[{"tags": ["c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464220721, "post_id": 37449439, "comment_id": 62400615, "body": "<code>strcmp(compare-&gt;val, &quot;a string&quot;) == 0</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1464221215, "post_id": 37449439, "comment_id": 62400736, "body": "@Barmar <code>overload</code> + <code>C</code> does not compute."}], "answers": [{"comments": [{"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 1, "creation_date": 1464220839, "post_id": 37449471, "comment_id": 62400643, "body": "actually this is the opposite o what the OP wanted since <code>strcmp</code> returns 0 if the two strings are equal."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 0, "creation_date": 1464221172, "post_id": 37449471, "comment_id": 62400726, "body": "@Jack  OP&#39;s post is ambiguous on that point, yet you are likely correct."}], "tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": false, "score": 1, "last_activity_date": 1464220788, "creation_date": 1464220788, "answer_id": 37449471, "question_id": 37449439, "link": "https://stackoverflow.com/questions/37449439/compare-struct-to-a-constant-in-c/37449471#37449471", "title": "Compare struct to a constant in C", "body": "<pre><code>typedef struct{\n    char *val;\n} STRING;\n\nint cmp(const STRING *a)\n{\n    return strcmp(a-&gt;val, \"a string\");\n}\n</code></pre>\n\n<p>You need <code>strcmp</code> for string comparison. == compares addresses.</p>\n"}, {"tags": [], "owner": {"reputation": 4425, "user_id": 6277831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c21010f99314f291650d4cd9e3b2735?s=128&d=identicon&r=PG", "display_name": "lostbard", "link": "https://stackoverflow.com/users/6277831/lostbard"}, "is_accepted": true, "score": 4, "last_activity_date": 1464220978, "creation_date": 1464220978, "answer_id": 37449499, "question_id": 37449439, "link": "https://stackoverflow.com/questions/37449439/compare-struct-to-a-constant-in-c/37449499#37449499", "title": "Compare struct to a constant in C", "body": "<p>You need to use strcmp. To keep with returning 1 if equal:</p>\n\n<pre><code>int func (STRING* compare){\n  if ( strcmp(compare, \"a string\" ) == 0) \n    return 1;\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "is_accepted": false, "score": 2, "last_activity_date": 1464221402, "creation_date": 1464221402, "answer_id": 37449556, "question_id": 37449439, "link": "https://stackoverflow.com/questions/37449439/compare-struct-to-a-constant-in-c/37449556#37449556", "title": "Compare struct to a constant in C", "body": "<p>When dealing with <code>struct</code> in C, since you don't have object oriented features, it's good to encapsulate the behavior or operations on such <code>struct</code> inside methods.</p>\n\n<p>Since your <code>STRING</code> type contains a pointer that I guess should be owned by the instance then you could provide 3 methods to manage allocation, decallocation and comparison of <code>STRING</code> objects, for example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\ntypedef struct {\n    char* val;\n} STRING;\n\nSTRING string_alloc(const char* val) {\n    STRING string;\n    string.val = malloc(strlen(val)+1);\n    strcpy(string.val, val);\n    return string;\n}\n\nvoid string_free(STRING* string) {\n    free(string-&gt;val);\n}\n\nbool string_compare(const STRING* str1, const STRING* str2) {\n    return strcmp(str1-&gt;val, str2-&gt;val) == 0;\n}\n\nint main(void) {\n    STRING string = string_alloc(\"foo\");\n    STRING string2 = string_alloc(\"foo\");\n\n    printf(\"Are equal: %s\\n\", string_compare(&amp;string, &amp;string2) ? \"true\" : \"false\");\n\n    string_free(&amp;string);\n    string_free(&amp;string2);\n\n    return 0;\n}\n</code></pre>\n\n<p>In this way you are able to encapsulate the comparison behavior inside a method and alter it if you need to alter the structure of the <code>struct</code>  (eg adding fields, removing fields) without touching anything else of the code.</p>\n"}], "owner": {"reputation": 490, "user_id": 2280542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/oWlu4.jpg?s=128&g=1", "display_name": "Andrei Tumbar", "link": "https://stackoverflow.com/users/2280542/andrei-tumbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 37449499, "answer_count": 3, "score": 3, "last_activity_date": 1464221402, "creation_date": 1464220599, "question_id": 37449439, "link": "https://stackoverflow.com/questions/37449439/compare-struct-to-a-constant-in-c", "title": "Compare struct to a constant in C", "body": "<p>I am trying to make a custom string class. Stuck on the a problem where I need to compare by struct to a constant string</p>\n\n<p>Example</p>\n\n<pre><code>    typedef struct{\n      char *val;\n    } STRING;\n\n    int func (STRING* compare){\n      if ( compare == \"a string\" ){\n        return 1;\n      return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "function"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464219718, "post_id": 37449186, "comment_id": 62400343, "body": "Also both of the words are checked same length."}, {"owner": {"reputation": 1, "user_id": 6383545, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c8OYL16Pk1k/AAAAAAAAAAI/AAAAAAAAAEM/Lsip2nVnNI8/photo.jpg?sz=128", "display_name": "Mehmet Han &#199;\u0131plak", "link": "https://stackoverflow.com/users/6383545/mehmet-han-%c3%87%c4%b1plak"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464305215, "post_id": 37449186, "comment_id": 62443659, "body": "I directly made null the last element still didn&#39;t work out. I enter the words with same length. If you can, please fix the code. Else {finals are gonna kill me;} :D"}], "owner": {"reputation": 1, "user_id": 6383545, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c8OYL16Pk1k/AAAAAAAAAAI/AAAAAAAAAEM/Lsip2nVnNI8/photo.jpg?sz=128", "display_name": "Mehmet Han &#199;\u0131plak", "link": "https://stackoverflow.com/users/6383545/mehmet-han-%c3%87%c4%b1plak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464218534, "creation_date": 1464218534, "question_id": 37449186, "link": "https://stackoverflow.com/questions/37449186/i-have-got-cygwin-exceptionopen-stackdumpfile-error-on-using-strstr-and-strn", "title": "I have got cygwin_exception::open_stackdumpfile error on using strstr() and strncopy functions", "body": "<p>one of my exam questions is about changing a word in a sentence. Well i decided to learn and implement string functions to get a better use but i'm stuck somewhere.</p>\n\n<p>Basically, the code works if it's in main like here</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main ()\n{\n  char str[] =\"lazyness is a sure thing\";\n  char w1[]=\"sure\";\n  char w2[]=\"lame\";\n\n\n  char *pch;\n  pch = strstr (str,w1);\n  strncpy (pch,w2,strlen(w1));\n  puts (str);\n  return 0;\n}\n</code></pre>\n\n<p>But i can not make it work in a void function which i need to run in exam.</p>\n\n<p>And the code i need follows;</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\n// == CHANGE STARTS BELOW THIS LINE ==\n\nvoid replace(char sentence[],char w1[],char w2[]){\n\n\n    char *pch;\n    pch = strstr (sentence,w1);\n   strncpy (pch,w2,strlen(w1));\n\n}\n\n\n// == CHANGE STOPS ABOVE THIS LINE ==\n\nvoid readString(char str[])\n{\n    char ch;\n    scanf(\"%c\", &amp;ch);\n    int i = 0;\n    while(ch != '\\n')\n{\n    str[i] = ch;\n    scanf(\"%c\", &amp;ch);\n    i++;\n}\nstr[i] = '\\0';\n}\n\nint main(void) {\n\nchar sentence[101];\nchar word1[21];\nchar word2[21];\n\nreadString(sentence);\nreadString(word1);\nreadString(word2);\n\nreplace(sentence, word1, word2);\n\nprintf(\"%s\", sentence);\n\nreturn EXIT_SUCCESS;\n</code></pre>\n\n<p>}</p>\n\n<p>You can only change between change starts this line and change stops above this line because the others parts must stay still to exam program can read it.</p>\n\n<p>Please help, thanx a lot :)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1464407341, "post_id": 37449087, "comment_id": 62485861, "body": "if <code>stdin</code> is pointed to the keyboard rather than a file, then there is no way to backup, as the keyboard cannot be backed up.  However, if <code>stdin</code> is pointed to a file, then can backup in the file, using something like <code>fseek()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 3, "last_activity_date": 1464220824, "last_edit_date": 1464220824, "creation_date": 1464218963, "answer_id": 37449242, "question_id": 37449087, "link": "https://stackoverflow.com/questions/37449087/nesting-fgets-with-stdin/37449242#37449242", "title": "Nesting fgets with stdin", "body": "<p>After the inner loop completes, you've reached the end of <code>stdin</code>. So when you go to the next iteration of the outer loop, there's nothing left in <code>stdin</code>, so the inner loop ends immediately.</p>\n\n<p>Assuming <code>stdin</code> is connected to a seekable stream (e.g. an ordinary file), you can solve this by rewinding back to the beginning before the inner loop.</p>\n\n<p>Another problem was that you were closing <code>fileInput</code> inside the loop. So after you read the first line of that file, it was closing the file, so it got an error trying to read the next line.</p>\n\n<pre><code>while (fgets(fline, sizeof(fline), fileInput)){\n    rewind(stdin);\n    while (fgets(line, sizeof(line), stdin)){\n        printf(\"%s\", fline);\n        printf(\"%s\", line); \n    }\n}\nfclose(fileInput);\n</code></pre>\n\n<p>A more general solution would be to read <code>stdin</code> into an array, then iterate over the array instead of using a <code>fgets</code> loop.</p>\n"}], "owner": {"reputation": 121, "user_id": 5781345, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/33834f2ddd72697091bf2b08297fafb4?s=128&d=identicon&r=PG&f=1", "display_name": "david12345", "link": "https://stackoverflow.com/users/5781345/david12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464220824, "creation_date": 1464217933, "last_edit_date": 1464218913, "question_id": 37449087, "link": "https://stackoverflow.com/questions/37449087/nesting-fgets-with-stdin", "title": "Nesting fgets with stdin", "body": "<p>I am trying to loop through every line in a file and every line in stdin to make a comparison. When I nest fgets in while loops the outer loop does not go though a second time. I've seen that if the inner loop was a file it could be closed to reset to the first line, but I can't seem to do the same thing with stdin. Is there a way to restart at the beginning of stdin?</p>\n\n<pre><code>while (fgets(fline, sizeof(fline), fileInput)){\n    while (fgets(line, sizeof(line), stdin)){\n        printf(\"%s\", fline);\n        printf(\"%s\", line); \n    }\n    fclose(fileInput);\n}\n</code></pre>\n\n<p>if file input contained </p>\n\n<pre><code>a\nb\nc\n</code></pre>\n\n<p>and std in was</p>\n\n<pre><code>d\ne\n</code></pre>\n\n<p>I want it to print</p>\n\n<pre><code>a\nd\na\ne\nb\nd\nb\ne\nc\nd\nc\ne\n</code></pre>\n"}, {"tags": ["c", "uint32"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1464216810, "post_id": 37448908, "comment_id": 62399661, "body": "The warning says it all. You cannot compute the value of an expression that cannot be expressed."}, {"owner": {"reputation": 786, "user_id": 5050247, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZNqD_kLm9FU/AAAAAAAAAAI/AAAAAAAAACc/G5JpPNk6hbg/photo.jpg?sz=128", "display_name": "Nicholas Patton", "link": "https://stackoverflow.com/users/5050247/nicholas-patton"}, "edited": false, "score": 0, "creation_date": 1464216949, "post_id": 37448908, "comment_id": 62399698, "body": "Perhaps the issue here is that (1 &lt;&lt; 32) requires 1 bit more of space (33 bits) to store the value -- so the compiler is having fits since you are working with a 32 bit variable."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1464216957, "post_id": 37448908, "comment_id": 62399702, "body": "with 32-bit int, 2^32 - 1 will fit (unsigned)... problem is, 2^32 won&#39;t, and it&#39;s a part of the expression you calculate 2^32-1 with.  However, for other reasons, you&#39;ll likely get the right answer in the end anyway since uint32_t will be modulo 2^32."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1464217019, "post_id": 37448908, "comment_id": 62399726, "body": "Try using <code>(1ULL &lt;&lt; 32)</code>."}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 2, "creation_date": 1464217211, "post_id": 37448908, "comment_id": 62399779, "body": "Why not just <code>0xFFFFFFFF</code>?"}, {"owner": {"reputation": 513, "user_id": 5432899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fRtnb.png?s=128&g=1", "display_name": "Simonlbc", "link": "https://stackoverflow.com/users/5432899/simonlbc"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1464217250, "post_id": 37448908, "comment_id": 62399785, "body": "@jxh 1ULL &lt;&lt; 32 seems to make the compiler happy! What is 1ULL?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1464217756, "post_id": 37448908, "comment_id": 62399893, "body": "The <code>ULL</code> suffix means the constant is of the <code>unsigned long long</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1464217785, "post_id": 37448908, "comment_id": 62399902, "body": "@Simonlbc it&#39;s an <code>unsigned long long</code> literal, and is at least 64 bits wide."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1464218324, "post_id": 37448908, "comment_id": 62400008, "body": "Just because the result is supposed to fit into the range of the target type does not mean that you should not care about the intermediate values fitting into that range. Even if we ignore other errors, arriving at 2^32-1 (which is in range) requires you to pass through 2^32 (which is out of range)."}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1464217209, "post_id": 37448948, "comment_id": 62399778, "body": "<code>1 &lt;&lt; 31</code> is also undefined behaviour (shifting into the sign bit)"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1464218465, "post_id": 37448948, "comment_id": 62400047, "body": "... unless <code>int</code> is wider than 32 bit."}], "tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": false, "score": 5, "last_activity_date": 1613991271, "last_edit_date": 1613991271, "creation_date": 1464216948, "answer_id": 37448948, "question_id": 37448908, "link": "https://stackoverflow.com/questions/37448908/232-1-not-part-of-uint32-t/37448948#37448948", "title": "2^32 - 1 not part of uint32_t?", "body": "<p>The warning is correct, the highest bit in a 32bit number is the 31st bit (0 indexed) so the largest shift before overflow is <code>1 &lt;&lt; 30</code> (30 because of the sign bit). Even though you are doing <code>-1</code> at some point the result of <code>1 &lt;&lt; 32</code> must be stored and it will be stored in an <code>int</code> (which in this case happens to be 32 bits). Hence you get the warning.</p>\n<p>If you really need to get the max of the <code>32 bit unsigned int</code> you should do it the neat way:</p>\n<pre><code>#include &lt;stdint.h&gt;\n\nuint32_t limit = UINT32_MAX;\n</code></pre>\n<p>Or better yet, use the c++ limits header:</p>\n<pre><code>#include &lt;limits&gt;\nauto limit = std::numeric_limits&lt;uint32_t&gt;::max();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1464217316, "post_id": 37448956, "comment_id": 62399802, "body": "That looks like C++ to me!"}, {"owner": {"reputation": 513, "user_id": 5432899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fRtnb.png?s=128&g=1", "display_name": "Simonlbc", "link": "https://stackoverflow.com/users/5432899/simonlbc"}, "edited": false, "score": 0, "creation_date": 1464217870, "post_id": 37448956, "comment_id": 62399910, "body": "is the 1 in -1 kind of converted to uint32_t? How come it works well?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "reply_to_user": {"reputation": 513, "user_id": 5432899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fRtnb.png?s=128&g=1", "display_name": "Simonlbc", "link": "https://stackoverflow.com/users/5432899/simonlbc"}, "edited": false, "score": 1, "creation_date": 1464218162, "post_id": 37448956, "comment_id": 62399975, "body": "@Simonlbc: The integer promotion rules guarantee the calculation will be performed either in a signed integral type large enough to represent every element of <code>uint32_t</code>, or if there is no such thing, in <code>uint32_t</code> itself. Either way, the end result is a well-defined number equivalent to <code>-1</code> modulo <code>2^32</code>. There&#39;s no harm in casting <code>1</code> to <code>uint32_t</code> as well, if you want."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 513, "user_id": 5432899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fRtnb.png?s=128&g=1", "display_name": "Simonlbc", "link": "https://stackoverflow.com/users/5432899/simonlbc"}, "edited": false, "score": 1, "creation_date": 1464218211, "post_id": 37448956, "comment_id": 62399985, "body": "@Simonlbc it uses modulo 2^32 arithmetic. You can also just do <code>uint32_t x = -1;</code>, which is perfectly legal (assuming <code>uint32_t</code> is implemented), although some compilers might issue a warning anyway."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "edited": false, "score": 0, "creation_date": 1464218311, "post_id": 37448956, "comment_id": 62400003, "body": "Right; I do <code>0-1</code> to reassure the compiler; you <i>can</i> just do <code>-1</code> directly if you&#39;re willing to put up with the warning or decide not to enable that warning... but I prefer to enable warnings and have warning-free builds."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "is_accepted": true, "score": 3, "last_activity_date": 1464218264, "last_edit_date": 1464218264, "creation_date": 1464216992, "answer_id": 37448956, "question_id": 37448908, "link": "https://stackoverflow.com/questions/37448908/232-1-not-part-of-uint32-t/37448956#37448956", "title": "2^32 - 1 not part of uint32_t?", "body": "<p>You have two errors:</p>\n\n<ul>\n<li><code>1</code> is of type <code>int</code>, so you are computing the initial value as an <code>int</code>, not as a <code>uint32_t</code>.</li>\n<li>As the warning says, shift operators must have their shift argument be less than the width of the type. <code>1 &lt;&lt; 32</code> is <strong><em>undefined behavior</em></strong> if <code>int</code> is 32 bits or less. <code>(uint32_t)1 &lt;&lt; 32</code> would be undefined as well.</li>\n</ul>\n\n<p>(also, note that <code>1 &lt;&lt; 31</code> would be undefined behavior as well, if <code>int</code> is 32 bits, because of overflow)</p>\n\n<p>Since arithmetic is done modulo <code>2^32</code> anyways, an easier way to do this is just</p>\n\n<pre><code>uint32_t x = -1;\nuint32_t y = (uint32_t)0 - 1; // this way avoids compiler warnings\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1464218520, "post_id": 37448960, "comment_id": 62400061, "body": "<code>~0u</code> is more appropriate for bit-fiddling, especially considering that the OP wants unsigned result."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1464218909, "post_id": 37448960, "comment_id": 62400162, "body": "Specifically, OP wants a <code>uint32_t</code> result with the maximum value, so even <code>~0u</code> is wrong if the compiler&#39;s <code>unsigned int</code> is less than 32 bits wide."}], "tags": [], "owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "is_accepted": false, "score": 1, "last_activity_date": 1464217046, "creation_date": 1464217046, "answer_id": 37448960, "question_id": 37448908, "link": "https://stackoverflow.com/questions/37448908/232-1-not-part-of-uint32-t/37448960#37448960", "title": "2^32 - 1 not part of uint32_t?", "body": "<p>The compiler is using int internally in your example when trying to calculate the target constant. Imagine that rhe compiler didn't have any optimization available and was to generate assembler for your shift. The number 32 would be to big for the 32bit int shift instruction.</p>\n\n<p>Also, if you want all bits set, use ~0</p>\n"}], "owner": {"reputation": 513, "user_id": 5432899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fRtnb.png?s=128&g=1", "display_name": "Simonlbc", "link": "https://stackoverflow.com/users/5432899/simonlbc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "accepted_answer_id": 37448956, "answer_count": 3, "score": 0, "last_activity_date": 1613991271, "creation_date": 1464216626, "question_id": 37448908, "link": "https://stackoverflow.com/questions/37448908/232-1-not-part-of-uint32-t", "title": "2^32 - 1 not part of uint32_t?", "body": "<p>Here is the program whose compilation output makes me cry:</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n\nint main()\n{\n        uint32_t limit = (1 &lt;&lt; 32) - 1; // 2^32 - 1 right?\n}\n</code></pre>\n\n<p>and here is the compilation output:</p>\n\n<pre><code>~/workspace/CCode$ gcc uint32.c \nuint32.c: In function \u2018main\u2019:\nuint32.c:5:29: warning: left shift count &gt;= width of type [-Wshift-count-overflow]\n         uint32_t limit = (1 &lt;&lt; 32) - 1; // 2^32 - 1 right?\n</code></pre>\n\n<p>I thought that <code>(1 &lt;&lt; 32) - 1</code> equals to 2^32 - 1 and that unsigned integers on 32 bits range from 0 to 2^32 - 1, isnt it the case? Where did I go wrong?</p>\n"}, {"tags": ["c++", "c", "gcc", "assembly", "x86"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 3, "creation_date": 1464216469, "post_id": 37448848, "comment_id": 62399555, "body": "It may just be garbage your debugger is disassembling to readable instructions. This can happen for a wide variety of reasons."}, {"owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "edited": false, "score": 1, "creation_date": 1464216473, "post_id": 37448848, "comment_id": 62399556, "body": "It would help to know the addresses of this code.  Do you know, for example, that the instruction <code>jae 0xb6e17b88</code> isn&#39;t just a jump over the <code>jmp</code> instruction to the <code>lea</code> instruction?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1464216515, "post_id": 37448848, "comment_id": 62399576, "body": "It may be the target of some other jump too. The <code>lea</code> is just padding for alignment, by the way, so that may indeed not be reached."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1464216736, "post_id": 37448848, "comment_id": 62399630, "body": "My personal favourite is a smashed stack results in a return to the wrong place in the code. Hilarity results. It&#39;s not quite Bill Murray funny, but it&#39;s way up there."}, {"owner": {"reputation": 2389, "user_id": 1991678, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a9f5d4caa1c8059acdb6582c8429bc3f?s=128&d=identicon&r=PG&f=1", "display_name": "default", "link": "https://stackoverflow.com/users/1991678/default"}, "reply_to_user": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "edited": false, "score": 0, "creation_date": 1464216912, "post_id": 37448848, "comment_id": 62399686, "body": "@davidbak, yes i know that.  I&#39;m showing a simplified output in my question, but in my full output, each line has a absolute and relative address next to it, and all the jumps also show the relative address as well so its really easy to see where all the jumps of the function are going."}], "answers": [{"comments": [{"owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "edited": false, "score": 4, "creation_date": 1464217043, "post_id": 37448913, "comment_id": 62399735, "body": "Geez, if the word &quot;bizarro&quot; wasn&#39;t in the quote, I would have made it this comment."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1464219757, "post_id": 37448913, "comment_id": 62400353, "body": "If the alignment filler code is supposed to be unreachable anyway, is there any advantage in filling with one bizarro LEA instruction rather than a series of NOP instructions?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1464231456, "post_id": 37448913, "comment_id": 62403000, "body": "@IanAbbott: It <i>probably</i> doesn&#39;t matter.  It might still get decoded in the same cycle as the jmp that makes it unreachable.  IDK if Intel SnB-family CPUs would allocate a new uop cache-line to hold those decoded uops, in case they&#39;re needed later.  (It doesn&#39;t know until after it decodes them that they&#39;re <code>nop</code>s, and in the non-<code>nop</code> case it&#39;s probable that something will jump there soon.)  So it might possibly save a cycle decoding, or some space in the uop cache."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1464231567, "post_id": 37448913, "comment_id": 62403015, "body": "@IanAbbott: Fun fact: the static prediction for an unconditional indirect jump is the next address.  If that&#39;s not one of the possible branch targets, it does actually help to follow it with a <code>ud2</code> to stop speculative execution when a better branch-target prediction isn&#39;t available.  Or, if you&#39;re making a jump table, try to put the common case as the address right after the <code>jmp rax</code>."}], "tags": [], "owner": {"reputation": 2389, "user_id": 1991678, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a9f5d4caa1c8059acdb6582c8429bc3f?s=128&d=identicon&r=PG&f=1", "display_name": "default", "link": "https://stackoverflow.com/users/1991678/default"}, "is_accepted": true, "score": 5, "last_activity_date": 1464216700, "last_edit_date": 1495541318, "creation_date": 1464216700, "answer_id": 37448913, "question_id": 37448848, "link": "https://stackoverflow.com/questions/37448848/unreachable-code-in-assembly/37448913#37448913", "title": "Unreachable code in assembly", "body": "<p>I found the answer <a href=\"https://stackoverflow.com/a/2553556/1991678\">here</a></p>\n\n<blockquote>\n  <p>Sometimes GCC inserts NOP instructions into the code stream to ensure proper alignment and stuff like that. The NOP instruction takes one byte, so you would think that you could just add as many as needed. But according to Ian Lance Taylor, it\u2019s faster for the chip to execute one long instruction than many short instructions. So rather than inserting seven NOP instructions, they instead use one bizarro LEA, which uses up seven bytes and is semantically equivalent to a NOP</p>\n</blockquote>\n"}], "owner": {"reputation": 2389, "user_id": 1991678, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a9f5d4caa1c8059acdb6582c8429bc3f?s=128&d=identicon&r=PG&f=1", "display_name": "default", "link": "https://stackoverflow.com/users/1991678/default"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 1, "accepted_answer_id": 37448913, "answer_count": 1, "score": 3, "last_activity_date": 1464358772, "creation_date": 1464216290, "last_edit_date": 1464358772, "question_id": 37448848, "link": "https://stackoverflow.com/questions/37448848/unreachable-code-in-assembly", "title": "Unreachable code in assembly", "body": "<p>I'm debugging a crash in linux, and am going through the assembly of the function <a href=\"https://github.com/lattera/glibc/blob/master/stdlib/cxa_finalize.c\" rel=\"nofollow\">cxa_finalize</a></p>\n\n<p>The crash happens on a source line that appears unreachable:</p>\n\n<pre><code>cmp    %edx,%esi             // f &gt;= &amp;funcs-&gt;fns[0]\njae    0xb6e17b88            // enter for loop\njmp    0xb6e17c08            // exit for loop\nlea    0x0(%esi,%eiz,1),%esi // crashes here - how do we even get here since there is a \n                             // jmp above us, and nothing jumps to here\ncmp    %edi,0xc(%esi)        // d == f-&gt;func.cxa.dso_handle (jumped to from below)\n</code></pre>\n\n<p>later on in this method, there is another <code>lea 0x0(%esi,%eiz,1),%esi</code> instruction that appears after a <code>jmp</code> and <code>nop</code> that also appears unreachable.  In that case, the <code>jmp</code> is also exiting a for loop.</p>\n\n<p>Is there some paradigm going on here that puts in unreachable instructions?</p>\n\n<p>Edit: Turns out it wasn't crashing on the <code>lea</code> instruction, but on the <code>cmp</code> instruction after it, when accessing the memory at <code>esi</code>.</p>\n"}, {"tags": ["c", "integer", "compare", "avx", "avx2"], "comments": [{"owner": {"reputation": 107, "user_id": 2399267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EGMyR.jpg?s=128&g=1", "display_name": "user2399267......seems good", "link": "https://stackoverflow.com/users/2399267/user2399267-seems-good"}, "edited": false, "score": 1, "creation_date": 1464214696, "post_id": 37448544, "comment_id": 62398915, "body": "I&#39;m not sure if there is a smarter (more efficient) way of doing it, as the unnecessary <code>0xF..F</code> is bothering me"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1464219294, "post_id": 37448544, "comment_id": 62400253, "body": "Have you checked what a good compiler will do for this? gcc generates the all-ones mask for the &quot;and not&quot; by comparing a temporary register for equality with itself (always compares true), so you don&#39;t need to keep this around as a constant, and according to Agner Fog&#39;s analysis, the instruction is recognized as independent of the previous value of the register, so you can quickly generate the mask and don&#39;t need to keep it around, wasting a register."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1464268996, "post_id": 37450881, "comment_id": 62423103, "body": "@PaulR: Apparently my sleepy brain knew the right answer involved some kind of reversing of operands, but ran out of steam before noticing that I had it totally wrong.  &gt;.&lt;"}, {"owner": {"reputation": 107, "user_id": 2399267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EGMyR.jpg?s=128&g=1", "display_name": "user2399267......seems good", "link": "https://stackoverflow.com/users/2399267/user2399267-seems-good"}, "edited": false, "score": 0, "creation_date": 1464269891, "post_id": 37450881, "comment_id": 62423838, "body": "you&#39;re right about the <code>blendv</code> intrinsics, but I actually would need an OR after that and there is no NOR for it - but thanks anyway"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 107, "user_id": 2399267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EGMyR.jpg?s=128&g=1", "display_name": "user2399267......seems good", "link": "https://stackoverflow.com/users/2399267/user2399267-seems-good"}, "edited": false, "score": 0, "creation_date": 1464270641, "post_id": 37450881, "comment_id": 62424450, "body": "@user2399267......seemsgood:  <code>NOR</code> would be <code>~(a|b)</code>.  The operation you&#39;d need, <code>(~a | b)</code> would be called <code>ORN</code>, like <code>ANDN</code>.  IIRC, AVX512 vector integer comparisons take a predicate argument (encoded in an immediate byte), so AVX512 will finally give us a wide choice of comparison operators, the way <code>cmpps</code> currently does."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1464273423, "post_id": 37450881, "comment_id": 62426749, "body": "@PeterCordes: well I think it&#39;s the first time I&#39;ve ever spotted a mistake in one of your posts, so your batting average is way better than mine. ;-) I&#39;ll delete my comment to reduce the noise, now that you&#39;ve updated the answer..."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 4, "last_activity_date": 1464269337, "last_edit_date": 1464269337, "creation_date": 1464232016, "answer_id": 37450881, "question_id": 37448544, "link": "https://stackoverflow.com/questions/37448544/avx2-integer-comparison-for-smaller-equal/37450881#37450881", "title": "AVX2 integer comparison for smaller equal", "body": "<p>You're right that there's no direct way to get the mask you really want, only an inverted mask: <code>A gt B</code> = <code>A nle B</code>.</p>\n\n<p>There's no vector-NOT instruction, so you do need a vector of all-ones as well as an extra instruction to invert a vector.  (Or a vector of all-zero and <code>_mm256_cmpeq_epi8</code>, but that can't run on as many execution ports as <code>_mm256_xor_si256</code> with an all-ones vector.)    See the <a href=\"/questions/tagged/x86\" class=\"post-tag\" title=\"show questions tagged &#39;x86&#39;\" rel=\"tag\">x86</a> tag wiki for performance info, esp. Agner Fog's guide.</p>\n\n<p>The other bitwise boolean option, <code>_mm256_andn_si256</code> is just as good as xor.  It isn't commutative, and slightly more complicated to mentally verify that you got it right.  xor-with-all-ones is a good idiom for flip-all-the-bits.</p>\n\n<hr>\n\n<p><strong>Instead of spending an instruction inverting the mask, in most code it's possible to just use it the opposite way.</strong></p>\n\n<p>e.g. if it's an input to a <code>blendv</code>, then reverse the order of the operands to the blend.  Instead of<br>\n<code>_mm256_blendv_epi8(a, b, A_le_B_mask)</code>, use<br>\n<code>_mm256_blendv_epi8(b, a, A_nle_B_mask)</code></p>\n\n<p>If you were going to <code>_mm_and</code> something with the mask, use <code>_mm_andn</code> instead.</p>\n\n<p>If you were going to <code>_mm_movemask</code> and test for all-zero, you can instead test for all-ones.  It will compile to a <code>cmp eax, -1</code> instruction instead of a <code>test eax,eax</code>, which is just as efficient.  If you were going to bitscan for the first 1, you will have to invert it.  An integer <code>not</code> instruction (from using <code>~</code> on the movemask result) is cheaper than doing it on the vector.</p>\n\n<hr>\n\n<p>You only have a problem if you were going to OR or XOR, because those instruction don't come in flavours that negate one of their inputs.  (IDK if Intel just didn't want to add a <code>PORN</code> mnemonic, but probably <code>PAND</code> and <code>PANDN</code> get more use, esp. before variable-blend instructions.</p>\n"}], "owner": {"reputation": 107, "user_id": 2399267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EGMyR.jpg?s=128&g=1", "display_name": "user2399267......seems good", "link": "https://stackoverflow.com/users/2399267/user2399267-seems-good"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1794, "favorite_count": 1, "accepted_answer_id": 37450881, "answer_count": 1, "score": 3, "last_activity_date": 1464269337, "creation_date": 1464214485, "question_id": 37448544, "link": "https://stackoverflow.com/questions/37448544/avx2-integer-comparison-for-smaller-equal", "title": "AVX2 integer comparison for smaller equal", "body": "<p>What is the most efficient way to compare two 4x 64bit-Integer AVX vectors for <code>&lt;=</code>.</p>\n\n<p>From the Intel Intrinsics Guide we have</p>\n\n<ul>\n<li><code>_mm256_cmpgt_epi64(__m256i a, __m256i b)</code> = a >  b</li>\n<li><code>_mm256_cmpeq_epi64(__m256i a, __m256i b)</code> = a == b</li>\n</ul>\n\n<p>for comparisons</p>\n\n<p>and</p>\n\n<ul>\n<li><code>_mm256_and_si256(__m256i a, __m256i b)</code> = a &amp; b</li>\n<li><code>_mm256_andnot_si256(__m256i a, __m256i b)</code> = ~a &amp; b</li>\n<li><code>_mm256_or_si256(__m256i a, __m256i b)</code> = a | b</li>\n<li><code>_mm256_xor_si256(__m256i a, __m256i b)</code> = a ^ b</li>\n</ul>\n\n<p>for logical operations.</p>\n\n<p>My approach was:</p>\n\n<p><code>// check = ( a &lt;= b ) = ~(a &gt; b) &amp; 0xF..F</code><br>\n<code>__m256i a     = ...</code><br>\n<code>__m256i b     = ...</code><br>\n<code>__m256i tmp   = _mm256_cmpgt_epi64(a, b)</code><br>\n<code>__m256i check = _mm256_andnot_si256(tmp, _mm256_set1_epi64x(-1))</code></p>\n"}, {"tags": ["c", "bit-shift"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 2, "creation_date": 1464214449, "post_id": 37448493, "comment_id": 62398826, "body": "The shift you&#39;re trying to do is undefined behavior. Also, why are you doing <code>(1&lt;&lt;31)&gt;&gt;31</code> (also undefined behavior) to get <code>-1</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464214481, "post_id": 37448493, "comment_id": 62398840, "body": "Note: Shifting left into the sign bit is UB. and &quot;An example of implementation-defined behavior is the propagation of the high-order bit when a signed integer is shifted right.&quot; so <code>int neg1=(1&lt;&lt;31)&gt;&gt;31;</code> may not execute as expected."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1464214617, "post_id": 37448493, "comment_id": 62398890, "body": "Must code use <code>int</code>?  How about <code>unsigned</code>?  Lots less issues."}, {"owner": {"reputation": 453, "user_id": 3624257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EMj2a.jpg?s=128&g=1", "display_name": "Hill", "link": "https://stackoverflow.com/users/3624257/hill"}, "edited": false, "score": 2, "creation_date": 1464214649, "post_id": 37448493, "comment_id": 62398898, "body": "You should be able to add an <code>if(n &gt;= 32) mask = 0; else ...</code> statement to deal with that case."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1464214832, "post_id": 37448493, "comment_id": 62398978, "body": "So <code>mask(0) --&gt; 0xFFFFFFFF</code>, <code>mask(1) --&gt; 0xFFFFFFFE</code> ... <code>mask(31) --&gt; 0x80000000</code> and <code>mask(32) --&gt; 0</code>?  Does code need to handle other values of <code>n</code>?"}, {"owner": {"reputation": 359, "user_id": 4682585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/826355592/picture?type=large", "display_name": "Aldo Pareja", "link": "https://stackoverflow.com/users/4682585/aldo-pareja"}, "edited": false, "score": 0, "creation_date": 1464222495, "post_id": 37448493, "comment_id": 62401034, "body": "My question is not answered in the question proposed by M.M. I understand why I am getting -1 as the result of 1&lt;&lt;31&gt;&gt;31. What I don&#39;t understand is what I asked."}], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 4682585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/826355592/picture?type=large", "display_name": "Aldo Pareja", "link": "https://stackoverflow.com/users/4682585/aldo-pareja"}, "edited": false, "score": 0, "creation_date": 1464222400, "post_id": 37448727, "comment_id": 62401009, "body": "Thank you so much!... I just didn&#39;t know it was an undefined behavior. Although it was pretty weird that when doing it with a constant I was getting what I wanted and when doing it with a variable I was getting the other thing!."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 359, "user_id": 4682585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/826355592/picture?type=large", "display_name": "Aldo Pareja", "link": "https://stackoverflow.com/users/4682585/aldo-pareja"}, "edited": false, "score": 1, "creation_date": 1464225763, "post_id": 37448727, "comment_id": 62401772, "body": "@Aldo Pareja  unclear by the statement &quot;doing it with a constant I was getting what I wanted and when doing it with a variable&quot;.  Detail  <code>1&lt;&lt;31</code> with 32-bit <code>int</code> is UB because 1 (an <code>int</code>) is shifted into the sign bit.  <code>0xffffffff</code> is an <code>unsigned</code> and shifting a 32-bit <code>unsigned</code> by 0 to 31 is well defined."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1464215818, "last_edit_date": 1464215818, "creation_date": 1464215512, "answer_id": 37448727, "question_id": 37448493, "link": "https://stackoverflow.com/questions/37448493/why-do-i-have-this-different-behavior-in-different-implementations-of-left-bit-s/37448727#37448727", "title": "why do I have this different behavior in different implementations of left bit-shift?", "body": "<p>OP's code invokes undefined behavior when trying to shift left into the sign bit of a 32-bit <code>int</code>.  </p>\n\n<blockquote>\n  <p>The result of E1 &lt;&lt; E2 is E1 left-shifted E2 bit positions; vacated bits are filled with zeros. ... If E1 has a signed type and nonnegative value, and E1 \u00d7 2E2 is representable in the result type, then that is the resulting value; otherwise, the behavior is undefined. C11 \u00a76.5.7 4</p>\n</blockquote>\n\n<p>Instead use unsigned types to avoid ill-defined behavior with a shift of 31.  A shift of 32+ on a 32-bit <code>unsigned</code> will be a problem too.  </p>\n\n<p>A simple approach uses a wider type.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;inttypes.h&gt;\n\nuint32_t mask32(int n) {\n  return 0 - (1ull &lt;&lt; n);\n}\n\nint main(void) {\n  for (int i=0; i&lt;=32; i++) {\n    printf(\"%2d %lX\\n\", i, (unsigned long) mask32(i));\n  }\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code> 0 FFFFFFFF\n 1 FFFFFFFE\n 2 FFFFFFFC\n ...\n29 E0000000\n30 C0000000\n31 80000000\n32 0\n</code></pre>\n"}], "owner": {"reputation": 359, "user_id": 4682585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/826355592/picture?type=large", "display_name": "Aldo Pareja", "link": "https://stackoverflow.com/users/4682585/aldo-pareja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1464215548, "accepted_answer_id": 37448727, "answer_count": 1, "score": 1, "last_activity_date": 1464215818, "creation_date": 1464214235, "question_id": 37448493, "link": "https://stackoverflow.com/questions/37448493/why-do-i-have-this-different-behavior-in-different-implementations-of-left-bit-s", "closed_reason": "Duplicate", "title": "why do I have this different behavior in different implementations of left bit-shift?", "body": "<p>the purpose of my code is to create a mask of n zeroes to the right of my int (32 bits) representation. My approach was first to have the negative one stored in a variable and then shift it left n spaces to have n zeroes to the right. The code is the following:</p>\n\n<pre><code>int mask(int n){\n  int neg1=(1&lt;&lt;31)&gt;&gt;31;\n  int mask=neg1&lt;&lt;n;\n  return mask;\n}\n</code></pre>\n\n<p>Nonetheless when n is 32 I would like to get the value 0x0, but instead I am getting 0xffffffff (neg1). That happens when I do the shift to the variable. But when I do the shift to the constant itself, it works like a charm. The new code would be:</p>\n\n<pre><code>mask=0xffffffff&lt;&lt;n;\n</code></pre>\n\n<p>Nonetheless, I'm not allowed to use constants of more than 8 bits. So I need the value stored in another variable. Can somebody tell me why is this happening and how can I solve it?</p>\n\n<p>Thank you so much!</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 4, "creation_date": 1464212522, "post_id": 37447996, "comment_id": 62398067, "body": "Umm.. and why exactly are you sending <code>WM_NCDESTROY</code> yourself?"}, {"owner": {"reputation": 446, "user_id": 4699114, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7c923110bd052844fe8983a7eeb522d8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike32ab", "link": "https://stackoverflow.com/users/4699114/mike32ab"}, "reply_to_user": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1464212735, "post_id": 37447996, "comment_id": 62398146, "body": "For testing purposes. It seems like any process can send you this message and there&#39;s no way to protect against it since <code>SendMessage()</code> is handling it itself"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1464213502, "post_id": 37447996, "comment_id": 62398455, "body": "None of this makes any sense. If another process decides to send a <code>WM_NCDESTROY</code> message to a window in your process, so be it. It&#39;s nothing you can protect yourself against. Just implement your application to work for the normal case (i.e. on systems that don&#39;t have rogue applications running, thrashing other programs)."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1464213628, "post_id": 37447996, "comment_id": 62398507, "body": "Yes, some messages are handled specially, no you can&#39;t protect against malicious programs sending you messages (like WM_TIMER for arbitrary code execution) except with UIPI, and why are you on Windows XP?"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1464215315, "post_id": 37447996, "comment_id": 62399158, "body": "WM_NCDESTROY is rather special, it is guaranteed to be the <i>last</i> message that a window ever receives before it is destroyed.  It gets lots and lots of use because of that, you always use it when you <i>subclass</i> a window.  Like the Visual Styles renderer will do to make a window look different and stop making it look different because it isn&#39;t around anymore.  Well, oops there."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1464216013, "post_id": 37447996, "comment_id": 62399408, "body": "You have to love these questions. <i>When I do something absolutely wrong, that I&#39;m never supposed to do, it causes me problems. Why?</i>"}], "answers": [{"tags": [], "owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "is_accepted": true, "score": 5, "last_activity_date": 1464264770, "last_edit_date": 1464264770, "creation_date": 1464216037, "answer_id": 37448809, "question_id": 37447996, "link": "https://stackoverflow.com/questions/37447996/why-is-the-window-painted-strangely-without-visual-styles-after-sending-wm-ncd/37448809#37448809", "title": "Why is the window painted strangely (without visual styles) after sending WM_NCDESTROY?", "body": "<p>The WM_NCDESTROY message is rather special, it is guaranteed to be the <strong>last</strong> message that a window ever receives before it is destroyed.  It is generated by the DestroyWindow() function.</p>\n\n<p>Being last gives it a rather exalted status.  It signals \"stop doing what you've been doing\".  For example, you always use it when you <em>subclass</em> a window; this message tells you to stop subclassing it.  And you'd always use it in a C++ wrapper class for a window, where it tells you when the C++ object needs to be destroyed.  And it is pretty likely to be the notification that the Visual Styles renderer uses to stop making a window look different because it isn't around anymore. </p>\n\n<p>Oops.</p>\n\n<p>Messages like that are <em>notifications</em> that something interesting happened.  As opposed to the kind of messages that are intended to <em>make</em> something interesting happen, like WM_LBUTTONDOWN, WM_KEYDOWN, WM_COMMAND.  Most obvious in the WM_CLOSE vs WM_DESTROY message.  WM_CLOSE is \"please close the window\". You can monkey with that and refuse to close the window, traditionally with the \"Data not saved, are you sure\" message.  WM_DESTROY is \"it is closed\".  That's a rock, it really did get destroyed, no point in ever monkeying with that one.</p>\n\n<p>If you generate a fake notification, then you should be prepared to get a fake outcome.  Don't mess with the important ones.</p>\n"}], "owner": {"reputation": 446, "user_id": 4699114, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7c923110bd052844fe8983a7eeb522d8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike32ab", "link": "https://stackoverflow.com/users/4699114/mike32ab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 37448809, "answer_count": 1, "score": 0, "last_activity_date": 1464264815, "creation_date": 1464212033, "last_edit_date": 1464264815, "question_id": 37447996, "link": "https://stackoverflow.com/questions/37447996/why-is-the-window-painted-strangely-without-visual-styles-after-sending-wm-ncd", "title": "Why is the window painted strangely (without visual styles) after sending WM_NCDESTROY?", "body": "<p>I get strange window painting after I send <code>WM_NCDESTROY</code> manually. This only happens when visual styles are on. When 'Classic style' is on it does not seem to affect the window. I do not pass <code>WM_NCDESTROY</code> to <code>DefWindowProc()</code> when I send it manually, but the window still gets painted strangely. It seems like <code>SendMessage()</code> is processing <code>WM_NCDESTROY</code>. Why is <code>WM_NCDESTROY</code> getting processed even though I do not pass it to <code>DefWindowProc()</code>?</p>\n\n<pre><code>#include &lt;windows.h&gt;\n\nHINSTANCE g_hInst;\n\nLRESULT CALLBACK WndProc2(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)\n{\n    static BOOL bProcessMsg = FALSE;\n\n    switch(msg)\n    {\n    case WM_RBUTTONUP:\n        SendMessage(hwnd, WM_NCDESTROY, 0, 0);\n        //Size window manually after this message is processed to see the effects\n        break;\n\n    case WM_DESTROY:\n        bProcessMsg = TRUE;\n        break;\n\n    case WM_NCDESTROY: \n        if(!bProcessMsg) return 0;\n        MessageBox(0, L\"Message processed\", 0, MB_OK);\n        return DefWindowProc(hwnd, msg, wParam, lParam);\n        break;\n\n    default: \n        return DefWindowProc(hwnd, msg, wParam, lParam);\n    }\n    return 0;\n}\n\nLRESULT CALLBACK WndProc1(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)\n{\n    switch(msg)\n    {\n    case WM_MBUTTONUP:\n        {\n            WNDCLASSEX wc = { 0 };\n            wc.cbSize        = sizeof(WNDCLASSEX);\n            wc.hbrBackground = (HBRUSH)(COLOR_WINDOW+1);\n            wc.hCursor       = LoadCursor(0, IDC_ARROW);\n            wc.hIcon         = LoadIcon(0, IDI_APPLICATION);\n            wc.hInstance     = g_hInst;\n            wc.lpfnWndProc   = WndProc2;\n            wc.lpszClassName = L\"Testclass2\";\n            if(!RegisterClassEx(&amp;wc)) return 0;\n            CreateWindowEx(0, L\"Testclass2\", L\"Test2\", WS_OVERLAPPEDWINDOW | WS_VISIBLE, 40, 40, 200, 200, hwnd, 0, g_hInst, 0);\n        }\n        break;\n\n    case WM_DESTROY: \n        PostQuitMessage(0);\n        break;\n\n    default: \n        return DefWindowProc(hwnd, msg, wParam, lParam);\n    }\n    return 0;\n}\n\nint WINAPI wWinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPWSTR lpCmdLine, int nCmdShow)\n{\n    WNDCLASSEX wc = { 0 };\n    HWND hwnd;\n    MSG msg;\n\n    wc.cbSize        = sizeof(WNDCLASSEX);\n    wc.hbrBackground = (HBRUSH)(COLOR_WINDOW+1);\n    wc.hCursor       = LoadCursor(0, IDC_ARROW);\n    wc.hIcon         = LoadIcon(0, IDI_APPLICATION);\n    wc.hInstance     = hInstance;\n    wc.lpfnWndProc   = WndProc1;\n    wc.lpszClassName = L\"Testclass\";\n    if(!RegisterClassEx(&amp;wc)) return 0;\n\n    g_hInst = hInstance;\n    hwnd = CreateWindowEx(0, L\"Testclass\", L\"Test1\", WS_OVERLAPPEDWINDOW, 0, 0, 200, 200, 0, 0, hInstance, 0);\n    if(!hwnd) return 0;\n\n    ShowWindow(hwnd, nCmdShow);\n    UpdateWindow(hwnd);\n\n    while(GetMessage(&amp;msg, 0, 0, 0) &gt; 0)\n    {\n        TranslateMessage(&amp;msg);\n        DispatchMessage(&amp;msg);\n    }\n\n    return (int)msg.wParam;\n}\n</code></pre>\n\n<p>Before right clicking on Test2</p>\n\n<p><a href=\"https://i.stack.imgur.com/dR08V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dR08V.png\" alt=\"enter image description here\"></a></p>\n\n<p>After right clicking on Test2</p>\n\n<p><a href=\"https://i.stack.imgur.com/7PZMc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7PZMc.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1464209135, "post_id": 37447251, "comment_id": 62396563, "body": "What is your question? Question&#39;s heading and body asks two separate things."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 4, "creation_date": 1464209204, "post_id": 37447251, "comment_id": 62396599, "body": "<code>&amp;sPtr[1]</code> is the same as <code>sPtr+1</code> so it does increment the pointer to point to the next letter."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1464209246, "post_id": 37447251, "comment_id": 62396615, "body": "You can&#39;t do <code>&amp;sPtr[i++]</code> because there&#39;s no variable <code>i</code>."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5075462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283fa736d02fc566de34ea2aeeda169d?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandru", "link": "https://stackoverflow.com/users/5075462/alexandru"}, "edited": false, "score": 0, "creation_date": 1464209884, "post_id": 37447353, "comment_id": 62396955, "body": "How does the &quot;reverse( &amp;sPtr[ 1 ] )&quot; moves to the next character. That&#39;s the main thing I just can&#39;t understand. To me that&#39;s just calling the address to the 2nd element."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 29, "user_id": 5075462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283fa736d02fc566de34ea2aeeda169d?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandru", "link": "https://stackoverflow.com/users/5075462/alexandru"}, "edited": false, "score": 0, "creation_date": 1464209972, "post_id": 37447353, "comment_id": 62396993, "body": "@Alexandru When you make the recursive call, the 1st element is the 2nd element from the caller, so now <code>&amp;sPtr[1]</code> is the 3rd element of the original string."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 29, "user_id": 5075462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283fa736d02fc566de34ea2aeeda169d?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandru", "link": "https://stackoverflow.com/users/5075462/alexandru"}, "edited": false, "score": 0, "creation_date": 1464210018, "post_id": 37447353, "comment_id": 62397019, "body": "@Alexandru And each time you recurse, it goes to the next character of the original string, until you get to the end."}, {"owner": {"reputation": 29, "user_id": 5075462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283fa736d02fc566de34ea2aeeda169d?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandru", "link": "https://stackoverflow.com/users/5075462/alexandru"}, "edited": false, "score": 1, "creation_date": 1464210218, "post_id": 37447353, "comment_id": 62397114, "body": "Thank you! I finally got it!"}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 7, "last_activity_date": 1464210030, "last_edit_date": 1464210030, "creation_date": 1464209329, "answer_id": 37447353, "question_id": 37447251, "link": "https://stackoverflow.com/questions/37447251/how-does-this-recursive-function-outputs-the-characters-in-reverse-order/37447353#37447353", "title": "How does this recursive function outputs the characters in reverse order?", "body": "<p>Notice that the putchar call is after the reverse call. Thus the reverse function will call itself, until it hits the null terminator and then the putchar calls will be called, in reverse order.</p>\n\n<p>Call stack in order:</p>\n\n<pre><code>reverse(\"word\")\n reverse(\"ord\")\n  reverse(\"rd\")\n   reverse(\"d\")\n    reverse(\"\")\n   putchar('d')\n  putchar('r')\n putchar('o')\nputchar('w')\n</code></pre>\n\n<hr>\n\n<p>Every time the code passes the string, it doesn't really pass the entire string, but only a pointer to it. So: <code>reverse( &amp;sPtr[1] )</code> is the same as <code>reverse( sPtr+1 )</code>, the code is simply passing a pointer to the string starting at the next character. </p>\n"}], "owner": {"reputation": 29, "user_id": 5075462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283fa736d02fc566de34ea2aeeda169d?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandru", "link": "https://stackoverflow.com/users/5075462/alexandru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1464303615, "accepted_answer_id": 37447353, "answer_count": 1, "score": 0, "last_activity_date": 1464210030, "creation_date": 1464208965, "question_id": 37447251, "link": "https://stackoverflow.com/questions/37447251/how-does-this-recursive-function-outputs-the-characters-in-reverse-order", "closed_reason": "Needs details or clarity", "title": "How does this recursive function outputs the characters in reverse order?", "body": "<p>I know that the recursion step should simplify the expression but in this case I can't see how it does it. Shouldn't it increment the \"&amp;sPtr[1]\" by using \"&amp;sPtr[i++]\" and doing the proper modifications until it gets to the base case?  </p>\n\n<pre><code>// recursively outputs characters in string in reverse order\n void reverse( const char * const sPtr )\n {\n    // if end of the string\n    if ( '\\0' == sPtr[ 0 ] ) { // base case\n       return;\n    } // end if\n    else { // if not end of the string\n      reverse(&amp;sPtr[1]);// recursion step\n      putchar( sPtr[ 0 ] ); // use putchar to display character\n\n    } // end else\n } // end function reverse\n</code></pre>\n"}, {"tags": ["c", "pointers", "malloc", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 3, "creation_date": 1464208882, "post_id": 37447198, "comment_id": 62396434, "body": "<b>A pointer is not an array</b>."}, {"owner": {"reputation": 339, "user_id": 4929696, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/01df2d381ab35cddeee0dcdf617d422e?s=128&d=identicon&r=PG&f=1", "display_name": "Surya Teja Vemparala", "link": "https://stackoverflow.com/users/4929696/surya-teja-vemparala"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1464208957, "post_id": 37447198, "comment_id": 62396483, "body": "A pointer is not an array. I got that. But is there any way that I can know how much bytes is allocated to b?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1464208989, "post_id": 37447198, "comment_id": 62396500, "body": "It prints a size of the pointer itself. (Which is 4 bytes, 32 bits. Are you sure about 64-bit compiler?) There is no (portable and standard) way to get a size of heap-allocated block once it got allocated."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1464209017, "post_id": 37447198, "comment_id": 62396521, "body": "Btw, don&#39;t cast the result of <code>malloc()</code> in C, it&#39;s only needed in C++."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1464209170, "post_id": 37447198, "comment_id": 62396581, "body": "You all ready know the size."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464209805, "post_id": 37447198, "comment_id": 62396912, "body": "The pointer does not point to an array, but the the first element. Something like <code>int (*)[length]</code> is a pointer to an array."}], "answers": [{"tags": [], "owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "is_accepted": false, "score": 0, "last_activity_date": 1464209423, "last_edit_date": 1464209423, "creation_date": 1464209204, "answer_id": 37447318, "question_id": 37447198, "link": "https://stackoverflow.com/questions/37447198/dynamically-allocated-variable-size/37447318#37447318", "title": "dynamically allocated variable size", "body": "<p>No; it should be the same as <code>printf(\"%zu\", sizeof(int *));</code>, which on your implementation is 4, no matter what value you assign to <code>b</code>, since <code>b</code> has type <code>int *</code>, not <code>int [10]</code>.</p>\n"}], "owner": {"reputation": 339, "user_id": 4929696, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/01df2d381ab35cddeee0dcdf617d422e?s=128&d=identicon&r=PG&f=1", "display_name": "Surya Teja Vemparala", "link": "https://stackoverflow.com/users/4929696/surya-teja-vemparala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "closed_date": 1464209271, "answer_count": 1, "score": 0, "last_activity_date": 1464209423, "creation_date": 1464208758, "question_id": 37447198, "link": "https://stackoverflow.com/questions/37447198/dynamically-allocated-variable-size", "closed_reason": "Duplicate", "title": "dynamically allocated variable size", "body": "<p>When I run this program, output is 4 bytes. ( I use a 64 bit compiler)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    int *b;\n    b=(int*)malloc(10*sizeof(int));\n    printf(\"%d\",sizeof(b));\n    return 0;\n}\n</code></pre>\n\n<p>But shouldn't the output be 40 bytes as I am dynamically allocating 40 bytes of space for 'b'?</p>\n"}, {"tags": ["c++", "c", "pointers", "iar"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464207730, "post_id": 37446831, "comment_id": 62395791, "body": "It&#39;s an assembly of random chunks of information. Insufficient not only for answering, but even for understanding what was asked."}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464207916, "post_id": 37446831, "comment_id": 62395897, "body": "Seems clear to me. You have a prototype of my function, you can see how I reference the pointer as I pass it in. You have the actual call to the function. And you have the actual line in the function where the error happened along with the actual error."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464207955, "post_id": 37446831, "comment_id": 62395923, "body": "Just FYI - there are 3 close votes as unclear at the moment."}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "edited": false, "score": 0, "creation_date": 1464208134, "post_id": 37446831, "comment_id": 62396023, "body": "Worth a shot, thanks for the help!"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1464214801, "post_id": 37446831, "comment_id": 62398965, "body": "@lusher00 it would be better to tag according to which language you are using; C and C++ are different"}, {"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 0, "creation_date": 1464220289, "post_id": 37446831, "comment_id": 62400507, "body": "bus errors are caused by alignment problems"}], "answers": [{"comments": [{"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "edited": false, "score": 0, "creation_date": 1464208520, "post_id": 37447058, "comment_id": 62396231, "body": "Yup, that&#39;s it. I forgot all about that. Thank you."}], "tags": [], "owner": {"reputation": 1161, "user_id": 1849769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd80cd843b2791a1312106d13d4fc10?s=128&d=identicon&r=PG", "display_name": "Pezo", "link": "https://stackoverflow.com/users/1849769/pezo"}, "is_accepted": true, "score": 5, "last_activity_date": 1464220222, "last_edit_date": 1464220222, "creation_date": 1464208240, "answer_id": 37447058, "question_id": 37446831, "link": "https://stackoverflow.com/questions/37446831/pointers-in-the-iar-compiler/37447058#37447058", "title": "pointers in the IAR compiler", "body": "<p>It could be that your MCU needs reads of 32 bit integers to be aligned to 32 bits.</p>\n\n<p><code>&amp;packet[9]</code> is most certainly not 32 bit aligned, that's why you get a fault.</p>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 6, "last_activity_date": 1464214279, "creation_date": 1464214279, "answer_id": 37448503, "question_id": 37446831, "link": "https://stackoverflow.com/questions/37446831/pointers-in-the-iar-compiler/37448503#37448503", "title": "pointers in the IAR compiler", "body": "<p><code>&amp;packet[9]</code> is probably not aligned correctly for <code>uint32_t</code>.  Seeing \"Bus Error\" on an ARM CPU is often a sign of an alignment error. <a href=\"https://www.ibm.com/developerworks/library/pa-dalign/\" rel=\"noreferrer\">See here</a> for an explanation of alignment.</p>\n\n<p>On the second example it probably avoids the bus fault by optimizing out the <code>*</code> operation, since you never use the result.</p>\n\n<p>Note that even if you fix this, the code still causes undefined behaviour by violating the strict aliasing rule.  (<code>uint8_t</code> may not be aliased as <code>uint32_t</code>).  Some compilers may appear to \"work correctly\" for now but the code could break at any time in future.</p>\n\n<p>The safe equivalent of your code would be:</p>\n\n<pre><code>uint8_t *src = &amp;packet[9];\nuint32_t var;\nmemcpy(&amp;var, src, sizeof var);\nsrc += sizeof var;\n</code></pre>\n\n<p>Note that if the source data is specified as having a particular byte order for integer (e.g. you are getting it from network stream as opposed to data you saved earlier by the same method) then you will want to use a method to read the data that is independent of the  representation of <code>uint32_t</code>.  (In other words, \"endianness\").</p>\n"}], "owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "closed_date": 1464303572, "accepted_answer_id": 37447058, "answer_count": 2, "score": 3, "last_activity_date": 1464220222, "creation_date": 1464207399, "last_edit_date": 1464208443, "question_id": 37446831, "link": "https://stackoverflow.com/questions/37446831/pointers-in-the-iar-compiler", "closed_reason": "Needs details or clarity", "title": "pointers in the IAR compiler", "body": "<p>Long story short I have this in C using the IAR EWARM compiler.</p>\n\n<pre><code>uint8_t packet[2048];\nuint32_t* src = (uint32_t*)&amp;packet[9];\nuint32_t var = *src++;\n</code></pre>\n\n<p>That last line causes a bus fault.</p>\n\n<pre><code>uint8_t packet[2048];\nuint32_t* src = (uint32_t*)&amp;packet[9];\nuint32_t var = 0xFE;\n*src++;\n</code></pre>\n\n<p>Now there is no bus fault. I can see in the debugger src points to the data I expect it to point to. Increment it works as expected but trying to read it casues a bus fault.</p>\n\n<p>Any help?</p>\n"}, {"tags": ["c", "linux", "memory", "memory-management", "kernel"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464207365, "post_id": 37446759, "comment_id": 62395592, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10509850/how-to-access-user-space-memory-from-the-linux-kernel\">How to access user space memory from the Linux kernel?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": true, "score": 1, "last_activity_date": 1464263095, "creation_date": 1464263095, "answer_id": 37459962, "question_id": 37446759, "link": "https://stackoverflow.com/questions/37446759/save-memory-by-using-user-space-buffer-of-write-function-in-function-handler-dir/37459962#37459962", "title": "Save memory by using user space buffer of write function in function-handler directly (Linux, Kernel)?", "body": "<p>User space memory shouldn't be used directly in any case.</p>\n\n<p>If your task can be expressed as a <em>stream processing</em> of user data, there is no need to allocate kernel memory for accomodate whole user data <em>at once</em>.</p>\n\n<p>It is sufficient to allocate memory of smaller size (e.g., 4KB), read the first chunk of user data into it (using <code>copy_from_user</code>), process it, read next chunk into same kernel memory, process it and so on:</p>\n\n<pre><code>void* dest = kmalloc(4096, GFP_KERNEL); // or use __get_free_pages()\nwhile(count &gt; 0)\n{\n    int size = count &gt;= 4096? 4096: count;\n    copy_from_user(dest, buffer, size);\n    &lt;process-data-in-dest&gt;\n    count -= size;\n    buffer += size;\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4677551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e1788d10d26944d0e353039c69253a?s=128&d=identicon&r=PG&f=1", "display_name": "tofi", "link": "https://stackoverflow.com/users/4677551/tofi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 1, "accepted_answer_id": 37459962, "answer_count": 1, "score": 2, "last_activity_date": 1464263095, "creation_date": 1464207162, "question_id": 37446759, "link": "https://stackoverflow.com/questions/37446759/save-memory-by-using-user-space-buffer-of-write-function-in-function-handler-dir", "title": "Save memory by using user space buffer of write function in function-handler directly (Linux, Kernel)?", "body": "<p>I have a Linux filesystem with an implementation of the function:</p>\n\n<pre><code> ssize_t (*write) (struct file *file, const char __user *buffer, size_t count, loff_t *pos);\n</code></pre>\n\n<p>Now let's say I want to use the data of the buffer to calculate parity (within the function handling).\nI could use </p>\n\n<pre><code>copy_from_user(void *to, const void __user *from, unsigned long n)\n</code></pre>\n\n<p>But the problem is that I need to allocate memory for my kernel space pointer first. The amount of data I want to copy is max. about 7.5 MB and min. 512KB. If i use <code>kmalloc</code> to allocate memory in kernel it likely fails and I can't even allocate enough memory in front with a memory pool, because somehow that fails, too...</p>\n\n<p>So: what could happen if I just use the pointer from user space in my code?</p>\n\n<pre><code>...\n     *(dest) ^= *(buf);\n...\n</code></pre>\n\n<p>So far it seems to work (for smaller memory regions though).\nI don't know how the memory mapping works. Could the user space memory be not contiguous? Could it even be swapped out? Whats the danger? Thx!</p>\n"}, {"tags": ["c", "linked-list", "stack", "postfix-notation"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464206473, "post_id": 37446440, "comment_id": 62395140, "body": "<code>(*newNode).data</code> is syntax-sugared with <code>newNode-&gt;data</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1464206536, "post_id": 37446440, "comment_id": 62395173, "body": "<code>*remove = (*top).data;</code> BZZZ! dereferencing an invalid pointer (<code>remove</code>)."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1464207484, "post_id": 37446440, "comment_id": 62395664, "body": "Should be <code>int result=0;</code> <code>result = top-&gt;data;</code> and <code>return result;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 296, "user_id": 3960301, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/aa1246204a46eb759c13f343f23fd474?s=128&d=identicon&r=PG&f=1", "display_name": "Raghib Ahsan", "link": "https://stackoverflow.com/users/3960301/raghib-ahsan"}, "is_accepted": false, "score": 0, "last_activity_date": 1464216200, "last_edit_date": 1464216200, "creation_date": 1464215889, "answer_id": 37448791, "question_id": 37446440, "link": "https://stackoverflow.com/questions/37446440/segmentation-fault-with-a-linked-stack-trying-to-evaluate-postfix-expressions/37448791#37448791", "title": "Segmentation fault with a linked stack trying to evaluate postfix expressions", "body": "<p>I have fully undestood your error the error in value is attributed to many factors </p>\n\n<blockquote>\n  <ol>\n  <li><p>pointed out by @Eugene Sh. <code>int remove</code> change it data type to integer </p></li>\n  <li><p>the loop you are iterating is twice the size of expression since you are using constant literal you should use <code>for (int i = 0; i &lt; strlen(exp)-1; i++)</code> subtracting <code>1</code> because of <code>\\0</code> </p></li>\n  <li><p>what you are doing here is </p></li>\n  </ol>\n</blockquote>\n\n<pre><code>   if (isdigit(exp[i])) {\n    push(exp[i]);\n} else {\n    int val1 = pop();\n    int val2 = pop();\n</code></pre>\n\n<p>since <code>34+</code> be an expression then you checked using <code>isdigit(exp[i])</code></p>\n\n<blockquote>\n  <p><strong>isdigit(exp[i])</strong> only check the passed character is a decimal digit character.</p>\n</blockquote>\n\n<p>subtract <code>(exp[i])</code> with <code>48</code> ascii value of <code>0</code> to convert decimal ascii character to integer</p>\n\n<p>modify your code like this</p>\n\n<blockquote>\n  <ol>\n  <li></li>\n  </ol>\n</blockquote>\n\n<pre><code> int pop() {\nstruct node *temp = top;\nint removed;\n//use isEmpty if can\nif (top != NULL) {\n    removed = (*top).data;\n    top = (*top).next;\n    free(temp);\n }\n return removed;\n}\n</code></pre>\n\n<blockquote>\n  <p>2&amp;3.</p>\n</blockquote>\n\n<pre><code>for (int i = 0; i &lt; strlen(exp)-1; i++) {\n  if (isdigit(exp[i])) {\n    push(exp[i]-48);\n} else {\n    int val1 = pop();\n    int val2 = pop();\nprintf(\"val1%d\\n\",val1);\nprintf(\"val2%d\\n\",val2);\n</code></pre>\n\n<p>your working code\n    <a href=\"http://ideone.com/z58Phy\" rel=\"nofollow\">http://ideone.com/z58Phy</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6383031"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464216200, "creation_date": 1464206003, "question_id": 37446440, "link": "https://stackoverflow.com/questions/37446440/segmentation-fault-with-a-linked-stack-trying-to-evaluate-postfix-expressions", "title": "Segmentation fault with a linked stack trying to evaluate postfix expressions", "body": "<p>I am attempting to implement a linked stack to evaluate post fix expressions however I keep getting a segmentation fault and not sure how to go about fixing it. I'm new to c programming which is different from OOD so any advice is welcomed. Thank you &amp; please excuse my comments and spacing.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct node {\nint data;\nstruct node *next;\n};\n struct node *top = NULL;\n\n\nvoid push(int data);\nint pop();\nint evaluatePostfix(char* exp);\n\nvoid main() {\n     char postfixExp[256];\n\n     printf(\"What is your Postfix Expression? : \\n\");\n\n     fgets(postfixExp, sizeof(postfixExp), stdin);\n     printf(\"%d\\n\", evaluatePostfix(postfixExp));\n}\n\n//done\nvoid push(int data) {\n     struct node *newNode;\n     newNode = (struct node*)malloc(sizeof(struct node));;\n     (*newNode).data = data;\n     (*newNode).next = NULL;\n     //use isEmpty if can\n     if (top != NULL) {\n         (*newNode).next = top;\n     }\n     top = newNode;\n}\n//done\nint pop() {\n    struct node *temp = top;\n    int *remove;\n    //use isEmpty if can\n    if (top != NULL) {\n        *remove = (*top).data;\n        top = (*top).next;\n        free(temp);\n    }\nreturn *remove;\n\n}\n\n int evaluatePostfix(char* exp) {\n     struct node *top = NULL;\n     for (int i = 0; i &lt; sizeof(exp); i++) {\n      if (isdigit(exp[i])) {\n        push(exp[i]);\n    } else {\n        int val1 = pop();\n        int val2 = pop();\n        switch(exp[i]) {\n            case '+':\n                push(val2+val1);\n                break;\n            case '-':\n                push(val2-val1);\n                break;\n            case '*':\n                push(val2*val1);\n                break;\n            case '/':\n                push(val2/val1);\n                break;\n        }\n    }\n}\nreturn pop();\n\n}\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 1, "user_id": 6368022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bc24fbfae27bcf034bf891973c541b?s=128&d=identicon&r=PG&f=1", "display_name": "Mrprintf", "link": "https://stackoverflow.com/users/6368022/mrprintf"}, "edited": false, "score": 0, "creation_date": 1464208550, "post_id": 37446441, "comment_id": 62396244, "body": "@Mrprintf: Yes. Read the last sentence of my answer."}, {"owner": {"reputation": 1, "user_id": 6368022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bc24fbfae27bcf034bf891973c541b?s=128&d=identicon&r=PG&f=1", "display_name": "Mrprintf", "link": "https://stackoverflow.com/users/6368022/mrprintf"}, "edited": false, "score": 0, "creation_date": 1464209833, "post_id": 37446441, "comment_id": 62396929, "body": "I can understand your sentence but what should i do. Can you explain it? My english is not very good so please explain simple."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 1, "user_id": 6368022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bc24fbfae27bcf034bf891973c541b?s=128&d=identicon&r=PG&f=1", "display_name": "Mrprintf", "link": "https://stackoverflow.com/users/6368022/mrprintf"}, "edited": false, "score": 0, "creation_date": 1464210150, "post_id": 37446441, "comment_id": 62397076, "body": "The <code>asd</code> function you have defined takes no parameters. The thread required a pointer to a function that accepts a <code>void*</code> parameter. So it doesn&#39;t match, and the compiler is telling you so. I&#39;ve added a modified <code>asd</code> to my answer."}, {"owner": {"reputation": 1, "user_id": 6368022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bc24fbfae27bcf034bf891973c541b?s=128&d=identicon&r=PG&f=1", "display_name": "Mrprintf", "link": "https://stackoverflow.com/users/6368022/mrprintf"}, "edited": false, "score": 0, "creation_date": 1464211454, "post_id": 37446441, "comment_id": 62397605, "body": "Thank you so much.. I search thread on windows about 1 week and solved problem. Thanks again."}, {"owner": {"reputation": 1, "user_id": 6368022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bc24fbfae27bcf034bf891973c541b?s=128&d=identicon&r=PG&f=1", "display_name": "Mrprintf", "link": "https://stackoverflow.com/users/6368022/mrprintf"}, "edited": false, "score": 0, "creation_date": 1464258517, "post_id": 37446441, "comment_id": 62415855, "body": "Now I want to play 2 music same time I read same function in main but only 1 is played. How can do it?"}], "tags": [], "owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "is_accepted": false, "score": 2, "last_activity_date": 1464210057, "last_edit_date": 1464210057, "creation_date": 1464206003, "answer_id": 37446441, "question_id": 37446215, "link": "https://stackoverflow.com/questions/37446215/thread-for-background-music/37446441#37446441", "title": "Thread for Background Music", "body": "<p>You're calling <code>asd</code> instead of passing its address. Since the function has a <code>void</code> return, you are incorrectly passing <code>void</code> where a function pointer is expected. Remove the parentheses.</p>\n\n<pre><code>int main()\n{\n    _beginthread(asd, 333, (void*)NULL);\n}\n</code></pre>\n\n<p>And the function <code>asd</code> must accept a void pointer parameter as well.</p>\n\n<pre><code>void asd(void*)\n{\n    printf(\"hello\");\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6368022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bc24fbfae27bcf034bf891973c541b?s=128&d=identicon&r=PG&f=1", "display_name": "Mrprintf", "link": "https://stackoverflow.com/users/6368022/mrprintf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": -7, "last_activity_date": 1464211555, "creation_date": 1464205211, "last_edit_date": 1464211555, "question_id": 37446215, "link": "https://stackoverflow.com/questions/37446215/thread-for-background-music", "title": "Thread for Background Music", "body": "<p>I have a homework assignment. I am supposed to make a calculator and add background music. I use Dev-C++ and C on windows.\n I need a thread when I want to use music and calculator. I am going to use <code>process.h</code> for thread. I tried using <code>_beginthread</code> but it raised an error.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;process.h&gt;\n\nvoid asd()\n{\n    printf(\"hello\");\n}\n\nint main()\n{\n    _beginthread(asd(),333,(void*)NULL);    _endthread();\n}\n</code></pre>\n\n<p>and error is </p>\n\n<pre><code>[invalid use of void expression]\n</code></pre>\n\n<p>How can I do this assignment? </p>\n"}, {"tags": ["c", "gcc", "macros"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464203899, "post_id": 37445800, "comment_id": 62393798, "body": "Can a static function be declared inside another function at all?"}, {"owner": {"reputation": 1050, "user_id": 2792852, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/JubJq.gif?s=128&g=1", "display_name": "feos", "link": "https://stackoverflow.com/users/2792852/feos"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464203954, "post_id": 37445800, "comment_id": 62393823, "body": "I don&#39;t know the exact way, but people say it can <a href=\"http://stackoverflow.com/a/11706921/2792852\">stackoverflow.com/a/11706921/2792852</a>"}, {"owner": {"reputation": 1050, "user_id": 2792852, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/JubJq.gif?s=128&g=1", "display_name": "feos", "link": "https://stackoverflow.com/users/2792852/feos"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464204081, "post_id": 37445800, "comment_id": 62393918, "body": "The code isn&#39;t mine unfortunately. I could try just removing <code>static</code>, but I don&#39;t want to see it go mad if it breaks something."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464204170, "post_id": 37445800, "comment_id": 62393974, "body": "Just move the last line of the first macro before the <code>x</code> function, and get rid of it inside the function. I mean, make the prototype global."}, {"owner": {"reputation": 1050, "user_id": 2792852, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/JubJq.gif?s=128&g=1", "display_name": "feos", "link": "https://stackoverflow.com/users/2792852/feos"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464204472, "post_id": 37445800, "comment_id": 62394152, "body": "For the reference, removing <code>static</code> did compile, but I don&#39;t know how dangerous it might be. As for making it global, @eugene-sh can you please post your idea as an answer?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464209253, "post_id": 37445800, "comment_id": 62396622, "body": "It still would have internal linkage, i.e. be only compilation-unit local. Anyway this looks like obfuscated code and will be pretty hard to maintain&amp;debug."}], "answers": [{"comments": [{"owner": {"reputation": 1050, "user_id": 2792852, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/JubJq.gif?s=128&g=1", "display_name": "feos", "link": "https://stackoverflow.com/users/2792852/feos"}, "edited": false, "score": 0, "creation_date": 1464204749, "post_id": 37446045, "comment_id": 62394298, "body": "I still wonder how it compiled with cl (and for the author of that code)."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 2, "creation_date": 1464204992, "post_id": 37446045, "comment_id": 62394429, "body": "&quot;You can&#39;t declare a function inside of another one&quot;. Er... Yes, you can, of course. Why not? It is just that <code>static</code> function declaration is not allowed."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 7, "last_activity_date": 1464205077, "last_edit_date": 1464205077, "creation_date": 1464204620, "answer_id": 37446045, "question_id": 37445800, "link": "https://stackoverflow.com/questions/37445800/invalid-storage-class-for-a-function-in-a-macro-in-gcc/37446045#37446045", "title": "Invalid storage class for a function in a macro in GCC", "body": "<p>You can't declare a static function inside of another one.  You need to put the declaration outside of <code>void(x)</code>:</p>\n\n<pre><code>#define ASYNC_FUNCTION(x)                                               \\\nstatic void internal ## x (ASYNCIOCB *);                                \\\nvoid x(void) {                                                          \\\n    ASYNCIOCB *aiocb = AcquireAsyncIOCB();                              \\\n    CallAsyncNativeFunction_md(aiocb, internal ## x);                   \\\n}                                                                       \\\nstatic void internal ## x (ASYNCIOCB *aiocb)\n</code></pre>\n\n<p>Then, if you run the source through just the preprocessor via <code>gcc -E</code>, you'll get something like this (extra spacing added):</p>\n\n<pre><code>static void internalOccasional_function_name (ASYNCIOCB *);\nvoid Occasional_function_name(void)\n{\n    ASYNCIOCB *aiocb = AcquireAsyncIOCB();\n    CallAsyncNativeFunction_md(aiocb, internalOccasional_function_name);\n}\nstatic void internalOccasional_function_name (ASYNCIOCB *aiocb) \n{\n    {\n        int a=1;\n    }\n    ASYNC_resumeThread();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 808, "user_id": 5172114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-eqH2vTpGwmQ/AAAAAAAAAAI/AAAAAAAABe8/4XDha6fFlGw/photo.jpg?sz=128", "display_name": "Error", "link": "https://stackoverflow.com/users/5172114/error"}, "edited": false, "score": 0, "creation_date": 1500503706, "post_id": 37446178, "comment_id": 77371344, "body": "*hint, some kernel implementations violates standard (written before standard i guess) i.e static__exittest() in macro module_exit(exit) in module.h"}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 1, "last_activity_date": 1464205083, "creation_date": 1464205083, "answer_id": 37446178, "question_id": 37445800, "link": "https://stackoverflow.com/questions/37445800/invalid-storage-class-for-a-function-in-a-macro-in-gcc/37446178#37446178", "title": "Invalid storage class for a function in a macro in GCC", "body": "<p>In C language local function declarations can optionally include storage class specifier <code>extern</code>. That's the only storage class specifier a local function declaration may have. No other storage class specifiers are allowed.</p>\n\n<p>6.7.1/7:</p>\n\n<blockquote>\n  <p>The declaration of an identifier for a function that has block scope shall have no explicit storage-class specifier other than <strong>extern</strong>.</p>\n</blockquote>\n"}], "owner": {"reputation": 1050, "user_id": 2792852, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/JubJq.gif?s=128&g=1", "display_name": "feos", "link": "https://stackoverflow.com/users/2792852/feos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46109, "favorite_count": 0, "accepted_answer_id": 37446045, "answer_count": 2, "score": 2, "last_activity_date": 1506970093, "creation_date": 1464203743, "last_edit_date": 1506970093, "question_id": 37445800, "link": "https://stackoverflow.com/questions/37445800/invalid-storage-class-for-a-function-in-a-macro-in-gcc", "title": "Invalid storage class for a function in a macro in GCC", "body": "<p>I have this legacy macro</p>\n\n<pre><code>#define ASYNC_FUNCTION(x)                                               \\\nvoid x(void) {                                                          \\\n    static void internal ## x (ASYNCIOCB *);                            \\\n    ASYNCIOCB *aiocb = AcquireAsyncIOCB();                              \\\n    CallAsyncNativeFunction_md(aiocb, internal ## x);                   \\\n}                                                                       \\\nstatic void internal ## x (ASYNCIOCB *aiocb)\n</code></pre>\n\n<p>followed by this one</p>\n\n<pre><code>#define ASYNC_FUNCTION_START(x)  ASYNC_FUNCTION(x) {\n#define ASYNC_FUNCTION_END       ASYNC_resumeThread(); }\n</code></pre>\n\n<p>And their use looks like this:</p>\n\n<pre><code>ASYNC_FUNCTION_START(Occasional_function_name)\n{\n    //actual stuff    \n}\nASYNC_FUNCTION_END\n</code></pre>\n\n<p>It compiles fine with cl, but gcc gives</p>\n\n<pre><code>invalid storage class for function \u2018internalOccasional_function_name\u2019\n     static void internal##x (ASYNCIOCB *);    \n                 ^\n</code></pre>\n\n<p>I tried to expand them all just to see what it becomes and found nothing broken. I also searched for unclosed curved brackets in the file, and found other macros like this</p>\n\n<pre><code>#define Foo_Bar1()  {                                                \\\n  extern int foo;                                                    \\\n  int bar = foo;                                                     \\\n  if (condition) {                                                   \\\n    Bar_Foo();                                                       \\\n  }                                                                  \\\n\n#define Foo_Bar2()                                                   \\\n  if (condibar != footion1){                                         \\\n    AbortAsyncIOCB(aiocb);                                           \\\n    return;                                                          \\\n  }                                                                  \\\n  if (condition) {                                                   \\\n    Bar_Foo();                                                       \\\n  }                                                                  \\\n}\n</code></pre>\n\n<p>No other headers are included, so other than that last macro looking weird, I couldn't find any obvious errors. I'm using cygwin and I'm fairly clueless.</p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 11, "creation_date": 1464199855, "post_id": 37444691, "comment_id": 62391572, "body": "Remove the ampersand."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464200104, "post_id": 37444691, "comment_id": 62391701, "body": "After that, print the announcement before the loop, and just the number within the loop. Then simplify further by using a single variable <code>i</code>. Replace <code>x</code> with <code>i</code> and remove <code>x++</code>"}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 2, "creation_date": 1464200180, "post_id": 37444691, "comment_id": 62391756, "body": "Did you enable all compiler warnings? Did you read them? You should see a warning like <code>format specifies type &#39;int&#39; but the argument has type &#39;int *&#39;</code>."}, {"owner": {"reputation": 21, "user_id": 6311430, "user_type": "registered", "profile_image": "https://graph.facebook.com/1051369371604693/picture?type=large", "display_name": "Preciosa Ni&#241;a", "link": "https://stackoverflow.com/users/6311430/preciosa-ni%c3%b1a"}, "edited": false, "score": 0, "creation_date": 1464200802, "post_id": 37444691, "comment_id": 62392090, "body": "SORRY! I know there shouldn&#39;t be an ampersand there! It was a typing mistake. It&#39;s working now! :) :)"}, {"owner": {"reputation": 21, "user_id": 6311430, "user_type": "registered", "profile_image": "https://graph.facebook.com/1051369371604693/picture?type=large", "display_name": "Preciosa Ni&#241;a", "link": "https://stackoverflow.com/users/6311430/preciosa-ni%c3%b1a"}, "edited": false, "score": 0, "creation_date": 1464200979, "post_id": 37444691, "comment_id": 62392187, "body": "what if I put i=0 inside the for loop instead of i=1?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1464201168, "post_id": 37444691, "comment_id": 62392298, "body": "Rolled back. Don&#39;t edit your question leaving answers without context."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464201737, "post_id": 37444691, "comment_id": 62392618, "body": "Although removing the <code>&amp;</code> fixes a problem, the real issues is that your compiler did not warn you about this.  Save time.  Insure all warnings are enabled."}], "answers": [{"tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": false, "score": 1, "last_activity_date": 1464200197, "creation_date": 1464200197, "answer_id": 37444795, "question_id": 37444691, "link": "https://stackoverflow.com/questions/37444691/can-anyone-help-me-with-this-c-program/37444795#37444795", "title": "Can anyone help me with this C program?", "body": "<p>In the line:</p>\n\n<pre><code>printf(\"the numbers are : %d\", &amp;x);\n</code></pre>\n\n<p><code>printf</code> is expecting an integer because of the <code>%d</code> format specifier, you have given it the address of an integer, thats what the <code>&amp;</code> means, address of <code>x</code>. To fix this give <code>printf</code> what it desires, an <code>int</code>:</p>\n\n<pre><code>printf(\"the numbers are : %d\", x);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 515, "user_id": 6183448, "user_type": "registered", "profile_image": "https://graph.facebook.com/1806456301/picture?type=large", "display_name": "Adrian Roman", "link": "https://stackoverflow.com/users/6183448/adrian-roman"}, "edited": false, "score": 1, "creation_date": 1464200287, "post_id": 37444797, "comment_id": 62391817, "body": "You should edit that and change the second x to i, too."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 1, "creation_date": 1464202491, "post_id": 37444797, "comment_id": 62393062, "body": "<code>printf(&quot;%d&quot;, i);</code> The output from this in a loop will be pretty unreadable. You either need a newline or some space between numbers."}], "tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": false, "score": 1, "last_activity_date": 1464202941, "last_edit_date": 1464202941, "creation_date": 1464200203, "answer_id": 37444797, "question_id": 37444691, "link": "https://stackoverflow.com/questions/37444691/can-anyone-help-me-with-this-c-program/37444797#37444797", "title": "Can anyone help me with this C program?", "body": "<p>The ampersand (<code>&amp;</code>) operator returns the <em>address</em> of a variable, which isn't what you want - you just want the value. Also, note that you don't need two variables (<code>x</code> and <code>i</code>) - you can just use the loop's counter:</p>\n\n<pre><code>printf(\"The numbers are:\\n\");\nfor (i = 1; i &lt;= 100; i++) {\n    if (i % 5 == 0 || i % 3 == 0) {\n        printf(\"%d \", i);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1464202574, "post_id": 37444941, "comment_id": 62393113, "body": "Just curious - how does your answer improve the other, identical, answers?"}], "tags": [], "owner": {"reputation": 1, "user_id": 6381897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a7a92f12c30a75117a33a60b73427e?s=128&d=identicon&r=PG&f=1", "display_name": "JP Dunn", "link": "https://stackoverflow.com/users/6381897/jp-dunn"}, "is_accepted": false, "score": 0, "last_activity_date": 1464200679, "creation_date": 1464200679, "answer_id": 37444941, "question_id": 37444691, "link": "https://stackoverflow.com/questions/37444691/can-anyone-help-me-with-this-c-program/37444941#37444941", "title": "Can anyone help me with this C program?", "body": "<p>Removing the &amp; will eliminate the error. You may also want to move the \"the numbers are:\" statement outisde of the loop so the text does not print each time through the loop.</p>\n"}], "owner": {"reputation": 21, "user_id": 6311430, "user_type": "registered", "profile_image": "https://graph.facebook.com/1051369371604693/picture?type=large", "display_name": "Preciosa Ni&#241;a", "link": "https://stackoverflow.com/users/6311430/preciosa-ni%c3%b1a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1464204687, "creation_date": 1464199819, "last_edit_date": 1464204687, "question_id": 37444691, "link": "https://stackoverflow.com/questions/37444691/can-anyone-help-me-with-this-c-program", "title": "Can anyone help me with this C program?", "body": "<p>I've just started to learn coding</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int i=0, x=0;\n\n    for (i=1; i&lt;=100; i++) {\n\n        x++;\n        if (x%5==0 || x%3==0)\n            printf(\"The numbers are : %d\\n\", &amp;x);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>so I'm trying to print all the integers &lt;=100 that are divisible by either 3 or 5. </p>\n"}, {"tags": ["c", "stat", "time.h"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464198710, "post_id": 37444142, "comment_id": 62390901, "body": "Rather than describe the error message &quot;the field tv_sec could not be resolved.&quot;, post the error message."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464198806, "post_id": 37444142, "comment_id": 62390955, "body": "Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> which shows the error."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464198884, "post_id": 37444142, "comment_id": 62391010, "body": "Is this on a recent Linux distro, or something else?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1464198953, "post_id": 37444142, "comment_id": 62391056, "body": "It could have been fair to extract interesting part of your code to provide an MCVE."}], "answers": [{"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 1, "last_activity_date": 1464198740, "creation_date": 1464198740, "answer_id": 37444396, "question_id": 37444142, "link": "https://stackoverflow.com/questions/37444142/the-field-tv-sec-could-not-be-resolved/37444396#37444396", "title": "The field tv_sec could not be resolved", "body": "<p><code>buf</code> has <code>struct stat</code> type in which there exists a <code>st_mtime</code> field of type <code>time_t</code>. <code>time_t</code> is usually defined as an arithmetic type not a structured one, it has then no field.</p>\n"}], "owner": {"reputation": 27, "user_id": 3403740, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e36fced9bb979d7b799370888bd7331e?s=128&d=identicon&r=PG&f=1", "display_name": "globus1988", "link": "https://stackoverflow.com/users/3403740/globus1988"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464198740, "creation_date": 1464197884, "question_id": 37444142, "link": "https://stackoverflow.com/questions/37444142/the-field-tv-sec-could-not-be-resolved", "title": "The field tv_sec could not be resolved", "body": "<p>I am trying to run the following code (a simple backup program), but from some reason, the field tv_sec could not be resolved.\nI tried everything that crossed my mind - but no help.\nI want to emphasize that I have read the other relevant questions in this site and also tried to add the line:</p>\n\n<pre><code>#include &lt;sys/time.h&gt;\n</code></pre>\n\n<p>but - again - it didn't work.</p>\n\n<p>Can you help me? </p>\n\n<p>Thank you all!</p>\n\n<p>I decided to attach the whole program, at any cas - in order to allow you to see the whole picture, if needed. \nThe code (the problematic line is under the note //&lt;>//): </p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;string.h&gt;\n    #include &lt;sys/types.h&gt;\n    #include &lt;sys/stat.h&gt;\n    #include &lt;unistd.h&gt;\n    #include &lt;fcntl.h&gt;\n    #include &lt;utime.h&gt;\n    #include &lt;dirent.h&gt;\n    #include &lt;libgen.h&gt;\n\n    #define MIN(X,Y) ((X) &lt; (Y) ? (X) : (Y))\n\n    // The header of each backed-up file\n    typedef struct {\n        char name[100];\n        char mode[8];\n        char uid[8];\n        char gid[8];\n        char size[12];\n        char mtime[12];\n        char typeflag;\n    } bkp_header;\n\n    // Function declarations\n    int backup(char *src, char *dest);\n    int restore(char *src);\n    int backup_abstract(char *src, int out_file);\n    int backup_file(char *name, struct stat buf, int out_file);\n    int backup_dir(char *name, struct stat buf, int out_file);\n    int backup_symlink(char *name, struct stat buf, int out_file);\n    int restore_file(bkp_header *file_header, int bkp_file);\n    int restore_dir(bkp_header *file_header, int bkp_file);\n    int restore_symlink(bkp_header *file_header, int bkp_file);\n    int restore_metadata(bkp_header *file_header);\n    bkp_header* get_file_header(char *name, struct stat buf, char type);\n    int write_header_to_file(char *name, struct stat buf, int out_file, char type);\n\n    char* backup_dir_name;\n\n    // Main\n    int main(int argc, char *argv[]) {\n        int result = 1;\n\n        if (argc &lt; 3) {\n            fprintf(stderr, \"Invalid parameters\\n\");\n        }\n        else {\n            // Backup\n            if (strncmp(argv[1], \"-c\", 2) == 0) {\n                if (argc &lt; 4) {\n                    fprintf(stderr, \"Please insert the path you want to backup\\n\");\n                }\n                else {\n                    result = backup(argv[3], argv[2]);\n                }\n            }\n            // Restore\n            else if (strncmp(argv[1], \"-x\", 2) == 0) {\n                result = restore(argv[2]);\n            }\n            else {\n                fprintf(stderr, \"Invalid operation\\n\");\n            }\n        }\n        exit(result);\n    }\n\n    // Takes a 'src' path and runs a backup to the 'dest' path\n    int backup(char *src, char *dest) {\n        // Create the backup file\n        int out_file = open(dest, O_TRUNC | O_CREAT | O_WRONLY);\n        if (out_file &lt; 0) {\n            fprintf(stdout, \"Failed opening file for writing.\");\n            return -1;\n        }\n\n        // Get the root backup directory\n        char *src_dup = strdup(src);\n        backup_dir_name = dirname(src_dup);\n\n        // Run the backup based on the type\n        int result = backup_abstract(src, out_file);\n        close(out_file);\n        return result;\n    }\n\n    // Backup something - a file, a folder or a symbolic link\n    int backup_abstract(char *src, int out_file) {\n        // Get the 'src' lstat\n        struct stat buf;\n        if (lstat(src, &amp;buf) &lt; 0) {\n            fprintf(stderr, \"lstat error\");\n            return -1;\n        }\n\n        if (S_ISDIR(buf.st_mode)) {\n            return backup_dir(src, buf, out_file);\n        }\n        else if (S_ISREG(buf.st_mode)) {\n            return backup_file(src, buf, out_file);\n        }\n        #ifdef  S_ISLNK\n        else if (S_ISLNK(buf.st_mode)) {\n            return backup_symlink(src, buf, out_file);\n        }\n        #endif\n        else {\n            fprintf(stderr, \"Can only backup a regular file, a directory, or a symlink\\n\");\n        }\n        return -1;\n    }\n\n    // Backup a single file\n    int backup_file(char *name, struct stat buf, int out_file) {\n        if (write_header_to_file(name, buf, out_file, 'r') &lt; 0) {\n            return -1;\n        }\n\n        // Copy the file right after the header in 8K chunks\n        int in_file = open(name, O_RDONLY);\n        if (in_file &lt; 0) {\n            fprintf(stdout, \"Failed opening file for reading.\");\n            return -1;\n        }\n        char read_buf[8192];\n        while (1) {\n            ssize_t result = read(in_file, read_buf, sizeof(read_buf));\n            if (result &lt; 0) {\n                fprintf(stdout, \"Failed reading from file.\");\n                return -1;\n            }\n            if (result == 0) {\n                break; /* EOF */\n            }\n            if (write(out_file, read_buf, (int)result) != (int)result) {\n                fprintf(stdout, \"Failed writing to file.\");\n                return -1;\n            }\n        }\n        close(in_file);\n        return 0;\n    }\n\n    // Backup a directory\n    int backup_dir(char *name, struct stat buf, int out_file) {\n        if (write_header_to_file(name, buf, out_file, 'd') &lt; 0) {\n            return -1;\n        }\n\n        // Backup the contents of this directory\n        DIR *dir;\n        struct dirent *ent;\n        if ((dir = opendir(name)) == NULL) {\n            fprintf(stdout, \"Failed opening directory for reading.\");\n            return -1;\n        }\n        while ((ent = readdir(dir)) != NULL) {\n            if (strcmp(ent-&gt;d_name, \".\") &amp;&amp; strcmp(ent-&gt;d_name, \"..\")) {\n                char full_path[100];\n                strcpy(full_path, name);\n                strcat(full_path, \"/\");\n                strcat(full_path, ent-&gt;d_name);\n\n                if (backup_abstract(full_path, out_file) != 0) {\n                    return -1;\n                }\n            }\n        }\n        closedir(dir);\n        return 0;\n    }\n\n    // Backup a symbolic link\n    int backup_symlink(char *name, struct stat buf, int out_file) {\n        if (write_header_to_file(name, buf, out_file, 'l') &lt; 0) {\n            return -1;\n        }\n\n        char *link_target = malloc(buf.st_size + 1);\n        if (link_target == NULL) {\n            fprintf(stdout, \"Failed allocating memory.\");\n            return -1;\n        }\n        ssize_t link = readlink(name, link_target, buf.st_size + 1);\n        if (link &lt; 0) {\n            fprintf(stderr, \"lstat error\");\n            return -1;\n        }\n        link_target[buf.st_size] = '\\0';\n        if (write(out_file, link_target, buf.st_size) != buf.st_size) {\n            fprintf(stdout, \"Failed writing to file.\");\n            return -1;\n        }\n        free(link_target);\n        return 0;\n    }\n\n    // Get the backup header for a file\n    bkp_header* get_file_header(char *name, struct stat buf, char type) {\n        bkp_header *file_header = (bkp_header*)malloc(sizeof(bkp_header));\n\n        int abs_path_start = strncmp(name, backup_dir_name, strlen(backup_dir_name));\n        if (abs_path_start != 0) {\n            fprintf(stdout, \"Warning: Failed converting backup path to relative.\");\n        }\n        else {\n            name = &amp;name[strlen(backup_dir_name)+1];\n        }\n\n        sprintf(file_header-&gt;name, name);\n        sprintf(file_header-&gt;mode, \"%d\", buf.st_mode);\n        sprintf(file_header-&gt;uid, \"%d\", buf.st_uid);\n        sprintf(file_header-&gt;gid, \"%d\", buf.st_gid);\n        sprintf(file_header-&gt;size, \"%d\", (int)buf.st_size);\n//&lt;&lt;PROBLEM!!!&gt;&gt;//\n        sprintf(file_header-&gt;mtime, \"%d\", (int)buf.st_mtim.tv_sec); \n        file_header-&gt;typeflag = type;\n\n        return file_header;\n    }\n\n    // Create and write the header to the output file\n    int write_header_to_file(char *name, struct stat buf, int out_file, char type) {\n        bkp_header *file_header = get_file_header(name, buf, type);\n        if (write(out_file, file_header, sizeof(bkp_header)) != sizeof(bkp_header)) {\n            fprintf(stdout, \"Failed writing to file.\");\n            return -1;\n        }\n        return 0;\n    }\n\n    // Takes a 'src' backup file path and extracts it to the current working dir\n    int restore(char *src) {\n        // Read the backup file\n        int bkp_file = open(src, O_RDONLY);\n        if (bkp_file &lt; 0) {\n            fprintf(stdout, \"Failed opening backup file for reading.\");\n            return -1;\n        }\n        while (1) {\n            // Read the header\n            char header_buf[sizeof(bkp_header)];\n            ssize_t h_result = read(bkp_file, header_buf, sizeof(header_buf));\n            if (h_result &lt; 0) {\n                fprintf(stdout, \"Failed reading from backup file.\");\n                return -1;\n            }\n            if (h_result == 0) {\n                break; /* EOF */\n            }\n            bkp_header *file_header = header_buf;\n\n            // Restore the file/dir/symbolic-link\n            if (file_header-&gt;typeflag == 'r') {\n                if (restore_file(file_header, bkp_file) &lt; 0) {\n                    return -1;\n                }\n            }\n            else if (file_header-&gt;typeflag == 'd') {\n                if (restore_dir(file_header, bkp_file) &lt; 0) {\n                    return -1;\n                }\n            }\n            else if (file_header-&gt;typeflag == 'l') {\n                if (restore_symlink(file_header, bkp_file) &lt; 0) {\n                    return -1;\n                }\n            }\n            else {\n                fprintf(stdout, \"Failed restoring, unknown file type found.\");\n                return -1;\n            }\n        }\n        close(bkp_file);\n        return 0;\n    }\n\n    // Restore a single file based on the header and the raw bkp_file\n    int restore_file(bkp_header *file_header, int bkp_file) {\n        // Make sure the output file does not exist\n        int out_file;\n        out_file = open(file_header-&gt;name, O_RDONLY);\n        if (out_file != -1) {\n            close(out_file);\n            fprintf(stdout, \"Failed restoring, file %s already exists.\", file_header-&gt;name);\n            return -1;\n        }\n\n        // Create and open it for writing\n        out_file = open(file_header-&gt;name, O_WRONLY | O_CREAT);\n        if (out_file &lt; 0) {\n            fprintf(stdout, \"Failed opening backed-up file path for writing.\");\n            return -1;\n        }\n\n        // Restore the file's meta data\n        if (restore_metadata(file_header) != 0) {\n            fprintf(stdout, \"Failed restoring backed-up file meta data.\");\n            return -1;\n        }\n\n        // Read the content of the file in 8K chunks, and write them to disk\n        int file_size = atoi(file_header-&gt;size);\n        while (file_size) {\n            // Read a chunk from the backup file\n            char file_buf[8192];\n            ssize_t f_result = read(bkp_file, file_buf, MIN(sizeof(file_buf), file_size));\n            if (f_result &lt; 0) {\n                fprintf(stdout, \"Failed reading from backup file.\");\n                return -1;\n            }\n            if (f_result == 0) {\n                break; /* EOF */\n            }\n\n            // Write this chunk to the disc\n            if (write(out_file, file_buf, (int)f_result) != (int)f_result) {\n                fprintf(stdout, \"Failed writing file to disc.\");\n                return -1;\n            }\n            file_size -= f_result;\n        }\n        close(out_file);\n        return 0;\n    }\n\n    // Restore a directory based on the header and the raw bkp_file\n    int restore_dir(bkp_header *file_header, int bkp_file) {\n        // Create this folder on the disc\n        if (mkdir(file_header-&gt;name, atoi(file_header-&gt;mode)) != 0) {\n            fprintf(stdout, \"Failed creating directory.\");\n            return -1;\n        }\n\n        // Restore the directory's meta data\n        if (restore_metadata(file_header) != 0) {\n            fprintf(stdout, \"Failed restoring backed-up directory's meta data.\");\n            return -1;\n        }\n        return 0;\n    }\n\n    // Restore a symbolic link (not the target file) based on the header and the raw bkp_file\n    int restore_symlink(bkp_header *file_header, int bkp_file) {\n        // Make sure the output file does not exist\n        int out_file;\n        out_file = open(file_header-&gt;name, O_RDONLY);\n        if (out_file != -1) {\n            close(out_file);\n            fprintf(stdout, \"Failed restoring, symlink %s already exists.\", file_header-&gt;name);\n            return -1;\n        }\n\n        int path_size = atoi(file_header-&gt;size);\n        char *file_buf = malloc(sizeof(char)*path_size);\n        if (file_buf == NULL) {\n            fprintf(stdout, \"Failed allocating memory.\");\n            return -1;\n        }\n\n        // Read the content of the file, get the link target\n        ssize_t f_result = read(bkp_file, file_buf, path_size);\n        if (f_result &lt; 0) {\n            fprintf(stdout, \"Failed reading from backup file.\");\n            return -1;\n        }\n\n        // Create this symbolic link on the disc\n        if (symlink(file_buf, file_header-&gt;name) != 0) {\n            fprintf(stdout, \"Failed creating symlink.\");\n            return -1;\n        }\n\n        // Restore the link's meta data\n        if (restore_metadata(file_header) != 0) {\n            fprintf(stdout, \"Failed restoring backed-up link meta data.\");\n            return -1;\n        }\n        return 0;\n    }\n\n\n    // Set the original UID, GID, permissions and modification time\n    int restore_metadata(bkp_header *file_header) {\n        if (lchown(file_header-&gt;name, atoi(file_header-&gt;uid), atoi(file_header-&gt;gid)) != 0) {\n            fprintf(stdout, \"chown error\");\n            return -1;\n        }\n        if (file_header-&gt;typeflag != 'l') {\n            // No lchmod in my glibc, not restoring mode for symlinks\n            if (chmod(file_header-&gt;name, atoi(file_header-&gt;mode)) != 0) {\n                fprintf(stdout, \"chmod error\");\n                return -1;\n            }\n            struct utimbuf ubuf;\n            ubuf.modtime = atoi(file_header-&gt;mtime);\n            if (utime(file_header-&gt;name, &amp;ubuf) != 0) {\n                fprintf(stdout, \"utime error\");\n                return -1;\n            }\n        }\n        return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 73, "user_id": 5819504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c9c0ea1de87e082b5fe7e19b1adce906?s=128&d=identicon&r=PG&f=1", "display_name": "hitman.star", "link": "https://stackoverflow.com/users/5819504/hitman-star"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1464197706, "post_id": 37443685, "comment_id": 62390329, "body": "There are only one line &quot;font=tahoma.ttf&quot; in my ini file."}, {"owner": {"reputation": 4168, "user_id": 6273251, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fCGXep-7snc/AAAAAAAAAAI/AAAAAAAAADk/nk_YDFGfkc0/photo.jpg?sz=128", "display_name": "Random Davis", "link": "https://stackoverflow.com/users/6273251/random-davis"}, "edited": false, "score": 2, "creation_date": 1464197915, "post_id": 37443685, "comment_id": 62390462, "body": "Have you used a debugger to go through your code line-by-line?"}, {"owner": {"reputation": 73, "user_id": 5819504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c9c0ea1de87e082b5fe7e19b1adce906?s=128&d=identicon&r=PG&f=1", "display_name": "hitman.star", "link": "https://stackoverflow.com/users/5819504/hitman-star"}, "edited": false, "score": 0, "creation_date": 1464198121, "post_id": 37443685, "comment_id": 62390582, "body": "Sorry, I don&#39;t know how to debug the source code, so I used printf(&quot;OK&quot;);"}, {"owner": {"reputation": 13521, "user_id": 654953, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f6453f58b70e93dbfa8998b71a95bb09?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/654953/ryan"}, "edited": false, "score": 0, "creation_date": 1464198192, "post_id": 37443685, "comment_id": 62390627, "body": "the algo is simple, split by line -&gt; split by <code>=</code> -&gt; shift the result, you get the key, shift again you get the value"}, {"owner": {"reputation": 73, "user_id": 5819504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c9c0ea1de87e082b5fe7e19b1adce906?s=128&d=identicon&r=PG&f=1", "display_name": "hitman.star", "link": "https://stackoverflow.com/users/5819504/hitman-star"}, "edited": false, "score": 0, "creation_date": 1464198338, "post_id": 37443685, "comment_id": 62390700, "body": "But after compile the source code, I can see the message: &quot;Segmentation fault (core dumped)&quot;."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464198519, "post_id": 37443685, "comment_id": 62390784, "body": "It&#39;s all very well saying your ini file has only one entry, so why have a field definition? Tomorrow, you&#39;ll need another definition in it, and another. <a href=\"http://stackoverflow.com/questions/2280352/use-ini-file-in-c-on-linux\">Try this SO question</a>."}, {"owner": {"reputation": 73, "user_id": 5819504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c9c0ea1de87e082b5fe7e19b1adce906?s=128&d=identicon&r=PG&f=1", "display_name": "hitman.star", "link": "https://stackoverflow.com/users/5819504/hitman-star"}, "edited": false, "score": 0, "creation_date": 1464198914, "post_id": 37443685, "comment_id": 62391028, "body": "I want to insert some new lines in my ini file."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464199752, "post_id": 37443685, "comment_id": 62391521, "body": "Step 1: <code>while (EndOfFile != EOF)</code> --&gt; <code>while (EndOfFile == 2)</code> Step 2 <code>&quot;%[^=]=%s&quot;</code> -----------&gt; into <code>&quot; %19[^=]=%19s&quot;</code>  (add space and 19s)  Step 3 Do not use <code>fscanf()</code>.  Use <code>fgets()</code>."}, {"owner": {"reputation": 73, "user_id": 5819504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c9c0ea1de87e082b5fe7e19b1adce906?s=128&d=identicon&r=PG&f=1", "display_name": "hitman.star", "link": "https://stackoverflow.com/users/5819504/hitman-star"}, "edited": false, "score": 0, "creation_date": 1464200216, "post_id": 37443685, "comment_id": 62391780, "body": "Well, there is no changes.."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 2, "creation_date": 1464205327, "post_id": 37443685, "comment_id": 62394592, "body": "1) <i>LEARN TO USE YOUR DEBUGGER</i>!  There&#39;s no time like the present ;).  2) Your code has many potential problems, including (but not limited to) <code>char Setting[20],Value[20]</code>.  3) SUGGESTION: Use <code>fgets()</code> and &#39; <code>strpbrk ( line, &quot;=&quot;)</code>, like user3121023 suggests."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1464205346, "post_id": 37443685, "comment_id": 62394600, "body": "If your platform supports <code>getline()</code> <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getdelim.html\" rel=\"nofollow noreferrer\">(link)</a>, that&#39;s even better than <code>fgets()</code>.  <code>fgets()</code> won&#39;t return an arbitrarily-long line (to be overly pedantic, neither will <code>getline()</code> - but <code>getline</code> is limited by how much memory it can allocate, while <code>fgets()</code> is limited to how much memory the caller supplies.)"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5819504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c9c0ea1de87e082b5fe7e19b1adce906?s=128&d=identicon&r=PG&f=1", "display_name": "hitman.star", "link": "https://stackoverflow.com/users/5819504/hitman-star"}, "edited": false, "score": 0, "creation_date": 1464264655, "post_id": 37444853, "comment_id": 62419985, "body": "Well, I discovered that and allocated some memory for it. Thanks for your reply!"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 3, "last_activity_date": 1464205030, "last_edit_date": 1464205030, "creation_date": 1464200355, "answer_id": 37444853, "question_id": 37443685, "link": "https://stackoverflow.com/questions/37443685/reading-ini-files-using-fscanf-in-c/37444853#37444853", "title": "reading ini files using fscanf in c", "body": "<p>SefFault could be caused by the <code>&amp;</code> before Value, but even after removing if, you could still read a <em>value</em>  longer than 20 characters. And some ini files can contain comment lines that does not follow the pattern and will break you progran</p>\n\n<p>You really should:</p>\n\n<ul>\n<li>read line by line with <code>fgets</code> into a buffer of at least 255 characters - repeat until end of file : <code>while (NULL != fgets(line, sizeof(line), stdin)) { ...}</code></li>\n<li><p>use <code>sscanf</code> to parse each line and ignore every non conformant one:</p>\n\n<pre><code>if (2 == sscanf(line, \"%19[^=]=%19s\", Setting, Value) { ... }\n</code></pre></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 5819504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c9c0ea1de87e082b5fe7e19b1adce906?s=128&d=identicon&r=PG&f=1", "display_name": "hitman.star", "link": "https://stackoverflow.com/users/5819504/hitman-star"}, "edited": false, "score": 0, "creation_date": 1464264988, "post_id": 37446044, "comment_id": 62420187, "body": "I learned something new from you. Thanks for your reply anyway!"}], "tags": [], "owner": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "is_accepted": false, "score": 2, "last_activity_date": 1464204618, "creation_date": 1464204618, "answer_id": 37446044, "question_id": 37443685, "link": "https://stackoverflow.com/questions/37443685/reading-ini-files-using-fscanf-in-c/37446044#37446044", "title": "reading ini files using fscanf in c", "body": "<p>Use fgets to read each line in the file. strpbrk could be used to locate the equal and the newline and copy that span of characters to the variables.</p>\n\n<pre><code>void LoadConfig()\n{\n    char Setting[100] = {'\\0'},Value[100] = {'\\0'}, line[300] = {'\\0'};\n    size_t span = 0;\n    if ((ini_file = fopen(\"config.ini\", \"r\")))\n    {\n        while ( fgets ( line, sizeof ( line), ini_file))//read each line\n        {\n            char *equal = strpbrk ( line, \"=\");//find the equal\n            if ( equal)//found the equal\n            {\n                span = equal - line;\n                memcpy ( Setting, line, span);\n                Setting[span] = '\\0';\n                if(strcmp(Setting,\"font\") == 0)\n                {\n                    equal++;//advance past the =\n                    char *nl = strpbrk ( equal, \"\\n\");//fine the newline\n                    if ( nl)//found the newline\n                    {\n                        span = nl - equal;\n                        memcpy ( font, nl, span);\n                        font[span] = '\\0';\n                    }\n                }\n            }\n        }\n        fclose(ini_file);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5819504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c9c0ea1de87e082b5fe7e19b1adce906?s=128&d=identicon&r=PG&f=1", "display_name": "hitman.star", "link": "https://stackoverflow.com/users/5819504/hitman-star"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1221, "favorite_count": 0, "accepted_answer_id": 37444853, "answer_count": 2, "score": 1, "last_activity_date": 1464205030, "creation_date": 1464196347, "last_edit_date": 1464199433, "question_id": 37443685, "link": "https://stackoverflow.com/questions/37443685/reading-ini-files-using-fscanf-in-c", "title": "reading ini files using fscanf in c", "body": "<p>I'm having a problem parsing an <code>.ini</code> <code>file</code>. I know there are lots of post on this topic, and I have read many of them. my <code>ini</code> <code>file</code> have only one <code>entry</code>:</p>\n\n<pre><code>font=tahoma.ttf\n</code></pre>\n\n<p>Source Code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nstatic FILE *ini_file;\nchar font[20];\n\nvoid LoadConfig()\n{\n    char Setting[20],Value[20];\n    int EndOfFile = 0;\n    if ((ini_file = fopen(\"config.ini\", \"r\")))\n    {\n        EndOfFile = fscanf(ini_file, \"%[^=]=%s\", Setting, &amp;Value);\n        while (EndOfFile != EOF)\n        {\n            if(strcmp(Setting,\"font\") == 0)\n            {\n                strcpy(font,Value);\n            }\n            EndOfFile = fscanf(ini_file, \"%[^=]=%s\", Setting, &amp;Value);\n        }\n        fclose(ini_file);\n    }\n}\n</code></pre>\n\n<p>The problem is that, the value is not never read into the <code>font</code> <code>variable</code>.</p>\n"}, {"tags": ["c", "pointers", "gtk", "gtk3"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1464196858, "post_id": 37443642, "comment_id": 62389876, "body": "Please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> and show us, right now it&#39;s impossible to do anything but guess."}, {"owner": {"reputation": 178, "user_id": 6382377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9ffe8be938aa2ba7d19b3bb718204b7?s=128&d=identicon&r=PG&f=1", "display_name": "ET Come Back", "link": "https://stackoverflow.com/users/6382377/et-come-back"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1464197873, "post_id": 37443642, "comment_id": 62390436, "body": "My apologies, first time posting. I have updated the post to include a complete example"}], "answers": [{"comments": [{"owner": {"reputation": 178, "user_id": 6382377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9ffe8be938aa2ba7d19b3bb718204b7?s=128&d=identicon&r=PG&f=1", "display_name": "ET Come Back", "link": "https://stackoverflow.com/users/6382377/et-come-back"}, "edited": false, "score": 0, "creation_date": 1464207107, "post_id": 37444754, "comment_id": 62395466, "body": "This did resolve my problem, and now my code is working on all my computers. Thank you!!!! I am still curious as to why my old code would work on some computers but not others. I tried downgrading my GTK versions and this didn&#39;t seem to have any impact. Any idea on what would change in newer versions to prevent this code from working?"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "reply_to_user": {"reputation": 178, "user_id": 6382377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9ffe8be938aa2ba7d19b3bb718204b7?s=128&d=identicon&r=PG&f=1", "display_name": "ET Come Back", "link": "https://stackoverflow.com/users/6382377/et-come-back"}, "edited": false, "score": 0, "creation_date": 1464224546, "post_id": 37444754, "comment_id": 62401526, "body": "Your pointer was probably on the stack from some other operation. What&#39;s realy going on is not guaranteed; that is the magic of undefined behavior."}], "tags": [], "owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "is_accepted": true, "score": 1, "last_activity_date": 1464200042, "creation_date": 1464200042, "answer_id": 37444754, "question_id": 37443642, "link": "https://stackoverflow.com/questions/37443642/gtk-c-pointer-address-changing/37444754#37444754", "title": "GTK+ C: Pointer Address Changing", "body": "<pre><code>static void startTimerPressed (GtkWidget *widget, gpointer data, TimerDataP timerData) {\n</code></pre>\n\n<p>The <code>gpointer data</code> parameter <em>is</em> the data you pass to <code>g_signal_connect()</code>. You're asking for more parameters than the <code>clicked</code> signal gives you. It's a shame there's no way to check signal function parameters :/ You want</p>\n\n<pre><code>static void startTimerPressed (GtkWidget *widget, TimerDataP timerData) {\n</code></pre>\n\n<p>or</p>\n\n<pre><code>static void startTimerPressed (GtkWidget *widget, gpointer data) {\n    TimeDataP timerData = (TimerDataP) data;\n</code></pre>\n\n<p>instead.</p>\n"}], "owner": {"reputation": 178, "user_id": 6382377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9ffe8be938aa2ba7d19b3bb718204b7?s=128&d=identicon&r=PG&f=1", "display_name": "ET Come Back", "link": "https://stackoverflow.com/users/6382377/et-come-back"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 37444754, "answer_count": 1, "score": 0, "last_activity_date": 1464200042, "creation_date": 1464196210, "last_edit_date": 1464197851, "question_id": 37443642, "link": "https://stackoverflow.com/questions/37443642/gtk-c-pointer-address-changing", "title": "GTK+ C: Pointer Address Changing", "body": "<p>I am getting a segmentation fault, due to a passed pointer's memory address changing when using GTK's g_signal_connect.</p>\n\n<p>This is happening on only one of my three computers. The one computer where it is not working, it is running Arch Linux, so I am assuming that some program's version is ahead of my other computers which are both running Fedora. I assumed it was GTK+, so I tried downgrading, and this did not have any affect.</p>\n\n<p>Weird thing... no matter where I compile the program, it always works on the two computers, and does not work on the one, so I don't believe it has anything to do with the compiler version.</p>\n\n<p>Header File:</p>\n\n<pre><code>typedef struct Timer {\n  gboolean running;\n} *TimerP;\n\ntypedef struct TimerData {\n  TimerP timerPointer;\n} *TimerDataP;\n</code></pre>\n\n<p>Main:</p>\n\n<pre><code>TimerP timerPointer;\ntimerPointer = malloc(sizeof(struct Timer));\n\nTimerDataP timerDataP;\ntimerDataP = malloc(sizeof(struct TimerData));\ntimerDataP-&gt;timerPointer = timerPointer;\n\ng_signal_connect (startButton, \"clicked\", G_CALLBACK (startTimerPressed), timerDataP);\n</code></pre>\n\n<p>startTimerPressed function:</p>\n\n<pre><code>static void startTimerPressed (GtkWidget *widget, gpointer data, TimerDataP timerData) {\n    TimerP timer = timerData-&gt;timerPointer;\n}\n</code></pre>\n\n<p>To test, I have been doing this periodically, and this seems to work everywhere in main:</p>\n\n<pre><code>gpointer theGPointer;\nstartTimerPressed(startButton, theGPointer, timerDataP);\n</code></pre>\n\n<p>But for some reason, when it's called using the callback, the memory location has changed and all the data inside is messed up, so trying to access anything causes a segmentation fault.</p>\n\n<p>Please &amp; thank you for any assistance!</p>\n\n<p>Complete Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;gtk/gtk.h&gt;\n#include &lt;glib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;cairo.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Timer {\n  gboolean running;\n}*TimerP;\n\ntypedef struct TimerData {\n  TimerP timerPointer;\n} *TimerDataP;\n\nstatic void startTimerPressed (GtkWidget *widget, gpointer data, TimerDataP timerData) {\n  printf(\"TimerData Location: %p\\n\", timerData);\n  TimerP timer = timerData-&gt;timerPointer;\n}\n\nint main (int argc, char *argv[]) {\n  GtkWidget *startButton;\n  GtkWidget *window;\n  GtkWidget *grid;\n\n  gtk_init (&amp;argc, &amp;argv);\n\n  window = gtk_window_new (GTK_WINDOW_TOPLEVEL);\n  gtk_window_set_default_size(GTK_WINDOW(window), 550, 200);\n  g_signal_connect (window, \"destroy\", G_CALLBACK (gtk_main_quit), NULL);\n  gtk_container_set_border_width (GTK_CONTAINER (window), 20);\n\n  grid = gtk_grid_new();\n  gtk_grid_set_column_spacing(GTK_GRID(grid), 20);\n  gtk_grid_set_row_spacing(GTK_GRID(grid), 10);\n  gtk_container_add (GTK_CONTAINER (window), grid);\n\n  startButton = gtk_button_new_with_label (\"Start\");\n\n  TimerP timerPointer;\n  timerPointer = malloc(sizeof(struct Timer));\n\n  TimerDataP timerDataP;\n  timerDataP = malloc(sizeof(struct TimerData));\n\n  printf(\"TimerData Location: %p\\n\", timerDataP);\n\n  g_signal_connect (startButton, \"clicked\", G_CALLBACK (startTimerPressed), timerDataP);\n  gtk_grid_attach (GTK_GRID (grid), startButton, 0, 4, 1, 1);\n\n  gtk_widget_show_all(window);\n\n  gtk_main ();\n}\n</code></pre>\n\n<p>On two of my computers, the memory location printed is the same in both locations, in one of them, it is different</p>\n"}, {"tags": ["c", "ffmpeg", "mp4", "h.264", "muxer"], "answers": [{"comments": [{"owner": {"reputation": 464, "user_id": 1699328, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9225b78aebcfa548c9e133dcae2c4dc7?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/1699328/dom"}, "edited": false, "score": 0, "creation_date": 1464254749, "post_id": 37448914, "comment_id": 62413383, "body": "Thanks, I went through your poste few times before I wrote this question, but it was and still is not so clear for me... Could you be more specific please, what data are not part of the stream?  I think this could be skipped:  <code>00 00 01 FC 02 19 F0 87 A0 23 73 41 B6 C0 01 00 00 00 00 01 67 4D 00 2A 95 A8 1E 00 89 F9 61 00 00 03 00 01 00 00 03 00 32 84 00 00 00 01 68 EE  3C 80 00 00 00 01 06 E5 01 19 80</code>   (first I-frame), however, there are some start codes in this part as well...  To remove them is no problem. Thanks in advance!"}, {"owner": {"reputation": 27067, "user_id": 210785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a561cd4d29738e18d9e565a6265d86ac?s=128&d=identicon&r=PG", "display_name": "szatmary", "link": "https://stackoverflow.com/users/210785/szatmary"}, "reply_to_user": {"reputation": 464, "user_id": 1699328, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9225b78aebcfa548c9e133dcae2c4dc7?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/1699328/dom"}, "edited": false, "score": 0, "creation_date": 1464278206, "post_id": 37448914, "comment_id": 62430109, "body": "You need to parse the data with your eyes. Read the packet and look at the data. You see a start start, what comes next? This is a reverse engineering job. 00 00 00 01 67 -&gt; thats an SPS, you can tell just by glancing at it. 00 00 01 FC -&gt; type 28, thats undefined. now look for a pattern. can you just drop NALUs of unknown type? maybe."}], "tags": [], "owner": {"reputation": 27067, "user_id": 210785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a561cd4d29738e18d9e565a6265d86ac?s=128&d=identicon&r=PG", "display_name": "szatmary", "link": "https://stackoverflow.com/users/210785/szatmary"}, "is_accepted": false, "score": 2, "last_activity_date": 1464216704, "last_edit_date": 1495540821, "creation_date": 1464216704, "answer_id": 37448914, "question_id": 37443588, "link": "https://stackoverflow.com/questions/37443588/h-264-muxing-to-mp4-from-cctv-hw-encoder-using-ffmpeg-library-in-c-c-how/37448914#37448914", "title": "H.264 muxing to MP4 from CCTV (HW) encoder using ffmpeg library in C / C++, how to fetch AVCodecContext::extradata", "body": "<p>First of all, there is some data that is not part of the video stream. You need to figure out a way how to remove that. Everything else can be answered here: <a href=\"https://stackoverflow.com/questions/24884827/possible-locations-for-sequence-picture-parameter-sets-for-h-264-stream\">Possible Locations for Sequence/Picture Parameter Set(s) for H.264 Stream</a></p>\n"}], "owner": {"reputation": 464, "user_id": 1699328, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9225b78aebcfa548c9e133dcae2c4dc7?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/1699328/dom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 990, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1464216704, "creation_date": 1464196044, "last_edit_date": 1495539991, "question_id": 37443588, "link": "https://stackoverflow.com/questions/37443588/h-264-muxing-to-mp4-from-cctv-hw-encoder-using-ffmpeg-library-in-c-c-how", "title": "H.264 muxing to MP4 from CCTV (HW) encoder using ffmpeg library in C / C++, how to fetch AVCodecContext::extradata", "body": "<p>I am trying to mux a video to mp4 file from packets received via SDK API of CCTV camera. The stream from CCTV seems to consist of packets of h264 I and P-frames only (no B-frames).</p>\n\n<p>The problem is, that the file is not playable in Daum PotPlayer when I leave the AVCodecContext::extradata empty, however, I can play the file in VLC. If I feed the extra data (probably not correctly - I just copy the first 50 bytes from the packet received from the HW encoder), the file is playable in PotPlayer, but not in VLC.</p>\n\n<p>I do not know, how to prepare the extradata properly.</p>\n\n<p>The code below shows the muxing.</p>\n\n<pre><code>void WriteVideo()\n{\n    AVFormatContext* formatContext = nullptr;\n    AVStream* stream = nullptr;\n\n    int ret = 0;\n\n    ret = avformat_alloc_output_context2(&amp;formatContext, nullptr, \"mp4\", OUTPUT_V_FILE_NAME);\n    if (ret &lt; 0)\n    {\n        fprintf(stderr, \"Error occurred when allocating output context: %d\\n\", ret);\n        return;\n    }\n\n    stream = avformat_new_stream(formatContext, nullptr);\n    if (!stream)\n    {\n        avformat_free_context(formatContext);\n        formatContext = nullptr;\n        fprintf(stderr, \"Error occurred creating new stream\");\n        return;\n    }\n\n    stream-&gt;codec-&gt;codec_tag = 0;\n\n    if (formatContext-&gt;oformat-&gt;flags &amp; AVFMT_GLOBALHEADER)\n    {\n        stream-&gt;codec-&gt;flags |= CODEC_FLAG_GLOBAL_HEADER;\n    }\n\n\n    stream-&gt;codec-&gt;codec_type = AVMEDIA_TYPE_VIDEO;\n    stream-&gt;codec-&gt;codec_id = AV_CODEC_ID_H264;\n    stream-&gt;codec-&gt;pix_fmt = AV_PIX_FMT_YUV420P;\n    stream-&gt;codec-&gt;bit_rate = 4096000; // 8192000; // 4096000; // 384000;\n    stream-&gt;codec-&gt;width = 1920; // 352\n    stream-&gt;codec-&gt;height = 1080; // 288\n    stream-&gt;codec-&gt;gop_size = 50;\n\n    AVRational tb;\n    tb.num = 1;\n    tb.den = 25;\n    stream-&gt;codec-&gt;time_base = tb;\n    //stream-&gt;codec-&gt;field_order = AVFieldOrder::AV_FIELD_UNKNOWN;\n    //stream-&gt;codec-&gt;color_primaries = AVColorPrimaries::AVCOL_PRI_BT470BG;\n    //stream-&gt;codec-&gt;color_trc = AVColorTransferCharacteristic::AVCOL_TRC_GAMMA22;\n    //stream-&gt;codec-&gt;colorspace = AVColorSpace::AVCOL_SPC_BT470BG;\n    //stream-&gt;codec-&gt;chroma_sample_location = AVChromaLocation::AVCHROMA_LOC_CENTER;\n    AVRational aratio;\n    aratio.num = 1;\n    aratio.den = 1;\n    stream-&gt;codec-&gt;sample_aspect_ratio = aratio;\n    // stream-&gt;codec-&gt;delay = 0;\n    // stream-&gt;codec-&gt;color_range = AVColorRange::AVCOL_RANGE_MPEG;\n\n    av_dump_format(formatContext, 0, formatContext-&gt;filename, 1);\n\n    if (!(formatContext-&gt;oformat-&gt;flags &amp; AVFMT_NOFILE))\n    {\n        if (avio_open(&amp;formatContext-&gt;pb, formatContext-&gt;filename, AVIO_FLAG_WRITE) &lt; 0)\n        {\n            avformat_free_context(formatContext);\n            formatContext = nullptr;\n            fprintf(stderr, \"Error occurred when opening output file.\");\n            return;\n\n        }\n    }\n\n    avformat_write_header(formatContext, nullptr);\n\n    int frameIdx = 0;\n    int pts = 0;\n    int dts = 0;\n    int pkt_pos = 0;\n    int size = static_cast&lt;int&gt;(tmpRawFrameBuffer.size());\n\n    AVPacket pkt = { 0 };\n    av_init_packet(&amp;pkt);\n\n    while (frameIdx &lt; size)\n    {\n        pkt.data = tmpRawFrameBuffer[frameIdx];\n        pkt.size = tmpRawFrameSizes[frameIdx];\n\n        // debug purphose start\n        FILE* f;\n        char filename[MAX_PATH];\n        sprintf_s(filename, MAX_PATH, OUTPUT_PACKET_FILE_PATTERN_NAME, frameIdx);\n        auto err = fopen_s(&amp;f, filename, \"wb\");\n        if (err != 0)\n        {\n            fprintf(stderr, \"Could not open %s\\n\", OUTPUT_V_FILE_NAME);\n            exit(1);\n        }\n\n        fflush(stdout);\n        fwrite(pkt.data, 1, pkt.size, f);\n        fclose(f);\n        // debug purphose end\n\n        if (tmpRawFrameTypes[frameIdx] == VIDEO_I_FRAME)\n        {\n            pkt.flags |= AV_PKT_FLAG_KEY;\n            stream-&gt;codec-&gt;extradata_size = 50;\n            stream-&gt;codec-&gt;extradata = (uint8_t*)av_malloc(stream-&gt;codec-&gt;extradata_size);\n            memcpy(stream-&gt;codec-&gt;extradata, pkt.data, stream-&gt;codec-&gt;extradata_size);\n        }\n        pkt.pts = pts++;\n        pkt.dts = dts++;\n        /* rescale output packet timestamp values from codec to stream timebase */\n        // av_packet_rescale_ts(&amp;pkt, stream-&gt;codec-&gt;time_base, stream-&gt;time_base);\n        pkt.pts = av_rescale_q(pkt.pts, stream-&gt;codec-&gt;time_base, stream-&gt;time_base);\n        pkt.dts = av_rescale_q(pkt.dts, stream-&gt;codec-&gt;time_base, stream-&gt;time_base);\n        pkt.duration = 512; // should be calculated (derived from FPS 25, and 12800)\n        pkt.pos = -1;\n        pkt.stream_index = stream-&gt;index;\n\n        auto ret = av_write_frame(formatContext, &amp;pkt);\n        if (ret &lt; 0)\n        {\n            fprintf(stderr, \"Error while writing video frame: %d\\n\", ret);\n            break;\n        }\n        av_packet_unref(&amp;pkt);\n        ++frameIdx;\n    }\n\n    if (formatContext)\n    {\n        av_write_trailer(formatContext);\n        if (!(formatContext-&gt;oformat-&gt;flags &amp; AVFMT_NOFILE)) avio_close(formatContext-&gt;pb); // close the output file\n        avformat_free_context(formatContext);\n        formatContext = nullptr;\n    }\n}\n</code></pre>\n\n<p>It seems, the packet from camera (buffered in tmpRawFrameBuffer vector) contains some headers, but I am not able to parse them, I do not understand the meaning of the header. </p>\n\n<p>The first bytes of the I-frame packet looks like the dump bellow:</p>\n\n<pre><code>00 00 01 FC 02 19 F0 87 A0 23 73 41 B6 C0 01 00\n00 00 00 01 67 4D 00 2A 95 A8 1E 00 89 F9 61 00\n00 03 00 01 00 00 03 00 32 84 00 00 00 01 68 EE \n3C 80 00 00 00 01 06 E5 01 19 80 00 00 00 01 65 \nB8 00 00 08 C7 B0 23 FF F7 80 EE FE 63 B6 FB F5\n...\n</code></pre>\n\n<p>The first bytes of the first P-frame:</p>\n\n<pre><code>00 00 01 FD E5 24 00 00 00 00 00 01 61 E0 22 27 \nFF D6 B0 D7 A4 2B 71 6B 19 C5 87 CA BB 8B BF 60 \n14 59 B4 00 CC BC 0F C0 9E FD 84 B5 FB C4 83 DB \n5A 8B 80 FC EC D6 33 6D DE 10 96 6F 31 41 86 5C \nD4 22 F9 33 48 5B CE 77 38 17 0C D6 DD C7 6C E8\n...\n</code></pre>\n\n<p>first bytes of next P-frame:</p>\n\n<pre><code>00 00 01 FD 5E 2F 00 00 00 00 00 01 61 E0 42 2F \nFF E7 06 DD 3C 66 26 15 94 93 7A F1 30 8A 6D B8 \nAD DD 6B 0F 38 89 1D 1B 5C AC 44 6A D7 D1 21 3B \nE2 29 F8 14 BB 98 1C 06 4D B6 10 BB DB B9 CA 4F \n0B ED B1 A9 06 78 8C EC 06 6D 9F 4F 79 0C 35 5B\n...\n</code></pre>\n\n<p>...</p>\n\n<p>begining of next I-frame:</p>\n\n<pre><code>00 00 01 FC 02 19 F0 87 A2 23 73 41 75 89 01 00 \n00 00 00 01 67 4D 00 2A 95 A8 1E 00 89 F9 61 00 \n00 03 00 01 00 00 03 00 32 84 00 00 00 01 68 EE \n3C 80 00 00 00 01 06 E5 01 1B 80 00 00 00 01 65 \nB8 00 00 0F 07 F0 7F F6 6C 69 43 0F F0 28 DF 97\n...\n</code></pre>\n\n<p>Does anybody know, how to fill correctly the extradata? I just made a copy of first 50 bytes, but it seems, this is not correct.</p>\n\n<p>Probably the headers are (AUD)(SPS)(PPS)(I-Slice)(PPS)(P-Slice)(PPS)(P-Slice) ... (AUD)(SPS)(PPS)(I-Slice) (<a href=\"https://stackoverflow.com/a/20686267/1699328\">https://stackoverflow.com/a/20686267/1699328</a>), however, I do not know, how to extract data for the </p>\n\n<pre><code>stream-&gt;codec-&gt;extradata\n</code></pre>\n\n<p>I tried to get some inspiration in this post <a href=\"https://stackoverflow.com/q/15263458/1699328\">H.264 muxed to MP4 using libavformat not playing back</a>, but I am not able to figure out what are values of spsFrameLen, ppsFrameLen and spsFrame.</p>\n\n<p>The result of the muxer (first and last bytes of the mp4 file):</p>\n\n<pre><code>00 00 00 20 66 74 79 70 69 73 6F 6D 00 00 02 00 \n69 73 6F 6D 69 73 6F 32 61 76 63 31 6D 70 34 31 \n00 00 00 08 66 72 65 65 00 26 2E 6D 6D 64 61 74 \n00 00 00 0D FC 02 19 F0 87 A0 23 73 41 B6 C0 01 \n00 00 00 00 16 67 4D 00 2A 95 A8 1E 00 89 F9 61 \n00 00 03 00 01 00 00 03 00 32 84 00 00 00 04 68 \nEE 3C 80 00 00 00 05 06 E5 01 19 80 00 01 C0 87 \n65 B8 00 00 08 C7 B0 23 FF F7 80 EE FE 63 B6 FB \nF5 97 A8 6B 48 39 61 99 FD 99 27 41 F2 78 54 EE \nD1 38 8E E8 18 DD 05 E4 BA F4 EB 69 CF 91 5C 34\n...\n...\n...\n95 B8 D8 D4 C3 AF A1 BA AC 28 F0 D4 D4 7C 48 9A \n0C A6 8C 4C 98 00 00 05 1E 6D 6F 6F 76 00 00 00 \n6C 6D 76 68 64 00 00 00 00 00 00 00 00 00 00 00 \n00 00 00 03 E8 00 00 13 B0 00 01 00 00 01 00 00 \n00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 \n00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 \n00 00 00 00 00 00 00 00 00 40 00 00 00 00 00 00 \n00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 \n00 00 00 00 00 00 00 00 02 00 00 04 48 74 72 61 \n6B 00 00 00 5C 74 6B 68 64 00 00 00 03 00 00 00 \n00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 13 \nB0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 \n00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 \n00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 \n00 40 00 00 00 07 80 00 00 04 38 00 00 00 00 00 \n24 65 64 74 73 00 00 00 1C 65 6C 73 74 00 00 00 \n00 00 00 00 01 00 00 13 B0 00 00 00 00 00 01 00 \n00 00 00 03 C0 6D 64 69 61 00 00 00 20 6D 64 68 \n64 00 00 00 00 00 00 00 00 00 00 00 00 00 00 32 \n00 00 00 FC 00 55 C4 00 00 00 00 00 2D 68 64 6C \n72 00 00 00 00 00 00 00 00 76 69 64 65 00 00 00 \n00 00 00 00 00 00 00 00 00 56 69 64 65 6F 48 61 \n6E 64 6C 65 72 00 00 00 03 6B 6D 69 6E 66 00 00 \n00 14 76 6D 68 64 00 00 00 01 00 00 00 00 00 00 \n00 00 00 00 00 24 64 69 6E 66 00 00 00 1C 64 72 \n65 66 00 00 00 00 00 00 00 01 00 00 00 0C 75 72 \n6C 20 00 00 00 01 00 00 03 2B 73 74 62 6C 00 00 \n00 93 73 74 73 64 00 00 00 00 00 00 00 01 00 00 \n00 83 61 76 63 31 00 00 00 00 00 00 00 01 00 00 \n00 00 00 00 00 00 00 00 00 00 00 00 00 00 07 80 \n04 38 00 48 00 00 00 48 00 00 00 00 00 00 00 01 \n00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 \n00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 \n00 18 FF FF 00 00 00 2D 61 76 63 43 01 4D 00 2A \nFF E1 00 16 67 4D 00 2A 95 A8 1E 00 89 F9 61 00 \n00 03 00 01 00 00 03 00 32 84 01 00 04 68 EE 3C \n80 00 00 00 18 73 74 74 73 00 00 00 00 00 00 00 \n01 00 00 00 7E 00 00 02 00 00 00 00 1C 73 74 73 \n73 00 00 00 00 00 00 00 03 00 00 00 01 00 00 00 \n33 00 00 00 65 00 00 00 34 73 74 73 63 00 00 00 \n00 00 00 00 03 00 00 00 01 00 00 00 3B 00 00 00 \n01 00 00 00 02 00 00 00 37 00 00 00 01 00 00 00 \n03 00 00 00 0C 00 00 00 01 00 00 02 0C 73 74 73 \n7A 00 00 00 00 00 00 00 00 00 00 00 7E 00 01 C0 \nC7 00 00 24 EE 00 00 2F 67 00 00 1D 83 00 00 2E \n8F 00 00 30 B6 00 00 2F 44 00 00 2F 50 00 00 34 \n6B 00 00 30 BE 00 00 31 0C 00 00 31 E7 00 00 30 \nEA 00 00 31 4E 00 00 31 A8 00 00 32 21 00 00 31 \nE6 00 00 31 B5 00 00 31 14 00 00 31 AF 00 00 31 \n9D 00 00 33 60 00 00 32 11 00 00 32 4C 00 00 31 \nF0 00 00 32 91 00 00 43 43 00 00 44 29 00 00 44 \nEC 00 00 44 20 00 00 44 86 00 00 45 AD 00 00 47 \n47 00 00 46 9F 00 00 46 D9 00 00 47 BE 00 00 48 \nCD 00 00 3E 50 00 00 40 98 00 00 41 0E 00 00 40 \n43 00 00 41 07 00 00 41 BB 00 00 41 FF 00 00 30 \n5E 00 00 33 C7 00 00 34 B7 00 00 33 F1 00 00 33 \n0D 00 00 32 DB 00 01 89 86 00 00 3B E1 00 00 3C \n55 00 00 3C 64 00 00 3C B7 00 00 3C FD 00 00 3E \n54 00 00 3E C5 00 00 3E 1C 00 00 3E 94 00 00 3E \n44 00 00 3E D7 00 00 3F CC 00 00 3E D6 00 00 40 \n00 00 00 40 4D 00 00 40 04 00 00 3F A9 00 00 40 \n82 00 00 41 0F 00 00 41 64 00 00 41 E5 00 00 42 \n1E 00 00 42 2C 00 00 42 80 00 00 42 4D 00 00 43 \n9F 00 00 43 DA 00 00 44 45 00 00 44 21 00 00 44 \nB7 00 00 45 22 00 00 45 E3 00 00 45 BF 00 00 46 \n18 00 00 47 4B 00 00 45 05 00 00 47 34 00 00 46 \n60 00 00 46 97 00 00 46 66 00 00 46 29 00 00 46 \n38 00 00 47 1D 00 00 47 42 00 00 47 18 00 00 47 \n13 00 00 46 52 00 00 47 48 00 00 46 F8 00 01 BE \nE3 00 00 3F 56 00 00 3B 32 00 00 38 F8 00 00 37 \n56 00 00 36 2D 00 00 35 DA 00 00 34 6B 00 00 3E \nBE 00 00 3E B5 00 00 3F 33 00 00 3F AC 00 00 3F \n38 00 00 42 32 00 01 1B DC 00 01 80 50 00 01 14 \n06 00 00 C2 BB 00 00 96 12 00 00 6D EC 00 00 54 \nE6 00 00 3A AC 00 00 32 00 00 00 2F 0A 00 00 2D \nF1 00 00 1B 7F 00 00 00 1C 73 74 63 6F 00 00 00 \n00 00 00 00 03 00 00 00 30 00 0F DD AB 00 1F 7D \n9E 00 00 00 62 75 64 74 61 00 00 00 5A 6D 65 74 \n61 00 00 00 00 00 00 00 21 68 64 6C 72 00 00 00 \n00 00 00 00 00 6D 64 69 72 61 70 70 6C 00 00 00 \n00 00 00 00 00 00 00 00 00 2D 69 6C 73 74 00 00 \n00 25 A9 74 6F 6F 00 00 00 1D 64 61 74 61 00 00 \n00 01 00 00 00 00 4C 61 76 66 35 37 2E 32 33 2E \n31 30 30\n</code></pre>\n\n<p>Thanks a lot for any advices.</p>\n"}, {"tags": ["c", "linux", "kernel", "scheduling"], "answers": [{"tags": [], "owner": {"reputation": 2219, "user_id": 1521807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ca95c59b3b803d42939dcc34412e5c6?s=128&d=identicon&r=PG", "display_name": "bodangly", "link": "https://stackoverflow.com/users/1521807/bodangly"}, "is_accepted": false, "score": 0, "last_activity_date": 1464197112, "creation_date": 1464197112, "answer_id": 37443901, "question_id": 37443479, "link": "https://stackoverflow.com/questions/37443479/determining-cause-of-delay-pause-kernel-scheduler-etc/37443901#37443901", "title": "Determining cause of delay/pause - kernel scheduler etc", "body": "<p>First you should try and run your program using strace to see if there are any system calls holding things up. </p>\n\n<p>If that is ambiguous or does not help I would suggest you try and profile the kernel. You could try <a href=\"http://oprofile.sourceforge.net/faq/\" rel=\"nofollow\">OProfile</a></p>\n\n<p>This will create a call graph that you can analyze and see what is happening.</p>\n"}], "owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464197112, "creation_date": 1464195663, "question_id": 37443479, "link": "https://stackoverflow.com/questions/37443479/determining-cause-of-delay-pause-kernel-scheduler-etc", "title": "Determining cause of delay/pause - kernel scheduler etc", "body": "<p>System is an embedded Linux/Busybox core on a small embedded board with a web server (Boa) running.</p>\n\n<p>We are seeing some high latency in responses from the web server - sometimes >500ms for no good reason, so I've been digging...</p>\n\n<p>On liberally scattering debug prints throughout the code it seems to come down to the entire process just... stopping for a bit, in a way which I can only assume must be the process/thread being interrupted by another process.</p>\n\n<p>Using print statements and clock_gettime() to calculate time taken to process a request, I can see the code reach the bottom of a while() loop (parsing input), print something like <code>\"Time so far: 5ms\"</code> and then the next line at the top of the loop will print <code>\"Time so far: 350ms\"</code> - and all that the code does between the bottom of the loop and the 1st print back at the top is a basic check along the lines of <code>while(position &lt; end)</code>, it has nothing complicated that could hold it up.</p>\n\n<p>There's no IO blocking, the data it's parsing has all arrived already, and it's not making any external calls or wandering off into complex functions.</p>\n\n<p>I then looked into whether the kernel scheduler (<a href=\"https://en.wikipedia.org/wiki/Completely_Fair_Scheduler\" rel=\"nofollow\">CFS</a> in our case) might be holding things up, adding calls to <a href=\"http://linux.die.net/man/3/clock\" rel=\"nofollow\">clock()</a> (processor time rather than wall-clock) and again calculating time differences Vs processor time used I can see that the wall-clock time delay may run beyond 300ms from one loop to the next, but the reported <em>processor time</em> taken (which seems to have a ~10ms resolution) is more like 50ms.</p>\n\n<p>So, that suggests the task scheduler is holding the process up for hundreds of milliseconds at a time. I've checked the <a href=\"https://stackoverflow.com/questions/16401294/how-to-know-linux-scheduler-time-slice\">scheduler granularity and max delay</a> and it's nowhere near 100ms, scheduler latency is set at 6ms for example.</p>\n\n<p>Any advice on what I can do now to try and track down the problem - identifying processes which could hog the CPU for >100ms, measuring/tracking what the scheduler is doing, etc.?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464196641, "post_id": 37443477, "comment_id": 62389762, "body": "<code>typedef uint8_t byte_t; &#47;&#47; could have used char</code> ~ could have used <code>unsigned char</code>."}, {"owner": {"reputation": 9795, "user_id": 1566187, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/00cb2ecc49f0f05736dc7c14bbccfeaa?s=128&d=identicon&r=PG", "display_name": "Ely", "link": "https://stackoverflow.com/users/1566187/ely"}, "edited": false, "score": 0, "creation_date": 1464196683, "post_id": 37443477, "comment_id": 62389782, "body": "I think you are trying to do something stupid here: <a href=\"http://stackoverflow.com/q/11326460/1566187\">stackoverflow.com/q/11326460/1566187</a>"}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 1, "creation_date": 1464197053, "post_id": 37443477, "comment_id": 62389985, "body": "<code>Is the 2 bytes the result of the msnibble taking up 1 byte plus the nibble(the enable bit,rs bit and the two blank bits), thus making the size 2 bytes?</code> yes, I cannot refer to standard, but it looks like this internal struct uses additional byte"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1464202140, "post_id": 37443477, "comment_id": 62392856, "body": "Note: &quot;A bit-field shall have a type that is a qualified or unqualified version of <code>_Bool, signed int, unsigned int</code>, or some other implementation-defined type. &#167;6.7.2.1  Using a bit-field with <code>uint8_t</code> is implementation-defined behavior.  A C compliant complier need not even compile this code.  Suggest adding tags of the compiler/platforms of interest."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464202388, "post_id": 37443477, "comment_id": 62393000, "body": "@Weather Vane  for <code>uint8_t</code> to exist, <code>CHAR_BIT</code> must be 8 and so <code>typedef unsigned char byte_t;</code> provide no benefit yet risks incorrect operation when <code>CHAR_BIT &gt; 8</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464202500, "post_id": 37443477, "comment_id": 62393068, "body": "I think the issue is that <code>msnibble</code> needs a computable byte offset, so it must begin on a <code>byte</code> boundary.  So the anonymous <code>struct</code> is 2 bytes."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464202794, "post_id": 37443477, "comment_id": 62393228, "body": "@chux re your quibble about the number of bits in a byte, my point was that <code>char</code> might be signed, but <code>uint8_t</code> is not, no matter how many bits. But the risk of 9 bits in a byte is typically small."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464203358, "post_id": 37443477, "comment_id": 62393499, "body": "@Weather Vane Agree OP&#39;s comment should have been <code>&#47;&#47; could have used unsigned char</code>.  I took <a href=\"http://stackoverflow.com/questions/37443477/why-does-this-union-take-up-2-bytes-even-though-im-aligning-to-one?noredirect=1#comment62389762_37443477\">your comment</a> to suggest <code>typedef unsigned char byte_t; </code>."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1464207763, "post_id": 37443477, "comment_id": 62395803, "body": "Are you asking why bit fields of both structs aren&#39;t joined into a single byte?"}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1464197222, "creation_date": 1464197222, "answer_id": 37443943, "question_id": 37443477, "link": "https://stackoverflow.com/questions/37443477/why-does-this-union-take-up-2-bytes-even-though-im-aligning-to-one/37443943#37443943", "title": "Why does this Union take up 2 bytes even though I&#39;m aligning to one", "body": "<p>Your final question asks if MSVC has 2 bytes for the union: yes it does.</p>\n\n<p>Your union has one variant as <code>struct</code> nested within <code>struct</code>. How could that be 1 byte? Without the union,</p>\n\n<pre><code>#pragma pack(push,1) \n\ntypedef struct {\n    byte_t enable       :1;\n    byte_t rs           :1;\n    byte_t              :1;\n    byte_t              :1;\n    struct \n    {\n        byte_t db4          :1;\n        byte_t db5          :1;\n        byte_t db6          :1;\n        byte_t db7          :1; \n    }msnibble;\n} thatstruct;\n\n#pragma pack(pop)\n</code></pre>\n\n<p>has a size of 2. Where does it say that nested structs can be packed into 1 byte?</p>\n"}, {"tags": [], "owner": {"reputation": 106, "user_id": 6382618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81d0fd7eca6601b53eda58032a011334?s=128&d=identicon&r=PG", "display_name": "owenfromcanada", "link": "https://stackoverflow.com/users/6382618/owenfromcanada"}, "is_accepted": false, "score": -1, "last_activity_date": 1464200033, "creation_date": 1464200033, "answer_id": 37444750, "question_id": 37443477, "link": "https://stackoverflow.com/questions/37443477/why-does-this-union-take-up-2-bytes-even-though-im-aligning-to-one/37444750#37444750", "title": "Why does this Union take up 2 bytes even though I&#39;m aligning to one", "body": "<blockquote>\n  <p>Can structs take up less than 1 byte if they're inside a union?</p>\n</blockquote>\n\n<p>Nope.  Your nested <code>struct</code> takes a full byte, and your outer <code>struct</code> rounds up to two bytes.</p>\n"}], "owner": {"reputation": 427, "user_id": 5450328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ikz0V.jpg?s=128&g=1", "display_name": "Mr. Branch", "link": "https://stackoverflow.com/users/5450328/mr-branch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495310521, "creation_date": 1464195653, "last_edit_date": 1495310521, "question_id": 37443477, "link": "https://stackoverflow.com/questions/37443477/why-does-this-union-take-up-2-bytes-even-though-im-aligning-to-one", "title": "Why does this Union take up 2 bytes even though I&#39;m aligning to one", "body": "<p>I'm modeling a LCD hitachi display parallel port connection (for those interested HD44780, in 4 bit mode).</p>\n\n<p>Even though alignment is set to 1,this union still takes up 2 bytes. If I get rid of the msnibble struct (directly put db4 to db7 in the struct in the union) it takes up 1 byte. Can structs take up less than 1 byte if they're inside a union? Is the 2 bytes the result of the msnibble taking up 1 byte plus the nibble (the enable bit,rs bit and the two blank bits), thus making the size 2 bytes?</p>\n\n<p>Here's the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n\ntypedef uint8_t byte_t;//could have used char\n\n#pragma pack(push,1) \ntypedef union\n{\n    byte_t  whole_port  :8;\n    struct\n    {\n        byte_t enable       :1;\n        byte_t rs           :1;\n        byte_t              :1;\n        byte_t              :1;\n        struct \n        {\n            byte_t db4          :1;\n            byte_t db5          :1;\n            byte_t db6          :1;\n            byte_t db7          :1; \n        }msnibble;\n\n    };\n} para_port_t;\n#pragma pack(pop)\n\nint main(int argc, char** argv) {\n    printf(\"%u\\n\",sizeof(para_port_t));\n    return (EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>I'm working from netbeans in ubuntu compiling with gcc. As pragma is a compiler directive I wanted to know if it's the same in Microsoft Visual Studio?</p>\n"}, {"tags": ["c", "data-structures", "singly-linked-list"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464195296, "post_id": 37443044, "comment_id": 62389027, "body": "Can you show <code>printList()</code> as well?  Adding looks ok as long as the initial node (<code>List</code> in <code>main()</code>) isn&#39;t supposed to hold part of the actual data."}, {"owner": {"reputation": 348, "user_id": 4947646, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/320cd2cf0199f26e85d79fd7705fb0c0?s=128&d=identicon&r=PG&f=1", "display_name": "fedi ", "link": "https://stackoverflow.com/users/4947646/fedi"}, "edited": false, "score": 0, "creation_date": 1464195423, "post_id": 37443044, "comment_id": 62389087, "body": "I just want to ask you, do you want add a new node in the front or in the back of the list ?"}, {"owner": {"reputation": 366, "user_id": 3137910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38afbd6e7529d20c6eefe364a52dba3c?s=128&d=identicon&r=PG&f=1", "display_name": "pingOfDoom", "link": "https://stackoverflow.com/users/3137910/pingofdoom"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464195638, "post_id": 37443044, "comment_id": 62389215, "body": "I add a new node to the front of the list. @Dmitri when I initialize the list, I allocate memory for a node and assign it to the head pointer but i don&#39;t store anything."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1464195697, "post_id": 37443044, "comment_id": 62389252, "body": "To get a full answer, you should post a <a href=\"http://stackoverflow.com/help/mcve\">Minimal Complete Verifiable Example</a>."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464195815, "post_id": 37443044, "comment_id": 62389303, "body": "Problem is in <code>printList()</code>..."}, {"owner": {"reputation": 2219, "user_id": 1521807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ca95c59b3b803d42939dcc34412e5c6?s=128&d=identicon&r=PG", "display_name": "bodangly", "link": "https://stackoverflow.com/users/1521807/bodangly"}, "edited": false, "score": 0, "creation_date": 1464196115, "post_id": 37443044, "comment_id": 62389478, "body": "@pingOfDoom I believe I fixed my answer for you. Pass in a pointer to the Node pointer, then you can modify it properly."}, {"owner": {"reputation": 366, "user_id": 3137910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38afbd6e7529d20c6eefe364a52dba3c?s=128&d=identicon&r=PG&f=1", "display_name": "pingOfDoom", "link": "https://stackoverflow.com/users/3137910/pingofdoom"}, "edited": false, "score": 0, "creation_date": 1464196304, "post_id": 37443044, "comment_id": 62389571, "body": "im getting incompatability errors. *List dereferences it and makes it a Node and it doesn&#39;t like that im passing that to a Node pointer"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464196387, "post_id": 37443044, "comment_id": 62389612, "body": "Again, this call <code>List = original;</code> is useless."}, {"owner": {"reputation": 366, "user_id": 3137910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38afbd6e7529d20c6eefe364a52dba3c?s=128&d=identicon&r=PG&f=1", "display_name": "pingOfDoom", "link": "https://stackoverflow.com/users/3137910/pingofdoom"}, "edited": false, "score": 0, "creation_date": 1464196472, "post_id": 37443044, "comment_id": 62389650, "body": "Doesn&#39;t that &quot;reset&quot; where the List pointer points to back to the beginning of the list?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464196505, "post_id": 37443044, "comment_id": 62389678, "body": "It does, but the change to <code>List</code> never got propagated upwards to the caller, so no need to reset it. <code>List</code> along with it&#39;s value goes away the moment the function is exited. C is pass by value."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464196590, "post_id": 37443044, "comment_id": 62389732, "body": "@pingOfDoom you don&#39;t need to &quot;reset&quot; <code>List</code> because the <code>List</code> from the function arguments is a separate variable local to the function, not the same as the one from <code>main()</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464197152, "post_id": 37443044, "comment_id": 62390032, "body": "And the next time, you debug this yourself using a debugger, don&#39;t you? ;-)"}, {"owner": {"reputation": 366, "user_id": 3137910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38afbd6e7529d20c6eefe364a52dba3c?s=128&d=identicon&r=PG&f=1", "display_name": "pingOfDoom", "link": "https://stackoverflow.com/users/3137910/pingofdoom"}, "edited": false, "score": 0, "creation_date": 1464212039, "post_id": 37443044, "comment_id": 62397841, "body": "Yes of course. Its just that I&#39;m not very adept with those kinds of tools, like gdb or valgrind"}], "answers": [{"comments": [{"owner": {"reputation": 366, "user_id": 3137910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38afbd6e7529d20c6eefe364a52dba3c?s=128&d=identicon&r=PG&f=1", "display_name": "pingOfDoom", "link": "https://stackoverflow.com/users/3137910/pingofdoom"}, "edited": false, "score": 0, "creation_date": 1464194940, "post_id": 37443097, "comment_id": 62388830, "body": "but then doesn&#39;t that just make toAdd-&gt; next = toAdd? When I initialize the list, i allocate some memory for the head. this doesn&#39;t seem correct to me since the head should only point to the first element, but i get warnings otherwise"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464195084, "post_id": 37443097, "comment_id": 62388911, "body": "This statement <code>List = toAdd;</code>  is useless."}, {"owner": {"reputation": 2219, "user_id": 1521807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ca95c59b3b803d42939dcc34412e5c6?s=128&d=identicon&r=PG", "display_name": "bodangly", "link": "https://stackoverflow.com/users/1521807/bodangly"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464195202, "post_id": 37443097, "comment_id": 62388977, "body": "@alk How is it useless? Granted, this is not how I would implement it normally, I would rather return a new list than overwrite List (ie return toAdd)"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464195291, "post_id": 37443097, "comment_id": 62389017, "body": "Doing <code>List = toAdd;</code> just changes the variable <code>List</code> local to <code>addFront()</code> then the function exits. You could just delete <code>List = toAdd;</code>."}, {"owner": {"reputation": 366, "user_id": 3137910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38afbd6e7529d20c6eefe364a52dba3c?s=128&d=identicon&r=PG&f=1", "display_name": "pingOfDoom", "link": "https://stackoverflow.com/users/3137910/pingofdoom"}, "edited": false, "score": 0, "creation_date": 1464195357, "post_id": 37443097, "comment_id": 62389049, "body": "However in doing any of that, now nothing prints out."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464195565, "post_id": 37443097, "comment_id": 62389170, "body": "And this last change isn&#39;t valid as it assigns a <code>Node*</code> to a <code>Node</code>, to which <code>*List</code> evaluates."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464195572, "post_id": 37443097, "comment_id": 62389172, "body": "I think <code>List</code> is just a dummy node and the real list begins at <code>List-&gt;next</code>... in which case his original <code>addFront()</code> looks ok."}, {"owner": {"reputation": 2219, "user_id": 1521807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ca95c59b3b803d42939dcc34412e5c6?s=128&d=identicon&r=PG", "display_name": "bodangly", "link": "https://stackoverflow.com/users/1521807/bodangly"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1464195810, "post_id": 37443097, "comment_id": 62389300, "body": "@alk Yeah fixed that."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464196135, "post_id": 37443097, "comment_id": 62389489, "body": "And finally it might be worth mentioning that calling <code>addFront()</code> now needs to be done differently: <code>addFront(&amp;List,testData[i]);</code>"}], "tags": [], "owner": {"reputation": 2219, "user_id": 1521807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ca95c59b3b803d42939dcc34412e5c6?s=128&d=identicon&r=PG", "display_name": "bodangly", "link": "https://stackoverflow.com/users/1521807/bodangly"}, "is_accepted": false, "score": 3, "last_activity_date": 1464196326, "last_edit_date": 1464196326, "creation_date": 1464194362, "answer_id": 37443097, "question_id": 37443044, "link": "https://stackoverflow.com/questions/37443044/first-element-disappearing-using-linked-lists-in-c/37443097#37443097", "title": "First element disappearing using Linked Lists in C", "body": "<p>You are adding to the front, yet you are setting the next element in <code>toAdd</code> to <code>List-&gt;next</code>. You are skipping the first element.</p>\n\n<p>Furthermore, you are setting <code>List-&gt;next</code> to <code>toAdd</code> afterwards.</p>\n\n<p>What you want to do is this:</p>\n\n<pre><code>void addFront(Node** List, int value)\n{\n    Node * toAdd = initNode(value);\n    toAdd-&gt;next = *List;\n    *List = toAdd;\n}\n</code></pre>\n\n<p>Pass in a pointer to the Node pointer, that allows you to modify the head from within the function.</p>\n\n<p>As per alk's comment, call it this way now: <code>addFront(&amp;List,testData[i]);</code></p>\n"}, {"comments": [{"owner": {"reputation": 366, "user_id": 3137910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38afbd6e7529d20c6eefe364a52dba3c?s=128&d=identicon&r=PG&f=1", "display_name": "pingOfDoom", "link": "https://stackoverflow.com/users/3137910/pingofdoom"}, "edited": false, "score": 0, "creation_date": 1464196769, "post_id": 37443678, "comment_id": 62389826, "body": "Thank you very much for your help. Here I thought it was an issue with my adding function when it turned out to be a problem with what I used to print."}], "tags": [], "owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "is_accepted": true, "score": 2, "last_activity_date": 1464196331, "creation_date": 1464196331, "answer_id": 37443678, "question_id": 37443044, "link": "https://stackoverflow.com/questions/37443044/first-element-disappearing-using-linked-lists-in-c/37443678#37443678", "title": "First element disappearing using Linked Lists in C", "body": "<p>Assuming that the first node is not used for data but only to point to the rest of the list, most of your code looks ok.  The problem is that you're not printing all the nodes in your list.</p>\n\n<p>Inside <code>printList()</code>, you don't need <code>original</code> since <code>List</code> from the function arguments is local anyway... and you need to break the loop when the node you're looking at is <code>NULL</code> instead of when its <code>next</code> node is <code>NULL</code> (since the <code>while</code> test happens before the loop body).</p>\n\n<p>Here's a shortened and corrected version, which also updates the <code>List</code> pointer inside the while condition instead of before the loop and in the loop body.</p>\n\n<pre><code>void printList(Node * List)\n{\n   while ((List = List-&gt;next) != NULL)\n   { \n      printf(\"%d\\n\",List-&gt;value);\n   }\n}\n</code></pre>\n"}], "owner": {"reputation": 366, "user_id": 3137910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38afbd6e7529d20c6eefe364a52dba3c?s=128&d=identicon&r=PG&f=1", "display_name": "pingOfDoom", "link": "https://stackoverflow.com/users/3137910/pingofdoom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 1, "accepted_answer_id": 37443678, "answer_count": 2, "score": 0, "last_activity_date": 1465512654, "creation_date": 1464194168, "last_edit_date": 1465512654, "question_id": 37443044, "link": "https://stackoverflow.com/questions/37443044/first-element-disappearing-using-linked-lists-in-c", "title": "First element disappearing using Linked Lists in C", "body": "<p>I am a beginner learning about data structures and Abstract Data Types in C. I am creating a simple linked-list implementation, but when I try to print the list, I seem to lose the first element. The Node type just consists of an integer and a pointer to itself. </p>\n\n<p>My main file</p>\n\n<pre><code>  int main()\n  {\n     Node * List=createList();\n\n     int testData[] = {1,2,3,4,5,6};\n\n     for (int i = 0 ; i &lt; 6 ; i++)\n     {\n       addFront(List,testData[i]);\n       printList(List);\n       printf(\"\\n\");\n     }\n\n  }\n</code></pre>\n\n<p>addToFront and its supporting initNode are defined thusly:</p>\n\n<pre><code> void addFront(Node * List, int value)\n {\n    Node * toAdd = initNode(value);\n\n    toAdd-&gt; next = List-&gt;next;\n\n    List-&gt;next = toAdd;\n }\n\n\n\n Node * initNode(int val)\n {\n    Node * newNode = malloc(sizeof(Node));\n    newNode -&gt; value = val;\n    newNode-&gt; next = NULL;\n\n    return newNode;\n }\n</code></pre>\n\n<p>EDIT: As per request, printList() is:</p>\n\n<pre><code>  void printList(Node * List)\n  {\n     Node * original = List-&gt;next;\n\n     while (List-&gt;next != NULL)\n     { \n        printf(\"%d\\n\",List-&gt;value);\n        List = List -&gt;next;\n     }\n\n     List = original;\n  }\n</code></pre>\n\n<p>Any ideas of what could be wrong? </p>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1464191259, "post_id": 37441994, "comment_id": 62386510, "body": "Try <code>#define create_array(N, ...) uint8_t my_entries ## N = __VA_ARGS__</code>"}, {"owner": {"reputation": 513, "user_id": 5432899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fRtnb.png?s=128&g=1", "display_name": "Simonlbc", "link": "https://stackoverflow.com/users/5432899/simonlbc"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1464191522, "post_id": 37441994, "comment_id": 62386730, "body": "that worked thanks!! Never had an answer so fast before, you should write that as an answer so that I give you the nice green arrow :)"}], "owner": {"reputation": 513, "user_id": 5432899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fRtnb.png?s=128&g=1", "display_name": "Simonlbc", "link": "https://stackoverflow.com/users/5432899/simonlbc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "closed_date": 1464191752, "answer_count": 0, "score": 0, "last_activity_date": 1464191111, "creation_date": 1464191111, "question_id": 37441994, "link": "https://stackoverflow.com/questions/37441994/passing-array-initial-values-to-a-c-macro", "closed_reason": "Duplicate", "title": "passing array initial values to a C macro", "body": "<p>I have been trying to define a macro <code>create_array</code> that \nwould behave such that for example</p>\n\n<p><code>create_array(1, {7, 2, 10, 32})</code> would expand to:</p>\n\n<pre><code> uint8_t my_entries1 [] = \n {7, 2, 10, 32} ; \n</code></pre>\n\n<p>or <code>create_array(2, {7, 2, 10, 32})</code> to:</p>\n\n<pre><code> uint8_t my_entries2 [] = \n {7, 2, 10, 32} ; \n</code></pre>\n\n<p>my attempt at that was the following code:</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n\n#define create_array(the_test_nb, initial_arr_values) \\\n     uint8_t my_entries ## the_test_nb [] =  \\\n     initial_arr_values ; \n\nint main()\n{\n    create_array(1, {0x22, 0x2A, 0x2B, 0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00});\n}\n</code></pre>\n\n<p>unfortunately the magic didn't happen and I got an error at compile time:</p>\n\n<pre><code>simonlbc@simonlbc-ThinkPad-T440s:~/workspace/CCode/os$ gcc reproducible.c \nreproducible.c: In function \u2018main\u2019:\nreproducible.c:9:186: error: macro \"create_array\" passed 33 arguments, but takes just 2\n 0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00});\n                                                                                                  ^\nreproducible.c:9:5: error: \u2018create_array\u2019 undeclared (first use in this function)\n     create_array(1, {0x22, 0x2A, 0x2B, 0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00\n     ^\nreproducible.c:9:5: note: each undeclared identifier is reported only once for each function it appears in\n</code></pre>\n\n<p>how can I can I define my macro so that I can call it like</p>\n\n<pre><code>create_array(1, {0x22, 0x2A, 0x2B, ...,0x00,0x00});\n</code></pre>\n\n<p>and keep on writing less code?</p>\n"}, {"tags": ["c++", "c", "string", "pointers"], "comments": [{"owner": {"reputation": 13521, "user_id": 654953, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f6453f58b70e93dbfa8998b71a95bb09?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/654953/ryan"}, "edited": false, "score": 0, "creation_date": 1464187787, "post_id": 37440655, "comment_id": 62383857, "body": "you&#39;re off by one if you&#39;re trying to do <code>C</code> strings."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 2, "creation_date": 1464187893, "post_id": 37440655, "comment_id": 62383937, "body": "You forgot a third option: <code>char str[] = &quot;Hello World&quot;</code>."}, {"owner": {"reputation": 59234, "user_id": 496161, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c425873f547d93f4079ca252b42a886d?s=128&d=identicon&r=PG", "display_name": "TartanLlama", "link": "https://stackoverflow.com/users/496161/tartanllama"}, "edited": false, "score": 0, "creation_date": 1464187937, "post_id": 37440655, "comment_id": 62383973, "body": "Note that method 1 is not allowed in C++11, it would have to be <code>const char*</code>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464188034, "post_id": 37440655, "comment_id": 62384035, "body": "There is absolutely no reason NOT to use <code>std::string</code>. Also, as many commented even though <code>char *string = &quot;string literal&quot;;</code> is legal in <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> for example, it&#39;s still a bad idea because string literals are read only, and writing to read only memory will invoke undefined behaviour."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464190118, "post_id": 37440701, "comment_id": 62385647, "body": "&quot;the content of the memory address cannot be modified.&quot; is better as &quot;attempting to modify the memory is UB&quot;.  C does not specify the memory cannot be modified, only that the attempted modification is UB."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464190400, "post_id": 37440701, "comment_id": 62385842, "body": "@chux modified the wordings, should be OK now. Thanks."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1464190359, "last_edit_date": 1464190359, "creation_date": 1464187840, "answer_id": 37440701, "question_id": 37440655, "link": "https://stackoverflow.com/questions/37440655/direct-assignment-vs-dynamic-allocation-for-char-string/37440701#37440701", "title": "Direct assignment vs Dynamic allocation for char * string", "body": "<p>In case of the first approach</p>\n\n<pre><code> char * str = \"Hello World\";\n</code></pre>\n\n<p>you are storing the address of the <a href=\"https://en.wikipedia.org/wiki/String_literal\" rel=\"nofollow\"><em>string literal</em></a> into the given pointer. However, due to the mismatch of the type <code>const char[]</code> vs <code>char *</code>, this construct is illegal.</p>\n\n<p>Remember, the content of the memory address should not be modified, attempt to do so will invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>. Also, you don't need to <em>free</em> anything, as you did not <em>allocate</em> any dynamic memory.</p>\n\n<p>In the second approach, </p>\n\n<pre><code>char * str = new char [12];\nstrcpy(str,\"Hellow World\");\n</code></pre>\n\n<p>you are allocating dynamic memory to the pointer and filling that with the content of the <em>string literal</em>. This array is perfectly writable. However, point to notice, for a dimension of <code>12</code>, you don't have a space for null-terminator. You may want to make the size at least <code>13</code> to have room for the null-terminator. Finally, you need to free-up the allocated memory after the usage.</p>\n"}, {"comments": [{"owner": {"reputation": 198, "user_id": 3497401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16440fd492f49c0e9978f3c1df0d67c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/3497401/leon"}, "edited": false, "score": 0, "creation_date": 1464188107, "post_id": 37440717, "comment_id": 62384094, "body": "Actually I am programming using WinAPI with tchar string in VS2015, and method 1 compiles perfectly. The std::string is terrible with Unicode handling (imagine you have two projects in a solution, one with Unicode other with multi-byte, and these two projects use the same library. Inside this library, it is good to use tchar. std string you must explicitly tell which version it is). Anyway I am very familiar with std string as well. Thanks for the info."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 198, "user_id": 3497401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16440fd492f49c0e9978f3c1df0d67c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/3497401/leon"}, "edited": false, "score": 1, "creation_date": 1464188153, "post_id": 37440717, "comment_id": 62384129, "body": "@Leon <i>&quot;The std::string is terrible with Unicode string&quot;</i> Use <code>std::wstring</code> then."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 198, "user_id": 3497401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16440fd492f49c0e9978f3c1df0d67c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/3497401/leon"}, "edited": false, "score": 2, "creation_date": 1464188163, "post_id": 37440717, "comment_id": 62384143, "body": "@Leon Then you need to tell us about that.  We cannot know what you are doing if you do not tell us."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464188770, "post_id": 37440717, "comment_id": 62384641, "body": "I am terribly sorry for the downvote. Now that I read it again I get it and you&#39;re 100% right. Please let&#39;s remove the useless comments?"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 5, "last_activity_date": 1464188455, "last_edit_date": 1464188455, "creation_date": 1464187874, "answer_id": 37440717, "question_id": 37440655, "link": "https://stackoverflow.com/questions/37440655/direct-assignment-vs-dynamic-allocation-for-char-string/37440717#37440717", "title": "Direct assignment vs Dynamic allocation for char * string", "body": "<pre><code>char * str = \"Hello World\";\n</code></pre>\n\n<p>Is deprecated in C++ as it violates const correctness.  <code>\"Hello World\"</code> is a <code>const char[]</code> and pointing to it with a <code>char*</code> is an invitation to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a> as you could try to modify it.  If you want to work with strings in C++ I suggest you use <code>std::string</code> which prevents you from falling into the numerous pitfalls c-strings have.</p>\n\n<p>If you do need a c-string then you can use</p>\n\n<pre><code>char str[] = \"Hello World\";\n</code></pre>\n\n<p>Which will create a char array of the correct length and allow you to modify the contents.</p>\n\n<blockquote>\n  <p>Edit: Actually I am programming using WinAPI with tchar string in VS2015, and method 1 compiles perfectly. The std::string is terrible with Unicode handling.</p>\n</blockquote>\n\n<p>There is nothing stopping method one from compiling on the majority of compilers but if you want to be standard conforming then you need stop using it.  It is deprecated and eventually(hopefully) compiler support for it will be removed.</p>\n\n<p>If you need Unicode support then use a <code>std::wstring</code> which wraps a <code>wchar_t*</code></p>\n"}, {"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464188269, "post_id": 37440786, "comment_id": 62384232, "body": "Arrays can be initialized with string literals so <code>char str[] = &quot;Hello World&quot;;</code> is both valid and correct. The resulting array can be modifier but cannot be resized, just as you can&#39;t resize memory allocated with the <code>new</code> operator. For <code>char *</code> pointers I would use <code>malloc()</code> on <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> because it does not have a constructor so you will have the advantage of calling <code>realloc()</code> if needed."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464189611, "post_id": 37440786, "comment_id": 62385278, "body": "@iharob I agree, except that I would use <code>std::string</code> if I need a string with dynamic allocation."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464189809, "post_id": 37440786, "comment_id": 62385436, "body": "Minor point: IMO an important distinction for experimenters.  &quot;You may not change the content of the string literal.&quot; is not specified by the language -  it <i>may</i> work - it may not, code may crash.  As you imply, <i>attempting</i> to do so is UB."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464190074, "post_id": 37440786, "comment_id": 62385625, "body": "@user2079303 Yes that&#39;s 100% true. It would be way more efficient and more <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a>ish. Also, it would avoid the hell of dealing with memory allocation and deallocation."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464190388, "post_id": 37440786, "comment_id": 62385836, "body": "@chux true I suppose. I didn&#39;t technically say &quot;standard says that you may not...&quot;, but it was implied. I guess I was projecting the limitation that I put on myself to never do UB. The answer should be correct now."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1464191231, "last_edit_date": 1464191231, "creation_date": 1464188070, "answer_id": 37440786, "question_id": 37440655, "link": "https://stackoverflow.com/questions/37440655/direct-assignment-vs-dynamic-allocation-for-char-string/37440786#37440786", "title": "Direct assignment vs Dynamic allocation for char * string", "body": "<p>My answer concerns c++. Some details are different from c.</p>\n\n<blockquote>\n  <ol>\n  <li>What's the fundamental difference between these two methods? Any advantages/disadvantages?</li>\n  </ol>\n</blockquote>\n\n<p>Let's take a look at your first code:</p>\n\n<pre><code>char * str = \"Hello World\";\n</code></pre>\n\n<p>This is ill formed. You may not assign a string literal to a non-const pointer. At least not since c++11. Prior to that the conversion was merely deprecated.</p>\n\n<p>This:</p>\n\n<pre><code>const char* str = \"Hello World\";\n</code></pre>\n\n<p>Would be correct. But, if you need to modify the string, then this is not an option.</p>\n\n<blockquote>\n  <p>Edit: Actually I am programming using WinAPI with tchar string in VS2015, and method 1 compiles perfectly.</p>\n</blockquote>\n\n<p>Even if your compiler supports the conversion, doing so is quite dangerous because you may accidentally end up modifying the string literal, which is bad because<sup>\u2020</sup></p>\n\n<p>Let's see your second code:</p>\n\n<p><strike></p>\n\n<pre><code>char * str = new char [12];\nstrcpy(str,\"Hellow World\");\n</code></pre>\n\n<p>This invokes undefined behaviour. The string literal is 13 characters long (because of the null terminal character) and the <code>strcpy</code> overflows the allocated array.\n</strike></p>\n\n<p>Edit: The code in question is fixed now, but this demonstrates well, why manually specifying the size is error prone.</p>\n\n<p>I recommend a simpler approach:</p>\n\n<pre><code>char str[] = \"Hello World\";\n</code></pre>\n\n<p>This is more concise, and leaves no possibility of using a wrong sized array. It is also more efficient than dynamic allocation, but not as efficient as using the string literal directly. However, unlike a string literal, you may modify this array.</p>\n\n<p>If the array is local, then it is destroyed at the end of scope. Also, you can not resize the array. If you need a resizeable string, then you do need dynamic allocation. I recommend <code>std::string</code> if you need dynamic allocation:</p>\n\n<pre><code>std::string str(\"Hello World\");\n</code></pre>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Should I clean the memory manually for method 1?</li>\n  </ol>\n</blockquote>\n\n<p>No, you should not. String literals have static storage.</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>What is the life span for the string in method 1? Can I trust it to persist as long as the pointer is still valid?</li>\n  </ol>\n</blockquote>\n\n<p>You can trust that the string literal exits throughout the entire execution of your program.</p>\n\n<blockquote>\n  <p>Can I change the content (provided I do not run over the '\\0' at the end)?</p>\n</blockquote>\n\n<p><sup>\u2020</sup> Modifying a string literal would have undefined behaviour. You don't want undefined behaviour anywhere near your program.</p>\n\n<blockquote>\n  <p>The std::string is terrible with Unicode handling.</p>\n</blockquote>\n\n<p><code>std::string</code> has exactly the same unicode handling as plain character arrays do.</p>\n\n<blockquote>\n  <p>Imagine you have two projects in a solution, one with Unicode other with multi-byte, and these two projects use the same library. Inside this library, it is good to use tchar. std string you must explicitly tell which version it is.</p>\n</blockquote>\n\n<p>I would avoid using <code>tchar</code> at all except when dealing with windows API. But if you do use it and need the niceties of <code>std::string</code>, then you can simply use <code>std::basic_string&lt;tchar&gt;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 198, "user_id": 3497401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16440fd492f49c0e9978f3c1df0d67c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/3497401/leon"}, "edited": false, "score": 0, "creation_date": 1464189233, "post_id": 37440947, "comment_id": 62385014, "body": "Really appreciate this knowledge on the fact that string literal content is constant and it is stored as static. Maybe it is due to my bad English that others do not get my question, but this is the answer I need. Thank you."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 3, "last_activity_date": 1464351021, "last_edit_date": 1464351021, "creation_date": 1464188465, "answer_id": 37440947, "question_id": 37440655, "link": "https://stackoverflow.com/questions/37440655/direct-assignment-vs-dynamic-allocation-for-char-string/37440947#37440947", "title": "Direct assignment vs Dynamic allocation for char * string", "body": "<p>In this declaration</p>\n\n<pre><code>char * str = \"Hello World\";\n</code></pre>\n\n<p>that is valid for C and is not valid for C++ there are created two objects.</p>\n\n<p>First of all the compiler creates a zero-terminated character array with the static storage duration for string literal <code>\"Hello World\"</code>. </p>\n\n<p>Ib C string literals have types of non-constant character arrays while in C++ string literals have types of constant character arrays.</p>\n\n<p>Nevertheless neither in C nor in C++ you may modify a string literal. Any attempt to modify a string literal results in undefined behavior. </p>\n\n<p>That means also that you may not clear the memory occupied by a string literal. It is the compiler that reserves the memory for a string literal.</p>\n\n<p>In C the string literal used in the declaration has type <code>char[12]</code> while in C++ it has type <code>const char[12]</code>.</p>\n\n<p>Thus in C++ the declaration will look like</p>\n\n<pre><code>const char * str = \"Hello World\";\n</code></pre>\n\n<p>The second object that is created in the declaration is the pointer named <code>str</code> that points to the first character of the string literal.  The pointer itself can be changed that is it can be reassigned.</p>\n\n<p>If the pointer is declared in a code block then it has the automatic storage duration. The storage duration of the pointer does not influence on the storage duration of the string literal that has as mentioned above the static storage duration.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1464189940, "creation_date": 1464189940, "answer_id": 37441532, "question_id": 37440655, "link": "https://stackoverflow.com/questions/37440655/direct-assignment-vs-dynamic-allocation-for-char-string/37441532#37441532", "title": "Direct assignment vs Dynamic allocation for char * string", "body": "<blockquote>\n  <p>What is the life span for the string in method 1?</p>\n</blockquote>\n\n<p>For the string literal itself, the lifetime of the program; storage for the literal is allocated when the program starts (maybe even as soon as the program is loaded into memory) and released when the program exits.</p>\n\n<blockquote>\n  <p>Can I trust it to persist as long as the pointer is still valid? </p>\n</blockquote>\n\n<p>You can trust the literal to persist regardless of the lifetime of the pointer variable <code>str</code>.</p>\n\n<blockquote>\n  <p>Can I change the content (provided I do not run over the '\\0' at the end)?</p>\n</blockquote>\n\n<p>No.  C++ string literals are arrays of <code>const char</code>, meaning they cannot be modified (which would defeat the entire purpose of them being a <em>literal</em>; it's logically the same thing as changing the content of <code>42</code>).  </p>\n\n<blockquote>\n  <p>What's the fundamental difference between these two methods? </p>\n</blockquote>\n\n<p>The first method does not set aside any new memory, and the contents of what <code>str</code> points to may not be modified.  </p>\n\n<p>The second method dynamically allocates a new block of memory and copies the <em>contents</em> of the string literal to it; you may modify the contents of the allocated block to your heart's content.</p>\n\n<blockquote>\n  <p>Any advantages/disadvantages?</p>\n</blockquote>\n\n<p>Use the first method to create symbolic constants for string literals (which you <em>want</em> to do - I've been burned by misspelling literals more than once).  </p>\n\n<p>There aren't many good use cases for the second method; if you need to manipulate text data, use the <code>std::string</code> type instead of arrays of <code>char</code>.  C-style string handling is a <em>massive pain in the ass</em>, and the <code>std::string</code> type makes life <em>much</em> easier in that respect.  If you need to create and store multiple strings, use a standard container like <code>std::vector</code>.  </p>\n"}], "owner": {"reputation": 198, "user_id": 3497401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16440fd492f49c0e9978f3c1df0d67c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/3497401/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1739, "favorite_count": 0, "accepted_answer_id": 37440947, "answer_count": 5, "score": 1, "last_activity_date": 1464351254, "creation_date": 1464187697, "last_edit_date": 1464351254, "question_id": 37440655, "link": "https://stackoverflow.com/questions/37440655/direct-assignment-vs-dynamic-allocation-for-char-string", "title": "Direct assignment vs Dynamic allocation for char * string", "body": "<p>I have being using C++ for quite some time now, but there is one fundamental concept that I could not get it.  First I will list two ways of assigning a text string to a char *.</p>\n\n<p>Method 1:</p>\n\n<pre><code>char * str = \"Hello World\";\n</code></pre>\n\n<p>Method 2:</p>\n\n<pre><code>char * str = new char [12];\nstrcpy(str,\"Hello World\");\n</code></pre>\n\n<p>I am very familiar with method 2.  Method 1 is the one that gives me headache.  My questions are</p>\n\n<ol>\n<li>What's the fundamental difference between these two methods?  Any advantages/disadvantages?</li>\n<li>Should I clean the memory manually for method 1?</li>\n<li>What is the life span for the string in method 1?  Can I trust it to persist as long as the pointer is still valid?  Can I change the content (provided I do not run over the '\\0' at the end)?</li>\n</ol>\n\n<p>I have read countless C++ textbooks and articles. They all tell me method 1 works with no elaboration on the repercussions. My own experimentation does not yield convincing results.</p>\n\n<p>Thank you (and maybe excuse me for my bad English)</p>\n\n<p><em>Edit</em>:\nActually I am programming using WinAPI with tchar string in VS2015, and method 1 compiles perfectly. The std::string is terrible with Unicode handling.</p>\n\n<p>Imagine you have two projects in a solution, one with Unicode other with multi-byte, and these two projects use the same library. Inside this library, it is good to use tchar. std string you must explicitly tell which version it is.</p>\n\n<p>I have to do this because the multi-byte project is a dll I need to inject into another app. The unicode version of the DLL will crash the app, only the multi-byte works.</p>\n"}, {"tags": ["c", "windows", "driver", "filter-driver"], "comments": [{"owner": {"reputation": 1992, "user_id": 693963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec5403dd4d2945335211ed635425f979?s=128&d=identicon&r=PG", "display_name": "K.Steff", "link": "https://stackoverflow.com/users/693963/k-steff"}, "edited": false, "score": 0, "creation_date": 1464185044, "post_id": 37439436, "comment_id": 62381541, "body": "I am receiving a downvote without a comment. I find this quite disturbing - if someone would like to comment why this is not a good question or provide criticism, please do so, it is quite strongly encouraged by the site rules."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 3, "creation_date": 1464185252, "post_id": 37439436, "comment_id": 62381712, "body": "It might very well be a bug. I also think that your question is fine. It&#39;s one of the best i&#39;ve seen so I too don&#39;t understand the downvote."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464185331, "post_id": 37439436, "comment_id": 62381779, "body": "&quot;<i>comparisons are made with this result</i>&quot; on the pointer <b>value</b> returned?"}, {"owner": {"reputation": 1992, "user_id": 693963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec5403dd4d2945335211ed635425f979?s=128&d=identicon&r=PG", "display_name": "K.Steff", "link": "https://stackoverflow.com/users/693963/k-steff"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464185573, "post_id": 37439436, "comment_id": 62382015, "body": "@alk I just edited the question to hopefully better reflect that the <i>pointers</i> are compared"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1464192049, "post_id": 37439436, "comment_id": 62387112, "body": "NMDV, but where is the rule about &quot;it is quite strongly encouraged by the site rules.&quot;? Did not find that <a href=\"http://stackoverflow.com/help/privileges/vote-down\">here</a>"}, {"owner": {"reputation": 1992, "user_id": 693963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec5403dd4d2945335211ed635425f979?s=128&d=identicon&r=PG", "display_name": "K.Steff", "link": "https://stackoverflow.com/users/693963/k-steff"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464344046, "post_id": 37439436, "comment_id": 62458405, "body": "@chux From <a href=\"http://stackoverflow.com/help/privileges/vote-down\">stackoverflow.com/help/privileges/vote-down</a> : &quot;Down-voting should be reserved for extreme cases. It&#39;s not meant as a substitute for communication and editing. Instead of voting down: [...] If something is wrong, please leave a comment or edit the post to correct it.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1992, "user_id": 693963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec5403dd4d2945335211ed635425f979?s=128&d=identicon&r=PG", "display_name": "K.Steff", "link": "https://stackoverflow.com/users/693963/k-steff"}, "edited": false, "score": 0, "creation_date": 1464191195, "post_id": 37441298, "comment_id": 62386462, "body": "Thanks for the answer. Can you provide a definitive source for this? While the documentation somewhat suggests it (by using <b>the</b> instead of <b>a</b>), I can&#39;t find anything else on this topic."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1464234710, "post_id": 37441298, "comment_id": 62403768, "body": "Self-evident, so unlikely to be explicitly documented."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1464238908, "post_id": 37441298, "comment_id": 62404906, "body": "(To clarify that: this is the sort of thing that in my experience Microsoft considers self-evident and are unlikely to explicitly document.  I didn&#39;t mean to imply that it <i>shouldn&#39;t</i> have been documented or that it was a silly question.)"}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": true, "score": 4, "last_activity_date": 1464189355, "creation_date": 1464189355, "answer_id": 37441298, "question_id": 37439436, "link": "https://stackoverflow.com/questions/37439436/is-it-ok-to-compare-peprocess-values/37441298#37441298", "title": "Is it OK to compare PEPROCESS values?", "body": "<p>Yes, this is pretty much correct. The documentation of <code>EPROCESS</code> makes it clear that there is one such object per process, and any <code>PEPROCESS</code> points to this. This means <code>PsGetCurrentProcess()</code> does't return a pointer to <em>an</em> <code>EPROCESS</code> but to <em>the</em> <code>EPROCESS</code>. And two pointers compare equal if they point to the same object. </p>\n"}], "owner": {"reputation": 1992, "user_id": 693963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec5403dd4d2945335211ed635425f979?s=128&d=identicon&r=PG", "display_name": "K.Steff", "link": "https://stackoverflow.com/users/693963/k-steff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 1, "accepted_answer_id": 37441298, "answer_count": 1, "score": 9, "last_activity_date": 1464189355, "creation_date": 1464184748, "last_edit_date": 1464185547, "question_id": 37439436, "link": "https://stackoverflow.com/questions/37439436/is-it-ok-to-compare-peprocess-values", "title": "Is it OK to compare PEPROCESS values?", "body": "<p>I am \"reviewing\" some code that was written well before me and I'm noticing a pattern that I have some doubts about:</p>\n\n<p>The result of the <code>PsGetCurrentProcess()</code> function is stored and then comparisons are made with that pointer (which is a pointer to an <code>EPROCESS</code> struct).\nHowever, I'm not finding anything in the documentation, which suggests this function is guaranteed to return the same pointer each time. What is much more surprising to me is that this code has been apparently working for a long time.</p>\n\n<p>Is this a bug, and would you recommend changing that logic to e.g. comparing Process IDs (Using PsGetProcessId)?</p>\n"}, {"tags": ["c", "floating-point", "ieee-754", "single-precision"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464184466, "post_id": 37439180, "comment_id": 62381092, "body": "I have no idea what <code>hex2float</code> does, as you don&#39;t even mention the library you are using. But I am pretty sure it is not taking <code>int</code>s.."}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464184699, "post_id": 37439180, "comment_id": 62381278, "body": "@EugeneSh.: <code>hex2float</code>&#39;s definition is in the posted code."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1464184735, "post_id": 37439180, "comment_id": 62381302, "body": "Oh. missed it. Strict aliasing violation."}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464184760, "post_id": 37439180, "comment_id": 62381326, "body": "@EugeneSh.: Of course, but well defined in all actual practice."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1464184828, "post_id": 37439180, "comment_id": 62381373, "body": "Anyway, bad function naming. It has nothing to do with <code>hex</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464184903, "post_id": 37439180, "comment_id": 62381419, "body": "Should definitely be named <code>int2float()</code>, as there is not data type <code>hex</code>."}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464184919, "post_id": 37439180, "comment_id": 62381431, "body": "@EugeneSh.: I agree, but that has very little to do with the actual question. :)"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464184954, "post_id": 37439180, "comment_id": 62381464, "body": "And any ways, this is UB. (<a href=\"http://stackoverflow.com/q/98650/694576\">stackoverflow.com/q/98650/694576</a>)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1464184967, "post_id": 37439180, "comment_id": 62381476, "body": "@Dolda2000 Yeah, just commenting :) Had to figure it out before looking at the actual problem.."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464185013, "post_id": 37439180, "comment_id": 62381514, "body": "@alk ok, let&#39;s assume it is not for a moment.."}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464185070, "post_id": 37439180, "comment_id": 62381563, "body": "@alk: If you&#39;re referring to the pointer aliasing, then perhaps it is, but that is not the cause of the behavior being asked about."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464185092, "post_id": 37439180, "comment_id": 62381578, "body": "So what is the actual result?"}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464185147, "post_id": 37439180, "comment_id": 62381626, "body": "@EugeneSh.: Having tested it, the result is <code>MAXFLOAT</code>, just like <code>a</code> and <code>b</code> are."}, {"owner": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 0, "creation_date": 1464185647, "post_id": 37439180, "comment_id": 62382072, "body": "Isn&#39;t that what you would expect in round-to-zero? The real number result of the addition is bigger than any finite float, but gets rounded to the largest magnitude float that is no further from zero, MAXFLOAT."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464185664, "post_id": 37439180, "comment_id": 62382090, "body": "I think <a href=\"http://www.gnu.org/software/libc/manual/html_node/Rounding.html\" rel=\"nofollow noreferrer\">this</a> is pretty comprehensive..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1464185938, "post_id": 37439180, "comment_id": 62382301, "body": "And as for limit constants, you should use predefined macros instead of making obscure pointer magic: <a href=\"http://en.cppreference.com/w/c/types/limits\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/types/limits</a>"}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "reply_to_user": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 0, "creation_date": 1464186230, "post_id": 37439180, "comment_id": 62382546, "body": "@PatriciaShanahan: By that logic, you could also argue that <code>FE_TONEAREST</code> rounding should also have <code>MAXFLOAT + MAXFLOAT == MAXFLOAT</code>, since any finite result will be mathematically &quot;nearer&quot; to <code>MAXFLOAT</code> than to infinity. ;)"}, {"owner": {"reputation": 89, "user_id": 4361479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/736559506/picture?type=large", "display_name": "Shay Golan", "link": "https://stackoverflow.com/users/4361479/shay-golan"}, "edited": false, "score": 0, "creation_date": 1464186422, "post_id": 37439180, "comment_id": 62382715, "body": "Thank you all. By the way, I use the name hex2float as opposed to int2float, because the conversion is not done between integer and float. i.e: 7 to 7.0. It is done from the binary (or hexadecimal) representation of the float type to a floating point type."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464186800, "post_id": 37439180, "comment_id": 62383019, "body": "@ShayGolan Binary/hexadecimal/decimal/octal or any other representations are absolutely equivalent. Why are you discriminating decimal while saying &quot; the binary (or hexadecimal)&quot;?"}, {"owner": {"reputation": 89, "user_id": 4361479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/736559506/picture?type=large", "display_name": "Shay Golan", "link": "https://stackoverflow.com/users/4361479/shay-golan"}, "edited": false, "score": 0, "creation_date": 1464187218, "post_id": 37439180, "comment_id": 62383396, "body": "Yes, you have a point. But I preferred to name the function in this way to avoid confusion with conversion between integer and float."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464189033, "post_id": 37439180, "comment_id": 62384874, "body": "Using <code>float a = FLT_MAX;</code> would have avoided the distracting discussion about <code>hex2float()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "is_accepted": true, "score": 6, "last_activity_date": 1464185738, "last_edit_date": 1592644375, "creation_date": 1464185738, "answer_id": 37439842, "question_id": 37439180, "link": "https://stackoverflow.com/questions/37439180/c-adding-two-single-precision-floating-point-normal-numbers-cant-get-result/37439842#37439842", "title": "C - adding two single-precision floating point normal numbers, can&#39;t get result to infinity", "body": "<p>The explanation for the observed behavior is that it is mandated by the IEEE 754-2008 floating-point standard:</p>\n<blockquote>\n<p><strong>7.4 Overflow</strong></p>\n<p>The overflow exception shall be signaled if and only if the destination format\u2019s largest finite number is exceeded in magnitude by what would have been the rounded floating-point result (see 4) were the exponent range unbounded. The default result shall be determined by the rounding-direction attribute and the sign of the intermediate result as follows:</p>\n<p>[...]</p>\n<p>b) roundTowardZero carries all overflows to the format\u2019s largest finite\nnumber with the sign of the intermediate result.</p>\n</blockquote>\n<p>So for the rounding mode used here (truncation, or rounding towards zero), the result in case of overflow is the largest finite number, <em>not</em> infinity.</p>\n"}], "owner": {"reputation": 89, "user_id": 4361479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/736559506/picture?type=large", "display_name": "Shay Golan", "link": "https://stackoverflow.com/users/4361479/shay-golan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 37439842, "answer_count": 1, "score": 3, "last_activity_date": 1464188796, "creation_date": 1464184105, "last_edit_date": 1464188796, "question_id": 37439180, "link": "https://stackoverflow.com/questions/37439180/c-adding-two-single-precision-floating-point-normal-numbers-cant-get-result", "title": "C - adding two single-precision floating point normal numbers, can&#39;t get result to infinity", "body": "<p>I'm playing around with floating-point arithmetic, and I encountered something which needs explaining.</p>\n\n<p>When setting rounding mode to 'towards zero', aka:</p>\n\n<pre><code>fesetround(FE_TOWARDZERO);\n</code></pre>\n\n<p>And adding different kind of normal positive numbers, I can never reach Infinity.</p>\n\n<p>However, it is known from the ieee 745 that overflow to infinity can result from adding finite numbers.</p>\n\n<p>For instance:</p>\n\n<pre><code>#include &lt;fenv.h&gt;\n#include &lt;stdio.h&gt;\n\nfloat hex2float (int hex_num) {\n  return *(float*)&amp;hex_num;\n}\n\nvoid main() {\n  int a_int = 0x7f7fffff; // Maximum finite single precision number, about 3.4E38\n  int b_int = 0x7f7fffff;\n  float a = hex2float(a_int);\n  float b = hex2float(b_int);\n  float res_add;\n\n  fesetround(FE_TOWARDZERO);  // need to include fenv.h for that\n  printf(\"Calculating... %+e + %+e\\n\",a,b);\n  res_add = a + b;\n  printf(\"Res = %+e\\n\",res_add);\n}\n</code></pre>\n\n<p>However, If i change rounding mode to something other, I might get a +INF as the answer.</p>\n\n<blockquote>\n  <p>Can someone explain this?</p>\n</blockquote>\n"}, {"tags": ["c", "graph", "adjacency-list"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1464183866, "post_id": 37438925, "comment_id": 62380589, "body": "Because it&#39;s less costly in terms of CPU time to double the size each time you need more memory instead of adding just 1 to the size. In the latter case <code>realloc</code> will be called for each newly added edge, and <code>realloc</code> is pretty expensive. Imagine you have 100 edges: realloc will be called 100 times, but if you double the size it will only be called log2(100) times."}, {"owner": {"reputation": 5681, "user_id": 1150918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81acdd9b6273c7860ac440c99eb747c?s=128&d=identicon&r=PG", "display_name": "Kamiccolo", "link": "https://stackoverflow.com/users/1150918/kamiccolo"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1464188323, "post_id": 37438925, "comment_id": 62384282, "body": "@MichaelWalz could You please Your comment to answer section to be accepted?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 5681, "user_id": 1150918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81acdd9b6273c7860ac440c99eb747c?s=128&d=identicon&r=PG", "display_name": "Kamiccolo", "link": "https://stackoverflow.com/users/1150918/kamiccolo"}, "edited": false, "score": 0, "creation_date": 1464188611, "post_id": 37438925, "comment_id": 62384513, "body": "@Kamiccolo done, thanks"}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1464188593, "creation_date": 1464188593, "answer_id": 37440995, "question_id": 37438925, "link": "https://stackoverflow.com/questions/37438925/c-graph-adjacency-list-implementation-growing-neighbour-array/37440995#37440995", "title": "C graph adjacency list implementation growing neighbour array", "body": "<p>Because it's less costly in terms of CPU time to double the size each time you need more memory instead of adding just 1 to the size.</p>\n\n<p>In the latter case <code>realloc</code> will be called for each newly added edge, and <code>realloc</code> is pretty expensive. Imagine you have 128 edges: <code>realloc</code> will be called 128 times, but if you double the size each time, it will only be called 7 <code>= log2(128)</code> times.</p>\n\n<p>Furthermore <code>realloc</code> will most likely be slower the longer the original memory portion is, because <code>realloc</code> will potentially copy the old memory portion buffer to a new larger one, and the longer the portion, the longer the copying will take.</p>\n"}], "owner": {"reputation": 103, "user_id": 4337224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/866425b706ac227f9391b76159f87846?s=128&d=identicon&r=PG&f=1", "display_name": "Prog", "link": "https://stackoverflow.com/users/4337224/prog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 37440995, "answer_count": 1, "score": 1, "last_activity_date": 1464188593, "creation_date": 1464183446, "last_edit_date": 1464183520, "question_id": 37438925, "link": "https://stackoverflow.com/questions/37438925/c-graph-adjacency-list-implementation-growing-neighbour-array", "title": "C graph adjacency list implementation growing neighbour array", "body": "<p>I found an implementation and was going throught the code and one part seems unclear to me.</p>\n\n<pre><code>struct graph {\n    int n;              /* number of vertices */\n    int m;              /* number of edges */\n    struct successors {\n        int d;          /* number of successors */\n        int len;        /* number of slots in array */\n        char is_sorted; /* true if list is already sorted */\n        int list[1];    /* actual list of successors */\n    } *alist[1];\n};\n</code></pre>\n\n<p>in the graph_add_edge function</p>\n\n<pre><code>/* do we need to grow the list? */\nwhile (g-&gt;alist[u]-&gt;d &gt;= g-&gt;alist[u]-&gt;len) {\n    g-&gt;alist[u]-&gt;len *= 2;\n    g-&gt;alist[u] =\n        realloc(g-&gt;alist[u],\n            sizeof(struct successors) + sizeof(int) * (g-&gt;alist[u]-&gt;len - 1));\n}\n</code></pre>\n\n<p>why does the length have to be doubled? why is it even needed? isn't it always d+1 (number of successors + 1) to make room for the next item?</p>\n\n<p><a href=\"http://www.cs.yale.edu/homes/aspnes/pinewiki/C%282f%29Graphs.html\" rel=\"nofollow\">Full code</a></p>\n"}, {"tags": ["c", "windows", "ssl", "ldap"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1464186105, "post_id": 37438566, "comment_id": 62382434, "body": "Is the LDAP server actually listening on <code>LDAP_SSL_PORT</code>, which is probably port 636?"}, {"owner": {"reputation": 1, "user_id": 6381373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb59ef5f14ef8c32c1350d24c7765b0?s=128&d=identicon&r=PG&f=1", "display_name": "klth", "link": "https://stackoverflow.com/users/6381373/klth"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1464325073, "post_id": 37438566, "comment_id": 62448392, "body": "I think so. I first tried to connect over SSL using the ancient and no longer maintained Netscape C API and the NSS libraries. It succeeded on port 636."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1464360604, "post_id": 37438566, "comment_id": 62469274, "body": "Do you have access to <code>openssl</code>?  If so, run <code>openssl s_client -connect host:636</code>, replacing <code>host</code> with the actual hostname or IP address of your LDAP server.  That should tell you the specific protocol and cipher suite used in the connection - maybe your server and Windows client don&#39;t have a common set there. You can also run <code>openssl s_client -connect host:636 | openssl x509 -text</code> to dump the server&#39;s certificate in a readable format."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1464360818, "post_id": 37438566, "comment_id": 62469445, "body": "Also, check the server&#39;s certificate that you installed on the Windows client.  Go to &quot;Internet Options-&gt;Content-&gt;Certificates-&gt;Trusted Root Certification Authorities&quot; (where you installed your server&#39;s cert).  Select your server&#39;s cert and click on the &quot;Advanced&quot; button.  (That&#39;s what it is on my Windows 7 laptop)  Make sure the proper certificate purposes are selected.  IIRC &quot;Server Authentication&quot; is the important one, but there may be others.  Look at some certificates from actual trusted authorities to see."}, {"owner": {"reputation": 1, "user_id": 6381373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb59ef5f14ef8c32c1350d24c7765b0?s=128&d=identicon&r=PG&f=1", "display_name": "klth", "link": "https://stackoverflow.com/users/6381373/klth"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1464607510, "post_id": 37438566, "comment_id": 62540557, "body": "@andrew You advised to examine the &quot;server\u2019s certificate&quot; on the client. I installed the CA on the client in the &quot;Trusted Root etc.&quot; but not the server cert. Do you mean that? The CA that is installed on the client has the &quot;Server Authentication&quot; property set.  I ran the openssl commands you suggested on both the server and the client. The output is identical apart from the value of &quot;Master-key&quot;.  So why is LDAPAdmin able to connect over SSL and a client program on the same computer is not? Does the Windows LDAP libraries expect the certs somewhere else or in a different form?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6381373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb59ef5f14ef8c32c1350d24c7765b0?s=128&d=identicon&r=PG&f=1", "display_name": "klth", "link": "https://stackoverflow.com/users/6381373/klth"}, "is_accepted": false, "score": 0, "last_activity_date": 1464767806, "creation_date": 1464767806, "answer_id": 37562712, "question_id": 37438566, "link": "https://stackoverflow.com/questions/37438566/windows-ldap-api-no-connection-over-ssl/37562712#37562712", "title": "Windows LDAP API: No connection over SSL", "body": "<p>Sometimes it helps reading error messages more carefully. The entry in the event viewer caused by an unsuccessful bind over SSL was <em>\"The server name we were expecting is eim-tsi2.sam.develop.beta.ads.\"</em></p>\n\n<p>I should have noticed that the name should have been eim-tsi2.cgn.de.(etc.), instead. So the domain name part was wrong.</p>\n\n<p>This is a bug in Schannel which can be solved by an entry in the registry as described here: <a href=\"https://support.microsoft.com/en-us/kb/2275950\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/2275950</a>.</p>\n\n<p>I still do not know why LDAPAdmin was able to connect without that additional registry key although it also uses the WINLDAP API and therefore should have run into the same error. But that doesn\u2019t matter any more.</p>\n\n<p>Thanks, Andrew, for your help.</p>\n"}], "owner": {"reputation": 1, "user_id": 6381373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb59ef5f14ef8c32c1350d24c7765b0?s=128&d=identicon&r=PG&f=1", "display_name": "klth", "link": "https://stackoverflow.com/users/6381373/klth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 960, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464767806, "creation_date": 1464182608, "question_id": 37438566, "link": "https://stackoverflow.com/questions/37438566/windows-ldap-api-no-connection-over-ssl", "title": "Windows LDAP API: No connection over SSL", "body": "<p>I\u2019m trying to connect to an LDAP directory over SSL using the Windows LDAP C-API. This fails with error code 0x51 = LDAP_SERVER_DOWN while the event log on the client computer has this:\n<em>\u201eThe certificate received from the remote server does not contain the expected name. It is therefore not possible to determine whether we are connecting to the correct server. The server name we were expecting is eim-tsi2.sam.develop.beta.ads. The SSL connection request has failed. The attached data contains the server certificate.\u201d</em></p>\n\n<p>This is can\u2019t be true since \u201cLdap Admin\u201d is able to connect over SSL and port 636.</p>\n\n<p>The LDAP directory is an Oracle DSEE which has the CA and the server certificate in the appropriate cert store.\nThe client has the CA installed in the \u201cTrusted Root Certification Authorities\u201d and there in the \u201eLocal Computer\u201c physical store. I assumed this to be the right place for the CA since my little client program uses the Windows LDAP C-API; LDAP Admin indeed expects the CA there.</p>\n\n<p>Here is an excerpt of my program omitting the error handling and other obvious source code:</p>\n\n<pre><code>   ld = ldap_sslinit(host, LDAP_SSL_PORT, 1);\n   // Set options: LDAP version, timeout ...\n   rc = ldap_set_option(ld, LDAP_OPT_SSL, LDAP_OPT_ON);\n   // Now connect:\n   rc = ldap_connect(ld, NULL);\n</code></pre>\n\n<p>Result:\n0x51 = LDAP_SERVER_DOWN</p>\n\n<p>Connecting without SSL succeeds so the LDAP server is generally accessible.</p>\n\n<p>Since Ldap Admin is able to connect over SSL, I assume the certificates are valid and in the right place. But obviously the LDAP API expects them somewhere else and cannot get the server certificate from the server. I configured the certs as described here: <a href=\"https://msdn.microsoft.com/en-us/library/aa366105%28v=vs.85%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa366105%28v=vs.85%29.aspx</a></p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 4, "creation_date": 1464182587, "post_id": 37438458, "comment_id": 62379613, "body": "1) You don&#39;t <code>fclose()</code> the file. (And don&#39;t check the <code>fopen()</code> for success.) 2) Please add the precise observed result, expected result. As-is, it is a bit hard to tell what exactly is baffling you."}, {"owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 5, "creation_date": 1464182588, "post_id": 37438458, "comment_id": 62379615, "body": "fwrite works with bytes, not integers. <code>int</code>s are usually 4 bytes. When you pass 1 and 4 to <code>fwrite</code>, that is telling it to write 4 elements of 1 byte each (starting at the first element of <code>output</code>). So really, you&#39;re just writing the first integer in the array."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464182675, "post_id": 37438458, "comment_id": 62379679, "body": "Please describe exactly what you expect to see in the <code>result.bin</code> file"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1464182743, "post_id": 37438458, "comment_id": 62379739, "body": "@DevSolar files are automatically closed when the program returns from <code>main</code>"}, {"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 1, "creation_date": 1464182866, "post_id": 37438458, "comment_id": 62379838, "body": "You need to pass sizeof(int), not 1."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464183522, "post_id": 37438458, "comment_id": 62380333, "body": "@M.M: Yes, but other handles, like e.g. memory, might not be. Releasing allocated resources before you go out of scope is good coding practice. Neither an <code>fclose()</code> nor a check of the <code>fopen()</code> return value fixes the OP&#39;s problem, but he might become a better coder for it."}, {"owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "reply_to_user": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 0, "creation_date": 1464184612, "post_id": 37438458, "comment_id": 62381212, "body": "See @Cameron&#39;s comment. Either use <code>sizeof(int)</code> as the second argument of <code>fwrite</code> (and then you get 16 bytes, all of which are 0-padded bytes essentially, in little endian order on a Windows Intel system, or use output as a <code>unsigned char</code> array and use 1 as the second argument and get 4 bytes, no padding."}, {"owner": {"reputation": 14229, "user_id": 574115, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/CtK6N.png?s=128&g=1", "display_name": "Daan Timmer", "link": "https://stackoverflow.com/users/574115/daan-timmer"}, "edited": false, "score": 0, "creation_date": 1464187670, "post_id": 37438458, "comment_id": 62383758, "body": "or! even better, use <code>&lt;stdint.h&gt;</code> and more standardized types: <code>int8 int16 int32 uint8 uint16 uint32</code> etc."}], "answers": [{"tags": [], "owner": {"reputation": 1008, "user_id": 261981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c602c66983841d31a8d2131c8428f1fb?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/261981/neil"}, "is_accepted": false, "score": 3, "last_activity_date": 1464182801, "creation_date": 1464182801, "answer_id": 37438650, "question_id": 37438458, "link": "https://stackoverflow.com/questions/37438458/c-fwrite-writes-extra-zeros/37438650#37438650", "title": "C fwrite writes extra zeros", "body": "<p>Try this ... </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int output[57];\n    int k=0;\n\n    output[0]=1;\n    output[1]=11;\n    output[2]=2;\n    output[3]=22;\n\n    FILE *result;\n    result=fopen(\"C:/Users/ael09mol/Desktop/data/result.bin\",\"w+b\");\n    fwrite(output,sizeof(int),4,result);\n\n                        printf(\"%d\\n\", output[0]);\n                        printf(\"%d\\n\", output[1]);\n                        printf(\"%d\\n\", output[2]);\n                        printf(\"%d\\n\", output[3]);\n    fclose(result);\n\n    return (EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>fwrite function: second parameter should contain the size of the object to copy, in bytes.</p>\n\n<blockquote>\n  <p>Following is the declaration for fwrite() function.</p>\n  \n  <p>size_t fwrite(const void *ptr, size_t size, size_t nmemb, FILE\n  *stream)</p>\n  \n  <p>Parameters</p>\n\n<pre><code>ptr \u2212 This is the pointer to the array of elements to be written.\n\nsize \u2212 This is the size in bytes of each element to be written.\n\nnmemb \u2212 This is the number of elements, each one with a size of size bytes.\n\nstream \u2212 This is the pointer to a FILE object that specifies an output stream.\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 9, "user_id": 6381340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13be5e653dc295162e9a96f972ed84a1?s=128&d=identicon&r=PG&f=1", "display_name": "Mattias Olsson", "link": "https://stackoverflow.com/users/6381340/mattias-olsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1219, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1464267572, "creation_date": 1464182323, "last_edit_date": 1464267572, "question_id": 37438458, "link": "https://stackoverflow.com/questions/37438458/c-fwrite-writes-extra-zeros", "title": "C fwrite writes extra zeros", "body": "<p>when i read from the result.bin file it puts the value i want then fill with 3 zeros then next value and so on i cant figure out why tried diffrent compilers (minigw cygwin and msdn) same result on all.\nalso tried reading it in matlab and using the functions in the libraries stdio,stdlib</p>\n\n<p>first sorry for the bad posting i was in a hurry here is a better hopfully more clear description:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n/*\n * \n */\nint main() {\n    int output[4];\n    int k=0;\n\n    output[0]=1;\n    output[1]=11;\n    output[2]=2;\n    output[3]=22;\n\n    FILE *result;\n    result=fopen(\"C:/Users/Mattias/Desktop/result.bin\",\"w+b\");\n    fwrite(output,sizeof(int),4,result);\n                        printf(\"%d\\n\", output[0]);\n                        printf(\"%d\\n\", output[1]);\n                        printf(\"%d\\n\", output[2]);\n                        printf(\"%d\\n\", output[3]);\n\n    fclose(result);\n\n\n    result=fopen(\"C:/Users/Mattias/Desktop/result.bin\",\"r+b\");\n    printf(\"%s\\n\", \"whats written to result\");\n\n        int buffer1[3];\n        long int size = sizeof(buffer1);\n\n    if (!result)\n    {\n            printf(\"Unable to open file!\");\n        return 1;\n    }\n    for ( k=0; k &lt;= 3; k++)\n    {\n            buffer1[k]=fgetc(result); \n            printf(\"%d\\n\", buffer1[k]);\n    }\n        fclose(result);\n\n    return (EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>and the output i get from reading the result.bin file is:</p>\n\n<p>1\n0\n0\n0\n11\n0\n0\n0\n2\n0\n0\n0\n22\n0\n0\n0\nand what i want to get when i read is just 1 11 2 22\nThanks for the help\nps. i used a 1 in fwrite becouse i know the data iam handeling is only 1 byte big </p>\n"}, {"tags": ["c", "performance", "code-complexity"], "comments": [{"owner": {"reputation": 7872, "user_id": 7841, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/3KsHr.png?s=128&g=1", "display_name": "Leonardo Herrera", "link": "https://stackoverflow.com/users/7841/leonardo-herrera"}, "edited": false, "score": 0, "creation_date": 1464182162, "post_id": 37438314, "comment_id": 62379282, "body": "Perhaps <a href=\"http://cs.stackexchange.com/\">Computer Science Stack Exchange</a> is a better fit for this question"}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1464182206, "post_id": 37438314, "comment_id": 62379317, "body": "Do you mean the complexity of the signal, or the complexity of the algorithm?"}, {"owner": {"reputation": 149, "user_id": 5161414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bd98f9bf8e2b6f4891ca46d4cdd7a8a?s=128&d=identicon&r=PG&f=1", "display_name": "Chamran Ashour", "link": "https://stackoverflow.com/users/5161414/chamran-ashour"}, "edited": false, "score": 0, "creation_date": 1464182255, "post_id": 37438314, "comment_id": 62379364, "body": "Complexity of the algorithm"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 2, "creation_date": 1464182950, "post_id": 37438314, "comment_id": 62379907, "body": "It depends on so much, e.g. problem size, scalability, parallelism, i/o characteristics."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1464183443, "post_id": 37438314, "comment_id": 62380262, "body": "I think the relationship is linear on the lower bound of running time because with larger size there will be more overhead of the system, e.g. cache misses and swapping."}], "answers": [{"comments": [{"owner": {"reputation": 10212, "user_id": 970543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wq9T6.jpg?s=128&g=1", "display_name": "Nik Bougalis", "link": "https://stackoverflow.com/users/970543/nik-bougalis"}, "edited": false, "score": 0, "creation_date": 1464184946, "post_id": 37439418, "comment_id": 62381453, "body": "Or, to put it a slightly different way, remember that Big-O type complexity deals with limiting behavior at infinity. And, of course, it doesn&#39;t account for a great many variables that can have a huge impact in performance."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 1, "last_activity_date": 1464184688, "creation_date": 1464184688, "answer_id": 37439418, "question_id": 37438314, "link": "https://stackoverflow.com/questions/37438314/algorithm-complexity-vs-running-time/37439418#37439418", "title": "Algorithm Complexity vs Running Time", "body": "<p>Time complexity is more a measure of how time varies with input size than an absolute measure.<br>\n(This is an extreme simplification, but it will do for explaining the phenomenon you're seeing.)</p>\n\n<p>If <code>n</code> is your problem size and your actual running time is <code>1000000000 * n</code>, it has linear complexity, while <code>0.000000001*n^2</code> would be quadratic.   </p>\n\n<p>If you plot them against each other, you'll see that <code>0.000000001*n^2</code> is smaller than <code>1000000000 * n</code> all the way up to around n = 1e18, despite its \"greater complexity\".</p>\n\n<p>(<code>0.000000001*n^2 + 1000000000 * n</code> would also be quadratic, but always have worse execution time than both.)</p>\n"}, {"tags": [], "owner": {"reputation": 2633, "user_id": 27898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84028aac31ee14ca90aa08c2442e3a1e?s=128&d=identicon&r=PG", "display_name": "mpez0", "link": "https://stackoverflow.com/users/27898/mpez0"}, "is_accepted": false, "score": 1, "last_activity_date": 1464185254, "creation_date": 1464185254, "answer_id": 37439641, "question_id": 37438314, "link": "https://stackoverflow.com/questions/37438314/algorithm-complexity-vs-running-time/37439641#37439641", "title": "Algorithm Complexity vs Running Time", "body": "<p>No, running time and algorithmic complexity do not have a simple relationship.</p>\n\n<p>Estimating or comparing run times can easily get very complicated and detailed. There are many variables that vary even with the same program and input data - that's why benchmarks do multiple runs and process them statistically.</p>\n\n<p>If you're looking for big differences, generally the two most significant factors are algorithmic complexity (\"big <em>O</em>()\") and start up time. Frequently, the lower \"big <em>O</em>()\" algorithm requires more complex startup; that is, it takes more initial setup in the program before entering the actual loop. If it takes longer to do that initial setup than run the rest of the algorithm for small data sets, the larger <em>O</em>() rated algorithm will run faster <em>for those small data sets</em>. For large data sets, the lower <em>O</em>() algorithm will be faster. There will be a data set size where the total time is equal, called the \"crossover\" size.</p>\n\n<p>For performance, you'd want to check if most of your data was above or below that crossover as part of picking the algorithm to implement.</p>\n\n<p>Getting more and more detail and accuracy in runtime predictions gets much more complex very quickly.</p>\n"}], "owner": {"reputation": 149, "user_id": 5161414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bd98f9bf8e2b6f4891ca46d4cdd7a8a?s=128&d=identicon&r=PG&f=1", "display_name": "Chamran Ashour", "link": "https://stackoverflow.com/users/5161414/chamran-ashour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 37439418, "answer_count": 2, "score": -2, "last_activity_date": 1464185254, "creation_date": 1464182027, "question_id": 37438314, "link": "https://stackoverflow.com/questions/37438314/algorithm-complexity-vs-running-time", "title": "Algorithm Complexity vs Running Time", "body": "<p>I have an algorithm used for signal quantization. For the algorithm I have an equation to calculate its complexity with different values of parameters. This algorithm is implemented in C. Sometimes according to the equation I have less complexity but the running time is higher. I'm not 100% sure about the equation.</p>\n\n<p>My question is running time and algorithm complexity are all the time having straight relation? Means, always the higher complexity we have, the higher running time happens? Or it's different from one algorithm to another?</p>\n"}, {"tags": ["css", "c", "gtk"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1464189448, "post_id": 37438087, "comment_id": 62385160, "body": "Are those three triangles independently moveable? If so, GtkScale isn&#39;t the right tool for the job; it only supports one such triangle. You&#39;ll need to implement the widget yourself, which is probably what GIMP is already doing."}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1464191122, "post_id": 37438087, "comment_id": 62386395, "body": "It seems that they drawn their own widget, you&#39;re right :-(. That&#39;s such a pain doing that."}, {"owner": {"reputation": 1444, "user_id": 6062567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e87060f0ce67ed68a097ac5186027c5?s=128&d=identicon&r=PG&f=1", "display_name": "oldtechaa", "link": "https://stackoverflow.com/users/6062567/oldtechaa"}, "edited": false, "score": 0, "creation_date": 1464265385, "post_id": 37438087, "comment_id": 62420480, "body": "It&#39;s not always very difficult to draw your own widget. That would be a rather simple one to implement."}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1464333872, "post_id": 37438087, "comment_id": 62452121, "body": "Yes maybe. But I never done this before :)."}], "answers": [{"tags": [], "owner": {"reputation": 7127, "user_id": 186347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41faca9cd29ae1ff1e10ffd01eb15e52?s=128&d=identicon&r=PG", "display_name": "ntd", "link": "https://stackoverflow.com/users/186347/ntd"}, "is_accepted": false, "score": 1, "last_activity_date": 1469701691, "creation_date": 1469701691, "answer_id": 38633738, "question_id": 37438087, "link": "https://stackoverflow.com/questions/37438087/how-to-custom-gtkscale-shape-c-program-to-obtain-sliders-like-in-the-level-w/38633738#38633738", "title": "How to custom GtkScale shape (C program) to obtain sliders like in the &quot;level&quot; window of GIMP", "body": "<p>For a quick&amp;dirty implementation, you can leverage 3 nested <code>GtkPaned</code> to simulate that behavior:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!-- Generated with glade 3.20.0 --&gt;\n&lt;interface&gt;\n  &lt;requires lib=\"gtk+\" version=\"3.20\"/&gt;\n  &lt;object class=\"GtkWindow\"&gt;\n    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n    &lt;child&gt;\n      &lt;object class=\"GtkBox\"&gt;\n        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n        &lt;property name=\"orientation\"&gt;vertical&lt;/property&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkLabel\"&gt;\n            &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n            &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n          &lt;/object&gt;\n          &lt;packing&gt;\n            &lt;property name=\"expand\"&gt;True&lt;/property&gt;\n            &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n            &lt;property name=\"position\"&gt;0&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkPaned\"&gt;\n            &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n            &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n            &lt;property name=\"wide_handle\"&gt;True&lt;/property&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkPaned\"&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n                &lt;property name=\"position\"&gt;10&lt;/property&gt;\n                &lt;property name=\"wide_handle\"&gt;True&lt;/property&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkLabel\"&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                  &lt;/object&gt;\n                  &lt;packing&gt;\n                    &lt;property name=\"resize\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"shrink\"&gt;True&lt;/property&gt;\n                  &lt;/packing&gt;\n                &lt;/child&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkOverlay\" id=\"Overlay1\"&gt;\n                    &lt;property name=\"width_request\"&gt;48&lt;/property&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkImage\"&gt;\n                        &lt;property name=\"width_request\"&gt;24&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"halign\"&gt;end&lt;/property&gt;\n                        &lt;property name=\"stock\"&gt;gtk-go-forward&lt;/property&gt;\n                      &lt;/object&gt;\n                      &lt;packing&gt;\n                        &lt;property name=\"index\"&gt;-1&lt;/property&gt;\n                      &lt;/packing&gt;\n                    &lt;/child&gt;\n                    &lt;child type=\"overlay\"&gt;\n                      &lt;object class=\"GtkImage\"&gt;\n                        &lt;property name=\"width_request\"&gt;24&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"halign\"&gt;start&lt;/property&gt;\n                        &lt;property name=\"stock\"&gt;gtk-goto-first&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                  &lt;/object&gt;\n                  &lt;packing&gt;\n                    &lt;property name=\"resize\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"shrink\"&gt;False&lt;/property&gt;\n                  &lt;/packing&gt;\n                &lt;/child&gt;\n              &lt;/object&gt;\n              &lt;packing&gt;\n                &lt;property name=\"resize\"&gt;True&lt;/property&gt;\n                &lt;property name=\"shrink\"&gt;False&lt;/property&gt;\n              &lt;/packing&gt;\n            &lt;/child&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkPaned\"&gt;\n                &lt;property name=\"width_request\"&gt;48&lt;/property&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n                &lt;property name=\"wide_handle\"&gt;True&lt;/property&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkOverlay\" id=\"Overlay2\"&gt;\n                    &lt;property name=\"width_request\"&gt;48&lt;/property&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkImage\"&gt;\n                        &lt;property name=\"width_request\"&gt;24&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"halign\"&gt;end&lt;/property&gt;\n                        &lt;property name=\"stock\"&gt;gtk-goto-last&lt;/property&gt;\n                      &lt;/object&gt;\n                      &lt;packing&gt;\n                        &lt;property name=\"index\"&gt;-1&lt;/property&gt;\n                      &lt;/packing&gt;\n                    &lt;/child&gt;\n                    &lt;child type=\"overlay\"&gt;\n                      &lt;object class=\"GtkImage\"&gt;\n                        &lt;property name=\"width_request\"&gt;24&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"halign\"&gt;start&lt;/property&gt;\n                        &lt;property name=\"stock\"&gt;gtk-go-back&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                  &lt;/object&gt;\n                  &lt;packing&gt;\n                    &lt;property name=\"resize\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"shrink\"&gt;False&lt;/property&gt;\n                  &lt;/packing&gt;\n                &lt;/child&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkLabel\"&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                  &lt;/object&gt;\n                  &lt;packing&gt;\n                    &lt;property name=\"resize\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"shrink\"&gt;True&lt;/property&gt;\n                  &lt;/packing&gt;\n                &lt;/child&gt;\n              &lt;/object&gt;\n              &lt;packing&gt;\n                &lt;property name=\"resize\"&gt;True&lt;/property&gt;\n                &lt;property name=\"shrink\"&gt;False&lt;/property&gt;\n              &lt;/packing&gt;\n            &lt;/child&gt;\n          &lt;/object&gt;\n          &lt;packing&gt;\n            &lt;property name=\"expand\"&gt;True&lt;/property&gt;\n            &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n            &lt;property name=\"position\"&gt;1&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n      &lt;/object&gt;\n    &lt;/child&gt;\n  &lt;/object&gt;\n&lt;/interface&gt;\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1469701691, "creation_date": 1464181512, "last_edit_date": 1464182340, "question_id": 37438087, "link": "https://stackoverflow.com/questions/37438087/how-to-custom-gtkscale-shape-c-program-to-obtain-sliders-like-in-the-level-w", "title": "How to custom GtkScale shape (C program) to obtain sliders like in the &quot;level&quot; window of GIMP", "body": "<p>I have a question about GtkScale shape.</p>\n\n<p>Indeed I want my Gtkscale looks like in level window of Gimp.\nI mean:</p>\n\n<ul>\n<li>a bar</li>\n<li>3 triangles (here there are one for shadows, one for midtones, one for highlights)\n<a href=\"https://i.stack.imgur.com/s6vbc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s6vbc.png\" alt=\"Sliders in gimp\"></a></li>\n</ul>\n\n<p>I can build the shade bar with GtkLabel and CSS file:</p>\n\n<pre><code>.label-shade {\nbackground-image: -gtk-gradient (linear,\n                            left top, right top,\n                            from (black),\n                            to (shade (white, 0.95)));\n}\n</code></pre>\n\n<p>But I don't know how I can build triangle sliders.</p>\n"}, {"tags": ["c", "arrays", "malloc", "free"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1464179802, "post_id": 37437293, "comment_id": 62377286, "body": "Yes, if you do <code>Q++</code>, than adjust <code>size--</code>. You have a chunk of memory, and you control how you access it."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 6, "creation_date": 1464180008, "post_id": 37437293, "comment_id": 62377479, "body": "After <code>Q++</code>, <code>Q[4]</code> doesn&#39;t contain &quot;garbage&quot;. Accessing it is  <b>undefined</b>."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1464180027, "post_id": 37437293, "comment_id": 62377498, "body": "You can use <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_realloc.htm\" rel=\"nofollow noreferrer\">realloc</a>."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 0, "creation_date": 1464180256, "post_id": 37437293, "comment_id": 62377700, "body": "If it&#39;s only one element it&#39;s questionable if it worth the work, it&#39;s quite likely that you won&#39;t release any memory in reality by doing so."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 4, "creation_date": 1464180758, "post_id": 37437293, "comment_id": 62378090, "body": "You should probably provide more context. This sounds like an XY-problem (<a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-probl&zwnj;&#8203;em</a>), what are you <b>really</b> trying to do?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464186493, "post_id": 37437293, "comment_id": 62382767, "body": "This sounds like the wrong solution indeed. It sounds very much like you should be using a linked list. Arrays and realloc will be terribly inefficient."}], "answers": [{"tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": true, "score": 5, "last_activity_date": 1464180098, "creation_date": 1464180098, "answer_id": 37437497, "question_id": 37437293, "link": "https://stackoverflow.com/questions/37437293/how-to-free-the-final-element-of-a-mallocd-array-in-c/37437497#37437497", "title": "How to free the final element of a malloc&#39;d array in C?", "body": "<p><code>realloc()</code> can change the size of an allocated chunk of memory, which will do the job for you.  Note that this cannot be used to \"free\" arbitrary elements of an array, but only one(s) on the end.</p>\n\n<p>How good an idea it is  to do this depends on a number of factors, none of which you have provided.</p>\n"}, {"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 1, "last_activity_date": 1464180872, "last_edit_date": 1495542278, "creation_date": 1464180461, "answer_id": 37437652, "question_id": 37437293, "link": "https://stackoverflow.com/questions/37437293/how-to-free-the-final-element-of-a-mallocd-array-in-c/37437652#37437652", "title": "How to free the final element of a malloc&#39;d array in C?", "body": "<p>Taliking about last elements of array you can surely use <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_realloc.htm\" rel=\"nofollow noreferrer\">realloc</a></p>\n\n<p>BTW take note that when you say</p>\n\n<p><em>The array looks like: {1, 2, 3, 4, #}, where # is some garbage value.</em></p>\n\n<p>You are wrong and you are invoking undefined behavior as well explained by <a href=\"https://stackoverflow.com/a/15647634/3436922\">this SO answer</a>.</p>\n\n<p>So the loop that left shift value have not to do <code>Q[4] = Q[5];</code></p>\n"}, {"tags": [], "owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "is_accepted": false, "score": 2, "last_activity_date": 1464180717, "creation_date": 1464180717, "answer_id": 37437748, "question_id": 37437293, "link": "https://stackoverflow.com/questions/37437293/how-to-free-the-final-element-of-a-mallocd-array-in-c/37437748#37437748", "title": "How to free the final element of a malloc&#39;d array in C?", "body": "<p>When you do Q++ the array has not changed, it still contains the five values 0,1,2,3,4 it is just that Q is pointing to the second element in the array.</p>\n\n<p>If you want to change the size of allocated memory then do as Scott said and <code>realloc</code> the block - but it is a costly way of handling heap memory. </p>\n\n<p>If you just want to keep track of the number of elements in the array let Q remain pointing on the first element and have a size variable indicating how many integers there are.</p>\n\n<p>Alternatively use another data structure to hold your integers e.g. a linked list of integers, then you can add and remove integers easier.</p>\n"}, {"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 1, "last_activity_date": 1464181822, "creation_date": 1464181822, "answer_id": 37438246, "question_id": 37437293, "link": "https://stackoverflow.com/questions/37437293/how-to-free-the-final-element-of-a-mallocd-array-in-c/37438246#37438246", "title": "How to free the final element of a malloc&#39;d array in C?", "body": "<p>To shift around elements inside an array one can use <code>memmove()</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n  int d_init[] = {0, 1, 2, 3, 4};\n\n  size_t s = sizeof d_init/sizeof *d_init;\n  int d[s];\n\n  /* Fill d */\n  memcpy(d, d_init, s * sizeof *d);\n\n  for (size_t i = 0; i &lt; s; ++i)\n    printf(\"%d \", d[i]);\n  puts(\"\\n\");\n\n  /* shift one to the left */\n  memmove(d, d + 1, (s - 1) * sizeof *d);\n\n  for (size_t i = 0; i &lt; s; ++i)\n    printf(\"%d \", d[i]);\n  puts(\"\\n\");\n\n\n  /* shift two to the right */\n  memmove(d + 2, d, (s - 2) * sizeof *d);  \n\n  for (size_t i = 0; i &lt; s; ++i)\n    printf(\"%d \", d[i]);\n  puts(\"\\n\");\n}\n</code></pre>\n\n<p>The snippet above would print:</p>\n\n<pre><code>0 1 2 3 4\n1 2 3 4 4\n1 2 1 2 3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 84, "user_id": 4821503, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-An36J-Nqpuk/AAAAAAAAAAI/AAAAAAAAABs/j63EglYShQg/photo.jpg?sz=128", "display_name": "William Duclot", "link": "https://stackoverflow.com/users/4821503/william-duclot"}, "is_accepted": false, "score": 0, "last_activity_date": 1464199265, "creation_date": 1464199265, "answer_id": 37444542, "question_id": 37437293, "link": "https://stackoverflow.com/questions/37437293/how-to-free-the-final-element-of-a-mallocd-array-in-c/37444542#37444542", "title": "How to free the final element of a malloc&#39;d array in C?", "body": "<p>If you're doing a <code>Q++</code> you've not shifted the elements of the array, your array is simply pointing to the second element (index 1). Thus, Q[4] is reading something that doesn't belong to the array: C is permissive enough to let you do that (in most cases), but it is a mistake.</p>\n\n<p>To shift elements you should either do</p>\n\n<pre><code>for (int i=0; i&lt;4; i++)\n    Q[i] = Q[i+1];\n</code></pre>\n\n<p>or (smarter)</p>\n\n<pre><code>memmove(Q, Q+1, 4*sizeof(int));\n</code></pre>\n\n<p>but indeed, to have an array of size 4 you'll have to realloc.</p>\n\n<p><strong>BUT</strong> if you need to do that, maybe an array is not the data structure you should use: a linked list seems to be a better choice.</p>\n"}], "owner": {"reputation": 131, "user_id": 6025569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb8334757fbdb6339d04f3644d4eca1?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Smithies", "link": "https://stackoverflow.com/users/6025569/julian-smithies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 0, "accepted_answer_id": 37437497, "answer_count": 5, "score": 1, "last_activity_date": 1464199265, "creation_date": 1464179588, "question_id": 37437293, "link": "https://stackoverflow.com/questions/37437293/how-to-free-the-final-element-of-a-mallocd-array-in-c", "title": "How to free the final element of a malloc&#39;d array in C?", "body": "<p>Say I initialize an array of 5 integer elements like this:</p>\n\n<pre><code>int *Q = malloc(sizeof(int) * 5);\n\nfor (int i = 0; i &lt; 5; i++) {\n    Q[i] = i;\n}\n</code></pre>\n\n<p>The array looks like: {0, 1, 2, 3, 4}.\nNow if I shift everything along by 1 position:</p>\n\n<pre><code>Q++;\n</code></pre>\n\n<p>The array looks like: {1, 2, 3, 4, #},  where # is some garbage value.</p>\n\n<p>Is there a way to free the final element so it's not stored in the array?</p>\n\n<p>I tried this:</p>\n\n<pre><code>free(Q[4]);\n</code></pre>\n\n<p>But I know this won't work because free() can only operate of the whole chunk of memory allocated for Q.</p>\n\n<p>Is there a better way to shift everything along? The resulting array should look like: {1, 2, 3, 4}.</p>\n\n<p>Would it be a good idea to realloc() Q after every shift?</p>\n"}, {"tags": ["c", "openmp", "c89"], "comments": [{"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 0, "creation_date": 1464180984, "post_id": 37437195, "comment_id": 62378276, "body": "Try to add <code>private(counter, n, isodd)</code> to your OpenMP <code>parallel</code> directive..."}, {"owner": {"reputation": 643, "user_id": 4892892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/433166266860648/picture?type=large", "display_name": "Zolt&#225;n Cs&#225;ti", "link": "https://stackoverflow.com/users/4892892/zolt%c3%a1n-cs%c3%a1ti"}, "reply_to_user": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 0, "creation_date": 1464181761, "post_id": 37437195, "comment_id": 62378954, "body": "This solves the problem. Please put it into an answer so that I can accept it."}], "answers": [{"tags": [], "owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "is_accepted": true, "score": 2, "last_activity_date": 1464182382, "creation_date": 1464182382, "answer_id": 37438486, "question_id": 37437195, "link": "https://stackoverflow.com/questions/37437195/counting-does-not-work-properly-in-openmp/37438486#37438486", "title": "Counting does not work properly in OpenMP", "body": "<p>Inside your OpenMP parallel region, you are assigning values to the <code>counter</code>, <code>n</code> and <code>isodd</code> scalar variables. These cannot therefore be just <code>shared</code> as they are by default. You need to pay extra attention to them.</p>\n\n<p>A quick analysis shows that as their values is only meaningful inside the parallel region and only for the current thread, so it becomes clear that they need to be declared <code>private</code>.</p>\n\n<p>Adding a <code>private( counter, n, isodd )</code> clause to your <code>#pragma omp parallel</code> directive should fix the issue.</p>\n"}], "owner": {"reputation": 643, "user_id": 4892892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/433166266860648/picture?type=large", "display_name": "Zolt&#225;n Cs&#225;ti", "link": "https://stackoverflow.com/users/4892892/zolt%c3%a1n-cs%c3%a1ti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 37438486, "answer_count": 1, "score": 1, "last_activity_date": 1464300028, "creation_date": 1464179387, "last_edit_date": 1464300028, "question_id": 37437195, "link": "https://stackoverflow.com/questions/37437195/counting-does-not-work-properly-in-openmp", "title": "Counting does not work properly in OpenMP", "body": "<p>I have the function</p>\n\n<pre><code>void collatz(int startNumber, int endNumber, int* iter, int nThreads)\n{\n    int i, n, counter;\n    int isodd; /* 1 if n is odd, 0 if even */\n    #pragma omp parallel for\n    for (i = startNumber; i &lt;= endNumber; i++)\n    {\n        counter = 0;\n        n = i;\n        omp_set_num_threads(nThreads);\n        while (n &gt; 1)\n        {\n            isodd = n%2;\n            if (isodd)\n                n = 3*n+1;\n            else\n                n/=2;\n            counter++;\n        }\n        iter[i - startNumber] = counter;\n    }\n}\n</code></pre>\n\n<p>It works as I wish when running serial (i.e. compiling without OpenMP or commenting out <code>#pragma omp parallel for</code> and <code>omp_set_num_threads(nThreads);</code>). However, the parallel version produces the wrong result and I think it is because the <code>counter</code> variable need to be set to zero at the beginning of each for loop and perhaps another thread can work with the non-zeroed <code>counter</code> value. But even if I use <code>#pragma omp parallel for private(counter)</code>, the problem still occurs. What am I missing?</p>\n\n<p>I compile the program as C89.</p>\n"}, {"tags": ["c", "tizen"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1512017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/614e6913458307b9f355ffdfc4deae79?s=128&d=identicon&r=PG", "display_name": "Dmitry Kingston", "link": "https://stackoverflow.com/users/1512017/dmitry-kingston"}, "edited": false, "score": 0, "creation_date": 1464323972, "post_id": 37454045, "comment_id": 62448083, "body": "Yeah, I know. But I have several pages which can change data, so I should put refresh code to every of them. But now I realized that user can just press back button, so the previous page should not be refreshed."}], "tags": [], "owner": {"reputation": 1, "user_id": 6384845, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a73a23b75694026815c63151e06caf51?s=128&d=identicon&r=PG", "display_name": "Hermet Park", "link": "https://stackoverflow.com/users/6384845/hermet-park"}, "is_accepted": false, "score": 0, "last_activity_date": 1464247160, "creation_date": 1464247160, "answer_id": 37454045, "question_id": 37436994, "link": "https://stackoverflow.com/questions/37436994/does-elementary-has-a-signal-which-is-emitted-when-object-becomes-visible-after/37454045#37454045", "title": "Does elementary has a signal which is emitted when object becomes visible after calling elm_naviframe_item_pop()?", "body": "<p>well.. when pop is called, the top view will be started to go out. That means previous page is going to be visible again at the same time (just right 1 frame after).\nI think, you can just regard the previous page will be visible on the time just right after calling elm_naviframe_item_pop();</p>\n"}], "owner": {"reputation": 1, "user_id": 1512017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/614e6913458307b9f355ffdfc4deae79?s=128&d=identicon&r=PG", "display_name": "Dmitry Kingston", "link": "https://stackoverflow.com/users/1512017/dmitry-kingston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464247160, "creation_date": 1464178887, "last_edit_date": 1464180588, "question_id": 37436994, "link": "https://stackoverflow.com/questions/37436994/does-elementary-has-a-signal-which-is-emitted-when-object-becomes-visible-after", "title": "Does elementary has a signal which is emitted when object becomes visible after calling elm_naviframe_item_pop()?", "body": "<p>I need to refresh screen because previous one has changed data in db, so the question: is there any way to know when the screen becomes visible again after previous was popped?</p>\n"}, {"tags": ["c", "gcc", "assembly", "printf", "compiler-optimization"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1464176478, "post_id": 37435984, "comment_id": 62374813, "body": "<code>gcc</code> does not (cannot..?) predict the <code>printf</code> output."}, {"owner": {"reputation": 561, "user_id": 4108929, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34ce934551dd49eeebb4a47f7b57d9a1?s=128&d=identicon&r=PG&f=1", "display_name": "Mitsos101", "link": "https://stackoverflow.com/users/4108929/mitsos101"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1464176585, "post_id": 37435984, "comment_id": 62374879, "body": "@LPs AFAIK, it changes calls to printf() with calls to puts() and putchar() where possible."}, {"owner": {"reputation": 9218, "user_id": 1132806, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4bbb8b9446bd2a8d2daf9abd5d42afe5?s=128&d=identicon&r=PG", "display_name": "adelphus", "link": "https://stackoverflow.com/users/1132806/adelphus"}, "edited": false, "score": 3, "creation_date": 1464176665, "post_id": 37435984, "comment_id": 62374940, "body": "@Mitsos101 only with <i>known compile-time constants</i>. What you&#39;re looking at in your code can only be determined by running it. Easy for you to do in your head - less easy for a compiler."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1464176740, "post_id": 37435984, "comment_id": 62374988, "body": "Suppose you had a <code>double </code>type and the format was <code>%4.3f</code>. This would require the compiler, to actually <i>run your code</i>, which it does not."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 16, "creation_date": 1464176759, "post_id": 37435984, "comment_id": 62375000, "body": "Required logic to detect this optimization opportunity is probably not worth the effort compared to benefits in real-world usage."}, {"owner": {"reputation": 8289, "user_id": 31762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8d966695b86efcb687c5e6a338542e32?s=128&d=identicon&r=PG", "display_name": "AnthonyLambert", "link": "https://stackoverflow.com/users/31762/anthonylambert"}, "edited": false, "score": 0, "creation_date": 1464178085, "post_id": 37435984, "comment_id": 62376007, "body": "Maybe it will only replace printf(&quot;i is equal to 30&quot;); to puts(&quot;i is equal to 30&quot;)   ?"}, {"owner": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "reply_to_user": {"reputation": 8289, "user_id": 31762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8d966695b86efcb687c5e6a338542e32?s=128&d=identicon&r=PG", "display_name": "AnthonyLambert", "link": "https://stackoverflow.com/users/31762/anthonylambert"}, "edited": false, "score": 0, "creation_date": 1464178178, "post_id": 37435984, "comment_id": 62376074, "body": "@ant gcc can do that. -fbuiltins . It does this for printf if it detects a constant string."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 6, "creation_date": 1464178185, "post_id": 37435984, "comment_id": 62376078, "body": "I can&#39;t even get gcc to optimize <code>printf(&quot;i is equal to %d\\n&quot;, 30);</code> into a <code>puts()</code>, which I would presume to be quite a bit simpler."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1464178647, "post_id": 37435984, "comment_id": 62376404, "body": "GCC allows to change the behaviour of how conversion specifiers are interpreted during run-time."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1464182589, "post_id": 37435984, "comment_id": 62379616, "body": "An interesting aspect of this question is that the <code>i</code> on the last line introduces a <i>data dependency</i> in the execution, whereas replacing it with <code>30</code> would have no such dependency. In more complicated, concurrent executions that use consume memory ordering, such &quot;optimizations&quot; may have surprising effects."}, {"owner": {"reputation": 561, "user_id": 4108929, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34ce934551dd49eeebb4a47f7b57d9a1?s=128&d=identicon&r=PG&f=1", "display_name": "Mitsos101", "link": "https://stackoverflow.com/users/4108929/mitsos101"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 4, "creation_date": 1464269100, "post_id": 37435984, "comment_id": 62423204, "body": "@KerrekSB GCC actually removes the data dependency on i. It realizes i is going to be 30, but it doesn&#39;t change the call to printf."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1464305752, "post_id": 37435984, "comment_id": 62443817, "body": "Why would you care about optimizing calls to <code>printf</code>? GCC apparently doesn&#39;t and there&#39;s really no good reason to."}], "answers": [{"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 3, "creation_date": 1464305732, "post_id": 37438728, "comment_id": 62443813, "body": "in this sample the compiler actually replaced i with 30 , so it doesnt care about the input. Its just not clever enough to know that it can replace printf  wiht puts"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1464635231, "post_id": 37438728, "comment_id": 62554906, "body": "&quot;Program analysis can never be perfect because of the Halting Problem, so we shouldn&#39;t bother with it&quot; is such a ridiculous attitude. Predicting the output of programs is impossible <i>in general</i>. That doesn&#39;t mean you can&#39;t (or shouldn&#39;t) predict specific cases. As has already been pointed out, GCC (just like any decent compiler) is perfectly capable of predicting that <code>i</code> will be 30 and it does in fact optimize the code based on that."}], "tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 6, "last_activity_date": 1464649818, "last_edit_date": 1464649818, "creation_date": 1464182967, "answer_id": 37438728, "question_id": 37435984, "link": "https://stackoverflow.com/questions/37435984/why-doesnt-gcc-optimize-this-call-to-printf/37438728#37438728", "title": "Why doesn&#39;t GCC optimize this call to printf?", "body": "<p>Modern compilers are quite clever, but not clever enough to foresee the output using logic. In this case, it's quite simple for human programmers to optimise this code, but this task is too hard for machines. In fact, predicting the output of a program without running it is impossible for programs (gcc for example). For proof, see <a href=\"https://en.wikipedia.org/wiki/Halting_problem\" rel=\"nofollow\">halting problem</a>.</p>\n\n<p>Anyway, you don't expect all programs without inputs to be optimised to several <code>puts()</code> statements, so it's perfectly reasonable for GCC not to optimise this code containing one <code>scanf()</code> statement.</p>\n\n<hr>\n\n<p>However, this does not mean compilers cannot or should not be optimised to generate more optimised executive files. Although it's impossible to predict the result <strong>all</strong> programs, it's perfectly possible and hopeful to \nimprove <strong>many</strong> of them.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1464306863, "post_id": 37472747, "comment_id": 62444074, "body": "You fixed your example (that didn&#39;t end with a newline) before I finished this comment, but I&#39;ll post this <a href=\"https://godbolt.org/g/mGzqZQ\" rel=\"nofollow noreferrer\">godbolt link anyway</a>, where I added v3 and v4 to an example I had already made for something else."}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 14, "last_activity_date": 1580923867, "last_edit_date": 1592644375, "creation_date": 1464306476, "answer_id": 37472747, "question_id": 37435984, "link": "https://stackoverflow.com/questions/37435984/why-doesnt-gcc-optimize-this-call-to-printf/37472747#37472747", "title": "Why doesn&#39;t GCC optimize this call to printf?", "body": "<p>First of all, the problem is not the <code>if</code>; as you saw, <code>gcc</code> sees through the <code>if</code> and manages to pass <code>30</code> straight to <code>printf</code>.</p>\n<p>Now, <code>gcc</code> does have some logic to handle special cases of <code>printf</code> (in particular, it does optimize <code>printf(&quot;something\\n&quot;)</code> and even <code>printf(&quot;%s\\n&quot;, &quot;something&quot;)</code> to <code>puts(&quot;something&quot;)</code>), but it is extremely specific and doesn't go much further; <code>printf(&quot;Hello %s\\n&quot;, &quot;world&quot;)</code>, for example, is left as-is. Even worse, any of the variants above <em>without</em> a trailing newline are left untouched, even if they could be transformed to <code>fputs(&quot;something&quot;, stdout)</code>.</p>\n<p>I imagine that this comes down to two main problems:</p>\n<ul>\n<li><p>the two cases above are extremely easy patterns to implement and happen quite frequently, but for the rest probably it's rarely worth the effort; if the string is constant and the performance is important, the programmer can take care of it easily - actually, if the performance of <code>printf</code> is critical he shouldn't be relying on this kind of optimization, which may break at the slightest change of format string.</p>\n<p>If you ask me, even just the <code>puts</code> optimizations above are already &quot;going for the style points&quot;: you are not really going to gain serious performance in anything but artificial test cases.</p>\n</li>\n<li><p>When you start to go outside the realm of <code>%s\\n</code>, <code>printf</code> is a minefield, because it has a strong dependency on the runtime environment; in particular, many <code>printf</code> specifiers are (unfortunately) affected by the locale, plus there are a host of implementation-specific quirks and specifiers (and <code>gcc</code> can work with <code>printf</code> from glibc, musl, mingw/msvcrt, ... - and at compile time you cannot invoke the target C runtime - think when you are cross-compiling).</p>\n<p>I agree that this simple <code>%d</code> case is probably safe, but I can see why they probably decided to avoid being overly smart and only perform the dumbest and safest optimizations here.</p>\n</li>\n</ul>\n<hr />\n<p>For the curious reader, <a href=\"https://github.com/gcc-mirror/gcc/blob/master/gcc/gimple-fold.c#L2545\" rel=\"noreferrer\">here</a> is where this optimization is actually implemented; as you can see, the function matches a restricted number of very simple cases (and GIMPLE aside, hasn't changed a lot since <a href=\"http://www.ciselant.de/projects/gcc_printf/gcc_printf.html\" rel=\"noreferrer\">this nice article</a> outlining them was written). Incidentally, the source actually explains why they couldn't implement the <code>fputs</code> variant for the non-newline case (there's no easy way to reference the <code>stdout</code> global at that compilation stage).</p>\n"}, {"comments": [{"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 0, "creation_date": 1577197031, "post_id": 42384785, "comment_id": 105118917, "body": "Actually, on most modern systems you wouldn&#39;t even save a &quot;push to stack&quot; - the first several arguments get passed in registers in almost every widely used ABI nowadays. (You still might have values moved around in registers instead, or a stack push to save whatever was in the register, but a modern compiler will often craftily arrange for the right values to be in the right registers as part of the other instructions it has to do anyway, if it can.)"}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 0, "creation_date": 1577197259, "post_id": 42384785, "comment_id": 105118990, "body": "Arguments one through three are the kind of thing that could and in fact probably ideally should be controlled by optimization flags. So they do mot prevent a sufficiently-intelligent compiler from implementing them, so long as the compiler then turned those optimizations off when &quot;optimize for size&quot; was in effect."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 0, "creation_date": 1577197283, "post_id": 42384785, "comment_id": 105118997, "body": "All that said, +1 to the answer overall."}, {"owner": {"reputation": 471, "user_id": 4606310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/436961ae0a249d361e993c733e51c561?s=128&d=identicon&r=PG&f=1", "display_name": "Explorer09", "link": "https://stackoverflow.com/users/4606310/explorer09"}, "reply_to_user": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 0, "creation_date": 1577316500, "post_id": 42384785, "comment_id": 105141402, "body": "@mtraceur In x86_64 ABI for Unix, the first 6 arguments to a function are passed in registers, but you still need &#39;mov&#39; instructions to do the work, which doesn&#39;t necessaily save code size (this kind of detail is complicated to explain and not needed with the given question&#39;s scope)."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 0, "creation_date": 1577464644, "post_id": 42384785, "comment_id": 105179518, "body": "Yeah, but like I said above, a good compiler can sometimes avoid separate <code>mov</code> instructions, but x86-64 is really a bad example architecture to see that on, because it has so few registers, and has many operations that operate &quot;on&quot; one of the operand registers instead of &quot;into&quot; a result register."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 0, "creation_date": 1577465221, "post_id": 42384785, "comment_id": 105179747, "body": "Better examples can be found by looking at what a modern compiler might do when generating code for an ARM (any version) ABI, or any of the other RISC chips (MIPS, SPARC, etc - but ARM probably gets the most human effort into compiler optimizations due to its massive prevalence)."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 1, "creation_date": 1577465634, "post_id": 42384785, "comment_id": 105179893, "body": "A toy example: if I have to add two numbers, and then call a function with the result, there have to be instructions to do the add anyway, and the compiler can just make sure that those instructions end up leaving the result in the register that is used to pass the function argument. (Whether this is possible in practice depends a lot of details of the code, instruction set, and ABI, and I agree that it&#39;s not worth explaining in-depth.)"}], "tags": [], "owner": {"reputation": 471, "user_id": 4606310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/436961ae0a249d361e993c733e51c561?s=128&d=identicon&r=PG&f=1", "display_name": "Explorer09", "link": "https://stackoverflow.com/users/4606310/explorer09"}, "is_accepted": false, "score": 2, "last_activity_date": 1487747705, "last_edit_date": 1487747705, "creation_date": 1487747136, "answer_id": 42384785, "question_id": 37435984, "link": "https://stackoverflow.com/questions/37435984/why-doesnt-gcc-optimize-this-call-to-printf/42384785#42384785", "title": "Why doesn&#39;t GCC optimize this call to printf?", "body": "<p>Not sure if this is a convincing answer, but I would expect that compilers shouldn't optimize <code>printf(\"%d\\n\", 10)</code> case to <code>puts(\"10\")</code> .</p>\n\n<p>Why? Because this case could be more complicated than you think. Here are some of the problems I can think of at the moment:</p>\n\n<ol>\n<li><p>Convert binary numbers to ASCII <strong>increases size of string literal</strong>, and thus overall code size. Although this is irrelevant to small numbers, but if it's <code>printf(\"some number: %d\", 10000)</code> ---- 5 digits or more (assuming <code>int</code> is 32-bit), the string size increased will beat the size saved for the integer, and some people could consider this a drawback. Yes, with the conversion I saved a \"push to stack\" instruction, but how many bytes the instruction is and how many would be saved is architecture-specific. It's non-trivial for a compiler to say if it's worth it.</p></li>\n<li><p><strong>Padding</strong>, if used in formats, can also increase size of expanded string literal. Example: <code>printf(\"some number: %10d\", 100)</code></p></li>\n<li><p>Sometimes I the developer would share a format string among printf calls, for code size reasons:</p>\n\n<pre><code>printf(\"%-8s: %4d\\n\", \"foo\", 100);\nprintf(\"%-8s: %4d\\n\", \"bar\", 500);\nprintf(\"%-8s: %4d\\n\", \"baz\", 1000);\nprintf(\"%-8s: %4d\\n\", \"something\", 10000);\n</code></pre>\n\n<p>Converting them to different string literals might lose the size advantage.</p></li>\n<li><p>For <code>%f</code>, <code>%e</code>, and <code>%g</code>, there is a problem that decimal point \".\" is locale-dependent. Hence the compiler cannot expand it to string constant for you. Although we are only discussing about <code>%d</code> I mention this here for completeness.</p></li>\n</ol>\n"}], "owner": {"reputation": 561, "user_id": 4108929, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34ce934551dd49eeebb4a47f7b57d9a1?s=128&d=identicon&r=PG&f=1", "display_name": "Mitsos101", "link": "https://stackoverflow.com/users/4108929/mitsos101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1431, "favorite_count": 0, "accepted_answer_id": 37472747, "answer_count": 3, "score": 15, "last_activity_date": 1580923867, "creation_date": 1464176262, "last_edit_date": 1464305137, "question_id": 37435984, "link": "https://stackoverflow.com/questions/37435984/why-doesnt-gcc-optimize-this-call-to-printf", "title": "Why doesn&#39;t GCC optimize this call to printf?", "body": "<pre><code>#include &lt;stdio.h&gt;\nint main(void) { \n    int i;\n    scanf(\"%d\", &amp;i);\n    if(i != 30) { return(0); } \n    printf(\"i is equal to %d\\n\", i);\n}\n</code></pre>\n\n<p>It appears that the resulting string will always be \"i is equal to 30\", so, why doesn't GCC optimize this call to printf with a call to <code>puts()</code>, or <code>write()</code>, for example?</p>\n\n<p>(Just checked the generated assembly, with <code>gcc -O3</code> (version 5.3.1), or on the <a href=\"http://gcc.godbolt.org/#compilers:!((compiler:g530,options:&#39;-xc+-std%3Dgnu11+-Wall+-fverbose-asm++-O3+-march%3Dhaswell+-mavx&#39;,source:&#39;%23include+%3Cstdio.h%3E%0Aint+main(void)+%7B+%0A++++int+i%3B%0A++++scanf(%22%25d%22,+%26i)%3B%0A++++if(i+!!%3D+30)+%7B+return(0)%3B+%7D+%0A++++printf(%22i+is+equal+to+%25d%5Cn%22,+i)%3B%0A%7D&#39;)),filterAsm:(commentOnly:!t,directives:!t,intel:!t,labels:!t),version:3\" rel=\"noreferrer\">Godbolt Compiler Explorer</a>)</p>\n"}, {"tags": ["c", "bash", "shell", "input", "io-redirection"], "comments": [{"owner": {"reputation": 95, "user_id": 4204404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85840562b79b7ff8f3ed41875a604e9d?s=128&d=identicon&r=PG&f=1", "display_name": "hiabcwelcome", "link": "https://stackoverflow.com/users/4204404/hiabcwelcome"}, "reply_to_user": {"reputation": 41196, "user_id": 887539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5baef9617bdee6db2f534c118bcbccee?s=128&d=identicon&r=PG", "display_name": "andlrc", "link": "https://stackoverflow.com/users/887539/andlrc"}, "edited": false, "score": 0, "creation_date": 1464177307, "post_id": 37435728, "comment_id": 62375433, "body": "@andlrc The duplicate question asks for &quot;way of checking to see if stdin exists&quot;. In my program stdin is present, I just have turned echo off using tcgetattr and tcsetattr."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1464177373, "post_id": 37435728, "comment_id": 62375483, "body": "<code>#include &lt;unistd.h&gt;         int isatty(int fd); </code>"}, {"owner": {"reputation": 95, "user_id": 4204404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85840562b79b7ff8f3ed41875a604e9d?s=128&d=identicon&r=PG&f=1", "display_name": "hiabcwelcome", "link": "https://stackoverflow.com/users/4204404/hiabcwelcome"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1464186815, "post_id": 37435728, "comment_id": 62383032, "body": "@wildplasser Can you please explain? I&#39;m not understanding what you are saying"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1464187139, "post_id": 37435728, "comment_id": 62383320, "body": "[please read the manpage for isatty() first] <code>stdin</code> is a file. But not all files have the same properties; your ioctls are only valid for some kind of files (TTYs) This applies to a lot of file operations, you cannot seek or mount a tty, and you cannot set the baudrate for a pipe or disk file, for instance."}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 4204404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85840562b79b7ff8f3ed41875a604e9d?s=128&d=identicon&r=PG&f=1", "display_name": "hiabcwelcome", "link": "https://stackoverflow.com/users/4204404/hiabcwelcome"}, "is_accepted": true, "score": 0, "last_activity_date": 1464324391, "creation_date": 1464324391, "answer_id": 37475041, "question_id": 37435728, "link": "https://stackoverflow.com/questions/37435728/send-input-to-a-c-program-from-shell-script/37475041#37475041", "title": "Send input to a C program from shell script", "body": "<p>Following Expect script worked for me.</p>\n\n<pre><code>#!/usr/bin/expect\nspawn ./test\nexpect \"password:\"\nsend \"hello word\\r\"\ninteract\n</code></pre>\n\n<p>I got output as follows:</p>\n\n<pre><code>$ ./test.sh \nspawn ./test\npassword: \nyou typed 'hello word'\n</code></pre>\n\n<p>I don't know why this worked and other won't.\nPlease feel free to edit this answer if anyone has more explanation.</p>\n"}], "owner": {"reputation": 95, "user_id": 4204404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85840562b79b7ff8f3ed41875a604e9d?s=128&d=identicon&r=PG&f=1", "display_name": "hiabcwelcome", "link": "https://stackoverflow.com/users/4204404/hiabcwelcome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1333, "favorite_count": 0, "closed_date": 1465384153, "accepted_answer_id": 37475041, "answer_count": 1, "score": 1, "last_activity_date": 1464324391, "creation_date": 1464175657, "last_edit_date": 1495541283, "question_id": 37435728, "link": "https://stackoverflow.com/questions/37435728/send-input-to-a-c-program-from-shell-script", "closed_reason": "Duplicate", "title": "Send input to a C program from shell script", "body": "<p>I have a c program\nIt uses tcgetattr and tcsetattr, which stop echo of user input.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;termios.h&gt;\n\nint\nmain(int argc, char **argv)\n{\n    struct termios oflags, nflags;\n    char password[64];\n\n    /* disabling echo */\n    tcgetattr(fileno(stdin), &amp;oflags);\n    nflags = oflags;\n    nflags.c_lflag &amp;= ~ECHO;\n    nflags.c_lflag |= ECHONL;\n\n    if (tcsetattr(fileno(stdin), TCSANOW, &amp;nflags) != 0) {\n        perror(\"tcsetattr\");\n        return EXIT_FAILURE;\n    }\n\n    printf(\"password: \");\n    fgets(password, sizeof(password), stdin);\n    password[strlen(password) - 1] = 0;\n    printf(\"you typed '%s'\\n\", password);\n\n    /* restore terminal */\n    if (tcsetattr(fileno(stdin), TCSANOW, &amp;oflags) != 0) {\n        perror(\"tcsetattr\");\n        return EXIT_FAILURE;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I want to execute this program using shell script and give some input to it. Following steps from <a href=\"https://stackoverflow.com/questions/16508817/how-do-i-provide-input-to-a-c-program-from-bash\">here</a> I tried</p>\n\n<pre><code>$ ./test &lt;&lt;EOF\n&gt; hello\n&gt; EOF\n</code></pre>\n\n<p>and</p>\n\n<pre><code>$ ./test &lt;&lt;&lt;'hello'\n</code></pre>\n\n<p>and</p>\n\n<pre><code>$ ./test &lt;input \n</code></pre>\n\n<p>and</p>\n\n<pre><code>$ cat input | ./test \n</code></pre>\n\n<p>but all above method gave me <code>tcsetattr: Inappropriate ioctl for device</code> error</p>\n\n<p>What is the appropriate way to run such program adding it to shell script?\nOr can we run it from python? If yes, how to pass inputs from python to c program?</p>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1464175527, "post_id": 37435567, "comment_id": 62374182, "body": "You <i>do</i> realise that <code>num</code> must be in the range <code>0..9</code> to index the array? If so, why do you multiply it by 16 (<code>num &lt;&lt;= 4</code>)? That has either no effect (when <code>num == 0</code>) or puts it out of range (when <code>num &gt;= 1</code>)."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1464189207, "post_id": 37435567, "comment_id": 62384992, "body": "is the problem senddatabyte or is the problem in your math?  if you call senddatabyte and hardcode a value for each digit instead of dec[num] can you get it to properly display the value.   alternatively if you take this code on the target or on some other platform and printf the bcd is it correct and does it meet the senddatabyte() input requirements?"}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 1, "last_activity_date": 1464176313, "creation_date": 1464176313, "answer_id": 37436006, "question_id": 37435567, "link": "https://stackoverflow.com/questions/37435567/show-decimal-value-on-tm-1638-8-digit-7-segment-display/37436006#37436006", "title": "Show decimal value on TM-1638 8 digit 7 segment display", "body": "<p>For larger numbers, you have to use a loop. Loop while the number is larger than or equal to 10. Take the number modulus 10 to get the least significant digit, which you can print on the display. Then divide the number by 10 and loop again. And then finally when the loop is done and what remains of the number is a digit smaller than 10, print that digit too.</p>\n"}], "owner": {"reputation": 3, "user_id": 5126418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b735153202526635adc5e3c406477cfa?s=128&d=identicon&r=PG&f=1", "display_name": "eza awt", "link": "https://stackoverflow.com/users/5126418/eza-awt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "closed_date": 1464325537, "accepted_answer_id": 37436006, "answer_count": 1, "score": 0, "last_activity_date": 1464176313, "creation_date": 1464175221, "last_edit_date": 1464175387, "question_id": 37435567, "link": "https://stackoverflow.com/questions/37435567/show-decimal-value-on-tm-1638-8-digit-7-segment-display", "closed_reason": "Not suitable for this site", "title": "Show decimal value on TM-1638 8 digit 7 segment display", "body": "<p>I am doing a program in C in which I have to read the value of the button in my TM-1638 and sent it to the 7-segment display. I got through the reading part now I am having problems to show the value in the display. \nI have converted the value to BCD with this code:</p>\n\n<pre><code>const uint8_t dec[] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d,0x07,0x7f,0x6f};\nif(readbyte &gt; 0)\n{\n    num &lt;&lt;= 4;\n    num |= readbyte % 10;\n    readbyte /= 10;\n}\n\nsenddatabyte(0x0a, dec[num]);\nsenddatabyte(0x0c, dec[num]);\nsenddatabyte(0x0e, dec[num &amp;0x0f]);\n</code></pre>\n\n<p>in which <code>senddatabyte</code> sends the value to the selected adress of the 7 segment display.\nIt works good when it have to display one digit number but it doesnt work when it displays tens and hundreds.</p>\n"}, {"tags": ["c++", "c", "linux", "ubuntu-12.04"], "comments": [{"owner": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "edited": false, "score": 0, "creation_date": 1464178014, "post_id": 37435526, "comment_id": 62375959, "body": "Which compiler are you using ? I got your code compile fine on g++/gcc 5.1"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1464182198, "post_id": 37435526, "comment_id": 62379312, "body": "OT: <code>sin_port</code> comes in network byte order. You want wrap the call into <code>ntoh()</code> to print the port number using (the more readable ;-) host byte order."}, {"owner": {"reputation": 351, "user_id": 5040234, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d8af41c8e0dae694f55420409c1eb61b?s=128&d=identicon&r=PG&f=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/5040234/ron"}, "reply_to_user": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "edited": false, "score": 0, "creation_date": 1464273248, "post_id": 37435526, "comment_id": 62426616, "body": "I compiled under g++ 4.6.3; @shrike"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 13872310, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GhDHEBjUBaJp77ZhDBKAyPNmMfU_wpBqdooWEUkhA=k-s128", "display_name": "orgg", "link": "https://stackoverflow.com/users/13872310/orgg"}, "edited": false, "score": 0, "creation_date": 1609345362, "post_id": 37435682, "comment_id": 115819432, "body": "I&#39;m using Centos7 and didn&#39;t have to define _BSD_SOURCE - looks like I was just missing arpa/inet.h :)"}], "tags": [], "owner": {"reputation": 3356, "user_id": 4451432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97b46aba1c1ec6b780b9735f0ec7f885?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Popov", "link": "https://stackoverflow.com/users/4451432/ilya-popov"}, "is_accepted": true, "score": 4, "last_activity_date": 1464182308, "last_edit_date": 1464182308, "creation_date": 1464175518, "answer_id": 37435682, "question_id": 37435526, "link": "https://stackoverflow.com/questions/37435526/inet-ntoa-not-declared-error/37435682#37435682", "title": "&#39;inet_ntoa&#39; not declared error", "body": "<p>From <code>man inet_ntoa</code> it appears you have to define <code>_BSD_SOURCE</code> before including the headers:</p>\n\n<pre><code>#define _BSD_SOURCE\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 5040234, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d8af41c8e0dae694f55420409c1eb61b?s=128&d=identicon&r=PG&f=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/5040234/ron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4631, "favorite_count": 0, "accepted_answer_id": 37435682, "answer_count": 1, "score": 2, "last_activity_date": 1464182308, "creation_date": 1464175120, "question_id": 37435526, "link": "https://stackoverflow.com/questions/37435526/inet-ntoa-not-declared-error", "title": "&#39;inet_ntoa&#39; not declared error", "body": "<p>I'm tring to use inet_ntoa function\nwriting to following code:</p>\n\n<pre><code>printf(\"Got connection from: %s:%d\\n\", inet_ntoa(cli_addr.sin_addr.s_addr), cli_addr.sin_port);\n</code></pre>\n\n<p>Using the following includes:</p>\n\n<pre><code>#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n</code></pre>\n\n<p>But, using g++/gcc I'm  always get the error:</p>\n\n<blockquote>\n  <p>error: \u2018inet_ntoa\u2019 was not declared in this scope</p>\n</blockquote>\n\n<p>If I'm comment that line, the code is just fine.</p>\n\n<p>Running under Ubuntu12.04.</p>\n\n<p>Can anybody tell me what I missed?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "windows", "networking", "driver", "ndis"], "owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1464174170, "creation_date": 1464174170, "question_id": 37435164, "link": "https://stackoverflow.com/questions/37435164/is-it-possible-to-have-two-filter-drivers-in-one-binary-on-windows", "title": "Is it possible to have two filter drivers in one binary on Windows?", "body": "<p>I have a filter (light-weight filter, LWF) driver that captures the packets from all the adapters. The <code>FilterClass</code> is <code>compression</code>, the same with official ndislwf example. This setting will bind the filter above <code>Native Wifi Filter</code>.</p>\n\n<p>However, this FilterClass can only capture Ethernet packets on wireless adapters. So I want it to be able to capture the raw 802.11 packets on wireless adapters. So I need to specify <code>FilterClass</code> as <code>ms_medium_converter_128</code> in the INF. This setting will bind the filter below <code>Native Wifi Filter</code>.</p>\n\n<p>So I need to have two drivers now. One is <code>compression</code> and another is <code>ms_medium_converter_128</code>. But I don't want to maintain two drivers's code and let my users install two drivers. Is there a way to mix two LWFs into one binary (and only needs one install)? Or is there a way to let one LWF be able to bind above and below <code>Native Wifi Filter</code> at the same time? Thanks!</p>\n\n<hr>\n\n<p>Here's my whole INF with <code>compression</code> FilterClass:</p>\n\n<pre><code>;-------------------------------------------------------------------------\n; NPF.INF -- Npcap NDIS 6.x LightWeight Filter Driver\n;\n; Copyright (c) 2015, Insecure.Com LLC.  All rights reserved.\n;------------------------------------------------------------------------\n[version]\nSignature       = \"$Windows NT$\"\nClass           = NetService\nClassGUID       = {4D36E974-E325-11CE-BFC1-08002BE10318}\nCatalogFile     = %NPF_DriverName%.cat\nProvider        = %Insecure%\nDriverVer=05/20/2016,15.54.30.752\n\n\n[Manufacturer]\n%Insecure%=Insecure,NTx86,NTia64,NTamd64\n\n[Insecure.NTx86]\n%NPF_Desc%=Install, INSECURE_NPF\n\n[Insecure.NTia64]\n%NPF_Desc%=Install, INSECURE_NPF\n\n[Insecure.NTamd64]\n%NPF_Desc%=Install, INSECURE_NPF\n\n;-------------------------------------------------------------------------\n; Installation Section\n;-------------------------------------------------------------------------\n[Install]\nAddReg=Inst_Ndi\nCharacteristics=0x40000\nNetCfgInstanceId=\"{7daf2ac8-e9f6-4765-a842-f1f5d2501340}\"\nCopyfiles = npf.copyfiles.sys\n\n[SourceDisksNames]\n1=%NPF_Desc%,\"\",,\n\n[SourceDisksFiles]\nnpf.sys=1\n\n[DestinationDirs]\nDefaultDestDir=12\nnpf.copyfiles.sys=12\n\n[npf.copyfiles.sys]\n%NPF_DriverName%.sys,,,2\n\n\n;-------------------------------------------------------------------------\n; Ndi installation support\n;-------------------------------------------------------------------------\n[Inst_Ndi]\nHKR, Ndi,Service,,%NPF_DriverName%\nHKR, Ndi,CoServices,0x00010000,%NPF_DriverName%\nHKR, Ndi,HelpText,,%NPF_HelpText%\nHKR, Ndi,FilterClass,, compression\n\n\n; For a Monitoring filter, use this:\n;     HKR, Ndi,FilterType,0x00010001, 1 ; Monitoring filter\n; For a Modifying filter, use this:\n;     HKR, Ndi,FilterType,0x00010001, 2 ; Modifying filter\nHKR, Ndi,FilterType,0x00010001,2\n\n\nHKR, Ndi\\Interfaces,UpperRange, , noupper\nHKR, Ndi\\Interfaces,LowerRange, , \"ndis5,ndis4\"\n\n\n; TODO: Ensure that the list of media types below is correct.  Typically,\n; filters include \"ethernet\".  Filters may also include \"ppip\" to include\n; native WWAN stacks, but you must be prepared to handle the packet framing.\n; Possible values are listed on MSDN, but common values include:\n;     ethernet, wan, ppip, wlan\nHKR, Ndi\\Interfaces, FilterMediaTypes,,\"ethernet, fddi, wan, ppip, wlan, bluetooth, ndis5, vwifi, flpp4, flpp6, vchannel, nolower\"\n\n\n; For a Mandatory filter, use this:\n;     HKR, Ndi,FilterRunType,0x00010001, 1 ; Mandatory filter\n; For an Optional filter, use this:\n;     HKR, Ndi,FilterRunType,0x00010001, 2 ; Optional filter\nHKR, Ndi,FilterRunType,0x00010001, 2 ; Optional filter\n\n\n; By default, Mandatory filters unbind all protocols when they are\n; installed/uninstalled, while Optional filters merely pause the stack.  If you\n; would like to override this behavior, you can include these options.  These\n; options only take effect with 6.30 filters on Windows \"8\" or later.\n; To prevent a full unbind, and merely pause/restart protocols:\n;     HKR, Ndi,UnbindOnAttach,0x00010001, 0 ; Do not unbind during FilterAttach\n;     HKR, Ndi,UnbindOnDetach,0x00010001, 0 ; Do not unbind during FilterDetach\n; To force a full unbind/bind (which includes pause/restart, of course):\n;     HKR, Ndi,UnbindOnAttach,0x00010001, 1 ; Unbind during FilterAttach\n;     HKR, Ndi,UnbindOnDetach,0x00010001, 1 ; Unbind during FilterDetach\n;\n\n;-------------------------------------------------------------------------\n; Service installation support\n;-------------------------------------------------------------------------\n[Install.Services]\nAddService=%NPF_DriverName%,,NPF_Service_Inst\n\n[NPF_Service_Inst]\nDisplayName     = %NPF_Desc%\nServiceType     = 1 ;SERVICE_KERNEL_DRIVER\nStartType       = 3 ;SERVICE_DEMAND_START\nErrorControl    = 1 ;SERVICE_ERROR_NORMAL\nServiceBinary   = %12%\\%NPF_DriverName%.sys\nLoadOrderGroup  = NDIS\nDescription     = %NPF_Desc%\nAddReg          = Common.Params.reg, NdisImPlatformBindingOptions.reg\n\n[Install.Remove.Services]\nDelService=%NPF_DriverName%,0x200 ; SPSVCINST_STOPSERVICE\n\n[Common.Params.reg]\n\n[NdisImPlatformBindingOptions.reg]\n; By default, when an LBFO team or Bridge is created, all filters will be\n; unbound from the underlying members and bound to the TNic(s). This keyword\n; allows a component to opt out of the default behavior\n; To prevent binding this filter to the TNic(s):\n;   HKR, Parameters, NdisImPlatformBindingOptions,0x00010001,1 ; Do not bind to TNic\n; To prevent unbinding this filter from underlying members:\n;   HKR, Parameters, NdisImPlatformBindingOptions,0x00010001,2 ; Do not unbind from Members\n; To prevent both binding to TNic and unbinding from members:\n;   HKR, Parameters, NdisImPlatformBindingOptions,0x00010001,3 ; Do not bind to TNic or unbind from Members\nHKR, Parameters, NdisImPlatformBindingOptions,0x00010001,0 ; Subscribe to default behavior\n\n[Strings]\nNPF_DriverName = \"npf\"\nInsecure = \"Nmap Project\"\nNPF_Desc = \"Npcap Packet Driver (NPCAP)\"\nNPF_HelpText = \"A NDIS 6 filter driver &amp; WFP callout driver to support packet capturing and sending under Windows 7, 8 &amp; 10\"\n</code></pre>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "edited": false, "score": 2, "creation_date": 1464174265, "post_id": 37435072, "comment_id": 62373379, "body": "cli_len should be of type socklen_t, not int. The typecast hides a potential problem on x86_64 where int can be 32bit, but other size_related types can be 64bit."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1464174271, "post_id": 37435072, "comment_id": 62373385, "body": "You&#39;re not reporting the error correctly. You need to call <code>perror()</code> or <code>strerror()</code> <i>before</i> doing anything else that could change <code>errno</code>, such as <code>printf()</code>. Fix, retest, ..."}, {"owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "edited": false, "score": 2, "creation_date": 1464174484, "post_id": 37435072, "comment_id": 62373514, "body": "Problem 2, the child should call exit when done, else both child and parent will fight in accept() ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 2, "last_activity_date": 1464174483, "creation_date": 1464174483, "answer_id": 37435319, "question_id": 37435072, "link": "https://stackoverflow.com/questions/37435072/bad-file-descriptor-error-on-accept/37435319#37435319", "title": "bad file descriptor: error on accept()", "body": "<p>If the result of <code>fork()</code> is zero you need to do your I/O with the accepted socket <em>and then exit the process</em>. At present you are allowing the accept loop to reiterate in the child process after having closed the listening socket.</p>\n"}, {"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 1, "last_activity_date": 1464179586, "last_edit_date": 1464179586, "creation_date": 1464175096, "answer_id": 37435519, "question_id": 37435072, "link": "https://stackoverflow.com/questions/37435072/bad-file-descriptor-error-on-accept/37435519#37435519", "title": "bad file descriptor: error on accept()", "body": "<p>The child forked off should end after the <code>read()</code>, but it doesn't. It continues to loop. What probably is not your intention.</p>\n\n<p>The child then calls <code>accept()</code> passing <code>-1</code> as socket descriptor. <code>-1</code> is not a valid socket descriptor.</p>\n\n<pre><code>    accept(sockfd, ...\n</code></pre>\n\n<p>The child sets <code>sockfd</code> to <code>-1</code> here:</p>\n\n<pre><code>    pid = fork();\n    if( pid == 0 ) {\n\n        close( sockfd );\n        sockfd = -1;\n</code></pre>\n\n<p>Doing so the valid socket descriptor as returned by <code>socket()</code> gets overwritten, is lost.</p>\n\n<p>So the error you observe does not arise from your listening server process, but from the forked-off child.</p>\n\n<p>To fix this add a call to <code>exit()</code> inside the child, like this:</p>\n\n<pre><code>        ...\n        newsockfd = -1;\n        exit(EXIT_SUCCESS);\n      }\n</code></pre>\n\n<hr>\n\n<p>This <code>int cli_len;</code> should be <code>socklen_t cli_len;</code>. And the cast of <code>cli_len</code> when calling <code>accept()</code> should be removed. Do <em>not</em> blindly cast away errors!</p>\n"}], "owner": {"reputation": 13, "user_id": 6380707, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207603981315332/picture?type=large", "display_name": "Emanuele Bucoli", "link": "https://stackoverflow.com/users/6380707/emanuele-bucoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6349, "favorite_count": 0, "accepted_answer_id": 37435519, "answer_count": 2, "score": 1, "last_activity_date": 1464179586, "creation_date": 1464173887, "last_edit_date": 1464178079, "question_id": 37435072, "link": "https://stackoverflow.com/questions/37435072/bad-file-descriptor-error-on-accept", "title": "bad file descriptor: error on accept()", "body": "<p>I am trying to write a simple chat application, in which a client receives a string from the server and sends a new message, which will be delivered to the next client connecting. I am new to socket programming, and I really can't get why this error occurs. After the client sends his buffer, the server notifies an error on <code>accept()</code> (returning -1) and a bad file descriptor. Here's the code running on the server: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n\nvoid error(char *msg) {\n    perror(msg);\n    exit(1);\n}\n\nint main (int argc, char *argv[] ) {\n\n    if ( argc &lt; 2 ) {\n        error(\"ERROR, no port provided\\n\");\n    }\n\n    int sockfd;\n    struct sockaddr_in serv_addr, cli_addr;\n    int cli_len, portno;\n    char message[256];\n    pid_t pid;\n    int n;\n\n    portno = atoi( argv[1] );\n    bzero( (char*)&amp;serv_addr, sizeof(serv_addr) );\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_addr.s_addr = INADDR_ANY;\n    serv_addr.sin_port = htons( portno );\n\n    sockfd = socket( AF_INET, SOCK_STREAM, 0 );\n\n    n =  bind ( sockfd, (struct sockaddr*)&amp;serv_addr, sizeof(serv_addr) );\n    if ( n &lt; 0 ) {\n        error(\"ERROR on binding\\n\");\n    }\n\n    listen( sockfd, 5 );\n\n    do {\n        cli_len = sizeof(cli_addr);\n\n        int newsockfd;\n        newsockfd = accept( sockfd,(struct sockaddr*)&amp;cli_addr,(socklen_t *)&amp;cli_len);\n        if ( newsockfd &lt; 0 ) {\n            printf(\"%i\", newsockfd);\n            error(\"ERROR on accept\\n\");\n\n        }\n\n        pid = fork();\n        if( pid == 0 ) {\n\n            close( sockfd );\n            sockfd = -1;\n\n            n = send( newsockfd, message, strlen(message), 0);\n            if ( n &lt; 0 ) error(\"ERROR sending\\n\");\n\n            bzero(message, 256);\n\n            n = recv( newsockfd, message, 256, 0);\n            if ( n &lt; 0 ) error(\"ERROR receiving\\n\");\n\n            close( newsockfd );\n            newsockfd = -1;\n\n        } \n\n    }\n    while( 1 );\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "parameter-passing"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1464174274, "post_id": 37435005, "comment_id": 62373390, "body": "You are breaking array bounds with <code>for (i = 0; i &lt; WIDTH+1;i++)</code> causing <i>undefined behaviour</i> and from then on anything might happen. Ditto the height loop."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1464174336, "post_id": 37435005, "comment_id": 62373429, "body": "You also have <code>array[i-1][j] = 45</code> which is also <i>undefined behaviour</i> when <code>i == 0</code>. Similar problem the other end with <code>array[i+1][j]</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1464174527, "post_id": 37435005, "comment_id": 62373543, "body": "Please do not use magic numbers, instead of <code>45</code> use <code>&#39;-&#39;</code>, instead of <code>48</code> use <code>&#39;0&#39;</code> and so on."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6380763"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464175787, "post_id": 37435005, "comment_id": 62374337, "body": "@WeatherVane I have changed it to:  for (i = 0; i &lt; WIDTH;i++) but the hyphens disappear all together.   May I ask how does one fix the issue with:   array[i-1][j] = 45 and how I end up with a negative array index if it&#39;s i = 0?  Thank you so much!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464176201, "post_id": 37435005, "comment_id": 62374610, "body": "You cannot write to the &quot;left&quot; of an array. So you fix it with <code>if (i &gt; 0) { array[i-1][j] = &#39;-&#39;; }</code>. You get a negative index when <code>i == 0</code> because <code>i-1</code> is <code>0-1</code> which is <code>-1</code>."}], "owner": {"user_type": "does_not_exist", "display_name": "user6380763"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464183819, "creation_date": 1464173714, "last_edit_date": 1464183819, "question_id": 37435005, "link": "https://stackoverflow.com/questions/37435005/number-board-program-doesnt-place-hyphens-correctly-in-c", "title": "Number Board Program doesn&#39;t place hyphens correctly in C", "body": "<p>We're supposed to create a number board whereby a user is allowed to select a number for instance, number 5 and one of the number 5's in the board will be clearly indicated as selected with a hyphen above and below it.</p>\n\n<p>Problem now is: No matter what I try the hyphens refuse to move to the right spot.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n#include&lt;time.h&gt;\n\n#define HEIGHT 9\n#define WIDTH 8\n\n\nvoid board(char array[HEIGHT][WIDTH])\n{    \n    int x,y,i,j,score,steps = 0;\n\n/****BORDER CREATION*/          \n    for (i = 0; i &lt; WIDTH+4; i ++)\n        printf(\"# \");    \n    printf(\"\\n\");\n\n    for(y=0;y&lt;WIDTH+1;y++)\n    {\n       printf(\"\\n\");    \n       printf(\"# \");\n\n       for(x=0;x&lt;HEIGHT+1;x++)\n         {              \n          printf(\"%c \",array[y][x]);          \n         }\n       printf(\"# \");\n    printf(\"\\n\\n\");                \n    }\n\n    for (i = 0; i &lt; WIDTH+4; i ++)\n    printf(\"# \");    \n    printf(\"\\n\");       \n/****BORDER CREATION*/      \n}\n\n\nvoid instruc(char *name, int *steps, int *selected)\n{       \n    /*User record &amp; score header*/      \n    printf(\"\\n-----Hello %s! Let's see what you can do------\\n\",name);      \n    printf(\"----------WELCOME TO NUMBER CONNECT----------\\n\");\n    printf(\"----------PREVIOUS PLAYERS' RECORDS----------\\n\");\n    printf(\"----------Name: %s   Score(Steps): %i--\\n\\n\",name,*steps);\n\n    printf(\"\\nYour score: %i\",*steps);\n    printf(\"\\nNumber %i is currently selected\",*selected);\n\n    printf(\"\\n\\nAction Keys: \");\n    printf(\"\\nPush 'U' to move UP\"); \n    printf(\"\\nPush 'D' to move DOWN\");\n    printf(\"\\nPush 'L' to move LEFT\");\n    printf(\"\\nPush 'R' to move RIGHT\");\n\n    printf(\"\\nPush 'X' to REMOVE path\\n\");\n    printf(\"\\nTo select a new number, press digits from 1 to 7\\n\");\n    printf(\"\\nPush 'q' or 'Q' to QUIT\\n\\n\");    \n}\n\n\nvoid select(int *selected,char array[HEIGHT][WIDTH])\n{    \n    int i,j,x; \n\n    printf(\"\\nPlease select a number (1-8): \");  \n    fflush(stdin);\n    scanf(\"%i\",selected);\n    /*POINTER TYPE CONVERTION FAIL \n    selected = (char)*selected;*/\n\n    /*ASCII CHARACTER ATTEMPT FAIL \n    if (*selected == 1){\n    *selected = 1;\n    }\n    else if (*selected == 2){\n    *selected = 2;}\n    else if (*selected == 3){\n    *selected = 3;}\n    else if (*selected == 52){\n    *selected = 4;}\n    else if (*selected == 53){\n    *selected = 5;}\n    else if (*selected == 54){\n    *selected = 6;}\n    else if (*selected == 55){\n    *selected = 7;}\n    else if (*selected == 56){\n    *selected = 8;}\n    else{ \n    printf(\"Non-Numeric Input not allowed\");}*/\n\n    printf(\"\\nNumber Selected: %i\",*selected);\n\n/*To indicate selected number with hyphens (denoted by 45)*/        \n    for (i = 0; i &lt; WIDTH+1;i++)\n    {\n        for (j =0; j &lt; HEIGHT+1; j++){          \n            if (array[i][j] == *selected){              \n                array[i-1][j] = 45;\n                array[i+1][j] = 45;         \n            }                   \n        }\n    } \n    printf(\"\\nPosition of i:  %i \",i);\n    printf(\"Position of j:  %i\\n\\n\",j);       \n}\n\n\nvoid assign(char array[HEIGHT][WIDTH], int *selected)\n{    \n    int i,j;\n    /*int rr,rrr;\n    int x = 0;\n    srand((unsigned) time(NULL));\n\n    for (i = 0; i &lt; WIDTH+3;i++)\n    {\n        for (j = 0; j &lt; HEIGHT; j++){           \n            x = (rand()%8+1)+48;\n            array[i][j] = x;                             \n        }\n    } \n\n    for (i = 0; i &lt; WIDTH+3;i++)\n    {\n        for (j = 0; j &lt; HEIGHT+3; j++){     \n            rr = rand()%WIDTH;\n            rrr = rand()%HEIGHT;\n            x= 32;\n            array[rr][rrr] = x;    \n        }        \n    }        \n    printf(\"\\n\");*/     \n\n/*To blank our everything that is not a symbol*/        \n    array[0][1] = 49;\n    array[0][7] = 49;\n\n    array[5][9] = 50;\n    array[6][1] = 50;\n\n    array[1][4] = 51;\n    array[5][7] = 51;\n\n    array[7][2] = 52;\n    array[5][5] = 52;\n\n    array[3][3] = 53;\n    array[1][1] = 53;\n\n    array[7][3] = 54;\n    array[6][2] = 54;\n\n    array[3][7] = 55;\n    array[7][6] = 55;\n\n    array[2][4] = 56;\n    array[4][4] = 56;\n\n    for (i = 0; i &lt; WIDTH+4;i++)\n    {\n        for (j = 0; j &lt; HEIGHT+4; j++){\n\n            if ((array[i][j] != 49) &amp;&amp; (array[i][j] != 50) &amp;&amp; (array[i][j] != 51) &amp;&amp; \n        (array[i][j] != 52) &amp;&amp;  (array[i][j] != 53) &amp;&amp;  (array[i][j] != 54) &amp;&amp;  (array[i][j] != 55) &amp;&amp;\n        (array[i][j] != 56)){           \n                array[i][j] = 32;\n            }\n        }\n    }\n}\n\n\nint main(void)\n{\n    int i,j,x,y,score = 0,steps = 0,result = 0,selected=0;\n    char array[HEIGHT][WIDTH],name[20];\n\n    printf(\"Please Input Name: \");\n    scanf(\"%s\",&amp;name);\n\n    instruc(name,&amp;steps,&amp;selected);\n\n    assign(array,&amp;selected);\n\n    board(array);  \n    select(&amp;selected,array);\n    board(array); \n\n    return 0;       \n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 5, "creation_date": 1464173839, "post_id": 37434965, "comment_id": 62373088, "body": "Is there any reason why you are using a 5-element buffer to try to hold 6 digits plus a comma? Why have 2  calls to <code>printf</code>? Just assemble the string you want to print in a large enough buffer and print it once."}, {"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 1, "creation_date": 1464175316, "post_id": 37434965, "comment_id": 62374047, "body": "depending on your runtime library, the format <code>%&#39;d</code> might work"}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1464176091, "last_edit_date": 1464176091, "creation_date": 1464174808, "answer_id": 37435422, "question_id": 37434965, "link": "https://stackoverflow.com/questions/37434965/inserting-comma-in-a-large-int-number/37435422#37435422", "title": "inserting comma in a large int number", "body": "<p>First of all to hold <code>870,120</code> you have to define a <code>8</code> chars <code>buffer</code>.</p>\n\n<p>So you can use <code>%f</code> format specifier to do what you the job, e.g.:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n   char buffer[8] = {0};\n   unsigned int lNum= 870120000;\n\n   snprintf(buffer, sizeof(buffer), \"%3.3f\", (float)(lNum)/(1000000));\n   char *temp = strstr(buffer, \".\");\n   if (temp != NULL)\n   {\n       *temp = ',';\n   }\n\n   printf(\"%s\\n\",buffer);\n\n   return 0;\n}\n</code></pre>\n\n<p>or another example using double <code>snprintf</code> and a given number of integer part digits and decimal part digits.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdint.h&gt;\n\n#define INT_DIGIT 3\n#define DEC_DIGIT 3\n\nint main()\n{\n   char temp_buffer[128];\n   char buffer[INT_DIGIT+DEC_DIGIT+2] = {0};\n   unsigned int lNum= 87012000;\n\n   snprintf(temp_buffer, sizeof(temp_buffer), \"%u\",lNum);\n   snprintf(buffer, sizeof(buffer), \"%.*s,%.*s\", INT_DIGIT, temp_buffer, DEC_DIGIT, &amp;temp_buffer[INT_DIGIT]);\n\n   printf(\"%s\\n\",buffer);\n\n\n   return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464175459, "post_id": 37435465, "comment_id": 62374141, "body": "Lol. I did it but too slow ;). +1"}], "tags": [], "owner": {"reputation": 1068, "user_id": 57140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da10f3d496288a3eb7cf6ac03c225ed?s=128&d=identicon&r=PG", "display_name": "kwarnke", "link": "https://stackoverflow.com/users/57140/kwarnke"}, "is_accepted": true, "score": 3, "last_activity_date": 1464176287, "last_edit_date": 1464176287, "creation_date": 1464174933, "answer_id": 37435465, "question_id": 37434965, "link": "https://stackoverflow.com/questions/37434965/inserting-comma-in-a-large-int-number/37435465#37435465", "title": "inserting comma in a large int number", "body": "<p>You can do that in two steps. First convert the lNum into a string, then cut the needed parts out of this string. Something like that. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    char tmp[256], out[256];\n    unsigned int lNum= 870120000;\n\n    sprintf(tmp, \"%u\", lNum);\n    sprintf(out, \"%3.3s,%3.3s\", tmp, tmp+3);\n    printf(\"%s\\n\", out); // prints 870,120 \n    return 0;\n}\n</code></pre>\n\n<p>See <a href=\"http://ideone.com/bnQNou\" rel=\"nofollow\">http://ideone.com/bnQNou</a>\nOr you can convert it into a float and change the locale to have \",\" as delimiter:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;locale.h&gt;\n\nint main()\n{\n    unsigned int lNum = 870120000;\n\n    setlocale(LC_NUMERIC, \"de_DE\");\n    printf(\"%3.3f\\n\", (float)(870120000 / 1000000)); // prints 870,120 \n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4125774, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e5dd6599c3fffbbef169307e2c7e8b0b?s=128&d=identicon&r=PG&f=1", "display_name": "KapaA", "link": "https://stackoverflow.com/users/4125774/kapaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 37435465, "answer_count": 2, "score": 1, "last_activity_date": 1464185746, "creation_date": 1464173606, "question_id": 37434965, "link": "https://stackoverflow.com/questions/37434965/inserting-comma-in-a-large-int-number", "title": "inserting comma in a large int number", "body": "<p>i am trying to insert a comma in a large integer number eg, 870120000 and present it as: 870,120 and the last three digits are discarded. The format will allways be the same, ie., xxxxxxxxx number where i am only interested in the first 6 digits. </p>\n\n<p>What i have been doing so fare is using snprintf:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n   char buffer[5];\n   unsigned int lNum= 870120000;\n   int cx;\n   memset(buffer,0,sizeof(buffer));\n\n   cx = snprintf(buffer, 4, \"%d,\", lNum);\n   buffer[3] = ',';\n   printf(\"%s\\n\",buffer);\n\n   cx = snprintf(buffer+4, 4, \"321\"); // Note 1 ???\n\n   printf(\"%s\\n\", buffer);\n\n   return 0;\n}\n</code></pre>\n\n<p>My problem is that i am stuck at (comment // Note 1), how do I add the last next three digits in to buffer ?</p>\n\n<p>in addition I would like to know if this approch is ideal or is there any better(easier) way to do this?</p>\n"}, {"tags": ["c++", "c", "cmake", "target"], "comments": [{"owner": {"reputation": 21282, "user_id": 140367, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/686b6807a5e05236c44c9472e99e146a?s=128&d=identicon&r=PG", "display_name": "Tam&#225;s Szelei", "link": "https://stackoverflow.com/users/140367/tam%c3%a1s-szelei"}, "edited": false, "score": 0, "creation_date": 1464175142, "post_id": 37434946, "comment_id": 62373927, "body": "Do you mean iterating the targets in your cmake script programmatically?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1464175985, "post_id": 37434946, "comment_id": 62374463, "body": "To what purpose? (Smelling a X-Y problem.) Whatever you want to do is probably best done in CMakeLists.txt itself."}, {"owner": {"reputation": 13848, "user_id": 276193, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3d9b60ead1b0c8420c03b203832e8d5f?s=128&d=identicon&r=PG", "display_name": "learnvst", "link": "https://stackoverflow.com/users/276193/learnvst"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 2, "creation_date": 1464176333, "post_id": 37434946, "comment_id": 62374708, "body": "@DevSolar see edits."}, {"owner": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1464180161, "post_id": 37434946, "comment_id": 62377620, "body": "Can you please also give the code for <code>sanitize_xcode()</code>? Do you add <code>POST_BUILD</code> steps or do you just add compiler options? If the later, there won&#39;t be the need to iterate over all targets."}, {"owner": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1464184885, "post_id": 37434946, "comment_id": 62381406, "body": "Thanks. Just looking at <a href=\"https://cmake.org/cmake/help/latest/prop_tgt/XCODE_ATTRIBUTE_an-attribute.html\" rel=\"nofollow noreferrer\"><code>XCODE_ATTRIBUTE_&lt;an-attribute&gt;</code></a> target property wouldn&#39;t it be enough to set the equivalent <a href=\"https://cmake.org/cmake/help/latest/variable/CMAKE_XCODE_ATTRIBUTE_an-attribute.html#variable:CMAKE_XCODE_ATTRIBUTE_&lt;an-attribute&gt;\" rel=\"nofollow noreferrer\"><code>CMAKE_XCODE_ATTRIBUTE_&lt;an-attribute&gt;</code></a> variables at root level to be applied to all targets?"}], "answers": [{"comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1464176987, "post_id": 37436036, "comment_id": 62375197, "body": "I found it generally a good trick to have a series of <code>set()</code> commands at the beginning, setting everything up, and doing all the &quot;magic&quot; at the end. Actually, <a href=\"http://jaws.rootdirectory.de\" rel=\"nofollow noreferrer\">in my re-useable CMake framework</a>, I <i>only</i> do <code>set()</code>s in my <code>CMakeLists.txt</code>, and then <code>include()</code> a file with all the &quot;magic&quot;. If I add / change source files, I only &quot;touch&quot; the <code>CMakeLists.txt</code>, if I modify the &quot;magic&quot; I &quot;touch&quot; a different file. Easier to maintain, IMHO."}, {"owner": {"reputation": 13193, "user_id": 213871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c228b6e11e7b817fd504a144ffbd773?s=128&d=identicon&r=PG", "display_name": "ceztko", "link": "https://stackoverflow.com/users/213871/ceztko"}, "edited": false, "score": 0, "creation_date": 1597836377, "post_id": 37436036, "comment_id": 112261902, "body": "This is not an answer since the list of targets may just be unknown/unpredictable."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 13193, "user_id": 213871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c228b6e11e7b817fd504a144ffbd773?s=128&d=identicon&r=PG", "display_name": "ceztko", "link": "https://stackoverflow.com/users/213871/ceztko"}, "edited": false, "score": 0, "creation_date": 1597838603, "post_id": 37436036, "comment_id": 112262956, "body": "@ceztko: 1) If your list of targets is unpredictable, you have other problems. 2) The answer <i>shows a way</i> to have a list of targets set up to iterate over. 3) <code>BUILDSYSTEM_TARGETS</code> was introduced half a year <b>after</b> Florian and I wrote our (initial) answers, so you can hardly blame us for not making use of it when we wrote our answers. At the time, these <b>were</b> the answers to the question. The later appearance of better mechanics might make this answer a bit obsolete, but &quot;not an answer&quot; is uncalled for."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 13193, "user_id": 213871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c228b6e11e7b817fd504a144ffbd773?s=128&d=identicon&r=PG", "display_name": "ceztko", "link": "https://stackoverflow.com/users/213871/ceztko"}, "edited": false, "score": 0, "creation_date": 1597863268, "post_id": 37436036, "comment_id": 112275018, "body": "@ceztko: Oh, I think I get it now. You&#39;re having CMakeLists.txt in <i>subdirectories</i> as well, and that&#39;s why you consider the list of targets to be &quot;unknown / unpredictable&quot;? Well, I don&#39;t do that, coming from the &quot;recursive make considered harmful&quot; school of thought, having only one top-level CMakeLists.txt. So we&#39;re working from different assumptions here."}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": false, "score": 1, "last_activity_date": 1464176400, "creation_date": 1464176400, "answer_id": 37436036, "question_id": 37434946, "link": "https://stackoverflow.com/questions/37434946/how-do-i-iterate-over-all-cmake-targets-programmatically/37436036#37436036", "title": "How do I iterate over all CMake targets programmatically?", "body": "<p>If you want to go over a list of targets, set your CMakeLists.txt up to <em>provide</em> that list in the first place.</p>\n\n<pre><code>if ( CMAKE_GENERATOR MATCHES \"Xcode\" )\n    include(sanitize_xcode)\nendif()\n\n# A list of executables to build\nset( project_EXECUTABLES\n     foo\n     bar\n   )\n\n# List of sources for each executable, following some naming scheme\n\n# foo\nset( EXE_foo_SOURCES\n     foo/main.c\n   )\n\n# bar\nset( EXE_bar_SOURCES\n     bar/main.c\n   )\n\n# For each executable in the list...\nforeach( exe ${project_EXECUTABLES} )\n    # declare the target...\n    add_executable( ${exe} ${EXE_${exe}_SOURCES} )\n\n    # ...and do whatever additional configuration you need\n    if ( CMAKE_GENERATOR MATCHES \"Xcode\" )\n        sanitize_xcode( ${exe} )\n    endif()\nendforeach()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13193, "user_id": 213871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c228b6e11e7b817fd504a144ffbd773?s=128&d=identicon&r=PG", "display_name": "ceztko", "link": "https://stackoverflow.com/users/213871/ceztko"}, "edited": false, "score": 0, "creation_date": 1591810141, "post_id": 37446362, "comment_id": 110200687, "body": "No, global <code>BUILDSYSTEM_TARGETS</code> has not been added, it&#39;s a directory property. There&#39;s an <a href=\"https://gitlab.kitware.com/cmake/cmake/-/issues/20124#\" rel=\"nofollow noreferrer\">rfe</a> for that"}, {"owner": {"reputation": 13193, "user_id": 213871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c228b6e11e7b817fd504a144ffbd773?s=128&d=identicon&r=PG", "display_name": "ceztko", "link": "https://stackoverflow.com/users/213871/ceztko"}, "edited": false, "score": 0, "creation_date": 1591816631, "post_id": 37446362, "comment_id": 110203997, "body": "Using <code>BUILDSYSTEM_TARGETS</code> and <code>SUBDIRECTORIES</code> it&#39;s possible to recursively retrieve targets defined at the current directory scope. See my <a href=\"https://stackoverflow.com/a/62311397/213871\">answer</a>."}], "tags": [], "owner": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "is_accepted": true, "score": 7, "last_activity_date": 1476796810, "last_edit_date": 1476796810, "creation_date": 1464205693, "answer_id": 37446362, "question_id": 37434946, "link": "https://stackoverflow.com/questions/37434946/how-do-i-iterate-over-all-cmake-targets-programmatically/37446362#37446362", "title": "How do I iterate over all CMake targets programmatically?", "body": "<p><em>Turning my comment into an answer</em></p>\n\n<p>To have a list of all targets is a wish that has been out there for a while, but the global property <code>TARGETS</code> is not yet implemented (as for May-2016, <a href=\"https://cmake.org/pipermail/cmake-developers/2016-March/027985.html\" rel=\"nofollow noreferrer\">see \"Listing all targets\" discussion</a>). </p>\n\n<p><strong>Edit:</strong> It is now implemented: Global <a href=\"https://cmake.org/cmake/help/latest/prop_dir/BUILDSYSTEM_TARGETS.html#prop_dir:BUILDSYSTEM_TARGETS\" rel=\"nofollow noreferrer\"><code>BUILDSYSTEM_TARGETS</code></a> property was released with CMake 3.7</p>\n\n<p>So you can implement this yourself using CMake script itself - as @DevSolar as commented/answered or like <a href=\"https://stackoverflow.com/questions/36333310/making-all-projects-in-cmake-visual-studio-depend-on-one-project\">here</a> - but I've learned over the time working with CMake that you could also change a lot of target properties globally. E.g. most target properties are defaulted to an equivalent global variable setting. </p>\n\n<p>You can take advantage of this in your case and solve this by adding the following to your global <code>CMakeLists.txt</code> file:</p>\n\n<pre><code>set(CMAKE_XCODE_ATTRIBUTE_GCC_GENERATE_DEBUGGING_SYMBOLS[variant=Debug] \"YES\")\nset(CMAKE_XCODE_ATTRIBUTE_GCC_GENERATE_DEBUGGING_SYMBOLS[variant=MinSizeRel] \"NO\")\nset(CMAKE_XCODE_ATTRIBUTE_GCC_GENERATE_DEBUGGING_SYMBOLS[variant=RelWithDebInfo] \"YES\")\nset(CMAKE_XCODE_ATTRIBUTE_GCC_GENERATE_DEBUGGING_SYMBOLS[variant=Release] \"NO\")\n\nset(CMAKE_XCODE_ATTRIBUTE_COPY_PHASE_STRIP[variant=Debug] \"NO\")\nset(CMAKE_XCODE_ATTRIBUTE_COPY_PHASE_STRIP[variant=MinSizeRel] \"YES\")\nset(CMAKE_XCODE_ATTRIBUTE_COPY_PHASE_STRIP[variant=RelWithDebInfo] \"NO\")\nset(CMAKE_XCODE_ATTRIBUTE_COPY_PHASE_STRIP[variant=Release] \"YES\")\n\nset(CMAKE_XCODE_ATTRIBUTE_GCC_OPTIMIZATION_LEVEL[variant=Debug] \"0\")\nset(CMAKE_XCODE_ATTRIBUTE_GCC_OPTIMIZATION_LEVEL[variant=MinSizeRel] \"s\")\nset(CMAKE_XCODE_ATTRIBUTE_GCC_OPTIMIZATION_LEVEL[variant=RelWithDebInfo] \"3\")\nset(CMAKE_XCODE_ATTRIBUTE_GCC_OPTIMIZATION_LEVEL[variant=Release] \"3\")\n\nset(CMAKE_XCODE_ATTRIBUTE_IPHONEOS_DEPLOYMENT_TARGET[variant=Debug] \"7.0\")\nset(CMAKE_XCODE_ATTRIBUTE_IPHONEOS_DEPLOYMENT_TARGET[variant=MinSizeRel] \"7.0\")\nset(CMAKE_XCODE_ATTRIBUTE_IPHONEOS_DEPLOYMENT_TARGET[variant=RelWithDebInfo] \"7.0\")\nset(CMAKE_XCODE_ATTRIBUTE_IPHONEOS_DEPLOYMENT_TARGET[variant=Release] \"7.0\")\n</code></pre>\n\n<p><strong>References</strong></p>\n\n<ul>\n<li><a href=\"https://cmake.org/cmake/help/latest/prop_tgt/XCODE_ATTRIBUTE_an-attribute.html\" rel=\"nofollow noreferrer\"><code>XCODE_ATTRIBUTE_&lt;an-attribute&gt;</code></a></li>\n<li><a href=\"https://cmake.org/cmake/help/latest/variable/CMAKE_XCODE_ATTRIBUTE_an-attribute.html\" rel=\"nofollow noreferrer\"><code>CMAKE_XCODE_ATTRIBUTE_&lt;an-attribute&gt;</code></a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 1266, "user_id": 13433323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wrcS9.png?s=128&g=1", "display_name": "Sprite", "link": "https://stackoverflow.com/users/13433323/sprite"}, "edited": false, "score": 2, "creation_date": 1616961122, "post_id": 62311397, "comment_id": 118160175, "body": "Oh god, I love you, this solved a problem that stuck me all day. +1"}, {"owner": {"reputation": 310, "user_id": 1218833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d6565257001f2b5c445874b05ce34f?s=128&d=identicon&r=PG", "display_name": "Andrew W", "link": "https://stackoverflow.com/users/1218833/andrew-w"}, "edited": false, "score": 0, "creation_date": 1619070931, "post_id": 62311397, "comment_id": 118794541, "body": "This is so great, I had been wanting a way to do this for ages, but had basically given up"}], "tags": [], "owner": {"reputation": 13193, "user_id": 213871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c228b6e11e7b817fd504a144ffbd773?s=128&d=identicon&r=PG", "display_name": "ceztko", "link": "https://stackoverflow.com/users/213871/ceztko"}, "is_accepted": false, "score": 10, "last_activity_date": 1619074365, "last_edit_date": 1619074365, "creation_date": 1591816472, "answer_id": 62311397, "question_id": 37434946, "link": "https://stackoverflow.com/questions/37434946/how-do-i-iterate-over-all-cmake-targets-programmatically/62311397#62311397", "title": "How do I iterate over all CMake targets programmatically?", "body": "<p>In correction to Florian's <a href=\"https://stackoverflow.com/a/37446362/213871\">answer</a>, <a href=\"https://cmake.org/cmake/help/latest/prop_dir/BUILDSYSTEM_TARGETS.html\" rel=\"nofollow noreferrer\">BUILDSYSTEM_TARGETS</a> is a not really a global property but a <a href=\"https://cmake.org/cmake/help/latest/manual/cmake-properties.7.html#properties-on-directories\" rel=\"nofollow noreferrer\">directory</a> scoped one. A request for enhancement is currently <a href=\"https://gitlab.kitware.com/cmake/cmake/-/issues/20124#\" rel=\"nofollow noreferrer\">open</a> to request a truly global property. Using <a href=\"https://cmake.org/cmake/help/latest/prop_dir/SUBDIRECTORIES.html\" rel=\"nofollow noreferrer\">SUBDIRECTORIES</a> property it's possible retrieve recursively all targets in the scope of the current directory with the following function:</p>\n<pre><code>function(get_all_targets var)\n    set(targets)\n    get_all_targets_recursive(targets ${CMAKE_CURRENT_SOURCE_DIR})\n    set(${var} ${targets} PARENT_SCOPE)\nendfunction()\n\nmacro(get_all_targets_recursive targets dir)\n    get_property(subdirectories DIRECTORY ${dir} PROPERTY SUBDIRECTORIES)\n    foreach(subdir ${subdirectories})\n        get_all_targets_recursive(${targets} ${subdir})\n    endforeach()\n\n    get_property(current_targets DIRECTORY ${dir} PROPERTY BUILDSYSTEM_TARGETS)\n    list(APPEND ${targets} ${current_targets})\nendmacro()\n\nget_all_targets(all_targets)\nmessage(&quot;All targets: ${all_targets}&quot;)\n</code></pre>\n"}], "owner": {"reputation": 13848, "user_id": 276193, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3d9b60ead1b0c8420c03b203832e8d5f?s=128&d=identicon&r=PG", "display_name": "learnvst", "link": "https://stackoverflow.com/users/276193/learnvst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9771, "favorite_count": 4, "accepted_answer_id": 37446362, "answer_count": 3, "score": 18, "last_activity_date": 1619074365, "creation_date": 1464173552, "last_edit_date": 1490879569, "question_id": 37434946, "link": "https://stackoverflow.com/questions/37434946/how-do-i-iterate-over-all-cmake-targets-programmatically", "title": "How do I iterate over all CMake targets programmatically?", "body": "<p>Is there a way to get all targets of a CMake project from within the top level <code>CMakeLists.txt</code>, i.e. iterate over the targets programmatically?</p>\n\n<p>The reason I want to do this is to apply some XCode specific settings to every target . . </p>\n\n<pre><code>if (CMAKE_GENERATOR MATCHES \"Xcode\")\n    include(sanitize_xcode)\n    sanitize_xcode(myTarget)\nendif()\n</code></pre>\n\n<p>FYI - the sanitization module looks like this . . </p>\n\n<pre><code>macro (set_xcode_property TARGET XCODE_PROPERTY XCODE_VALUE)\n    set_property (TARGET ${TARGET} PROPERTY XCODE_ATTRIBUTE_${XCODE_PROPERTY} ${XCODE_VALUE})\nendmacro (set_xcode_property)\n\nmacro (sanitize_xcode TARGET)\n    set_xcode_property(${TARGET} GCC_GENERATE_DEBUGGING_SYMBOLS[variant=Debug] \"YES\")\n    set_xcode_property(${TARGET} GCC_GENERATE_DEBUGGING_SYMBOLS[variant=MinSizeRel] \"NO\")\n    set_xcode_property(${TARGET} GCC_GENERATE_DEBUGGING_SYMBOLS[variant=RelWithDebInfo] \"YES\")\n    set_xcode_property(${TARGET} GCC_GENERATE_DEBUGGING_SYMBOLS[variant=Release] \"NO\")\n\n    set_xcode_property(${TARGET} COPY_PHASE_STRIP[variant=Debug] \"NO\")\n    set_xcode_property(${TARGET} COPY_PHASE_STRIP[variant=MinSizeRel] \"YES\")\n    set_xcode_property(${TARGET} COPY_PHASE_STRIP[variant=RelWithDebInfo] \"NO\")\n    set_xcode_property(${TARGET} COPY_PHASE_STRIP[variant=Release] \"YES\")\n\n    set_xcode_property(${TARGET} GCC_OPTIMIZATION_LEVEL[variant=Debug] \"0\")\n    set_xcode_property(${TARGET} GCC_OPTIMIZATION_LEVEL[variant=MinSizeRel] \"s\")\n    set_xcode_property(${TARGET} GCC_OPTIMIZATION_LEVEL[variant=RelWithDebInfo] \"3\")\n    set_xcode_property(${TARGET} GCC_OPTIMIZATION_LEVEL[variant=Release] \"3\")\n\n    set_xcode_property(${TARGET} IPHONEOS_DEPLOYMENT_TARGET[variant=Debug] \"7.0\")\n    set_xcode_property(${TARGET} IPHONEOS_DEPLOYMENT_TARGET[variant=MinSizeRel] \"7.0\")\n    set_xcode_property(${TARGET} IPHONEOS_DEPLOYMENT_TARGET[variant=RelWithDebInfo] \"7.0\")\n    set_xcode_property(${TARGET} IPHONEOS_DEPLOYMENT_TARGET[variant=Release] \"7.0\")\nendmacro (sanitize_xcode)\n</code></pre>\n"}, {"tags": ["c", "amazon-web-services", "curl", "amazon-dynamodb", "libcurl"], "comments": [{"owner": {"reputation": 4760, "user_id": 819019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiYfP.jpg?s=128&g=1", "display_name": "Taterhead", "link": "https://stackoverflow.com/users/819019/taterhead"}, "edited": false, "score": 0, "creation_date": 1472568905, "post_id": 37434929, "comment_id": 65798599, "body": "Are you still looking for an answer to this?"}, {"owner": {"reputation": 4315, "user_id": 4182755, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ggHFY.jpg?s=128&g=1", "display_name": "Abdul Manaf", "link": "https://stackoverflow.com/users/4182755/abdul-manaf"}, "reply_to_user": {"reputation": 4760, "user_id": 819019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiYfP.jpg?s=128&g=1", "display_name": "Taterhead", "link": "https://stackoverflow.com/users/819019/taterhead"}, "edited": false, "score": 0, "creation_date": 1472569142, "post_id": 37434929, "comment_id": 65798766, "body": "its difficult for me. because i moved with api gateway. if you give a solution for this, i can improve my dynamo query speed. it also offer better performance to my program."}], "answers": [{"tags": [], "owner": {"reputation": 4376, "user_id": 1022807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb555b012e3b78f4e5efc213bdb8edd6?s=128&d=identicon&r=PG", "display_name": "Alexander Patrikalakis", "link": "https://stackoverflow.com/users/1022807/alexander-patrikalakis"}, "is_accepted": true, "score": 0, "last_activity_date": 1486268978, "creation_date": 1486268978, "answer_id": 42048557, "question_id": 37434929, "link": "https://stackoverflow.com/questions/37434929/error-while-calling-dynamodb-low-level-apis-from-c-code/42048557#42048557", "title": "Error while calling DynamoDB low-level API&#39;s from C code", "body": "<p>Are you able to use the <a href=\"https://github.com/aws/aws-sdk-cpp\" rel=\"nofollow noreferrer\">AWS SDK for C++</a>? It will do all this heavy lifting and more for you. Actually, even if you are making a C program, you can expose an <a href=\"http://www.tldp.org/HOWTO/C++-dlopen/thesolution.html\" rel=\"nofollow noreferrer\">extern C library</a> structure to the AWS SDK calls that you need. So, either way, I recommend coding against the AWS SDK for C++, and create an extern C library wrapper in case you need to compile your main program as a C program.</p>\n"}], "owner": {"reputation": 4315, "user_id": 4182755, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ggHFY.jpg?s=128&g=1", "display_name": "Abdul Manaf", "link": "https://stackoverflow.com/users/4182755/abdul-manaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 42048557, "answer_count": 1, "score": 4, "last_activity_date": 1486268978, "creation_date": 1464173519, "last_edit_date": 1464174158, "question_id": 37434929, "link": "https://stackoverflow.com/questions/37434929/error-while-calling-dynamodb-low-level-apis-from-c-code", "title": "Error while calling DynamoDB low-level API&#39;s from C code", "body": "<p>i tried to calling DynamoDB low-level API's from C code. This is my code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;curl/curl.h&gt;\n\n\nint main(void)\n{\n  CURL *curl;\n  CURLcode res;\n\n  curl = curl_easy_init();\n  if(curl) {\n    struct curl_slist *chunk = NULL;\n\n    chunk = curl_slist_append(chunk, \"Host: dynamodb.us-east-1.amazonaws.com;\");    \n    chunk = curl_slist_append(chunk, \"Accept-Encoding: identity;\");\n    chunk = curl_slist_append(chunk, \"Content-Length: 53;\");    \n    chunk = curl_slist_append(chunk, \"User-Agent: CustomApp42;\");\n    chunk = curl_slist_append(chunk, \"Content-Type: application/x-amz-json-1.0;\");\n    chunk = curl_slist_append(chunk, \"Authorization: AWS4-HMAC-SHA256 Credential=&lt;Credential&gt;, SignedHeaders=&lt;Headers&gt;, Signature=&lt;signature&gt;;\");   \n    chunk = curl_slist_append(chunk, \"X-Amz-Date: 4.4.2016 ;\");\n    chunk = curl_slist_append(chunk, \"X-Amz-Target: DynamoDB_20120810.GetItem;\");\n\n    res = curl_easy_setopt(curl, CURLOPT_HTTPHEADER, chunk);\n\n    curl_easy_setopt(curl, CURLOPT_URL, \"dynamodb.us-east-1.amazonaws.com\");\n    curl_easy_setopt(curl, CURLOPT_VERBOSE, 1L);\n    curl_easy_setopt(curl, CURLOPT_POSTFIELDS, \"{\\\"TableName\\\":\\\"Pets\\\",\\\"Key\\\":{\\\"AnimalType\\\":{\\\"S\\\": \\\"Dog\\\"},\\\"Name\\\": {\\\"S\\\": \\\"Fido\\\"}}}\");\n    res = curl_easy_perform(curl);\n    /* Check for errors */ \n    if(res != CURLE_OK)\n      fprintf(stderr, \"curl_easy_perform() failed: %s\\n\",\n              curl_easy_strerror(res));\n\n    /* always cleanup */ \n    curl_easy_cleanup(curl);\n\n    /* free the custom headers */ \n    curl_slist_free_all(chunk);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>But it produce error while running like </p>\n\n<pre><code>HTTP/1.1 400 Bad Request\n</code></pre>\n\n<p>I faced mainly two issues.</p>\n\n<ol>\n<li>i have aws_access_key_id and aws_secret_access_key. How to create Authorization (SignedHeaders &amp; Signature) using these two credentials?</li>\n<li>How to modify \"X-Amz-Target\" for dynamo query method?</li>\n</ol>\n"}, {"tags": ["c", "hash", "codeblocks", "undefined-reference"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1464173076, "post_id": 37434608, "comment_id": 62372605, "body": "&quot;<i>undefined reference</i>&quot; is linker error."}, {"owner": {"reputation": 14380, "user_id": 2102532, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fe51636ca4d4799fe8600414a3bc891b?s=128&d=identicon&r=PG", "display_name": "meskobalazs", "link": "https://stackoverflow.com/users/2102532/meskobalazs"}, "edited": false, "score": 0, "creation_date": 1464173117, "post_id": 37434608, "comment_id": 62372636, "body": "Where did you get the library from? It seems like it is misconfigured, and the linker can&#39;t link it."}, {"owner": {"reputation": 63, "user_id": 6117403, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a8eae857ee3104b2d82799b711721a13?s=128&d=identicon&r=PG&f=1", "display_name": "Boku", "link": "https://stackoverflow.com/users/6117403/boku"}, "reply_to_user": {"reputation": 14380, "user_id": 2102532, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fe51636ca4d4799fe8600414a3bc891b?s=128&d=identicon&r=PG", "display_name": "meskobalazs", "link": "https://stackoverflow.com/users/2102532/meskobalazs"}, "edited": false, "score": 0, "creation_date": 1464173479, "post_id": 37434608, "comment_id": 62372857, "body": "@meskobalazs The search.h was obtained from the man page <a href=\"http://linux.die.net/man/3/hcreate\" rel=\"nofollow noreferrer\">Here</a>"}, {"owner": {"reputation": 1068, "user_id": 57140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da10f3d496288a3eb7cf6ac03c225ed?s=128&d=identicon&r=PG", "display_name": "kwarnke", "link": "https://stackoverflow.com/users/57140/kwarnke"}, "edited": false, "score": 1, "creation_date": 1464174031, "post_id": 37434608, "comment_id": 62373225, "body": "Are you running linux or windows? The function is in the standard libc. On linux it should run &quot;out of the box&quot;. See <a href=\"https://ideone.com/mr06W3\" rel=\"nofollow noreferrer\">ideone.com/mr06W3</a> I just pasted the example from the man page into."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464174535, "post_id": 37434608, "comment_id": 62373547, "body": "<code>search.h</code> is not a library, but a so called &quot;header file&quot;, which in fact is a C source file. It only provides the &quot;interface&quot; of what a specific object or library implements, so that the compiler knows about it. When the compiler is done in a final step all objects/libraries needed are linked together with what the compiler produced, to create the final program."}, {"owner": {"reputation": 63, "user_id": 6117403, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a8eae857ee3104b2d82799b711721a13?s=128&d=identicon&r=PG&f=1", "display_name": "Boku", "link": "https://stackoverflow.com/users/6117403/boku"}, "reply_to_user": {"reputation": 1068, "user_id": 57140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da10f3d496288a3eb7cf6ac03c225ed?s=128&d=identicon&r=PG", "display_name": "kwarnke", "link": "https://stackoverflow.com/users/57140/kwarnke"}, "edited": false, "score": 0, "creation_date": 1464176542, "post_id": 37434608, "comment_id": 62374852, "body": "@kwarnke I&#39;m running on windows, hence using codeblock IDE to do my coding. I think is the problem, but is there a way around it?"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6117403, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a8eae857ee3104b2d82799b711721a13?s=128&d=identicon&r=PG&f=1", "display_name": "Boku", "link": "https://stackoverflow.com/users/6117403/boku"}, "edited": false, "score": 0, "creation_date": 1464176582, "post_id": 37435372, "comment_id": 62374876, "body": "Ahhh yes, this is what I&#39;m looking for. I&#39;ll search on the web a bit, and see if I can find it and get it working. Thank you so much!"}], "tags": [], "owner": {"reputation": 14380, "user_id": 2102532, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fe51636ca4d4799fe8600414a3bc891b?s=128&d=identicon&r=PG", "display_name": "meskobalazs", "link": "https://stackoverflow.com/users/2102532/meskobalazs"}, "is_accepted": false, "score": 1, "last_activity_date": 1464174641, "creation_date": 1464174641, "answer_id": 37435372, "question_id": 37434608, "link": "https://stackoverflow.com/questions/37434608/undefined-reference-to-hash-function/37435372#37435372", "title": "Undefined reference to hash function", "body": "<p>Header files are just containing the <em>declarations</em>. You need to have the libraries installed, which are containing the <em>implementation</em>.</p>\n\n<p>And that what it is telling you. It found the declarations just fine, however the linker did not find the libraries, hence the linkage error.</p>\n\n<p>On Linux, the <code>search.h</code> and its implementation is part of the <code>libc</code>, so it is already ready to use. On Windows, however, you need to get a binary version of it, set up the library path for Code::Blocks, and use the linker options in the settings.</p>\n"}], "owner": {"reputation": 63, "user_id": 6117403, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a8eae857ee3104b2d82799b711721a13?s=128&d=identicon&r=PG&f=1", "display_name": "Boku", "link": "https://stackoverflow.com/users/6117403/boku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 661, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1464174750, "creation_date": 1464172642, "last_edit_date": 1464174750, "question_id": 37434608, "link": "https://stackoverflow.com/questions/37434608/undefined-reference-to-hash-function", "title": "Undefined reference to hash function", "body": "<p>I'm trying to run a program in Code::Blocks, and in my program I have used the hash functions, such as <code>hsearch</code> and <code>hcreate</code>, but Code::Blocks seems to not allow them.</p>\n\n<p>I have the header: </p>\n\n<pre><code>#include &lt;search.h&gt;    \n</code></pre>\n\n<p>included already, but errors such as <code>\"undefined reference to 'hsearch' \"</code>  still comes up.</p>\n\n<p>Is there anyway to allow these functions to run in Code::Blocks at all?</p>\n"}, {"tags": ["c", "function", "return", "void-pointers"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 5, "creation_date": 1464170010, "post_id": 37433525, "comment_id": 62370439, "body": "You cannot return a stack allocated pointer (local scoped) from a function...."}, {"owner": {"reputation": 5818, "user_id": 389222, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6e599629d5f058545c7ae84e7bdd3441?s=128&d=identicon&r=PG", "display_name": "Gilad Naaman", "link": "https://stackoverflow.com/users/389222/gilad-naaman"}, "edited": false, "score": 1, "creation_date": 1464170018, "post_id": 37433525, "comment_id": 62370449, "body": "No,  you can&#39;t return multiple types."}, {"owner": {"reputation": 903, "user_id": 6057480, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9389d363a4bf11c8b70596391e16d1eb?s=128&d=identicon&r=PG&f=1", "display_name": "Bohao LI", "link": "https://stackoverflow.com/users/6057480/bohao-li"}, "reply_to_user": {"reputation": 5818, "user_id": 389222, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6e599629d5f058545c7ae84e7bdd3441?s=128&d=identicon&r=PG", "display_name": "Gilad Naaman", "link": "https://stackoverflow.com/users/389222/gilad-naaman"}, "edited": false, "score": 0, "creation_date": 1464170104, "post_id": 37433525, "comment_id": 62370518, "body": "@GiladNaaman So it is not possible to make a general function ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1464170120, "post_id": 37433525, "comment_id": 62370528, "body": "IMO you should rethink your design."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1464170479, "post_id": 37433525, "comment_id": 62370785, "body": "Return a dynamically-allocated variant type.  That&#39;s it, really."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1464170504, "post_id": 37433525, "comment_id": 62370798, "body": "Automatic variables do not persist after a function returns.  They&#39;re allocated on the stack.  This is very, very basic C."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1464170606, "post_id": 37433525, "comment_id": 62370864, "body": "@MartinJames, returning by value or by an output parameter may be better if the different members of the variant are small enough..."}], "answers": [{"comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1464170706, "post_id": 37433599, "comment_id": 62370923, "body": "Since you only want one type at a time, I&#39;d recommend a tagged union instead of just a struct."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 903, "user_id": 6057480, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9389d363a4bf11c8b70596391e16d1eb?s=128&d=identicon&r=PG&f=1", "display_name": "Bohao LI", "link": "https://stackoverflow.com/users/6057480/bohao-li"}, "edited": false, "score": 0, "creation_date": 1464171872, "post_id": 37433599, "comment_id": 62371704, "body": "@BohaoLI See PMG sir&#39;s answer, it should suffice for you. :)"}, {"owner": {"reputation": 903, "user_id": 6057480, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9389d363a4bf11c8b70596391e16d1eb?s=128&d=identicon&r=PG&f=1", "display_name": "Bohao LI", "link": "https://stackoverflow.com/users/6057480/bohao-li"}, "edited": false, "score": 0, "creation_date": 1464172024, "post_id": 37433599, "comment_id": 62371820, "body": "@SouravGhosh He apparently did what you said :) I already noticed it."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 9, "last_activity_date": 1464171773, "last_edit_date": 1495535317, "creation_date": 1464170015, "answer_id": 37433599, "question_id": 37433525, "link": "https://stackoverflow.com/questions/37433525/how-to-return-different-types-from-a-single-function/37433599#37433599", "title": "How to return different types from a single function", "body": "<p>The problem as I see it, you're trying to <code>return</code> the address of a local variable from a function (scope) and trying to access the returned memory from the caller. In the caller, the memory is <em>invalid</em> and any usage will lead to  <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>Solution: You need to use dynamic memory allocation for the pointer (<code>malloc()</code>/ <code>calloc()</code>) which you want to <code>return</code> from the function. This will overcome the issue here, as the lifetime of the dynamically allocated memory is untill <code>free()</code>-d manually or till program termination, whichever is earlier.</p>\n\n<p>Having said that, this approach is not a good one. If all you want to return one of multiple types, go for a <code>struct</code> containing members for all types and use a flag to mark the type. Fill the corresponding member variable, set the flag and <code>return</code> the structure variable.</p>\n\n<p>For better, you can actually use an <code>union</code> as a member of the structure, as you only need <em>one type at a time</em>. For a working code, please refer to <a href=\"https://stackoverflow.com/a/37434038/2173917\">the other answer</a> by <strong>@pmg</strong>.</p>\n"}, {"comments": [{"owner": {"reputation": 903, "user_id": 6057480, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9389d363a4bf11c8b70596391e16d1eb?s=128&d=identicon&r=PG&f=1", "display_name": "Bohao LI", "link": "https://stackoverflow.com/users/6057480/bohao-li"}, "edited": false, "score": 0, "creation_date": 1464171063, "post_id": 37433604, "comment_id": 62371184, "body": "I want to have as less static variables as possible cause static variable will bring thread-safe problems later."}, {"owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "reply_to_user": {"reputation": 903, "user_id": 6057480, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9389d363a4bf11c8b70596391e16d1eb?s=128&d=identicon&r=PG&f=1", "display_name": "Bohao LI", "link": "https://stackoverflow.com/users/6057480/bohao-li"}, "edited": false, "score": 0, "creation_date": 1464174537, "post_id": 37433604, "comment_id": 62373550, "body": "If you do not wish to use static variables, then dynamic memory allocation is the method to use. However, ideally I would rethink a design that requires a function to return two different types. Take your code as an example, it prints both of the outputs regardless of type; meaning the function could return just <code>chars</code> one being the <i>character</i> <code>&#39;5&#39;</code> and the other <code>&#39;b&#39;</code>."}], "tags": [], "owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "is_accepted": false, "score": 0, "last_activity_date": 1464175023, "last_edit_date": 1464175023, "creation_date": 1464170024, "answer_id": 37433604, "question_id": 37433525, "link": "https://stackoverflow.com/questions/37433525/how-to-return-different-types-from-a-single-function/37433604#37433604", "title": "How to return different types from a single function", "body": "<p>This is because the values that you return the pointers to are of <em>local scope</em>. This means that when the function returns the <code>a_char</code> and <code>a_int</code> variables effectively no longer exist, thus references to them (the pointers) are invalid.</p>\n\n<p>The reason that you see the random output is because the memory that <em>was</em> used by those variables is now being used by something else.</p>\n\n<p>You could either declare these variables at a wider scope (i.e. file scope or program scope) or use dynamic memory allocation.</p>\n\n<p>This example uses file scope variables:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic int a_int = 5;\nstatic char a_char = 'b'\n\nvoid *func(int a) { \n    if (a==3) {\n        return (void *)&amp;a_int;\n    } \n    else if (a==4) {\n        return (void *)&amp;a_char;\n    }\n    else {\n        fprintf(stderr, \"return value is NULL\");\n        return NULL;\n    }\n}\n\nint main (int argc, char *argv[]) {\n    int *ptr_int = (int *)func(3);\n    char *ptr_char = (char *)func(4);\n    fprintf(stdout, \"int value = %d\\n\", *ptr_int);\n    fprintf(stdout, \"char value = %c\\n\", *ptr_char);\n    return 0; \n}\n</code></pre>\n\n<p>In this specific case you could also just return strings (which would be thread-safe):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar * func(int a) {\n    if (a == 3) {\n        return \"5\";\n    } else if (a == 4) {\n        return \"b\";\n    } else {\n        return \"Return value is nothing\";\n    }\n}\n\nint main (int argc, char *argv[]) {\n    fprintf(stdout, func(3));\n    fprintf(stdout, func(4));\n    fprintf(stdout, func(15));\n    return 0; \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 1, "last_activity_date": 1464171367, "last_edit_date": 1464171367, "creation_date": 1464170066, "answer_id": 37433621, "question_id": 37433525, "link": "https://stackoverflow.com/questions/37433525/how-to-return-different-types-from-a-single-function/37433621#37433621", "title": "How to return different types from a single function", "body": "<p>Your problem is that you are returning the address of a local scoped variable. You have to use dynamic allocation to do what you want to do.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid *func(int a)\n{\n    void *retVal = NULL;\n\n    if (a==3)\n    {\n        retVal = malloc(sizeof(int));\n        if (retVal != NULL)\n        {\n            *((int *)(retVal)) = 5;\n        }\n    }\n    else if (a==4)\n    {\n        retVal = malloc(sizeof(int));\n        if (retVal != NULL)\n        {\n            *((char *)(retVal)) = 'b';\n        }\n    }\n    else\n    {\n        fprintf(stderr, \"return value is NULL\");\n    }\n\n    return retVal;\n}\n\nint main ()\n{\n    int *ptr_int = func(3);\n    char *ptr_char = func(4);\n\n    fprintf(stdout, \"int value = %d\\n\", *ptr_int);\n    fprintf(stdout, \"char value = %c\\n\", *ptr_char);\n\n    free(ptr_int);\n    free(ptr_char);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 903, "user_id": 6057480, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9389d363a4bf11c8b70596391e16d1eb?s=128&d=identicon&r=PG&f=1", "display_name": "Bohao LI", "link": "https://stackoverflow.com/users/6057480/bohao-li"}, "edited": false, "score": 0, "creation_date": 1464170331, "post_id": 37433678, "comment_id": 62370684, "body": "But, if I make a function void, I would not be able to return pointers I think, right ?"}, {"owner": {"reputation": 2203, "user_id": 6137423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O1Rfu.jpg?s=128&g=1", "display_name": "AhmadWabbi", "link": "https://stackoverflow.com/users/6137423/ahmadwabbi"}, "reply_to_user": {"reputation": 903, "user_id": 6057480, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9389d363a4bf11c8b70596391e16d1eb?s=128&d=identicon&r=PG&f=1", "display_name": "Bohao LI", "link": "https://stackoverflow.com/users/6057480/bohao-li"}, "edited": false, "score": 0, "creation_date": 1464170931, "post_id": 37433678, "comment_id": 62371091, "body": "You cannot return a pointer to a local variable in anyway. But if you allocate the pointer properly, you can return a pointer by reference. Just assign it to the parameter."}], "tags": [], "owner": {"reputation": 2203, "user_id": 6137423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O1Rfu.jpg?s=128&g=1", "display_name": "AhmadWabbi", "link": "https://stackoverflow.com/users/6137423/ahmadwabbi"}, "is_accepted": false, "score": -1, "last_activity_date": 1464170239, "creation_date": 1464170239, "answer_id": 37433678, "question_id": 37433525, "link": "https://stackoverflow.com/questions/37433525/how-to-return-different-types-from-a-single-function/37433678#37433678", "title": "How to return different types from a single function", "body": "<p>If you want a function that return two (or more) values, you have two possibilities: </p>\n\n<p>1- Make the function <code>void</code> and return the values as parameters by reference &amp;</p>\n\n<p>2- Declare a struct (or class) that groups the values and make the function return a value of this struct.</p>\n"}, {"comments": [{"owner": {"reputation": 903, "user_id": 6057480, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9389d363a4bf11c8b70596391e16d1eb?s=128&d=identicon&r=PG&f=1", "display_name": "Bohao LI", "link": "https://stackoverflow.com/users/6057480/bohao-li"}, "edited": false, "score": 1, "creation_date": 1464171825, "post_id": 37434038, "comment_id": 62371679, "body": "Thanks, it&#39;s useful."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464171899, "post_id": 37434038, "comment_id": 62371726, "body": "Why not simply avoid pointers inside union and allocate a union type pointer? <code>union members *my_var = malloc(sizeof(union members));</code>"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1464172278, "post_id": 37434038, "comment_id": 62372002, "body": "That&#39;s a possibility @LPs, but it doesn&#39;t avoid allocating space for a string."}], "tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 5, "last_activity_date": 1464171172, "creation_date": 1464171172, "answer_id": 37434038, "question_id": 37433525, "link": "https://stackoverflow.com/questions/37433525/how-to-return-different-types-from-a-single-function/37434038#37434038", "title": "How to return different types from a single function", "body": "<p>You can return (a struct containing) an union</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\nunion members {\n    int *intp;\n    char *charp;\n    double doublev;\n};\nstruct group {\n    int lastunionmember;\n    union members x;\n};\n\nstruct group f1(void) {\n    struct group r = {0};\n    int choice = rand() % 3;\n\n    if (choice == 0) {\n        r.x.intp = malloc(sizeof (int)); // remember to free(intp) at some time\n        *r.x.intp = 42;\n        r.lastunionmember = 1;\n    }\n    if (choice == 1) {\n        r.x.charp = malloc(42); // remember to free(charp) at some time\n        strcpy(r.x.charp, \"forty two\");\n        r.lastunionmember = 2;\n    }\n    if (choice == 2) {\n        r.x.doublev = 3.14159;\n        r.lastunionmember = 3;\n    }\n    return r;\n}\n\nint main(void) {\n    struct group x;\n    srand(time(0));\n    for (int k = 0; k &lt; 20; k++) {\n        x = f1();\n        switch (x.lastunionmember) {\n            default: printf(\"invalid value\\n\"); break;\n            case 1: printf(\"int value is %d\\n\", *x.x.intp); break;\n            case 2: printf(\"string is \\\"%s\\\"\\n\", x.x.charp); break;\n            case 3: printf(\"double value is %f\\n\", x.x.doublev); break;\n        }\n    }\n}\n</code></pre>\n\n<p>See the <a href=\"https://ideone.com/PnOq9f\" rel=\"noreferrer\">code running at ideone</a>.</p>\n"}], "owner": {"reputation": 903, "user_id": 6057480, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9389d363a4bf11c8b70596391e16d1eb?s=128&d=identicon&r=PG&f=1", "display_name": "Bohao LI", "link": "https://stackoverflow.com/users/6057480/bohao-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5348, "favorite_count": 2, "accepted_answer_id": 37433599, "answer_count": 5, "score": 1, "last_activity_date": 1464175023, "creation_date": 1464169853, "last_edit_date": 1464170432, "question_id": 37433525, "link": "https://stackoverflow.com/questions/37433525/how-to-return-different-types-from-a-single-function", "title": "How to return different types from a single function", "body": "<p>I have the following c code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid *func(int a) { \n    if (a==3) {\n        int a_int = 5;\n        int *ptr_int = &amp;a_int;\n        return (void *)ptr_int;\n    } \n    else if (a==4) {\n        char a_char = 'b';\n        char *ptr_char = &amp;a_char;\n        return (void *)ptr_char;\n    }\n    else {\n        fprintf(stderr, \"return value is NULL\");\n        return NULL;\n    }\n}\n\nint main (int argc, char *argv[]) {\n    int *ptr_int = (int *)func(3);\n    char *ptr_char = (char *)func(4);\n    fprintf(stdout, \"int value = %d\\n\", *ptr_int);\n    fprintf(stdout, \"char value = %c\\n\", *ptr_char);\n    return 0; \n}\n</code></pre>\n\n<p><br>\nBut when I use gcc to test this code, I have the following results :\n<br></p>\n\n<blockquote>\n<pre><code>int value = 98\nchar value = \ufffd\nroot@coupure:/home/bohao/Desktop/test1375# gcc test.c -o test\nroot@coupure:/home/bohao/Desktop/test1375# ./test \nint value = 98\nchar value = \nroot@coupure:/home/bohao/Desktop/test1375# gcc test.c -o test\nroot@coupure:/home/bohao/Desktop/test1375# ./test \nint value = 98\nchar value = \nroot@coupure:/home/bohao/Desktop/test1375# gcc test.c -o test\nroot@coupure:/home/bohao/Desktop/test1375# ./test \nint value = 98\nchar value = \nroot@coupure:/home/bohao/Desktop/test1375# gcc test.c -o test\nroot@coupure:/home/bohao/Desktop/test1375# ./test \nint value = 98\nchar value = \nroot@coupure:/home/bohao/Desktop/test1375# gcc test.c -o test\nroot@coupure:/home/bohao/Desktop/test1375# ./test \nint value = 98\nchar value = g\nroot@coupure:/home/bohao/Desktop/test1375# gcc test.c -o test\nroot@coupure:/home/bohao/Desktop/test1375# ./test \nint value = 98\nchar value = \nroot@coupure:/home/bohao/Desktop/test1375# gcc test.c -o test\nroot@coupure:/home/bohao/Desktop/test1375# ./test \nint value = 98\nchar value = !\n</code></pre>\n</blockquote>\n\n<p>Why do I have the <strong>98</strong> for ptr_int and the <strong>random value</strong> of ptr_char ? <br>\nWhat I want is to have <strong>a general function</strong> who can return different types of values instead of using two functions. Is that possible ? If so, how to do it ? </p>\n"}, {"tags": ["c", "windows", "kernel", "driver"], "answers": [{"comments": [{"owner": {"reputation": 1992, "user_id": 693963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec5403dd4d2945335211ed635425f979?s=128&d=identicon&r=PG", "display_name": "K.Steff", "link": "https://stackoverflow.com/users/693963/k-steff"}, "edited": false, "score": 0, "creation_date": 1464183477, "post_id": 37434861, "comment_id": 62380291, "body": "I understand that this is the Windows security model, <i>however</i> the full image name (along with the path) is reliable for me, since there is a filter driver involved, which can monitor that the service binary file is not modifier. Furthermore, due to the high security significance of the communication between the two parties, if I don&#39;t secure this pipe, it will indirectly allow escalation from SYSTEM to ring0, which is NOT acceptable in my case. Of course, I welcome any criticism of my &quot;security model&quot; and assumptions."}, {"owner": {"reputation": 1992, "user_id": 693963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec5403dd4d2945335211ed635425f979?s=128&d=identicon&r=PG", "display_name": "K.Steff", "link": "https://stackoverflow.com/users/693963/k-steff"}, "edited": false, "score": 0, "creation_date": 1464183739, "post_id": 37434861, "comment_id": 62380494, "body": "Also I should add that there are other security measures planned, for example asking the human user to review which Windows users can debug the process and so on, which are meant to further limit other attack vectors, similar to the one you pointed out."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 1992, "user_id": 693963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec5403dd4d2945335211ed635425f979?s=128&d=identicon&r=PG", "display_name": "K.Steff", "link": "https://stackoverflow.com/users/693963/k-steff"}, "edited": false, "score": 0, "creation_date": 1464186033, "post_id": 37434861, "comment_id": 62382384, "body": "I don&#39;t get how a filter driver (at individual device level) would establish that a certain complete path (which is generally system-wide) is reliable. Even if the file itself isn&#39;t changed on disk, you&#39;d have to make sure that the full path doesn&#39;t refer to another device altogether. And while you may think C:\\ is your hard disk, with reparse points and the like it&#39;s not that simple."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 1992, "user_id": 693963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec5403dd4d2945335211ed635425f979?s=128&d=identicon&r=PG", "display_name": "K.Steff", "link": "https://stackoverflow.com/users/693963/k-steff"}, "edited": false, "score": 1, "creation_date": 1464186205, "post_id": 37434861, "comment_id": 62382527, "body": "As for &quot;escalation from SYSTEM to ring 0&quot;, I&#39;m going to channel Raymond Chen: once you&#39;ve gained control of SYSTEM, you have gained control of the system. As SYSTEM you can already load another driver, which means SYSTEM has access to ring 0 regardless of what you do in your driver."}, {"owner": {"reputation": 1992, "user_id": 693963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec5403dd4d2945335211ed635425f979?s=128&d=identicon&r=PG", "display_name": "K.Steff", "link": "https://stackoverflow.com/users/693963/k-steff"}, "edited": false, "score": 0, "creation_date": 1464186337, "post_id": 37434861, "comment_id": 62382635, "body": "You are correct. I just realized you can enable unsigned drivers when you are SYSTEM and from there on run any code you want as ring0. I&#39;m accepting the answer."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 1992, "user_id": 693963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec5403dd4d2945335211ed635425f979?s=128&d=identicon&r=PG", "display_name": "K.Steff", "link": "https://stackoverflow.com/users/693963/k-steff"}, "edited": false, "score": 0, "creation_date": 1464186371, "post_id": 37434861, "comment_id": 62382671, "body": "Finally, asking a &quot;human user&quot; to verify there are no other accounts with debug permission is missing the point as well. If another account has that right, it has the ability to hide that right.  Remember, you&#39;re modeling threat vectors. You can&#39;t assume your opponent is making it easy for you."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": true, "score": 2, "last_activity_date": 1464173366, "creation_date": 1464173366, "answer_id": 37434861, "question_id": 37433329, "link": "https://stackoverflow.com/questions/37433329/limit-access-to-a-pipe-to-a-process-windows/37434861#37434861", "title": "Limit access to a pipe to a process (Windows)", "body": "<p>Image names are not secured anyway, anyone can create a \"Notepad.EXE\". And a process ID is just a number and can be reused, so that's no protection either. Besides, there are many ways in which you can smuggle a DLL inside another process, so even if you knew that a particular process was running your EXE, you still wouldn't know if it was running <em>just</em> your EXE.</p>\n\n<p>The Windows security model uses the notion of security principals (user and system accounts). Those are directly supported by ACL's, and those are protected against spoofing. It makes sense if your filter driver refuses to talk to just anyone, but it's willing to talk to process A of user X, it should be willing to talk to any process of user X. </p>\n"}], "owner": {"reputation": 1992, "user_id": 693963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec5403dd4d2945335211ed635425f979?s=128&d=identicon&r=PG", "display_name": "K.Steff", "link": "https://stackoverflow.com/users/693963/k-steff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 37434861, "answer_count": 1, "score": 3, "last_activity_date": 1464214305, "creation_date": 1464169354, "last_edit_date": 1464214305, "question_id": 37433329, "link": "https://stackoverflow.com/questions/37433329/limit-access-to-a-pipe-to-a-process-windows", "title": "Limit access to a pipe to a process (Windows)", "body": "<p>Is it possible to limit access to a named pipe by process (either image name, or process ID would work)?  </p>\n\n<p>The context here is a Filter Minidriver which has to communicate with a user-space service that would do most of the business logic. Since this communication is security-sensitive, I'd like to protect it from external interference, while by default it seems the named pipe, created by the driver can be communicated with by <em>any</em> user-space process that knows the name of the pipe (which is trivial to discover by static or dynamic analysis).</p>\n\n<p>This is what I already know: Pipes are securable objects in Windows, and as such, they have a security descriptor. This security descriptor can contain a DACL, which is supposed to limit access to the object. I have searched extensively for documentation and examples of conditional ACEs, which I hoped could do what I want, but I failed to find anything related.</p>\n\n<p><strong>EDIT</strong>: I have accepted MSalters' answer. It is generally accepted that <code>SYSTEM</code> == <code>ring0</code> and while code signing of drivers may seem like it matters, <code>SYSTEM</code> can disable code signing easily, so there is no need for privilege escalation from <code>SYSTEM</code> to <code>ring0</code> - they're already the same. On the other hand, even the default security descriptor (in the minifilter driver context - see <code>FltBuildDefaultSecurityDescriptor</code>) contains a restriction so that only <code>SYSTEM</code> and Administrators can access the object, so no further action is necessary (or possible, it seems).</p>\n"}, {"tags": ["c", "printf", "buffer"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 4, "creation_date": 1464168280, "post_id": 37432797, "comment_id": 62369213, "body": "<code>size_t</code> is unsigned...."}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 4, "last_activity_date": 1464169018, "last_edit_date": 1464169018, "creation_date": 1464168675, "answer_id": 37433031, "question_id": 37432797, "link": "https://stackoverflow.com/questions/37432797/snprintf-negative-zero-value-of-buffer-size/37433031#37433031", "title": "snprintf negative/zero value of buffer size", "body": "<p>Passing <code>0</code> to <code>snprintf</code> no char will be inserted into <code>dest</code> buffer.</p>\n\n<p>Passing a negative number to a <code>size_t</code> parameter, which is <code>unsigned</code>, you are  passing a very big number as <code>size</code>.</p>\n\n<p>Try</p>\n\n<pre><code>printf(\"%zu\\n%zu\\n\", (size_t)(-1),  SIZE_MAX);\n</code></pre>\n\n<p>So with negative size parameter you can write a lot of bytes more that real dest buffer size, that in other words is Undefined Behavior/buffer overflow.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 9, "last_activity_date": 1464169734, "last_edit_date": 1464169734, "creation_date": 1464168702, "answer_id": 37433047, "question_id": 37432797, "link": "https://stackoverflow.com/questions/37432797/snprintf-negative-zero-value-of-buffer-size/37433047#37433047", "title": "snprintf negative/zero value of buffer size", "body": "<p>Quoting <code>C11</code>, chpater \u00a77.21.6.5, <em>The <code>snprintf()</code> function</em></p>\n\n<blockquote>\n  <p><code>int snprintf(char * restrict s, size_t n,const char * restrict format, ...);</code></p>\n  \n  <p>[...] If <code>n</code> is zero, nothing is written,\n  and <code>s</code> may be a null pointer.</p>\n</blockquote>\n\n<p>So, in case you pass 0, nothing is written.</p>\n\n<p>In case if you pass a <code>-</code>ve value, it may create issues, as the second argument, is of type <code>size_t</code> which is <code>unsigned</code>. So, the signed value will be treated as <code>unsigned</code> producing a unwanted size. This may cause issues (memory overrun) as the size is likely to be more than the supplied buffer can handle, which invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.\n. Nevertheless, as long as the buffer is large enough to be able to hold the supplied data, the supplied data will be written to the buffer.</p>\n\n<p>From \u00a77.19, <code>&lt;stddef.h&gt;</code></p>\n\n<blockquote>\n  <p><code>size_t</code><br>\n  which is the unsigned integer type of the result of the sizeof operator;</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1624, "user_id": 296549, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/134cf24554b2115f4ed28d2ff43b378f?s=128&d=identicon&r=PG", "display_name": "Bacon", "link": "https://stackoverflow.com/users/296549/bacon"}, "is_accepted": false, "score": 3, "last_activity_date": 1563330504, "last_edit_date": 1592644375, "creation_date": 1563330504, "answer_id": 57067749, "question_id": 37432797, "link": "https://stackoverflow.com/questions/37432797/snprintf-negative-zero-value-of-buffer-size/57067749#57067749", "title": "snprintf negative/zero value of buffer size", "body": "<p>While the existing answers are correct when saying that no bytes will be written to the destination buffer when a size of 0 is given, they fail to inform you that, in this case, the return value of <code>snprintf</code> will be the sum of the sizes of your formatting parameters. Realizing this can come quite handy at times :)</p>\n<p>From the manual:</p>\n<blockquote>\n<p>RETURN VALUE</p>\n<p>Upon successful return, these functions return the number\nof characters printed (excluding  the null byte used to end output to\nstrings).</p>\n<p>The  functions snprintf() and vsnprintf() do not write more than size\nbytes (including the ter\u2010 minating null byte ('\\0')).  <strong>If the output\nwas truncated due to this  limit,  then  the  return value  is  the\nnumber of characters (excluding the terminating null byte) which would\nhave been written to the final string if enough space had been\navailable.</strong>  Thus, a return value  of  size or more means that the\noutput was truncated.  (See also below under NOTES.)</p>\n<p>If an output error is encountered, a negative value is returned.</p>\n</blockquote>\n"}], "owner": {"reputation": 3717, "user_id": 1215996, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ff628cd135c5f60ce0dfda4b40ac06e?s=128&d=identicon&r=PG", "display_name": "Sumit Trehan", "link": "https://stackoverflow.com/users/1215996/sumit-trehan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2529, "favorite_count": 1, "accepted_answer_id": 37433031, "answer_count": 3, "score": 3, "last_activity_date": 1563330504, "creation_date": 1464168098, "last_edit_date": 1464169132, "question_id": 37432797, "link": "https://stackoverflow.com/questions/37432797/snprintf-negative-zero-value-of-buffer-size", "title": "snprintf negative/zero value of buffer size", "body": "<p>If a negative number or 0 is passed as the second argument to <code>snprintf()</code>, will it write at the provided buffer position. Want to have the views that this should not result in any unexpected behavior.</p>\n\n<pre><code>int snprintf(char *str, size_t size, const char *format, ...);\n</code></pre>\n"}, {"tags": ["c", "gcc", "gcc-warning"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1464168076, "post_id": 37432718, "comment_id": 62369049, "body": "It complains it&#39;s uninitialized, or unused? And what is your warning level by the way?"}, {"owner": {"reputation": 21, "user_id": 6380319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-10JL0xNv7qU/AAAAAAAAAAI/AAAAAAAAAAA/hlx8yIpU_nQ/photo.jpg?sz=128", "display_name": "Erik Oomen", "link": "https://stackoverflow.com/users/6380319/erik-oomen"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1464168129, "post_id": 37432718, "comment_id": 62369092, "body": "(Used with -Wall) warning: \u2018j\u2019 may be used uninitialized in this function [-Wmaybe-uninitialized]"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1464168262, "post_id": 37432718, "comment_id": 62369201, "body": "add <code>-O1</code> to get the warning for this code (in gcc 5.3).  It doesn&#39;t try very hard to make these warnings, changing the optimization level may make it stumble on the problem"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1464168316, "post_id": 37432718, "comment_id": 62369236, "body": "the warning goes away at O2 and O3 because the whole loop is optimized out; to stop this, insert a call <code>void g();  g();</code> in the loop"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464168471, "post_id": 37432718, "comment_id": 62369342, "body": "ok, I was using 5.3.0 with switches <code>-std=c11 -Wall -O1</code>. All versions of gcc on the online tester (4.7 through to 5.3.0, and 6.1) give the warning with these switches for your code as posted"}, {"owner": {"reputation": 21, "user_id": 6380319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-10JL0xNv7qU/AAAAAAAAAAI/AAAAAAAAAAA/hlx8yIpU_nQ/photo.jpg?sz=128", "display_name": "Erik Oomen", "link": "https://stackoverflow.com/users/6380319/erik-oomen"}, "edited": false, "score": 0, "creation_date": 1464168835, "post_id": 37432718, "comment_id": 62369615, "body": "Indeed.  Scary...  Didn&#39;t realize the optimization level matters."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1464169361, "post_id": 37432718, "comment_id": 62369979, "body": "Strange, it should warn in both cases, at least that&#39;s what clang does. You can explore different compilers <a href=\"https://gcc.godbolt.org/\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6380319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-10JL0xNv7qU/AAAAAAAAAAI/AAAAAAAAAAA/hlx8yIpU_nQ/photo.jpg?sz=128", "display_name": "Erik Oomen", "link": "https://stackoverflow.com/users/6380319/erik-oomen"}, "edited": false, "score": 2, "creation_date": 1464169030, "post_id": 37433095, "comment_id": 62369744, "body": "You are correct, I didn&#39;t releaize the optimization levels removed the loop.  However, why is the loop not removed when I remove the j+= 10...  Strange."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 21, "user_id": 6380319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-10JL0xNv7qU/AAAAAAAAAAI/AAAAAAAAAAA/hlx8yIpU_nQ/photo.jpg?sz=128", "display_name": "Erik Oomen", "link": "https://stackoverflow.com/users/6380319/erik-oomen"}, "edited": false, "score": 0, "creation_date": 1464169261, "post_id": 37433095, "comment_id": 62369903, "body": "@ErikOomen goes to show that nothing except <code>-O3</code> matters when talking about optimization"}], "tags": [], "owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "is_accepted": false, "score": 1, "last_activity_date": 1464168808, "creation_date": 1464168808, "answer_id": 37433095, "question_id": 37432718, "link": "https://stackoverflow.com/questions/37432718/gcc-not-complaining-about-uninitialized-variable/37433095#37433095", "title": "GCC not complaining about uninitialized variable", "body": "<p>You're likely compiling this at high optimization levels, which cause the loop to be removed for optimization purposes.</p>\n\n<p>So try compiling at <code>-O1</code> or <code>-O0</code> even.</p>\n\n<p>If that doesn't make it show up, ensure that you use high warning levels, with <code>-Wall</code> and <code>-pendantic</code></p>\n"}, {"tags": [], "owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "is_accepted": true, "score": 0, "last_activity_date": 1464169762, "creation_date": 1464169762, "answer_id": 37433491, "question_id": 37432718, "link": "https://stackoverflow.com/questions/37432718/gcc-not-complaining-about-uninitialized-variable/37433491#37433491", "title": "GCC not complaining about uninitialized variable", "body": "<p>An optimiser can figure out that the whole loop is pointless, but it is a bit complicated. The loop is pointless because the values of i and j are not used after the loop, and j is used inside the loop only to decide when to break early, which doesn't matter either because the number of iterations of the loop doesn't matter. So in this situation, if you initialised j to a random number, you would get exactly the same result. So the compiler <em>may</em> not issue a warning because nothing harmful will happen. </p>\n\n<p>Obviously you have undefined behaviour, so the whole app could just crash because of the uninitialised variable. But that is up to the compiler, so if that happened, you should get a warning. </p>\n"}], "owner": {"reputation": 21, "user_id": 6380319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-10JL0xNv7qU/AAAAAAAAAAI/AAAAAAAAAAA/hlx8yIpU_nQ/photo.jpg?sz=128", "display_name": "Erik Oomen", "link": "https://stackoverflow.com/users/6380319/erik-oomen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 37433491, "answer_count": 2, "score": 1, "last_activity_date": 1464169762, "creation_date": 1464167912, "last_edit_date": 1464169206, "question_id": 37432718, "link": "https://stackoverflow.com/questions/37432718/gcc-not-complaining-about-uninitialized-variable", "title": "GCC not complaining about uninitialized variable", "body": "<p>Why is it that gcc is not complaining about j being uninitialized? If I remove the j += 10 it will actually complain...  Compile with -Wall (tested with gcc 4.9 and 5.3).</p>\n\n<pre><code>int main(void)\n{\n    int i;\n    int j;\n    int threshold = 100;\n\n    for (i = 0 ; i &lt; 100 ; i++)\n    {\n        if (j &gt;= threshold)\n            break;\n        j += 10; /* comment this line to enable uninitialized variable warning */\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "angelscript"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1464173488, "post_id": 37432630, "comment_id": 62372864, "body": "What is the problem you are having? Quick googling revealed <a href=\"http://www.angelcode.com/angelscript/sdk/docs/manual/doc_reg_objprop.html\" rel=\"nofollow noreferrer\">a lot of info</a> regarding registering objects and object properties. Please read the manual and try find solution, and then ask if you have specific problem. Question as it&#39;s now is too broad and shows no research effort."}, {"owner": {"reputation": 779, "user_id": 1727703, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/lLjZS.jpg?s=128&g=1", "display_name": "Max", "link": "https://stackoverflow.com/users/1727703/max"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1464174039, "post_id": 37432630, "comment_id": 62373231, "body": "@user694733 Oh! I missed this paragraph. Ty!"}], "owner": {"reputation": 779, "user_id": 1727703, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/lLjZS.jpg?s=128&g=1", "display_name": "Max", "link": "https://stackoverflow.com/users/1727703/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464167685, "creation_date": 1464167685, "question_id": 37432630, "link": "https://stackoverflow.com/questions/37432630/custom-struct-in-angelscript", "title": "Custom struct in AngelScript", "body": "<p>Maybe somebody know. How can I send my custom c-struct, from my c-application to AngelScript-script?  At the moment, I just use the standard types (char*, uint8_t)</p>\n\n<p>Best regards.</p>\n"}, {"tags": ["c++", "c", "video", "ffmpeg"], "answers": [{"comments": [{"owner": {"reputation": 114, "user_id": 6320153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fhZdF.png?s=128&g=1", "display_name": "lupod", "link": "https://stackoverflow.com/users/6320153/lupod"}, "edited": false, "score": 0, "creation_date": 1464167229, "post_id": 37432167, "comment_id": 62368446, "body": "Thank you for your answer. I forgot to specify that I put aside for the moment the parallelization and that the queue is built sequentially (I edited my question),"}, {"owner": {"reputation": 141, "user_id": 6340066, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207551318599538/picture?type=large", "display_name": "Joey Yandle", "link": "https://stackoverflow.com/users/6340066/joey-yandle"}, "reply_to_user": {"reputation": 114, "user_id": 6320153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fhZdF.png?s=128&g=1", "display_name": "lupod", "link": "https://stackoverflow.com/users/6320153/lupod"}, "edited": false, "score": 0, "creation_date": 1464167842, "post_id": 37432167, "comment_id": 62368879, "body": "If you don&#39;t want to post the full code, I suggest logging the pushed and popped frame pointer addresses.  Make sure you&#39;re seeing the same sequence of addresses in both directions."}, {"owner": {"reputation": 141, "user_id": 6340066, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207551318599538/picture?type=large", "display_name": "Joey Yandle", "link": "https://stackoverflow.com/users/6340066/joey-yandle"}, "reply_to_user": {"reputation": 114, "user_id": 6320153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fhZdF.png?s=128&g=1", "display_name": "lupod", "link": "https://stackoverflow.com/users/6320153/lupod"}, "edited": false, "score": 1, "creation_date": 1464169345, "post_id": 37432167, "comment_id": 62369958, "body": "You can also log the frame&#39;s pts and verify its monotonicity."}], "tags": [], "owner": {"reputation": 141, "user_id": 6340066, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207551318599538/picture?type=large", "display_name": "Joey Yandle", "link": "https://stackoverflow.com/users/6340066/joey-yandle"}, "is_accepted": false, "score": 0, "last_activity_date": 1464166352, "creation_date": 1464166352, "answer_id": 37432167, "question_id": 37431897, "link": "https://stackoverflow.com/questions/37431897/ffmpeg-c-api-creating-queue-of-frames/37432167#37432167", "title": "ffmpeg C API - creating queue of frames", "body": "<p>There's nothing obviously wrong with your pseudocode.  The problem almost certainly lies in how you lock the queue between threads. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5930793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a398d7d3bd726cd2dda8f91f1f4772e?s=128&d=identicon&r=PG&f=1", "display_name": "B. Chalios", "link": "https://stackoverflow.com/users/5930793/b-chalios"}, "is_accepted": false, "score": 0, "last_activity_date": 1464171632, "creation_date": 1464171632, "answer_id": 37434206, "question_id": 37431897, "link": "https://stackoverflow.com/questions/37431897/ffmpeg-c-api-creating-queue-of-frames/37434206#37434206", "title": "ffmpeg C API - creating queue of frames", "body": "<p>Your memory allocation seems same to me. Do you maybe do something else in between reading and writing the frames? </p>\n\n<p>Is <code>queue</code> the same queue in the routines that read and write the frames?</p>\n"}, {"comments": [{"owner": {"reputation": 114, "user_id": 6320153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fhZdF.png?s=128&g=1", "display_name": "lupod", "link": "https://stackoverflow.com/users/6320153/lupod"}, "edited": false, "score": 0, "creation_date": 1464174731, "post_id": 37434813, "comment_id": 62373673, "body": "THANK YOU! This was exactly my problem!"}], "tags": [], "owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "is_accepted": true, "score": 2, "last_activity_date": 1464174124, "last_edit_date": 1464174124, "creation_date": 1464173244, "answer_id": 37434813, "question_id": 37431897, "link": "https://stackoverflow.com/questions/37431897/ffmpeg-c-api-creating-queue-of-frames/37434813#37434813", "title": "ffmpeg C API - creating queue of frames", "body": "<p>Ah, so I'm assuming that <code>readFrame()</code> is a wrapper around libavformat's <code>av_read_frame()</code> and libavcodec's <code>avcodec_decode_video2()</code>, is that right?</p>\n\n<p>From the <a href=\"https://ffmpeg.org/doxygen/trunk/group__lavc__decoding.html#ga3ac51525b7ad8bca4ced9f3446e96532\" rel=\"nofollow\">documentation</a>:</p>\n\n<blockquote>\n  <p>When <code>AVCodecContext.refcounted_frames</code> is set to 1, the frame is\n  reference counted and the returned reference belongs to the caller.\n  The caller must release the frame using <code>av_frame_unref()</code> when the\n  frame is no longer needed.</p>\n</blockquote>\n\n<p>and:</p>\n\n<blockquote>\n  <p>When\n  <code>AVCodecContext.refcounted_frames</code> is set to 0, the returned reference\n  belongs to the decoder and is valid only until the next call to this\n  function or until closing or flushing the decoder.</p>\n</blockquote>\n\n<p>Obviously, from this it follows from this that you need to set <code>AVCodecContext.refcounted_frames</code> to 1. The default is 0, so my gut feeling is you need to set it to 1 and that will fix your problem. Don't forget to use <code>av_fame_unref()</code> on the pictures after use to prevent memleaks, and also don't forget to free your <code>AVFrame</code> in this loop if <code>got_frame = 0</code> - again to prevent memleaks:</p>\n\n<blockquote>\n<pre><code>while (ret) {\n  AVFrame* frame = av_frame_alloc();\n  ret = readFrame(inputfile,frame,&amp;got_frame);\n  if (got_frame) \n    queue.push(frame);\n  else\n    av_frame_free(frame);\n}\n</code></pre>\n</blockquote>\n\n<p>(Or alternatively you could implement some cache for <code>frame</code> so you only realloc it if the previous object was pushed in the queue.)</p>\n"}], "owner": {"reputation": 114, "user_id": 6320153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fhZdF.png?s=128&g=1", "display_name": "lupod", "link": "https://stackoverflow.com/users/6320153/lupod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1460, "favorite_count": 2, "accepted_answer_id": 37434813, "answer_count": 3, "score": 1, "last_activity_date": 1464174124, "creation_date": 1464165637, "last_edit_date": 1464167084, "question_id": 37431897, "link": "https://stackoverflow.com/questions/37431897/ffmpeg-c-api-creating-queue-of-frames", "title": "ffmpeg C API - creating queue of frames", "body": "<p>I have created using the C API of ffmpeg a C++ application that reads frames from a file and writes them to a new file. Everything works fine, as long as I write immediately the frames to the output. In other words, the following structure of the program outputs the correct result (I put only the pseudocode for now, if needed I can also post some real snippets but the classes that I have created for handling the ffmpeg functionalities are quite large):</p>\n\n<pre><code>AVFrame* frame = av_frame_alloc();\nint got_frame;\n\n// readFrame returns 0 if file is ended, got frame = 1 if\n// a complete frame has been extracted\nwhile(readFrame(inputfile,frame, &amp;got_frame)) {\n  if (got_frame) {\n    // I actually do some processing here\n    writeFrame(outputfile,frame);\n  }\n}\nav_frame_free(&amp;frame);\n</code></pre>\n\n<p>The next step has been to parallelize the application and, as a consequence, frames are not written immediately after they are read (I do not want to go into the details of the parallelization). In this case problems arise: there is some flickering in the output, as if some frames get repeated randomly. However, the number of frames and the duration of the output video remains correct.</p>\n\n<p>What I am trying to do now is to separate completely the reading from writing in the serial implementation in order to understand what is going on. I am creating a queue of pointers to frames:</p>\n\n<pre><code>std::queue&lt;AVFrame*&gt; queue;\nint ret = 1, got_frame;\nwhile (ret) {\n  AVFrame* frame = av_frame_alloc();\n  ret = readFrame(inputfile,frame,&amp;got_frame);\n  if (got_frame) \n    queue.push(frame);\n}\n</code></pre>\n\n<p>To write frames to the output file I do:</p>\n\n<pre><code>while (!queue.empty()) {\n  frame = queue.front();\n  queue.pop();\n  writeFrame(outputFile,frame);\n  av_frame_free(&amp;frame);\n}\n</code></pre>\n\n<p>The result in this case <strong>is an output video with the correct duration and number of frames that is only a repetition of the last 3 (I think) frames of the video.</strong></p>\n\n<p>My guess is that something might go wrong because of the fact that in the first case I use always the same memory location for reading frames, while in the second case I allocate many different frames.</p>\n\n<p>Any suggestions on what could be the problem?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1220, "user_id": 2172854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hm0Q1.png?s=128&g=1", "display_name": "abhishek_naik", "link": "https://stackoverflow.com/users/2172854/abhishek-naik"}, "edited": false, "score": 3, "creation_date": 1464165605, "post_id": 37431870, "comment_id": 62367423, "body": "<code>*p_array = 0;</code> refers only to the first element of the array."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1464165877, "creation_date": 1464165877, "answer_id": 37431988, "question_id": 37431870, "link": "https://stackoverflow.com/questions/37431870/wanting-to-deference-my-array-contents-to-zero-only-first-number-in-array-chang/37431988#37431988", "title": "Wanting to deference my array contents to zero. Only first number in array changes to zero", "body": "<p>For any pointer or array <code>p</code> and index <code>i</code> the expression <code>p[i]</code> and <code>*(p + i)</code> are the same.</p>\n\n<p>Now if the index is <code>0</code> then we have <code>p[0]</code> which is the same as <code>*(p + 0)</code>, and <code>*(p + 0)</code> is the same as <code>*(p)</code> which is the same as <code>*p</code>.</p>\n\n<p>That is, if you have a pointer and dereference it, then you will get exactly what the pointer is pointing to, for example the first element in an array pointed to by the pointer.</p>\n\n<p>If you want to set all elements in the array to zero, you have two choices: Either use an explicit loop and set each and every element to zero. Or since you have an array of integers you could use <a href=\"http://en.cppreference.com/w/c/string/byte/memset\" rel=\"nofollow\"><code>memset</code></a> to set each and every <em>byte</em> in the array to zero.</p>\n\n<p>Using <a href=\"http://en.cppreference.com/w/c/string/byte/memset\" rel=\"nofollow\"><code>memset</code></a> you could do e.g.</p>\n\n<pre><code>memset(p_array, 0, sizeof(*p_array) * num_elements);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1220, "user_id": 2172854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hm0Q1.png?s=128&g=1", "display_name": "abhishek_naik", "link": "https://stackoverflow.com/users/2172854/abhishek-naik"}, "is_accepted": true, "score": 0, "last_activity_date": 1464166094, "creation_date": 1464166094, "answer_id": 37432067, "question_id": 37431870, "link": "https://stackoverflow.com/questions/37431870/wanting-to-deference-my-array-contents-to-zero-only-first-number-in-array-chang/37432067#37432067", "title": "Wanting to deference my array contents to zero. Only first number in array changes to zero", "body": "<p>Please consider the code modified as below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid print_array(int* p_array, int num_elements)\n{\n    printf(\"print_array called:\\n\");\n\n    for (int i = 0; i &lt; num_elements; i++)\n    {\n        printf(\"%d \\n\", p_array[i]);\n    }\n}\n\nvoid zero_out_array(int* p_array, int num_elements)\n{\n    printf(\"zero_out_array called:\\n\");\n\n    *p_array = 0;\n\n    for(int j = 0; j &lt; num_elements; j++)\n        *(p_array+j)=0;\n\n    for (int j = 0; j &lt; num_elements; j++)\n    {\n        printf(\"%d \\n\", p_array[j]);\n    }\n}\n\nint main()\n{\n    int main_array[] = { 15, 24, 33, 42, 51 };\n\n    print_array(main_array, 5);\n\n    zero_out_array(main_array, 5);\n\n    return 0;\n}\n</code></pre>\n\n<p>In the above code, I have added the extra for loop:</p>\n\n<pre><code>for(int j = 0; j &lt; num_elements; j++)\n        *(p_array+j)=0;\n</code></pre>\n\n<p><code>*p_array</code> points only to the first element of the array, so I have used a for loop to change all the elements.  By doing <code>*(p_array+j)=0</code>, I am iteratively visiting all the array elements and making them 0.</p>\n"}], "owner": {"reputation": 1, "user_id": 6380184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20859d156370c7a9b3862d8f1e6c2e9?s=128&d=identicon&r=PG&f=1", "display_name": "CStudent1667", "link": "https://stackoverflow.com/users/6380184/cstudent1667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 37432067, "answer_count": 2, "score": -1, "last_activity_date": 1464166094, "creation_date": 1464165539, "question_id": 37431870, "link": "https://stackoverflow.com/questions/37431870/wanting-to-deference-my-array-contents-to-zero-only-first-number-in-array-chang", "title": "Wanting to deference my array contents to zero. Only first number in array changes to zero", "body": "<p>I am new to stackoverflow and C and I have a question. I am required to write a program that will iterate through an array, and then dereference the contents to zero. For some reason, my \"zero_out_array\" will only change the first number in my array to zero, and not the rest. Here is my code, any help is appreciated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid print_array(int* p_array, int num_elements)\n{\n    printf(\"print_array called:\\n\");\n\n    for (int i = 0; i &lt; num_elements; i++)\n    {\n        printf(\"%d \\n\", p_array[i]);\n    }\n}\n\nvoid zero_out_array(int* p_array, int num_elements)\n{\n    printf(\"zero_out_array called:\\n\");\n\n    *p_array = 0;\n\n    for (int j = 0; j &lt; num_elements; j++)\n    {\n        printf(\"%d \\n\", p_array[j]);\n    }\n}\n\nint main()\n{\n    int main_array[] = { 15, 24, 33, 42, 51 };\n\n    print_array(main_array, 5);\n\n    zero_out_array(main_array, 5);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "reverse"], "comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1464160261, "post_id": 37430085, "comment_id": 62364328, "body": "Change <code>char temp[1]</code> to <code>char temp[2]</code>, as you need an additional entry for the null-character."}, {"owner": {"reputation": 1065, "user_id": 3845747, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9u54v.jpg?s=128&g=1", "display_name": "MrPickles", "link": "https://stackoverflow.com/users/3845747/mrpickles"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1464160550, "post_id": 37430085, "comment_id": 62364484, "body": "@barakmanos made the change and still breaks on that test case.  Added a <code>temp[1] = &#39;\\0&#39;;</code> after <code>strncpy</code> just to get it to compile."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1464160563, "post_id": 37430085, "comment_id": 62364492, "body": "You&#39;re right (in the comment to my (now deleted) answer). I didn&#39;t notice the <code>n</code> in <code>strncpy</code>. However, the following call to <code>strcat</code> is done with a non-null-terminated string, which is where the problem lies."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1464160593, "post_id": 37430085, "comment_id": 62364515, "body": "@MrPickles: That&#39;s UB. You should do <code>temp[1] = &#39;\\0&#39;;</code>!!!"}, {"owner": {"reputation": 1065, "user_id": 3845747, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9u54v.jpg?s=128&g=1", "display_name": "MrPickles", "link": "https://stackoverflow.com/users/3845747/mrpickles"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1464160649, "post_id": 37430085, "comment_id": 62364549, "body": "@barakmanos sorry I meant <code>temp[1] = &#39;\\0&#39;;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1065, "user_id": 3845747, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9u54v.jpg?s=128&g=1", "display_name": "MrPickles", "link": "https://stackoverflow.com/users/3845747/mrpickles"}, "edited": false, "score": 0, "creation_date": 1464160745, "post_id": 37430263, "comment_id": 62364605, "body": "That was the problem.  I didn&#39;t initialize <code>reversed_string</code> after I did the <code>malloc</code> and I just added the <code>temp[2]</code> per @barakmanos.  Answer is accepted on leetcode now."}], "tags": [], "owner": {"reputation": 47440, "user_id": 229410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e0014fcc07d184018d3b8185a85a09?s=128&d=identicon&r=PG", "display_name": "Rohan", "link": "https://stackoverflow.com/users/229410/rohan"}, "is_accepted": true, "score": 1, "last_activity_date": 1464160616, "creation_date": 1464160616, "answer_id": 37430263, "question_id": 37430085, "link": "https://stackoverflow.com/questions/37430085/c-whats-wrong-with-my-reverse-string-function/37430263#37430263", "title": "C: What&#39;s wrong with my reverse string function?", "body": "<p>You need to allocate 2 chars for <code>temp</code> and initialize with 0's, so change it to</p>\n\n<pre><code>char temp[2] = { 0 };\n</code></pre>\n\n<p>Also, initialize <code>reversed_string</code> after allocating memory to it, so that first <code>strcat</code> works properly.</p>\n\n<pre><code>reversed_string = malloc(length + 1);\nreversed_string[0] = '\\0';\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1464162880, "creation_date": 1464162880, "answer_id": 37430992, "question_id": 37430085, "link": "https://stackoverflow.com/questions/37430085/c-whats-wrong-with-my-reverse-string-function/37430992#37430992", "title": "C: What&#39;s wrong with my reverse string function?", "body": "<p>this part of the posted code:</p>\n\n<pre><code>for(i = 0; i &lt; length; i++)\n{\n    s = s - 1;\n    strncpy(temp, s, 1);\n    strcat(reversed_string, temp);\n}\n</code></pre>\n\n<p>is not doing the right thing.</p>\n\n<p>It should be copying one byte at a time from the end of the original string to the beginning of the reversed string.</p>\n\n<p>Suggest the following code which: </p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>performs the desired functionality</li>\n<li>is a complete program</li>\n<li>because it is going to be used in one of the online coding contests does not perform any error checking.</li>\n</ol>\n\n<p>and now, the code</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n// use meaningful variable and parameter names\nchar* reverseString(char* original)\n{\n    size_t length = strlen( original );\n\n\n    /* Allocate reversed string based off length of original string */\n    char *reversed = NULL;\n    reversed = malloc(length + 1);\n\n    char *dest = reversed;\n    char *source = &amp;(original[ strlen(original) -1 ]);\n\n    for( ; source &gt;= original; source--)\n    {\n        *dest = *source;\n        dest++;\n    }\n\n    *dest = '\\0';\n\n    /* Return reversed string */\n    return reversed;\n} // end function: reverseString\n\n\nint main( void )\n{\n    char inBuffer[ 4096 ];\n    fgets( inBuffer, sizeof(inBuffer), stdin );\n\n    // eliminate trailing newline if it exists\n    char * newline = NULL;\n    if( NULL != (newline = strstr( inBuffer, \"\\n\" ) ) )\n    {\n        *newline = '\\0';\n    }\n\n    char * newString = reverseString( inBuffer );\n    printf( \"%s\\n\\n\", newString );\n} // end function: main\n</code></pre>\n"}], "owner": {"reputation": 1065, "user_id": 3845747, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9u54v.jpg?s=128&g=1", "display_name": "MrPickles", "link": "https://stackoverflow.com/users/3845747/mrpickles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 37430263, "answer_count": 2, "score": 0, "last_activity_date": 1464162880, "creation_date": 1464160095, "last_edit_date": 1464161138, "question_id": 37430085, "link": "https://stackoverflow.com/questions/37430085/c-whats-wrong-with-my-reverse-string-function", "title": "C: What&#39;s wrong with my reverse string function?", "body": "<p>Been solving leetcode puzzles and thought I solved this one pretty quickly, yet I am running into a strange error.  My output is matching the expected output, so I have no idea why it's rejecting my solution based off the following test case.</p>\n\n<pre><code>char* reverseString(char* s) \n{\n/* Sample input: \"Hello\"\n   Sample output: \"olleh\"\n*/\n\n    char * reversed_string;\n    char temp[1];\n    int length = 0;\n    int i;\n\n    if(s == NULL)\n        return NULL;\n\n    length = strlen(s);\n\n/* While string is not null, increment pointer */\n    while(*s != NULL)\n    {\n        s = s + 1;\n    }\n\n/* Allocate reversed string based off length of original string */\nreversed_string = malloc(length + 1);\n\n/* Traverse backwards for length of string */\n/* Copy each letter to temp */\n/* Concatenate each letter to reversed_string */\n    for(i = 0; i &lt; length; i++)\n    {\n        s = s - 1;\n        strncpy(temp, s, 1);\n        strcat(reversed_string, temp);\n    }\n\n    reversed_string[length] = '\\0';\n\n/* Return reversed string */\n    return reversed_string;\n}\n</code></pre>\n\n<p>MOutput = My Output</p>\n\n<p>EOutput = Expected Output</p>\n\n<pre><code>Input:   \"?CZU.9Iw8G3K?fse,b7 m;0?f :`c9d!D'`Pem0'Du0;9i` 03F,: 7,oPw'T'5`1g!iwR5J71iJ\\\"f;r6L;qZaDGx?cvkS 8\\\"UY2u`YC P3CM y`4v 1q7P;Zd1.;:RA!oYh;!2W8xMfMx8W2!;hYo!AR:;.1dZ;P7q1 v4`y MC3P CY`u2YU\\\"8 Skvc?xGDaZq;L6r;f\\\"Ji17J5Rwi!g1`5'T'wPo,7 :,F30 `i9;0uD'0meP`'D!d9c`: f?0;Z 7b,esf?K3G8wI9.UmC?\"\n\nMOutput: \"?CmU.9Iw8G3K?fse,b7 Z;0?f :`c9d!D'`Pem0'Du0;9i` 03F,: 7,oPw'T'5`1g!iwR5J71iJ\"f;r6L;qZaDGx?cvkS 8\"UY2u`YC P3CM y`4v 1q7P;Zd1.;:RA!oYh;!2W8xMfMx8W2!;hYo!AR:;.1dZ;P7q1 v4`y MC3P CY`u2YU\"8 Skvc?xGDaZq;L6r;f\"Ji17J5Rwi!g1`5'T'wPo,7 :,F30 `i9;0uD'0meP`'D!d9c`: f?0;m 7b,esf?K3G8wI9.UZC?\"\n\nEOutput: \"?CmU.9Iw8G3K?fse,b7 Z;0?f :`c9d!D'`Pem0'Du0;9i` 03F,: 7,oPw'T'5`1g!iwR5J71iJ\"f;r6L;qZaDGx?cvkS 8\"UY2u`YC P3CM y`4v 1q7P;Zd1.;:RA!oYh;!2W8xMfMx8W2!;hYo!AR:;.1dZ;P7q1 v4`y MC3P CY`u2YU\"8 Skvc?xGDaZq;L6r;f\"Ji17J5Rwi!g1`5'T'wPo,7 :,F30 `i9;0uD'0meP`'D!d9c`: f?0;m 7b,esf?K3G8wI9.UZC?\"\n</code></pre>\n\n<p>Anyone spot what might be wrong with my function?  Is there undefined behavior anywhere?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1464160505, "post_id": 37430047, "comment_id": 62364464, "body": "<code>*data</code> is effectively equivalent to <code>data[0]</code>.  Clearly that won&#39;t work."}, {"owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "edited": false, "score": 0, "creation_date": 1464160544, "post_id": 37430047, "comment_id": 62364479, "body": "<code>volatile uint8_t data[4]</code> is a static array, when you use the name of this array in an expression it will decay into a pointer of its type which is a <code>prvalue</code> which means you can&#39;t assign to it like <code>data=(uint8_t*)speed;</code>."}, {"owner": {"reputation": 331, "user_id": 3682393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f38564fa14ad5ebbdc676dc32e5f38b?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume George", "link": "https://stackoverflow.com/users/3682393/guillaume-george"}, "edited": false, "score": 0, "creation_date": 1464160591, "post_id": 37430047, "comment_id": 62364511, "body": "You probably want to write speed=*(uint32_t*)data instead of speed=( uint32_t)*data."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "reply_to_user": {"reputation": 331, "user_id": 3682393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f38564fa14ad5ebbdc676dc32e5f38b?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume George", "link": "https://stackoverflow.com/users/3682393/guillaume-george"}, "edited": false, "score": 1, "creation_date": 1464161235, "post_id": 37430047, "comment_id": 62364878, "body": "@GuillaumeGeorge This is dangerous. According endianness of microcontroller, results can be different"}, {"owner": {"reputation": 35, "user_id": 6333920, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/555647ad664f5f7afc03ead2d5760d4d?s=128&d=identicon&r=PG&f=1", "display_name": "shams alsham", "link": "https://stackoverflow.com/users/6333920/shams-alsham"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1464161444, "post_id": 37430047, "comment_id": 62365003, "body": "@TomKarzes so I have to write:       speed=( uint32_t)data;"}, {"owner": {"reputation": 3107, "user_id": 1928235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8119b4672d36b04e505f44e0e9187eea?s=128&d=identicon&r=PG", "display_name": "user4520", "link": "https://stackoverflow.com/users/1928235/user4520"}, "edited": false, "score": 0, "creation_date": 1464162111, "post_id": 37430047, "comment_id": 62365361, "body": "You want <code>speed = *(uint32_t*)data;</code>. Keep in mind the result of this depends on the CPU&#39;s endianness, though. And after you multiply <code>speed</code> by 10, you can&#39;t really use the <code>=</code> operator to copy the bytes back into the array; instead, do this: <code>memcpy(data, (uint8_t*)data, 4);</code>."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1464162179, "post_id": 37430047, "comment_id": 62365393, "body": "@shamsalsham no, <code>speed=( uint32_t)data;</code> result to an assignment of pointer to integer. You will get at least a warning, and certainly an unexpected behavior"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1464162392, "post_id": 37430047, "comment_id": 62365510, "body": "Well, it would actually be <code>(uint32_t *) data</code>.  Except that will quite likely fail since it ignores alignment.  If you just want to alias the array to a <code>uint32_t</code>, then put it in a union."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1464173590, "post_id": 37430047, "comment_id": 62372915, "body": "Apparently, getting this right is hard even for intermediately experienced programmers. Just ignore all advise given in the above comments, most of it is incorrect or leads to non-portable code..."}], "answers": [{"comments": [{"owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "edited": false, "score": 0, "creation_date": 1464163795, "post_id": 37430478, "comment_id": 62366286, "body": "std::uint32_t is c++, isn&#39;t it... uint32_t alone looks more like C to me"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1464167318, "post_id": 37430478, "comment_id": 62368509, "body": "<code>speed = *((uint32_t *)data);</code> fails on platforms with sufficient alignment restrictions and also breaks strict aliasing rules (which means compiler can generate incorrect code). Never use it, use <code>memcpy</code> instead."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464168228, "post_id": 37430478, "comment_id": 62369176, "body": "Your answer has lots of poorly-defined behavior because you bit shift on signed integer types. This <code>speed = data[0] &lt;&lt; 24 + data[1] &lt;&lt; 16 + data[2] &lt;&lt; 8 + data[3];</code> is dangerous code, implicit promotions to <code>int</code> may cause havoc."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464168556, "post_id": 37430478, "comment_id": 62369421, "body": "@Lundin Does my edit correct errors you identified ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464168701, "post_id": 37430478, "comment_id": 62369519, "body": "@Garf365 No. You should never use bit shift signed integers, it is simple as that."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464169388, "post_id": 37430478, "comment_id": 62369998, "body": "Looks ok now, but I really don&#39;t see why you must mention the unsafe or non-portable methods. There is never a reason to use any of them."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464169599, "post_id": 37430478, "comment_id": 62370135, "body": "@Lundin I mention them because there are the starting point of question"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464170374, "post_id": 37430478, "comment_id": 62370708, "body": "The OP actually didn&#39;t mention them, it was just various confused people leaving very bad advise in comments to him."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464171171, "post_id": 37430478, "comment_id": 62371251, "body": "@Lundin edit according your comments, really thanks for every informations you give me!"}, {"owner": {"reputation": 1580, "user_id": 5979854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/006148a3926039507c4e2cc538bc47df?s=128&d=identicon&r=PG", "display_name": "Marcin Kajzler", "link": "https://stackoverflow.com/users/5979854/marcin-kajzler"}, "edited": false, "score": 0, "creation_date": 1464178129, "post_id": 37430478, "comment_id": 62376044, "body": "@Garf365 Your answer is full and right, but I have a little doubts: volatile suggests it has something to do with interface/data source which has defined endianess. With my experience in such a situation it is better to use functions from &lt;endian.h&gt; (be32toh or le32toh). Then it is gains more portability."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1464179038, "post_id": 37430478, "comment_id": 62376695, "body": "I don&#39;t know <code>&lt;endian.h&gt;</code> but it seams to be specific form Unix world. So I doubt it exists everywhere."}], "tags": [], "owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "is_accepted": false, "score": 6, "last_activity_date": 1464171065, "last_edit_date": 1495542708, "creation_date": 1464161323, "answer_id": 37430478, "question_id": 37430047, "link": "https://stackoverflow.com/questions/37430047/converting-bytes-array-to-integer/37430478#37430478", "title": "Converting bytes array to integer", "body": "<p>To be safe according endianess, portable and secure, you should recreate your data:</p>\n\n<pre><code>speed = ((uint32_t)data[0]) &lt;&lt; 24 \n      | ((uint32_t)data[1]) &lt;&lt; 16 \n      | ((uint32_t)data[2]) &lt;&lt; 8 \n      | ((uint32_t)data[3]);\n</code></pre>\n\n<p>or </p>\n\n<pre><code>speed = ((uint32_t)data[3]) &lt;&lt; 24 \n      | ((uint32_t)data[2]) &lt;&lt; 16 \n      | ((uint32_t)data[1]) &lt;&lt; 8 \n      | ((uint32_t)data[0]);\n</code></pre>\n\n<p>Choose solution according position of most significant byte</p>\n\n<hr>\n\n<p>You get an \"assignment to expression with array type\" error because you can't assign directly an array: <code>data=(uint8_t*)speed;</code> is totally forbidden in C, you definitively can't have an array for lvalue. You have to do inverse operation:</p>\n\n<pre><code>data[0] = (uint8_t)((speed &gt;&gt; 24) &amp; 0x00FF);\ndata[1] = (uint8_t)((speed &gt;&gt; 16) &amp; 0x00FF);\ndata[2] = (uint8_t)((speed &gt;&gt; 8) &amp; 0x00FF);\ndata[3] = (uint8_t)(speed &amp; 0x00FF);\n</code></pre>\n\n<p>or, according position of most significant byte:</p>\n\n<pre><code>data[3] = (uint8_t)((speed &gt;&gt; 24) &amp; 0x00FF);\ndata[2] = (uint8_t)((speed &gt;&gt; 16) &amp; 0x00FF);\ndata[1] = (uint8_t)((speed &gt;&gt; 8) &amp; 0x00FF);\ndata[0] = (uint8_t)(speed &amp; 0x00FF);\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>Don't use cast or <code>memcpy</code> as mention in commentaries and original answer: in addition of non portability issues, you will have security issues, according alignment restrictions and aliasing rules on some platform, compiler can generate incorrect code - thanks to user694733 | see <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">here</a> - thanks to Lundin</p>\n\n<pre><code>    speed = *((uint32_t *)data); // DANGEROUS NEVER USE IT\n    *((uint32_t *)data) = speed; // DANGEROUS NEVER USE IT\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464168736, "post_id": 37433057, "comment_id": 62369547, "body": "Please note that other present answers suggest dangerous methods that lead to bugs or that aren&#39;t portable. There&#39;s no reason why you should ever do anything except the above method. Forget about structs, unions, memcpy, addition, pointer conversions and other nonsense."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464169151, "post_id": 37433057, "comment_id": 62369824, "body": "(Though note that if <code>volatile</code> for some reason is important to preserve during the operation, the casts should use a volatile qualified type too)"}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1464169484, "post_id": 37433057, "comment_id": 62370063, "body": "For my personal culture, why addition is bad in this case in comparison of bit-or ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1464170237, "post_id": 37433057, "comment_id": 62370618, "body": "@Garf365 Because it doesn&#39;t express the intent. Bitwise OR is self-documenting code. It is true that addition and bitwise OR are equivalent, the compiler should hopefully not generate slower code because of addition. But addition could be confused with for example adding the value of the individual bytes and storing the result in a uint32_t. You shouldn&#39;t use it for the same reason as you shouldn&#39;t use <code>speed &#47; 256</code> instead of <code>speed &gt;&gt; 8</code>."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1464170595, "post_id": 37433057, "comment_id": 62370857, "body": "Ok, thanks :) I avoid to use &quot;tricks&quot; to optimize in place of compiler and I prefer explicit code. I will remember this"}, {"owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "edited": false, "score": 0, "creation_date": 1464177567, "post_id": 37433057, "comment_id": 62375650, "body": "@Lundin <i>&quot;...you just get an array type which can&#39;t be used in arithmetic&quot;</i>,is assignment an arithmetic operation or is that a typo?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "edited": false, "score": 0, "creation_date": 1464179344, "post_id": 37433057, "comment_id": 62376917, "body": "@bkVnet Well, there&#39;s really no such thing as arithmetic operations in C. The standard speaks of <i>arithmetic operands</i> or arithmetic types, which are all integer, bool and float types. Though I guess that sentence doesn&#39;t make sense, since the assignment operators work on other types than the arithmetic types. I&#39;ll edit."}, {"owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "edited": false, "score": 0, "creation_date": 1464180955, "post_id": 37433057, "comment_id": 62378257, "body": "@Ludin Thank you for the clarification, but i am still a little confused. for example,<code>*(data+1)</code> is performing a pointer arithmetic, from this my understanding was you can perform arithmetic using the name of an array(which in this context decays to a pointer value and is an arithmetic operand). May be i have the wrong understanding about this in C."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "edited": false, "score": 0, "creation_date": 1464184376, "post_id": 37433057, "comment_id": 62381010, "body": "@bkVnet Briefly: the rule of &quot;array decay&quot; (6.3.2.1/3) specifically says that: &quot;an expression that has type \u2018\u2018array of type\u2019\u2019 is converted to an expression with type \u2018\u2018pointer to type\u2019\u2019 that points to the initial element of the array object and is not an lvalue.&quot; The key here is that this isn&#39;t a &quot;lvalue&quot; so it cannot be used by the assignment operator. The result of the unary <code>*</code> is however a lvalue. Anyway, please ask a separate question about this, since it is not related to the topic in this post."}, {"owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "edited": false, "score": 0, "creation_date": 1464184644, "post_id": 37433057, "comment_id": 62381238, "body": "@Lundin Sorry if i took your time but i didn&#39;t think this was a separate question. I was just asking about the statement in your answer that says the array name can&#39;t be used in <i>&quot;any form of arithmetic&quot;</i>. Thanks anyway."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 5, "last_activity_date": 1464179369, "last_edit_date": 1464179369, "creation_date": 1464168718, "answer_id": 37433057, "question_id": 37430047, "link": "https://stackoverflow.com/questions/37430047/converting-bytes-array-to-integer/37433057#37433057", "title": "Converting bytes array to integer", "body": "<p>Your code doesn't work because during <code>data=(uint8_t*)speed;</code> you don't get a \"lvalue\" for data, you just get an array type which can't be used in assignment or any form of arithmetic. Similarly, <code>speed=( uint32_t)*data;</code> is a bug because that only gives you the first item in the array.</p>\n\n<p>The only correct way you should do this:</p>\n\n<pre><code>volatile uint8_t data[4] = {0x00 , 0x00, 0x00, 0x00};\nvolatile uint32_t speed;\n\nspeed = (uint32_t)data[0] &lt;&lt; 24 |\n        (uint32_t)data[1] &lt;&lt; 16 |\n        (uint32_t)data[2] &lt;&lt;  8 |\n        (uint32_t)data[3] &lt;&lt;  0;\n\nspeed=speed*10;\n\ndata[0] = (uint8_t) ((speed &gt;&gt; 24) &amp; 0xFFu);\ndata[1] = (uint8_t) ((speed &gt;&gt; 16) &amp; 0xFFu);\ndata[2] = (uint8_t) ((speed &gt;&gt;  8) &amp; 0xFFu);\ndata[3] = (uint8_t) ((speed &gt;&gt;  0) &amp; 0xFFu);\n</code></pre>\n\n<p>This is 100% portable and well-defined code. No implicit promotions take place. This code does not rely on endianess or other implementation-defined behavior. Why write code that does, when you can write code that doesn't?</p>\n"}], "owner": {"reputation": 35, "user_id": 6333920, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/555647ad664f5f7afc03ead2d5760d4d?s=128&d=identicon&r=PG&f=1", "display_name": "shams alsham", "link": "https://stackoverflow.com/users/6333920/shams-alsham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 0, "accepted_answer_id": 37433057, "answer_count": 2, "score": 2, "last_activity_date": 1464179369, "creation_date": 1464159999, "last_edit_date": 1464167893, "question_id": 37430047, "link": "https://stackoverflow.com/questions/37430047/converting-bytes-array-to-integer", "title": "Converting bytes array to integer", "body": "<p>I have a 4-byte array (data) of type <code>uint8_t</code>, which represents a speed data integer. I'm trying to cast this array to <code>uint32_t</code> integer (speed),  multiply this speed by 10 and then restore it back to the 4-byte array (data). The data format is clear in the code below.\nI always get the error: </p>\n\n<blockquote>\n  <p>\"assignment to expression with array type\"</p>\n</blockquote>\n\n<p>The code:</p>\n\n<pre><code>volatile uint8_t data[4] = {0x00 , 0x00, 0x00, 0x00};\nvolatile uint32_t speed;\nspeed=( uint32_t)*data;\nspeed=speed*10;\ndata=(uint8_t*)speed;\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "edited": false, "score": 2, "creation_date": 1464159648, "post_id": 37429911, "comment_id": 62363994, "body": "<code>data_array[size]</code> should really be <code>data_array[i]</code> and <code>i==size</code> you may want <code>i&lt;size</code>."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1464159774, "post_id": 37429911, "comment_id": 62364045, "body": "Side note: You should add a declaration of <code>count_even</code> before <code>main</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1464159800, "post_id": 37429911, "comment_id": 62364060, "body": "Your loop will never run. For example, when will <code>0 == 6</code> ever be true?"}, {"owner": {"reputation": 21, "user_id": 6379716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b19705583e65ea227bb962aa4e77ca9?s=128&d=identicon&r=PG&f=1", "display_name": "ImVeryStuupid", "link": "https://stackoverflow.com/users/6379716/imverystuupid"}, "reply_to_user": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "edited": false, "score": 0, "creation_date": 1464159839, "post_id": 37429911, "comment_id": 62364080, "body": "Thank you so much @bkVnet for your quick response. My code works perfectly now."}, {"owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "edited": false, "score": 1, "creation_date": 1464159900, "post_id": 37429911, "comment_id": 62364119, "body": "change the  for <code>(int i = 0; i == size; i++)</code> to 1 for <code>(int i = 0; i &lt; size; i++)</code> and <code>if (data_array[size] % 2 == 0)</code> to <code>if (data_array[i] % 2 == 0)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 5818, "user_id": 389222, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6e599629d5f058545c7ae84e7bdd3441?s=128&d=identicon&r=PG", "display_name": "Gilad Naaman", "link": "https://stackoverflow.com/users/389222/gilad-naaman"}, "is_accepted": false, "score": 2, "last_activity_date": 1464160044, "last_edit_date": 1464160044, "creation_date": 1464159841, "answer_id": 37429990, "question_id": 37429911, "link": "https://stackoverflow.com/questions/37429911/trying-to-write-a-program-that-counts-the-amount-of-even-numbers-in-an-array-and/37429990#37429990", "title": "Trying to write a program that counts the amount of even numbers in an array and returns the value", "body": "<p>The condition in your for loop is wrong. \nThe correct condition should say \"as long as the index is smaller than size\",  but yours say \"as long as the index equal to to size\".</p>\n\n<p>The condition should be <code>i &lt; size</code>. </p>\n\n<p>As for the result,  it seems like it should return 0 (for the non-working code),  not <code>size</code>. </p>\n\n<p>Also,  you are using <code>size</code> as an index,  when you should use <code>i</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "edited": false, "score": 2, "creation_date": 1464159993, "post_id": 37430009, "comment_id": 62364167, "body": "<code>i&lt;=size</code> might lead to access the memory out of array as i=0"}], "tags": [], "owner": {"reputation": 38, "user_id": 5430039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c1awq.jpg?s=128&g=1", "display_name": "rhysvo", "link": "https://stackoverflow.com/users/5430039/rhysvo"}, "is_accepted": false, "score": 0, "last_activity_date": 1464159896, "creation_date": 1464159896, "answer_id": 37430009, "question_id": 37429911, "link": "https://stackoverflow.com/questions/37429911/trying-to-write-a-program-that-counts-the-amount-of-even-numbers-in-an-array-and/37430009#37430009", "title": "Trying to write a program that counts the amount of even numbers in an array and returns the value", "body": "<p>In your count_even function, you are using the size attribute as the array index, when it should be i</p>\n\n<pre><code>int count_even(int* data_array, int size)\n{\n    int even_num = 0\n    for(int i = 0; i &lt;= size, ++i)\n    {\n        if(data_array[i] % 2 == 0) \n        {\n            even_num++;\n        }\n    }\n    return even_num;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1464163454, "creation_date": 1464163454, "answer_id": 37431199, "question_id": 37429911, "link": "https://stackoverflow.com/questions/37429911/trying-to-write-a-program-that-counts-the-amount-of-even-numbers-in-an-array-and/37431199#37431199", "title": "Trying to write a program that counts the amount of even numbers in an array and returns the value", "body": "<p>these two lines are the root of the problems in the code:</p>\n\n<pre><code>for (int i = 0; i == size; i++)\n{\n    if (data_array[size] % 2 == 0)\n</code></pre>\n\n<p>the <code>for()</code> statement, should be:</p>\n\n<pre><code> for (int i = 0; i &lt; size; i++)\n</code></pre>\n\n<p>so the loop exits when reaching the end of the array</p>\n\n<p>the <code>if()</code> statement is always looking at the same entry beyond the end of the array, This is undefined behaviour</p>\n\n<p>The <code>if()</code> statement should be:</p>\n\n<pre><code>if (data_array[i] % 2 == 0)\n</code></pre>\n\n<p>However, the modulo operator <code>&amp;</code> is not a good choice for negative numbers</p>\n\n<p>a better choice would be:</p>\n\n<pre><code>if ( !(data_array[i] &amp; 1 ) )\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6379716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b19705583e65ea227bb962aa4e77ca9?s=128&d=identicon&r=PG&f=1", "display_name": "ImVeryStuupid", "link": "https://stackoverflow.com/users/6379716/imverystuupid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1464163454, "creation_date": 1464159568, "question_id": 37429911, "link": "https://stackoverflow.com/questions/37429911/trying-to-write-a-program-that-counts-the-amount-of-even-numbers-in-an-array-and", "title": "Trying to write a program that counts the amount of even numbers in an array and returns the value", "body": "<p>I am trying to make a program that will count the number of even numbers in the provided arrays. When I run the program now, it will return the amount of numbers in the array, but not the amount of even numbers. For some reason my count_even function doesn't work. Can anyone help?   </p>\n\n<pre><code> #include &lt;stdio.h&gt;\n\nint main()\n{\n    int data_array_1[] = { 1, 3, 5, 7, 9, 11 };\n    int data_array_2[] = { 2, -4, 6, -8, 10, -12, 14, -16 };\n    int data_array_3[] = { 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0 };\n    int data_array_4[] = { 6, 2, 4, 5, 1, -9 };\n    int data_array_5[] = { 1, 3, 9, 23, 5, -2, 4 };\n\n    int result_1 = count_even(data_array_1, 6);\n\n    printf(\"data_array_1 has %d even numbers.\\n\", result_1);\n\n    int result_2 = count_even(data_array_2, 8);\n\n    printf(\"data_array_2 has %d even numbers.\\n\", result_2);\n\n    int result_3 = count_even(data_array_3, 11);\n\n    printf(\"data_array_3 has %d even numbers.\\n\", result_3);\n\n    int result_4 = count_even(data_array_4, 6);\n\n    printf(\"data_array_4 has %d even numbers.\\n\", result_4);\n\n    int result_5 = count_even(data_array_5, 7);\n\n    printf(\"data_array_5 has %d even numbers.\\n\", result_5);\n\n\n    return 0;\n}\n\nint count_even(int* data_array, int size)\n{\n    int even_num = 0;\n\n    for (int i = 0; i == size; i++)\n    {\n        if (data_array[size] % 2 == 0)\n        {\n            even_num++;\n        }\n    }\n\n    return even_num;\n}\n</code></pre>\n"}, {"tags": ["c", "xcode", "string", "data-files"], "comments": [{"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 1, "creation_date": 1464158170, "post_id": 37429451, "comment_id": 62363154, "body": "&quot;I want to open it in Xcode&quot;.  Are you <i>sure</i> that&#39;s what you want to do?  Where is the stacktrace which will help us determine where the problem is?"}], "answers": [{"comments": [{"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1464158657, "post_id": 37429509, "comment_id": 62363422, "body": "@Lundin It&#39;s a reasonable size to accommodate any file path and is the size of the POSIX <code>PATH_MAX</code> on most systems."}], "tags": [], "owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "is_accepted": false, "score": 1, "last_activity_date": 1464158256, "creation_date": 1464158256, "answer_id": 37429509, "question_id": 37429451, "link": "https://stackoverflow.com/questions/37429451/how-can-i-open-an-existing-file-in-xcode-in-c/37429509#37429509", "title": "How can I open an existing file in Xcode in C?", "body": "<p>The issue is <em>almost certainly</em> the size of the <code>new</code> character array as it does not have the capacity to hold the complete filename and will cause a stack overflow:</p>\n\n<pre><code>char new[40]=\"/Users/mahmoudhamra/Desktop/C language/\";\nstrcat(new, fileName);\n</code></pre>\n\n<p>Change the <code>40</code> to <code>1024</code>:</p>\n\n<pre><code>char new[1024] = ...;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "edited": false, "score": 1, "creation_date": 1464158645, "post_id": 37429561, "comment_id": 62363410, "body": "This is a good answer. Additionally, I think the OP will want to remove the quotes around &quot;new&quot; in the fopen call."}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1464159565, "post_id": 37429561, "comment_id": 62363943, "body": "That <code>strncpy()</code> call is broken as the copy length is the size of the destination buffer.  That cannot be right."}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1464159917, "post_id": 37429561, "comment_id": 62364131, "body": "It&#39;s still broken.  What happens when the copy accesses memory in the source buffer that is beyond the size of the source buffer?  Undefined I would say.  Also WRT <code>malloc()</code> and <code>strcpy()</code>; have you heard of <code>strdup()</code>?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1464160266, "post_id": 37429561, "comment_id": 62364332, "body": "@trojanfoe 1st) I&#39;m giving a solution for OP, not a solution for whatever. 128 chars are more than enough. 2nd) As I wrote: <i>If you want to learn something about dynamic allocation</i>. But, well, I add an example with <code>strdup</code>."}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1464160325, "post_id": 37429561, "comment_id": 62364358, "body": "But the solution is unsound.  I am not convinced you understand the issue with <code>strncpy()</code>."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1464161007, "post_id": 37429561, "comment_id": 62364750, "body": "@trojanfoe Probably I need some coffee. Buffer is zeroed. So <code>strncpy</code> copy at most <code>sizeof(path_and_file)-1</code> bytes of literal C-string. So the last byte will be left unchanged: &#39;\\0&#39;. After that, code has to take care about what happened with the <code>strncpy</code>: if it fails for length or there is no more space to add <code>filename</code> program must be killed... Am I wrong?"}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 1, "creation_date": 1464161098, "post_id": 37429561, "comment_id": 62364799, "body": "No actually you are right; apologies.  That is the correct use of <code>strncpy()</code>."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 3, "last_activity_date": 1464162359, "last_edit_date": 1464162359, "creation_date": 1464158387, "answer_id": 37429561, "question_id": 37429451, "link": "https://stackoverflow.com/questions/37429451/how-can-i-open-an-existing-file-in-xcode-in-c/37429561#37429561", "title": "How can I open an existing file in Xcode in C?", "body": "<p>First of all this</p>\n\n<pre><code>char new[40]=\"/Users/mahmoudhamra/Desktop/C language/\";\n</code></pre>\n\n<p>should be at least </p>\n\n<pre><code>char new[41]=\"/Users/mahmoudhamra/Desktop/C language/\";\n</code></pre>\n\n<p>to leave space for null terminator. A C-string is an array of chars with a null-terminator (<code>0x00</code>, <code>'\\0'</code>, <code>0</code>) as last char.</p>\n\n<p>Best would be:</p>\n\n<pre><code>char new[]=\"/Users/mahmoudhamra/Desktop/C language/\";\n</code></pre>\n\n<p>BTW your problem is that you have no space to add <code>filename</code> chars, so at least you should define it as</p>\n\n<pre><code>char path_and_file[128] = {0};\nstrncpy(path_and_file, \"/Users/mahmoudhamra/Desktop/C language/\", sizeof(path_and_file)-1);\n</code></pre>\n\n<p>If you want to learn something about dynamic allocation you can:</p>\n\n<pre><code>char *directory = \"/Users/mahmoudhamra/Desktop/C language/\";\nchar *path_and_file = malloc(strlen(directory)+1);\nif (path_and_file != NULL)\n{\n   strcpy(path_and_file, directory);\n\n   printf(\"enter file name: \");\n   scanf(\"%s\",fileName);\n\n   path_and_file = realloc(path_and_file,strlen(directory)+strlen(filename)+1);\n   if (path_and_file != NULL)\n   {\n      strcat(path_and_file, filename);\n\n      // YOUR STUFF\n\n   }\n}\n\n\nfree(path_and_file);\n</code></pre>\n\n<p>Another way with dynamic allocation is using strdup to create your first string:</p>\n\n<pre><code>char *path_and_file = strdup(\"/Users/mahmoudhamra/Desktop/C language/\");\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Last thing, as @visibleman pointed out, the call to <code>fopen</code> have to be changed to</p>\n\n<pre><code>inFile=fopen(new, \"r\");\n</code></pre>\n\n<p>or according to my examples:</p>\n\n<pre><code>inFile=fopen(path_and_file, \"r\");\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5637429, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/37c29e8f711c4ced52c78f683706e20b?s=128&d=identicon&r=PG", "display_name": "Mahmoud Hamra", "link": "https://stackoverflow.com/users/5637429/mahmoud-hamra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1464162359, "creation_date": 1464158075, "last_edit_date": 1464158172, "question_id": 37429451, "link": "https://stackoverflow.com/questions/37429451/how-can-i-open-an-existing-file-in-xcode-in-c", "title": "How can I open an existing file in Xcode in C?", "body": "<p>I have created a file called mahmoud.txt in the direceotry: <code>/Users/mahmoudhamra/Desktop/C language/</code></p>\n\n<p>I want to open it in Xcode.</p>\n\n<p>I created the directory and the name of the file into a string each. \nThen I concatenated the file name to the directory and tried to open it to read it but it always gives me an error: \"Thread 1: signal SIGBART\".</p>\n\n<p>Can someone help me please?\nHere is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\n\nint main(int argc, const char * argv[]) {\n\n\n    FILE *inFile;\n    char fileName[13];\n\n    printf(\"enter file name: \");\n    scanf(\"%s\",fileName);\n\n    char new[40]=\"/Users/mahmoudhamra/Desktop/C language/\";\n    strcat(new, fileName);\n\n    inFile=fopen(\"new\", \"r\");\n\n    if (inFile== NULL) {\n        printf(\"file %s was not opened!\\n\", fileName);\n        printf(\"check that the file exists!\\n\");\n        exit(1);\n\n\n    }\n    else\n        printf(\"the files has successfully been opened!\\n\");\n\n\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "clang", "abstract-syntax-tree", "llvm-clang", "matcher"], "answers": [{"tags": [], "owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "is_accepted": false, "score": 2, "last_activity_date": 1506486708, "creation_date": 1506486708, "answer_id": 46439552, "question_id": 37428862, "link": "https://stackoverflow.com/questions/37428862/using-clang-matchers-to-detect-sequence-of-patterns/46439552#46439552", "title": "Using clang matchers to detect sequence of patterns", "body": "<h1>Correct Answer</h1>\n\n<p>In reality traversing ASTs for sequence patterning (which is the basis of static analysis) is not really the correct approach because you DON'T know whether the statement <code>pattern1</code> is ACTUALLY going to happen before <code>pattern2</code> </p>\n\n<p>Consider </p>\n\n<pre class=\"lang-c prettyprint-override\"><code> int foo() {\n       int a = 0;\n       int *b;\n       int c = -1;\n       if(c &lt; 0) goto fixit;\n nowhat:\n       b = &amp;a;\n fixit: \n       c = *b;\n       goto nowhat;\n }\n</code></pre>\n\n<p>As you can see AST is not going to help here but CFG is the correct thing to use.</p>\n\n<h1>Somewhat of an answer using ASTs</h1>\n\n<p>If you look at the Traversal Matchers in AST (v6.0.0) they are, pretty much, hierarchical in nature. You are looking to extend the matching to look for siblings. </p>\n\n<p>Much of what I am about to get into assumes that you know how to implement a custom AST matcher. If not, it is explained rather nicely by Manu S\u00e1nchez in his <a href=\"https://manu343726.github.io/2017/02/11/writing-ast-matchers-for-libclang.html\" rel=\"nofollow noreferrer\" title=\"Writing AST Matchers for libclang\">Writing AST Matchers for <em>libclang</em></a> blog post.</p>\n\n<p>Not sure if he gets into <em>actually</em> writing a sibling matcher, but he comes very close to it, so start there and then you have to implement something akin to this:</p>\n\n<p>Let's say given the code:</p>\n\n<pre><code>  class P {}; class Q {}; class R {};\n</code></pre>\n\n<p>We want to be able to do something like:</p>\n\n<pre><code> (matcher = recordDecl(hasName(\"P\"), \\\n        hasNextSibling(recordDecl(hasName(\"R\"))))`\n</code></pre>\n\n<p>You can combine <code>matchesChild</code> and <code>matchesParent</code> in <code>AstMatchFinder</code> class and traverse the children of the parent of the current cursor (these would be the siblings :P). Read the footnotes as you would have to implement BoundCursors in order to avoid runaway recursion. </p>\n"}], "owner": {"reputation": 161, "user_id": 4187910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bZbERbo9PTo/AAAAAAAAAAI/AAAAAAAAAIk/mjE05-axs_I/photo.jpg?sz=128", "display_name": "Mehrnoosh EP", "link": "https://stackoverflow.com/users/4187910/mehrnoosh-ep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 3, "answer_count": 1, "score": 8, "last_activity_date": 1506486708, "creation_date": 1464155872, "question_id": 37428862, "link": "https://stackoverflow.com/questions/37428862/using-clang-matchers-to-detect-sequence-of-patterns", "title": "Using clang matchers to detect sequence of patterns", "body": "<p>Is it possible to use <a href=\"http://clang.llvm.org/docs/LibASTMatchersReference.html#traversal-matchers\">clang matchers</a> to identify sequence of patterns in a program?</p>\n\n<p>For example I need to find cases in which pattern1 happens before pattern2.</p>\n\n<p>For instance:</p>\n\n<p>Pattern1 = assigning a value to pointer P<br>\npattern2 = dereferencing pointer P</p>\n\n<p>I can identify cases that pattern1 and pattern2 happen in the code, but is it possible to specify an ordering? (say pattern1 has to happen before pattern2 and only match those cases) Thanks!</p>\n"}, {"tags": ["c", "winapi", "pipeline", "createprocess"], "comments": [{"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 0, "creation_date": 1464160177, "post_id": 37428779, "comment_id": 62364281, "body": "So you&#39;re saying <code>CreateProcess</code> fails? Then you should look into the error code returned by <code>GetLastError</code>. BTW, is it correct that you pass the <code>STARTUPINFO</code> of the calling process? Is this to pass the handles to stdin and stdout?"}, {"owner": {"reputation": 97, "user_id": 3637994, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/95129fa34f71d316f8849b0593c9ebf0?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen Tran", "link": "https://stackoverflow.com/users/3637994/nguyen-tran"}, "reply_to_user": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 0, "creation_date": 1464176795, "post_id": 37428779, "comment_id": 62375036, "body": "When I try debugging, the program always execute the chunk of code inside that if(!CreateProcess()) which is to print the error when it fails to create and exit the program."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 3637994, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/95129fa34f71d316f8849b0593c9ebf0?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen Tran", "link": "https://stackoverflow.com/users/3637994/nguyen-tran"}, "edited": false, "score": 0, "creation_date": 1464175904, "post_id": 37431112, "comment_id": 62374413, "body": "My source.exe is in the same folder as the Driver.c file. Is it the correct place for it to be in?"}, {"owner": {"reputation": 71, "user_id": 6376874, "user_type": "registered", "profile_image": "https://graph.facebook.com/1283027705058080/picture?type=large", "display_name": "Dima Kostenich", "link": "https://stackoverflow.com/users/6376874/dima-kostenich"}, "reply_to_user": {"reputation": 97, "user_id": 3637994, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/95129fa34f71d316f8849b0593c9ebf0?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen Tran", "link": "https://stackoverflow.com/users/3637994/nguyen-tran"}, "edited": false, "score": 0, "creation_date": 1464177059, "post_id": 37431112, "comment_id": 62375252, "body": "Nope. Your binary usually placed to Release or Debug folder (depending on which build config you are using). If you created your project with an option &quot;Create directory for solution&quot; turned on, then you&#39;ll see 2 different Release and 2 different Debug folders. You need the one located at upper layers of your directory structure. Anyway, just try to find exact location of your driver.exe file and put source.exe to this folder."}, {"owner": {"reputation": 71, "user_id": 6376874, "user_type": "registered", "profile_image": "https://graph.facebook.com/1283027705058080/picture?type=large", "display_name": "Dima Kostenich", "link": "https://stackoverflow.com/users/6376874/dima-kostenich"}, "reply_to_user": {"reputation": 97, "user_id": 3637994, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/95129fa34f71d316f8849b0593c9ebf0?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen Tran", "link": "https://stackoverflow.com/users/3637994/nguyen-tran"}, "edited": false, "score": 0, "creation_date": 1464180842, "post_id": 37431112, "comment_id": 62378164, "body": "Can you then provide error code from GetLastError()?"}, {"owner": {"reputation": 97, "user_id": 3637994, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/95129fa34f71d316f8849b0593c9ebf0?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen Tran", "link": "https://stackoverflow.com/users/3637994/nguyen-tran"}, "edited": false, "score": 0, "creation_date": 1464181565, "post_id": 37431112, "comment_id": 62378791, "body": "So i tried fprintf(stderr, &quot;Error creating child process: %d&quot;,GetLastError()); and it returned that value 2"}, {"owner": {"reputation": 71, "user_id": 6376874, "user_type": "registered", "profile_image": "https://graph.facebook.com/1283027705058080/picture?type=large", "display_name": "Dima Kostenich", "link": "https://stackoverflow.com/users/6376874/dima-kostenich"}, "reply_to_user": {"reputation": 97, "user_id": 3637994, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/95129fa34f71d316f8849b0593c9ebf0?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen Tran", "link": "https://stackoverflow.com/users/3637994/nguyen-tran"}, "edited": false, "score": 0, "creation_date": 1464182120, "post_id": 37431112, "comment_id": 62379247, "body": "error code 2 = ERROR_FILE_NOT_FOUND. Are you sure that source.exe is in the same folder as driver.exe? You can also hardcode the full path to source.exe, but in that case take a look first at how it should be formatted on <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682425(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MSDN CreateProcess page</a>"}, {"owner": {"reputation": 97, "user_id": 3637994, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/95129fa34f71d316f8849b0593c9ebf0?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen Tran", "link": "https://stackoverflow.com/users/3637994/nguyen-tran"}, "edited": false, "score": 0, "creation_date": 1464198150, "post_id": 37431112, "comment_id": 62390598, "body": "I have figure out why."}], "tags": [], "owner": {"reputation": 71, "user_id": 6376874, "user_type": "registered", "profile_image": "https://graph.facebook.com/1283027705058080/picture?type=large", "display_name": "Dima Kostenich", "link": "https://stackoverflow.com/users/6376874/dima-kostenich"}, "is_accepted": false, "score": 2, "last_activity_date": 1464163245, "creation_date": 1464163245, "answer_id": 37431112, "question_id": 37428779, "link": "https://stackoverflow.com/questions/37428779/create-process-and-anonymous-pipe/37431112#37431112", "title": "Create process and anonymous pipe", "body": "<p>The only problem I can see here is the possibility that Source.exe app is not located in the same directory where Driver.exe is located. I tried your code and it was the only case when CreateProcess failed.</p>\n"}, {"comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1464209844, "post_id": 37444219, "comment_id": 62396935, "body": "That is demonstrably not tire. The code in the question would not have compiled. This is what happens when you lost made up fake code. Shame on you. Switching to multi byte is the wrong way to go. It&#39;s 2016. Use Unicode already!"}, {"owner": {"reputation": 97, "user_id": 3637994, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/95129fa34f71d316f8849b0593c9ebf0?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen Tran", "link": "https://stackoverflow.com/users/3637994/nguyen-tran"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1464214173, "post_id": 37444219, "comment_id": 62398717, "body": "My code in the question does compiled. I looked up on some other questions here on stackoverflow that said Unicode character set is poorly supported in Win32 console and can&#39;t be displayed properly so it is best to avoid. So do you have any suggestion to do it in Unicode character set?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1464214358, "post_id": 37444219, "comment_id": 62398789, "body": "If that code compiles then Unicode is not defined. Unicode is supported by windows console."}], "tags": [], "owner": {"reputation": 97, "user_id": 3637994, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/95129fa34f71d316f8849b0593c9ebf0?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen Tran", "link": "https://stackoverflow.com/users/3637994/nguyen-tran"}, "is_accepted": false, "score": -1, "last_activity_date": 1464198124, "creation_date": 1464198124, "answer_id": 37444219, "question_id": 37428779, "link": "https://stackoverflow.com/questions/37428779/create-process-and-anonymous-pipe/37444219#37444219", "title": "Create process and anonymous pipe", "body": "<p>I have figure out why. My project's property was using the Unicode character set. When I switch to Multi-byte character set it works fine.</p>\n"}], "owner": {"reputation": 97, "user_id": 3637994, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/95129fa34f71d316f8849b0593c9ebf0?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen Tran", "link": "https://stackoverflow.com/users/3637994/nguyen-tran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1464804555, "creation_date": 1464155483, "last_edit_date": 1464804555, "question_id": 37428779, "link": "https://stackoverflow.com/questions/37428779/create-process-and-anonymous-pipe", "title": "Create process and anonymous pipe", "body": "<p>UPDATE Question: So I have been able to create the process and get the programs to compiled. However, I run into a new problem. When I try to pipe the Source program into the Filter program. It doesn't seem to feed in any input for the sink program. There are no error message. I have also test all of my standalone program using the pipe operator in Windows' cmd.</p>\n\n<p>I'm trying to do this small project to learn about anonymous pipe and create process. I created 3 small standalone programs called Source, Filter, and Sink. These 3 are already compiled and run fine. Here's the descriptions for the 3 standalone programs.</p>\n\n<p>Source:  obtains a source text-file filename from its commandline, opens the file,and reads and copies the file contents one character at a time directly to standard output(stdout). When the file has been copied, Source terminates (closing all of its open file handles).</p>\n\n<p>Filter program does not utilize any filename commandline parameters. Instead, Filter reads a text file from standard input (stdin) and writes to standard output (stdout) a copy of the input with all upper-case letters converted to lower-case. Filter specifically must be designed to read one character, convert it, output it, and then loop until the incoming data is finished.</p>\n\n<p>Sink program obtains a destination text-file filename from its commandline, opens the file for writing, and then reads characters one at a time from the standard input file (stdin) and writes each incoming character directly to the destination sink file. </p>\n\n<p>Next I'm driving a main driver program separately that creates 2 pipes and spawn 3 independent child with inputs and outputs configured to carry out the indicated concurrent execution and dataflow. Something like this:</p>\n\n<ul>\n<li><em>srcfile -> Source -> pipe1 -> Filter -> Pipe2 -> Sink -> destfile</em></li>\n</ul>\n\n<p>The driver program will requires 2 command line parameters:</p>\n\n<ul>\n<li><code>C:\\&gt; Driver.exe srcfile destfile</code></li>\n</ul>\n\n<p>where srcfile is an existing data text-file, and destfile is the filename of a new destination file that is to be created by the Sink application. </p>\n\n<p>Here's my code for the driver program. It's not finished yet. But I encountered a hiccup when trying to create a process for the Source program.</p>\n\n<p>UPDATED CODE:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;WinBase.h&gt;\n#include &lt;stdio.h&gt;\n\n\n#define DELAY_A_WHILE() {volatile long j; for(j = 1; j&lt; 10000; j++) ; } \n\nint main(int argc, char *argv[])\n{\n    HANDLE hPipeRead, hPipeWrite, hPipeRead2, hPipeWrite2;\n    STARTUPINFO StartupInfoSource;\n    STARTUPINFO StartupInfoFilter;\n    STARTUPINFO StartupInfoSink;\n    PROCESS_INFORMATION ProcInfoSource;\n    PROCESS_INFORMATION ProcInfoFilter;\n    PROCESS_INFORMATION ProcInfoSink;\n    SECURITY_ATTRIBUTES PipeAttributes;\n    SECURITY_ATTRIBUTES PipeAttributes2;\n    char cmdline[200];\n\n    PipeAttributes.nLength = sizeof(SECURITY_ATTRIBUTES);\n    PipeAttributes.lpSecurityDescriptor = NULL;     //ignore\n    PipeAttributes.bInheritHandle = TRUE;           //child can inherit\n\n    //Create first pipe\n    if (!CreatePipe(&amp;hPipeRead, &amp;hPipeWrite, &amp;PipeAttributes, 0)) {\n        fprintf(stderr, \"Error creating pipe: %d\\n\", GetLastError());\n        exit(1);\n    }\n\n    sprintf_s(cmdline, 200, \"Source.exe %s\", argv[1]);\n    printf(\"Create process: %s\\n\", cmdline);\n\n    GetStartupInfo(&amp;StartupInfoSource);\n    StartupInfoSource.dwFlags = StartupInfoSource.dwFlags | STARTF_USESTDHANDLES;\n\n\n    //Mapping\n    StartupInfoSource.hStdInput = GetStdHandle(STD_INPUT_HANDLE);\n    StartupInfoSource.hStdOutput = hPipeWrite;\n    StartupInfoSource.hStdError = GetStdHandle(STD_ERROR_HANDLE);\n\n    if (!CreateProcess(\n        NULL, cmdline, NULL, NULL,\n        TRUE,\n        CREATE_NEW_CONSOLE, NULL, NULL,\n        &amp;StartupInfoSource,\n        &amp;ProcInfoSource))\n    {\n        fprintf(stderr, \"Error creating child process: %d\",GetLastError());\n        exit(1);\n    }\n\n    CloseHandle(hPipeWrite);\n    CloseHandle(ProcInfoSource.hProcess);\n    CloseHandle(ProcInfoSource.hThread);\n\n    PipeAttributes2.nLength = sizeof(SECURITY_ATTRIBUTES);\n    PipeAttributes2.lpSecurityDescriptor = NULL;        //ignore\n    PipeAttributes2.bInheritHandle = TRUE;          //child can inherit\n    //Create Second Pipe\n    if (!CreatePipe(&amp;hPipeRead2, &amp;hPipeWrite2, &amp;PipeAttributes2, 0)) {\n        fprintf(stderr, \"Error creating pipe: %d\\n\", GetLastError());\n        exit(1);\n    } \n\n    GetStartupInfo(&amp;StartupInfoFilter);\n    StartupInfoFilter.dwFlags = StartupInfoFilter.dwFlags | STARTF_USESTDHANDLES;\n\n    //Mapping\n    StartupInfoFilter.hStdInput = hPipeRead;\n    StartupInfoFilter.hStdOutput = hPipeWrite2;\n    StartupInfoFilter.hStdError = GetStdHandle(STD_ERROR_HANDLE);\n\n    sprintf_s(cmdline, 200, \"Filter.exe\");\n    printf(\"Create process: %s\\n\", cmdline);\n\n    //Filter\n    GetStartupInfo(&amp;StartupInfoFilter);\n    if (!CreateProcess(\n        NULL, cmdline, NULL, NULL,\n        TRUE,\n        CREATE_NEW_CONSOLE, NULL, NULL,\n        &amp;StartupInfoFilter,\n        &amp;ProcInfoFilter))\n    {\n        fprintf(stderr, \"Error creating child process: %d\", GetLastError());\n        exit(1);\n    }\n//  int exitStatus;\n    //  GetExitCodeProcess(ProcInfoFilter.hProcess, &amp;exitStatus);\n    CloseHandle(hPipeRead);\n    CloseHandle(hPipeWrite2);\n    CloseHandle(ProcInfoFilter.hProcess);\n    CloseHandle(ProcInfoFilter.hThread);\n\n\n    GetStartupInfo(&amp;StartupInfoSink);\n    StartupInfoSink.dwFlags = StartupInfoSink.dwFlags | STARTF_USESTDHANDLES;\n\n\n\n    //Mapping\n    StartupInfoSink.hStdInput = hPipeRead2;\n    StartupInfoSink.hStdOutput = GetStdHandle(STD_OUTPUT_HANDLE);\n    StartupInfoSink.hStdError = GetStdHandle(STD_ERROR_HANDLE);\n\n    sprintf_s(cmdline, 200, \"Sink.exe %s\", argv[2]);\n    printf(\"Create process: %s\\n\", cmdline);\n\n    GetStartupInfo(&amp;StartupInfoSink);\n    if (!CreateProcess(\n        NULL, cmdline, NULL, NULL,\n        TRUE,\n        CREATE_NEW_CONSOLE, NULL, NULL,\n        &amp;StartupInfoSink,\n        &amp;ProcInfoSink))\n    {\n        fprintf(stderr, \"Error creating child process: %d\", GetLastError());\n        exit(1);\n    }\n\n    CloseHandle(hPipeRead2);\n    CloseHandle(ProcInfoSink.hProcess);\n    CloseHandle(ProcInfoSink.hThread);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>The program compiles fine. However, when it try to creates the Process, it always fails and exits. The <code>cmdline</code> value when it parse in is \"Source.exe test.txt\", which is exactly what I used to execute my standalone Source program. Can someone explain why my <code>CreateProcess</code> fail? Is it because I parse in the wrong parameter?</p>\n"}, {"tags": ["c", "multithreading", "mutex"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1464155405, "post_id": 37428482, "comment_id": 62361925, "body": "You need some mechanism to ensure <code>prod</code> gets executed first, then it can signal <code>cons</code> to print the value. ,, a <code>pthread_cond_t</code> conditional variable comes to mind. They are used for threads to signal each other when a specific condition is met (so <code>cons</code> can wait, <code>prod</code> can print then accept user input, after which it can signal <code>cons</code> to print the value then halt. After <code>cons</code> has printed it can signal <code>prod</code> to query the user again, etc). This is a good tutorial with examples: <a href=\"https://computing.llnl.gov/tutorials/pthreads/\" rel=\"nofollow noreferrer\">computing.llnl.gov/tutorials/pthreads</a>"}, {"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "edited": false, "score": 2, "creation_date": 1464155514, "post_id": 37428482, "comment_id": 62361969, "body": "Just note: <code>prod</code> and <code>cons</code> functions take no arguments. But they <a href=\"http://man7.org/linux/man-pages/man3/pthread_create.3.html\" rel=\"nofollow noreferrer\">should</a> take <code>void *</code>. It seems there should be a warning"}, {"owner": {"reputation": 951, "user_id": 6339395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93045a766ed5527e61c165a271cb4622?s=128&d=identicon&r=PG&f=1", "display_name": "The Philomath", "link": "https://stackoverflow.com/users/6339395/the-philomath"}, "edited": false, "score": 0, "creation_date": 1464156577, "post_id": 37428482, "comment_id": 62362373, "body": "You shouldn&#39;t do what you are trying to do here. For a mutex it is mentioned in Pthread manual that  <b>If a thread attempts to unlock a mutex that it has not locked or a mutex which is unlocked, undefined behavior results.</b> If you needs to achieve producer consumer synchronization you should use <code>pthread_cond_wait()</code>, <code>pthread_cond_signal()</code> ."}], "answers": [{"tags": [], "owner": {"reputation": 2104, "user_id": 4635537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad50ed18dff8aaff0ff427ea7b1067d?s=128&d=identicon&r=PG", "display_name": "sameerkn", "link": "https://stackoverflow.com/users/4635537/sameerkn"}, "is_accepted": false, "score": 1, "last_activity_date": 1464155573, "creation_date": 1464155573, "answer_id": 37428794, "question_id": 37428482, "link": "https://stackoverflow.com/questions/37428482/not-able-to-find-the-bug-in-my-multithreading-program/37428794#37428794", "title": "Not able to find the bug in my multithreading program?", "body": "<p>Logically, Producer code might run multiple time before Consumer gets a chance to run. In such case you might miss some entered values. You will require 2 mutex. <code>mutex_full</code> and <code>mutex_empty</code>.</p>\n\n<p>Initial values:  <code>mutex_full = NON_SIGNALED</code>   and   <code>mutex_empty = SIGNALED</code></p>\n\n<pre><code>Producer()\n{\nWait(mutex_empty);\n//produce code\nSignal(mutex_full);\n}\n\nConsumer()\n{\nWait(mutex_full);\n//consumer code\nSignal(mutex_empty);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 497, "user_id": 1812249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3d126f269c17f870e5378f38942b1e1d?s=128&d=identicon&r=PG&f=1", "display_name": "jigglypuff", "link": "https://stackoverflow.com/users/1812249/jigglypuff"}, "edited": false, "score": 0, "creation_date": 1464158667, "post_id": 37429061, "comment_id": 62363429, "body": "A semaphore is also a good alternative to a conditional variable."}, {"owner": {"reputation": 133, "user_id": 2503875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vkCF1.jpg?s=128&g=1", "display_name": "Ivan Dubynets", "link": "https://stackoverflow.com/users/2503875/ivan-dubynets"}, "reply_to_user": {"reputation": 497, "user_id": 1812249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3d126f269c17f870e5378f38942b1e1d?s=128&d=identicon&r=PG&f=1", "display_name": "jigglypuff", "link": "https://stackoverflow.com/users/1812249/jigglypuff"}, "edited": false, "score": 0, "creation_date": 1464184403, "post_id": 37429061, "comment_id": 62381035, "body": "@Martinn, I don&#39;t agree with you, especially for current question. Semaphore is a different synchronization object for different purposes. This one is good if you want to limit access to the some resources. For example you want allow 10 simultaneous threads to use some object."}, {"owner": {"reputation": 497, "user_id": 1812249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3d126f269c17f870e5378f38942b1e1d?s=128&d=identicon&r=PG&f=1", "display_name": "jigglypuff", "link": "https://stackoverflow.com/users/1812249/jigglypuff"}, "edited": false, "score": 0, "creation_date": 1464222760, "post_id": 37429061, "comment_id": 62401107, "body": "Yes they can both be used. But in this example I prefer semaphores. The producer can increment the semaphore for every new data it creates, which will signal the consumer to do one unit of consuming. This better matches the producer/consumer design pattern. Also what happens when the producer produces faster than the consumer can consume? From your source: It is a logical error to call pthread_cond_signal() before calling pthread_cond_wait(), which may occur in that case."}, {"owner": {"reputation": 133, "user_id": 2503875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vkCF1.jpg?s=128&g=1", "display_name": "Ivan Dubynets", "link": "https://stackoverflow.com/users/2503875/ivan-dubynets"}, "reply_to_user": {"reputation": 497, "user_id": 1812249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3d126f269c17f870e5378f38942b1e1d?s=128&d=identicon&r=PG&f=1", "display_name": "jigglypuff", "link": "https://stackoverflow.com/users/1812249/jigglypuff"}, "edited": false, "score": 0, "creation_date": 1464244874, "post_id": 37429061, "comment_id": 62407303, "body": "I still don&#39;t agree with you. Sorry, but your example is also wrong.. If producer will produce faster than consumer can process, you still will lose data, because there is only one variable which stores payload in example above. In general, the producer should put data to the queue and signal cond var each time after inserting new value. Consumer wake ups and processes <b>ALL</b> values in queue. when queue is become empty, he just waits for new signal."}], "tags": [], "owner": {"reputation": 133, "user_id": 2503875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vkCF1.jpg?s=128&g=1", "display_name": "Ivan Dubynets", "link": "https://stackoverflow.com/users/2503875/ivan-dubynets"}, "is_accepted": true, "score": 0, "last_activity_date": 1464156622, "creation_date": 1464156622, "answer_id": 37429061, "question_id": 37428482, "link": "https://stackoverflow.com/questions/37428482/not-able-to-find-the-bug-in-my-multithreading-program/37429061#37429061", "title": "Not able to find the bug in my multithreading program?", "body": "<p>I suggest to use conditional variable for such cases.</p>\n\n<p><a href=\"https://computing.llnl.gov/tutorials/pthreads/#ConVarOverview\" rel=\"nofollow\">https://computing.llnl.gov/tutorials/pthreads/#ConVarOverview</a></p>\n\n<p>This way is more efficient for your task. So that consumer should wait for some cond variable. When producer will get new data, he will notify condition variable and consumer will wake up to do some job with that data.</p>\n\n<p>The link above has pretty good explanation, but if you have questions, you are welcome</p>\n"}], "owner": {"reputation": 13, "user_id": 6349728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b791d20cf59ac0681b376217133d53d1?s=128&d=identicon&r=PG&f=1", "display_name": "Vikas Giridhar", "link": "https://stackoverflow.com/users/6349728/vikas-giridhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 37429061, "answer_count": 2, "score": 1, "last_activity_date": 1464165009, "creation_date": 1464154184, "last_edit_date": 1464165009, "question_id": 37428482, "link": "https://stackoverflow.com/questions/37428482/not-able-to-find-the-bug-in-my-multithreading-program", "title": "Not able to find the bug in my multithreading program?", "body": "<p>I have implemented a simple multithreading program, where producer access the global variable and fills it, after that consumner prints it.</p>\n\n<p>I have written the main like this  </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;pthread.h&gt;\n\nvoid *prod(void);\nvoid *cons(void);\n\nunsigned int my_var = 0;\n\npthread_mutex_t mut = PTHREAD_MUTEX_INITIALIZER;\n\nint main()\n{\n    pthread_t th1, th2;\n    int status;\n\n    status = pthread_create(&amp;th1, NULL, (void*)prod, NULL);\n    if(status)\n    {\n        printf(\"Error creating thread 1 : %d\\n\", status);\n        exit(-1);\n    }\n    status = pthread_create(&amp;th2, NULL, (void*)cons, NULL);\n    if(status)\n    {\n         printf(\"Error creating thread 2 : %d\\n\", status);\n         exit(-1);\n    }\n\n    pthread_join(th1, NULL);\n    pthread_join(th2, NULL);\n\n    return 0;\n}\n</code></pre>\n\n<p>my Producer function goes like this : </p>\n\n<pre><code>void *prod(void)\n{\n    while(1)\n    {\n        pthread_mutex_unlock(&amp;mut);\n        printf(\"Enter the value : \");\n        scanf(\"%d\", &amp;my_var);\n    }\n}\n</code></pre>\n\n<p>Consumer function is : </p>\n\n<pre><code>void *cons(void)\n{\n    while(1)\n    {\n        printf(\"The value entered was %d\\n\", my_var);\n        pthread_mutex_lock(&amp;mut);\n    }\n}\n</code></pre>\n\n<p>This program runs with exact output but pattern is different, like : </p>\n\n<pre><code>Enter the value : The value entered was 0\nThe value entered was 0\n45\nEnter the value : The value entered was 45\n85\nEnter the value : The value entered was 85\n12\nEnter the value : The value entered was 12\n67\nEnter the value : The value entered was 67\n49\nEnter the value : The value entered was 49\n</code></pre>\n\n<p>I am finding it difficult to rectify this logic as am new to threading concept.\nPlease help me out in resolving the issue.</p>\n\n<p>My Expected output : </p>\n\n<pre><code>Enter the value : 45\nThe value entered is 45\n.........................................\n</code></pre>\n\n<p>After some answer's and guidelines to use mutex_cond_var. I used them in the function like this : </p>\n\n<pre><code>void *prod(void)\n{\n    while(1)\n    {\n        printf(\"Enter the value : \");\n        scanf(\"%d\", &amp;my_var);\n        pthread_cond_signal(&amp;condition_var1);\n        pthread_mutex_unlock(&amp;mut);\n    }  \n}\n\nvoid *cons(void)\n{\n    while(1)\n    {\n        pthread_mutex_lock(&amp;mut);\n        pthread_cond_wait( &amp;condition_var1, &amp;mut );\n        printf(\"The value entered was %d\\n\", my_var);\n    }\n}\n</code></pre>\n\n<p>Resulted output : </p>\n\n<pre><code>Enter the value : 78\nEnter the value : The value entered was 78\n86\nEnter the value : 15\nEnter the value : The value entered was 15\n35\nEnter the value : 86\nEnter the value : The value entered was 86\n12\nEnter the value : 65\nEnter the value : The value entered was 65\n78\nEnter the value : 65\nEnter the value : The value entered was 65\n12\nEnter the value : 35\nEnter the value : The value entered was 35\n</code></pre>\n\n<p>Please guide me in cleaning the code to get the expected output.</p>\n"}, {"tags": ["c", "image-processing", "bitmap"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 6, "creation_date": 1464158624, "post_id": 37428380, "comment_id": 62363393, "body": "So many magic numbers... For the sake of your own sanity, use named constants!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1464159352, "post_id": 37428380, "comment_id": 62363848, "body": "Please use <i><code>unsigned</code></i> <code>char bitmap[1900]</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1464160044, "post_id": 37428380, "comment_id": 62364201, "body": "Why have you made a 4x1 bitmap when you need it 24x15? You&#39;ll need to write 3 bytes (each the same for a greyscale) of pixel data at each position in the array, which (effectively) is <code>array[height][width][3]</code>."}, {"owner": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464160221, "post_id": 37428380, "comment_id": 62364304, "body": "@WeatherVane Actually i made it 24x15 but the bmp created gives error that file damaged. But when i set it to 4x1 it runs perfectly. Dont know why."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1464160482, "post_id": 37428380, "comment_id": 62364453, "body": "Was that because the image size information is greater than can be held in 1 byte of the header? That field is <code>uint32_t</code>."}, {"owner": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464160767, "post_id": 37428380, "comment_id": 62364618, "body": "@WeatherVane Any solution for this. How can I do this ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1464161057, "post_id": 37428380, "comment_id": 62364771, "body": "<code>unsigned imagesize = height * width * 3; for(int i=0; i&lt;4; i++) { bitmap[34+i] = imagesize &amp; 255; imagesize &gt;&gt;= 8; }</code>. Note too that the array width only equals the image width when the image width is a multiple of 4 (which it is in this case), because the array width (its &quot;stride&quot;) must always be a multiple of 4 itself."}], "answers": [{"comments": [{"owner": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "edited": false, "score": 0, "creation_date": 1464371712, "post_id": 37486697, "comment_id": 62475564, "body": "I dont think that the code is working. Because first there are casting errors from void to uint32 or other. 2nd after removing  these errors the file is not generated. Can you check it. ?"}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "reply_to_user": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "edited": false, "score": 1, "creation_date": 1464377633, "post_id": 37486697, "comment_id": 62478483, "body": "It works fine with <code>gcc -std=c11 -Wall -Wextra -pedantic</code> on my Debian (with both <code>gcc-5</code> and <code>gcc-6</code>). So it should be fine with other standard compilers. Please be more specific about the errors."}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "reply_to_user": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "edited": false, "score": 1, "creation_date": 1464596467, "post_id": 37486697, "comment_id": 62534054, "body": "Does it still interest you? You did not answer my question : what kind of error did you encountered? I cannot help without details."}, {"owner": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "edited": false, "score": 0, "creation_date": 1464607772, "post_id": 37486697, "comment_id": 62540692, "body": "Sir @Boiethios I removed the errors. I provide the input file i,e a text file containing pattern and the output file i.e a bmp file But it just executes and close. Nothing happen."}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "reply_to_user": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "edited": false, "score": 0, "creation_date": 1464610751, "post_id": 37486697, "comment_id": 62542520, "body": "@MuhammadHashimShafiq What was the errors you removed?"}, {"owner": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "edited": false, "score": 0, "creation_date": 1464614665, "post_id": 37486697, "comment_id": 62544973, "body": "<code>bmp_header_t *header = static_cast&lt;bmp_header_t *&gt;(malloc(sizeof(_header)));</code>                                                                           <code>buff = static_cast&lt;char *&gt;(malloc(file_len + 1));</code>                               <code>datas-&gt;bitmap = static_cast&lt;uint8_t *&gt;(malloc(header-&gt;infos.img_size * sizeof(*datas-&gt;bitmap)));</code>   <b>These are the corrected lines. Code Block gives error to these lines. I Simple cast them from void to their respective data types</b>"}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "reply_to_user": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "edited": false, "score": 1, "creation_date": 1464616224, "post_id": 37486697, "comment_id": 62545903, "body": "@MuhammadHashimShafiq I guess you compiled it with a C++ compiler, because this is a C++ error. C accept implicit cast from void * to every pointer type. Compile C with C compiler, it will be better."}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "reply_to_user": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "edited": false, "score": 1, "creation_date": 1464629202, "post_id": 37486697, "comment_id": 62552418, "body": "@MuhammadHashimShafiq and if you do C++ code, please replace the C tag with C++ tag."}, {"owner": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "edited": false, "score": 0, "creation_date": 1464630477, "post_id": 37486697, "comment_id": 62552911, "body": "sir my mistake. I am compiling it with c++ compiler. I will check and let you know :) thanks alot for helping me :)"}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "reply_to_user": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "edited": false, "score": 0, "creation_date": 1464633595, "post_id": 37486697, "comment_id": 62554195, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/113349/discussion-between-boiethios-and-muhammad-hashim-shafiq\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "is_accepted": true, "score": 4, "last_activity_date": 1464361577, "last_edit_date": 1464361577, "creation_date": 1464361264, "answer_id": 37486697, "question_id": 37428380, "link": "https://stackoverflow.com/questions/37428380/reading-pattern-from-file-and-create-a-bmp-image-of-that-in-c/37486697#37486697", "title": "Reading pattern from file and create a bmp image of that in C", "body": "<p>Here is a working code. I do not check some case of error (input file badly formatted, for example). I put some commentaries, though the code itself is not difficult to understand.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;ctype.h&gt;\n\n#define BMP_ASSERT(condition, message) \\\n    do { \\\n        if (! (condition)) { \\\n            fprintf(stderr, __FILE__ \":%d: %s: Assertion `\" #condition \\\n                \"` failed.\\n\\t: %s\\n\", __LINE__, __func__, message); \\\n            exit(EXIT_FAILURE); \\\n        } \\\n    } while (false)\n\n#define BMP_COLORMAP_SIZE   10\n\n////////////////////////////////////////////////////////////////////////////////\n// STRUCTS\n\ntypedef struct __attribute__((__packed__))\nbmp_color \n{\n    uint8_t             r,\n                        g,\n                        b;\n    uint8_t             :8;\n}                       bmp_color_t;\n\ntypedef struct __attribute__((__packed__))\nbmp_header_infos\n{\n    uint32_t const      info_size;\n    uint32_t            width;\n    uint32_t            height;\n    uint16_t const      planes;\n    uint16_t const      bpp;\n    uint32_t const      compression;\n    uint32_t            img_size;\n    uint32_t const      horz_resolution;\n    uint32_t const      vert_resolution;\n    uint32_t const      n_colors;\n    uint32_t const      n_important_colors;\n}                       bmp_header_infos_t;\n\ntypedef struct __attribute__((__packed__))\nbmp_header\n{\n    /* Header */\n    char const          signature[2];\n    uint32_t            file_size;\n    uint32_t const      :32; // reserved\n    uint32_t const      img_offset;\n    /* Infos */\n    bmp_header_infos_t  infos;\n    /* Color map */\n    bmp_color_t         colormap[BMP_COLORMAP_SIZE];\n}                       bmp_header_t;\n\ntypedef struct          bmp_file_datas\n{\n    size_t              width;\n    size_t              height;\n    /* Bit map */\n    uint8_t             *bitmap;\n}                       bmp_file_datas_t;\n\n\n////////////////////////////////////////////////////////////////////////////////\n// FUNCTIONS\n\n/* Give a header with the right magic values */\nbmp_header_t *\nbmp_get_header(void)\n{\n    static bmp_header_t _header = {\n        {'B', 'M'},\n        0u,\n        sizeof(_header),\n        {   // struct info\n            sizeof(_header.infos),\n            0u, 0u, // width, height\n            1u,     // planes\n            8u,     // bpp\n            0u,     // no compression\n            0u,     // img size\n            0u, 0u, // resolution\n            BMP_COLORMAP_SIZE,\n            BMP_COLORMAP_SIZE,      // important colors\n        },\n        {{0u}}\n    };\n    bmp_header_t        *header = malloc(sizeof(_header));\n    size_t              i,\n                        color;\n\n    assert(header != NULL);\n    memcpy(header, &amp;_header, sizeof(*header));\n    // setting the scale of greys\n    for (i = 0 ; i &lt; BMP_COLORMAP_SIZE ; ++i)\n    {\n        color = (i * 255) / BMP_COLORMAP_SIZE;\n        header-&gt;colormap[i] = (bmp_color_t){color, color, color};\n    }\n    return header;\n}\n\n/* Take all the file content and store it in a buffer */\nchar *\nget_file_content(char const *filename)\n{\n    FILE        *file_handler = fopen(filename, \"r\");\n    size_t      file_len;\n    char        *buff;\n\n    BMP_ASSERT(file_handler != NULL, strerror(errno));\n    fseek(file_handler, 0, SEEK_END);\n    file_len = ftell(file_handler);\n    fseek(file_handler, 0, SEEK_SET);\n    buff = malloc(file_len + 1);\n    assert(buff != NULL);\n    fread(buff, file_len, 1, file_handler);\n    buff[file_len] = '\\0';\n    fclose(file_handler);\n    return buff;\n}\n\n/* Get the greatest multiple of 4 that is &gt;= size */\nstatic inline size_t\nmultiple_of_four(size_t size)\n{\n    while (size % 4)\n        ++size;\n    return size;\n}\n\n/* Get the informations from buffer: size of line, number of lines */\nvoid\nget_file_infos(char *buff, bmp_header_t *header, bmp_file_datas_t *datas)\n{\n    /* width &amp; height */\n    header-&gt;infos.width =  strchr(buff, '\\n') - buff;\n    header-&gt;infos.height = strlen(buff) / (header-&gt;infos.width + 1);\n                                            // + 1 for the terminating '\\n'\n    datas-&gt;width = multiple_of_four(header-&gt;infos.width);\n    datas-&gt;height = header-&gt;infos.height;\nprintf(\"File size: %u, %u\\n\", header-&gt;infos.width, header-&gt;infos.height);\n    /* image size &amp; bitmap allocation */\n    header-&gt;infos.img_size = datas-&gt;width * datas-&gt;height;\n    datas-&gt;bitmap = malloc(header-&gt;infos.img_size * sizeof(*datas-&gt;bitmap));\n    assert(datas-&gt;bitmap != NULL);\n    header-&gt;file_size = header-&gt;img_offset + header-&gt;infos.img_size;\n}\n\n/* Take the informations from the buffer and store them in the bitmap */\nvoid\nwrite_bitmap(char *buff, bmp_file_datas_t *datas)\n{\n    size_t          ibuff,\n                    iline = 0,\n                    ibitmap = 0;\n\n    for (ibuff = 0 ; buff[ibuff] ; ++ibuff)\n    {\n        if (isdigit(buff[ibuff]))\n        {\n            datas-&gt;bitmap[ibitmap] = BMP_COLORMAP_SIZE - 1 - (buff[ibuff] - '0');\n            ++ibitmap;\n        }\n        else if (buff[ibuff] == '\\n')\n        {\n            ++iline;\n            ibitmap = iline * datas-&gt;width;\n        }\n    }\n}\n\n/* Write the datas in the file: the header and the bitmap */\nvoid\nwrite_in_file(bmp_header_t *header,\n              bmp_file_datas_t *datas,\n              char const *filename)\n{\n    FILE        *file_handler = fopen(filename, \"w\");\n\n    BMP_ASSERT(file_handler != NULL, strerror(errno));\n    fwrite(header, sizeof(*header), 1, file_handler);\n    fwrite(datas-&gt;bitmap, header-&gt;infos.img_size, 1, file_handler);\n    fclose(file_handler);\n}\n\n\nint main(int argc, char **argv)\n{\n    char                *buff;\n    bmp_header_t        *header;\n    bmp_file_datas_t    datas;\n\n    if (argc != 3)\n    {\n        fprintf(stderr, \"Usage: %s &lt;input filename&gt; &lt;output filename&gt;\\n\",\n                                argv[0]);\n        return EXIT_FAILURE;\n    }\n    buff = get_file_content(argv[1]);\n    header = bmp_get_header();\n    get_file_infos(buff, header, &amp;datas);\n    write_bitmap(buff, &amp;datas);\n    write_in_file(header, &amp;datas, argv[2]);\n    free(buff), free(header), free(datas.bitmap);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "is_accepted": false, "score": 2, "last_activity_date": 1464594447, "last_edit_date": 1464594447, "creation_date": 1464591365, "answer_id": 37519395, "question_id": 37428380, "link": "https://stackoverflow.com/questions/37428380/reading-pattern-from-file-and-create-a-bmp-image-of-that-in-c/37519395#37519395", "title": "Reading pattern from file and create a bmp image of that in C", "body": "<p>A crude method to achieve the required functionality would be: (Not really C, but then it is your homework not mine)</p>\n\n<pre><code>WIDTH = 0, HEIGHT = 0\nif(LINE=READ_LINE(fin))\n  WIDTH = strlen(LINE)\n  ++HEIGHT\nelse\n  ERROR!!!\nPUSH(LINE)\nwhile(LINE=READ_LINE(fin))\n  if(WIDTH != strlen(LINE))\n    ERROR!!!\n  else\n    ++HEIGHT\n    PUSH(LINE)\nWRITE_BMP_HEADER(WIDTH, HEIGHT)\nfor(h = 0; h &lt; HEIGHT; ++h)\n  LINE = POP()\n  for(w = 0; w &lt; WIDTH; ++w)\n    COLOR = (LINE[w] - '0') * 255 / 9;\n    WRITE_BMP_COLOR(COLOR)\n  WRITE_BMP_PADDING(W)\n</code></pre>\n"}], "owner": {"reputation": 562, "user_id": 3164900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ts8qL.jpg?s=128&g=1", "display_name": "Muhammad Hashim Shafiq", "link": "https://stackoverflow.com/users/3164900/muhammad-hashim-shafiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1027, "favorite_count": 0, "accepted_answer_id": 37486697, "answer_count": 2, "score": 5, "last_activity_date": 1464594447, "creation_date": 1464153624, "last_edit_date": 1464428953, "question_id": 37428380, "link": "https://stackoverflow.com/questions/37428380/reading-pattern-from-file-and-create-a-bmp-image-of-that-in-c", "title": "Reading pattern from file and create a bmp image of that in C", "body": "<p>I want  to read an text file Using C Language.Here's the file:-</p>\n\n<p><a href=\"https://i.stack.imgur.com/am5Lj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/am5Lj.jpg\" alt=\"enter image description here\"></a> </p>\n\n<p>You see there is some pattern in the text content on the file.\n0 means nothing. 9 means black. so there is coloring scheme from 0 to 9.</p>\n\n<p>I have to create a bitmap image of this and the color are according to the values in the pattern. You have to adjust it with the 0-256 color scheme. \nAnd the final output for this is shown below</p>\n\n<p><a href=\"https://i.stack.imgur.com/I1rKy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I1rKy.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Now see the pattern in the content of the text file is opposite to the final output bitmap file (not necessary).  The darkness of the colors in bitmap image is according to the values in the pattern of the text content. </p>\n\n<blockquote>\n  <p>Anyone will tell me how I achieve this in C language.</p>\n</blockquote>\n\n<p>I am able to create a BMP file but not according to the pattern in text file.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n\nchar bitmap[1900];\n\n    // -- FILE HEADER -- //\n\n    // bitmap signature\n    bitmap[0] = 0x42;\n    bitmap[1] = 0x4d;\n\n    // file size\n    bitmap[2] = 58; // 40 + 14 + 12\n    bitmap[3] = 0;\n    bitmap[4] = 0;\n    bitmap[5] = 0;\n    int i=0;\n    // reserved field (in hex. 00 00 00 00)\n    for(i = 6; i &lt; 10; i++) bitmap[i] = 0;\n\n    // offset of pixel data inside the image\n    for(i = 10; i &lt; 14; i++) bitmap[i] = 0;\n\n    // -- BITMAP HEADER -- //\n\n    // header size\n    bitmap[14] = 40;\n    for(i = 15; i &lt; 18; i++) bitmap[i] = 0;\n\n    // width of the image\n    bitmap[18] = 4;\n    for(i = 19; i &lt; 22; i++) bitmap[i] = 0;\n\n    // height of the image\n    bitmap[22] = 1;\n    for(i = 23; i &lt; 26; i++) bitmap[i] = 0;\n\n    // reserved field\n    bitmap[26] = 1;\n    bitmap[27] = 0;\n\n    // number of bits per pixel\n    bitmap[28] = 24; // 3 byte\n    bitmap[29] = 0;\n\n    // compression method (no compression here)\n    for(i = 30; i &lt; 34; i++) bitmap[i] = 0;\n\n    // size of pixel data\n    bitmap[34] = 12; // 12 bits =&gt; 4 pixels\n    bitmap[35] = 0;\n    bitmap[36] = 0;\n    bitmap[37] = 0;\n\n    // horizontal resolution of the image - pixels per meter (2835)\n    bitmap[38] = 0;\n    bitmap[39] = 0;\n    bitmap[40] = 0b00110000;\n    bitmap[41] = 0b10110001;\n\n    // vertical resolution of the image - pixels per meter (2835)\n    bitmap[42] = 0;\n    bitmap[43] = 0;\n    bitmap[44] = 0b00110000;\n    bitmap[45] = 0b10110001;\n\n    // color pallette information\n    for(i = 46; i &lt; 50; i++) bitmap[i] = 0;\n\n    // number of important colors\n    for(i = 50; i &lt; 54; i++) bitmap[i] = 0;\n\n    // -- PIXEL DATA -- //\n    for(i = 54; i &lt; 66; i++) bitmap[i] = 255;\n\n\n    FILE *file;\n    file = fopen(\"bitmap.bmp\", \"w+\");\n    for(i = 0; i &lt; 66; i++)\n    {\n        fputc(bitmap[i], file);\n    }\n    fclose(file);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "pthreads", "posix"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1464150770, "post_id": 37427852, "comment_id": 62360333, "body": "What did you expect to happen? What actually happened?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1464151848, "post_id": 37427852, "comment_id": 62360652, "body": "Please report what you directly observe. &quot;Log mssages don&#39;t come out&quot; is good. &quot;Thread does not execute function&quot; is not so good, there&#39;s no easy way to verify this."}, {"owner": {"reputation": 22021, "user_id": 236222, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf4f3c341534395199d4dbe35a432f9d?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/236222/jay"}, "edited": false, "score": 0, "creation_date": 1464152297, "post_id": 37427852, "comment_id": 62360786, "body": "How do you know the function is getting executed? Add more printfs. Attach the process to gdb and add a break for your thread function and check."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 5, "creation_date": 1464153716, "post_id": 37427852, "comment_id": 62361252, "body": "Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. My guess is that the main thread is exiting without waiting for the child threads to complete. But since you have only shown partial code we cannot determine for sure."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1464157263, "post_id": 37427852, "comment_id": 62362688, "body": "Probably you have an <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">UB</a> with first called function in task: <code>listen(cpu-&gt;servidor,cpu-&gt;cantConexiones);</code> CPU points to a <code>malloc</code>-ated <b><i>not initialized</i></b> memory."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1464162753, "post_id": 37427852, "comment_id": 62365700, "body": "Since you oh so wisely decide to <code>pthread_create()</code> a detached thread, how does the main thread avoid exiting before the created thread has finished its work?"}, {"owner": {"reputation": 9, "user_id": 6379246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ccf56d24610d124cbc14eebd38968e0?s=128&d=identicon&r=PG&f=1", "display_name": "hernang94", "link": "https://stackoverflow.com/users/6379246/hernang94"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1464291486, "post_id": 37427852, "comment_id": 62437877, "body": "@EOF , that&#39;s the point, how the f*** can i do that? it&#39;s driving me crazy"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1464303563, "post_id": 37427852, "comment_id": 62443205, "body": "@hernang94: Theoretically, you can avoid <code>return</code>ing or <code>exit()</code>ing from <code>main()</code>, instead <code>pthread_exit()</code>ing in the main thread. Practically this is nonsense and you should do the sane thing and create joinable threads and <code>pthread_join()</code> with all threads before <code>return</code>ing or <code>exit()</code>ing from <code>main()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 0, "last_activity_date": 1464184317, "creation_date": 1464184317, "answer_id": 37439269, "question_id": 37427852, "link": "https://stackoverflow.com/questions/37427852/pthread-not-executing-function/37439269#37439269", "title": "Pthread not executing function", "body": "<p>To flush <code>stdout</code> (which is used by <code>printf()</code>) suffix each \"string\" by a new-line like this </p>\n\n<pre><code>   printf(\"estoy esperando CPUs\\n\");\n</code></pre>\n\n<p>Debug logging should go to <code>stderr</code> using <code>fprintf(stderr, ...)</code>. <code>stderr</code> isn't buffered as <code>stdout</code> is. </p>\n"}], "owner": {"reputation": 9, "user_id": 6379246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ccf56d24610d124cbc14eebd38968e0?s=128&d=identicon&r=PG&f=1", "display_name": "hernang94", "link": "https://stackoverflow.com/users/6379246/hernang94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1464184317, "creation_date": 1464150537, "last_edit_date": 1464155517, "question_id": 37427852, "link": "https://stackoverflow.com/questions/37427852/pthread-not-executing-function", "title": "Pthread not executing function", "body": "<p>i have been trying to figure out why a thread that i created in C, using pthread library is not executing the fucntion that pthread_create recieves.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>    void* escucharCPUs (void* arg){\n     t_Escucha* cpu= (t_Escucha*) arg; \n     listen(cpu-&gt;servidor,cpu-&gt;cantConexiones);\n     printf(\"estoy esperando CPUs\");\n     t_CPU* newCPU=malloc(sizeof(t_CPU));\n     while(1){\n      int cliente2 = recibirCliente(cpu-&gt;servidor);\n      printf(\"Recib\u00ed una conexi\u00f3n en %d!!\\n\", cliente2);\n      inicializarCPU(newCPU);\n      list_add(listaCPUs,newCPU);\n     }\n    }\n    //This is the function that pthread_create recieves.\n\n    typedef struct{\n     int servidor;\n     int cantConexiones;\n    }t_Escucha;\n\n    //This one above is an auxiliar function for networking, I put it as extra info.\n\n    //THIS GOES INSIDE THE MAIN\n    t_Escucha* CPU;\n    CPU=malloc(sizeof(t_Escucha));\n\n    //And, here is the thread creation\n    pthread_t hiloEscuchaCPUs;\n    pthread_attr_init(&amp;atributo);\n    pthread_attr_setdetachstate(&amp;atributo,PTHREAD_CREATE_DETACHED);\n    t2=pthread_create(&amp;hiloEscuchaCPUs,&amp;atributo,escucharCPUs,(void*)CPU);\n    //Is inside the main too\n</code></pre>\n\n<p>The result is, that the pthread_create acts like if it hasn't anything to do.</p>\n\n<p>We(My entire working team) dont know what is going wrong there.</p>\n\n<p>Anything that you propose will be helpful, Thank you!!</p>\n"}, {"tags": ["c", "loops", "calculator"], "comments": [{"owner": {"reputation": 2085, "user_id": 3273991, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e7616104c8d62b67175913d82ee68bc9?s=128&d=identicon&r=PG&f=1", "display_name": "Thirupathi Thangavel", "link": "https://stackoverflow.com/users/3273991/thirupathi-thangavel"}, "edited": false, "score": 1, "creation_date": 1464148054, "post_id": 37427415, "comment_id": 62359640, "body": "<code>change - 5000</code> to <code>change -= 5000</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1464148492, "post_id": 37427415, "comment_id": 62359750, "body": "And <code>nisen = 0;</code> --&gt; <code>nisen = 0; break;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1464165923, "post_id": 37427415, "comment_id": 62367623, "body": "for ease of readability and understanding: 1) please indent consistently.  Indent after every opening brace.  un-indent before every closing brace.  2) separate code blocks (for, if, else, while, do...while, switch, case, default) via a blank line.  3) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6379107, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74f10fa0e7a5628174bb25cf36187f9e?s=128&d=identicon&r=PG&f=1", "display_name": "rgolden", "link": "https://stackoverflow.com/users/6379107/rgolden"}, "edited": false, "score": 0, "creation_date": 1464149570, "post_id": 37427439, "comment_id": 62359997, "body": "Awesome. That fixed it! I should have seen that. Thanks"}, {"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "reply_to_user": {"reputation": 139, "user_id": 6379107, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74f10fa0e7a5628174bb25cf36187f9e?s=128&d=identicon&r=PG&f=1", "display_name": "rgolden", "link": "https://stackoverflow.com/users/6379107/rgolden"}, "edited": false, "score": 0, "creation_date": 1464149637, "post_id": 37427439, "comment_id": 62360024, "body": "Glad i could help."}], "tags": [], "owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "is_accepted": true, "score": 2, "last_activity_date": 1464147887, "creation_date": 1464147887, "answer_id": 37427439, "question_id": 37427415, "link": "https://stackoverflow.com/questions/37427415/change-calculation-program-in-c/37427439#37427439", "title": "Change Calculation Program in C", "body": "<pre><code>while (change &gt; 5000) //This is an infinite loop \n{\n    change - 5000; //no change is made to change\n    gosen++;\n}\n</code></pre>\n\n<p>You might want <code>change -= 5000;</code> instead of <code>change - 5000;</code>\nThis is at several places in your code.\n<code>change-=5000</code> is equivalent to</p>\n\n<pre><code> change = change-5000;\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 6379107, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74f10fa0e7a5628174bb25cf36187f9e?s=128&d=identicon&r=PG&f=1", "display_name": "rgolden", "link": "https://stackoverflow.com/users/6379107/rgolden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 37427439, "answer_count": 1, "score": 0, "last_activity_date": 1464147887, "creation_date": 1464147733, "question_id": 37427415, "link": "https://stackoverflow.com/questions/37427415/change-calculation-program-in-c", "title": "Change Calculation Program in C", "body": "<p>I'm just beginning studying programming and am trying to write a program that will display how many of each denomination of currency is required for any given amount of change.\nI'm studying in Japan, so the currency is yen, but I think the basic code is universal. I've seen other similar programs online, but mine has a few extra features which may be the cause of my problem, but I'm not sure.</p>\n\n<p>First the user inputs whether or not there are two-thousand yen bills in the register or not. (as these bills are not common).\nThen you enter the total amount due. Then enter how much was paid. it then calculates the change and how much of each denomination and then displays it.</p>\n\n<p>However, after you enter the amount paid, the cursor goes to the next line and just sits there indefinitely. I don't know what's causing this. My only guess is that it's getting stuck in a loop somewhere.</p>\n\n<p>Does anyone see a problem? (*I switched the text to be printed to English)</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    //\u5165\u529b\n    int aru;\n\n    printf(\"Are there 2-thousand yen bills in the register?\\n 1.) Yes\\n 2.) No\\n \"); //\u30ec\u30b8\u306b\uff12\u5343\u5186\u672d\u304c\u5165\u3063\u3066\u307e\u3059\u304b\uff1f\\n 1.) \u5165\u3063\u3066\u307e\u3059\\n 2.)\u5165\u3063\u3066\u307e\u305b\u3093\n    scanf(\"%d\", &amp;aru);\n\n    int total, paid;\n\n    printf(\"Enter Total Price  \");//\u304a\u4f1a\u8a08\u3092\u8a18\u5165\u3057\u3066\u4e0b\u3055\u3044\u3002\u3000\n    scanf(\"%d\", &amp;total);\n    printf(\"Enter Amount Paid \");//\u304a\u5ba2\u3055\u3093\u306e\u304a\u652f\u6255\u3063\u305f\u5408\u8a08\u3092\u8a18\u5165\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n    scanf(\"%d\", &amp;paid);\n\n    //\u8a08\u7b97\n    if (paid &lt; total)\n    {\n        printf(\"Insufficiant amount paid\\n\");//\u304a\u91d1\u3092\u5341\u5206\u306b\u3082\u3089\u3044\u307e\u305b\u3093\u3067\u3057\u305f\n    }\n    if (paid &gt; total)\n    {\n    int change = paid - total;\n    int ichi = 0, go = 0, ju = 0, goju = 0;\n    int hyaku = 0, gohyaku = 0, sen = 0, nisen = 0, gosen = 0;\n\n    while (change &gt; 5000)\n    {\n        change - 5000;\n        gosen++;\n    }\n    while (change &gt; 2000)\n    {\n        if (aru == 1)\n        {\n            change - 2000;\n            nisen++;\n        }\n        else\n        {\n            nisen = 0; //skips calculating 2000 yen bills if answer was 'no'\n        }\n    }\n    while (change &gt; 1000)\n    {\n        change - 1000;\n        sen++;\n    }\n    while (change &gt; 500)\n    {\n        change - 500;\n        gohyaku++;\n    }\n    while (change &gt; 100)\n    {\n        change - 100;\n        hyaku++;\n    }\n    while (change &gt; 50)\n    {\n        change - 50;\n        goju++;\n    }\n    while (change &gt; 10)\n    {\n        change - 10;\n        ju++;\n    }\n    while (change &gt; 1)\n    {\n        change - 1;\n        ichi++;\n    }\n\n    //\u51fa\u529b\n    printf(\" %d \\n\", gosen);\n    printf(\" %d \\n\", nisen);\n    printf(\" %d \\n\", sen);\n    printf(\" %d \\n\", gohyaku);\n    printf(\" %d \\n\", hyaku);\n    printf(\" %d \\n\", goju);\n    printf(\" %d \\n\", ju);\n    printf(\" %d \\n\", go);\n    printf(\" %d \\n\", ichi);\n}\n    return 0;\n} \n</code></pre>\n"}, {"tags": ["c", "pointers", "client", "user-defined-functions"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1464147681, "post_id": 37427394, "comment_id": 62359536, "body": "That line <b>doesn&#39;t</b> define <code>gattCharCfg_t</code>."}, {"owner": {"reputation": 19603, "user_id": 339843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/53a8a18baa2eda6e6758c3e522f77c24?s=128&d=identicon&r=PG", "display_name": "tofutim", "link": "https://stackoverflow.com/users/339843/tofutim"}, "edited": false, "score": 0, "creation_date": 1464147734, "post_id": 37427394, "comment_id": 62359553, "body": "Also, look for the place in the code where GATT_CCC_TBL( .. ) shows up"}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1464148125, "last_edit_date": 1464148125, "creation_date": 1464147766, "answer_id": 37427422, "question_id": 37427394, "link": "https://stackoverflow.com/questions/37427394/how-using-a-pointer-and-definition-from-a-define-in-c/37427422#37427422", "title": "How using a pointer and definition from a #define in C", "body": "<p>In the code there is no use of the macro <code>GATT_CCC_TBL</code><sup>1</sup> anywhere. The code is casting the return value of <code>ICall_malloc()</code> which presumably returns <code>void *</code><sup>2</sup> to a pointer of type <code>gattCharCfg_t</code><sup>3</sup>. If this is really <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> code that is actually not necessary and</p>\n\n<pre><code>voltDataConfig = ICall_malloc(sizeof(gattCharCfg_t) * linkDBNumConns)\n</code></pre>\n\n<p>and the better version would be</p>\n\n<pre><code>voltDataConfig = ICall_malloc(sizeof(*voltDataConfig) * linkDBNumConns)\n</code></pre>\n\n<p>would probably be correct.</p>\n\n<hr>\n\n<p><sup>1</sup><sub>Which is what <code>#define</code> defines actually.</sub><br>\n<sup>2</sup><sub>You never need to cast <code>void *</code> to another pointer type in <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a>.</sub><br>\n<sup>3</sup><sub>Note that <code>gattCharCfg_t</code> is actually a type defined somewhere with a <code>typedef</code>.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464194189, "post_id": 37427454, "comment_id": 62388412, "body": "&quot;<i>will take a pointer value <code>pValue</code> and turn it into a pointer to one or more gattCharCfg_t structures</i>&quot; I&#39;d say you miss one indirection here. It should read &quot;<i>will take a pointer value <code>pValue</code> and turn what it points to into a pointer to ...</i>&quot;. Note the <code>*</code> in <code>(*((PTR_TYPE)(pValue)))</code>."}, {"owner": {"reputation": 19603, "user_id": 339843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/53a8a18baa2eda6e6758c3e522f77c24?s=128&d=identicon&r=PG", "display_name": "tofutim", "link": "https://stackoverflow.com/users/339843/tofutim"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464200864, "post_id": 37427454, "comment_id": 62392122, "body": "@alk, I agree with that"}], "tags": [], "owner": {"reputation": 19603, "user_id": 339843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/53a8a18baa2eda6e6758c3e522f77c24?s=128&d=identicon&r=PG", "display_name": "tofutim", "link": "https://stackoverflow.com/users/339843/tofutim"}, "is_accepted": false, "score": 2, "last_activity_date": 1464200900, "last_edit_date": 1464200900, "creation_date": 1464147990, "answer_id": 37427454, "question_id": 37427394, "link": "https://stackoverflow.com/questions/37427394/how-using-a-pointer-and-definition-from-a-define-in-c/37427454#37427454", "title": "How using a pointer and definition from a #define in C", "body": "<pre><code>( (gattCharCfg_t *)(*((PTR_TYPE)(pValue))) )\n</code></pre>\n\n<ol>\n<li><code>(PTR_TYPE)(pValue)</code> - cast pValue as a PTR_TYPE (pointer)</li>\n<li><code>*((PTR_TYPE)(pValue))</code> - look at the memory location pointed to by the pointer</li>\n<li><code>(gattCharCfg_t *)(*((PTR_TYPE)(pValue)))</code> - for a pointer pointing to a <code>gattCharCfg_t</code> structure (could be an array of <code>gattCharCfg_t</code>) instead of void *</li>\n</ol>\n\n<p><code>GATT_CCC_TBL</code> is a macro to shortcut having to write out the conversion. With respect to the other code in your post, </p>\n\n<pre><code>  voltDataConfig = (gattCharCfg_t *)ICall_malloc(sizeof(gattCharCfg_t) *\n                                                    linkDBNumConns);\n</code></pre>\n\n<ol>\n<li><p><code>sizeof(gattCharCfg_t)</code> - take the size of <code>gattCharCfg_t</code>, e.g., 23 bytes</p></li>\n<li><p><code>* linkDBNumConns</code> - multiply it by linkDBNumConns, e.g., 100 making 2300 bytes</p></li>\n<li><p><code>ICall_malloc(..)</code> - allocate that much memory</p></li>\n<li><p><code>(gattCharCfg_t *)</code> - cast that location in memory as a pointer to <code>gattCharCfg_t</code> structures</p></li>\n</ol>\n\n<p><strong>Update.</strong> Looks like this code is from the Bluetooth stack, in which case</p>\n\n<pre><code>typedef struct\n{\n  uint16 connHandle; //!&lt; Client connection handle\n  uint8  value;      //!&lt; Characteristic configuration value for this client\n} gattCharCfg_t;\n</code></pre>\n\n<p>So <code>GATT_CCC_TBL( pValue )</code> will take a pointer value <code>pValue</code> and <em>turn what it points to</em> to one or more gattCharCfg_t structures - most likely an array of these since _TBL is likely \"table\". </p>\n"}], "owner": {"reputation": 83, "user_id": 2861029, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1cc403cd80de25cd0d96e0cf3c0905fa?s=128&d=identicon&r=PG&f=1", "display_name": "jSeesFor3ver", "link": "https://stackoverflow.com/users/2861029/jseesfor3ver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593969654, "creation_date": 1464147570, "last_edit_date": 1593969654, "question_id": 37427394, "link": "https://stackoverflow.com/questions/37427394/how-using-a-pointer-and-definition-from-a-define-in-c", "title": "How using a pointer and definition from a #define in C", "body": "<p>I was wondering exactly how the <code>gattCharCfg_t</code> within this defined snippet is being used.</p>\n\n<p>Here is the #define snipped:</p>\n\n<pre><code>    // Client Characteristic Configuration table (from CCC attribute value pointer)\n      #define GATT_CCC_TBL( pValue )           ( (gattCharCfg_t *)(*((PTR_TYPE)(pValue))) )\n</code></pre>\n\n<p>And here is how it is being accessed in a couple spots in the given code:</p>\n\n<pre><code>    // Characteristic Configuration: voltage\n    static gattCharCfg_t *voltDataConfig;\n\n      // Allocate Client Characteristic Configuration table\n  voltDataConfig = (gattCharCfg_t *)ICall_malloc(sizeof(gattCharCfg_t) *\n                                                    linkDBNumConns);\n    if (voltDataConfig == NULL)\n    {\n      return (bleMemAllocError);\n    }\n</code></pre>\n\n<p>I guess I am not understanding the mechanics of how it is being accessed. I would definitely appreciate a more thorough explanation as I am just diving back into c.</p>\n"}, {"tags": ["c", "gcc", "c11", "tr24731"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 3, "creation_date": 1464146812, "post_id": 37427267, "comment_id": 62359335, "body": "If you are learning, don&#39;t use non standard functions. Which OS is this?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1464148594, "post_id": 37427267, "comment_id": 62359776, "body": "Hey everyone.. if you haven&#39;t seen something before, it doesn&#39;t mean it is non-standard"}, {"owner": {"reputation": 4446, "user_id": 696485, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4de94e14f977802057b0109d079d95a1?s=128&d=identicon&r=PG", "display_name": "Iskar Jarak", "link": "https://stackoverflow.com/users/696485/iskar-jarak"}, "edited": false, "score": 1, "creation_date": 1464148920, "post_id": 37427267, "comment_id": 62359860, "body": "<code>scanf_s</code> and <code>printf_s</code> are MS specific prior to C11, I believe."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3794830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BHrdg.jpg?s=128&g=1", "display_name": "ThE411", "link": "https://stackoverflow.com/users/3794830/the411"}, "edited": false, "score": 0, "creation_date": 1464146994, "post_id": 37427295, "comment_id": 62359381, "body": "I know the _s is pretty unnecessary here, but the book is forcing me to use the _s for future reference. I still need to fix the error."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 35, "user_id": 3794830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BHrdg.jpg?s=128&g=1", "display_name": "ThE411", "link": "https://stackoverflow.com/users/3794830/the411"}, "edited": false, "score": 2, "creation_date": 1464147063, "post_id": 37427295, "comment_id": 62359396, "body": "Ok, read another book. You are likely using a compiler that expects standard code. Standard code SHOULD compile on any compiler while this variation the book is teaching you requires a specific compiler AFAIK, the MS C++ compiler (<i>it does compile <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> code but it does not differentiate between the languages I think</i>). If the book is forcing you to learn that it&#39;s IMHO not a good book. A good book would teach the basics and standards only. Giving you freedom to choose when you gain experience."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": -2, "last_activity_date": 1464147431, "last_edit_date": 1464147431, "creation_date": 1464146921, "answer_id": 37427295, "question_id": 37427267, "link": "https://stackoverflow.com/questions/37427267/getting-an-implicit-declaration-of-function-error-in-code-blocks/37427295#37427295", "title": "Getting an &quot;implicit declaration of function&quot; error in Code Blocks", "body": "<p>Standard function names have no <code>_s</code> so the standard compliant version of the program would be</p>\n\n<pre><code>#define __STDC_WANT_LIB_EXT1__ 1\n#include &lt;stdio.h&gt;\nint main(void)\n{\n  int age = 0;\n  char name[20];\n\n  printf(\"Enter your age: \");\n  scanf(\"%d\", &amp;age);\n\n  print(\"Enter your name: \");\n  scanf(\"%19s\", name);\n\n  printf(\"Your name is %s and you are %d years old.\\n\", name, age);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1155, "user_id": 5756174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a905ba32865388962bd9d78e11dff454?s=128&d=identicon&r=PG&f=1", "display_name": "jblixr", "link": "https://stackoverflow.com/users/5756174/jblixr"}, "is_accepted": false, "score": 3, "last_activity_date": 1464149504, "last_edit_date": 1464149504, "creation_date": 1464148548, "answer_id": 37427553, "question_id": 37427267, "link": "https://stackoverflow.com/questions/37427267/getting-an-implicit-declaration-of-function-error-in-code-blocks/37427553#37427553", "title": "Getting an &quot;implicit declaration of function&quot; error in Code Blocks", "body": "<p><code>printf_s</code> and <code>scanf_s</code> are only available if <code>__STDC_LIB_EXT1__</code> is defined by the library implementation. It is added since C11 standard.</p>\n\n<p>First you have to check <code>__STDC_LIB_EXT1__</code> is defined or not, then only you should use <code>printf_s</code> or <code>scanf_s</code>.</p>\n\n<pre><code>#define __STDC_WANT_LIB_EXT1__ 1\n#include &lt;stdio.h&gt;\nint main(void)\n{\n  int age = 0;\n  char name[20];\n  #ifdef __STDC_LIB_EXT1__\n      printf_s(\"Enter your age: \");\n      scanf_s(\"%d\", &amp;age);\n      print_s(\"Enter your name: \");\n      scanf_s(\"%s\", name, sizeof(name));\n      printf_s(\"Your name is %s and you are %d years old.\\n\", name, age);\n  #else\n      printf(\"Enter your age: \");\n      scanf(\"%d\", &amp;age);\n      print(\"Enter your name: \");\n      scanf(\"%19s\", name);\n      printf(\"Your name is %s and you are %d years old.\\n\", name, age);\n  #endif\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1464149572, "creation_date": 1464149572, "answer_id": 37427708, "question_id": 37427267, "link": "https://stackoverflow.com/questions/37427267/getting-an-implicit-declaration-of-function-error-in-code-blocks/37427708#37427708", "title": "Getting an &quot;implicit declaration of function&quot; error in Code Blocks", "body": "<p>The features you are using are \"optional\" according to the ISO C Standard. </p>\n\n<p>Apparently, the compiler/library bundled with Code::Blocks does not implement this option.  So your choices now are:</p>\n\n<ul>\n<li>Don't use the features</li>\n<li>Use a compiler which does implement this option</li>\n<li>Use conditional code as shown in jblixr's answer</li>\n</ul>\n\n<p>Also, you could log a feature request with MinGW (or MinGW-w64).</p>\n\n<p>Why does the C Standard include optional functions? Typically this is the result of political processes; one faction on the standards committee wanted the feature and another didn't, so the compromise is to make the feature optional.  Another example of this is variable-length arrays.</p>\n"}], "owner": {"reputation": 35, "user_id": 3794830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BHrdg.jpg?s=128&g=1", "display_name": "ThE411", "link": "https://stackoverflow.com/users/3794830/the411"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1203, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1524055245, "creation_date": 1464146759, "last_edit_date": 1524055245, "question_id": 37427267, "link": "https://stackoverflow.com/questions/37427267/getting-an-implicit-declaration-of-function-error-in-code-blocks", "title": "Getting an &quot;implicit declaration of function&quot; error in Code Blocks", "body": "<p>I am still quite new to C, and I keep getting an error in Code Blocks which stops me from running my programs. I get the error \"implicit declaration of functions printf_s() and scanf_s(). Here is my code:</p>\n\n<pre><code>#define __STDC_WANT_LIB_EXT1__ 1\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n  int age = 0;\n  char name[20];\n\n  printf_s(\"Enter your age: \");\n  scanf_s(\"%d\", &amp;age);\n\n  print_s(\"Enter your name: \");\n  scanf_s(\"%s\", name, sizeof(name));\n\n  printf_s(\"Your name is %s and you are %d years old.\\n\", name, age);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "debugging"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464145978, "post_id": 37427030, "comment_id": 62359174, "body": "<code>char input[][200];</code>, the compiler should complain"}, {"owner": {"reputation": 11, "user_id": 6362477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57294d273400154b7bf594fe6c531a2?s=128&d=identicon&r=PG&f=1", "display_name": "kar3154", "link": "https://stackoverflow.com/users/6362477/kar3154"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464146130, "post_id": 37427030, "comment_id": 62359210, "body": "It did complain but it still worked."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464146233, "post_id": 37427030, "comment_id": 62359231, "body": "Results of running any program with errors are meaningless. For example in your case you got a bunch of garbage output, but anything could have happened."}, {"owner": {"reputation": 11, "user_id": 6362477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57294d273400154b7bf594fe6c531a2?s=128&d=identicon&r=PG&f=1", "display_name": "kar3154", "link": "https://stackoverflow.com/users/6362477/kar3154"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464147593, "post_id": 37427030, "comment_id": 62359514, "body": "Ok I understand what you mean. I thought it would be ok because they were just warnings about that."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1464152156, "post_id": 37427030, "comment_id": 62360743, "body": "It might ne helpful to realize that C has neither strings (it has pointers to start of character strings with the first byte value 0 indicating end of string, with no regard for how much space there is for the string) nor arrays (it has pointers to raw memory buffers, with just enough of static typing glued on top so you can talk about array types). This important to realize for those C learners, who already know other languages which have strings and arrays."}], "answers": [{"tags": [], "owner": {"reputation": 806, "user_id": 4094323, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/897c0d37b948ec74767e9c401ff87200?s=128&d=identicon&r=PG&f=1", "display_name": "Sorikairo", "link": "https://stackoverflow.com/users/4094323/sorikairo"}, "is_accepted": false, "score": 1, "last_activity_date": 1464145967, "last_edit_date": 1464145967, "creation_date": 1464145523, "answer_id": 37427097, "question_id": 37427030, "link": "https://stackoverflow.com/questions/37427030/program-that-finds-every-other-character-in-the-first-half-of-a-char-array-in-c/37427097#37427097", "title": "Program that finds every other character in the first half of a char array in C", "body": "<p>The <code>&amp;</code> before a variable means that you are referring to the address of the variable, and not the variable value itself. If you don't know about what the address of a variable is : <a href=\"http://www.cquestions.com/2010/02/address-of-variable-in-c.html\" rel=\"nofollow\">http://www.cquestions.com/2010/02/address-of-variable-in-c.html</a></p>\n\n<p><code>char input[][200]</code> is an array of char array (a char array is vulgarized as a string but it ISN'T the TYPE).</p>\n\n<p>Your problem is about your <code>strcat</code> use, you're adding characters that are between <code>string[i]</code> (included) and <code>string[strLength]</code>, not only the <code>string[i]</code> character. </p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6362477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57294d273400154b7bf594fe6c531a2?s=128&d=identicon&r=PG&f=1", "display_name": "kar3154", "link": "https://stackoverflow.com/users/6362477/kar3154"}, "edited": false, "score": 0, "creation_date": 1464203942, "post_id": 37427549, "comment_id": 62393815, "body": "When I took out the &amp; I got an &quot;Incompatible integer to pointer conversion passing &#39;char&#39; to parameter of type &#39;const char*&#39;; take the adress with &amp;&quot;"}, {"owner": {"reputation": 55, "user_id": 4332517, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TdW515M2gbw/AAAAAAAAAAI/AAAAAAAAADE/9rkAVO-rmY0/photo.jpg?sz=128", "display_name": "Deepak S", "link": "https://stackoverflow.com/users/4332517/deepak-s"}, "reply_to_user": {"reputation": 11, "user_id": 6362477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57294d273400154b7bf594fe6c531a2?s=128&d=identicon&r=PG&f=1", "display_name": "kar3154", "link": "https://stackoverflow.com/users/6362477/kar3154"}, "edited": false, "score": 0, "creation_date": 1464232980, "post_id": 37427549, "comment_id": 62403356, "body": "strcat is used to append string and not single character. So, use the following link on how to append character to string: <a href=\"http://stackoverflow.com/questions/4834811/strcat-concat-a-char-onto-a-string\" title=\"strcat concat a char onto a string\">stackoverflow.com/questions/4834811/&hellip;</a> Try,  char temp[2]; temp[0] = string[i]; temp[1]=&#39;\\0&#39;; strcat(outputs,temp); This will work :)"}], "tags": [], "owner": {"reputation": 55, "user_id": 4332517, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TdW515M2gbw/AAAAAAAAAAI/AAAAAAAAADE/9rkAVO-rmY0/photo.jpg?sz=128", "display_name": "Deepak S", "link": "https://stackoverflow.com/users/4332517/deepak-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1464148539, "creation_date": 1464148539, "answer_id": 37427549, "question_id": 37427030, "link": "https://stackoverflow.com/questions/37427030/program-that-finds-every-other-character-in-the-first-half-of-a-char-array-in-c/37427549#37427549", "title": "Program that finds every other character in the first half of a char array in C", "body": "<p>Your problem is in strcat:</p>\n\n<p>Your code passes the address and hence you are getting the entire string from that character onward.</p>\n\n<pre><code>strcat(outputs,&amp;string[i]);\n</code></pre>\n\n<p>Now, change the above code as below:</p>\n\n<pre><code>strcat(output,string[i]);\n</code></pre>\n\n<p>You'll get the desired output. The problem with your initial code was that you were passing the address and not individual character. \nAlso, change the for loop in such a way that  \"&lt;\"number and not \"&lt;=\"number.\nLet me know if you have any more doubts.</p>\n"}], "owner": {"reputation": 11, "user_id": 6362477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57294d273400154b7bf594fe6c531a2?s=128&d=identicon&r=PG&f=1", "display_name": "kar3154", "link": "https://stackoverflow.com/users/6362477/kar3154"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464227992, "creation_date": 1464144923, "last_edit_date": 1464145888, "question_id": 37427030, "link": "https://stackoverflow.com/questions/37427030/program-that-finds-every-other-character-in-the-first-half-of-a-char-array-in-c", "title": "Program that finds every other character in the first half of a char array in C", "body": "<p>This is the first part of the program and I have a few questions on how parts of it work exactly. Keep in mind this is the first C program I have written. scanf(\"%d\",&amp;numberOfTimes); Why do I need the &amp; and what does it do?\nchar input[][200]; Is this basically an array of strings or is it something completely different?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nchar outputs[100];\nchar input[][200];\nint numberOfTimes;\n\nvoid io(void){\n    scanf(\"%d\", &amp;numberOfTimes);\n    for(int i = 0; i &lt; numberOfTimes; i++){\n        scanf(\"%s\",input[i]);\n    }\n}\n</code></pre>\n\n<p>This next part of the code is my attempt at actually solving the problem however I suspect that I screwed up the use of a function but I don't know which one or I used something improperly in order to get this result. (I provided example i/o of me code at the bottom). </p>\n\n<pre><code>void stringManipulation(char string[200]){\n    int strLength = strlen(string);\n    int number = strLength/2;\n    for(int i = 0; i &lt;= number; i=i+2){\n        strcat(outputs,&amp;string[i]);\n    }\n}\n\n\n\nint main(void) {\n    io();\n    for(int i = 0; i &lt; numberOfTimes; i++) {\n        stringManipulation(input[i]);\n        printf(\"%s\\n\",outputs);\n        memset(&amp;outputs[0], 0, sizeof(outputs));\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Did I use memset properly? Again I don't understand the use of the &amp;.</p>\n\n<p>Example input:</p>\n\n<pre><code>4\n\nyour\n\nprogress\n\nis\n\nnoticeable\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>y\n\npo\n\ni\n\nntc\n</code></pre>\n\n<p>Output I am getting:</p>\n\n<pre><code>yourur\n\nprogressogressress\n\nis\n\nnoticeableticeableceable\n</code></pre>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["c", "bash"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1464144715, "post_id": 37426941, "comment_id": 62358859, "body": "&quot;What happens?&quot; - you run the program <code>.&#47;cgi-bin&#47;smth</code>, with the zeroth argument being <code>.&#47;cgi-bin&#47;smth</code> and the first argument being <code>&gt; &#47;cgi-bin&#47;tmp</code>. Exactly what you asked to happen happens."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1464144831, "post_id": 37426941, "comment_id": 62358892, "body": "The shell does I/O redirection for you; if you&#39;re writing the &#39;shell&#39;, you&#39;ll have to do it for yourself.  The simplest fix is to use <code>system(&quot;.&#47;cgi-bin&#47;smth &gt; &#47;cgi-bin&#47;tmp&quot;);</code> (are you sure the file shouldn&#39;t be <code>.&#47;cgi-bin&#47;tmp</code>?).  Failing that, you have to open the file in your program and arrange for standard output to go to the file \u2014 using <code>dup2()</code>, <code>close()</code> and <code>open()</code>, not in that order."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1464145079, "post_id": 37426941, "comment_id": 62358954, "body": "Not honoring shell-style redirections, expansions, and other shell-specific magic is what makes directly calling <code>exec*</code>-family syscalls more secure than going through <code>system()</code> when handling untrusted data. If this behaved in any way other than what you describe here, writing secure software on UNIX would be next to impossible."}], "answers": [{"tags": [], "owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "is_accepted": true, "score": 1, "last_activity_date": 1464144482, "last_edit_date": 1495541767, "creation_date": 1464144482, "answer_id": 37426969, "question_id": 37426941, "link": "https://stackoverflow.com/questions/37426941/c-execlp-and/37426969#37426969", "title": "C: execlp() and &gt;", "body": "<p>You have to handle it yourself with <code>dup2</code> if using <code>execlp</code>. You can look at how I handle file out with <code>execvp</code> in comparison. I pass a flag for out redirection and then I handle it:</p>\n\n<pre><code>  if (structpipeline-&gt;option[0] == 1) { /* output redirection */    \n        int length = structpipeline[i].size;\n        char *filename = structpipeline-&gt;data[length - 1];\n        for (int k = length - 2; k &lt; length; k++)\n            structpipeline-&gt;data[k] = '\\0';    \n        fd[1] = open(filename, O_WRONLY | O_CREAT, 0666);\n        dup2(fd[1], STDOUT_FILENO);\n        close(fd[1]);\n    } /* TODO: input redirection */\n    execvp(structpipeline[i].data[0], structpipeline[i].data);\n</code></pre>\n\n<p>See also this question\n<a href=\"https://stackoverflow.com/questions/2605130/redirecting-exec-output-to-a-buffer-or-file\">Redirecting exec output to a buffer or file</a></p>\n"}], "owner": {"reputation": 744, "user_id": 2879539, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ewJnB.png?s=128&g=1", "display_name": "sooobus", "link": "https://stackoverflow.com/users/2879539/sooobus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 37426969, "answer_count": 1, "score": 1, "last_activity_date": 1464145355, "creation_date": 1464144192, "question_id": 37426941, "link": "https://stackoverflow.com/questions/37426941/c-execlp-and", "title": "C: execlp() and &gt;", "body": "<p>I want to run execlp() from C file and write the result to some output file.\nI use the line:</p>\n\n<pre><code>buff = \"./cgi-bin/smth\";\nexeclp(buff, buff, \"&gt; /cgi-bin/tmp\", NULL);\n</code></pre>\n\n<p>where smth is a compiled c script.\nBut smth prints to stdout, and no file appears.\nWhat happens, and how to put script result to an output file?</p>\n"}, {"tags": ["c", "file", "stdin", "c-strings"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1464143805, "post_id": 37426856, "comment_id": 62358679, "body": "You should not cast the return value of <code>malloc()</code> and it&#39;s not needed in <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a>. Don&#39;t use <code>sizeof(char)</code> because it adds nothing and it&#39;s always 1 and don&#39;t <code>malloc()</code> that since you can define an array for 200 chars, also read the file name with <code>fgets()</code> and drop the end line character."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1464166696, "post_id": 37426856, "comment_id": 62368111, "body": "when calling system function, like <code>malloc()</code>,    <code>read()</code>, always check the returned value to assure the operation was successful.  When displaying an error message, those error indication was returned from a call to a system function, display the error on <code>stderr</code>, along with your text and the system error message using: <code>perror( &quot;your text&quot; );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1464166755, "post_id": 37426856, "comment_id": 62368147, "body": "in modern <code>C</code>, when returning from the <code>main()</code> function, if the return value is 0 then no need for the <code>return</code> statement.."}], "answers": [{"comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464144899, "post_id": 37426907, "comment_id": 62358906, "body": "for the edge case (newline does not exist) if you want to use <code>read</code>, You need to use <code>calloc</code> instead of <code>malloc</code>. or Put a null-terminator in the number of characters read."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464145057, "post_id": 37426907, "comment_id": 62358949, "body": "@BLUEPIXY NO way! But I did forget to mention... No <code>calloc()</code> because it&#39;s precisely in this situation where it would hide a bug. It will unnecessarily initialize all bytes to <code>0</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1464147341, "post_id": 37426907, "comment_id": 62359446, "body": "Note that using <code>read()</code> has the advantage over <code>fgets()</code> that it tells you how many bytes were read (like <code>getline()</code> does, and unlike <code>fgets()</code>), so you can check probably for the newline by indexing rather than searching.  There&#39;s an edge case where you have managed to type several lines of input before the program gets going (or you redirected standard input from a regular file); then your long <code>read()</code> could include several newlines."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 5, "last_activity_date": 1464145549, "last_edit_date": 1464145549, "creation_date": 1464143978, "answer_id": 37426907, "question_id": 37426856, "link": "https://stackoverflow.com/questions/37426856/reading-a-file-from-stdin/37426907#37426907", "title": "Reading a file from stdin", "body": "<p>You must remove the <code>'\\n'</code> new line character that is being read and stored into the <code>filename</code> buffer.</p>\n\n<p>One of the many was to do it is include <code>string.h</code> and after reading the filename</p>\n\n<pre><code>char *newline = strchr(filename, '\\n');\nif (newline != NULL)\n    *newline = '\\0';\n</code></pre>\n\n<p>Also, use <code>fgets()</code> instead of <code>read()</code> because that way the program is more portable. And more importantly, <code>read()</code> will not add the <code>null</code> terminator which is very important in order to use the buffer as a string &mdash; <em>to pass it to <code>fopen()</code> for example</em> &mdash; correctly. If you want to use read try something like this</p>\n\n<pre><code>ssize_t length;\nchar filename[200];\nlength = read(STDIN_FILENO, filename, sizeof(filename) - 1);\nif (length &lt;= 0)\n    return -1; // No input or input error\nif (filename[length] == '\\n')\n    filename[--length] = '\\0';\nelse\n    filename[length] = '\\0';\n</code></pre>\n\n<p>But otherwise, try this which is simpler</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;string.h&gt;\n\nint main(void) \n{\n    FILE *file;\n    char filename[200];\n    char *newline;   \n\n    if (fgets(filename, sizeof(filename), stdin) == NULL)\n        return -1; // Input error / EOF\n    newline = strchr(filename, '\\n');\n    if (newline) // ? is a newline present?\n        *newline = '\\0';\n    printf(\"**%s**\\n\", filename); // ** will help checking for\n                                  //    the presence of white spaces.\n\n    file = fopen(filename, \"r\");\n    if (file) {\n        int chr;\n        while ((chr = fgetc(file)) != EOF)\n            fputc(chr, stdout);\n        fclose(file);\n    } else {\n        printf(\"File not found.\");\n    }\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 663, "user_id": 3670814, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/966b2739ab5fdb6131106180c7ff9d8b?s=128&d=identicon&r=PG&f=1", "display_name": "k1234", "link": "https://stackoverflow.com/users/3670814/k1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22647, "favorite_count": 0, "accepted_answer_id": 37426907, "answer_count": 1, "score": 5, "last_activity_date": 1464145549, "creation_date": 1464143658, "question_id": 37426856, "link": "https://stackoverflow.com/questions/37426856/reading-a-file-from-stdin", "title": "Reading a file from stdin", "body": "<p>It's been years since I programmed in C, and so I've been struggling a lot just to do a simply \"get filename &amp; path from stdin, read file, print file to stdout\" task, which I know shouldn't be that hard but ya. Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    int c;\n    FILE *file;\n    //scanf(\"%s\", filename);\n    char *filename;\n    filename = (char *)malloc(200 * sizeof(char));\n\n    read(STDIN_FILENO, filename, 200);\n\n\n    printf(\"%s\", filename);\n\n    file = fopen(filename, \"r\");\n\n    if (file) {\n        while ((c = getc(file)) != EOF)\n            putchar(c);\n        fclose(file);\n    } else {\n        printf(\"File not found.\");\n    }\n    printf(\"\\n\");\n\n    return(0);\n}\n</code></pre>\n\n<p>I my code continues to simply print out <code>File not found.</code>, when I know for a fact my file path and everything is correct (not only because I literally drop it and past it into terminal from my folder with Mac OSX El Capitan - what a lovely feature, but also) because I had a different version of this program using <code>scanf</code> which found the file and read it perfectly fine, (as you can see I have it commented out on my code). </p>\n\n<p>There is another program I'm writing that just uses this one, and I got rid of the <code>scanf</code> because I think it was negatively affecting other things in that program, so I want to be able to use <code>read()</code></p>\n\n<p>If anyone has any advice on how I can fix this or why this isn't working, that would be greatly appreciated as I've been at this for hours already and would very much like to move on to my <em>actual</em> program that I need to code! </p>\n\n<p>THANKS A BUNCH</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 0, "creation_date": 1464143819, "post_id": 37426848, "comment_id": 62358684, "body": "So what exactly is your error....? Also, you need to remove that semicolon after your ending brace."}, {"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 0, "creation_date": 1464144161, "post_id": 37426848, "comment_id": 62358758, "body": "I would look into using <code>fgets()</code> instead of <code>scanf()</code>, also you might want to specify a size for <code>%s</code> to prevent overflow, especially since your <code>Name</code> variable is so small. And <code>scanf()</code> takes a <code>pointer</code> to the variable where it will store stuff, so since <code>myInfo,Name</code> will decay into a pointer to the first element in that array, you&#39;re fine for that case, but <code>scanf(&quot;%d\\n&quot;, myInfo.Age);</code> must be changed to <code>scanf(&quot;%d\\n&quot;, &amp;myInfo.Age);</code>. I&#39;ve made the update in my edit, along with some other stuff to make your answer more technically correct."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1464144967, "post_id": 37426848, "comment_id": 62358921, "body": "So what is your question?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 1, "creation_date": 1464145103, "post_id": 37426848, "comment_id": 62358962, "body": "@Rasta: Your edit is invalid, and I&#39;ve voted to reject it. It is a violation of the policy here to substantially change the code in a question other than formatting, and you&#39;ve altered the meaning and intent of the code with your edit. Please stop making those sorts of changes; if you continue, your editing privileges will end up being suspended."}, {"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1464145275, "post_id": 37426848, "comment_id": 62359010, "body": "@KenWhite wait what exactly did I change I don&#39;t even remember now? I thought I just added the <code>&amp;</code> needed for the integer value for <code>scanf()</code>?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 1, "creation_date": 1464145412, "post_id": 37426848, "comment_id": 62359038, "body": "@Rasta: You made several changes to the code (including changing <i>main</i>), and <b>any</b> changes to the code other than formatting are against the guidelines here. Altering the code can hide or change the problem the poster is having. Even the edit of adding <code>&amp;</code> is invalid when editing a question. <b>No code changes other than formatting are permitted.</b>"}, {"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1464145506, "post_id": 37426848, "comment_id": 62359057, "body": "@KenWhite I see, I&#39;m sorry about that. So even removing a cast for return value for <code>malloc()</code> is wrong too? I apologize. To change gears a little bit, is it okay to pass a struct to a function as opposed to a pointer to that struct? Does it make a copy of it (if so, I didn&#39;t think &quot;pass by value&quot; was even remotely a thing in C)? I know when you pass arrays it really is using pointers automatically, but I really don&#39;t know the behavior with structs."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 1, "creation_date": 1464145560, "post_id": 37426848, "comment_id": 62359067, "body": "@Rasta: Yes, A change to <b>anything</b> other than formatting (and even those if the language is sensitive to formatting) are prohibited."}], "answers": [{"comments": [{"owner": {"reputation": 286, "user_id": 6332818, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f42b5028386ea1be306355aad44cb129?s=128&d=identicon&r=PG", "display_name": "miiworld2", "link": "https://stackoverflow.com/users/6332818/miiworld2"}, "edited": false, "score": 0, "creation_date": 1464148328, "post_id": 37427111, "comment_id": 62359703, "body": "Sadly we don&#39;t use fgets for this particular class. For challenge purposes. But I will keep this in mind for future references. Thx."}], "tags": [], "owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1464145594, "last_edit_date": 1495535641, "creation_date": 1464145594, "answer_id": 37427111, "question_id": 37426848, "link": "https://stackoverflow.com/questions/37426848/im-trying-to-create-a-program-with-a-loop-that-prompts-the-user-to-enter-data-i/37427111#37427111", "title": "I&#39;m trying to create a program with a loop that prompts the user to enter data in the array elements", "body": "<p>You can use <code>fgets</code> to read strings and cast the string to digits with <code>atoi</code>. The storage is not complete, but with my changes you can read to structs and specify the size of the loop (TODO: Save a list of structs so that you actually can print a list of structs that you have specified.)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Name_Age {\n    char Name[10];\n    int Age;\n};\n\nvoid printMe(struct Name_Age info) {\n    printf(\"Name: %s\\n\", info.Name);\n    printf(\"Age:  %d\\n\", info.Age);\n}\n\nint main() {\n    int size = 0, i = 0, j = 0;\n    struct Name_Age *array_ptr = malloc((size + 1) * sizeof(struct Name_Age));\n    struct Name_Age myInfo = *array_ptr;\n\n    printf(\"Enter size of array: \");\n    char tmp[10];\n    fgets(tmp, 10,stdin);\n    size = atoi(tmp);\n    for (i = 0; i &lt; size; ++i) {\n        printf(\"Enter Name: \");\n        fgets(myInfo.Name, 10,stdin);\n        printf(\"Enter Age: \");\n        fgets(tmp, 10,stdin);\n        myInfo.Age = atoi(tmp);\n    }\n\n    printMe(myInfo);\n    return 0;\n\n};\n</code></pre>\n\n<p><strong>Test</strong></p>\n\n<pre><code>$ ./a.out \nEnter size of array: 2\nEnter Name: Superman\nEnter Age: 25\nEnter Name: Batman\nEnter Age: 27\nName: Batman\n\nAge:  27\n</code></pre>\n\n<p>See also this question about fgets <a href=\"https://stackoverflow.com/questions/4374474/fgets-how-to-read-int\">fgets how to read int</a></p>\n"}, {"comments": [{"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 1, "creation_date": 1464145862, "post_id": 37427129, "comment_id": 62359143, "body": "Change <code>scanf(&quot;%s&quot;, &amp;array_ptr[i].Name);</code> to <code>scanf(&quot;%s&quot;, array_ptr[i].Name);</code>, it is incorrect otherwise because the name of the array is already decaying to a pointer. And also, don&#39;t cast the return value of <code>malloc()</code>, see <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc/605858#605858\">here</a>."}, {"owner": {"reputation": 354, "user_id": 4262814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513e68ba08dbe21e84479afe8007cbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Wenfeng", "link": "https://stackoverflow.com/users/4262814/wenfeng"}, "reply_to_user": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 1, "creation_date": 1464146758, "post_id": 37427129, "comment_id": 62359322, "body": "@RastaJedi maybe <code>scanf(&quot;%s&quot;, &amp;(array_ptr[i].Name))</code> is clearer, but not <code>scanf(&quot;%s&quot;, array_ptr[i].Name)</code>."}, {"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 1, "creation_date": 1464147093, "post_id": 37427129, "comment_id": 62359402, "body": "It&#39;s not a matter of what is clearer; it is <i>incorrect</i>, because using the name of an array already decays to a pointer to the first element, you are actually taking the memory address of the pointer to the first element. That is <b>not</b> what you want to be passing to <code>scanf()</code>. Actually, I think you are giving it a pointer to the entire array, and this is wrong because <code>%s</code> expects a <i>pointer to char</i>, i.e., <code>char *</code>, not a pointer to a character array.... (<code>char (*)[10]</code>): <code>warning: format &#39;%s&#39; expects argument of type &#39;char *&#39;, but argument 2 has type &#39;char (*)[10]&#39;</code>."}, {"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 1, "creation_date": 1464147377, "post_id": 37427129, "comment_id": 62359452, "body": "Within the very first 5 examples of any C tutorial/book, they tell you to use <code>&amp;</code> for <code>%d</code> for <code>scanf()</code>, but <b>NOT</b> for <code>%s</code>. Everyone knows that, and doing so is incorrect (see above); please do not suggest incorrect code to OP."}, {"owner": {"reputation": 286, "user_id": 6332818, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f42b5028386ea1be306355aad44cb129?s=128&d=identicon&r=PG", "display_name": "miiworld2", "link": "https://stackoverflow.com/users/6332818/miiworld2"}, "edited": false, "score": 0, "creation_date": 1464149029, "post_id": 37427129, "comment_id": 62359881, "body": "This works tremendously! Thank you both! I appreciate the feedback and the explanation :)"}, {"owner": {"reputation": 354, "user_id": 4262814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513e68ba08dbe21e84479afe8007cbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Wenfeng", "link": "https://stackoverflow.com/users/4262814/wenfeng"}, "reply_to_user": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 0, "creation_date": 1464150186, "post_id": 37427129, "comment_id": 62360160, "body": "@RastaJedi Yes, you&#39;re right, I didn&#39;t take enough care about it. I&#39;ve edited the post, thanks!"}, {"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 0, "creation_date": 1468886482, "post_id": 37427129, "comment_id": 64300670, "body": "@Wenfeng You&#39;re welcome and I&#39;m sorry if I came off sort of brash; that wasn&#39;t my intention :). And also +miiworld2 you are welcome :)."}], "tags": [], "owner": {"reputation": 354, "user_id": 4262814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513e68ba08dbe21e84479afe8007cbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Wenfeng", "link": "https://stackoverflow.com/users/4262814/wenfeng"}, "is_accepted": true, "score": 1, "last_activity_date": 1464150091, "last_edit_date": 1464150091, "creation_date": 1464145728, "answer_id": 37427129, "question_id": 37426848, "link": "https://stackoverflow.com/questions/37426848/im-trying-to-create-a-program-with-a-loop-that-prompts-the-user-to-enter-data-i/37427129#37427129", "title": "I&#39;m trying to create a program with a loop that prompts the user to enter data in the array elements", "body": "<p>First, <code>scanf(\"%d\", &amp;size)</code> replace <code>scanf(\"%d\\n\", size)</code>, put <code>&amp;size</code> instead of <code>size</code> as argument(You need an address), and put the <code>malloc</code> things after this line of code, because you need an exact <code>size</code> value before <code>malloc</code>. Same thing with all the <code>scanf</code> stuffs.</p>\n\n<p>As you want to print out all your input names and ages in order, I changed your code like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Name_Age\n{\n    char Name[10];\n    int Age;\n};\n\nvoid printMe(struct Name_Age *infoList, int size)\n{\n    int i;\n    for (i = size-1; i &gt;= 0; --i)\n    {\n        printf(\"Name: %s\\n\", infoList[i].Name);\n        printf(\"Age:  %d\\n\", infoList[i].Age);\n        printf(\"\\n\");\n    }\n}\n\nint main()\n{\n    int size, i;\n\n    printf(\"Enter size of array: \");\n    scanf(\"%d\", &amp;size);\n\n    struct Name_Age * array_ptr = (struct Name_Age*)malloc(size* sizeof(struct Name_Age));\n\n    for (i = 0; i &lt; size; ++i)\n    {\n        printf(\"Enter Name: \\n\");\n        scanf(\"%s\", array_ptr[i].Name);\n        printf(\"Enter Age: \\n\");\n        scanf(\"%d\", &amp;array_ptr[i].Age);\n    }\n\n    printMe(array_ptr, size);\n\n    return 0;\n}\n</code></pre>\n\n<p>Try to test and compare with your code, questions are welcome.</p>\n"}, {"comments": [{"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 1, "creation_date": 1464147629, "post_id": 37427280, "comment_id": 62359527, "body": "Definitely add some error checking and input validation. You wouldn&#39;t want someone to try to specify a negative number for <code>size</code> e.g...."}], "tags": [], "owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "is_accepted": false, "score": 1, "last_activity_date": 1464146817, "creation_date": 1464146817, "answer_id": 37427280, "question_id": 37426848, "link": "https://stackoverflow.com/questions/37426848/im-trying-to-create-a-program-with-a-loop-that-prompts-the-user-to-enter-data-i/37427280#37427280", "title": "I&#39;m trying to create a program with a loop that prompts the user to enter data in the array elements", "body": "<p>Obviously using <code>fgets()</code> is a much better approach, but making the fewest amount of changes as possible to your code and still achieving your result is the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Name_Age\n{\n    char Name[10];\n    int Age;\n};\n\nvoid printMe(struct Name_Age *info);\n\nint main(void)\n{\n    int size, i;\n    struct Name_Age *array_ptr;\n\n    printf(\"Enter size of array: \");\n    scanf(\"%d\", &amp;size);\n\n    array_ptr = malloc(size * sizeof *array_ptr);\n\n    for (i = 0; i &lt; size; ++i)\n    {\n            printf(\"Enter Name: \");\n            scanf(\" %s\", array_ptr[i].Name);\n            printf(\"Enter Age: \");\n            scanf(\"%d\", &amp;array_ptr[i].Age);\n            printf(\"\\n\");\n    }\n\n    for (i = 0; i &lt; size; ++i)\n            printMe(&amp;array_ptr[i]);\n\n    return 0;\n}\n\nvoid printMe(struct Name_Age *info)\n{\n    printf(\"Name: %s\\n\", info-&gt;Name);\n    printf(\"Age:  %d\\n\", info-&gt;Age);\n}\n</code></pre>\n\n<p>Note that passing the struct by pointer to the function should be faster, note that you don't need the <code>myInfo</code> struct; you can just directly modify the elements of the array. Note the space before <code>%s</code> in the <code>scanf()</code> line, this is to discard any whitespace (including <code>\\n</code>), this is done automatically for <code>%d</code> so it is only necessary for your strings (technically not the first iteration of the loop, but it doesn't fail if no whitespace is found). If you have any questions about why I made the changes I did, please feel free to comment on this answer!</p>\n"}, {"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 1, "last_activity_date": 1464147102, "creation_date": 1464147102, "answer_id": 37427326, "question_id": 37426848, "link": "https://stackoverflow.com/questions/37426848/im-trying-to-create-a-program-with-a-loop-that-prompts-the-user-to-enter-data-i/37427326#37427326", "title": "I&#39;m trying to create a program with a loop that prompts the user to enter data in the array elements", "body": "<p>example of fix</p>\n\n<pre><code>//struct Name_Age myInfo = *array_ptr;//Not necessary\n\nprintf(\"Enter size of array: \");\nscanf(\"%d\", &amp;size);//remove `\\n`, add `&amp;`\n\n//To ensure after the size has been determined\nstruct Name_Age * array_ptr = (struct Name_Age*)malloc(size * sizeof(struct Name_Age));//Cast is not necessary in C\n\nfor (i = 0; i &lt; size; ++i)\n{\n    printf(\"Enter Name: \\n\");\n    scanf(\"%s\", array_ptr[i].Name);//remove `\\n`\n    printf(\"Enter Age: \\n\");\n    scanf(\"%d\", &amp;array_ptr[i].Age);//need `&amp;`\n}\n\nfor (i = 0; i &lt; size; ++i)\n    printMe(array_ptr[i]);\n</code></pre>\n"}], "owner": {"reputation": 286, "user_id": 6332818, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f42b5028386ea1be306355aad44cb129?s=128&d=identicon&r=PG", "display_name": "miiworld2", "link": "https://stackoverflow.com/users/6332818/miiworld2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 37427129, "answer_count": 4, "score": 0, "last_activity_date": 1464150091, "creation_date": 1464143587, "question_id": 37426848, "link": "https://stackoverflow.com/questions/37426848/im-trying-to-create-a-program-with-a-loop-that-prompts-the-user-to-enter-data-i", "title": "I&#39;m trying to create a program with a loop that prompts the user to enter data in the array elements", "body": "<p>I'm trying to create a program with a loop that prompts the user to enter data in the array elements. And when the user no longer can enter data, print to screen the data entered in a last in, first out order.</p>\n\n<p>And this is my attempt...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct Name_Age\n{\n    char Name[10];\n    int Age;\n};\n\nvoid printMe(struct Name_Age info)\n{\n    printf(\"Name: %s\\n\", info.Name);\n    printf(\"Age:  %d\\n\", info.Age);\n}\n\nint main()\n{\n    int size = 0, i = 0, j = 0;\n    struct Name_Age * array_ptr = (struct Name_Age*)malloc((size + 1)* sizeof(struct Name_Age));\n    struct Name_Age myInfo = *array_ptr;\n\n    printf(\"Enter size of array: \");\n    scanf(\"%d\\n\", size);\n\n    for (i = 0; i &lt; size; ++i)\n    {\n        printf(\"Enter Name: \\n\");\n        scanf(\"%s\\n\", myInfo.Name);\n        printf(\"Enter Age: \\n\");\n        scanf(\"%d\\n\", myInfo.Age);\n    }\n\n    printMe(myInfo);\n\n    return 0;\n\n};\n</code></pre>\n"}, {"tags": ["c", "signals", "stdin"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1464147534, "post_id": 37426631, "comment_id": 62359494, "body": "Note <a href=\"http://stackoverflow.com/questions/16891019/\">How to avoid using <code>printf()</code> in a signal handler?</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464150513, "post_id": 37426631, "comment_id": 62360259, "body": "Note: In <code>nsh_signal_handler()</code>, set <code>char c = &#39;?&#39;;</code> or something to avoid printing an uninitialized value with <code>fprintf(stdout, &quot;I ... %c\\n&quot;, c);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1464146870, "post_id": 37426803, "comment_id": 62359351, "body": "Once there has been an error (such as getting an <code>EINTR</code>, as is happening here) EVERY call to getc will return EOF, and <code>ferror(stdin)</code> will be true, until you call <code>clearerr</code>.  So you need to put a call to <code>clearerr(stdin)</code> in the inner while loop before calling <code>getc</code>, or it will loop forever (appearing to hang)."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1464147708, "post_id": 37426803, "comment_id": 62359542, "body": "@Chris, actually I don&#39;t believe that&#39;s so. ISO (C11 7.21.7.1) only states that if the eof flag is set for the stream or it encounters eof, it will return EOF and set the eof flag. Otherwise it gets a character. It can <i>set</i> the error flag but it does not check it."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1464148403, "post_id": 37426803, "comment_id": 62359726, "body": "The C standard is completely silent about what happens on an error condition, leaving it implementation defined.  Most implementations treat it as persistent -- once the error flag is set, every call will return an error until it is cleared with <code>clearerr</code>."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1464149361, "post_id": 37426803, "comment_id": 62359949, "body": "@Chris: If Linux is one of those &quot;most implementations&quot; you discuss, you may want to test it :-) It recovers fine as is after the EINTR and continues to retrieve real input from the stream. The standard is quite explicit in the required behaviour - the <i>only</i> way for fgetc to fail without a preceding end-of-file is if &quot;a read error occurs&quot;, otherwise the next character is read. I suppose an implementation <i>could</i> define &quot;a read error occurs&quot; as including the case where a read error has previously occurred and not been cleared but that seems a bit of a stretch. However, I&#39;ll update to cover it."}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 2, "last_activity_date": 1464149746, "last_edit_date": 1464149746, "creation_date": 1464143119, "answer_id": 37426803, "question_id": 37426631, "link": "https://stackoverflow.com/questions/37426631/ctrl-signals-fills-stdin-with-eof/37426803#37426803", "title": "Ctrl signals fills stdin with EOF?", "body": "<p>The <code>getc</code> call will return <code>EOF</code> for either a true end of file <em>or an error condition.</em></p>\n\n<p>If you need to differentiate between the two, you can use <code>feof</code> or <code>ferror</code> to do so.</p>\n\n<p>For your particular case, you could simply replace:</p>\n\n<pre><code>while(c != EOF);\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>while ((c != EOF) || (! feof(stdin)));\n</code></pre>\n\n<p>Perhaps even better would be to avoid trying to output the character at all if it's one that was caught by the signal. You could do this by changing the loop to something like:</p>\n\n<pre><code>do {\n    c = getc(stdin);\n    while ((c == EOF) &amp;&amp; (!feof(stdin))) { // throw away CTRL-whatever.\n        //clearerr (stdin);\n        c = getc(stdin);\n    }\n    printf(\"[%c][%d]\\n\", c, c);            // print true characters and last EOF.\n}\nwhile (c != EOF);\n</code></pre>\n\n<p>You'll notice there's a call to <code>clearerr</code> commented out in the code above. If your implementation is one of those that will continuously supply an error indication until you clear the error flag (Linux is not one of those), you may want to uncomment it, especially since it shouldn't otherwise harm the flow of the code.</p>\n\n<p>I actually see that behaviour as a likely violation of the standard since it specifically states:</p>\n\n<blockquote>\n  <p>If the end-of-file indicator for the stream is set, or if the stream is at end-of-file, the endoffile indicator for the stream is set and the fgetc function returns EOF. <strong><em>Otherwise, the fgetc function returns the next character from the input stream pointed to by stream.</em></strong> If a read error occurs, the error indicator for the stream is set and the fgetc function returns EOF.</p>\n</blockquote>\n\n<p>In other words, <em>no</em> mention is made of a preceding error indicator preventing future reads. The only way I could see that being allowed is if the text \"a read error occurs\" included the event \"a read error has previously occurred and the error indicator has not been reset\", which seems a bit of a stretch to me.</p>\n"}, {"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 2, "last_activity_date": 1464147018, "creation_date": 1464147018, "answer_id": 37427310, "question_id": 37426631, "link": "https://stackoverflow.com/questions/37426631/ctrl-signals-fills-stdin-with-eof/37427310#37427310", "title": "Ctrl signals fills stdin with EOF?", "body": "<p>If you don't want to have to deal with errors on your read calls after handling the signal, you can set the <code>SA_RESTART</code> flag on the signal handler:</p>\n\n<pre><code>s.sa_flags = SA_RESTART;\n</code></pre>\n\n<p>which will result in the <code>getc</code> calls not getting interrupted with an <code>EINTR</code> error by the signal handler.</p>\n"}], "owner": {"reputation": 828, "user_id": 3058060, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/raWu5.png?s=128&g=1", "display_name": "ViniciusArruda", "link": "https://stackoverflow.com/users/3058060/viniciusarruda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 0, "accepted_answer_id": 37426803, "answer_count": 2, "score": 1, "last_activity_date": 1464149746, "creation_date": 1464141548, "last_edit_date": 1464142561, "question_id": 37426631, "link": "https://stackoverflow.com/questions/37426631/ctrl-signals-fills-stdin-with-eof", "title": "Ctrl signals fills stdin with EOF?", "body": "<p>I am doing a parser getting characters until <code>EOF</code>, I am handling the signals <code>SIGTERM</code>, <code>SIGINT</code>, <code>SIGTSTP</code> and <code>SIGQUIT</code>. So when I send a signal with <kbd>Ctrl</kbd>+<kbd>C</kbd> (<em>for example to</em> <code>SIGINT</code>) the signal handler prints <kbd>Ctrl</kbd>+<kbd>C</kbd> and then must continue, but is not continuing.</p>\n\n<p>I figured out that after each <kbd>Ctrl</kbd> signal, an <code>EOF</code> is filling the buffer, but I do not know how to get rid of it. I tried to do <code>while(getc(stdin) != EOF);</code> inside the handler, but the parser behave normally, \"eating\" every character typed until <code>EOF</code>.</p>\n\n<p>How can I receive a <kbd>Ctrl</kbd> signal without messing up my <code>stdin</code>?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n\nstatic void nsh_signal_handler(int code)\n{\n    char c;\n\n    switch(code)\n    {\n        case SIGQUIT: c = '\\\\'; break;\n    }\n\n    fprintf(stdout, \"I will do nothing about your Ctrl - %c\\n\", c);\n}\n\nint main(void)\n{\n    int c;\n    struct sigaction s;\n\n    s.sa_flags = 0;\n    s.sa_handler = nsh_signal_handler;\n    sigfillset(&amp;s.sa_mask);\n    sigaction(SIGQUIT, &amp;s, NULL);\n\n    do\n    {\n        c = getc(stdin);\n        printf(\"[%c][%d]\\n\", c, c);\n    }\n    while(c != EOF);\n\n    return 0;\n}\n</code></pre>\n\n<p>The code above show this error.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1464141463, "post_id": 37426579, "comment_id": 62358232, "body": "More context is needed. See <a href=\"http://stackoverflow.com/help/mcve\">Minimal Complete Verifiable Example</a>."}, {"owner": {"reputation": 1788, "user_id": 403367, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b3a5c1fc1e8d3cf913b695d7422e2cd?s=128&d=identicon&r=PG", "display_name": "PJ.Hades", "link": "https://stackoverflow.com/users/403367/pj-hades"}, "edited": false, "score": 1, "creation_date": 1464141484, "post_id": 37426579, "comment_id": 62358237, "body": "What&#39;s the definition of <code>AI_FileHeader</code>?"}, {"owner": {"reputation": 127, "user_id": 5776019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac4f3cd7019758079652a56db5c24cda?s=128&d=identicon&r=PG&f=1", "display_name": "Dizzzyp", "link": "https://stackoverflow.com/users/5776019/dizzzyp"}, "edited": false, "score": 0, "creation_date": 1464141593, "post_id": 37426579, "comment_id": 62358258, "body": "typedef struct {     int file_size;     int section_table_offset;      int section_count; } AI_FileHeader;"}, {"owner": {"reputation": 427, "user_id": 5450328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ikz0V.jpg?s=128&g=1", "display_name": "Mr. Branch", "link": "https://stackoverflow.com/users/5450328/mr-branch"}, "edited": false, "score": 1, "creation_date": 1464141705, "post_id": 37426579, "comment_id": 62358280, "body": "Fread prototype is as following size_t fread ( void * ptr, size_t size, size_t count, FILE * stream ); You&#39;re passing a datatype as the destination for the bytes read from the file to be stored"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 5, "creation_date": 1464141820, "post_id": 37426579, "comment_id": 62358310, "body": "<code>AI_FileHeader</code> is a type and not an actual variable. So you can&#39;t use that in <code>fread</code>. Try: <code>AI_FileHeader header; fread(&amp;header, sizeof(header) ,1 , infile);</code>"}, {"owner": {"reputation": 127, "user_id": 5776019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac4f3cd7019758079652a56db5c24cda?s=128&d=identicon&r=PG&f=1", "display_name": "Dizzzyp", "link": "https://stackoverflow.com/users/5776019/dizzzyp"}, "edited": false, "score": 0, "creation_date": 1464141912, "post_id": 37426579, "comment_id": 62358322, "body": "That works! Thank you"}], "owner": {"reputation": 127, "user_id": 5776019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac4f3cd7019758079652a56db5c24cda?s=128&d=identicon&r=PG&f=1", "display_name": "Dizzzyp", "link": "https://stackoverflow.com/users/5776019/dizzzyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1002, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464142039, "creation_date": 1464141122, "last_edit_date": 1464142039, "question_id": 37426579, "link": "https://stackoverflow.com/questions/37426579/using-fread-on-binary-file-into-a-struct-in-c", "title": "Using fread on binary file into a struct in C", "body": "<p>Infile is a .bin file and AI_FileHeader is a struct with 3 ints and I keep getting the error <strong>error: expected expression before \u2018AI_FileHeader\u2019</strong></p>\n\n<pre><code>fread(AI_FileHeader, sizeof(AI_FileHeader) ,1 , infile);\n</code></pre>\n\n<p>I've tried it with &amp;. But I get the same error.</p>\n\n<pre><code>fread(&amp;AI_FileHeader, sizeof(AI_FileHeader), 1, infile);\n\n\n\n\ntypedef struct {\n   int file_size;\n   int section_table_offset; \n   int section_count;\n} AI_FileHeader;\n</code></pre>\n\n<p><em>Solved</em></p>\n\n<pre><code>AI_FileHeader head;\n\nfread(&amp;head, sizeof(AI_FileHeader), 1,infile);\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 8, "creation_date": 1464141163, "post_id": 37426558, "comment_id": 62358177, "body": "500*500*4 = 1 megabyte. On some systems, that will exceed the maximum stack size. Either move the declaration of <code>array</code> outside of <code>main</code> (i.e. make it a global), or declare it with the <code>static</code> keyword, or allocate it on the heap with <code>malloc</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464142960, "post_id": 37426558, "comment_id": 62358522, "body": "There is a regularity in the numerical value on the diagonal do not need to use such large array."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464145935, "post_id": 37426558, "comment_id": 62359163, "body": "Your code accesses out of bounds too, e.g. <code>p</code> is <code>250</code>, and when <code>n</code> is also <code>250</code> then <code>array[...][p+n]</code> is <code>array[...][500]</code> which is OOB since 500 is the array dimension"}], "answers": [{"comments": [{"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 0, "creation_date": 1464143618, "post_id": 37426647, "comment_id": 62358641, "body": "There&#39;s no need to have <code>num</code> be global. Also, <code>const</code> variables in C aren&#39;t true constants as they are in C++, so you might want to use a symbolic constant (<code>#define</code>), but obviously that&#39;s not necessary. I&#39;ve made other edits as well to make  your answer more technically correct (and slightly easier to read)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 0, "creation_date": 1464145792, "post_id": 37426647, "comment_id": 62359126, "body": "@RastaJedi <code>sizeof arr</code> is an error, the parentheses can only be omitted when the argument is an expression.  <code>sizeof *array</code> would be preferable"}, {"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464146085, "post_id": 37426647, "comment_id": 62359203, "body": "@M.M that was just simple oversight because the two names (arr and array) are so similar. Fixed; thank you :)."}], "tags": [], "owner": {"reputation": 1588, "user_id": 6353415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HI3UX.png?s=128&g=1", "display_name": "Alastair Brown", "link": "https://stackoverflow.com/users/6353415/alastair-brown"}, "is_accepted": false, "score": 1, "last_activity_date": 1464144418, "last_edit_date": 1464144418, "creation_date": 1464141682, "answer_id": 37426647, "question_id": 37426558, "link": "https://stackoverflow.com/questions/37426558/why-do-i-get-a-seg-fault-when-in-n500-coded-in-c/37426647#37426647", "title": "Why do I get a seg fault when in n&gt;500? Coded in C", "body": "<p>My best guess is that because <code>500*500*sizeof(int) == 1000000</code> (assuming an <code>sizeof (int) == 4</code>), you've run out of stack space.  I suggest putting it on the heap instead:</p>\n\n<pre><code>typedef struct { int array[num - 1][num - 1] } arr;\n\nint main(void)\n{\n    const int num = 501;\n    int n;\n    arr *array;\n    int p = (num + 1) / 2 - 1;\n    int count = 25;\n    int x;\n\n    array = malloc(sizeof arr);\n\n    array-&gt;array[p][p] = 1;\n    array-&gt;array[p + 1][p] = 4;\n.\n.\n.\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4312654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690311667a0a3c816568007ebbd91148?s=128&d=identicon&r=PG&f=1", "display_name": "Tujamo", "link": "https://stackoverflow.com/users/4312654/tujamo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464144418, "creation_date": 1464140977, "last_edit_date": 1464141477, "question_id": 37426558, "link": "https://stackoverflow.com/questions/37426558/why-do-i-get-a-seg-fault-when-in-n500-coded-in-c", "title": "Why do I get a seg fault when in n&gt;500? Coded in C", "body": "<p>in the following piece of code which I wrote for problem 28 in project Euler. It needs to add the numbers along the two diagonals of an expanding square of increasing numbers. It results in a seg fault when I set <code>num&gt;500</code>. Until this limit it works perfectly. Thanks in advance!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\n  int n, num=501;\n  int array[num-1][num-1];\n  int p=((num+1)/2)-1;\n  int count=25;\n  int x;\n\n    array[p][p]=1;\n    array[p+1][p]=4;\n    array[p+1][p+1]=3;\n    array[p][p+1]=2;\n    array[p-1][p+1]=9;\n    array[p-1][p]=8;\n    array[p-1][p-1]=7;\n    array[p][p-1]=6;\n    array[p+1][p-1]=5;  \n\n    int i=10; \n  for (n=2;((n*2)+1)&lt;=num;n++){\n\n\n\n    for(x=0;x&lt;n*2;x++){\n       array[p+(x-(n-1))][p+n]=i;\n       i++;\n    }\n    count+=(i-1);\n\n\n\n    for(x=0;x&lt;n*2;x++){\n      array[p+n][p+(n-1)-x]=i;\n      i++;\n    }\n          count+=(i-1);\n\n\n\n\n    for(x=0;x&lt;n*2;x++){\n      array[p+((n-1)-x)][p-n]=i;\n      i++;\n    }\n     i--;\n\n\n        count+=i;\n    for(x=0;x&lt;=n*2;x++){\n      array[p-n][p+(x-n)]=i;\n      i++;\n    }\n\n        count+=(i-1);\n }\n\n    printf(\"The answer is %lu\\n\", count);\n\n}\n</code></pre>\n"}, {"tags": ["python", "c", "ipython", "cython"], "answers": [{"comments": [{"owner": {"reputation": 28612, "user_id": 7954504, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/6POkt.jpg?s=128&g=1", "display_name": "Brad Solomon", "link": "https://stackoverflow.com/users/7954504/brad-solomon"}, "edited": false, "score": 0, "creation_date": 1533761602, "post_id": 37441143, "comment_id": 90470625, "body": "Sure you need to specify <code>spam.c</code> in <code>setup()</code>?  Simply <code>setup(ext_modules=cythonize(&#39;*.pyx&#39;, quiet=True)</code> seems to work"}], "tags": [], "owner": {"reputation": 118092, "user_id": 4952130, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/kKQZw.png?s=128&g=1", "display_name": "Dimitris Fasarakis Hilliard", "link": "https://stackoverflow.com/users/4952130/dimitris-fasarakis-hilliard"}, "is_accepted": true, "score": 10, "last_activity_date": 1465035817, "last_edit_date": 1495535245, "creation_date": 1464188980, "answer_id": 37441143, "question_id": 37426534, "link": "https://stackoverflow.com/questions/37426534/how-can-i-import-an-external-c-function-into-an-ipython-notebook-using-cython/37441143#37441143", "title": "How can I import an external C function into an IPython Notebook using Cython?", "body": "<h3>The <code>%cython</code> magic command probaby doesn't seem to do the trick.</h3>\n\n<p>The <code>%cython</code> magic command doesn't really do the task here. In order to compile this you need to also supply the <code>*.c</code> source file and that (as far as I'm aware) isn't allowed with <code>%cython</code>. (<em><a href=\"https://github.com/davclark/ipython-extensions/blob/master/cythonmagic.py#L245\" rel=\"noreferrer\">The source file for it indicates that it only uses the text entered in the cell as a source file.</a></em>)</p>\n\n<h3>Wrap your <code>C</code> functions:</h3>\n\n<p>Before presenting a probable solution, let me point out that the <code>.pyx</code> file you have created doesn't actually wrap the <code>C</code> function <code>order_spam</code> automatically. You can have it automatically wrapped if you specify it as <code>cpdef</code> inside the <code>cdef extern</code> block (alternatively you could wrap it on your own outside the <code>cdef extern</code> block, this allows more flexibility).</p>\n\n<p>I'll use a filename of <code>cyspam.pyx</code> for the Cython file:</p>\n\n<pre><code>cdef extern from \"spam.c\":\n    cpdef void order_spam(int tons)\n</code></pre>\n\n<p>Notice how I've prefixed the function declaration with <code>cpdef</code>, this instructs Cython to automatically wrap the function.</p>\n\n<h3>Use a <code>setup.py</code> script:</h3>\n\n<p>In order to have full control over the compilation process, you usually need to create a <code>setup.py</code> script that has all the required sources, include directories et cetera, specified. </p>\n\n<p>Here's how the <code>setup.py</code> script should look like:</p>\n\n<pre><code>from distutils.core import setup, Extension\nfrom Cython.Build import cythonize\n\n# you specify the c source file in the sources list\next = Extension('cyspam', sources = ['cyspam.pyx', 'spam.c'])\nsetup(name=\"C spam\", ext_modules = cythonize([ext]))\n</code></pre>\n\n<p>You can either create a file like this via a simple text editor or via <code>IPython</code> with the <a href=\"https://ipython.org/ipython-doc/3/interactive/magics.html#cellmagic-writefile\" rel=\"noreferrer\"><strong><code>%%writefile</code></strong></a> magic command. The <code>setup.py</code> script should of course be placed in the same directory as the <code>cyspam.pyx</code> and <code>spam.c</code> files.</p>\n\n<h3>Compile the files:</h3>\n\n<p>You can either open a terminal for this or use the <strong><a href=\"https://ipython.org/ipython-doc/3/interactive/magics.html#cellmagic-bash\" rel=\"noreferrer\"><code>%%bash</code></a></strong> command from <code>IPython</code>, either way does the trick. Issue the following command:</p>\n\n<pre><code>python setup.py build_ext --inplace \n</code></pre>\n\n<p><code>--inplace</code> places the generated <code>.so</code> file in the current directory. </p>\n\n<p>After doing these you can easily import the file <code>cyspam</code> in <code>Ipython</code> and  just call the wrapped <code>C</code> function:</p>\n\n<h3>Rounding up all commands from <code>IPython</code>:</h3>\n\n<p>All in all, if you want to do it only from <code>IPython</code> you'll issue the following commands:</p>\n\n<pre><code>In [1]: %%writefile setup.py\n   ....: from distutils.core import setup, Extension\n   ....: from Cython.Build import cythonize\n   ....: ext = Extension('cyspam', sources = ['cyspam.pyx', 'spam.c'])\n   ....: setup(name=\"C spam\", ext_modules = cythonize([ext]))\n\nIn [2]: %%bash\n   ...: python setup.py build_ext --inplace\n\nIn [3]: import cyspam\n\nIn [4]: cyspam.order_spam(1000)\nYou ordered 1000 ammount of spam!\n</code></pre>\n\n<hr>\n\n<p>As an alternative you could always create a <code>.pyxbld</code> file that specifies the needed arguments for <code>pyximport.install()</code>. This offers the same level of control but is most likely counter-intuitive for Python users who already have experience with using <code>setup.py</code> scripts. </p>\n\n<p><strong><em>See Related:</em></strong></p>\n\n<p><a href=\"https://stackoverflow.com/questions/26833947/how-can-i-set-cython-compiler-flags-when-using-pyximport\">How can I set Cython compiler flags when using pyximport?</a></p>\n"}], "owner": {"reputation": 307, "user_id": 5285811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26142141959bd83209ceaba6d7a23aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Alizaybak", "link": "https://stackoverflow.com/users/5285811/alizaybak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1663, "favorite_count": 2, "accepted_answer_id": 37441143, "answer_count": 1, "score": 5, "last_activity_date": 1474175487, "creation_date": 1464140772, "last_edit_date": 1474175487, "question_id": 37426534, "link": "https://stackoverflow.com/questions/37426534/how-can-i-import-an-external-c-function-into-an-ipython-notebook-using-cython", "title": "How can I import an external C function into an IPython Notebook using Cython?", "body": "<p>I'd like to import a C function into an IPython notebook using Cython. Currently, I'm trying to replicate the example in the <a href=\"http://docs.cython.org/src/userguide/external_C_code.html\" rel=\"nofollow\">Cython documentation</a>, but I get a compilation error.</p>\n\n<p>My Python code (from an iPython notebook):</p>\n\n<pre><code>import cython\n%load_ext Cython\n</code></pre>\n\n<p>---------------------------------- new cell</p>\n\n<pre><code>%%cython\ncdef extern from \"spam.c\":\n    void order_spam(int tons)\n</code></pre>\n\n<p>My C code:</p>\n\n<pre><code>// spam.c\n#include &lt;stdio.h&gt;\n\nstatic void order_spam(int tons)\n{\n    printf(\"Ordered %i tons of spam!\\n\", tons);\n}\n</code></pre>\n\n<p>Running this code, I get the following traceback and error message:</p>\n\n<pre><code>CompileError                              Traceback (most recent call last)\n&lt;ipython-input-13-8bb733557977&gt; in &lt;module&gt;()\n----&gt; 1 get_ipython().run_cell_magic(u'cython', u'', u'\\ncdef extern from \"spam.c\":\\n    void order_spam(int tons)')\n\n/Users/danielacker/anaconda2/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in run_cell_magic(self, magic_name, line, cell)\n   2118             magic_arg_s = self.var_expand(line, stack_depth)\n   2119             with self.builtin_trap:\n-&gt; 2120                 result = fn(magic_arg_s, cell)\n   2121             return result\n   2122 \n\n&lt;decorator-gen-126&gt; in cython(self, line, cell)\n\n/Users/danielacker/anaconda2/lib/python2.7/site-packages/IPython/core/magic.pyc in &lt;lambda&gt;(f, *a, **k)\n    191     # but it's overkill for just that one bit of state.\n    192     def magic_deco(arg):\n--&gt; 193         call = lambda f, *a, **k: f(*a, **k)\n    194 \n    195         if callable(arg):\n\n/Users/danielacker/anaconda2/lib/python2.7/site-packages/Cython/Build/IpythonMagic.py in cython(self, line, cell)\n    276             build_extension.build_temp = os.path.dirname(pyx_file)\n    277             build_extension.build_lib  = lib_dir\n--&gt; 278             build_extension.run()\n    279             self._code_cache[key] = module_name\n    280 \n\n/Users/danielacker/anaconda2/lib/python2.7/distutils/command/build_ext.pyc in run(self)\n    337 \n    338         # Now actually compile and link everything.\n--&gt; 339         self.build_extensions()\n    340 \n    341     def check_extensions_list(self, extensions):\n\n/Users/danielacker/anaconda2/lib/python2.7/distutils/command/build_ext.pyc in build_extensions(self)\n    446 \n    447         for ext in self.extensions:\n--&gt; 448             self.build_extension(ext)\n    449 \n    450     def build_extension(self, ext):\n\n/Users/danielacker/anaconda2/lib/python2.7/distutils/command/build_ext.pyc in build_extension(self, ext)\n    496                                          debug=self.debug,\n    497                                          extra_postargs=extra_args,\n--&gt; 498                                          depends=ext.depends)\n    499 \n    500         # XXX -- this is a Vile HACK!\n\n/Users/danielacker/anaconda2/lib/python2.7/distutils/ccompiler.pyc in compile(self, sources, output_dir, macros, include_dirs, debug, extra_preargs, extra_postargs, depends)\n    572             except KeyError:\n    573                 continue\n--&gt; 574             self._compile(obj, src, ext, cc_args, extra_postargs, pp_opts)\n    575 \n    576         # Return *all* object filenames, not just the ones we just built.\n\n/Users/danielacker/anaconda2/lib/python2.7/distutils/unixccompiler.pyc in _compile(self, obj, src, ext, cc_args, extra_postargs, pp_opts)\n    120                        extra_postargs)\n    121         except DistutilsExecError, msg:\n--&gt; 122             raise CompileError, msg\n    123 \n    124     def create_static_lib(self, objects, output_libname,\n\nCompileError: command 'gcc' failed with exit status 1\n</code></pre>\n\n<p>I've tried searching Google for this error, but I can't seem to find anything relevant.</p>\n"}, {"tags": ["c", "unix", "tty", "ioctl", "pty"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 1, "creation_date": 1464141292, "post_id": 37426420, "comment_id": 62358199, "body": "I seriously hope you&#39;re not actually running a telnet server ... <i>please</i> use <code>sshd</code>."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 818058, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18c9a0d88bae442e68b11762c4691662?s=128&d=identicon&r=PG", "display_name": "Kaushik Koneru", "link": "https://stackoverflow.com/users/818058/kaushik-koneru"}, "edited": false, "score": 0, "creation_date": 1464154723, "post_id": 37426584, "comment_id": 62361648, "body": "Thank you @o11c, this will actually open a xterm model terminal but that is not what I am looking for.  I don&#39;t want any new xterm open. Something like following .consider we have process X running .. (and opened 2002 port to listen connections         $telnet 0:2002              -&gt; print this              -&gt; this              -&gt; exit"}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "reply_to_user": {"reputation": 79, "user_id": 818058, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18c9a0d88bae442e68b11762c4691662?s=128&d=identicon&r=PG", "display_name": "Kaushik Koneru", "link": "https://stackoverflow.com/users/818058/kaushik-koneru"}, "edited": false, "score": 0, "creation_date": 1464155040, "post_id": 37426584, "comment_id": 62361782, "body": "Huh? Note that you don&#39;t have to do anything <i>graphical</i> with a pty, you can just process it directly in a program"}, {"owner": {"reputation": 79, "user_id": 818058, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18c9a0d88bae442e68b11762c4691662?s=128&d=identicon&r=PG", "display_name": "Kaushik Koneru", "link": "https://stackoverflow.com/users/818058/kaushik-koneru"}, "edited": false, "score": 0, "creation_date": 1464156058, "post_id": 37426584, "comment_id": 62362150, "body": "Yes, I agree, But I need to open at one pty or tty or port to listen continuously. So, My Program will be having two process. One will be doing its work or execution. Other thread/Process will open a at one tty or port will continuously listen to User Commands. For This I need to attach to either port or any tty/pty. So, user can access that terminal and can run commands."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "reply_to_user": {"reputation": 79, "user_id": 818058, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18c9a0d88bae442e68b11762c4691662?s=128&d=identicon&r=PG", "display_name": "Kaushik Koneru", "link": "https://stackoverflow.com/users/818058/kaushik-koneru"}, "edited": false, "score": 0, "creation_date": 1464186317, "post_id": 37426584, "comment_id": 62382618, "body": "I&#39;m still quite confused about what you&#39;re saying. Do you want just a client-server architecture? Do you want to spawn an <code>xterm</code> with all its I/O redirected to your process?"}, {"owner": {"reputation": 19975, "user_id": 369489, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7ed0cb2aaf4902aadde8e021ce97df01?s=128&d=identicon&r=PG", "display_name": "Ashkan Kh. Nazary", "link": "https://stackoverflow.com/users/369489/ashkan-kh-nazary"}, "edited": false, "score": 0, "creation_date": 1588963197, "post_id": 37426584, "comment_id": 109112580, "body": "OP wants to connect a terminal emulator (i.e. <code>xterm</code>) to an <i>already running</i> and <i>remote</i> process via some ipv4 address:port and then (OP believes) it would act as if the said remote process was launched locally via a shell or something in the sense that OP can enter text and the remote process receives it as via <code>stdin</code> (like a normal terminal application, launched locally) and remote process writes in <code>stdout</code> and the terminal emulator on the other ends shows it as if ... well you get the picture :D"}], "tags": [], "owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "is_accepted": false, "score": 2, "last_activity_date": 1464141189, "creation_date": 1464141189, "answer_id": 37426584, "question_id": 37426420, "link": "https://stackoverflow.com/questions/37426420/c-code-to-connect-a-pty-terminal-to-current-process-to-execute-commands/37426584#37426584", "title": "C Code: To connect a pty terminal to current process to execute commands", "body": "<p>To create a new pseudoterminal, tou need to call the following functions in order:</p>\n\n<ul>\n<li><p><code>posix_openpt</code> (To get a new master)</p></li>\n<li><p><code>grantpt</code> (To fix permissions for the new slave)</p></li>\n<li><p><code>unlockpt</code> (To unlock the slave)</p></li>\n<li><p><code>ptsname</code> (To get the name of the slave)</p></li>\n<li><p><code>open</code> (To open the slave)</p></li>\n<li><p><code>setsid</code> (optional, to enter a new session and process group - typically after fork when you are running a separate process on the slave)</p></li>\n</ul>\n"}], "owner": {"reputation": 79, "user_id": 818058, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18c9a0d88bae442e68b11762c4691662?s=128&d=identicon&r=PG", "display_name": "Kaushik Koneru", "link": "https://stackoverflow.com/users/818058/kaushik-koneru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464141189, "creation_date": 1464139774, "question_id": 37426420, "link": "https://stackoverflow.com/questions/37426420/c-code-to-connect-a-pty-terminal-to-current-process-to-execute-commands", "title": "C Code: To connect a pty terminal to current process to execute commands", "body": "<p>In a Unix Process, I am planning to write code to access terminal. So, I can login to process and run few commands. </p>\n\n<p>For example, \nI can do telnet 0:2000 to get my terminal and from there I can dump my commands to dump process information.</p>\n\n<p>On my research, I saw that I can use /dev/pts or /dev/tty to the access terminal for the process. User can login to terminal to these but not clear on how it is works.</p>\n"}, {"tags": ["c", "linux", "bash"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464140276, "post_id": 37426384, "comment_id": 62357985, "body": "You should check whether <code>status</code> is <code>-1</code> before calling <code>WEXITSTATUS</code>. If it is <code>-1</code> then it means <code>system</code> failed and <code>WEXITSTATUS</code> is not valid. If it is not <code>-1</code> then the <code>WEXITSTATUS</code> value is returned by your program and so we can&#39;t tell you what it means since we don&#39;t have the source code to your program."}, {"owner": {"reputation": 331, "user_id": 2980260, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/923ea602792ac32799cdd2018d051b1e?s=128&d=identicon&r=PG", "display_name": "vesontio", "link": "https://stackoverflow.com/users/2980260/vesontio"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464140448, "post_id": 37426384, "comment_id": 62358023, "body": "it&#39;s already done, still the same."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464140494, "post_id": 37426384, "comment_id": 62358034, "body": "What is already done? What is the same? Could you not be clearer? If you mean <code>status</code> has been checked and is not <code>-1</code> then please read the second part of the comment - the <code>WEXITSTATUS</code> is returned by <code>myprog</code>. There is no way we can tell you what a return value of <code>127</code> means since we don&#39;t have the source code to <code>myprog</code>."}, {"owner": {"reputation": 331, "user_id": 2980260, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/923ea602792ac32799cdd2018d051b1e?s=128&d=identicon&r=PG", "display_name": "vesontio", "link": "https://stackoverflow.com/users/2980260/vesontio"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464140753, "post_id": 37426384, "comment_id": 62358079, "body": "Sorry for that, I mean I have checked the returned value of <code>system</code>, if it&#39;s <code>-1</code>, I just log a error message, <code>if (status != -1)</code>, I pass <code>status</code> to <code>WEXITSTATUS</code>, then the macro returns <code>127</code>."}], "answers": [{"tags": [], "owner": {"reputation": 331, "user_id": 2980260, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/923ea602792ac32799cdd2018d051b1e?s=128&d=identicon&r=PG", "display_name": "vesontio", "link": "https://stackoverflow.com/users/2980260/vesontio"}, "is_accepted": false, "score": 0, "last_activity_date": 1464145318, "last_edit_date": 1492086991, "creation_date": 1464145318, "answer_id": 37427077, "question_id": 37426384, "link": "https://stackoverflow.com/questions/37426384/system-keeps-returning-127/37427077#37427077", "title": "system() keeps returning 127", "body": "<p>Well, I have found the answer:<a href=\"https://unix.stackexchange.com/questions/44370/how-to-make-unix-service-see-environment-variables\">How to make unix service see environment variables?</a>,the environment variables are removed in init.d script.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1464272674, "creation_date": 1464272674, "answer_id": 37463641, "question_id": 37426384, "link": "https://stackoverflow.com/questions/37426384/system-keeps-returning-127/37463641#37463641", "title": "system() keeps returning 127", "body": "<p>this excerpt from the man page for <code>system()</code></p>\n\n<pre><code>-----------------------------------------------------------------\nThe value returned is -1 on  error  (e.g.,  fork(2)  failed),  and  the\n   return  status  of the command otherwise.  \nThis latter return status is\n   in the format specified in wait(2).  \nThus, the exit code of the command\n   will  be  WEXITSTATUS(status).   \nIn case /bin/sh could not be executed,\n   the exit status will be that of a command that does exit(127).\"\n-----------------------------------------------------------------\n</code></pre>\n\n<p>indicates the 127 means that <code>/bin/sh</code> could not be executed.</p>\n"}], "owner": {"reputation": 331, "user_id": 2980260, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/923ea602792ac32799cdd2018d051b1e?s=128&d=identicon&r=PG", "display_name": "vesontio", "link": "https://stackoverflow.com/users/2980260/vesontio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1226, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1464272674, "creation_date": 1464139427, "last_edit_date": 1464140611, "question_id": 37426384, "link": "https://stackoverflow.com/questions/37426384/system-keeps-returning-127", "title": "system() keeps returning 127", "body": "<p>I am developing a shared-library <code>L</code> which is used by an other system service <code>S</code>. In my program I need to call a small program <code>P</code>, which uses Oracle shared libraries.</p>\n\n<p>The small program <code>P</code> is packaged and installed correctly, and the environment variables, such as <code>PATH</code>,<code>LD_LIBRARY_PATH</code> and <code>ORACLE_HOME</code> are set correctly. I can run <code>P</code> on command line without any problem.</p>\n\n<p>But when service <code>S</code> call my library <code>L</code> which runs the small program <code>P</code> via <code>system()</code>, it gives me a return code <code>127</code>. I've googled, people says it's a <code>command not found</code> error, probably a <code>PATH</code> issue, so I've tried with absolute path like the following</p>\n\n<pre><code>int status = system(\"/usr/bin/myprog --args\");\nif (status &lt; 0) { ... }\nret = WEXITSTATUS(status);\n</code></pre>\n\n<p><code>ret</code> still equals <code>127</code>.</p>\n\n<p>Any idea please ? Thank you.</p>\n\n<p><strong>Update</strong>\nIt turns out that the service <code>S</code> is launched via command <code>daemon</code>, in its <code>init.d</code> script, I have found the following line:</p>\n\n<pre><code>daemon /usr/bin/myserv\n</code></pre>\n\n<p>if I <code>export</code> explicitly all my environment variables (<code>PATH</code>, <code>ORACLE_HOME</code> and <code>LD_LIBRARY_PATH</code>), it works. I don't know if <code>daemon</code> eliminates my environment variables.</p>\n"}, {"tags": ["c", "redirect"], "comments": [{"owner": {"reputation": 2682, "user_id": 4072843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tKkUM.jpg?s=128&g=1", "display_name": "Castaglia", "link": "https://stackoverflow.com/users/4072843/castaglia"}, "edited": false, "score": 2, "creation_date": 1464140002, "post_id": 37426336, "comment_id": 62357926, "body": "You want to read from <code>stdin</code> (fd 0), and <i>write</i> to <code>stdout</code> (fd 1), right?  Right now, your code is reading from <i>and</i> writing to <code>stdout</code>.  (On a different note, you might want to see what happens if you do <code>.&#47;mycat -1024 &lt; b.txt</code>.)"}, {"owner": {"reputation": 694, "user_id": 4475267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RSHYsfQegM/AAAAAAAAAAI/AAAAAAAAAI0/NQY8UBQZ-ag/photo.jpg?sz=128", "display_name": "noisypixy", "link": "https://stackoverflow.com/users/4475267/noisypixy"}, "edited": false, "score": 0, "creation_date": 1464140257, "post_id": 37426336, "comment_id": 62357982, "body": "The <code>STDIN_FILENO</code> and <code>STDOUT_FILENO</code> constants from <code>&lt;unistd.h&gt;</code> might be easier to read than <code>0</code> and <code>1</code>."}, {"owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "edited": false, "score": 0, "creation_date": 1464140670, "post_id": 37426336, "comment_id": 62358062, "body": "I didn&#39;t saw the 1 on read, it solved the problem."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5076313"}, "is_accepted": true, "score": 0, "last_activity_date": 1464155791, "last_edit_date": 1464155791, "creation_date": 1464147089, "answer_id": 37427321, "question_id": 37426336, "link": "https://stackoverflow.com/questions/37426336/redirecting-input-to-c-program/37427321#37427321", "title": "Redirecting input to C program", "body": "<p>You have to read from the stdin. But you are reading the contents from stdout. So, only you are blocked to entering the input.</p>\n\n<p>The file descriptor for stdin is 0. and stdout is 1. If you are confusing with these 1 and 0. You can use the macros for stdin and stdout file descriptors.</p>\n\n<p>The following are the built in macros defined in the unistd.h header file.</p>\n\n<pre><code>STDIN_FILENO     -- Standard input file descriptor\nSTDOUT_FILENO    -- Standard output file descriptor\nSTDERR_FILENO    -- Standard error file descriptor\n</code></pre>\n\n<p>So, change the code as like below. It will work as you expect.</p>\n\n<pre><code>#include&lt;unistd.h&gt;\n#include&lt;stdio.h&gt;\n\nint main(int argc,char** argv){\nint bytes = atoi(argv[1]);\nchar buf[1024];\nwhile(1){\n    int b = read(STDIN_FILENO,buf,bytes);\n    if(b&lt;=0) break;\n    write(STDOUT_FILENO,buf,b);\n}\nreturn 0;\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 37427321, "answer_count": 1, "score": 0, "last_activity_date": 1464155791, "creation_date": 1464139073, "question_id": 37426336, "link": "https://stackoverflow.com/questions/37426336/redirecting-input-to-c-program", "title": "Redirecting input to C program", "body": "<p>I have this program:</p>\n\n<pre><code>int main(int argc,char** argv){\nint bytes = atoi(argv[1]);\nchar buf[1024];\nwhile(1){\n    int b = read(1,buf,bytes);\n    if(b&lt;=0) break;\n    write(1,buf,b);\n}\nreturn 0;\n</code></pre>\n\n<p>This is a version of the command cat but in this program i give as an argument the number of bytes each <code>read</code> will read.\nNow i have a file <code>b.txt</code> and i want to redirect the file content to the program as input so i used this</p>\n\n<pre><code>./mycat 1024 &lt; b.txt\n</code></pre>\n\n<p>But nothing happens, the program keeps waiting for me to type some text, like if i did \n<code>./mycat 1024</code>. \nWhy is not the redirection working?</p>\n"}, {"tags": ["c", "string", "scanf"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464136832, "post_id": 37426033, "comment_id": 62357228, "body": "push enter because <code>stdin</code> is bufferd stream. or add limit like this <code>&quot;%10[^\\n]&quot;</code>"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 3, "creation_date": 1464136871, "post_id": 37426033, "comment_id": 62357231, "body": "Stop using scanf.  If you want to learn C, read input using <code>fgetc</code>, <code>fread</code>, <code>fgets</code>, and <code>read</code>.  (Maybe a few others)."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1464136922, "post_id": 37426033, "comment_id": 62357243, "body": "And a reasonable argument could be made to avoid <code>read</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "is_accepted": false, "score": 1, "last_activity_date": 1464167150, "last_edit_date": 1464167150, "creation_date": 1464163090, "answer_id": 37431063, "question_id": 37426033, "link": "https://stackoverflow.com/questions/37426033/c-how-to-read-a-string-with-only-spaces-using-scanf/37431063#37431063", "title": "C - How to read a string with only spaces using scanf", "body": "<p>Using <code>char *fgets(char *str, int n, FILE *stream)</code> will make your day.</p>\n\n<p>According to man :</p>\n\n<blockquote>\n  <p>fgets() reads in at most one less than size characters from stream and\n  stores them into the buffer pointed to by s. Reading stops after an\n  EOF or a newline. If a newline is read, it is stored into the buffer.\n  A terminating null byte ('\\0') is stored after the last character in\n  the buffer.</p>\n</blockquote>\n\n<p><strong>Example program</strong> </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define MAXSTR 21\n\nint main(void)\n{\nchar my_str[MAXSTR] = {'\\0'};\n\nfgets(my_str, MAXSTR, stdin);\n\nreturn 0;\n}\n</code></pre>\n\n<p><strong>Input :</strong></p>\n\n<blockquote>\n  <p>Claudio Cortese</p>\n</blockquote>\n\n<p><strong>Output :</strong></p>\n\n<blockquote>\n  <p>Claudio Cortese</p>\n</blockquote>\n"}], "owner": {"reputation": 19, "user_id": 6378713, "user_type": "registered", "profile_image": "https://graph.facebook.com/741942662575761/picture?type=large", "display_name": "Ramon Machado", "link": "https://stackoverflow.com/users/6378713/ramon-machado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "closed_date": 1464348746, "answer_count": 1, "score": 1, "last_activity_date": 1464276990, "creation_date": 1464136391, "last_edit_date": 1464276990, "question_id": 37426033, "link": "https://stackoverflow.com/questions/37426033/c-how-to-read-a-string-with-only-spaces-using-scanf", "closed_reason": "Duplicate", "title": "C - How to read a string with only spaces using scanf", "body": "<p>I'm with a little problem while doing an excercise to learn C.\nThe problem is: I need to read a string from the user, but if he types just a space, I need to print a space. That's okay in theory.\nBut, when I type the space while the program is running, it doesn't understand it as a string and it keeps waiting for me to type other things.</p>\n\n<p>I'm using the <code>scanf(\"%[^\\n]\", string_name_here);</code></p>\n\n<p>I appreciate your help, and have a nice day! o/\nAnd sorry for my bad english, I hope you can understand this :)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1464136099, "post_id": 37425996, "comment_id": 62357064, "body": "This <code>fd = open(dir, O_RDONLY) == -1</code> is wrong, print <code>fd</code> after that line and check. Enable compiler warnings too. Use <code>%zu</code> for <code>size_t</code> in <code>printf()</code>."}, {"owner": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "edited": false, "score": 1, "creation_date": 1464136346, "post_id": 37425996, "comment_id": 62357108, "body": "important : download a C/C++ IDE with a correct debugger, and use it"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "edited": false, "score": 0, "creation_date": 1464136854, "post_id": 37425996, "comment_id": 62357229, "body": "Please @user1952009 note that <code>c&#47;c++</code> is, undefined behaviour. And in fact, there is no such language. So suggest a C and/or C++ IDE. Since this is all  <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> code, then a C IDE. I know it looks like <i>it doesn&#39;t really matter</i> but, inexperienced programmers develop the feeling that <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> and <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> are the same languages not-{,object oriented} respectively. It also does not require a debugger, that&#39;s is almost useless if the OP doesn&#39;t know that <code>fd == 0</code> wouldn&#39;t make sense in this scenario. Compilation Warnings on the other hand are crucial here."}, {"owner": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464136953, "post_id": 37425996, "comment_id": 62357256, "body": "@iharob : I don&#39;t agree with you, at all (except for the compilation warnings of course)"}, {"owner": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464137120, "post_id": 37425996, "comment_id": 62357292, "body": "@iharob : did you already work on a huge source code that you didn&#39;t write ? because it seems you are thinking that understanding a code by reading it is the most important, whereas when you work on someone else code, with many function/methods calls that (at first) you  understand nothing of, you understand the code while debugging it, not by reading it. and here the situation is exactly the same with fd = open(...); I don&#39;t know how it works and what arguments it is expecting."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "edited": false, "score": 0, "creation_date": 1464137246, "post_id": 37425996, "comment_id": 62357323, "body": "@user1952009 That is not a requirement, I think it&#39;s just my opinion and it might make sense to others so I commented. But it&#39;s certainly just my opinion and it might very well be wrong. Although, the FACT that <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> and <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> are NOT the same language is that, a FACT."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "edited": false, "score": 0, "creation_date": 1464137351, "post_id": 37425996, "comment_id": 62357345, "body": "@user1952009 I think you did not understand what I meant at all. I didn&#39;t say that debuggers are useless. But the problem in this code does not require a debugger yet, to detect it compilation warnings are MORE THAN ENOUGH. Also, if I am unable to understand code by reading it, I think I would write it from scratch instead. Perhaps the company won&#39;t let me do this but I would certainly want to. And maybe, it would save time and effort to re-write it."}, {"owner": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464137510, "post_id": 37425996, "comment_id": 62357372, "body": "@iharob : did you already work on a huge source code / software that you didn&#39;t write ? the debugger is the most important tool in the life of a developper, much more important than the language"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "edited": false, "score": 0, "creation_date": 1464137550, "post_id": 37425996, "comment_id": 62357385, "body": "@user1952009 Again, the debugger is indeed the most important tool. I will not say the contrary. I am just saying that it&#39;s not necessary to find <code>fd = open(...) == -1</code>  is a problem."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "edited": false, "score": 0, "creation_date": 1464137722, "post_id": 37425996, "comment_id": 62357411, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/112841/discussion-between-iharob-and-user1952009\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 3, "last_activity_date": 1464136302, "creation_date": 1464136302, "answer_id": 37426020, "question_id": 37425996, "link": "https://stackoverflow.com/questions/37425996/c-file-reading-doesnt-stop/37426020#37426020", "title": "C File reading doesn&#39;t stop", "body": "<p>You have an issue with this statement</p>\n\n<pre><code>if (fd = open(dir, O_RDONLY) == -1) \n</code></pre>\n\n<p>according to operator precendence <code>==</code> is evaluated first and thus, <code>fd</code> is being assigned the value of the comparison and not the opened file descriptor.</p>\n\n<p>With compiler warnings enabled parentheses would be suggested, and the correted expression would be</p>\n\n<pre><code>if ((fd = open(dir, O_RDONLY)) == -1) \n/*  ^~~~~~~~~~~~~~~~~~~~~~~~~^ */\n</code></pre>\n\n<p>would first assign the return value of <code>open()</code> to <code>fd</code> and then the comparison is performed.</p>\n\n<p>If you print the value of <code>fd</code> you will see that it's <code>0</code> if <code>open()</code> succeeded <em>i.e. returned a value not <code>-1</code></em> and <code>1</code> otherwise.</p>\n"}], "owner": {"reputation": 744, "user_id": 2879539, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ewJnB.png?s=128&g=1", "display_name": "sooobus", "link": "https://stackoverflow.com/users/2879539/sooobus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 37426020, "answer_count": 1, "score": 0, "last_activity_date": 1464136302, "creation_date": 1464136042, "last_edit_date": 1464136180, "question_id": 37425996, "link": "https://stackoverflow.com/questions/37425996/c-file-reading-doesnt-stop", "title": "C File reading doesn&#39;t stop", "body": "<p>I am writing a simple server that allows sending files using HTTP protocol. I have a function that puts everything from the file into buffer. \nEverything goes well before <strong>read</strong>. The file size is printed correctly. But on <strong>read</strong> program just waits. </p>\n\n<pre><code>char *get_file(char *dir) {\n    fprintf(stderr, \"GET FILE\\n\");\n    char *buff;\n    int fd;\n    if (fd = open(dir, O_RDONLY) == -1) {\n        fprintf(stderr, \"No such file: %s\\n\", dir);\n        exit(6);\n    }\n\n    size_t size = fsize(dir);\n\n    fprintf(stderr, \"OPENED FILE, SIZE: %ld\\n\", size);\n    buff = malloc(size);\n    read(fd, buff, size);\n\n    fprintf(stderr, \"to be downloaded: %s\\n\", buff);\n    char *response = make_file_response(buff);\n    return response;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464135651, "post_id": 37425763, "comment_id": 62356973, "body": "It&#39;s unlikely the cause of the problem but recently I learned that it should be <code>PF_INET</code> instead of <code>AF_INET</code>. Normally I think <code>AF_INET</code> is just <code>#define AF_INET PF_INET</code>. But the correct constant is <code>PF_INET</code>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1464136033, "post_id": 37425763, "comment_id": 62357051, "body": "Perhaps you mean <code>(int[]){1}</code> instead, <a href=\"http://stackoverflow.com/a/6117081/1983495\">read this</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1464136198, "post_id": 37425763, "comment_id": 62357084, "body": "@iharob: <a href=\"http://stackoverflow.com/questions/6729366/\">What is the difference between AF_INET and PF_INET in socket programming?</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1464136435, "post_id": 37425763, "comment_id": 62357139, "body": "@iharob: it would be safer to use an actual variable instead of trying to type-cast a temp array. <code>setsockopt()</code> is expecting a pointer to a variable: <code>int flag = 1; setsockopt(..., &amp;flag, sizeof(flag));</code>  Also, don&#39;t forget that Linux also has an <code>SO_REUSEPORT</code> option."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1464136646, "post_id": 37425763, "comment_id": 62357185, "body": "@RemyLebeau Interesting link, and that&#39;s what I would do too. It doesn&#39;t bother me to use an extra variable. But certainly the code is incorrect and it might be what was meant. And since Beej&#39;s explains it and it makes a lot of sense it&#39;s weird that we don&#39;t see <code>#define PF_INET AF_INET</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 5654, "user_id": 2735434, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78c287cbf5caae399b4f1ad45d9178b6?s=128&d=identicon&r=PG&f=1", "display_name": "dexterous", "link": "https://stackoverflow.com/users/2735434/dexterous"}, "is_accepted": true, "score": 0, "last_activity_date": 1467606941, "creation_date": 1467606941, "answer_id": 38177024, "question_id": 37425763, "link": "https://stackoverflow.com/questions/37425763/udp-socket-bind-error-address-already-in-use/38177024#38177024", "title": "UDP -- Socket - bind error - Address already in use?", "body": "<p>I got to know that I can reserve the port in rcS file - </p>\n\n<pre><code>sysctl -w net.ipv4.ip_local_reserved_ports=49155\n</code></pre>\n"}], "owner": {"reputation": 5654, "user_id": 2735434, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78c287cbf5caae399b4f1ad45d9178b6?s=128&d=identicon&r=PG&f=1", "display_name": "dexterous", "link": "https://stackoverflow.com/users/2735434/dexterous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2872, "favorite_count": 0, "accepted_answer_id": 38177024, "answer_count": 1, "score": 1, "last_activity_date": 1467606941, "creation_date": 1464134064, "last_edit_date": 1464136106, "question_id": 37425763, "link": "https://stackoverflow.com/questions/37425763/udp-socket-bind-error-address-already-in-use", "title": "UDP -- Socket - bind error - Address already in use?", "body": "<p>I see that the address is already in use on bind() while the system is starting up.</p>\n\n<p>When I reload the system plenty of times, I see that once in a while like 1 out of 100, I see the following error:</p>\n\n<blockquote>\n  <p>bind failed.Error: Address already in use.</p>\n</blockquote>\n\n<p>On every reboot of the system - I am closing the socket by using <code>close(gTx.i4TxSockId)</code>.</p>\n\n<p>Here is the code, I am not sure on how can I debug this.</p>\n\n<p>I have added netstat -ap to find out what problem was it. </p>\n\n<p>On success, I see: </p>\n\n<pre>\nnetstat: /proc/net/tcp6: No such file or directory\nudp        0      0 0.0.0.0:syslog          0.0.0.0:*                           1562/syslog-ng\nudp        0      0 0.0.0.0:49155           0.0.0.0:*                           1817/App.exe\n</pre>\n\n<p>On failure, I see:</p>\n\n<pre>\nnetstat: /proc/net/tcp6: No such file or directory\nudp        0      0 0.0.0.0:45825           0.0.0.0:*                           1816/App.exe\nudp        0      0 0.0.0.0:syslog          0.0.0.0:*                           1562/syslog-ng\nudp        0      0 localhost:49155         0.0.0.0:*                           1816/App.exe\n</pre>\n\n<p>I have added the following line:</p>\n\n<pre><code>if (setsockopt(gTx.i4TxSockId, SOL_SOCKET, SO_REUSEADDR, &amp;(int){ 1 }, sizeof(int)) &lt; 0)\n{\n    perror(\"Failed in SO_REUSEADDR\");\n    return;\n}\n</code></pre>\n\n<p>This is not making any difference.</p>\n\n<p>I am using embedded linux - version - 3.8.8</p>\n\n<pre><code>struct sockaddr_in  LocalAddr;\n\ngTx.i4TxSockId = socket (AF_INET, SOCK_DGRAM, IPPROTO_UDP);\n\nif (gTx.i4TxSockId &lt; 0)\n{\n    printf(\"Error in opening socket\");\n    return ;\n}\n\nif (setsockopt(gTx.i4TxSockId, SOL_SOCKET, SO_REUSEADDR, &amp;(int){ 1 }, sizeof(int)) &lt; 0)\n{\n    perror(\"Failed in SO_REUSEADDR\");\n    return;\n}\n\nLocalAddr.sin_family = AF_INET;\nLocalAddr.sin_addr.s_addr = INADDR_ANY;\nLocalAddr.sin_port = HTONS(49155);\n\n/* Bind with the socket */\nif (bind (gTx.i4TxSockId, (struct sockaddr *) &amp;LocalAddr, sizeof (struct sockaddr_in)) &lt; 0)\n{\n    /* Failure in binding the UDP socket */\n    perror(\"bind failed.Error\");\n    return;\n}\n</code></pre>\n"}, {"tags": ["c", "math", "resources"], "comments": [{"owner": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "edited": false, "score": 1, "creation_date": 1464134206, "post_id": 37425634, "comment_id": 62356630, "body": "you can multiply by (-1) at each loop, or use (N % 2 ? 1:-1) which is an expression returning 1 or -1 depending on the result of N modulo 2, there is also (N &amp; 1 ? 1:-1) the same but with the &#39;bit and&#39; operator (the value of the last bit of N). and for computing 3^N use pow(3,N)"}, {"owner": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "edited": false, "score": 0, "creation_date": 1464134431, "post_id": 37425634, "comment_id": 62356689, "body": "<a href=\"https://en.wikipedia.org/wiki/Operators_in_C_and_C++\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Operators_in_C_and_C++</a>"}, {"owner": {"reputation": 1165, "user_id": 1459311, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K2qNT.jpg?s=128&g=1", "display_name": "Sponge Bob", "link": "https://stackoverflow.com/users/1459311/sponge-bob"}, "reply_to_user": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "edited": false, "score": 0, "creation_date": 1464135214, "post_id": 37425634, "comment_id": 62356882, "body": "@user1952009 The term completely chances each iteration, so I can&#39;t multiply it like that."}, {"owner": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "edited": false, "score": 0, "creation_date": 1464135833, "post_id": 37425634, "comment_id": 62357012, "body": "but you approved an answer where it does..."}, {"owner": {"reputation": 1165, "user_id": 1459311, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K2qNT.jpg?s=128&g=1", "display_name": "Sponge Bob", "link": "https://stackoverflow.com/users/1459311/sponge-bob"}, "reply_to_user": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "edited": false, "score": 0, "creation_date": 1464136476, "post_id": 37425634, "comment_id": 62357149, "body": "Then I guess I just don&#39;t understand your comment completely...."}, {"owner": {"reputation": 732, "user_id": 1952009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b213144223d7c866ab308fe6700633?s=128&d=identicon&r=PG", "display_name": "reuns", "link": "https://stackoverflow.com/users/1952009/reuns"}, "edited": false, "score": 0, "creation_date": 1464136700, "post_id": 37425634, "comment_id": 62357198, "body": "sign = (-1)*sign; and sign = -sign; are not so different"}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1464134324, "post_id": 37425788, "comment_id": 62356660, "body": "This is IMHO the best solution."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 3, "last_activity_date": 1464134290, "creation_date": 1464134290, "answer_id": 37425788, "question_id": 37425634, "link": "https://stackoverflow.com/questions/37425634/how-to-create-alternating-sign-of-an-infinite-series-in-ansi-c-using-the-least/37425788#37425788", "title": "How to create alternating sign of an &quot;infinite&quot; series in ANSI C using the least amount of system resources?", "body": "<p>Just keep the sign as a separate variable, and negate it as you process each term:</p>\n\n<pre><code>int sign = 1;\nfor ( int i = 0; i &lt; N; i++ )\n{\n    printf( \"%2d\\n\", sign );\n    sign = -sign;\n}\n</code></pre>\n"}], "owner": {"reputation": 1165, "user_id": 1459311, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K2qNT.jpg?s=128&g=1", "display_name": "Sponge Bob", "link": "https://stackoverflow.com/users/1459311/sponge-bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 37425788, "answer_count": 1, "score": -1, "last_activity_date": 1464134290, "creation_date": 1464133186, "question_id": 37425634, "link": "https://stackoverflow.com/questions/37425634/how-to-create-alternating-sign-of-an-infinite-series-in-ansi-c-using-the-least", "title": "How to create alternating sign of an &quot;infinite&quot; series in ANSI C using the least amount of system resources?", "body": "<p>I am working with ANSI C for the first time and I need to sum a series out to an N number of terms.</p>\n\n<p>My background is in physics, not CS, so I instinctively thought to use the old (-1)^N trick, but quickly realized that 1) it didn't work, and 2) ANSI C doesn't have a built in exponentiation operator. </p>\n\n<p>Since I now realize that exponentiation is slow, what is the best way to create an alternating series in for this?  My second thought was checking the parity of N and then using an if statement that gives me either a 1 or -1 to multiply the term by, but I don't know any good methods to check parity on a computer, and I think it would be even slower than exponentiating -1.  </p>\n\n<p>Are there better ways to accomplish this that won't heavily tax the CPU?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464130413, "post_id": 37425179, "comment_id": 62355535, "body": "<code>for (i; i &lt;= 2;i++)</code> needs to be <code>for (i=0; i &lt;= 2;i++)</code>. Otherwise <code>i</code> will already be <code>2</code> when the second <code>for</code> loop is reached. Also <code>&amp;name[i]</code> is wrong as <code>name</code> only has one byte of memory."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1464130503, "post_id": 37425179, "comment_id": 62355564, "body": "You should read in an entire line with <code>fgets()</code>, and then parse it with <code>sscanf()</code>."}, {"owner": {"reputation": 33, "user_id": 4183961, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-kLJgVhqRPu8/AAAAAAAAAAI/AAAAAAAAAFc/AExZ7sO8S2Q/photo.jpg?sz=128", "display_name": "NewProgrammer7", "link": "https://stackoverflow.com/users/4183961/newprogrammer7"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464130611, "post_id": 37425179, "comment_id": 62355590, "body": "i did it like u said @kaylum but it now says file.exe stopped working when I execute it"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1464130691, "post_id": 37425179, "comment_id": 62355611, "body": "What exactly did you do? It sounds like you fixed the first problem but not the second. Your declaration and/or use of <code>name</code> is wrong as there isn&#39;t enough/correct memory allocated. Which is likely to crash the program in the way you are observing. Try replacing <code>char name[] = &quot;&quot;;</code> with <code>char name[3][99];</code>."}, {"owner": {"reputation": 33, "user_id": 4183961, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-kLJgVhqRPu8/AAAAAAAAAAI/AAAAAAAAAFc/AExZ7sO8S2Q/photo.jpg?sz=128", "display_name": "NewProgrammer7", "link": "https://stackoverflow.com/users/4183961/newprogrammer7"}, "edited": false, "score": 0, "creation_date": 1464131012, "post_id": 37425179, "comment_id": 62355706, "body": "I got it thanks but what does char[3][99] do?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1464131276, "post_id": 37425179, "comment_id": 62355784, "body": "@NewProgrammer7 I&#39;m not trying to be offensive but if you don&#39;t know what that does then you really should go back to review a basic C book/tutorial before proceeding with writing code. It declares a two dimensional array of chars."}, {"owner": {"reputation": 33, "user_id": 4183961, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-kLJgVhqRPu8/AAAAAAAAAAI/AAAAAAAAAFc/AExZ7sO8S2Q/photo.jpg?sz=128", "display_name": "NewProgrammer7", "link": "https://stackoverflow.com/users/4183961/newprogrammer7"}, "edited": false, "score": 0, "creation_date": 1464131500, "post_id": 37425179, "comment_id": 62355855, "body": "i know its a 2D array but i just want to know why cant we declare name[3] or name[99] rather then array[3][99]"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1464131893, "post_id": 37425179, "comment_id": 62355964, "body": "<code>name[3]</code> will only give you a buffer that can store 3 bytes. <code>name[99]</code> is better in that you can store 99 bytes. But what you really want are 3 buffers that can store 99 bytes each. Because the loop reads in 3 names. Hence <code>[3][99]</code>."}, {"owner": {"reputation": 405, "user_id": 6336615, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-54JWXHU1LhI/AAAAAAAAAAI/AAAAAAAABKc/N9fUA8Ue7e4/photo.jpg?sz=128", "display_name": "Wayne Booth", "link": "https://stackoverflow.com/users/6336615/wayne-booth"}, "edited": false, "score": 0, "creation_date": 1464512031, "post_id": 37425179, "comment_id": 62510032, "body": "@NewProgrammer7, If you found an answer provided here helpful, please upvote and/or mark as accepted, so that other users with a similar question can benefit."}], "answers": [{"tags": [], "owner": {"reputation": 405, "user_id": 6336615, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-54JWXHU1LhI/AAAAAAAAAAI/AAAAAAAABKc/N9fUA8Ue7e4/photo.jpg?sz=128", "display_name": "Wayne Booth", "link": "https://stackoverflow.com/users/6336615/wayne-booth"}, "is_accepted": false, "score": 2, "last_activity_date": 1464130771, "creation_date": 1464130771, "answer_id": 37425253, "question_id": 37425179, "link": "https://stackoverflow.com/questions/37425179/printing-array-in-c/37425253#37425253", "title": "Printing array In C", "body": "<p>Your second loop is not starting from 0, but starting from where the first left off, ie 2.\nReset it back to 0 and try again.</p>\n"}], "owner": {"reputation": 33, "user_id": 4183961, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-kLJgVhqRPu8/AAAAAAAAAAI/AAAAAAAAAFc/AExZ7sO8S2Q/photo.jpg?sz=128", "display_name": "NewProgrammer7", "link": "https://stackoverflow.com/users/4183961/newprogrammer7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1464130771, "creation_date": 1464130253, "last_edit_date": 1464130411, "question_id": 37425179, "link": "https://stackoverflow.com/questions/37425179/printing-array-in-c", "title": "Printing array In C", "body": "<p>I am trying to input some values in arrays but cant print them out. Below is my code.please tell me what is wrong. Thank you. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n    int i = 0;\n    int win[99],tied[99],lost[99],streak[99],points[99];\n    char name[] = \"\";\n\n    for (i;i&lt;=2;i++)\n    {\n\n        scanf(\"%s %d %d %d %d\", &amp;name[i] , &amp;win[i] , &amp;tied[i] , &amp;lost[i] , &amp;streak[i]);\n\n        points[i] = win[i]*3 + tied[i];\n\n    }\n    for (i; i &lt;= 2;i++){\n\n        printf(\"%s \\t%d \\t%d\\n\", name[i], points[i] , streak[i]);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "fork"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1464128624, "post_id": 37424841, "comment_id": 62354902, "body": "When using <code>fork()</code>, the correct return type for <code>main()</code> is <code>int</code>, not <code>void</code>.  You can use <code>void main()</code> on Windows; everywhere else, it is wrong (almost everywhere else \u2014 specific systems could document it as OK, like Windows does).  See <a href=\"http://stackoverflow.com/questions/204476/\">What should <code>main()</code> return in C and C++?</a>"}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 1, "creation_date": 1464128700, "post_id": 37424841, "comment_id": 62354932, "body": "So why are you expecting <code>123123123</code>? I don&#39;t understand; fork really generates independent processes. There&#39;s no reason for one process to print a number, then wait for another thread, etc. It just does it&#39;s <code>for</code> loop, and eventually, the other threads get scheduled. Also, there&#39;s buffering on the output. At any rate, your code makes no attempt at making one process wait for the other, and it&#39;s pretty hard to do that correctly, indeed. Are you <i>sure</i> you&#39;re supposed to <code>fork</code> here, or were you given another hint on how to do synchronization between processes?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1464128788, "post_id": 37424841, "comment_id": 62354971, "body": "One problem is that after you launch each child, you wait for three children to die.  That loop should probably be after the launch loop.  Another problem is that you don&#39;t use newlines at the ends of messages; this causes confusion too (see <a href=\"https://stackoverflow.com/questions/2530663/printf-anomaly-after-fork/\"><code>printf()</code> anomaly after <code>fork()</code></a>)."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1464129220, "post_id": 37424841, "comment_id": 62355132, "body": "Agreed - I see nothing wrong with the output of this program.  Async is async.  If you want 123123 across processes, you either shouldn&#39;t use <code>fork</code>, or you are going to have to work a bit harder on synchronizing things."}, {"owner": {"reputation": 1543, "user_id": 3704627, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6e3a7da2c79b553b211bc3fd58da6c60?s=128&d=identicon&r=PG&f=1", "display_name": "Rasalas", "link": "https://stackoverflow.com/users/3704627/rasalas"}, "edited": false, "score": 0, "creation_date": 1464129422, "post_id": 37424841, "comment_id": 62355198, "body": "I am supposed to launch three child processes from one parent process. Since we only learned about forks I thought this is the way to go. We can use <code>environ, strol, fork, waitpid, usleep, fflush</code> (but everything but fork is new to me). I thought the processes are running at the same time and the scheduler tells the processes which process can go first. which will create kind of &quot;random&quot; number combinations from 0 to 2 (I switched up the numers sry). To get a one line result and not 60 line result I didn&#39;t use newlines."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1464129511, "post_id": 37424841, "comment_id": 62355230, "body": "The parent process calls <code>fork</code>, then <code>wait</code>, then <code>wait</code>, then <code>wait</code>, then <code>fork</code>, then <code>wait</code>, then <code>wait</code>, then <code>wait</code>, then <code>fork</code>, then <code>wait</code>, then <code>wait</code>, then <code>wait</code>. It&#39;s not surprising that when the parent process calls <code>wait</code>, it waits."}, {"owner": {"reputation": 1543, "user_id": 3704627, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6e3a7da2c79b553b211bc3fd58da6c60?s=128&d=identicon&r=PG&f=1", "display_name": "Rasalas", "link": "https://stackoverflow.com/users/3704627/rasalas"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1464129809, "post_id": 37424841, "comment_id": 62355329, "body": "@immibis thanks - but this isn&#39;t the problem, I think. The task says that the process should wait 1ms for every loop."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1464129915, "post_id": 37424841, "comment_id": 62355371, "body": "@Rasalas Why do you think that is not the problem?"}, {"owner": {"reputation": 1543, "user_id": 3704627, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6e3a7da2c79b553b211bc3fd58da6c60?s=128&d=identicon&r=PG&f=1", "display_name": "Rasalas", "link": "https://stackoverflow.com/users/3704627/rasalas"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1464130093, "post_id": 37424841, "comment_id": 62355437, "body": "@immibis well I read the 2 answers and now I kind of get what you are talking about  - sry... I thought that the wait is supposed to be there since the process should wait for 1ms for every loop."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1464130199, "post_id": 37424841, "comment_id": 62355466, "body": "Don&#39;t get into the habit of calling <code>exit</code> from your child processes. This can lead to serious errors and has, in the past, been the cause of bugs with major security implications. Use <code>_exit</code> in every process but one."}], "answers": [{"tags": [], "owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "is_accepted": false, "score": 1, "last_activity_date": 1464154761, "last_edit_date": 1464154761, "creation_date": 1464129639, "answer_id": 37425067, "question_id": 37424841, "link": "https://stackoverflow.com/questions/37424841/how-to-create-3-processes-with-fork-that-are-running-async/37425067#37425067", "title": "how to create 3 processes with fork that are running async", "body": "<p>Just missplaced { and } I think and missing flush. Not compile-tested:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid printfXtimes(int a, int b)\n{\n    int i;\n    for(i=0;i&lt;b;i++) {\n        printf(\"%i\",a);\n        fflush(stdout);\n        sleep(1);\n    }\n}\n\nint main(int argc, char *argv[]){\n    for(int kid = 0; kid &lt; 3; ++kid) {\n        int pid = fork();\n        if(pid &lt; 0){\n            exit(EXIT_FAILURE);\n        }else if (pid &gt; 0){\n            /* Parent process */\n            printf(\"ready\");\n        }else{\n            /* Child process */\n            printfXtimes(kid,20);\n            exit(EXIT_SUCCESS);\n        }\n    }\n    for (int kid = 0; kid &lt; 3; ++kid) {\n        int status;\n        pid_t pid = wait(&amp;status);\n    }\n    return  0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1464142590, "last_edit_date": 1495539845, "creation_date": 1464129726, "answer_id": 37425085, "question_id": 37424841, "link": "https://stackoverflow.com/questions/37424841/how-to-create-3-processes-with-fork-that-are-running-async/37425085#37425085", "title": "how to create 3 processes with fork that are running async", "body": "<p>Moderately workable code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic void printfXtimes(int a, int b)\n{\n    for (int i = 0; i &lt; b; i++)\n    {\n        printf(\"%i\\n\", a);\n        usleep(10000);\n        //sleep(1);\n    }\n}\n\nint main(void)\n{\n    for (int kid = 0; kid &lt; 3; ++kid)\n    {\n        int pid = fork();\n        if (pid &lt; 0)\n        {\n            exit(EXIT_FAILURE);\n        }\n        else if (pid &gt; 0)\n        {\n            /* Parent process */\n            printf(\"PID %d ready\\n\", pid);\n        }\n        else\n        {\n            /* Child process */\n            printfXtimes(kid, 10);\n            exit(EXIT_SUCCESS);\n        }\n    }\n\n    for (int kid = 0; kid &lt; 3; ++kid)\n    {\n        int status;\n        int corpse = wait(&amp;status);\n        printf(\"PID %d exited 0x%.4X\\n\", corpse, status);\n    }\n}\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li>When using <code>fork()</code>, the correct return type for <code>main()</code> is <code>int</code>, not <code>void</code>. You can use <code>void main()</code> on Windows; everywhere else, it is wrong (almost everywhere else \u2014 specific systems could document it as OK, like Windows does). See <a href=\"https://stackoverflow.com/questions/204476/\">What should main() return in C and C++?</a></li>\n<li>One problem is that after you launch each child, you wait for three children to die. That loop should be after the launch loop.  Otherwise, you're forcing sequential processing, not asynchronous processing.</li>\n<li>Another problem is that you don't use newlines at the ends of messages; this causes confusion too (see <a href=\"https://stackoverflow.com/questions/2530663/printf-anomaly-after-fork/\"><code>printf()</code> anomaly after <code>fork()</code></a>).</li>\n</ul>\n\n<p>Example output (no piping):</p>\n\n<pre><code>PID 34795 ready\nPID 34796 ready\n0\n1\n2\nPID 34797 ready\n0\n1\n2\n0\n1\n2\n0\n1\n2\n0\n1\n2\n0\n1\n2\n1\n2\n0\n1\n0\n2\n1\n0\n2\n1\n2\n0\nPID 34795 exited 0x0000\nPID 34797 exited 0x0000\nPID 34796 exited 0x0000\n</code></pre>\n\n<p>Example output (piped to <code>sed</code>):</p>\n\n<pre><code>0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nPID 34789 ready\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\nPID 34789 ready\nPID 34790 ready\n2\n2\n2\n2\n2\n2\n2\n2\n2\n2\nPID 34789 ready\nPID 34790 ready\nPID 34791 ready\nPID 34789 exited 0x0000\nPID 34791 exited 0x0000\nPID 34790 exited 0x0000\n</code></pre>\n\n<p>If you've read and understood the \"<code>printf()</code> anomaly after <code>fork()</code>\" question, you should understand about line buffering and full buffering, and the output via <code>sed</code> should be explicable (in particular, why there are extra copies of the <code>PID nnnnn ready</code> messages).</p>\n"}], "owner": {"reputation": 1543, "user_id": 3704627, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6e3a7da2c79b553b211bc3fd58da6c60?s=128&d=identicon&r=PG&f=1", "display_name": "Rasalas", "link": "https://stackoverflow.com/users/3704627/rasalas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1416, "favorite_count": 2, "accepted_answer_id": 37425085, "answer_count": 2, "score": 1, "last_activity_date": 1464154761, "creation_date": 1464128454, "last_edit_date": 1464129560, "question_id": 37424841, "link": "https://stackoverflow.com/questions/37424841/how-to-create-3-processes-with-fork-that-are-running-async", "title": "how to create 3 processes with fork that are running async", "body": "<p>I have a problem,\nI need to write a small c program that prints out a random numbers given by three processes that are printing only one number by themselfes 20 times.</p>\n\n<p>output should be something like <code>0122102021012021120...</code> and something finishing from the parent process.</p>\n\n<p>I only get outputs like: </p>\n\n<p><code>00000000000000000000ready11111111111111111111readyready22222222222222222222readyreadyready</code></p>\n\n<p>and I don't know what to do - it seems that I didn't understand the ground logic behind that fork() system ;)</p>\n\n<p>my code is:</p>\n\n<pre><code>  1 #include &lt;stdio.h&gt;\n  2 #include &lt;unistd.h&gt;\n  3 #include &lt;stdlib.h&gt;\n  4\n  5 void printfXtimes(int a, int b){\n  6         int i;\n  7         for(i=0;i&lt;b;i++){\n  8                 printf(\"%i\",a);\n  9                 sleep(1);\n 10         }\n 11 }\n 12\n 13 void main(){\n 14         for(int kid = 0; kid &lt; 3; ++kid) {\n 15                 int pid = fork();\n 16                 if(pid &lt; 0){\n 17                         exit(EXIT_FAILURE);\n 18                 }else if (pid &gt; 0){\n 19                          /* Parent process */\n 20                         printf(\"ready\");\n 21                 }else{\n 22                         /* Child process */\n 23                         printfXtimes(kid,20);\n 24                         exit(EXIT_SUCCESS);\n 25                 }\n 26                 for (int kid = 0; kid &lt; 3; ++kid) {\n 27                         int status;\n 28                         pid_t pid = wait(&amp;status);\n 29                 }\n 30\n 31         }\n 32 }\n</code></pre>\n\n<p>whats wrong here? :/\nThe task is considered \"easy\"... I don't get it...</p>\n"}, {"tags": ["c", "struct", "private"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1464127190, "post_id": 37424557, "comment_id": 62354392, "body": "Did you actually define <code>TEST_H_</code>?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1464127263, "post_id": 37424557, "comment_id": 62354428, "body": "Structs do not work like functions - structs must be defined in every translation unit that uses them."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1464127300, "post_id": 37424557, "comment_id": 62354443, "body": "<code>main()</code> without a return type is very old and invalid now."}, {"owner": {"reputation": 31, "user_id": 6378383, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1012383549/picture?type=large", "display_name": "Mohamed Fawzy", "link": "https://stackoverflow.com/users/6378383/mohamed-fawzy"}, "edited": false, "score": 0, "creation_date": 1464127510, "post_id": 37424557, "comment_id": 62354517, "body": "yes i defined TEST_H_ as i show in the code"}, {"owner": {"reputation": 31, "user_id": 6378383, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1012383549/picture?type=large", "display_name": "Mohamed Fawzy", "link": "https://stackoverflow.com/users/6378383/mohamed-fawzy"}, "edited": false, "score": 0, "creation_date": 1464127557, "post_id": 37424557, "comment_id": 62354537, "body": "the main is containing code but i didn&#39;t like to make the code area crowded"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1464206204, "post_id": 37424557, "comment_id": 62395008, "body": "in the C language, there is no concept of <code>private</code>,  However, you can perform data hiding using the technique shown in @R Sahu&#39;s answer.  Except, say nothing about the names/content of the struct in the *.h file.  Place the instance of the struct (with the <code>static</code> modifier) inside test.c, along with all the functions to manipulate that struct. Any file that wants to use that struct includes the test.h header file."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1464206471, "post_id": 37424557, "comment_id": 62395139, "body": "Note: returning pointer to the actual instance of the struct avails nothing.  Don&#39;t do that.  Only allow access to an <code>interface</code> to the struct.  Then the user can only access the struct through the interface and need know nothing about the actual struct contents/layout/location/etc."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6378383, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1012383549/picture?type=large", "display_name": "Mohamed Fawzy", "link": "https://stackoverflow.com/users/6378383/mohamed-fawzy"}, "edited": false, "score": 0, "creation_date": 1464127676, "post_id": 37424654, "comment_id": 62354577, "body": "My problem that i want to avoid any dynamic allocation, so i need to allocate the structure statically"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 31, "user_id": 6378383, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1012383549/picture?type=large", "display_name": "Mohamed Fawzy", "link": "https://stackoverflow.com/users/6378383/mohamed-fawzy"}, "edited": false, "score": 0, "creation_date": 1464127790, "post_id": 37424654, "comment_id": 62354611, "body": "@MohamedFawzy, is there a fixed number of such objects? If not, dynamic allocation is probably your only option."}, {"owner": {"reputation": 31, "user_id": 6378383, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1012383549/picture?type=large", "display_name": "Mohamed Fawzy", "link": "https://stackoverflow.com/users/6378383/mohamed-fawzy"}, "edited": false, "score": 0, "creation_date": 1464127876, "post_id": 37424654, "comment_id": 62354638, "body": "one object will be created in the whole application"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 31, "user_id": 6378383, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1012383549/picture?type=large", "display_name": "Mohamed Fawzy", "link": "https://stackoverflow.com/users/6378383/mohamed-fawzy"}, "edited": false, "score": 1, "creation_date": 1464127946, "post_id": 37424654, "comment_id": 62354668, "body": "Then you can just use create a function called <code>point* getPoint()</code> and make sure that that function returns a pointer to an object that is allocated statically."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31, "user_id": 6378383, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1012383549/picture?type=large", "display_name": "Mohamed Fawzy", "link": "https://stackoverflow.com/users/6378383/mohamed-fawzy"}, "edited": false, "score": 1, "creation_date": 1464128392, "post_id": 37424654, "comment_id": 62354821, "body": "@Mohamed Fawzy It is not considerate to add requirements like  &quot;avoid any dynamic allocation&quot; in a comment here, yet leave the info put of the post.  Add it to the post if it is important."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1464127424, "creation_date": 1464127424, "answer_id": 37424654, "question_id": 37424557, "link": "https://stackoverflow.com/questions/37424557/private-members-in-c-struct/37424654#37424654", "title": "private members in c struct", "body": "<p>You cannot create an object of type <code>struct point</code> with just a forward declaration.</p>\n\n<p>You need to add functions to construct instances of <code>struct point</code> and manipulate its data. In these functions, you deal only with pointers.</p>\n\n<p>Add the declarations in the .h file:</p>\n\n<pre><code>#ifndef TEST_H_\n#define TEST_H_\n\ntypedef struct point point;\n\npoint* constructPoint();\nvoid setX(point* p, int x);\nvoid setY(point* p, int y);\n\nint getX(point* p);\nint getY(point* p);\n\n\n#endif /* TEST_H_ */\n</code></pre>\n\n<p>Define the <code>struct</code> and the functions in the .c file:</p>\n\n<pre><code>#include \"test.h\"\nstruct point\n{\n   int x;\n   int y;\n};\n\npoint* constructPoint()\n{\n   return calloc(1, sizeof(point));\n}\n\nvoid setX(point* p, int x)\n{\n   p-&gt;x = x;\n}\n\nvoid setY(point* p, int y)\n{\n   p-&gt;y = x;\n}\n\nint getX(point* p)\n{\n   return p-&gt;x;\n}\n\nint getY(point* p)\n{\n   return p-&gt;y;\n}\n</code></pre>\n\n<p>Use the functions to construct and manipulate the object in main.c:</p>\n\n<pre><code>#include \"test.h\"\n\nint main()\n{\n   point* pt_ptr = constructPoint();\n   setX(pt_ptr, 10);\n   printf(\"%d\\n\", getX(pt_ptr));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "is_accepted": false, "score": 0, "last_activity_date": 1464127779, "creation_date": 1464127779, "answer_id": 37424704, "question_id": 37424557, "link": "https://stackoverflow.com/questions/37424557/private-members-in-c-struct/37424704#37424704", "title": "private members in c struct", "body": "<p>Well, you have already answered your question. If you are trying to hide structure members from other code, you have to use a pointer.</p>\n\n<p>The issue is, when compiler encounters this line in your code:</p>\n\n<pre><code>static point objpoint;\n</code></pre>\n\n<p>it needs to know how much space to allocate for it and for that it needs to know what are the data members of the structure. So, it has to be fully defined at this point in code with all the fields and their types.</p>\n\n<p>If you want to hide data members of the structure. You need to define a creation function returning a pointer to your structure (as noted in another answer). And only use pointers to your structure everywhere else.</p>\n\n<p>You can allocate a structure statically, but only in the file where the structure is defined. Then you can return a pointer to that variable instead of allocating a new one. But you still have to use a pointer to reference to that structure everywhere else.</p>\n"}], "owner": {"reputation": 31, "user_id": 6378383, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1012383549/picture?type=large", "display_name": "Mohamed Fawzy", "link": "https://stackoverflow.com/users/6378383/mohamed-fawzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1943, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464131858, "creation_date": 1464126853, "last_edit_date": 1592644375, "question_id": 37424557, "link": "https://stackoverflow.com/questions/37424557/private-members-in-c-struct", "title": "private members in c struct", "body": "<p>i read many threads like\n<a href=\"https://stackoverflow.com/questions/5368028/how-to-make-struct-members-private\">How to make struct members private?</a>\n<a href=\"https://stackoverflow.com/questions/2672015/hiding-members-in-a-c-struct\">Hiding members in a C struct</a>\nbut i didn't help me, such that\ni have a header file</p>\n<pre><code>#ifndef TEST_H_\n#define TEST_H_\ntypedef struct point point;\n#endif /* TEST_H_ */\n</code></pre>\n<p>and c file</p>\n<pre><code>#include &quot;test.h&quot;\nstruct point\n{\n    void *data;\n};\n</code></pre>\n<p>and when i'm trying to create an instance of point structure in the main.c as</p>\n<pre><code>static point objpoint;\nmain()\n{\n}\n</code></pre>\n<p>the compiler is getting this error\nDescription Resource    Path    Location    Type</p>\n<h1>237 variable &quot;objpoint&quot; was declared with a never-completed type   main.c</h1>\n<p>BTW, if i defined a pointer to the struct like</p>\n<pre><code>static point *ppoint;\n</code></pre>\n<p>the compiler won't generate any errors</p>\n<p>Also, one more important information that i need to avoid any dynamic allocation for the struct object</p>\n<p>please advise.</p>\n"}, {"tags": ["c", "multithreading", "assembly", "x86", "operating-system"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 7, "creation_date": 1464126449, "post_id": 37424448, "comment_id": 62354103, "body": "Hint: There is a <code>ret</code> instruction (for <code>return 0;</code>) shortly after your inline assembly. What does <code>ret</code> do?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 3, "creation_date": 1464126664, "post_id": 37424448, "comment_id": 62354188, "body": "Hint: switching stack under the compiler in a C function is a bad idea anyway."}, {"owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "edited": false, "score": 0, "creation_date": 1464136735, "post_id": 37424448, "comment_id": 62357206, "body": "Why would you expect anything other than an access violation after moving 0 into the stack pointer?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "reply_to_user": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "edited": false, "score": 3, "creation_date": 1464137301, "post_id": 37424448, "comment_id": 62357336, "body": "@user3344003 it does not move a <code>0</code>. It moves <code>%0</code> which is operand <code>0</code> which in turn is a register holding <code>stackArray</code>. So at least that part is not wrong ;)"}, {"owner": {"reputation": 1, "user_id": 6364266, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201637586097191/picture?type=large", "display_name": "Ishan Varade", "link": "https://stackoverflow.com/users/6364266/ishan-varade"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1464153179, "post_id": 37424448, "comment_id": 62361078, "body": "@immibis &#39;return 0&#39; is a exit status of the application. &#39;0&#39; use to show the success status of program. If you are talking about ret instruction than it simply pop the instruction address from the stack and jump to that address to start execute."}, {"owner": {"reputation": 1, "user_id": 6364266, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201637586097191/picture?type=large", "display_name": "Ishan Varade", "link": "https://stackoverflow.com/users/6364266/ishan-varade"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1464153543, "post_id": 37424448, "comment_id": 62361193, "body": "@Jester, I want to context switch the thread therefore I need %ESP(stack pointer register) to point to the stack pointer address that is stored in Thread Control Block."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1464153544, "post_id": 37424448, "comment_id": 62361195, "body": "@IshanVarade I know what <code>return 0;</code> does and I know what <code>ret</code> does. The compiler translates <code>return 0;</code> into assembly code. It probably translates it into something like <code>mov $0, eax</code> followed by <code>ret</code>. Which then pops the return address off the stack at the location pointed to by <code>esp</code>. But wait, there&#39;s just garbage there, not a return address!"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 1, "creation_date": 1464173107, "post_id": 37424448, "comment_id": 62372630, "body": "Then you must be completely unaware that <code>ret</code> is going to use the address <i>on the top of the stack</i> to return... but you have just pointed the stack pointer somewhere else entirely and that stack contains a big fat zero on the top (<code>calloc</code>)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1464214421, "post_id": 37424448, "comment_id": 62398813, "body": "I kinda want to downvote this for failure to understand the answer, but that&#39;s not a problem with the question, just the asker.  Maybe single-stepping instructions in a debugger (<code>layout asm</code> and <code>stepi</code> in gdb) will help you see   what&#39;s going on.  See more on the <a href=\"http://stackoverflow.com/tags/x86/info\">x86 tag wiki</a>."}], "owner": {"reputation": 1, "user_id": 6364266, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201637586097191/picture?type=large", "display_name": "Ishan Varade", "link": "https://stackoverflow.com/users/6364266/ishan-varade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464126503, "creation_date": 1464126356, "last_edit_date": 1464126503, "question_id": 37424448, "link": "https://stackoverflow.com/questions/37424448/is-it-possible-to-change-esp", "title": "Is it possible to change %esp", "body": "<pre><code>int main()\n{\n   int *stackArray = calloc(15, sizeof(int));\n\n   asm volatile ( \"movl %0, %%esp  \\t\\n\"\n       : \n       : \"r\" (stackArray)\n       : );\n\n   return 0;\n}\n</code></pre>\n\n<p>I'm compiling this by using <code>gcc -m32</code></p>\n\n<p>But when I running the program it gives \n<code>segmentation fault (core dump)</code>\nI want to context switch the threads but I'm finding above error when I'm trying to point <code>%esp</code> to other array.</p>\n"}, {"tags": ["c", "linux", "pipe"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1464125406, "post_id": 37424101, "comment_id": 62353646, "body": "You&#39;re overwriting <code>fd2</code> before you fork each child. When you get to the buffer filling part, you&#39;re just writing to the pipe for the last child."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1464125995, "post_id": 37424101, "comment_id": 62353910, "body": "When I run it with 2 child processes, the second child gets into an infinite loop in the <code>while(read)</code> loop. You need to check for EOF and stop the loop."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1464126194, "post_id": 37424101, "comment_id": 62353989, "body": "Your error detection logic is wrong here: <code>!(pipe(fd) &gt; -1 || pipe(fd2) &gt; -1)</code>.  <i>Both</i> <code>pipe()</code> calls must return non-negative values (in fact, 0), else an error has occurred.  You therefore want <code>&amp;&amp;</code> instead of <code>||</code>."}, {"owner": {"reputation": 901, "user_id": 2759002, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da56a1cda361fe8d877c115da7901e91?s=128&d=identicon&r=PG&f=1", "display_name": "KrunalParmar", "link": "https://stackoverflow.com/users/2759002/krunalparmar"}, "edited": false, "score": 0, "creation_date": 1464148279, "post_id": 37424101, "comment_id": 62359688, "body": "use gdb to debug. follow child process."}], "owner": {"reputation": 119, "user_id": 3348252, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/723b9c3caafac6904649a1b47e11788d?s=128&d=identicon&r=PG&f=1", "display_name": "Actaeonis", "link": "https://stackoverflow.com/users/3348252/actaeonis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464125157, "creation_date": 1464124762, "last_edit_date": 1464125157, "question_id": 37424101, "link": "https://stackoverflow.com/questions/37424101/c-using-pipe-to-communicate-with-child-processes-in-two-directions", "title": "C, using pipe() to communicate with child processes in two directions", "body": "<p>I'm trying to write a program that functions as follows:</p>\n\n<ul>\n<li>User gives amount of child processes wanted</li>\n<li>Each child generates a random number, and passes it to the parent along with the according PID.</li>\n<li>Parent decides the winner</li>\n<li>Parent fills buffer with the winning number</li>\n<li>Childs check if they've won or not</li>\n</ul>\n\n\n\n<pre><code>struct Data {\n    int pid;\n    int nummer;\n};\n\nint main(int argc, char ** argv) {\n\n    int aantal = atoi(argv[1]);\n    printf(\"Amount : %d \\n\", aantal);\n    int j;\n    int pids[aantal];\n    int kinderen = 0;\n    int i;\n    int fd[2];\n    int fd2[2];\n    int winnaar = 0;\n    int grootste = 0;\n    int pid;\n\n    for (i = 0; i &lt; aantal; i++) {\n        if (!(pipe(fd) &gt; -1 || pipe(fd2) &gt; -1)) {\n            printf(\"Pipe error!\");\n            exit(0);\n        }\n\n        if ((pid = fork()) == 0) {\n            srand(getpid());\n            struct Data data;\n            data.nummer = rand();\n            data.pid = getpid();\n            close(fd[0]);\n            close(fd2[1]);\n            printf(\"Try to send... \\n\");\n            write(fd[1], (void * )( &amp; data), sizeof(struct Data));\n            printf(\"Sent! \\n\");\n\n            int nummer;\n            while ((read(fd2[0], (void * )( &amp; nummer), sizeof(int))) != sizeof(int));\n            printf(\"Received %d \\n\", nummer);\n\n            if (nummer == getpid()) {\n                printf(\"Not the winning process!\");\n                exit(0);\n            } else {\n                printf(\"I won!, %d\", nummer);\n                exit(0);\n            }\n            //kinderen++;\n        } else {\n            close(fd[1]);\n            close(fd2[0]);\n            int wachten = 0;\n            int fout = 1;\n            struct Data ontvangen;\n\n            if ((fout = read(fd[0], (void * )( &amp; ontvangen), sizeof(struct Data))) &gt; 0) {\n                printf(\"PID: %d GETAL: %d \\n\", ontvangen.pid, ontvangen.nummer);\n                wachten++;\n                if (grootste == 0 || grootste &lt; ontvangen.nummer) {\n                    printf(\"Compare \\n\");\n                    grootste = ontvangen.nummer;\n                    winnaar = ontvangen.pid;\n                }\n                printf(\"Compared \\n\");\n            }\n        }\n    }\n\n    int k = 0;\n    for (k = 0; k &lt; aantal; k++) {\n        printf(\"Filling buffer...\");\n        write(fd2[1], (void * )( &amp; winnaar), sizeof(int));\n    }\n\n    while (wait(NULL) &gt; 0) {\n        printf(\"Waiting for childs to exit\");\n    }\n}\n</code></pre>\n\n<p>However I never get to the buffer filling part, anybody who can aid me?</p>\n\n<p>Can't get the formatting to work for some reason :/. Pastebin link: <a href=\"http://pastebin.com/61zrC6pb\" rel=\"nofollow\">http://pastebin.com/61zrC6pb</a></p>\n"}, {"tags": ["c", "avr", "servo"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1464124992, "post_id": 37424070, "comment_id": 62353466, "body": "Do you know what <code>void f(int x) {x = 5;} int main() {int y = 7; f(y); printf(&quot;%i\\n&quot;, y); return 0;}</code> prints? (in normal C, not AVR)"}, {"owner": {"reputation": 35, "user_id": 6361398, "user_type": "registered", "profile_image": "https://graph.facebook.com/1100048883392150/picture?type=large", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/6361398/mateusz"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1464125153, "post_id": 37424070, "comment_id": 62353532, "body": "I think i know its 5"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1464125306, "post_id": 37424070, "comment_id": 62353605, "body": "@Mateusz It prints 7, because <code>x</code> is a different variable from <code>y</code>, and <code>x = 5;</code> changes <code>x</code>, not <code>y</code>."}, {"owner": {"reputation": 35, "user_id": 6361398, "user_type": "registered", "profile_image": "https://graph.facebook.com/1100048883392150/picture?type=large", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/6361398/mateusz"}, "edited": false, "score": 0, "creation_date": 1464125477, "post_id": 37424070, "comment_id": 62353674, "body": "So what will be the solution for this?"}, {"owner": {"reputation": 1224, "user_id": 4950659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ygz0E.jpg?s=128&g=1", "display_name": "AdminXVII", "link": "https://stackoverflow.com/users/4950659/adminxvii"}, "edited": false, "score": 0, "creation_date": 1464125924, "post_id": 37424070, "comment_id": 62353874, "body": "<code>void f(int* x) {*x = 5;} int main() {int y = 7; f(&amp;y); printf(&quot;%i\\n&quot;, y); return 0;}</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1224, "user_id": 4950659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ygz0E.jpg?s=128&g=1", "display_name": "AdminXVII", "link": "https://stackoverflow.com/users/4950659/adminxvii"}, "edited": false, "score": 0, "creation_date": 1464126089, "post_id": 37424070, "comment_id": 62353947, "body": "@adminXVII Post that as an answer."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1464194960, "post_id": 37424070, "comment_id": 62388839, "body": "1)  the variable: <code>variable</code>, is not declared. 2) if <code>variable</code> is not a float, then this line: <code>variable=variable&#47;10;</code> will perform a integer divide, probably not what you want."}], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 35, "user_id": 6361398, "user_type": "registered", "profile_image": "https://graph.facebook.com/1100048883392150/picture?type=large", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/6361398/mateusz"}, "edited": false, "score": 0, "creation_date": 1464195180, "post_id": 37424432, "comment_id": 62388963, "body": "@Mateusz,  if you like the answer, then &#39;select&#39; it so this question will close AND <code>admin XVII</code> will be properly credited for the answer"}], "tags": [], "owner": {"reputation": 1224, "user_id": 4950659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ygz0E.jpg?s=128&g=1", "display_name": "AdminXVII", "link": "https://stackoverflow.com/users/4950659/adminxvii"}, "is_accepted": true, "score": 1, "last_activity_date": 1464126286, "creation_date": 1464126286, "answer_id": 37424432, "question_id": 37424070, "link": "https://stackoverflow.com/questions/37424070/c-what-is-wrong-with-function/37424432#37424432", "title": "C what is wrong with function?", "body": "<p>If you want to change a variable you passed to a function, you must use <a href=\"http://www.tutorialspoint.com/cprogramming/c_pointers.htm\" rel=\"nofollow\">pointers</a>.</p>\n\n<p>Basically it's used like this:</p>\n\n<pre><code>void f(int* x){\n  *x = 5;\n}\n\nint main() {\n  int y = 7;\n  f(&amp;y);\n  printf(\"%i\\n\", y);\n  return 0;\n}\n</code></pre>\n\n<p>In short, <code>&amp;</code> get the address of the variable and <code>*</code> get the value at the address</p>\n"}], "owner": {"reputation": 35, "user_id": 6361398, "user_type": "registered", "profile_image": "https://graph.facebook.com/1100048883392150/picture?type=large", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/6361398/mateusz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 37424432, "answer_count": 1, "score": -4, "last_activity_date": 1464126286, "creation_date": 1464124640, "question_id": 37424070, "link": "https://stackoverflow.com/questions/37424070/c-what-is-wrong-with-function", "title": "C what is wrong with function?", "body": "<p>Hi i have problem with function to control my 4servos. I want to take this code to function but it's not working. </p>\n\n<pre><code>volatile float servo1;\n\n            variable=  uart_getchar();\n            _delay_ms(100);\n            variable=variable/10;\n            servo1=variable;\n            sprintf(bufor,\"Servo_1= %4.1f\\n\",servo1);\n            uart_puts(bufor);\n</code></pre>\n\n<p>when this code is not in function everything is okay, servo works good. Problem is when i do this:</p>\n\n<pre><code>void get(float Servo, char Number)\n{\n            variable=  uart_getchar();\n            _delay_ms(100);\n            variable=variable/10;\n            Servo=variable;\n            sprintf(bufor,\"Serwo_%c= %4.1f\\n\",Number,Servo);\n            uart_puts(bufor);\n}\n</code></pre>\n\n<p>and when i call <code>get(servo1,'1');</code>servo stayed in the same place all the time.. any idea what is wrong??</p>\n"}, {"tags": ["java", "c", "char", "java-native-interface", "buffer"], "comments": [{"owner": {"reputation": 26542, "user_id": 3699139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYdt3.jpg?s=128&g=1", "display_name": "Jorn Vernee", "link": "https://stackoverflow.com/users/3699139/jorn-vernee"}, "edited": false, "score": 0, "creation_date": 1464124108, "post_id": 37423867, "comment_id": 62353041, "body": "The java <code>char</code> and C <code>char</code> types are incompatible, it would probably be better to pass the <code>byte[]</code> to C and then convert each element on demand"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1464124552, "post_id": 37423867, "comment_id": 62353255, "body": "&quot;How can I use Java Native Interface to pass a byte array into a C function which takes a char* as an argument?&quot; - you can&#39;t, but you can pass a byte array into a C function which takes a Java byte array as an argument."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1464126546, "post_id": 37424193, "comment_id": 62354137, "body": "A bit more explanation would make this a better answer.  A copy from your comment would be a good start, but it would also be worth mentioning that a Java array as received by a native method is <i>not</i> a C array.  You have to use the appropriate JNI function to obtain from it an actual C array (as you demonstrate), and that puts some additional requirements on the overall native method implementation."}, {"owner": {"reputation": 26542, "user_id": 3699139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYdt3.jpg?s=128&g=1", "display_name": "Jorn Vernee", "link": "https://stackoverflow.com/users/3699139/jorn-vernee"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1464127569, "post_id": 37424193, "comment_id": 62354540, "body": "@JohnBollinger Thanks for the suggestion. I kind of assumed that OP already knew most of this. But any ways, I sometimes forget other people will read this too ;)"}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 1, "creation_date": 1464158236, "post_id": 37424193, "comment_id": 62363190, "body": "The importance of the Release* functions is to unpin the objects in the JVM heap. The array elements are not necessarily copied by Get* and so JNI_ABORT does not necessarily avoid modifying the JVM array; It only saves time <i>if</i> there was a copy.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6373390"}, "edited": false, "score": 0, "creation_date": 1464196760, "post_id": 37424193, "comment_id": 62389823, "body": "@JornVernee Hey, thanks a lot! This works, and I am effectively able to print and change the values inside the memory buffer. Is there any chance you could answer my very similar question regarding calling a C library from python? You seem to know what you&#39;re talking about. Thanks again."}, {"owner": {"reputation": 26542, "user_id": 3699139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYdt3.jpg?s=128&g=1", "display_name": "Jorn Vernee", "link": "https://stackoverflow.com/users/3699139/jorn-vernee"}, "edited": false, "score": 0, "creation_date": 1464197120, "post_id": 37424193, "comment_id": 62390017, "body": "@Mr.Pickles No sorry, I don&#39;t know much about python."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6373390"}, "edited": false, "score": 0, "creation_date": 1464211884, "post_id": 37424193, "comment_id": 62397785, "body": "@JornVernee So when I modify the loop in the C method to say buffer[i] = buffer[i] + 1, and run the java program, I can see that it prints &quot;ifmmp&quot; instead of &quot;hello&quot;, which is what I want. Is there any way to see that change from the java side? Is there any way for me to say: &#39;String hello = &quot;hello&quot;&#39; and when I call the method: &#39;passBytes(hello.getBytes)&#39; it actually updates the value of the string in JAVA to &quot;ifmmp&quot;? So that if I print hello, I would get the value that the C method incremented that was stored in the heap? Thanks"}, {"owner": {"reputation": 26542, "user_id": 3699139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYdt3.jpg?s=128&g=1", "display_name": "Jorn Vernee", "link": "https://stackoverflow.com/users/3699139/jorn-vernee"}, "edited": false, "score": 0, "creation_date": 1464212283, "post_id": 37424193, "comment_id": 62397956, "body": "@Mr.Pickles Not directly, since strings in java are immutable, the byte array returned by <code>String::getBytes</code> is an encoding of the actual value in the platform&#39;s standard character set. By passing <code>0</code> instead of <code>JNI_ABORT</code> to the release function, it will copy back any changes. You can then use the changed <code>byte[]</code> in java to create a new string. i.e. <code>byte[] b = &quot;hello&quot;.getBytes(); passBytes(b); String str = new String(b);</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6373390"}, "edited": false, "score": 0, "creation_date": 1464213273, "post_id": 37424193, "comment_id": 62398359, "body": "@JornVernee I changed it to 0, but in the case when I call passBytes(b), make the string str and print it in java, I still see &quot;hello&quot; and not &quot;ifmmp&quot;. I want it so that if I take a byte array in java and pass it through the C function then print out the same byte array, the incremented value in the function changes the value when printed to java. Is that possible?"}, {"owner": {"reputation": 26542, "user_id": 3699139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYdt3.jpg?s=128&g=1", "display_name": "Jorn Vernee", "link": "https://stackoverflow.com/users/3699139/jorn-vernee"}, "edited": false, "score": 0, "creation_date": 1464213367, "post_id": 37424193, "comment_id": 62398392, "body": "@Mr.Pickles I tested it out and it works fine for me, with the exact code I posted in the last comment. I don&#39;t know what to tell you..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6373390"}, "edited": false, "score": 0, "creation_date": 1464215301, "post_id": 37424193, "comment_id": 62399154, "body": "@JornVernee You&#39;re saying that when you call passBytes(b), then print out str, your output is ifmmpifmmp?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6373390"}, "edited": false, "score": 0, "creation_date": 1464215930, "post_id": 37424193, "comment_id": 62399372, "body": "@JohnVernee Nevermind, got it to work. Thanks for the help!!"}], "tags": [], "owner": {"reputation": 26542, "user_id": 3699139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYdt3.jpg?s=128&g=1", "display_name": "Jorn Vernee", "link": "https://stackoverflow.com/users/3699139/jorn-vernee"}, "is_accepted": true, "score": 7, "last_activity_date": 1464174154, "last_edit_date": 1464174154, "creation_date": 1464125211, "answer_id": 37424193, "question_id": 37423867, "link": "https://stackoverflow.com/questions/37423867/how-can-i-use-java-native-interface-to-pass-a-byte-array-into-a-c-function-which/37424193#37424193", "title": "How can I use Java Native Interface to pass a byte array into a C function which takes a char* as an argument?", "body": "<p>The Java <code>char</code> and C <code>char</code> types are incompatible, it would probably be better to pass the <code>byte[]</code> to C and then convert each element on demand.</p>\n\n<hr>\n\n<p>Something along these lines:</p>\n\n<p>Main.java:</p>\n\n<pre><code>//...Code to load library...\n\npublic static void main(String[] args) {\n    passBytes(\"hello\".getBytes());\n}\n\npublic static native void passBytes(byte[] bytes);\n</code></pre>\n\n<p>Main.c:</p>\n\n<pre><code>#include \"Main.h\" // Main.h is generated\n\nJNIEXPORT void JNICALL Java_Main_passBytes\n  (JNIEnv *env, jclass clazz, jbyteArray array) {\n    unsigned char* buffer = (*env)-&gt;GetByteArrayElements(env, array, NULL);\n    jsize size = (*env)-&gt;GetArrayLength(env, array);\n\n    for(int i = 0; i &lt; size; i++) {\n        printf(\"%c\", buffer[i]);\n    }\n\n    (*env)-&gt;ReleaseByteArrayElements(env, array, buffer, JNI_ABORT);\n }\n</code></pre>\n\n<hr>\n\n<p><code>jbyteArray</code> is nothing more then a stub type, defined in <code>jni.h</code>:</p>\n\n<pre><code>struct _jobject;\ntypedef struct _jobject *jobject;\ntypedef jobject jarray;\ntypedef jarray jbyteArray;\n</code></pre>\n\n<p>It doesn't actually contain any data. It is more or less just a memory adress.</p>\n\n<p>To get the elements from it we pass it to <a href=\"http://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/functions.html#wp17382\" rel=\"noreferrer\"><code>GetByteArrayElements</code></a> (since the type was <code>byte[]</code>) which can than ask the VM to retrieve the elements in a C style array. (It might or might not make a copy. See doc)</p>\n\n<p>The same is done for the array length.</p>\n\n<p>To tell the VM we're done with the array. We call <a href=\"http://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/functions.html#wp17440\" rel=\"noreferrer\"><code>ReleaseArrayElements</code></a>.</p>\n\n<p>Also, <code>jbyte</code> is defined as <code>signed char</code>, so just using the result of <code>GetByteArrayElements</code> as an <code>unsigend char*</code> instead of <code>jbyte*</code> is safe in this case.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6373390"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5504, "favorite_count": 0, "accepted_answer_id": 37424193, "answer_count": 1, "score": 7, "last_activity_date": 1464174154, "creation_date": 1464123845, "question_id": 37423867, "link": "https://stackoverflow.com/questions/37423867/how-can-i-use-java-native-interface-to-pass-a-byte-array-into-a-c-function-which", "title": "How can I use Java Native Interface to pass a byte array into a C function which takes a char* as an argument?", "body": "<p>So I need to use JNI to call a C function from java. I've been able to successfully do this when passing in different data types (create the native variables, header file, shared library, blah blah), but can't get it to work with a byte array. Here's my C function:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid encrypt(int size, unsigned char *buffer);\nvoid decrypt(int size, unsigned char *buffer);\n\nvoid encrypt(int size, unsigned char *buffer){\n    for(int i=0; i&lt;size; i++){\n        unsigned char c = buffer[i];\n        printf(\"%c\",c);\n    }\n}\nvoid decrypt(int size, unsigned char *buffer){\n    for(int i=0; i&lt;size; i++){\n        unsigned char c = buffer[i];\n        printf(\"%c\",c);\n    }\n}\n</code></pre>\n\n<p>And here's my java code (I understand that after making a header file from this, I have to replace the C function declarations by the JNI code in the header file)</p>\n\n<pre><code>class Tester{\n    public native void encrypt(int size, char *buffer);\n    public native void decrypt(int size, char *buffer);\n    static{\n    System.loadLibrary(\"buffer\");\n    {\n    public static void main(String[] args){\n        Tester test = new Tester();\n        String hello = \"hello\";\n        byte[] byteHello = hello.getBytes();\n        test.encrypt(5,byteHello);\n        test.decrypt(5,byteHello);\n    }\n}\n</code></pre>\n\n<p>I get that the char* type isn't supported in Java and that's why I'm getting an error trying to compile. Perhaps I should change the type to char[] in Java? Anyways, my goal is to be able to pass a byte array in Java into my C function, iterate through the byte array, and print out each element.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1464123331, "post_id": 37423672, "comment_id": 62352617, "body": "It&#39;s kinda funny how <code>scanf_s()</code> is supposed to be &quot;safer&quot;. I keep seeing it misused  horribly."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464123351, "post_id": 37423672, "comment_id": 62352629, "body": "<code>scanf_s(&quot;%s&quot;,str);</code> --&gt; <code>scanf_s(&quot;%99s&quot;, str, sizeof str);</code>"}, {"owner": {"reputation": 108986, "user_id": 511529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YNRmY.jpg?s=128&g=1", "display_name": "GolezTrol", "link": "https://stackoverflow.com/users/511529/goleztrol"}, "edited": false, "score": 8, "creation_date": 1464123433, "post_id": 37423672, "comment_id": 62352671, "body": "&quot;<i>Exception thrown blah blah blah. What&#39;s wrong?</i>&quot; - That &quot;blah blah blah&quot; bit is where the information is. :S Somewhere in the past 4 hours you must have read that message. ;o)"}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1464123626, "post_id": 37423672, "comment_id": 62352777, "body": "I don&#39;t use Windows and consequently don&#39;t know exactly what <code>scanf_s</code> does, but if I replace it with <code>scanf</code>, then this program works for me, at least. And I see no obvious reason why it shouldn&#39;t work."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464123674, "post_id": 37423672, "comment_id": 62352804, "body": "@BLUEPIXY: That seems kind of belt-and-suspenders. Why both <code>scanf_s()</code> with a limit <i>and</i> <code>%99s</code>?"}, {"owner": {"reputation": 3, "user_id": 6378179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1a827f24a477908b54f6a0bd55480c9?s=128&d=identicon&r=PG&f=1", "display_name": "Hoop", "link": "https://stackoverflow.com/users/6378179/hoop"}, "edited": false, "score": 0, "creation_date": 1464124158, "post_id": 37423672, "comment_id": 62353065, "body": "lol so i took BLUEPIXY&#39;s advice and now i&#39;m getting a LNK1168 error... I&#39;m going to post a different question with different code that might make more sense"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1464124191, "post_id": 37423672, "comment_id": 62353082, "body": "@EOF if you use MSVC, try <a href=\"http://ideone.com/S5A8oo\" rel=\"nofollow noreferrer\">this</a> input <code>abcdefg</code>."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464124802, "post_id": 37423672, "comment_id": 62353365, "body": "@BLUEPIXY: Sorry, I&#39;m on Linux. The only problem I see with your example is the undefined behavior for passing a <code>size_t</code> in place of <code>rsize_t</code> (or <code>unsigned</code> according to Microsoft)."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1464124911, "post_id": 37423672, "comment_id": 62353426, "body": "@EOF The main thing is that both of the operation is not the same."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1464125930, "post_id": 37423672, "comment_id": 62353876, "body": "@EOF C defines <code>rsize_t</code> as <code>size_t</code> in its normative section K. Yet agree <code>(rsize_t) sizeof (...)</code> or equivalent is better."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464126258, "post_id": 37423672, "comment_id": 62354029, "body": "@chux: Somebody should notify Microsoft that their interpretation of the bounds-checking interfaces is not C11-compliant. Oh, wait..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1464126317, "post_id": 37423672, "comment_id": 62354053, "body": "@EOF <a href=\"https://en.wikipedia.org/wiki/Embrace,_extend_and_extinguish\" rel=\"nofollow noreferrer\">Embrace, enhance, extinguish</a>"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1464126393, "post_id": 37423672, "comment_id": 62354079, "body": "@chux: Well, considering that a) Microsoft doesn&#39;t even do C99, and b) Nobody <i>but</i> Microsoft uses the bounds-checking interfaces, I&#39;d say this is a bit ridiculous at this point."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1464193059, "post_id": 37423672, "comment_id": 62387745, "body": "1) use standard C library functions.  I.E. use <code>scanf()</code> not <code>scanf_s()</code>  2) always check the returned value (not the parameter value) to assure the operation was successful. 3) when using the &#39;%s&#39; input/conversion specifier, always use a &#39;max characters&#39; modifier that is 1 less than the actual length of the input buffer.  I.E. <code>if( 1 != scanf( &quot;%99s&quot;, str ) ) { &#47;&#47; handle error }</code>   Without the &#39;max characters&#39; modifier, the user can overrun the input buffer, which is undefined behaviour and can lead to a seg fault event."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1464193200, "post_id": 37423672, "comment_id": 62387832, "body": "The posted code contains a &#39;magic&#39; number.  (100)  &#39;magic&#39; numbers are numbers without a basis.  &#39;magic&#39; numbers make the code much more difficult to understand, debug, maintain.  Suggest using a <code>enum</code> statement or <code>#define</code> statements to give magic numbers meaningful names, Then use those meaningful names throughout the code."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464126053, "post_id": 37423842, "comment_id": 62353931, "body": "<code>scanf_s()</code> is in Microsoft Visual Studio and it is in C11&#39;s <i>Annex K (normative) Bounds-checking interfaces</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464126226, "post_id": 37423842, "comment_id": 62354017, "body": "The 100 should be of type <code>rsize_t</code> per C, and <code>unsigned</code> per MS.  Good luck!"}], "tags": [], "owner": {"reputation": 1224, "user_id": 4950659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ygz0E.jpg?s=128&g=1", "display_name": "AdminXVII", "link": "https://stackoverflow.com/users/4950659/adminxvii"}, "is_accepted": true, "score": 1, "last_activity_date": 1464123770, "creation_date": 1464123770, "answer_id": 37423842, "question_id": 37423672, "link": "https://stackoverflow.com/questions/37423672/converting-individual-characters-of-a-string-into-ascii-values-on-one-line-c/37423842#37423842", "title": "Converting individual characters of a string into ASCII values on one line, C", "body": "<p>The <code>scanf_s()</code> function must be used with a third argument to indicate the max length of the string i.e. <code>scanf_s(\"%s\", str, 100);</code></p>\n\n<p>BTW <code>scanf_s()</code> is specific to Microsoft Visual Studio so it's less portable so I don't recommend it and <code>str</code> isn't a really good variable name</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1464194273, "creation_date": 1464194273, "answer_id": 37443077, "question_id": 37423672, "link": "https://stackoverflow.com/questions/37423672/converting-individual-characters-of-a-string-into-ascii-values-on-one-line-c/37443077#37443077", "title": "Converting individual characters of a string into ASCII values on one line, C", "body": "<p>The posted code is:</p>\n\n<ol>\n<li>not portable</li>\n<li>contains 'magic' (not basis for value) numbers</li>\n<li>spreads the variable <code>i</code> declaration far from its' usage</li>\n<li>will not input past a 'white space' character</li>\n</ol>\n\n<p>The following code corrects those problems, checks for errors, and compiles cleanly</p>\n\n<pre><code>#include &lt;stdio.h&gt;   // scanf(), printf(), perror()\n#include &lt;stdlib.h&gt;  // exit(), EXIT_FAILURE\n\n#define MAX_STR_LEN (100)\n\nint main( void )\n{\n\n    char str[ MAX_STR_LEN ];\n\n    printf(\"Enter any string: \");\n    if( NULL == fgets( str, sizeof(str), stdin ))\n    {\n        perror( \"fgets failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, scanf successful\n\n    printf(\"ASCII values of each characters of given string: \");\n    for( size_t i=0; str[i]; i++ )\n         printf(\"%d \",str[i]);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>Note: the above code will input the newline and print it (10 on linux)  You might want to use something to eliminate the newline, so insert the following, right after the call to <code>fgets()</code>:</p>\n\n<pre><code>char *newline = NULL;\nif( NULL != ( newline = strstr( str, \"\\n\" ) ) )\n{ // carriage return found\n    *newline = '\\0';\n}\n</code></pre>\n\n<p>This method of eliminating the newline char means the code also needs:</p>\n\n<pre><code>#include &lt;string.h&gt; // strstr()\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6378179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1a827f24a477908b54f6a0bd55480c9?s=128&d=identicon&r=PG&f=1", "display_name": "Hoop", "link": "https://stackoverflow.com/users/6378179/hoop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 37423842, "answer_count": 2, "score": 0, "last_activity_date": 1464194273, "creation_date": 1464123170, "last_edit_date": 1464123227, "question_id": 37423672, "link": "https://stackoverflow.com/questions/37423672/converting-individual-characters-of-a-string-into-ascii-values-on-one-line-c", "title": "Converting individual characters of a string into ASCII values on one line, C", "body": "<p>keep in mind i'm a complete beginner and i'm still getting acclimated to the programming vocabulary.</p>\n\n<p>When I run the debug from visual studio, the command prompt comes up with \"Enter any string: \" but when I enter something, i get \"Exception thrown blah blah blah\". What is going wrong? Any help and criticism is greatly appreciated. I've been losing my mind over this for 4 hours now.</p>\n\n<p>Heres my code:</p>\n\n<pre><code>int main(){\n\n    char str[100];\n    int i=0;\n\n    printf(\"Enter any string: \");\n    scanf_s(\"%s\",str);\n\n    printf(\"ASCII values of each characters of given string: \");\n    while(str[i])\n         printf(\"%d \",str[i++]);\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "real-time", "vxworks"], "answers": [{"tags": [], "owner": {"reputation": 2771, "user_id": 4163321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrgsU.gif?s=128&g=1", "display_name": "Lukas Thomsen", "link": "https://stackoverflow.com/users/4163321/lukas-thomsen"}, "is_accepted": true, "score": 2, "last_activity_date": 1464328976, "creation_date": 1464328976, "answer_id": 37475915, "question_id": 37423432, "link": "https://stackoverflow.com/questions/37423432/how-do-i-decide-between-taskspawn-period-and-watchdogs/37475915#37475915", "title": "How do I decide between taskSpawn(), period(), and watchdogs?", "body": "<p>Here is a little clarification:</p>\n\n<ul>\n<li><p><code>taskSpawn(..)</code> creates a task with which you're free to do anything with you like.</p></li>\n<li><p>Watchdogs shall only be used to monitor time constraints. Remember that the callback of the watchdog is executed within the context of the system clock ISR which has many limitations (e.g. free stack size, never use blocking function calls in an ISR, ...). Additionally executing \"a lot of code\" in the system clock ISR slows down your entire system.</p></li>\n<li><p><code>period(..)</code> is intended to be a helper for the VxWorks shell and not to be used by a program.</p></li>\n</ul>\n\n<p>With that being said your only option is to use <code>taskSpawn(..)</code> unless you're doing some very simple stuff in which case <code>period(..)</code> might be ok to use.</p>\n\n<p>If you need to do things cyclically in a specific time frame you might look at timers or <code>taskDelay(..)</code> in combination with <code>sysClkRateSet(..)</code>.</p>\n\n<p>Another option is to create two tasks. One that is setting a semaphore after a specific time intervall and the other \"worker\" tasks waits for this semaphore to do something. With that approach you separate \"timing\" from \"action\" which proved to be benefitial according to my experience. You also might want to monitor excution time of the \"worker\" task by using a watchdog.</p>\n"}], "owner": {"reputation": 31428, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 37475915, "answer_count": 1, "score": 1, "last_activity_date": 1464328976, "creation_date": 1464122361, "last_edit_date": 1464180201, "question_id": 37423432, "link": "https://stackoverflow.com/questions/37423432/how-do-i-decide-between-taskspawn-period-and-watchdogs", "title": "How do I decide between taskSpawn(), period(), and watchdogs?", "body": "<p>We are using embedded C for the VxWorks real time operating system.<br>\nCurrently, all of our UDP connections are started with <a href=\"http://www.vxdev.com/docs/vx55man/vxworks/ref/taskLib.html#taskSpawn\" rel=\"nofollow\">TaskSpawn()</a>.  </p>\n\n<blockquote>\n  <p><em>This routine creates and activates a new task with a specified</em><br>\n  <em>priority and options and returns a system-assigned ID.</em></p>\n</blockquote>\n\n<p>We specify the task size, a priority, and pass in an entry point.<br>\nThese are continuous connections, and thus every entry point contains an infinite loop where we delay before the next iteration.  </p>\n\n<p>Then I discovered <a href=\"http://www.vxdev.com/docs/vx55man/vxworks/ref/usrLib.html#period\" rel=\"nofollow\">period()</a>.  </p>\n\n<blockquote>\n  <p><em>period spawns a task to call a function periodically.</em>  </p>\n</blockquote>\n\n<p>Period sounds like what we should be using instead, but I can't find any information on when you would prefer this function over TaskSpawn.  Period also doesn't  allow specifying the task size or the priority, so how is it decided?  Is the task size dynamic?  What will the priority be?  </p>\n\n<p>There are also <a href=\"http://www.vxdev.com/docs/vx55man/vxworks/ref/wdLib.html\" rel=\"nofollow\">watchdogs</a>.  </p>\n\n<blockquote>\n  <p><em>Any task may create a watchdog timer and use it to run a specified</em>\n  <em>routine in the context of the system-clock ISR, after a specified</em>\n  <em>delay.</em></p>\n</blockquote>\n\n<p>Again, this seems to be in line with the goal of processing data at a particular rate.  Which do I choose when a task must continuously execute code at the same rate (i.e. in real time)?<br>\nWhat are the differences between these 3 methods?</p>\n"}, {"tags": ["python", "c", "shared-libraries", "ctypes"], "answers": [{"comments": [{"owner": {"reputation": 2856, "user_id": 230851, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/85bfabc247b68f8f12f2449386f7e92d?s=128&d=identicon&r=PG", "display_name": "orion elenzil", "link": "https://stackoverflow.com/users/230851/orion-elenzil"}, "edited": false, "score": 0, "creation_date": 1521499406, "post_id": 37488156, "comment_id": 85748410, "body": "this is very helpful, thank you. for the python-ignorant out there in the future, if your C function takes only a single argument, specify <code>argtype</code> as <code>[ctypes.some_type]</code> rather than as <code>(ctypes.some_type)</code>. the latter is apparently interpreted as a single item rather than a list containing a single item."}, {"owner": {"reputation": 565, "user_id": 1981338, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6f633a5a0ec37d78cf491b97b6dc526d?s=128&d=identicon&r=PG&f=1", "display_name": "osvein", "link": "https://stackoverflow.com/users/1981338/osvein"}, "reply_to_user": {"reputation": 2856, "user_id": 230851, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/85bfabc247b68f8f12f2449386f7e92d?s=128&d=identicon&r=PG", "display_name": "orion elenzil", "link": "https://stackoverflow.com/users/230851/orion-elenzil"}, "edited": false, "score": 0, "creation_date": 1589138109, "post_id": 37488156, "comment_id": 109168321, "body": "@orionelenzil try <code>(ctypes.some_type,)</code> with a comma"}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "reply_to_user": {"reputation": 565, "user_id": 1981338, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6f633a5a0ec37d78cf491b97b6dc526d?s=128&d=identicon&r=PG&f=1", "display_name": "osvein", "link": "https://stackoverflow.com/users/1981338/osvein"}, "edited": false, "score": 0, "creation_date": 1589141838, "post_id": 37488156, "comment_id": 109169624, "body": "@osvein Parentheses aren\u2019t needed except for clarity for order of operations. <code>.argtypes = c_int,</code> works. The comma makes it a tuple."}], "tags": [], "owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "is_accepted": false, "score": 5, "last_activity_date": 1615055382, "last_edit_date": 1615055382, "creation_date": 1464365816, "answer_id": 37488156, "question_id": 37422662, "link": "https://stackoverflow.com/questions/37422662/how-can-i-use-ctypes-to-pass-a-bytearray-into-a-c-function-that-takes-a-char-as/37488156#37488156", "title": "How can I use ctypes to pass a byteArray into a C function that takes a char* as its argument?", "body": "<p>The minimum you need (Python 2) is:</p>\n<pre><code>hello = &quot;hello&quot;\nencryptPy.encrypt(5,hello)\nencryptPy.decrypt(5,hello)\n</code></pre>\n<p>But it is good to declare the argument types and return values as well.  Full program:</p>\n<pre><code>#!python2\nimport ctypes\n\nencryptPy = ctypes.CDLL('/home/aradhak/Documents/libencrypt.so')\n\nencryptPy.encrypt.argtypes = (ctypes.c_int,ctypes.c_char_p)\nencryptPy.encrypt.restype = None\nencryptPy.decrypt.argtypes = (ctypes.c_int,ctypes.c_char_p)\nencryptPy.decrypt.restype = None\n\nhello = &quot;hello&quot;\nencryptPy.encrypt(len(hello),hello)\nencryptPy.decrypt(len(hello),hello)\n</code></pre>\n<p>Note that when passing a python byte string, consider the buffer immutable.  In this case you only are reading the buffer, but if you need to allow the C function to mutate the string use:</p>\n<pre><code>hello = ctypes.create_string_buffer('hello',5)\n</code></pre>\n<p>Below works as well, but will be length 6.  A terminating null will be included.</p>\n<pre><code>hello = ctypes.create_string_buffer('hello')\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43402, "user_id": 47961, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/EyOv8.jpg?s=128&g=1", "display_name": "Eugene Mayevski &#39;Callback", "link": "https://stackoverflow.com/users/47961/eugene-mayevski-callback"}, "edited": false, "score": 0, "creation_date": 1575922185, "post_id": 49373785, "comment_id": 104721277, "body": "Unfortunately the link takes to a different topic. But thank you for the code anyway - it seems to work (though I am not sure that there&#39;s no memory allocated when char_array is assigned to initially."}, {"owner": {"reputation": 14614, "user_id": 432294, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/NKe9d.png?s=128&g=1", "display_name": "Jay Sullivan", "link": "https://stackoverflow.com/users/432294/jay-sullivan"}, "edited": false, "score": 0, "creation_date": 1590788569, "post_id": 49373785, "comment_id": 109824370, "body": "TLDR: Convert your byte array to a char array with <code>(ctypes.c_char*len(ba)).from_buffer(bytearray(ba))</code>, where <code>ba</code> is your byte array."}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 0, "creation_date": 1615055870, "post_id": 49373785, "comment_id": 117575834, "body": "TLDR: In Python 3 just use<code>bytes(ba)</code> (for immutable buffer) or <code>create_string_buffer(bytes(ba))</code> (for mutable)."}], "tags": [], "owner": {"reputation": 2856, "user_id": 230851, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/85bfabc247b68f8f12f2449386f7e92d?s=128&d=identicon&r=PG", "display_name": "orion elenzil", "link": "https://stackoverflow.com/users/230851/orion-elenzil"}, "is_accepted": false, "score": 9, "last_activity_date": 1590787946, "last_edit_date": 1590787946, "creation_date": 1521500569, "answer_id": 49373785, "question_id": 37422662, "link": "https://stackoverflow.com/questions/37422662/how-can-i-use-ctypes-to-pass-a-bytearray-into-a-c-function-that-takes-a-char-as/49373785#49373785", "title": "How can I use ctypes to pass a byteArray into a C function that takes a char* as its argument?", "body": "<p>Mark's answer is quite helpful in that it passes a character array to the C function, which is what the OP really wanted, but in case there's folks finding their way here who really want to pass a byte-array, <a href=\"https://mail.python.org/pipermail/python-list/2010-January/563875.html\" rel=\"nofollow noreferrer\">an approach seems to be to build a ctypes.c_char backed by the memory of your byte-array, and pass that</a>.</p>\n\n<p>My example here disregards the argument declaration recommend by Mark, which indeed seems like a good idea.</p>\n\n<pre><code>import ctypes\n\n# libFoo.c:\n# (don't forget to use extern \"C\" if this is a .cpp file)\n#\n# void foo(unsigned char* buf, size_t bufSize) {\n#   for (size_t n = 0; n &lt; bufSize; ++n) {\n#     buf[n] = n;\n#   }\n# }\n\nfooLib = ctypes.cdll.LoadLibrary('./lib/libFoo.dylib')\n\nba = bytearray(10)\n\nchar_array = ctypes.c_char * len(ba)\n\nfooLib.foo(char_array.from_buffer(ba), len(ba))\n\nfor b in ba:\n  print b\n\n# 0\n# 1\n# 2\n# 3\n# 4\n# 5\n# 6\n# 7\n# 8\n# 9\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6373390"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10842, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1615055382, "creation_date": 1464119551, "question_id": 37422662, "link": "https://stackoverflow.com/questions/37422662/how-can-i-use-ctypes-to-pass-a-bytearray-into-a-c-function-that-takes-a-char-as", "title": "How can I use ctypes to pass a byteArray into a C function that takes a char* as its argument?", "body": "<p>I have created a function in C which takes an int size and a char *buffer as arguments. I would like to use ctypes to call this function from python and pass in a python byteArray. I know that first you must compile the C file into a shared library (.so file) and use ctypes to call that function. Here's the code I have so far. </p>\n\n<p>encrypt.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid encrypt(int size, unsigned char *buffer);\nvoid decrypt(int size, unsigned char *buffer);\n\nvoid encrypt(int size, unsigned char *buffer){\n    for(int i=0; i&lt;size; i++){\n        unsigned char c = buffer[i];\n        printf(\"%c\",c);\n    }\n}\nvoid decrypt(int size, unsigned char *buffer){\n    for(int i=0; i&lt;size; i++){\n        unsigned char c = buffer[i];\n        printf(\"%c\",c);\n    }\n}\n</code></pre>\n\n<p>And here's the python file:</p>\n\n<pre><code>import ctypes\n\nencryptPy = ctypes.CDLL('/home/aradhak/Documents/libencrypt.so')\nhello = \"hello\"\nbyteHello = bytearray(hello)\nencryptPy.encrypt(5,byteHello)\nencryptPy.decrypt(5,byteHello)\n</code></pre>\n\n<p>Basically I want to call the C method from python, pass through a python byte array, and have it iterate through the array and print each element</p>\n"}, {"tags": ["c", "parsing", "csv", "clion"], "comments": [{"owner": {"reputation": 452, "user_id": 3531310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c879bfa7b230a3b1a3f96fd3cb830e?s=128&d=identicon&r=PG&f=1", "display_name": "jaroslawj", "link": "https://stackoverflow.com/users/3531310/jaroslawj"}, "edited": false, "score": 1, "creation_date": 1464119738, "post_id": 37422587, "comment_id": 62350643, "body": "why data.csv is in source files?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464120277, "post_id": 37422587, "comment_id": 62350930, "body": "Have <code>main()</code> first report its current working directory."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464120341, "post_id": 37422587, "comment_id": 62350971, "body": "Try creating a file <code>&quot;dataxyz.csv&quot;</code> from the program and find the folder where it was written."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464120467, "post_id": 37422587, "comment_id": 62351042, "body": "Suspect code reports error when <code>header == NULL</code>.  Add check if <code>csvparser==NULL</code>."}, {"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464120981, "post_id": 37422587, "comment_id": 62351324, "body": "@chux Yes, code reports when header == NULL"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464121015, "post_id": 37422587, "comment_id": 62351342, "body": "... and was <code>csvparser==NULL</code> true?  Does <code>&quot;data.csv&quot;</code> have a header?"}, {"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464121214, "post_id": 37422587, "comment_id": 62351429, "body": "@chux it returns 1, but I actually have a header"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1464122673, "post_id": 37422587, "comment_id": 62352245, "body": "Since <code>csvparser==NULL</code> is true, certainly the file is not where the code is looking for it."}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 342, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464127737, "creation_date": 1464119263, "last_edit_date": 1464127737, "question_id": 37422587, "link": "https://stackoverflow.com/questions/37422587/cant-read-csv-file-by-csvparser", "title": "Can&#39;t read csv file by csvparser", "body": "<p>I use <strong>CLion</strong> code editor.\nFor parsing a csv file I use <a href=\"https://sourceforge.net/projects/cccsvparser/\" rel=\"nofollow\">C/C++ csvparser</a>. </p>\n\n<p>This contend of data.csv:</p>\n\n<pre><code>Country,Continent,National Language\nUnited States,North America,English\nCanada,North America, French\nMexico,North America,Spainish\n</code></pre>\n\n<p>I created project named Tutorial. \nMy CMakeLists.txt:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.4)\nproject(Tutorial)\n\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -std=c++11\")\n\nset(SOURCE_FILES main.c)\nadd_executable(Tutorial ${SOURCE_FILES})\ntarget_link_libraries(Tutorial csvparser)\n</code></pre>\n\n<p>The content of main.c. It is taken from its <a href=\"https://sourceforge.net/p/cccsvparser/wiki/Home/\" rel=\"nofollow\">official page</a>:</p>\n\n<pre><code>#include \"csvparser.h\"\n\nint main() {\n    int i =  0;\n    //                                   file, delimiter, first_line_is_header?\n    CsvParser *csvparser = CsvParser_new(\"data.csv\", \",\", 1);\n    CsvRow *header;\n    CsvRow *row;\n\n    header = CsvParser_getHeader(csvparser);\n    if (header == NULL) {\n        printf(\"%s\\n\", CsvParser_getErrorMessage(csvparser));\n        return 1;\n    }\n    const char **headerFields = CsvParser_getFields(header);\n    for (i = 0 ; i &lt; CsvParser_getNumFields(header) ; i++) {\n        printf(\"TITLE: %s\\n\", headerFields[i]);\n    }\n    // Do NOT destroy the headear manually if you plan to destroy the parser later.\n    // If you destroy both header and parser, you will get double free runtime error\n    // CsvParser_destroy_row(header);\n    while ((row = CsvParser_getRow(csvparser)) ) {\n        printf(\"==NEW LINE==\\n\");\n        const char **rowFields = CsvParser_getFields(row);\n        for (i = 0 ; i &lt; CsvParser_getNumFields(row) ; i++) {\n            printf(\"FIELD: %s\\n\", rowFields[i]);\n        }\n        printf(\"\\n\");\n        CsvParser_destroy_row(row);\n    }\n    CsvParser_destroy(csvparser);\n\n    return 0;\n}\n</code></pre>\n\n<p>But it gives an error:</p>\n\n<pre><code>/home/ken/.CLion2016.1/system/cmake/generated/Tutorial-9a39f70/9a39f70/Debug/Tutorial\nError opening CSV file for reading: data.csv : No such file or directory\n</code></pre>\n\n<p>Strange, but `data.csv' file actually exists in current folder.</p>\n\n<p>I tried to have pass an absolute path, but it doesn't help. \nHow can I avoid this problem?</p>\n\n<p><strong>P.S</strong> It it worth noting that when I compile this programm by <code>gcc main.c -I ../include ../src/csvparser.c -o main</code> all works fine.</p>\n"}, {"tags": ["c", "date", "datetime", "time"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1464120015, "post_id": 37422556, "comment_id": 62350787, "body": "Again and again, we get people who will not read up the function they are using, before asking a question."}], "answers": [{"tags": [], "owner": {"reputation": 14078, "user_id": 11589, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/54f226385450ee11f20bd512d15e3888?s=128&d=identicon&r=PG", "display_name": "shodanex", "link": "https://stackoverflow.com/users/11589/shodanex"}, "is_accepted": true, "score": 4, "last_activity_date": 1464119787, "creation_date": 1464119787, "answer_id": 37422732, "question_id": 37422556, "link": "https://stackoverflow.com/questions/37422556/print-time-in-c-initial-and-end-of-doing-sleep/37422732#37422732", "title": "Print time in c initial and end of doing sleep", "body": "<p>from the asctime man page :</p>\n\n<blockquote>\n  <p>The asctime() function converts the broken-down time value tm into\n  a null-terminated string with the same format as ctime().  The return\n  value points to  a  statically  allocated    string  which  might  be \n  overwritten by subsequent calls to any of the date and time functions.\n  The asctime_r() function does the same, but stores the string in a\n  user-supplied    buffer which should have room for at least 26 bytes.</p>\n</blockquote>\n\n<p>In other word, your second call to asctime stores its result in the same buffer where the result of the first call was stored.</p>\n\n<p>Copy the result somewhere if you want to keep it for later use, or print it as soon as you get it, or use asctime_r</p>\n"}], "owner": {"reputation": 25, "user_id": 6367100, "user_type": "registered", "profile_image": "https://graph.facebook.com/272686513075646/picture?type=large", "display_name": "Pedro Silva", "link": "https://stackoverflow.com/users/6367100/pedro-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 37422732, "answer_count": 1, "score": 1, "last_activity_date": 1464128412, "creation_date": 1464119146, "last_edit_date": 1464128412, "question_id": 37422556, "link": "https://stackoverflow.com/questions/37422556/print-time-in-c-initial-and-end-of-doing-sleep", "title": "Print time in c initial and end of doing sleep", "body": "<p>I'm trying to print the date two times</p>\n\n<pre><code>char *init_time=getTime();\n//do something and sleep 5 sec \nchar *end=getTime();\nprintf(\"train 2 started at %s and arrived at %s\\n\",init_time, end);\n</code></pre>\n\n<p>the get time:</p>\n\n<pre><code>char* getTime(){\n    time_t result;\n    result = time(NULL);\n    return asctime(localtime(&amp;result));\n}\n</code></pre>\n\n<p>Why is the result printed the same?</p>\n"}, {"tags": ["c", "arrays", "string", "printf", "character"], "comments": [{"owner": {"reputation": 93, "user_id": 5766557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b2de533bc7b40249e08b6c636399d4?s=128&d=identicon&r=PG&f=1", "display_name": "ppel123", "link": "https://stackoverflow.com/users/5766557/ppel123"}, "edited": false, "score": 0, "creation_date": 1464119080, "post_id": 37422528, "comment_id": 62350296, "body": "sorry for the wrong post i am new i have this code and i want to print every one char of this string"}, {"owner": {"reputation": 93, "user_id": 5766557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b2de533bc7b40249e08b6c636399d4?s=128&d=identicon&r=PG&f=1", "display_name": "ppel123", "link": "https://stackoverflow.com/users/5766557/ppel123"}, "edited": false, "score": 0, "creation_date": 1464119094, "post_id": 37422528, "comment_id": 62350305, "body": "i cant find where i am wrong"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1464119320, "post_id": 37422528, "comment_id": 62350418, "body": "<code>scanf(&quot;%1000s&quot;, str);printf(&quot;element is &quot;);     for(i=0; str[i];i++){         printf(&quot;%c&quot;, str[i]);     }</code>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1464119353, "post_id": 37422528, "comment_id": 62350433, "body": "When you compile, always use <code>-Wall</code>, and always fix every warning that you get."}, {"owner": {"reputation": 1725, "user_id": 1351828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a351d561f75641e458ce8f6dfd5b5227?s=128&d=identicon&r=PG", "display_name": "Adrian Krupa", "link": "https://stackoverflow.com/users/1351828/adrian-krupa"}, "edited": false, "score": 1, "creation_date": 1464119369, "post_id": 37422528, "comment_id": 62350443, "body": "What is your question? What is the output? What should be?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1464119644, "post_id": 37422528, "comment_id": 62350580, "body": "Also this <code>scanf(&quot; %s&quot;,&amp;str);</code> should really be <code>..., str);</code> as <code>str</code> decays to the address of its first element."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1464119966, "post_id": 37422528, "comment_id": 62350770, "body": "@alk and maybe <code>(&quot;%1000s&quot;...)</code> also, right? :)"}, {"owner": {"reputation": 901, "user_id": 4979197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/deGfP.png?s=128&g=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/4979197/chuck"}, "edited": false, "score": 0, "creation_date": 1464121555, "post_id": 37422528, "comment_id": 62351608, "body": "This looks like homework."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 5766557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b2de533bc7b40249e08b6c636399d4?s=128&d=identicon&r=PG&f=1", "display_name": "ppel123", "link": "https://stackoverflow.com/users/5766557/ppel123"}, "edited": false, "score": 0, "creation_date": 1464119607, "post_id": 37422569, "comment_id": 62350563, "body": "oooooooooo hhhh thank you very much i am really excited"}, {"owner": {"reputation": 93, "user_id": 5766557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b2de533bc7b40249e08b6c636399d4?s=128&d=identicon&r=PG&f=1", "display_name": "ppel123", "link": "https://stackoverflow.com/users/5766557/ppel123"}, "edited": false, "score": 0, "creation_date": 1464119651, "post_id": 37422569, "comment_id": 62350586, "body": "this site is the best it can really help people to understand programming languages thanks"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1464119700, "last_edit_date": 1464119700, "creation_date": 1464119198, "answer_id": 37422569, "question_id": 37422528, "link": "https://stackoverflow.com/questions/37422528/basic-c-programming-array-of-string/37422569#37422569", "title": "basic c programming array of string", "body": "<p>To start with, let me tell you, there is no <em>array of string</em> in your code, it's an array of <code>char</code>s.</p>\n\n<p>Coming to the problem, it is twofold.</p>\n\n<p>Firstly, to print a <code>char</code>, you need to use <code>%c</code> format specifier, <code>%s</code> is for <em>strings</em> (null-terminated <code>char</code> arrays).</p>\n\n<p>Secondly, in your looping condition. When you say</p>\n\n<pre><code>for(i=0;i&lt;1001;i++)\n</code></pre>\n\n<p>the index iterates over <strong>all</strong> the elements of the array. However, if your input is less than 1000 <code>char</code>s, then, some part of the array remains uninitialized. Accessing uninitialized variable value invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>Basically, instead of looping over the <em>whole</em> array, you should do something like</p>\n\n<pre><code> int len = strlen(str);\n for(i=0; i&lt;len; i++)\n      printf(\"element is %c\",str[i]);\n</code></pre>\n\n<p>which will limit your index to <em>valid</em> values.</p>\n\n<p>That said, the <code>scanf()</code> statement should better be like</p>\n\n<pre><code>scanf(\"%1000s\",str);   //protect from buffer overflow from reallylonginputstring.....\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 2, "last_activity_date": 1464119251, "creation_date": 1464119251, "answer_id": 37422581, "question_id": 37422528, "link": "https://stackoverflow.com/questions/37422528/basic-c-programming-array-of-string/37422581#37422581", "title": "basic c programming array of string", "body": "<p>Characters are printed using <code>%c</code>, the <code>%s</code> format specifier expects a 0-terminated string.</p>\n\n<p>You should also not iterate past <code>strlen(str)</code> since maybe all input won't be a full 1000 characters.</p>\n"}, {"tags": [], "owner": {"reputation": 412, "user_id": 6357231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/69Lxh.jpg?s=128&g=1", "display_name": "pinjasaur", "link": "https://stackoverflow.com/users/6357231/pinjasaur"}, "is_accepted": false, "score": 1, "last_activity_date": 1464119866, "creation_date": 1464119866, "answer_id": 37422752, "question_id": 37422528, "link": "https://stackoverflow.com/questions/37422528/basic-c-programming-array-of-string/37422752#37422752", "title": "basic c programming array of string", "body": "<p>Right now your <code>for</code> loop condition may be causing you to iterate over undefined elements in your <code>char</code> array (string).</p>\n\n<p>You'll want to change your <code>for</code> loop condition to something like</p>\n\n<pre><code>for (i = 0; i &lt; length; i++)\n</code></pre>\n\n<p>where <code>length</code> is defined as <code>int length = strlen(str);</code> which would be the length of the string up to, but not including the null terminator.</p>\n\n<p>Sounds like your pretty new to C programming. I'd recommend reading a bit about <a href=\"http://www.cprogramming.com/tutorial/c/lesson9.html\" rel=\"nofollow\">Strings in C</a> and <a href=\"http://www.thegeekstuff.com/2013/06/buffer-overflow/\" rel=\"nofollow\">Buffer Overflows</a> since they're topics worth knowing and being careful about.</p>\n\n<p>Edit: as mentioned in the other answers, you should use <code>%c</code> to print out each character, not <code>%s</code>.</p>\n"}], "owner": {"reputation": 93, "user_id": 5766557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b2de533bc7b40249e08b6c636399d4?s=128&d=identicon&r=PG&f=1", "display_name": "ppel123", "link": "https://stackoverflow.com/users/5766557/ppel123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 37422569, "answer_count": 3, "score": -3, "last_activity_date": 1464119885, "creation_date": 1464119010, "last_edit_date": 1464119885, "question_id": 37422528, "link": "https://stackoverflow.com/questions/37422528/basic-c-programming-array-of-string", "title": "basic c programming array of string", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n/*functions\nint addHugeNumbers(char *a1,char *a2, char *res);\n\n*/\n\n\n/* run this program using the console pauser or add your own getch, system(\"pause\") or input loop */\n\nint main() {\n\n    /*variables*/\n    char str[1001];\n    int i;\n    /**/\n\n    printf(\"Give the string that contains the numbers that you want to add.\\n\");\n    printf(\"The strings must not contain more than 1000 characters.\\n\");\n    scanf(\" %s\",&amp;str);\n    for(i=0;i&lt;1001;i++){\n        printf(\"element is %s\",str[i]);\n    }\n    return 0;\n}'\n</code></pre>\n"}, {"tags": ["c", "file", "encryption", "openssl"], "comments": [{"owner": {"reputation": 452, "user_id": 3531310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c879bfa7b230a3b1a3f96fd3cb830e?s=128&d=identicon&r=PG&f=1", "display_name": "jaroslawj", "link": "https://stackoverflow.com/users/3531310/jaroslawj"}, "edited": false, "score": 2, "creation_date": 1464118312, "post_id": 37422089, "comment_id": 62349912, "body": "Lower results for bigger files, may be related with caching. It&#39;s just a guess."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1464119018, "post_id": 37422089, "comment_id": 62350267, "body": "How fast does rewriting the file without encrypting it take?"}, {"owner": {"reputation": 455, "user_id": 4423914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wPGrL.jpg?s=128&g=1", "display_name": "vianna77", "link": "https://stackoverflow.com/users/4423914/vianna77"}, "edited": false, "score": 0, "creation_date": 1464122069, "post_id": 37422089, "comment_id": 62351928, "body": "sorry, I didn&#39;t get it... what did you mean by rewriting the file without encrypting?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1464122766, "post_id": 37422089, "comment_id": 62352294, "body": "@vianna77 Comment out your call to <code>EVP_CipherUpdate</code>, and replace <code>fwrite(outbuf, 1, outlen, outputFilePointer)</code> with <code>fwrite(inbuf, 1, inlen, outputFilePointer)</code> so all your code does is make an unencrypted copy of the file.  If <i>that</i> goes slower with larger files, the problem is in the copying, and if that doesn&#39;t go slower with larger files, the problem is in the encryption."}, {"owner": {"reputation": 455, "user_id": 4423914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wPGrL.jpg?s=128&g=1", "display_name": "vianna77", "link": "https://stackoverflow.com/users/4423914/vianna77"}, "edited": false, "score": 0, "creation_date": 1464123270, "post_id": 37422089, "comment_id": 62352584, "body": "Great idea! thank you! I will do that and check what happens. I&#39;m at home now, but as soon I get back to work, I will make that test."}, {"owner": {"reputation": 455, "user_id": 4423914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wPGrL.jpg?s=128&g=1", "display_name": "vianna77", "link": "https://stackoverflow.com/users/4423914/vianna77"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1464178843, "post_id": 37422089, "comment_id": 62376553, "body": "@AndrewHenle I just finished the copy experiment... took the time 3 times for files with 500MB, 1GB and 10GB... it was linear, maintaining the rate."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1464187468, "post_id": 37422089, "comment_id": 62383604, "body": "So, the IO rate <i>without</i> encryption is constant?  And doesn&#39;t get slower?  Can you try a different cipher, maybe something really simple like <code>EVP_enc_null()</code>?  (It&#39;s hard to be simpler than that - <code>EVP_enc_null()</code> doesn&#39;t actually do <i>any</i> encryption...)"}, {"owner": {"reputation": 455, "user_id": 4423914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wPGrL.jpg?s=128&g=1", "display_name": "vianna77", "link": "https://stackoverflow.com/users/4423914/vianna77"}, "edited": false, "score": 0, "creation_date": 1464191009, "post_id": 37422089, "comment_id": 62386294, "body": "Yep, the IO rate without encryption is constant and doesn&#39;t get any slower with bigger files. I will try the EVP_enc_null."}, {"owner": {"reputation": 455, "user_id": 4423914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wPGrL.jpg?s=128&g=1", "display_name": "vianna77", "link": "https://stackoverflow.com/users/4423914/vianna77"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1464196987, "post_id": 37422089, "comment_id": 62389956, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/112950/discussion-between-vianna77-and-andrew-henle\">continue this discussion in chat</a>."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1464210712, "post_id": 37422089, "comment_id": 62397331, "body": "@vianna77 - when you find an answer, please provide it. Maybe its the <code>fwrite(inbuf, 1, inlen, outputFilePointer)</code>? I&#39;&#39;ll update OpenSSL&#39;s wiki accordingly. Also, you might want to try <code>mmap</code> and friends to avoid extra copies from the file system to memory. Just map a view of the view and work with it directly."}, {"owner": {"reputation": 455, "user_id": 4423914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wPGrL.jpg?s=128&g=1", "display_name": "vianna77", "link": "https://stackoverflow.com/users/4423914/vianna77"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1464354257, "post_id": 37422089, "comment_id": 62464825, "body": "@jww , I already made the code copy the stream from IN to OUT without any encryption and also changed the cipher to <code>EVP_enc_null()</code> and both cases maintain a constant rate of read/write for very different file sizes. In practical terms, I will use <code>EVP_aes_256_gcm</code> to encrypt only sensitive files, making the payload to be encrypted somewhat small. Other people will probably have to deal with that issue."}], "owner": {"reputation": 455, "user_id": 4423914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wPGrL.jpg?s=128&g=1", "display_name": "vianna77", "link": "https://stackoverflow.com/users/4423914/vianna77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 392, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1464191087, "creation_date": 1464117537, "last_edit_date": 1464191087, "question_id": 37422089, "link": "https://stackoverflow.com/questions/37422089/encryption-decryption-with-openssl-slow-rate-when-tested-with-bigger-files", "title": "Encryption + Decryption with OpenSSL slow rate when tested with bigger files", "body": "<p>I just coded two C applications, one to encrypt and another to decrypt files.</p>\n\n<p>The code for file manipulation during encryption+decryption was copied/pasted from <a href=\"https://www.openssl.org/docs/manmaster/crypto/EVP_EncryptInit.html#EXAMPLES\" rel=\"nofollow\">OpenSSL site</a> and changed to use AES-GCM</p>\n\n<p>It works like a charm! The thing is</p>\n\n<ul>\n<li>for a 500MB file, the cipher rate is 80MB/s </li>\n<li>for a 10000MB file, the cipher rate goes down to 22MB/s</li>\n</ul>\n\n<p>I should be nearly constant. If the rate is around 80MB/s for 500MB file, that's the rate I should get for a 10GB file (a little less, maybe, but not THAT much!).</p>\n\n<p>As I increase the file size, the cipher rate keeps decreasing.</p>\n\n<p>Could it be an issue with the file manipulation? Maybe something related to the memory usage? Am I doing something wrong?</p>\n\n<p>Here is the code I'm actually using:</p>\n\n<pre><code>const EVP_CIPHER *cipher;\nunsigned char inbuf[1024], outbuf[1024 + EVP_MAX_BLOCK_LENGTH];\nint inlen, outlen;\n/* Initialize cipher*/\ncipher = EVP_aes_256_gcm (); // AES in Galois Counter Mode\nEVP_CIPHER_CTX *encCTX = EVP_CIPHER_CTX_new();\nEVP_CipherInit_ex(encCTX, cipher, NULL, key, iv, 1); // 1 for encrypt, 0 for decrypt\n\n/* Loop loading file chunks and cipher it*/\nfor(;;) {\n    inlen = fread(inbuf, 1, 1024, sourceFilePointer);\n    if(inlen &lt;= 0) break;\n    if(!EVP_CipherUpdate(encCTX, outbuf, &amp;outlen, inbuf, inlen)) {\n        /* Error */\n        EVP_CIPHER_CTX_free(encCTX);\n        printf(\"Error while updating ciphered file \\n\");\n        free(key);\n        free(targetFilename);\n        return 0;\n    }\n    fwrite(outbuf, 1, outlen, outputFilePointer);\n}\n\n/* Finish the cipher*/\nif(!EVP_CipherFinal_ex(encCTX, outbuf, &amp;outlen)) {\n    /* Error */\n    EVP_CIPHER_CTX_free(encCTX);\n    printf(\"Error while finalizing cipher \\n\");\n    free(key);\n    free(targetFilename);\n    return 0;\n}\nfwrite(outbuf, 1, outlen, outputFilePointer);\n\nEVP_CIPHER_CTX_ctrl (encCTX, EVP_CTRL_GCM_GET_TAG, TAG_SIZE, tag);\nEVP_CIPHER_CTX_free(encCTX);\nfclose(outputFilePointer);\n</code></pre>\n\n<p>UPDATE: I commented out the entire cipher update section <code>EVP_CipherUpdate(encCTX, outbuf, &amp;outlen, inbuf, inlen)</code> and replaced <code>fwrite(outbuf, 1, outlen, outputFilePointer)</code> with <code>fwrite(inbuf, 1, inlen, outputFilePointer)</code> as suggested in the comments to test if the file copy rate was constant for different file sizes. After testing a few times with different file sizes the IO rate proved to be constant. </p>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "edited": false, "score": 0, "creation_date": 1464120231, "post_id": 37421888, "comment_id": 62350899, "body": "Why don&#39;t you want to use SIGINT? That&#39;s exactly what it&#39;s for."}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "reply_to_user": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "edited": false, "score": 0, "creation_date": 1464122624, "post_id": 37421888, "comment_id": 62352225, "body": "As you can see in the example code, I <b>do</b> use SIGINT and it works. I&#39;m only looking if there is something more elegant."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464127539, "post_id": 37421888, "comment_id": 62354529, "body": "Note: Don&#39;t use homebrew boolean types and constants. C has a standard boolena type and <code>stdbool.h</code> also defines the constants as macros. Use it!"}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464129361, "post_id": 37421888, "comment_id": 62355174, "body": "These are actually boolean types used in CoreAudio, that I need for the audio process - thats not standard C indeed, thanks for your suggestion @Olaf, I&#39;ll fix it in this example."}], "answers": [{"comments": [{"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1464123047, "post_id": 37422583, "comment_id": 62352450, "body": "It is very likely that  I&#39;ll have to go on in this direction. Do you know some example code posted, that I could study? Thanks a lot!"}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1469198251, "post_id": 37422583, "comment_id": 64452270, "body": "The following question was found on <a href=\"http://unix.stackexchange.com/questions/25291/writing-to-stdout-except-for-output-redirection-c\">unix stack exchange</a>. Since one of the answers includes a nice, minimal, working <b>C</b> code <b>example</b>, I post the link here."}], "tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1464119260, "creation_date": 1464119260, "answer_id": 37422583, "question_id": 37421888, "link": "https://stackoverflow.com/questions/37421888/stopping-a-unix-program-using-keyboard-during-redirected-input-without-sigint/37422583#37422583", "title": "Stopping a unix program using keyboard, during redirected input, without SIGINT, in C", "body": "<p>If you want an interactive TTY user to be able to stop a program using an input character (not a signaling character which causes the TTY driver to deliver a signal), and that program must be redirected, then your only resort is to explicitly open a file descriptor to the TTY device (via <code>/dev/tty</code>) and monitor <em>that</em> for input.</p>\n\n<p>Your <code>kbhit</code> function should probably take an <code>int fd</code> parameter, using which you give it the open TTY file descriptor that it should poll.</p>\n\n<p>If you want a single character input from a TTY to be immediately available to the program (even if that character isn't a newline), then you have to put the TTY into \"raw mode\", or at least partially: at the very least, you have to disable \"canonical input processing\" via negating the <code>ICANON</code> flag in the <code>c_iflag</code> numeric field in the <code>struct termios</code> structure, and ensure that <code>c_cc[VTIME]</code> and <code>c_cc[VMIN]</code> are set to 0 and 1, respectively. Look up <code>tcgetattr</code> and <code>tcsetattr</code>. You probably want to disable the signaling characters, and disable echoing and other things. Some platforms have a <code>cfmakeraw</code> function which tweaks a <code>struct termios</code> object in the right ways to bring about a very raw mode without having to fiddle with any of the <code>termios</code> flags.</p>\n\n<p>In canonical input processing mode, a TTY won't make input available to the process (and won't select positive under <code>select</code> for input) until a complete line of input is received.</p>\n"}, {"comments": [{"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1464123650, "post_id": 37422650, "comment_id": 62352794, "body": "No, I&#39;m not trying to use file when reading from redirection -it is clear from the code. I&#39;m already using signals. Probably opening a new file descriptor would be what I need. Thanks for your input."}], "tags": [], "owner": {"reputation": 84, "user_id": 4821503, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-An36J-Nqpuk/AAAAAAAAAAI/AAAAAAAAABs/j63EglYShQg/photo.jpg?sz=128", "display_name": "William Duclot", "link": "https://stackoverflow.com/users/4821503/william-duclot"}, "is_accepted": false, "score": 1, "last_activity_date": 1464119486, "creation_date": 1464119486, "answer_id": 37422650, "question_id": 37421888, "link": "https://stackoverflow.com/questions/37421888/stopping-a-unix-program-using-keyboard-during-redirected-input-without-sigint/37422650#37422650", "title": "Stopping a unix program using keyboard, during redirected input, without SIGINT, in C", "body": "<p>Your problem is that, when reading data from redirection, you're trying to use both the file AND your keyboard. stdin isn't your keyboard anymore, it is the file, and thus you cannot read data from your keyboard (like the \"enter\" key pressed).</p>\n\n<p>If I'm not mistaken, your only two options are signals and opening a new file descriptor to the keyboard input (the TTY).</p>\n"}], "owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 37422583, "answer_count": 2, "score": 0, "last_activity_date": 1464130155, "creation_date": 1464116771, "last_edit_date": 1464130155, "question_id": 37421888, "link": "https://stackoverflow.com/questions/37421888/stopping-a-unix-program-using-keyboard-during-redirected-input-without-sigint", "title": "Stopping a unix program using keyboard, during redirected input, without SIGINT, in C", "body": "<p>I haven't found a post addressing a similar scenario so far:<BR> In a command-line unix program for sonification of certain floating point data sets, I have a <code>main()</code> which either reads from a file whose name is given as program argumant or <code>stdin</code> redirection <code>( &lt; )</code> or data piped from another program <code>( | )</code>, depending on <code>argc</code>.\nFor as long as <code>argv[1]</code> is a file name, I can manage gently stopping the execution by hitting 'enter' key, which programmatically sets a condition to fade out the signal, cleanup and regularly exit the audio subroutine and terminate the program. I achieve it by calling a function for non-blocking <code>kbhit()</code>. Definition:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int kbhit(void)\n{    \n    struct timeval tv;\n    fd_set read_fd;\n\n    tv.tv_sec = 0;\n    tv.tv_usec= 0;\n\n    FD_ZERO(&amp;read_fd);    \n    FD_SET(0, &amp;read_fd);\n\n    if(select(1, &amp;read_fd, NULL, NULL, &amp;tv) == -1)\n        return 0;\n\n    if(FD_ISSET(0, &amp;read_fd))\n        return 1;\n\n    return 0;    \n}\n</code></pre>\n\n<p>However, if input is being redirected or piped, <code>kbhit()</code> then prevents from execution by stopping the playback the moment it has started, since it returns <code>1</code>. I don't know how to deal with it, so I am using SIGINT, which I don't find so elegant. Here are the code snippets:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>//...   ... \nbool stop = false;        //global variable\n//...   ...  \nif(argc == 1) stdr = true;//flag: reading from redirected or piped stdin (simplified)\n\n//code for reading from file or stdin, using fscanf() ...\n//code for initializing and starting audio process ...\n//loop, during audio callback on a separate thread ...\nwhile((player.totalFrames &lt; player.totalSize) &amp;&amp; !stop){\n    if(!stdr){      //( = reading from file)\n      if (kbhit()){\n        stop = true;\n        break;\n      }\n   }else{           //( = reading from redirected stdin)\n      if (signal(SIGINT, sig_handler) == SIG_ERR)\n        printf(\"\\ncan't catch SIGINT\\n\");\n   }        \n}\n\nif(stop){ \u2026 }//code for gently fading the signal and stopping the audio process\n//cleanup and termination...\n//...   ...\n</code></pre>\n\n<p>And here is the standard signal handler which sets <code>stop</code> condition to <code>true</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void sig_handler(int s)\n{\n    if (s == SIGINT){\n      if(debug)printf(\"\\ncaught SIGINT\\n\");\n      stop = true;\n    }\n}\n</code></pre>\n\n<p>Is there a more elegant way to:</p>\n\n<ol>\n<li>send &amp; catch a message from the keyboard while having input redirected or piped, to allow program cleaning after itself and exiting (other than using SIGINT as described above)?</li>\n<li><p>how would a code allowing for such a message from coputer keyoard (during redirection or piping) look like? Could the arguments inside <code>kbhit()</code> be rearranged somehow, or one has to go in a completely different direction. I have no idea which?</p>\n\n<p>If this is possible, I would kindly appreciate a suggestion. Thanks in advance!</p></li>\n</ol>\n"}, {"tags": ["c", "gcc", "compiler-errors", "crt"], "comments": [{"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 1, "creation_date": 1464116576, "post_id": 37421795, "comment_id": 62349005, "body": "Try adding <code>-nostdlib -nostdinc</code>, assuming, of course, that you don&#39;t use the C standard library or its includes."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464116608, "post_id": 37421795, "comment_id": 62349019, "body": "<code>crt0</code> is a part of runtime library, implementing (among the others) the standard startup code (entry point) for the application. If you want it to be freestanding without standard libraries, you will have to implement the startup code yourself. Are you doing so?"}], "owner": {"reputation": 103, "user_id": 6277141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6DiwI.png?s=128&g=1", "display_name": "George Gibson", "link": "https://stackoverflow.com/users/6277141/george-gibson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 697, "favorite_count": 0, "closed_date": 1464348762, "answer_count": 0, "score": 0, "last_activity_date": 1464116437, "creation_date": 1464116437, "question_id": 37421795, "link": "https://stackoverflow.com/questions/37421795/what-is-the-crt0-o-error-when-cross-compiling-and-how-do-i-fix-it", "closed_reason": "Duplicate", "title": "What is the crt0.o error when cross compiling and how do I fix it?", "body": "<p>The project I am working on at the minute must be compiled using a cross compiler. My <code>binutils</code> and <code>gcc</code> have been installed into <code>~/opt/cross</code>, however when I try to compile, I am faced with this error:</p>\n\n<pre><code>/home/george/opt/cross/lib/gcc/i686-elf/6.1.0/../../../../i686-elf/bin/ld: cannot find crt0.o: No such file or directory\n/home/george/opt/cross/lib/gcc/i686-elf/6.1.0/../../../../i686-elf/bin/ld: cannot find -lc\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>My code uses only GCC's freestanding headers (my full compile command: <code>~/opt/cross/bin/i686-elf-gcc kernel.c tty.c -std=gnu99 -ffreestanding -O2 -Wall -Wextra</code>).</p>\n\n<p>So what is <code>crt0.o</code> and how can I fix this error?</p>\n"}, {"tags": ["c", "opencl", "fifo"], "comments": [{"owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1464124238, "post_id": 37421566, "comment_id": 62353109, "body": "a.sf0123456789abcde=a.s0123456789abcdef right shifts elements by 1 and puts last element to beginning element in a 16-wide vector."}, {"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "reply_to_user": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1464179706, "post_id": 37421566, "comment_id": 62377216, "body": "Where did you get a.sf0123456789abcde from? How would I be able to use the same format that you provided to an array I do not know the inputs of (I know them I just can&#39;t guess them, they are random)."}, {"owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1464180728, "post_id": 37421566, "comment_id": 62378072, "body": "<a href=\"https://www.khronos.org/registry/cl/sdk/1.1/docs/man/xhtml/shuffle.html\" rel=\"nofollow noreferrer\">khronos.org/registry/cl/sdk/1.1/docs/man/xhtml/shuffle.html</a>. There is also indexed access to vector elements."}, {"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "reply_to_user": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1464182881, "post_id": 37421566, "comment_id": 62379847, "body": "@huseyintugrulbuyukisik Would this work for my vector though? I have 58 elements in this example but the values could be larger based on the user input."}, {"owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1464184293, "post_id": 37421566, "comment_id": 62380947, "body": "Even if opencl has in array shifting(I don&#39;t think so), simple gaming cards cannot do in-memory compute. You should download from array to vector, shift as many times needed, update array then."}, {"owner": {"reputation": 4922, "user_id": 1152356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zx2WP.jpg?s=128&g=1", "display_name": "mfa", "link": "https://stackoverflow.com/users/1152356/mfa"}, "edited": false, "score": 0, "creation_date": 1464628525, "post_id": 37421566, "comment_id": 62552151, "body": "If I understand correctly, your goal is to pass in 1.2M values and 1.2M coefficients?"}, {"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1464628678, "post_id": 37421566, "comment_id": 62552207, "body": "1.2M values and only 65 coefficients. There is a temporary buffer that takes 65 elements from the input array (1.2million values) and multiplies it with the elements in the coefficient array (constant 65 elements)"}], "answers": [{"comments": [{"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1464196075, "post_id": 37442681, "comment_id": 62389457, "body": "Thanks for your answer. I will look into creating multiple threads when performing the calculations. Although one thing that has always confused me is the globalId value. In this case, since there are 57 work items, globalId would execute in data-parallel fashion right? But if I had 1.2million elements, how would this work? Would that mean there are 1.2million work items and they execute at once as well?"}, {"owner": {"reputation": 631, "user_id": 4985539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y6oGqPV2UBo/AAAAAAAAAAI/AAAAAAAAARc/dEMkTia8L8g/photo.jpg?sz=128", "display_name": "Jan Lucas", "link": "https://stackoverflow.com/users/4985539/jan-lucas"}, "reply_to_user": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1464198220, "post_id": 37442681, "comment_id": 62390640, "body": "The different work items are executed in parallel. However no current GPUs is big enough to execute 1.2 million work items in parallel. The GPU will execute as many work items in parallel as possible and then automatically switch to the next work item once a work item is finished and not all 1.2 million work items are finished."}, {"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1464199193, "post_id": 37442681, "comment_id": 62391202, "body": "Oh I see, so if I was to use 1.2 million elements as the limit instead of 58, the GPU would automatically switch at whatever its work item capacity is until the 1.2 million elements have been completed."}, {"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1464199788, "post_id": 37442681, "comment_id": 62391537, "body": "I still face the problem of implementing the fifo buffer though. It is kind of essential when it comes to what the program has to do, without the buffer the results will not be the same. I am not sure if I should create the fifo buffer in the main loop of the cpp file and just continue to shift and call the kernel until the input array is empty. Or if I should create it inside the kernel."}, {"owner": {"reputation": 631, "user_id": 4985539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y6oGqPV2UBo/AAAAAAAAAAI/AAAAAAAAARc/dEMkTia8L8g/photo.jpg?sz=128", "display_name": "Jan Lucas", "link": "https://stackoverflow.com/users/4985539/jan-lucas"}, "reply_to_user": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1464201569, "post_id": 37442681, "comment_id": 62392524, "body": "You do not have to actually implement the fifo buffer. You can easily figure out what would be in the FIFO buffer. Your FIFO buffer always contains a consecutive 58 element window into your Array. Only at the very beginning it is padded with zeros. Look at the for loop in the code. It loops through all elements of the FIFO. tmp contains the i-th element in the FIFO. Every thread just calculates one output value and reconstructed the state of the FIFO for the calculation of that output value."}, {"owner": {"reputation": 631, "user_id": 4985539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y6oGqPV2UBo/AAAAAAAAAAI/AAAAAAAAARc/dEMkTia8L8g/photo.jpg?sz=128", "display_name": "Jan Lucas", "link": "https://stackoverflow.com/users/4985539/jan-lucas"}, "reply_to_user": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1464201856, "post_id": 37442681, "comment_id": 62392685, "body": "Let me add one thing:"}, {"owner": {"reputation": 631, "user_id": 4985539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y6oGqPV2UBo/AAAAAAAAAAI/AAAAAAAAARc/dEMkTia8L8g/photo.jpg?sz=128", "display_name": "Jan Lucas", "link": "https://stackoverflow.com/users/4985539/jan-lucas"}, "reply_to_user": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1464202534, "post_id": 37442681, "comment_id": 62393091, "body": "The idea of my kernel is not that you do the multiplication of the fifo elements with the coefficients in parallel. That is done sequentially within the same thread. Instead multiple output values are calculated in parallel. Your FIFO just looks like you first need to calculate one output value, before you can take the new fifo state and calculate the next one, but that is not actually true. If you want to calculate the k-th output of your algorithm, you can just reconstruct the FIFO state for that output from the input array, knowledge of the k-1 fifo state is not required."}, {"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "reply_to_user": {"reputation": 631, "user_id": 4985539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y6oGqPV2UBo/AAAAAAAAAAI/AAAAAAAAARc/dEMkTia8L8g/photo.jpg?sz=128", "display_name": "Jan Lucas", "link": "https://stackoverflow.com/users/4985539/jan-lucas"}, "edited": false, "score": 0, "creation_date": 1464202761, "post_id": 37442681, "comment_id": 62393218, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/112955/discussion-between-vedhar-and-jan-lucas\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 631, "user_id": 4985539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y6oGqPV2UBo/AAAAAAAAAAI/AAAAAAAAARc/dEMkTia8L8g/photo.jpg?sz=128", "display_name": "Jan Lucas", "link": "https://stackoverflow.com/users/4985539/jan-lucas"}, "is_accepted": true, "score": 2, "last_activity_date": 1464205430, "last_edit_date": 1464205430, "creation_date": 1464193038, "answer_id": 37442681, "question_id": 37421566, "link": "https://stackoverflow.com/questions/37421566/best-approach-to-fifo-implementation-in-a-kernel-opencl/37442681#37442681", "title": "Best approach to FIFO implementation in a kernel OpenCL", "body": "<p>To get good performance out of GPU, you need to parallelize your work to many threads. In your code you are just using a single thread and a GPU is very slow per thread but can be very fast, if many threads are running at the same time. In this case you can use a single thread for each output value. You do not actually need to shift values through a array: For every output value a window of 58 values is considered, you can just grab these values from memory, multiply them with the coefficients and write back the result. </p>\n\n<p>A simple implementation would be (launch with as many threads as output values):</p>\n\n<pre><code>__kernel void lowpass(__global float *Array, __global float *coefficients, __global float *Output) \n{ \n    int globalId = get_global_id(0); \n    float sum=0.0f;\n    for (int i=0; i&lt; 58; i++)\n    {\n        float tmp=0;\n        if (globalId+i &gt; 56)\n        {\n            tmp=Array[i+globalId-57]*coefficient[57-i];\n        }\n        sum += tmp;\n    }\n    output[globalId]=sum;\n}\n</code></pre>\n\n<p>This is not perfect, as the memory access patterns it generates are not optimal for GPUs. The Cache will likely help a bit, but there is clearly a lot of room for optimization, as the values are reused several times. The operation you are trying to perform is called convolution (1D). NVidia has an 2D example called oclConvolutionSeparable in their GPU Computing SDK, that shows an optimized version. You adapt use their convolutionRows kernel for a 1D convolution.</p>\n"}, {"comments": [{"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1464703811, "post_id": 37533310, "comment_id": 62584778, "body": "Thanks for your detailed answer mfa. I would accept two answers if I could, really appreciate the response though! :) Although I need to look into barriers a bit more, my understanding of them is not the best. Although, when I pass variables in through my main cpp code, how would I declare these local variables? Do I just assign a random amount of space for it when I set kernel arguments?"}, {"owner": {"reputation": 4922, "user_id": 1152356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zx2WP.jpg?s=128&g=1", "display_name": "mfa", "link": "https://stackoverflow.com/users/1152356/mfa"}, "reply_to_user": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 1, "creation_date": 1464708571, "post_id": 37533310, "comment_id": 62588216, "body": "Here is a good SO answer to that question: <a href=\"http://stackoverflow.com/a/8888861/1152356\">stackoverflow.com/a/8888861/1152356</a>  You call setKernelArg, using the correct size (sizeof(float)*65) and NULL s the value."}, {"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1464714838, "post_id": 37533310, "comment_id": 62592181, "body": "Awesome. Thank you!"}], "tags": [], "owner": {"reputation": 4922, "user_id": 1152356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zx2WP.jpg?s=128&g=1", "display_name": "mfa", "link": "https://stackoverflow.com/users/1152356/mfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1464640316, "creation_date": 1464640316, "answer_id": 37533310, "question_id": 37421566, "link": "https://stackoverflow.com/questions/37421566/best-approach-to-fifo-implementation-in-a-kernel-opencl/37533310#37533310", "title": "Best approach to FIFO implementation in a kernel OpenCL", "body": "<p>Here's another kernel you can try out. There are a lot of synchronization points (barriers), but this should perform fairly well. The 65-item work group is not very optimal. </p>\n\n<p><strong>the steps:</strong>  </p>\n\n<ol>\n<li>init local values to 0  </li>\n<li>copy coefficients to local variable  </li>\n</ol>\n\n<p>looping over the output elements to compute:  </p>\n\n<ol start=\"3\">\n<li>shift existing elements (work items > 0 only)  </li>\n<li>copy new element (work item 0 only)  </li>\n<li>compute dot product<br>\n5a. multiplication - one per work item<br>\n5b. reduction loop to compute sum  </li>\n<li>copy dot product to output (WI 0 only)  </li>\n<li>final barrier</li>\n</ol>\n\n<p><strong>the code:</strong></p>\n\n<pre><code>__kernel void lowpass(__global float *Array, __constant float *coefficients, __global float *Output, __local float *localArray, __local float *localSums){\n\n    int globalId = get_global_id(0);\n    int localId = get_local_id(0);  \n    int localSize = get_local_size(0);  \n\n    //1  init local values to 0\n    localArray[localId] = 0.0f\n\n    //2  copy coefficients to local\n    //don't bother with this id __constant is working for you\n    //requires another local to be passed in: localCoeff\n    //localCoeff[localId] = coefficients[localId];\n\n    //barrier for both steps 1 and 2\n    barrier(CLK_LOCAL_MEM_FENCE);\n\n    float tmp;\n    for(int i = 0; i&lt; outputSize; i++)\n    {\n        //3  shift elements (+barrier)\n        if(localId &gt; 0){\n            tmp = localArray[localId -1]\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        localArray[localId] = tmp\n\n        //4  copy new element (work item 0 only, + barrier)\n        if(localId == 0){\n            localArray[0] = Array[i];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n\n        //5  compute dot product\n        //5a multiply + barrier\n        localSums[localId] = localArray[localId] * coefficients[localId];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        //5b reduction loop + barrier\n        for(int j = 1; j &lt; localSize; j &lt;&lt;= 1) {\n            int mask = (j &lt;&lt; 1) - 1;\n            if ((localId &amp; mask) == 0) {\n                localSums[local_index] += localSums[localId +j]\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n\n        //6 copy dot product (WI 0 only)\n        if(localId == 0){\n            Output[i] = localSums[0];\n        }\n\n        //7 barrier\n        //only needed if there is more code after the loop.\n        //the barrier in #3 covers this in the case where the loop continues\n        //barrier(CLK_LOCAL_MEM_FENCE);\n    }\n\n}\n</code></pre>\n\n<p><strong>What about more work groups?</strong><br>\nThis is slightly simplified to allow a single 1x65 work group computer the entire 1.2M Output. To allow multiple work groups, you could use  / get_num_groups(0) to calculate the amount of work each group should do (workAmount), and adjust the i for-loop:  </p>\n\n<pre><code>for (i = workAmount * get_group_id(0); i&lt; (workAmount * (get_group_id(0)+1) -1); i++)\n</code></pre>\n\n<p>Step #1 must be changed as well to initialize to the correct starting state for localArray, rather than all 0s.  </p>\n\n<pre><code>    //1  init local values\n    if(groupId == 0){\n        localArray[localId] = 0.0f\n    }else{\n        localArray[localSize - localId] = Array[workAmount - localId];\n    }\n</code></pre>\n\n<p>These two changes should allow you to use a more optimal number of work groups; I suggest some multiple of the number of compute units on the device. Try to keep the amount of work for each group in the thousands though. Play around with this, sometimes what seems optimal on a high-level will be detrimental to the kernel when it's running.</p>\n\n<p><strong>Advantages</strong><br>\nAt almost every point in this kernel, the work items have something to do. The only time fewer than 100% of the items are working is during the reduction loop in step 5b. <a href=\"http://developer.amd.com/resources/documentation-articles/articles-whitepapers/opencl-optimization-case-study-simple-reductions/\" rel=\"nofollow\">Read more here about why that is a good thing.</a></p>\n\n<p><strong>Disadvantages</strong><br>\nThe barriers will slow down the kernel just by the nature of what barriers do: the pause a work item until the others reach that point. Maybe there is a way you could implement this with fewer barriers, but I still feel this is optimal because of the problem you are trying to solve.<br>\nThere isn't room for more work items per group, and 65 is not a very optimal size. Ideally, you should try to use a power of 2, or a multiple of 64. This won't be a huge issue though, because there are a lot of barriers in the kernel which makes them all wait fairly regularly.</p>\n"}], "owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 3, "accepted_answer_id": 37442681, "answer_count": 2, "score": 3, "last_activity_date": 1464640316, "creation_date": 1464115573, "last_edit_date": 1464117416, "question_id": 37421566, "link": "https://stackoverflow.com/questions/37421566/best-approach-to-fifo-implementation-in-a-kernel-opencl", "title": "Best approach to FIFO implementation in a kernel OpenCL", "body": "<p>Goal: Implement the diagram shown below in OpenCL. The main thing needed from the OpenCl kernel is to multiply the coefficient array and temp array and then accumilate all those values into one at the end. (That is probably the most time intensive operation, parallelism would be really helpful here). </p>\n\n<p>I am using a helper function for the kernel that does the multiplication and addition (I am hoping this function will be parallel as well).</p>\n\n<p><strong>Description of the picture:</strong></p>\n\n<p><strong>One at a time</strong>, the values are passed into the array (temp array) which is the same size as the coefficient array. Now <strong>every time</strong> a single value is passed into this array, the temp array is multiplied with the coefficient array in parallel and the values of each index are then concatenated into one single element. This will continue until the input array reaches it's final element.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3cmlN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3cmlN.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>What happens with my code?</strong></p>\n\n<p>For 60 elements from the input, it takes over 8000 ms!! and I have a total of 1.2 million inputs that still have to be passed in. I know for a fact that there is a way better solution to do what I am attempting. Here is my code below. </p>\n\n<p>Here are some things that I know are wrong with he code for sure. When I try to multiply the coefficient values with the temp array, it crashes. This is because of the global_id. All I want this line to do is simply multiply the two arrays in parallel.</p>\n\n<p>I tried to figure out why it was taking so long to do the FIFO function, so I started commenting lines out. I first started by commenting everything except the first for loop of the FIFO function. As a result this took 50 ms. Then when I uncommented the next loop, it jumped to 8000ms. So the delay would have to do with the transfer of data.</p>\n\n<p>Is there a register shift that I could use in OpenCl? Perhaps use some logical shifting method for integer arrays? (I know there is a '>>' operator).</p>\n\n<pre><code>float constant temp[58];\nfloat constant tempArrayForShift[58];\nfloat constant multipliedResult[58];\n\nfloat fifo(float inputValue, float *coefficients, int sizeOfCoeff) {\n\n//take array of 58 elements (or same size as number of coefficients)\n//shift all elements to the right one\n//bring next element into index 0 from input\n//multiply the coefficient array with the array thats the same size of coefficients and accumilate\n//store into one output value of the output array\n//repeat till input array has reached the end\n\nint globalId = get_global_id(0); \n\nfloat output = 0.0f;\n\n//Shift everything down from 1 to 57\n//takes about 50ms here\nfor(int i=1; i&lt;58; i++){\n    tempArrayForShift[i] = temp[i];\n}\n\n//Input the new value passed from main kernel. Rest of values were shifted over so element is written at index 0.\ntempArrayForShift[0] = inputValue;\n//Takes about 8000ms with this loop included\n//Write values back into temp array\nfor(int i=0; i&lt;58; i++){\n    temp[i] = tempArrayForShift[i];\n}\n\n//all 58 elements of the coefficient array and temp array are multiplied at the same time and stored in a new array\n//I am 100% sure this line is crashing the program.\n//multipliedResult[globalId] = coefficients[globalId] * temp[globalId];\n\n//Sum the temp array with each other. Temp array consists of coefficients*fifo buffer\nfor (int i = 0; i &lt;  58; i ++) {\n//  output = multipliedResult[i] + output;\n}\n\n//Returned summed value of temp array\nreturn output;\n}\n\n\n__kernel void lowpass(__global float *Array, __global float *coefficients, __global float *Output) { \n\n//Initialize the temporary array values to 0\nfor (int i = 0; i &lt;  58; i ++) {\n    temp[i] = 0;\n    tempArrayForShift[i] = 0;\n    multipliedResult[i] = 0;\n}\n\n//fifo adds one element in and calls the fifo function. ALL I NEED TO DO IS SEND ONE VALUE AT A TIME HERE.\nfor (int i = 0; i &lt;  60; i ++) {\n    Output[i] = fifo(Array[i], coefficients, 58);\n}\n\n}\n</code></pre>\n\n<p>I have had this problem with OpenCl for a long time. I am not sure how to implement parallel and sequential instructions together.</p>\n\n<p><strong>Another alternative I was thinking about</strong></p>\n\n<p>In the main cpp file, I was thinking of implementing the fifo buffer there and having the kernel do the multiplication and addition. But this would mean I would have to call the kernel 1000+ times in a loop. Would this be the better solution? Or would it just be completely inefficient. </p>\n"}, {"tags": ["c", "printf", "free"], "comments": [{"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 1, "creation_date": 1464114604, "post_id": 37421209, "comment_id": 62348047, "body": "That&#39;s not C#... it&#39;s not clear what C# has to do with this."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1464114747, "post_id": 37421209, "comment_id": 62348115, "body": "<code>18446744073709551615</code> is <code>0xFFFFFFFFFFFFFFFF</code> which can happen if a 64-bit value is <code>-1</code>"}, {"owner": {"reputation": 27, "user_id": 6377586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29678ff17c8a832774b49b7110f4fabe?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Bry", "link": "https://stackoverflow.com/users/6377586/alan-bry"}, "edited": false, "score": 0, "creation_date": 1464115388, "post_id": 37421209, "comment_id": 62348439, "body": "That&#39;s right, its only C, i apologize for the mistake."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1464115646, "post_id": 37421209, "comment_id": 62348544, "body": "From the <code>printf</code> <a href=\"https://msdn.microsoft.com/en-us/library/wc7014hz.aspx\" rel=\"nofollow noreferrer\">man page</a> <i>&quot;Returns the number of characters printed, or a negative value if an error occurs. If format is NULL, the invalid parameter handler is invoked, as described in Parameter Validation. If execution is allowed to continue, the function returns -1 and sets errno to EINVAL. If EOF (0xFFFF) is encountered in argument, the function returns -1.&quot;</i>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1464116261, "post_id": 37421209, "comment_id": 62348819, "body": "<code>printf</code> returns an <code>int</code>, not a <code>size_t</code>. That&#39;s important because the code checks <code>if(valorORI&gt;0)</code>. That should fail when <code>printf</code> returns a negative number, but it doesn&#39;t fail because you declared <code>valorORI</code> as a <code>size_t</code>, which is unsigned."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464116787, "post_id": 37421755, "comment_id": 62349110, "body": "Minor:  seems odd to return <code>0L</code> from <code>int IC_ObtenerReferenciaInstr()</code>.  Suggest <code>return 0;</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464116863, "post_id": 37421755, "comment_id": 62349151, "body": "Similarly the unnecessary cast in <code>return((int)lRet);</code>"}, {"owner": {"reputation": 27, "user_id": 6377586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29678ff17c8a832774b49b7110f4fabe?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Bry", "link": "https://stackoverflow.com/users/6377586/alan-bry"}, "edited": false, "score": 0, "creation_date": 1464116887, "post_id": 37421755, "comment_id": 62349159, "body": "Thanks for your response! The values of the variables in the last iteration are:  (gdb) p Entidad $5 = 0x7fff4315e040 &quot;13&quot; (gdb) p treoseq $6 = 0xa19394 &quot;BG&quot;"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 27, "user_id": 6377586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29678ff17c8a832774b49b7110f4fabe?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Bry", "link": "https://stackoverflow.com/users/6377586/alan-bry"}, "edited": false, "score": 0, "creation_date": 1464116932, "post_id": 37421755, "comment_id": 62349186, "body": "@AlanBry perhaps you changed the function type at some stage and didn&#39;t follow it thru."}, {"owner": {"reputation": 27, "user_id": 6377586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29678ff17c8a832774b49b7110f4fabe?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Bry", "link": "https://stackoverflow.com/users/6377586/alan-bry"}, "edited": false, "score": 0, "creation_date": 1464117185, "post_id": 37421755, "comment_id": 62349318, "body": "thanks to all, i&#39;ll implement your suggestions now :) (sorry for the Edit, late i&#39;ll catch that the Enter key post the comment :p)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 27, "user_id": 6377586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29678ff17c8a832774b49b7110f4fabe?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Bry", "link": "https://stackoverflow.com/users/6377586/alan-bry"}, "edited": false, "score": 0, "creation_date": 1464117315, "post_id": 37421755, "comment_id": 62349390, "body": "@AlanBry please &quot;accept&quot; this answer if it was the one that helped you."}, {"owner": {"reputation": 27, "user_id": 6377586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29678ff17c8a832774b49b7110f4fabe?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Bry", "link": "https://stackoverflow.com/users/6377586/alan-bry"}, "edited": false, "score": 0, "creation_date": 1464118242, "post_id": 37421755, "comment_id": 62349883, "body": "I applied all the changes, now the printf() returns &quot;-1&quot;, so the error it&#39;s catched before it occurs, but still i don&#39;t know why the printf() is returning that value; as i post before, the arguments are OK in the last iteration. I keep reviewing, so if i got an answer (before anyone give me the key) i&#39;ll come here and post it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 27, "user_id": 6377586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29678ff17c8a832774b49b7110f4fabe?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Bry", "link": "https://stackoverflow.com/users/6377586/alan-bry"}, "edited": false, "score": 0, "creation_date": 1464118582, "post_id": 37421755, "comment_id": 62350049, "body": "@Alan Bry Hmmm.   Was <code>stdout</code> closed?"}, {"owner": {"reputation": 27, "user_id": 6377586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29678ff17c8a832774b49b7110f4fabe?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Bry", "link": "https://stackoverflow.com/users/6377586/alan-bry"}, "edited": false, "score": 0, "creation_date": 1464120476, "post_id": 37421755, "comment_id": 62351048, "body": "No, it isn&#39;t. Because of your question, i searched about and i find a solution: put <b>printf(&quot;\\r &quot;);</b> before the valor = printf(...) and it worked. Is not the best solution, i supposed, but i&#39;ll use it until i find anything better. Any ideas why is this happening?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464120653, "post_id": 37421755, "comment_id": 62351149, "body": "<code>printf()</code> has buffering limits, maybe as small as about 4095.  Add <code>fflush(stdout);</code> or <code>&#39;\\n&#39;</code> to the output statements."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1464116630, "last_edit_date": 1495539846, "creation_date": 1464116263, "answer_id": 37421755, "question_id": 37421209, "link": "https://stackoverflow.com/questions/37421209/c-proc-printf-return-a-value-too-big/37421755#37421755", "title": "C / ProC printf return a value too big", "body": "<p><code>printf()</code> returns a signed integer type <code>int</code>.  Assigning that to <code>size_t</code> (an unsigned integer type)  loses its sign-ness and so incorrectly passes <code>if (valorORI &gt; 0)</code>.</p>\n\n<p>Test the result of <code>printf()</code> as an <code>int</code> first.  <a href=\"https://stackoverflow.com/questions/37421209/c-proc-printf-return-a-value-too-big/37421755#comment62348544_37421209\">@Weather Vane</a>  </p>\n\n<pre><code>int valorORI = printf(\" where ...\nif (valorORI &gt; 0) {\n  /// minor suggested change of malloc code\n  sWhereORI = malloc(sizeof *sWhereORI * (valorORI + 1u));  \n</code></pre>\n\n<p>Perhaps OP is calling <code>printf()</code> on the last iteration with invalid arguments.</p>\n"}], "owner": {"reputation": 27, "user_id": 6377586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29678ff17c8a832774b49b7110f4fabe?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Bry", "link": "https://stackoverflow.com/users/6377586/alan-bry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1464116630, "creation_date": 1464114456, "last_edit_date": 1464115695, "question_id": 37421209, "link": "https://stackoverflow.com/questions/37421209/c-proc-printf-return-a-value-too-big", "title": "C / ProC printf return a value too big", "body": "<p>I search for a similar topic, but i don't find anything</p>\n\n<p>I have a function in C, wich i call it recursively. The prupose of this function is to construct a query to execute by another function (Carga_Datos_OptimizadoV2):</p>\n\n<pre><code>int IC_ObtenerReferenciaInstr(char *Entidad, char *treoseq)\n{                       \n    char *sCampos []={\"T0OPINST.NB_REF_1\",\"\"}; \n    char *sFormatos []={\"C\",\"\"};\n    char **sDatos=NULL;  \n    int lFilas=0; \n    char sDiagnostico [256]; \n    int lRet;                                     \n    size_t  valorORI=0;\n    char   *sWhereORI=NULL;\n\n    valorORI = printf(\" where t0opoper.cd_entidad='%s' \"\n                   \" and t0opoper.nu_operac_ext_eftvo='%s'\"\n                   \" and t0opoper.cd_entidad=t0opinst.cd_entidad\"\n                   \" and t0opoper.nu_instruc_princ=t0opinst.nu_instruc\",\n                   Entidad,treoseq); \n\n    if (valorORI &gt; 0)\n      {               \n       sWhereORI = (char *)malloc((valorORI + 1) * sizeof(char));  \n\n       if(sWhereORI != NULL)\n         { sprintf(sWhereORI,\" where t0opoper.cd_entidad='%s' \"\n                          \" and t0opoper.nu_operac_ext_eftvo='%s'\"\n                          \" and t0opoper.cd_entidad=t0opinst.cd_entidad\"\n                          \" and t0opoper.nu_instruc_princ=t0opinst.nu_instruc\",\n                          Entidad,treoseq); \n\n          lRet=Carga_Datos_OptimizadoV2(sizeof(sFormatos)/sizeof(char *)-1,\n                            sWhereORI,\"T0OPOPER,T0OPINST\",sCampos,sFormatos,\n                            &amp;sDatos,&amp;lFilas,sDiagnostico,-1); \n          free(sWhereORI);\n          sWhereORI=NULL;\n         }\n       else\n         { sprintf(sWhereORI,\"Warning, sWhere2 over in IC_ObtenerReferenciaInstr.\");\n           }\n      }\n    else\n      {return(ERROR);}\n\n    if (lRet != 0)\n      {return((int)lRet);}\n\n    if((lFilas&gt;0) &amp;&amp; (strcmp(sDatos[0],\"\")!=0))\n           {strcpy(treoseq,sDatos[0]); }\n\n    return(0L);  \n}/* end-funcion IC_ObtenerReferenciaInstr */\n</code></pre>\n\n<p>The problem is in \"valorORI\", who captures the valor of the printf. If i call it 6 times recursively, the last time the \"printf\" return the value 18446744073709551615 (in the others iterations, it returns a value between 163 and 170), resulting in an abort when trying to do de free() in free(sWhereORI).</p>\n\n<p>I've been looking for a solution 3 days in a row... Thanks to any who could give me an idea :)</p>\n"}, {"tags": ["c", "arrays", "initialization", "structure"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1464114369, "post_id": 37421076, "comment_id": 62347935, "body": "<code>{10, 1000, 5, 14, 1, 0};</code> wrong initializer list. --&gt; <code>{{10, 1000}, {5, 14}, {1, 0}}</code>"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5346682, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154477319322316/picture?type=large", "display_name": "Pedro Marinho", "link": "https://stackoverflow.com/users/5346682/pedro-marinho"}, "edited": false, "score": 0, "creation_date": 1464114359, "post_id": 37421130, "comment_id": 62347932, "body": "Thanks for the quick reply. Do you know how to fix it?"}, {"owner": {"reputation": 37, "user_id": 5346682, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154477319322316/picture?type=large", "display_name": "Pedro Marinho", "link": "https://stackoverflow.com/users/5346682/pedro-marinho"}, "edited": false, "score": 1, "creation_date": 1464114665, "post_id": 37421130, "comment_id": 62348078, "body": "Thank you! That helped me understand what was going on and look for a solution."}, {"owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "edited": false, "score": 0, "creation_date": 1464149498, "post_id": 37421130, "comment_id": 62359983, "body": "This is true since 89 standard"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464149741, "post_id": 37421130, "comment_id": 62360042, "body": "The initialization is actually a constraint violation because <code>5</code> is not a valid initializer for a pointer.  Yet another example of &quot;helpful&quot; compiler extensions confusing the coder."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 8, "last_activity_date": 1464115335, "last_edit_date": 1464115335, "creation_date": 1464114183, "answer_id": 37421130, "question_id": 37421076, "link": "https://stackoverflow.com/questions/37421076/structure-making-array-display-wrong-values/37421130#37421130", "title": "Structure making array display wrong values", "body": "<p>Quoting <code>C11</code>, chapter \u00a76.7.9, (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>Each brace-enclosed initializer list has an associated current object. <strong>When no\n  designations are present, subobjects of the current object are initialized in order according\n  to the type of the current object: array elements in increasing subscript order, structure\n  members in declaration order, and the first named member of a union.</strong> [...]</p>\n</blockquote>\n\n<p>So, basically, in the initialization </p>\n\n<pre><code>struct node p1_terms[] = {10, 1000, 5, 14, 1, 0};\n</code></pre>\n\n<p>the array size is 2. It creates two elements of <code>struct node</code> thus accessing <code>p1_terms[2]</code> is out of bound access which invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\">undefined behavior</a>.</p>\n\n<p>That said, the initialization initializes the structure elements in order, that means, for the above case, the member values will be like</p>\n\n<pre><code>p1_terms[0].coef = 10;\np1_terms[0].exp= 1000;\np1_terms[0].next= 5;   // see here....\n</code></pre>\n\n<p>and this is certainly <strong>not</strong> what you want. You need to use the initializer list like</p>\n\n<pre><code>struct node p1_terms[] = {{10, 1000}, {5, 14}, {1, 0}};\n</code></pre>\n\n<p>to avoid <code>next</code> getting initialized.</p>\n\n<p>Related, from the same chapter</p>\n\n<blockquote>\n  <p>If the aggregate or union contains elements or members that are aggregates or unions,\n  these rules apply recursively to the subaggregates or contained unions. If the initializer of\n  a subaggregate or contained union begins with a left brace, the initializers enclosed by\n  that brace and its matching right brace initialize the elements or members of the\n  subaggregate or the contained union. [...]</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2522, "user_id": 5976576, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9ec90d5b8c13f25c3eae9fe8a9df6fc8?s=128&d=identicon&r=PG&f=1", "display_name": "MotKohn", "link": "https://stackoverflow.com/users/5976576/motkohn"}, "is_accepted": false, "score": 1, "last_activity_date": 1464148615, "last_edit_date": 1464148615, "creation_date": 1464114680, "answer_id": 37421277, "question_id": 37421076, "link": "https://stackoverflow.com/questions/37421076/structure-making-array-display-wrong-values/37421277#37421277", "title": "Structure making array display wrong values", "body": "<p>Your initialization code <code>struct node p1_terms[] = {10, 1000, 5, 14, 1, 0};</code> does not take into account the pointer for the next node. Actually it initializes the 1st pointer to 5 and second one to 0 which is definitely not what you want. Then when you reference a 3rd one with the <code>poly[2] = p1_terms[2];</code> there is no data left in the initializer so you are pointing to random data beyond the contents of your array. When you take the <code>Node_ptr next;</code> out. 2 ints are consumed per node, so it works as intended.</p>\n"}], "owner": {"reputation": 37, "user_id": 5346682, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154477319322316/picture?type=large", "display_name": "Pedro Marinho", "link": "https://stackoverflow.com/users/5346682/pedro-marinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 37421130, "answer_count": 2, "score": 2, "last_activity_date": 1464148615, "creation_date": 1464113997, "last_edit_date": 1464114610, "question_id": 37421076, "link": "https://stackoverflow.com/questions/37421076/structure-making-array-display-wrong-values", "title": "Structure making array display wrong values", "body": "<p>Does anyone know why the member <code>Node_ptr next;</code> makes the elements of the array <code>poly[1]</code> and <code>poly[2]</code> display the wrong value? If I remove\u00a0<code>Node_ptr next;</code> from the structure (<code>struct node</code>), I'm able to get the correct value for the indexes 1 and 2.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\ntypedef struct node *Node_ptr;\nstruct node {\n\u00a0 \u00a0 int coef;\n\u00a0 \u00a0 int exp;\n\u00a0 \u00a0 Node_ptr next;\n\u00a0 \u00a0 };\n\nint main()\n{\n\u00a0 \u00a0 struct node p1_terms[] = {10, 1000, 5, 14, 1, 0};\n\u00a0 \u00a0 struct node p2_terms[] = {3, 1990, 2, 1492, 11, 5};\n\n\u00a0 \u00a0 struct node poly[20];\n\u00a0 \u00a0 poly[0] = p1_terms[0];\n\n\u00a0 \u00a0 poly[1] = p1_terms[1];\n\n\u00a0 \u00a0 poly[2] = p1_terms[2];\n\n\u00a0 \u00a0 printf(\"Your polynomials are: \\n%dx^%d+%dx^%d+%dx^%d\", poly[0].coef, poly[0].exp, poly[1].coef, poly[1].exp, poly[2].coef, poly[2].exp);\n\n\u00a0 \u00a0 int siz = sizeof(poly);\n\u00a0 \u00a0 printf(\"\\n\\nSize of the array: %d bytes \\n\",siz);\n\u00a0 \u00a0 return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1464113639, "post_id": 37420842, "comment_id": 62347541, "body": "Do not hide pointer nature behind a typedef, as apparently you are doing with type <code>Cliente</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464113881, "post_id": 37420842, "comment_id": 62347667, "body": "...and if you must, at least use the Hungarian notation such as <code>pCliente</code> to make the code easier to follow."}, {"owner": {"reputation": 279, "user_id": 6377534, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1279860408708068/picture?type=large", "display_name": "Goamaral", "link": "https://stackoverflow.com/users/6377534/goamaral"}, "edited": false, "score": 0, "creation_date": 1464117394, "post_id": 37420842, "comment_id": 62349431, "body": "Then how can i initialize adq to NULL?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464118333, "post_id": 37420842, "comment_id": 62349923, "body": "To &quot;initialize adq to NULL&quot; --&gt; <code>Cliente_as_a_non_pointer_type *adq = NULL;</code>"}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1464136484, "post_id": 37420842, "comment_id": 62357151, "body": "Don&#39;t cast the result returned from <code>malloc()</code>. It&#39;s not necessary in C, and can hide the failure to include the required function prototype."}], "answers": [{"tags": [], "owner": {"reputation": 279, "user_id": 6377534, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1279860408708068/picture?type=large", "display_name": "Goamaral", "link": "https://stackoverflow.com/users/6377534/goamaral"}, "is_accepted": false, "score": 0, "last_activity_date": 1464120060, "creation_date": 1464120060, "answer_id": 37422810, "question_id": 37420842, "link": "https://stackoverflow.com/questions/37420842/change-the-start-address-of-two-linked-lists-with-one-function/37422810#37422810", "title": "change the start address of two linked lists with one function", "body": "<p>I simply added a integer in the params. and i set it to 0 or 1 depending on wut list i want to set the return value as. Then out the function I just used:</p>\n\n<pre><code>if(out_int==0){\n    adq=return_pCliente;\n}else if(out_int==1){\n    esp=return_pCliente;\n}\n</code></pre>\n\n<p>The out_int is passed in the params of the function as int *out_int, so it can be changed inside the function.\nNo changes were required in the rest of the code. I am on the clock so tmy solution works just fine. But thanks for the help, learned one or two new things. </p>\n"}], "owner": {"reputation": 279, "user_id": 6377534, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1279860408708068/picture?type=large", "display_name": "Goamaral", "link": "https://stackoverflow.com/users/6377534/goamaral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464120060, "creation_date": 1464113174, "question_id": 37420842, "link": "https://stackoverflow.com/questions/37420842/change-the-start-address-of-two-linked-lists-with-one-function", "title": "change the start address of two linked lists with one function", "body": "<pre><code>Cliente insert_last_adq(int option,Viagem global,Cliente adq,Cliente esp,int data,char *destino,int cod_destino,int id,char *nome){\n/*FIX: Caso quando full*/\nCliente new_node = (Cliente) malloc( sizeof(Clientes_node) );\nCliente adq_orig = adq;\nCliente esp_orig = esp;\nnew_node-&gt;data=data;\nnew_node-&gt;cod_destino=cod_destino;\nnew_node-&gt;id=id;\nstrcpy(new_node-&gt;destino,destino);\nstrcpy(new_node-&gt;nome,nome);\nswitch( option ){\n    case 0:\n        if(adq==NULL){\n            new_node-&gt;next=NULL;\n            if(option==0){\n                diminuir_disp(global,data,cod_destino);\n            }\n            return new_node;\n        } else if( get_viagens_disp_destino(global,data,cod_destino) &gt; 0 ){\n            while(adq-&gt;next!=NULL){\n                adq=adq-&gt;next;\n            }\n            adq-&gt;next=new_node;\n            new_node-&gt;next=NULL;\n            diminuir_disp(global,data,cod_destino);\n            return adq_orig;\n        } else if( get_viagens_disp_destino(global,data,cod_destino)==0 ){\n            /*FIX: Not workin*/\n            if(esp==NULL){\n                new_node-&gt;next=NULL;\n                esp=new_node;\n            }else{\n                while(esp-&gt;next!=NULL){\n                    esp=esp-&gt;next;\n                }\n                esp-&gt;next=new_node;\n                new_node-&gt;next=NULL;\n                return adq_orig;\n            }\n        }\n        break;\n    case 1:\n        if(esp==NULL){\n                new_node-&gt;next=NULL;\n                return new_node;\n            }else{\n                while(esp-&gt;next!=NULL){\n                    esp=esp-&gt;next;\n                }\n                esp-&gt;next=new_node;\n                new_node-&gt;next=NULL;\n                return esp_orig;\n            }\n        break;\n}\n</code></pre>\n\n<p>}</p>\n\n<p>After the comment FIX: Not working, I have the line:</p>\n\n<pre><code>esp=new_node;\n</code></pre>\n\n<p>So my objective was to give the start address of the linked list esp the address of new_node.\nI know i can change this when if i return an address but the prob is that the adq linked list will be the one recieving the return value.</p>\n\n<p>Btw esp is a pointed to the struct, as well as adq, so no \"*\" required.\nAnd adq and esp are of the same type \"Cliente\"</p>\n"}]