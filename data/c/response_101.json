[{"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1481760225, "post_id": 41154268, "comment_id": 69510485, "body": "check return value of <code>fscanf</code>.  Reading numerical values will fail if there is a character string."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1481760781, "post_id": 41154268, "comment_id": 69510645, "body": "In future, please don&#39;t put line numbers on the code; it makes it hard to make a copy and test.  Please review the layout of the data; are there blank lines either side of the dashed line?  Is there really a dashed line in the data?  It is worth using more spaces in your code, after commas in particular."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1481760998, "post_id": 41154268, "comment_id": 69510715, "body": "The first line contains a string (<code>time:</code>), a number (<code>40</code>), and another string (<code>ms</code>). So the first <code>fscanf</code> needs to use a format string like <code>&quot;%*s%lf%*s&quot;</code>. Note that <code>fscanf</code> isn&#39;t going to skip the strings, unless you tell it to."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1481761022, "post_id": 41154268, "comment_id": 69510723, "body": "Your code looks for 800 numbers that are stored in <code>temp1</code>.  But your data doesn&#39;t contain just numbers \u2014 it contains keywords followed by numbers.  Your <code>fscanf()</code> calls are all failing, so you get whatever your system provides as data.  You seem to be &#39;lucky&#39; that most of them end up as zero, rather than impossibly large numbers.  Of course, they could be ridiculously small numbers (1.23456780123456E-127) which would print as zeros to 6 decimal places.  You need to review your data carefully; you need to revise your reading a lot.  You need to check every call to <code>fscanf()</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1481761058, "post_id": 41154268, "comment_id": 69510734, "body": "Note that <code>fscanf()</code> returns 0 when it can&#39;t match anything \u2014 it only returns EOF when there is no data left.  It does not discard unrecognizable data."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1481761191, "post_id": 41154268, "comment_id": 69510767, "body": "If it doesn&#39;t return <code>EOF</code>, <code>fscanf()</code>returns the number of values it has successfully read.  That number can be less than the number specified in the format string if an error occurs.  Depending on what error has occurred (e.g. encountering a character like <code>&#39;Q&#39;</code> when the format string specifies a <code>float</code>) looping on <code>fscanf != EOF</code> can yield an infinite loop, unless other checks are done."}], "answers": [{"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1481766651, "post_id": 41154686, "comment_id": 69512183, "body": "Might it be a good idea to replace <code>&quot; --------------------------- &quot;</code> with <code>&quot; %*[-] &quot;</code> to allow for possible mistakes in the number of dashes in the data file?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1481767302, "post_id": 41154686, "comment_id": 69512352, "body": "@DavidBowling Could go either way on that.  Certainly the input text file is created from code output.  <i>Any</i> variation is worthy of investigation."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1481765609, "last_edit_date": 1495535440, "creation_date": 1481763160, "answer_id": 41154686, "question_id": 41154268, "link": "https://stackoverflow.com/questions/41154268/issue-with-fscanf-reading-input-file/41154686#41154686", "title": "Issue with fscanf reading input file", "body": "<p>Checking the return value from <code>fscanf()</code> against the <em>expected</em> value, not against <code>EOF</code> is a good idea.  <a href=\"https://stackoverflow.com/questions/41154268/issue-with-fscanf-reading-input-file/41154686#comment69510485_41154268\">@BLUEPIXY</a> <a href=\"https://stackoverflow.com/questions/41154268/issue-with-fscanf-reading-input-file/41154686#comment69510767_41154268\">@Peter</a>.  This will identify/solve most of OP's problems.</p>\n\n<p>The data file has keywords in it, they needed to be scanned too. <a href=\"https://stackoverflow.com/questions/41154268/issue-with-fscanf-reading-input-file/41154686#comment69510715_41154268\">@user3386109</a></p>\n\n<p>Suggest direct code to read the entire record with one <code>fscanf()</code>.</p>\n\n<pre><code>struct kk {\n  int time;\n  int switchn[4];\n  double potentiometer, temperature, light;\n};\n\nint data_kk_read(FILE *inf, struct kk *data) {\n  int cnt = fscanf(inf,\n      \" time: %d ms switch0: %d switch1: %d switch2: %d\"\n      \" switch3: %d potentiometer: %lf temperature: %lf light: %lf\"\n      \" --------------------------- \",\n      &amp;data-&gt;time,&amp;data-&gt;switchn[0],&amp;data-&gt;switchn[1], &amp;data-&gt;switchn[2],\n      &amp;data-&gt;switchn[3], &amp;data-&gt;potentiometer, &amp;data-&gt;temperature, &amp;data-&gt;light);\n  return cnt;\n}\n\nint data_kk_write(FILE *outf, unsigned n, const struct kk *data) {\n  int cnt = fprintf(outf,\n      \"%3u %d, %d, %d, %d, %d, %.2lf, %.2lf, %.2lf\\n\", n,\n      data-&gt;time, data-&gt;switchn[0], data-&gt;switchn[1], data-&gt;switchn[2],\n      data-&gt;switchn[3], data-&gt;potentiometer, data-&gt;temperature, data-&gt;light);\n  return cnt;\n}\n\nint main(void) {\n  FILE *inf = fopen(\"data.txt\", \"r\");\n  assert(inf);\n  unsigned line = 0;\n  struct kk data;\n  int cnt;\n  while ((cnt = data_kk_read(inf, &amp;data)) == 8) {\n    data_kk_write(stdout, ++line, &amp;data);\n  }\n  fclose(inf);\n  if (cnt != EOF) puts(\"Unexpected scanning problem\");\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>  1 40, 1, 1, 1, 1, 0.00, 0.66, 0.23\n  2 80, 1, 1, 1, 1, 0.00, 0.66, 0.23\n  3 120, 1, 1, 1, 1, 0.00, 0.66, 0.23\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7299285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9060ff50f25f627b5b7a041cd663f69?s=128&d=identicon&r=PG&f=1", "display_name": "kikimomo", "link": "https://stackoverflow.com/users/7299285/kikimomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481765609, "creation_date": 1481759878, "last_edit_date": 1481760691, "question_id": 41154268, "link": "https://stackoverflow.com/questions/41154268/issue-with-fscanf-reading-input-file", "title": "Issue with fscanf reading input file", "body": "<p>I am trying to convert an input file from .txt to .csv. I've performed multiple tests using gdb and switched my code around. The code looks like it should work but for some reason it doesn't. I've tried using \"<code>while (fscanf(\u2026arguments\u2026) != EOF)</code>\" but I always end up in a never-ending loop when I know that the input file does end. Is it the way I'm trying to read the file that's the problem or something else? I'd greatly appreciate any advice.</p>\n\n<p>A sample of the input file (it's way too big. Also the potentiometer value is the only value that is consistently zero. All other values are greater than zero)</p>\n\n<pre><code>time:  40 ms\nswitch0: 1\nswitch1: 1\nswitch2: 1\nswitch3: 1\npotentiometer: 0.00\ntemperature: 0.66\nlight: 0.23\n\n---------------------------\n\ntime:  80 ms\nswitch0: 1\nswitch1: 1\nswitch2: 1\nswitch3: 1\npotentiometer: 0.00\ntemperature: 0.66\nlight: 0.23\n\n---------------------------\n\ntime:  120 ms\nswitch0: 1\nswitch1: 1\nswitch2: 1\nswitch3: 1\npotentiometer: 0.00\ntemperature: 0.66\nlight: 0.23\n\n---------------------------\n</code></pre>\n\n<p>The file that convert from txt to csv</p>\n\n<pre><code>1 #include &lt;stdio.h&gt;\n2 #include &lt;stdlib.h&gt;\n3\n4 int main()\n5 {\n6         FILE *data = fopen(\"data.csv\",\"w\");\n7         FILE *arduino = fopen(\"arduino.txt\",\"r\");\n8\n9         if(arduino == NULL)\n10         {\n11             printf(\"error reading file\\n\");\n12             return 1;\n13         }\n14         if(data == NULL)\n15         {\n16             printf(\"error writing file\\n\");\n17             return 2;\n18         }\n19\n20         fprintf(data,\"Time,Switch0,Switch1,Switch2,Switch3,Potentiometer,Temperature,Light\\n\");\n21\n22         int num1,num2,num3,num4,num5;\n23         double num6,num7,num8;\n24\n25         double temp1[800];\n26\n27         int count1 = 0;\n28\n29         while(count1&lt;800)\n30         {\n31             fscanf(arduino,\"%lf\",&amp;temp1[count1]);\n32             count1++;\n33         }\n34\n35         for(count1 = 0; count1 &lt; 800; count1++)\n36         {\n37             printf(\"%lf\",temp1[count1]);\n38         }\n39\n40\n41         int count2 = 0;\n42         int i = 0;\n43\n44         while(count2 != 800)\n45         {\n46                 for(i=0 ; i &lt;8;i++)\n47                 {\n48                         if(i==7)\n49                         {\n50                                 fprintf(data,\"%lf\\n\",temp1[count2]);\n51                         }\n52\n53                         else\n54                         {\n55                                 fprintf(data, \"%lf,\", temp1[count2]);\n56                         }\n57                         count2++;\n58                 }\n59         }\n60\n61\n62         if (fclose(arduino)==EOF)\n63         {\n64                 printf(\"error closing input file\\n\");\n65         }\n66         if(fclose(data)==EOF)\n67         {\n68                 printf(\"error closing output file\\n\");\n69         }\n70 }\n</code></pre>\n\n<p>and here's the output</p>\n\n<pre><code>Time,Switch0,Switch1,Switch2,Switch3,Potentiometer,Temperature,Light\n  2 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n  3 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n  4 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n  5 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n  6 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n  7 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n  8 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n  9 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n (still zeros across the board)\n 61 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 62 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 63 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 64 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 65 0.000000,0.000000,0.000000,0.000000,-nan,0.000000,0.000000,0.000000\n 66 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 67 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 68 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 69 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 70 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 71 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 72 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 73 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 74 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 75 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 76 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 77 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 78 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 79 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 80 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 81 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 82 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 83 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 84 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 85 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 86 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 87 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 88 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 89 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 90 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 91 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 92 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 93 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 94 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 95 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 96 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 97 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 98 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 99 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n 100 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,253700437344304240814662650531587413567701629019053044079803999006261210888228446189339915094527360    92923426425002851172634311446770729875573243622981632.000000,49038509684686202755808411764574575003743211375155249005916427827780247417991687082747214451    073341675744581253991867335918252416362555908299070786942125737694751726823604090062182039519355613866611467434357822207669472484839486934106348907556279    40839424.000000\n101 0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000\n</code></pre>\n"}, {"tags": ["c", "linux", "macos", "profiling", "clock"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1481761850, "post_id": 41154227, "comment_id": 69510939, "body": "If you&#39;re working on macOS Sierra (10.12) or later, then there is finally support for <code>clock_gettime()</code> provided by the system, though the real resolution is only microseconds, not nanoseconds. (That is, the <code>tv_nsec</code> component of the answer from <code>clock_gettime()</code> always ends with three zeros.)  The question you reference pre-dates Sierra by over four years."}, {"owner": {"reputation": 65, "user_id": 4368816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f53c3bc2b633d2605769dffc07b57dc?s=128&d=identicon&r=PG&f=1", "display_name": "TSIguy", "link": "https://stackoverflow.com/users/4368816/tsiguy"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1481766189, "post_id": 41154227, "comment_id": 69512066, "body": "Well I&#39;m working with 10.11 and the mach header function calls from the reference still work. But This is good to know."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 4368816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f53c3bc2b633d2605769dffc07b57dc?s=128&d=identicon&r=PG&f=1", "display_name": "TSIguy", "link": "https://stackoverflow.com/users/4368816/tsiguy"}, "edited": false, "score": 0, "creation_date": 1481829582, "post_id": 41155934, "comment_id": 69543835, "body": "Thanks for this response, it validates my thinking. The example you pointed out in the libsoq directory is clear, but I don&#39;t see any setup code for a monotonic clock config. I assume I can just use the COCK_MONOTONIC define instead of CLOCK_REALTIME right?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 65, "user_id": 4368816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f53c3bc2b633d2605769dffc07b57dc?s=128&d=identicon&r=PG&f=1", "display_name": "TSIguy", "link": "https://stackoverflow.com/users/4368816/tsiguy"}, "edited": false, "score": 0, "creation_date": 1481829728, "post_id": 41155934, "comment_id": 69543913, "body": "You&#39;re correct.  Until Sierra, I didn&#39;t have a machine where CLOCK_MONOTONIC was an option \u2014 I was mostly using <code>gettimeofday()</code> \u2014 so that wasn&#39;t as much of an issue to me.  It is my &#39;working code&#39;; good enough for my purposes, but not necessarily perfect.  One disadvantage of CLOCK_MONOTONIC is that it doesn&#39;t give you an absolute timestamp (relative to The Epoch \u2014 aka 1970-01-01 00:00:00 +00:00), whereas <code>gettimeofday()</code> does.  But for performance measuring, you&#39;re seldom worried about the time it was run to the same level of precision as you&#39;re worried about how long it took to run."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 0, "last_activity_date": 1481772237, "last_edit_date": 1495540801, "creation_date": 1481772237, "answer_id": 41155934, "question_id": 41154227, "link": "https://stackoverflow.com/questions/41154227/relative-c-code-execution-time-analysis-using-system-monotonic-clock/41155934#41155934", "title": "Relative C code execution time analysis using system monotonic clock", "body": "<p>The main modification I make to the timing scheme you outline is to ensure that the same timing code is used for both functions \u2014 assuming they do have an identical interface, by passing a function pointer to skeletal code.</p>\n\n<p>As an example, I have some code that times some functions that validate whether a given number is prime.  The control function is:</p>\n\n<pre><code>static void test_primality_tester(const char *tag, int seed, int (*prime)(unsigned), int count)\n{\n    srand(seed);\n    Clock clk;\n    int nprimes = 0;\n    clk_init(&amp;clk);\n\n    clk_start(&amp;clk);\n    for (int i = 0; i &lt; count; i++)\n    {\n        if (prime(rand()))\n            nprimes++;\n    }\n    clk_stop(&amp;clk);\n\n    char buffer[32];\n    printf(\"%9s: %d primes found (out of %d) in %s s\\n\", tag, nprimes,\n           count, clk_elapsed_us(&amp;clk, buffer, sizeof(buffer)));\n}\n</code></pre>\n\n<p>I'm well aware of <a href=\"https://stackoverflow.com/questions/7343833/srand-why-call-it-only-once/\"><code>srand()</code> \u2014 why call it once?</a>, but the point of using <code>srand()</code> once each time this function is called is to ensure that the tests process the same sequence of random numbers.  On macOS, <code>RAND_MAX</code> is <code>0x7FFFFFFF</code>.</p>\n\n<p>The type <code>Clock</code> contain analogues to two <code>struct timespec</code> structures, for the start and stop time.  The <code>clk_init()</code> function initializes the structure; <code>clk_start()</code> records the start time in the structure; <code>clk_stop()</code> records the stop time in the structure; and <code>clk_elapsed_us()</code> calculates the elapsed time between the start and stop times in microseconds.  The package is written to provide me with cross-platform portability (at the cost of some headaches in determining which is the best sub-second timing routine available at compile time).</p>\n\n<p>You can find my code for timers on Github in the repository <a href=\"https://github.com/jleffler/soq\" rel=\"nofollow noreferrer\">https://github.com/jleffler/soq</a>, in the <code>src/libsoq</code> directory \u2014 files <code>timer.h</code> and <code>timer.c</code>.  The code has not yet caught up with macOS Sierra having <code>clock_gettime()</code>, though it could be compiled to use it with <code>-DHAVE_CLOCK_GETTIME</code> as a command-line compiler option.</p>\n\n<p>This code was called from a function <code>one_test()</code>:</p>\n\n<pre><code>static void one_test(int seed)\n{\n    printf(\"Seed; %d\\n\", seed);\n    enum { COUNT = 10000000 };\n    test_primality_tester(\"IsPrime1\", seed, IsPrime1, COUNT);\n    test_primality_tester(\"IsPrime2\", seed, IsPrime2, COUNT);\n    test_primality_tester(\"IsPrime3\", seed, IsPrime3, COUNT);\n    test_primality_tester(\"isprime1\", seed, isprime1, COUNT);\n    test_primality_tester(\"isprime2\", seed, isprime2, COUNT);\n    test_primality_tester(\"isprime3\", seed, isprime3, COUNT);\n}\n</code></pre>\n\n<p>And the main program can take one or a series of seeds, or uses the current time as a seed:</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    if (argc &gt; 1)\n    {\n        for (int i = 1; i &lt; argc; i++)\n            one_test(atoi(argv[i]));\n    }\n    else\n        one_test(time(0));\n    return(0);\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 4368816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f53c3bc2b633d2605769dffc07b57dc?s=128&d=identicon&r=PG&f=1", "display_name": "TSIguy", "link": "https://stackoverflow.com/users/4368816/tsiguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 41155934, "answer_count": 1, "score": 0, "last_activity_date": 1481772237, "creation_date": 1481759523, "last_edit_date": 1495539941, "question_id": 41154227, "link": "https://stackoverflow.com/questions/41154227/relative-c-code-execution-time-analysis-using-system-monotonic-clock", "title": "Relative C code execution time analysis using system monotonic clock", "body": "<p>Is there is a simple but sure way to measure the relative differences in performance between two algorithm implementations in C programs. More specifically, I want to compare the performance of implementation A vs. B? I'm thinking of a scheme like this: </p>\n\n<ul>\n<li><p>In a unit test program: </p>\n\n<ol>\n<li>start timer    </li>\n<li>call function</li>\n<li>stop timer </li>\n<li>get difference between start stop time</li>\n</ol></li>\n<li>Run the scheme above for a pair of functions A and B, then get a percentage difference in execution time to determine which is faster.  </li>\n</ul>\n\n<p>Upon doing some research I came across this question about using a <a href=\"https://stackoverflow.com/questions/11680461/monotonic-clock-on-osx\">Monotonic clock on OSX</a> in C, which apparently can give me at least nanosecond precision. To be clear, I understand that precise, controlled measurements are hard to perform, like what's discussed in <a href=\"https://stackoverflow.com/questions/40600683\">\"With O(N) known and system clock known, can we calculate the execution time of the code?</a>, which I assume should be irrelevant in this case because I only want a relative measurement. </p>\n\n<p>Everything considered, is this a sufficient and valid approach towards the kind of analysis I want to perform? Are there any details or considerations I might be missing?        </p>\n"}, {"tags": ["c", "pointers", "runtime-error", "text-editor", "doubly-linked-list"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1481759393, "post_id": 41154178, "comment_id": 69510263, "body": "This error message usually means you used <code>-&gt;</code> on a null pointer"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481759405, "post_id": 41154178, "comment_id": 69510268, "body": "<a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc in C</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1481759449, "post_id": 41154178, "comment_id": 69510285, "body": "In <code>currentLine-&gt;headLetter = link;</code> , <code>currentLine</code> is a null pointer."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1481759495, "post_id": 41154178, "comment_id": 69510298, "body": "Maybe instead of <code>headLine = lastLine = currentLine;</code> you meant <code>headLine = lastLine = currentLine = link;</code> ?"}, {"owner": {"reputation": 1, "user_id": 6091232, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NKSWpgF8YWw/AAAAAAAAAAI/AAAAAAAAAOs/QUMw2licsyA/photo.jpg?sz=128", "display_name": "yagizKanbur", "link": "https://stackoverflow.com/users/6091232/yagizkanbur"}, "edited": false, "score": 0, "creation_date": 1481761313, "post_id": 41154178, "comment_id": 69510804, "body": "I changed that line as you suggest and it worked thanks and also thanks for warning about casting malloc"}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 0, "last_activity_date": 1539175649, "creation_date": 1539175649, "answer_id": 52740659, "question_id": 41154178, "link": "https://stackoverflow.com/questions/41154178/nested-structure-pointer-cannot-access-memory-at-address-0x8/52740659#52740659", "title": "Nested structure pointer cannot access memory at address 0x8", "body": "<p>This error message usually means you used <code>-&gt;</code> on a null pointer</p>\n\n<p>In <code>currentLine-&gt;headLetter = link;</code> , <code>currentLine</code> is a null pointer.</p>\n\n<p>Maybe instead of <code>headLine = lastLine = currentLine;</code> you meant <code>headLine = lastLine = currentLine = link;</code> ?\n                    &ndash;&nbsp;M.M</p>\n"}], "owner": {"reputation": 1, "user_id": 6091232, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NKSWpgF8YWw/AAAAAAAAAAI/AAAAAAAAAOs/QUMw2licsyA/photo.jpg?sz=128", "display_name": "yagizKanbur", "link": "https://stackoverflow.com/users/6091232/yagizkanbur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1348, "favorite_count": 0, "accepted_answer_id": 52740659, "answer_count": 1, "score": 0, "last_activity_date": 1539175649, "creation_date": 1481759274, "question_id": 41154178, "link": "https://stackoverflow.com/questions/41154178/nested-structure-pointer-cannot-access-memory-at-address-0x8", "title": "Nested structure pointer cannot access memory at address 0x8", "body": "<p>I'm trying to do a basic text editor with linked lists for school project. When i tried to take a letter from keyboard program crushed cause of a runtime error. I watched currentLine->headLetter which is in void insertLetter function with debugger it says cannot access memory at address 0x8. I couldnt understand why it is crushing?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;windows.h&gt;\n\nstruct sentence {\n    struct sentence *next;\n    struct sentence *prev;\n    char letter;\n};\n\nstruct sentence *currentLetter;\n\nstruct line{\n    struct line *next;\n    struct line *prev;\n    struct sentence *headLetter;\n    struct sentence *lastLetter;\n};\n\nstruct line *headLine;\nstruct line *lastLine;\nstruct line *currentLine;\n\nvoid gotoxy(int x, int y)\n{\n  static HANDLE h = NULL;\n  if(!h)\n    h = GetStdHandle(STD_OUTPUT_HANDLE);\n  COORD c = { x, y };\n  SetConsoleCursorPosition(h,c);\n}\n\nvoid insertFirstLine ()\n{\n   struct line *link = (struct line*) malloc(sizeof(struct line));\n\n   headLine = lastLine = currentLine;\n   headLine = link;\n   link-&gt;prev = NULL;\n   link-&gt;next = NULL;\n}\n\nvoid insertLetter (char data)\n{\n    struct sentence *link = (struct sentence*) malloc(sizeof(struct sentence));\n    link-&gt;letter = data;\n\n        currentLine-&gt;headLetter = link;\n        currentLine-&gt;lastLetter = link;\n        currentLetter = link;\n        link-&gt;next = NULL;\n        link-&gt;prev = NULL;\n\n}\n\nvoid newFile ()\n{\n    char control;\n    while (1)\n    {\n        control = _getch();\n        insertLetter(control);\n    }\n}\n\nint main ()\n{\n    insertFirstLine();\n    newFile();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1481759178, "post_id": 41154160, "comment_id": 69510200, "body": "no newline in the output? You should do <code>printf(%p\\n&quot;, (void*)str);</code> instead, <code>%p</code> expects a <code>void</code> pointer."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1481759218, "post_id": 41154160, "comment_id": 69510214, "body": "That&#39;s just where the string happened to end up in the address space. It&#39;s completely arbitrary and not something you should rely on."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1481759248, "post_id": 41154160, "comment_id": 69510229, "body": "You have two <code>printf</code>s. What did you expect the second <code>printf</code> to do?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1481759288, "post_id": 41154160, "comment_id": 69510242, "body": "Please explain in the question what output you expected instead"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 2, "creation_date": 1481759374, "post_id": 41154160, "comment_id": 69510258, "body": "It happens to be the address where <code>&quot;Hello&quot;</code> is stored in memory. It must be stored <i>somewhere</i> \u2013 so why not there?"}, {"owner": {"reputation": 49, "user_id": 7299321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b09afcdf8a901b0578ec7cb4925f3be?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Lee", "link": "https://stackoverflow.com/users/7299321/chris-lee"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1481759607, "post_id": 41154160, "comment_id": 69510328, "body": "So you mean that the second printf is printing the address of the pointer str, which is &#39;H&#39;? @user2357112"}, {"owner": {"reputation": 49, "user_id": 7299321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b09afcdf8a901b0578ec7cb4925f3be?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Lee", "link": "https://stackoverflow.com/users/7299321/chris-lee"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1481759706, "post_id": 41154160, "comment_id": 69510354, "body": "So you mean that the second printf is printing the address of the pointer str, which is &#39;H&#39;? @RadLexus"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481760059, "post_id": 41154160, "comment_id": 69510439, "body": "Yes, that&#39;s what it&#39;s doing. The <code>%p</code> format specification is for printing the value of a pointer, not what the pointer points to."}, {"owner": {"reputation": 49, "user_id": 7299321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b09afcdf8a901b0578ec7cb4925f3be?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Lee", "link": "https://stackoverflow.com/users/7299321/chris-lee"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481760356, "post_id": 41154160, "comment_id": 69510520, "body": "Thank you so much. I think I finally understood what it is!! @Barmar"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 7299321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b09afcdf8a901b0578ec7cb4925f3be?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Lee", "link": "https://stackoverflow.com/users/7299321/chris-lee"}, "edited": false, "score": 0, "creation_date": 1481760540, "post_id": 41154345, "comment_id": 69510586, "body": "Thank you!! I finally understood what it is."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "reply_to_user": {"reputation": 49, "user_id": 7299321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b09afcdf8a901b0578ec7cb4925f3be?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Lee", "link": "https://stackoverflow.com/users/7299321/chris-lee"}, "edited": false, "score": 1, "creation_date": 1481761276, "post_id": 41154345, "comment_id": 69510798, "body": "@ChrisLee if you understand from an answer you should accept it and vote for it"}], "tags": [], "owner": {"reputation": 196, "user_id": 7246196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PGxLg.png?s=128&g=1", "display_name": "Brandon83", "link": "https://stackoverflow.com/users/7246196/brandon83"}, "is_accepted": true, "score": 2, "last_activity_date": 1481760446, "creation_date": 1481760446, "answer_id": 41154345, "question_id": 41154160, "link": "https://stackoverflow.com/questions/41154160/i-am-really-confused-with-understanding-array-pointer-in-c/41154345#41154345", "title": "I am really confused with understanding array pointer in C", "body": "<p>The format specifier <code>%p</code> will print the address contained within the <code>char* str</code> variable whereas the <code>%s</code> specifier will print the actual string literal <code>Hello</code>.  The address in memory <code>0x00000000 00404000</code> is where <code>Hello</code> resides.</p>\n"}, {"tags": [], "owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1481773329, "creation_date": 1481773329, "answer_id": 41156079, "question_id": 41154160, "link": "https://stackoverflow.com/questions/41154160/i-am-really-confused-with-understanding-array-pointer-in-c/41156079#41156079", "title": "I am really confused with understanding array pointer in C", "body": "<p>In Bjarne Stroustrup words:</p>\n\n<blockquote>\n  <p><code>%s</code> The argument is taken to be a string (character pointer), and characters from the string\n  are printed until a null character or until the number of characters indicated by the precision specification is reached; however, if the precision is 0 or missing, all characters up to a null are printed;</p>\n  \n  <p><code>%p</code> The argument is taken to be a pointer. The representation printed is implementation dependent;</p>\n</blockquote>\n"}], "owner": {"reputation": 49, "user_id": 7299321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b09afcdf8a901b0578ec7cb4925f3be?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Lee", "link": "https://stackoverflow.com/users/7299321/chris-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 41154345, "answer_count": 2, "score": 0, "last_activity_date": 1481773329, "creation_date": 1481759118, "last_edit_date": 1481772501, "question_id": 41154160, "link": "https://stackoverflow.com/questions/41154160/i-am-really-confused-with-understanding-array-pointer-in-c", "title": "I am really confused with understanding array pointer in C", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n    char *str = \"Hello\"; //defining and initializing the str pointer, which is directing to 'H'.\n\n    printf(\"%s\\n\", str);\n    printf(\"%p\\n\", str);\n    return 0;\n}\n</code></pre>\n\n<p>The Result is:</p>\n\n<pre><code>Hello\n0000000000404000\n</code></pre>\n\n<p>My question is where did 0000000000404000 come from?</p>\n"}, {"tags": ["c", "variables", "gcc", "static", "non-static"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 4, "creation_date": 1481758472, "post_id": 41154044, "comment_id": 69510007, "body": "Undefined behavior is undefined..."}, {"owner": {"reputation": 1871, "user_id": 1101001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7836be7c67e3d1d26ee615a142231a87?s=128&d=identicon&r=PG&f=1", "display_name": "embedded_guy", "link": "https://stackoverflow.com/users/1101001/embedded-guy"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1481758819, "post_id": 41154044, "comment_id": 69510106, "body": "Try adding another (different) function between your two calls to <code>myFunc()</code> and create new variables in that function... see what happens.  But, like @John3136 said..."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1481759099, "post_id": 41154044, "comment_id": 69510181, "body": "@Al Kenny: How do you tell the difference between a genuinely zero-initialized variable and a garbage variable that just happens to have garbage value 0? And how do you tell a variable that genuinely retains its value between calls (static) and a garbage variable that just happens to match its previous value purely accidentally?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1481759512, "post_id": 41154044, "comment_id": 69510303, "body": "&quot;Why is a non-static variable being zero-initialized?&quot; this is not certain. The compiler sees code like <code>int b; b = b + 2;  printf(&quot;b:%d\\n&quot;,b);</code> and can replace that with <code>puts(&quot;b:2&quot;):</code> or <code>destroy_hard_drive()</code>.  Either are OK as it is <i>undefined behavior</i>."}, {"owner": {"reputation": 15, "user_id": 7299263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374d46b541086985054937c1184f3b8c?s=128&d=identicon&r=PG&f=1", "display_name": "keaek", "link": "https://stackoverflow.com/users/7299263/keaek"}, "reply_to_user": {"reputation": 1871, "user_id": 1101001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7836be7c67e3d1d26ee615a142231a87?s=128&d=identicon&r=PG&f=1", "display_name": "embedded_guy", "link": "https://stackoverflow.com/users/1101001/embedded-guy"}, "edited": false, "score": 0, "creation_date": 1481762430, "post_id": 41154044, "comment_id": 69511096, "body": "@embedded_guy: I&#39;ve added the following function to the code:  <code>void testFunc() { \t    static int c; \t    int d; \t    c++; \t    d = d + 2; \t    printf(&quot;c:%d, d:%d\\n&quot;,c,d);      }</code>  and changed the code in main to be  `    myFunc();     testFunc();     myFunc();     testFunc();     myFunc();     testFunc();     myFunc();     testFunc();`     ....  what results is:  <code>a:1, b:2</code> <code>c:1, d:4</code> <code>a:2, b:6</code> <code>c:2, d:8</code> <code>a:3, b:10</code> <code>c:3, d:12</code> <code>....</code>"}, {"owner": {"reputation": 15, "user_id": 7299263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374d46b541086985054937c1184f3b8c?s=128&d=identicon&r=PG&f=1", "display_name": "keaek", "link": "https://stackoverflow.com/users/7299263/keaek"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1481763028, "post_id": 41154044, "comment_id": 69511235, "body": "@AnT: as shown in my reply to embedded_guy, it sure seems like there&#39;s some carry over between calls to the myFunc. Indeed, it would appear that <code>b</code> and <code>d</code> are accessing the same location in memory each time myFunc and testFunc run. The odds of different locations in memory having exactly these values seems pretty slim. What might be happening here?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1481763492, "post_id": 41154044, "comment_id": 69511357, "body": "The memory location is on the stack. Since you&#39;re calling them from the same parent function, you&#39;re using the same stack memory each time, and nothing is overwriting it between the calls."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1481764785, "post_id": 41154044, "comment_id": 69511704, "body": "@keaek: Well, yes, that is exactly what&#39;s happening. The fact that the memory location in question retained its value is not surprising since the two calls immediately follow each other. But inster something other call between them and it will all fall apart."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481765078, "post_id": 41154044, "comment_id": 69511781, "body": "What did you expect to happen instead, and why?"}, {"owner": {"reputation": 15, "user_id": 7299263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374d46b541086985054937c1184f3b8c?s=128&d=identicon&r=PG&f=1", "display_name": "keaek", "link": "https://stackoverflow.com/users/7299263/keaek"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481765675, "post_id": 41154044, "comment_id": 69511939, "body": "@M.M I honestly expected to get pure and simple garbage from b and d each time either function ran. If I&#39;m understanding everyone correctly here, what appears to be happening is that the same memory block on the stack is being allocated each time these functions are being called. &quot;here you go, have location X&quot; &quot;ok, X is done, time to release it (without clearing it)&quot; &quot;oh, you want some memory as well? I guess I&#39;ll give you X too&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7299263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374d46b541086985054937c1184f3b8c?s=128&d=identicon&r=PG&f=1", "display_name": "keaek", "link": "https://stackoverflow.com/users/7299263/keaek"}, "edited": false, "score": 0, "creation_date": 1481763243, "post_id": 41154209, "comment_id": 69511287, "body": "Running myFunc several more times seems to show results that are counter to what you&#39;re saying though. If I modify the main block of code to call myFunc 8 times, I get the output:  <code>a:1, b:2</code> <code>a:2, b:4</code> <code>a:3, b:6</code> <code>a:4, b:8</code> <code>a:5, b:10</code> <code>a:6, b:12</code> <code>a:7, b:14</code> <code>a:8, b:16</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 15, "user_id": 7299263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374d46b541086985054937c1184f3b8c?s=128&d=identicon&r=PG&f=1", "display_name": "keaek", "link": "https://stackoverflow.com/users/7299263/keaek"}, "edited": false, "score": 0, "creation_date": 1481763403, "post_id": 41154209, "comment_id": 69511328, "body": "@keaek Try calling some other function between the calls to <code>myFunc()</code>. The reason you&#39;re seeing that is because nothing else is using that part of the stack, so it still has what was left from the previous call."}, {"owner": {"reputation": 15, "user_id": 7299263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374d46b541086985054937c1184f3b8c?s=128&d=identicon&r=PG&f=1", "display_name": "keaek", "link": "https://stackoverflow.com/users/7299263/keaek"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481763720, "post_id": 41154209, "comment_id": 69511428, "body": "@Barmar That clears a few things up. If I add the function <code>void print_something() { \tprintf(&quot;something\\n&quot;); }</code> and call it between calls to <code>myFunc()</code>, I get something like <code>a:1, b:2 something a:2, b:2 something a:3, b:2 something a:4, b:2 something a:5, b:2 something</code>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 15, "user_id": 7299263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374d46b541086985054937c1184f3b8c?s=128&d=identicon&r=PG&f=1", "display_name": "keaek", "link": "https://stackoverflow.com/users/7299263/keaek"}, "edited": false, "score": 0, "creation_date": 1481764866, "post_id": 41154209, "comment_id": 69511724, "body": "@keaek: It doesn&#39;t really &quot;counter&quot; it. It simply means that you are continuing to deliberately, succesfully (and meaninglessly) balance upturned Eiffel tower on its tip in ultra-clean laboratory conditions (no wind or sound). Just try calling someting else between your calls and it will all fall apart and come crashing down."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 3, "last_activity_date": 1481759757, "last_edit_date": 1481759757, "creation_date": 1481759434, "answer_id": 41154209, "question_id": 41154044, "link": "https://stackoverflow.com/questions/41154044/why-is-a-non-static-variable-in-a-function-being-initialized-to-0-and-why-is-it/41154209#41154209", "title": "Why is a non-static variable in a function being initialized to 0 and why is it becoming static?", "body": "<ol>\n<li><p>Your non-static variable <code>b</code> is not zero-initialized. In your experiment it just so happened that the indeterminate garbage value in <code>b</code> was zero. Zero is as garbage as any other value.</p></li>\n<li><p>Variable <code>b</code> is not \"converted to static\". It does not retain its value between calls. In your experiment it just so happened that the indeterminate garbage value of <code>b</code> in the second function invocation was the same as the last value from the first invocation. That value is as garbage as any other value.</p></li>\n</ol>\n\n<p>While there are rather simple and deterministic underlying reasons for the \"accidental\" behavior you observed, it is as fragile as it gets. None of this will hold in real-life code.</p>\n"}], "owner": {"reputation": 15, "user_id": 7299263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374d46b541086985054937c1184f3b8c?s=128&d=identicon&r=PG&f=1", "display_name": "keaek", "link": "https://stackoverflow.com/users/7299263/keaek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1481763407, "creation_date": 1481758329, "last_edit_date": 1481763407, "question_id": 41154044, "link": "https://stackoverflow.com/questions/41154044/why-is-a-non-static-variable-in-a-function-being-initialized-to-0-and-why-is-it", "title": "Why is a non-static variable in a function being initialized to 0 and why is it becoming static?", "body": "<p>I'm attempting to run the following C code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid myFunc() {\n    static int a;\n    int b;\n    a++;\n    b = b + 2;\n    printf(\"a:%d, b:%d\\n\",a,b);\n}\n\nint main(void)  {\n    myFunc();\n    myFunc();\n    return 0;\n}\n</code></pre>\n\n<p>The result I get when compiling on ubuntu with gcc version 5.4.0 20160609 is </p>\n\n<pre><code>a:1, b:2\na:2, b:4\n</code></pre>\n\n<p>I understand that <strong>a</strong>, being static, will be zero initialized, but it appears that non-static <strong>b</strong> is being zero initialized as well. Further, it looks like <strong>b</strong> is actually being converted to a static variable, since its value is retained for the second call to myFunc.</p>\n\n<p>I'm assuming this has something to do with my compiler/OS because compiling with codepad online (using gcc 4.1.2) gives</p>\n\n<pre><code>a:1, b:2\na:2, b:2\n</code></pre>\n\n<p>which, while still zero-initializing <strong>b</strong> for some reason, does not retain the value of <strong>b</strong> for subsequent calls to myFunc.</p>\n\n<p>1) Why is a non-static variable being zero-initialized? Am I just constantly getting lucky that the compiler assigned to it a memory block that was zero'd?</p>\n\n<p>2) Why does gcc seem to convert <strong>b</strong> to a static variable in gcc 4 but not gcc 5?</p>\n\n<p>EDIT:</p>\n\n<p>To better illustrate this issue, if I add, say, 6 more calls to myFunc, the resulting output is:</p>\n\n<pre><code>a:1, b:2\na:2, b:4\na:3, b:6\na:4, b:8\na:5, b:10\na:6, b:12\na:7, b:14\na:8, b:16\n</code></pre>\n"}, {"tags": ["c", "assembly", "compilation", "linker", "machine-code"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 6, "creation_date": 1481757974, "post_id": 41153978, "comment_id": 69509864, "body": "Executable formats are different."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 7, "creation_date": 1481758143, "post_id": 41153978, "comment_id": 69509914, "body": "You can&#39;t avoid calling an OS function or something that calls an OS function. Not if you want your program to have a visible effect, like for example printing a number."}, {"owner": {"reputation": 3430, "user_id": 1708155, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/t3GJi.jpg?s=128&g=1", "display_name": "dnnagy", "link": "https://stackoverflow.com/users/1708155/dnnagy"}, "edited": false, "score": 0, "creation_date": 1481758261, "post_id": 41153978, "comment_id": 69509950, "body": "Why are they different? Is it related to protected-mode/kernel-mode? If the processors are identical, shouldn&#39;t they run the same machine-code?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1481758356, "post_id": 41153978, "comment_id": 69509974, "body": "They do run the same machine code but the interface to the operating system is different."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481758564, "post_id": 41153978, "comment_id": 69510033, "body": "What useful would your program do <b>without</b> calling any OS function?"}, {"owner": {"reputation": 3430, "user_id": 1708155, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/t3GJi.jpg?s=128&g=1", "display_name": "dnnagy", "link": "https://stackoverflow.com/users/1708155/dnnagy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481758861, "post_id": 41153978, "comment_id": 69510121, "body": "@Olaf I asked the question to understand, how compilers do the work, and why do we need to write OS-spectific code. For example if I would want to move some bytes from memory address A to address B, would the output be the same on every x86 cpu?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481758937, "post_id": 41153978, "comment_id": 69510143, "body": "Who said we &quot;<b>need</b> to write OS-specific code&quot;? There is no need to have an OS at all. So, what did you find out by own research? What is your <b>specific</b> problem?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1481759256, "post_id": 41153978, "comment_id": 69510233, "body": "The OS loads programs to run. It expects them to be in a format the OS can handle."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481759686, "post_id": 41153978, "comment_id": 69510351, "body": "Note: C does not even require an &quot;OS&quot;."}, {"owner": {"reputation": 2572, "user_id": 5784350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be79d2a9a367e3b66c42928c0b095a7?s=128&d=identicon&r=PG&f=1", "display_name": "Tommylee2k", "link": "https://stackoverflow.com/users/5784350/tommylee2k"}, "edited": false, "score": 2, "creation_date": 1481792381, "post_id": 41153978, "comment_id": 69521116, "body": "even if you don&#39;t call &quot;os specific functions&quot;, the compiler does. At least &quot;return to OS&quot; at the end of the programm will be done"}], "answers": [{"comments": [{"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 2, "creation_date": 1481760933, "post_id": 41154361, "comment_id": 69510691, "body": "One more note. Assemblers usually produce &quot;object files&quot;, which are again in toolchain-specific format, so Microsoft Visual Studio is using different &quot;.obj&quot; files to store the same assembled machine code, than gcc on linux producing &quot;.o&quot;. The machine code part of object file is same, but meta data allowing linking of such file may be completely different (plus different format of debug meta data, etc). So that&#39;s another reason, why you must compile the same source several times, but it&#39;s not per-OS, but per-toolchain."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1481773254, "post_id": 41154361, "comment_id": 69513832, "body": "Also, ABI differences in type sizes:  <code>long</code> is 32 bits on x86-64 Windows, but 64-bits in the System V x86-64 ABI.  So the same C struct can mean different things when compiled for different ABIs, not to mention single variables being different sizes (and thus needing different operand-size in the machine code, and different stack layout for locals, etc.)"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 2, "creation_date": 1481805545, "post_id": 41154361, "comment_id": 69529136, "body": "It is worse than &quot;per-toolchain&quot;. It is per-version-of-toolchain. Binary compatibility of intermediate files is not guaranteed in perpetuity for all tools from a particular vendor. I&#39;m not sure if the GCC folks try to provide backwards compatibility here, but Microsoft explicitly does not. (Which is rather ironic, actually.) The only thing that works cross-toolchain is the debugging information, since that has a standardized format. But, of course, the best thing about standards is there are so many to choose from: COFF, ELF, CodeView, PDB, ... :-)"}], "tags": [], "owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "is_accepted": true, "score": 8, "last_activity_date": 1481760624, "creation_date": 1481760624, "answer_id": 41154361, "question_id": 41153978, "link": "https://stackoverflow.com/questions/41153978/why-does-the-machine-code-depend-on-the-os-type/41154361#41154361", "title": "Why does the machine code depend on the OS type?", "body": "<p>Machine code does not depend on OS, it's same for the same CPU.</p>\n\n<p>If you did OS agnostic piece of machine code, in target CPU mode (let's say x86 32b), and load that into some ROM memory, so it will be available, you can map that part of ROM both in Windows and in linux (by completely different OS API to map physical memory and give it executable rights), and jump there.. and the machine code in ROM would run the same way.</p>\n\n<blockquote>\n  <p>So why do I need to compile my program twice? Suppose, I dont call any OS-related function, or something that depends on the actual OS.</p>\n</blockquote>\n\n<p>You don't have to. But usually you want some entry point into your code, and usually the simplest way how to provide universal entry point is to follow the OS defined ABI (Application Binary Interface), so for example in 32b windows you read arguments from stack, and in 64b linux you receive arguments in registers (when possible). If you wouldn't adjust your procedure prologue code to pick arguments in correct way, it will operate with wrong inputs in the \"other\" OS than it is written for.</p>\n\n<p>But the machine code itself, the CPU instructions, are same.</p>\n\n<p>That said, on x86 the situation is a bit more hairy due to historical backward compatibility, so the CPU can be in 16b mode, 32b [protected] mode (couple of them plus differently set up), or 64b mode. The 80386 CPU instruction <code>mov eax,1</code> has different machine code encoding for 16b mode, and for 32b mode.</p>\n\n<p>But as long as you are targetting the same CPU mode, the machine code of the same instruction is compiled in the same way. You just write source differently to follow different ABI.</p>\n\n<p>And the executable files... each format is different, it's not even \"per OS\", again due to historical reasons almost all x86 OS support several executable file formats, so the meta data around machine code stored in the file (to be used by OS during loading machine code into memory and setting it up for run) are completely different.</p>\n\n<p>Practical example is linux app <code>wine</code>, which can execute windows executables, by providing fake OS hook points to simulate windows OS, and by understanding windows executable binaries, so correctly loading them into memory. The machine code of such windows application is run natively, without any further patching.</p>\n"}], "owner": {"reputation": 3430, "user_id": 1708155, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/t3GJi.jpg?s=128&g=1", "display_name": "dnnagy", "link": "https://stackoverflow.com/users/1708155/dnnagy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1498, "favorite_count": 2, "closed_date": 1481930504, "accepted_answer_id": 41154361, "answer_count": 1, "score": 5, "last_activity_date": 1481760624, "creation_date": 1481757927, "question_id": 41153978, "link": "https://stackoverflow.com/questions/41153978/why-does-the-machine-code-depend-on-the-os-type", "closed_reason": "Needs more focus", "title": "Why does the machine code depend on the OS type?", "body": "<p>Suppose, I have a program written in C and I have two identical computers, the one is running Windows and the other is linux. Since the computers are identical, their processors have the same instruction set, so the machine code after compilation should be the same. So why do I need to compile my program twice? Suppose, I dont call any OS-related function, or something that depends on the actual OS.</p>\n"}, {"tags": ["c", "runtime-error"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1481757705, "post_id": 41153929, "comment_id": 69509794, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a Minimal, Complete, and Verifiable example."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1481757833, "post_id": 41153929, "comment_id": 69509818, "body": "<code>for (i=0;i&lt;=input</code> --&gt; <code>for (i=1;i&lt;input</code>"}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 5, "last_activity_date": 1481757952, "creation_date": 1481757952, "answer_id": 41153981, "question_id": 41153929, "link": "https://stackoverflow.com/questions/41153929/c-programing-code-dosent-work/41153981#41153981", "title": "c.programing, code dosent work", "body": "<p><code>input % i</code> returns the remainder when dividing <code>input</code> by <code>i</code>. But you can't divide a number by <code>0</code>, so <code>input % 0</code> results in undefined behavior.</p>\n\n<p>Change your loop to start from <code>1</code> rather than <code>0</code>. Also, you should stop <em>before</em> <code>i</code> reaches <code>number</code>, because the number is always a divisor of itself, but that shouldn't be included in the sum when adding up the divisors (how could a number be equal to the sum of itself and all the divisors?).</p>\n\n<pre><code>for (i = 1; i &lt; number; i++)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196, "user_id": 7246196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PGxLg.png?s=128&g=1", "display_name": "Brandon83", "link": "https://stackoverflow.com/users/7246196/brandon83"}, "is_accepted": false, "score": 1, "last_activity_date": 1481758090, "creation_date": 1481758090, "answer_id": 41153999, "question_id": 41153929, "link": "https://stackoverflow.com/questions/41153929/c-programing-code-dosent-work/41153999#41153999", "title": "c.programing, code dosent work", "body": "<p>you have <code>input%i == 0</code>  and <code>i</code> is being initialized to <code>0</code>.  This is essentially dividing by <code>0</code> on the first iteration which is probably where the error is coming from.</p>\n"}], "owner": {"reputation": 1, "user_id": 7299257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7941bf75f0c7ae7f57f03b844e74388c?s=128&d=identicon&r=PG&f=1", "display_name": "d.ginzburg", "link": "https://stackoverflow.com/users/7299257/d-ginzburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1481758090, "creation_date": 1481757658, "question_id": 41153929, "link": "https://stackoverflow.com/questions/41153929/c-programing-code-dosent-work", "title": "c.programing, code dosent work", "body": "<p>my program is to check if a number is a perfect number \nI have a runtime eror please help \nand I am using notepad++ if it matters </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int input=0;\n    int i=0;\n    int counter=0;\n\n    printf(\"enter a number \\n\");\n    scanf(\"%d\", &amp;input);\n    for (i=0;i&lt;=input;i++)\n    {\n        if (input%i==0)\n        {\n            counter = counter+i;\n        }\n    }\n    if (input==counter)\n    {\n        printf(\"%d in a perfect number\\n\", counter);\n    }\n    else\n    {\n        printf(\"%d is not a perfect number\\n\", input);\n    }\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list", "bit-manipulation", "bitwise-operators", "bit-shift"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1481756706, "post_id": 41153712, "comment_id": 69509447, "body": "My guess is you have an uninitialized <code>list-&gt;next</code>. So the problem is in your code that builds the list, not the code you&#39;ve posted here."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481756802, "post_id": 41153712, "comment_id": 69509482, "body": "Run your program under a debugger, and check all your <code>next</code> pointers when this happens."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481758017, "post_id": 41153712, "comment_id": 69509882, "body": "You&#39;re probably accessing out of bounds of an array"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481759997, "post_id": 41153712, "comment_id": 69510424, "body": "Step 1: Change type: <code>short shape</code> --&gt; <code>unsigned short shape</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481760089, "post_id": 41153712, "comment_id": 69510451, "body": "In <code>while (i &lt; piece-&gt;height)</code> , I&#39;d expect the bit shifted out to be used in the next element."}], "owner": {"reputation": 9, "user_id": 7299187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84d70e1f56297ad66fc96f91d424b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Eclahn", "link": "https://stackoverflow.com/users/7299187/eclahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481759822, "creation_date": 1481756426, "last_edit_date": 1481759822, "question_id": 41153712, "link": "https://stackoverflow.com/questions/41153712/bitwise-right-shift-affecting-another-short", "title": "bitwise right shift affecting another short", "body": "<p>I am using bitwise operators to shift the binary value of shorts within a linked list. The function is recursive and after an arbitrary number of occurrences, my right shift seems to affect the value of a short in the next link despite me not pointing to this link at all at this point of the function. Here is my code :</p>\n\n<pre><code>static void move_right(t_tetri *piece) {\n  int i;\n  i = 0;\n  piece-&gt;x_offset++;\n  while (i &lt; piece-&gt;height) {\n    piece-&gt;shape[i] = piece-&gt;shape[i] &gt;&gt; 1;\n    i++;\n  }\n}\n\nint ft_solve(t_map *map, t_tetri *list) {\n  if (list == NULL) return (1);\n  while (list-&gt;y_offset + list-&gt;height &lt;= map-&gt;size) {\n    while (list-&gt;x_offset + list-&gt;width &lt;= map-&gt;size) {\n      if (put_tetri(map, list)) {\n        set_piece(map, list);\n        if (ft_solve(map, list-&gt;next)) return (1);\n        else unset_piece(map, list);\n      }\n      move_right(list);\n    }\n    reset_piece(list);\n  }\n  list-&gt;y_offset = 0;\n  return (0);\n}\n</code></pre>\n\n<p><code>piece-&gt;shape</code> is an array containing 4 <code>short</code> but I'm mostly concerned about the first of these here. In certain cases (not all) when I go through the <code>move_right</code> function the value of <code>piece-&gt;next-&gt;shape[0]</code> is shifted in the same way, which poses a big problem for the next recursion of ft_solve.</p>\n\n<p>Would anyone have any idea?</p>\n\n<p>I can post more of my code if necessary, I'm not really used to ask questions here so if you need more information I'm ready to add it.</p>\n"}, {"tags": ["c", "multithreading", "mutex"], "comments": [{"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 7, "creation_date": 1481755627, "post_id": 41153505, "comment_id": 69509033, "body": "Copy x to a local variable inside the lock and then return that copy instead."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1481755633, "post_id": 41153505, "comment_id": 69509034, "body": "Sidenote: <code>return</code> is a statement, not a function. Don&#39;t use parentheses around the expression. That can result in subtle errors."}, {"owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1481755716, "post_id": 41153505, "comment_id": 69509067, "body": "@Fredrik so then the answer to part 1 of the question (is a race condition possible in between the unlock and return) is yes?"}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1481755758, "post_id": 41153505, "comment_id": 69509081, "body": "That&#39;s correct a race condition is possible."}, {"owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1481755800, "post_id": 41153505, "comment_id": 69509097, "body": "@Fredrik feel free to make your two comments an answer and I&#39;ll accept :) Thank You"}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 1, "creation_date": 1481755896, "post_id": 41153505, "comment_id": 69509127, "body": "Commenting from my phone, to much of a hassle to create an answer ;) thanks for the thought"}, {"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1481755962, "post_id": 41153505, "comment_id": 69509154, "body": "@Fredrik why does making a local variable work, exactly?"}, {"owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "reply_to_user": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 2, "creation_date": 1481756011, "post_id": 41153505, "comment_id": 69509176, "body": "@c650 I think it works because each thread has it&#39;s own stack, and therefore it&#39;s own copy of the local variable. Therefore even if thread 1 has it&#39;s execution paused before the return statement, the value of the variable it returns can not be changed by another thread."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "reply_to_user": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 3, "creation_date": 1481756106, "post_id": 41153505, "comment_id": 69509205, "body": "@c650 Because the local variable can&#39;t be changed before returned. The variable x could be changed by another thread before returned."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1481756148, "post_id": 41153505, "comment_id": 69509225, "body": "@Ankush exactly"}, {"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1481756978, "post_id": 41153505, "comment_id": 69509551, "body": "Thank you, @Fredrik"}], "answers": [{"tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": true, "score": 9, "last_activity_date": 1481756099, "creation_date": 1481756099, "answer_id": 41153647, "question_id": 41153505, "link": "https://stackoverflow.com/questions/41153505/can-a-race-condition-occur-between-mutex-unlocking-and-returning-from-function/41153647#41153647", "title": "Can a race condition occur between mutex unlocking and returning from function", "body": "<p>Here's the sequence of events in your current code:</p>\n\n<ol>\n<li>Unlock the lock.</li>\n<li>Read the shared <code>x</code> variable.</li>\n<li>Return the value you read.</li>\n</ol>\n\n<p>The read of <code>x</code> is completely unprotected.</p>\n\n<p>What you need to do is</p>\n\n<ol>\n<li>Read the shared <code>x</code> variable.</li>\n<li>Unlock the lock.</li>\n<li>Return the value you read.</li>\n</ol>\n\n<p>so that the read is protected by the lock. To do that, store the value of <code>x</code> to an unshared (local) variable before unlocking the lock, and use that as the return value:</p>\n\n<pre><code>int retval = x;\npthread_mutex_unlock(&amp;mutex);\nreturn retval;\n</code></pre>\n"}], "owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 1, "accepted_answer_id": 41153647, "answer_count": 1, "score": 3, "last_activity_date": 1481756099, "creation_date": 1481755425, "last_edit_date": 1481755753, "question_id": 41153505, "link": "https://stackoverflow.com/questions/41153505/can-a-race-condition-occur-between-mutex-unlocking-and-returning-from-function", "title": "Can a race condition occur between mutex unlocking and returning from function", "body": "<p>I've been learning about Multithreaded applications and in particular, about how a mutex can be used to prevent race conditions. However, while writing some code, I discovered a race condition (using the <code>helgrind</code> tool from <code>valgrind</code>) in my code, I believe that execution in one thread may be pausing after the unlock and before the return.</p>\n\n<p>If we take the example code below, <strong>is a race condition possible in between the mutex unlock and the return statement? If so, how do we get around this   problem?</strong> (short of requiring the caller to pass in some sort of buffer and returning a constant value like <code>0</code>)</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n\nint x = 0;\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\n\ndoSomething()\n{\n    pthread_mutex_lock(&amp;mutex);\n    ++x;\n    pthread_mutex_unlock(&amp;mutex);\n               /* &lt;-- Race Condition? */\n    return x;\n}\n\nvoid *t2()\n{\n    doSomething();\n}\n\nmain()\n{\n    pthread_t thread;\n    pthread_t_create(&amp;thread, NULL);\n    doSomething();\n    pthread_join(thread, NULL);\n    return 0;\n}\n</code></pre>\n\n<p><strong>NOTE:</strong> I understand that in the above example, returning 'x' is useless, as x is global. However, in a library where 'x' needs to be global for library functions, but can't be exposed to the user, the return  value becomes important.</p>\n"}, {"tags": ["c", "performance"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1481751128, "post_id": 41152415, "comment_id": 69507251, "body": "It is not clear what your problem is. If you want to benchmark, read how to do it properly. If you have other problems, you should be more specific."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 6, "creation_date": 1481751196, "post_id": 41152415, "comment_id": 69507282, "body": "On modern CPU hardware, the only operations with data-dependent performance are (int and FP) division and sqrt. (They are often variable latency, and not fully pipelined; see <a href=\"http://stackoverflow.com/questions/40354978/why-is-this-c-code-faster-than-my-hand-written-assembly-for-testing-the-collat/40355466#40355466\">the recent Collatz-conjecture hand-written asm question for more about DIV vs. shifts, for example</a>).  add/sub/mul/shift are all fixed latency/throughput.  This is definitely true on all current <a href=\"http://agner.org/optimize\" rel=\"nofollow noreferrer\">x86 CPUs</a>, and almost certainly true on most other systems."}, {"owner": {"reputation": 181, "user_id": 2880968, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000439636982/picture?type=large", "display_name": "Shaun Holtzman", "link": "https://stackoverflow.com/users/2880968/shaun-holtzman"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481751350, "post_id": 41152415, "comment_id": 69507364, "body": "@Olaf I don&#39;t have a specific problem, I&#39;m just curious. I took off the benchmarking tag in case it made it seem like I have a specific benchmarking question. I figured a kernel benchmark would be a good example to illustrate what I was trying to ask."}, {"owner": {"reputation": 274, "user_id": 6562313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59b0bb1e797a141fb9a0da24bc81fab?s=128&d=identicon&r=PG&f=1", "display_name": "DBPriGuy", "link": "https://stackoverflow.com/users/6562313/dbpriguy"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1481751396, "post_id": 41152415, "comment_id": 69507382, "body": "@PeterCordes has it right. On most modern architectures, <i>type</i> certainly matters, but not the <i>value</i> for most of the basic ALU operations."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 274, "user_id": 6562313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59b0bb1e797a141fb9a0da24bc81fab?s=128&d=identicon&r=PG&f=1", "display_name": "DBPriGuy", "link": "https://stackoverflow.com/users/6562313/dbpriguy"}, "edited": false, "score": 2, "creation_date": 1481751444, "post_id": 41152415, "comment_id": 69507402, "body": "@DBPriGuy: It does for e.g. division matter a lot. Worse: on high-end CPUs value can matter even for single-cycle operations: a lot of switching nodes in the CPU generates more heat, which can result in reduced clock for e.g. slim-line notebooks or mobile phones. Or even for normal desktops if they use turbo-speed modes."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1481751500, "post_id": 41152415, "comment_id": 69507423, "body": "@PeterCordes: Does that include operations on NaNs, infinities, and subnormals?"}, {"owner": {"reputation": 274, "user_id": 6562313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59b0bb1e797a141fb9a0da24bc81fab?s=128&d=identicon&r=PG&f=1", "display_name": "DBPriGuy", "link": "https://stackoverflow.com/users/6562313/dbpriguy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481751545, "post_id": 41152415, "comment_id": 69507435, "body": "@Olaf: I agree, which is why I said <i>most</i>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 274, "user_id": 6562313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59b0bb1e797a141fb9a0da24bc81fab?s=128&d=identicon&r=PG&f=1", "display_name": "DBPriGuy", "link": "https://stackoverflow.com/users/6562313/dbpriguy"}, "edited": false, "score": 0, "creation_date": 1481751646, "post_id": 41152415, "comment_id": 69507471, "body": "@DBPriGuy: Which architectures other than Core-i, ARMv7A/v8A, current AMD (and most probably Zen), POWER or GPUs from Nvidia and AMD do you consider &quot;most modern&quot;?"}, {"owner": {"reputation": 274, "user_id": 6562313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59b0bb1e797a141fb9a0da24bc81fab?s=128&d=identicon&r=PG&f=1", "display_name": "DBPriGuy", "link": "https://stackoverflow.com/users/6562313/dbpriguy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481751844, "post_id": 41152415, "comment_id": 69507568, "body": "@Olaf: Sigh, we seem to be having a hard time understanding each other. I was referring to most operations, I apologize for my lack of clarity. Essentially, I am expressing agreement with Peter Cordes."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 274, "user_id": 6562313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59b0bb1e797a141fb9a0da24bc81fab?s=128&d=identicon&r=PG&f=1", "display_name": "DBPriGuy", "link": "https://stackoverflow.com/users/6562313/dbpriguy"}, "edited": false, "score": 0, "creation_date": 1481752343, "post_id": 41152415, "comment_id": 69507780, "body": "@DBPriGuy: I refer to <b>all</b> operations. Without any offence: this is about digital electronics, CMOS technology, power management and dynamic clocking; you need very deep knowledge about this to understand the problems. Things have become very complicated since CPUs change their clock frequency extremely dynamically with power consumption and die temperature. Some even change it depending on the physical region which heats up, i.e. which part of the die the rise in temperature is and from one clock cycle to another. The clock can change by 50 or more percent."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1481752938, "post_id": 41152415, "comment_id": 69508040, "body": "Even if the per-operation cost does not vary with the operand values, if the result of the operations are used in a branch condition then having always the same operand values will cause the branch to always go the same way.  A CPU that performs dynamic branch prediction to attempt to speed up execution (as all modern PC-class CPUs do) would likely run that faster than if the relevant operand values were random."}, {"owner": {"reputation": 181, "user_id": 2880968, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000439636982/picture?type=large", "display_name": "Shaun Holtzman", "link": "https://stackoverflow.com/users/2880968/shaun-holtzman"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481753291, "post_id": 41152415, "comment_id": 69508169, "body": "@JohnBollinger The values of the matrix all being the same was just a way for me to sort of simplify the question and make it concise. I am really just interested in the amount of time a calculation would take from start to finish. For example: <code>for(i=0;i&lt;size;i++) { C[i]=A[i]+B[i]; }</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481753596, "post_id": 41152415, "comment_id": 69508285, "body": "@ShaunHoltzman, then I have no idea what you&#39;re actually asking.  As far as I can tell, the effect of the values being the same is not at all incidental to the question -- on the contrary, it seems to be the whole focus."}, {"owner": {"reputation": 181, "user_id": 2880968, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000439636982/picture?type=large", "display_name": "Shaun Holtzman", "link": "https://stackoverflow.com/users/2880968/shaun-holtzman"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481754655, "post_id": 41152415, "comment_id": 69508674, "body": "@JohnBollinger What I&#39;m trying to get at is if I&#39;m, for example, adding up two 32-bit matrices with large numbers, A[0] = 1,021,000,398 A[1] = 1,278,236,282...+B[0] = 2,102,123,010 B[1] = 1,009,876,148... in a for loop, will that be slower than doing the same for loop with smaller 32-bit numbers such as, A[0] = 3 A[1] = 2 ...etc. + B[0] = 9 B[1] = 6. The numbers are the same data type (32 bit integers) but in one case they are all very large and in the other case they are small. Would the performance differ, or would it be similar since they are all still 32-bit integers in memory"}, {"owner": {"reputation": 274, "user_id": 6562313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59b0bb1e797a141fb9a0da24bc81fab?s=128&d=identicon&r=PG&f=1", "display_name": "DBPriGuy", "link": "https://stackoverflow.com/users/6562313/dbpriguy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481754812, "post_id": 41152415, "comment_id": 69508717, "body": "@Olaf: So you are in disagreement with Peter Cordes, then?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 274, "user_id": 6562313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59b0bb1e797a141fb9a0da24bc81fab?s=128&d=identicon&r=PG&f=1", "display_name": "DBPriGuy", "link": "https://stackoverflow.com/users/6562313/dbpriguy"}, "edited": false, "score": 2, "creation_date": 1481755188, "post_id": 41152415, "comment_id": 69508860, "body": "@DBPriGuy: No. Peter talks about clocks, which is correct in a synchronous CPU (which all major CPUs are). I talk talk about time. Not the number of cycles can vary, but the length of each cycle. Note that OP asks about time (which is reasonable for a program). But there are many other influences in a system. Proper benchmarking is not a beginner&#39;s job. &quot;Benchmarks do lie, liars do benchmarks&quot; - this proverb has a very serious background. Today way more than the time it originates from (I know this since the 1980ies; it might very well be much older)."}, {"owner": {"reputation": 274, "user_id": 6562313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59b0bb1e797a141fb9a0da24bc81fab?s=128&d=identicon&r=PG&f=1", "display_name": "DBPriGuy", "link": "https://stackoverflow.com/users/6562313/dbpriguy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481755666, "post_id": 41152415, "comment_id": 69509047, "body": "@Olaf: Ah, I reread everything you wrote and now I understand what you are saying. Thanks for sharing your knowledge!"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1481755859, "post_id": 41152415, "comment_id": 69509114, "body": "@ShaunHoltzman, in that case, I have edited your question to more clearly convey what I now understand you to be asking."}, {"owner": {"reputation": 181, "user_id": 2880968, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000439636982/picture?type=large", "display_name": "Shaun Holtzman", "link": "https://stackoverflow.com/users/2880968/shaun-holtzman"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481756581, "post_id": 41152415, "comment_id": 69509391, "body": "@JohnBollinger thanks, your edit definitely helps articulate my question better."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481760487, "post_id": 41152415, "comment_id": 69510565, "body": "@JohnBollinger: great point, Shaun should have a look at SO&#39;s highest-voted question: <a href=\"http://stackoverflow.com/questions/11227809/why-is-it-faster-to-process-a-sorted-array-than-an-unsorted-array\">Why is it faster to process a sorted array than an unsorted array?</a>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1481761194, "post_id": 41152415, "comment_id": 69510771, "body": "@user2357112: good question.  On <b>x86 with SSE: NaN and Infinity as inputs/outputs: no penalty</b>.  On x86 with x87 legacy FPU: NaN and Infinity: <a href=\"http://stackoverflow.com/questions/31875464/huge-performance-difference-26x-faster-when-compiling-for-32-and-64-bits/31879376#31879376\">big slowdown</a>.  <b>Denormals</b>: depends on the microarchitecture, but many do trap to microcode to handle it.  Intel Sandybridge has fast denormals for add/subtract, but not multiply.  IIRC, AMD always does denormals in hardware.  Of course, setting FTZ (flush to zero) and DAZ (input denormals are zero) avoids these."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1481760326, "post_id": 41154193, "comment_id": 69510513, "body": "Normal compilers for normal platforms (like x86) always align integers, floats and double to their natural alignment (e.g. 8 bytes for 8-byte values).  You have to specifically use <code>__attribute__((packed))</code> or a similar pragma to override this inside a struct.  Arranging your data in structs to avoid padding can make the difference between the whole struct fitting in one cache line or not, though, leading to larger-scale cache hit rate effects over multiple structs."}, {"owner": {"reputation": 196, "user_id": 7246196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PGxLg.png?s=128&g=1", "display_name": "Brandon83", "link": "https://stackoverflow.com/users/7246196/brandon83"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1481761048, "post_id": 41154193, "comment_id": 69510730, "body": "Great point!  I work in the embedded world mostly and unfortunately this isn&#39;t always the case :(.  The alignment needs to be forced by the developer and accounted for as I have mentioned above."}, {"owner": {"reputation": 196, "user_id": 7246196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PGxLg.png?s=128&g=1", "display_name": "Brandon83", "link": "https://stackoverflow.com/users/7246196/brandon83"}, "edited": false, "score": 0, "creation_date": 1481771905, "post_id": 41154193, "comment_id": 69513506, "body": "There is nothing wrong with expanding on the OP&#39;s question and providing extra information which is related to the original question.  Don&#39;t troll and mark down answers where you have not provided any useful information on the topic or constructive criticism on how to make the answer better."}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1481795162, "post_id": 41154193, "comment_id": 69522868, "body": "I agree that additional information can be useful, but only if the question is answered too. Stop trying to tell me what to do, anyone if free to vote for any reason. But I actually provided a suggestion to make your answer better: Answer the question."}, {"owner": {"reputation": 196, "user_id": 7246196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PGxLg.png?s=128&g=1", "display_name": "Brandon83", "link": "https://stackoverflow.com/users/7246196/brandon83"}, "reply_to_user": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1481808897, "post_id": 41154193, "comment_id": 69531244, "body": "@alain: I have updated my response to clearly answer the question from feedback provided in the comments section.  I have also provided some additional information to consider that could affect performance.  Thank you for your input!"}], "tags": [], "owner": {"reputation": 196, "user_id": 7246196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PGxLg.png?s=128&g=1", "display_name": "Brandon83", "link": "https://stackoverflow.com/users/7246196/brandon83"}, "is_accepted": false, "score": 1, "last_activity_date": 1481808480, "last_edit_date": 1481808480, "creation_date": 1481759359, "answer_id": 41154193, "question_id": 41152415, "link": "https://stackoverflow.com/questions/41152415/does-the-cost-of-arithmetic-operations-on-a-given-data-type-vary-with-operand-va/41154193#41154193", "title": "Does the cost of arithmetic operations on a given data type vary with operand values?", "body": "<p>The data contained within a variable will not affect the performance it is just a storage space.  If the data in this storage space has to be manipulated in some fashion you could encounter some performance issues.  Here are a couple of things to consider that could affect performance related to this.</p>\n\n<ol>\n<li><p>Depending on the hardware architecture of the CPU (i.e. HW FPU vs SW floating point implementation, pipelined vs not pipelined etc...) performing a CPU intensive mathematical operation (i.e. division, square root, etc...) on different data sets could affect performance.</p></li>\n<li><p>Another scenario that could affect performance is where that variable resides in memory.  Is the variable byte aligned in a way that it will only take one instruction cycle to access the data? Or is it misaligned so it takes an extra instruction cycle to retrieve all the data.  Often in these cases the compiler will have special keywords or even pragma's that can force variables to be aligned for optimization.</p></li>\n</ol>\n\n<p>Best Regards!</p>\n"}], "owner": {"reputation": 181, "user_id": 2880968, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000439636982/picture?type=large", "display_name": "Shaun Holtzman", "link": "https://stackoverflow.com/users/2880968/shaun-holtzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1481808480, "creation_date": 1481750573, "last_edit_date": 1481755818, "question_id": 41152415, "link": "https://stackoverflow.com/questions/41152415/does-the-cost-of-arithmetic-operations-on-a-given-data-type-vary-with-operand-va", "title": "Does the cost of arithmetic operations on a given data type vary with operand values?", "body": "<p>If I perform a computation written in C, something like matrix-matrix addition or matrix-matrix multiplication, where the work is done in a <code>for</code> loop, with the same number and type of arithmetic operations happening on each iteration, could the specific values of the input data impact the speed of the computation?  For example, if the matrix elements are 32-bit integers with values between 0 and 127, so that their representations vary only in one out of each four corresponding bytes, would that run faster than if the values varied between 0 and <code>INT_MAX</code> (supposing no undefined behavior occurs)?</p>\n\n<p>If I had to guess I would say no, because whether or not the value is small or very large, since it is defined as a 32-bit integer it will be masked to fit in the same amount of memory space so the small and large values will end up having the same amount of bytes in memory. Am I thinking about this correctly? Is it different for single/double precision floating point numbers?</p>\n"}, {"tags": ["c", "algorithm", "time-complexity"], "comments": [{"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 3, "creation_date": 1481752272, "post_id": 41152365, "comment_id": 69507754, "body": "This is not valid C code. <code>hash.find</code> requires <code>myHash</code> to be a struct type; but <code>hash[c]</code> requires <code>myHash</code> to be an array or pointer type. Did you maybe mean to tag this as C++?"}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1481755326, "post_id": 41152365, "comment_id": 69508919, "body": "abc is not the only answer, you also have bca and cab."}], "answers": [{"tags": [], "owner": {"reputation": 765, "user_id": 1250473, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/spHQA.png?s=128&g=1", "display_name": "Marshall Conover", "link": "https://stackoverflow.com/users/1250473/marshall-conover"}, "is_accepted": false, "score": 1, "last_activity_date": 1481751040, "creation_date": 1481751040, "answer_id": 41152516, "question_id": 41152365, "link": "https://stackoverflow.com/questions/41152365/code-complexity-of-longest-non-repeating-substring-algorithm/41152516#41152516", "title": "Code complexity of longest non-repeating substring algorithm", "body": "<p>If I'm understanding your algorithm and data structure used correctly, consider the worse-case scenario: we get a string of the same character over and over again, and have to erase every time. In that case, we've performed just about <code>2n</code> operations for the string. This is still linear growth, granted with a constant in front of it. So, for the purposes of understanding how it grows, we're still linear growth -  but, as you noted, in between <code>n</code> and <code>n^2</code>, since we're about <code>2n</code> worst-case.</p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1481751237, "creation_date": 1481751237, "answer_id": 41152573, "question_id": 41152365, "link": "https://stackoverflow.com/questions/41152365/code-complexity-of-longest-non-repeating-substring-algorithm/41152573#41152573", "title": "Code complexity of longest non-repeating substring algorithm", "body": "<p>The complexity of this algorithm is indeed O(n).</p>\n\n<p><strong>Proof:</strong> Consider the values of <code>start</code> and <code>end</code>. Each iteration of the outer loop performs one of two actions:</p>\n\n<ul>\n<li>advances <code>end</code> by 1, or</li>\n<li>advances <code>start</code> in a loop one or more times.</li>\n</ul>\n\n<p>The number of times that <code>end</code> is advanced is equal to <code>n</code>, the length of the input. The <em>total</em> number of times that <code>start</code> is advanced cannot exceed <code>n</code>, because <code>index</code> is never set to a number above <code>n</code>, and <code>start</code> is never decremented.</p>\n\n<p>Hence, the total number of times the outer loop runs is <code>n</code>, and the total number of times the inner loop runs is <code>n</code>, yielding time complexity of O(n).</p>\n\n<p>Note that the inner loop does not do all <code>n</code> iterations at once. Its iterations are \"distributed\" among the iterations of the outer loop. However, if you total up the number of iterations of the inner loop, during all iterations of the outer loop, they are not going to exceed <code>n</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1481752070, "creation_date": 1481752070, "answer_id": 41152771, "question_id": 41152365, "link": "https://stackoverflow.com/questions/41152365/code-complexity-of-longest-non-repeating-substring-algorithm/41152771#41152771", "title": "Code complexity of longest non-repeating substring algorithm", "body": "<p>Asymptotic complexity analysis is trickier than just counting loops.</p>\n\n<p>Before we go any further, however, do note that if an algorithm's asymptotic complexity is O(n), then it is <em>also</em> O(n<sup>2</sup>), as the latter expresses a weaker bound.  Presumably you're looking for the tightest bound.</p>\n\n<p>So let's now look at sum of all the operations performed in all the iterations of the outer loop.  On each iteration,  <code>hash.find(c) == hash.end()</code> is computed. We assume each such evaluation costs O(1).  Then there are two alternatives:</p>\n\n<ol>\n<li><p>the current character, <code>s[end]</code>, is distinct from all others in the current substring, as judged by the hash lookup.  In this case, the current character is added to the current substring, and <code>end</code> is incremented.</p></li>\n<li><p>the current character duplicates a previous character in the current substring.  In this case, the previous appearance of the current character and each preceding character in the current substring is removed from the substring.</p></li>\n</ol>\n\n<p>Each of the <code>n</code> characters in the original string is added to the current string once, and removed from it at most once, and the actions involved in each individual character's addition or removal cost O(1).  The remaining operations performed in the outer loop cost O(1) per iteration.  Every iteration of the loop performs either one addition or at least one removal, so there cannot be more than 2*n iterations altogether.  That gives the loop nest a worst-case cost of <code>n * O(1)</code> [for additions] + <code>n * O(1)</code> [for removals] + <code>2 * n * O(1)</code> [for other operations], for a total cost bounded by <code>4 * n * O(1) = O(4n) = O(n)</code>.</p>\n"}], "owner": {"reputation": 1411, "user_id": 6018651, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/17f6ddba3381095e37c4cc8599316689?s=128&d=identicon&r=PG", "display_name": "beetlej", "link": "https://stackoverflow.com/users/6018651/beetlej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 41152771, "answer_count": 3, "score": 0, "last_activity_date": 1481753153, "creation_date": 1481750308, "last_edit_date": 1481753153, "question_id": 41152365, "link": "https://stackoverflow.com/questions/41152365/code-complexity-of-longest-non-repeating-substring-algorithm", "title": "Code complexity of longest non-repeating substring algorithm", "body": "<h3>Problem:</h3>\n\n<p>Given a string, find the length of the longest substring without repeating characters.</p>\n\n<p>Examples:</p>\n\n<p>Given \"abcabcbb\", the answer is \"abc\", which the length is 3.</p>\n\n<h3>Solution:</h3>\n\n<pre><code>int lengthOfLongestSubstring(char* s) {\n    if (s == NULL) {\n        return 0;\n    }\n    myHash  hash;\n    int start = 0;\n    int end = 0;\n    int maxLen = 0;\n    while (s[end] != '\\0') {\n        char c = s[end];\n        if (hash.find(c) == hash.end()) {\n            hash[c] = end;\n            end++;\n        }else {\n            if (end - start &gt; maxLen) {\n                maxLen = end - start;\n            }\n            int index = hash[c];\n            while(start &lt;= index) {\n                hash.erase(s[start]);\n                start++;\n            }\n        }\n    }\n    if (end - start &gt; maxLen) {\n        maxLen = end - start;\n    }\n    return maxLen;\n}\n</code></pre>\n\n<h3>Complexity:</h3>\n\n<p>Some one said this algorithm complexity is O(n) but I think it didn't consider the second loop, it's less than O(n^2) but should be bigger than O(n).</p>\n\n<p>How should we analyze the worst case complexity?</p>\n"}, {"tags": ["c", "performance", "buffer", "byte-shifting"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481748736, "post_id": 41151894, "comment_id": 69506081, "body": "It is too dangerous to <code>strcat(argv[1], suffix);</code> you have no idea if there is enough room."}, {"owner": {"reputation": 332, "user_id": 2010012, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/01f47bec1cf38b0bc2ba112a6613fe1c?s=128&d=identicon&r=PG", "display_name": "james28909", "link": "https://stackoverflow.com/users/2010012/james28909"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481749205, "post_id": 41151894, "comment_id": 69506341, "body": "hmm so what would be the best way to handle that? I looked for a way to add the suffix to the filename from argv. ofcourse argv[1]+&quot;.suffix&quot; didnt work ;("}, {"owner": {"reputation": 332, "user_id": 2010012, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/01f47bec1cf38b0bc2ba112a6613fe1c?s=128&d=identicon&r=PG", "display_name": "james28909", "link": "https://stackoverflow.com/users/2010012/james28909"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481749298, "post_id": 41151894, "comment_id": 69506385, "body": "i guess i could output a static filename then rename it after im done."}, {"owner": {"reputation": 332, "user_id": 2010012, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/01f47bec1cf38b0bc2ba112a6613fe1c?s=128&d=identicon&r=PG", "display_name": "james28909", "link": "https://stackoverflow.com/users/2010012/james28909"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1481749476, "post_id": 41151894, "comment_id": 69506463, "body": "i did find this: <a href=\"http://stackoverflow.com/questions/7119718/appending-string-to-input-file-name-in-c\" title=\"appending string to input file name in c\">stackoverflow.com/questions/7119718/&hellip;</a>&quot;"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481749505, "post_id": 41151894, "comment_id": 69506480, "body": "Allocate memory with the required space (incl <code>&#39;\\0&#39;</code> terminator) and build a new string. Either with <code>strcpy</code> and <code>strcat</code>, or with <code>sprintf</code>. But do please check <code>argc</code> before accessing <code>argv[]</code>. Please show how you have tried to do the swapping. From the example, it looks as if you want to swap each pair of bytes."}, {"owner": {"reputation": 332, "user_id": 2010012, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/01f47bec1cf38b0bc2ba112a6613fe1c?s=128&d=identicon&r=PG", "display_name": "james28909", "link": "https://stackoverflow.com/users/2010012/james28909"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481750691, "post_id": 41151894, "comment_id": 69507047, "body": "I tried alot of different things, i would go back and edit my code to include all of the resources but it would take me a while to find them all. let me see what i can do. Everything i tried either crashed, or didnt work. I really want to swap the largest amount of bytes possible, I realize the swapping 4 or 8 pair of bytes would be faster than swapping one pair of bytes. Ill put one of the failed attempts of byteswapping up in the code."}], "answers": [{"comments": [{"owner": {"reputation": 332, "user_id": 2010012, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/01f47bec1cf38b0bc2ba112a6613fe1c?s=128&d=identicon&r=PG", "display_name": "james28909", "link": "https://stackoverflow.com/users/2010012/james28909"}, "edited": false, "score": 0, "creation_date": 1481754592, "post_id": 41152942, "comment_id": 69508656, "body": "&quot;But this is the definition of swapped&quot; hmm i thought that i added to swapped when i tried to byteswap data. I think i see what you mean though, i should have did &#39;sizeof swapped&#39; right?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 332, "user_id": 2010012, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/01f47bec1cf38b0bc2ba112a6613fe1c?s=128&d=identicon&r=PG", "display_name": "james28909", "link": "https://stackoverflow.com/users/2010012/james28909"}, "edited": false, "score": 1, "creation_date": 1481758230, "post_id": 41152942, "comment_id": 69509944, "body": "@james28909 - assuming you mean the <code>fwrite()</code> statement, it should probably be something like <code>fwrite( &amp;swapped, sizeof swapped, 1, output );</code>  Note that the first argument to <code>fwrite()</code> is the <i>address</i> of the data to be written."}, {"owner": {"reputation": 332, "user_id": 2010012, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/01f47bec1cf38b0bc2ba112a6613fe1c?s=128&d=identicon&r=PG", "display_name": "james28909", "link": "https://stackoverflow.com/users/2010012/james28909"}, "edited": false, "score": 0, "creation_date": 1481761367, "post_id": 41152942, "comment_id": 69510824, "body": "i do appreciate your comments, so thanks for that. but i am going to put this down for the evening and pick it back up tomorrow. thanks for your help"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1481752689, "last_edit_date": 1495542632, "creation_date": 1481752689, "answer_id": 41152942, "question_id": 41151894, "link": "https://stackoverflow.com/questions/41151894/c-reading-a-whole-file-into-buffer-and-byteswap-the-buf-addecefa-deadface/41152942#41152942", "title": "C: Reading a whole file into buffer and byteswap the buf | ADDECEFA -&gt; DEADFACE", "body": "<p>Given</p>\n\n<pre><code>int data[16384];\n</code></pre>\n\n<p>this code</p>\n\n<pre><code>while(fread(data,sizeof data, 1, input)){\n</code></pre>\n\n<p>will try to read 16,384 <code>int</code> values from <code>input</code>.  Nothing wrong so far.</p>\n\n<p>But this code:</p>\n\n<pre><code>swapped = ((data &amp; 0x000000FF) &lt;&lt; 24) |\n          ((data &amp; 0x0000FF00) &lt;&lt;  8) |\n          ((data &amp; 0x00FF0000) &gt;&gt;  8) |\n          ((data &amp; 0xFF000000) &gt;&gt; 24);\n</code></pre>\n\n<p>Will put try to stuff whatever part that fits of the byte-swapped <em>address</em> of <code>data</code> into <code>swapped</code>, because <code>data</code> is evaluated as the address of the first element of the array.</p>\n\n<p>You probably want something like this:</p>\n\n<pre><code>swapped = ((data[ 0 ] &amp; 0x000000FF) &lt;&lt; 24) |\n          ((data[ 0 ] &amp; 0x0000FF00) &lt;&lt;  8) |\n          ((data[ 0 ] &amp; 0x00FF0000) &gt;&gt;  8) |\n          ((data[ 0 ] &amp; 0xFF000000) &gt;&gt; 24);\n</code></pre>\n\n<p>But that has a problem that shifting <em>signed</em> <code>int</code> values has implementation-defined behavior.  See <a href=\"https://stackoverflow.com/questions/4009885/arithmetic-bit-shift-on-a-signed-integer\">Arithmetic bit-shift on a signed integer</a></p>\n\n<p>So you probably want</p>\n\n<pre><code>unsigned int data[16384];\n</code></pre>\n\n<p>Even given that, though, you're only swapping one <code>int</code> value.  You need to loop over all the data that's been read, swapping each <code>int</code>, assuming that's what you want to do.</p>\n\n<p>Which raises another problem - your code does not track how much data it needs to byte swap.  You need to count the number of <code>int</code> values read in and <em>use</em> that.</p>\n\n<p>Finally, this code</p>\n\n<pre><code>fwrite(swapped, sizeof data , 1, output);\n</code></pre>\n\n<p>will write <code>sizeof data</code> bytes to <code>output</code>, starting at the address of whatever <code>swapped</code> happens to point to.  But this is the definition of <code>swapped</code>:</p>\n\n<pre><code>int swapped;\n</code></pre>\n\n<p>So that <code>fwrite()</code> call is undefined behavior.</p>\n"}], "owner": {"reputation": 332, "user_id": 2010012, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/01f47bec1cf38b0bc2ba112a6613fe1c?s=128&d=identicon&r=PG", "display_name": "james28909", "link": "https://stackoverflow.com/users/2010012/james28909"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1481763978, "creation_date": 1481748524, "last_edit_date": 1481763978, "question_id": 41151894, "link": "https://stackoverflow.com/questions/41151894/c-reading-a-whole-file-into-buffer-and-byteswap-the-buf-addecefa-deadface", "title": "C: Reading a whole file into buffer and byteswap the buf | ADDECEFA -&gt; DEADFACE", "body": "<p>EDIT: After doing some more research, it seems that what i actually need is big endian to middle endian and vice versa. so 12345678 -> 34127856 and back. Sorry for any confusion.</p>\n\n<p>I have a small file, exactly 16MB. I am reading the whole file into a buffer. What Im trying to do is byteswap the whole file/buffer in one go if possible (eg. uniformly/globaly swaps ADDECEFA => DEADFACE). I have read countless pages of byteswapping but alot of the bitwise/byteswap stuff goes right over my head for some reason (dumb brain most likely). If anyone knows a bitwise/byteswap for dummies, please point me in the right direction!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[]) \n{\n\n    const char * suffix = \".reversed\";\n\n    FILE *input = fopen(argv[1], \"rb\");\n    char * out = strcat(argv[1], suffix);\n    FILE *output = fopen(out, \"wb\");\n\n    int data[16384];\n    int swapped;\n\n while(fread(data,sizeof data, 1, input)){\n\n    swapped = ((data &amp; 0x000000FF) &lt;&lt; 24) |\n              ((data &amp; 0x0000FF00) &lt;&lt;  8) |\n              ((data &amp; 0x00FF0000) &gt;&gt;  8) |\n              ((data &amp; 0xFF000000) &gt;&gt; 24);\n\n    fwrite(swapped, sizeof data , 1, output);\n\n            /*  by golly it copies the file fast as heck!\n                but i am unsure how to manipulate 'data' buffer\n                so as it uniformly/globaly swaps ADDECEFA =&gt; DEADFACE \n            */\n        }\n    }\n</code></pre>\n\n<p>Also, if you see me doing something wrong in my code, please tell me and show me a better way. If you need me to elaborate anything please dont hesitate to ask. Thanks and have a good one. </p>\n\n<p>EDIT: I added one of my failed attempts. My end goal was to swap the bytes as I write it back out to outfile and swap them as efficiently as possible.</p>\n"}, {"tags": ["c", "pointers", "malloc", "free"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 4, "creation_date": 1481746652, "post_id": 41151414, "comment_id": 69505021, "body": "What do you mean by, &quot;does not work&quot;? What behavior are you seeing, and what do you expect to happen?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 6, "creation_date": 1481746668, "post_id": 41151414, "comment_id": 69505028, "body": "<code>if (&amp;s!=NULL){</code> Why do you care about <i>the address</i> of <code>s</code>?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1481746706, "post_id": 41151414, "comment_id": 69505048, "body": "Probably not a good idea to call a function <code>delete</code> - as it is a keyword in C++ and may lead to confusion"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481746748, "post_id": 41151414, "comment_id": 69505064, "body": "<code>student *s; init(s);</code> uses the value of an uninitialized variable (<code>s</code>), which has undefined behavior."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1481746749, "post_id": 41151414, "comment_id": 69505065, "body": "<a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">please read this about casting malloc</a>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1481746795, "post_id": 41151414, "comment_id": 69505090, "body": "C passes arguments by value. <code>f(x)</code> can&#39;t change <code>x</code>."}, {"owner": {"reputation": 21, "user_id": 7298655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/005c8400cff98ba7e62a0d6c557c40e9?s=128&d=identicon&r=PG&f=1", "display_name": "user7298655", "link": "https://stackoverflow.com/users/7298655/user7298655"}, "edited": false, "score": 0, "creation_date": 1481746853, "post_id": 41151414, "comment_id": 69505120, "body": "I&#39;m starting to just play with the programming. Still I do not know the function"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1481746865, "post_id": 41151414, "comment_id": 69505127, "body": "<code>free()</code> is happy to take a null pointer and does nothing.  The address of <code>s</code> will never be a null pointer; the <code>if</code> line is useless (and the compiler I use, GCC, would warn about it because of the compilation options I use \u2014 if yours doesn&#39;t, you aren&#39;t getting full value from your compiler, or you need a better compiler)."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 4, "creation_date": 1481746867, "post_id": 41151414, "comment_id": 69505128, "body": "Your problem can be reduced to: <code>void foo(int s) { s = 42; }  int main(void) { int s = 0; foo(s); printf(&quot;%d\\n&quot;, s); return 0; }</code>."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481746886, "post_id": 41151414, "comment_id": 69505137, "body": "@melpomene: I think you put your finger on it. <code>s</code> in <code>main()</code> is never changed."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1481746939, "post_id": 41151414, "comment_id": 69505156, "body": "@user7298655 - Please start reading the manual pages."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1481746976, "post_id": 41151414, "comment_id": 69505173, "body": "@melpomene: I&#39;m pretty sure it&#39;s not undefined behavior to pass an uninitialized variable by value into a function. It&#39;s not like <code>init</code> does anything with the value passed in anyways."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481747126, "post_id": 41151414, "comment_id": 69505228, "body": "@Hurkyl &quot;<i>The behavior is undefined in the following circumstances: [...] - The value of an object with automatic storage duration is used while it is indeterminate (6.2.4, 6.7.8, 6.8).</i>&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1481747798, "post_id": 41151414, "comment_id": 69505584, "body": "There are various errors in your code which result from basic misscinception. Please (re-)read the section about pointers in your favourite C book. Learning C by trial&amp;error, questionalbel online tutorials (including youtube videos) is a really bad idea."}], "answers": [{"comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 4, "creation_date": 1481747148, "post_id": 41151526, "comment_id": 69505236, "body": "<code>malloc(sizeof *s)</code> was fine, and is better style than repeating the type."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1481747249, "post_id": 41151526, "comment_id": 69505287, "body": "@Quentin, Wasn&#39;t sure if you could do that in the same statement in which <code>s</code> was declared. And there&#39;s no repeating of the type since the cast isn&#39;t needed."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1481747275, "post_id": 41151526, "comment_id": 69505304, "body": "@ikegami <code>student *s = ... sizeof (student)</code> contains &quot;student&quot; twice."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481747310, "post_id": 41151526, "comment_id": 69505325, "body": "@melpomene, if you change it to <code>*s</code>, it would contain <code>*s</code> twice, so no better. That particular code duplication is unavoidable."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1481747425, "post_id": 41151526, "comment_id": 69505393, "body": "@ikegami Eh? The point is not to avoid all repetition; the point is to avoid hard-to-diagnose bugs if you ever change the type of the pointer but forget to update the <code>sizeof</code> part. <code>sizeof *s</code> is always correct, no matter how <code>s</code> is declared."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1481747574, "post_id": 41151526, "comment_id": 69505468, "body": "Forgetting to change the variable name in one place just gives you a hard error (&quot;undeclared identifier&quot; or something), not a silently wrong allocation."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1481747587, "post_id": 41151526, "comment_id": 69505476, "body": "Same with changing the type name! Are you saying you have a problem&#39;s with C++&#39;s <code>new Student</code> and Perl&#39;s <code>Student-&gt;new</code>. Nonsense!"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481747625, "post_id": 41151526, "comment_id": 69505503, "body": "I was talking about changing the type of <code>s</code>, not renaming the struct."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1481747711, "post_id": 41151526, "comment_id": 69505543, "body": "What do you mean, change the type of <code>s</code>? You&#39;re allocating a student. If you change the type of <code>s</code>, that would be an error!"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1481748057, "post_id": 41151526, "comment_id": 69505712, "body": "I don&#39;t understand. Consider: <code>typedef struct { ... } teacher; ... teacher *s; ... s = malloc(sizeof(student));</code>. Now you&#39;ve allocated a block of size A but you&#39;re using it as if it were size B. To track this down, you have to check every call to <code>malloc</code> and make sure that <code>sizeof(TYPE)</code> matches the declaration of the pointer you&#39;re assigning to. On the other hand, <code>s = malloc(sizeof *s);</code> is correct and you don&#39;t have to look at any other lines to very this."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1481748114, "post_id": 41151526, "comment_id": 69505747, "body": "<code>s = malloc(sizeof *s);</code> is NOT correct. It would not allocate the right amount. It would allocate <code>sizeof(teacher)</code> instead of <code>sizeof(student)</code> as desired. I know it&#39;s buggy, but the bug is that <code>teacher *s</code> should be <code>student *s</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481748414, "post_id": 41151526, "comment_id": 69505921, "body": "Not necessarily. Maybe the code was refactored, or maybe it was copy/pasted because the code for teachers started out very similar to students. <code>teacher</code> may well be the right type in this particular case. Or think of numeric code: Maybe initially it was <code>float *v; ... v = malloc(n * sizeof (float));</code> but then it was changed to <code>double *v;</code> and nobody noticed the <code>sizeof (float)</code> hidden in there. Bam, a memory corruption bug. <code>n * sizeof *v</code> is both more robust and easier to verify correct."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1481748527, "post_id": 41151526, "comment_id": 69505969, "body": "I&#39;m not talking about some other function. I&#39;m talking about this function whose sole purpose is to initialize a student. If you create a function to initialize a teacher then you&#39;ll need to write code to allocate a teacher. // I&#39;m also not talking about primitive types. This function deals specifically with a semantic type. I would indeed use <code>n * sizeof *v</code> in that case because it wouldn&#39;t be in a function to initialize a float; it would be in a function that initializes something that happens to be float."}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 1, "creation_date": 1481748980, "post_id": 41151526, "comment_id": 69506219, "body": "@ikegami Seriously? You don&#39;t understand why <code>malloc(sizeof thing)</code> is more error resistant and therefore better practice than <code>malloc(sizeof type-of-thing)</code>?"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1481749351, "post_id": 41151526, "comment_id": 69506408, "body": "More error prone, as it might not allocate a student. Why would you risk having it allocate something else?! I don&#39;t know about you, but I use variables needed by the code; I don&#39;t declare arbitrary variables first then hope their the right ones for my code. That sounds like a very brain dead way of doing things to me. Again, the point of this function is to allocate and initialize a student. The next line will be something like <code>s-&gt;gpa = 0;</code>. You can&#39;t just change the type of <code>s</code>!"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1481750151, "post_id": 41151526, "comment_id": 69506801, "body": "Furthermore, if you want your code to also compile as C++, then you&#39;d need <code>(student*)malloc(sizeof(student))</code>, which is way safer than <code>(student*)malloc(sizeof(*s))</code> because the former would look obviously wrong if there was a type mismatch. So I&#39;ll meet you guys in the middle an introduce a compile-time type check by using a cast."}], "tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": -3, "last_activity_date": 1481750347, "last_edit_date": 1481750347, "creation_date": 1481747025, "answer_id": 41151526, "question_id": 41151414, "link": "https://stackoverflow.com/questions/41151414/deallocated-memory-functions-c/41151526#41151526", "title": "Deallocated memory functions C", "body": "<p>You never change the <code>s</code> in <code>main</code>.</p>\n\n<p>Solution 1: Pass a pointer to the variable in <code>main</code> for <code>init</code> to populate.</p>\n\n<pre><code>void init_student(student** s_ptr) {\n    *s_ptr = (student*)malloc(sizeof(student));\n    if (*s_ptr == NULL) {\n        fprintf(stderr \"panic: Allocation Failed\\n\");\n        exit(1);\n    }\n\n    (*s_ptr)-&gt;name = malloc(MAX_NAME_SIZE + 1);\n    if ((*s_ptr)-&gt;name == NULL) {\n        fprintf(stderr \"panic: Allocation Failed\\n\");\n        exit(1);\n    }\n\n    (*s_ptr)-&gt;name[0] = 0;\n\n    (*s_ptr)-&gt;gpa = 0;\n}   \n\nvoid delete_student(student* s) {\n    free(s-&gt;name);\n    free(s);\n}\n\nint main() {\n    student* s;\n    init_student(&amp;s);\n    delete_student(s);\n    return 0;\n}\n</code></pre>\n\n<p>Solution 1b: Same, but a cleaner implementation.</p>\n\n<pre><code>void init_student(student** s_ptr) {\n    student* s = (student*)malloc(sizeof(student));\n    if (*s_ptr == NULL) {\n        fprintf(stderr \"panic: Allocation Failed\\n\");\n        exit(1);\n    }\n\n    s-&gt;name = malloc(MAX_NAME_SIZE + 1);\n    if (s-&gt;name == NULL) {\n        fprintf(stderr \"panic: Allocation Failed\\n\");\n        exit(1);\n    }\n\n    s-&gt;name[0] = 0;\n\n    s-&gt;gpa = 0;\n\n    *s_ptr = s;\n}   \n\nvoid delete_student(student* s) {\n    free(s-&gt;name);\n    free(s);\n}\n\nint main() {\n    student* s;\n    init_student(&amp;s);\n    delete_student(s);\n    return 0;\n}\n</code></pre>\n\n<p>Solution 2: Return the allocated point to <code>main</code>.</p>\n\n<pre><code>student* init_student() {\n    student* s = (student*)malloc(sizeof(student));\n    if (s == NULL) {\n        fprintf(stderr \"panic: Allocation Failed\\n\");\n        exit(1);\n    }\n\n    s-&gt;name = malloc(MAX_NAME_SIZE + 1);\n    if (s-&gt;name == NULL) {\n        fprintf(stderr \"panic: Allocation Failed\\n\");\n        exit(1);\n    }\n\n    s-&gt;name[0] = 0;\n\n    s-&gt;gpa = 0;\n\n    return s;\n}   \n\nvoid delete_student(student* s) {\n    free(s-&gt;name);\n    free(s);\n}\n\nint main() {\n    student* s = init_student();\n    delete_student(s);\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>Note that <code>&amp;s == NULL</code> will never be true because <code>&amp;s</code> is the address of the variable itself. You want just <code>s == NULL</code> to check the value of the pointer in <code>s</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7298655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/005c8400cff98ba7e62a0d6c557c40e9?s=128&d=identicon&r=PG&f=1", "display_name": "user7298655", "link": "https://stackoverflow.com/users/7298655/user7298655"}, "edited": false, "score": 0, "creation_date": 1481748032, "post_id": 41151689, "comment_id": 69505696, "body": "Thanks. It helped me"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1481748423, "last_edit_date": 1481748423, "creation_date": 1481747712, "answer_id": 41151689, "question_id": 41151414, "link": "https://stackoverflow.com/questions/41151414/deallocated-memory-functions-c/41151689#41151689", "title": "Deallocated memory functions C", "body": "<p>First of all the function <code>init</code> has undefined bbehaviour because it returns nothing in the case of successful memory allocation.</p>\n\n<p>You can check whether the memory was allocated or not by returning pointer to the allocated memory or <code>NULL</code>.</p>\n\n<p>Also this statement</p>\n\n<pre><code>if(&amp;s==NULL){\n</code></pre>\n\n<p>is wrong. The condition will always yield false because the address of the local variable <code>s</code> is not equal to <code>NULL</code>.</p>\n\n<p>So the function can be rewritten either the following way</p>\n\n<pre><code>student * init()\n{\n    printf(\"The next stage in the allocation of memory\\n\");\n\n    student *s = ( student* )malloc( sizeof( *s ) );\n\n    if ( s == NULL )\n    {\n        printf(\"Allocation Failed\\n\");\n    } \n    else \n    {\n        printf(\"Allocation completed successfully\\n\");\n    }\n\n    return s;\n} \n</code></pre>\n\n<p>And called like</p>\n\n<pre><code>int main( void )\n          ^^^^^\n{\n    student *s = init();\n    //...\n</code></pre>\n\n<p>Or it can be defined the following way</p>\n\n<pre><code>int init( student **s )\n{\n    printf(\"The next stage in the allocation of memory\\n\");\n\n    *s = ( student* )malloc( sizeof( **s ) );\n\n    int success = *s != NULL;\n\n    if ( !success )\n    {\n        printf(\"Allocation Failed\\n\");\n    } \n    else \n    {\n        printf(\"Allocation completed successfully\\n\");\n    }\n\n    return success;\n} \n</code></pre>\n\n<p>and called like</p>\n\n<pre><code>int main( void )\n          ^^^^^\n{\n    student *s;\n    init( &amp;s );\n    //...\n</code></pre>\n\n<p>The function <code>delete</code> should be defined at least like</p>\n\n<pre><code>void delete(student *s) {\n    if (s != NULL) {\n       ^^^\n        printf(\"begin removal\\n\");\n        free(s);\n        printf(\"Released memory\");\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4572181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AxHxRaZaaew/AAAAAAAAAAI/AAAAAAAAAJw/XsAoiMsW_Js/photo.jpg?sz=128", "display_name": "Hakk\u0131 I.", "link": "https://stackoverflow.com/users/4572181/hakk%c4%b1-i"}, "is_accepted": false, "score": 0, "last_activity_date": 1481794426, "creation_date": 1481794426, "answer_id": 41160748, "question_id": 41151414, "link": "https://stackoverflow.com/questions/41151414/deallocated-memory-functions-c/41160748#41160748", "title": "Deallocated memory functions C", "body": "<p>Firstly, free is NULL safe. If variable is NULL already, basically nothing happens. You do not have to check if it is NULL. (you can check page 313 <a href=\"http://www.open-std.org/JTC1/SC22/wg14/www/docs/n1124.pdf\" rel=\"nofollow noreferrer\">ISO-IEC 9899</a> ) </p>\n\n<p>Also, when you initialize <code>student-&gt;name</code> and allocate, there will be memory leak. You have to free that too. </p>\n\n<p>So, your delete function could be like this ; </p>\n\n<pre><code>  void delete(student *s) {\n    printf(\"begin removal\\n\");\n    free(s-&gt;name);\n    free(s);\n    printf(\"Released memory\");\n}\n</code></pre>\n\n<p>And <code>if (&amp;s == NULL)</code> is wrong. They must be changed with <code>if (s == NULL)</code>.</p>\n\n<p>Your allocation may cause really big troubles in the big codes. If you allocate     <code>s = (student*)malloc(sizeof(*s));</code> it means that \"allocate s with size of *s\". But pointer size is fixed memory block (mostly 8 bytes). It means that you blocks certain size of memory. If you have bigger struct than that, this kind of allocation will corrupt the memory and your executable will be killed by the OS(you can try add some more variables to your struct and initialize them). In small structs and very short runtimes, mostly this allocation works too. But i guarantee that this is not safe for run-time. And it will not give any warnings or errors in compile-time.  True way is <code>s = malloc(sizeof(student))</code>. With this way, you exactly allocates all the memory blocks. And your memory stay safe in run-time. </p>\n\n<p>Lastly, your <code>init</code> function should return the initialized variable. And your init function could be like this ; </p>\n\n<pre><code>#define NAME_LENGHT 128\n\n...\n\nstudent * init(student *s) {\n   printf(\"The next stage in the allocation of memory\\n\");\n   s = malloc(sizeof(student));\n   if (s == NULL) {\n       printf(\"Allocation Failed\\n\");\n       return NULL;\n   }\n\n   s-&gt;name = malloc(NAME_LENGHT); \n   if (s-&gt;name == NULL) {\n       printf(\"Allocation Failed\\n\");\n       return NULL;\n   } else {\n       printf(\"Allocation completed successfully\\n\");\n   }\n   //alternatively you can strdup directly without any allocation\n   // s-&gt;name = strdup(\"some name\");\n   return s; \n}   \n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7298655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/005c8400cff98ba7e62a0d6c557c40e9?s=128&d=identicon&r=PG&f=1", "display_name": "user7298655", "link": "https://stackoverflow.com/users/7298655/user7298655"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 41151689, "answer_count": 3, "score": 1, "last_activity_date": 1481794426, "creation_date": 1481746550, "last_edit_date": 1481748315, "question_id": 41151414, "link": "https://stackoverflow.com/questions/41151414/deallocated-memory-functions-c", "title": "Deallocated memory functions C", "body": "<p>I have problems with memory deallocation in C. Without the division of functions everything is OK, but unfortunately it does not work on the same functions. Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\ntypedef struct {\n    char *name;\n    enum {\n        summer,\n        winter\n    } index;\n} student;\n\nbool init(student *s) {\n    printf(\"The next stage in the allocation of memory\\n\");\n    s = (student*)malloc(sizeof(*s));\n    if (&amp;s == NULL) {\n        printf(\"Allocation Failed\\n\");\n        return 0;\n    } else {\n        printf(\"Allocation completed successfully\\n\");\n    }\n}   \n\nvoid delete(student *s) {\n    if (&amp;s != NULL) {\n        printf(\"begin removal\\n\");\n        free(s);\n        printf(\"Released memory\");\n    }\n}\n\nint main() {\n    student *s;\n    init(s);\n    delete(s);\n\n    return 0;\n}\n</code></pre>\n\n<p>I do not know what I'm doing wrong. Please help.</p>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481746392, "post_id": 41151295, "comment_id": 69504879, "body": "What are <code>Soglia</code> and <code>ArrSoglia</code>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481746448, "post_id": 41151295, "comment_id": 69504909, "body": "What is <code>TipoL</code> (its definition)? Why have you not used <code>TRESHOLD</code> after inputting a value?"}, {"owner": {"reputation": 21, "user_id": 7184982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b340c51e5de00431c92214572392c5?s=128&d=identicon&r=PG&f=1", "display_name": "Ruggero Latella", "link": "https://stackoverflow.com/users/7184982/ruggero-latella"}, "edited": false, "score": 0, "creation_date": 1481746586, "post_id": 41151295, "comment_id": 69504985, "body": "Oh sorry i forgot to replace every italian declaration with english, now its perfected. TipoL is the globally-declared name of the struct used."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1481746707, "post_id": 41151295, "comment_id": 69505050, "body": "It will be perfect when you show the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>, which means verifiable by <i>you too</i>. Now nobody knows whether you have posted the truth after making grand changes to the posted code."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1481746787, "post_id": 41151295, "comment_id": 69505086, "body": "Undefined behavior for using the value of an object with automatic storage duration while it is uninitialized."}, {"owner": {"reputation": 21, "user_id": 7184982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b340c51e5de00431c92214572392c5?s=128&d=identicon&r=PG&f=1", "display_name": "Ruggero Latella", "link": "https://stackoverflow.com/users/7184982/ruggero-latella"}, "edited": false, "score": 0, "creation_date": 1481747096, "post_id": 41151295, "comment_id": 69505212, "body": "I can&#39;t pass the Whole code since it&#39;s about 150 lines of code but im 100% sure the problem is here because every part of the other functions works perfectly. I just can&#39;t understand what i&#39;m doing wrong..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481747811, "post_id": 41151295, "comment_id": 69505591, "body": "Is this as simple as adding a space <code>scanf(&quot;%c&quot;, &amp;TRESHOLD);</code> --&gt; <code>scanf(&quot; %c&quot;, &amp;TRESHOLD);</code>?"}, {"owner": {"reputation": 21, "user_id": 7184982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b340c51e5de00431c92214572392c5?s=128&d=identicon&r=PG&f=1", "display_name": "Ruggero Latella", "link": "https://stackoverflow.com/users/7184982/ruggero-latella"}, "edited": false, "score": 0, "creation_date": 1481750156, "post_id": 41151295, "comment_id": 69506803, "body": "Nope that wasnt the problem, its been solved by the two guys under this post. Thank you anyway for your time!"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7184982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b340c51e5de00431c92214572392c5?s=128&d=identicon&r=PG&f=1", "display_name": "Ruggero Latella", "link": "https://stackoverflow.com/users/7184982/ruggero-latella"}, "edited": false, "score": 0, "creation_date": 1481747400, "post_id": 41151498, "comment_id": 69505376, "body": "I see! Thank you very much now it works and i understood what i was doing wrong . very much appreciated!!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 21, "user_id": 7184982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b340c51e5de00431c92214572392c5?s=128&d=identicon&r=PG&f=1", "display_name": "Ruggero Latella", "link": "https://stackoverflow.com/users/7184982/ruggero-latella"}, "edited": false, "score": 0, "creation_date": 1481747583, "post_id": 41151498, "comment_id": 69505472, "body": "@RuggeroLatella You are welcome, and I appreciated the fact that your main goal was to understand what&#39;s wrong and to continue with your own work. :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1481746883, "creation_date": 1481746883, "answer_id": 41151498, "question_id": 41151295, "link": "https://stackoverflow.com/questions/41151295/extract-lower-number-over-a-fixated-threshold/41151498#41151498", "title": "Extract lower number over a fixated threshold?", "body": "<p>The problem is that when you do the following:</p>\n\n<pre><code>if(lista.seqchar[i]&gt;THRESHOLD)\n{\n    ArrTHRESHOLD[i]=lista.seqchar[i];\n}\n</code></pre>\n\n<p>you are missing the <code>else</code> case, so you leave <code>ArrTHRESHOLD[i]</code> un-initialized. You should instead set it to some <code>maximum value</code> in order to avoid it being selected in the next phase:</p>\n\n<pre><code>else\n{\n    ArrTHRESHOLD[i]= 127; // or MAX_CHAR;\n}\n</code></pre>\n\n<p>Sure, there is better than this method but since you asked help to make your method work, I hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7184982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b340c51e5de00431c92214572392c5?s=128&d=identicon&r=PG&f=1", "display_name": "Ruggero Latella", "link": "https://stackoverflow.com/users/7184982/ruggero-latella"}, "edited": false, "score": 0, "creation_date": 1481747439, "post_id": 41151522, "comment_id": 69505396, "body": "thank you verymuch for your help too! now i got a better and cleaner idea on how to do it. ill try your method too!"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1485262284, "last_edit_date": 1485262284, "creation_date": 1481747014, "answer_id": 41151522, "question_id": 41151295, "link": "https://stackoverflow.com/questions/41151295/extract-lower-number-over-a-fixated-threshold/41151522#41151522", "title": "Extract lower number over a fixated threshold?", "body": "<blockquote>\n  <p>I would like to know why this doesnt work rather than having another way to do this</p>\n</blockquote>\n\n<p><code>ArrTHRESHOLD</code> has automatic duration and no initializer, so all its elements are initially indeterminate.  You scan the input array, and copy those elements exceeding the threshold to <em>the corresponding element</em> of <code>ArrTHRESHOLD</code>, leaving the other elements indeterminate.<br>\nYou then scan <code>ArrTHRESHOLD</code>, including the indeterminate elements, to attempt to identify the minimum.<br>\nUsing indeterminate values produces undefined behavior.</p>\n\n<p>You could consider keeping a separate count of the number of elements so far copied into <code>ArrTHRESHOLD</code>, and using that to fill an initial subset of the elements, without gaps.  Afterward, you could scan just those elements as you now do.</p>\n\n<p>Better, however, would be to do without <code>ArrTHRESHOLD</code> altogether: you don't need it, as you can do everything necessary in your pass through <code>lista.seqchar</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 7184982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b340c51e5de00431c92214572392c5?s=128&d=identicon&r=PG&f=1", "display_name": "Ruggero Latella", "link": "https://stackoverflow.com/users/7184982/ruggero-latella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1485265357, "creation_date": 1481746045, "last_edit_date": 1485265357, "question_id": 41151295, "link": "https://stackoverflow.com/questions/41151295/extract-lower-number-over-a-fixated-threshold", "title": "Extract lower number over a fixated threshold?", "body": "<p>I ask for your help because I'm going crazy. </p>\n\n<p>I have this procedure that takes from my main a struct called lista(of a typedefined TipoL) that is composed by an int (N, numbers of chars inserted) and an array of lowercase chars(seqchar). I need the procedure to printf the lowest number over an user-inserted threshold.\nI would like to know why this doesn't work rather than having another way to do this because now I feel like I'm doing something wrong since the last printf gives this output, assuming an example of d being the threshold: The smallest character over the threshold ('d') (ASCII '100') is 'nothing here' (ASCII '0') and I don't know why. </p>\n\n<p>Thank you very much for your help in advance!</p>\n\n<pre><code>void Minimum(TipoL lista)\n{\nint i,j;\nchar k,s,THRESHOLD,ArrTHRESHOLD[lista.N];\n\n\n    scanf(\"%c\", &amp;THRESHOLD);\n\n    for(i=0; i&lt;lista.N; i++)\n    {\n        if(lista.seqchar[i]&gt;THRESHOLD)\n        {\n        ArrTHRESHOLD[i]=lista.seqchar[i];\n        }\n    }\n\n    s=ArrTHRESHOLD[0];\n    for(j=1; j&lt;lista.N; j++)\n    {\n        if(ArrTHRESHOLD[j]&lt;s)\n        {\n        s=ArrTHRESHOLD[j];\n        }\n    }\nprintf(\"\\nThe smallest character over the threshold '%c' (ASCII '%d') is: '%c'\\n(ASCII '%d')\\n\", THRESHOLD, THRESHOLD, s, s);\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "memory", "memory-management", "realloc"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1481745665, "post_id": 41151149, "comment_id": 69504505, "body": "&quot;What causes <code>realloc</code> to act like this?&quot; Um... But that&#39;s exactly what <code>realloc</code> does! That&#39;s what <code>realloc</code> is for. In general case it allocates a <i>new</i> memory block at <i>new</i> memory location. How else did you expect it to behave?"}, {"owner": {"reputation": 115, "user_id": 2175857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b5086866374fae5f3eebeb97a1aac?s=128&d=identicon&r=PG&f=1", "display_name": "razorx", "link": "https://stackoverflow.com/users/2175857/razorx"}, "edited": false, "score": 0, "creation_date": 1481745685, "post_id": 41151149, "comment_id": 69504519, "body": "I am using C. Not C++."}, {"owner": {"reputation": 115, "user_id": 2175857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b5086866374fae5f3eebeb97a1aac?s=128&d=identicon&r=PG&f=1", "display_name": "razorx", "link": "https://stackoverflow.com/users/2175857/razorx"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1481745735, "post_id": 41151149, "comment_id": 69504551, "body": "@AnT but it doesn&#39;t change lines[0] but changes line, they are the same thing."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1481745737, "post_id": 41151149, "comment_id": 69504553, "body": "@razorx Don&#39;t tag C++ then."}, {"owner": {"reputation": 115, "user_id": 2175857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b5086866374fae5f3eebeb97a1aac?s=128&d=identicon&r=PG&f=1", "display_name": "razorx", "link": "https://stackoverflow.com/users/2175857/razorx"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1481745795, "post_id": 41151149, "comment_id": 69504584, "body": "@BaummitAugen same problem can apply to C++ as well."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 2, "creation_date": 1481745808, "post_id": 41151149, "comment_id": 69504587, "body": "@razorx: That has nothing to do with <code>realloc</code>. And no <code>line</code> and <code>line[0]</code> are not &quot;the same thing&quot;. These are two completely unrelated, independent pointers that just happened to point to the same spot in memory. Then you decided to change one of them, while not changing the other. So, they became different. If you want to update <code>lines[0]</code> as well - it is your responsibility."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1481745838, "post_id": 41151149, "comment_id": 69504608, "body": "C11 draft standard n1570: <i>6.5.2.2 Function calls 4 An argument may be an expression of any complete object type. In preparing for the call to a function, the arguments are evaluated, and each parameter is assigned the value of the corresponding argument. 93) A function may change the values of its parameters, but these changes cannot affect the values of the arguments.[...]</i>"}, {"owner": {"reputation": 115, "user_id": 2175857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b5086866374fae5f3eebeb97a1aac?s=128&d=identicon&r=PG&f=1", "display_name": "razorx", "link": "https://stackoverflow.com/users/2175857/razorx"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1481746032, "post_id": 41151149, "comment_id": 69504706, "body": "@AnT that may be it, thanks for the answer."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1481746337, "post_id": 41151149, "comment_id": 69504851, "body": "@razorx: <a href=\"http://stackoverflow.com/questions/373419/whats-the-difference-between-passing-by-reference-vs-passing-by-value\" title=\"whats the difference between passing by reference vs passing by value\">stackoverflow.com/questions/373419/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1227, "user_id": 1974414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1fdd96f9d84a095fa844866e6bc2680?s=128&d=identicon&r=PG", "display_name": "Dima Ogurtsov", "link": "https://stackoverflow.com/users/1974414/dima-ogurtsov"}, "is_accepted": true, "score": 3, "last_activity_date": 1481746105, "creation_date": 1481746105, "answer_id": 41151307, "question_id": 41151149, "link": "https://stackoverflow.com/questions/41151149/why-does-realloc-create-two-different-pointers/41151307#41151307", "title": "Why does realloc create two different pointers?", "body": "<p>You are wrong here:</p>\n\n<blockquote>\n  <p>Here <code>line</code> and <code>lines[0]</code> are both in memory location 0x6465e0.</p>\n</blockquote>\n\n<p>Both variables have <strong>value</strong> <code>0x6465e0</code>, but they are in different locations.\nWhen you call <code>realloc</code> with <code>line</code>, runtime deallocates memory that <code>line</code> pointed to (which is <code>0x6465e0</code>), allocates new memory and puts its address in <code>line</code> - that is <code>0x648200</code>. <strong>Value</strong> of <code>lines[0]</code> is not influenced by this operation, but the memory where it is pointing has been freed already.\nBottom line - if you reallocate you need to update <strong>all</strong> pointers that pointed to the old location with the new location</p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 115, "user_id": 2175857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b5086866374fae5f3eebeb97a1aac?s=128&d=identicon&r=PG&f=1", "display_name": "razorx", "link": "https://stackoverflow.com/users/2175857/razorx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 41151307, "answer_count": 1, "score": -2, "last_activity_date": 1481746105, "creation_date": 1481745472, "last_edit_date": 1481745722, "question_id": 41151149, "link": "https://stackoverflow.com/questions/41151149/why-does-realloc-create-two-different-pointers", "title": "Why does realloc create two different pointers?", "body": "<p>I have a pointer array named **lines, each line being 100 character long.</p>\n\n<p>And have a function which adds characters to any given line and reallocates the line if it's not big enough:</p>\n\n<pre><code>void add_letter(char *line, int pos, char letter) {\n    if(strlen(line) % 100 == 0){\n        line = realloc(line, sizeof(char) * strlen(line) + 100);\n    }\n    ...\n</code></pre>\n\n<p><code>add_letter</code> is called like this:</p>\n\n<pre><code>add_letter(lines[0], pos, ch);\n</code></pre>\n\n<p>line here is equal to <code>lines[0]</code>, and in the  second line, gdb returns <code>1</code> for <code>p line == lines[0]</code>.\nHere <code>line</code> and <code>lines[0]</code> are both in memory location <code>0x6465e0</code>.</p>\n\n<p>But after the <code>realloc</code> call, <code>line</code> becomes <code>0x648200</code>, but <code>lines[0]</code> stays in the same and becomes an <code>\"\"</code> empty string.</p>\n\n<p>What causes <code>realloc</code> to act like this? Because of this reason, <code>strcat(line, newline)</code>, <code>newline</code> being the end result of addition doesn't work at the end of the function.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "answers": [{"comments": [{"owner": {"reputation": 1094, "user_id": 5259805, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/448bac0393b643e9a7e2f36cb3995ed0?s=128&d=identicon&r=PG&f=1", "display_name": "zale", "link": "https://stackoverflow.com/users/5259805/zale"}, "edited": false, "score": 0, "creation_date": 1481745553, "post_id": 41151083, "comment_id": 69504449, "body": "I should have been clearer -- I&#39;d like assignments to <code>level_map</code> elements to assign to the corresponding <code>map</code> element, so copying doesn&#39;t work for me"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481745794, "post_id": 41151083, "comment_id": 69504583, "body": "&quot;<i><code>level_map</code> is const pointer</i>&quot;, sry, but no, <code>levelmap</code> is an array."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481745863, "post_id": 41151083, "comment_id": 69504616, "body": "&quot;<i><code>(*)level_map</code></i>&quot; you mean <code>(*level_map)</code>, don&#39;t you?"}, {"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481745908, "post_id": 41151083, "comment_id": 69504643, "body": "@alk hehe exactly!"}], "tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": false, "score": 2, "last_activity_date": 1481745893, "last_edit_date": 1481745893, "creation_date": 1481745249, "answer_id": 41151083, "question_id": 41150966, "link": "https://stackoverflow.com/questions/41150966/c-select-2d-slice-from-3d-array/41151083#41151083", "title": "C - select 2D slice from 3D array", "body": "<pre><code>TileType level_map[LEVEL_HEIGHT][LEVEL_WIDTH] = &amp;(maps[dlvl]);\n</code></pre>\n\n<p>You can't do that because <code>level_map</code> is array, and array cannot be reassigned.</p>\n\n<p>What you need is <code>memcpy</code>. Given what you need to assign to <code>level_map</code> is the first element of 3D <code>maps</code> (at index 0): </p>\n\n<pre><code>memcpy(level_map, &amp;maps[0], sizeof(level_map));\n</code></pre>\n\n<p>You can do the same for other elements.</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<blockquote>\n  <p>I should have been clearer -- I'd like assignments to level_map elements to assign to the corresponding map element</p>\n</blockquote>\n\n<p>Ok then you need to declare a pointer instead of array:</p>\n\n<pre><code>TileType (*level_map)[LEVEL_HEIGHT][LEVEL_WIDTH];  // pointer to 2D array\nlevel_map = &amp;maps[0]; // reassign pointer to the address of `maps` first element\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 1094, "user_id": 5259805, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/448bac0393b643e9a7e2f36cb3995ed0?s=128&d=identicon&r=PG&f=1", "display_name": "zale", "link": "https://stackoverflow.com/users/5259805/zale"}, "edited": false, "score": 0, "creation_date": 1481747673, "post_id": 41151090, "comment_id": 69505532, "body": "Please see correction (<code>TileType * pplevel_map = ...</code>) and update."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 1094, "user_id": 5259805, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/448bac0393b643e9a7e2f36cb3995ed0?s=128&d=identicon&r=PG&f=1", "display_name": "zale", "link": "https://stackoverflow.com/users/5259805/zale"}, "edited": false, "score": 0, "creation_date": 1481747843, "post_id": 41151090, "comment_id": 69505602, "body": "Sry, now it should be fine ... :}"}, {"owner": {"reputation": 1094, "user_id": 5259805, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/448bac0393b643e9a7e2f36cb3995ed0?s=128&d=identicon&r=PG&f=1", "display_name": "zale", "link": "https://stackoverflow.com/users/5259805/zale"}, "edited": false, "score": 0, "creation_date": 1481748145, "post_id": 41151090, "comment_id": 69505757, "body": "No problem, I appreciate it! That works well, but now I can&#39;t easily do arbitrary (x, y) accesses right? I&#39;m essentially selecting a 1D slice instead of 2D?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 1094, "user_id": 5259805, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/448bac0393b643e9a7e2f36cb3995ed0?s=128&d=identicon&r=PG&f=1", "display_name": "zale", "link": "https://stackoverflow.com/users/5259805/zale"}, "edited": false, "score": 1, "creation_date": 1481750110, "post_id": 41151090, "comment_id": 69506779, "body": "Finally ... :-)"}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 2, "last_activity_date": 1481781735, "last_edit_date": 1481781735, "creation_date": 1481745265, "answer_id": 41151090, "question_id": 41150966, "link": "https://stackoverflow.com/questions/41150966/c-select-2d-slice-from-3d-array/41151090#41151090", "title": "C - select 2D slice from 3D array", "body": "<blockquote>\n<pre><code>   TileType level_map[LEVEL_HEIGHT][LEVEL_WIDTH] = &amp;(maps[dlvl]);\n</code></pre>\n</blockquote>\n\n<p><code>&amp;(maps[dlvl])</code> evaluates to an address, namely the address of the <code>dlvl</code>th element of <code>maps</code>.</p>\n\n<p>You cannot use an address to initialise an array, which <code>level_map</code> is.</p>\n\n<p>You <em>could</em> do </p>\n\n<pre><code>TileType (*plevel_map)[LEVEL_HEIGHT][LEVEL_WIDTH] = maps[dlvl];\n</code></pre>\n\n<p>The above statement defines and initialises <code>plevel_map</code> to <em>point</em> to the <code>dlvl</code>th element of <code>maps</code>.</p>\n\n<p>You would then access the elements of <code>dlvl</code>th element of <code>maps</code> like this</p>\n\n<pre><code>(*plevel_map)[x][y]\n</code></pre>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>What you also <em>could</em> do is</p>\n\n<pre><code>TileType * pplevel_map = maps[dlvl][0];\n</code></pre>\n\n<p>And then access <code>map[dlvl][0]</code>'s element like this:</p>\n\n<pre><code>pplevel_map[x]\n</code></pre>\n\n<p>and then do </p>\n\n<pre><code>pplevel_map += sizeof(**maps);\n</code></pre>\n\n<p>to seek to <code>maps[dlvl][1]</code>.</p>\n\n<p>And then access <code>map[dlvl][1]</code>'s element (also) like this:</p>\n\n<pre><code>pplevel_map[x]\n</code></pre>\n\n<hr>\n\n<p><strong>Update^2</strong> </p>\n\n<p>To still  be able access all \"level\"'s elements using <code>[x][y]</code> you could do:</p>\n\n<pre><code>TileType (*aplevel_map)[LEVEL_WIDTH] = maps[dlvl];\n</code></pre>\n\n<p>And then access <code>map[dlvl]</code>'s element like this:</p>\n\n<pre><code>aplevel_map[x][y]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1094, "user_id": 5259805, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/448bac0393b643e9a7e2f36cb3995ed0?s=128&d=identicon&r=PG&f=1", "display_name": "zale", "link": "https://stackoverflow.com/users/5259805/zale"}, "edited": false, "score": 0, "creation_date": 1481748752, "post_id": 41151798, "comment_id": 69506095, "body": "Honest question, what&#39;s the reason for using this instead of keeping the original definition of <code>maps</code> and using <code>maps[levelid][x][y]</code>? I&#39;m mostly trying to make this expression less cumbersome, and your answer seems to make things worse in that matter. (Don&#39;t get me wrong I appreciate the answer, I just don&#39;t really understand it)"}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "reply_to_user": {"reputation": 1094, "user_id": 5259805, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/448bac0393b643e9a7e2f36cb3995ed0?s=128&d=identicon&r=PG&f=1", "display_name": "zale", "link": "https://stackoverflow.com/users/5259805/zale"}, "edited": false, "score": 0, "creation_date": 1481749125, "post_id": 41151798, "comment_id": 69506302, "body": "To get into the habit of thinking of the world as tiles laid out in some arrangement in memory, rather than as constructs in some programming language.."}], "tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 0, "last_activity_date": 1481748176, "creation_date": 1481748176, "answer_id": 41151798, "question_id": 41150966, "link": "https://stackoverflow.com/questions/41150966/c-select-2d-slice-from-3d-array/41151798#41151798", "title": "C - select 2D slice from 3D array", "body": "<p>Do yourself a favour</p>\n\n<pre><code> TileType maps[DLVL_MAX * LEVEL_HEIGHT* LEVEL_WIDTH];\n</code></pre>\n\n<p>Now always pass maps, and levelid (guess that's what you mean), y\nco-ordinate, and x co-ordinate.</p>\n\n<pre><code>  void foo(TileType *maps, int levelid, int x, int y)\n  {\n      TileType tile = BLANK;\n\n      map[levelid * LEVEL_HEIGHT * LEVEL_WIDTH + y * LEVEL_WIDTH + x]\n        = tile;\n  }\n</code></pre>\n\n<p>Then the problems just disappear.\nThe expression is a bit cumbersome, but you soon learn to live with it.</p>\n"}], "owner": {"reputation": 1094, "user_id": 5259805, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/448bac0393b643e9a7e2f36cb3995ed0?s=128&d=identicon&r=PG&f=1", "display_name": "zale", "link": "https://stackoverflow.com/users/5259805/zale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 41151090, "answer_count": 3, "score": 0, "last_activity_date": 1481781735, "creation_date": 1481744852, "last_edit_date": 1481752738, "question_id": 41150966, "link": "https://stackoverflow.com/questions/41150966/c-select-2d-slice-from-3d-array", "title": "C - select 2D slice from 3D array", "body": "<p>I have a global 3D array declared like this:</p>\n\n<pre><code>TileType maps[DLVL_MAX][LEVEL_HEIGHT][LEVEL_WIDTH];\n</code></pre>\n\n<p>and a function in which I'd like to name one 2D slice of this array to make things less cumbersome, i.e. something like</p>\n\n<pre><code>void f(int dlvl) {\n    TileType level_map[LEVEL_HEIGHT][LEVEL_WIDTH] = &amp;(maps[dlvl]);\n    ...\n}\n</code></pre>\n\n<p>At first sight this looks to me like it should be possible, since C array dimensions are ordered left to right. Yet I can't find the right expression for this. (Of course, I can just give <code>level_map</code> a <code>TileType*</code> type, but then I can't use double indexing as in <code>level_map[x][y]</code>.)</p>\n\n<p>Is it possible at all?</p>\n"}, {"tags": ["c", "while-loop", "whitespace"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1481744805, "post_id": 41150916, "comment_id": 69503985, "body": "Trace it in a debugger"}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1481744864, "post_id": 41150916, "comment_id": 69504020, "body": "@KevinDTimm There&#39;s not a segmentation fault."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1481744912, "post_id": 41150916, "comment_id": 69504052, "body": "A debugger can be used to step through the code and see if it is doing what you expect, examine variables, etc."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1481744946, "post_id": 41150916, "comment_id": 69504071, "body": "Is <code>c</code> of type <code>int</code>?"}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481744965, "post_id": 41150916, "comment_id": 69504083, "body": "<code>c</code> is of type <code>char</code>."}, {"owner": {"reputation": 481, "user_id": 5916150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c209005186a84dd1820b220d7b78527e?s=128&d=identicon&r=PG&f=1", "display_name": "Arif Burhan", "link": "https://stackoverflow.com/users/5916150/arif-burhan"}, "edited": false, "score": 2, "creation_date": 1481745017, "post_id": 41150916, "comment_id": 69504114, "body": "It seems <b>print_spaces()</b> is incorrect, but we cannot see the soucre code."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1481745174, "post_id": 41150916, "comment_id": 69504219, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1481745212, "post_id": 41150916, "comment_id": 69504237, "body": "@kaylum I have a MCVE. I didn&#39;t include my entire code, only the offending portion. And I included everything necessary."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 2, "creation_date": 1481745215, "post_id": 41150916, "comment_id": 69504238, "body": "You answered &quot;there&#39;s not a bug&quot; to which you get responses.  You edit your answer to say &quot;there&#39;s not a seg fault&quot;.  To which I respond, &quot;So what? Debuggers are used for debugging ALL faults&quot;."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1481745298, "post_id": 41150916, "comment_id": 69504304, "body": "C stands for <i>complete</i>. Complete means code that we can copy as is and run for ourselves. By definition you don&#39;t know where the problem is. So you could be leaving out the very thing that is the root cause of the problem. The only sure way to avoid that is a MCVE."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481745302, "post_id": 41150916, "comment_id": 69504308, "body": "Hmm... the MCVE and the source file, could be one and the same ;)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481745371, "post_id": 41150916, "comment_id": 69504349, "body": "<a href=\"http://stackoverflow.com/q/41136213/2173917\">This answer</a> might be of interest, if not a duplicate."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481745476, "post_id": 41150916, "comment_id": 69504405, "body": "@SouravGhosh Nope, tried changing <code>char</code> to <code>int</code> and it didn&#39;t fix anything."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1481745585, "post_id": 41150916, "comment_id": 69504466, "body": "So it was a <code>char</code> and not an <code>int</code>. What if that turned out to be the problem? By not showing it you are not providing the full picture and wasting time going back and forth with people asking for more info. Hence an MCVE."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1481745599, "post_id": 41150916, "comment_id": 69504473, "body": "Please edit the question to also include the declarations of <code>c</code> and <code>f</code>, and the code that opens <code>f</code>.  Also, are you running this using shell redirection, and if so, which shell?  Which OS?  On Windows you may get the <code>\\r</code> characters as well as the <code>\\n</code>s.  <b>Also</b> what file viewer are you using to look at the output?  Does your input file or your output have any real tab characters in it?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481745885, "post_id": 41150916, "comment_id": 69504631, "body": "@Redesign says &quot;I have a MCVE&quot; but we do not, hence all this is just guesswork. You do not seem to be looking for or printing &quot;whitespace&quot;, only &quot;space&quot;."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1481746129, "post_id": 41150916, "comment_id": 69504751, "body": "Oh FFS put the MCVE <b><i>in the question</i></b>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481761096, "post_id": 41150916, "comment_id": 69510743, "body": "What about text that has <code>&#39;{&#39;</code> or <code>&quot;{&quot;</code> in it?  Will that mess up the <code>space</code> count as those are not <i>open brackets</i>, but characters constants or string literals?"}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481825779, "post_id": 41150916, "comment_id": 69541825, "body": "I&#39;m still working on it, I&#39;ll add that stuff later."}], "answers": [{"comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 2, "creation_date": 1481745652, "post_id": 41151187, "comment_id": 69504494, "body": "I thought that was intentional, to swallow any whitespace in the file and replace it with that provided by <code>print_spaces</code>.  I agree the style is suboptimal :) ."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481745931, "post_id": 41151187, "comment_id": 69504656, "body": "Nope, that was intentional."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481746470, "post_id": 41151187, "comment_id": 69504916, "body": "@Redesign: OK, I was off base in both the diagnostics and the remedy... I updated the answer for the actual problem(s)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481760746, "post_id": 41151187, "comment_id": 69510635, "body": "Interesting <code>} else  (newline) if (</code> style - new to me."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481822800, "post_id": 41151187, "comment_id": 69540241, "body": "I updated the code to <a href=\"https://gist.github.com/gimmetehcodez/21977a5bf05c60c08e60f1ec3148cf9c\" rel=\"nofollow noreferrer\">this</a> and now I get <a href=\"https://gist.github.com/gimmetehcodez/f88cc3fe72d139da117cf779539f18a5\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481822872, "post_id": 41151187, "comment_id": 69540284, "body": "Actually, that was all I needed. Thanx for the help."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 1, "creation_date": 1481925455, "post_id": 41151187, "comment_id": 69585720, "body": "@R\u0367e\u0364\u0364\u0367\u030a\u0357de\u030c\u0352\u0357\u0307\u0310\u0352s\u0306\u034a\u0343\u034b\u034ci\u0342\u0368g\u031a\u0308\u030fn: to remove the spaces before the <code>}</code>, you must refine the algorithm and only print the indentation after checking the character but before printing it."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481925803, "post_id": 41151187, "comment_id": 69585837, "body": "@chqrlie I know. Working on it."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1481747130, "last_edit_date": 1481747130, "creation_date": 1481745613, "answer_id": 41151187, "question_id": 41150916, "link": "https://stackoverflow.com/questions/41150916/whitespace-not-printing-properly/41151187#41151187", "title": "Whitespace not printing properly", "body": "<p>There is an extra <code>;</code> at the end of the <code>while</code> condition, it is probably intentional, but very misleading: it looks like a bug.  You should add a <code>continue</code> statement or an empty block <code>{}</code> to emphasize the empty statement as intentional:</p>\n\n<pre><code>    while ((c = getc(f)) == ' ')\n        continue;\n</code></pre>\n\n<p>There are some problems in your approach:</p>\n\n<ul>\n<li>you should unget the last byte if it is not <code>EOF</code> so it can be tested in the main loop. This the cause of your problem: <code>{</code> is just copied after the <code>\\n</code> and <code>spaces</code> is not incremented.</li>\n<li>You should also skip tab characters and handle newlines specially, otherwise a blank line will prevent proper indentation of the next line.</li>\n<li>Lines that are not <code>;</code> terminated should cause the continuations to be indented, potentially by a specific amount different than 4.</li>\n</ul>\n\n<p>Here an improved code fragment that only addresses the first 2 issues:</p>\n\n<pre><code>while ((c = getc(f)) != EOF) {\n    putchar(c);\n    if (c == '{') {\n        spaces += 4;\n    } else\n    if (c == '}') {\n        if (spaces &gt;= 4) {\n            spaces -= 4;\n        }\n    } else\n    if (c == '\\n') {\n        /* consume all white space except newlines */\n        while (isspace(c = getc(f))) {\n            if (c == '\\n')\n               putchar(c);\n        }\n        if (c != EOF) {\n            ungetc(c, f);\n            /* print the indentation if further code is present */\n            print_spaces(spaces);\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481754260, "post_id": 41151325, "comment_id": 69508539, "body": "This stalls after the first <code>{\\n</code>."}], "tags": [], "owner": {"reputation": 873, "user_id": 2005801, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/0LXeP.jpg?s=128&g=1", "display_name": "aoak", "link": "https://stackoverflow.com/users/2005801/aoak"}, "is_accepted": false, "score": 4, "last_activity_date": 1481749352, "last_edit_date": 1481749352, "creation_date": 1481746175, "answer_id": 41151325, "question_id": 41150916, "link": "https://stackoverflow.com/questions/41150916/whitespace-not-printing-properly/41151325#41151325", "title": "Whitespace not printing properly", "body": "<p>This is because the character <code>{</code> is being read through your <code>while ((c = getc(f)) == ' ');</code> line in the newline character block. That is why the condition <code>c == '{'</code> is never reached and spaces counter never incremented.</p>\n\n<p>As far as I see, there are two things here:</p>\n\n<ol>\n<li>The indentation depends on two character sequence <code>\\n{</code> to indent and <code>\\n}</code> to de-indent. You need some way to convey what the previous or next character is (<code>newline</code> variable below).</li>\n<li><code>}</code> and <code>{</code> have slightly difference paradigm i.e. print and increment vs decrement and print (kinda like <code>i++</code> vs <code>++i</code></li>\n</ol>\n\n<p>The code below tries to capture these two points by </p>\n\n<ol>\n<li>changing the sequence of space counter adjustment and print </li>\n<li>using a variable to convey what the previous character was</li>\n</ol>\n\n<p>That being said, it is very rudimentary, doesn't handle corner cases or coding style and most likely there is more elegant way to do it.</p>\n\n<p>`</p>\n\n<pre><code> 10     int newline = 0;\n 11     while ((c = getc(f)) != EOF) {\n 12         if (c == '}') {\n 13             spaces -= 4;\n 14         }\n 15         if (newline == 1) {\n 16             print_spaces(spaces);\n 17             newline = 0;\n 18         }\n 19         putchar(c);\n 20         if (c == '{') {\n 21             spaces += 4;\n 22         } else if (c == '\\n') {\n 23             newline = 1;\n 24             while ((c = getc(f)) == ' ');\n 25             ungetc(c, f);\n 26         }\n 27     }\n</code></pre>\n\n<p>`</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1481747005, "post_id": 41151433, "comment_id": 69505180, "body": "interesting alternate approach, but it has the same problem as a <code>{</code> that follows a <code>\\n</code> is not handled correctly. Even with this problem fixed, the program cannot indent itself properly as <code>case</code> and <code>default</code> clauses will have the same indentation as the code inside the switch` block."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1481747307, "post_id": 41151433, "comment_id": 69505320, "body": "your code raises an extra question: should initial spaces be skipped or copied?"}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1481754310, "post_id": 41151433, "comment_id": 69508562, "body": "@chqrlie Initial spaces should be skipped."}, {"owner": {"reputation": 399, "user_id": 7043446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73635f40fd88750ae2c66090819b277b?s=128&d=identicon&r=PG&f=1", "display_name": "cpatricio", "link": "https://stackoverflow.com/users/7043446/cpatricio"}, "edited": false, "score": 0, "creation_date": 1481754592, "post_id": 41151433, "comment_id": 69508657, "body": "Starting the flag as 1 will skip the initial spaces, as long as <code>spaces</code> start as 0."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481783644, "post_id": 41151433, "comment_id": 69516929, "body": "@Redesign: other similar questions: should trailing spaces be removed at the end of a line? should tabs be expanded inside lines? should extra spaces be removed inside lines?"}], "tags": [], "owner": {"reputation": 399, "user_id": 7043446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73635f40fd88750ae2c66090819b277b?s=128&d=identicon&r=PG&f=1", "display_name": "cpatricio", "link": "https://stackoverflow.com/users/7043446/cpatricio"}, "is_accepted": false, "score": 0, "last_activity_date": 1481754526, "last_edit_date": 1481754526, "creation_date": 1481746636, "answer_id": 41151433, "question_id": 41150916, "link": "https://stackoverflow.com/questions/41150916/whitespace-not-printing-properly/41151433#41151433", "title": "Whitespace not printing properly", "body": "<p>Your code it's a bit confusing.</p>\n\n<pre><code>int printspaces = 1; // initial spaces are ignored.\nwhile ((c = getc(f)) != EOF) {\n    if(printspaces == 1)\n    {\n        print_spaces(spaces);\n        printspaces = 0;\n        if(c == ' ')\n            while((c = getc(f)) == ' ');\n    }\n    putchar(c);\n    switch(c)\n    {\n        case '{':\n            spaces += 4;\n            break;\n        case '}':\n            if(spaces &gt;= 4)\n                spaces -= 4;\n                break;\n        case '\\n':\n            printspaces = 1;\n            break;\n        default:\n            break;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "closed_date": 1482090893, "accepted_answer_id": 41151187, "answer_count": 3, "score": -1, "last_activity_date": 1487990482, "creation_date": 1481744699, "last_edit_date": 1487990482, "question_id": 41150916, "link": "https://stackoverflow.com/questions/41150916/whitespace-not-printing-properly", "closed_reason": "Not suitable for this site", "title": "Whitespace not printing properly", "body": "<p>I have this program:</p>\n\n<pre><code>int main(void)\n{\n    while ((c = getchar()) != EOF) {\n        putchar(c);\n        if (c == '{')\n            spaces += 4;\n        else if (c == '}')\n            spaces -= 4;\n        else if (c == '\\n') {\n            print_spaces(spaces);\n            while ((c = getchar()) == ' ')\n                continue;\n            putchar(c);\n        }\n    }\n}\n\nvoid print_spaces(int spaces)\n{\n    while (spaces-- &gt; 0)\n        putchar(' ');\n}\n</code></pre>\n\n<p>When run with this input:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(void)\n{\nprintf(\"hello, world!\\n\");\n}\n</code></pre>\n\n<p>It simply prints the exact input, instead of the desired output - desired output being:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(void)\n{\n    printf(\"hello, world!\\n\");\n}\n</code></pre>\n\n<p>Where have I gone wrong?</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 4, "creation_date": 1481743187, "post_id": 41150485, "comment_id": 69503177, "body": "This is not a testable example, but I suspect you run out of stackspace."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 5, "creation_date": 1481743225, "post_id": 41150485, "comment_id": 69503196, "body": "Use some heap allocated memory (e.g. <code>malloc</code>)."}, {"owner": {"reputation": 7902, "user_id": 4322363, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9447e9906e54173c7ccf70fc6450d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "rosghub", "link": "https://stackoverflow.com/users/4322363/rosghub"}, "edited": false, "score": 0, "creation_date": 1481743303, "post_id": 41150485, "comment_id": 69503228, "body": "Have you tried making your buffer <code>static</code>? This will allocate the space in the data segment instead of the stack"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481743483, "post_id": 41150485, "comment_id": 69503325, "body": "OT: <code>sizeof(char)</code> equals <code>1</code> by definition."}], "answers": [{"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1481745226, "post_id": 41150716, "comment_id": 69504253, "body": "This exact code wont work well because <code>buffer</code> will go out of scope immediately if the condition is not met."}, {"owner": {"reputation": 5213, "user_id": 6757971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1q1Q.jpg?s=128&g=1", "display_name": "Leon Carlo Valencia", "link": "https://stackoverflow.com/users/6757971/leon-carlo-valencia"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1481749519, "post_id": 41150716, "comment_id": 69506488, "body": "Nice catch. Thanks."}], "tags": [], "owner": {"reputation": 5213, "user_id": 6757971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1q1Q.jpg?s=128&g=1", "display_name": "Leon Carlo Valencia", "link": "https://stackoverflow.com/users/6757971/leon-carlo-valencia"}, "is_accepted": false, "score": 2, "last_activity_date": 1481749578, "last_edit_date": 1481749578, "creation_date": 1481743961, "answer_id": 41150716, "question_id": 41150485, "link": "https://stackoverflow.com/questions/41150485/read-300mb-binary-file-to-char-array/41150716#41150716", "title": "Read 300MB binary file to char array", "body": "<p>Depending on your platform and compiler, some limits are set on allowable allocations on stack (that's where your buffer goes). If you want to load the entire file into memory, you would have to use the heap (use malloc). So instead of:</p>\n\n<pre><code>char buffer[MAX_FILE_SIZE];\n</code></pre>\n\n<p>use:</p>\n\n<pre><code>char *buffer;\nif ((buffer = malloc(sizeof(char) * MAX_FILE_SIZE)) == 0) {\n    // exit or some other action to take as your OS failed to allocate\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 4, "last_activity_date": 1481744799, "creation_date": 1481744799, "answer_id": 41150952, "question_id": 41150485, "link": "https://stackoverflow.com/questions/41150485/read-300mb-binary-file-to-char-array/41150952#41150952", "title": "Read 300MB binary file to char array", "body": "<p>There is no C syntax for defining large numbers with separators for blocks of digits: <code>int MAX_FILE_SIZE = 1 000 000</code> should be written <code>int MAX_FILE_SIZE = 1000000;</code>.</p>\n\n<p>Allocating a large array as a local object with automatic storage may cause undefined behavior.  The total space available for this depends on the system, but may be less than one megabyte.  I suggest you allocate the buffer with <code>malloc()</code> and free it after use:</p>\n\n<pre><code>size_t MAX_FILE_SIZE = 300000000;  // 300MB\n\nint read_file(void) {\n    FILE *f;\n    int n = -1;\n    char *buffer = malloc(MAX_FILE_SIZE);\n    if (buffer == NULL)\n        return -1;\n    f = fopen(\"sample.bin\", \"rb\"); //sample.bin is 300MB binary file\n    if (f) {\n        n = fread(buffer, sizeof(char), MAX_FILE_SIZE, f);\n        // perform what ever task you want\n        fclose(f);\n    }\n    free(buffer);\n    return n;\n}\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 5724906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4ba2cda68a7916b7c97d60b52c1110ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/5724906/tomasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 41150952, "answer_count": 2, "score": 1, "last_activity_date": 1481749578, "creation_date": 1481743142, "last_edit_date": 1481744953, "question_id": 41150485, "link": "https://stackoverflow.com/questions/41150485/read-300mb-binary-file-to-char-array", "title": "Read 300MB binary file to char array", "body": "<p>I'm trying to load binary file into char array. My code:</p>\n\n<pre><code>int MAX_FILE_SIZE = 1 000 000\nFILE *f;\nchar buffer[MAX_FILE_SIZE];\nf = fopen(\"sample.bin\", \"rb\"); //sample.bin is 300MB binary file\nif (f)\n  n = fread(buffer, sizeof(char), MAX_FILE_SIZE, f);\n</code></pre>\n\n<p>It works until I set <code>MAX_FILE_SIZE</code> to anything bigger than 1M because I recieve <code>program.exe has stopped working</code>. If I thinking right to load all <code>sample.bin</code> to memory I should set <code>MAX_FILE_SIZE</code> to ~300M. How can I do that?</p>\n"}, {"tags": ["c", "macros"], "answers": [{"comments": [{"owner": {"reputation": 274, "user_id": 6562313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59b0bb1e797a141fb9a0da24bc81fab?s=128&d=identicon&r=PG&f=1", "display_name": "DBPriGuy", "link": "https://stackoverflow.com/users/6562313/dbpriguy"}, "edited": false, "score": 1, "creation_date": 1481742434, "post_id": 41150243, "comment_id": 69502798, "body": "don&#39;t you mean <code>T T</code>?"}, {"owner": {"reputation": 348, "user_id": 7047364, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-SBk9XJ74pRY/AAAAAAAAAAI/AAAAAAAAQcs/ZS8uNP1MDUM/photo.jpg?sz=128", "display_name": "Anjani Kumar", "link": "https://stackoverflow.com/users/7047364/anjani-kumar"}, "edited": false, "score": 1, "creation_date": 1481742502, "post_id": 41150243, "comment_id": 69502839, "body": "@SouravGhosh But the output is T T and not t t."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 348, "user_id": 7047364, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-SBk9XJ74pRY/AAAAAAAAAAI/AAAAAAAAQcs/ZS8uNP1MDUM/photo.jpg?sz=128", "display_name": "Anjani Kumar", "link": "https://stackoverflow.com/users/7047364/anjani-kumar"}, "edited": false, "score": 1, "creation_date": 1481743813, "post_id": 41150243, "comment_id": 69503477, "body": "@AnjaniKumar: You want to consider pressing the F5-key ... ;-)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1481745231, "last_edit_date": 1481745231, "creation_date": 1481742293, "answer_id": 41150243, "question_id": 41150207, "link": "https://stackoverflow.com/questions/41150207/the-output-of-the-following-c-code-is-t-t-why-not-t-t/41150243#41150243", "title": "The output of the following C code is T T , why not t t?", "body": "<p><strong>TL;DR</strong> The variable name <code>T</code> is subject to MACRO replacement, not the initializer <code>'T'</code>.</p>\n\n<hr>\n\n<p>To elaborate, <code>#define</code> MACROs cause textual replacements and anything inside the \"quotes\" (<em>either <code>''</code> or <code>\"\"</code></em>) are not part of MACRO replacement.</p>\n\n<p>So in essence, try running the preprocessor on your code (example: <code>gcc -E test.c</code>) and it looks like</p>\n\n<pre><code> char t = 'T';\n printf(\"\\n%c\\t%c\\n\",t,t);\n</code></pre>\n\n<p><strong><a href=\"http://www.tutorialspoint.com/compile_c99_online.php?PID=0Bw_CjBb95KQMVFUybmxJdmdqZHM\" rel=\"nofollow noreferrer\">Run <code>gcc -E main.c -o test.txt  &amp;&amp; tail -f test.txt</code> and <kbd>See it online</kbd></a></strong></p>\n\n<p>which, expectedly, prints the <em>value</em> of variable <code>t</code>, <code>T T</code>.</p>\n\n<p>That said, for a hosted environment, the required signature for <code>main()</code> is <code>int main(void)</code>, at least.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 8, "last_activity_date": 1481751550, "last_edit_date": 1481751550, "creation_date": 1481742427, "answer_id": 41150275, "question_id": 41150207, "link": "https://stackoverflow.com/questions/41150207/the-output-of-the-following-c-code-is-t-t-why-not-t-t/41150275#41150275", "title": "The output of the following C code is T T , why not t t?", "body": "<p>The preprocessor does not perform substitution of any text within quotes, whether they are single quotes or double quotes.  </p>\n\n<p>So the character constant <code>'T'</code> is unchanged.</p>\n\n<p>From section 6.10.3 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>:</p>\n\n<blockquote>\n  <p><em>9</em> A preprocessing directive of the form</p>\n\n<pre><code># define identifier  replacement-list  new-line\n</code></pre>\n  \n  <p>defines an object-like macro that causes each subsequent instance of\n  the macro name <sup>171)</sup> to  be  replaced  by  the  replacement  list  of \n  preprocessing  tokens  that  constitute  the remainder of the\n  directive.  The replacement list is then rescanned for more macro\n  names as specified below.</p>\n  \n  <blockquote>\n    <p>171) Since, by macro-replacement time, <strong>all character constants and\n    string literals are preprocessing tokens</strong>, not  sequences  possibly \n    containing  identifier-like subsequences  (see  5.1.1.2,  translation \n    phases),  <strong>they are never scanned for macro names or parameters.</strong></p>\n  </blockquote>\n</blockquote>\n"}], "owner": {"reputation": 348, "user_id": 7047364, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-SBk9XJ74pRY/AAAAAAAAAAI/AAAAAAAAQcs/ZS8uNP1MDUM/photo.jpg?sz=128", "display_name": "Anjani Kumar", "link": "https://stackoverflow.com/users/7047364/anjani-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1481751550, "creation_date": 1481742166, "last_edit_date": 1481745164, "question_id": 41150207, "link": "https://stackoverflow.com/questions/41150207/the-output-of-the-following-c-code-is-t-t-why-not-t-t", "title": "The output of the following C code is T T , why not t t?", "body": "<p>The output of the following C code is <code>T T</code>, but I think it should  be <code>t t</code>.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#define T t\nvoid main()\n{\n     char T = 'T';\n     printf(\"\\n%c\\t%c\\n\",T,t);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "random"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1481742053, "post_id": 41150159, "comment_id": 69502591, "body": "What is <code>rang</code>?"}, {"owner": {"reputation": 1432, "user_id": 5036612, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bf1ceca4bda9dba7776ffa4917e537c1?s=128&d=identicon&r=PG&f=1", "display_name": "Adalcar", "link": "https://stackoverflow.com/users/5036612/adalcar"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1481742158, "post_id": 41150159, "comment_id": 69502658, "body": "@SouravGhosh he probably means range"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1481742521, "post_id": 41150159, "comment_id": 69502846, "body": "1) Each range is 10 wide, so all should be <code>% 10</code> or equivalent, but <code>col==1</code> to <code>col==4</code> use <code>11</code>. /// 2) The ranges are even wonkier for <code>col&gt;=5</code>. e.g. <code>rand() % (60 + 1) + 50</code> will produce a number in <code>[50..111]</code>. /// 3) I think you ran a different version of the code than the one you posted. I don&#39;t see how <code>rand() % ((40 + 1) - 30) + 30</code> could produce <code>5</code> (since you&#39;re adding <code>30</code> to a non-negative number)."}, {"owner": {"reputation": 1, "user_id": 6209314, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ovXJGaewWcw/AAAAAAAAAAI/AAAAAAAAAUY/Naz9K9yPEr4/photo.jpg?sz=128", "display_name": "ICM89", "link": "https://stackoverflow.com/users/6209314/icm89"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481753000, "post_id": 41150159, "comment_id": 69508065, "body": "@SouravGhosh Yes range sorry"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6209314, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ovXJGaewWcw/AAAAAAAAAAI/AAAAAAAAAUY/Naz9K9yPEr4/photo.jpg?sz=128", "display_name": "ICM89", "link": "https://stackoverflow.com/users/6209314/icm89"}, "edited": false, "score": 0, "creation_date": 1481757025, "post_id": 41150263, "comment_id": 69509570, "body": "I updated my code with your suggestion but I&#39;m must be missing something obvious here?"}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 1, "user_id": 6209314, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ovXJGaewWcw/AAAAAAAAAAI/AAAAAAAAAUY/Naz9K9yPEr4/photo.jpg?sz=128", "display_name": "ICM89", "link": "https://stackoverflow.com/users/6209314/icm89"}, "edited": false, "score": 0, "creation_date": 1481812287, "post_id": 41150263, "comment_id": 69533653, "body": "@ICM89 Here&#39;s a more complete example."}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1481812257, "last_edit_date": 1481812257, "creation_date": 1481742388, "answer_id": 41150263, "question_id": 41150159, "link": "https://stackoverflow.com/questions/41150159/random-number-in-a-range-inside-an-array/41150263#41150263", "title": "Random number in a range inside an Array", "body": "<p>You're really only generating a random number between 0-9 and adding to it the \"base\" of each column.  Here's a complete example;</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n\n#define ROWS 3\n#define COLS 9\nint bingoCard[ROWS][COLS];\n\nmain()\n{\n  int col, row;\n\n  srand(time(NULL));\n\n  for (row = 0; row&lt;ROWS; row++)\n  {\n      for (col = 0; col&lt;COLS; col++)\n      {\n          bingoCard[row][col] = (rand() % 10) + 1 + col*10;\n      }\n  }\n\n  for (row = 0; row&lt;ROWS; row++)\n  {\n      for (col = 0; col&lt;COLS; col++)\n      {\n          printf(\"%d\\t\", bingoCard[row][col]);          \n      }\n      /* put a newline */\n      puts(\"\");      \n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481743274, "post_id": 41150293, "comment_id": 69503216, "body": "You want to take into account <code>RAND_MAX</code> and that seeding most likely is wanted, by doing for example: <code>srand(time(NULL));</code> before calling <code>rand()</code>."}], "tags": [], "owner": {"reputation": 1432, "user_id": 5036612, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bf1ceca4bda9dba7776ffa4917e537c1?s=128&d=identicon&r=PG&f=1", "display_name": "Adalcar", "link": "https://stackoverflow.com/users/5036612/adalcar"}, "is_accepted": false, "score": 1, "last_activity_date": 1481742676, "last_edit_date": 1481742676, "creation_date": 1481742472, "answer_id": 41150293, "question_id": 41150159, "link": "https://stackoverflow.com/questions/41150159/random-number-in-a-range-inside-an-array/41150293#41150293", "title": "Random number in a range inside an Array", "body": "<p>This is a convoluted means of performing a very simple task</p>\n\n<p>Getting a random number in a range is a simple matter of <code>(rand() % range_size) + range_start</code>.</p>\n\n<p>Here</p>\n\n<pre><code>for (col = 0; col &lt; 9; col++)\n{\n    for (row = 0; row &lt; 3; row++)\n    {\n        bingoCard[row][col] = rand() % 10 + (col * 10 + 1);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6209314, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ovXJGaewWcw/AAAAAAAAAAI/AAAAAAAAAUY/Naz9K9yPEr4/photo.jpg?sz=128", "display_name": "ICM89", "link": "https://stackoverflow.com/users/6209314/icm89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1481812257, "creation_date": 1481741998, "last_edit_date": 1481756917, "question_id": 41150159, "link": "https://stackoverflow.com/questions/41150159/random-number-in-a-range-inside-an-array", "title": "Random number in a range inside an Array", "body": "<p>I'm trying to get random a random number between certain ranges in each column in an array so as to mimic a Bingo card. </p>\n\n<p>The first   column should contain numbers from 1 to 10, the second  column  numbers from 11 to 20, the third, 21 to 30 and so on up until the last column,  which contains numbers from 81 to 90.</p>\n\n<p>Here is my revised code based on answers below:</p>\n\n<pre><code> for (row = 0; row&lt;3; row++)\n            {\n                for (col = 0; col&lt;9; col++)\n                {\n                    if (col == 0)\n                    {\n                        bingoCard[row][col] = (rand() % 10) + 1 + col * 10;\n\n                    }//end of 1st col\n\n                    else if (col == 1)\n                    {\n                        bingoCard[row][col] = (rand() % 10) + 1 + col * 10;\n\n                    }//end of 2nd col\n\n                    else if (col == 2)\n                    {\n                        bingoCard[row][col] = (rand() % 10) + 1 + col * 10;\n\n                    }//end of 3rd col\n\n                    else if (col == 3)\n                    {\n                        bingoCard[row][col] = (rand() % 10) + 1 + col * 10;\n\n                    }//end of 4th col\n\n                    else if (col == 4)\n                    {\n                        bingoCard[row][col] = (rand() % 10) + 1 + col * 10;\n\n                    }//end of 5th col\n\n                    else if (col == 5)\n                    {\n                        bingoCard[row][col] = (rand() % 10) + 1 + col * 10;\n\n                    }//end of 6th col\n\n                    else if (col == 6)\n                    {\n                        bingoCard[row][col] = (rand() % 10) + 1 + col * 10;\n\n                    }//end of 7th col\n\n                    else if (col == 7)\n                    {\n                        bingoCard[row][col] = (rand() % 10) + 1 + col * 10;\n\n                    }//end of 8th col\n\n                    else if (col == 8)\n                    {   \n                        bingoCard[row][col] = (rand() % 10) + 1 + col * 10;\n\n                    }//end of 9th col\n\n                }// end col for\n</code></pre>\n\n<p>The code now outputs the following : </p>\n\n<pre><code>***New Game***\nHow many players?\n1\n\nPlayer : 1 's card\n\n\n\n2       18      25      5       16      26      8       17      22\n5       16      26      8       17      22      35      43      54\n8       17      22      35      43      54      63      73      82\n</code></pre>\n\n<p>It's still way off once it goes past the 3rd column? From there one value in each column is right? </p>\n"}, {"tags": ["c", "linux", "signals"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481742260, "post_id": 41150097, "comment_id": 69502701, "body": "Are you sure you&#39;re not missing a <code>0</code>? <code>SA_NODEFER</code> is 0x4000000`"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1481742277, "post_id": 41150097, "comment_id": 69502710, "body": "In <code>&#47;usr&#47;include&#47;x86_64-linux-gnu&#47;asm&#47;signal.h</code>/<code>&#47;usr&#47;include&#47;asm-&zwnj;&#8203;generic&#47;signal.h:</code> I see: <code>#define SA_RESTORER     0x04000000</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481742331, "post_id": 41150097, "comment_id": 69502740, "body": "That&#39;s probably it. That&#39;s an obsolete flag, so other include files have it commented out."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481742427, "post_id": 41150097, "comment_id": 69502795, "body": "@alk Thanks! Can finally stringify the struct in full."}], "answers": [{"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 4, "last_activity_date": 1481742815, "last_edit_date": 1495542290, "creation_date": 1481742495, "answer_id": 41150297, "question_id": 41150097, "link": "https://stackoverflow.com/questions/41150097/whats-the-0x4000000-sigaction-flag-on-linux/41150297#41150297", "title": "What&#39;s the 0x4000000 sigaction flag on Linux?", "body": "<p>Referring <a href=\"https://stackoverflow.com/questions/41150097/whats-the-0x4000000-sigaction-flag-on-linux/41150297#comment69502710_41150097\">my comment</a>, from <a href=\"http://man7.org/linux/man-pages/man2/rt_sigaction.2.html\" rel=\"nofollow noreferrer\">this man-page</a> we learn:</p>\n\n<blockquote>\n  <p><strong>SA_RESTORER</strong></p>\n  \n  <p><em>Not intended for application use</em>.  This flag is used by C\n                    libraries to indicate that the <em>sa_restorer</em> field contains\n                    the address of a \"signal trampoline\".  See <a href=\"http://man7.org/linux/man-pages/man2/sigreturn.2.html\" rel=\"nofollow noreferrer\"><code>sigreturn(2)</code></a>\n                    for more details.</p>\n</blockquote>\n"}], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 41150297, "answer_count": 1, "score": 1, "last_activity_date": 1481742815, "creation_date": 1481741759, "question_id": 41150097, "link": "https://stackoverflow.com/questions/41150097/whats-the-0x4000000-sigaction-flag-on-linux", "title": "What&#39;s the 0x4000000 sigaction flag on Linux?", "body": "<p>It seems that regardless of how I fill <code>struct sigaction</code> for the set call to the sigaction function, the <code>.sa_flags</code> member gets ORed with\n<code>0x4000000</code>, or at least that's how I get it if I later retrieve the dispositon with <code>sigaction(Signum, NULL, &amp;sa)</code>.</p>\n\n<p>The manpage for sigaction lists the following ORable values for <code>.sa_flags</code>:</p>\n\n<pre><code>SA_NOCLDSTOP\nSA_NOCLDWAIT\nSA_NODEFER\nSA_ONSTACK\nSA_RESETHAND\nSA_RESTART\nSA_SIGINFO\n</code></pre>\n\n<p><code>0x4000000</code> ANDs to 0 with each of the above. What is <code>0x4000000</code>?</p>\n"}, {"tags": ["c", "pthreads", "semaphore", "binary-semaphore"], "comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1481741582, "post_id": 41150014, "comment_id": 69502312, "body": "I would like to test your code, but I do not have the file <code>&quot;timer.h&quot;</code>. Please provide a code which actually does compile."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1481741800, "post_id": 41150014, "comment_id": 69502453, "body": "SO isn&#39;t a debugging service. Compile with symbols, run the code inside a debugger to trace through the program(s) line by line inspecting the values of the relevant variables to learn what is really going on. If then a <i>specific</i> question arises feel free to come back here."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1481741846, "post_id": 41150014, "comment_id": 69502475, "body": "This indention is not really readable."}, {"owner": {"reputation": 346, "user_id": 5231520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a9648c966a8fd857ad01716dcc6d64a6?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5231520/andyw"}, "edited": false, "score": 1, "creation_date": 1481741887, "post_id": 41150014, "comment_id": 69502498, "body": "You&#39;ve got some really weird indentation on that code snippet. Could you copy it again so that it&#39;s easier to read? This error means you are freeing something that has already been freed once. Take a look at all of your &#39;free&#39; statements, and make sure they never free the same variable more than once. Perhaps you are calling &#39;free&#39; in one of your threads, and multiple threads are trying to free the same thing."}, {"owner": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1481742132, "post_id": 41150014, "comment_id": 69502641, "body": "@Michi updated the question now."}, {"owner": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481742309, "post_id": 41150014, "comment_id": 69502726, "body": "@alk It happens when pthreads are trying to write the array to a file."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1481743350, "post_id": 41150014, "comment_id": 69503250, "body": "also a file.dat would be nice"}], "answers": [{"tags": [], "owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "is_accepted": true, "score": 0, "last_activity_date": 1481742829, "creation_date": 1481742829, "answer_id": 41150394, "question_id": 41150014, "link": "https://stackoverflow.com/questions/41150014/error-while-compiling-the-code-double-free-or-corruption-out-using-threads-i/41150394#41150394", "title": "Error while compiling the code &#39;double free or corruption (out)&#39; using threads in C?", "body": "<p>The *fp is a global variable, so each therad will initialize it with fopen and after finished working try to close it. the *fp is shared between threads (which should not be) so each thread before exiting tries to close the file handle stored in *fp and the double free occurs when multiple threads tries to close file handle which closed already by another thread.</p>\n\n<p>You have to put *fp inside function block to make it local to each thread or add __thread before *fp declaration to make it local for each thread instance.\n    __thread FILE * fp;</p>\n"}], "owner": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "closed_date": 1481930500, "accepted_answer_id": 41150394, "answer_count": 1, "score": -3, "last_activity_date": 1481742952, "creation_date": 1481741481, "last_edit_date": 1481742952, "question_id": 41150014, "link": "https://stackoverflow.com/questions/41150014/error-while-compiling-the-code-double-free-or-corruption-out-using-threads-i", "closed_reason": "Needs more focus", "title": "Error while compiling the code &#39;double free or corruption (out)&#39; using threads in C?", "body": "<p>I'm trying to do a ebola simulation using pthreads. Everything worked just fine up to the semaphor part.\nI'm getting this error while compiling code:</p>\n\n<pre><code>  *** Error in `./ebola_serial': double free or corruption (out): 0x00007f49700008c0 ***\n  *** Error in `======= Backtrace: =========\n  /lib64/libc.so.6(+0x7238e)[0x7f49868f038e]\n  ./ebola_serial/lib64/libc.so.6(+0x7a0c8)[0x7f49868f80c8]\n  ': /lib64/libc.so.6(cfree+0x48)[0x7f49868fb798]\n  double free or corruption (out)/lib64/libc.so.6(fclose+0x113)[0x7f49868e6473]\n  ./ebola_serial[0x401717]\n  /lib64/libpthread.so.0(+0x75bd)[0x7f4986c395bd]\n  : 0x/lib64/libc.so.6(clone+0x6d)[0x7f498697562d]\n  ======= Memory map: ========\n  00007f49700008c000400000-00402000 r-xp 00000000 08:01 802698                             /home/name/Desktop/try ca/ebola_serial\n  00601000-00602000 r--p 00001000 08:01 802698                             /home/name/Desktop/try ca/ebola_serial\n  00602000-00603000 rw-p 00002000 08:01 802698                             /home/name/Desktop/try ca/ebola_serial\n  00603000-009d3000 rw-p 00000000 00:00 0 \n  01b96000-01bb7000 rw-p 00000000 00:00 0                                  [heap]\n  7f4970000000-7f4970021000 rw-p 00000000 00:00 0 \n  7f4970021000-7f4974000000 ---p 00000000 00:00 0 \n  7f4978000000-7f4978021000 rw-p 00000000 00:00 0 \n  7f4978021000-7f497c000000 ---p 00000000 00:00 0 \n  7f497c000000-7f497c021000 rw-p 00000000 00:00 0 \n  7f497c021000-7f4980000000 ---p 00000000 00:00 0 \n  7f4980000000-7f4980021000 rw-p 00000000 00:00 0 \n  7f4980021000-7f4984000000 ---p 00000000 00:00 0 \n  7f4984663000-7f4984679000 r-xp 00000000 08:01 131531                     /usr/lib64/libgcc_s-4.9.2.so.1\n  7f4984679000-7f4984878000 ---p 00016000 08:01 131531                     /usr/lib64/libgcc_s-4.9.2.so.1\n  7f4984878000-7f4984879000 r--p 00015000 08:01 131531                     /usr/lib64/libgcc_s-4.9.2.so.1\n  7f4984879000-7f498487a000 rw-p 00016000 08:01 131531                     /usr/lib64/libgcc_s-4.9.2.so.1\n  7f498487a000-7f498487b000 ---p 00000000 00:00 0 \n  7f498487b000-7f498507b000 rw-p 00000000 00:00 0                          [stack:7376]\n  7f498507b000-7f498507c000 ---p 00000000 00:00 0 \n  7f498507c000-7f498587c000 rw-p 00000000 00:00 0 \n  7f498587c000-7f498587d000 ---p 00000000 00:00 0 \n  7f498587d000-7f498607d000 rw-p 00000000 00:00 0                          [stack:7374]\n  7f498607d000-7f498607e000 ---p 00000000 00:00 0 \n  7f498607e000-7f498687e000 rw-p 00000000 00:00 0                          [stack:7373]\n  7f498687e000-7f4986a28000 r-xp 00000000 08:01 130947                     /usr/lib64/libc-2.20.so\n  7f4986a28000-7f4986c28000 ---p 001aa000 08:01 130947                     /usr/lib64/libc-2.20.so\n  7f4986c28000-7f4986c2c000 r--p 001aa000 08:01 130947                     /usr/lib64/libc-2.20.so\n  7f4986c2c000-7f4986c2e000 rw-p 001ae000 08:01 130947                     /usr/lib64/libc-2.20.so\n  7f4986c2e000-7f4986c32000 rw-p 00000000 00:00 0 \n  7f4986c32000-7f4986c49000 r-xp 00000000 08:01 130973                     /usr/lib64/libpthread-2.20.so\n  7f4986c49000-7f4986e48000 ---p 00017000 08:01 130973                     /usr/lib64/libpthread-2.20.so\n  7f4986e48000-7f4986e49000 r--p 00016000 08:01 130973                     /usr/lib64/libpthread-2.20.so\n  7f4986e49000-7f4986e4a000 rw-p 00017000 08:01 130973                     /usr/lib64/libpthread-2.20.so\n  7f4986e4a000-7f4986e4e000 rw-p 00000000 00:00 0 \n  7f4986e4e000-7f4986f53000 r-xp 00000000 08:01 130955                     /usr/lib64/libm-2.20.so\n  7f4986f53000-7f4987152000 ---p 00105000 08:01 130955                     /usr/lib64/libm-2.20.so\n  7f4987152000-7f4987153000 r--p 00104000 08:01 130955                     /usr/lib64/libm-2.20.so\n  7f4987153000-7f4987154000 rw-p 00105000 08:01 130955                     /usr/lib64/libm-2.20.so\n  7f4987154000-7f4987174000 r-xp 00000000 08:01 130940                     /usr/lib64/ld-2.20.so\n  7f4987353000-7f4987356000 rw-p 00000000 00:00 0 \n  7f498736d000-7f4987373000 rw-p 00000000 00:00 0 \n  7f4987373000-7f4987374000 r--p 0001f000 08:01 130940                     /usr/lib64/ld-2.20.so\n  7f4987374000-7f4987376000 rw-p 00020000 08:01 130940                     /usr/lib64/ld-2.20.so\n  7ffce31e3000-7ffce3205000 rw-p 00000000 00:00 0                          [stack]\n  7ffce320d000-7ffce320f000 r--p 00000000 00:00 0                          [vvar]\n  7ffce320f000-7ffce3211000 r-xp 00000000 00:00 0                          [vdso]\n  ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n  Aborted\n</code></pre>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;semaphore.h&gt;\n#include \"timer.h\"\n#define NUMROW 1000\n#define NUMCOL 1000\n#define NUMCOMP 1000000\n#define GEN 400\n#define THREAD_COUNT 4\n\nFILE *fp;\nchar buffer[32];\n\nint map[1000][1000];\nint neighbours[8];\nint nextGen;\ndouble chance;\n\nint tInfection = 0;\nint tHealthy = 0;\nint tDead = 0;\nint tRecovered = 0;\n\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\n\nsem_t semaphores[THREAD_COUNT];\n\nint barrCount1,\nbarrCount2, totalDead, totalHealthy, totalInfection, totalRecovered, p;\npthread_mutex_t barrier_mutex;\n\nvoid* mythread_func(void* rank)\n{\n  long my_rank = (long) rank;\n  long i, j;\n  long my_row = NUMROW / THREAD_COUNT;\n  long my_col = my_row;\n  long my_first_i = my_row * my_rank;\n  long my_last_i = my_first_i + my_row - 1;\n\n  for (i = my_first_i; i &lt; my_last_i; i++)\n  {\n    for (j = my_first_i; j &lt; my_last_i; j++)\n    {\n      map[i][j] = 0;\n    }\n  }\n\n  int inf;\n  //infecting 5 random people\n  for (inf = 0; inf &lt; 1; inf++)\n  {\n    double rand1 = floor(rand() % ((my_last_i + 1 - my_first_i) + my_first_i));\n    double rand2 = floor(rand() % ((my_last_i + 1 - my_first_i) + my_first_i));\n\n    int randFin1 = (int) rand1;\n    int randFin2 = (int) rand2;\n\n    map[randFin1][randFin2] = 1;\n\n  }\n\n  int k = 0;\n  long dest = (my_rank + 1) % THREAD_COUNT;\n\n  long genCount;\n\n  //loops of generation\n  for (genCount = 0; genCount &lt; GEN; genCount++)\n  {\n\n    //mutex barrier---------------------------\n    pthread_mutex_lock(&amp;barrier_mutex);\n    barrCount1++;\n    pthread_mutex_unlock(&amp;barrier_mutex);\n    while (barrCount1 &lt; THREAD_COUNT)\n      ;\n    //----------------------------------------\n\n    //looping through columns and rows\n    for (i = my_first_i; i &lt; my_last_i; i++)\n    {\n      for (j = my_first_i; j &lt; my_last_i; j++)\n      {\n\n        nextGen = 1;\n\n        //left neigbour\n        neighbours[0] = map[(i + NUMROW - 1) % NUMROW][j];\n\n        //right neighbour\n        neighbours[1] = map[(i + NUMROW + 1) % NUMROW][j];\n\n        //top neighbour\n        neighbours[2] = map[i][(j + NUMROW - 1) % NUMROW];\n\n        //bottom neigbour\n        neighbours[3] = map[i][(j + NUMROW + 1) % NUMROW];\n\n        //bottom left neighbour\n        neighbours[4] =\n            map[(i + NUMROW - 1) % NUMROW][(j + NUMROW + 1) % NUMROW];\n\n        //bottom right neighbour\n        neighbours[5] =\n            map[(i + NUMROW + 1) % NUMROW][(j + NUMROW + 1) % NUMROW];\n\n        //top left neighbour\n        neighbours[6] =\n            map[(i + NUMROW - 1) % NUMROW][(j + NUMROW - 1) % NUMROW];\n\n        //top right neigbour\n        neighbours[7] =\n            map[(i + NUMROW + 1) % NUMROW][(j + NUMROW - 1) % NUMROW];\n\n        int infections = 0;\n        int dead = 0;\n\n        for (p = 0; p &lt; 8; p++)\n        {\n          if (neighbours[p] == 1)\n          {\n            infections++;\n          }\n\n          if (neighbours[p] == 2)\n          {\n            dead++;\n          }\n        }\n\n        if (infections &gt; 0 &amp;&amp; map[i][j] == 0)\n        {\n          chance = 20.0;\n\n          if (floor(rand() % 101) &lt; chance)\n          {\n            //Person is infected\n\n            tInfection++;\n            tHealthy--;\n\n            map[i][j] = 1;\n            nextGen = 0;\n          } //end of infections if statement\n        } //end of chancing life\n\n        if (map[i][j] == 1 &amp;&amp; nextGen)\n        {\n          chance = 10.0;\n\n          if (floor(rand() % 101) &lt; chance)\n          {\n            //Person is dead\n            tDead++;\n            tHealthy--;\n            map[i][j] = 2;\n          }\n        }\n\n        if (map[i][j] == 1 &amp;&amp; nextGen)\n        {\n          chance = 0.5;\n\n          if (floor(rand() % 101) &lt; chance)\n          {\n            tRecovered++;\n            tDead--;\n            map[i][j] = 3;\n          }\n        }\n      }\n    }\n  }\n\n  pthread_mutex_lock(&amp;mutex);\n  totalHealthy += tHealthy;\n  totalDead += tDead;\n  totalInfection += tInfection;\n  totalRecovered += tRecovered;\n  pthread_mutex_unlock(&amp;mutex);\n\n  //mutex barrier---------------------------\n  pthread_mutex_lock(&amp;barrier_mutex);\n  barrCount2++;\n  pthread_mutex_unlock(&amp;barrier_mutex);\n  while (barrCount2 &lt; THREAD_COUNT)\n    ;\n  //----------------------------------------\n\n  printf(\n      \"-------------------------------------------------\\nThread %ld numbers:\\nHealthy: %d\\nDead: %d\\nInfected: %d\\nRecovered: %d\\n\",\n      my_rank, totalHealthy, totalDead, totalInfection, totalRecovered);\n\n  //every 50 generations create file with results\n  if (genCount % 50 == 0)\n  {\n    //incrementing file name\n\n    sem_post(&amp;semaphores[dest]);\n\n    sem_wait(&amp;semaphores[my_rank]);\n\n    snprintf(buffer, sizeof(char) * 32, \"file%i.dat\", k);\n\n    //open the file\n    fp = fopen(buffer, \"r+\");\n    if (fp == NULL )\n    {\n      printf(\"I couldn't open file for writing.\\n\");\n      exit(0);\n    }\n\n    int loop1, loop2;\n\n    //outputting the array into the file\n    for (loop1 = my_first_i; loop1 &lt; my_last_i; loop1++)\n    {\n      for (loop2 = my_first_i; loop2 &lt; my_last_i; loop2++)\n      {\n        fprintf(fp, \"%d\\t\", map[loop1][loop2]);\n      }\n    }\n\n    //close the file\n    fclose(fp);\n\n    k++;\n  }\n\n  return NULL ;\n}\n\nint main()\n{\n\n  //int map[1000][1000];\n  //neighbours\n  int totalHealthy = 0;\n  int totalInfection = 0;\n  int totalDead = 0;\n  int totalRecovered = 0;\n  double chance = 20.0;\n  double start, finish, elapsed;\n\n  int i, j, g, inf;\n  int k = 0;\n\n  //--------------Seed For Random Numbers-----------\n  time_t t;\n  /* Inititializes random number generator*/\n  srand((unsigned) time(&amp;t));\n  //------------------------------------------------\n\n  printf(\"Ebola spreading...\\n\");\n\n  //start timer------------------\n  GET_TIME(start);\n  //-----------------------------\n\n  //Thread code----------------------------------------------------------------------\n  long thread;\n\n  int semCount;\n  for (semCount = 0; semCount &lt; THREAD_COUNT; semCount++)\n  {\n    sem_init(&amp;semaphores[semCount], 0, 1);\n  }\n\n  pthread_t *mythread_handle;\n\n  mythread_handle = malloc(THREAD_COUNT * sizeof(pthread_t));\n\n  for (thread = 0; thread &lt; THREAD_COUNT; thread++)\n  {\n    pthread_create(&amp;mythread_handle[thread], NULL, mythread_func,\n        (void *) thread);\n  }\n\n  for (thread = 0; thread &lt; THREAD_COUNT; thread++)\n  {\n    pthread_join(mythread_handle[thread], NULL );\n  }\n\n  pthread_mutex_destroy(&amp;mutex);\n\n  //----------------------------------------------------------------------------------\n  //stop timer------------\n  GET_TIME(finish);\n\n  elapsed = finish - start;\n\n  free(mythread_handle);\n\n  printf(\"Time elapsed: %e seconds\\n\", elapsed);\n\n  return 0;\n\n}\n</code></pre>\n\n<p>Here is timer.h file:</p>\n\n<pre><code>#ifndef _TIMER_H_\n#define _TIMER_H_\n\n#include &lt;sys/time.h&gt;\n\n/* The argument now should be a double (not a pointer to a double) */\n#define GET_TIME(now) { \\\n      struct timeval t; \\\n      gettimeofday(&amp;t, NULL); \\\n      now = t.tv_sec + t.tv_usec/1000000.0; \\\n    }\n\n#endif\n</code></pre>\n\n<p>Any help would be appreciated. Thanks</p>\n"}, {"tags": ["c", "arrays", "buffer", "spi"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1481741909, "post_id": 41149740, "comment_id": 69502507, "body": "Your <code>static uint8 endFrame[32] = {1,1,1,1};</code> is neither a 32-element array of <code>1</code> bits (only the first 4 elements are 1, the others are 0), nor a 4-element array of <code>0xFF</code> bytes (32 bits). And you seem to only write one LED date [sic] field. Note that its &quot;global&quot; bitfield probably must not be <code>11111b</code> or the items could possibly be confused with the end frame marker when the pixel is white."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481743776, "post_id": 41149740, "comment_id": 69503458, "body": "Why have you changed the question? Making corrections from comments and answers is not helpful. StackOverflow is not a running-update service."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481743896, "post_id": 41149740, "comment_id": 69503517, "body": "If necessary add an addendum to the question. But how will anyone now reading the question make sense of the answers and comments?"}, {"owner": {"reputation": 8408, "user_id": 1048385, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/emBBd.png?s=128&g=1", "display_name": "random", "link": "https://stackoverflow.com/users/1048385/random"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481743929, "post_id": 41149740, "comment_id": 69503538, "body": "@WeatherVane i understand. I&#39;ve changed it back to the original questions + addendums."}], "answers": [{"comments": [{"owner": {"reputation": 8408, "user_id": 1048385, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/emBBd.png?s=128&g=1", "display_name": "random", "link": "https://stackoverflow.com/users/1048385/random"}, "edited": false, "score": 0, "creation_date": 1481742542, "post_id": 41150150, "comment_id": 69502857, "body": "I very much appreciate your response. I&#39;ve updated my question with the documentation for the put array method."}, {"owner": {"reputation": 8408, "user_id": 1048385, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/emBBd.png?s=128&g=1", "display_name": "random", "link": "https://stackoverflow.com/users/1048385/random"}, "edited": false, "score": 0, "creation_date": 1481743012, "post_id": 41150150, "comment_id": 69503079, "body": "Would I not want my <code>endFrame</code> to be` {0xff,0xff,0xff,0xff};` since it has to be all 1&#39;s? Any my <code>startFrame</code> be <code>{0x00,0x00,0x00,0x00}</code> ??"}, {"owner": {"reputation": 7797, "user_id": 942746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34cf9eae5d595c0b480a7cb42f3722b1?s=128&d=identicon&r=PG", "display_name": "Brian McFarland", "link": "https://stackoverflow.com/users/942746/brian-mcfarland"}, "reply_to_user": {"reputation": 8408, "user_id": 1048385, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/emBBd.png?s=128&g=1", "display_name": "random", "link": "https://stackoverflow.com/users/1048385/random"}, "edited": false, "score": 1, "creation_date": 1481743392, "post_id": 41150150, "comment_id": 69503270, "body": "Yes, you&#39;re correct on the start frame.  Sorry, got that backwards.  Also, FYI, from a quick glance, the &quot;global&quot; value sets an overall &quot;brightness&quot; via drive strength control where the R/G/B sets PWM duty cycle.  Don&#39;t be surprised if 1) altering the brightness <i>also</i> shifts the color, and 2) this device doesn&#39;t perfectly map to your expectations of RGB values for setting color."}], "tags": [], "owner": {"reputation": 7797, "user_id": 942746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34cf9eae5d595c0b480a7cb42f3722b1?s=128&d=identicon&r=PG", "display_name": "Brian McFarland", "link": "https://stackoverflow.com/users/942746/brian-mcfarland"}, "is_accepted": true, "score": 2, "last_activity_date": 1481741965, "creation_date": 1481741965, "answer_id": 41150150, "question_id": 41149740, "link": "https://stackoverflow.com/questions/41149740/creating-arrays-in-c-based-on-data-sheet/41150150#41150150", "title": "Creating arrays in C based on data sheet", "body": "<p>You could have a couple problems here.  </p>\n\n<p>First of all... SPI is normally more or less transactional.  Unlike UART (as a common counter example) you don't just write whatever you want whenever you want.  You normally need to toggle a chip select (sometimes \"slave select\"), \"clock out\" words one at a time, then toggle the chip select the other way.  Without documentation on <code>SPI_1_SpiUartPutArray()</code>, its hard to say whether or not you can call it multiple times in the same transfer (between chip select toggling).</p>\n\n<p><strong>EDIT:</strong>  Never mind on the chip select thing.  This LED driver does not appear to have a chip select/enable line.  Just note for future reference this is unusual for SPI.</p>\n\n<p>Second problem - I would assume <code>SPI_1_SpiUartPutArray()</code> puts out BYTES at a time, not bits.  Again, you did not provide documentation of the function so its hard to say.  If my assumption is correct, you would want <code>startFrame</code> to be <code>static uint8 startFrame[4] = {0xff, 0xff, 0xff, 0xff};</code> as there are 8 bits in a byte giving you a 32-bit start-of-frame.  Same idea applies to color &amp; end of frame.</p>\n\n<p>Third problem - If I'm wrong about how the SPI function works, you're not fully initializing those arrays.  You declare arrays of 32 <em>bytes</em> and then only initialize 4 of those.</p>\n"}, {"tags": [], "owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "is_accepted": false, "score": 2, "last_activity_date": 1481741985, "creation_date": 1481741985, "answer_id": 41150152, "question_id": 41149740, "link": "https://stackoverflow.com/questions/41149740/creating-arrays-in-c-based-on-data-sheet/41150152#41150152", "title": "Creating arrays in C based on data sheet", "body": "<p>You have to declare startFrame a 4 element array of uint8, not 32 element of uint8 which is 256 bits long, accordingly if the second argument of SPI_1_SpiUartPutArray is number of Bytes to write on SPI, you have to put 4 (4bytes - 32bit), not 32 (which is 256 bit)</p>\n\n<pre><code>static uint8 startFrame[4];\nSPI_1_SpiUartPutArray(startFrame, 4);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5213, "user_id": 6757971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1q1Q.jpg?s=128&g=1", "display_name": "Leon Carlo Valencia", "link": "https://stackoverflow.com/users/6757971/leon-carlo-valencia"}, "is_accepted": false, "score": 1, "last_activity_date": 1481742045, "creation_date": 1481742045, "answer_id": 41150173, "question_id": 41149740, "link": "https://stackoverflow.com/questions/41149740/creating-arrays-in-c-based-on-data-sheet/41150173#41150173", "title": "Creating arrays in C based on data sheet", "body": "<p>You need to change your array size to 4 instead of 32. uint8 already has 8 bits and 4 of those means 32 bits. Now unless you use some non-standard library, you need a bit of math to say what bits to set to 1 and which ones to set to 0. For instance, putting a 31 = 00001111b in one byte means you are setting the first 4 bits to 0 and the last 4 bits to 1. So, in your case, the code would be:</p>\n\n<pre><code>static uint8 startFrame[4] = {0,0,0,0};\nstatic uint8 colorFrame[4] = {255, &lt;R&gt;, &lt;G&gt;, &lt;B&gt;};\nstatic uint8 endFrame[4] = {255,255,255,255};\n\nSPI_1_SpiUartPutArray(startFrame, 4);\nSPI_1_SpiUartPutArray(colorFrame, 4); // multiple of these for each LED\nSPI_1_SpiUartPutArray(endFrame, 4);\n</code></pre>\n"}], "owner": {"reputation": 8408, "user_id": 1048385, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/emBBd.png?s=128&g=1", "display_name": "random", "link": "https://stackoverflow.com/users/1048385/random"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 41150150, "answer_count": 3, "score": 1, "last_activity_date": 1481744045, "creation_date": 1481740547, "last_edit_date": 1481744045, "question_id": 41149740, "link": "https://stackoverflow.com/questions/41149740/creating-arrays-in-c-based-on-data-sheet", "title": "Creating arrays in C based on data sheet", "body": "<p>I'm extremely new to the c language (obj-c, swift usually) and I'm working with some Cypress BLE boards. I'm trying to control a simple LED.</p>\n\n<p>Per <a href=\"https://cdn-shop.adafruit.com/product-files/2343/APA102C.pdf\" rel=\"nofollow noreferrer\">the documentation</a> I should simply be writing to a SPI bus to control the LED. </p>\n\n<p>Here is the relevant part: \n<a href=\"https://i.stack.imgur.com/dCH2r.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dCH2r.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So I write 32 bits of 0's to start. Then the RGB array. Then 32 bits of all 1's. Here is what I'm currently trying: </p>\n\n<pre><code>static uint8 startFrame[32] = {0,0,0,0};\nstatic uint8 colorFrame[32] = {1, 255, 0, 0};\nstatic uint8 endFrame[32] = {1,1,1,1};\n\n\nSPI_1_SpiUartPutArray(startFrame, 32);\nSPI_1_SpiUartPutArray(colorFrame, 32);\nSPI_1_SpiUartPutArray(endFrame,   32);\n</code></pre>\n\n<p>My thought is that an <code>int</code> is 8 bits so putting <code>{1,1,1,1}</code> should be of size 32. Again, I'm extremely new and hacking my way through this. Any help is very much appreciated!</p>\n\n<p>Documentation for <code>SPI_1_SpiUartPutArray</code>:</p>\n\n<pre><code>/*******************************************************************************\n* Function Name: SPI_1_SpiUartPutArray\n****************************************************************************//**\n*\n*  Places an array of data into the transmit buffer to be sent.\n*  This function is blocking and waits until there is a space available to put\n*  all the requested data in the transmit buffer. The array size can be greater\n*  than transmit buffer size.\n*\n* \\param wrBuf: pointer to an array of data to be placed in transmit buffer. \n*  The width of the data to be transmitted depends on TX data width selection \n*  (the data bit counting starts from LSB for each array element).\n* \\param count: number of data elements to be placed in the transmit buffer.\n*\n* \\globalvars\n*  SPI_1_txBufferHead - the start index to put data into the \n*  software transmit buffer.\n*  SPI_1_txBufferTail - start index to get data from the software\n*  transmit buffer.\n*\n*******************************************************************************/\nvoid SPI_1_SpiUartPutArray(const uint8 wrBuf[], uint32 count)\n{\n    uint32 i;\n\n    for (i=0u; i &lt; count; i++)\n    {\n        SPI_1_SpiUartWriteTxData((uint32) wrBuf[i]);\n    }\n}\n</code></pre>\n\n<p>Which I've also tried this: </p>\n\n<pre><code> static uint8 startFrame[32] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};\n    static uint8 colorFrame[32] = {1,1,1, 1,1,1,1,1 , 1,1,1,1,1,1,1,1, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0};\n    static uint8 endFrame[32] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};\n</code></pre>\n\n<p>and this: </p>\n\n<pre><code>static uint8 startFrame[4] = {0x00, 0x00, 0x00, 0x00};\nstatic uint8 colorFrame[4] = {0xff, 0xff, 0xff, 0xff};\nstatic uint8 endFrame[4]   = {0xff, 0xff, 0xff ,0xff};\n\nSPI_1_SpiUartPutArray(startFrame, 4);\nSPI_1_SpiUartPutArray(colorFrame, 4);\nSPI_1_SpiUartPutArray(endFrame,   4);\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>static uint8 startFrame[4] = {0,0,0,0};\nstatic uint8 colorFrame[4] = {255, &lt;R&gt;, &lt;G&gt;, &lt;B&gt;};\nstatic uint8 endFrame[4] = {255,255,255,255};\n\nSPI_1_SpiUartPutArray(startFrame, 4);\nSPI_1_SpiUartPutArray(colorFrame, 4); // multiple of these for each LED\nSPI_1_SpiUartPutArray(endFrame, 4);\n</code></pre>\n\n<p>If any of the above setups are correct then it must be an issue with how I'm writing to the SPI. </p>\n"}, {"tags": ["c", "arrays", "pointers", "buffer-overflow"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 2, "creation_date": 1481740473, "post_id": 41149693, "comment_id": 69501694, "body": "You shouldn&#39;t have any expectation from undefined behavior. Its every act is deceptive."}, {"owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "edited": false, "score": 1, "creation_date": 1481740568, "post_id": 41149693, "comment_id": 69501736, "body": "&quot;Undefined behavior&quot; means anything can happen as far as the Standard is concerned. Something is actually happening so that should meet your expectations. :)"}, {"owner": {"reputation": 300, "user_id": 7172363, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000922552347/picture?type=large", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0435\u0439 \u041d\u0435\u0443\u0434\u0430\u0447\u0438\u043d", "link": "https://stackoverflow.com/users/7172363/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b5%d0%b9-%d0%9d%d0%b5%d1%83%d0%b4%d0%b0%d1%87%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1481742527, "post_id": 41149693, "comment_id": 69502849, "body": "compiler aligns data segment.I bet to this cause."}], "answers": [{"comments": [{"owner": {"reputation": 300, "user_id": 7172363, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000922552347/picture?type=large", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0435\u0439 \u041d\u0435\u0443\u0434\u0430\u0447\u0438\u043d", "link": "https://stackoverflow.com/users/7172363/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b5%d0%b9-%d0%9d%d0%b5%d1%83%d0%b4%d0%b0%d1%87%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1481741872, "post_id": 41149728, "comment_id": 69502486, "body": "..non-null-terminated...   and all that stuff is wrong"}, {"owner": {"reputation": 300, "user_id": 7172363, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000922552347/picture?type=large", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0435\u0439 \u041d\u0435\u0443\u0434\u0430\u0447\u0438\u043d", "link": "https://stackoverflow.com/users/7172363/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b5%d0%b9-%d0%9d%d0%b5%d1%83%d0%b4%d0%b0%d1%87%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1481742748, "post_id": 41149728, "comment_id": 69502956, "body": "char b[]=&quot;jyumj&quot;; printf(&quot;%s&quot;,b);       workin"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 300, "user_id": 7172363, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000922552347/picture?type=large", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0435\u0439 \u041d\u0435\u0443\u0434\u0430\u0447\u0438\u043d", "link": "https://stackoverflow.com/users/7172363/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b5%d0%b9-%d0%9d%d0%b5%d1%83%d0%b4%d0%b0%d1%87%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1481742795, "post_id": 41149728, "comment_id": 69502980, "body": "@\u0410\u043b\u0435\u043a\u0441\u0435\u0439\u041d\u0435\u0443\u0434\u0430\u0447\u0438\u043d so you think <code>b</code> is not null-terminated, i&#39;m afraid, you&#39;re wrong."}, {"owner": {"reputation": 300, "user_id": 7172363, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000922552347/picture?type=large", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0435\u0439 \u041d\u0435\u0443\u0434\u0430\u0447\u0438\u043d", "link": "https://stackoverflow.com/users/7172363/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b5%d0%b9-%d0%9d%d0%b5%d1%83%d0%b4%d0%b0%d1%87%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1481742848, "post_id": 41149728, "comment_id": 69502998, "body": "how about to type non workin ex"}, {"owner": {"reputation": 300, "user_id": 7172363, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000922552347/picture?type=large", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0435\u0439 \u041d\u0435\u0443\u0434\u0430\u0447\u0438\u043d", "link": "https://stackoverflow.com/users/7172363/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b5%d0%b9-%d0%9d%d0%b5%d1%83%d0%b4%d0%b0%d1%87%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1481744403, "post_id": 41149728, "comment_id": 69503774, "body": "yea it&#39;s null-terminated"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1481741854, "last_edit_date": 1481741854, "creation_date": 1481740515, "answer_id": 41149728, "question_id": 41149693, "link": "https://stackoverflow.com/questions/41149693/behavior-of-char-pointer/41149728#41149728", "title": "Behavior of char pointer", "body": "<p>As per your memory allocation of <code>sizeof(char)</code> bytes (<em>and considering the allocation is success</em>),</p>\n\n<pre><code>  list[1] = 'b';\n</code></pre>\n\n<p>is out-of-bound access, which invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>. There can be no <em>expectation</em> from a program causing UB. It can do <em>anything</em>, absolutely <em>anything</em>.</p>\n\n<p>That said,</p>\n\n<ul>\n<li><code>sizeof(char)</code> is defined (<em>guranteed</em>) to be <code>1</code> in C standard.</li>\n<li>Check for the success of <code>malloc()</code> before using the return value. Otherwise, the first access, <code>list[0]</code> itself will invoke UB as you'll end up dereferencing an invalid pointer (<em>i.e., accessing invalid memory</em>)</li>\n<li>Passing a pointer to a non-null-terminated <code>char</code> array as argument to <code>%s</code> also invokes UB.</li>\n</ul>\n"}], "owner": {"reputation": 1196, "user_id": 5333936, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tuYyF.png?s=128&g=1", "display_name": "Blobonat", "link": "https://stackoverflow.com/users/5333936/blobonat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1481741407, "accepted_answer_id": 41149728, "answer_count": 1, "score": 0, "last_activity_date": 1481867734, "creation_date": 1481740414, "last_edit_date": 1481867734, "question_id": 41149693, "link": "https://stackoverflow.com/questions/41149693/behavior-of-char-pointer", "closed_reason": "Duplicate", "title": "Behavior of char pointer", "body": "<p>I am really confused about the following:</p>\n\n<pre><code>char *list = malloc(sizeof(char));\n\nlist[0] = 'a';\nlist[1] = 'b';\nprintf(\"%s\\n\", list);\n</code></pre>\n\n<p>My expectation was some kind of undefined behavior, because <code>list</code> has only memory for 1 char \"object\".</p>\n\n<p>But the actual output is <code>ab</code>. Why can I access <code>list[1]</code> when <code>list</code> only has allocated memory for one char?</p>\n"}, {"tags": ["c", "microcontroller", "scaling", "68hc12"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1481740343, "post_id": 41149621, "comment_id": 69501624, "body": "Did you not like the answers to your similar recent <a href=\"http://stackoverflow.com/questions/41148145/how-to-scale-a-number-range-of-numbers-in-c\">previous question</a>? I would like to close this question as a <b>duplicate</b>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481740655, "post_id": 41149621, "comment_id": 69501798, "body": "There were days where programming was taken/tought as applied mathematics."}, {"owner": {"reputation": 35, "user_id": 5558046, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/281d26d9ceea9c35d15338736b6f7827?s=128&d=identicon&r=PG&f=1", "display_name": "user_1", "link": "https://stackoverflow.com/users/5558046/user-1"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481740680, "post_id": 41149621, "comment_id": 69501805, "body": "The second part to my last question is unanswered.  Apologies for the repost. @WeatherVane"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1481740825, "post_id": 41149621, "comment_id": 69501876, "body": "Scaling the range <code>0..1023</code> to <code>0..19</code> is trivial. Then print <code>N</code> blocks on the line followed by <code>20 - N</code> spaces."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481740872, "post_id": 41149621, "comment_id": 69501895, "body": "You want to double check, whether your use-case requires the 0 to be handled exclusively. Will say if you want to have the LCD show <i>something</i> for <i>any</i> value &gt;0. Which would require scaling 1-1023 to 0-19 or 1-20 (depending how you index the 20 elements)."}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1481748564, "post_id": 41149621, "comment_id": 69505996, "body": "Don&#39;t quite get what you&#39;re asking. We can reduce 0-1023 to 0-19 via (x * 20)/1024. You need to watch for overflow."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "reply_to_user": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1481750700, "post_id": 41149621, "comment_id": 69507052, "body": "@MalcolmMcLean (x*5)/256 and no chance of overflow on any compliant C Platform."}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1539171820, "post_id": 41149621, "comment_id": 92403390, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/41148145/how-to-scale-a-number-range-of-numbers-in-c\">How to scale a number/range of numbers in c</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2832, "user_id": 3735873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K93GY.jpg?s=128&g=1", "display_name": "tonypdmtr", "link": "https://stackoverflow.com/users/3735873/tonypdmtr"}, "edited": false, "score": 1, "creation_date": 1481810433, "post_id": 41150650, "comment_id": 69532354, "body": "Actually, it&#39;s much simpler that this:  You do ADC_VALUE*20/1023 and you get the number (integer part) of blocks to fill using a simple loop.  No need for a long series of IF ... ELSE statements.  (Also, note that you need to divide with 1023, not 1024 if you need to absolutely accurate.  1024 may be close enough and easier to deal with if you want to use shifting instead of division but technically it is not quite right.  To see why, consider the maximum value read from the 10-bit ADC -- 1023 -- which cancels out with the 1023 in the denominator.)"}, {"owner": {"reputation": 196, "user_id": 7246196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PGxLg.png?s=128&g=1", "display_name": "Brandon83", "link": "https://stackoverflow.com/users/7246196/brandon83"}, "reply_to_user": {"reputation": 2832, "user_id": 3735873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K93GY.jpg?s=128&g=1", "display_name": "tonypdmtr", "link": "https://stackoverflow.com/users/3735873/tonypdmtr"}, "edited": false, "score": 0, "creation_date": 1481812886, "post_id": 41150650, "comment_id": 69534049, "body": "I agree with the formula provided and the for loop implementation.  But you have to remember that a 10-bit ADC provides 1024 values (0 to 1023).  This is why I have (1024 / 20) in my post to account for the zero&#39;ith value.  The values need to be bucketized into 20 equal segments.  I do like your approach much better!"}], "tags": [], "owner": {"reputation": 196, "user_id": 7246196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PGxLg.png?s=128&g=1", "display_name": "Brandon83", "link": "https://stackoverflow.com/users/7246196/brandon83"}, "is_accepted": false, "score": 0, "last_activity_date": 1481745564, "last_edit_date": 1481745564, "creation_date": 1481743741, "answer_id": 41150650, "question_id": 41149621, "link": "https://stackoverflow.com/questions/41149621/scaling-down-a-range-of-numbers-in-c/41150650#41150650", "title": "Scaling down a range of numbers in C", "body": "<p>All you need to do is take the full range of the ADC and divide it by the number of LCD Characters (1024 / 20 = 51.2).  Round the value up to 52 to include all possible values in the ADC Range.  This means you have 20 available LCD characters to display a full range of 0 - 1023.  Each LCD character will represent 0 to 52 ADC Counts (except the last one due to rounding).</p>\n\n<p><strong>Pseudo Code:</strong></p>\n\n<ul>\n<li>First, clear the display for a new update.</li>\n<li>Check if ADC Counts >= 0 and ADC Counts &lt;= 51: Turn 'ON' LCD Block 0.</li>\n<li>Else if ADC Counts >= 52 and ADC Counts &lt;=103: Turn 'ON' LCD Block 0 &amp; 1.</li>\n<li>Else if ADC Counts >=104 and ADC Counts &lt;=155: Turn 'ON' LCD Block 0 &amp; 1 &amp; 2.</li>\n</ul>\n\n<p>You would do this sort of pattern for all of the remaining 17 entries.</p>\n\n<p>Cheers!</p>\n"}, {"comments": [{"owner": {"reputation": 2832, "user_id": 3735873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K93GY.jpg?s=128&g=1", "display_name": "tonypdmtr", "link": "https://stackoverflow.com/users/3735873/tonypdmtr"}, "edited": false, "score": 0, "creation_date": 1481809873, "post_id": 41152591, "comment_id": 69531959, "body": "And, in general, you should always reduce your constant ratios to avoid unnecessary overflows during multiplication.  So, 2000/5115 =&gt; 400/1023."}], "tags": [], "owner": {"reputation": 130, "user_id": 4191106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c34ea41ace8b660de1e3df27c37b870?s=128&d=identicon&r=PG&f=1", "display_name": "Mazi", "link": "https://stackoverflow.com/users/4191106/mazi"}, "is_accepted": false, "score": 1, "last_activity_date": 1481751292, "creation_date": 1481751292, "answer_id": 41152591, "question_id": 41149621, "link": "https://stackoverflow.com/questions/41149621/scaling-down-a-range-of-numbers-in-c/41152591#41152591", "title": "Scaling down a range of numbers in C", "body": "<p>Your calculation has mistake</p>\n\n<pre><code> BarGraph = ((DELVAL2/5115)*2000);\n</code></pre>\n\n<p>DELVAL2 is 0-1023. You divide it by 5115, so you get value between 0 and 1. It's probably casted to 0. 0 Mutliplied by 2000 is still 0.</p>\n\n<p>Try first multiply, then divide:</p>\n\n<pre><code>BarGraph = (DELVAL2*2000/5115);\n</code></pre>\n\n<p>Also for printing </p>\n\n<pre><code> sprintf(buf, \"*\", BarGraph); \n</code></pre>\n\n<p>will not work. Refer to sprintf function or simple use loop for putting symbol in buf array.</p>\n"}], "owner": {"reputation": 35, "user_id": 5558046, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/281d26d9ceea9c35d15338736b6f7827?s=128&d=identicon&r=PG&f=1", "display_name": "user_1", "link": "https://stackoverflow.com/users/5558046/user-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481751292, "creation_date": 1481740175, "question_id": 41149621, "link": "https://stackoverflow.com/questions/41149621/scaling-down-a-range-of-numbers-in-c", "title": "Scaling down a range of numbers in C", "body": "<p>I am reading values from a potentiometer that I can rotate to produce a range of numbers from 0-1023.  I want to be able to display these numbers in terms of a horizontal bar graph on an LCD screen.  The LCD screen is 20 blocks wide so the 0-1023 must be scaled down to 0-20.  The character I want to use to produce the bar graph is a block that fills one entire block out of the 20 available.  The bit pattern for this block is <code>0b11110001</code>.</p>\n\n<pre><code>   block = 0b11110001; \n   BarGraph = ((DELVAL2/5115)*2000);\n\n   lcd_putxy(2,0,buf);\n   for (delay = 0; delay &lt; 50000; delay++);      // introduce a delay \n\n   sprintf(buf, \"*\", BarGraph); \n   lcd_putxy(2,0,buf);\n</code></pre>\n\n<p>I was hoping somebody could explain to me how to achieve this and the best method for scaling down my potentiometer values.  </p>\n"}, {"tags": ["c++", "c", "recursion", "fibonacci"], "comments": [{"owner": {"reputation": 2289, "user_id": 2356414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff4a2241e2dcfc50615e4b7c709bd17?s=128&d=identicon&r=PG", "display_name": "KABoissonneault", "link": "https://stackoverflow.com/users/2356414/kaboissonneault"}, "edited": false, "score": 2, "creation_date": 1481740010, "post_id": 41149449, "comment_id": 69501477, "body": "You have made an &quot;optimization&quot; where <code>fib(1)</code> does not call <code>fib(0)</code> to get its result - it returns <code>1</code> directly. Only <code>fib(2)</code> will call it. Therefore <code>fib(0)</code> is not called as often as it should. Also, I don&#39;t understand your first question"}], "answers": [{"tags": [], "owner": {"reputation": 38726, "user_id": 301883, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/937b36681a56def2b41c438a00e12b46?s=128&d=identicon&r=PG", "display_name": "Edward Strange", "link": "https://stackoverflow.com/users/301883/edward-strange"}, "is_accepted": true, "score": 5, "last_activity_date": 1481740457, "last_edit_date": 1481740457, "creation_date": 1481739985, "answer_id": 41149568, "question_id": 41149449, "link": "https://stackoverflow.com/questions/41149449/computing-the-number-of-times-fibn-is-called-for-each-n/41149568#41149568", "title": "Computing the number of times fib(n) is called FOR EACH n", "body": "<p>Because <code>count[1]</code> is going to be called for each <code>count[2] + count[3]</code> but <code>count[0]</code> is only going to be called for <code>count[2]</code>...<code>count[1]</code> doesn't contribute because it's a terminus.</p>\n\n<p>As for mathematical formula:</p>\n\n<pre><code>if n == 0: fib(N - 1)\nelse: fib(N-(n-1))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1481741326, "last_edit_date": 1481741326, "creation_date": 1481741014, "answer_id": 41149872, "question_id": 41149449, "link": "https://stackoverflow.com/questions/41149449/computing-the-number-of-times-fibn-is-called-for-each-n/41149872#41149872", "title": "Computing the number of times fib(n) is called FOR EACH n", "body": "<p>As for calculation </p>\n\n<pre><code>call(n)=call(n-1)+call(n-2)+1\n  call(1)=1\n  call(0)=1\n</code></pre>\n\n<p>Hope this make things clear. </p>\n\n<pre><code>n  | calls\n---+--------\n0  |   1\n1  |   1\n2  |   3 \n3  |   5  f(3)= f(2)[= f(1)+ f(0)]+ f(1)\n5  |   9  \n.\nfib(n)    2*fib(n)-1\n</code></pre>\n"}], "owner": {"reputation": 589, "user_id": 4882506, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62d78be71d1cc3e8a2bd98b88daeba05?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Tarng", "link": "https://stackoverflow.com/users/4882506/tony-tarng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 41149568, "answer_count": 2, "score": 1, "last_activity_date": 1481741326, "creation_date": 1481739640, "question_id": 41149449, "link": "https://stackoverflow.com/questions/41149449/computing-the-number-of-times-fibn-is-called-for-each-n", "title": "Computing the number of times fib(n) is called FOR EACH n", "body": "<p>I want to compute the number of times fib(n) is called FOR EACH n. I have written the code as below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define N 10\n\nint count[N + 1]; // count[n] keeps track of the number of times each fib(n) is called\n\nint fib(int n) {\n    count[n]++;\n\n    if(n &lt;= 1)\n        return n;\n    else\n        return fib(n - 1) + fib(n - 2);\n}\n\nint main() {\n    for(int i = 0; i &lt;= N; i++) {\n        count[i] = 0; // initialize count to 0\n    }\n    fib(N);\n\n    // print values of count[]\n    for(int i = 0; i &lt;= N; i++) {\n        printf(\"count[%d] = %d\", i, count[i]);\n    }\n}\n</code></pre>\n\n<p>I have tried printing the array count[] to get the result, where the result is resembles the fibonacci numbers except for count[0]:</p>\n\n<blockquote>\n  <p>count[0] = 34 count[1] = 55 count[2] = 34 count[3] = 21 count[4] = 13\n  count[5] = 8 count[6] = 5 count[7] = 3 count[8] = 2 count[9] = 1\n  count[10] = 1</p>\n</blockquote>\n\n<p><strong>Is there a way to mathematically show this result, maybe a recursive formula? Also, why doesn't count[0], or rather fib(0), doesn't continue the fibonacci sequence?</strong> Thanks.</p>\n"}, {"tags": ["c", "wireshark", "wireshark-dissector"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4553607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09c9c8f07f33c2ce6ff6c2cbab705431?s=128&d=identicon&r=PG&f=1", "display_name": "Rash123", "link": "https://stackoverflow.com/users/4553607/rash123"}, "is_accepted": true, "score": 0, "last_activity_date": 1482951065, "creation_date": 1482951065, "answer_id": 41368029, "question_id": 41149262, "link": "https://stackoverflow.com/questions/41149262/wireshark-dissector-with-pcapng-format-file-access-section-interface-descripti/41368029#41368029", "title": "Wireshark dissector with pcapng format file - access section/interface description fields", "body": "<p>Got the answer from wireshark forum : <a href=\"https://ask.wireshark.org/questions/58090/wireshark-dissector-with-pcapng-format-file-access-sectioninterface-description-fields\" rel=\"nofollow noreferrer\">https://ask.wireshark.org/questions/58090/wireshark-dissector-with-pcapng-format-file-access-sectioninterface-description-fields</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4553607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09c9c8f07f33c2ce6ff6c2cbab705431?s=128&d=identicon&r=PG&f=1", "display_name": "Rash123", "link": "https://stackoverflow.com/users/4553607/rash123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 41368029, "answer_count": 1, "score": 0, "last_activity_date": 1482951065, "creation_date": 1481738884, "question_id": 41149262, "link": "https://stackoverflow.com/questions/41149262/wireshark-dissector-with-pcapng-format-file-access-section-interface-descripti", "title": "Wireshark dissector with pcapng format file - access section/interface description fields", "body": "<p>I am writing a custom protocol wireshark dissector in C as a plugin. I have got the dissector working . I am not able to figure out if there is a way to access the information we fill in section header / interface description header from our dissector? There seem to be tvbuff and packet_info passed , which dont have this information.</p>\n\n<p>Is there a way to access these fields?</p>\n"}, {"tags": ["c", "language-lawyer"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 5, "creation_date": 1481738735, "post_id": 41149194, "comment_id": 69500801, "body": "Its constraint violation, not an undefined behavior. Statement <code>return;</code> just return a <code>void</code> type, while <code>main</code> expects its return type to be <code>int</code>."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 2, "creation_date": 1481738790, "post_id": 41149194, "comment_id": 69500828, "body": "And in the case of a constraint violation, the compiler must diagnose (produce a message) for it. If the compiler then proceeds to produce output anyway, the standard has nothing to say about what the output program does, as far as I can tell."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1481738806, "post_id": 41149194, "comment_id": 69500838, "body": "@haccks Right sir, that is why I also referred to chapter 4, where exactly i&#39;m puzzled."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481739370, "post_id": 41149194, "comment_id": 69501133, "body": "I tend to close this as being a duplicate to the referenced question ..."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481739560, "post_id": 41149194, "comment_id": 69501219, "body": "@alk emm.. why is that sir? I&#39;m not asking the same, all I&#39;m looking for an alternate wordings for the quoted spec in my answer to either validate or invalidate my answer under the other question, that&#39;s all. If I can improve this question in any way, please let me know."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1481739711, "post_id": 41149194, "comment_id": 69501314, "body": "OK, I have updated my answer in the other thread using the comments provided here (thanks to haccks and @R.. for that). A quick review, anyone?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1481739942, "post_id": 41149194, "comment_id": 69501448, "body": "@SouravGhosh; I would say that it would be better if you seek help from <a href=\"http://stackoverflow.com/users/827263/keith-thompson\">Keith Thompson</a> in this matter. He could help better."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1481740084, "post_id": 41149194, "comment_id": 69501517, "body": "@haccks I&#39;d try to get in touch with him via chat, thanks."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1481748028, "post_id": 41149194, "comment_id": 69505694, "body": "The <a href=\"http://stackoverflow.com/a/41149104/2173917\">other answer</a>, saying it&#39;s not UB, was deleted by its owner."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1481750004, "post_id": 41149194, "comment_id": 69506733, "body": "I think the context and the title could get a different answer: Title: definitive &quot;NO, not UB&quot;. Context: I&#39;m guessing UB, as with KeithThompson."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1481763925, "post_id": 41149194, "comment_id": 69511475, "body": "I was seriously tempted to post two answers, one &quot;Yes&quot; and one &quot;No&quot;, with a lengthy explanation for each."}], "answers": [{"comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 1, "creation_date": 1481749790, "post_id": 41152077, "comment_id": 69506627, "body": "Regarding the constraint violation and undefined behavior, I&#39;d like to bring this quote to your attention: &quot;If a \u2018\u2018shall\u2019\u2019 or \u2018\u2018shall not\u2019\u2019 requirement that appears <b>outside of a constraint</b> or runtime constraint is violated, the behavior is undefined. [..]&quot; (&#167; 4/2 N1570) From that I&#39;d say a constraint violation is not UB. But continuing the quote: &quot;[..] Undefined behavior is otherwise indicated in this International Standard by the words \u2018\u2018undefined behavior\u2019\u2019 or by <b>the omission of any explicit definition of behavior</b>&quot;. Thus I&#39;d say that <code>return;</code> is UB."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1481749891, "post_id": 41152077, "comment_id": 69506672, "body": "@DanielJour: I think I agree with your conclusion, but I&#39;m not 100% sure. As I said in my answer, the standard <i>does</i> define the behavior of <code>return;</code>. The question is whether that definition still applies when the <code>return;</code> is in a non-<code>void</code> function. I believe the Standard is ambiguous on this point."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1481791780, "post_id": 41152077, "comment_id": 69520791, "body": "I am also not sure that a constraint violation is always UB, but in this particular case I would say (contradicting my comment on OP&#39;s post) that the <i>shall</i> in  <i>A return statement without an expression <b>shall</b> only appear in a function whose return type is void.</i>, makes the behavior undefined. As standard says: <i>If a <b>\u2018\u2018shall\u2019\u2019</b> or \u2018\u2018shall not\u2019\u2019 requirement that appears <b>outside of a constraint</b> or runtime constraint is violated, the behavior is undefined.</i>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1481793621, "post_id": 41152077, "comment_id": 69521821, "body": "@haccks: That <b>shall</b> is in a constraint."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1481794986, "post_id": 41152077, "comment_id": 69522738, "body": "@KeithThompson; To me it seems out of constraint."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1481820985, "post_id": 41152077, "comment_id": 69539222, "body": "@haccks: <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> 6.8.6.4. The &quot;shall&quot;s in question are in paragraph 1, which is directly under a &quot;Constraints&quot; header. The &quot;Semantics&quot; section starts with paragraph 2."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1481821964, "post_id": 41152077, "comment_id": 69539798, "body": "@KeithThompson; Since <code>return;</code> statement appeared in a function (<code>main</code>) whose return type is <code>int</code> and not <code>void</code>, the &quot;shall&quot; requirement appears to be outside of the constraint."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 2, "creation_date": 1481829581, "post_id": 41152077, "comment_id": 69543833, "body": "@haccks: I&#39;m starting to wonder if we&#39;re looking at the same document. The <code>return</code> statement is specified in N1570 6.8.6.4. There are exactly two occurrences of the word <b>shall</b> in that subsection. Both are in paragraph 1, which is the entirety of the <b>Constraints</b> section. How is that outside of the constraint?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1485295327, "post_id": 41152077, "comment_id": 70864752, "body": "@KeithThompson; I think I misunderstood it. But I am still not sure when constraint violation invoke UB and when not."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 2, "creation_date": 1485295544, "post_id": 41152077, "comment_id": 70864845, "body": "@haccks: A constraint violation permits the compiler to reject the program altogether. In that case, there is no behavior, defined or otherwise. But if an implementation diagnoses a constraint violation with a non-fatal warning and then generates an executable, it&#39;s not clear whether the behavior is necessarily undefined. I think the standard is unclear on this point. If the standard doesn&#39;t define the behavior, then the behavior is undefined."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1485295641, "post_id": 41152077, "comment_id": 70864894, "body": "In other cases .. well, the definition of a &quot;constraint&quot; is a &quot;restriction, either syntactic or semantic, by which the exposition of language elements is to be interpreted&quot;. If a constraint is violated, one could argue that there is no way to interpret the language elements. (I personally think that the standard <i>should</i> say that the behavior is undefined if a constraint is violated, but I&#39;m not sure that it actually does.)"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1485329628, "post_id": 41152077, "comment_id": 70875824, "body": "@KeithThompson; Hope next revision of C standard will look into this issue."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 8, "last_activity_date": 1487613208, "last_edit_date": 1487613208, "creation_date": 1481749220, "answer_id": 41152077, "question_id": 41149194, "link": "https://stackoverflow.com/questions/41149194/is-running-a-binary-generated-from-a-code-with-constraint-violation-actually-u/41152077#41152077", "title": "Is running a binary generated from a code with &quot;constraint violation&quot; actually undefined behaviour?", "body": "<p>Let's assume this context:</p>\n\n<pre><code>int main(void) {\n    return;\n}\n</code></pre>\n\n<p>and a hosted implementation.</p>\n\n<p>Note that <code>void main()</code> is not strictly forbidden (an implementation is permitted to permit it), and <code>return;</code> would be perfectly valid within such a definition of <code>main</code>.</p>\n\n<p>First off, this <code>return;</code> is clearly a constraint violation.  It violates <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> 6.8.6.4p1:</p>\n\n<blockquote>\n  <p>A <strong><code>return</code></strong> statement without an expression shall only appear in a function whose return type is <strong><code>void</code></strong>.</p>\n</blockquote>\n\n<p>(It was not a constraint violation in C90; that was changed in C99.)</p>\n\n<p>The standard requires a compiler to issue at least one diagnostic for any program containing a violation of a constraint or syntax rule.  Once it's done so, it can then proceed to generate an executable (if the diagnostic is a non-fatal warning).</p>\n\n<p>It's not clear whether there's a general rule that programs with constraint violations have undefined behavior. The standard doesn't say so explicitly. It defines a \"constraint\" as a</p>\n\n<blockquote>\n  <p>restriction, either syntactic or semantic, by which the exposition of language elements is to be interpreted</p>\n</blockquote>\n\n<p>My own interpretation is that if a constraint is violated, there is no valid interpretation, and thus the behavior is undefined, but there are some who disagree. I'd like to see an explicit statement to this effect in a future standard.</p>\n\n<p>I believe the wording of the C Standard is genuinely ambiguous on this point.</p>\n\n<p>Without such a general rule, it's not clear that the behavior is undefined. After stating the constraint that this code violates, the standard goes on to define the semantics of the <code>return</code> statement:</p>\n\n<blockquote>\n  <p>A <strong><code>return</code></strong> statement terminates execution of the current function\n  and returns control to its caller.</p>\n</blockquote>\n\n<p>That description could still make sense even in the presence of this constraint violation. It's reasonable to assume, though it's not quite stated, that <code>return;</code> is equivalent to reaching the closing <code>}</code>, which is equivalent to <code>return 0;</code> (this is a special-case rule for <code>main</code>; N1570 5.1.2.2.3).</p>\n\n<p>On the other hand, it's not 100% clear that the description is unambiguous. The argument that <code>return;</code> is equivalent to reaching the closing <code>}</code> is particularly weak. So even in the absence of a general rule, one could argue that the behavior is undefined by omission (there's no definition of the behavior).</p>\n\n<p>The <code>return;</code> is clearly a constraint violation, and <em>in my opinion</em> it has undefined behavior if the implementation produces an executable. Of course a conforming compiler is also permitted to reject the program altogether; in that case, it has no behavior at all.</p>\n\n<p>Bottom line: It's much <em>much</em> <strong><em>much</em></strong> easier to change the <code>return;</code> to <code>return 0;</code> than to answer this question.</p>\n\n<p>I encourage other language lawyers to refute this answer. I've made enough internally inconsistent arguments here that it shouldn't be too difficult.</p>\n"}, {"tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": false, "score": 1, "last_activity_date": 1481750609, "creation_date": 1481750609, "answer_id": 41152425, "question_id": 41149194, "link": "https://stackoverflow.com/questions/41149194/is-running-a-binary-generated-from-a-code-with-constraint-violation-actually-u/41152425#41152425", "title": "Is running a binary generated from a code with &quot;constraint violation&quot; actually undefined behaviour?", "body": "<p>Answering the title:</p>\n\n<blockquote>\n  <p>Is running a binary generated from a code with \u201cconstraint violation\u201d actually undefined behaviour?</p>\n</blockquote>\n\n<p>I say <strong>no</strong> because of the definition of undefined behaviour in the standard, emphasis mine:</p>\n\n<blockquote>\n  <p>If a \u2018\u2018shall\u2019\u2019 or \u2018\u2018shall not\u2019\u2019 requirement that appears <strong>outside of a\n  constraint</strong> or runtime constraint is violated, the behavior is undefined.\n  Undefined behavior <strong>is otherwise indicated</strong> in this International Standard\n  by the words \u2018\u2018undefined behavior\u2019\u2019 or by the omission of any explicit\n  definition of behavior. There is no difference in emphasis among\n  these three; they all describe \u2018\u2018behavior that is undefined\u2019\u2019</p>\n  \n  <p>\u00a7 4/2</p>\n</blockquote>\n\n<p>Assuming that violating a constraint means breaking a \"shall\" or \"shall not\" requirement that is <em>inside</em> a section marked as \"constraint\" and it is not otherwise indicated that the violation leads to UB.</p>\n\n<p>As per the context case I agree with Keith Thompson's answer.</p>\n"}, {"comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1481751837, "post_id": 41152650, "comment_id": 69507565, "body": "Hmm, you mean that &quot;or&quot; part of the quote in my answer?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1481752312, "post_id": 41152650, "comment_id": 69507765, "body": "I like your conclusion, and it&#39;s plausible that that&#39;s the intent, but I&#39;m not convinced it follows from the wording of the standard. Consider <code>void *ptr; ptr = 42;</code>. This clearly violates a constraint (N1570 6.5.16.1p1) -- but the standard then goes on to define the behavior in p2: &quot;the value of the right operand is converted to the type of the assignment expression&quot;."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1481753938, "post_id": 41152650, "comment_id": 69508407, "body": "@KeithThompson I&#39;d argue that the &quot;Semantics&quot; section can only applies to code that complied with the &quot;Constraints&quot;. In plenty of other cases the Semantics don&#39;t even make sense for code that didn&#39;t comply with the constraints, e.g. <code>++1;</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1481754209, "post_id": 41152650, "comment_id": 69508520, "body": "@M.M: Again, I <i>like</i> that argument, but I can&#39;t derive it from the wording of the standard."}, {"owner": {"reputation": 474, "user_id": 1949418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xh4sK.jpg?s=128&g=1", "display_name": "jinawee", "link": "https://stackoverflow.com/users/1949418/jinawee"}, "edited": false, "score": 0, "creation_date": 1547056822, "post_id": 41152650, "comment_id": 95064502, "body": "Then why does ISO/IEC 9899:1999 say <i>If a \u2018\u2018shall\u2019\u2019 or \u2018\u2018shall not\u2019\u2019 requirement that appears outside of a constraint is violated, the behavior is undefined</i> instead of <i>If a \u2018\u2018shall\u2019\u2019 or \u2018\u2018shall not\u2019\u2019 requirement, the behavior is undefined</i>? It doesn&#39;t contradict your statement, but if constraint violations were UB, the standard is wasting words."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1481751520, "creation_date": 1481751520, "answer_id": 41152650, "question_id": 41149194, "link": "https://stackoverflow.com/questions/41149194/is-running-a-binary-generated-from-a-code-with-constraint-violation-actually-u/41152650#41152650", "title": "Is running a binary generated from a code with &quot;constraint violation&quot; actually undefined behaviour?", "body": "<p>The standard doesn't define the behaviour of code containing a constraint violation. Therefore the behaviour is undefined.</p>\n\n<p>Saying that code containing a constraint violation is well-defined is tantamount to saying that all constraints in the Standard can be ignored, which is absurd.</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 0, "last_activity_date": 1487615799, "creation_date": 1487615799, "answer_id": 42351966, "question_id": 41149194, "link": "https://stackoverflow.com/questions/41149194/is-running-a-binary-generated-from-a-code-with-constraint-violation-actually-u/42351966#42351966", "title": "Is running a binary generated from a code with &quot;constraint violation&quot; actually undefined behaviour?", "body": "<p>As a real-world scenario where a program with a constraint violation could cause\nUndefined Behavior, consider a build system which doesn't erase output files\nunless/until it has something to replace them with.  When fed a valid program\nit creates an executable file with a certain name, and when fed an invalid\nprogram it leaves the old file unmodified.  Since the source text that were used to generate the leftover executable may bear no relation to the current source text, the behavior of the executable may be arbitrarily different from anything that's in the current source file.</p>\n\n<p>Ideally an implementation would try to prevent accidental execution of such left-over code, but if a C compiler is just a small portion of a larger build system the compiler might not have control over such issues, and I doubt that the authors of the Standard wanted to say that build systems that didn't let a compiler delete or invalidate an executable (that it might know nothing about) should be unable to host conforming C implementations.</p>\n"}], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 41152077, "answer_count": 4, "score": 4, "last_activity_date": 1487615799, "creation_date": 1481738549, "last_edit_date": 1495540400, "question_id": 41149194, "link": "https://stackoverflow.com/questions/41149194/is-running-a-binary-generated-from-a-code-with-constraint-violation-actually-u", "title": "Is running a binary generated from a code with &quot;constraint violation&quot; actually undefined behaviour?", "body": "<p>Reference: <a href=\"https://stackoverflow.com/q/41148654/2173917\">This question</a></p>\n\n<p>Context: A <code>return</code> statement at the end of <code>main()</code> with no expression, like</p>\n\n<pre><code> return;\n</code></pre>\n\n<p>As I read the standard, it appears to be  <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> and so I wrote <a href=\"https://stackoverflow.com/a/41148748/2173917\">an answer</a>.</p>\n\n<p>However, <a href=\"https://stackoverflow.com/a/41149104/2173917\">another answer</a> says, it's not UB.</p>\n\n<p>Where did I go wrong reading or understanding the standard <em>language</em>?</p>\n\n<hr>\n\n<p><sup> Note: I have seen <a href=\"https://groups.google.com/forum/#!topic/comp.std.c/WNVXRSCqrGU\" rel=\"nofollow noreferrer\">this thread</a> already, but I cannot conclude.</sup></p>\n"}, {"tags": ["c", "stdin"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481739709, "post_id": 41149185, "comment_id": 69501313, "body": "And the question is? BTW, is your <code>.</code> key broken?"}, {"owner": {"reputation": 999, "user_id": 759468, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iFYiM.jpg?s=128&g=1", "display_name": "mardon", "link": "https://stackoverflow.com/users/759468/mardon"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481740783, "post_id": 41149185, "comment_id": 69501854, "body": "yes this code print NOT OK even if the first character in contetn is &#39;+&#39;"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481741106, "post_id": 41149185, "comment_id": 69502021, "body": "OT: Can you make sure that no input line is longer then 1023 <code>char</code>s?"}, {"owner": {"reputation": 999, "user_id": 759468, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iFYiM.jpg?s=128&g=1", "display_name": "mardon", "link": "https://stackoverflow.com/users/759468/mardon"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481741161, "post_id": 41149185, "comment_id": 69502052, "body": "not i am not sure, maybe the all code is bad"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1481741239, "post_id": 41149185, "comment_id": 69502091, "body": "You want to handle reading input and interpreting input separately."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481741266, "post_id": 41149185, "comment_id": 69502103, "body": "1st read until you have new-line, then parse its content."}, {"owner": {"reputation": 999, "user_id": 759468, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iFYiM.jpg?s=128&g=1", "display_name": "mardon", "link": "https://stackoverflow.com/users/759468/mardon"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481741507, "post_id": 41149185, "comment_id": 69502267, "body": "using fgets? But I must input until eof"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481743268, "post_id": 41149185, "comment_id": 69503210, "body": "To read a <i>line</i>, reading should stop if 1) <code>&#39;\\n&#39;</code> is read, 2) End-of-file occurs, or 3) Input error occurs.  This code is missing #1 if the line is longer than 1023.  Is that your intent?"}], "answers": [{"comments": [{"owner": {"reputation": 999, "user_id": 759468, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iFYiM.jpg?s=128&g=1", "display_name": "mardon", "link": "https://stackoverflow.com/users/759468/mardon"}, "edited": false, "score": 0, "creation_date": 1481740552, "post_id": 41149654, "comment_id": 69501733, "body": "i comment the line <code>content[0] = &#39;\\0&#39;;</code> either thi script pritn after any input line NOT OK even if first charcter is +"}, {"owner": {"reputation": 406, "user_id": 6422468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8622bb1b203d0548d5938c30588f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Hardik Sanghvi", "link": "https://stackoverflow.com/users/6422468/hardik-sanghvi"}, "reply_to_user": {"reputation": 999, "user_id": 759468, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iFYiM.jpg?s=128&g=1", "display_name": "mardon", "link": "https://stackoverflow.com/users/759468/mardon"}, "edited": false, "score": 0, "creation_date": 1481741606, "post_id": 41149654, "comment_id": 69502322, "body": "sorry no need to comment this. I have edited my comment. Execute and confirm this"}], "tags": [], "owner": {"reputation": 406, "user_id": 6422468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8622bb1b203d0548d5938c30588f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Hardik Sanghvi", "link": "https://stackoverflow.com/users/6422468/hardik-sanghvi"}, "is_accepted": true, "score": 1, "last_activity_date": 1481777115, "last_edit_date": 1481777115, "creation_date": 1481740288, "answer_id": 41149654, "question_id": 41149185, "link": "https://stackoverflow.com/questions/41149185/read-line-from-stdin-until-eof-and-print-the-text-after-test-for-first-character/41149654#41149654", "title": "Read line from stdin until EOF and print the text after test for first character", "body": "<p>You are concatenating the buffer to the content </p>\n\n<pre><code>strcat(content, buffer);\n</code></pre>\n\n<p>So for the 1st input , suppose \"abc\" <code>content</code> will be <strong>abc</strong> and it will print NOT OK . \nFor the 2nd input, suppose \"+xyz\" <code>content</code> will be <strong>abc+xyz</strong> so the value of <code>content[0]</code> will always be <strong>\"a\"</strong> and hence it will always print NOT OK.</p>\n\n<p>Similarly if your 1st input is \"+abc\" , then it will always print OK for all the inputs.</p>\n\n<p>Use strcpy instead of strcat</p>\n\n<pre><code>strcpy(content, buffer);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 999, "user_id": 759468, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iFYiM.jpg?s=128&g=1", "display_name": "mardon", "link": "https://stackoverflow.com/users/759468/mardon"}, "edited": false, "score": 0, "creation_date": 1481788199, "post_id": 41150890, "comment_id": 69518975, "body": "I try this but even line has first letter + the NOT OK is printing and when input line is under 10 char i obtain error in realloc"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1481814832, "last_edit_date": 1495542633, "creation_date": 1481744624, "answer_id": 41150890, "question_id": 41149185, "link": "https://stackoverflow.com/questions/41149185/read-line-from-stdin-until-eof-and-print-the-text-after-test-for-first-character/41150890#41150890", "title": "Read line from stdin until EOF and print the text after test for first character", "body": "<p>To read a <em>line</em> via <code>fgets()</code>, better to handle this as a stand-alone function <a href=\"https://stackoverflow.com/questions/41149185/read-line-from-stdin-until-eof-and-print-the-text-after-test-for-first-string#comment69502091_41149185\">@alk</a></p>\n\n<p>Following suggested code is similar to OP's.  A key difference is testing if <code>fgets(buffer)</code> read a <code>'\\n'</code>.</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#define BUF_SIZE 10\n\nchar *readline_mardon(void) {\n  char buffer[BUF_SIZE];\n  size_t contentSize = 1;\n  char *content = malloc(contentSize);\n  if (content == NULL) {\n    perror(\"Failed to allocate content\");\n    exit(1);\n  }\n  content[0] = '\\0'; // make null-terminated\n  while (fgets(buffer, sizeof buffer, stdin)) {\n    size_t buffer_length = strlen(buffer);\n\n    // more idiomatic code\n    // Assign `content` after successful allocation detected\n    size_t contentSize_new = contentSize + buffer_length;\n    printf(\"%zu &lt;%s&gt;\\n\", buffer_length, buffer);\n    char *content_new = realloc(content, contentSize_new);\n    if (content_new == NULL) {\n      perror(\"Failed to reallocate content\");\n      free(content);\n      exit(2);\n    }\n\n    // memcpy faster than strcat as the end of the first part is known\n    memcpy(content_new + contentSize - 1, buffer, buffer_length + 1);\n\n    content = content_new;\n    contentSize = contentSize_new;\n\n    // look for \\n\n    if (buffer_length &gt; 0 &amp;&amp; buffer[buffer_length - 1] == '\\n') {\n      break;\n    }\n  }\n  return content;\n}\n</code></pre>\n\n<p>Usage</p>\n\n<pre><code>char *s;\nwhile((s = readline_mardon()) != NULL) {\n  if (s[0]== '+')  {\n    printf(\"OK\\n\");\n  } else {\n    printf(\"NOT OK\\n\");\n  }\n  free(s);\n}\n</code></pre>\n\n<p>Additional code could return <code>NULL</code> if <em>nothing</em> was read or an input error occurred.</p>\n"}], "owner": {"reputation": 999, "user_id": 759468, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iFYiM.jpg?s=128&g=1", "display_name": "mardon", "link": "https://stackoverflow.com/users/759468/mardon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1822, "favorite_count": 0, "accepted_answer_id": 41149654, "answer_count": 2, "score": -2, "last_activity_date": 1481814832, "creation_date": 1481738534, "last_edit_date": 1481756048, "question_id": 41149185, "link": "https://stackoverflow.com/questions/41149185/read-line-from-stdin-until-eof-and-print-the-text-after-test-for-first-character", "title": "Read line from stdin until EOF and print the text after test for first character", "body": "<p><strike>I wanr interactive</strike>(I want to) read a line from standard input until EOF but after each line I want to print if the line first character is <code>'+'</code> then print <code>\"OK\"</code> else print <code>\"NOT OK\"</code>.  I tried this code but this prints <code>\"NOT OK\"</code> even if the line I input has a first character equal to <code>'+'</code>.</p>\n\n<pre><code>int main()\n{\n    #define BUF_SIZE 1024\n    char buffer[BUF_SIZE];\n    size_t contentSize = 1;\n    /* Preallocate space.  We could just allocate one char here,\n    but that wouldn't be efficient. */\n    char *content = malloc(sizeof(char) * BUF_SIZE);\n    if(content == NULL)\n    {\n        perror(\"Failed to allocate content\");\n        exit(1);\n    }\n    content[0] = '\\0'; // make null-terminated\n    while(fgets(buffer, BUF_SIZE, stdin))\n    {\n        char *old = content;\n        contentSize += strlen(buffer);\n        content = realloc(content, contentSize);\n        if(content == NULL)\n        {\n            perror(\"Failed to reallocate content\");\n            free(old);\n            exit(2);\n        }\n        strcat(content, buffer);\n        if (content[0]== '+')  {\n            printf(\"OK\\n\");\n        } else {\n            printf(\"NOT OK\\n\");\n        }\n    }\n\n    if(ferror(stdin))\n    {\n        free(content);\n        perror(\"Error reading from stdin.\");\n        exit(3);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "char", "tolower"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1481737787, "post_id": 41148978, "comment_id": 69500333, "body": "<code>void main()</code> --&gt; <code>int main(void)</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1481738144, "post_id": 41148978, "comment_id": 69500519, "body": "<code>tolower()</code> is applied to a single letter, not a word. You could try <code>strlwr()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1481744323, "post_id": 41149086, "comment_id": 69503737, "body": "IMO, it&#39;s best not to use <code>i &lt; strlen(upperString)</code> in a <code>for</code> loop condition; there&#39;s no guarantee that the compiler will optimize the call to <code>strlen()</code>.  It might do so in this case, but be very careful.  If the compiler can&#39;t tell whether the body of the function could change the length of the string, it can&#39;t do the optimization, and that converts a linear algorithm into a quadratic one."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1481744427, "post_id": 41149086, "comment_id": 69503788, "body": "@JonathanLeffler Yes, I agree. I know it&#39;d be better practice to write <code>int s = strlen(upperString);</code> and then <code>for (i = 0; i &lt; s; i++)</code>, but I was going for simplicity instead of efficiency."}], "tags": [], "owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "is_accepted": false, "score": 0, "last_activity_date": 1481790933, "last_edit_date": 1481790933, "creation_date": 1481738159, "answer_id": 41149086, "question_id": 41148978, "link": "https://stackoverflow.com/questions/41148978/how-to-use-tolower-with-char/41149086#41149086", "title": "How to use tolower() with char*?", "body": "<p>Since you asked about <code>tolower</code>, you could try looping through a string character by character:</p>\n\n<pre><code>int i, s = strlen(upperString);\nfor (i = 0; i &lt; s; i++)\n    lowerString[i] = tolower(upperString[i]);\n</code></pre>\n\n<p>If you <em>don't</em> need to use <code>tolower</code>, you can use <code>strlwr</code> to convert an entire string to lowercase (if it's implemented on your system - <code>strlwr</code> isn't standard C).</p>\n"}, {"comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 2, "creation_date": 1481738515, "post_id": 41149146, "comment_id": 69500686, "body": "<code>strlwr</code> is not standard C."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481738961, "post_id": 41149146, "comment_id": 69500926, "body": "@sameerasy it possibly could have been downvoted because: a) <code>strlwr</code> is not standard C b) your edit has made it the same concept as my answer, which came first c) people don&#39;t like good answers to bad questions. I&#39;m not the downvoter, btw."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1481739094, "post_id": 41149146, "comment_id": 69500990, "body": "<code>strlwr</code> is a bad name for a user function - identifiers beginning with <code>str</code> followed by a lowercase letter are reserved in Standard C."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1481744003, "post_id": 41149146, "comment_id": 69503574, "body": "Now the function is renamed from <code>strlwr()</code> (a name which exists in Microsoft&#39;s libraries, but is not otherwise standardized AFAIK) to <code>cnvtolwr()</code>, is the second sentence &quot;There is a function in <code>&lt;string.h&gt;</code> to convert strings to lower case&quot; still accurate?  I think it needs revising.  If you can provide a URL for <a href=\"https://msdn.microsoft.com/en-us/library/ms235455.aspx\" rel=\"nofollow noreferrer\"><code>strlwr()</code></a> on MSDN, then you can mention it (but note that MS warns about the name when you use it \u2014 it&#39;s a mess!)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481745247, "post_id": 41149146, "comment_id": 69504269, "body": "@TobySpeight &quot;identifiers beginning with <code>str</code> followed by a lowercase letter are reserved in Standard C.&quot; --&gt; Unable to find that in the C spec (especially in &quot;7.1.3 Reserved identifiers&quot;).  Please provide the C spec citation.  Perhaps it is reserved by some other spec per its rules?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1481791164, "post_id": 41149146, "comment_id": 69520460, "body": "@chux It&#39;s mentioned in N1570 &#167;7.31.13 (part of <i>Future library directions</i>)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481814986, "post_id": 41149146, "comment_id": 69535497, "body": "@TobySpeight Thanks, I see many other reserved identifiers there (7.31 Future library directions) too."}], "tags": [], "owner": {"reputation": 1560, "user_id": 4303216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-crjc3oGU_5c/AAAAAAAAAAI/AAAAAAAAADc/BTLu8OHFfRM/photo.jpg?sz=128", "display_name": "sameera sy", "link": "https://stackoverflow.com/users/4303216/sameera-sy"}, "is_accepted": false, "score": 4, "last_activity_date": 1481781366, "last_edit_date": 1481781366, "creation_date": 1481738373, "answer_id": 41149146, "question_id": 41148978, "link": "https://stackoverflow.com/questions/41148978/how-to-use-tolower-with-char/41149146#41149146", "title": "How to use tolower() with char*?", "body": "<p><code>tolower()</code> works only for single characters. You can make use of the below function to convert strings to lower case:</p>\n\n<pre><code>printf(\"%s\\n\", cnvtolwr(mystring));\n</code></pre>\n\n<p>The implementation of the function is as below. </p>\n\n<pre><code>char *cnvtolwr(char *str)\n{\n    unsigned char *mystr = (unsigned char *)str;\n\n    while (*mystr) {\n        *mystr = tolower(*mystr);\n        mystr++;\n    }\n    return str;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 6, "creation_date": 1481744931, "post_id": 41149214, "comment_id": 69504064, "body": "<code>tolower()</code> takes an <code>int</code> in the range of <code>unsigned char</code> or <code>EOF</code>.  Robust code uses <code>*ch = tolower((unsigned char) *ch);</code> to avoid UB."}, {"owner": {"reputation": 365, "user_id": 2593302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe83beb5917d7541b088a20bce08b3?s=128&d=identicon&r=PG&f=1", "display_name": "chad", "link": "https://stackoverflow.com/users/2593302/chad"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1481907513, "post_id": 41149214, "comment_id": 69577996, "body": "You are correct, I hadn&#39;t thought about that. Answer updated."}], "tags": [], "owner": {"reputation": 365, "user_id": 2593302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe83beb5917d7541b088a20bce08b3?s=128&d=identicon&r=PG&f=1", "display_name": "chad", "link": "https://stackoverflow.com/users/2593302/chad"}, "is_accepted": true, "score": 3, "last_activity_date": 1481907544, "last_edit_date": 1481907544, "creation_date": 1481738668, "answer_id": 41149214, "question_id": 41148978, "link": "https://stackoverflow.com/questions/41148978/how-to-use-tolower-with-char/41149214#41149214", "title": "How to use tolower() with char*?", "body": "<p>The <code>tolower</code> function takes a single character and makes it lower case, so calling it on a <code>char*</code> doesn't really make sense. If you know that only the first character of each substring returned by <code>strtok</code> is upper case, you need to call <code>tolower</code> on that character specifically within your loop. In other words, something like this:</p>\n\n<pre><code>while(ptr != NULL)  \n{\n    ptr[0] = tolower((unsigned char) ptr[0]);\n    /* \n    Or equivalently ...\n    *ptr = tolower((unsigned char) *ptr)\n    */\n    words[i]= ptr;\n    i++;\n    ptr = strtok(NULL, \",.; \"); \n}\n</code></pre>\n\n<p>If there are more characters in the string that could be upper case and you want to make sure that they become lower case, you need to iterate through the substring and call <code>tolower</code> on every character:</p>\n\n<pre><code>while(ptr != NULL)  \n{\n    for (char *ch = ptr; *ch; ch++)\n    {\n        *ch = tolower((unsigned char) *ch);\n    }\n    words[i]= ptr;\n    i++;\n    ptr = strtok(NULL, \",.; \"); \n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 6913348, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a90bdae9ea0583a4c75a29b555469ee8?s=128&d=identicon&r=PG&f=1", "display_name": "PoorProgrammer", "link": "https://stackoverflow.com/users/6913348/poorprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9595, "favorite_count": 0, "accepted_answer_id": 41149214, "answer_count": 3, "score": 1, "last_activity_date": 1481907544, "creation_date": 1481737736, "last_edit_date": 1481737930, "question_id": 41148978, "link": "https://stackoverflow.com/questions/41148978/how-to-use-tolower-with-char", "title": "How to use tolower() with char*?", "body": "<p>I have a .txt file with some words and I need them to be lowercase.\nHow to make each word  lowercase? Just adding tolower() to strtok() doesn't work. What should I add? Or maybe it would be easier to use tolower() on whole file firstly? But how? Please help!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n//#include &lt;ctype.h&gt;\n\nint main(void)\n{\n    char str[5000];\n    char *ptr;\n    char *words[5000];\n    FILE * fp = fopen(\"hi.txt\", \"r\");\n    fgets(str, 49, fp);             \n    ptr = strtok(str, \",.; \");         \n    int i = 0;\n    while(ptr != NULL)  \n    {\n        words[i]= ptr;\n        i++;\n        ptr = strtok(NULL, \",.; \"); \n    }\n    fclose(fp);\n\n    for(int j=0;j&lt;i;j++) {\n        printf(\"%s\\n\", words[j]);\n        //printf(\"%s\\n\", tolower(words[j])); // Doesn't work!\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Example:</p>\n\n<p>hi.txt</p>\n\n<pre><code>Foo;\nBar.\nBaz.\n</code></pre>\n\n<p>Expected output</p>\n\n<pre><code>foo\nbar\nbaz\n</code></pre>\n"}, {"tags": ["c", "arrays", "memory", "memory-management"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481737482, "post_id": 41148896, "comment_id": 69500179, "body": "Did you (not) check the return value of <code>malloc()</code>?"}, {"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 1, "creation_date": 1481737836, "post_id": 41148896, "comment_id": 69500356, "body": "Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates the problem. I&#39;d like to see how you passed a <code>Stud*</code> value to a function that takes <code>Stud*[]</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1481738303, "post_id": 41148896, "comment_id": 69500586, "body": "<code>new_student(Stud* students[], ...</code> is equal to <code>new_student(Stud** students, ...</code>. But you want <code>new_student(Stud* students,...</code>. The compiler should have warned you about this."}, {"owner": {"reputation": 31, "user_id": 6227589, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NvGGO.jpg?s=128&g=1", "display_name": "Kan", "link": "https://stackoverflow.com/users/6227589/kan"}, "edited": false, "score": 0, "creation_date": 1481738309, "post_id": 41148896, "comment_id": 69500589, "body": "Ok i must have misunderstood you, but your answer seem to solve something im testing it right now."}], "answers": [{"tags": [], "owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "is_accepted": true, "score": 4, "last_activity_date": 1481737950, "creation_date": 1481737950, "answer_id": 41149034, "question_id": 41148896, "link": "https://stackoverflow.com/questions/41148896/using-malloc-to-allocate-memory-for-an-array/41149034#41149034", "title": "Using malloc to allocate memory for an array", "body": "<p>There's a mismatch between the local variable <code>Stud *students</code> and the function parameter <code>Stud *students[]</code>. Those two variables ought to have the same type.</p>\n\n<p>The local variable and <code>malloc()</code> look good. <code>new_student</code> has an undesirable extra layer of pointers. It should look like this instead:</p>\n\n<pre><code>void new_student(Stud* students, int stud_loc){\n   scanf (\"%s\", students[stud_loc].stud_id);\n   printf(\"%s\", students[stud_loc].stud_id);\n   scanf (\"%s\", students[stud_loc].stud_name);\n   printf(\"%s\", students[stud_loc].stud_name); \n}\n</code></pre>\n\n<p>You would then call it like so:</p>\n\n<pre><code>Stud* students = malloc(sizeof(Stud)*STUDENT_SIZE);\n\nnew_student(students, 0);\nnew_student(students, 1);\nnew_student(students, 2);\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6227589, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NvGGO.jpg?s=128&g=1", "display_name": "Kan", "link": "https://stackoverflow.com/users/6227589/kan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 41149034, "answer_count": 1, "score": 0, "last_activity_date": 1481738277, "creation_date": 1481737406, "last_edit_date": 1481738277, "question_id": 41148896, "link": "https://stackoverflow.com/questions/41148896/using-malloc-to-allocate-memory-for-an-array", "title": "Using malloc to allocate memory for an array", "body": "<p>I'm trying to make an array of structs by using malloc to allocate the memory needed like so:</p>\n\n<pre><code>typedef struct stud{\n   char stud_id[MAX_STR_LEN];\n   char stud_name[MAX_STR_LEN];\n   Grade* grd_list;\n   Income* inc_list;\n}Stud;\n\nStud* students = malloc(sizeof(Stud)*STUDENT_SIZE);\n</code></pre>\n\n<p>The problem is that I have a function that adds <code>id</code> and <code>name</code> to a place in the array like so:</p>\n\n<pre><code>void new_student(Stud* students[], int stud_loc){\n   scanf(\"%s\", students[stud_loc]-&gt;stud_id);\n   printf(\"%s\", students[stud_loc]-&gt;stud_id);\n   scanf(\"%s\", students[stud_loc]-&gt;stud_name);\n   printf(\"%s\", students[stud_loc]-&gt;stud_name); \n}\n</code></pre>\n\n<p>But after the first call to the function, which works, the second one gives me the error:</p>\n\n<pre><code>Segmentation fault (core dumped)\n</code></pre>\n\n<p>And I can only think that it must mean I'm not doing this right and all the memory is probably going into one place and not in an array form. I'd rather do</p>\n\n<pre><code>  Stud students[STUDENT_SIZE];\n</code></pre>\n\n<p>but in this case I must use malloc.</p>\n\n<p>I tried using calloc but I still get the same error.</p>\n"}, {"tags": ["c", "arrays", "struct", "malloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481737424, "post_id": 41148841, "comment_id": 69500140, "body": "Also: <code>a[1].B = 3;</code> should be <code>a[0].B = 3;</code> as C uses 0-based indexing."}, {"owner": {"reputation": 129, "user_id": 7241384, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/584f7b7bdf9770265b38f48dea1ecb21?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Per", "link": "https://stackoverflow.com/users/7241384/jason-per"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481737702, "post_id": 41148841, "comment_id": 69500292, "body": "I am trying to access 1 for a reason and this is not a part of the question"}], "owner": {"reputation": 129, "user_id": 7241384, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/584f7b7bdf9770265b38f48dea1ecb21?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Per", "link": "https://stackoverflow.com/users/7241384/jason-per"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1481737319, "answer_count": 0, "score": 1, "last_activity_date": 1481737644, "creation_date": 1481737236, "last_edit_date": 1481737644, "question_id": 41148841, "link": "https://stackoverflow.com/questions/41148841/c-memory-allocation-of-structures", "closed_reason": "Duplicate", "title": "C memory allocation of structures", "body": "<pre><code>typedef struct my_struct {\n  int A;\n  int B;\n} my_struct;\n\nvoid foo(my_struct * a) {\n  a= malloc(5 * sizeof ( my_struct));\n  a[1].B = 3;\n}\n\nint main(int argc, char** argv) {\n\n  my_struct * newStruct;\n  foo(newStruct);\n  printf(\"\\n%d\", newStruct[1].B);\n}\n</code></pre>\n\n<p>Trying to print newStruct[1].B results in a seg fault. What is wrong with the memory allocation here and what is the correct way to allocate the memory. </p>\n"}, {"tags": ["c", "pointers", "stack"], "comments": [{"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1481736816, "post_id": 41148697, "comment_id": 69499831, "body": "Regarding the first problem. You have to initialise pointers, otherwise they point to garbage. <code>p-&gt;elem</code> has probably not been initialised. Moreover, I assume you have initialised your pointer <code>typedef cel* pile</code>. Note also that you have declared the function <code>pile_est_vide</code> to receive as parameter a value. Is that intentional?"}, {"owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1481736995, "post_id": 41148697, "comment_id": 69499934, "body": "@nbro The pile is initialised in my main function, but why should I initialise p-&gt;elem for the first problem? As I&#39;m checking whether it&#39;s <code>NULL</code> or not"}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1481737122, "post_id": 41148697, "comment_id": 69499998, "body": "In C you need to do &quot;everything&quot; manually. If a struct contains a pointer, when you create a variable of that struct, its pointer is not inialised to <code>NULL</code> but points to some area of memory which you do not &quot;own&quot;. The usual way of programming, at least what I do in these cases, is to have a function that initialises my struct to a well-defined state."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481737129, "post_id": 41148697, "comment_id": 69500001, "body": "At which lines do you get the error ?"}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 1, "creation_date": 1481737184, "post_id": 41148697, "comment_id": 69500026, "body": "Check here a few exercises which illustrate what I&#39;ve just said: <a href=\"https://github.com/nbro/c-exercises\" rel=\"nofollow noreferrer\">github.com/nbro/c-exercises</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481737194, "post_id": 41148697, "comment_id": 69500027, "body": "typedefs such as <code>typedef cel* pile;</code> only create confusion. Don&#39;t do this."}, {"owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481737218, "post_id": 41148697, "comment_id": 69500041, "body": "@MichaelWalz the first error is on the line: <code>if(p-&gt;ele){</code>  and the other is on the line: <code>ptmp=p-&gt;suiv;</code>"}, {"owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481737242, "post_id": 41148697, "comment_id": 69500052, "body": "@MichaelWalz it&#39;s a class assignment so we don&#39;t have a choice"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1481737263, "post_id": 41148697, "comment_id": 69500067, "body": "What is <code>element</code> ? Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1481737866, "post_id": 41148697, "comment_id": 69500370, "body": "I know it may seem annoying, but show us also the definition of the function <code>init_pile()</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1481737983, "post_id": 41148697, "comment_id": 69500432, "body": "@JessicaChambers please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that means the minimum code that exposes the problem so we can copy/paste it on our computers, compile it and see what&#39;s wrong. And if there is some input, please post that too."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1481738185, "post_id": 41148697, "comment_id": 69500533, "body": "... what you have posted, is maybe <i>minimal</i>, but not <i>complete</i>. We need something we can compile so we can reproduce the same situation that you have."}, {"owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1481738185, "post_id": 41148697, "comment_id": 69500534, "body": "@nbro it won&#39;t let me edit the post again, so here&#39;s init_pile: <code>pile init_pile(){ \tpile p=malloc(sizeof(pile)); \tif(p){ \t\tp-&gt;ele=NULL; \t\tp-&gt;suiv=NULL; \t} \treturn p; } </code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481738236, "post_id": 41148697, "comment_id": 69500549, "body": "@JessicaChambers <i>it won&#39;t let you edit the post</i> ?? What error message do you get from Stack overflow ??"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481738327, "post_id": 41148697, "comment_id": 69500598, "body": "We still don&#39;t know what <code>ppile</code>  is nor <code>init_element()</code> and <code>empile</code>."}, {"owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481738430, "post_id": 41148697, "comment_id": 69500646, "body": "@MichaelWalz I had edited it too quickly, it&#39;s ok now. ppile is a pointer to a pile, a pile is a stack, init element creates an element and empile=push (studying in french)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1481738641, "post_id": 41148697, "comment_id": 69500741, "body": "Please post <b>all</b> your code, <code>init_element</code>, <code>affecte_element</code>, <code>empile</code> and <code>affiche_pile</code> are still missing. <i>Il faut vraiment vous tirer les vers du nez</i>."}, {"owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481738688, "post_id": 41148697, "comment_id": 69500769, "body": "@MichaelWalz I usually get punished when I do that on here... You&#39;re damned if you do and you&#39;re damned if you don&#39;t"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481738749, "post_id": 41148697, "comment_id": 69500807, "body": "OK, without sufficient information I can&#39;t help. I&#39;m giving up. Sorry."}, {"owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481738936, "post_id": 41148697, "comment_id": 69500913, "body": "@MichaelWalz No, I was just in the process of adding it.. thanks for your help though"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481739663, "post_id": 41148697, "comment_id": 69501279, "body": "<code>pile</code> or <code>stack</code> ? Please make up your mind."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 1, "creation_date": 1481740864, "post_id": 41148697, "comment_id": 69501888, "body": "@JessicaChambers From your <code>init_pile</code> function, it seems to me that you&#39;re initialising correctly your <code>pile</code>s."}, {"owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481786015, "post_id": 41148697, "comment_id": 69517927, "body": "@MichaelWalz I renamed it stack so it would be clearer for anglophones. It&#39;s the same thing"}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1539174030, "post_id": 41148697, "comment_id": 92404802, "body": "The definition of <code>init_stack()</code> is missing."}], "answers": [{"comments": [{"owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "edited": false, "score": 0, "creation_date": 1481738142, "post_id": 41149007, "comment_id": 69500518, "body": "Doesn&#39;t seem to change anything; even when I compile it it says it is already up to date"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "edited": false, "score": 1, "creation_date": 1481738455, "post_id": 41149007, "comment_id": 69500660, "body": "You have problems with your build system. You don&#39;t edit the correct file. Could you post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> ?"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1481737829, "creation_date": 1481737829, "answer_id": 41149007, "question_id": 41148697, "link": "https://stackoverflow.com/questions/41148697/assignment-from-incompatible-pointer-type-issues-with-dynamic-stack-in-c/41149007#41149007", "title": "assignment from incompatible pointer type issues with dynamic stack in C", "body": "<p><code>struct cel</code> is defined nowhere.</p>\n\n<pre><code>typedef struct etCel{\n    element *ele;\n    struct cel *suiv;   // &lt;&lt;&lt; this looks wrong to me\n} cel;\n</code></pre>\n\n<p>Shouldn't it be:</p>\n\n<pre><code>typedef struct etCel{\n    element *ele;\n    struct etCel *suiv;   // &lt;&lt;&lt; changement here\n} cel;\n</code></pre>\n"}], "owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539177660, "creation_date": 1481736683, "last_edit_date": 1539177660, "question_id": 41148697, "link": "https://stackoverflow.com/questions/41148697/assignment-from-incompatible-pointer-type-issues-with-dynamic-stack-in-c", "title": "assignment from incompatible pointer type issues with dynamic stack in C", "body": "<p>I have two main problems.\nMy code is a stack (pile) of \"elements\", made with a struct as so:</p>\n\n<pre><code>typedef struct etCel{\n    element *ele;\n    struct cel *suiv;   \n} cel;\n\ntypedef cel* pile;\n</code></pre>\n\n<p>The first problem is the \"isEmpty\" function, which generates a Segmentation fault:</p>\n\n<pre><code>int isEmpty(stack p){\n    if(p-&gt;ele){\n        return 0;\n    }else{\n        return 1;\n    }\n}\n\nint affiche_pile(pile p){\n    printf(\"Valeurs de la pile:\\n\");\n\n    while(p-&gt;ele){\n        affiche_element(p-&gt;ele);\n        printf(\"\\n\");\n        p=p-&gt;suiv;\n    }\n\n    return 1;\n}\n\nint pile_est_vide(pile p){\n    if(p-&gt;ele){\n        return 0;\n    }else{\n        return 1;\n    }\n}\n\npile push(stack p, element e){\n    element *nvoele;\n    nvoele = (element*)malloc(sizeof(element));\n    stack ptmp = (stack)malloc(sizeof(cel));\n\n    assert(ptmp);\n\n    nvoele = &amp;e;\n    ptmp-&gt;ele = nvoele;\n    ptmp-&gt;suiv = p; //ERROR HERE\n    return ptmp;    \n}\n\nelement pop(stack p){\n    stack ptmp = init_stack();\n\n    if(isEmpty(p) != 1){\n        ptmp = p-&gt;suiv; //ERROR HERE\n        free(p);\n        return *(ptmp-&gt;ele);\n    }else{\n        printf(\"Erreur! La pile est vide!\\n\");\n    }\n}\n\nint fill_stack(stack p, int q){\n    element tmp = init_element();\n    element *ptmp = &amp;tmp;\n\n    for(int i = 0; i &lt; q; i++){\n        input_element(ptmp);\n        push(p, tmp);\n    }\n\n    return 1;\n}\n</code></pre>\n\n<p>The second problem is the assignment issue, which occurs in other functions such as this \"pop\" function:</p>\n\n<pre><code>element pop(stack p){\n    stack ptmp = init_stack();\n    if(isEmpty(p) != 1){\n        ptmp = p-&gt;suiv;\n        free(p);\n        return *(ptmp-&gt;ele);\n    }else{\n        printf(\"Erreur! La pile est vide!\\n\");\n    }\n}\n</code></pre>\n\n<p>it generates this error:</p>\n\n<blockquote>\n  <p>warning: assignment from incompatible pointer type [enabled by\n  default]    ptmp = p->suiv;</p>\n</blockquote>\n\n<p>I'm sure it's just some kind of syntax error, any help is appreciated, thanks</p>\n\n<p>---- Edit:\nHere's what element looks like:</p>\n\n<pre><code>typedef struct etElement{\n    float num;\n} element;\n\nelement init_element(){\n    element p;\n    p.num=0.0;\n    return p;\n}\n\nint affiche_element(element *p){\n    printf(\"Valeur de l\\'element:\\n\");\n    printf(\"%f, \", p-&gt;num);\n    printf(\"\\n\");\n    return 1;\n}\n\nint affecte_element(element *p, float x){\n    p-&gt;num = x;\n    return 1;\n}\n\nint saisir_element(element *p){\n    float x = 0;\n    scanf(\"%f\", &amp;x);\n\n    if(affecte_element(p, x)){\n        return 1;\n    } else { \n        return 0; \n    }\n}\n\nint compare_element(element *p, element *e){\n    if(p-&gt;num &gt; e-&gt;num){\n        printf(\"%f &gt; %f\\n\", p-&gt;num, e-&gt;num);\n        return 3;\n    }\n\n    if(p-&gt;num == e-&gt;num){\n        printf(\"%f = %f\\n\", p-&gt;num, e-&gt;num);\n        return 2;\n    }\n\n    if(p-&gt;num &lt; e-&gt;num) {\n        printf(\"%f &lt; %f\\n\", p-&gt;num, e-&gt;num);\n        return 1;\n    } else {\n        return 0;\n    }\n}\n</code></pre>\n\n<p>And a minimal example of code:</p>\n\n<pre><code>int main(){\n\n    //Initialisation\n    stack p = init_stack();\n\n    if(isEmpty(p)==1){\n        printf(\"Empty.\\n\");\n    }else{\n        printf(\"Not empty.\\n\");\n    }\n\n    element e = init_element();\n    element *pele = &amp;e;\n    assign_element(pele,3.0);\n\n    //Empilation\n    if(push(p,e)){\n        p=push(p,e);\n    }else{\n        printf(\"Echec de l\\'empilation.\\n\");\n    }\n\n    show_stack(p);\n}\n</code></pre>\n\n<p>this is literally what I'm compiling minus some <code>printfs</code></p>\n\n<p>while I'm here, here's element:</p>\n\n<pre><code>typedef struct etElement{\n    float num;\n} element;\n</code></pre>\n"}, {"tags": ["c", "macros", "post-increment", "pre-increment"], "comments": [{"owner": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 0, "creation_date": 1481736729, "post_id": 41148678, "comment_id": 69499788, "body": "undefined behavior"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1481738771, "post_id": 41148678, "comment_id": 69500816, "body": "It&#39;s not quite a duplicate of <a href=\"http://stackoverflow.com/questions/949433/why-are-these-constructs-using-undefined-behavior\" title=\"why are these constructs using undefined behavior\">stackoverflow.com/questions/949433/&hellip;</a> as OP might be confused about what macros do (as assumed by Sourav Ghosh&#39;s answer)."}, {"owner": {"reputation": 3, "user_id": 7297996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e91987267e2dd5c0242834de58f6938?s=128&d=identicon&r=PG&f=1", "display_name": "user7297996", "link": "https://stackoverflow.com/users/7297996/user7297996"}, "reply_to_user": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 0, "creation_date": 1481738797, "post_id": 41148678, "comment_id": 69500832, "body": "hey @Danh actually this question was asked in one of my exams, hence I thought there should be someway to get the answer."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1481740745, "post_id": 41148678, "comment_id": 69501831, "body": "Another useful and relevant Q&amp;A is <a href=\"http://stackoverflow.com/questions/4176328/undefined-behavior-and-sequence-points\" title=\"undefined behavior and sequence points\">stackoverflow.com/questions/4176328/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7297996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e91987267e2dd5c0242834de58f6938?s=128&d=identicon&r=PG&f=1", "display_name": "user7297996", "link": "https://stackoverflow.com/users/7297996/user7297996"}, "edited": false, "score": 0, "creation_date": 1481738859, "post_id": 41148800, "comment_id": 69500864, "body": "Ain&#39;t there any way to get the answer atleast for the first function, coz that is what I got in one of my exams"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 3, "user_id": 7297996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e91987267e2dd5c0242834de58f6938?s=128&d=identicon&r=PG&f=1", "display_name": "user7297996", "link": "https://stackoverflow.com/users/7297996/user7297996"}, "edited": false, "score": 1, "creation_date": 1481738898, "post_id": 41148800, "comment_id": 69500887, "body": "@user7297996 nopes, UB is...UB. that&#39;s it."}, {"owner": {"reputation": 3, "user_id": 7297996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e91987267e2dd5c0242834de58f6938?s=128&d=identicon&r=PG&f=1", "display_name": "user7297996", "link": "https://stackoverflow.com/users/7297996/user7297996"}, "edited": false, "score": 0, "creation_date": 1481738918, "post_id": 41148800, "comment_id": 69500900, "body": "Okay thank you for ur help"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 2, "creation_date": 1481740798, "post_id": 41148800, "comment_id": 69501860, "body": "If this is a question on an exam, either your teacher is tricking you and the answer is &quot;undefined behavior&quot;, or your teacher has no idea what they&#39;re doing and has no business teaching C. (An alternative answer that I would have accepted would be, &quot;I have no idea, but if you ever wrote code like this, you deserve to have your butt kicked, so it doesn&#39;t really matter.&quot;)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 2, "last_activity_date": 1481737092, "creation_date": 1481737092, "answer_id": 41148800, "question_id": 41148678, "link": "https://stackoverflow.com/questions/41148678/macro-and-pre-post-increment-in-c/41148800#41148800", "title": "Macro and Pre/Post Increment in C", "body": "<p>MACROs are textual replacement, so your code</p>\n\n<pre><code> SQR(a++)\n</code></pre>\n\n<p>expands to something like</p>\n\n<pre><code> a++ * a++\n</code></pre>\n\n<p>and, <code>int c=SQR(++a);</code> to <code>int c = ++a*++a;</code></p>\n\n<p>which invokes  <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>. To elaborate the <em>why</em> part for this, please refer to this well-written answer.</p>\n"}], "owner": {"reputation": 3, "user_id": 7297996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e91987267e2dd5c0242834de58f6938?s=128&d=identicon&r=PG&f=1", "display_name": "user7297996", "link": "https://stackoverflow.com/users/7297996/user7297996"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 0, "closed_date": 1481736786, "accepted_answer_id": 41148800, "answer_count": 1, "score": 0, "last_activity_date": 1481738580, "creation_date": 1481736608, "last_edit_date": 1481738580, "question_id": 41148678, "link": "https://stackoverflow.com/questions/41148678/macro-and-pre-post-increment-in-c", "closed_reason": "Duplicate", "title": "Macro and Pre/Post Increment in C", "body": "<p>I have noticed this strange behavior of macro functions while using pre increment operator. I know it is not preferable to use pre increment operator with macros but still I would like to know the reason behind the execution of the following 2 codes:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define SQR(x) {x*x }\n\nint main()\n{\n    int a=4;\n    int b=SQR(a++);\n    int c=SQR(++a);\n    printf(\"%d.....%d....%d\\n\",b,c,a*b*c); \n    return 0;\n}\n</code></pre>\n\n<p>The output of this is:</p>\n\n<pre><code>20.....64....10240\n</code></pre>\n\n<p>The first value b is 20, which is okay 4*5. But why the value of C is 64 i.e. 8*8 instead of 7*8?</p>\n\n<p>And I just replaced the sequence of execution like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define SQR(x) {x*x }\n\nint main()\n{\n    int a=4;\n    int c=SQR(++a);\n    int b=SQR(a++);\n    printf(\"%d.....%d....%d\\n\",b,c,a*b*c); \n    return 0;\n}\n</code></pre>\n\n<p>The output of this is:</p>\n\n<pre><code>42.....36....12096\n</code></pre>\n\n<p>Strange isn't it? The pre increment again had some issue. It gave 42 i.e. 6*7 instead of 5*6 and after that the post increment also gave wrong answer 36 i.e. 6*6 instead of 6*7.</p>\n\n<p>It would be a great help if anyone can explain why the outputs are like this?</p>\n"}, {"tags": ["c", "return", "return-value"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1481736888, "post_id": 41148654, "comment_id": 69499877, "body": "<code>return</code> wirhout an expression is not permitted in a function returning a non-void."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1481741098, "post_id": 41148654, "comment_id": 69502017, "body": "@abelenky IDEONE should never be used for a code checking. If you have a code, check it yourself and if you are sure that your code is OK, show it with IDEONE. But never use IDEONE to check your code. <a href=\"http://ideone.com/DRTOi5\" rel=\"nofollow noreferrer\">Check this simple example</a>. You do realize that initializer element is not constant. More over, as far as I know IDEONE use only 32 BIT compiler (maybe I&#39;m wrong)."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1481985085, "post_id": 41148654, "comment_id": 69598584, "body": "Short answer: it depends on the compiler / settings.  That&#39;s what undefined behavior means."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "edited": false, "score": 0, "creation_date": 1481742236, "post_id": 41148748, "comment_id": 69502689, "body": "I may have worded my question wrong, but <b>what is the return value of <code>main</code> <i>likely</i> to be in this case?</b>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481742940, "post_id": 41148748, "comment_id": 69503042, "body": "@MarkYisri The problem here is, execution of this program (if a compiler generates a binary, at all) invokes UB, so thing is guranteed."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 8, "last_activity_date": 1481741805, "last_edit_date": 1481741805, "creation_date": 1481736915, "answer_id": 41148748, "question_id": 41148654, "link": "https://stackoverflow.com/questions/41148654/what-is-the-result-of-calling-return-in-a-non-void-function-after-calling-a-func/41148748#41148748", "title": "What is the result of calling return in a non-void function after calling a function returning int?", "body": "<p>This is not a <em>desired</em> behaviour, though not <em>explicitly</em> mentioned as undefined behaviour. This is a \"Constraints violation\".</p>\n\n<p>Quoting <code>C11</code>, chapter 6.8.6.4</p>\n\n<blockquote>\n  <p>[...] A <code>return</code> statement without an expression shall only appear in a function\n  whose return type is <code>void</code>.</p>\n</blockquote>\n\n<p>and, from chapter \u00a75.1.1.3, <em>Diagnostics</em>,</p>\n\n<blockquote>\n  <p>A conforming implementation shall produce at least one diagnostic message (identified in\n  an implementation-defined manner) if a preprocessing translation unit or translation unit\n  contains a violation of any syntax rule or constraint, even if the behavior is also explicitly\n  specified as undefined or implementation-defined. [....]</p>\n</blockquote>\n\n<p>In this case, compiler proceeds to generate the executable code, so, yes, executing this binary invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">undefined behavior</a>.</p>\n\n<p>Bottom line, for <code>main()</code> which is expected to return an <code>int</code> should not have a <code>return</code> statement without an expression. Refrain from writing code like that.</p>\n\n<hr>\n\n<p><sup><em>[Note: <a href=\"https://groups.google.com/forum/#!topic/comp.std.c/WNVXRSCqrGU\" rel=\"noreferrer\">As per this discussion</a>, there's a strong notion that this is undefined behaviour, but still, there's no <strong>explicit</strong> mention in the standard.]</em></sup></p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1481737013, "post_id": 41148759, "comment_id": 69499940, "body": "I&#39;d be interested if you can quote something related to this. Thanks."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481737159, "post_id": 41148759, "comment_id": 69500017, "body": "The standard makes no requirements on programs that are not well-formed - a compiler should normally reject such inputs with a suitable error message.  &quot;<i>A <code>return</code> statement without an expression shall only appear in a function whose return type is <code>void</code></i>&quot; - that &quot;<b>shall</b>&quot; absolves the compiler from producing any program at all."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481737270, "post_id": 41148759, "comment_id": 69500071, "body": "That said, you&#39;re allowed to omit the <code>return</code> from <code>main()</code> (and only from <code>main()</code>), so a compiler might choose to treat a void return as equivalent.  But unless it documents that, we can&#39;t reason about it here!"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481737758, "post_id": 41148759, "comment_id": 69500318, "body": "OK, I had a quick look at the draft of the standard and you&#39;re correct. I&#39;ve amended my answer to include the chain of reference. :)"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 2, "creation_date": 1481741293, "post_id": 41148759, "comment_id": 69502129, "body": "@TobySpeight Your comments helps more than the whole Answer you provide. This means that your Comments are actually an Answer and your Answer is no more than a Comment."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "edited": false, "score": 0, "creation_date": 1481742246, "post_id": 41148759, "comment_id": 69502693, "body": "I may have worded my question wrong, but <b>what is the return value of <code>main</code> <i>likely</i> to be in this case?</b>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1481749520, "post_id": 41148759, "comment_id": 69506489, "body": "The C standard does not talk about &quot;well-formed&quot; programs. Perhaps you&#39;re thinking of C++? A <code>return;</code> with no expression in a non-<code>void</code> function is a <i>constraint violation</i>, and a conforming implementation is required to issue a diagnostic. (That diagnostic may be a non-fatal warning; in that case it&#39;s not 100% clear whether the behavior of the resulting program is undefined.) The rule that a non-<code>void</code> function may not have a <code>return;</code> with no expression was added in C99."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481794067, "post_id": 41148759, "comment_id": 69522119, "body": "Sorry, I should be more precise in my terminology.  Your comment is much clearer than my answer; I&#39;ll incorporate most of it as an edit -unless you want to answer for yourself?"}], "tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 0, "last_activity_date": 1481799887, "last_edit_date": 1481799887, "creation_date": 1481736956, "answer_id": 41148759, "question_id": 41148654, "link": "https://stackoverflow.com/questions/41148654/what-is-the-result-of-calling-return-in-a-non-void-function-after-calling-a-func/41148759#41148759", "title": "What is the result of calling return in a non-void function after calling a function returning int?", "body": "<p>The program as shown is not legal C.  The use of <code>return;</code> in a non-void function like that is a <em>constraint violation</em>, and your compiler is required to complain.  Usually, that will be an error, but a compiler is allowed to produce a program - but the standard obviously does not make any requirements on the behaviour of such a program.  Therefore its behaviour is not defined (technically, this is slightly different from Undefined Behaviour, as it's not something explicitly specified as \"<em>undefined</em>\" in the standard).</p>\n\n<p>There's no point asking questions like, \"<em>What happens when I cause Undefined Behaviour?</em>\" because the answer is always, \"<em>Anything</em>.\"</p>\n\n<p>As an aside, you are allowed to <strong>omit</strong> a return statement (i.e. to run off the end of the function) <em>as long as your program does not use the return value</em>.  If the program uses the return value, then the behaviour is Undefined (not merely unspecified).  In particular, running off the end of <code>main()</code> is legal.  Although there's no rationale for allowing functions with no <code>return</code> but not those with an explicit void <code>return</code>, I presume it's due to the logical undecidability of whether a function's end is reachable (it's a case of the Halting Problem).</p>\n\n<p>Of particular interest in this case is that the function in question is <code>main()</code>.  Options available to the compiler (in addition to emitting the required diagnostic) include (but are not limited to):</p>\n\n<ul>\n<li>Terminate compilation</li>\n<li>Optimise out <code>return;</code> as the last statement in a function, and treat it the same as <code>main()</code> with no return statement</li>\n<li>Return an uninitialized value (which might be a signalling value on architectures that support them, or it might be a recently-used stack value, or something else altogether)</li>\n</ul>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "edited": false, "score": 0, "creation_date": 1481982145, "post_id": 41198082, "comment_id": 69597719, "body": "Thank you for the helpful answer. Can you try it with the new updated code"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 2, "creation_date": 1481989730, "post_id": 41198082, "comment_id": 69599942, "body": "@MarkYisri sorry, this is not a discussion forum.  You are welcome to ask new questions, but it&#39;s not fair to the people who answered you to change your question."}], "tags": [], "owner": {"reputation": 3073, "user_id": 6536841, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AgaMV.jpg?s=128&g=1", "display_name": "Nikhil Manapure", "link": "https://stackoverflow.com/users/6536841/nikhil-manapure"}, "is_accepted": false, "score": 0, "last_activity_date": 1481974068, "creation_date": 1481974068, "answer_id": 41198082, "question_id": 41148654, "link": "https://stackoverflow.com/questions/41148654/what-is-the-result-of-calling-return-in-a-non-void-function-after-calling-a-func/41198082#41198082", "title": "What is the result of calling return in a non-void function after calling a function returning int?", "body": "<p>From the comments (not from the question), I understood that the main aim is to find what is returned by main by doing <code>return;</code>. I hope I am going in right direction.</p>\n\n<p><strong>First thing</strong> is few compiler allow writing just <code>return;</code> and some give a warning and a few compiler give implicitly add <code>return 0;</code> if nothing is returned by main.</p>\n\n<p><strong>Second thing</strong> returning 0 signifies successful execution of the program and if returning anything else will mean some runtime error(At least your environment thinks that way).</p>\n\n<p>Now coming to your doubt: what is implicitly returned by main by writing <code>return;</code>. I checked with the tool you are using <a href=\"http://ideone.com/\" rel=\"nofollow noreferrer\">ideone.com</a> and C (gcc-5.1).</p>\n\n<p>With <code>return;</code> it gave</p>\n\n<pre><code>Runtime error   time: 0 memory: 2164 signal:-1\n</code></pre>\n\n<p>With <code>return 0;</code> it gave</p>\n\n<pre><code>Success time: 0 memory: 2164 signal:0\n</code></pre>\n\n<p>With <code>return 1;</code> it again gave</p>\n\n<pre><code>Runtime error   time: 0 memory: 2164 signal:-1\n</code></pre>\n\n<p>In this signal signifies the returned value from <code>main</code></p>\n\n<p>If you use the terminal to run your program, you can use <code>echo $?</code> to get the returned value.</p>\n\n<p>So now you can observe yourself that <code>return;</code> and <code>return 1;</code> give the same output (the implicit value returned can be garbage too). Still, we cannot guarantee this but now you have all the tools you need to find out.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "edited": false, "score": 0, "creation_date": 1482013846, "post_id": 41200617, "comment_id": 69606622, "body": "I&#39;ll award you the bounty for the best answer."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1481992056, "last_edit_date": 1481992056, "creation_date": 1481991654, "answer_id": 41200617, "question_id": 41148654, "link": "https://stackoverflow.com/questions/41148654/what-is-the-result-of-calling-return-in-a-non-void-function-after-calling-a-func/41200617#41200617", "title": "What is the result of calling return in a non-void function after calling a function returning int?", "body": "<p>The issue here is you don't seem to understand what <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> means.</p>\n\n<p>When you invoke undefined behavior, anything can happen.  Your program can crash, it can generate unexpected results, or it can appear to work correctly.  Making a seeming unrelated change, such as adding an unused variable or an extra call to <code>printf</code>, can change how undefined behavior manifests itself.</p>\n\n<p>This also means that two different compilers can generate different results for the same code, or that one compiler with two different optimization settings can generate different results.</p>\n\n<p>I'll give you an example.  I compiled your original code on a CentOS 5.10 with gcc 4.1.2.  First I compiled without any optimization:</p>\n\n<pre><code>gcc -Wall -Wextra -g -o /tmp/x1 /tmp/x1.c\n</code></pre>\n\n<p>I ran the resulting code and then ran <code>echo $?</code>.  The latter prints the exit code of the previous process (i.e. the return value of <code>main</code>).  The result:</p>\n\n<pre><code>[dbush@db-centos tmp]$ /tmp/x1\n[dbush@db-centos tmp]$ echo $?\n3\n[dbush@db-centos tmp]$ \n</code></pre>\n\n<p>Now I'll compile the same code on a Windows 7 machine under Visual Studio 2010:</p>\n\n<pre><code>cl x1.c\n</code></pre>\n\n<p>If I run this and then <code>echo %ERRORLEVEL%</code> to print the return code, I get this:</p>\n\n<pre><code>C:\\Users\\dbush\\Documents&gt;x1\n\nC:\\Users\\dbush\\Documents&gt;echo %ERRORLEVEL%\n0\n\nC:\\Users\\dbush\\Documents&gt;\n</code></pre>\n\n<p>As you can see, gcc and MSVC generate different results for the same code.  In one case it returns 3 while in the other case it return 0.</p>\n\n<p>Now let's play around with optimization.  I compiled the same code on the same CentOS machine with the same version of gcc, but with optimization turned on:</p>\n\n<pre><code>gcc -Wall -Wextra -g -o /tmp/x1 /tmp/x1.c -O3\n</code></pre>\n\n<p>I then ran this twice. I then got the following result:</p>\n\n<pre><code>[dbush@db-centos tmp]$ /tmp/x1\n[dbush@db-centos tmp]$ echo $?\n68\n[dbush@db-centos tmp]$ /tmp/x1\n[dbush@db-centos tmp]$ echo $?\n36\n[dbush@db-centos tmp]$ \n</code></pre>\n\n<p>So not only do I get different results when running with different optimization settings, I get different results running the <strong>same program multiple times</strong>.  That's what can happen with undefined behavior.</p>\n\n<p>So to answer your question \"what return value will be produced\", the answer is it depends because you invoked undefined behavior.  You can't reliably predict what will happen.</p>\n\n<p>EDIT:</p>\n\n<p>More examples with your updated code.</p>\n\n<p>On gcc with no optimizations:</p>\n\n<pre><code>[dbush@db-centos tmp]$ /tmp/x1\nmytest2 = 3\n[dbush@db-centos tmp]$ echo $?\n12\n</code></pre>\n\n<p>On gcc with optimization <code>-O3</code>:</p>\n\n<pre><code>[dbush@db-centos tmp]$ /tmp/x1\nmytest2 = -1078711820\n[dbush@db-centos tmp]$ echo $?\n22\n[dbush@db-centos tmp]$ /tmp/x1\nmytest2 = -1077511916\n[dbush@db-centos tmp]$ echo $?\n22\n</code></pre>\n\n<p>On MSVC with no optimizations:</p>\n\n<pre><code>C:\\Users\\dbush\\Documents&gt;x1\nmytest2 = 3\n\nC:\\Users\\dbush\\Documents&gt;echo %ERRORLEVEL%\n0\n\nC:\\Users\\dbush\\Documents&gt;\n</code></pre>\n\n<p>On MSVC with optimization <code>/Ox</code>:</p>\n\n<pre><code>C:\\Users\\dbush\\Documents&gt;x1\nmytest2 = 1\n\nC:\\Users\\dbush\\Documents&gt;echo %ERRORLEVEL%\n0\n\nC:\\Users\\dbush\\Documents&gt;\n</code></pre>\n\n<p>So again, no guarantees.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 41200617, "answer_count": 4, "score": -4, "last_activity_date": 1534676376, "creation_date": 1481736541, "last_edit_date": 1592644375, "question_id": 41148654, "link": "https://stackoverflow.com/questions/41148654/what-is-the-result-of-calling-return-in-a-non-void-function-after-calling-a-func", "title": "What is the result of calling return in a non-void function after calling a function returning int?", "body": "<p><strong>UPDATE 2018: This was an old question I wrote with reduced understanding of C. Please refrain from downvoting.</strong></p>\n<hr />\n<p>When I use the following code:</p>\n<pre><code>int mytest(void);\nint main(void)\n{\n   mytest();\n   return;\n}\nint mytest(void)\n{\n   return 3;\n}\n</code></pre>\n<p>What is the return value of <code>main</code>? I understand this is</p>\n<ul>\n<li>undefined behavior</li>\n<li>might produce an error</li>\n</ul>\n<blockquote>\n<p>Edit: large comment: <strong>I know this is undefined behavior.</strong> Logically, what return value will be produced?</p>\n<p>Edit 2: <strong>Sample: <a href=\"http://ideone.com/fAxnNn\" rel=\"nofollow noreferrer\">http://ideone.com/fAxnNn</a></strong></p>\n</blockquote>\n"}, {"tags": ["c", "arduino", "urlencode", "esp8266", "arduino-esp8266"], "answers": [{"comments": [{"owner": {"reputation": 731, "user_id": 3129252, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/100001486491198/picture?type=large", "display_name": "kris14an", "link": "https://stackoverflow.com/users/3129252/kris14an"}, "edited": false, "score": 0, "creation_date": 1481747104, "post_id": 41149981, "comment_id": 69505215, "body": "JSON is sent in request payload POST method. So, i really should encode this content using URI encoding method? Why library changing + to space character, and how prevent this solution?"}, {"owner": {"reputation": 5508, "user_id": 794749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pfE2l.jpg?s=128&g=1", "display_name": "gre_gor", "link": "https://stackoverflow.com/users/794749/gre-gor"}, "reply_to_user": {"reputation": 731, "user_id": 3129252, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/100001486491198/picture?type=large", "display_name": "kris14an", "link": "https://stackoverflow.com/users/3129252/kris14an"}, "edited": false, "score": 0, "creation_date": 1481751496, "post_id": 41149981, "comment_id": 69507422, "body": "<a href=\"https://en.wikipedia.org/wiki/POST_(HTTP)#Use_for_submitting_web_forms\" rel=\"nofollow noreferrer\">POST data must also be encoded</a>"}, {"owner": {"reputation": 731, "user_id": 3129252, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/100001486491198/picture?type=large", "display_name": "kris14an", "link": "https://stackoverflow.com/users/3129252/kris14an"}, "edited": false, "score": 0, "creation_date": 1481784310, "post_id": 41149981, "comment_id": 69517191, "body": "ok, when encode this json, works fine, but is some method to read this data from client connection stream using original bytes?"}], "tags": [], "owner": {"reputation": 5508, "user_id": 794749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pfE2l.jpg?s=128&g=1", "display_name": "gre_gor", "link": "https://stackoverflow.com/users/794749/gre-gor"}, "is_accepted": true, "score": 2, "last_activity_date": 1481741382, "creation_date": 1481741382, "answer_id": 41149981, "question_id": 41148167, "link": "https://stackoverflow.com/questions/41148167/esp8266-arduino-request-content-encoding/41149981#41149981", "title": "ESP8266 Arduino request content encoding", "body": "<p>The <code>ESP8266WebServer</code> library is decoding <code>+</code> into a space character.</p>\n\n<p>You need to URL encode the JSON string, before sending it.</p>\n\n<p>In vanilla JavaScript you need to use <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent\" rel=\"nofollow noreferrer\"><code>encodeURIComponent</code></a>.<br>\nDon't use <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURI\" rel=\"nofollow noreferrer\"><code>encodeURI</code></a>, because it doesn't encode <code>+</code>.<br>\nWhatever you use, make sure the <code>+</code> character is encoded into <code>%2b</code>.</p>\n\n<p>This will also save you from potential problems, involving <code>?</code>, <code>&amp;</code> and <code>=</code> inside your JSON.</p>\n"}], "owner": {"reputation": 731, "user_id": 3129252, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/100001486491198/picture?type=large", "display_name": "kris14an", "link": "https://stackoverflow.com/users/3129252/kris14an"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1089, "favorite_count": 0, "accepted_answer_id": 41149981, "answer_count": 1, "score": 0, "last_activity_date": 1481741603, "creation_date": 1481734808, "last_edit_date": 1481741603, "question_id": 41148167, "link": "https://stackoverflow.com/questions/41148167/esp8266-arduino-request-content-encoding", "title": "ESP8266 Arduino request content encoding", "body": "<p>I'm trying to send JSON to an Arduino module with a ESP8266. I have a simple web server, which waiting for JSON with SSID and password where device must connect. </p>\n\n<pre><code>ESP8266WebServer server(80);\nserver.on(\"/config\", HTTP_POST, configHandle);\nserver.begin();\n\nvoid handleConfig() {\n    String payload = server.arg(\"plain\");\n    //convert JSON to char[]\n    //parse using jsmn lib\n}\n</code></pre>\n\n<p>What if password contains non ASCII characters? How can I handle request content to put this arguments to method:</p>\n\n<pre><code>WiFi.begin(ssid, pass);\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>Example: If I send JSON like: </p>\n\n<pre><code>{\"pass\": \"test+test\"}\n</code></pre>\n\n<p>Then, when I print this payload I don't get a <code>+</code> sign (but this is ASCII sign)</p>\n\n<p>Request (wireshark):</p>\n\n<p><a href=\"https://i.stack.imgur.com/QIIae.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QIIae.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Char array payload from board:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lhs7j.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lhs7j.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "microcontroller", "scaling", "68hc12"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1481735507, "post_id": 41148145, "comment_id": 69499031, "body": "<code>altitude = (potentiometer*20000ul + 1023&#47;2)&#47;1023</code> seems like a good first step."}, {"owner": {"reputation": 35, "user_id": 5558046, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/281d26d9ceea9c35d15338736b6f7827?s=128&d=identicon&r=PG&f=1", "display_name": "user_1", "link": "https://stackoverflow.com/users/5558046/user-1"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481735771, "post_id": 41148145, "comment_id": 69499195, "body": "@chux This works perfectly.  I did not realise it was this easy, thank you.  Now I need to work out the bar graph one, I&#39;ll try this myself."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1481735772, "creation_date": 1481735772, "answer_id": 41148452, "question_id": 41148145, "link": "https://stackoverflow.com/questions/41148145/how-to-scale-a-number-range-of-numbers-in-c/41148452#41148452", "title": "How to scale a number/range of numbers in c", "body": "<p>To scale <code>[0...1023]</code> to <code>[0...20000]</code> multiply by 20,000 and then divide by 1023.</p>\n\n<pre><code>int altitude = (int) ((potentiometer*20000L + 1023/2)/1023);\n</code></pre>\n\n<p>Code uses <code>long</code> multiplication as <code>int</code> may only be 16-bit on a micro-controller.  Not necessary if <code>INT_MAX == 0x7FFFFFFF</code>.</p>\n\n<p>The <code>+ 1023/2</code> is to provide a rounded conversion.</p>\n"}, {"comments": [{"owner": {"reputation": 79873, "user_id": 205608, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/61eE0.png?s=128&g=1", "display_name": "O. Jones", "link": "https://stackoverflow.com/users/205608/o-jones"}, "edited": false, "score": 0, "creation_date": 1481735846, "post_id": 41148459, "comment_id": 69499244, "body": "all this from an old hacker who used to work on systems with software emulation for mul and div."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481735909, "post_id": 41148459, "comment_id": 69499276, "body": "Hmmm.  <code>scaledbuf = buf &gt;&gt; 5;</code>  or <code>scaledbuf = buf &lt;&lt; 5;</code>?"}], "tags": [], "owner": {"reputation": 79873, "user_id": 205608, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/61eE0.png?s=128&g=1", "display_name": "O. Jones", "link": "https://stackoverflow.com/users/205608/o-jones"}, "is_accepted": false, "score": 0, "last_activity_date": 1481735795, "creation_date": 1481735795, "answer_id": 41148459, "question_id": 41148145, "link": "https://stackoverflow.com/questions/41148145/how-to-scale-a-number-range-of-numbers-in-c/41148459#41148459", "title": "How to scale a number/range of numbers in c", "body": "<p>Presumably <code>buf</code> is a 16-bit integer, and contains the pot value. Presumably you can rely on it being limited to the values [0, 1023].</p>\n\n<p>If you do</p>\n\n<pre><code>    int scaledbuf;\n    scaledbuf = buf &gt;&gt; 5;\n</code></pre>\n\n<p>you'll get a value of <code>scaledbuf</code> in the range [0, 32736].  You could then do</p>\n\n<pre><code>    if (scaledbuf &gt; 20000) scaledbuf = 20000;\n</code></pre>\n\n<p>At the cost of sacrificing some of the range of your  pot, this will give you a value in the range [0,20000] without doing any multiplications, only a left shift. </p>\n\n<p>But, you're torching cycles in your delay loops anyway, so you can probably manage the cost of a multiplication by 20.</p>\n\n<pre><code>     int scaledbuf;\n     scaledbuf = buf * 20;\n     if (scaledbuf &gt; 20000) scaledbuf = 20000;\n</code></pre>\n\n<p>This preserves considerably more of your pot's range while keeping you in the realm of 16-bit arithmetic.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5558046, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/281d26d9ceea9c35d15338736b6f7827?s=128&d=identicon&r=PG&f=1", "display_name": "user_1", "link": "https://stackoverflow.com/users/5558046/user-1"}, "edited": false, "score": 0, "creation_date": 1481737459, "post_id": 41148495, "comment_id": 69500167, "body": "thank you.  With regards to the bar graph, this piece of code does not display anything.  Another thing is I want use a block character which is <code>0b11110001</code> on the LCD instead of <code>*</code>.  Sorry I never mentioned this.  @Mazi"}, {"owner": {"reputation": 130, "user_id": 4191106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c34ea41ace8b660de1e3df27c37b870?s=128&d=identicon&r=PG&f=1", "display_name": "Mazi", "link": "https://stackoverflow.com/users/4191106/mazi"}, "reply_to_user": {"reputation": 35, "user_id": 5558046, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/281d26d9ceea9c35d15338736b6f7827?s=128&d=identicon&r=PG&f=1", "display_name": "user_1", "link": "https://stackoverflow.com/users/5558046/user-1"}, "edited": false, "score": 0, "creation_date": 1481750967, "post_id": 41148495, "comment_id": 69507169, "body": "Try <code>num = DELVAL2 * 20 &#47; 1024</code>. And instead of &#39;*&#39; just use (char)0b11110001"}, {"owner": {"reputation": 130, "user_id": 4191106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c34ea41ace8b660de1e3df27c37b870?s=128&d=identicon&r=PG&f=1", "display_name": "Mazi", "link": "https://stackoverflow.com/users/4191106/mazi"}, "reply_to_user": {"reputation": 35, "user_id": 5558046, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/281d26d9ceea9c35d15338736b6f7827?s=128&d=identicon&r=PG&f=1", "display_name": "user_1", "link": "https://stackoverflow.com/users/5558046/user-1"}, "edited": false, "score": 0, "creation_date": 1481751024, "post_id": 41148495, "comment_id": 69507195, "body": "But maybe first try with &#39;*&#39; or any letter that you are sure is displayed correctly. Maybe problem lies in your LCD library for example"}], "tags": [], "owner": {"reputation": 130, "user_id": 4191106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c34ea41ace8b660de1e3df27c37b870?s=128&d=identicon&r=PG&f=1", "display_name": "Mazi", "link": "https://stackoverflow.com/users/4191106/mazi"}, "is_accepted": false, "score": 1, "last_activity_date": 1481735932, "last_edit_date": 1495542633, "creation_date": 1481735932, "answer_id": 41148495, "question_id": 41148145, "link": "https://stackoverflow.com/questions/41148145/how-to-scale-a-number-range-of-numbers-in-c/41148495#41148495", "title": "How to scale a number/range of numbers in c", "body": "<p>If your DELVAL2 is in range 0-1023 you can scale it to 0-20000, but you cannot get bigger resolution than (1/1024) * 20000. Why? Minimum value (single bit) you can read is 1/1024. Your maximum value is 20000, so one bit change on DELVAL2 will result in 20000/1024 = 19,53 change on scaled value.</p>\n\n<p>You can calculate how to scale it, it's already described on stackoverflow:\n<a href=\"https://stackoverflow.com/questions/5294955/how-to-scale-down-a-range-of-numbers-with-a-known-min-and-max-value\">How to scale down a range of numbers with a known min and max value</a></p>\n\n<p>You must keep in mind that you may fall into floating point operation and this is something that you may want to avoid. For example, you can do something like this</p>\n\n<pre><code>scaled = (DELVAL2 * 1953) / 1000;\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>scaled = DELVAL2 * 19.53;\n</code></pre>\n\n<p>Keep in mind that maximum value that you can get inside this computation will be 1024*1953 = 1999872, so you need 32 bit variable. Additional cast may be needed, depending on your architecture and compiler, eg</p>\n\n<pre><code>scaled = (DELVAL2 * (uint32_t)1953) / 1000;\n</code></pre>\n\n<p>About second question - bar graph - you are on good way. Calculate how many symbols do you need and draw them. It's scaling down instead of up. Simple division should be enough. When you know how many symbols you need, generate them in simple loop</p>\n\n<pre><code>for(int i = 0; i &lt; num; i++)\n    buf[i] = '*';\nbuf[i] = 0; //last symbol is 0 to stop drawing\nlcd_putxy(2,0,buf);\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5558046, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/281d26d9ceea9c35d15338736b6f7827?s=128&d=identicon&r=PG&f=1", "display_name": "user_1", "link": "https://stackoverflow.com/users/5558046/user-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1254, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1481735932, "creation_date": 1481734738, "question_id": 41148145, "link": "https://stackoverflow.com/questions/41148145/how-to-scale-a-number-range-of-numbers-in-c", "title": "How to scale a number/range of numbers in c", "body": "<p>I want to be able to display the altitude in ft ranging from 0ft to 20000ft on my LCD module.  The numbers are read from a potentiometer that I can rotate to change the values.  At the moment the potentiometer displays from 0 to 1023 but I need to scale these appropriately so they read from 0-20000ft.  As well as this I want the line below to display a 'bar graph' to represent the altitude increasing.  The LCD has 20 blocks per line so the bar graph can range from 1 block to 20 blocks.</p>\n\n<pre><code>   sprintf(buf, \"Altitude: %d    \", DELVAL2);    // display altitude level\n   lcd_putxy(1,0,buf);\n   for (delay = 0; delay &lt; 50000; delay++);      // introduce a delay\n\n   sprintf(buf, \"*\", DELVAL2 );                  // display bar graph\n   lcd_putxy(2,0,buf);\n   for (delay = 0; delay &lt; 50000; delay++);      // introduce a delay\n</code></pre>\n\n<p>This is my code so far.  It reads the value from the potentiometer <code>DELVAL2</code> and displays it on the LCD.  Can someone please explain a method of how I can scale the data appropriately to produce an altitude and bar graph.</p>\n"}, {"tags": ["c", "arrays", "string", "split"], "comments": [{"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 1, "creation_date": 1481734297, "post_id": 41147884, "comment_id": 69498314, "body": "Why not just create some new fixed size arrays and manually copy the data in?"}, {"owner": {"reputation": 1, "user_id": 7257554, "user_type": "registered", "profile_image": "https://graph.facebook.com/1856431077927622/picture?type=large", "display_name": "Cristi Capbatut", "link": "https://stackoverflow.com/users/7257554/cristi-capbatut"}, "edited": false, "score": 0, "creation_date": 1481735042, "post_id": 41147884, "comment_id": 69498745, "body": "this is a row from db, i have a lot of rows in file and need to split this string into array of string( as host variable) and insert all rows in db. i know how to insert and other processing with bd, question is how to split string"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7257554, "user_type": "registered", "profile_image": "https://graph.facebook.com/1856431077927622/picture?type=large", "display_name": "Cristi Capbatut", "link": "https://stackoverflow.com/users/7257554/cristi-capbatut"}, "edited": false, "score": 0, "creation_date": 1481735290, "post_id": 41148011, "comment_id": 69498900, "body": "if i have 1000 strings like this in file? do it for each string in a loop? each string is split in the same mode."}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 1, "last_activity_date": 1481734343, "creation_date": 1481734343, "answer_id": 41148011, "question_id": 41147884, "link": "https://stackoverflow.com/questions/41147884/split-a-string-into-arrays-of-string-without-a-delimiter-in-c/41148011#41148011", "title": "Split a string into arrays of string without a delimiter in C", "body": "<p>you just have to do it the hard way.</p>\n\n<pre><code>char first[4];\nchar second[8];\n...\nmemcpy(first,str,3);\nfirst[3] = 0;\nmemcpy(second, str + 3, 7);\nsecond[7] = 0;\n...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7257554, "user_type": "registered", "profile_image": "https://graph.facebook.com/1856431077927622/picture?type=large", "display_name": "Cristi Capbatut", "link": "https://stackoverflow.com/users/7257554/cristi-capbatut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1481739775, "creation_date": 1481733996, "question_id": 41147884, "link": "https://stackoverflow.com/questions/41147884/split-a-string-into-arrays-of-string-without-a-delimiter-in-c", "title": "Split a string into arrays of string without a delimiter in C", "body": "<p>Need to split a string into array of strings. Problem is that i havent delimiters.\nFor example: if i have 0970909547091000000089942200 and i need to split into array of strings and know that firs string have 3 digits, second string have 7 digits, third string have 2 digits and the like. I search, but anywhere is answer with any delimiters.</p>\n"}, {"tags": ["c", "undefined-behavior"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 6, "creation_date": 1481734092, "post_id": 41147878, "comment_id": 69498164, "body": "double free does not have to give a error in the first place"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1481734179, "post_id": 41147878, "comment_id": 69498236, "body": "This is simply undefined behaviour."}, {"owner": {"reputation": 33, "user_id": 6818990, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c81b95d3c4ebda57e6609f07c550f574?s=128&d=identicon&r=PG&f=1", "display_name": "Gopala krishna", "link": "https://stackoverflow.com/users/6818990/gopala-krishna"}, "edited": false, "score": 0, "creation_date": 1481734211, "post_id": 41147878, "comment_id": 69498265, "body": "*** Error in `./app&#39;: double free or corruption (fasttop): 0x0000563f04897010 ***"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1481734274, "post_id": 41147878, "comment_id": 69498301, "body": "C is allowing you to do many bad things. Voiding the warranty, of course.."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 6, "last_activity_date": 1481739381, "last_edit_date": 1481739381, "creation_date": 1481734314, "answer_id": 41148002, "question_id": 41147878, "link": "https://stackoverflow.com/questions/41147878/why-the-following-code-is-not-giving-double-free-error/41148002#41148002", "title": "Why the following code is not giving double free error?", "body": "<p>There's no promise made that a double <code>free</code> will cause a segmentation fault.</p>\n\n<p>From the <a href=\"https://linux.die.net/man/3/free\" rel=\"nofollow noreferrer\">man page</a>:</p>\n\n<blockquote>\n  <p><code>free()</code> frees the memory space pointed to by <code>ptr</code>, which must  have \n  been returned by a previous call to <code>malloc()</code>, <code>calloc()</code> or <code>realloc()</code>. \n  <strong>Otherwise, or  if  <code>free(ptr)</code>  has  already  been  called  before, \n  undefined behaviour occurs.</strong>  If <code>ptr</code> is <code>NULL</code>, no operation is\n  performed.</p>\n</blockquote>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">Undefined behavior</a> means there are no guarantees regarding what will happen.  Your program may crash, it may exhibit strange behavior, or (as you've seen) it could appear to work correctly.  Making a seemingly unrelated change to your code can change how undefined behavior manifests itself, so it could start crashing or it could stop crashing.</p>\n\n<p>EDIT:</p>\n\n<p>Running a program through a tool such as Valgrind, as suggested by Toby, puts additional checks in place specifically to look for these types of errors and will tell you exactly where things are going wrong.  </p>\n\n<p>Without such a tool however, if you invoke undefined behavior all bets are off.</p>\n"}, {"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 2, "last_activity_date": 1481736419, "last_edit_date": 1481736419, "creation_date": 1481734950, "answer_id": 41148198, "question_id": 41147878, "link": "https://stackoverflow.com/questions/41147878/why-the-following-code-is-not-giving-double-free-error/41148198#41148198", "title": "Why the following code is not giving double free error?", "body": "<p>Perhaps you're using the wrong tool to test your program.  Valgrind certainly reports plenty of errors when I built your test program:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>gcc -std=c11 -fPIC -g -Wall -Wextra -Wwrite-strings -Wno-parentheses -Wpedantic -Warray-bounds      41147878.c    -o 41147878\nvalgrind  ./41147878 \n==30744== Memcheck, a memory error detector\n==30744== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==30744== Using Valgrind-3.12.0.SVN and LibVEX; rerun with -h for copyright info\n==30744== Command: ./41147878\n==30744== \n==30744== Invalid read of size 8\n==30744==    at 0x10876C: main (41147878.c:10)\n==30744==  Address 0x51d5038 is 8 bytes before a block of size 1 alloc'd\n==30744==    at 0x4C2ABAF: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x108751: main (41147878.c:7)\n==30744== \n0\n==30744== Invalid read of size 8\n==30744==    at 0x108797: main (41147878.c:12)\n==30744==  Address 0x51d5038 is 8 bytes before a block of size 1 free'd\n==30744==    at 0x4C2BDDB: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x10878E: main (41147878.c:11)\n==30744==  Block was alloc'd at\n==30744==    at 0x4C2ABAF: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x108751: main (41147878.c:7)\n==30744== \n0\n==30744== Invalid free() / delete / delete[] / realloc()\n==30744==    at 0x4C2BDDB: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x1087C5: main (41147878.c:14)\n==30744==  Address 0x51d5040 is 0 bytes inside a block of size 1 free'd\n==30744==    at 0x4C2BDDB: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x10878E: main (41147878.c:11)\n==30744==  Block was alloc'd at\n==30744==    at 0x4C2ABAF: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x108751: main (41147878.c:7)\n==30744== \n==30744== Invalid free() / delete / delete[] / realloc()\n==30744==    at 0x4C2BDDB: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x1087D1: main (41147878.c:15)\n==30744==  Address 0x51d5090 is 0 bytes inside a block of size 1 free'd\n==30744==    at 0x4C2BDDB: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x1087B9: main (41147878.c:13)\n==30744==  Block was alloc'd at\n==30744==    at 0x4C2ABAF: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x10875F: main (41147878.c:8)\n==30744== \n==30744== Invalid free() / delete / delete[] / realloc()\n==30744==    at 0x4C2BDDB: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x1087DD: main (41147878.c:16)\n==30744==  Address 0x51d5040 is 0 bytes inside a block of size 1 free'd\n==30744==    at 0x4C2BDDB: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x10878E: main (41147878.c:11)\n==30744==  Block was alloc'd at\n==30744==    at 0x4C2ABAF: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x108751: main (41147878.c:7)\n==30744== \n==30744== Invalid free() / delete / delete[] / realloc()\n==30744==    at 0x4C2BDDB: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x1087E9: main (41147878.c:17)\n==30744==  Address 0x51d5090 is 0 bytes inside a block of size 1 free'd\n==30744==    at 0x4C2BDDB: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x1087B9: main (41147878.c:13)\n==30744==  Block was alloc'd at\n==30744==    at 0x4C2ABAF: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30744==    by 0x10875F: main (41147878.c:8)\n==30744== \n==30744== \n==30744== HEAP SUMMARY:\n==30744==     in use at exit: 0 bytes in 0 blocks\n==30744==   total heap usage: 3 allocs, 7 frees, 1,026 bytes allocated\n==30744== \n==30744== All heap blocks were freed -- no leaks are possible\n==30744== \n==30744== For counts of detected and suppressed errors, rerun with: -v\n==30744== ERROR SUMMARY: 6 errors from 6 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>If you were using some other checker to conduct your test, you should edit the question to be more specific.</p>\n"}], "owner": {"reputation": 33, "user_id": 6818990, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c81b95d3c4ebda57e6609f07c550f574?s=128&d=identicon&r=PG&f=1", "display_name": "Gopala krishna", "link": "https://stackoverflow.com/users/6818990/gopala-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1541531232, "creation_date": 1481733987, "last_edit_date": 1541531232, "question_id": 41147878, "link": "https://stackoverflow.com/questions/41147878/why-the-following-code-is-not-giving-double-free-error", "title": "Why the following code is not giving double free error?", "body": "<p>When I do two consecutive <code>free()</code>'s on same pointer it is giving double free error but when I try to free the same pointer two times in between i freed other pointer it is not giving  the error.</p>\n\n<pre><code>#include &lt;stdio.h&gt;                                                              \n#include &lt;stdlib.h&gt;                                                             \nint main (){                                                                               \n   long int*ptr;                                                              \n    int *ptr1;                                                                  \n\n    ptr = malloc (1);                                                           \n    ptr1 = malloc (1);                                                          \n\n    printf (\"%ld\\n\", ptr[-1]);                                                  \n    free (ptr);                                                                 \n    printf (\"%ld\\n\", ptr[-1]);                                                  \n    free (ptr1);                                                                \n    free (ptr);                                                                 \n    free (ptr1);                                                                \n    free (ptr);                                                                 \n    free (ptr1);                                                                \n    return 0;                                                                   \n} \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1481733690, "post_id": 41147707, "comment_id": 69497906, "body": "A while loop is a god awful way to update the cursors position, aside from that it probably stays in the same place since you only ever pass it 0,0 as it&#39;s coords"}], "answers": [{"comments": [{"owner": {"reputation": 388, "user_id": 969429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oOGKW.jpg?s=128&g=1", "display_name": "Phil_12d3", "link": "https://stackoverflow.com/users/969429/phil-12d3"}, "reply_to_user": {"reputation": 1, "user_id": 6909702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33c0b0187a22f41ca2525b7f583e4237?s=128&d=identicon&r=PG&f=1", "display_name": "Sami", "link": "https://stackoverflow.com/users/6909702/sami"}, "edited": false, "score": 0, "creation_date": 1481796928, "post_id": 41147788, "comment_id": 69523987, "body": "No problem, it happens."}], "tags": [], "owner": {"reputation": 388, "user_id": 969429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oOGKW.jpg?s=128&g=1", "display_name": "Phil_12d3", "link": "https://stackoverflow.com/users/969429/phil-12d3"}, "is_accepted": false, "score": 1, "last_activity_date": 1481733771, "creation_date": 1481733771, "answer_id": 41147788, "question_id": 41147707, "link": "https://stackoverflow.com/questions/41147707/cursor-is-not-moving/41147788#41147788", "title": "Cursor is not moving", "body": "<p>Move </p>\n\n<pre><code>int x = 0, y = 0;\n</code></pre>\n\n<p>above <code>while(1)</code>. You are resetting <code>x</code> and <code>y</code> to zero before you call <code>gotoxy</code> each time.</p>\n"}], "owner": {"reputation": 1, "user_id": 6909702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33c0b0187a22f41ca2525b7f583e4237?s=128&d=identicon&r=PG&f=1", "display_name": "Sami", "link": "https://stackoverflow.com/users/6909702/sami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1481733771, "creation_date": 1481733521, "question_id": 41147707, "link": "https://stackoverflow.com/questions/41147707/cursor-is-not-moving", "title": "Cursor is not moving", "body": "<p>I am making a notepad through a double linked list, I have made a cursor function that will move with the linked list. But when I insert characters in the linked list the cursor stays at the start, even though I am incrementing as follows:</p>\n\n<pre><code>void gotoxy(int x, int y) {\n   COORD coord;\n   coord.X = x; coord.Y = y;\n   SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), coord);\n}\n\nint main() {\nstruct DLLADT notepad;\ninit(&amp;notepad);\nchar c; \n\nwhile (1) {\n    int x = 0, y = 0;\n    gotoxy(x, y);\n    c = getch();\n\n    if (c == 13) {\n        insertDoubly(&amp;notepad, '\\n'); // User pressed Enter\n        y++;\n    } else {\n        insertDoubly(&amp;notepad, c);\n        system(\"cls\");\n        printDoubly(&amp;notepad);\n        x++;\n    }\n}\n\nreturn 0;\ngetch();\n</code></pre>\n\n<p>I am using codeblocks</p>\n"}, {"tags": ["c", "variables", "scope", "global-variables", "lifetime"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1481732175, "post_id": 41147208, "comment_id": 69496862, "body": "The question that can be answered by &quot;Yes&quot; or &quot;No&quot; is a <i>bad</i> question for SO format."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1481732240, "post_id": 41147208, "comment_id": 69496899, "body": "Yes specially because you left any explanation out of the scope. You should trust your understanding too, you are reasoning cleanly about it and it does make sense. So why ask?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1481732284, "post_id": 41147208, "comment_id": 69496931, "body": "It depends on many factors, but usually it is pointless to care about this."}, {"owner": {"reputation": 365, "user_id": 3117573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TEuTH.jpg?s=128&g=1", "display_name": "mnish", "link": "https://stackoverflow.com/users/3117573/mnish"}, "edited": false, "score": 1, "creation_date": 1481732339, "post_id": 41147208, "comment_id": 69496979, "body": "Totally depends on the cache behavior. Both could be like 100x faster than the other based on the usage pattern."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1481732499, "post_id": 41147208, "comment_id": 69497085, "body": "There is no &quot;stack&quot;. There are only objects with <i>automatic storage duration</i>, which may be kept in registers if their address is never taken. On practically all processor architectures, accessing a register is much faster than the memory access required for accessing an object with <i>static storage duration</i> like a global."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 2, "creation_date": 1481732718, "post_id": 41147208, "comment_id": 69497239, "body": "There is no extra work to &quot;allocate&quot; a value on the stack.  The stack pointer is just moved by a different number.  Access time is the same to offset a value by the stack pointer as to offset it by a data segment register.  So your thinking is mostly wrong."}], "answers": [{"comments": [{"owner": {"reputation": 2547, "user_id": 1027055, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/pFD7t.png?s=128&g=1", "display_name": "mc.dev", "link": "https://stackoverflow.com/users/1027055/mc-dev"}, "edited": false, "score": 0, "creation_date": 1543531952, "post_id": 41148360, "comment_id": 93964186, "body": "what if a variable is too big to be kept inside registers? Lets say I create int[10000] array and iterate over it in the loop. If array is created locally on every function call, it&#39;s probably going to be slower than allocate same array once in global space and then reuse it."}, {"owner": {"reputation": 5213, "user_id": 6757971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1q1Q.jpg?s=128&g=1", "display_name": "Leon Carlo Valencia", "link": "https://stackoverflow.com/users/6757971/leon-carlo-valencia"}, "reply_to_user": {"reputation": 2547, "user_id": 1027055, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/pFD7t.png?s=128&g=1", "display_name": "mc.dev", "link": "https://stackoverflow.com/users/1027055/mc-dev"}, "edited": false, "score": 0, "creation_date": 1556137506, "post_id": 41148360, "comment_id": 98340052, "body": "In such cases, the developer should dynamically allocate the variable and pass around the pointer. Putting it in the stack (local variable) is not a good idea due to its limited size. Making it global is not a good idea either unless it really is a constant."}, {"owner": {"reputation": 456, "user_id": 5703461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/swOnq.png?s=128&g=1", "display_name": "ferdepe", "link": "https://stackoverflow.com/users/5703461/ferdepe"}, "edited": false, "score": 0, "creation_date": 1600684945, "post_id": 41148360, "comment_id": 113155057, "body": "You&#39;re right @LeonCarloValencia. Nevertheless, dynamically allocation should not be used under some directives (MISRA). In this case, what I do is declaring the array inside the function scope as static instead of global."}], "tags": [], "owner": {"reputation": 5213, "user_id": 6757971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1q1Q.jpg?s=128&g=1", "display_name": "Leon Carlo Valencia", "link": "https://stackoverflow.com/users/6757971/leon-carlo-valencia"}, "is_accepted": true, "score": 10, "last_activity_date": 1481735461, "creation_date": 1481735461, "answer_id": 41148360, "question_id": 41147208, "link": "https://stackoverflow.com/questions/41147208/are-global-variables-faster-than-local-variables-in-c/41148360#41148360", "title": "Are global variables faster than local variables in C?", "body": "<p>It's rather inaccurate.</p>\n\n<p>If you study computer architecture, you'll find out that the fastest storage are the registers, followed by the caches, followed by the RAM. The thing about local variables is that the compiler optimizes them to be allocated from the registers if possible, or from the cache if not. This is why local variables are faster.</p>\n\n<p>For embedded systems, sure it might be possible to compile to a tiny memory model in which case your data segment may possibly fit into a modern controller's SRAM cache. But in such cases, your local variable usage would also be very tight such that they are probably operating entirely on registers.</p>\n\n<p>Conclusion: In most cases, local variables will be faster than global variables.</p>\n"}], "owner": {"reputation": 227, "user_id": 7019978, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db5a35293f57ef2941b6decefa776b0f?s=128&d=identicon&r=PG&f=1", "display_name": "user628544", "link": "https://stackoverflow.com/users/7019978/user628544"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3430, "favorite_count": 3, "closed_date": 1481735812, "accepted_answer_id": 41148360, "answer_count": 1, "score": 6, "last_activity_date": 1481735461, "creation_date": 1481731934, "question_id": 41147208, "link": "https://stackoverflow.com/questions/41147208/are-global-variables-faster-than-local-variables-in-c", "closed_reason": "Needs more focus", "title": "Are global variables faster than local variables in C?", "body": "<p>I had a couple thoughts on this.  The first is that allocating global variables may be faster, since they are only allocated once, at the time the program is first spawned, whereas local variables must be allocated every time a function is called.  My second thought is that since local variables are on the stack, they are accessed through the base pointer register, so the value stored in the base pointer must be decremented every time a local variable is accessed; global variables are accessed directly through their static addresses in the data segment.  Is my thinking accurate?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1481730999, "post_id": 41146863, "comment_id": 69496031, "body": "It is possible, but it generally doesn&#39;t make sense."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 2, "creation_date": 1481731101, "post_id": 41146863, "comment_id": 69496113, "body": "Try this: <code>system(&quot;&#47;path&#47;filename.sh&quot;);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 511, "user_id": 7297569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9798b8e7b391ce57a9533e9e691bdb8a?s=128&d=identicon&r=PG&f=1", "display_name": "A.N", "link": "https://stackoverflow.com/users/7297569/a-n"}, "is_accepted": false, "score": 2, "last_activity_date": 1481732954, "last_edit_date": 1495541326, "creation_date": 1481732029, "answer_id": 41147240, "question_id": 41146863, "link": "https://stackoverflow.com/questions/41146863/is-it-possible-to-include-a-shell-script-in-a-c-program/41147240#41147240", "title": "Is it possible to include a shell script in a C program", "body": "<p>Yes its definately possible to call shell scripts or other scripts/executables from C using <code>system(..)</code> function call. Check <a href=\"http://man7.org/linux/man-pages/man3/system.3.html\" rel=\"nofollow noreferrer\">system(3)</a>.  </p>\n\n<p>For the given task of copying directories and subdirectories you can easily code it in C using <code>opendir()</code>, <code>readdir()</code>, and other API's.</p>\n\n<p>Check <a href=\"https://stackoverflow.com/questions/9192295/copy-directory-recursively-in-pure-c-on-linux-unix\">Copy directory recursively in pure C on Linux/UNIX</a> for more details</p>\n"}], "owner": {"reputation": 21, "user_id": 7224932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GNrsN.png?s=128&g=1", "display_name": "daniel Graham", "link": "https://stackoverflow.com/users/7224932/daniel-graham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513949839, "creation_date": 1481730939, "last_edit_date": 1513949839, "question_id": 41146863, "link": "https://stackoverflow.com/questions/41146863/is-it-possible-to-include-a-shell-script-in-a-c-program", "title": "Is it possible to include a shell script in a C program", "body": "<p>I've been successful in writing a C program that copies files from one directory to another and I'm trying to write one that copies directories and sub-directories to another directory.</p>\n\n<p>I've equally been able to write a shell script that copies directories and sub-directories from one location to another. </p>\n\n<p>So, I wish to ask if it is possible to include a shell script into a C program so I won't have to spend time writing another C program to copy directories and sub-directories.</p>\n"}, {"tags": ["c", "arrays", "struct", "malloc", "realloc"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1481730785, "post_id": 41146751, "comment_id": 69495872, "body": "You are invoking undefined behavior - it&#39;s &quot;working&quot; because your compiler&#39;s implementation happens to produce that kind of code (Which may just be coincidental, change with changes to the code, be different on a different compiler, change with optimization level, ....)"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 7241384, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/584f7b7bdf9770265b38f48dea1ecb21?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Per", "link": "https://stackoverflow.com/users/7241384/jason-per"}, "edited": false, "score": 0, "creation_date": 1481731015, "post_id": 41146805, "comment_id": 69496040, "body": "does this mean that my code is correct, because here I see a different syntax for the same task   <a href=\"http://stackoverflow.com/questions/6169972/realloc-an-array-of-structs?rq=1\" title=\"realloc an array of structs\">stackoverflow.com/questions/6169972/&hellip;</a>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 129, "user_id": 7241384, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/584f7b7bdf9770265b38f48dea1ecb21?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Per", "link": "https://stackoverflow.com/users/7241384/jason-per"}, "edited": false, "score": 0, "creation_date": 1481731052, "post_id": 41146805, "comment_id": 69496069, "body": "Your code is absolutely not correct. You can&#39;t access position 13 legally in a 10 element array."}, {"owner": {"reputation": 129, "user_id": 7241384, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/584f7b7bdf9770265b38f48dea1ecb21?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Per", "link": "https://stackoverflow.com/users/7241384/jason-per"}, "edited": false, "score": 0, "creation_date": 1481731094, "post_id": 41146805, "comment_id": 69496105, "body": "Thank you ! This is what I needed"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 5, "last_activity_date": 1481730785, "creation_date": 1481730785, "answer_id": 41146805, "question_id": 41146751, "link": "https://stackoverflow.com/questions/41146751/malloc-and-realloc-array-of-structs/41146805#41146805", "title": "Malloc and Realloc array of structs", "body": "<p>The behaviour of the program is <em>undefined</em>.</p>\n\n<p>You are accessing memory that doesn't belong to you.</p>\n\n<p>(What could well be happening is that <code>realloc</code> is obtaining more memory from the operating system than is actually required).</p>\n"}], "owner": {"reputation": 129, "user_id": 7241384, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/584f7b7bdf9770265b38f48dea1ecb21?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Per", "link": "https://stackoverflow.com/users/7241384/jason-per"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 41146805, "answer_count": 1, "score": 1, "last_activity_date": 1481730785, "creation_date": 1481730649, "question_id": 41146751, "link": "https://stackoverflow.com/questions/41146751/malloc-and-realloc-array-of-structs", "title": "Malloc and Realloc array of structs", "body": "<p>I am defining a type of structures</p>\n\n<pre><code>typedef struct structs{\nint freeSpace;\n} structs;   \n</code></pre>\n\n<p>I am creating a pointer to a structure</p>\n\n<pre><code>structs* arrayOfStructs;\n</code></pre>\n\n<p>I am allocating memory for array of size 5 of that structure</p>\n\n<pre><code>arrayOfStructs = malloc(5 * sizeof (arrayOfStructs));\narrayOfStructs[3].freeSpace = 99;\nprintf(\"\\n%d\", arrayOfStructs[3].freeSpace);\n</code></pre>\n\n<p>At some point I am reallocating that memory to array of size 10</p>\n\n<pre><code>arrayOfStructs = realloc(arrayOfStructs, 10 * sizeof (arrayOfStructs));\narrayOfStructs[8].freeSpace = 9;\nprintf(\"\\n%d\", arrayOfStructs[8].freeSpace);\n</code></pre>\n\n<p>And here I am setting freespace 17 at position 13 of the array which I expect to have only 10 positions.</p>\n\n<pre><code>arrayOfStructs[13].freeSpace = 17;\nprintf(\"\\n%d\", arrayOfStructs[13].freeSpace);\nfree(arrayOfStructs);\n</code></pre>\n\n<p>Why is this working ? What am I doing wrong ?</p>\n"}, {"tags": ["c", "user-input"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1481728300, "post_id": 41145908, "comment_id": 69494271, "body": "Read the data to a char* buffer, and parse it."}, {"owner": {"reputation": 2612, "user_id": 706695, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/eb9a5e298a2050ebad7ee3d494a13e32?s=128&d=identicon&r=PG", "display_name": "HRgiger", "link": "https://stackoverflow.com/users/706695/hrgiger"}, "edited": false, "score": 0, "creation_date": 1481728387, "post_id": 41145908, "comment_id": 69494329, "body": "have you tried with atoi? <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_atoi.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/c_standard_library/c_function_atoi.htm</a>"}, {"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "reply_to_user": {"reputation": 2612, "user_id": 706695, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/eb9a5e298a2050ebad7ee3d494a13e32?s=128&d=identicon&r=PG", "display_name": "HRgiger", "link": "https://stackoverflow.com/users/706695/hrgiger"}, "edited": false, "score": 0, "creation_date": 1481729744, "post_id": 41145908, "comment_id": 69495191, "body": "@HRgiger don&#39;t suggest atoi, it is old unsafe and hard to use."}, {"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "reply_to_user": {"reputation": 2612, "user_id": 706695, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/eb9a5e298a2050ebad7ee3d494a13e32?s=128&d=identicon&r=PG", "display_name": "HRgiger", "link": "https://stackoverflow.com/users/706695/hrgiger"}, "edited": false, "score": 0, "creation_date": 1481729764, "post_id": 41145908, "comment_id": 69495205, "body": "@HRgiger <a href=\"https://stackoverflow.com/questions/17710018/why-shouldnt-i-use-atoi\" title=\"why shouldnt i use atoi\">stackoverflow.com/questions/17710018/why-shouldnt-i-use-atoi</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481730103, "post_id": 41145908, "comment_id": 69495391, "body": "Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 67, "user_id": 6942242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f47f8fbaba54cbaf66568ffc34e284f1?s=128&d=identicon&r=PG&f=1", "display_name": "NotAProgrammer", "link": "https://stackoverflow.com/users/6942242/notaprogrammer"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481730879, "post_id": 41145908, "comment_id": 69495936, "body": "@Olaf what was wrong with my question sir? :/"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1481781397, "post_id": 41145908, "comment_id": 69516110, "body": "a %d format specifier will not allow a character to be entered..   Note the logic of the posted code is rather convoluted.  But most of all, always check the returned value (not the parameter value) of any call to any of the <code>scanf()</code> family of functions to assure the operation was successful.  Suggest reading the <code>man</code> page for <code>scanf()</code>  to get all the details, but of current interest is the <code>returned value</code> paragraph."}], "answers": [{"comments": [{"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "edited": false, "score": 0, "creation_date": 1481729840, "post_id": 41146037, "comment_id": 69495244, "body": "I wouldn&#39;t suggest use of scanf either since it&#39;s hard to use and error-prone compared to <code>fgets</code> + <code>strtoull</code>"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "edited": false, "score": 0, "creation_date": 1481731820, "post_id": 41146037, "comment_id": 69496612, "body": "@cat I suggested it too and the link explains it very well. <code>sscanf()</code> approach works just as well as <code>strtoull</code>. I suppose copy-pasteable code is valued more on SO."}, {"owner": {"reputation": 5213, "user_id": 6757971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1q1Q.jpg?s=128&g=1", "display_name": "Leon Carlo Valencia", "link": "https://stackoverflow.com/users/6757971/leon-carlo-valencia"}, "edited": false, "score": 0, "creation_date": 1481740981, "post_id": 41146037, "comment_id": 69501951, "body": "I tried this... but it still accepts numeric input immediately followed by non-numeric characters as valid (i.e. 123sda is accepted as 123). Hence, I added a bit of additional code taking off from this one."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 3, "last_activity_date": 1481728644, "creation_date": 1481728644, "answer_id": 41146037, "question_id": 41145908, "link": "https://stackoverflow.com/questions/41145908/how-to-stop-user-entering-char-as-int-input-in-c/41146037#41146037", "title": "How to stop user entering char as int input in C", "body": "<blockquote>\n  <p>but how do I add to it so it also stops user from entering a char??</p>\n</blockquote>\n\n<p>You can't prevent user from entering character values. What you can do is check if <code>tktAdult</code> was successfully scanned.\nIf not, flush out everything from stdin:</p>\n\n<pre><code> bool valid = false;\n while (true) {\n ...\n\n    if (scanf(\"%d\", &amp;TktAdult) != 1) {\n       int c;\n       while ((c = getchar()) != EOF &amp;&amp; c != '\\n');\n    } else {\n       break;\n    }\n}\n</code></pre>\n\n<p>The better alternative is to use <a href=\"http://man7.org/linux/man-pages/man3/fgetc.3.html\" rel=\"nofollow noreferrer\"><code>fgets()</code></a> and then parse the line using <a href=\"http://man7.org/linux/man-pages/man3/scanf.3.html\" rel=\"nofollow noreferrer\"><code>sscanf()</code></a>.</p>\n\n<p>Also see: <a href=\"http://c-faq.com/stdio/scanfprobs.html\" rel=\"nofollow noreferrer\">Why does everyone say not to use scanf? What should I use instead?</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 644, "user_id": 7014281, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cSk7z.png?s=128&g=1", "display_name": "glauxosdever", "link": "https://stackoverflow.com/users/7014281/glauxosdever"}, "edited": false, "score": 0, "creation_date": 1481731744, "post_id": 41146306, "comment_id": 69496563, "body": "<code>getline()</code> is more useful than <code>fgets()</code>, since it can allocate the needed buffer. The problem however is that <code>fgets()</code> might be less portable."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 644, "user_id": 7014281, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cSk7z.png?s=128&g=1", "display_name": "glauxosdever", "link": "https://stackoverflow.com/users/7014281/glauxosdever"}, "edited": false, "score": 0, "creation_date": 1481733918, "post_id": 41146306, "comment_id": 69498055, "body": "@glauxosdever <code>getline()</code> is not part of the standard C library.  <code>fgets()</code> is part of the standard C library making <code>fgets()</code> <i>more  portable</i> than  <code>getline()</code>.  <code>getline()</code> has a weakness as it allows the hacker exploit of overwhelming computer resources based on user input.  Numeric input exceeding 100 characters is certainly an error or attack.  Code only needs to process the data in those cases, not allocate large memory."}, {"owner": {"reputation": 644, "user_id": 7014281, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cSk7z.png?s=128&g=1", "display_name": "glauxosdever", "link": "https://stackoverflow.com/users/7014281/glauxosdever"}, "edited": false, "score": 0, "creation_date": 1481734572, "post_id": 41146306, "comment_id": 69498466, "body": "Clearly a typo. I definitely meant <code>getline()</code> is less portable and not <code>fgets()</code>."}, {"owner": {"reputation": 644, "user_id": 7014281, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cSk7z.png?s=128&g=1", "display_name": "glauxosdever", "link": "https://stackoverflow.com/users/7014281/glauxosdever"}, "edited": false, "score": 1, "creation_date": 1481734714, "post_id": 41146306, "comment_id": 69498564, "body": "To be fair, while I&#39;m concerned much about security, I didn&#39;t ever think <code>getline()</code> could be exploitable this way. Good catch!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 644, "user_id": 7014281, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cSk7z.png?s=128&g=1", "display_name": "glauxosdever", "link": "https://stackoverflow.com/users/7014281/glauxosdever"}, "edited": false, "score": 0, "creation_date": 1481735226, "post_id": 41146306, "comment_id": 69498854, "body": "@glauxosdever I like <code>getline()</code> over <code>fgets()</code> for <i>file</i> input, not <code>stdin</code>, but even that is getting exploitable.  If a <code>getline_s()</code> existed with an upper bound, that would be good, yet then that is similar to<code>fgets()</code> with a pre-allocated buffer.    IMO, a robust user input function is not possible simple using current functions given todays nefarious users.  Feel like using <code>fgetc()</code> is the only safe building block.  Sigh."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 5, "last_activity_date": 1481729361, "creation_date": 1481729361, "answer_id": 41146306, "question_id": 41145908, "link": "https://stackoverflow.com/questions/41145908/how-to-stop-user-entering-char-as-int-input-in-c/41146306#41146306", "title": "How to stop user entering char as int input in C", "body": "<blockquote>\n  <p>... stop user from entering a negative value ...</p>\n</blockquote>\n\n<p>is not possible.  Users enter all sorts of gibberish.  Instead, read a <em>line</em> of user input and parse it for correctness.  Use <code>fgets()</code> for input, then  <code>sscanf()</code>, <code>strtol()</code>, etc. for parsing.</p>\n\n<pre><code>// return -1 on EOF\nint GetPositiveNumber(const char *prompt, const char *reprompt) {\n  char buf[100];\n  fputs(prompt, stdout);\n  fflush(stdout);\n  while (fgets(buf, sizeof buf, stdin)) [\n    int value;\n    if (sscanf(buf, \"%d\", &amp;value) == 1 &amp;&amp; value &gt; 0) {\n      return value;\n    }\n    fputs(reprompt, stdout);\n    fflush(stdout);\n  }\n  return -1;\n}\n\n// Usage\nint TktAdult = GetPositiveNumber(\n    \"\\nEnter amount of adult tickets:\" , \n    \"\\nPlease enter a positive number!\");\nif (TktAdult &lt; 0) Handle_End_of_File();\nelse Success(TktAdult);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1481734160, "post_id": 41146711, "comment_id": 69498215, "body": "Better to use <code>int ch</code> than <code>char ch</code> to prevent UB in the <code>is...()</code> calls and to detect <code>EOF</code> (which causes an infinite loop here).  Suggest adding a limit to the number of iterations in <code>while()</code> so <code>i</code> does not get too big."}, {"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "edited": false, "score": 1, "creation_date": 1481737216, "post_id": 41146711, "comment_id": 69500039, "body": "Please, don&#39;t suggest atoi. <a href=\"https://stackoverflow.com/questions/17710018/why-shouldnt-i-use-atoi\" title=\"why shouldnt i use atoi\">stackoverflow.com/questions/17710018/why-shouldnt-i-use-atoi</a>"}], "tags": [], "owner": {"reputation": 39, "user_id": 7162297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/88QKI.jpg?s=128&g=1", "display_name": "xw Lee", "link": "https://stackoverflow.com/users/7162297/xw-lee"}, "is_accepted": false, "score": 3, "last_activity_date": 1481730539, "creation_date": 1481730539, "answer_id": 41146711, "question_id": 41145908, "link": "https://stackoverflow.com/questions/41145908/how-to-stop-user-entering-char-as-int-input-in-c/41146711#41146711", "title": "How to stop user entering char as int input in C", "body": "<pre><code>// You can try this,  Filter all except for the digital characters\nint TktAdult;\nchar ch;\nchar str[10];\nint i = 0;\nprintf(\"\\nEnter amount of adult tickets:\");\nwhile ((ch = getchar()) != '\\n')\n{\n    // Filter all except for the digital characters\n    if(!isalpha(ch) &amp;&amp; isalnum(ch))\n        str[i++] = ch;\n}\nstr[i] = '\\0';\nTktAdult = atoi(str);\nprintf(\"Done [%d]\\n\", TktAdult);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5213, "user_id": 6757971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1q1Q.jpg?s=128&g=1", "display_name": "Leon Carlo Valencia", "link": "https://stackoverflow.com/users/6757971/leon-carlo-valencia"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481817056, "post_id": 41147834, "comment_id": 69536744, "body": "Except that scanf(&quot;%d&quot;, &amp;TktAdult) returns a negative value and not a 0 for non-numeric input. Yup, next is declared on top of that while along with declaration of TktAdult. It&#39;s just a code snippet with the declarations taken out. Anyway, I&#39;ve tested that code already for all 3 cases before posting it. So I&#39;m pretty confident it works."}], "tags": [], "owner": {"reputation": 5213, "user_id": 6757971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1q1Q.jpg?s=128&g=1", "display_name": "Leon Carlo Valencia", "link": "https://stackoverflow.com/users/6757971/leon-carlo-valencia"}, "is_accepted": true, "score": 2, "last_activity_date": 1481741060, "last_edit_date": 1481741060, "creation_date": 1481733878, "answer_id": 41147834, "question_id": 41145908, "link": "https://stackoverflow.com/questions/41145908/how-to-stop-user-entering-char-as-int-input-in-c/41147834#41147834", "title": "How to stop user entering char as int input in C", "body": "<p>The following code rejects user input that are:</p>\n\n<ul>\n<li>non-numeric as handled by // 1;</li>\n<li>negative numbers as handled by // 2;</li>\n<li><p>positive numbers followed by non-numeric chars as handled by //3</p>\n\n<pre><code>while (1) {\n    printf(\"\\nEnter amount of adult tickets: \");\n    if (scanf(\"%d\", &amp;TktAdult) &lt; 0 ||  // 1\n            TktAdult &lt; 0 ||  // 2\n            ((next = getchar()) != EOF &amp;&amp; next != '\\n')) {  // 3\n        clearerr(stdin);\n        do\n            next = getchar();\n        while (next != EOF &amp;&amp; next != '\\n');  // 4\n        clearerr(stdin);\n        printf(\"\\nPlease enter a positive number!\");\n    } else {\n        break;\n    }\n}\n</code></pre></li>\n</ul>\n\n<p>Also, // 4 clears the standard input of buffered non-numeric characters following case // 3 (i.e. 123sda - scanf takes 123 but leaves 'sda' in the buffer).</p>\n"}, {"tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1604512210, "last_edit_date": 1604512210, "creation_date": 1604511833, "answer_id": 64685132, "question_id": 41145908, "link": "https://stackoverflow.com/questions/41145908/how-to-stop-user-entering-char-as-int-input-in-c/64685132#64685132", "title": "How to stop user entering char as int input in C", "body": "<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int x = 0.0;\n    int readReasult;\n    while(1)\n    {\n        readReasult = scanf(&quot;%d&quot;,&amp;x);\n        if (readReasult &lt; 0) break;\n        if (readReasult == 1) {\n            if (x &gt;= 0)\n                printf(&quot;next number: %d\\n&quot;, x);\n            else\n                printf(&quot;negative value not expected\\n&quot;);\n        } else {\n            clearerr(stdin);\n            scanf(&quot;%*s&quot;);\n            printf(&quot;wrong input\\n&quot;);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n<p><a href=\"https://godbolt.org/z/xn86qz\" rel=\"nofollow noreferrer\">https://godbolt.org/z/xn86qz</a></p>\n"}], "owner": {"reputation": 67, "user_id": 6942242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f47f8fbaba54cbaf66568ffc34e284f1?s=128&d=identicon&r=PG&f=1", "display_name": "NotAProgrammer", "link": "https://stackoverflow.com/users/6942242/notaprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5839, "favorite_count": 1, "accepted_answer_id": 41147834, "answer_count": 5, "score": 1, "last_activity_date": 1604512210, "creation_date": 1481728227, "question_id": 41145908, "link": "https://stackoverflow.com/questions/41145908/how-to-stop-user-entering-char-as-int-input-in-c", "title": "How to stop user entering char as int input in C", "body": "<p>Heres a part of my code:</p>\n\n<pre><code>    printf(\"\\nEnter amount of adult tickets:\");\n    scanf(\"%d\", &amp;TktAdult);\n    while (TktAdult&lt;0){\n        printf(\"\\nPlease enter a positive number!\");\n        printf(\"\\nEnter amount of adult tickets:\");\n        scanf(\"%d\", &amp;TktAdult);\n    }\n</code></pre>\n\n<p>Right now it can only stop user from entering a negative value, but how do I add to it so it also stops user from entering a char??</p>\n"}, {"tags": ["c", "exec", "execvp"], "comments": [{"owner": {"reputation": 176, "user_id": 4805077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37Y4Z.jpg?s=128&g=1", "display_name": "saeleko", "link": "https://stackoverflow.com/users/4805077/saeleko"}, "edited": false, "score": 0, "creation_date": 1481729693, "post_id": 41145882, "comment_id": 69495154, "body": "Well if what you want is to execute cat with custom arguments, first ask the user the said arguments, then start cat with them. May I ask you why you want to do that?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1481730010, "post_id": 41145882, "comment_id": 69495340, "body": "You need to create a pipe, just like the shell does."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481730065, "post_id": 41145882, "comment_id": 69495370, "body": "You should totally change the question to &quot;how to execute a cat&quot;."}, {"owner": {"reputation": 1, "user_id": 7297264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2e4681861ddbf4ca5152f60dea25db?s=128&d=identicon&r=PG&f=1", "display_name": "vinny76", "link": "https://stackoverflow.com/users/7297264/vinny76"}, "edited": false, "score": 0, "creation_date": 1481730276, "post_id": 41145882, "comment_id": 69495518, "body": "All I want is first execute cat, and as we know when we just exec cat, the stdin blocks and ask us to fill it, then it send back the result by the same string which we had entered, that&#39;s what I&#39;m looking for ^^"}, {"owner": {"reputation": 176, "user_id": 4805077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37Y4Z.jpg?s=128&g=1", "display_name": "saeleko", "link": "https://stackoverflow.com/users/4805077/saeleko"}, "edited": false, "score": 0, "creation_date": 1481730479, "post_id": 41145882, "comment_id": 69495652, "body": "Isn&#39;t using <code>fgets</code> more efficient to read a string? Or do you have any particular reason to prefer cat ? It sounds very XY-ish in my opinion <a href=\"http://meta.stackexchange.com/a/66378\">meta.stackexchange.com/a/66378</a>"}, {"owner": {"reputation": 176, "user_id": 4805077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37Y4Z.jpg?s=128&g=1", "display_name": "saeleko", "link": "https://stackoverflow.com/users/4805077/saeleko"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1481730569, "post_id": 41145882, "comment_id": 69495718, "body": "Ah I saw your edit. If you need to execute any command and pass it user input after executing it you will need pipes as @iharob said"}, {"owner": {"reputation": 1, "user_id": 7297264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2e4681861ddbf4ca5152f60dea25db?s=128&d=identicon&r=PG&f=1", "display_name": "vinny76", "link": "https://stackoverflow.com/users/7297264/vinny76"}, "edited": false, "score": 0, "creation_date": 1481730713, "post_id": 41145882, "comment_id": 69495825, "body": "Yes but I wonder how can I do it ^^ , I already use pipe/fork to do it and when I type cat, it blocks me and it is here that I request words from my client. Do you want my code?"}, {"owner": {"reputation": 176, "user_id": 4805077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37Y4Z.jpg?s=128&g=1", "display_name": "saeleko", "link": "https://stackoverflow.com/users/4805077/saeleko"}, "edited": false, "score": 0, "creation_date": 1481730835, "post_id": 41145882, "comment_id": 69495905, "body": "Then you should post your code or we won&#39;t be able to help, yes."}, {"owner": {"reputation": 1, "user_id": 7297264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2e4681861ddbf4ca5152f60dea25db?s=128&d=identicon&r=PG&f=1", "display_name": "vinny76", "link": "https://stackoverflow.com/users/7297264/vinny76"}, "edited": false, "score": 0, "creation_date": 1481731575, "post_id": 41145882, "comment_id": 69496445, "body": "I did it, hope you will se what I mean ^^"}, {"owner": {"reputation": 176, "user_id": 4805077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37Y4Z.jpg?s=128&g=1", "display_name": "saeleko", "link": "https://stackoverflow.com/users/4805077/saeleko"}, "edited": false, "score": 0, "creation_date": 1481732817, "post_id": 41145882, "comment_id": 69497323, "body": "I haven&#39;t read the code more than that but it sure looks overly complicated. Did you write it all at once ? If not what&#39;s the last moment it worked as expected? If you wrote it all at once you should consider rewriting it bit by bit up to the point it does not do what you expect anymore. That&#39;s probably the error."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1539162225, "creation_date": 1539162225, "answer_id": 52736482, "question_id": 41145882, "link": "https://stackoverflow.com/questions/41145882/how-to-exec-only-cat-in-c/52736482#52736482", "title": "How to exec only cat in C", "body": "<blockquote>\n  <p>I already use pipe/fork to do it and when I type cat, it blocks me and it is here that I request words from my client.</p>\n</blockquote>\n\n<p>The foremost reason why your code blocks is that it calls <code>wait(NULL)</code> immediately after it has forked the child - thus it waits for the child to terminate before any attempt is made to send data through the pipe. You have to move the <code>wait()</code> call behind the <code>close(fd[0])</code>, where the communication is finished.</p>\n"}], "owner": {"reputation": 1, "user_id": 7297264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2e4681861ddbf4ca5152f60dea25db?s=128&d=identicon&r=PG&f=1", "display_name": "vinny76", "link": "https://stackoverflow.com/users/7297264/vinny76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 553, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539162251, "creation_date": 1481728168, "last_edit_date": 1539162251, "question_id": 41145882, "link": "https://stackoverflow.com/questions/41145882/how-to-exec-only-cat-in-c", "title": "How to exec only cat in C", "body": "<p>I'd like to know how can I exec only cat like this:</p>\n\n<p><br>\n<code>execvp(\"cat\", \"cat\", NULL);</code>\n<br></p>\n\n<p>and ask to a client to fill the rest of the command.</p>\n\n<p>For example: my client ask cat to the daemon. The daemon then ask to the client to fill cat by mkfifo, then the daemon read the pipe and send the result of the cat until the client stop to fill cat.</p>\n\n<p>Thanks for helping</p>\n\n<p>EDIT: this may not only work for cat. This should work for every commands that require any entry from the client. As required, I post my code :</p>\n\n<pre><code>void *run(void *dat)\n{\n   struct shared_memory *d = (struct shared_memory *)dat;\n   int fd[2];\n   int end = d-&gt;hasEnd;\n   if(pipe(fd) &lt;0){\n      perror(\"pipe failed\");\n      exit(EXIT_FAILURE);\n   }\n   if(strcmp(d-&gt;command[0], \"cat\") == 0 &amp;&amp; (strcmp(d-&gt;command[1],\",\")== 0 || strcmp(d-&gt;command[1],\"fin\") == 0)){\n        printf(\"dans la condition\\n\");\n        d-&gt;needClient = 1;\n   }\n   char pipe1[256];\n   char tube2[256];\n   strcpy(pipe1, d-&gt;pipe1);\n   strcpy(tube2, d-&gt;tube2);\n   switch(fork()){\n        case -1:\n            perror(\"fork\");\n            break;\n        case 0:\n            // redirection de l'entr\u00e9 standard\n            close(fd[0]);\n            dup2(fd[1], 1);\n            dup2(fd[1], 2);\n            close(fd[1]);\n            // \u00e9x\u00e9cution de la commande courrante.\n            execvp(d-&gt;command[0], d-&gt;command);\n            perror(\"execvp\");\n            break;\n        default:\n          // g\u00e8re les processus zombies.\n          if(wait(NULL) == -1){\n                perror(\"wait\");\n          }\n          if(d-&gt;needClient == 1){\n                int sortieTube;\n                char chaineALire[5000];\n                do /* Pas de for car l'objectif d'optimisation est que le client recoive l'int\u00e9gralit\u00e9 des r\u00e9ponses du d\u00e9mon au sujet de sa commande*/\n                {\n                    /****************  Lecture de la r\u00e9ponse du d\u00e9mon ******************/\n                    while((sortieTube = open (pipe1, O_RDONLY)) == -1)\n                    {\n                        sleep(1); // on attend qu'il y ai une quelconque r\u00e9ponse du d\u00e9mon.\n                    }\n                    if(read(sortieTube, chaineALire, sizeof(chaineALire)) == -1){\n                        perror(\"read\");\n                    }\n                    printf(\"%s\\n\", chaineALire);\n                    memset(chaineALire, 0, 5000);\n                }\n                while(d-&gt;needClient == 1);\n            }\n          unlink(d-&gt;pipe1);\n          unlink(d-&gt;tube2);\n          unlink(tube2);\n          //cr\u00e9ation du tube nomm\u00e9 pour le client.\n          if(mkfifo(tube2, 0644) != 0)\n          {\n              perror(\"mkfifo\");\n              fprintf(stderr, \"Impossible de cr\u00e9er le tube nomm\u00e9.\\n\");\n              exit(EXIT_FAILURE);\n          }\n          // ouverture de ce m\u00eame tube\n          if((d-&gt;entree_tube = open(tube2, O_WRONLY)) == -1)\n          {\n              perror(\"open\");\n              fprintf(stderr, \"Impossible d'ouvrir l'entr\u00e9e du tube nomm\u00e9.\\n\");\n              exit(EXIT_FAILURE);\n          }\n          char buffer[550000] = {0};\n          close(fd[1]);\n          // lecture du r\u00e9sultat de la commande stock\u00e9 dans fd[0]\n          while (read(fd[0], buffer, sizeof(buffer)) &gt;0)\n          {\n              //\u00e9criture du r\u00e9sultat dans l'entr\u00e9 du tube.\n             if(write(d-&gt;entree_tube, buffer, strlen(buffer)) == -1){\n                perror(\"write\");\n             }\n             //r\u00e9initialisation du buffer stockant une partie du r\u00e9sultat de la commande.\n             memset (buffer, 0, sizeof(buffer));\n          }\n          close(fd[0]);\n          // on regarde si il y a eu le mot cl\u00e9 \"fin\" pour alerter la client que la commande est termin\u00e9\n          // et on redonne la main \u00e0 un autre client tentant de se connecter au d\u00e9mon.\n          if(end == 1){\n            strcpy(d-&gt;fin, \"fin\");\n            d-&gt;hasEnd = 0;\n          }\n          unlink(d-&gt;pipe1);\n          unlink(tube2);\n          unlink(d-&gt;tube2);\n          break;\n   }\n   return NULL;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6418808, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fee0377cad69887e346e7d9144bac135?s=128&d=identicon&r=PG&f=1", "display_name": "juergen861", "link": "https://stackoverflow.com/users/6418808/juergen861"}, "edited": false, "score": 0, "creation_date": 1481880571, "post_id": 41149590, "comment_id": 69562052, "body": "Thanks a lot for Your help!  Our ideas are similar. But <a href=\"https://msdn.microsoft.com/de-de/library/windows/desktop/aa364218(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/de-de/library/windows/desktop/&hellip;</a> claims that setting the flag FILE_FLAG_NO_BUFFERING disables file caching. But when using      HANDLE hFile = CreateFileW(wFilename.c_str(), GENERIC_READ, 0, 0, OPEN_EXISTING, \tFILE_ATTRIBUTE_NORMAL | FILE_FLAG_NO_BUFFERING | FILE_FLAG_OVERLAPPED, \t0); Time behavior (slow on first loading, 5 times faster on subsequent loading) remains the same !?!? How does that fit with our file caching assumption? Thanks for any idea,  J&#252;rgen"}, {"owner": {"reputation": 201, "user_id": 7291911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acdca85267f3fcca6881f482693aec32?s=128&d=identicon&r=PG&f=1", "display_name": "fer-rum", "link": "https://stackoverflow.com/users/7291911/fer-rum"}, "reply_to_user": {"reputation": 29, "user_id": 6418808, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fee0377cad69887e346e7d9144bac135?s=128&d=identicon&r=PG&f=1", "display_name": "juergen861", "link": "https://stackoverflow.com/users/6418808/juergen861"}, "edited": false, "score": 0, "creation_date": 1481895262, "post_id": 41149590, "comment_id": 69570849, "body": "May be quirky OS behavior, a subtle implementation mistake, some other parts of your code that interfere or other running applications that interfere. Also: keep in mind that hard drives and SSDs may (and usually do) have an internal buffer that is beyond the OS&#39;s control."}], "tags": [], "owner": {"reputation": 201, "user_id": 7291911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acdca85267f3fcca6881f482693aec32?s=128&d=identicon&r=PG&f=1", "display_name": "fer-rum", "link": "https://stackoverflow.com/users/7291911/fer-rum"}, "is_accepted": false, "score": 1, "last_activity_date": 1481740073, "creation_date": 1481740073, "answer_id": 41149590, "question_id": 41145695, "link": "https://stackoverflow.com/questions/41145695/extreme-performance-difference-when-reading-same-files-a-second-time-with-c/41149590#41149590", "title": "Extreme performance difference, when reading same files a second time with C", "body": "<p>Educated guess here:\nYou most likely are right with your file cache assumption. </p>\n\n<p>Can you pre load files before the user runs the software?\nNot directly. How would your program be supposed to know that it is going to be run in the next few minutes?</p>\n\n<p>So you probably need a helper mechanism or tricks.\nThe options I see here are:</p>\n\n<ul>\n<li>Indexing mechanisms to provide a faster and better aimed access to your data. This is helpful if you only need small chunks of information from these data at once.</li>\n<li>Attempt to parallelize the loading of the data, so even if it does not really get faster, the user has the impression it does because he can start working already with the data he has, while the rest is fetched in the background.</li>\n<li>Have a helper tool starting up with the OS and pre-fetching everything, so you already have it in memory when required. <strong>Caution:</strong> This has serious implications since you reserve either a large chunk of RAM or even SSD-cache (depending on implementation) for your tool from the start. Only consider doing this if the alternative is the apocalypse\u2026</li>\n</ul>\n\n<p>You can also try to combine the first two options. The key to a faster data availability is to figure out what to read in which order instead of trying to load everything at once en-bloc. <a href=\"https://en.wikipedia.org/wiki/Divide_and_conquer\" rel=\"nofollow noreferrer\"><em>Divide and Conquer</em>.</a></p>\n\n<p>Without further details on the problem it is impossible to provide more specific solutions though.</p>\n"}], "owner": {"reputation": 29, "user_id": 6418808, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fee0377cad69887e346e7d9144bac135?s=128&d=identicon&r=PG&f=1", "display_name": "juergen861", "link": "https://stackoverflow.com/users/6418808/juergen861"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481740073, "creation_date": 1481727594, "last_edit_date": 1481735464, "question_id": 41145695, "link": "https://stackoverflow.com/questions/41145695/extreme-performance-difference-when-reading-same-files-a-second-time-with-c", "title": "Extreme performance difference, when reading same files a second time with C", "body": "<p>I have to read binary data into char-arrays from large (2GB) binary files in a C++ program.  When reading the files for the first time from my SSD, reading takes about 6.4 seconds per file. But when running the same code again or even after running a different dummy-program, which does almost the same before, the next readings take only about 1.4 seconds per file. The Windows Task Manager even shows much less disk-activity on the second, third, fourth\u2026 run. So, my guess is Window\u2019s File Caching is sparing me from waiting for data from the SSD, when filling the arrays another time.</p>\n\n<p>Is there any clean option to read the files into file cache before the customer runs the software? Any better option than just already loading the files with fread in advance? And how can I make sure, the data remains in the File Cache until I need it?</p>\n\n<p>Or am I totally wrong with my File Cache assumption? Is there another (better) explanation for these different loading times?</p>\n"}, {"tags": ["c", "linux", "multithreading", "signals"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1481730536, "post_id": 41145657, "comment_id": 69495695, "body": "Call <code>timer_create()</code> with a <code>struct sigevent</code> with <code>.sigev_notify = SIGEV_THREAD</code>."}], "answers": [{"tags": [], "owner": {"reputation": 8959, "user_id": 1182921, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5cbca9fe5b06dab4005212a4bf9a5416?s=128&d=identicon&r=PG", "display_name": "Tom Tanner", "link": "https://stackoverflow.com/users/1182921/tom-tanner"}, "is_accepted": false, "score": 2, "last_activity_date": 1481728450, "last_edit_date": 1481728450, "creation_date": 1481727700, "answer_id": 41145740, "question_id": 41145657, "link": "https://stackoverflow.com/questions/41145657/creating-a-thread-in-signal-handlers/41145740#41145740", "title": "Creating a thread in signal handlers", "body": "<p>Signal handlers may not call non re-entrant functions. You should look at your o/s documentation but creating a thread is unlikely to be re-entrant. On linux, <code>man -s7 signal</code> gives you a list of safe to call functions, which doesn't include anything from pthread.</p>\n\n<p>Really all a signal handler should do is to set a flag for the main code or a signal handling thread to read. More than that gets risky.</p>\n"}], "owner": {"reputation": 365, "user_id": 2294991, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/beda6ed4a3aba7b355f3b4cbfa76b078?s=128&d=identicon&r=PG", "display_name": "Rama P", "link": "https://stackoverflow.com/users/2294991/rama-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1481728450, "creation_date": 1481727458, "question_id": 41145657, "link": "https://stackoverflow.com/questions/41145657/creating-a-thread-in-signal-handlers", "title": "Creating a thread in signal handlers", "body": "<p>In my program I need to perform some action upon timer (timer_create()) expiration. I want to perform this action by spawning a new thread. So I want to know if it is safe to create a thread in signal handlers?</p>\n"}, {"tags": ["c++", "c", "simd", "avx", "avx2"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1481727008, "post_id": 41145460, "comment_id": 69493398, "body": "Because of a strict aliasing violation. Compile with <code>-O3 -fno-strict-aliasing</code> and it should solve the problem."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1481727008, "post_id": 41145460, "comment_id": 69493399, "body": "The cast invokes UB. Write compliant code using a <code>union</code>."}, {"owner": {"reputation": 17899, "user_id": 1018562, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ca58bb22c2bf586eb0c11e94d79d031e?s=128&d=identicon&r=PG", "display_name": "pythonic", "link": "https://stackoverflow.com/users/1018562/pythonic"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481727040, "post_id": 41145460, "comment_id": 69493417, "body": "@Olaf: UB. What is that?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1481727044, "post_id": 41145460, "comment_id": 69493420, "body": "Try with <code>-fno-strict-aliasing</code> - all that nasty type-punning may be causing problems."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1481727093, "post_id": 41145460, "comment_id": 69493464, "body": "Seriously? <b>undefined behaviour</b>. Something every C programmer should know about right after his very first <code>hello world</code>. If you don&#39;t know, you definitively should research about it. And don&#39;t mess with compiler options here."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481727118, "post_id": 41145460, "comment_id": 69493490, "body": "@pythonic UB is C slang for &quot;undefined behavior&quot;, meaning that you have a bug in your program where you did things beyond what the C standard guarantees, which in turn can cause anything to happen."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1481727459, "post_id": 41145460, "comment_id": 69493730, "body": "@Olaf Using <code>-fno-strict-aliasing</code> is an acceptable solution. GCC has taken optimizations to the extreme in this case. More useful compilers implement a non-standard extension instead, and the C standard may be damned. Trying to write for example embedded systems programming without violating strict aliasing is a major pain - why embedded compilers implement deterministic non-standard behavior. The strict aliasing rule is mostly a bug in the C standard, caused by clueless PC programmers having too much influence in the C committee."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481727978, "post_id": 41145460, "comment_id": 69494079, "body": "In fact, <code>-fno-strict-aliasing</code> may be your only reasonable choice here, unless I&#39;m missing something. &quot;Legal&quot; type punning using a union won&#39;t work; the optimizer is too smart for it and still elides all of the intrinsics. Basically everything else I can think of that you could do would result in an explosion of code, which is precisely what you <i>don&#39;t</i> want when you&#39;re trying to write hand-optimized code using intrinsics. @lundin I&#39;m not sure that this is actually a duplicate. Certainly the duplicate does not contain a good answer to the question, how do I make this work!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481728348, "post_id": 41145460, "comment_id": 69494307, "body": "@Lundin: How come I manage to write large embedded projects with gcc and without need to reort to such options? What&#39;s the problem using a <code>union here</code>? gcc just follows the standard and targets optimal code. and gcc provides enough extensions where necessary to even support special constructs. E.g. compiler barriers, etc. Before starting something I would inspect the machine code generated for both optimisations. Problem is casting the <code>char []</code> to <code>uint64_t</code> is problematic also for alignment issues. If not UB, it can introduce a major performance penalty."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 1, "creation_date": 1481728527, "post_id": 41145460, "comment_id": 69494441, "body": "@CodyGray If you show it inside a union, then it sates the strict aliasing rule. As for if this is a duplicate or not, I think the first step here is to illuminate the OP what this is about. We don&#39;t need yet another thread explaining that. If the canonical duplicate is bad for some reason (I think not), then anyone is free to improve it. Once the OP grasps what strict aliasing is, they may of course ask a new question &quot;how to fix strict aliasing violations in this code&quot;."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1481728730, "post_id": 41145460, "comment_id": 69494573, "body": "Yes, a union fixes the strict aliasing rule. <b>It does <i>not</i>, however, fix the problem.</b> The object code emitted by GCC is identical, whether you use pythonic&#39;s original code or rewrite it to use a union. As such, it does not answer the question in a useful way. But sure, fine, I guess you can always ask it as a new question."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481728860, "post_id": 41145460, "comment_id": 69494644, "body": "@Olaf Example 1: write a generic eeprom driver. The driver must write 32 bits to memory at a time because of hardware requirements, but it must be able to accept a pointer to any form of data. Example 2: receive data from a serial bus, in the form of <code>uint8_t</code> bytes. Now convert this data to the correct, larger types. You may not use struct or union because they have padding and the code needs to be portable. And so on. You need to do a lot of fiddling and ugly patches to sort out such situations, if you care about strict aliasing."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481729053, "post_id": 41145460, "comment_id": 69494766, "body": "@Lundin: The interface of such a driver is broken by design already. And typical 32 bit embedded systems support aligned accesses only, so you either pass a <code>uint32_t []</code> or (better) a <code>uint8_t []</code> and use byte-accesses. EEPROM accesses are not really time-critical. An alternative would be to leave the transfer to DMA, which might require additional measures anyway (compiler/memory barriers). For the serial transfer (very familar to me), you use proper marshaling with shifts and leave optimisation to the compiler.  ..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481729186, "post_id": 41145460, "comment_id": 69494850, "body": "... After all the major reason gcc exploits UB that much is because it tries to optimise agressively. I prefer this attitude over compilers which tolerate careless programmers. And no, there is nothing ugly about my code - the opposite is true."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1481729417, "post_id": 41145460, "comment_id": 69495001, "body": "@Olaf The alignment requirements of a eeprom/data flash memory are not necessarily the same as the CPU! Often you might have to write a whole segment at the same time, because you had to erase it before writing to it. EEPROM writes can certainly be time critical, take for example the trip meter in your car. Anyway, the point here is that the aliasing rules and effective type were introduced in C99 because of some PC compiler vendor lobbying. The committee could have made the decision to fix known cases of undefined behavior instead of adding more, but didn&#39;t. Thus this is a C standard bug IMO."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481729599, "post_id": 41145460, "comment_id": 69495098, "body": "@Lundin: Depends on how the EEPROM is connected to the CPU. If that is through the normal bus-interface, of course you have to follow the CPU restrictions. For typical (external) EEPROMs you use some buffer-register anyway, so there is no direct relation between the data in memory and the EEPROM anyway and you can use bitops to merge/split bytes to words. And IIRC, the aliasing was an issue with C90 anyway. I&#39;m fine with that and my code is neither slowed down, not ugly using proper marshalling. And C11 provides measures to support proper alignment of buffers very well."}], "owner": {"reputation": 17899, "user_id": 1018562, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ca58bb22c2bf586eb0c11e94d79d031e?s=128&d=identicon&r=PG", "display_name": "pythonic", "link": "https://stackoverflow.com/users/1018562/pythonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "closed_date": 1481727037, "answer_count": 0, "score": 1, "last_activity_date": 1481727014, "creation_date": 1481726876, "last_edit_date": 1481727014, "question_id": 41145460, "link": "https://stackoverflow.com/questions/41145460/output-of-m256i-changes-with-optimization-level", "closed_reason": "Duplicate", "title": "Output of _m256i changes with optimization level", "body": "<p>I have the following code which I compiled with g++ 6.1 on windows using the MinGW compiler.</p>\n\n<pre><code>unsigned char test_uc[8] = {0, 0xaa, 0xbb, 0xcc, 0x11, 0x22, 0x33, 0x44};\n\nuint64_t* p64 = (uint64_t*)test_uc;\n__m256i res = _mm256_cvtepu8_epi32 (_mm_cvtsi64_si128(*p64));\nuint32_t* u32 = (uint32_t*)&amp;res;\nfor(int i = 0; i &lt; 8; i++)\n    printf(\"%d.0x%x\\n\", i, u32[i]);\n</code></pre>\n\n<p>When I run the program with optimization level -O1, I get the expected output as shown below.</p>\n\n<pre><code>0.0x0\n1.0xaa\n2.0xbb\n3.0xcc\n4.0x11\n5.0x22\n6.0x33\n7.0x44\n</code></pre>\n\n<p>However, if I switch to optimization level -O3, I get this strange output.</p>\n\n<pre><code>0.0x0\n1.0x0\n2.0x0\n3.0x0\n4.0x8\n5.0x0\n6.0x41027f\n7.0x0\n</code></pre>\n\n<p>What is going on here?</p>\n"}, {"tags": ["c", "new-operator"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1481726730, "post_id": 41145365, "comment_id": 69493165, "body": "We can&#39;t read your mind and figure out what the code is supposed to do. Please add more explanation."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1481726804, "post_id": 41145365, "comment_id": 69493228, "body": "This looks as if you wanted a loop (<code>while</code>) and a condition (<code>if</code>), but you have two conditoions here. Otherwise, how do you expect <code>j</code> to get to 26?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1481726821, "post_id": 41145365, "comment_id": 69493247, "body": "@chrisjn  How do you want to compare the arrays? Do you want to check whether they are equal or that the first one is not less than the second one?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481727207, "post_id": 41145365, "comment_id": 69493546, "body": "I suppose you need a <code>while</code> loop instead of a <code>if</code>, something like <code>while user[j] &gt;=  dirctionary[j]</code>."}, {"owner": {"reputation": 21821, "user_id": 3987294, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4751b219bec937f1c58a18de85dcd06?s=128&d=identicon&r=PG&f=1", "display_name": "nicola", "link": "https://stackoverflow.com/users/3987294/nicola"}, "edited": false, "score": 0, "creation_date": 1481727209, "post_id": 41145365, "comment_id": 69493549, "body": "A rather verbose way of writing <code>return 1;</code>..."}, {"owner": {"reputation": 1, "user_id": 7297124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c18f9a8bf2c8f58621592f02f5d5b932?s=128&d=identicon&r=PG&f=1", "display_name": "chrisjn", "link": "https://stackoverflow.com/users/7297124/chrisjn"}, "edited": false, "score": 0, "creation_date": 1481728473, "post_id": 41145365, "comment_id": 69494400, "body": "This code is to compare letters entered with words in a document and it should spit out what words you can spell. My issue is that the code isn&#39;t printing anything no matter what I enter."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481728643, "post_id": 41145365, "comment_id": 69494507, "body": "&quot;code isn&#39;t printing anything&quot;  --&gt; There are no output functions in the posted code.  Why expect it to print anything?  &quot;no matter what I enter&quot; --&gt;  There are no input functions in the posted code either."}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1481730569, "post_id": 41145365, "comment_id": 69495719, "body": "@chrisjn: Your question is not clear. So do one thing. Give one or two examples and tell us what are the expected outputs."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481732184, "post_id": 41145365, "comment_id": 69496865, "body": "@chrisjn now we need a minimal dictionary.txt file and an example of input expected output."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7297124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c18f9a8bf2c8f58621592f02f5d5b932?s=128&d=identicon&r=PG&f=1", "display_name": "chrisjn", "link": "https://stackoverflow.com/users/7297124/chrisjn"}, "edited": false, "score": 0, "creation_date": 1481728910, "post_id": 41145629, "comment_id": 69494674, "body": "Thanks for the help but I&#39;m still getting the same issue. I should have probably posted what exactly my issue was when I asked the question. The issue is no matter what I enter nothing gets printed. I decided to add an &#39;else&#39; statement in my compare arrays and it keeps printing what I wrote in the &#39;else&#39;."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1, "user_id": 7297124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c18f9a8bf2c8f58621592f02f5d5b932?s=128&d=identicon&r=PG&f=1", "display_name": "chrisjn", "link": "https://stackoverflow.com/users/7297124/chrisjn"}, "edited": false, "score": 0, "creation_date": 1481730358, "post_id": 41145629, "comment_id": 69495569, "body": "@chrisjn you need to provide more information, otherwise we can&#39;t help."}, {"owner": {"reputation": 1, "user_id": 7297124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c18f9a8bf2c8f58621592f02f5d5b932?s=128&d=identicon&r=PG&f=1", "display_name": "chrisjn", "link": "https://stackoverflow.com/users/7297124/chrisjn"}, "edited": false, "score": 0, "creation_date": 1481731942, "post_id": 41145629, "comment_id": 69496692, "body": "Posted my entire code. The code should promp the user for a series of letters. Than read in the letters and print out which dictionary words can be made from the letters you enter. My problem is whenever I would enter anything I wouldn&#39;t get anything back. I put an extra line into where I compare the arrays to see if its working and it doesn&#39;t seem to be. Its keeps printing out the &quot;also broken&quot; line I added in."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 0, "last_activity_date": 1481727374, "creation_date": 1481727374, "answer_id": 41145629, "question_id": 41145365, "link": "https://stackoverflow.com/questions/41145365/can-someone-help-me-with-this-compare-array/41145629#41145629", "title": "Can someone help me with this compare array?", "body": "<p>Not sure that this is the correct answer as it's hard to guess what you are actually trying to do, but you probably want this, or something similar:</p>\n\n<pre><code>int compare_arrays(int dictionary[], int user[])\n{\n    int j = 0;\n\n    while (user[j] &gt;= dictionary[j])\n    {\n        j++;\n        if (j == 26)\n        {\n            return 0;\n        }\n    }\n    return 1;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7297124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c18f9a8bf2c8f58621592f02f5d5b932?s=128&d=identicon&r=PG&f=1", "display_name": "chrisjn", "link": "https://stackoverflow.com/users/7297124/chrisjn"}, "edited": false, "score": 0, "creation_date": 1481733038, "post_id": 41147344, "comment_id": 69497476, "body": "After editing that in my code. I&#39;m still getting the same results, After I enter some letters that I know should spell something all I get back is a &quot; : &quot;"}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "reply_to_user": {"reputation": 1, "user_id": 7297124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c18f9a8bf2c8f58621592f02f5d5b932?s=128&d=identicon&r=PG&f=1", "display_name": "chrisjn", "link": "https://stackoverflow.com/users/7297124/chrisjn"}, "edited": false, "score": 0, "creation_date": 1481734164, "post_id": 41147344, "comment_id": 69498221, "body": "@chrisjn This could be some other issue. (1) Print temp before and after calling find_frequency() and make sure it is correct. (2) Print dictionary_words[i] with temp and make sure that is also correct. (3) You have declared <code>char string[11];</code>. Make sure you are not entering more than 10 characters. Better do <code>scanf(&quot;%10s&quot;, string); string[10]=&#39;\\0&#39;;</code> Try with these changes and let me know your observation."}, {"owner": {"reputation": 1, "user_id": 7297124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c18f9a8bf2c8f58621592f02f5d5b932?s=128&d=identicon&r=PG&f=1", "display_name": "chrisjn", "link": "https://stackoverflow.com/users/7297124/chrisjn"}, "edited": false, "score": 0, "creation_date": 1481736511, "post_id": 41147344, "comment_id": 69499660, "body": "I added those print temp commands with a \\n so they would be printed onto different lines but all they print are blank lines. I tried printing the dictionary_words[i] and i also just got a blank line. Why would it be doing this?"}], "tags": [], "owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "is_accepted": false, "score": 1, "last_activity_date": 1481779010, "last_edit_date": 1481779010, "creation_date": 1481732417, "answer_id": 41147344, "question_id": 41145365, "link": "https://stackoverflow.com/questions/41145365/can-someone-help-me-with-this-compare-array/41147344#41147344", "title": "Can someone help me with this compare array?", "body": "<p>You are returning wrong result.</p>\n\n<pre><code>int compare_arrays(int dictionary[], int user[])\n{\n    int j = 0;\n\n    while (user[j] &gt;= dictionary[j])\n    {\n        j++;\n        if (j == 26)\n        {\n            // You have checked all 26 letters and for all of them condition is true. Therefore a word can be made from user entered letters.\n            return 1; \n        }\n    }\n    return 0; //Word can not be made from user entered letters\n}\n</code></pre>\n\n<p>If you want to take care of case sensitivity,</p>\n\n<pre><code>void find_frequency(char string[],int count[])\n{\n    int i;\n    for(i=0; string[i] != '\\0'; i++)\n    {\n        //If letter is in upper case, it will be converted to lower case before checking.\n        if (tolower(string[i]) &gt;= 'a' &amp;&amp; tolower(string[i]) &lt;= 'z')\n        {\n            count[tolower(string[i])-'a']++;\n        }\n    }\n}\n</code></pre>\n\n<p><strong>UPDATE 1:</strong> </p>\n\n<p>Error in tokenizing.\n1) <code>int total_words=11; //number of words</code>\n    You are using this variable as array index. So it should be initialized to zero. Or you declare another variable for index.\n   <code>int index=0;</code></p>\n\n<p>2) strtok will return address of start of token. So you are writing words with token and not copying null terminator.</p>\n\n<pre><code>    char *prevTokenPtr = line;\n    while(fgets(line,SIZE,cfPtr)!= NULL)\n    {\n        char*tokenPtr=strtok(line, \"\\t\");\n        while(tokenPtr != NULL)\n        {\n            /* Copy from last token to this token. */\n            int lengthToCopy = (tokenPtr  - prevTokenPtr)/sizeof(char);\n            strncpy(dictionary_words[index], prevTokenPtr, lengthToCopy);\n            dictionary_words[index][lengthToCopy] = '\\0';\n\n            printf(\"dictionary_words[%d] is [%s]\\n\", index, dictionary_words[index]);\n            index++;\n\n            prevTokenPtr = tokenPtr + 1; //Neglect '\\t'\n            tokenPtr     = strtok(NULL, \"\\t\" );\n        }\n\n        /* Copy the last word. */\n        if(NULL != prevTokenPtr)\n        {\n            strcpy(dictionary_words[index], prevTokenPtr);\n            printf(\"dictionary_words[%d] is [%s]\\n\", index, dictionary_words[index]);\n            index++;\n        }\n  }\n</code></pre>\n\n<p>Please note: </p>\n\n<p>1) I assume the input is like this.\n\"word1\"\\t\"word2\"\\t\"word3\"\\t...\\t\"wordN\"</p>\n\n<p>2) I have not tested this code. Prints should help you debugging further.</p>\n"}, {"comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1539169273, "post_id": 52738673, "comment_id": 92401930, "body": "Also <code>i&lt;=total_words</code> has a <i>bad smell</i> :)"}], "tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1539169050, "creation_date": 1539169050, "answer_id": 52738673, "question_id": 41145365, "link": "https://stackoverflow.com/questions/41145365/can-someone-help-me-with-this-compare-array/52738673#52738673", "title": "Can someone help me with this compare array?", "body": "<blockquote>\n  <p>I tried printing the dictionary_words[i] and i also just got a blank line. Why would it be doing this?</p>\n</blockquote>\n\n<p>A small, but momentous error:</p>\n\n<pre><code>    for(i=0; i&lt;=total_words; i++);\n    {\n        \u2026\n</code></pre>\n\n<p>The <code>;</code> at the end of the <code>for</code> line causes the block which was supposed to be the loop body to be executed only once, with a wrong <code>i</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7297124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c18f9a8bf2c8f58621592f02f5d5b932?s=128&d=identicon&r=PG&f=1", "display_name": "chrisjn", "link": "https://stackoverflow.com/users/7297124/chrisjn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1539169050, "creation_date": 1481726624, "last_edit_date": 1481731536, "question_id": 41145365, "link": "https://stackoverflow.com/questions/41145365/can-someone-help-me-with-this-compare-array", "title": "Can someone help me with this compare array?", "body": "<p>Im new to C and am having trouble with this code i'm writing. I'm almost 100% sure its because of my compare array section but I don't really know what to change. Can anyone help? If you would need my entire code I can also post that.\nThe code should compare letters entered by the user with words in a .txt document and see if you can spell any words with those letters.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define SIZE 99\n#define NUM_WORDS 100\n\nvoid find_frequency(char string[], int count[]);\nint compare_arrays(int dictionary[], int user[]);\n\nint main()\n{\n    int total_words=11; //number of words\n    char dictionary_words[NUM_WORDS][SIZE]; //store words in directory\n    FILE *cfPtr; //dictionary.txt pointer\n\n    if ((cfPtr=fopen(\"dictionary.txt\",\"r\"))==NULL)//try to open file\n    {\n        puts(\"File dictionary.txt could not be opened.\");\n        exit(1);//exit if file doesn't open\n    }\n\n    else{ //Read each word from the dictionary and save to array\n        char line[SIZE]; //save each word\n\n        {\n            while(fgets(line,SIZE,cfPtr)!= NULL)\n                  {\n                      char*tokenPtr=strtok(line, \"\\t\");\n                      while(tokenPtr != NULL)\n                        {\n                            strcpy(dictionary_words[total_words],tokenPtr);\n                            total_words++;\n                            tokenPtr = strtok(NULL, \"\\t\" );\n                        }\n\n                  }\n        }\n        }\n    fclose(cfPtr);//close file\n\n    char string[11];//get string of characters from user\n    int count[26]={0};//store the number of each letter\n\n    printf(\"Enter letters:\\n\");\n    scanf(\"%s\", string);\n\n\n    find_frequency(string, count);//count of each character entered\n\n    char temp[SIZE];\n    int temp_count[26]={0};//convert words into letters\n    int i;\n\n    for(i=0; i&lt;=total_words; i++);\n    {\n        strcpy(temp,dictionary_words[i]);\n        find_frequency(temp,temp_count);//convert word to letters in alphabet\n\n        if (compare_arrays(temp_count,count))//compare words with letters entered\n        {\n            printf(\"%s:\", temp);//print what you can spell\n        }\n        else\n        {\n             printf(\"broken\", temp);\n        }\n       memset(temp_count,0,sizeof(temp_count));//test next word\n    }\n    return(0);\n}//end main\n\n//define function\nvoid find_frequency(char string[],int count[])\n{\n    int i;\n    for(i=0; string[i] != '\\0'; i++)\n    {\n        if (string[i] &gt;= 'a' &amp;&amp; string[i] &lt;= 'z')\n        {\n            count[string[i]-'a']++;\n        }\n    }\n}\n\nint compare_arrays(int dictionary[], int user[])\n{\n    int j = 0;\n\n    while (user[j] &gt;= dictionary[j])\n    {\n        j++;\n        if (j == 26)\n        {\n            return 0;\n        }\n        else\n        {\n            printf(\"also broken\");\n        }\n    }\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["asp.net", "c", "excel", "oledb"], "comments": [{"owner": {"reputation": 2847, "user_id": 1884992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d911a8edcdc81a0dee5ea7a677b8f4b?s=128&d=identicon&r=PG", "display_name": "Ciar&#225;n", "link": "https://stackoverflow.com/users/1884992/ciar%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1481728625, "post_id": 41145099, "comment_id": 69494495, "body": "What&#39;s the problem? What errors are you getting?"}, {"owner": {"reputation": 302, "user_id": 4494267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/814e09392c1daba873c85dd3d9dd9995?s=128&d=identicon&r=PG&f=1", "display_name": "Aya Aboud", "link": "https://stackoverflow.com/users/4494267/aya-aboud"}, "reply_to_user": {"reputation": 2847, "user_id": 1884992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d911a8edcdc81a0dee5ea7a677b8f4b?s=128&d=identicon&r=PG", "display_name": "Ciar&#225;n", "link": "https://stackoverflow.com/users/1884992/ciar%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1481788311, "post_id": 41145099, "comment_id": 69519024, "body": "Code return first sheet alphabetical not actual first one in sheet."}], "answers": [{"tags": [], "owner": {"reputation": 302, "user_id": 4494267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/814e09392c1daba873c85dd3d9dd9995?s=128&d=identicon&r=PG&f=1", "display_name": "Aya Aboud", "link": "https://stackoverflow.com/users/4494267/aya-aboud"}, "is_accepted": true, "score": 0, "last_activity_date": 1482147797, "last_edit_date": 1495539944, "creation_date": 1482147797, "answer_id": 41221853, "question_id": 41145099, "link": "https://stackoverflow.com/questions/41145099/get-sheets-names-from-excel-asp-net/41221853#41221853", "title": "Get sheets names from excel ASP.Net", "body": "<p>After many search i found out that \"OLEDB\" not support reading sheets in original order (read sheets names in alphabetical order only) but there are many way support reading sheets names in original order from excel file.\n<br/> <br/>\nHelped link: <a href=\"http://csharp.net-informations.com/excel/csharp-read-excel.htm\" rel=\"nofollow noreferrer\">Reading sheets in original order from excel file</a>,\n<br/>\n<a href=\"https://stackoverflow.com/questions/26144407/order-of-sheets-in-excel-file-while-reading-with-getoledbschematable\">OLEDB does not preserve the sheet order as they were in Excel</a>.</p>\n"}], "owner": {"reputation": 302, "user_id": 4494267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/814e09392c1daba873c85dd3d9dd9995?s=128&d=identicon&r=PG&f=1", "display_name": "Aya Aboud", "link": "https://stackoverflow.com/users/4494267/aya-aboud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 41221853, "answer_count": 1, "score": 0, "last_activity_date": 1482147797, "creation_date": 1481725847, "last_edit_date": 1482145707, "question_id": 41145099, "link": "https://stackoverflow.com/questions/41145099/get-sheets-names-from-excel-asp-net", "title": "Get sheets names from excel ASP.Net", "body": "<p>I am getting sheets names sorting alphabetically by next code.</p>\n\n<pre><code>        OleDbConnection connection = new OleDbConnection(string.Format(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source={0}; Extended Properties=\\\"Excel 8.0;HDR=No;\\\"\", filePath));\n        OleDbCommand command = new OleDbCommand();\n        DataTable tableOfData = null;\n        command.Connection = connection;\n        try\n        {\n            connection.Open();\n            tableOfData = connection.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, null);\n            string tablename = tableOfData.Rows[0][\"TABLE_NAME\"].ToString();\n            tableOfData = new DataTable();\n            command.CommandText = \"Select * FROM [\" + tablename + \"]\";\n            tableOfData.Load(command.ExecuteReader());\n        }\n        catch (Exception ex)\n        {\n        }\n</code></pre>\n\n<p>I want only to read them with original order. Any idea?</p>\n"}, {"tags": ["c", "gcc", "wrapper", "glibc", "dynamic-linking"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 1922244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IzgNv.gif?s=128&g=1", "display_name": "0xdeda10", "link": "https://stackoverflow.com/users/1922244/0xdeda10"}, "edited": false, "score": 0, "creation_date": 1481729884, "post_id": 41145783, "comment_id": 69495278, "body": "Thanks for the answer. I do not use LD_PRELOAD because the whole point is to wrap a GLIBC function call with the sole use of the target&#39;s RPATH. Still, I don&#39;t see which other library might satisfy those symbols:  I have edited to include LD_DEBUG output."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 43, "user_id": 1922244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IzgNv.gif?s=128&g=1", "display_name": "0xdeda10", "link": "https://stackoverflow.com/users/1922244/0xdeda10"}, "edited": false, "score": 0, "creation_date": 1481734067, "post_id": 41145783, "comment_id": 69498149, "body": "@mr_sparxx, I have substantially revised and updated the answer after noticing your comment that you are statically linking libgcc, which I had previously overlooked."}, {"owner": {"reputation": 43, "user_id": 1922244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IzgNv.gif?s=128&g=1", "display_name": "0xdeda10", "link": "https://stackoverflow.com/users/1922244/0xdeda10"}, "edited": false, "score": 0, "creation_date": 1481792397, "post_id": 41145783, "comment_id": 69521122, "body": "Yes, I meant -lstatic-gcc (I have edited my post) and that was my misconception, I will try the path you have opened by your update."}, {"owner": {"reputation": 43, "user_id": 1922244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IzgNv.gif?s=128&g=1", "display_name": "0xdeda10", "link": "https://stackoverflow.com/users/1922244/0xdeda10"}, "edited": false, "score": 0, "creation_date": 1481811673, "post_id": 41145783, "comment_id": 69533218, "body": "Actually it is <code>-static-libgcc</code> but the purpose was the one you mentioned. Thank you."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1481734013, "last_edit_date": 1495540424, "creation_date": 1481727850, "answer_id": 41145783, "question_id": 41145062, "link": "https://stackoverflow.com/questions/41145062/wrapping-a-glibc-function-using-the-dynamic-linker/41145783#41145783", "title": "Wrapping a glibc function using the dynamic linker", "body": "<blockquote>\n  <p>I [place] my library where the executable's <code>RPATH</code> is pointing with the name <code>libc.so.6</code>.</p>\n</blockquote>\n\n<p>And therefore the process loads your library <em>instead of</em> GLIBC's <code>libc.so.6</code>.  <s>That is surely not what you want unless you're providing an <em>independent</em> implementation of at least <em>the entire C standard library</em>.</s>  That requires your library to provide an <em>independent</em> implementation of everything in <code>libc.so.6</code>, or else to dynamically load the real <code>libc</code>.  I see that you attempt to attain completeness by statically linking libgcc (I guess you mean using <code>-lstatic-libgcc</code>), but</p>\n\n<ol>\n<li><p>that's the wrong library.  It provides functions to support GCC-compiled binaries, which may include wrappers or alternatives for some C-library functions, but it does not provide the C library itself.</p></li>\n<li><p>even if you linked the C library statically (e.g. <code>-lc_nonshared</code>), the library you get that way will not include a dynamically loadable symbol by which you can access the wrapped function.  That's a direct consequence of the static linking.</p></li>\n<li><p>your library is anyway not independent because it tries to wrap GLIBC's implementation of <code>fstat()</code>, which is unavailable to it.</p></li>\n</ol>\n\n<blockquote>\n  <p>Why is there a relocation error on <code>__libc_start_main</code> and not on <code>system</code>?</p>\n</blockquote>\n\n<p>There is a relocation error on <code>__libc_start_main</code> because that function is provided by the glibc's libc.so.6, but not by yours, nor by your binary itself or any other library dynamically linked to your binary.  <em>(See (1) above)</em></p>\n\n<p>If there is no relocation error for the <code>system</code> or <code>printf</code> functions, then it follows that either those are not external dynamic symbols in your binary, or they are satisfied by some other library dynamically linked to your binary.  (<strong><em>Update:</strong> the linker debug information shows the former to be the case: those are not external symbols, by which I meant symbols for which no definition is provided; they are provided by your library, presumably as a result of linking in libgcc.</em>) <s>The details don't really matter, as the point is that your strategy is totally unworkable.</s>  Consider using <a href=\"https://stackoverflow.com/q/426230/2402272\"><code>LD_PRELOAD</code></a> instead.</p>\n\n<p><strong>Update:</strong> an alternative might be to give your shared library a constructor function that <code>dlopen()</code>s the real <code>libc.so.6</code> with flag <code>RTLD_GLOBAL</code> enabled.  This way, your library does not have to provide a complete C library itself, but it does need to know how to find the real library.  That will certainly solve the problem of the wrapped function being unavailable in the wrapper.</p>\n"}], "owner": {"reputation": 43, "user_id": 1922244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IzgNv.gif?s=128&g=1", "display_name": "0xdeda10", "link": "https://stackoverflow.com/users/1922244/0xdeda10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 41145783, "answer_count": 1, "score": 4, "last_activity_date": 1481811608, "creation_date": 1481725719, "last_edit_date": 1481811608, "question_id": 41145062, "link": "https://stackoverflow.com/questions/41145062/wrapping-a-glibc-function-using-the-dynamic-linker", "title": "Wrapping a glibc function using the dynamic linker", "body": "<p>I am trying to wrap the GLIBC <code>fstat</code> function (it could be any other: it is just a proof of concept) by injecting my library to an executable. I do this by placing my library where the executable's <code>RPATH</code> is pointing with the name <code>libc.so.6</code>.</p>\n\n<p>The source code of my library is the one below:</p>\n\n<pre><code>#define _GNU_SOURCE\n\n#include &lt;stdio.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;dlfcn.h&gt;\n\n\n\nint fstat(int fd, struct stat *buf){\n\n        typeof(fstat) *old_fstat;\n\n        // Try with a printf...\n\n        printf(\"HOOT! fstat wrapped!\");\n\n        old_fstat = dlsym(RTLD_NEXT, \"fstat\");\n        return (*old_fstat)(fd, buf);\n}\n</code></pre>\n\n<p>I compile it with <code>--version-script</code> (to add symbol versioning) and statically link it to libgcc.</p>\n\n<pre><code>gcc -Wall -fPIC -c -o wrapperlib.o wrapperlib.c \ngcc -shared -static-libgcc -fPIC -Wl,-soname -Wl,libc.so.6 -Wl,--version-script=wrapperlib.map,-Bstatic -o libc.so.6 wrapperlib.o\n</code></pre>\n\n<p>With <code>wrapperlib.map</code> containing:</p>\n\n<pre><code>GLIBC_2.0 {\n};\n</code></pre>\n\n<p>When I execute the target program my library gets loaded but I get the following error:</p>\n\n<pre><code>./target: relocation error: ./target: symbol __libc_start_main, version GLIBC_2.0 not defined in file libc.so.6 with link time reference\n</code></pre>\n\n<p>If I provide my own implementation of <code>__libc_start_main</code> I don't get this error (but it crashes, of course).</p>\n\n<pre><code>int __libc_start_main(int (*main) (int, char **, char **), int argc, char *argv, void (*init) (void), void (*fini) (void), void (*rtld_fini) (void), void *stack_end) {\n        system(\"echo I am in __libc_start_main\");\n        printf(\"printf: I am in __libc_start_main\");\n        fflush(stdin);\n    return 0;\n}\n</code></pre>\n\n<p>Why is there a relocation error on <code>__libc_start_main</code> and not on <code>system</code>? </p>\n\n<p>(By the way, the call to the <code>system</code> does work but the call to <code>printf</code> produces no output. Am I missing something obvious here?)</p>\n\n<p>Thank you</p>\n\n<p>Edit:\nRunning target with <code>LD_DEBUG=all</code> outputs this:\n<a href=\"http://pastebin.com/iVVbwf6n\" rel=\"nofollow noreferrer\">http://pastebin.com/iVVbwf6n</a></p>\n"}, {"tags": ["c", "sorting", "quicksort"], "comments": [{"owner": {"reputation": 271, "user_id": 6051666, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TUrSKwuXEEE/AAAAAAAAAAI/AAAAAAAAARA/tDbL2HNgMiA/photo.jpg?sz=128", "display_name": "Siddharth jha", "link": "https://stackoverflow.com/users/6051666/siddharth-jha"}, "edited": false, "score": 0, "creation_date": 1481726598, "post_id": 41145033, "comment_id": 69493047, "body": "Lol,i don&#39;t run it without main function, it&#39;s just the important part of the program"}, {"owner": {"reputation": 8959, "user_id": 1182921, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5cbca9fe5b06dab4005212a4bf9a5416?s=128&d=identicon&r=PG", "display_name": "Tom Tanner", "link": "https://stackoverflow.com/users/1182921/tom-tanner"}, "edited": false, "score": 0, "creation_date": 1481728417, "post_id": 41145033, "comment_id": 69494349, "body": "saying &#39;lol&#39; doesn&#39;t make what you said funny or particularly helpful."}, {"owner": {"reputation": 271, "user_id": 6051666, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TUrSKwuXEEE/AAAAAAAAAAI/AAAAAAAAARA/tDbL2HNgMiA/photo.jpg?sz=128", "display_name": "Siddharth jha", "link": "https://stackoverflow.com/users/6051666/siddharth-jha"}, "reply_to_user": {"reputation": 8959, "user_id": 1182921, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5cbca9fe5b06dab4005212a4bf9a5416?s=128&d=identicon&r=PG", "display_name": "Tom Tanner", "link": "https://stackoverflow.com/users/1182921/tom-tanner"}, "edited": false, "score": 0, "creation_date": 1481728864, "post_id": 41145033, "comment_id": 69494647, "body": "With due respect previous comment was deleted, so you are not aware of why I used LOL"}], "answers": [{"comments": [{"owner": {"reputation": 271, "user_id": 6051666, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TUrSKwuXEEE/AAAAAAAAAAI/AAAAAAAAARA/tDbL2HNgMiA/photo.jpg?sz=128", "display_name": "Siddharth jha", "link": "https://stackoverflow.com/users/6051666/siddharth-jha"}, "edited": false, "score": 0, "creation_date": 1481728803, "post_id": 41145962, "comment_id": 69494616, "body": "Thank you very much"}], "tags": [], "owner": {"reputation": 8959, "user_id": 1182921, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5cbca9fe5b06dab4005212a4bf9a5416?s=128&d=identicon&r=PG", "display_name": "Tom Tanner", "link": "https://stackoverflow.com/users/1182921/tom-tanner"}, "is_accepted": true, "score": 2, "last_activity_date": 1481728380, "creation_date": 1481728380, "answer_id": 41145962, "question_id": 41145033, "link": "https://stackoverflow.com/questions/41145033/whats-wrong-in-this-quicksort-program/41145962#41145962", "title": "Whats wrong in this quicksort program?", "body": "<p>Your partition algorithm always starts at element zero. It should start at the start of the partition.</p>\n"}], "owner": {"reputation": 271, "user_id": 6051666, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TUrSKwuXEEE/AAAAAAAAAAI/AAAAAAAAARA/tDbL2HNgMiA/photo.jpg?sz=128", "display_name": "Siddharth jha", "link": "https://stackoverflow.com/users/6051666/siddharth-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 41145962, "answer_count": 1, "score": -2, "last_activity_date": 1484839005, "creation_date": 1481725629, "last_edit_date": 1484839005, "question_id": 41145033, "link": "https://stackoverflow.com/questions/41145033/whats-wrong-in-this-quicksort-program", "title": "Whats wrong in this quicksort program?", "body": "<p>I doubt that the there is something wrong with the partition function.</p>\n\n<pre><code>void swap(int num1, int num2) { /*function to swap the values */\n   int temp = intArray[num1];    \n   intArray[num1] = intArray[num2];\n   intArray[num2] = temp;\n}\n\nint partition(int left, int right) { //partition function\n   int leftPointer = left;\n   int j;\n   int pivot=intArray[right];\n   for(j=0;j&lt;right;j++){\n    if(intArray[j]&lt;=pivot){\n        swap(j,leftPointer);\n        leftPointer++;\n    }\n   }\n  swap(leftPointer,right);\n  return leftPointer;\n}\n\nvoid quickSort(int left, int right) { //quicksort\n   if(left&lt;right){\n      int partitionPoint = partition(left, right);\n      quickSort(left,partitionPoint-1);\n      quickSort(partitionPoint+1,right);\n   }\n}\n</code></pre>\n\n<p>The program runs fine , but it doesn't sort!</p>\n"}, {"tags": ["c", "fwrite", "fread", "imagefilter"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1481724652, "post_id": 41144638, "comment_id": 69491816, "body": "Start checking if <code>fopen</code> returns NULL. <code>fread(*datain, sizeof(image), 1, f);</code> -&gt; <code>fread(datain, sizeof(image), 1, f);</code>. <code>(*dataout) [i][j]</code> is complete nonsense, you cannot access memory allocated with <code>malloc</code> as a 2D array, and anyway <code>(*dataout)</code> -&gt; <code>(dataout)</code>. There are possibily other issues."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481725256, "post_id": 41144638, "comment_id": 69492201, "body": "Check also the return values of your other function calls against the result expected for successful completion.  C standard library functions, especially I/O functions, are not silent when they are unable to do the job asked of them."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1481726152, "post_id": 41144638, "comment_id": 69492770, "body": "@MichaelWalz What&#39;s wrong with using <code>(*dataout)[i][j]</code>? <code>(*dataout)</code> is of type <code>unsigned char [251][256]</code>, so that looks fine to me."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1481726533, "post_id": 41144638, "comment_id": 69492994, "body": "It would be cleaner to replace <code>fread(*datain, sizeof(image), 1, f);</code> with <code>fread(datain, sizeof(image), 1, f);</code> since <code>datain</code> is a pointer to an <code>image</code>, but they should be the same value when converted to <code>void *</code> by the call to <code>fread</code>."}, {"owner": {"reputation": 11, "user_id": 7296937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99ed7ed7598360e04f498855841dba1?s=128&d=identicon&r=PG&f=1", "display_name": "HaniMasta", "link": "https://stackoverflow.com/users/7296937/hanimasta"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481726587, "post_id": 41144638, "comment_id": 69493036, "body": "@MichaelWalz I need the dataout aswell as well as the datain to be to be described as a pointer aswell."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1481726764, "post_id": 41144638, "comment_id": 69493194, "body": "I&#39;d recommend opening the files in binary mode for portability to non Unix-like systems, by using modes &quot;rb&quot; and &quot;wb&quot; instead of &quot;r&quot; and &quot;w&quot; in the <code>fopen</code> calls."}, {"owner": {"reputation": 11, "user_id": 7296937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99ed7ed7598360e04f498855841dba1?s=128&d=identicon&r=PG&f=1", "display_name": "HaniMasta", "link": "https://stackoverflow.com/users/7296937/hanimasta"}, "edited": false, "score": 0, "creation_date": 1481727502, "post_id": 41144638, "comment_id": 69493759, "body": "If i cant access memory allocated with <code>malloc</code> as a 2D array, how can I do it in this situation?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1481728435, "post_id": 41144638, "comment_id": 69494370, "body": "@HaniMasta There is nothing wrong with your memory accesses."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1481728486, "post_id": 41144638, "comment_id": 69494412, "body": "What makes you thing the output image does not change depending on the number of iterations?"}, {"owner": {"reputation": 11, "user_id": 7296937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99ed7ed7598360e04f498855841dba1?s=128&d=identicon&r=PG&f=1", "display_name": "HaniMasta", "link": "https://stackoverflow.com/users/7296937/hanimasta"}, "edited": false, "score": 0, "creation_date": 1481729834, "post_id": 41144638, "comment_id": 69495239, "body": "The Roller2.raw is supposed to be &quot;blurred&quot; when i upload it to rawpixels.net, but it is the same, Not really sure what the real problem is."}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1481731588, "post_id": 41144638, "comment_id": 69496456, "body": "@HaniMasta Just a guess: <code>(*dataout)[i][j] = (sum + (*datain)[i][j]*7) &#47; 16;</code> I think this line should be outside the <code>for( k = -1;..</code> loop."}, {"owner": {"reputation": 11, "user_id": 7296937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99ed7ed7598360e04f498855841dba1?s=128&d=identicon&r=PG&f=1", "display_name": "HaniMasta", "link": "https://stackoverflow.com/users/7296937/hanimasta"}, "reply_to_user": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1481732861, "post_id": 41144638, "comment_id": 69497352, "body": "@MayurK Thanks for the notification you are right! Still not getting the &#39;roller2.raw&#39; burred though"}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1481733125, "post_id": 41144638, "comment_id": 69497533, "body": "@HaniMasta: As Michael Walz  mentioned, you need to change<code>(*data__)[i][j]</code> to <code>data__[i][j]</code>. Make this change everywhere and try."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7296937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99ed7ed7598360e04f498855841dba1?s=128&d=identicon&r=PG&f=1", "display_name": "HaniMasta", "link": "https://stackoverflow.com/users/7296937/hanimasta"}, "edited": false, "score": 0, "creation_date": 1481734640, "post_id": 41147709, "comment_id": 69498513, "body": "you are right about the sequence outside the k and l loop, but the two other foorloops should be inside the i loop"}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "reply_to_user": {"reputation": 11, "user_id": 7296937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99ed7ed7598360e04f498855841dba1?s=128&d=identicon&r=PG&f=1", "display_name": "HaniMasta", "link": "https://stackoverflow.com/users/7296937/hanimasta"}, "edited": false, "score": 0, "creation_date": 1481735539, "post_id": 41147709, "comment_id": 69499051, "body": "then you should use different variable names."}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "reply_to_user": {"reputation": 11, "user_id": 7296937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99ed7ed7598360e04f498855841dba1?s=128&d=identicon&r=PG&f=1", "display_name": "HaniMasta", "link": "https://stackoverflow.com/users/7296937/hanimasta"}, "edited": false, "score": 0, "creation_date": 1481779469, "post_id": 41147709, "comment_id": 69515394, "body": "@HaniMasta: I have updated the answer. Please correct it if it is wrong. This might help someone someday. :)"}], "tags": [], "owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "is_accepted": false, "score": 1, "last_activity_date": 1481779429, "last_edit_date": 1481779429, "creation_date": 1481733528, "answer_id": 41147709, "question_id": 41144638, "link": "https://stackoverflow.com/questions/41144638/why-am-i-not-writing-anything-to-my-roller2-raw/41147709#41147709", "title": "Why am I not writing anything to my Roller2.raw?", "body": "<p>I think the issue is in <code>iterations</code> loop.</p>\n\n<pre><code>for( h = 1; h &lt;= iterations; h ++) \n{\n    for( i = 1; i &lt;= 249; i ++) \n    {\n        for( j = 1; j &lt;= 254; j ++) \n        {\n            sum = 0;\n            for( k = -1; k &lt;= 1; k ++) \n            {\n                for( l = -1; l &lt;= 1; l ++) \n                {\n                    sum = sum + (*datain)[i+k][j+l];\n                }\n            }\n\n            //This should be outside the k and l loop.\n            (*dataout)[i][j] = (sum + (*datain)[i][j]*7) / 16;\n        }\n\n        //You should use different variable name instead of i. OR declare 'i' again for `for` loop.\n        for(int i2 = 0; i2 &lt;= 250; i2 ++)\n        {\n            for( j = 0; j &lt;= 255; j ++) \n            {\n                (*datain)[i2][j] = (*dataout)[i2][j];\n            }\n        }\n    }\n }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7296937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99ed7ed7598360e04f498855841dba1?s=128&d=identicon&r=PG&f=1", "display_name": "HaniMasta", "link": "https://stackoverflow.com/users/7296937/hanimasta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481779429, "creation_date": 1481724462, "question_id": 41144638, "link": "https://stackoverflow.com/questions/41144638/why-am-i-not-writing-anything-to-my-roller2-raw", "title": "Why am I not writing anything to my Roller2.raw?", "body": "<p>I got the following code written in C but I have a small issue with this image filter program. The problem complies and everything as usual, but my image roller2.raw is not changing based on the number of iterations (checked in rawpixels.net). It is supposed to read the roller1 and write to roller2. Am I doing the writing in a wrong way? following code is below</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\ntypedef unsigned char image[251][256];\n\nint main() \n{\n\n int h,i,j,k,l,sum,iterations;\n image *datain, *dataout;\n\n FILE *f , *g; \n f = fopen(\"/home/osboxes/prestandaoptimering/roller1.raw\", \"r\"); \n g = fopen(\"/home/osboxes/prestandaoptimering/roller2.raw\", \"w\"); \n\n datain = (image*)malloc(sizeof(image));\n dataout = (image*)malloc(sizeof(image));\n fread(*datain, sizeof(image), 1, f); \n\n\n printf(\"Enter number of iterations:\");\n scanf(\"%d\", &amp;iterations);\n getchar(); \n\n printf(\"Computing result\\n\");\n\n\n for( i = 0; i &lt;= 250; i ++) {\n        for( j = 0; j &lt;= 255; j ++) {\n                (*dataout) [i][j] = (*datain) [i][j]; \n    }\n }\n\n\n\n for( h = 1; h &lt;= iterations; h ++) {\n\n        for( i = 1; i &lt;= 249; i ++) {\n\n                for( j = 1; j &lt;= 254; j ++) {\n\n                        sum = 0;\n                        for( k = -1; k &lt;= 1; k ++) {\n                            for( l = -1; l &lt;= 1; l ++) {\n                                sum = sum + (*datain)[i+k][j+l];\n                }\n\n                        (*dataout)[i][j] = (sum + (*datain)[i][j]*7) / 16;\n            }\n                }\n                for( i = 0; i &lt;= 250; i ++) {\n                    for( j = 0; j &lt;= 255; j ++) {\n                        (*datain)[i][j] = (*dataout)[i][j];\n            }\n        }\n    }\n }\n\n printf(\"Writing result\\n\");\n fwrite(dataout, sizeof(image), 1, g);\n if (f != NULL) {\n    fclose(f); \n }\n f = NULL;\n if (g != NULL) {\n    fclose(g);\n }\n g = NULL;\n\n free(datain);\n free(dataout);\n return 0; \n}\n</code></pre>\n"}, {"tags": ["c", "named-pipes", "fifo", "mkfifo"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481724086, "post_id": 41144488, "comment_id": 69491465, "body": "See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, follow the advice and format&amp;indent this mess correctly."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7296907, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248925585183944/picture?type=large", "display_name": "Thomas Levan", "link": "https://stackoverflow.com/users/7296907/thomas-levan"}, "edited": false, "score": 0, "creation_date": 1481725004, "post_id": 41144657, "comment_id": 69492035, "body": "I have a second reader program, running it from another teminal window only does this : ./test2 ttime__vdso_get_?@?@@"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "is_accepted": true, "score": 2, "last_activity_date": 1481724519, "creation_date": 1481724519, "answer_id": 41144657, "question_id": 41144488, "link": "https://stackoverflow.com/questions/41144488/program-running-mkfifo-doesnt-work/41144657#41144657", "title": "Program running mkfifo doesn&#39;t work", "body": "<p>For a named pipe to be useful, somebody has to read it and somebody has to write it. Usually this will be 2 separate programs. Your program is the writer. Where is the reader?</p>\n\n<p>If there is no reader, it is normal for the program to block on the <code>O_WRONLY</code> open. So when your program appears to be doing nothing, it's really just doing this:</p>\n\n<pre><code>pipe = open(\"/tmp/myfifo\", O_WRONLY);\n</code></pre>\n\n<p>which waits for a reader to show up.</p>\n\n<p>In another terminal, run <code>cat /tmp/myfifo</code>. The presence of a reader will allow the writer to make progress. Your program will wake up and move on to the <code>Enter line</code> prompt, and what you enter will be read by the <code>cat</code> and written to the second terminal.</p>\n\n<p>The other problem is an inconsistency in your filenames. In one place you wrote <code>\"tmp/myfifo\"</code> without a leading slash, so you are trying to create the named pipe in a <code>tmp</code> directory that is inside the current working directory. If that <code>tmp</code> directory doesn't exist, <code>No such file or directory</code> will be the result.</p>\n"}], "owner": {"reputation": 3, "user_id": 7296907, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248925585183944/picture?type=large", "display_name": "Thomas Levan", "link": "https://stackoverflow.com/users/7296907/thomas-levan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1500, "favorite_count": 0, "accepted_answer_id": 41144657, "answer_count": 1, "score": -3, "last_activity_date": 1481724519, "creation_date": 1481724003, "question_id": 41144488, "link": "https://stackoverflow.com/questions/41144488/program-running-mkfifo-doesnt-work", "title": "Program running mkfifo doesn&#39;t work", "body": "<p>I'm trying to make a named pipe on c under linux using the mkfifo command. But when I run the program, I either get a \"no such file or directory\" error or absolutely nothing (console doesn't display anything)</p>\n\n<p>Here is my code :</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n\n#define MAX_LINE 80\n\nint main(int argc, char** argv) {\nint create;\n//mkfifo(\"/tmp/myfifo\", 0666);\ncreate = mkfifo(\"tmp/myfifo\", 0666);\nif (create==-1)\n{\n    printf(\"error%s\", strerror(errno));\n}\nchar line[MAX_LINE];\nint pipe;\npipe = open(\"/tmp/myfifo\", O_WRONLY);\n if (pipe==-1)\n {printf(\"error\");\n }\nprintf(\"Enter line: \");\nfgets(line, MAX_LINE, stdin);\nwrite(pipe, line, strlen(line));\nsleep (100);\nclose(pipe);\nreturn 0;\n}\n</code></pre>\n\n<p>I am still learning, and I don't understand what i'm doing wrong. Thanks for your help.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 5, "creation_date": 1481723005, "post_id": 41144114, "comment_id": 69490683, "body": "It&#39;s two operators - think of <code>*--bufptr</code> as <code>*(--bufptr)</code>."}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 1, "creation_date": 1481723040, "post_id": 41144114, "comment_id": 69490710, "body": "Pointer dereference (*) and pre-decrement (--)"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 3, "creation_date": 1481723095, "post_id": 41144114, "comment_id": 69490750, "body": "That&#39;s an example of &quot;ugly&quot; code."}, {"owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1481809252, "post_id": 41144114, "comment_id": 69531515, "body": "@PaulR Maybe it&#39;s a daft question but why on earth is it &quot;off topic&quot;?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1481809502, "post_id": 41144114, "comment_id": 69531708, "body": "@Barleyman: the 5 close votes were probably for different reasons - off-topic (&quot;resolved in a manner unlikely to help future readers&quot;) was the majority vote though, so that&#39;s the one that&#39;s shown above.  I think that was probably my close reason too, since it was just a simple misunderstanding in the reading of two operators as a single operator, the resolution of which is unlikely to be of benefit to anyone else in the future. The fact that it&#39;s closed doesn&#39;t actually matter too much, in that the questioner got their answer - it just means that the bots will come along later and clean up."}, {"owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1481903168, "post_id": 41144114, "comment_id": 69575600, "body": "@PaulR From some googling it seems I&#39;m hardly the only one confused by some of the possible combinations. In this particular case breaking those operations into *(bufptr--) makes the code much more readable. I&#39;m a big believer into there&#39;s not being shortage of lines in source code so when I rewrote that routine I broke (*bufptr)++ and bufptr++ to separate items. With a 16MHz microcontroller simple utoa function needs some thought instead of tossing a modulo around as if the CPU had a DIV instruction."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1481904738, "post_id": 41144114, "comment_id": 69576512, "body": "@Barleyman: if you think that&#39;s confusing then take a look at the slide operator: <code>while (i --&gt; 0) ...</code>. See <a href=\"http://stackoverflow.com/q/20754582/253056\">this question</a> for an explanation. ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "edited": false, "score": 0, "creation_date": 1481723789, "post_id": 41144152, "comment_id": 69491248, "body": "Ok, I see it. I wasn&#39;t actually aware of pre-decrement and why it exists."}, {"owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "reply_to_user": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "edited": false, "score": 1, "creation_date": 1481723915, "post_id": 41144152, "comment_id": 69491345, "body": "@Barleyman if you didn&#39;t aware pre-decrement operator then I would suggest you to pick up a good C book."}, {"owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "edited": false, "score": 0, "creation_date": 1481724477, "post_id": 41144152, "comment_id": 69491709, "body": "It&#39;s fairly easy to find a reference that doesn&#39;t cover that. You don&#39;t exactly run into it much in source code either. Certainly not in the firmware I write for obvious reasons."}], "tags": [], "owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "is_accepted": true, "score": 5, "last_activity_date": 1481723024, "creation_date": 1481723024, "answer_id": 41144152, "question_id": 41144114, "link": "https://stackoverflow.com/questions/41144114/what-does-notation-do-in-c/41144152#41144152", "title": "What does *-- notation do in C?", "body": "<p><code>*--bufptr</code> is equivalent of <code>*(--bufptr)</code>, i.e. it decrements <code>bufptr</code> first and then gets the value of it. </p>\n\n<p>If you look into the <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"noreferrer\">precedence table of C operators</a> then you would see that increment and decrement operators have higher precedence that dereference operator.</p>\n"}, {"tags": [], "owner": {"reputation": 5259, "user_id": 482317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baddc1ebd4dbe1bdb3fa853c18fe155f?s=128&d=identicon&r=PG", "display_name": "Andrea Bergia", "link": "https://stackoverflow.com/users/482317/andrea-bergia"}, "is_accepted": false, "score": 1, "last_activity_date": 1481723056, "creation_date": 1481723056, "answer_id": 41144160, "question_id": 41144114, "link": "https://stackoverflow.com/questions/41144114/what-does-notation-do-in-c/41144160#41144160", "title": "What does *-- notation do in C?", "body": "<p>It's just a sequence of * and -- without a space; it's the same as <code>*(--bufptr)</code>.</p>\n"}], "owner": {"reputation": 153, "user_id": 5325170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18033b243395d1ae517cb0345981b621?s=128&d=identicon&r=PG", "display_name": "Barleyman", "link": "https://stackoverflow.com/users/5325170/barleyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 724, "favorite_count": 0, "closed_date": 1481724623, "accepted_answer_id": 41144152, "answer_count": 2, "score": -2, "last_activity_date": 1481723443, "creation_date": 1481722907, "question_id": 41144114, "link": "https://stackoverflow.com/questions/41144114/what-does-notation-do-in-c", "closed_reason": "Not suitable for this site", "title": "What does *-- notation do in C?", "body": "<p>I ran into this in a library with the compiler:</p>\n\n<pre><code>register char *bufptr;\nregister int   neg = val &lt; 0;\nregister long  uval = val;\n\n*(bufptr = &amp;tempc[BUFLEN - 1]) = 0;\n\ndo {*--bufptr = abs(uval % 10) + '0';}  while(uval /= 10);\n</code></pre>\n\n<p>What does \"*--\" actually do? I tried searching for that but it's not included in C references I could find and search engines do not like \"*--\" much. </p>\n"}, {"tags": ["c", "signals", "handle"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481725627, "post_id": 41144112, "comment_id": 69492437, "body": "I don&#39;t understand &quot;A exec himself with another program.&quot;  Is A execing the same binary it is already running?  Is it execing a different binary?  Is it forking first?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481725776, "post_id": 41144112, "comment_id": 69492539, "body": "What is the nature of the piped dialog between the processes?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481726134, "post_id": 41144112, "comment_id": 69492757, "body": "You mean <code>pipe</code>(2) pipes, right?  Not FIFOs (aka &quot;named pipes&quot;) recorded in the file system?"}, {"owner": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481726942, "post_id": 41144112, "comment_id": 69493350, "body": "(1,2) I can&#39;t use the pipe to pass the information, because A can execing any programs you wan&#39;t... (3) Yes I mean pipe(2)"}, {"owner": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481727047, "post_id": 41144112, "comment_id": 69493424, "body": "But I actually wonder if I can attach A to B as a child, and handle him with that property"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481728216, "post_id": 41144112, "comment_id": 69494217, "body": "I&#39;m still not following the situation you&#39;re trying to describe.  Note in particular that if thread A successfully execs, then its entire process image (including any other threads) is replaced with a new one.  In what sense do you expect the new image to find any kind of notification about the state of B meaningful?"}, {"owner": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481728342, "post_id": 41144112, "comment_id": 69494302, "body": "The standard input of B is sent to A and the ouput of A is sent to B (throught the pipes)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1481728908, "post_id": 41144112, "comment_id": 69494672, "body": "I have reworded the question as I think you mean based on your comments.  Feel free to revert or edit further if I have not adequately captured it."}, {"owner": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481729440, "post_id": 41144112, "comment_id": 69495014, "body": "thanks to you. Do you know if there&#39;s a function like change_parent(pid_t pid) that set the calling process parent on the pid ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481736802, "post_id": 41144112, "comment_id": 69499825, "body": "No, a process cannot be manually reparented.  If a child process outlives its parent, however, then process 1 becomes its parent."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481725988, "post_id": 41145031, "comment_id": 69492674, "body": "That would be a possibility if process A can be relied upon to try to write to the pipe after B terminates.  Whether that indeed describes the OP&#39;s scenario is impossible to determine based on the information currently available."}, {"owner": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "edited": false, "score": 0, "creation_date": 1481730397, "post_id": 41145031, "comment_id": 69495588, "body": "Doesn&#39;t works, because if A have a block processing when B died, he will never know..."}], "tags": [], "owner": {"reputation": 11, "user_id": 4672770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc86b590cec8b8023dc27ebb42343e9a?s=128&d=identicon&r=PG&f=1", "display_name": "indianant", "link": "https://stackoverflow.com/users/4672770/indianant"}, "is_accepted": false, "score": 1, "last_activity_date": 1481725618, "creation_date": 1481725618, "answer_id": 41145031, "question_id": 41144112, "link": "https://stackoverflow.com/questions/41144112/listen-a-signal-from-a-processus-by-pid/41145031#41145031", "title": "Listen a signal from a processus by pid", "body": "<p>\"A\" receives SIGPIPE signal when it writes to pipe where consumer is killed.</p>\n\n<p>You can register handler for SIGPIPE and handle it gracefully.</p>\n"}, {"comments": [{"owner": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "edited": false, "score": 0, "creation_date": 1481731748, "post_id": 41146887, "comment_id": 69496564, "body": "But how can A saw EOF if he exec ? Should I do a thread which have the pid of A, and make him try to know when B is dead by checking on the existence of the pipes ?  Unfortunatly, i can&#39;t do your last proposition... I have to follow this architecture for a school project..."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "edited": false, "score": 0, "creation_date": 1481734719, "post_id": 41146887, "comment_id": 69498567, "body": "@ThomasPetillot as I said, if you&#39;ve only the pipes to rely upon, then you can only detect the other process&#39;s state when you are doing I/O.  And you can only do it <i>in the normal course</i> of your program&#39;s I/O, because otherwise you will interfere with the program&#39;s behavior."}, {"owner": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "edited": false, "score": 0, "creation_date": 1481734758, "post_id": 41146887, "comment_id": 69498584, "body": "So I have make A sending his pid on the output, and B catch it so it can kill him when he want. thanks for your help"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "edited": false, "score": 0, "creation_date": 1481734858, "post_id": 41146887, "comment_id": 69498633, "body": "@ThomasPetillot, but if <b>A</b> is the parent of <b>B</b>, <i>and you have full control of the implementation of the program execed in <b>A</i></b>, then you could make that program register a signal handler for <code>SIGCHLD</code>.  That handler will be notified when any child process dies, and it can take appropriate action."}, {"owner": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "edited": false, "score": 0, "creation_date": 1481735347, "post_id": 41146887, "comment_id": 69498933, "body": "A isn&#39;t, I add a quick view of what I am doing"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "edited": false, "score": 0, "creation_date": 1481736940, "post_id": 41146887, "comment_id": 69499904, "body": "@ThomasPetillot, for <b>A</b> and <b>B</b> to be connected by pipes, with <b>A</b>  not being the parent of <b>B</b>, the two must have a shared ancestor somewhere that created those pipes.  In that ancestor -- ideally a common parent -- is where the functionality I described in my third alternative could live."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "edited": false, "score": 0, "creation_date": 1481737085, "post_id": 41146887, "comment_id": 69499976, "body": "@ThomasPetillot, not also that relying on <b>B</b> to kill <b>A</b> will not be effective in all cases.  In particular, it cannot be effective when <b>B</b> is killed by a <code>SIGKILL</code>, as no handler can be installed for that signal."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1481730990, "creation_date": 1481730990, "answer_id": 41146887, "question_id": 41144112, "link": "https://stackoverflow.com/questions/41144112/listen-a-signal-from-a-processus-by-pid/41146887#41146887", "title": "Listen a signal from a processus by pid", "body": "<p>As I understand you, the only thing you have to work with is the pipes.  Nothing else that might help you carries across an exec, especially if we suppose that the program running in process <strong>A</strong> is not specifically designed for this interaction.  Let us therefore consider what you can do with the pipes.</p>\n\n<p>When <strong>B</strong> terminates, for whatever reason, all its open file handles are closed.  That includes its handles on the pipe ends.</p>\n\n<p>If <strong>A</strong> thereafter attempts to write to its own <code>stdout</code>, and the read end is not open in any process,<sup>*</sup> then A will receive a <code>SIGPIPE</code>, as @indianant observed.  The default disposition for that signal is to terminate the process, so <strong>A</strong> will then die too unless it has changed the disposition for that signal.  Whether <strong>A</strong> changes the disposition of <code>SIGPIPE</code> is out of your control unless the program running in <strong>A</strong> is one you've provided.</p>\n\n<p>But perhaps <strong>A</strong> will be blocked reading from its standard input when <strong>B</strong> terminates.  Supposing that <strong>B</strong> was the only process holding the write end of that pipe open, <strong>A</strong> will then see EOF on its standard input.  This will not automatically cause <strong>A</strong> to terminate, but it can respond appropriately to that event, which might cause it to terminate naturally.  Additionally, <strong>A</strong> may first receive data written by <strong>B</strong> before its termination; if <strong>A</strong> responds by trying to write to its standard output, then the previous paragraph applies.</p>\n\n<p>None of that applies, however, unless <strong>A</strong> is actually performing I/O on its standard streams.  If you're looking for some kind of asynchronous notification, then you probably need to make that the responsibility of a third process.  It would be easiest for that purpose to give <strong>A</strong> and <strong>B</strong> a common parent process, possibly one dedicated to the purpose.  The parent will be notified via a <code>SIGCHLD</code> or by returning from a <code>wait()</code> or <code>waitpid()</code> when one of its children dies; it could then take appropriate action such as killing the other child.  Note that this does not work for <strong>A</strong> being the parent of <strong>B</strong>, or <code>vise versa</code>, because signal handlers are not carried over an exec, except possibly <code>SIG_IGN</code> for <code>SIGCHLD</code>.</p>\n\n<p><sup>*</sup>In particular, make sure the read end is not open in <em>A</em> by closing it before the exec.</p>\n"}], "owner": {"reputation": 221, "user_id": 6253080, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/828795010586660/picture?type=large", "display_name": "Neok", "link": "https://stackoverflow.com/users/6253080/neok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 41146887, "answer_count": 2, "score": 0, "last_activity_date": 1481735574, "creation_date": 1481722898, "last_edit_date": 1481735574, "question_id": 41144112, "link": "https://stackoverflow.com/questions/41144112/listen-a-signal-from-a-processus-by-pid", "title": "Listen a signal from a processus by pid", "body": "<p>Consider two processes, A and B, with standard input and output streams connected to each other via pipes to form a closed loop.  Suppose that, as a result of an <a href=\"https://linux.die.net/man/3/exec\" rel=\"nofollow noreferrer\">exec</a>, the two processes are not directly aware of their relationship with each other.</p>\n\n<p>If B is abruptly terminated (e.g. by sending it a <code>SIGKILL</code>), how can A know that B died? Or at least, make A died too</p>\n\n<p>Quick view of the situation, where Cmd is A and B Client :\n<a href=\"https://i.stack.imgur.com/HQMh6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HQMh6.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "semaphore", "binary-semaphore"], "comments": [{"owner": {"reputation": 1620, "user_id": 902384, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/46da49256462126dbe77187c073aa6c6?s=128&d=identicon&r=PG", "display_name": "Shiv", "link": "https://stackoverflow.com/users/902384/shiv"}, "edited": false, "score": 0, "creation_date": 1481722787, "post_id": 41143974, "comment_id": 69490510, "body": "Read <code>man sem_init</code> and ask further."}, {"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 2, "creation_date": 1481722797, "post_id": 41143974, "comment_id": 69490514, "body": "What kind of C is that? It seems the <code>&#47;&#47;</code> becomes <code>&#47;</code> and the <code>_</code> are missing... Anyway <code>[]</code> is the array subscript operator, to answer your question."}, {"owner": {"reputation": 1620, "user_id": 902384, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/46da49256462126dbe77187c073aa6c6?s=128&d=identicon&r=PG", "display_name": "Shiv", "link": "https://stackoverflow.com/users/902384/shiv"}, "edited": false, "score": 1, "creation_date": 1481722852, "post_id": 41143974, "comment_id": 69490563, "body": "It is a bad copy from some ebook or scan. Do you notice the unlockquotes. Those are printing quotes not code quotes of a monospace font. Underscores missing. The OCR has a fail implementation."}, {"owner": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "reply_to_user": {"reputation": 1620, "user_id": 902384, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/46da49256462126dbe77187c073aa6c6?s=128&d=identicon&r=PG", "display_name": "Shiv", "link": "https://stackoverflow.com/users/902384/shiv"}, "edited": false, "score": 0, "creation_date": 1481723248, "post_id": 41143974, "comment_id": 69490875, "body": "@Shiv Yea, sorry didn&#39;t spot that. Fixed it now. I&#39;ve tried <code>sem_init(&amp;semaphores, 1, 0);</code> but that didn&#39;t work."}, {"owner": {"reputation": 522, "user_id": 5472899, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/906d78201e3d2cdf72b9ca471f77a568?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Sanford", "link": "https://stackoverflow.com/users/5472899/josh-sanford"}, "edited": false, "score": 0, "creation_date": 1481723348, "post_id": 41143974, "comment_id": 69490941, "body": "<code>semaphores</code> is an array of semaphores.  <code>dest</code> and <code>my_rank</code> are indexes into that array.  <code>&amp;semaphores[dest]</code> is the address of the <code>dest</code> element of array <code>semaphores</code>."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481723743, "post_id": 41143974, "comment_id": 69491213, "body": "I&#39;m sure that <code>return NULL;</code> isn&#39;t an OCR error - if that compiles without warnings, you&#39;ve misconfigured your compilation..."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1481725523, "post_id": 41143974, "comment_id": 69492368, "body": "also your declaration of <code>Send_msg</code> is weird as in <code>Send_msg(void rank)</code> should be <code>Send_msg(void *rank)</code> ... It&#39;s always better to cut and paste the code and then use <code>{}</code> button in the editor to format it rather than retyping it."}, {"owner": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1481730548, "post_id": 41143974, "comment_id": 69495700, "body": "@AhmedMasud Yes, you&#39;re right. I copied it from pdf and it didn&#39;t copy, all characters."}, {"owner": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481730879, "post_id": 41143974, "comment_id": 69495937, "body": "@TobySpeight what I&#39;m getting is this: <code>error: subscripted value is neither array nor pointer nor vector</code> and its pointing to the <code>[</code> to this piece of code <code>sem_post(&amp;semaphores[dest]);</code> and <code>sem_wait(&amp;semaphores[my_rank]);</code>"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1481734283, "post_id": 41143974, "comment_id": 69498306, "body": "You should <a href=\"https://stackoverflow.com/posts/41143974/edit\">edit</a> your question to add the additional information, rather than just using a comment."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1481742959, "post_id": 41143974, "comment_id": 69503053, "body": "also your question is not <a href=\"http://stackoverflow.com/help/mvce\">stackoverflow.com/help/mvce</a> ... I cannot copy and paste your stuff to simply compile it."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "edited": false, "score": 0, "creation_date": 1481731338, "post_id": 41144911, "comment_id": 69496277, "body": "Oh okay, I get your point. So does that mean that I should have one semaphore for each thread?"}, {"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "reply_to_user": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "edited": false, "score": 1, "creation_date": 1481735247, "post_id": 41144911, "comment_id": 69498869, "body": "Semaphores are used to protect the data in the critical sections, for example consider producer-consumer problem, one thread is producing some data and consumer threads are consuming them, now consider two threads are accessing same variable or same section of data at the same time! it may break the consistency or troubling producer-consumer operation"}, {"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "reply_to_user": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "edited": false, "score": 1, "creation_date": 1481735405, "post_id": 41144911, "comment_id": 69498970, "body": "So you have to protect the data, for example with semaphores. you can put a semaphore lock before accessing critical section (shared data between two threads) and unlocking when you have finished working with them. when a semaphore is locked, no other lock will be placed. Actually first locker thread will continue to work and second and other locker threads will block until first locker thread finishes it works and unlocks the semaphore. Note that, two threads must lock on same semaphore."}, {"owner": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "edited": false, "score": 0, "creation_date": 1481737589, "post_id": 41144911, "comment_id": 69500231, "body": "Thank you. That explains alot. I&#39;ve implemented your solution. It compiles, but it gives me an error when it access the data. I&#39;ve updated my question with the error."}, {"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "reply_to_user": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "edited": false, "score": 1, "creation_date": 1481738656, "post_id": 41144911, "comment_id": 69500753, "body": "The errors are irrelevant to the codes, please put full code here or ask a new question. The error is about trying to free malloc&#39;ed region which freed previously (try to free a region twice)"}, {"owner": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "edited": false, "score": 0, "creation_date": 1481741550, "post_id": 41144911, "comment_id": 69502295, "body": "Here is the link to new question: <a href=\"http://stackoverflow.com/questions/41150014/error-while-compiling-the-code-double-free-or-corruption-out-using-threads-i\" title=\"error while compiling the code double free or corruption out using threads i\">stackoverflow.com/questions/41150014/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "is_accepted": false, "score": 2, "last_activity_date": 1481725311, "creation_date": 1481725311, "answer_id": 41144911, "question_id": 41143974, "link": "https://stackoverflow.com/questions/41143974/controlling-thread-order-using-semaphores-in-c/41144911#41144911", "title": "Controlling thread order using semaphores in C", "body": "<p>looks like semaphores defined this way </p>\n\n<pre><code>sem_t semaphores[N];\n</code></pre>\n\n<p>where N is number of semaphores</p>\n\n<p>For initializing a semaphore you should use sem_init function which takes a pointer to desired semaphore, a flag which enables shared process usage and initial value of the semaphore.</p>\n\n<pre><code>sem_init(&amp;semaphores[0], 0, 1);\n</code></pre>\n\n<p>In your case the semaphore instances stored in array called semaphores, so you have to iterate on all members of array to initialize</p>\n\n<pre><code>int i;\nfor(i=0;i&lt;N;i++)\n    sem_init(&amp;semaphores[i], 0, 1);\n</code></pre>\n\n<p>Finlay for using semaphores you have to call sem_wait and sem_post functions this way</p>\n\n<pre><code>sem_wait(&amp;semaphores[0 to N-1]); // Locking semaphore\nsem_post(&amp;semaphores[0 to N-1]); // Unlocking it\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6174804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f65b3567154e65e620b648e0d3408244?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Badacz", "link": "https://stackoverflow.com/users/6174804/jakub-badacz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1398, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1481736746, "creation_date": 1481722515, "last_edit_date": 1481736746, "question_id": 41143974, "link": "https://stackoverflow.com/questions/41143974/controlling-thread-order-using-semaphores-in-c", "title": "Controlling thread order using semaphores in C", "body": "<p>I'm new to C and I'm just trying to run this piece of code of Pacheco's book \"<em>An Introduction to Parallel Programming</em>\". And I just can't figure out how I should implement the semaphores initialization in <code>main()</code>. Are <code>&amp;semaphores[dest]</code> and <code>&amp;semaphores[my_rank]</code> arrays?</p>\n\n<p>C code:</p>\n\n<pre><code>/* messages is allocated and initialized to NULL in main */\n/* semaphores is allocated and initialized to 0 (locked) in main */\nvoid *Send_msg(void* rank) {\n    long my_rank = (long) rank;\n    long dest = (my_rank + 1) % thread_count;\n    char* my_msg = (char*)malloc(MSG_MAX*sizeof(char));\n\n    sprintf(my_msg, \"Hello to %ld from %ld\", dest, my_rank);\n    messages[dest] = my_msg;\n    sem_post(&amp;semaphores[dest])\n    /* \u2018\u2018Unlock\u2019\u2019 the semaphore of dest */\n\n    sem_wait(&amp;semaphores[my_rank]);/* Wait for our semaphore to be unlocked */\n    printf(\"Thread %ld &gt; %s\\n\", my_rank, messages[my_rank]);\n\n    return NULL;\n} /* Send_msg */\n</code></pre>\n\n<p>I want to implement this type of order mechanism as I am trying to write output array to a file. Here is my code:</p>\n\n<pre><code>int k = 0;\nlong dest = (my_rank + 1) % THREAD_COUNT;\n\nif(genCount%50==0){\n//incrementing file name\n\n//semapthore lock\nsem_post(&amp;semaphores[dest]);\n\nsem_wait(&amp;semaphores[my_rank]);\n\nsnprintf(buffer, sizeof(char) * 32, \"file%i.dat\", k);\n\n//open the file\nfp = fopen(buffer, \"r+\");\nif (fp == NULL) {\n  printf(\"I couldn't open file for writing.\\n\");\n  exit(0);\n}\n\nint loop1, loop2;\n\n//outputting the array into the file\nfor (loop1 = my_first_i; loop1 &lt; my_last_i; loop1++){\n  for(loop2 = my_first_i; loop2 &lt; my_last_i; loop2++){\nfprintf(fp,\"%d\\t\", map[loop1][loop2]);\n  }\n}\n\n//close the file\nfclose(fp);\n\nk++;\n</code></pre>\n\n<p>}</p>\n\n<p>The initialization of semaphors in the <code>main()</code>:</p>\n\n<pre><code>  int semCount;\n  for(semCount = 0; semCount &lt; THREAD_COUNT; semCount++){\n   sem_init(&amp;semaphores[semCount], 0, 1);\n  }\n</code></pre>\n\n<p>I also have it as a global variable:</p>\n\n<pre><code>#define THREAD_COUNT 4\nsem_t semaphores[THREAD_COUNT];\n</code></pre>\n\n<p>The program compiles, but it gives me this error:</p>\n\n<pre><code>      *** Error in `./ebola_serial': double free or corruption (out): 0x00007f49700008c0 ***\n  *** Error in `======= Backtrace: =========\n  /lib64/libc.so.6(+0x7238e)[0x7f49868f038e]\n  ./ebola_serial/lib64/libc.so.6(+0x7a0c8)[0x7f49868f80c8]\n  ': /lib64/libc.so.6(cfree+0x48)[0x7f49868fb798]\n  double free or corruption (out)/lib64/libc.so.6(fclose+0x113)[0x7f49868e6473]\n  ./ebola_serial[0x401717]\n  /lib64/libpthread.so.0(+0x75bd)[0x7f4986c395bd]\n  : 0x/lib64/libc.so.6(clone+0x6d)[0x7f498697562d]\n  ======= Memory map: ========\n  00007f49700008c000400000-00402000 r-xp 00000000 08:01 802698                             /home/name/Desktop/try ca/ebola_serial\n  00601000-00602000 r--p 00001000 08:01 802698                             /home/name/Desktop/try ca/ebola_serial\n  00602000-00603000 rw-p 00002000 08:01 802698                             /home/name/Desktop/try ca/ebola_serial\n  00603000-009d3000 rw-p 00000000 00:00 0 \n  01b96000-01bb7000 rw-p 00000000 00:00 0                                  [heap]\n  7f4970000000-7f4970021000 rw-p 00000000 00:00 0 \n  7f4970021000-7f4974000000 ---p 00000000 00:00 0 \n  7f4978000000-7f4978021000 rw-p 00000000 00:00 0 \n  7f4978021000-7f497c000000 ---p 00000000 00:00 0 \n  7f497c000000-7f497c021000 rw-p 00000000 00:00 0 \n  7f497c021000-7f4980000000 ---p 00000000 00:00 0 \n  7f4980000000-7f4980021000 rw-p 00000000 00:00 0 \n  7f4980021000-7f4984000000 ---p 00000000 00:00 0 \n  7f4984663000-7f4984679000 r-xp 00000000 08:01 131531                     /usr/lib64/libgcc_s-4.9.2.so.1\n  7f4984679000-7f4984878000 ---p 00016000 08:01 131531                     /usr/lib64/libgcc_s-4.9.2.so.1\n  7f4984878000-7f4984879000 r--p 00015000 08:01 131531                     /usr/lib64/libgcc_s-4.9.2.so.1\n  7f4984879000-7f498487a000 rw-p 00016000 08:01 131531                     /usr/lib64/libgcc_s-4.9.2.so.1\n  7f498487a000-7f498487b000 ---p 00000000 00:00 0 \n  7f498487b000-7f498507b000 rw-p 00000000 00:00 0                          [stack:7376]\n  7f498507b000-7f498507c000 ---p 00000000 00:00 0 \n  7f498507c000-7f498587c000 rw-p 00000000 00:00 0 \n  7f498587c000-7f498587d000 ---p 00000000 00:00 0 \n  7f498587d000-7f498607d000 rw-p 00000000 00:00 0                          [stack:7374]\n  7f498607d000-7f498607e000 ---p 00000000 00:00 0 \n  7f498607e000-7f498687e000 rw-p 00000000 00:00 0                          [stack:7373]\n  7f498687e000-7f4986a28000 r-xp 00000000 08:01 130947                     /usr/lib64/libc-2.20.so\n  7f4986a28000-7f4986c28000 ---p 001aa000 08:01 130947                     /usr/lib64/libc-2.20.so\n  7f4986c28000-7f4986c2c000 r--p 001aa000 08:01 130947                     /usr/lib64/libc-2.20.so\n  7f4986c2c000-7f4986c2e000 rw-p 001ae000 08:01 130947                     /usr/lib64/libc-2.20.so\n  7f4986c2e000-7f4986c32000 rw-p 00000000 00:00 0 \n  7f4986c32000-7f4986c49000 r-xp 00000000 08:01 130973                     /usr/lib64/libpthread-2.20.so\n  7f4986c49000-7f4986e48000 ---p 00017000 08:01 130973                     /usr/lib64/libpthread-2.20.so\n  7f4986e48000-7f4986e49000 r--p 00016000 08:01 130973                     /usr/lib64/libpthread-2.20.so\n  7f4986e49000-7f4986e4a000 rw-p 00017000 08:01 130973                     /usr/lib64/libpthread-2.20.so\n  7f4986e4a000-7f4986e4e000 rw-p 00000000 00:00 0 \n  7f4986e4e000-7f4986f53000 r-xp 00000000 08:01 130955                     /usr/lib64/libm-2.20.so\n  7f4986f53000-7f4987152000 ---p 00105000 08:01 130955                     /usr/lib64/libm-2.20.so\n  7f4987152000-7f4987153000 r--p 00104000 08:01 130955                     /usr/lib64/libm-2.20.so\n  7f4987153000-7f4987154000 rw-p 00105000 08:01 130955                     /usr/lib64/libm-2.20.so\n  7f4987154000-7f4987174000 r-xp 00000000 08:01 130940                     /usr/lib64/ld-2.20.so\n  7f4987353000-7f4987356000 rw-p 00000000 00:00 0 \n  7f498736d000-7f4987373000 rw-p 00000000 00:00 0 \n  7f4987373000-7f4987374000 r--p 0001f000 08:01 130940                     /usr/lib64/ld-2.20.so\n  7f4987374000-7f4987376000 rw-p 00020000 08:01 130940                     /usr/lib64/ld-2.20.so\n  7ffce31e3000-7ffce3205000 rw-p 00000000 00:00 0                          [stack]\n  7ffce320d000-7ffce320f000 r--p 00000000 00:00 0                          [vvar]\n  7ffce320f000-7ffce3211000 r-xp 00000000 00:00 0                          [vdso]\n  ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n  Aborted\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 3, "creation_date": 1481722328, "post_id": 41143890, "comment_id": 69490196, "body": "What happens when you try?  Do you get an error message?  What?"}, {"owner": {"reputation": 4243, "user_id": 3541063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6adceaa65067703d17fb70863dfa5bc8?s=128&d=identicon&r=PG&f=1", "display_name": "werediver", "link": "https://stackoverflow.com/users/3541063/werediver"}, "edited": false, "score": 1, "creation_date": 1481722541, "post_id": 41143890, "comment_id": 69490343, "body": "This way you are in danger of null-pointer dereferencing."}, {"owner": {"reputation": 6964, "user_id": 2261657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de05cbfc9a0fbef64f55eb69e761bee5?s=128&d=identicon&r=PG", "display_name": "\u03b3\u03b7\u03c1\u03ac\u03c3\u03ba\u03c9 \u03b4&#39; \u03b1\u03b5\u03af \u03c0\u03bf\u03bb\u03bb\u03ac \u03b4\u03b9\u03b4\u03b1\u03c3\u03ba\u03cc\u03bc\u03b5", "link": "https://stackoverflow.com/users/2261657/%ce%b3%ce%b7%cf%81%ce%ac%cf%83%ce%ba%cf%89-%ce%b4-%ce%b1%ce%b5%ce%af-%cf%80%ce%bf%ce%bb%ce%bb%ce%ac-%ce%b4%ce%b9%ce%b4%ce%b1%cf%83%ce%ba%cf%8c%ce%bc%ce%b5"}, "edited": false, "score": 0, "creation_date": 1481722555, "post_id": 41143890, "comment_id": 69490352, "body": "You allocated memory for the pointer not for the struct"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1481722692, "post_id": 41143890, "comment_id": 69490442, "body": "Why do you think that it is not possible? If you can ensure that the pointers are valid, you can access pointers like that. But it is not advisable."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481723000, "post_id": 41143890, "comment_id": 69490677, "body": "We need more context information, possibly a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Otherwise your question cannot be answered."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1481723694, "post_id": 41143890, "comment_id": 69491178, "body": "Maybe it&#39;s just a typo: <code>slinedlist</code> -&gt; <code>slinkedlist</code> ?"}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1481724743, "post_id": 41143890, "comment_id": 69491872, "body": "If we could actually see some code, it would help alot."}], "answers": [{"comments": [{"owner": {"reputation": 5213, "user_id": 6757971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1q1Q.jpg?s=128&g=1", "display_name": "Leon Carlo Valencia", "link": "https://stackoverflow.com/users/6757971/leon-carlo-valencia"}, "reply_to_user": {"reputation": 21, "user_id": 7296770, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WpXCbV7a_vQ/AAAAAAAAAAI/AAAAAAAADso/pXIUpmUgYeI/photo.jpg?sz=128", "display_name": "Harish G", "link": "https://stackoverflow.com/users/7296770/harish-g"}, "edited": false, "score": 0, "creation_date": 1481811218, "post_id": 41148440, "comment_id": 69532914, "body": "Just to clarify... by error, do you mean segmentation fault? Anyway, since both tmp=start-&gt;next-&gt;next; and tmp=start-&gt;next; tmp=tmp-&gt;next; are logically the same, there is only one last explanation I could think of: the compiler optimizes the former resulting to an out of order execution between the 1st and 2nd dereference."}, {"owner": {"reputation": 5213, "user_id": 6757971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1q1Q.jpg?s=128&g=1", "display_name": "Leon Carlo Valencia", "link": "https://stackoverflow.com/users/6757971/leon-carlo-valencia"}, "reply_to_user": {"reputation": 21, "user_id": 7296770, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WpXCbV7a_vQ/AAAAAAAAAAI/AAAAAAAADso/pXIUpmUgYeI/photo.jpg?sz=128", "display_name": "Harish G", "link": "https://stackoverflow.com/users/7296770/harish-g"}, "edited": false, "score": 0, "creation_date": 1481811485, "post_id": 41148440, "comment_id": 69533091, "body": "One way to check if that is indeed the problem is to look at the assembly code generated. If the former resulted to a dereferencing that are close in succession, then an out of order execution will cause a seg fault. In that case, it&#39;s a compiler bug."}, {"owner": {"reputation": 5213, "user_id": 6757971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1q1Q.jpg?s=128&g=1", "display_name": "Leon Carlo Valencia", "link": "https://stackoverflow.com/users/6757971/leon-carlo-valencia"}, "reply_to_user": {"reputation": 21, "user_id": 7296770, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WpXCbV7a_vQ/AAAAAAAAAAI/AAAAAAAADso/pXIUpmUgYeI/photo.jpg?sz=128", "display_name": "Harish G", "link": "https://stackoverflow.com/users/7296770/harish-g"}, "edited": false, "score": 0, "creation_date": 1481811721, "post_id": 41148440, "comment_id": 69533258, "body": "Having a tmp to hold the result of the 1st dereferencing would result to dereferencing assembly instructions that are further apart which would ensure that the 1st one is already done before the 2nd one is attempted."}], "tags": [], "owner": {"reputation": 5213, "user_id": 6757971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1q1Q.jpg?s=128&g=1", "display_name": "Leon Carlo Valencia", "link": "https://stackoverflow.com/users/6757971/leon-carlo-valencia"}, "is_accepted": false, "score": 1, "last_activity_date": 1481735746, "creation_date": 1481735746, "answer_id": 41148440, "question_id": 41143890, "link": "https://stackoverflow.com/questions/41143890/why-it-is-not-possible-to-access-pointer-in-linked-list-like-this/41148440#41148440", "title": "Why it is not possible to access pointer in linked list like this?", "body": "<p>As soon as tmp points to the last node, tmp->next will be null such that tmp->next->next will cause a null pointer dereferencing.</p>\n"}], "owner": {"reputation": 21, "user_id": 7296770, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WpXCbV7a_vQ/AAAAAAAAAAI/AAAAAAAADso/pXIUpmUgYeI/photo.jpg?sz=128", "display_name": "Harish G", "link": "https://stackoverflow.com/users/7296770/harish-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1481784696, "creation_date": 1481722218, "last_edit_date": 1481784696, "question_id": 41143890, "link": "https://stackoverflow.com/questions/41143890/why-it-is-not-possible-to-access-pointer-in-linked-list-like-this", "title": "Why it is not possible to access pointer in linked list like this?", "body": "<p>I declared node as follows,</p>\n\n<pre><code>typedef struct slinkedlist {\n    int data;\n    struct slinedlist *next;\n} node;\n</code></pre>\n\n<p>I have temp pointer <code>node * tmp</code> in my code, why can't I access <code>tmp-&gt;next-&gt;next</code>.</p>\n\n<p>/* Added code */</p>\n\n<pre><code>   typedef struct slinkedlist {\n        int data;\n        struct slinedlist *next;\n    } node;\n\n\n    node *start;\n\n/* Assume I have 5 nodes in a list */\n\n    void ex(void)\n    {\n        node *tmp;\n\n        tmp = start-&gt;next-&gt;next; /* This will be error in C , explain me, why? */\n\n        /* But this works fine */\n        tmp = start-&gt;next;\n        tmp = tmp-&gt;next;\n    }\n</code></pre>\n\n<p>why i will get error if i access start->next->next?</p>\n"}, {"tags": ["c", "macros", "arguments"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1481721878, "post_id": 41143751, "comment_id": 69489908, "body": "Why you want a macro while you can surely use a function to do that?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1481721961, "post_id": 41143751, "comment_id": 69489967, "body": "Not directly related, bit <b>never</b> define macros like <code>#define add_three_arguments(x,y,z) x+y+z</code> but always put the expression into <code>()</code> like this: <code>#define add_three_arguments(x,y,z) (x+y+z)</code>. Otherwise if you use <code>x = add_three_arguments(1,2,3) * 10</code> the result will not be what you expect."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 1, "creation_date": 1481722181, "post_id": 41143751, "comment_id": 69490108, "body": "It would really help if you would tell us the higher-level goal you&#39;re trying to achieve here."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481722885, "post_id": 41143751, "comment_id": 69490587, "body": "This looks like an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a> to me."}], "answers": [{"tags": [], "owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "is_accepted": false, "score": 0, "last_activity_date": 1481724335, "last_edit_date": 1481724335, "creation_date": 1481723442, "answer_id": 41144286, "question_id": 41143751, "link": "https://stackoverflow.com/questions/41143751/macro-expansion-to-additional-macro-arguments/41144286#41144286", "title": "macro expansion to additional macro arguments", "body": "<p>Try the following:</p>\n\n<pre><code>#define EMPTY\n#define EVAL(X) X\n#define add_three_arguments(x,y,z) x+y+z\n#define extra_arguments ,constant1,constant2\n#define make_value(A) EVAL(add_three_arguments EMPTY (A extra_arguments))\n\nmake_value(5);\n</code></pre>\n\n<p>However, if you redesign your macros you may get a nicer solution not requiring such constructs. </p>\n"}, {"tags": [], "owner": {"reputation": 418, "user_id": 2421075, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6d41281e21a653afc88140ceff794db5?s=128&d=identicon&r=PG", "display_name": "iamacomputer", "link": "https://stackoverflow.com/users/2421075/iamacomputer"}, "is_accepted": false, "score": 1, "last_activity_date": 1481807212, "creation_date": 1481807212, "answer_id": 41164941, "question_id": 41143751, "link": "https://stackoverflow.com/questions/41143751/macro-expansion-to-additional-macro-arguments/41164941#41164941", "title": "macro expansion to additional macro arguments", "body": "<p>The closest solution I have found is this:</p>\n\n<pre><code>int constant1=2, constant2=3;\n#define _add_three_arguments(x,y,z) x+y+z\n#define add_three_arguments(...) _add_three_arguments(__VA_ARGS__)\n\n#define extra_arguments ,constant1,constant2\n#define make_value(A) add_three_arguments(A extra_arguments)\n\nint r = make_value(5);\n</code></pre>\n\n<p>Which is of course not a solution to the problem I stated.  So the current answer seems to be, \"this is not possible.\"  But maybe a new version of clang/gcc will somehow enable this.  I will leave the question open.</p>\n"}], "owner": {"reputation": 418, "user_id": 2421075, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6d41281e21a653afc88140ceff794db5?s=128&d=identicon&r=PG", "display_name": "iamacomputer", "link": "https://stackoverflow.com/users/2421075/iamacomputer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481807212, "creation_date": 1481721757, "question_id": 41143751, "link": "https://stackoverflow.com/questions/41143751/macro-expansion-to-additional-macro-arguments", "title": "macro expansion to additional macro arguments", "body": "<p>I'm looking for a way of making a macro that expands to extra arguments:</p>\n\n<pre><code>int constant1=2, constant2=3;\n#define add_three_arguments(x,y,z) x+y+z\n#define extra_arguments ,constant1,constant2\n#define make_value(A) add_three_arguments(A extra_arguments)\n\nint r = make_value(5);\n</code></pre>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1481722293, "post_id": 41143390, "comment_id": 69490171, "body": "Read the manpage. <a href=\"http://man7.org/linux/man-pages/man3/pthread_create.3.html\" rel=\"nofollow noreferrer\"><code>pthread_create</code></a> wants a pointer to <code>const pthread_attr_t</code> in the second argument and you provide an <code>int</code> instead."}, {"owner": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "edited": false, "score": 0, "creation_date": 1481723820, "post_id": 41143390, "comment_id": 69491270, "body": "I guess you also want to define the variable <code>a</code> in the <code>print_fun</code>. You also miss check whether <code>pid3==0</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1492588"}, "reply_to_user": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "edited": false, "score": 0, "creation_date": 1481724162, "post_id": 41143390, "comment_id": 69491502, "body": "@MarekKlein: I have done it.  Thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1481722608, "creation_date": 1481722608, "answer_id": 41144009, "question_id": 41143390, "link": "https://stackoverflow.com/questions/41143390/couldnt-pass-a-value-to-a-thread-in-c/41144009#41144009", "title": "Couldn&#39;t pass a value to a thread in C", "body": "<p>You probably want this: </p>\n\n<pre><code>pthread_create(&amp;t1, NULL, print_fun, (void*)2);\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>pthread_create(&amp;t1, 2, print_fun, NULL);\n</code></pre>\n\n<p>The second argument of <code>pthread_create</code> is a pointer to a <code>pthread_attr_t</code> structure or <code>NULL</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1492588"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 41144009, "answer_count": 1, "score": 0, "last_activity_date": 1481722726, "creation_date": 1481720654, "last_edit_date": 1481722726, "question_id": 41143390, "link": "https://stackoverflow.com/questions/41143390/couldnt-pass-a-value-to-a-thread-in-c", "title": "Couldn&#39;t pass a value to a thread in C", "body": "<p>I am new in thread subject and I want to create some process and threads. However I couldn't pass my value to the thread.</p>\n\n<p>Please let me know what is wrong in my code.</p>\n\n<p>When I compile I got the following error:</p>\n\n<blockquote>\n  <p>warning: passing argument 2 of \u2018pthread_create\u2019 makes pointer from integer without a cast [-Wint-conversion]</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/fcntl.h&gt;\n#include &lt;pthread.h&gt;\n///////////////////////////\n\nvoid *print_fun(int *id)    {\n\n    printf(\"Thread #%d is using the print function now! \\n\",a);\n}\n\nint main()\n{\n    int pid1,pid2,pid3;\n    pthread_t t1,t2;\n\n    pid1=fork();\n    if (pid1==0)\n    {//child #1\n        pthread_create(&amp;t1,1,print_fun,NULL);\n        printf(\"The child of process #1 has been created!!\\n\");\n    }\n    if (pid1&gt;0)\n    {//Father #1\n        printf(\"The process #1 has been created!!\\n\");\n        pid2=fork();\n        if (pid2&gt;0)//Father #2\n        {\n            printf(\"The process #2 has been created!!\\n\");\n            pid3=fork();\n            if (pid3&gt;0)//Father #3\n            {\n                printf(\"The process #3 has been created!!\\n\");\n            }\n            else\n            {\n                printf(\"There is error in the third fork!\\n\");\n            }\n        }\n        else if(pid2==0)//child #2\n        {\n            pthread_create(&amp;t1,2,print_fun,NULL);\n            printf(\"The child of process #2 has been created!!\\n\");\n        }\n        else\n        {\n            printf(\"There is error in the second fork!\\n\");\n        }\n    }\n    else\n    {//error\n        printf(\"There is error in the first fork!\\n\");\n    }\n\n    pthread_exit(NULL);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 3, "creation_date": 1481719770, "post_id": 41143070, "comment_id": 69488502, "body": "How would you? This isn&#39;t Coders For Free.com ..."}, {"owner": {"reputation": 498, "user_id": 7110778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HyB4Q.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/7110778/andrew"}, "edited": false, "score": 0, "creation_date": 1481719914, "post_id": 41143070, "comment_id": 69488616, "body": "See <a href=\"https://en.wikibooks.org/wiki/C_Programming/Arrays\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/C_Programming/Arrays</a> for information C arrays. There is also a section on data types."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1481719930, "post_id": 41143070, "comment_id": 69488632, "body": "Please create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> of what you have and what you have tried. Then tell us how it does or doesn&#39;t work."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481720668, "post_id": 41143070, "comment_id": 69489127, "body": "This is an integer array with pointers converted to integers. You really should first get the basics right. Mabe you then can do your homework yourself or at least follow the advice in <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1481724972, "post_id": 41143070, "comment_id": 69492017, "body": "<code>int stringAscii</code>?, Shouldn&#39;t it be <code>char *stringAscii[] = {..........};</code>? Unless those values are indeed integers, and not strings with <code>&quot; &quot;</code>."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1481726468, "post_id": 41143070, "comment_id": 69492962, "body": "<code>fflush(stdin)</code> =&gt; UB."}], "answers": [{"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": true, "score": 1, "last_activity_date": 1481727317, "last_edit_date": 1481727317, "creation_date": 1481726357, "answer_id": 41145277, "question_id": 41143070, "link": "https://stackoverflow.com/questions/41143070/integer-array-to-string-in-c-programming/41145277#41145277", "title": "Integer array to string in c programming", "body": "<p>Assuming that your <code>stringAscii</code> array is:</p>\n\n<pre><code>int stringAscii[] = {72, 101, 108, 108, 111, 32, \n                     87, 111, 114, 108, 100};\n</code></pre>\n\n<p>And not:</p>\n\n<pre><code>int stringAscii = {\"072\", \"101\", \"108\", \"108\", \"111\", \"032\", \n                   \"087\", \"111\", \"114\", \"108\", \"100\"};\n</code></pre>\n\n<p>Which is incorrect for two reasons:</p>\n\n<ul>\n<li>you need to have <code>stringAscii[]</code> as your array name.</li>\n<li>You can't have string <code>\" \"</code> values as members of an integer array. That is type conflict in C.</li>\n</ul>\n\n<p>You can dynamically allocate space for <code>char *string</code> using <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_malloc.htm\" rel=\"nofollow noreferrer\"><code>malloc</code></a>, and add your ascii integer values to the dynamic array one at a time. </p>\n\n<p>You can <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_free.htm\" rel=\"nofollow noreferrer\"><code>free</code></a> the requested space at the end. </p>\n\n<p>Something like this will help you get started:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar *stringAsciiToString(int stringAscii[], const size_t size);\n\nint\nmain(int argc, char *argv[]) {\n    int stringAscii[] = {72, 101, 108, 108, 111, 32, \n                     87, 111, 114, 108, 100};\n\n    const size_t size = sizeof(stringAscii)/sizeof(*stringAscii);\n\n    char *string = stringAsciiToString(stringAscii, size);\n\n    printf(\"Output -&gt; '%s'\\n\", string);\n\n    free(string);\n\n    return 0;\n}\n\nchar \n*stringAsciiToString(int stringAscii[], const size_t size) {\n    int i, slen = 0;\n\n    char *string = malloc((size+1) * sizeof(*string));\n    if (!string) {\n        printf(\"Cannot allocate memory\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    for (i = 0; i &lt; size; i++) {\n        string[slen++] = stringAscii[i];\n    }\n    string[slen] = '\\0';\n\n    return string;\n}\n</code></pre>\n\n<p>Output here: <a href=\"http://ideone.com/wdliVr\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 427, "user_id": 5736983, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/f7572b1f8a84e9507945668c0d01cf58?s=128&d=identicon&r=PG&f=1", "display_name": "TobiasKnudsen", "link": "https://stackoverflow.com/users/5736983/tobiasknudsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1418, "favorite_count": 0, "closed_date": 1481734393, "accepted_answer_id": 41145277, "answer_count": 1, "score": -1, "last_activity_date": 1481727317, "creation_date": 1481719684, "last_edit_date": 1481720519, "question_id": 41143070, "link": "https://stackoverflow.com/questions/41143070/integer-array-to-string-in-c-programming", "closed_reason": "Needs more focus", "title": "Integer array to string in c programming", "body": "<p>Lets say i have an integer array with ascii values.</p>\n\n<pre><code>int stringAscii = {\"072\", \"101\", \"108\", \"108\", \"111\", \"032\", \n                   \"087\", \"111\", \"114\", \"108\", \"100\"};\n</code></pre>\n\n<p>and i want to convert the ascii values to characters and combine them to a string:</p>\n\n<pre><code>char *string = stringAsciiToString(stringAscii);\n\nprintf(\"Output -&gt; '%s'\", string);\n</code></pre>\n\n<p>// output -> 'Hello World'</p>\n\n<p>How would you make such a function? This is what i got so far;</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;math.h&gt;\n#include&lt;string.h&gt;\n\nlong int p,q,n,t,flag,e[100],d[100],temp[100],j,m[100],en[100],i;\nchar msg[100];\nint prime(long int);\nvoid ce();\nlong int cd(long int);\nvoid encrypt();\nvoid decrypt();\n\nint main()\n{\n    p = 53;\n    q = 61;\n    printf(\"\\nENTER MESSAGE\\n\");\n    fflush(stdin);\n    scanf(\"%s\",msg);\n\n    for(i=0;msg[i]!=NULL;i++)\n      m[i]=msg[i];\n    n=p*q;\n    t=(p-1)*(q-1);\n    ce();\n\n    encrypt();\n    decrypt();\n\n    strcpy(msg, \"\");\n\n    for(i=0;en[i]!=-1;i++) {\n      strcpy(msg, concat(msg, en[i]));\n    }\n\n    printf(\"%s\", msg);\n\n    return 0;\n}\n\nchar* concat(const char *s1, const char *s2) {\n    char *result = malloc(strlen(s1)+strlen(s2)+1);                              //+1 for the zero-terminator\n    strcpy(result, s1);\n    strcat(result, s2);\n    return result;\n}\n\nint prime(long int pr)\n{\n   int i;\n   j=sqrt(pr);\n   for(i=2;i&lt;=j;i++)\n   {\n      if(pr%i==0)\n         return 0;\n   }\n   return 1;\n}\n\nvoid ce()\n{\n   int k;\n   k=0;\n   for(i=2;i&lt;t;i++)\n        {\n            if(t%i==0)\n                continue;\n                flag=prime(i);\n            if(flag==1&amp;&amp;i!=p&amp;&amp;i!=q)\n            {\n                e[k]=i; flag=cd(e[k]);\n                if(flag&gt;0)\n      {\n         d[k]=flag;\n         k++;\n      }\n      if(k==99)\n         break;\n      }\n   }\n}\n\nlong int cd(long int x)\n{\n   long int k=1;\n   while(1)\n   {\n      k=k+t;\n      if(k%x==0)\n         return(k/x);\n   }\n}\n\nvoid encrypt()\n{\n   long int pt,ct,key=e[0],k,len;\n   i=0;\n   len=strlen(msg);\n   while(i!=len)\n   {\n      pt=m[i];\n      pt=pt-96;\n      k=1;\n      for(j=0;j&lt;key;j++)\n      {\n         k=k*pt;\n         k=k%n;\n      }\n      temp[i]=k;\n      ct=k+96;\n      en[i]=ct;\n      i++;\n   }\n   en[i]=-1;\n   printf(\"\\nTHE ENCRYPTED MESSAGE IS\\n\");\n   for(i=0;en[i]!=-1;i++)\n      printf(\"%c\",en[i]);\n}\n\nvoid decrypt()\n{\n   long int pt,ct,key=d[0],k;\n   i=0;\n   while(en[i]!=-1)\n   {\n      ct=temp[i];\n      k=1;\n      for(j=0;j&lt;key;j++)\n      {\n         k=k*ct;\n         k=k%n;\n      }\n      pt=k+96;\n      m[i]=pt;\n      i++;\n   }\n   m[i]=-1;\n   printf(\"\\nTHE DECRYPTED MESSAGE IS\\n\");\n   for(i=0;m[i]!=-1;i++)\n      printf(\"%c\",m[i]);\n}\n</code></pre>\n"}, {"tags": ["c", "visual-studio", "console-application"], "comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1481717276, "post_id": 41142189, "comment_id": 69486870, "body": "&quot;my <code>createFile</code> function is not working&quot; - what exactly is not working in it???"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1481717395, "post_id": 41142189, "comment_id": 69486942, "body": "On a semi-related note: don&#39;t user <code>void main</code>. It&#39;s <code>int main</code>"}, {"owner": {"reputation": 57, "user_id": 5975106, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-xCXc4MwvGR8/AAAAAAAAAAI/AAAAAAAAAF4/sYzv0shFHE4/photo.jpg?sz=128", "display_name": "Angel Vasilev", "link": "https://stackoverflow.com/users/5975106/angel-vasilev"}, "edited": false, "score": 0, "creation_date": 1481717399, "post_id": 41142189, "comment_id": 69486948, "body": "That&#39;s exactly what I cannot figure out. Code-wise it&#39;s correct. Here is input I tried. After I enter the name and and then enter &quot;1&quot; it should display &quot;File created&quot; and I should see I file in the folder of the solution. Problem is it just loops. Same for the other funcions when I call them.  Here is an example - <a href=\"http://i.imgur.com/zl4UkzR.png\" rel=\"nofollow noreferrer\">i.imgur.com/zl4UkzR.png</a>"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1481717448, "post_id": 41142189, "comment_id": 69486979, "body": "<code>case 1: createFile; break;</code> that&#39;s not how you call a function - it should be <code>case 1: createFile(); break;</code>: NOTE the parentheses after the function name"}, {"owner": {"reputation": 57, "user_id": 5975106, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-xCXc4MwvGR8/AAAAAAAAAAI/AAAAAAAAAF4/sYzv0shFHE4/photo.jpg?sz=128", "display_name": "Angel Vasilev", "link": "https://stackoverflow.com/users/5975106/angel-vasilev"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1481717491, "post_id": 41142189, "comment_id": 69487009, "body": "@UnholySheep our professor requires it&#39;s void."}, {"owner": {"reputation": 57, "user_id": 5975106, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-xCXc4MwvGR8/AAAAAAAAAAI/AAAAAAAAAF4/sYzv0shFHE4/photo.jpg?sz=128", "display_name": "Angel Vasilev", "link": "https://stackoverflow.com/users/5975106/angel-vasilev"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1481717537, "post_id": 41142189, "comment_id": 69487042, "body": "@UnholySheep Oh my god.... THANK YOU! I really feel like an idiot. Have a nice day dude!"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1481717603, "post_id": 41142189, "comment_id": 69487082, "body": "Please also tell your professor that <code>void main</code> is not standard compliant and as such not portable. The standard defines <code>int main</code> as the required function signature (see <a href=\"http://stackoverflow.com/a/2108208/2878796\">this answer</a> for more details)"}, {"owner": {"reputation": 57, "user_id": 5975106, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-xCXc4MwvGR8/AAAAAAAAAAI/AAAAAAAAAF4/sYzv0shFHE4/photo.jpg?sz=128", "display_name": "Angel Vasilev", "link": "https://stackoverflow.com/users/5975106/angel-vasilev"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1481717726, "post_id": 41142189, "comment_id": 69487159, "body": "@UnholySheep If you see our lectures, you&#39;ll be shocked. It&#39;s old-school C. They&#39;re working on Visual studio 2006 and when we use free community version of 2015 with c++14 standards we have to use scanf_s and such which makes it really uncomfortable. Errors occurs quite often and what not."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481718222, "post_id": 41142189, "comment_id": 69487488, "body": "1) m<code>void main()</code> is invalid-&gt;undefined behaviour 2) <code>scanf_s</code> usage wrong. Read the docs of all functions you use! -&gt; undefined behaviour. Not checking for function resuls, namely <code>fopen</code>, but others too -&gt; problems or even undefined behaviour. 4) Usage of <code>feof</code> wrong-&gt;undefined behaviour. Fix the code, read the documentation. Enable warnings and don&#39;t ignore them! And see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. We are not a debugging service."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 5975106, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-xCXc4MwvGR8/AAAAAAAAAAI/AAAAAAAAAF4/sYzv0shFHE4/photo.jpg?sz=128", "display_name": "Angel Vasilev", "link": "https://stackoverflow.com/users/5975106/angel-vasilev"}, "edited": false, "score": 1, "creation_date": 1481718418, "post_id": 41142424, "comment_id": 69487612, "body": "@UnholySheep already found my problem. My code is floppy but the problem was that I didn&#39;t call for my funcions properly. I forgot &quot;()&quot; in my main function when I want to call them. Still I&#39;ll take what you said and fix it. Thanks a lot :)"}], "tags": [], "owner": {"reputation": 11, "user_id": 7296112, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wLuzZ.png?s=128&g=1", "display_name": "Hira", "link": "https://stackoverflow.com/users/7296112/hira"}, "is_accepted": false, "score": 1, "last_activity_date": 1481718584, "last_edit_date": 1481718584, "creation_date": 1481717776, "answer_id": 41142424, "question_id": 41142189, "link": "https://stackoverflow.com/questions/41142189/console-app-menu-not-working-in-c/41142424#41142424", "title": "Console app menu not working in C", "body": "<p>i think you should use your struct variable like this:</p>\n\n<pre><code>struct Student {\nchar ime[50];\nchar fn[10];\nint ocfiz, ocmat, ocpro;\n}ps;\n</code></pre>\n\n<p>or use</p>\n\n<pre><code>struct Student ps;\n</code></pre>\n\n<p>instead of just student ps,or you can decleare it in main function..And passing a struct in a functin is </p>\n\n<pre><code>void readStud( struct Student *s)() {\n//your code...\n}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5975106, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-xCXc4MwvGR8/AAAAAAAAAAI/AAAAAAAAAF4/sYzv0shFHE4/photo.jpg?sz=128", "display_name": "Angel Vasilev", "link": "https://stackoverflow.com/users/5975106/angel-vasilev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1481718584, "creation_date": 1481717077, "question_id": 41142189, "link": "https://stackoverflow.com/questions/41142189/console-app-menu-not-working-in-c", "title": "Console app menu not working in C", "body": "<p>guys! So I have an assignment to create a structure that includes variables based on what information I need to store and to bring out a menu that calls different functions and does different things. The problems is that for some reason my createFile function is not working at all and I've been looking for errors for 2 days and I simply cannot spot where this is coming from.</p>\n\n<p>Ignore the changeStud funcion as I'm still working on it. I simply want to create my file when I enter the name for it and then chose the nnumber of the function. (in my case > enter filename> enter 1> it just loops the menu function and it should create a file)</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include \"stdafx.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct Student {\n    char ime[50];\n    char fn[10];\n    int ocfiz, ocmat, ocpro;\n};\nchar filename[20];\n\nFILE *fd;\n\nStudent ps;\n\nvoid createFile() {\n    fd = fopen(filename, \"wb\");\n    fclose(fd);\n    printf(\"File created!\\n\");\n}\n\nvoid readStud(Student *s) {\n    printf(\"Enter data for new student\");\n    getchar();\n    printf(\"Enter student name:\"); \n    gets_s(s-&gt;ime);\n    printf(\"\\nEnter FN:\");\n    scanf_s(\"%s\", s-&gt;fn);\n    printf(\"\\nEnter marks for Maths, Programming, Physics\");\n    scanf_s(\"%d %d %d\", &amp;s-&gt;ocmat, &amp;s-&gt;ocpro, &amp;s-&gt;ocfiz);\n    getchar(); \n}\nvoid addStud() {\n    fd = fopen(filename, \"a+b\");\n    char c;\n    do {\n        readStud(&amp;ps);\n        fwrite(&amp;ps, sizeof(ps), 1, fd);\n        printf(\"More Students? (y/n) : \");\n        c = getchar(); getchar();\n    } while (c == 'y');\n    fclose(fd);\n}\n\nvoid writeAllStud() {\n        fd = fopen(filename, \"rb\");\n        printf(\"students in file\\n\");\n        fread(&amp;ps, sizeof(ps), 1, fd);\n        while (!feof(fd)) {\n            printf(\"%s fn: %s ocmat: %d ocpro: %d ocfiz: %d\", ps.ime, ps.fn, ps.ocmat, ps.ocpro, ps.ocfiz);\n            fread(&amp;ps, sizeof(ps), 1, fd);\n        }\n        fclose(fd);\n}/*\nvoid changeStud() {\n    char fn2[50];\n    printf(\"enter FN:\");\n    gets_s(fn2);\n    fd = fopen(filename, \"r+b\");\n    fread(&amp;ps, sizeof(ps), 1, fd);\n    while (!feof(fd)) {\n        if (strcmp(ps.fn, fn2)==0) {\n\n            fseek(fd, -(long) sizeof(ps), SEEK_CUR);\n            fwrite(&amp;ps, sizeof(ps, 1, fd));\n            break;\n        }\n    }\n}*/\n\nvoid Avg() {\n\n}\n\nvoid exportData() {\n    FILE *txt;\n    txt = fopen(\"students.txt\", \"wt\");\n    fd = fopen(filename, \"rb\");\n    fread(&amp;ps, sizeof(ps), 1, fd);\n    while (!feof(fd)) {\n        fprintf(txt, \"%s %s marks fiz%d mat%d prog%d\\n\", ps.fn, ps.ime, ps.ocfiz, ps.ocmat, ps.ocpro);\n        fread(&amp;ps, sizeof(ps), 1, fd);\n    }\n    fclose(fd);\n    fclose(txt);\n    printf(\"students have been written to a text file.\\n\");\n}\nvoid main() {\n    printf(\"Enter file name:\");\n    gets_s(filename);\n    int c;\n    do {\n        printf(\"\\nMenu:\\n\");\n        printf(\"0 Exit\\n\");\n        printf(\"1 Create file\\n\");\n        printf(\"2 Add new student data\\n\");\n        printf(\"3 Change data from FN\\n\");\n        printf(\"4 AVG marks for maths, programming, physics\\n\");\n        printf(\"5 export all AVG marks to .txt file\\n\");\n        scanf(\"%d\", &amp;c);\n        switch (c) {\n        case 1: createFile; break;\n        case 2: addStud; break;\n        //case 3: changeStud; break;\n        case 4: Avg; break;\n        case 5: exportData; break;\n        }\n    } while (c != 0);\n}\n</code></pre>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1481719317, "post_id": 41142090, "comment_id": 69488215, "body": "rmem_default/rmem_max: if need be, increase the value of rmem_max. <a href=\"https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Performance_Tuning_Guide/s-network-dont-adjust-defaults.html\" rel=\"nofollow noreferrer\">access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Lin&zwnj;&#8203;ux/&hellip;</a>"}, {"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "edited": false, "score": 1, "creation_date": 1481726012, "post_id": 41142090, "comment_id": 69492695, "body": "Looks like its not possible , <a href=\"http://stackoverflow.com/a/2090902/4490542\">stackoverflow.com/a/2090902/4490542</a>"}, {"owner": {"reputation": 21, "user_id": 7296371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c74ac9284fd06665b65f65f729b99a1?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Mishra", "link": "https://stackoverflow.com/users/7296371/ravi-mishra"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1481786295, "post_id": 41142090, "comment_id": 69518062, "body": "@unwind:  We have gone through the redhat documentation and not able to set receive buffer ore than rmem_max max value which were already set in OS."}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1539158151, "post_id": 41142090, "comment_id": 92395331, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2090850/specifying-udp-receive-buffer-size-at-runtime-in-linux\">Specifying UDP receive buffer size at runtime in Linux</a>"}], "owner": {"reputation": 21, "user_id": 7296371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c74ac9284fd06665b65f65f729b99a1?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Mishra", "link": "https://stackoverflow.com/users/7296371/ravi-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1481786341, "creation_date": 1481716775, "last_edit_date": 1481786341, "question_id": 41142090, "link": "https://stackoverflow.com/questions/41142090/by-c-code-increase-udp-receive-buffer-size-more-than-rmem-max-max-value", "title": "By C code increase UDP receive buffer size more than rmem_max max value", "body": "<p>In Linux, one can specify the system's default receive buffer size for network packets, say UDP, using the following command:</p>\n\n<pre><code>$ sysctl -w net.core.rmem_max=&lt;value&gt;\n</code></pre>\n\n<p>Can we use <code>setsockoption()</code> to handle socket?  We have tried multiple times but this option is not giving the more than <code>rmem_max</code> max value which were already set in OS.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1481717063, "post_id": 41142050, "comment_id": 69486758, "body": "What does &quot;not work&quot; mean, to you? Please describe the outcome, and the expected outcome. Also, remember that I/O can fai: you should check the return value of <code>scanf()</code>."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1481717346, "post_id": 41142050, "comment_id": 69486909, "body": "What is the aim of this code?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481718011, "post_id": 41142050, "comment_id": 69487350, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a Minimal, Complete, and Verifiable example."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481725111, "post_id": 41142050, "comment_id": 69492103, "body": "<code>scanf(&quot;%*[^\\n]&quot;); &#47;&#47; fflush does not work on Macs. This is an alternative.</code> does not scan in a <code>&#39;\\n&#39;</code>.  So any &lt;Enter key&gt; will only be read with <code>scanf(&quot;%c&quot;, &amp;x);</code>.  Recommend using <code>fgets(buffer, ...)</code> for user input and then scan the buffer for the desired text"}], "answers": [{"tags": [], "owner": {"reputation": 569, "user_id": 4181430, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1488320649/picture?type=large", "display_name": "jurhas", "link": "https://stackoverflow.com/users/4181430/jurhas"}, "is_accepted": false, "score": 1, "last_activity_date": 1481717589, "creation_date": 1481717589, "answer_id": 41142365, "question_id": 41142050, "link": "https://stackoverflow.com/questions/41142050/why-does-isdigit-always-return-false/41142365#41142365", "title": "Why does isdigit always return false?", "body": "<p>I cannot understand what are you trying to do. First if you need the integer number of a charachter you should leave the value '0' so  </p>\n\n<pre><code>c-'0'.\n</code></pre>\n\n<p>Then rather than use scanf, if you should just get a charachter much better getchar()\nto flush just </p>\n\n<pre><code> while(getchar()!='\\n')\n              ;\n</code></pre>\n\n<p>Than if you do not want use the proper <em>scanf(\"%d\",&amp;int_variable);</em> you have to build a function to rebuild the number, it means take the charachter, leave '0' and multiply by ten at each following charachter. </p>\n"}, {"comments": [{"owner": {"reputation": 14730, "user_id": 6120338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0865ba5a8a6f29ef80937137f7869026?s=128&d=identicon&r=PG", "display_name": "Ritwick Dey", "link": "https://stackoverflow.com/users/6120338/ritwick-dey"}, "edited": false, "score": 0, "creation_date": 1481720698, "post_id": 41142816, "comment_id": 69489153, "body": "Solution 1 is added."}, {"owner": {"reputation": 14730, "user_id": 6120338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0865ba5a8a6f29ef80937137f7869026?s=128&d=identicon&r=PG", "display_name": "Ritwick Dey", "link": "https://stackoverflow.com/users/6120338/ritwick-dey"}, "edited": false, "score": 0, "creation_date": 1481721576, "post_id": 41142816, "comment_id": 69489703, "body": "Solution 2 added."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1481722148, "post_id": 41142816, "comment_id": 69490083, "body": "<code>fflush(stdin)</code> is undefined behaviour."}, {"owner": {"reputation": 14730, "user_id": 6120338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0865ba5a8a6f29ef80937137f7869026?s=128&d=identicon&r=PG", "display_name": "Ritwick Dey", "link": "https://stackoverflow.com/users/6120338/ritwick-dey"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1481722371, "post_id": 41142816, "comment_id": 69490228, "body": "&#39;fflush(stdin)&#39;  is works fine is Windows &amp; Linux. I don&#39;t about MACs"}, {"owner": {"reputation": 23, "user_id": 5504622, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cx8FoiQXAjM/AAAAAAAAAAI/AAAAAAAAAlM/B4F9zGV1AVQ/photo.jpg?sz=128", "display_name": "Rogier Reerink", "link": "https://stackoverflow.com/users/5504622/rogier-reerink"}, "edited": false, "score": 1, "creation_date": 1481735502, "post_id": 41142816, "comment_id": 69499026, "body": "Thank you! I think that this is what I am looking for!"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1481740293, "post_id": 41142816, "comment_id": 69501602, "body": "&quot;works fine&quot; is not an answer to &quot;undefined behavior&quot;. It is still undefined behavior, and you still should not be using it, even if it <i>appears</i> to &quot;work fine&quot;."}, {"owner": {"reputation": 14730, "user_id": 6120338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0865ba5a8a6f29ef80937137f7869026?s=128&d=identicon&r=PG", "display_name": "Ritwick Dey", "link": "https://stackoverflow.com/users/6120338/ritwick-dey"}, "edited": false, "score": 0, "creation_date": 1481740331, "post_id": 41142816, "comment_id": 69501622, "body": "Don&#39;t why, people marked my ans as down vote. But it works fine. :("}, {"owner": {"reputation": 14730, "user_id": 6120338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0865ba5a8a6f29ef80937137f7869026?s=128&d=identicon&r=PG", "display_name": "Ritwick Dey", "link": "https://stackoverflow.com/users/6120338/ritwick-dey"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1481740395, "post_id": 41142816, "comment_id": 69501653, "body": "Then, upper one is fine. :) @cody Gray"}, {"owner": {"reputation": 14730, "user_id": 6120338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0865ba5a8a6f29ef80937137f7869026?s=128&d=identicon&r=PG", "display_name": "Ritwick Dey", "link": "https://stackoverflow.com/users/6120338/ritwick-dey"}, "reply_to_user": {"reputation": 23, "user_id": 5504622, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cx8FoiQXAjM/AAAAAAAAAAI/AAAAAAAAAlM/B4F9zGV1AVQ/photo.jpg?sz=128", "display_name": "Rogier Reerink", "link": "https://stackoverflow.com/users/5504622/rogier-reerink"}, "edited": false, "score": 0, "creation_date": 1481742395, "post_id": 41142816, "comment_id": 69502777, "body": "@Rogier Reerink, if you satisfied with my code , pls mark as ans. :)"}, {"owner": {"reputation": 23, "user_id": 5504622, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cx8FoiQXAjM/AAAAAAAAAAI/AAAAAAAAAlM/B4F9zGV1AVQ/photo.jpg?sz=128", "display_name": "Rogier Reerink", "link": "https://stackoverflow.com/users/5504622/rogier-reerink"}, "edited": false, "score": 0, "creation_date": 1481743359, "post_id": 41142816, "comment_id": 69503255, "body": "@RitwickDey, I haven&#39;t been able to get it to work actually."}, {"owner": {"reputation": 14730, "user_id": 6120338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0865ba5a8a6f29ef80937137f7869026?s=128&d=identicon&r=PG", "display_name": "Ritwick Dey", "link": "https://stackoverflow.com/users/6120338/ritwick-dey"}, "edited": false, "score": 0, "creation_date": 1481776318, "post_id": 41142816, "comment_id": 69514547, "body": "Do you not get how it is working? Or program is not working?"}, {"owner": {"reputation": 14730, "user_id": 6120338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0865ba5a8a6f29ef80937137f7869026?s=128&d=identicon&r=PG", "display_name": "Ritwick Dey", "link": "https://stackoverflow.com/users/6120338/ritwick-dey"}, "edited": false, "score": 0, "creation_date": 1481776405, "post_id": 41142816, "comment_id": 69514566, "body": "If you are not getting the solution 2, just tell me. I&#39;ll make a simple for you"}], "tags": [], "owner": {"reputation": 14730, "user_id": 6120338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0865ba5a8a6f29ef80937137f7869026?s=128&d=identicon&r=PG", "display_name": "Ritwick Dey", "link": "https://stackoverflow.com/users/6120338/ritwick-dey"}, "is_accepted": false, "score": 0, "last_activity_date": 1481740908, "last_edit_date": 1481740908, "creation_date": 1481718855, "answer_id": 41142816, "question_id": 41142050, "link": "https://stackoverflow.com/questions/41142050/why-does-isdigit-always-return-false/41142816#41142816", "title": "Why does isdigit always return false?", "body": "<p>Sweet problem!! <code>isdigit</code> take argument a single character(ASCII Value) and determine whether the character is digit or not . [so, it will work for signal digit].</p>\n\n<p>first, as <code>isdigit</code> take argument a single character, if you pass the digit as argument then it will say \"NO IT IS NOT NUMBER\". You should pass ASCII value of single digit number as argument of \n<code>isdigit</code>.</p>\n\n<p>I mean, '1' != 1 </p>\n\n<p>'1' is equal to 1+'0' which is ASCII value of character '1'.</p>\n\n<p>Solution 1: [It will work for single digit]</p>\n\n<pre><code>void input(int *array, int size) {\n    printf(\"Give me ten numbers. \\n\");\n    for (int i = 0; i &lt; size; i++) {\n        int x;\n        do {\n            x = 'a'; //bcz if user enter a character, scanf will not able to take the value, so, x will hold the previous value\n            printf(\"Array[%d]: \", i);\n            scanf(\"%d\", &amp;x);\n            scanf(\"%*[^\\n]\"); // fflush does not work on Macs. This is an alternative. [I don't know about the line, I copied from you.]\n        } while (!isdigit(x+'0')); //converting the value to character\n\n        array[i] = x;\n    }\n}\n</code></pre>\n\n<p>Solution 2 : (For pro) :p single line code :) </p>\n\n<pre><code>void input(int *array, int size) {\n    printf(\"Give me ten numbers. \\n\");\n    for (int i = 0; i &lt; size; i++) {\n        while( printf(\"array[%d] = \",i) &amp;&amp; !scanf(\"%d\",&amp;array[i]) &amp;&amp; !scanf(\"%*[^\\n]\")); // it will give same result.\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5504622, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cx8FoiQXAjM/AAAAAAAAAAI/AAAAAAAAAlM/B4F9zGV1AVQ/photo.jpg?sz=128", "display_name": "Rogier Reerink", "link": "https://stackoverflow.com/users/5504622/rogier-reerink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1528638039, "creation_date": 1481716616, "last_edit_date": 1528638039, "question_id": 41142050, "link": "https://stackoverflow.com/questions/41142050/why-does-isdigit-always-return-false", "title": "Why does isdigit always return false?", "body": "<p>I cannot get <code>isdigit</code> to work. Here is some of my code.</p>\n\n<pre><code>void input(int *array, int size) {\n    int x;\n    printf(\"Give me ten numbers. \\n\");\n    for (int i = 0; i &lt; size; i++) {\n        do {\n            printf(\"Array[%d]: \", i);\n            scanf(\"%d\", &amp;x);\n            scanf(\"%*[^\\n]\");\n        } while (!isdigit(x));\n        array[i] = x;\n    }\n}\n</code></pre>\n\n<p>The aim of this program is to read an integer from the keyboard with <code>scanf</code> (which is no problem). If the input is not a number, it should repeat the while loop, until the user gives a number. With <code>isdigit</code>, you should be able to identify if a character is an integer or not. It returns 1 if integer, 0 if not. At least, that should be the case. In this code it always returns 0.</p>\n"}, {"tags": ["c++", "c", "gcc", "x86", "reverse-engineering"], "comments": [{"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 2, "creation_date": 1481717290, "post_id": 41142029, "comment_id": 69486878, "body": "If you don&#39;t use the <code>-O3</code> switch the compiler generates code that can be redundant or nonsense (though still correct)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7295860"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1481717771, "post_id": 41142029, "comment_id": 69487186, "body": "Yes, I know. I&#39;m just learning :)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481717815, "post_id": 41142029, "comment_id": 69487219, "body": "Is this C or C++? They are different languages and there will likely be differet code generated for function entry/exit."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 1, "creation_date": 1481717943, "post_id": 41142029, "comment_id": 69487306, "body": "@MargaretBloom: Not nonsense. Just superfluous. But often better comprehensible by beginners and easier to debug. In general it is best to compile with <code>-Og</code> for debugging, though."}], "answers": [{"comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1481723940, "post_id": 41142240, "comment_id": 69491363, "body": "Sure, that&#39;s what the code does. But why does it do that for <code>double</code> but not for <code>int</code>? (Serious question, not trolling: I haven&#39;t looked at code generation issues in a long time...)"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 2, "creation_date": 1481728365, "post_id": 41142240, "comment_id": 69494318, "body": "On x86, <code>double</code> is a 64-bit type and requires 8-byte alignment, but the ABI does not require that the stack be 8-byte aligned. The same thing happens for <code>long long</code>, BTW, since it&#39;s also an 8-byte type. It isn&#39;t necessary for <code>int</code> because that&#39;s just a 4-byte type, and the stack pointer is guaranteed to be 4-byte aligned."}], "tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": true, "score": 7, "last_activity_date": 1481717220, "creation_date": 1481717220, "answer_id": 41142240, "question_id": 41142029, "link": "https://stackoverflow.com/questions/41142029/int-vs-double-in-assembly/41142240#41142240", "title": "Int vs Double in assembly", "body": "<p>In the case of a <code>double</code> in automatic scope (on the stack), the extra code aligns the stack frame at an even 8 byte boundary, so that the <code>double</code> variable is stored at a memory address with suitable alignment. The stack pointer, when entering the function, is not guaranteed to be aligned on an even 8-byte boundary, and the compiler adds the extra code to make it so.</p>\n\n<p>That's what the <code>and esp, -8</code> does. -8 is 0xFFFFFFF8. This clears the last 3 bits of <code>esp</code>, using <code>and</code>, making it point to an even 8 byte boundary memory address, adjusting it down (the stack grows from high to low memory addresses).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7295860"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 41142240, "answer_count": 1, "score": 2, "last_activity_date": 1481718337, "creation_date": 1481716572, "last_edit_date": 1481718337, "question_id": 41142029, "link": "https://stackoverflow.com/questions/41142029/int-vs-double-in-assembly", "title": "Int vs Double in assembly", "body": "<p>Why GCC compiler adds this three lines when using double and don't when there is Int?</p>\n\n<hr>\n\n<p>With int:</p>\n\n<pre><code>#include &lt;cstdio&gt;\n\nint main(){\n    int i = 1;\n}\n</code></pre>\n\n<p>==></p>\n\n<pre><code>main:\n        push    ebp\n        mov     ebp, esp\n        sub     esp, 16\n        mov     DWORD PTR [ebp-4], 1\n        mov     eax, 0\n        leave\n        ret\n</code></pre>\n\n<hr>\n\n<p>With double:</p>\n\n<pre><code>#include &lt;cstdio&gt;\n\nint main(){\n    double i = 1;\n}\n</code></pre>\n\n<p>==></p>\n\n<pre><code>main:\n        lea     ecx, [esp+4]            // This three lines\n        and     esp, -8                 //  ...\n        push    DWORD PTR [ecx-4]       //  ...\n        push    ebp\n        mov     ebp, esp\n        push    ecx\n        sub     esp, 20\n        fld1\n        fstp    QWORD PTR [ebp-16]\n        mov     eax, 0\n        add     esp, 20\n        pop     ecx\n        pop     ebp\n        lea     esp, [ecx-4]\n        ret\n</code></pre>\n\n<p>Similar happens when using pointers, for example, int *s = new int(4);</p>\n\n<p>Can you explain why this happens, and why not always?</p>\n"}, {"tags": ["c", "pipe", "stdin"], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 7046336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7783f2206d109fc116a42c738afc334d?s=128&d=identicon&r=PG&f=1", "display_name": "Itega", "link": "https://stackoverflow.com/users/7046336/itega"}, "is_accepted": true, "score": 2, "last_activity_date": 1481720381, "creation_date": 1481720381, "answer_id": 41143310, "question_id": 41141823, "link": "https://stackoverflow.com/questions/41141823/restore-stdin-after-a-pipe/41143310#41143310", "title": "Restore stdin after a pipe", "body": "<p>Using fdopen seems to work well so here is the fixed code :</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n\nvoid readPBM(char *output)\n{\n    FILE* fp;\n    char tmp[1024];\n\n    int fd[2] = {0,0};\n    int pid;\n\n    //Open the pipe for inter-process communication\n    pipe(&amp;fd[0]);\n\n    //Fork and test if we are child or parent process\n    pid = fork();\n    if(pid) //Parent process\n    {\n        wait(NULL); //Wait for child's end\n        close(fd[1]);//Close pipe's write stream\n\n        fp = fdopen(fd[0], \"r\");\n\n        strcpy(output, \"\");// Init output at 0\n        while(fgets(tmp, 1024, fp) != NULL) //Put remainings entry in output\n        {\n            strcat(output, tmp);\n        }\n        strcat(output, \"It works\\n\");\n        fclose(fp);\n    }\n    else if(pid == 0) //Child process\n    {\n        close(fd[0]);//Close pipe's read stream\n        close(1);//Close stdout\n        dup(fd[1]);//Duplicate stdin\n        close(fd[1]);\n\n        printf(\"A random string ...\\n\");\n        exit(0);\n    }\n    else //Print error if fork failed\n    {\n        printf(\"Error creating a new process\");\n        exit(EXIT_FAILURE);\n    }\n}\n\nint main(int argc, char *argv[])\n{\n    int i, j;\n\n    char *str = NULL;\n    char c;\n\n    str = malloc(512 * sizeof(char*));\n    readPBM(str);\n\n    printf(\"%s\", str);\n\n    c = getchar();\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7046336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7783f2206d109fc116a42c738afc334d?s=128&d=identicon&r=PG&f=1", "display_name": "Itega", "link": "https://stackoverflow.com/users/7046336/itega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 0, "accepted_answer_id": 41143310, "answer_count": 1, "score": 1, "last_activity_date": 1481720381, "creation_date": 1481716037, "last_edit_date": 1481720269, "question_id": 41141823, "link": "https://stackoverflow.com/questions/41141823/restore-stdin-after-a-pipe", "title": "Restore stdin after a pipe", "body": "<p>I made a pipe using stdin and stdout to communicate but I can't figure out how to restore stdin after closing it in my father process.  </p>\n\n<p>Here is an example :</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n\nvoid readPBM(char *output)\n{\n    char tmp[1024];\n\n    int fd[2] = {0,0};\n    int pid;\n\n    //Open the pipe for inter-process communication\n    pipe(&amp;fd[0]);\n\n    //Fork and test if we are child or parent process\n    pid = fork();\n    if(pid) //Parent process\n    {\n        wait(NULL); //Wait for child's end\n        close(fd[1]);//Close pipe's write stream\n        close(0);//Close stdin\n        dup(fd[0]);\n        close(fd[0]);\n\n        strcpy(output, \"\");// Init output at 0\n        while(fgets(tmp, 1024, stdin) != NULL) //Put remainings entry in output\n        {\n            strcat(output, tmp);\n        }\n        strcat(output, \"It works\\n\");\n    }\n    else if(pid == 0) //Child process\n    {\n        close(fd[0]);//Close pipe's read stream\n        close(1);//Close stdout\n        dup(fd[1]);//Duplicate stdin\n        close(fd[1]);\n\n        printf(\"A random string ...\\n\");\n        exit(0);\n    }\n    else //Print error if fork failed\n    {\n        printf(\"Error creating a new process\");\n        exit(EXIT_FAILURE);\n    }\n}\n\nint main(int argc, char *argv[])\n{\n    int i, j;\n\n    char *str = NULL;\n    char c;\n\n    str = malloc(512 * sizeof(char*));\n    readPBM(str);\n\n    printf(\"%s\", str);\n\n    c = getchar();\n}\n</code></pre>\n\n<p>I tried to save stdin using : <code>int stdin_copy = dup(0)</code> then restoring it but my getchar is not working.<br>\nI also tried to use <code>freopen(\"/dev/stdin\", \"a\", stdin)</code> but it still doesn't wait for an input</p>\n"}, {"tags": ["c", "cp"], "comments": [{"owner": {"reputation": 4007, "user_id": 4255107, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-84XHYSdES6k/AAAAAAAAAAI/AAAAAAAAAF0/BzBS4Ozwoc0/photo.jpg?sz=128", "display_name": "sonus21", "link": "https://stackoverflow.com/users/4255107/sonus21"}, "edited": false, "score": 1, "creation_date": 1481716117, "post_id": 41141808, "comment_id": 69486148, "body": "open file with the flag for reading: &quot;rb&quot;, and writing: &quot;wb&quot;, this should solve the problem."}, {"owner": {"reputation": 956, "user_id": 953828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37c313a00efd99489396c26622c2f6fb?s=128&d=identicon&r=PG", "display_name": "Jerry", "link": "https://stackoverflow.com/users/953828/jerry"}, "edited": false, "score": 1, "creation_date": 1481716622, "post_id": 41141808, "comment_id": 69486482, "body": "The flag &quot;b&quot; should have no effect according to fopen&#39;s man page."}, {"owner": {"reputation": 142, "user_id": 7279579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49cabdc8b29195ba696ce54b7bbb3f89?s=128&d=identicon&r=PG", "display_name": "Abel Tom", "link": "https://stackoverflow.com/users/7279579/abel-tom"}, "reply_to_user": {"reputation": 4007, "user_id": 4255107, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-84XHYSdES6k/AAAAAAAAAAI/AAAAAAAAAF0/BzBS4Ozwoc0/photo.jpg?sz=128", "display_name": "sonus21", "link": "https://stackoverflow.com/users/4255107/sonus21"}, "edited": false, "score": 0, "creation_date": 1481717142, "post_id": 41141808, "comment_id": 69486796, "body": "@sonukumar Thanks, but, it did not change a thing."}, {"owner": {"reputation": 4007, "user_id": 4255107, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-84XHYSdES6k/AAAAAAAAAAI/AAAAAAAAAF0/BzBS4Ozwoc0/photo.jpg?sz=128", "display_name": "sonus21", "link": "https://stackoverflow.com/users/4255107/sonus21"}, "reply_to_user": {"reputation": 956, "user_id": 953828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37c313a00efd99489396c26622c2f6fb?s=128&d=identicon&r=PG", "display_name": "Jerry", "link": "https://stackoverflow.com/users/953828/jerry"}, "edited": false, "score": 0, "creation_date": 1481717801, "post_id": 41141808, "comment_id": 69487211, "body": "@Jerry can you please point to the man page which says about flag &quot;b&quot; ?"}, {"owner": {"reputation": 956, "user_id": 953828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37c313a00efd99489396c26622c2f6fb?s=128&d=identicon&r=PG", "display_name": "Jerry", "link": "https://stackoverflow.com/users/953828/jerry"}, "reply_to_user": {"reputation": 4007, "user_id": 4255107, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-84XHYSdES6k/AAAAAAAAAAI/AAAAAAAAAF0/BzBS4Ozwoc0/photo.jpg?sz=128", "display_name": "sonus21", "link": "https://stackoverflow.com/users/4255107/sonus21"}, "edited": false, "score": 0, "creation_date": 1481718266, "post_id": 41141808, "comment_id": 69487520, "body": "@sonukumar, I am on OS X, and the BSD man page is dated January 26, 2003.  What system are you on?"}, {"owner": {"reputation": 4007, "user_id": 4255107, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-84XHYSdES6k/AAAAAAAAAAI/AAAAAAAAAF0/BzBS4Ozwoc0/photo.jpg?sz=128", "display_name": "sonus21", "link": "https://stackoverflow.com/users/4255107/sonus21"}, "edited": false, "score": 0, "creation_date": 1481718427, "post_id": 41141808, "comment_id": 69487618, "body": "mac OS X and RHEL"}, {"owner": {"reputation": 4007, "user_id": 4255107, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-84XHYSdES6k/AAAAAAAAAAI/AAAAAAAAAF0/BzBS4Ozwoc0/photo.jpg?sz=128", "display_name": "sonus21", "link": "https://stackoverflow.com/users/4255107/sonus21"}, "edited": false, "score": 0, "creation_date": 1481719196, "post_id": 41141808, "comment_id": 69488119, "body": "Can you try to linux system?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481719237, "post_id": 41141808, "comment_id": 69488152, "body": "Unix/Linux does not need this Windows legacy."}, {"owner": {"reputation": 4007, "user_id": 4255107, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-84XHYSdES6k/AAAAAAAAAAI/AAAAAAAAAF0/BzBS4Ozwoc0/photo.jpg?sz=128", "display_name": "sonus21", "link": "https://stackoverflow.com/users/4255107/sonus21"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481719330, "post_id": 41141808, "comment_id": 69488224, "body": "@Olaf I&#39;m not sure what&#39;s wrong here, I wrote simple CPython script to copy a file it works lie charm, for all format."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 4007, "user_id": 4255107, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-84XHYSdES6k/AAAAAAAAAAI/AAAAAAAAAF0/BzBS4Ozwoc0/photo.jpg?sz=128", "display_name": "sonus21", "link": "https://stackoverflow.com/users/4255107/sonus21"}, "edited": false, "score": 0, "creation_date": 1481719996, "post_id": 41141808, "comment_id": 69488678, "body": "@sonukumar: 1) Python is a programming language, not just a scripting language. 2) CPython is <b>one</b> implementation of the Python language. 3) This is not about Python, but C. A very different language! 4) Read what text mode actually is for. Hint: it is ignored by modern OSes. For current desktop systems, only Windows treats it special."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1481720330, "post_id": 41141808, "comment_id": 69488891, "body": "You have two buffers but you&#39;re trying to copy char by char? Things are really not clear in <code>while</code> loop. Can you explain us what you try to do in it?"}, {"owner": {"reputation": 406, "user_id": 6422468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8622bb1b203d0548d5938c30588f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Hardik Sanghvi", "link": "https://stackoverflow.com/users/6422468/hardik-sanghvi"}, "edited": false, "score": 0, "creation_date": 1481721466, "post_id": 41141808, "comment_id": 69489627, "body": "I think you cannot open a pdf or mp3 files using fopen. The cp command in linux uses open(), read(), write() system calls to perform the operation. You can check the source code of cp command to know more"}, {"owner": {"reputation": 142, "user_id": 7279579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49cabdc8b29195ba696ce54b7bbb3f89?s=128&d=identicon&r=PG", "display_name": "Abel Tom", "link": "https://stackoverflow.com/users/7279579/abel-tom"}, "reply_to_user": {"reputation": 406, "user_id": 6422468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8622bb1b203d0548d5938c30588f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Hardik Sanghvi", "link": "https://stackoverflow.com/users/6422468/hardik-sanghvi"}, "edited": false, "score": 0, "creation_date": 1481721894, "post_id": 41141808, "comment_id": 69489918, "body": "@HardikSanghvi actually you can and i did it :)"}, {"owner": {"reputation": 142, "user_id": 7279579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49cabdc8b29195ba696ce54b7bbb3f89?s=128&d=identicon&r=PG", "display_name": "Abel Tom", "link": "https://stackoverflow.com/users/7279579/abel-tom"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1481722350, "post_id": 41141808, "comment_id": 69490216, "body": "@purplepsycho actually, it was my method of implementation, i wanted to read every single character and save it in a character buffer (256 bytes long in this case) like a cache, and put it using <code>fputc</code> one after the other in the opened destination file."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1481725818, "post_id": 41141808, "comment_id": 69492568, "body": "The <code>mychar= (char *)malloc(sizeof(char *));</code> line makes absolutely no sense at all, and gives off a scent of a programmer who is very uncertain about pointers."}, {"owner": {"reputation": 142, "user_id": 7279579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49cabdc8b29195ba696ce54b7bbb3f89?s=128&d=identicon&r=PG", "display_name": "Abel Tom", "link": "https://stackoverflow.com/users/7279579/abel-tom"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1481734164, "post_id": 41141808, "comment_id": 69498222, "body": "@unwind why is it wrong to initialize mychar with a non-garbage value?"}], "answers": [{"comments": [{"owner": {"reputation": 142, "user_id": 7279579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49cabdc8b29195ba696ce54b7bbb3f89?s=128&d=identicon&r=PG", "display_name": "Abel Tom", "link": "https://stackoverflow.com/users/7279579/abel-tom"}, "edited": false, "score": 0, "creation_date": 1481722101, "post_id": 41143308, "comment_id": 69490056, "body": "Thank you so much, i changed <code>mychar</code> to int and did a typecast when i accepted it as a character in <code>char_buf</code>  array. i oversaw the return type of <code>fgetc</code>. aweswome!"}], "tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": true, "score": 1, "last_activity_date": 1481720379, "creation_date": 1481720379, "answer_id": 41143308, "question_id": 41141808, "link": "https://stackoverflow.com/questions/41141808/c-implementation-of-cp/41143308#41143308", "title": "C implementation of cp", "body": "<blockquote>\n  <p>Is it wrong the way i use EOF?</p>\n</blockquote>\n\n<p>It is wrong. <code>EOF</code> is of type <code>int</code>. The return value of <code>fgetc</code> is also of type <code>int</code>. You store the value in a <code>char</code>.</p>\n\n<p>Your code will fail if the file contains any byte with the value <code>-1</code>/<code>255</code>. Text files won't, of course, but large binary files are likely to contain such bytes.</p>\n\n<p>Changing the type of <code>mychar</code> to <code>int</code> will fix that problem.</p>\n\n<p>Another bug is the possible buffer overflow when you <code>NUL</code>-terminate <code>char_buff</code>. If the file is an even multiple of 256 then <code>i</code> will be \n<code>256</code> when you add the <code>NUL</code>-terminator and you will write outside the buffer.</p>\n"}], "owner": {"reputation": 142, "user_id": 7279579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49cabdc8b29195ba696ce54b7bbb3f89?s=128&d=identicon&r=PG", "display_name": "Abel Tom", "link": "https://stackoverflow.com/users/7279579/abel-tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 1, "accepted_answer_id": 41143308, "answer_count": 1, "score": 0, "last_activity_date": 1481720379, "creation_date": 1481715979, "last_edit_date": 1481720033, "question_id": 41141808, "link": "https://stackoverflow.com/questions/41141808/c-implementation-of-cp", "title": "C implementation of cp", "body": "<p>This is a primitive implementation of cp, i compiled and ran it on Linux machine(Ubuntu), this code works fine for text files of any size but not for pdfs or mp3, i dont know what im dong wrong. Is it wrong the way i use EOF? It compiles and runs without error, but does not work for every kind of file.</p>\n\n<pre><code> #include&lt;stdio.h&gt;\n #include&lt;stdlib.h&gt;\n #include &lt;string.h&gt;\n\n #define MAX_SIZE 2\n #define MAX_BUF_SIZE 256\n\n int main(int argc, char* argv[])\n {\n  FILE *pFile_src=NULL;\n  FILE *pFile_dest=NULL;\n\n  char* mychar;\n  char *SRC, *DEST;\n  int i=0,j;\n\n  char char_buff[MAX_BUF_SIZE];\n  mychar= (char *)malloc(sizeof(char *));\n\n  if(argv[1]!=NULL)\n      SRC=argv[1];\n  else\n      printf(\"\\nUSAGE: ./Ex_ManualCP_prog src_file dest_file.\\nFirst arg should be a filename, cannot be empty.\\n\");\n\n  if(argv[2]!=NULL)\n      DEST=argv[2];\n  else\n      printf(\"\\nSecond arg should be a filename, cannot be empty.\\n\");\n\n  mychar= (char *)malloc(MAX_SIZE*sizeof(char *));\n\n  //initialize text buffer\n  for(j=0;j&lt;MAX_BUF_SIZE;j++)\n      char_buff[j]='\\0';\n\n  pFile_src=fopen(SRC,\"r\");     //Open file to read and store in a character buffer\n\n  pFile_dest=fopen(DEST,\"w\");  //open destination file\n\n  if(pFile_dest==NULL)\n      printf(\"\\nFile specified as Destination DOES NOT EXIST.\\n\");\n\n  if(pFile_src==NULL)\n      printf(\"\\nFile specified as Source, DOES NOT EXIST.\\n\");\n  else\n  {\n   //printf(\"\\n----File opened successfully-----\\n\");\n\n       while(((*mychar=fgetc(pFile_src))!=EOF))\n       {\n             if(i&gt;=MAX_BUF_SIZE)\n             {\n                i=0;\n             }\n\n             char_buff[i]=*mychar;\n             fputc(char_buff[i],pFile_dest); //write buffer data into opened file\n             ++i;\n        }\n\n       char_buff[i]='\\0';\n       fclose(pFile_src);  //close source file\n\n   }\n\n   fclose(pFile_dest);\n\n   if(pFile_src!=NULL &amp;&amp; pFile_dest!=NULL)\n       printf(\"\\n\\n-----Copy Done!----\\n-----Reached end of file.-----\\n\");\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "encoding", "compression", "bit-manipulation", "huffman-code"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1481723074, "post_id": 41141807, "comment_id": 69490730, "body": "Try opening the file in binary mode: <code>result-&gt;file = fopen(name, &quot;rwb&quot;);</code>"}], "owner": {"reputation": 11, "user_id": 7296135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c6ec44d174959093cd5c89a3daf936?s=128&d=identicon&r=PG&f=1", "display_name": "R_M_F", "link": "https://stackoverflow.com/users/7296135/r-m-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1481715978, "creation_date": 1481715978, "question_id": 41141807, "link": "https://stackoverflow.com/questions/41141807/unable-to-encode-a-file-using-huffman-tree-in-c", "title": "Unable to encode a file using Huffman tree in C", "body": "<p>So I have a table of encodings and a bit file Struct to write a bit at a time. However, when I attempt to actually encode a file it usually crashes the program upon opening. When I attempt to open it on a Mac it gives the error</p>\n\n<blockquote>\n  <p>The document \u201coutput.txt\u201d could not be opened. Text encoding Unicode (UTF-8) isn\u2019t applicable.</p>\n</blockquote>\n\n<p>I will provide the relevant code and hope you can help me spot the problem. I have been researching online for a solution and have been trying different writing techniques but nothing works.</p>\n\n<p>The following is the code for the bitfile</p>\n\n<pre><code>struct bitfile\n{\n    FILE * file;\n    unsigned char buffer;  //1 byte in size\n    int index;  //tells you which byte your filling\n};\n\nstruct bitfile * bitfile_open(char * name)\n {\n     struct bitfile * result;\n     result = malloc(sizeof(struct bitfile));\n     result-&gt;file = fopen(name, \"rw\");\n     result-&gt;buffer = 0;\n     result-&gt;index=0;\n     return result;\n }\n\nvoid bitfile_write(struct bitfile * out, int bit){\n    if (bit)\n    {\n        out-&gt;buffer |= (1&lt;&lt;out-&gt;index);\n    }\n\n    out-&gt;index++;\n    if (out-&gt;index == 8)\n    {\n        fwrite (&amp;out-&gt;buffer, 1, 1, out-&gt;file);\n        out-&gt;index = 0;\n        out-&gt;buffer = 0;\n    }\n}\n</code></pre>\n\n<p>Then here is the route the program takes from the main to encode</p>\n\n<pre><code>int main(int argc, const char * argv[]){\n    struct bitfile * output = bitfile_open(\"textOutput.txt\");\n    file = fopen(argv[1], \"r\");\n    /**\n\n    Other code which generate Huffman tree and gets encodings\n\n    **/\n    encode_file(file,output,encodings);\n}\n</code></pre>\n\n<p>This function iterates through the file sending in the relevant encoding to \"write_encoding\" function</p>\n\n<pre><code>void encode_file(FILE * in, struct bitfile * out, char ** encodings){\n    unsigned char c;\n    c = fgetc(in);\n    char * encoding;\n\n    while(!feof(in))\n    {\n        encoding = encodings[c];\n        write_encoding(out, encoding);\n        c = fgetc(in);\n    }\n\n    const int EOT = 4;\n    write_encoding(out, encodings[EOT]);\n    Flush_Bits(out);\n    fclose(in);\n    bitfile_close(out);\n}\n\n\n\nvoid write_encoding(struct bitfile * out, char * encoding){\n    assert(encoding != NULL);\n    for(int i = 0; encoding[i] != '\\0';i++)\n    {\n        int bit = encoding[i] - '0';\n        bitfile_write(out,bit);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 4007, "user_id": 4255107, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-84XHYSdES6k/AAAAAAAAAAI/AAAAAAAAAF0/BzBS4Ozwoc0/photo.jpg?sz=128", "display_name": "sonus21", "link": "https://stackoverflow.com/users/4255107/sonus21"}, "edited": false, "score": 1, "creation_date": 1481716291, "post_id": 41141798, "comment_id": 69486276, "body": "Most likely you wanted to call ltt_search as ltt_search( word, ltt ) not ltt_srch(word[len], ltt)"}, {"owner": {"reputation": 842, "user_id": 6868584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-N3nZLuk31y4/AAAAAAAAAAI/AAAAAAAABvU/opOgVOgkjoo/photo.jpg?sz=128", "display_name": "Aidin", "link": "https://stackoverflow.com/users/6868584/aidin"}, "edited": false, "score": 0, "creation_date": 1481716345, "post_id": 41141798, "comment_id": 69486301, "body": "Your function expects an array but you are sending it a <code>char</code>. In your <code>if</code>, change <code>word[len]</code> into just <code>word</code>"}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1481717102, "post_id": 41141798, "comment_id": 69486774, "body": "You can improve the speed for this function from <code>O(N)</code> to <code>O(logN)</code> using binary search."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1481723678, "post_id": 41141798, "comment_id": 69491170, "body": "There is also a bug in the way <code>ltt_srch</code> determines the length of the word. In <code>ltt_srch</code>, C magically redefines <code>word</code> as a <code>char *</code> because you cannot pass arrays by value in C. Therefore, <code>sizeof(word)</code> will be <code>sizeof(char *)</code>, which is probably either 4 or 8 on your platform. If <code>word</code> is null-terminated, you can use <code>len = strlen(word);</code> to determine it&#39;s length. If <code>word</code> is not null-terminated, you will have to pass the length as a function parameter."}], "answers": [{"tags": [], "owner": {"reputation": 1356, "user_id": 4584421, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xdIx5.png?s=128&g=1", "display_name": "Julian Declercq", "link": "https://stackoverflow.com/users/4584421/julian-declercq"}, "is_accepted": true, "score": 2, "last_activity_date": 1503138584, "last_edit_date": 1503138584, "creation_date": 1481716340, "answer_id": 41141937, "question_id": 41141798, "link": "https://stackoverflow.com/questions/41141798/c-searching-for-a-letter-in-word/41141937#41141937", "title": "C - searching for a letter in word", "body": "<p>The problem is that you are passing <code>word[len]</code> instead of <code>word</code> as your first parameter. If you pass <code>word[len]</code> you will pass the character on the index <code>len</code> of <code>word</code> instead of <code>word</code> itself. </p>\n\n<p>For example if <code>word = \"word\"</code> and <code>len = 2</code> then <code>word[len] == 'r'</code>.</p>\n\n<p>Solution: </p>\n\n<p><code>if(ltt_srch(word, ltt) == 0)</code> instead of <code>if(ltt_srch(word[len], ltt) == 0)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 0, "last_activity_date": 1481716609, "creation_date": 1481716609, "answer_id": 41142046, "question_id": 41141798, "link": "https://stackoverflow.com/questions/41141798/c-searching-for-a-letter-in-word/41142046#41142046", "title": "C - searching for a letter in word", "body": "<p>This:</p>\n\n<pre><code>len = sizeof(word)/sizeof(word[0]);\n</code></pre>\n\n<p>is wrong. You cannot use <code>sizeof</code> inside a function to get the size of an array passed as an argument like that.</p>\n\n<p>You meant:</p>\n\n<pre><code>const size_t len = strlen(word);\n</code></pre>\n\n<p>You need to search for the terminator, to work with general strings in C.</p>\n\n<p>Also you're calling it wrong, this:</p>\n\n<pre><code>ltt_srch(word[len], ltt)\n</code></pre>\n\n<p>is subscripting into <code>word</code> which will yield a character, but you want to pass the array itself so it should be</p>\n\n<pre><code>ltt_srch(word, ltt)\n</code></pre>\n\n<p>Finally, the standard library has this function already, look up <a href=\"https://linux.die.net/man/3/strchr\" rel=\"nofollow noreferrer\"><code>strchr()</code></a>:</p>\n\n<pre><code>int ltt_srch(const char *word, chr ltt)\n{\n  return strchr(word, ltt) != NULL;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": false, "score": 0, "last_activity_date": 1481716954, "creation_date": 1481716954, "answer_id": 41142154, "question_id": 41141798, "link": "https://stackoverflow.com/questions/41141798/c-searching-for-a-letter-in-word/41142154#41142154", "title": "C - searching for a letter in word", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint ltt_srch(char word[], char ltt);\n\nint\nmain(void) {\n    char *word = \"word\";\n    char key = 'r';\n\n    if (ltt_srch(word, key)) {\n        printf(\"Letter found.\\n\");\n    } else {\n        printf(\"Letter not found.\\n\");\n    }\n\n    return 0;\n}\n\nint\nltt_srch(char word[], char ltt) {\n    int i;\n\n    for(i = 0; word[i] != '\\0'; i++) {\n        if(ltt == word[i]) {\n            return 1;\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6649332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vuYdx.png?s=128&g=1", "display_name": "AQUATH", "link": "https://stackoverflow.com/users/6649332/aquath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 41141937, "answer_count": 3, "score": 0, "last_activity_date": 1503138584, "creation_date": 1481715958, "last_edit_date": 1481716220, "question_id": 41141798, "link": "https://stackoverflow.com/questions/41141798/c-searching-for-a-letter-in-word", "title": "C - searching for a letter in word", "body": "<p>I am trying to create a function which has two arguments, the word, and a letter to search in the word. </p>\n\n<p>The word is actually an array where each letter is an element of the array, e.g. for the word \"word\", we have the following:\nword = [w, o, r, d]. </p>\n\n<p>Therefore I have to compare each element of word[ ] to the letter, and if they match the function should return 1, otherwise 0.\nThe code is the following:</p>\n\n<pre><code>char ltt_srch(char word[], char ltt)//LINE 13\n{\n    int len, i;\n    len = sizeof(word)/sizeof(word[0]);\n    for(i = 0; i &lt; len; i++)\n    {\n        if(ltt == word[i])\n        {\n            return 1;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I call <code>ltt_srch</code> in main using this code:</p>\n\n<pre><code>if(ltt_srch(word[len], ltt) == 0)//LINE 51\n{\n    printf(\"Letter not found.\\n\");\n}\n</code></pre>\n\n<p>but I get one warning and one note, specifically:</p>\n\n<p><code>Line 13: [Note] Expected 'char *' but argument is of type 'char'</code></p>\n\n<p><code>Line 51: [Warning] passing argument 1 of 'ltt_srch' makes pointer from integer without a cast</code></p>\n"}, {"tags": ["c", "io", "hard-drive"], "answers": [{"comments": [{"owner": {"reputation": 7071, "user_id": 549010, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/181219cd20b8036ef8ec45b94aed6474?s=128&d=identicon&r=PG", "display_name": "Roger", "link": "https://stackoverflow.com/users/549010/roger"}, "edited": false, "score": 0, "creation_date": 1481748418, "post_id": 41143879, "comment_id": 69505922, "body": "thank you, my point is more, does the return value (if block_size ==  write(...)) does that qualify, within the spec of erasure, as a verify."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 7071, "user_id": 549010, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/181219cd20b8036ef8ec45b94aed6474?s=128&d=identicon&r=PG", "display_name": "Roger", "link": "https://stackoverflow.com/users/549010/roger"}, "edited": false, "score": 0, "creation_date": 1481810132, "post_id": 41143879, "comment_id": 69532130, "body": "@Rogier - Yes, either method, <code>if(block_size == write(...))</code> or <code>if(bytes_written == block_size)</code> are a clear indication ( <i>validation</i> )  that the <i>change</i> has been made.  Additional steps such as <code>memcmp(...)</code> would just provide additional verification, and are completely optional for your purpose, IMO.  I have modified my answer in attempt to make these thoughts more clear."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 7071, "user_id": 549010, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/181219cd20b8036ef8ec45b94aed6474?s=128&d=identicon&r=PG", "display_name": "Roger", "link": "https://stackoverflow.com/users/549010/roger"}, "edited": false, "score": 0, "creation_date": 1481837651, "post_id": 41143879, "comment_id": 69547869, "body": "@Rogier - I am curious if your avatar image is of a <i><a href=\"http://www.thundermustang.com/\" rel=\"nofollow noreferrer\">Thunder Mustang</a></i>, or a full scale WWII plane?"}, {"owner": {"reputation": 7071, "user_id": 549010, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/181219cd20b8036ef8ec45b94aed6474?s=128&d=identicon&r=PG", "display_name": "Roger", "link": "https://stackoverflow.com/users/549010/roger"}, "edited": false, "score": 0, "creation_date": 1481843305, "post_id": 41143879, "comment_id": 69550211, "body": "i&#39;m not sure, i picked it up somewhere :o I think its a P51 (full). I do have my PPL.  The P51 is on my bucket-list! You fly a experimental/kit?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 7071, "user_id": 549010, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/181219cd20b8036ef8ec45b94aed6474?s=128&d=identicon&r=PG", "display_name": "Roger", "link": "https://stackoverflow.com/users/549010/roger"}, "edited": false, "score": 0, "creation_date": 1481904367, "post_id": 41143879, "comment_id": 69576290, "body": "@Rogier -  Cool.  And yes I would like to.  Just sold a Cessna, would like to purchase a partially constructed RV-8."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1481810136, "last_edit_date": 1481810136, "creation_date": 1481722163, "answer_id": 41143879, "question_id": 41141476, "link": "https://stackoverflow.com/questions/41141476/what-means-verifies-the-write-when-erasing-hdds/41143879#41143879", "title": "What means &quot;Verifies the write&quot; when erasing hdd&#39;s?", "body": "<p><em>What means \u201cVerifies the write\u201d when erasing hdd's?</em>  </p>\n\n<p>From <em><a href=\"ftp://gd.tuwien.ac.at/languages/c/programming-bbrown/c_075.htm\" rel=\"nofollow noreferrer\">Here</a></em></p>\n\n<blockquote>\n  <p>The <code>write(...)</code> function attempts to write nbytes from buffer to the\n  file associated with handle. On text files, it expands each LF to a\n  CR/LF.</p>\n  \n  <p>The function returns the <strong><em>number of bytes written to the file</em></strong>. A return\n  value of -1 indicates an error, with errno set appropriately.</p>\n</blockquote>\n\n<p>So in your example, <code>int bytes_written = write(fd, &amp;block, block_size);</code>\nthe value for bytes_written, if equal to the block size, <em>verifies</em> that all memory locations of block have been written to.</p>\n\n<p>And in answer to your other questions:  </p>\n\n<ul>\n<li><p>(1) Always check the return value of a non-void function anyway, and there is no significant efficiency or speed loss by simply performing a compare of two <code>int</code> values.  You can even do it in one step, but I am not sure it is an efficiency gain (view the assembly to know for sure).  So instead of:  </p>\n\n<p><code>// verify option: A<br>\nif (bytes_written == block_size) \n{ \n    // all good \n}</code><br>\n//You can do the comparison in the same line:  </p>\n\n<p><code>if(write(fd, &amp;block, block_size) == block_size) { // all good }</code> </p></li>\n<li><p>(2) Optional..  It provides an <em>additional verification</em> that the memory block contains the new contents.  </p></li>\n</ul>\n\n<p>You can find a more detailed description of write() in <em><a href=\"https://linux.die.net/man/3/write\" rel=\"nofollow noreferrer\">this Linux man page</a></em>.</p>\n"}], "owner": {"reputation": 7071, "user_id": 549010, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/181219cd20b8036ef8ec45b94aed6474?s=128&d=identicon&r=PG", "display_name": "Roger", "link": "https://stackoverflow.com/users/549010/roger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481810136, "creation_date": 1481714992, "last_edit_date": 1481721840, "question_id": 41141476, "link": "https://stackoverflow.com/questions/41141476/what-means-verifies-the-write-when-erasing-hdds", "title": "What means &quot;Verifies the write&quot; when erasing hdd&#39;s?", "body": "<p>Im looking at some code for (secure) erasing harddrives. I notice when looking at the different methods (<strong>Infosec 5</strong>, <strong>DoD 5220.22-M</strong>, etc.) i read \"Verify the write\".</p>\n\n<p>examples:</p>\n\n<p><a href=\"https://www.lifewire.com/dod-5220-22-m-2625856\" rel=\"nofollow noreferrer\">https://www.lifewire.com/dod-5220-22-m-2625856</a></p>\n\n<blockquote>\n  <p>Pass 3: Writes a random character and verifies the write</p>\n</blockquote>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Infosec_Standard_5#cite_note-5\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Infosec_Standard_5#cite_note-5</a></p>\n\n<blockquote>\n  <p>Regardless of which level is used, verification is needed to ensure\n  that overwriting was successful.</p>\n</blockquote>\n\n<p>My question is, what does it <strong>technical</strong> imply? </p>\n\n<ol>\n<li><p>Do you just check when you write a block of data, if the bytes written are equal the size of the block (seems fast)?</p></li>\n<li><p>Do you read back the block you wrote and compare (memcmp?) if its exactly same as the block of data written?</p></li>\n<li><p>any other solution i overlooked?</p></li>\n</ol>\n\n<p>Here a bit of <em>sample</em> code to illustrate my question. Which solution would indicate \"verify on write\"? If you only check the return value (from <code>write</code>) can <strong>you be sure</strong>, as long is matches the length of the block that <em>all</em> bytes are indeed written? </p>\n\n<pre><code>// erasure example\n// erasure single block, start from 0\n\n// block size\nunsigned long block_size = 512;\n\n// data-block we will write\nchar block[block_size];\n\n// zero the block\nbzero(&amp;block, block_size);\n\n// open device\nint fd = open('/dev/sdb', O_RDWR);   \n\n// write 1st block\nint bytes_written = write(fd, &amp;block, block_size);  \n\n// verify option: A\nif (bytes_written == block_size) {\n    // all good\n}\n\n// verify option B\n// go back the number of bytes-wtitten from the current pos.\nlseek(fd, -1 * bytes_written);\n// read the same number of bytes\nint bytes_read = read(fd, &amp;block, bytes_written);  \n\n// should be same\nif (bytes_read == bytes_written) {\n    // here code to check i block indeed contains zero's    \n    // use memcmp ?\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "arrays", "dynamic", "crash"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 3, "creation_date": 1481713581, "post_id": 41141036, "comment_id": 69484668, "body": "<code>int n</code>, <code>x[n];</code> ---&gt; undefined behavior"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481713614, "post_id": 41141036, "comment_id": 69484690, "body": "I don&#39;t know, C++ supports VLA? I thought it was more of a C thing, but I may be wrong."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 2, "creation_date": 1481713692, "post_id": 41141036, "comment_id": 69484731, "body": "Are you compiling it as C++? (Not that that really matters since you declare <code>x[n]</code> before you know <code>n</code>). Variable length arrays are a <code>C</code> thing - in C++ I&#39;d use a <code>vector</code>."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481713692, "post_id": 41141036, "comment_id": 69484732, "body": "@SouravGhosh It&#39;s a GCC extension"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1481713776, "post_id": 41141036, "comment_id": 69484783, "body": "C and C++ are quite different with respect to arrays. You should decide which one you have before asking here. From the view of it you are trying to use C concepts within C++. Don&#39;t do that, you&#39;ll never know what you get."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1481713792, "post_id": 41141036, "comment_id": 69484790, "body": "@StoryTeller So, to be clear, no C++ standard has it included, right? Atleast one C standard has the VLA as mandate."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481713873, "post_id": 41141036, "comment_id": 69484840, "body": "@SouravGhosh Correct. C++ has no standard support for VLA. IIRC there <i>was</i> a proposal for a restricted form of VLA pointers, but it wasn&#39;t voted in."}], "answers": [{"comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1481713675, "post_id": 41141066, "comment_id": 69484717, "body": "Or.. use <code>std::vector&lt;int&gt;</code>"}, {"owner": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 2, "creation_date": 1481714043, "post_id": 41141066, "comment_id": 69484933, "body": "I downvoted WITH a reason.. your question, before editing,  consisted of &quot;Declare your array after taking input for n.&quot;. this is not a real answer, it is a comment. After your edit I will withdraw my downvote. But IMO this answer is not useful since you did not mentioned about the nonstandard extensions. or even a real C++ solution"}, {"owner": {"reputation": 1620, "user_id": 902384, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/46da49256462126dbe77187c073aa6c6?s=128&d=identicon&r=PG", "display_name": "Shiv", "link": "https://stackoverflow.com/users/902384/shiv"}, "edited": false, "score": 0, "creation_date": 1481714286, "post_id": 41141066, "comment_id": 69485067, "body": "That is okay. There is no need to strain your voicebox. A programmer is supposed to use compiler well. The answer should also contain that for g++ one should use -pedantic -Wall for seeing this."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "reply_to_user": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1481717635, "post_id": 41141066, "comment_id": 69487106, "body": "Yeah calm down @HumamHelfawi, you sound pretty stressed."}], "tags": [], "owner": {"reputation": 1620, "user_id": 902384, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/46da49256462126dbe77187c073aa6c6?s=128&d=identicon&r=PG", "display_name": "Shiv", "link": "https://stackoverflow.com/users/902384/shiv"}, "is_accepted": true, "score": 0, "last_activity_date": 1481714394, "last_edit_date": 1481714394, "creation_date": 1481713615, "answer_id": 41141066, "question_id": 41141036, "link": "https://stackoverflow.com/questions/41141036/dynamic-array-crashed-for-more-than-8-elements/41141066#41141066", "title": "Dynamic array crashed for more than 8 elements", "body": "<p>Declare your array after taking input for n.</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\nvoid arrayin(int x[], int n);\nvoid arrayout(int x[], int n);\nmain()\n{\n    int n;\n    cout &lt;&lt; \"Please enter the number of elements in the array: \" &lt;&lt; endl;\n    cin &gt;&gt; n;\n    int x[n];\n    cout &lt;&lt; \"Please enter the elements: \" &lt;&lt; endl;\n    arrayin(x,n);\n    cout &lt;&lt; \"Array is of \" &lt;&lt; n &lt;&lt; \" elements.\"&lt;&lt; endl;\n    cout &lt;&lt; \"Elements are as follow :\" &lt;&lt; endl;\n    arrayout(x,n);\n}\nvoid arrayin(int x[],int n)\n{\n    for (int i = 0; i &lt; n; i ++)\n    {\n        cin &gt;&gt; x[i];\n    }\n}\nvoid arrayout(int x[], int n)\n{\n    for (int i = 0; i &lt; n; i++)\n    {\n        cout &lt;&lt; x[i] &lt;&lt; \"\\t\";\n    }\n}\n</code></pre>\n\n<p>This code works. The problem is when you declare array with no value for n the array will be initialized with whatever is on stack from past. Variable length arrays require the value. So declare the array later.</p>\n\n<p>Someone downvoted without any reason.</p>\n\n<p>Edit: Variable length arrays are not part of ISO C++. To write standard compliant C++ code you should use <code>-pedantic</code> flag with g++ or clang.</p>\n\n<p>You have two simple choice. Either use std::array for fixed length arrays or std::vector for dynamic arrays.</p>\n"}, {"tags": [], "owner": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "is_accepted": false, "score": 5, "last_activity_date": 1481713703, "creation_date": 1481713703, "answer_id": 41141096, "question_id": 41141036, "link": "https://stackoverflow.com/questions/41141036/dynamic-array-crashed-for-more-than-8-elements/41141096#41141096", "title": "Dynamic array crashed for more than 8 elements", "body": "<p>Here is the problem:</p>\n\n<pre><code> int n, x[n]; // It is undefined behaviour\n cout &lt;&lt; \"Please enter the number of elements in the array: \" &lt;&lt; endl;\n cin &gt;&gt; n;\n</code></pre>\n\n<p>The correct way is (on your compiler with the variable-size-array extension):</p>\n\n<pre><code> int n;\n cout &lt;&lt; \"Please enter the number of elements in the array: \" &lt;&lt; endl;\n cin &gt;&gt; n;\n int x[n];\n</code></pre>\n\n<p>The correct way using C++ is to use <code>std::vector</code> instead:</p>\n\n<pre><code> int n;\n cout &lt;&lt; \"Please enter the number of elements in the array: \" &lt;&lt; endl;\n cin &gt;&gt; n;\n std::vector&lt;int&gt; x(n);\n</code></pre>\n\n<p>and you have to make some other changes to adapt <code>std::vector</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 3, "last_activity_date": 1481713805, "creation_date": 1481713805, "answer_id": 41141127, "question_id": 41141036, "link": "https://stackoverflow.com/questions/41141036/dynamic-array-crashed-for-more-than-8-elements/41141127#41141127", "title": "Dynamic array crashed for more than 8 elements", "body": "<p>The problem is here:</p>\n\n<pre><code>int n, x[n];  // &lt;-- n is not yet initialized\ncout &lt;&lt; \"Please enter the number of elements in the array: \" &lt;&lt; endl;\ncin &gt;&gt; n;\ncout &lt;&lt; \"Please enter the elements: \" &lt;&lt; endl;\narrayin(x,n);\n</code></pre>\n\n<p>You need this:</p>\n\n<pre><code>int n;\ncout &lt;&lt; \"Please enter the number of elements in the array: \" &lt;&lt; endl;\ncin &gt;&gt; n;\nint x[n];   // &lt;&lt; now n has been initialized\ncout &lt;&lt; \"Please enter the elements: \" &lt;&lt; endl;\narrayin(x,n);\n</code></pre>\n\n<p>BTW: VLA (or dynamic arrays as you call them) are non standard in C++, but gcc (and possibily clang) has them as extension.</p>\n"}, {"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 2, "last_activity_date": 1481714868, "last_edit_date": 1481714868, "creation_date": 1481714117, "answer_id": 41141202, "question_id": 41141036, "link": "https://stackoverflow.com/questions/41141036/dynamic-array-crashed-for-more-than-8-elements/41141202#41141202", "title": "Dynamic array crashed for more than 8 elements", "body": "<p><code>int n, x[n];</code> is the problem</p>\n\n<p>You are declaring <code>n</code> that will have an indeterminate value. With this value you are declaring an array that will have an indeterminate size.</p>\n\n<p>You are using C++, so use <code>new</code> keyword to create your array, after user input:</p>\n\n<pre><code>cout &lt;&lt; \"Please enter the number of elements in the array: \" &lt;&lt; endl;\ncin &gt;&gt; n;\nint *x = new int[n];\n// your stuff\ndelete x;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7296059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23c9502816915c7f60c630af658a4f65?s=128&d=identicon&r=PG&f=1", "display_name": "Qasimi", "link": "https://stackoverflow.com/users/7296059/qasimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 41141066, "answer_count": 4, "score": 1, "last_activity_date": 1481714868, "creation_date": 1481713483, "question_id": 41141036, "link": "https://stackoverflow.com/questions/41141036/dynamic-array-crashed-for-more-than-8-elements", "title": "Dynamic array crashed for more than 8 elements", "body": "<pre><code>#include&lt;iostream&gt;\nusing namespace std;\nvoid arrayin(int x[], int n);\nvoid arrayout(int x[], int n);\nmain()\n{\n    int n, x[n];\n    cout &lt;&lt; \"Please enter the number of elements in the array: \" &lt;&lt; endl;\n    cin &gt;&gt; n;\n    cout &lt;&lt; \"Please enter the elements: \" &lt;&lt; endl;\n    arrayin(x,n);\n    cout &lt;&lt; \"Array is of \" &lt;&lt; n &lt;&lt; \" elements.\"&lt;&lt; endl;\n    cout &lt;&lt; \"Elements are as follow :\" &lt;&lt; endl;\n    arrayout(x,n); \n}\nvoid arrayin(int x[],int n)\n{\n    for (int i = 0; i &lt; n; i ++)\n    {\n        cin &gt;&gt; x[i];\n    }\n}   \nvoid arrayout(int x[], int n)\n{\n    for (int i = 0; i &lt; n; i++)\n    {\n        cout &lt;&lt; x[i] &lt;&lt; \"\\t\";\n    }\n}\n</code></pre>\n\n<p>I'm new to programming.\nIt crashes for more than 8 elements, if n > 8 crashes.. but for n&lt;8 works fine..\nDont know why!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1481713816, "post_id": 41140905, "comment_id": 69484805, "body": "Just find the convex hull using the standard algorithms. Then length is trivial."}], "answers": [{"tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 0, "last_activity_date": 1481714251, "creation_date": 1481714251, "answer_id": 41141238, "question_id": 41140905, "link": "https://stackoverflow.com/questions/41140905/convex-hull-length-in-c/41141238#41141238", "title": "Convex hull length in C", "body": "<p>I can't see a standard answer, so here's the algorithm:</p>\n\n<p>Choose a point roughly in the centre of your point cloud. Then sort the points radially, by angle from the centre. The topmost point must be in the convex hull, so define it as having an angle of 0.0 and being first in the list.</p>\n\n<p>Now go though. Put point 2 in the \"tentative\" hull list. Then check point 3. If the angle P1-P2-P3 is concave (relative to the centre point), remove P2 from the list, if it is convex, keep it. Continue like this, backtracking and removing points if they go concave. You only need two points in your \"tentative\" list, once you have three, they become definite.</p>\n\n<p>You stop when you go full circle and get back to P1.</p>\n"}, {"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1539089857, "creation_date": 1539089857, "answer_id": 52721646, "question_id": 41140905, "link": "https://stackoverflow.com/questions/41140905/convex-hull-length-in-c/52721646#52721646", "title": "Convex hull length in C", "body": "<p>There are many known <a href=\"https://en.wikipedia.org/wiki/Convex_hull_algorithms\" rel=\"nofollow noreferrer\">convex hull algorithms</a>, one of the simplest of which is the <a href=\"https://en.wikipedia.org/wiki/Gift_wrapping_algorithm\" rel=\"nofollow noreferrer\">gift wrapping algorithm</a>. Here's an implementation that fits in your program where the points have been input and sorted:</p>\n\n<pre><code>    int j = 0;  // after sorting, b[0] is leftmost point, must be on an edge\n    double length = 0;\n    VECTOR v1, v2, vv;\n    v1.x = 0, v1.y = 1; // start by measuring angles from vertical\n    int iv;     // index of next edge point\n    do          // find next egde point by minimum angle\n    {\n        double lv1 = vector_length(v1), lv2, lv;\n        double cv = -1; // minimal possible cosine value\n        for (i = 0; i &lt; n; ++i) if (i != j)\n        {   // compute cosine of angle between v1 and (b[j]--&gt;b[i]) = v2\n            v2.x = b[i].x-b[j].x, v2.y = b[i].y-b[j].y;\n            double c = (v1.x*v2.x + v1.y*v2.y) / lv1 / (lv2 = vector_length(v2));\n            if (c &gt; cv) cv = c, iv = i, lv = lv2, vv = v2;  // new maximum cosine\n        }\n        if (v == -1) break;\n        // printf(\"%d:%f,%f--&gt;%d:%f,%f = %f\\n\", j, b[j], iv, b[iv], lv);\n        length += lv;\n        v1 = vv;        // found edge is new reference edge\n    } while (j = iv);   // repeat while not at start again\n    printf(\"%.3lf\\n\", length);\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6948903"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 340, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1539089857, "creation_date": 1481713110, "question_id": 41140905, "link": "https://stackoverflow.com/questions/41140905/convex-hull-length-in-c", "title": "Convex hull length in C", "body": "<p>Im making a program to calculate convex hull length of 2D points.</p>\n\n<p>On the input there is a number of points <code>n</code> and then the coordinates of each point.</p>\n\n<p>for example:</p>\n\n<pre><code>6\n-8 -3\n-6 1\n-5 -2\n-3 1\n-3 4\n2 18\n</code></pre>\n\n<p>and output is simply the length of the convex hull.</p>\n\n<p>my code looks like this so far:</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\ntypedef struct point\n{\n    double x;\n    double y;\n}POINT,VECTOR;\n\nPOINT b[1000];\nVECTOR normal;\nint n;\n\nint upper_lower(int i, VECTOR ab, double c) {\n    double x, y,result;\n    y = b[i].y;\n    x = normal.x*b[i].x;\n    result = -(x + c) / normal.y;\n    if (y&gt;result) return 1;\n    if (y == result) return 0;\n    else\n        return -1;\n\n\n}\n\nint ccw(VECTOR v,VECTOR v2)\n{\n    double cp;\n\n    cp = v2.x*v.y - v2.y*v.x;\n\nif (cp == abs(cp)) return 1;\nelse\n    return -1;\n\n\n}\n\ndouble vector_length(VECTOR v)\n{\n    return sqrt(pow(v.x, 2) + pow(v.y, 2));\n\n}\n\nint cmp_points(const void *p1, const void *p2)\n{\n    const POINT *pt1 = p1;\n    const POINT *pt2 = p2;\n\n// do primary compare on x\nif (pt1-&gt;x &gt; pt2-&gt;x)\n    return 1;\nif (pt1-&gt;x &lt; pt2-&gt;x)\n    return -1;\n\n// pt1-&gt;x == pt2-&gt;x - do secondary compare on y...\nif (pt1-&gt;y &gt; pt2-&gt;y)\n    return 1;\nif (pt1-&gt;y &lt; pt2-&gt;y)\n    return -1;\n\n// pt1 == pt2\nreturn 0;\n}\n\nint main()\n{\n    int i,poloha,upper[1000],lower[1000],h=0,d=0;\n    scanf(\"%d\", &amp;n);\n    if (n &lt;= 0 &amp;&amp; n &gt; 1000) return 0;\n    for (i = 0; i &lt; n; i++)\n    {\n        scanf(\"%lf %lf\", &amp;b[i].x, &amp;b[i].y);\n    }\n    qsort(b, n, sizeof(POINT), cmp_points);\n\n//split in half\nVECTOR ab;\ndouble c;\nab.x = b[n - 1].x - b[0].x;\nab.y = b[n - 1].y - b[0].y;\nnormal.x = -ab.y;\nnormal.y = ab.x;\nc = -normal.x*b[0].x - (normal.y*b[0].y);\nfor (i = 0; i &lt; n; i++)\n{\n    poloha = upper_lower(i,ab,c);\n    if (poloha == 1) upper[h++] = i;\n    if (poloha == -1) lower[d++]=i;\n    if (poloha == 0)\n    {\n        upper[h++] = i;\n        lower[d++] = i;\n    }\n\n}\nint j = 0;\ndouble v, length = 0;\nVECTOR v1, v2, v3,v4;\nv3.x = 0; v3.y = 0;\n//lower part\nfor (i = 0; ; i++)\n{\n    int in = 0;\n    if (lower[i + 2] &lt; 0)\n    {\n        v1.x = b[lower[i + 1]].x - b[lower[0]].x;\n        v1.y = b[lower[i + 1]].y - b[lower[0]].y;\n\n        v2.x = b[lower[i]].x - b[lower[i + 1]].x;\n        v2.y = b[lower[i]].y - b[lower[i + 1]].y;\n\n        lenght += vector_length(v1);\n        length += vector_length(v2);\n        break;\n    }\n    v1.x = b[lower[i + 1]].x - b[lower[i]].x;\n    v1.y = b[lower[i + 1]].y - b[lower[i]].y;\n\n    v2.x = b[lower[i + 2]].x - b[lower[i]].x;\n    v2.y = b[lower[i + 2]].y - b[lower[i]].y;\n    in = ccw(v1, v2);\n    if (in == 1)\n    {\n        length += vector_length(v1);\n        v3 = v2;\n        v4 = v1;\n    }\n    if (in == -1)\n    {\n        length -= vector_length(v4);\n        if (v3.x != 0 &amp;&amp; v3.y != 0)\n        {\n            length += vector_length(v3);\n            v3.x = 0; v3.y = 0;\n        }\n        else\n        {\n            length += vector_length(v2);\n\n        }\n\n\n    }\n}\n\nprintf(\"%.3lf\", length);\n\nreturn 0;\n}\n</code></pre>\n\n<p>the problem is that in the last part where I try to compute the length...I just dont know how to finish it..no matter what I try it never works as I want to. Could you guys give me some advice?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1481712347, "post_id": 41140577, "comment_id": 69483876, "body": "Is there also an error or a warning that <code>struct emp</code> is undefined or undeclared? Because that matters."}, {"owner": {"reputation": 75, "user_id": 4404837, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o8rUF0uiNRs/AAAAAAAAAAI/AAAAAAAAAD4/KI7Xo9d8Hig/photo.jpg?sz=128", "display_name": "Vaibhav Gautam", "link": "https://stackoverflow.com/users/4404837/vaibhav-gautam"}, "edited": false, "score": 0, "creation_date": 1481713474, "post_id": 41140577, "comment_id": 69484594, "body": "@Rhymoid No such warning like undefined or undeclared struct emp."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 4404837, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o8rUF0uiNRs/AAAAAAAAAAI/AAAAAAAAAD4/KI7Xo9d8Hig/photo.jpg?sz=128", "display_name": "Vaibhav Gautam", "link": "https://stackoverflow.com/users/4404837/vaibhav-gautam"}, "edited": false, "score": 0, "creation_date": 1481712831, "post_id": 41140675, "comment_id": 69484184, "body": "Why the scope is limited to this prototype?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 1, "creation_date": 1481712983, "post_id": 41140675, "comment_id": 69484279, "body": "Because it has no other way to sensibly fix your broken code. C is read from front to back. If the compiler is missing information, it can&#39;t look ahead."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 75, "user_id": 4404837, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o8rUF0uiNRs/AAAAAAAAAAI/AAAAAAAAAD4/KI7Xo9d8Hig/photo.jpg?sz=128", "display_name": "Vaibhav Gautam", "link": "https://stackoverflow.com/users/4404837/vaibhav-gautam"}, "edited": false, "score": 0, "creation_date": 1481713363, "post_id": 41140675, "comment_id": 69484528, "body": "@VaibhavGautam Because that&#39;s the rule. If you want to know why that&#39;s the rule, the ANSI committee may have an archive of discussions somewhere."}, {"owner": {"reputation": 75, "user_id": 4404837, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o8rUF0uiNRs/AAAAAAAAAAI/AAAAAAAAAD4/KI7Xo9d8Hig/photo.jpg?sz=128", "display_name": "Vaibhav Gautam", "link": "https://stackoverflow.com/users/4404837/vaibhav-gautam"}, "edited": false, "score": 0, "creation_date": 1481714021, "post_id": 41140675, "comment_id": 69484921, "body": "@Rhymoid So basically compiler is considering two different instances of struct emp, and when it sees that instance of struct in calling function argument does not match with instance of struct during function prototype, it gives conflicting type error."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1481718382, "post_id": 41140675, "comment_id": 69487591, "body": "That&#39;s how I understand the situation. Always make sure to declare everything upfront, and to instruct your compiler to warn you about every problem (for GCC, you need the <code>-Wall -pedantic</code> flags, and using <code>-Werror</code> is a good habit to get used to)."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 3, "last_activity_date": 1481712444, "creation_date": 1481712444, "answer_id": 41140675, "question_id": 41140577, "link": "https://stackoverflow.com/questions/41140577/compilation-error-conflicting-types-for-modify-why/41140675#41140675", "title": "compilation error: conflicting types for &#39;modify&#39; - why?", "body": "<p>gcc can tell you the reason.</p>\n\n<p>Increase your warning level:</p>\n\n<pre><code>prog.c:3:20: warning: 'struct emp' declared inside parameter list\n void modify(struct emp *y);\n                    ^\nprog.c:3:20: warning: its scope is only this definition or declaration, which is \n                      probably not what you want\n</code></pre>\n\n<p>You can either change the order of the prototype and the struct definition, or add a declaration of the struct before the prototype.</p>\n"}, {"tags": [], "owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "is_accepted": false, "score": 1, "last_activity_date": 1481713116, "last_edit_date": 1481713116, "creation_date": 1481712492, "answer_id": 41140689, "question_id": 41140577, "link": "https://stackoverflow.com/questions/41140577/compilation-error-conflicting-types-for-modify-why/41140689#41140689", "title": "compilation error: conflicting types for &#39;modify&#39; - why?", "body": "<p>Move the struct upwards so your function prototype knows <code>emp</code></p>\n\n<pre><code>    struct emp\n    {\n      char name[20];\n      int age;\n    };\n    void modify(struct emp *y);    \n\n    int main(void)\n    {\n      struct emp e={\"foo\",35};\n      modify(&amp;e);\n      printf(\"\\n%s%d\",e.name,e.age);\n      return 0;\n    }\n    void modify(struct emp *p){\n      p-&gt;age = p-&gt;age+2;\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1481712905, "post_id": 41140765, "comment_id": 69484231, "body": "You&#39;re wrong about the definition of <code>main</code>. It&#39;s the one function that does not need an explicit return statement."}, {"owner": {"reputation": 17784, "user_id": 1646322, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d9fd7a75e0d8ace7bb3276476786c2c0?s=128&d=identicon&r=PG", "display_name": "Ruslan Osmanov", "link": "https://stackoverflow.com/users/1646322/ruslan-osmanov"}, "edited": false, "score": 0, "creation_date": 1481713002, "post_id": 41140765, "comment_id": 69484288, "body": "@Rhymoid, okay, it <i>should</i> explicitly return integer, and the return type <i>should</i> be specified."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1481713218, "post_id": 41140765, "comment_id": 69484418, "body": "Regarding rants and incorrect believes about the format of <code>main</code>, <a href=\"http://stackoverflow.com/a/31263079/584518\">read this</a>. <code>main()</code> is valid in C90 and also on all freestanding implementations. Missing <code>return 0</code> is undefined behavior in C90 but valid in later standards."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481713319, "post_id": 41140765, "comment_id": 69484503, "body": "@RuslanOsmanov IIRC, it&#39;s implicit, and <i>should</i> is valid only if you expect something other than <code>0</code>."}], "tags": [], "owner": {"reputation": 17784, "user_id": 1646322, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d9fd7a75e0d8ace7bb3276476786c2c0?s=128&d=identicon&r=PG", "display_name": "Ruslan Osmanov", "link": "https://stackoverflow.com/users/1646322/ruslan-osmanov"}, "is_accepted": false, "score": 1, "last_activity_date": 1481713404, "last_edit_date": 1495542632, "creation_date": 1481712733, "answer_id": 41140765, "question_id": 41140577, "link": "https://stackoverflow.com/questions/41140577/compilation-error-conflicting-types-for-modify-why/41140765#41140765", "title": "compilation error: conflicting types for &#39;modify&#39; - why?", "body": "<p>The declaration of <code>main()</code> is incorrect. The function <a href=\"https://stackoverflow.com/questions/204476/what-should-main-return-in-c-and-c\">should return an integer</a>: <code>return 0;</code>, and the return type should be specified explicitly:</p>\n\n<pre><code>int main(void)\n{\n  /* ... */\n  return 0;\n}\n</code></pre>\n\n<p>Prototype of <code>modify</code> function mentions undeclared structure <code>emp</code>. In other words, you should put the declaration of <code>emp</code> structure before the prototype.</p>\n\n<p>Avoid using <code>strupr</code> as it <a href=\"https://stackoverflow.com/questions/26327812/strupr-and-strlwr-in-string-h-part-are-of-the-ansi-standard/26328095#26328095\">is non-standard function</a>.</p>\n\n<p>Consider declaring functions <code>static</code>, if they are supposed to be used <em>only</em> within the current compilation unit.</p>\n"}, {"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1481713400, "creation_date": 1481713400, "answer_id": 41141012, "question_id": 41140577, "link": "https://stackoverflow.com/questions/41140577/compilation-error-conflicting-types-for-modify-why/41141012#41141012", "title": "compilation error: conflicting types for &#39;modify&#39; - why?", "body": "<p>Moving the definitions around will fix the issue for you. But since no one mentioned it yet, I'll pitch in:</p>\n\n<p>You can fix it with the minimal change of forward declaring the <code>struct</code>.</p>\n\n<pre><code>struct emp; // Forward declare struct emp before using it in the prototype.\nvoid modify(struct emp *y);\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4404837, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o8rUF0uiNRs/AAAAAAAAAAI/AAAAAAAAAD4/KI7Xo9d8Hig/photo.jpg?sz=128", "display_name": "Vaibhav Gautam", "link": "https://stackoverflow.com/users/4404837/vaibhav-gautam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 834, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1481713404, "creation_date": 1481712155, "last_edit_date": 1481713147, "question_id": 41140577, "link": "https://stackoverflow.com/questions/41140577/compilation-error-conflicting-types-for-modify-why", "title": "compilation error: conflicting types for &#39;modify&#39; - why?", "body": "<p>Why am I getting compilation error for below code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid modify(struct emp *y);\nstruct emp\n{\n  char name[20];\n  int age;\n};\nmain()\n{\n  struct emp e={\"foo\",35};\n  modify(&amp;e);\n  printf(\"\\n%s%d\",e.name,e.age);\n}\nvoid modify(struct emp *p){\n  strupr(p-&gt;name);\n  p-&gt;age = p-&gt;age+2;\n}\n</code></pre>\n\n<p>Below is the part of build log messages.</p>\n\n<p>error: conflicting types for 'modify'| at line no. 15</p>\n\n<p>note: previous declaration of 'modify' was here| at line no. 3</p>\n"}, {"tags": ["c", "semaphore"], "answers": [{"comments": [{"owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "edited": false, "score": 0, "creation_date": 1481712328, "post_id": 41140599, "comment_id": 69483864, "body": "sem_wait() decrements (locks) the semaphore pointed to by sem.  If        the semaphore&#39;s value is greater than zero, then the decrement        proceeds, and the function returns, immediately.  If the semaphore        currently has the value zero, then the call blocks until either it        becomes possible to perform the decrement (i.e., the semaphore value        rises above zero), or a signal handler interrupts the call."}, {"owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "edited": false, "score": 0, "creation_date": 1481712367, "post_id": 41140599, "comment_id": 69483888, "body": "You see, &quot;if the semaphore currently has the value zero, then the call blocks...&quot;. What does block mean here?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "edited": false, "score": 2, "creation_date": 1481712566, "post_id": 41140599, "comment_id": 69484022, "body": "It blocks the execution of the thread that is calling <code>sem_wait</code>, not the whole process or other tasks."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 0, "last_activity_date": 1512408160, "last_edit_date": 1512408160, "creation_date": 1481712211, "answer_id": 41140599, "question_id": 41140538, "link": "https://stackoverflow.com/questions/41140538/why-doesnt-sem-wait-block/41140599#41140599", "title": "why doesn&#39;t sem_wait block", "body": "<p><code>pthread_join</code> is mandatory in your implementation.</p>\n\n<p>Otherwise your process finishes (ie. main returns), and all tasks (ie. threads) are killed before thread 3 prints anything.</p>\n"}], "owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1535, "favorite_count": 0, "accepted_answer_id": 41140599, "answer_count": 1, "score": 0, "last_activity_date": 1512408160, "creation_date": 1481712061, "question_id": 41140538, "link": "https://stackoverflow.com/questions/41140538/why-doesnt-sem-wait-block", "title": "why doesn&#39;t sem_wait block", "body": "<pre><code>static int res1 = 0;\nstatic int res2 = 0;\nstatic int res3 = 0;\n\nstatic int counter = 0;\nstatic sem_t sem;\n\n\n\nvoid * func_thread1(void *p)\n{\n    sleep(2);\n    res1 = 1;\n    printf(\"func_thread1\\n\");\n    sem_post(&amp;sem);\n    return NULL;\n}\n\nvoid * func_thread2(void *p)\n{\n    sleep(2);\n    res2 = 2;\n    printf(\"func_thread2\\n\");\n    sem_post(&amp;sem);\n    return NULL;\n}\n\nvoid * func_thread3(void *p)\n{\n    sem_wait(&amp;sem);\n    sem_wait(&amp;sem);\n    res3 = res1 + res2;\n    printf(\"func_thread3\\n\");\n    return NULL;\n}\n\n\n\n\nvoid main()\n{\n    sem_init(&amp;sem, 0, counter);\n    pthread_t pd1, pd2, pd3;\n    pthread_create(&amp;pd1, NULL, func_thread1, NULL);\n    pthread_create(&amp;pd2, NULL, func_thread2, NULL);\n    pthread_create(&amp;pd3, NULL, func_thread3, NULL);\n\n    //pthread_join(pd3, NULL);\n\n    printf(\"main_thread\\n\");\n    printf(\"%d\", res3);\n}\n</code></pre>\n\n<p>I'm trying to understand how semaphore works.<br>\nI'm trying to make the <code>td3</code> block to wait for the <code>td1</code> and the <code>td2</code>.<br></p>\n\n<p>In my opinion, the <code>sem_wait</code> will block twice. If the <code>sem_post</code>s in <code>func_thread1</code> and in <code>func_thread2</code> are executed, <code>func_thread3</code> could continue.<br></p>\n\n<p>However, it doesn't work unless I add <code>pthread_join(td3, NULL)</code> in <code>main</code>. I think the join is not necessary because <code>sem_wait</code> can block.<br></p>\n\n<p>So <code>pthread_join</code> is necessary or I use semaphore incorrectly?</p>\n"}, {"tags": ["c", "embedded", "tdd", "iar", "unity-test-framework"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1481712119, "post_id": 41140188, "comment_id": 69483739, "body": "As far as I know, IAR linker is <code>ilinkarm</code>, <code>iccarm</code> is only the compiler. Compiler manual should give you the details on how to use them. Also, workbench has option to show full build commands on compile, which you could check for reference."}, {"owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1481712282, "post_id": 41140188, "comment_id": 69483834, "body": "@user694733 Thanks - I&#39;ve made that change. Do you happen to know if <code>iccarm</code> is still appropriate for the <code>test_file_preprocessor</code> and <code>test_includes_preprocessor</code> roles?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1481712556, "post_id": 41140188, "comment_id": 69484010, "body": "I haven&#39;t really compiled much from command line, so I cannot say for sure. And you should verify my earlier comment from the compiler manual: my IAR version is slightly older than yours so it may have changed."}, {"owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1481712647, "post_id": 41140188, "comment_id": 69484069, "body": "@user694733 Doing that now. I&#39;m also looking over the full build logs from a complete rebuild of my actual project to see how <code>iccarm</code> and <code>ilinkarm</code> are being used - looks like <code>iccarm</code> has a <code>--preprocess</code> flag."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481718330, "post_id": 41140188, "comment_id": 69487568, "body": "Obviously the tests must be carried out on the target hardware or they won&#39;t be very meaningful. TDD was never meant to replace common sense. If you test them on a PC you can only detect pure algorithm problems and not problems with hardware, interrupts, memory, timing or poorly-specified behavior. If there is a requirement that the code should be portable, it would be wise to test it on multiple platforms."}, {"owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "edited": false, "score": 0, "creation_date": 1481718406, "post_id": 41140188, "comment_id": 69487607, "body": "&quot;If you test them on a PC you can only detect pure algorithm problems...&quot; Which is only what I need for the time being. There is also no requirement for the code to be portable."}, {"owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "edited": false, "score": 0, "creation_date": 1481718753, "post_id": 41140188, "comment_id": 69487820, "body": "To expand: purely algorithmic tests can be automated and performed on the host machine while testing on the actual hardware (to detect possible problems with timing, etc.) can be done manually (as is done at the moment). It&#39;s not obvious at all that tests must be carried out on target hardware to be meaningful, as James Grenning advocates a &quot;dual-targeting&quot; approach and claims both sorts of tests have value."}], "answers": [{"comments": [{"owner": {"reputation": 275, "user_id": 986977, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d518faad181286ddc764ed3e86ff8d21?s=128&d=identicon&r=PG", "display_name": "mek363", "link": "https://stackoverflow.com/users/986977/mek363"}, "edited": false, "score": 1, "creation_date": 1522592562, "post_id": 41163907, "comment_id": 86205170, "body": "Thanks for following up with an example!"}], "tags": [], "owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "is_accepted": true, "score": 11, "last_activity_date": 1513123211, "last_edit_date": 1513123211, "creation_date": 1481803983, "answer_id": 41163907, "question_id": 41140188, "link": "https://stackoverflow.com/questions/41140188/how-can-i-configure-ceedling-for-an-iar-embedded-workbench-project/41163907#41163907", "title": "How can I configure Ceedling for an IAR Embedded Workbench project?", "body": "<p>It was a struggle but I believe I've managed to configure Ceedling to help test my project. Hopefully this will be useful to anyone else looking to use Ceedling within IAR projects.</p>\n\n<p>The Ceedling CLI has a command (<code>ceedling new &lt;proj_name&gt;</code>) that allows you to create new projects with the structure Ceedling expects. You can also specify the name of an <em>existing</em> project in which case it only adds the necessary files to make it Ceedling-compatible, which is what I did with my project.</p>\n\n<p>For reference, my project structure looked something like this after performing this step:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>.\n\u251c\u2500\u2500 build\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 artifacts\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 test\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 docs\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 exe\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 list\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 logs\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 obj\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 temp\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 test\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 cache\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 dependencies\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 list.i\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 mocks\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 out\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 results\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 runners\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 tests.map\n\u251c\u2500\u2500 project.yml\n\u251c\u2500\u2500 rakefile.rb\n\u251c\u2500\u2500 src\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 c\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 canDatabase.c\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 include\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 canDatabase.h\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 python\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 resources\n\u251c\u2500\u2500 test\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 support\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 test_canDatabase.c\n\u251c\u2500\u2500 &lt;my_project&gt;.dep\n\u251c\u2500\u2500 &lt;my_project&gt;.ewd\n\u251c\u2500\u2500 &lt;my_project&gt;.ewp\n\u251c\u2500\u2500 &lt;my_project&gt;.eww\n\u251c\u2500\u2500 vendor\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 ceedling\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 docs\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 lib\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 plugins\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 vendor\n\u2514\u2500\u2500 version.properties\n</code></pre>\n\n<p>After that, I looked over the reference manuals for the IAR tools and studied the output from IAR Embedded Workbench when building sample projects, as @user694733 suggested. I used this information to edit my <code>project.yml</code> as given below:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>:project:\n  :use_exceptions: FALSE\n  :use_test_preprocessor: FALSE\n  :use_auxiliary_dependencies: TRUE\n  :build_root: build\n  :release_build: FALSE\n  :test_file_prefix: test_\n\n:environment:\n  - :path:\n    - 'C:\\Program Files (x86)\\IAR Systems\\Embedded Workbench 6.5\\arm\\bin'\n    - 'C:\\Program Files (x86)\\IAR Systems\\Embedded Workbench 6.5\\common\\bin'\n    - #{ENV['PATH']}\n\n:extension:\n  :executable: .out\n\n:paths:\n  :test:\n    - +:test/**\n    - -:test/support\n  :source:\n    - src/main/c/**\n    - src/main/include/**\n    - src/main/resources/**\n  :support:\n    - test/support\n\n:defines:\n  :commmon: &amp;common_defines []\n  :test:\n    - *common_defines\n    - TEST\n  :test_preprocess:\n    - *common_defines\n    - TEST\n\n:cmock:\n  :mock_prefix: mock_\n  :when_no_prototypes: :warn\n  :enforce_strict_ordering: TRUE\n  :plugins:\n    - :ignore\n    - :callback\n  :treat_as:\n    uint8:    HEX8\n    uint16:   HEX16\n    uint32:   UINT32\n    int8:     INT8\n    bool:     UINT8\n\n:tools:\n  :test_compiler:\n    :executable: iccarm\n    :name: 'IAR test compiler'\n    :arguments:\n      - -D _DLIB_FILE_DESCRIPTOR=1\n      - --debug\n      - --endian=little\n      - --cpu=Cortex-M3\n      - -e\n      - --fpu=None\n      - -Ol\n      - --preprocess \"build/test/list\"\n      - --dlib_config \"C:/Program Files (x86)/IAR Systems/Embedded Workbench 6.5/arm/INC/c/DLib_Config_Normal.h\"\n      - -I\"$\": COLLECTION_PATHS_TEST_TOOLCHAIN_INCLUDE\n      - -I\"$\": COLLECTION_PATHS_TEST_SUPPORT_SOURCE_INCLUDE_VENDOR\n      - -o \"${2}\"\n      - --diag_suppress=Pa050\n      - '\"${1}\"'\n\n  :test_linker:\n    :executable: ilinkarm\n    :name: 'IAR test linker'\n    :arguments:\n      - --vfe\n      - --redirect _Printf=_PrintfFull\n      - --redirect _Scanf=_ScanfFull\n      - --semihosting\n      - --config \"C:/Program Files (x86)/IAR Systems/Embedded Workbench 6.5/arm/config/generic_cortex.icf\"\n      - --map \"build/test/tests.map\"\n      - -o \"${2}\"\n      - '\"${1}\"'\n\n  :test_fixture:\n    :executable: cspybat\n    :name: 'CSpyBat test runner'\n    :arguments:\n      - '\"C:\\Program Files (x86)\\IAR Systems\\Embedded Workbench 6.5\\arm\\bin\\armproc.dll\"'\n      - '\"C:\\Program Files (x86)\\IAR Systems\\Embedded Workbench 6.5\\arm\\bin\\armsim2.dll\"'\n      - '\"${1}\"'\n      - --plugin \"C:\\Program Files (x86)\\IAR Systems\\Embedded Workbench 6.5\\arm\\bin\\armbat.dll\"\n      - --backend -B\n      - --endian=little\n      - --cpu=Cortex-M3\n      - --fpu=None\n      - --semihosting\n\n:plugins:\n  :load_paths:\n    - vendor/ceedling/plugins\n  :enabled:\n    - stdout_pretty_tests_report\n    - module_generator\n...\n</code></pre>\n\n<p>This seems to be a suitable configuration for testing code designed to work on a Cortex-M3 device.</p>\n\n<p>I also edited <code>rakefile.rb</code> to ensure that the generated test files are cleaned before each test run, as this was necessary to have the test results get printed consistently.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>PROJECT_CEEDLING_ROOT = \"vendor/ceedling\"\nload \"#{PROJECT_CEEDLING_ROOT}/lib/ceedling.rb\"\n\nCeedling.load_project\n\ntask :default =&gt; %w[ clean test:all ]\n</code></pre>\n\n<p>I was then able to define and run unit tests. Below is an excerpt from <code>test_canDatabase.c</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"unity.h\"\n#include \"canDatabase.h\"\n\nuint32_t actualId;\nuint8_t actualPayload[8];\nuint8_t actualPayloadLen;\nuint8_t actualCanPort;\n\nvoid mockHandler(uint32_t id, uint8_t payload[8], uint8_t payloadLen, uint8_t canPort)\n{\n  actualId = id;\n  actualPayloadLen = payloadLen;\n  actualCanPort = canPort;\n\n  for (int i=0; i &lt; payloadLen; i++)\n  {\n    actualPayload[i] = payload[i];\n  }\n}\n\nvoid setUp(void)\n{\n  actualId = 0;\n  actualPayloadLen = 0;\n  actualCanPort = 0;\n\n  for (int i=0; i &lt; 8; i++)\n  {\n    actualPayload[i] = 0;\n  }\n\n  CANDB_Init(mockHandler);\n}\n\nvoid tearDown(void) {}\n\nvoid test_Register_Tx_Definition()\n{\n  // GIVEN a CAN Tx message definition.\n  CAN_TX_MESSAGE_DEFINITION_T definition;\n  definition.id = 0;\n\n  // WHEN we register the definition in the CAN database.\n  int err = CANDB_RegisterTxDefinition(definition);\n\n  // THEN the database should return SUCCESS (0x0).\n  TEST_ASSERT_EQUAL_MESSAGE(0x0, err, \"Registration should succeed\");\n}\n\nvoid test_Register_Tx_Definition_Twice()\n{\n  // GIVEN a CAN Tx message definition.\n  CAN_TX_MESSAGE_DEFINITION_T definition;\n  definition.id = 0;\n\n  // WHEN we register the definition once.\n  CANDB_RegisterTxDefinition(definition);\n\n  // AND we register the definition again.\n  int err = CANDB_RegisterTxDefinition(definition);\n\n  // THEN the database should return SUCCESS (0x0).\n  TEST_ASSERT_EQUAL_MESSAGE(0x0, err, \"Re-registration should succeed\");\n}\n</code></pre>\n\n<p>I'm now able to run automated tests by invoking \"ceedling\" from a terminal (project root is the current working directory):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ ceedling\n---------------------\nBUILD FAILURE SUMMARY\n---------------------\nUnit test failures.\n\n\nCleaning build artifacts...\n(For large projects, this task may take a long time to complete)\n\n\n\nTest 'test_canDatabase.c'\n-------------------------\nGenerating runner for test_canDatabase.c...\nCompiling test_canDatabase_runner.c...\nCompiling test_canDatabase.c...\nCompiling unity.c...\nCompiling canDatabase.c...\nCompiling cmock.c...\nLinking test_canDatabase.out...\nRunning test_canDatabase.out...\n\n-----------\nTEST OUTPUT\n-----------\n[test_canDatabase.c]\n  - \"\"\n  - \"     IAR C-SPY Command Line Utility V6.6.0.2752\"\n  - \"     Copyright 2000-2013 IAR Systems AB.\"\n  - \"\"\n  - \"\"\n\n-------------------\nFAILED TEST SUMMARY\n-------------------\n[test_canDatabase.c]\n  Test: test_Register_More_Than_Max_Allowed_Definitions\n  At line (84): \"Expected 1 Was 0. Registration &gt; CANDB_MAX_TX_DEFINITIONS should fail\"\n\n  Test: test_Activate_Tx_Definition_With_Hardcoded_Payload\n  At line (124): \"Expected 0x00000001 Was 0x00000000. Incorrect ID\"\n\n--------------------\nOVERALL TEST SUMMARY\n--------------------\nTESTED:  4\nPASSED:  2\nFAILED:  2\nIGNORED: 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 831833, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/46990af6127fa30b2361fe21cb770bc8?s=128&d=identicon&r=PG", "display_name": "Cac3a", "link": "https://stackoverflow.com/users/831833/cac3a"}, "is_accepted": false, "score": 2, "last_activity_date": 1587582452, "creation_date": 1587582452, "answer_id": 61373202, "question_id": 41140188, "link": "https://stackoverflow.com/questions/41140188/how-can-i-configure-ceedling-for-an-iar-embedded-workbench-project/61373202#61373202", "title": "How can I configure Ceedling for an IAR Embedded Workbench project?", "body": "<p>Your answer was super helpful and I'm working on similar approach for Cortex-M4 with IAR 7.5 and thought of sharing my portions of project.yml additions.</p>\n\n<pre><code>:tools:\n  :test_compiler:\n    :executable: iccarm\n    :name: 'IAR test compiler'\n    :arguments:\n      - -D _DLIB_FILE_DESCRIPTOR=1 \n      - --diag_suppress Pa050,Pa082,Pa039,Pe186\n      - --no_cse\n      - --no_unroll\n      - --no_inline\n      - --no_code_motion\n      - --no_tbaa\n      - --no_clustering\n      - --no_scheduling\n      - --debug\n      - --endian=little\n      - --cpu=Cortex-M4\n      - -e\n      - --fpu=VFPv4_sp\n      - --dlib_config \"C:\\Program Files (x86)\\IAR Systems\\Embedded Workbench 7.5\\arm\\INC\\c\\DLib_Config_Normal.h\"\n      - --preprocess \"build/test/list\"\n      - -On\n      - --c++\n      - --no_exceptions\n      - --no_rtti\n      - -I\"$\": COLLECTION_PATHS_TEST_TOOLCHAIN_INCLUDE\n      - -I\"$\": COLLECTION_PATHS_TEST_SUPPORT_SOURCE_INCLUDE_VENDOR\n      - -o \"${2}\"\n      - '\"${1}\"'\n\n  :test_linker:\n    :executable: ilinkarm\n    :name: 'IAR test linker'\n    :arguments:\n      - --vfe\n      - --redirect _Printf=_PrintfFull\n      - --redirect _Scanf=_ScanfFull\n      - --semihosting\n      - --keep __checksum\n      - --entry __iar_program_start\n      - --place_holder __checksum,4,.checksum,4\n      - --define_symbol __checksum_begin=0x8020000\n      - --define_symbol __checksum_end=0x80dfffb\n      - --no_exceptions \n      - --config \"C:\\Users\\jseinfeld\\RubymineProjects\\m4\\common\\cb\\proj\\flash.icf\"\n      - --map \"build/test/m4.map\"\n      - -o \"${2}\"\n      - '\"${1}\"'\n\n  :test_fixture:\n    :executable: cspybat\n    :name: 'CSpyBat test runner'\n    :arguments:\n      - '\"C:\\Program Files (x86)\\IAR Systems\\Embedded Workbench 7.5\\arm\\bin\\armproc.dll\"'\n      - '\"C:\\Program Files (x86)\\IAR Systems\\Embedded Workbench 7.5\\arm\\bin\\armsim2.dll\"'\n      - '\"${1}\"'\n      - --plugin \"C:\\Program Files (x86)\\IAR Systems\\Embedded Workbench 7.5\\arm\\bin\\armbat.dll\"\n      - --backend -B\n      - --endian=little\n      - --cpu=Cortex-M4\n      - --fpu=VFPv4_sp\n      - --semihosting\n</code></pre>\n"}], "owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3958, "favorite_count": 5, "accepted_answer_id": 41163907, "answer_count": 2, "score": 4, "last_activity_date": 1587582452, "creation_date": 1481711114, "last_edit_date": 1481711958, "question_id": 41140188, "link": "https://stackoverflow.com/questions/41140188/how-can-i-configure-ceedling-for-an-iar-embedded-workbench-project", "title": "How can I configure Ceedling for an IAR Embedded Workbench project?", "body": "<p>I'm trying to develop a new feature for an embedded application and I'd like to do so using a test-driven approach.</p>\n\n<p>The project is written in pure C and is being developed using IAR Embedded Workbench 6.60.1.5104. I'm targeting an LPC1788, which is a Cortex-M3 device, and all development is being done on a 64-bit Windows 7 machine. Right now I'm more in favour of getting unit tests to run on the PC rather than on the target hardware (RAM is quite limited).</p>\n\n<p>I came across a useful book on the subject called <a href=\"https://pragprog.com/book/jgade/test-driven-development-for-embedded-c\" rel=\"nofollow noreferrer\">Test Driven Development for Embedded C</a> and that pointed me towards tools like Unity, CppUTest, Ceedling, etc. After looking into this stuff, I think my best choice is to configure Ceedling (which uses Unity) for my project. However, I'm not sure exactly what steps I need to take to configure Ceedling to work with my current IAR toolchain.</p>\n\n<p>I've installed Ceedling and created the \"blinky\" example project and I'm trying to build and test it using the IAR toolchain. I've added <code>iccarm.exe</code> to my path and edited <code>blinky/project.yml</code> as given below:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>---\n\n# Notes:\n# This is a fully tested project that demonstrates the use\n# of a timer ISR to blink the on board LED of an Arduino UNO\n:project:\n  :use_exceptions: FALSE\n  :use_test_preprocessor: TRUE\n  :use_auxiliary_dependencies: TRUE\n  :build_root: build\n  :release_build: TRUE\n  :test_file_prefix: test_\n\n#You'll have to specify these\n:environment:\n  - :mcu: atmega328p\n  - :f_cpu: 16000000UL \n  - :serial_port: COM8  #change this to the serial port you are using!!!\n  - :objcopy: avr-objcopy\n  # Uncomment these lines if you are using windows and don't have these tools in your path\n  # - :path:\n    # - C:\\mingw\\bin\n    # - C:\\WinAVR-20100110\\bin\n    # - C:\\WinAVR-20100110\\utils\\bin\n    # - #{ENV['PATH']}\n\n:extension:\n  :executable: .bin\n\n:release_build:\n  :output: blinky\n\n:paths:\n  :test:\n    - +:test/**\n    - -:test/support\n  :source:\n    - src/**\n  :support:\n    - test/support\n\n:defines:\n  # in order to add common defines:\n  #  1) remove the trailing [] from the :common: section\n  #  2) add entries to the :common: section (e.g. :test: has TEST defined)\n  :commmon: &amp;common_defines []\n  :test:\n    - *common_defines\n    - TEST\n  :test_preprocess:\n    - *common_defines\n    - TEST\n\n:tools:\n  :release_compiler:\n    :executable: avr-gcc\n    :arguments:\n      - ${1}\n      - -DTARGET\n      - -DF_CPU=#{ENV['F_CPU']}\n      - -mmcu=#{ENV['MCU']}\n      - -Iinclude/\n      - -Wall\n      - -Os\n      - -c\n      - -o ${2}\n  :release_linker:\n    :executable: avr-gcc\n    :arguments:\n      - -mmcu=#{ENV['MCU']}\n      - ${1}\n      - -o ${2}.bin\n\n:cmock:\n  :mock_prefix: mock_\n  :when_no_prototypes: :warn\n  :enforce_strict_ordering: TRUE\n  :plugins:\n    - :ignore\n  :treat_as:\n    uint8:    HEX8\n    uint16:   HEX16\n    uint32:   UINT32\n    int8:     INT8\n    bool:     UINT8\n\n:tools:\n  :test_file_preprocessor:\n    :executable: iccarm\n    :name: 'IAR test file preprocessor'\n\n  :test_includes_preprocessor:\n    :executable: iccarm\n    :name: 'IAR test includes preprocessor'\n\n  :test_compiler:\n    :executable: iccarm\n    :name: 'IAR test compiler'\n\n  :test_linker:\n    :executable: iccarm\n    :name: 'IAR test linker'\n\n  :release_compiler:\n    :executable: iccarm\n    :name: 'IAR release compiler'\n\n  :release_linker:\n    :executable: iccarm\n    :name: 'IAR release linker'\n\n:plugins:\n  :load_paths:\n    - vendor/ceedling/plugins\n  :enabled:\n    - stdout_pretty_tests_report\n    - module_generator\n...\n</code></pre>\n\n<p>The only difference between this and the default <code>project.yml</code> is the content under the second <code>:tools</code> section.</p>\n\n<p>My guess is that I'm heading in the right direction, but I'm not sure whether <code>iccarm.exe</code> is the correct executable to use for all these parts of the toolchain and what arguments I need to pass.</p>\n\n<p>If I can configure Ceedling to build and test the blinky project using an IAR toolchain, I'm hoping I should be able to apply the same configuration for my actual project. If I try running <code>rake</code> now, I get the following output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ rake\n\n\nTest 'test_BlinkTask.c'\n-----------------------\nrake aborted!\nErrno::ENOENT: No such file or directory @ rb_sysopen - build/test/preprocess/files/test_BlinkTask.c\nC:/Users/davidfallah/Documents/IAR Projects/blinky/vendor/ceedling/lib/ceedling/preprocessinator_extractor.rb:18:in `readlines'\nC:/Users/davidfallah/Documents/IAR Projects/blinky/vendor/ceedling/lib/ceedling/preprocessinator_extractor.rb:18:in `extract_base_file_from_preprocessed_expansion'\nC:/Users/davidfallah/Documents/IAR Projects/blinky/vendor/ceedling/lib/ceedling/preprocessinator_file_handler.rb:14:in `preprocess_file'\nC:/Users/davidfallah/Documents/IAR Projects/blinky/vendor/ceedling/lib/ceedling/preprocessinator.rb:40:in `preprocess_file'\nC:/Users/davidfallah/Documents/IAR Projects/blinky/vendor/ceedling/lib/ceedling/preprocessinator.rb:12:in `block in setup'\nC:/Users/davidfallah/Documents/IAR Projects/blinky/vendor/ceedling/lib/ceedling/preprocessinator_helper.rb:33:in `preprocess_test_file'\nC:/Users/davidfallah/Documents/IAR Projects/blinky/vendor/ceedling/lib/ceedling/preprocessinator.rb:25:in `preprocess_test_and_invoke_test_mocks'\nC:/Users/davidfallah/Documents/IAR Projects/blinky/vendor/ceedling/lib/ceedling/test_invoker.rb:42:in `block in setup_and_invoke'\nC:/Users/davidfallah/Documents/IAR Projects/blinky/vendor/ceedling/lib/ceedling/test_invoker.rb:32:in `setup_and_invoke'\nC:/Users/davidfallah/Documents/IAR Projects/blinky/vendor/ceedling/lib/ceedling/tasks_tests.rake:11:in `block (2 levels) in &lt;top (required)&gt;'\nTasks: TOP =&gt; default =&gt; test:all\n(See full trace by running task with --trace)\n\n--------------------\nOVERALL TEST SUMMARY\n--------------------\n\nNo tests executed.\n</code></pre>\n\n<p>I assume this is because the test file preprocessor should be copying test files under the <code>build/test/preprocess/files</code> directory, which currently doesn't happen.</p>\n\n<p>After a bit of digging around I found this <a href=\"https://docs.omniref.com/ruby/gems/ceedling/0.16.0/files/vendor/unity/test/targets/iar_cortexm3_v5.yml#line=29\" rel=\"nofollow noreferrer\">example configuration file for Unity</a> that looks like it may be helpful. It's geared towards an IAR EW/Cortex M3 environment like the one I'm using. This may give some indication of what configuration options I need to specify in my Ceedling <code>project.yml</code>:</p>\n\n<p>If I can get Ceedling to build and test the <code>blinky</code> project using an IAR toolchain, I'm hoping I can adapt it to work with my actual project. Any help would be appreciated.</p>\n"}, {"tags": ["c", "svn", "doxygen"], "comments": [{"owner": {"reputation": 635, "user_id": 2010398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GnCdn.png?s=128&g=1", "display_name": "gmug", "link": "https://stackoverflow.com/users/2010398/gmug"}, "edited": false, "score": 1, "creation_date": 1483694454, "post_id": 41140136, "comment_id": 70210089, "body": "Most IDEs support file templates in which you can add the <code>\\file</code> tag. So if a file is created in the IDE the <code>\\file</code> tag is automatically added."}, {"owner": {"reputation": 1698, "user_id": 2214806, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/RgdBJ.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/2214806/michael"}, "edited": false, "score": 0, "creation_date": 1484093762, "post_id": 41140136, "comment_id": 70366367, "body": "Alternately... is the problem fixed if you change to document all (<code>EXTRACT_ALL = YES</code>)?  Is this why it is ignoring the files?"}], "owner": {"reputation": 768, "user_id": 2668213, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/mPlL3.jpg?s=128&g=1", "display_name": "Federico Destefanis", "link": "https://stackoverflow.com/users/2668213/federico-destefanis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481735709, "creation_date": 1481710944, "last_edit_date": 1481735709, "question_id": 41140136, "link": "https://stackoverflow.com/questions/41140136/enforce-c-source-documentation-in-svn-precommit-hook-using-doxygen", "title": "enforce c source documentation in svn precommit hook using doxygen", "body": "<p>As the title suggests, I want to enforce source code documentation for a C project managed in Subversion.</p>\n\n<p>My idea is: set up a pre-commit hook that use doxygen for checking files with this options</p>\n\n<pre><code>   WARNINGS              = YES\n   WARN_IF_UNDOCUMENTED  = YES\n   WARN_IF_DOC_ERROR     = YES\n   WARN_NO_PARAMDOC      = YES\n</code></pre>\n\n<p>The problem is: in order to have doxygen take into account a source file and raise warnings for undocumented members, It seems I must put into that file the \"\\file\" documentation block as you see below. </p>\n\n<pre><code>/** \\file foo.h\n * A file for testing how to enforce documentation\n *\n * if I don't put voluntarily this first \"file\" block, \n * doxygen \"ignores\" the file and does not generate the warnings\n * I would expect (note that otherfunction is not documented)\n */\n\n\n#ifndef FOO_H_\n#define FOO_H_\n\n\n/**\n* \\brief my test function \n* \\param msg a simple string\n* \\return 0 if ok, 1 if not ok\n*/\nint testFunction(const char *msg);\n\n\n\nint otherFunction(const char *msg);\n\n#endif\n</code></pre>\n\n<p>If I don't doxygen \"ignores\" the file and no warning is raised.\nThis makes the check uneffective: users can easily forget to put the required block at the beginning of the source and commit without control.</p>\n\n<p>Is there a way to make doxygen enforce the /file block in the beginning of the file?</p>\n"}, {"tags": ["c++", "c", "gcc", "assembly", "reverse-engineering"], "comments": [{"owner": {"reputation": 719, "user_id": 3944257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b6137f4fc597c673775e63728188088?s=128&d=identicon&r=PG&f=1", "display_name": "Frodo", "link": "https://stackoverflow.com/users/3944257/frodo"}, "edited": false, "score": 0, "creation_date": 1481711953, "post_id": 41140089, "comment_id": 69483636, "body": "Maybe the <a href=\"https://godbolt.org/g/OyxeLq\" rel=\"nofollow noreferrer\">Godbolt</a>-Tool can help you for your analysis."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7295860"}, "reply_to_user": {"reputation": 719, "user_id": 3944257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b6137f4fc597c673775e63728188088?s=128&d=identicon&r=PG&f=1", "display_name": "Frodo", "link": "https://stackoverflow.com/users/3944257/frodo"}, "edited": false, "score": 0, "creation_date": 1481712137, "post_id": 41140089, "comment_id": 69483751, "body": "I&#39;m using Godbolt. This assembly is generated on Godbolt :)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7295860"}, "edited": false, "score": 0, "creation_date": 1481715899, "post_id": 41140699, "comment_id": 69486031, "body": "If this first three line is necessary for save information, why 64-bit code uses the same thing? (view edited post)"}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1481716368, "post_id": 41140699, "comment_id": 69486313, "body": "@J.Doe What same thing? The 64-bit code has a standard prolog."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7295860"}, "edited": false, "score": 0, "creation_date": 1481716561, "post_id": 41140699, "comment_id": 69486439, "body": "Why 64-bit mode don&#39;t saves original ESP as in 32-bit mode?"}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 3, "creation_date": 1481716932, "post_id": 41140699, "comment_id": 69486681, "body": "@J.Doe Because the ABI for 64 bit imposes that at the start of a function the stack is at 16B+8, while for 32 bit this is not true for <code>main</code>. Knowing the initial state of the stack pointer let the compiler omit the <code>and</code> instruction and use instead pushes and arithmetic on <code>rsp</code>. The <code>and</code> is not reversible and thus the original state must be saved. The push/arithmetic is reversible and the original state is restored in the prolog."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7295860"}, "edited": false, "score": 0, "creation_date": 1481717652, "post_id": 41140699, "comment_id": 69487115, "body": "sorry for my newbie questions :d :)  what is ABI and what&#39;s mean 16B+8?"}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 1, "creation_date": 1481718488, "post_id": 41140699, "comment_id": 69487648, "body": "@J.Doe Yes, that&#39;s the ABI, there should be links to the PDF docs (or you can Google the keywords). 16B+X means an address that is X bytes after a multiple of 16. For example 16B+8 can be 8 (16*0+8) or 24 (16*1+8) or 40 (16*2+8) and so on."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1481748301, "post_id": 41140699, "comment_id": 69505849, "body": "@J.Doe: links to ABI docs in the <a href=\"http://stackoverflow.com/tags/x86/info\">x86 tag wiki</a>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1481748392, "post_id": 41140699, "comment_id": 69505907, "body": "gcc does that weird R/ECX or R10 thing when aligning the stack to 32B even in 64-bit code, when using <code>__m256</code>.  I still have no idea what that&#39;s about.  Maybe I should ask an SO question about it vs. clang&#39;s technique, since I think clang is different."}], "tags": [], "owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "is_accepted": true, "score": 8, "last_activity_date": 1481712532, "creation_date": 1481712532, "answer_id": 41140699, "question_id": 41140089, "link": "https://stackoverflow.com/questions/41140089/gcc-generated-assembly/41140699#41140699", "title": "GCC generated assembly", "body": "<p>The insight is that the compiler keep the stack aligned at function calls.<br>\nThe alignment is 16 byte.  </p>\n\n<pre><code>lea     ecx, [esp+4]           ;Save original ESP to ECX (ESP+4 actually)\nand     esp, -16               ;Align stack on 16 bytes (Lower esp)\n\npush    DWORD PTR [ecx-4]      ;Push main return address (Stack at 16B + 4)\n                               ;My guess is to aid debugging tools that expect the RA\n                               ;to be at [ebp+04h]\npush    ebp\nmov     ebp, esp               ;Prolog (Stack at 16B+8)\n\npush    ecx                    ;Save ECX (Original stack pointer) (Stack at 16B+12)\n\nsub     esp, 20                ;Reserve 20 bytes (Stack at 16B+0, ALIGNED AGAIN)\n                               ;4 for alignment + 1x16 for a variable (variable space is\n                               ;allocated in multiple of 16)\n\nmov     DWORD PTR [ebp-12], 11 ;a = 11\n\nsub     esp, 8                 ;Stack at 16B+8 for later alignment\npush    DWORD PTR [ebp-12]     ;a\npush    OFFSET FLAT:.LC0       ;\"%d\"     (Stack at 16B)\ncall    printf\nadd     esp, 16                ;Remove args+pad from the stack (Stack at 16B)\n\nmov     eax, 0                 ;Return 0\n\nmov     ecx, DWORD PTR [ebp-4] ;Restore ECX without the need to add to esp\nleave                          ;Restore EBP\n\nlea     esp, [ecx-4]           ;Restore original ESP\nret\n</code></pre>\n\n<p>I don't know why the compiler saves <code>esp+4</code> in <code>ecx</code> instead of <code>esp</code> (<code>esp+4</code> is the address of the first parameter of <code>main</code>).  </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7295860"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "accepted_answer_id": 41140699, "answer_count": 1, "score": 7, "last_activity_date": 1514730992, "creation_date": 1481710809, "last_edit_date": 1481715752, "question_id": 41140089, "link": "https://stackoverflow.com/questions/41140089/gcc-generated-assembly", "title": "GCC generated assembly", "body": "<p>Why printf function causes the change of prologue?</p>\n\n<p>C code_1:</p>\n\n<pre><code>#include &lt;cstdio&gt;\n\nint main(){\n  int a = 11;\n  printf(\"%d\", a);\n}\n</code></pre>\n\n<p>GCC -m32 generated one:</p>\n\n<pre><code>.LC0:\n        .string \"%d\"\nmain:\n        lea     ecx, [esp+4]           // What's purpose of this three\n        and     esp, -16               // lines?\n        push    DWORD PTR [ecx-4]      // \n        push    ebp\n        mov     ebp, esp\n        push    ecx\n        sub     esp, 20                // why sub 20?\n        mov     DWORD PTR [ebp-12], 11\n        sub     esp, 8\n        push    DWORD PTR [ebp-12]\n        push    OFFSET FLAT:.LC0\n        call    printf\n        add     esp, 16\n        mov     eax, 0\n        mov     ecx, DWORD PTR [ebp-4]\n        leave\n        lea     esp, [ecx-4]\n        ret\n</code></pre>\n\n<p>C code_2:</p>\n\n<pre><code>#include &lt;cstdio&gt;\n\nint main(){\n  int a = 11;\n}\n</code></pre>\n\n<p>GCC -m32:</p>\n\n<pre><code>main:\n        push    ebp\n        mov     ebp, esp\n        sub     esp, 16\n        mov     DWORD PTR [ebp-4], 11\n        mov     eax, 0\n        leave\n        ret\n</code></pre>\n\n<p>What is the purpose of first three lines added in first code?\nPlease, explain first assembly code, if you can.</p>\n\n<p>EDIT:</p>\n\n<p>64-bit mode:</p>\n\n<pre><code>.LC0:\n        .string \"%d\"\nmain:\n        push    rbp\n        mov     rbp, rsp\n        sub     rsp, 16\n        mov     DWORD PTR [rbp-4], 11\n        mov     eax, DWORD PTR [rbp-4]\n        mov     esi, eax\n        mov     edi, OFFSET FLAT:.LC0\n        mov     eax, 0\n        call    printf\n        mov     eax, 0\n        leave\n        ret\n</code></pre>\n"}, {"tags": ["ios", "c", "xml", "swift", "libxml2"], "answers": [{"comments": [{"owner": {"reputation": 3281, "user_id": 6808319, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d9314641b8d5132a63d011fd051a199?s=128&d=identicon&r=PG&f=1", "display_name": "ElegyD", "link": "https://stackoverflow.com/users/6808319/elegyd"}, "edited": false, "score": 0, "creation_date": 1482413895, "post_id": 41262990, "comment_id": 69770555, "body": "Yeah, it was the off-by-one error. Much thanks that you found this. But now i have another problem. I&#39;ve updated my question. Maybe you know a solution for this? Or maybe you have a tutorial how to use the XmlTextReader for iOS (Swift (3) or Obj-C)?"}, {"owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "reply_to_user": {"reputation": 3281, "user_id": 6808319, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d9314641b8d5132a63d011fd051a199?s=128&d=identicon&r=PG&f=1", "display_name": "ElegyD", "link": "https://stackoverflow.com/users/6808319/elegyd"}, "edited": false, "score": 0, "creation_date": 1482422246, "post_id": 41262990, "comment_id": 69776152, "body": "@ElegyD If you have a different problem, it&#39;s better to ask a separate question."}], "tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": true, "score": 0, "last_activity_date": 1482324402, "last_edit_date": 1482324402, "creation_date": 1482323843, "answer_id": 41262990, "question_id": 41140050, "link": "https://stackoverflow.com/questions/41140050/parsing-large-xml-from-server-while-downloading-with-libxml2-in-swift-3/41262990#41262990", "title": "Parsing large XML from server while downloading with LibXML2 in Swift 3", "body": "<p>Seems like a simple off-by-one error. To iterate the attributes array in C, I'd write something like:</p>\n\n<pre><code>for (int i = 0; i &lt; nb_attributes; i++)\n</code></pre>\n\n<p>But you're using the <a href=\"https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/BasicOperators.html#//apple_ref/doc/uid/TP40014097-CH6-ID74\" rel=\"nofollow noreferrer\">closed range operator</a> which includes the upper bound:</p>\n\n<pre><code>for i in 0...Int(nb_attributes)\n</code></pre>\n\n<p>So you should use the <a href=\"https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/BasicOperators.html#//apple_ref/doc/uid/TP40014097-CH6-ID75\" rel=\"nofollow noreferrer\">half-open range operator</a> instead:</p>\n\n<pre><code>for i in 0..&lt;Int(nb_attributes)\n</code></pre>\n\n<p>By the way, <em>libxml2</em> also has a <a href=\"http://xmlsoft.org/xmlreader.html\" rel=\"nofollow noreferrer\">pull parser interface</a> modeled after C#'s <code>XmlTextReader</code> which is much easier to use than the SAX parser.</p>\n"}], "owner": {"reputation": 3281, "user_id": 6808319, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d9314641b8d5132a63d011fd051a199?s=128&d=identicon&r=PG&f=1", "display_name": "ElegyD", "link": "https://stackoverflow.com/users/6808319/elegyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 3, "accepted_answer_id": 41262990, "answer_count": 1, "score": 7, "last_activity_date": 1484299813, "creation_date": 1481710694, "last_edit_date": 1495541436, "question_id": 41140050, "link": "https://stackoverflow.com/questions/41140050/parsing-large-xml-from-server-while-downloading-with-libxml2-in-swift-3", "title": "Parsing large XML from server while downloading with LibXML2 in Swift 3", "body": "<p>I have a Problem with the SAX parser from LibXML2 in Swift 3.<br>\nI want something like <code>XMLPullParser</code> from Android in iOS. Which downloads XML from a server and while downloading it parses the Stream.  </p>\n\n<p>My XML looks like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;ResultList id=\"12345678-0\" platforms=\"A;B;C;D;E\"&gt;\n    &lt;Book id=\"1111111111\" author=\"Author A\" title=\"Title A\" price=\"9.95\" ... /&gt;\n    &lt;Book id=\"1111111112\" author=\"Author B\" title=\"Title B\" price=\"2.00\" ... /&gt;\n    &lt;Book id=\"1111111113\" author=\"Author C\" title=\"Title C\" price=\"5.00\" ... /&gt;\n    &lt;ResultInfo bookcount=\"3\" /&gt;\n&lt;/ResultList&gt;\n</code></pre>\n\n<p>So all the data is stored in attributes rather than child nodes.</p>\n\n<p>I've made the following class by myself mostly based by these examples:<br>\n<a href=\"https://developer.apple.com/library/content/samplecode/XMLPerformance/Introduction/Intro.html\" rel=\"nofollow noreferrer\">XMLPerformance</a>, <a href=\"https://github.com/FTS-InfoTech/XMLPerformance-Swift\" rel=\"nofollow noreferrer\">XMLPerformance-Swift</a> and <a href=\"https://github.com/robertmryan/iOS-XML-Streaming-w-Base64-Decode\" rel=\"nofollow noreferrer\">iOS-XML-Streaming</a></p>\n\n<pre><code>import Foundation\n\nclass LibXMLParser: NSObject, URLSessionDataDelegate {\n\n    var url: URL?\n    var delegate: LibXMLParserDelegate?\n    var done = false\n    var context: xmlParserCtxtPtr?\n\n    var simpleSAXHandlerStruct: xmlSAXHandler = {\n        var handler = xmlSAXHandler()\n\n        handler.initialized = XML_SAX2_MAGIC\n        handler.startElementNs = startElementSAX\n        handler.endElementNs = endElementSAX\n        handler.characters = charactersFoundSAX\n        //handler.error = errorEncounteredSAX\n\n        return handler\n    }()\n\n    init(url: URL) {\n        super.init()\n\n        self.url = url\n    }\n\n    func parse() {\n        self.done = false\n        let session = URLSession(configuration: .default, delegate: self, delegateQueue: OperationQueue.main)\n        let dataTask = session.dataTask(with: URLRequest(url: url!))\n        dataTask.resume()\n\n        self.context = xmlCreatePushParserCtxt(&amp;simpleSAXHandlerStruct, Unmanaged.passUnretained(self).toOpaque(), nil, 0, nil)\n        self.delegate?.parserDidStartDocument()\n\n        repeat {\n            RunLoop.current.run(mode: .defaultRunLoopMode, before: Date.distantFuture)\n        } while !self.done\n\n        xmlFreeParserCtxt(self.context)\n        self.delegate?.parserDidEndDocument()\n    }\n\n    func urlSession(_ session: URLSession, dataTask: URLSessionDataTask, didReceive data: Data) {\n        print(\"Did receive data\")\n        data.withUnsafeBytes { (bytes: UnsafePointer&lt;CChar&gt;) -&gt; Void in\n            xmlParseChunk(self.context, bytes, CInt(data.count), 0)\n        }\n    }\n\n    func urlSessionDidFinishEvents(forBackgroundURLSession session: URLSession) {\n        xmlParseChunk(self.context, nil, 0, 1)\n        self.done = true\n    }\n\n    func urlSession(_ session: URLSession, didBecomeInvalidWithError error: Error?) {\n        self.done = true\n        //self.delegate?.parserErrorOccurred(error)\n    }\n\n    func urlSession(_ session: URLSession, task: URLSessionTask, didCompleteWithError error: Error?) {\n        self.done = true\n        //self.delegate?.parserErrorOccurred(error)\n    }\n}\n\nprivate func startElementSAX(_ ctx: UnsafeMutableRawPointer?, name: UnsafePointer&lt;xmlChar&gt;?, prefix: UnsafePointer&lt;xmlChar&gt;?, URI: UnsafePointer&lt;xmlChar&gt;?, nb_namespaces: CInt, namespaces: UnsafeMutablePointer&lt;UnsafePointer&lt;xmlChar&gt;?&gt;?, nb_attributes: CInt, nb_defaulted: CInt, attributes: UnsafeMutablePointer&lt;UnsafePointer&lt;xmlChar&gt;?&gt;?) {\n    let parser = Unmanaged&lt;LibXMLParser&gt;.fromOpaque(ctx!).takeUnretainedValue()\n    parser.delegate?.parserDidStartElement(String(cString: name!), nb_attributes: nb_attributes, attributes: attributes)\n}\n\nprivate func endElementSAX(_ ctx: UnsafeMutableRawPointer?, name: UnsafePointer&lt;xmlChar&gt;?,\n                           prefix: UnsafePointer&lt;xmlChar&gt;?,\n                           URI: UnsafePointer&lt;xmlChar&gt;?) {\n    let parser = Unmanaged&lt;LibXMLParser&gt;.fromOpaque(ctx!).takeUnretainedValue()\n    parser.delegate?.parserDidEndElement(String(cString: name!))\n}\n\nprivate func charactersFoundSAX(_ ctx: UnsafeMutableRawPointer?, ch: UnsafePointer&lt;xmlChar&gt;?, len: CInt) {\n    let parser = Unmanaged&lt;LibXMLParser&gt;.fromOpaque(ctx!).takeUnretainedValue()\n    parser.delegate?.parserFoundCharacters(String(cString: ch!))\n}\n</code></pre>\n\n<p>I initialize this class with an <code>URL</code>. When i call <code>parse()</code> it creates a <code>URLSession</code> and a <code>URLSessionDataTask</code> with an delegate to self to override the method <code>didReceive data: Data</code>.\nAfter that i create a <code>xmlParserCtxtPtr</code> and loop until the dataTask is finished.</p>\n\n<p>When it receives data I parse it with the <code>xmlParseChunk</code> method and <code>startElementSAX</code> calls the delegate that I've set from a ViewController class. (I just need the element name, number of attributes and attributes.)<br>\nSo far so good.</p>\n\n<p>In my ViewController (UITableViewController) I have the following code:</p>\n\n<pre><code>func downloadBooksLibXML() {\n    print(\"Downloading\u2026\")\n    UIApplication.shared.isNetworkActivityIndicatorVisible = true\n\n    DispatchQueue.global().async {\n        print(\"Setting up parser\")\n        let parser = LibXMLParser(url: URL(string: self.baseUrl + self.parameters!)!)\n        parser.delegate = self\n        parser.parse()\n    }\n}\n\nfunc parserDidStartDocument() {\n\n}\n\nfunc parserDidEndDocument() {\n    DispatchQueue.main.sync {\n        UIApplication.shared.isNetworkActivityIndicatorVisible = false\n        self.isDone = true\n        print(\"Finished\")\n    }\n}\n\nfunc parserDidStartElement(_ elementName: String, nb_attributes: CInt, attributes: UnsafeMutablePointer&lt;UnsafePointer&lt;xmlChar&gt;?&gt;?) {\n    print(elementName)\n    switch elementName {\n    case \"Book\":\n        DispatchQueue.main.async {\n            let book = self.buildBook(nb_attributes: nb_attributes, attributes: attributes)\n            self.books.append(book)\n\n            self.tableView.beginUpdates()\n            self.tableView.insertRows(at: [IndexPath(row: self.books.count - 1, section: 0)], with: .automatic)\n            self.tableView.endUpdates()\n            self.navigationItem.title = String(format: NSLocalizedString(\"books_found\", comment: \"Books found\"), \"\\(self.books.count)\")\n        }\n    case \"ResultList\":\n        break\n    case \"ResultInfo\":\n        break\n    default:\n        break\n    }\n}\n\nfunc buildBook(nb_attributes: CInt, attributes: UnsafeMutablePointer&lt;UnsafePointer&lt;xmlChar&gt;?&gt;?) -&gt; Book {\n    let fields = 5 /* (localname/prefix/URI/value/end) */\n    let book = Book()\n    for i in 0..&lt;Int(nb_attributes) {\n        if let localname = attributes?[i * fields + 0],\n            //let prefix = attributes?[i * fields + 1],\n            //let URI = attributes?[i * fields + 2],\n            let value_start = attributes?[i * fields + 3],\n            let value_end = attributes?[i * fields + 4] {\n\n            let localnameString = String(cString: localname)\n            let string_start = String(cString: value_start)\n            let string_end = String(cString: value_end)\n            let diff = string_start.characters.count - string_end.characters.count\n            if diff &gt; 0 {\n                let value = string_start.substring(to: string_start.index(string_start.startIndex, offsetBy: diff))\n                book.setValue(value, forKey: localnameString)\n            }\n        }\n    }\n    return book\n}\n\nfunc parserDidEndElement(_ elementName: String) {\n\n}\n\nfunc parserFoundCharacters(_ string: String) {\n\n}\n\nfunc parserErrorOccurred(_ parseError: Error?) {\n\n}\n</code></pre>\n\n<h1>------</h1>\n\n<h1>Update</h1>\n\n<p>So the problem getting the attribute values has been fixed by the answer from nwellnhof. I've updated my code above to a much better code. It doesn't iterate through all the attributes now anymore.\nNow my new problem:</p>\n\n<p>I've created the method <code>buildBook</code> to get a <code>Book</code> object of the XML attributes.\nI've mostly translated the method from here <a href=\"https://stackoverflow.com/a/25688162/6808319\">What is the right way to get attribute value in libXML sax parser (C++)?</a> to Swift and used <code>setValue(value: Any?, forKey: String)</code> to set the attributes of my book object.</p>\n\n<p>But now my problem is that it doesn't update the tableView.\nI've tried executing the <code>buildBook</code> method synchronous in a background thread using <code>DispatchQueue.global().sync</code> and the tableView update in an asynchronous main thread using <code>DispatchQueue.main.async</code>. But then it crashes at <code>tableView.endUpdates()</code> although it's in the main thread.</p>\n\n<h1>------</h1>\n\n<p>Any help would be highly appreciated.</p>\n"}, {"tags": ["c", "uefi"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1481710840, "post_id": 41139714, "comment_id": 69482966, "body": "Interesting detail is also the <code>#define</code> and <code>#undef</code> around <code>#include</code>. It would suggest that header uses <code>#define</code> instead of <code>typedef</code>, which might clue that there are also other WTFs in the code. That could explain the passive aggressive tone of the comment..."}], "answers": [{"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1481710453, "post_id": 41139955, "comment_id": 69482729, "body": "It can even kick you repeatedly, depending on your compiler settings"}, {"owner": {"reputation": 774, "user_id": 2752467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81593fbaf44886f58c1a35b2c2de371f?s=128&d=identicon&r=PG&f=1", "display_name": "user2752467", "link": "https://stackoverflow.com/users/2752467/user2752467"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1481738271, "post_id": 41139955, "comment_id": 69500569, "body": "@StoryTeller Javascript also has this feature. <a href=\"http://softwareengineering.stackexchange.com/a/11812/168891\">softwareengineering.stackexchange.com/a/11812/168891</a>"}, {"owner": {"reputation": 774, "user_id": 2752467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81593fbaf44886f58c1a35b2c2de371f?s=128&d=identicon&r=PG&f=1", "display_name": "user2752467", "link": "https://stackoverflow.com/users/2752467/user2752467"}, "edited": false, "score": 0, "creation_date": 1481738342, "post_id": 41139955, "comment_id": 69500607, "body": "I&#39;m not sure I understand correctly. If you do this, what types <i>can</i> <code>*EFI_HANDLE</code> now point to?"}, {"owner": {"reputation": 779, "user_id": 2379079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hyI9I.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/2379079/alex"}, "reply_to_user": {"reputation": 774, "user_id": 2752467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81593fbaf44886f58c1a35b2c2de371f?s=128&d=identicon&r=PG&f=1", "display_name": "user2752467", "link": "https://stackoverflow.com/users/2752467/user2752467"}, "edited": false, "score": 0, "creation_date": 1481738695, "post_id": 41139955, "comment_id": 69500773, "body": "@JustinLardinois It points to a structure. It&#39;s a very well know concept called handle paradigm! It&#39;s all done for 2 reasons - type safety (verification at compilation time), and abstraction (like in OOP to separate internals from the interface);"}, {"owner": {"reputation": 774, "user_id": 2752467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81593fbaf44886f58c1a35b2c2de371f?s=128&d=identicon&r=PG&f=1", "display_name": "user2752467", "link": "https://stackoverflow.com/users/2752467/user2752467"}, "reply_to_user": {"reputation": 779, "user_id": 2379079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hyI9I.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/2379079/alex"}, "edited": false, "score": 0, "creation_date": 1481760005, "post_id": 41139955, "comment_id": 69510428, "body": "@Alex Am I understanding right then that a pointer to an unnamed <code>struct</code> type can point to any <code>struct</code> type? I tried googling &quot;c handle paradigm&quot; but didn&#39;t find any results on a concept with that name."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 774, "user_id": 2752467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81593fbaf44886f58c1a35b2c2de371f?s=128&d=identicon&r=PG&f=1", "display_name": "user2752467", "link": "https://stackoverflow.com/users/2752467/user2752467"}, "edited": false, "score": 0, "creation_date": 1481760566, "post_id": 41139955, "comment_id": 69510594, "body": "@JustinLardinois A pointer of non-void pointer type cannot be assigned an address unless an explicit cast is involved. Only <code>void*</code> implicitly casts to, and from, other arbitrary pointer types. The library authors, no doubt, have their own structure of data they use these &quot;handles&quot; to address by their own casts.  What the address held within actually refers to isn&#39;t really important to you (and that is somewhat the point of all this). By using that struct typedef, it is no longer possible to pass an EFI_HANDLE to anything expecting something besides an EFI_HANDLE (like I did) without a cast."}, {"owner": {"reputation": 779, "user_id": 2379079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hyI9I.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/2379079/alex"}, "reply_to_user": {"reputation": 774, "user_id": 2752467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81593fbaf44886f58c1a35b2c2de371f?s=128&d=identicon&r=PG&f=1", "display_name": "user2752467", "link": "https://stackoverflow.com/users/2752467/user2752467"}, "edited": false, "score": 0, "creation_date": 1481777823, "post_id": 41139955, "comment_id": 69514907, "body": "@JustinLardinois Compiler will give you a warning &quot;incompatible types&quot; and that is exactly the goal to get that warning. You of course can cast it but that&#39;s a different story because when you casted it means that you know what you are doing!"}, {"owner": {"reputation": 779, "user_id": 2379079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hyI9I.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/2379079/alex"}, "reply_to_user": {"reputation": 774, "user_id": 2752467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81593fbaf44886f58c1a35b2c2de371f?s=128&d=identicon&r=PG&f=1", "display_name": "user2752467", "link": "https://stackoverflow.com/users/2752467/user2752467"}, "edited": false, "score": 0, "creation_date": 1481777927, "post_id": 41139955, "comment_id": 69514933, "body": "@JustinLardinois Oh and btw, I forgot to add, google for opaque pointer or opaque structure in c."}, {"owner": {"reputation": 774, "user_id": 2752467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81593fbaf44886f58c1a35b2c2de371f?s=128&d=identicon&r=PG&f=1", "display_name": "user2752467", "link": "https://stackoverflow.com/users/2752467/user2752467"}, "edited": false, "score": 0, "creation_date": 1481826982, "post_id": 41139955, "comment_id": 69542409, "body": "Ah, I see. I didn&#39;t catch from reading this answer that the point was to do an explicit cast."}], "tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 19, "last_activity_date": 1481711298, "last_edit_date": 1481711298, "creation_date": 1481710350, "answer_id": 41139955, "question_id": 41139714, "link": "https://stackoverflow.com/questions/41139714/use-of-redefining-void-pointer-to-pointer-to-an-anonymous-structure/41139955#41139955", "title": "Use of redefining void pointer to pointer to an anonymous structure?", "body": "<p>The library is using <em>information hiding</em> on the internal data object behind the address held in an EFI_HANDLE. But in doing so, they're making the code <em>more</em> susceptible to accidental bugs.</p>\n\n<p>In C, <code>void*</code> is transparently cast to <em>any</em> other non-<code>void*</code> non-const data pointer type <em>without warning</em> (it's by language design). </p>\n\n<p>Using a non-void pointer type ensures an <code>EFI_HANDLE</code> is only used where <code>EFI_HANDLE</code> belongs. The compiler's type-checking kicks you in the groin when you pass it somewhere else that isn't <code>EFI_HANDLE</code> , but rather a pointer to something else. </p>\n\n<p>Ex: As <code>void*</code>, this will compile without warning or error</p>\n\n<pre><code>#include &lt;string.h&gt;\n\n#define EFI_HANDLE void*\n\nint main()\n{\n    EFI_HANDLE handle = NULL;\n\n    strcpy(handle, \"Something\");\n}\n</code></pre>\n\n<p>Changing the alias to:</p>\n\n<pre><code>typedef struct {} *EFI_HANDLE;\n</code></pre>\n\n<p>will reap the ensuing \"incompatible pointer type\" compile-time error.</p>\n\n<p>Finally, as an anonymous struct, there is no pointless structure tag name adding to the already-polluted name space that you can use (accidently or nefariously).</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 2, "creation_date": 1481728902, "post_id": 41141138, "comment_id": 69494668, "body": "Worth mentioning is that in older versions of the C standard, &quot;anonymous structure&quot; did not exist as a separate term. For those versions, &quot;anonymous&quot; would just be interpreted as the ordinary English word meaning &quot;without a name&quot;, which for structure types seems perfectly fair to interpret as &quot;without a tag&quot;."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 7, "last_activity_date": 1481726338, "last_edit_date": 1481726338, "creation_date": 1481713852, "answer_id": 41141138, "question_id": 41139714, "link": "https://stackoverflow.com/questions/41139714/use-of-redefining-void-pointer-to-pointer-to-an-anonymous-structure/41141138#41141138", "title": "Use of redefining void pointer to pointer to an anonymous structure?", "body": "<p>That isn't an anonymous structure, but a struct without a tag.</p>\n\n<p>An anonymous structure can only exist as a member of another struct,<br>\nand it must also not have a tag<sup>1</sup>. </p>\n\n<p>Defining a struct without any members is not allowed. The code you're looking at is using a compiler extension that permits this.</p>\n\n<p>The library is doing this to hide the definition of the structure from the user, while maintaining type safety. </p>\n\n<p>However there is a much better way to do this. If you have a hidden structure definition, you can still define an opaque pointer to it, that has a type, so it is type safe:</p>\n\n<pre><code>struct hidden    //defined in a file and not exposed\n{\n    int a;\n};\n</code></pre>\n\n<p></p>\n\n<pre><code>void Hidden( struct hidden* );\nvoid Other( struct other* );\nstruct hidden* a = NULL;    //doesn't see the definition of struct hidden\nHidden( a );    //it may be used \nOther( a );    //compiler error\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup> (Quoted from: ISO/IEC 9899:201x 6.7.2.1 Structure and union specifiers 13)<br>\nAn unnamed member whose type specifier is a structure specifier with no tag is called an\nanonymous structure; an unnamed member whose type specifier is a union specifier with\nno tag is called an anonymous union. The members of an anonymous structure or union\nare considered to be members of the containing structure or union. This applies\nrecursively if the containing structure or union is also anonymous  </p>\n"}], "owner": {"reputation": 1180, "user_id": 4233968, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/34a8a28a578ed988cb3b7800cc79a867?s=128&d=identicon&r=PG&f=1", "display_name": "achoora", "link": "https://stackoverflow.com/users/4233968/achoora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 1, "accepted_answer_id": 41139955, "answer_count": 2, "score": 17, "last_activity_date": 1481726338, "creation_date": 1481709715, "last_edit_date": 1481720665, "question_id": 41139714, "link": "https://stackoverflow.com/questions/41139714/use-of-redefining-void-pointer-to-pointer-to-an-anonymous-structure", "title": "Use of redefining void pointer to pointer to an anonymous structure?", "body": "<p>I was working with <a href=\"http://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface\" rel=\"nofollow noreferrer\">UEFI</a> driver-related code, and I came across this:</p>\n\n<pre><code>/* EFI headers define EFI_HANDLE as a void pointer, which renders type\n* checking somewhat useless. Work around this bizarre sabotage\n* attempt by redefining EFI_HANDLE as a pointer to an anonymous\n* structure.\n*/\n#define EFI_HANDLE STUPID_EFI_HANDLE\n#include &lt;ipxe/efi/Uefi/UefiBaseType.h&gt;\n#undef EFI_HANDLE\ntypedef struct {} *EFI_HANDLE;\n</code></pre>\n\n<p>The full source code is in this path\n<a href=\"http://dox.ipxe.org/include_2ipxe_2efi_2efi_8h_source.html\" rel=\"nofollow noreferrer\">http://dox.ipxe.org/include_2ipxe_2efi_2efi_8h_source.html</a></p>\n\n<p>This is my first encounter with anonymous structure, and I couldn't make out the logic of redefining a <code>void *</code> to a pointer to an anonymous structure. What kind of a hack the \"bizzare sabotage attempt\" hints at?</p>\n"}, {"tags": ["c", "windows", "winapi", "ip"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1481709446, "post_id": 41139561, "comment_id": 69482122, "body": "The code above is for Linux and similar operating systems - to do the same thing on Windows you&#39;ll need to look at MSDN to find Microsoft&#39;s equivalent API."}, {"owner": {"reputation": 3699, "user_id": 474173, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/18331a42eeb0683a21fe3af6722c04cc?s=128&d=identicon&r=PG", "display_name": "Swanand", "link": "https://stackoverflow.com/users/474173/swanand"}, "edited": false, "score": 2, "creation_date": 1481709621, "post_id": 41139561, "comment_id": 69482238, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/5114305/how-to-get-the-ip-address-under-windows\">How to get the ip address under Windows</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481709670, "post_id": 41139561, "comment_id": 69482270, "body": "Maybe <a href=\"http://stackoverflow.com/questions/122208/get-the-ip-address-of-local-computer\">this SO question</a> helps."}, {"owner": {"reputation": 25, "user_id": 6464294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-MaOGVnJoZMQ/AAAAAAAAAAI/AAAAAAAAACA/UezqocAsdDA/photo.jpg?sz=128", "display_name": "Niks Arora", "link": "https://stackoverflow.com/users/6464294/niks-arora"}, "edited": false, "score": 0, "creation_date": 1481710009, "post_id": 41139561, "comment_id": 69482480, "body": "swanand that question is using linux code as including net/if.h  ."}], "answers": [{"tags": [], "owner": {"reputation": 6306, "user_id": 5662469, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZYgSJ.png?s=128&g=1", "display_name": "Deepak K Gupta", "link": "https://stackoverflow.com/users/5662469/deepak-k-gupta"}, "is_accepted": false, "score": -2, "last_activity_date": 1520735190, "last_edit_date": 1520735190, "creation_date": 1481710914, "answer_id": 41140126, "question_id": 41139561, "link": "https://stackoverflow.com/questions/41139561/find-ip-address-of-the-machine-in-c/41140126#41140126", "title": "Find IP address of the machine in C?", "body": "<p>The structure </p>\n\n<pre><code>struct ifaddrs *id;\n</code></pre>\n\n<p>is a linked list. You have to loop through it and check the existence of the address </p>\n\n<pre><code>if(id-&gt;fa_addr)\n   // print statements\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1481745795, "last_edit_date": 1481745795, "creation_date": 1481745433, "answer_id": 41151132, "question_id": 41139561, "link": "https://stackoverflow.com/questions/41139561/find-ip-address-of-the-machine-in-c/41151132#41151132", "title": "Find IP address of the machine in C?", "body": "<p>The code you showed does not compile because it is designed for Linux, not Windows.  There is no <code>&lt;net/if.h&gt;</code> header on Windows.</p>\n\n<p><a href=\"http://man7.org/linux/man-pages/man3/getifaddrs.3.html\" rel=\"nofollow noreferrer\"><code>getifaddrs()</code></a> returns a linked list of local interface addresses.  But <code>getifaddrs()</code> does not exist on Windows at all (unless you find a custom 3rd party implementation).</p>\n\n<p>The equivalent on Windows is to use the Win32 <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365917.aspx\" rel=\"nofollow noreferrer\"><code>GetAdaptersInfo()</code></a> function on XP and earlier, or the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365915.aspx\" rel=\"nofollow noreferrer\"><code>GetAdaptersAddresses()</code></a> function on Vista and later.  Both functions return a linked list of detailed adapter information (much more than just addresses).</p>\n\n<p>C examples are provided in their documentation on MSDN.</p>\n"}], "owner": {"reputation": 25, "user_id": 6464294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-MaOGVnJoZMQ/AAAAAAAAAAI/AAAAAAAAACA/UezqocAsdDA/photo.jpg?sz=128", "display_name": "Niks Arora", "link": "https://stackoverflow.com/users/6464294/niks-arora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4536, "favorite_count": 0, "accepted_answer_id": 41151132, "answer_count": 2, "score": 1, "last_activity_date": 1520735190, "creation_date": 1481709262, "last_edit_date": 1481745231, "question_id": 41139561, "link": "https://stackoverflow.com/questions/41139561/find-ip-address-of-the-machine-in-c", "title": "Find IP address of the machine in C?", "body": "<p>How do I get the IP address of the local machine in C on Windows? I was not able to get the IP address of my machine in the following code:</p>\n\n<pre><code>#include &lt;ifaddrs.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    struct ifaddrs *id;\n    int val;\n    val = getifaddrs(&amp;id);\n    printf(\"Network Interface Name :- %s\\n\",id-&gt;ifa_name);\n    printf(\"Network Address of %s :- %d\\n\",id-&gt;ifa_name,id-&gt;ifa_addr);\n    printf(\"Network Data :- %d \\n\",id-&gt;ifa_data);\n    printf(\"Socket Data : -%c\\n\",id-&gt;ifa_addr-&gt;sa_data);\n    return 0;\n}\n</code></pre>\n\n<p>I am facing an error while compiling:</p>\n\n<blockquote>\n  <p>fatal error C1083: Cannot open include file: 'net/if.h': No such file or directory.</p>\n</blockquote>\n\n<p>I cannot use <code>#include &lt;net/if.h&gt;</code> as it is only available on Linux.</p>\n"}, {"tags": ["c++", "c", "microcontroller"], "comments": [{"owner": {"reputation": 21133, "user_id": 1084416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/RLhZZ.jpg?s=128&g=1", "display_name": "Peter Wood", "link": "https://stackoverflow.com/users/1084416/peter-wood"}, "edited": false, "score": 2, "creation_date": 1481708484, "post_id": 41139220, "comment_id": 69481491, "body": "See <a href=\"https://docs.python.org/3/library/struct.html\" rel=\"nofollow noreferrer\"><b><code>struct</code></b></a>"}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1481708802, "post_id": 41139220, "comment_id": 69481710, "body": "Is this a python or C question?"}, {"owner": {"reputation": 21, "user_id": 5810054, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/383fe3bfaed5cecfe309df53aa2bb840?s=128&d=identicon&r=PG&f=1", "display_name": "Ghani", "link": "https://stackoverflow.com/users/5810054/ghani"}, "edited": false, "score": 0, "creation_date": 1481709974, "post_id": 41139220, "comment_id": 69482463, "body": "It is C. Done as below answer."}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 2, "last_activity_date": 1481709052, "last_edit_date": 1481709052, "creation_date": 1481708704, "answer_id": 41139349, "question_id": 41139220, "link": "https://stackoverflow.com/questions/41139220/how-to-convert-binary-data-to-float-value/41139349#41139349", "title": "how to convert binary data to float value?", "body": "<p>If you want to do this in Python, it sounds like a job for the <a href=\"https://docs.python.org/2/library/struct.html\" rel=\"nofollow noreferrer\"><code>struct</code></a> module:</p>\n\n<pre><code>&gt;&gt;&gt; struct.unpack(\"f\", \"\".join([chr(x) for x in [24, 58, 46, 66]]))\n(43.556732177734375,)\n</code></pre>\n\n<p>This assumes little-endian byte-order.</p>\n\n<p>In C, you can use <code>memcpy()</code>:</p>\n\n<pre><code>float x;\nconst unsigned char bytes[] = { 24, 58, 46, 66 };\nmemcpy(&amp;x, bytes, sizeof x);\nprintf(\"%f\\n\", x);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1481709590, "creation_date": 1481709590, "answer_id": 41139675, "question_id": 41139220, "link": "https://stackoverflow.com/questions/41139220/how-to-convert-binary-data-to-float-value/41139675#41139675", "title": "how to convert binary data to float value?", "body": "<p>With </p>\n\n<pre><code>unsigned int hum;\n....\nhum = (humicon[0] &lt;&lt; 24) | (humicon[1] &lt;&lt; 16) | (humicon[2] &lt;&lt; 8) | humicon[3];\n</code></pre>\n\n<p>You are converting 8 bit data to 32 bit integer data. You can store this data directly. Or if you absolutely want to store in floats, you can use.</p>\n\n<pre><code>float hum_f;\n....\nhum_f = hum;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 569, "user_id": 4181430, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1488320649/picture?type=large", "display_name": "jurhas", "link": "https://stackoverflow.com/users/4181430/jurhas"}, "is_accepted": false, "score": 0, "last_activity_date": 1481719822, "last_edit_date": 1481719822, "creation_date": 1481718629, "answer_id": 41142733, "question_id": 41139220, "link": "https://stackoverflow.com/questions/41139220/how-to-convert-binary-data-to-float-value/41142733#41142733", "title": "how to convert binary data to float value?", "body": "<p>Yap, is not simple function, transform an array of bytes to a floating point function. I am lookin also to implement it to avoid portable reasons. There are differences also between little endian and big endian machines. \nBut there are several hacks to this problem. \nFirst the file size, you have to include \"sys/stat.h\", with small differences is also portable. But is not required.\nRead it as buffer of char :</p>\n\n<pre><code>char f[sizeof(float)];\nif (fread(f,1,sizeof(float), yourfile) ==sizeof(float))\n{\n    float *flt_ptr=f;\n    printf(\"%f\\n\",*flt_ptr);\n}\n</code></pre>\n\n<p>C is wonderful for those things, there is also no need to cast everithing. </p>\n"}], "owner": {"reputation": 21, "user_id": 5810054, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/383fe3bfaed5cecfe309df53aa2bb840?s=128&d=identicon&r=PG&f=1", "display_name": "Ghani", "link": "https://stackoverflow.com/users/5810054/ghani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2320, "favorite_count": 0, "accepted_answer_id": 41139349, "answer_count": 3, "score": 0, "last_activity_date": 1481719822, "creation_date": 1481708328, "last_edit_date": 1481713389, "question_id": 41139220, "link": "https://stackoverflow.com/questions/41139220/how-to-convert-binary-data-to-float-value", "title": "how to convert binary data to float value?", "body": "<p>For my data logger project I'm logging data to a SD card. Here I'm storing the data in binary format. I'm logging accelerometer and temp&amp;humidity sensors. I could read data byte by byte. Hence to print ADXL data (two bytes), I combine each two byte data. Hence four bytes has to be combined to get temparature data. Unfortunately for temparature I failed to print actual data. There is some conversion problem. I'm looking some help regarding how to convert data to floats.</p>\n\n<p>Code to read and print binary to uint16_t ( accelerometer data): working</p>\n\n<pre><code>while ((nr = fgetc(logFile)) != EOF){\n         pc.printf(\" \\r\\n %d \",nr);\n          acc_con[i] = nr;\n          if (i == 1){ \n          acc = (acc_con[1]&lt;&lt;8) | acc_con[0];\n          pc.printf(\" \\r\\n %i \",acc);\n          i = 0;} \n          else i++; \n         }\n</code></pre>\n\n<p>Code to read and print binary to float ( temparature data): Not working</p>\n\n<pre><code>while ((nr = fgetc(logFile)) != EOF){\n         pc.printf(\" \\r\\n %d \",nr);\n           humicon[i] = nr;\n           if (i == 3){\n            hum = (humicon[0] &lt;&lt; 24) | (humicon[1] &lt;&lt; 16) | (humicon[2] &lt;&lt; 8) | humicon[3];\n            pc.printf(\" \\r\\n %f \",hum);\n            i = 0;}\n            else i++;\n            }\n</code></pre>\n\n<p>The byte by byte raw data from variable nr is: 24, 58, 46, 66, and the output from variable hum is: 406466112.000000.</p>\n\n<p>I could read humidity or temparature (floats) with fread. Unfortunatly to use fread I must know th no of bytes stored in the file.\nWith below code I could print floats also.\n     int main() {</p>\n\n<pre><code>int nr;\nFILE *fp = fopen(\"/sd/PCE000.bin\", \"rb\");\nfloat read[1];\nfread(read,sizeof(float),1,fp);\npc.printf(\"\\r\\n %f\",read[0]);\n  fclose(fp); \n</code></pre>\n\n<p>}</p>\n\n<p>I would like to know the formula for the conversion like (acc_con[1]&lt;&lt;8) | acc_con[0]. Thank you.</p>\n"}, {"tags": ["c++", "c", "struct", "d"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 5668470, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8ff780b9695e21972882b6fa38a206db?s=128&d=identicon&r=PG&f=1", "display_name": "Anders S", "link": "https://stackoverflow.com/users/5668470/anders-s"}, "edited": false, "score": 0, "creation_date": 1481727273, "post_id": 41143678, "comment_id": 69493598, "body": "Thanks rcorre, that does the trick. at least to this point, now I continue to cast data.... and play with my new code ;)"}], "tags": [], "owner": {"reputation": 5163, "user_id": 1435461, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/05f6236ee5ec04b27e27f504ebdd3744?s=128&d=identicon&r=PG", "display_name": "rcorre", "link": "https://stackoverflow.com/users/1435461/rcorre"}, "is_accepted": true, "score": 1, "last_activity_date": 1481721545, "creation_date": 1481721545, "answer_id": 41143678, "question_id": 41138993, "link": "https://stackoverflow.com/questions/41138993/how-to-read-binary-file-data-using-dlang/41143678#41143678", "title": "how to read binary file data using dlang", "body": "<p>Try <a href=\"http://dlang.org/phobos/std_stdio.html#.File.seek\" rel=\"nofollow noreferrer\"><code>File.seek</code></a> and <a href=\"http://dlang.org/phobos/std_stdio.html#.File.rawRead\" rel=\"nofollow noreferrer\"><code>File.rawRead</code></a>. They work like their C counterparts, but <code>rawRead</code> determines the read count from the size of the output buffer you hand it.</p>\n"}], "owner": {"reputation": 145, "user_id": 5668470, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8ff780b9695e21972882b6fa38a206db?s=128&d=identicon&r=PG&f=1", "display_name": "Anders S", "link": "https://stackoverflow.com/users/5668470/anders-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 0, "accepted_answer_id": 41143678, "answer_count": 1, "score": 1, "last_activity_date": 1481721545, "creation_date": 1481707655, "question_id": 41138993, "link": "https://stackoverflow.com/questions/41138993/how-to-read-binary-file-data-using-dlang", "title": "how to read binary file data using dlang", "body": "<p>I'm trying to read struct data from specific position in a a binary file.\nFound out that I can use import std.stdio and its File, however all i seem to find is all about string handling.</p>\n\n<p>I have c-code written data on binary files that compose of several different structs and they all, as far as I understand coding lay in a oneliner. In order to find specific struct I need to, like in old c, </p>\n\n<ol>\n<li>Open file for reading .... (binary read??) </li>\n<li>using sizeof and move to startposition of struct data to read</li>\n<li>read data (struct.sizeof data) into receivingbuffer and  </li>\n<li>Close file</li>\n</ol>\n\n<p><a href=\"https://dlang.org/phobos/std_file.html#.read\" rel=\"nofollow noreferrer\">Documentation for std.stdio.File # read</a> talks about reading entire or up to size but can't find how to read as below c-code line?</p>\n\n<pre><code>fseek(filehandle, sizeof(firstStructData), SEEK_SET));\nread(filehandle, (char *)nextReceivingBuffer, sizeof(nextReceivingBuffer))\n</code></pre>\n\n<p>Any ideas or hints?</p>\n"}, {"tags": ["c++", "c", "logic", "counter"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1481707776, "post_id": 41138868, "comment_id": 69481061, "body": "You can use <code>uint64_t</code> for both, but preform the operations modulo <code>UINT23_MAX</code>. You can also note, that even when <code>startCount == UINT23_MAX</code>, <code>counter &gt; 0</code> will still be equivalent to <code>counter &gt; startCount +1</code>. But in general, giving advice about &quot;how to do something smarter&quot; requires of you to show why you do it in the first place."}, {"owner": {"reputation": 21, "user_id": 7295559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2f4013a1c3d0b7a2a5b79cc805ddc6?s=128&d=identicon&r=PG&f=1", "display_name": "S.Max", "link": "https://stackoverflow.com/users/7295559/s-max"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1481708530, "post_id": 41138868, "comment_id": 69481518, "body": "The counter is internal, I cannot change the type. I am not very good with bit comparsion and I was wondering if this block of code could be reduced to a single statement considering some expreience programmers might have faced simillar issue."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7204876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c029107b5bd7a33808508dc62b6e7bb?s=128&d=identicon&r=PG&f=1", "display_name": "Susheel Nuguru", "link": "https://stackoverflow.com/users/7204876/susheel-nuguru"}, "edited": false, "score": 1, "creation_date": 1481722870, "post_id": 41143509, "comment_id": 69490573, "body": "ofcourse this assumes that there has atleast been one increment .. maynot be optimum in your case?"}], "tags": [], "owner": {"reputation": 1, "user_id": 7204876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c029107b5bd7a33808508dc62b6e7bb?s=128&d=identicon&r=PG&f=1", "display_name": "Susheel Nuguru", "link": "https://stackoverflow.com/users/7204876/susheel-nuguru"}, "is_accepted": false, "score": 0, "last_activity_date": 1481721977, "last_edit_date": 1481721977, "creation_date": 1481721020, "answer_id": 41143509, "question_id": 41138868, "link": "https://stackoverflow.com/questions/41138868/comparing-to-a-counter-which-reset/41143509#41143509", "title": "Comparing to a counter which reset", "body": "<p>Just checking this below should cover everything </p>\n\n<pre><code>if (counter &gt; startCount +1) || ( (counter != startCount) &amp;&amp; (counter &lt; startCount +1)) \n    break;\n</code></pre>\n\n<p>`</p>\n"}, {"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1539001824, "creation_date": 1539001824, "answer_id": 52702362, "question_id": 41138868, "link": "https://stackoverflow.com/questions/41138868/comparing-to-a-counter-which-reset/52702362#52702362", "title": "Comparing to a counter which reset", "body": "<p>I'd use</p>\n\n<pre><code>if (counter-startCount &gt; 1) break;\n</code></pre>\n\n<p>or, if I'd want to allow for <code>int</code> having more than 32 bits,</p>\n\n<pre><code>if ((uint32_t)(counter-startCount) &gt; 1) break;\n</code></pre>\n\n<p>the number of increments computes modulo 2<sup>32</sup>.</p>\n"}], "owner": {"reputation": 21, "user_id": 7295559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2f4013a1c3d0b7a2a5b79cc805ddc6?s=128&d=identicon&r=PG&f=1", "display_name": "S.Max", "link": "https://stackoverflow.com/users/7295559/s-max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1539001824, "creation_date": 1481707245, "last_edit_date": 1481726817, "question_id": 41138868, "link": "https://stackoverflow.com/questions/41138868/comparing-to-a-counter-which-reset", "title": "Comparing to a counter which reset", "body": "<p>I have an uint32 counter. I read this counter and store it like <code>startCount = counter;</code>\nThen I do some operations and then check again the counter. If counter is greater than startCount+1 (means counter must be incremented at least twice).</p>\n\n<pre><code>if (counter &gt; startCount +1 )\n  break;\n</code></pre>\n\n<p>Now the counter will be reseted to zero once it reaches max value for unit32.\nTo compensate this I have added</p>\n\n<pre><code>if (startCount == Max)\n  if (counter &gt; 0)\n    break;\nelse\n  if (counter &gt; startCount +1) || (counter &lt; startCount)\n    break;\n</code></pre>\n\n<p>My question is: is there a better / smarter way to do that?\nThanks for all the help.</p>\n"}, {"tags": ["c", "tensorflow"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 6234868, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/be0b2078a89f6a4997b399e91ba7f638?s=128&d=identicon&r=PG&f=1", "display_name": "john smith", "link": "https://stackoverflow.com/users/6234868/john-smith"}, "edited": false, "score": 0, "creation_date": 1481774521, "post_id": 41155668, "comment_id": 69514130, "body": "But what is the dimension of a string if it&#39;s not a scalar?"}, {"owner": {"reputation": 185, "user_id": 6234868, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/be0b2078a89f6a4997b399e91ba7f638?s=128&d=identicon&r=PG&f=1", "display_name": "john smith", "link": "https://stackoverflow.com/users/6234868/john-smith"}, "edited": false, "score": 0, "creation_date": 1481775213, "post_id": 41155668, "comment_id": 69514278, "body": "<code>int64_t dims[] = {1};</code> still get the same error.  with <code>int64_t dims[] = {4};</code> I got: Malformed TF_STRING tensor; too short to hold number of elements."}], "tags": [], "owner": {"reputation": 2808, "user_id": 5708323, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iN_dtRnmo9Y/AAAAAAAAAAI/AAAAAAAAABE/VlOtp_yX8RI/photo.jpg?sz=128", "display_name": "Pete Warden", "link": "https://stackoverflow.com/users/5708323/pete-warden"}, "is_accepted": false, "score": 1, "last_activity_date": 1481770492, "creation_date": 1481770492, "answer_id": 41155668, "question_id": 41138822, "link": "https://stackoverflow.com/questions/41138822/how-to-create-a-string-type-tensor-in-tensorflow-c-api/41155668#41155668", "title": "How to create a string type tensor in tensorflow C api?", "body": "<p>Unless a Tensor is a scalar (holding just a single number) you need to pass in dimensions information. You're passing in nullptr and zero for the dims in your current code, which is why it's raising an error. You can see an example of how to call TF_NewTensor for a string here:\n<a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/c/c_api.cc#L441\" rel=\"nofollow noreferrer\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/c/c_api.cc#L441</a></p>\n"}, {"comments": [{"owner": {"reputation": 1389, "user_id": 7319089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MS36HcTR-0E/AAAAAAAAAAI/AAAAAAAAABQ/VY_Qhy6rphc/photo.jpg?sz=128", "display_name": "Leonardo Physh", "link": "https://stackoverflow.com/users/7319089/leonardo-physh"}, "edited": false, "score": 1, "creation_date": 1611823031, "post_id": 47879372, "comment_id": 116575335, "body": "a very useful example. but seems that this example only takes consideration of the case of a single string, how to create a tensor contains a list of string, like [&#39;ab&#39;, &#39;abc&#39;, &#39;cc&#39;]?"}], "tags": [], "owner": {"reputation": 41, "user_id": 9116076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a48be84f4b76a24b256ee53fd5944f37?s=128&d=identicon&r=PG&f=1", "display_name": "simflin", "link": "https://stackoverflow.com/users/9116076/simflin"}, "is_accepted": false, "score": 4, "last_activity_date": 1513651897, "creation_date": 1513651897, "answer_id": 47879372, "question_id": 41138822, "link": "https://stackoverflow.com/questions/41138822/how-to-create-a-string-type-tensor-in-tensorflow-c-api/47879372#47879372", "title": "How to create a string type tensor in tensorflow C api?", "body": "<p>Example of valid (but a bit ugly) code which creates a string tensor:</p>\n\n<pre><code>std::string input_str = \"abracdabra\";  // any input string\nsize_t encoded_size = TF_StringEncodedSize(input_str.size());\nsize_t total_size = 8 + encoded_size;  // 8 extra bytes - for start_offset \nchar *input_encoded = (char*)malloc(total_size);\nfor (int i =0; i &lt; 8; ++i) {  // fills start_offset\n    input_encoded[i] = 0;\n}\nTF_StringEncode(input_str.c_str(), input_str.size(), input_encoded+8, encoded_size, status); // fills the rest of tensor data\nif (TF_GetCode(status) != TF_OK){\n    fprintf(stderr, \"ERROR: something wrong with encoding: %s\", TF_Message(status));\n    return 1;\n}\nTF_Tensor* input = TF_NewTensor(TF_STRING, NULL, 0, input_encoded, total_size, &amp;Deallocator, 0);\n</code></pre>\n\n<p>Why it works: <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/c/c_api.h#L213\" rel=\"nofollow noreferrer\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/c/c_api.h#L213</a>  According to this link, data for string tensor consists of two parts. The last one is input string encoded via TF_StringEncode function. The first one is array 'start_offset', I don't completely understand its role, but looks like eight zeros do the trick)</p>\n\n<p>Another example of tensor creation could be found in C API tests: <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/c/c_api_test.cc#L1934\" rel=\"nofollow noreferrer\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/c/c_api_test.cc#L1934</a></p>\n"}], "owner": {"reputation": 185, "user_id": 6234868, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/be0b2078a89f6a4997b399e91ba7f638?s=128&d=identicon&r=PG&f=1", "display_name": "john smith", "link": "https://stackoverflow.com/users/6234868/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1165, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1534926144, "creation_date": 1481707109, "question_id": 41138822, "link": "https://stackoverflow.com/questions/41138822/how-to-create-a-string-type-tensor-in-tensorflow-c-api", "title": "How to create a string type tensor in tensorflow C api?", "body": "<p>What exactly should the <code>data</code> below in the parameter list be?</p>\n\n<pre><code>TF_Tensor* tensorStr = TF_NewTensor(TF_STRING, nullptr, 0, &amp;data[0], 8, no_op, nullptr);\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code>char * data = \"blah\";\nchar* data[] = {\"blah\"};\nchar data[1][4] = {{'b','l','a','h'}};\n</code></pre>\n\n<p>all out of luck. When feed into input. I always get :</p>\n\n<pre><code>Malformed TF_STRING tensor; element 0 out of range\n</code></pre>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1481707691, "post_id": 41138661, "comment_id": 69481000, "body": "The problem isn&#39;t in the code posted. Please provide a minimal example with how you use these structs."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481707798, "post_id": 41138764, "comment_id": 69481075, "body": "You can actually use assignment just fine if the array is fixed-size and located inside a struct. This is not the cause of the problem here."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": -2, "last_activity_date": 1481706948, "creation_date": 1481706948, "answer_id": 41138764, "question_id": 41138661, "link": "https://stackoverflow.com/questions/41138661/struct-copy-in-c-where-struct-are-elements/41138764#41138764", "title": "struct copy in c where struct are elements", "body": "<p>It will work for most members, but you have one that cannot be copied like that <code>arry</code>. You should copy one element at a time from the target to the destination instances.</p>\n\n<p>Note that there are functions that take care of such copying like <code>memcpy()</code>. But you cannot copy an array by assignment like you do with an <code>int</code> or a <code>struct</code> actually.</p>\n"}, {"comments": [{"owner": {"reputation": 287, "user_id": 2102298, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/0a29d72fbcf72d1ee0f1c665b97b1aa3?s=128&d=identicon&r=PG", "display_name": "vow", "link": "https://stackoverflow.com/users/2102298/vow"}, "edited": false, "score": 0, "creation_date": 1481707237, "post_id": 41138791, "comment_id": 69480744, "body": "&#39;you need to do strcpy for string members.&#39; so i should take care of all the string elements separately. like copy them 1 by 1 using strcpy?"}, {"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "reply_to_user": {"reputation": 287, "user_id": 2102298, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/0a29d72fbcf72d1ee0f1c665b97b1aa3?s=128&d=identicon&r=PG", "display_name": "vow", "link": "https://stackoverflow.com/users/2102298/vow"}, "edited": false, "score": 0, "creation_date": 1481707820, "post_id": 41138791, "comment_id": 69481092, "body": "@vow that statement applies to the first struct initialisation. If the struct has any string member you need to use <code>strcpy</code> give it initial value."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 287, "user_id": 2102298, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/0a29d72fbcf72d1ee0f1c665b97b1aa3?s=128&d=identicon&r=PG", "display_name": "vow", "link": "https://stackoverflow.com/users/2102298/vow"}, "edited": false, "score": 0, "creation_date": 1481707822, "post_id": 41138791, "comment_id": 69481093, "body": "@vow The char arrays inside the structs are copied when you assign one struct variable to another. To set the value of a char array you would typically use <code>strcpy</code>. For example: <code>strcpy(second_school.team[0].arry, &quot;Cubs&quot;);</code> would &quot;assign&quot; the string <code>Cubs</code> to the first team of <code>second_school</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1481707882, "post_id": 41138791, "comment_id": 69481131, "body": "If the string struct members are just arrays and not pointers, there is no particular reason why you need to use strcpy in this case. Assignment will work just fine. So this doesn&#39;t answer the question."}], "tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": false, "score": 2, "last_activity_date": 1481707662, "last_edit_date": 1481707662, "creation_date": 1481707000, "answer_id": 41138791, "question_id": 41138661, "link": "https://stackoverflow.com/questions/41138661/struct-copy-in-c-where-struct-are-elements/41138791#41138791", "title": "struct copy in c where struct are elements", "body": "<blockquote>\n  <p>But I step through code this line doesn't seem to work. How should I copy ?</p>\n</blockquote>\n\n<p>It's entirely correct to copy struct like that</p>\n\n<pre><code>first_school = second_school; // valid\n</code></pre>\n\n<p>If it doesn't work as expected then the error is somewhere else. For example, you need to do <code>strcpy()</code> for string members.</p>\n"}, {"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1481707375, "creation_date": 1481707375, "answer_id": 41138907, "question_id": 41138661, "link": "https://stackoverflow.com/questions/41138661/struct-copy-in-c-where-struct-are-elements/41138907#41138907", "title": "struct copy in c where struct are elements", "body": "<p>Structures are values that can be assigned. They can contain arrays, which <em>by themselves</em> are not assignable, but being inside a <code>struct</code> makes it possible.</p>\n\n<p>That code is fine, except you need to reverse the order of the declarations, since <code>School</code> references <code>Name</code> and <code>Sport</code> they must be declared first.</p>\n\n<p>I tested it and it works just fine after reversing the declaration order, this prints <code>hello</code>:</p>\n\n<pre><code>int main(void) {\n    School foo, bar;\n    strcpy(bar.team[0].arry, \"hello\");\n    foo = bar;\n    printf(\"'%s'\\n\", foo.team[0].arry);\n    return 0;\n}\n</code></pre>\n\n<p>There is probably something else wrong with your initialization of the <code>second_shool</code>, or you're failing to verify that it worked. </p>\n"}], "owner": {"reputation": 287, "user_id": 2102298, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/0a29d72fbcf72d1ee0f1c665b97b1aa3?s=128&d=identicon&r=PG", "display_name": "vow", "link": "https://stackoverflow.com/users/2102298/vow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1481707662, "creation_date": 1481706620, "question_id": 41138661, "link": "https://stackoverflow.com/questions/41138661/struct-copy-in-c-where-struct-are-elements", "title": "struct copy in c where struct are elements", "body": "<p>Hi i have following situation</p>\n\n<pre><code>typedef struct\n{\n    int a;\n    Name team[5];\n    Sport sport[5];\n} School;\n\nwhere Name and Sport are also structs,\n\ntypedef struct\n{\n    char arry[20];\n}Name;\n\ntypedef struct\n{\n        char arry[20];\n        int tag;\n}Sport;\n</code></pre>\n\n<p>then</p>\n\n<pre><code>School first_school, second_school;\n</code></pre>\n\n<p>I populate them individually, then at some point I do</p>\n\n<pre><code>first_school = second_school\n</code></pre>\n\n<p>But I step through code this line doesn't seem to work. How should I copy ?</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1481706709, "post_id": 41138622, "comment_id": 69480434, "body": "you print a string into the fifth char of the array (which is not part of the array...). (Be careful with those nasal demons.) Also your array would be to small for the string."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1481706752, "post_id": 41138622, "comment_id": 69480456, "body": "You need to compile with warnings enabled (<code>-Wall</code> for gcc/clang), and then fix all of the warnings."}, {"owner": {"reputation": 57, "user_id": 7216188, "user_type": "registered", "profile_image": "https://graph.facebook.com/365755243767746/picture?type=large", "display_name": "Syed Hussain", "link": "https://stackoverflow.com/users/7216188/syed-hussain"}, "reply_to_user": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1481706941, "post_id": 41138622, "comment_id": 69480580, "body": "@KamiKaze how should i do it then??"}, {"owner": {"reputation": 645, "user_id": 1462225, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0afb9a47eb6654437c6986283cff151c?s=128&d=identicon&r=PG", "display_name": "23ars", "link": "https://stackoverflow.com/users/1462225/23ars"}, "edited": false, "score": 0, "creation_date": 1481706954, "post_id": 41138622, "comment_id": 69480589, "body": "compile with warnings enabled."}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 4, "last_activity_date": 1505359832, "last_edit_date": 1505359832, "creation_date": 1481706762, "answer_id": 41138705, "question_id": 41138622, "link": "https://stackoverflow.com/questions/41138622/string-not-printing/41138705#41138705", "title": "string not printing", "body": "<pre><code>colour[5]=\"green\";\n</code></pre>\n\n<p>and</p>\n\n<pre><code>colour[5]=\"red\";\n</code></pre>\n\n<p>leads to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behaviour</em></a> for multiple reasons (You are accessing the array <code>colour</code> outside of bounds and attempting to assign a string literal to a char).</p>\n\n<p>You don't really need an array. Just use a pointer:</p>\n\n<pre><code>char *colour;\nif (rn == 1) {\n    colour=\"green\";\n} else {\n    colour=\"red\";\n}\nprintf(\"Random number : %d\\nColour : %s\", rn, colour);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1481708486, "post_id": 41138737, "comment_id": 69481493, "body": "that would create another problem as you write more characters than there are slots in the array."}, {"owner": {"reputation": 1159, "user_id": 3302647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/784a183178e06cdacc78678f3779cf7d?s=128&d=identicon&r=PG&f=1", "display_name": "shafeeq", "link": "https://stackoverflow.com/users/3302647/shafeeq"}, "reply_to_user": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1481709909, "post_id": 41138737, "comment_id": 69482422, "body": "Yes, the array size is need to be increased in the case of green, right?"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1481710013, "post_id": 41138737, "comment_id": 69482485, "body": "I would suggest that you write this in the answer to make it correct."}], "tags": [], "owner": {"reputation": 1159, "user_id": 3302647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/784a183178e06cdacc78678f3779cf7d?s=128&d=identicon&r=PG&f=1", "display_name": "shafeeq", "link": "https://stackoverflow.com/users/3302647/shafeeq"}, "is_accepted": false, "score": 0, "last_activity_date": 1481711348, "last_edit_date": 1481711348, "creation_date": 1481706876, "answer_id": 41138737, "question_id": 41138622, "link": "https://stackoverflow.com/questions/41138622/string-not-printing/41138737#41138737", "title": "string not printing", "body": "<p>Change array declaration as <code>char colour[32] = {0};</code></p>\n\n<p>use <code>strcpy(colour, \"green\");</code> instead of <code>colour[5]=\"green\";</code> similarly for red</p>\n\n<p>use %s instead of %c while printing..</p>\n"}], "owner": {"reputation": 57, "user_id": 7216188, "user_type": "registered", "profile_image": "https://graph.facebook.com/365755243767746/picture?type=large", "display_name": "Syed Hussain", "link": "https://stackoverflow.com/users/7216188/syed-hussain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1505359832, "creation_date": 1481706493, "last_edit_date": 1481707350, "question_id": 41138622, "link": "https://stackoverflow.com/questions/41138622/string-not-printing", "title": "string not printing", "body": "<p>In this program I have to generate a random number and then if the number is 1 I have to store green in variable colour and if it is 0 I have to store red and then print the result</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;time.h&gt;\nint main ()\n{\n    int rn;\n    rn=Switch();\n    Display(rn);\n    return 0;\n}\nint Switch()\n{\n    int rn;\n    srand(time(NULL));\n    rn=rand()%2;\n    return rn;\n}\nint Display(int rn)\n{\n    char colour[5];\n    if (rn==1)\n    {\n        colour[5]=\"green\";\n    }\n    else\n    {\n        colour[5]=\"red\";\n    }\n    printf(\"Random number : %d\\nColour : %c\",rn,colour);\n}\n</code></pre>\n\n<p>but when I run the program it prints the random number and it doesn't prints the colour.</p>\n"}, {"tags": ["c", "data-structures", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1481706611, "post_id": 41138618, "comment_id": 69480387, "body": "There is nothing at all wrong with a linked list node containing multiple things.  In fact, this is completely normal."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1481706793, "post_id": 41138618, "comment_id": 69480482, "body": "I guess its fine if that is what you want. However, why not just make life easier and have a pointer to the next node? If your able to store and access data without issues, then it is a valid data structure, just not a very common one."}, {"owner": {"reputation": 821, "user_id": 3791028, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/wO8Jq.jpg?s=128&g=1", "display_name": "Subhranil", "link": "https://stackoverflow.com/users/3791028/subhranil"}, "reply_to_user": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1481707169, "post_id": 41138618, "comment_id": 69480707, "body": "If i keep a pointer to the next node, then I&#39;ll have to keep all pointers of other structures to every structure, and even another flag to determine which is in use. That&#39;s why i used this strategy. @RoadRunner"}, {"owner": {"reputation": 821, "user_id": 3791028, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/wO8Jq.jpg?s=128&g=1", "display_name": "Subhranil", "link": "https://stackoverflow.com/users/3791028/subhranil"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1481707254, "post_id": 41138618, "comment_id": 69480752, "body": "@TimBiegeleisen, thank you for your answer. Can you give a practical example where this type of structure is used?"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1481707339, "post_id": 41138618, "comment_id": 69480808, "body": "Sure, off the top of my head, you could have a list of some C++ class which represents a log event/object.  This class could have members for the date when the log occurred, the log content, and the log level (e.g. debug, error, etc.)."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481710507, "post_id": 41138949, "comment_id": 69482768, "body": "However, standard C does not guarantee that <code>dataaddress = ((long)(&amp;generic-&gt;nextaddress)) + sizeof(long);</code> works. Also there are pointer aliasing problems in the code."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 0, "creation_date": 1481711022, "post_id": 41138949, "comment_id": 69483047, "body": "@Marian The questions are: <i>Can it be called a valid linked list? And moreover, is it even a valid data structure?</i> So is not Code Review, or check my code service. I pointed out the part of OP code related to questions."}, {"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 0, "creation_date": 1481711148, "post_id": 41138949, "comment_id": 69483116, "body": "@LP In my understanding the question is talking about particular code presented in the link. Your answer could give impression that OP&#39;s code is valid while it is not. Your code on the other hand is valid."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481711408, "post_id": 41138949, "comment_id": 69483291, "body": "@Lundin For sure, but I answered to OP questions: <i>Can it be called a valid linked list? And moreover, is it even a valid data structure?</i>"}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 2, "last_activity_date": 1481712007, "last_edit_date": 1592644375, "creation_date": 1481707525, "answer_id": 41138949, "question_id": 41138618, "link": "https://stackoverflow.com/questions/41138618/can-a-data-structure-contain-multiple-type-of-elements/41138949#41138949", "title": "Can a data structure contain multiple type of elements?", "body": "<p>Your code has many problems, but only referring to your specific questions about structs</p>\n<p><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">Standard C</a> grants that you solution works</p>\n<blockquote>\n<p><strong>6.7.2.1 Structure and union specifiers</strong></p>\n<p>Sub chapter 15</p>\n<p>Within a structure object, the non-bit-field members and the units in which bit-fields\nreside have addresses that increase in the order in which they are declared. <strong>A pointer to a\nstructure object, suitably converted, points to its initial member (or if that member is a\nbit-field, then to the unit in which it resides), and vice versa.</strong> There may be unnamed\npadding within a structure object, but not at its beginning.</p>\n</blockquote>\n<p><sup>Emphasis mine</sup></p>\n<p>You should use <code>gen_struct</code> inside the other struct:this grants to respect the rule of &quot;initial member&quot;.</p>\n<pre><code>struct gen_type {\n    int flag;\n    void *nextaddress;\n};\n\nstruct node_type_int {\n    struct gen_type header;\n    long data;\n};\n\nstruct node_type_real {\n    struct gen_type header;\n    double data;\n};\n\nstruct node_type_char {\n    struct gen_type header;\n    char data;\n};\n</code></pre>\n<p>As you can see I also changed type of <code>nextaddress</code>: is meant to be a pointer, so use a pointer.</p>\n<p>Side note: <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">do-i-cast-the-result-of-malloc</a></p>\n"}, {"comments": [{"owner": {"reputation": 821, "user_id": 3791028, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/wO8Jq.jpg?s=128&g=1", "display_name": "Subhranil", "link": "https://stackoverflow.com/users/3791028/subhranil"}, "edited": false, "score": 0, "creation_date": 1481710688, "post_id": 41139550, "comment_id": 69482866, "body": "Yup, it is the ultimate point. Although the processing is kinda difficult to imagine and implement from the programmer point of view, I don&#39;t think it&#39;ll take much overhead of the processor to perform some simple additions and addressing, compared to the leak of a few bytes in each instance. I&#39;d rather have a compact memory at the cost of a few more seconds of processing. What say?"}], "tags": [], "owner": {"reputation": 312, "user_id": 7204551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ed9da506b9c5cdb571443dff701a60?s=128&d=identicon&r=PG&f=1", "display_name": "Dipti Shiralkar", "link": "https://stackoverflow.com/users/7204551/dipti-shiralkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1481709239, "creation_date": 1481709239, "answer_id": 41139550, "question_id": 41138618, "link": "https://stackoverflow.com/questions/41138618/can-a-data-structure-contain-multiple-type-of-elements/41139550#41139550", "title": "Can a data structure contain multiple type of elements?", "body": "<p>Nice. Out of the box, I liked different way of doing it! but ...</p>\n\n<p>Considering memory alignments differences across don't you feel there could be issue with below code:</p>\n\n<pre><code>dataaddress = ((long)(&amp;generic-&gt;nextaddress)) + sizeof(long);\n</code></pre>\n\n<p>Here you are assuming the data is stored continuously and hence calculating address of data by adding sizeof long to the address of next address. But this need not be the case always right? </p>\n\n<p>Instead, I feel its better to typecast to the appropriate structure type after reading the flag value, and then read data.</p>\n\n<p>Considering such challenges, though you are saving on some memory but adding some more processing. So though it looks like a valid linked list, implementation can be decided upon choice of memory vs processing.</p>\n"}, {"tags": [], "owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "is_accepted": false, "score": 0, "last_activity_date": 1481713266, "last_edit_date": 1481713266, "creation_date": 1481709303, "answer_id": 41139576, "question_id": 41138618, "link": "https://stackoverflow.com/questions/41138618/can-a-data-structure-contain-multiple-type-of-elements/41139576#41139576", "title": "Can a data structure contain multiple type of elements?", "body": "<p>Your code has at least two weak points:</p>\n\n<p>1.) conversion between <code>long</code> and pointer and back. The C standard allows this only if the integer type can hold the necessary range, which may not be the case on architectures with 32-bit <code>long</code> integers and 64-bit pointers. </p>\n\n<p>I am adding quotation from C11 standard, section 6.3.2.3 Pointers:</p>\n\n<blockquote>\n  <p>An integer may be converted to any pointer type. Except as previously specified, the\n  result is implementation-defined, might not be correctly aligned, might not point to an\n  entity of the referenced type, and might be a trap representation.67)</p>\n  \n  <p>Any pointer type may be converted to an integer type. Except as previously specified, the\n  result is implementation-defined. If the result cannot be represented in the integer type,\n  the behavior is undefined. The result need not be in the range of values of any integer\n  type.</p>\n  \n  <p>67) The mapping functions for converting a pointer to an integer or an integer to a pointer are intended to\n  be consistent with the addressing structure of the execution environment</p>\n</blockquote>\n\n<p>2.) implementation supposes that fields in two different structures (where types of preceding fields match) are stored at the same place (offset) within the structure. Although this is true for most implementations, the standard guarantee this only if those two structures are part of a union.</p>\n\n<p>Section 6.5.2.3 Structure and union members:</p>\n\n<blockquote>\n  <p>One special guarantee is made in order to simplify the use of unions: if a union contains\n  several structures that share a common initial sequence (see below), and if the union\n  object currently contains one of these structures, it is permitted to inspect the common\n  initial part of any of them anywhere that a declaration of the completed type of the union\n  is visible. Tw o structures share a common initial sequence if corresponding members\n  have compatible types (and, for bit-fields, the same widths) for a sequence of one or more\n  initial members.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 821, "user_id": 3791028, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/wO8Jq.jpg?s=128&g=1", "display_name": "Subhranil", "link": "https://stackoverflow.com/users/3791028/subhranil"}, "edited": false, "score": 0, "creation_date": 1481711851, "post_id": 41139941, "comment_id": 69483570, "body": "I have not casted a <code>struct* y</code> to <code>struct* x</code> and vice versa. I only casted the addresses to the <code>gen_type</code>, which, according to C standard is completely permissible, and all of the four structures will follow the same memory layout for initial common members. No unnamed padding is at the beginning, and not anywhere between the <code>int flag</code> and <code>long nextaddress</code>, as both is a complete multiple of 4, which is again, to quote you, <code>will work on practice in every system out there</code>. The problem lies in the <code>data</code> part, more specifically in <code>node_type_char</code>."}, {"owner": {"reputation": 821, "user_id": 3791028, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/wO8Jq.jpg?s=128&g=1", "display_name": "Subhranil", "link": "https://stackoverflow.com/users/3791028/subhranil"}, "edited": false, "score": 0, "creation_date": 1481711887, "post_id": 41139941, "comment_id": 69483589, "body": "That can also be overcome by using some calculations.&lt;br&gt;<code>offset_of_data = sizeof(node) + start_address - sizeof(data)</code>&lt;br&gt;To be clear, I want specifically different structures in the same list, a heterogeneous linked list if I may."}, {"owner": {"reputation": 821, "user_id": 3791028, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/wO8Jq.jpg?s=128&g=1", "display_name": "Subhranil", "link": "https://stackoverflow.com/users/3791028/subhranil"}, "edited": false, "score": 0, "creation_date": 1481712311, "post_id": 41139941, "comment_id": 69483851, "body": "And meanwhile, the whole code is tested and compiled in GCC itself. So I&#39;m not quite sure about aggressive optimizations."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 821, "user_id": 3791028, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/wO8Jq.jpg?s=128&g=1", "display_name": "Subhranil", "link": "https://stackoverflow.com/users/3791028/subhranil"}, "edited": false, "score": 0, "creation_date": 1481712532, "post_id": 41139941, "comment_id": 69483992, "body": "@Subhranil No, according to standard C, they will have the same memory layout <i>for the very first member</i>. After that, no guarantees. The pointer aliasing problem is not just related to structs, but any data types that are not compatible. For example, you cannot take a pointer-to-int and convert it to a pointer-to-double."}, {"owner": {"reputation": 821, "user_id": 3791028, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/wO8Jq.jpg?s=128&g=1", "display_name": "Subhranil", "link": "https://stackoverflow.com/users/3791028/subhranil"}, "edited": false, "score": 0, "creation_date": 1481712685, "post_id": 41139941, "comment_id": 69484085, "body": "<code>Two structures share a common initial sequence if corresponding members have compatible types (and, for bit-fields, the same widths) for a sequence of one or more initial members.</code> I think I read that from a previous answer."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 821, "user_id": 3791028, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/wO8Jq.jpg?s=128&g=1", "display_name": "Subhranil", "link": "https://stackoverflow.com/users/3791028/subhranil"}, "edited": false, "score": 0, "creation_date": 1481712951, "post_id": 41139941, "comment_id": 69484264, "body": "@Subhranil The problem is &quot;There may be unnamed padding within a structure object, but not at its beginning.&quot; But as I wrote this is mainly a theoretical/formal problem, I very much doubt there will be a difference in practice."}, {"owner": {"reputation": 821, "user_id": 3791028, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/wO8Jq.jpg?s=128&g=1", "display_name": "Subhranil", "link": "https://stackoverflow.com/users/3791028/subhranil"}, "edited": false, "score": 0, "creation_date": 1481713307, "post_id": 41139941, "comment_id": 69484490, "body": "And to the pointer aliasing problem, let me try in the way I visualized that. Let&#39;s say the program is compiled in a 64bit GCC. So, the size of <code>node_type_char</code> is 4+8+1+13_pads = 24. So if i cast the first 32bits, I get whatever the value of the bitmap in a 32bit integer. If i cast first 64bits, I get whatever the value of the bitmap in a 64bit long, which should contain the <code>int</code> and half of the <code>long</code>. This assumption is particularly correct in my experiments, and the same I implemented in the program."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 821, "user_id": 3791028, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/wO8Jq.jpg?s=128&g=1", "display_name": "Subhranil", "link": "https://stackoverflow.com/users/3791028/subhranil"}, "edited": false, "score": 0, "creation_date": 1481715982, "post_id": 41139941, "comment_id": 69486079, "body": "@Subhranil The problem is that the compiler is free to assume that the value is never accessed at all, since doing so through an incorrect pointer type would be undefined behavior. Which in turn may cause it to generate incorrect code. Check the link I posted."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 2, "last_activity_date": 1481710329, "last_edit_date": 1495540807, "creation_date": 1481710329, "answer_id": 41139941, "question_id": 41138618, "link": "https://stackoverflow.com/questions/41138618/can-a-data-structure-contain-multiple-type-of-elements/41139941#41139941", "title": "Can a data structure contain multiple type of elements?", "body": "<p>It is fine to do this as long as you have a means to tell which type each node contains, like the <code>flag</code> variable.</p>\n\n<p>It seems reasonable that you can assume that <code>flag</code> and <code>nextaddress</code> will be on the same struct offsets no matter which struct type you use. Although strictly speaking the C language does not guarantee this, I believe it will work in practice on any system out there.</p>\n\n<p>However, you cannot assume that <code>data</code> is located at <code>(uint8_t*)&amp;my_struct + sizeof(int) + sizeof(long)</code>. This offset may vary between structues because of different alignment requirements.</p>\n\n<p>A more serious concern is pointer aliasing. You cannot take a pointer <code>struct* x</code> and convert that to another pointer type <code>struct* y</code>. It will compile, but this is a violation of the type rules in C and invokes undefined behavior (unless both structs have exactly the same members). Standard-compliant compilers that use aggressive optimizations (like GCC) will not compile such code as expected. (<a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">What is the strict aliasing rule?</a>)</p>\n\n<p>To be on the safe side and to get better program design overall, I would recommend that you instead do this:</p>\n\n<pre><code>typedef struct node\n{\n  long   nextaddress;\n  type_t type; // some enum\n  void*  data;\n} node_t;\n</code></pre>\n\n<p>Where <code>data</code> is allocated separately from a node. You get a chained linked list of sorts.</p>\n"}], "owner": {"reputation": 821, "user_id": 3791028, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/wO8Jq.jpg?s=128&g=1", "display_name": "Subhranil", "link": "https://stackoverflow.com/users/3791028/subhranil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1439, "favorite_count": 0, "accepted_answer_id": 41139941, "answer_count": 4, "score": 1, "last_activity_date": 1481713266, "creation_date": 1481706466, "last_edit_date": 1481710038, "question_id": 41138618, "link": "https://stackoverflow.com/questions/41138618/can-a-data-structure-contain-multiple-type-of-elements", "title": "Can a data structure contain multiple type of elements?", "body": "<p><a href=\"https://github.com/iamsubhranil/MiscLinkedLIst/blob/master/misc_list.c\" rel=\"nofollow noreferrer\">This program</a> is a different approach over the same old singly linked list. Instead of creating a single structure and keeping the pointer of the next node of the same type as a member of the structure, I here used three different structures, and a plain <code>long nextaddress</code> member in each to point the address of the next node, because pointers also do the same.</p>\n\n<p>Each node also has a <code>int flag</code> member as the first item of the structure, and the <code>data</code> part resides at the end of the structure because of its variable length.</p>\n\n<p>The three structures are basic extension of the built-in types, <code>long</code>, <code>double</code> and <code>char</code>. While accessing the structures, I first casted the address of the node as an <code>int *</code>, which gives me access to the <code>flag</code> without fully typecasting the address to a definite structure from the three. </p>\n\n<p>Then analyzing the <code>flag</code>, various operations are done.</p>\n\n<p>So here's my question. Can it be called a valid linked list? And moreover, is it even a valid data structure?</p>\n"}, {"tags": ["c", "linux", "sockets", "networking"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1481707259, "post_id": 41138474, "comment_id": 69480758, "body": "It is safe, but unpredictable, but really, why? Do you really need two threads per socket?"}, {"owner": {"reputation": 11, "user_id": 4461618, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eFWObbZhpVE/AAAAAAAAAAI/AAAAAAAAAsA/lE4pEgbvtog/photo.jpg?sz=128", "display_name": "Tubo Yang \u6768\u82f1\u8d85", "link": "https://stackoverflow.com/users/4461618/tubo-yang-%e6%9d%a8%e8%8b%b1%e8%b6%85"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1481765973, "post_id": 41138474, "comment_id": 69512019, "body": "well, I don&#39;t like it either. But this is legacy code, written by someone else."}], "owner": {"reputation": 11, "user_id": 4461618, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eFWObbZhpVE/AAAAAAAAAAI/AAAAAAAAAsA/lE4pEgbvtog/photo.jpg?sz=128", "display_name": "Tubo Yang \u6768\u82f1\u8d85", "link": "https://stackoverflow.com/users/4461618/tubo-yang-%e6%9d%a8%e8%8b%b1%e8%b6%85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1481706060, "creation_date": 1481706060, "question_id": 41138474, "link": "https://stackoverflow.com/questions/41138474/is-it-safe-to-call-getsockopt-and-read-write-simultaneity-in-different-thr", "title": "Is it safe to call getsockopt() and read()/write() simultaneity in different threads?", "body": "<p>Suppose I have two threads:</p>\n\n<ul>\n<li>Thread 1 keeps reading from or writing into sockets via read()/write().</li>\n<li>Thread 2 sleeps for several seconds and then calls getsockopt() to get tcp_info from socket.</li>\n</ul>\n\n<p>Is it safe to do so in linux box?</p>\n\n<p>I know it would be better to use epoll or select in this case, but I just want to know whether the above approach is safe....</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "syntax", "comments", "line"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 2, "creation_date": 1481705297, "post_id": 41138195, "comment_id": 69479677, "body": "Most modern IDEs have tools which can aid you in doing a block comment, all with the single click of a mouse.  As the answer-comment below says, you probably can&#39;t do this."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1481705347, "post_id": 41138195, "comment_id": 69479706, "body": "Also, that&#39;s a good reason not to use multi line comments."}], "answers": [{"tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 2, "last_activity_date": 1481705302, "creation_date": 1481705302, "answer_id": 41138244, "question_id": 41138195, "link": "https://stackoverflow.com/questions/41138195/c-programming-multi-line-comments/41138244#41138244", "title": "C Programming - Multi-line comments", "body": "<p>What you can do is</p>\n\n<pre><code>#if 0\n/Code that needs to be commented/\n#endif\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1481705388, "last_edit_date": 1481705388, "creation_date": 1481705317, "answer_id": 41138250, "question_id": 41138195, "link": "https://stackoverflow.com/questions/41138195/c-programming-multi-line-comments/41138250#41138250", "title": "C Programming - Multi-line comments", "body": "<p>I suppose you want to comment out some code containing itself comments.</p>\n\n<p>You can use conditionnal compilation for this:</p>\n\n<pre><code>#if 0\n/* This is my first comment */\nprintf(\"\\n This is my first print command\");\n\n/* This is my second comment */\nprintf(\"\\n This is my second print command\");\n#endif\n</code></pre>\n\n<p>Everything between <code>#if 0</code> and <code>#endif</code> will be ignored by the compiler, just if it was a comment.</p>\n"}, {"comments": [{"owner": {"reputation": 311, "user_id": 7260372, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-iyMoXomspnc/AAAAAAAAAAI/AAAAAAAAADg/E69qbcWFWUU/photo.jpg?sz=128", "display_name": "Amninder Singh", "link": "https://stackoverflow.com/users/7260372/amninder-singh"}, "edited": false, "score": 1, "creation_date": 1481709337, "post_id": 41138263, "comment_id": 69482055, "body": "Thank you :) .. StackOverflow is adding things to my learning . Happy about it..    I never used # if 0 ..... #endif . So thank you so much :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 8, "last_activity_date": 1481705706, "last_edit_date": 1481705706, "creation_date": 1481705356, "answer_id": 41138263, "question_id": 41138195, "link": "https://stackoverflow.com/questions/41138195/c-programming-multi-line-comments/41138263#41138263", "title": "C Programming - Multi-line comments", "body": "<p>What you <em>expect</em> here is the multi-line comments to be <em>nested</em>.</p>\n\n<p>Quoting directly from the standard <code>C11</code>, chapter \u00a76.4.9,</p>\n\n<blockquote>\n  <p>Except within a character constant, a string literal, or a comment, the characters <code>/*</code>\n  introduce a comment. The contents of such a comment are examined only to identify\n  multibyte characters and to find the characters <code>*/</code> that terminate it. <sup>83)</sup></p>\n</blockquote>\n\n<p>and the footnote,</p>\n\n<blockquote>\n  <p>83 ) <strong>Thus, <code>/* ... */</code> comments do not nest.</strong></p>\n</blockquote>\n\n<p>As a workaround, you can use the conditional compilation block as</p>\n\n<pre><code>#if 0\n.\n.\n.\n.\n#endif \n</code></pre>\n\n<p>to have a whole block <em>commented out</em>.</p>\n"}], "owner": {"reputation": 311, "user_id": 7260372, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-iyMoXomspnc/AAAAAAAAAAI/AAAAAAAAADg/E69qbcWFWUU/photo.jpg?sz=128", "display_name": "Amninder Singh", "link": "https://stackoverflow.com/users/7260372/amninder-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 41138263, "answer_count": 3, "score": 4, "last_activity_date": 1481721814, "creation_date": 1481705121, "last_edit_date": 1481721814, "question_id": 41138195, "link": "https://stackoverflow.com/questions/41138195/c-programming-multi-line-comments", "title": "C Programming - Multi-line comments", "body": "<p>How to ignore the multi-line comment symbols <strong><em>inside</em></strong> another multi-line comment?</p>\n\n<p>Say I want to put the entire code in comments so that I can test other things in my code</p>\n\n<pre><code>/* This is my first comment */\nprintf(\"\\n This is my first print command\");\n\n/* This is my second comment */\nprintf(\"\\n This is my second print command\");\n</code></pre>\n\n<p>If I do </p>\n\n<pre><code>/* \n\n/* This is my first comment */\nprintf(\"\\n This is my first print command\");\n\n/* This is my second comment */\nprintf(\"\\n This is my second print command\");\n\n*/\n</code></pre>\n\n<p>this is creating error.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "edited": false, "score": 0, "creation_date": 1481705867, "post_id": 41138182, "comment_id": 69479967, "body": "You&#39;re calling this from <i>within</i> the kernel?"}, {"owner": {"reputation": 151, "user_id": 2785398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25a239fafd33b6a08a5ea9c6f95d3330?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/2785398/tom"}, "reply_to_user": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "edited": false, "score": 0, "creation_date": 1481706382, "post_id": 41138182, "comment_id": 69480230, "body": "no from user space"}, {"owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "edited": false, "score": 0, "creation_date": 1481706615, "post_id": 41138182, "comment_id": 69480389, "body": "No, you&#39;ll need to create a device node to perform the mounting in this case; however it&#39;s a single system call (<code>mknod</code>) to create the device node, and it can be absolutely <i>anywhere</i> (even in <code>&#47;tmp</code>)"}, {"owner": {"reputation": 151, "user_id": 2785398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25a239fafd33b6a08a5ea9c6f95d3330?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/2785398/tom"}, "reply_to_user": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "edited": false, "score": 0, "creation_date": 1481707123, "post_id": 41138182, "comment_id": 69480687, "body": "this is what i know, but i was curious if there is any way to bypass it like an ioctl, feels like a detour to create a node first"}], "owner": {"reputation": 151, "user_id": 2785398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25a239fafd33b6a08a5ea9c6f95d3330?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/2785398/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1481707664, "creation_date": 1481705077, "last_edit_date": 1481707664, "question_id": 41138182, "link": "https://stackoverflow.com/questions/41138182/mount-by-major-minor-without-dev-node", "title": "mount by major / minor without dev node", "body": "<p>In linux is there a way to mount a block device from its major and minor number by using only system calls(user space), but without temporarily creating a dev node file.</p>\n\n<p>I already had a look at sys/mount.h(<a href=\"https://linux.die.net/man/2/mount\" rel=\"nofollow noreferrer\">https://linux.die.net/man/2/mount</a>)! (i \ntry to implement this in c)</p>\n"}, {"tags": ["c++", "c", "linux", "posix"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 3, "creation_date": 1481705279, "post_id": 41138181, "comment_id": 69479665, "body": "You should search systemd&#39;s documentation. But just for curiosity, is this a <a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">XY Problem</a>? From my experience when someone is asking this kind of question, they actually want to do something else."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1481705598, "post_id": 41138181, "comment_id": 69479831, "body": "Also, note that doing this can be a security risk because presumably the program would have to have root privileges in order to query the required data."}, {"owner": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "edited": false, "score": 0, "creation_date": 1481708338, "post_id": 41138181, "comment_id": 69481404, "body": "Maybe use something similar to this, and e.g. parse output of &#39;ps aux | grep &lt;daemonname&gt;&#39;: <a href=\"http://stackoverflow.com/questions/478898/how-to-execute-a-command-and-get-output-of-command-within-c-using-posix\" title=\"how to execute a command and get output of command within c using posix\">stackoverflow.com/questions/478898/&hellip;</a>"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481711340, "post_id": 41138181, "comment_id": 69483239, "body": "Largely dependent on which init system you are running (SysV, systemd, runit, etc) - you may get more informed answers over on the <a href=\"https://unix.stackexchange.com\">Unix & Linux</a> site."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7205997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdfaae28a52797eb7356ed54a47bbeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Raju", "link": "https://stackoverflow.com/users/7205997/raju"}, "edited": false, "score": 1, "creation_date": 1481885718, "post_id": 41139840, "comment_id": 69565226, "body": "thanks!....Looks like in my CentOS this command is not available. its shows me following error:                                                  root@t1024rdb:~# systemctl -sh: systemctl: command not found"}], "tags": [], "owner": {"reputation": 31, "user_id": 2786098, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000167558287/picture?type=large", "display_name": "Deekshith Narayanaswamy", "link": "https://stackoverflow.com/users/2786098/deekshith-narayanaswamy"}, "is_accepted": false, "score": 0, "last_activity_date": 1481710067, "creation_date": 1481710067, "answer_id": 41139840, "question_id": 41138181, "link": "https://stackoverflow.com/questions/41138181/how-to-programmatically-check-if-particular-daemon-is-runnning-by-specifying-its/41139840#41139840", "title": "How to programmatically check if particular daemon is runnning by specifying its name on Linux using C, C++?", "body": "<p>As I cannot add comment above. \nyou can use systemctl to check service status.</p>\n\n<pre><code>systemctl status servicename\n</code></pre>\n\n<p>This is terminal command. \nusing <code>system(\"systemctl status servicename\")</code> u can manage call from c++.</p>\n\n<p>Hope this is what is were looking at or similar.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2578780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd95c8376fd4973b4901dd8e026ce343?s=128&d=identicon&r=PG", "display_name": "ckousik", "link": "https://stackoverflow.com/users/2578780/ckousik"}, "is_accepted": false, "score": 1, "last_activity_date": 1574408899, "creation_date": 1574408899, "answer_id": 58989721, "question_id": 41138181, "link": "https://stackoverflow.com/questions/41138181/how-to-programmatically-check-if-particular-daemon-is-runnning-by-specifying-its/58989721#58989721", "title": "How to programmatically check if particular daemon is runnning by specifying its name on Linux using C, C++?", "body": "<p>A simple command to run would be <code>systemctl status ${service} | grep \"Active:\" | cut -d' ' -f6</code>. Capture the stdout of the above command and it should equal <code>(running)</code>.</p>\n\n<p>On that note, <code>*ctl</code> are intended for command line use only and not for use by other programs. The accepted way is to interact with <code>systemd</code> using the <code>dbus</code> API.</p>\n\n<p><a href=\"https://www.freedesktop.org/wiki/Software/systemd/dbus/\" rel=\"nofollow noreferrer\">https://www.freedesktop.org/wiki/Software/systemd/dbus/</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7496472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99d668793b988d91bd37178f041548d2?s=128&d=identicon&r=PG&f=1", "display_name": "R.Amutha", "link": "https://stackoverflow.com/users/7496472/r-amutha"}, "is_accepted": false, "score": -1, "last_activity_date": 1606717489, "creation_date": 1606717489, "answer_id": 65068946, "question_id": 41138181, "link": "https://stackoverflow.com/questions/41138181/how-to-programmatically-check-if-particular-daemon-is-runnning-by-specifying-its/65068946#65068946", "title": "How to programmatically check if particular daemon is runnning by specifying its name on Linux using C, C++?", "body": "<p>systemctl is-active ${service_name} can be used to check if a service is active or not</p>\n"}], "owner": {"reputation": 51, "user_id": 7205997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdfaae28a52797eb7356ed54a47bbeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Raju", "link": "https://stackoverflow.com/users/7205997/raju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1606717489, "creation_date": 1481705072, "last_edit_date": 1481705321, "question_id": 41138181, "link": "https://stackoverflow.com/questions/41138181/how-to-programmatically-check-if-particular-daemon-is-runnning-by-specifying-its", "title": "How to programmatically check if particular daemon is runnning by specifying its name on Linux using C, C++?", "body": "<p>How to programmatically check if particular daemon is running by specifying its name on Linux using C, C++ ?</p>\n"}, {"tags": ["ios", "objective-c", "c", "security", "key-pair"], "answers": [{"comments": [{"owner": {"reputation": 447, "user_id": 1883047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ozp5j.jpg?s=128&g=1", "display_name": "Sunil aruru", "link": "https://stackoverflow.com/users/1883047/sunil-aruru"}, "edited": false, "score": 0, "creation_date": 1520425934, "post_id": 41766545, "comment_id": 85308225, "body": "What has to give in &quot;privateKeyLegnth&quot;?"}, {"owner": {"reputation": 899, "user_id": 1110292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c263fc8087f3c927899d57ce891710c?s=128&d=identicon&r=PG", "display_name": "Chaosed0", "link": "https://stackoverflow.com/users/1110292/chaosed0"}, "edited": false, "score": 0, "creation_date": 1526596551, "post_id": 41766545, "comment_id": 87818638, "body": "The first part of this answer (how to export the key) is correct, but the exported key is not compatible with <code>d2i_EC_PUBKEY</code>. See: <a href=\"https://forums.developer.apple.com/message/84684#84684\" rel=\"nofollow noreferrer\">forums.developer.apple.com/message/84684#84684</a>"}, {"owner": {"reputation": 990, "user_id": 5342853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ebbae059e7fb20010004036ec0c2f331?s=128&d=identicon&r=PG&f=1", "display_name": "William GP", "link": "https://stackoverflow.com/users/5342853/william-gp"}, "edited": false, "score": 0, "creation_date": 1554160296, "post_id": 41766545, "comment_id": 97641483, "body": "Shouldn&#39;t you be using <code>d2i_PrivateKey_bio</code> for the private key?"}], "tags": [], "owner": {"reputation": 1269, "user_id": 7264553, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/COdkO.jpg?s=128&g=1", "display_name": "Hassan Shahbazi", "link": "https://stackoverflow.com/users/7264553/hassan-shahbazi"}, "is_accepted": false, "score": 1, "last_activity_date": 1484924421, "creation_date": 1484924421, "answer_id": 41766545, "question_id": 41138104, "link": "https://stackoverflow.com/questions/41138104/convert-seckeyref-to-ec-key-in-ios/41766545#41766545", "title": "Convert SecKeyRef to EC_KEY in iOS", "body": "<p>You can change private key from <code>SecKeyRef</code> to <code>NSData</code></p>\n\n<p>Example:</p>\n\n<pre><code>- (NSData *)getPrivateKeyBits {\n    OSStatus sanityCheck = noErr;\n    NSData * privateKeyBits = nil;\n\n    NSMutableDictionary * queryPrivateKey = [[NSMutableDictionary alloc] init];\n\n    // Set the public key query dictionary.\n\n    [queryPrivateKey setObject:(id)kSecClassKey forKey:(id)kSecClass];\n    [queryPrivateKey setObject:_privateTag forKey:(id)kSecAttrApplicationTag];\n    [queryPrivateKey setObject:(id)kSecAttrKeyTypeEC forKey:(id)kSecAttrKeyType];\n    [queryPrivateKey setObject:[NSNumber numberWithBool:YES] forKey:(id)kSecReturnData];\n\n    // Get the key bits.\n    sanityCheck = SecItemCopyMatching((__bridge CFDictionaryRef)queryPrivateKey, (void *)&amp;privateKeyBits);\n\n    if (sanityCheck != noErr) {\n        privateKeyBits = nil;\n    }\n    else if (sanityCheck == errSecItemNotFound) {\n        privateKeyBits = nil;\n    }\n\n    return privateKeyBits;\n}\n</code></pre>\n\n<p>Don't forget to use the <code>_privateTag</code> used for generating private key</p>\n\n<p>now you can use:</p>\n\n<pre><code>const unsigned char *bitsOfKeyDataPrivateKey = (unsigned char *) [[self getPrivateKeyBits] bytes];\nEC_KEY *_ec_keyPrivate = d2i_EC_PUBKEY(NULL,&amp;bitsOfKeyDataPrivateKey, privateKeyLegnth);\n</code></pre>\n"}], "owner": {"reputation": 2815, "user_id": 671060, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/ea8b261a6e02873eab5a616f1bf62ef0?s=128&d=identicon&r=PG", "display_name": "Aleem", "link": "https://stackoverflow.com/users/671060/aleem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484924421, "creation_date": 1481704748, "question_id": 41138104, "link": "https://stackoverflow.com/questions/41138104/convert-seckeyref-to-ec-key-in-ios", "title": "Convert SecKeyRef to EC_KEY in iOS", "body": "<p>I'm creating CSR from openSSL but due to OpenSSL isn't storing keys in secure enclave so I chooses objective C to create key pair (private key and public key) in secure enclave and send to OpenSSL for X509 certificate. I get successfully public key in NSData and then convert <code>const unsigned char * bitsOfKeyDataPublicKey = (unsigned char *) [publicKey bytes];</code> and then create public key <code>EC_KEY*_ec_keyPublic = d2i_EC_PUBKEY(NULL,&amp;bitsOfKeyDataPublicKey, publicKeyLegnth);</code>. But For Private key we get <code>SecKeyRef</code> from objective c so for creation <code>EC_Key</code> how can we convert private key or is this any way to convert or use private key ?\nLooking for response.\nThanks</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481703998, "post_id": 41137853, "comment_id": 69478944, "body": "<code>&amp;str[i]</code> is incorrect and you don&#39;t allocate any memory for the strings either."}, {"owner": {"reputation": 3697, "user_id": 1848578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7e2bfa9bcb3299428c8321c37db0560?s=128&d=identicon&r=PG", "display_name": "qxz", "link": "https://stackoverflow.com/users/1848578/qxz"}, "edited": false, "score": 0, "creation_date": 1481704053, "post_id": 41137853, "comment_id": 69478983, "body": "Related: <a href=\"http://stackoverflow.com/questions/5406935/reading-a-string-with-scanf\">Reading a string with scanf</a>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481704485, "post_id": 41137853, "comment_id": 69479231, "body": "<a href=\"http://ideone.com/dmsf4U\" rel=\"nofollow noreferrer\">simple code</a>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481704683, "post_id": 41137853, "comment_id": 69479340, "body": "<code>char str[MAX];</code> is 1D-Array. Why do you think it is different?"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1481706632, "post_id": 41137853, "comment_id": 69480400, "body": "Have you ever heard about Array of Pointers, or moreover about Pointers?"}], "answers": [{"tags": [], "owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "is_accepted": false, "score": 3, "last_activity_date": 1481703875, "creation_date": 1481703875, "answer_id": 41137892, "question_id": 41137853, "link": "https://stackoverflow.com/questions/41137853/why-i-can-not-use-the-inputted-value-from-one-dimensional-array-in-c/41137892#41137892", "title": "Why I can not use the inputted value from one-dimensional array, in C?", "body": "<p>In this array: <code>char * str[MAX]</code></p>\n\n<p>None of the entries is initialized to point to a valid (properly allocated) memory block.</p>\n\n<p>And so you should not <code>scanf(\"%s\", &amp;str[i])</code> until you have initialized entry #<code>i</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1481707311, "post_id": 41137922, "comment_id": 69480789, "body": "What&#39;s wrong with scanf? It is almost always wrong used."}], "tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 1, "last_activity_date": 1481703982, "creation_date": 1481703982, "answer_id": 41137922, "question_id": 41137853, "link": "https://stackoverflow.com/questions/41137853/why-i-can-not-use-the-inputted-value-from-one-dimensional-array-in-c/41137922#41137922", "title": "Why I can not use the inputted value from one-dimensional array, in C?", "body": "<pre><code>char * str[MAX];\n</code></pre>\n\n<p><code>str</code> is an array of pointers. You should allocate memory to pointers before writing anything to it.</p>\n\n<pre><code>str[i] = malloc(20);/* Showing an example of using malloc() . How much memory should be allocated is left to you */\n</code></pre>\n\n<p>Using a <code>scanf()</code> to scan a string is not a good idea I would rather prefer <code>fgets()</code></p>\n"}], "owner": {"reputation": 1, "user_id": 7295262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/def4a6aa6c249e02fed8ec2f19c28a9e?s=128&d=identicon&r=PG&f=1", "display_name": "j1496002", "link": "https://stackoverflow.com/users/7295262/j1496002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1481704032, "answer_count": 2, "score": -2, "last_activity_date": 1504447409, "creation_date": 1481703733, "last_edit_date": 1504447409, "question_id": 41137853, "link": "https://stackoverflow.com/questions/41137853/why-i-can-not-use-the-inputted-value-from-one-dimensional-array-in-c", "closed_reason": "Duplicate", "title": "Why I can not use the inputted value from one-dimensional array, in C?", "body": "<p>I understand that: I can use a <strong>two-dimensional</strong> array for storaging many strings. But, I would like to solve this problem with <strong>one-dimensional</strong>; so, please <strong>do not</strong> advise me to use <strong>two-dimensional</strong> array for solving.</p>\n\n<hr>\n\n<p>I have a small <strong>one-dimensional</strong> array, which is used for storaging many strings. Here is all of source code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid main()\n{\n    #define MAX 10\n\n    int N = 3;\n\n    char * str[MAX];\n\n    printf(\"Input a string in each line:\\n\\n\");\n\n    for (int i = 0; i &lt; N; i++)\n    {\n        printf(\"str[%d] = \", i);\n         gets(str[i]);\n    }\n\n    printf(\"\\n\\n---\\n\\nExport the list of strings:\\n\\n\");\n\n    for (int j = 0; j &lt; N; j++)\n    {\n        printf(\"str[%d] = \", j);\n        printf(\"%s\\n\", str[j]);\n    }\n\n}\n</code></pre>\n\n<p>When I compile it, the compiler <strong>does not</strong> return any error or warning. But, after I inputted the data, there is an error message from Windows:</p>\n\n<blockquote>\n  <p>A problem caused the program to stop working correctly</p>\n</blockquote>\n\n<p>Then, my program is broken.</p>\n"}, {"tags": ["c++", "c", "algorithm"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 7, "creation_date": 1481703113, "post_id": 41137638, "comment_id": 69478495, "body": "<code>clrscr()</code> isn&#39;t a standard c++ function."}, {"owner": {"reputation": 45, "user_id": 7169745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48a8de363ce4e168204c0b4c2fc56920?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7169745/gab"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1481703594, "post_id": 41137638, "comment_id": 69478737, "body": "What other function can I use?"}, {"owner": {"reputation": 22187, "user_id": 193892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6178b59305359920a922edd061a55e7a?s=128&d=identicon&r=PG", "display_name": "Prof. Falken", "link": "https://stackoverflow.com/users/193892/prof-falken"}, "edited": false, "score": 3, "creation_date": 1481703821, "post_id": 41137638, "comment_id": 69478860, "body": "There is no standard way of clearing the screen. It depends on which development environment, libraries etc you have. You need to figure something out.  If all else fails, you can do lots of <code>printf(&quot;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n&quot;);</code> to sort of &quot;clear&quot; the screen."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481710559, "post_id": 41137638, "comment_id": 69482790, "body": "Please read how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> - the code you have posted is far from minimal, and most of it is irrelevant to the problem you&#39;re describing.  It&#39;s much easier to offer assistance if you present a targeted sample code."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1481710624, "post_id": 41137638, "comment_id": 69482827, "body": "Multiple duplicates, e.g. <a href=\"http://stackoverflow.com/questions/21750450/undefined-refrence-to-clrscr\" title=\"undefined refrence to clrscr\">stackoverflow.com/questions/21750450/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/3226329/function-clrscr-in-c-and-c\" title=\"function clrscr in c and c\">stackoverflow.com/questions/3226329/function-clrscr-in-c-and&zwnj;&#8203;-c</a>"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1481710708, "post_id": 41137638, "comment_id": 69482885, "body": "As an aside, why do you think that a program needs to clear the screen?  Assuming that you have a screen, it&#39;s quite rude for a program to unilaterally overwrite the output of previous commands, that might still be relevant.  And there are many situations in which you won&#39;t have a screen, depending on how your i/o is connected (e.g. to pipe or to file)."}], "answers": [{"comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1481705861, "post_id": 41137983, "comment_id": 69479962, "body": "<i>Note</i>: On <i>Ux</i>, instead of <a href=\"http://ss64.com/nt/cls.html\" rel=\"nofollow noreferrer\">CLS</a> you could run <a href=\"https://linux.die.net/man/1/clear\" rel=\"nofollow noreferrer\">clear</a> (there are other ways or commands, but this seems the simplest one)."}, {"owner": {"reputation": 73, "user_id": 5575038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0280fd40d6f663c8d36e61d4c5fdbf59?s=128&d=identicon&r=PG&f=1", "display_name": "asmcriminal", "link": "https://stackoverflow.com/users/5575038/asmcriminal"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1481706300, "post_id": 41137983, "comment_id": 69480187, "body": "@CristiFati I never coded C++ on Unix/Linux. Do you need a header file for clear()?"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1481711410, "post_id": 41137983, "comment_id": 69483293, "body": "<i>clear</i> is <i>CLS</i>&#39;s counterpart: it&#39;s a shell command, so you call it similarly from <i>C</i> / <i>C++</i> (like you did for <i>CLS</i>: via <code>system</code>)."}], "tags": [], "owner": {"reputation": 73, "user_id": 5575038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0280fd40d6f663c8d36e61d4c5fdbf59?s=128&d=identicon&r=PG&f=1", "display_name": "asmcriminal", "link": "https://stackoverflow.com/users/5575038/asmcriminal"}, "is_accepted": false, "score": 1, "last_activity_date": 1481710372, "last_edit_date": 1481710372, "creation_date": 1481704246, "answer_id": 41137983, "question_id": 41137638, "link": "https://stackoverflow.com/questions/41137638/why-do-i-got-error-in-clrscr-it-says-undefined/41137983#41137983", "title": "Why do I got error in clrscr(); it says undefined?", "body": "<p>I coded a little example for you. I am assuming you're running on windows. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\n#include &lt;stdio.h&gt; // include this for the clear\n\nint main()\n{\n  string usersInput;\n  cout &lt;&lt;\"Enter string: \";\n  getline(cin,usersInput);\n\n  cout &lt;&lt; \"The string is: \" &lt;&lt; usersInput &lt;&lt; endl;\n\n  cout &lt;&lt; \"Press Enter to clear screen.\";\n\n  cin.ignore();\n  system(\"CLS\"); // this clears the screen\n\n  cin.ignore();\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7169745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48a8de363ce4e168204c0b4c2fc56920?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7169745/gab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4351, "favorite_count": 0, "closed_date": 1481710557, "answer_count": 1, "score": -1, "last_activity_date": 1481710372, "creation_date": 1481702993, "last_edit_date": 1481708857, "question_id": 41137638, "link": "https://stackoverflow.com/questions/41137638/why-do-i-got-error-in-clrscr-it-says-undefined", "closed_reason": "Duplicate", "title": "Why do I got error in clrscr(); it says undefined?", "body": "<p>I'm trying to clear my screen in C++, but I can't compile this code...</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n#include&lt;conio.h&gt;\n\n#include&lt;stdio.h&gt;\n\nclass cpuschedule\n{\n    int n, bu[20];\n\n    float twt, awt, wt[20], tat[20];\n\npublic:\n\n    void Getdata();\n\n    void fcfs();\n\n    void sjf();\n\n    void roundrobin();\n\n};\n\n//Getting no of processes and Burst time\n\nvoid cpuschedule::Getdata()\n{\n    int i;\n\n    cout &lt;&lt; \"Enter the no of processes : \";\n\n    cin &gt;&gt; n;\n\n    for (i = 1; i &lt;= n; i++)\n    {\n        cout &lt;&lt; \"\\nEnter The BurstTime for Process p\"&lt;&lt; i &lt;&lt; \" = \";\n\n        cin &gt;&gt; bu[i];\n    }\n\n}\n\n//First come First served Algorithm\n\nvoid cpuschedule::fcfs()\n{\n    int i, b[10];\n\n    float sum = 0.0;\n\n    twt = 0.0;\n\n    for (i = 1; i &lt;= n; i++)\n    {\n        b[i] = bu[i];\n\n        cout &lt;&lt; \"\\nBurst time for process p\"&lt;&lt; i &lt;&lt; \" = \";\n\n        cout &lt;&lt; b[i];\n    }\n\n    wt[1] = 0;\n\n    for (i = 2; i &lt;= n; i++)\n    {\n        wt[i] = b[i - 1] + wt[i - 1];\n    }\n\n    for (i = 1; i &lt;= n; i++)\n    {\n        twt = twt + wt[i];\n\n        tat[i] = b[i] + wt[i];\n\n        sum += tat[i];\n    }\n\n    awt = twt / n;\n    sum = sum / n;\n\n    cout &lt;&lt; \"\\nTotal Waiting Time = \" &lt;&lt; twt;\n\n    cout &lt;&lt; \"\\nAverage Waiting Time = \" &lt;&lt; awt;\n\n    cout &lt;&lt; \"\\nAverage Turnaround time = \" &lt;&lt; sum;\n\n}\n\n//Shortest job First Algorithm\n\nvoid cpuschedule::sjf()\n{\n\n    int i, j, temp, b[10];\n\n    float sum = 0.0;\n\n    twt = 0.0;\n\n    for (i = 1; i &lt;= n; i++)\n    {\n        b[i] = bu[i];\n\n        cout &lt;&lt; \"\\nBurst time for process p\" &lt;&lt; i &lt;&lt; \" = \";\n\n        cout &lt;&lt; b[i];\n    }\n\n    for (i = n; i &gt;= 1; i-)\n    {\n        for (j = 2; j &lt;= n; j++)\n        {\n            if (b[j - 1]&gt;b[j])\n            {\n                temp = b[j - 1];\n\n                b[j - 1] = b[j];\n\n                b[j] = temp;\n            }\n        }\n    }\n\n    wt[1] = 0;\n\n    for (i = 2; i &lt;= n; i++)\n    {\n        wt[i] = b[i - 1] + wt[i - 1];\n    }\n\n    for (i = 1; i &lt;= n; i++)\n    {\n        twt = twt + wt[i];\n\n        tat[i] = b[i] + wt[i];\n\n        sum += tat[i];\n    }\n\n    awt = twt / n;\n    sum = sum / n;\n\n    cout &lt;&lt; \"\\nTotal Waiting Time = \" &lt;&lt; twt;\n\n    cout &lt;&lt; \"\\nAverage Waiting Time = \" &lt;&lt; awt;\n\n    cout &lt;&lt; \"\\nAverage turnaround time = \" &lt;&lt; sum;\n}\n\n//Round Robin Algorithm\n\nvoid cpuschedule::roundrobin()\n{\n    int i, j, tq, k, b[10], Rrobin[10][10], count[10];\n\n    int max = 0;\n\n    int m;\n\n    float sum = 0.0;\n\n    twt = 0.0;\n\n    for (i = 1; i &lt;= n; i++)\n    {\n        b[i] = bu[i];\n\n        cout &lt;&lt; \"\\nBurst time for process p\" &lt;&lt; i &lt;&lt; \" = \";\n\n        cout &lt;&lt; b[i];\n\n        if (max&lt;b[i])\n\n            max = b[i];\n\n        wt[i] = 0;\n    }\n\n    cout &lt;&lt; \"\\nEnter the Time Quantum = \";\n\n    cin &gt;&gt; tq;\n\n    //TO find the dimension of the Round robin array\n\n    m = max / tq + 1;\n\n    //initializing Round robin array\n\n    for (i = 1; i &lt;= n; i++)\n    {\n        for (j = 1; j &lt;= m; j++)\n        {\n            Rrobin[i][j] = 0;\n        }\n    }\n\n    //placing value in the Rrobin array\n\n    i = 1;\n\n    while (i &lt;= n)\n    {\n        j = 1;\n\n        while (b[i]&gt;0)\n        {\n            if (b[i] &gt;= tq)\n            {\n                b[i] = b[i] - tq;\n\n                Rrobin[i][j] = tq;\n\n                j++;\n            }\n            else\n            {\n                Rrobin[i][j] = b[i];\n\n                b[i] = 0;\n\n                j++;\n            }\n        }\n\n        count[i] = j - 1;\n\n        i++;\n    }\n\n    cout &lt;&lt;\" Display\";\n\n    for (i = 1; i &lt;= n; i++)\n    {\n        for (j = 1; j &lt;= m; j++)\n        {\n            cout &lt;&lt; \"\\nRr[\" &lt;&lt; i &lt;&lt; \", \" &lt;&lt; j &lt;&lt; \"] = \" &lt;&lt; Rrobin[i][j];\n\n            cout &lt;&lt; \"     \";\n        }\n        cout &lt;&lt; \"\\ncount = \" &lt;&lt; count[i];\n    }\n\n    for (j = 1; j &lt;= n; j++)\n    {\n        for (i = 1; i &lt;= count[j]; i++)\n        {\n            if (i == count[j])\n            {\n                for (k = 1; k&lt;j; k++)\n                {\n                    if (k != j)\n\n                        wt[j] += Rrobin[k][i];\n                }\n            }\n\n            else\n\n            for (k = 1; k &lt;= n; k++)\n            {\n\n                if (k != j)\n\n                    wt[j] += Rrobin[k][i];\n            }\n        }\n    }\n\n    for (i = 1; i &lt;= n; i++)\n        cout &lt;&lt; \"\\nWaiting Time for process P\" &lt;&lt; i &lt;&lt; \" = \" &lt;&lt; wt[i];\n\n    //calculating Average Weighting Time\n\n    for (i = 1; i &lt;= n; i++)\n    {\n        twt = twt + wt[i];\n\n        tat[i] = b[i] + wt[i];\n\n        sum += tat[i];\n    }\n\n    awt = twt / n;\n    sum = sum / n;\n\n    cout &lt;&lt; \"\\nTotal Waiting Time = \" &lt;&lt; twt;\n\n    cout &lt;&lt; \"\\nAverage Waiting Time = \" &lt;&lt; awt;\n\n    cout &lt;&lt; \"\\nAverage turnaround time = \" &lt;&lt; sum;\n\n}\n\nvoid main()\n{\n    int ch = 0, cho;\n\n    cpuschedule c;\n\n    clrscr();\n\n    do\n    {\n        switch (ch)\n        {\n\n        case 0:\n\n            cout &lt;&lt; \"\\n0.MENU\";\n\n            cout &lt;&lt; \"\\n1.Getting BurstTime\";\n\n            cout &lt;&lt; \"\\n2.FirstComeFirstServed\";\n\n            cout &lt;&lt; \"\\n3.ShortestJobFirst\";\n\n            cout &lt;&lt; \"\\n4.RoundRobin\";\n\n            cout &lt;&lt; \"\\n5.EXIT\";\n\n            break;\n\n        case 1:\n            c.Getdata();\n            break;\n\n        case 2:\n            cout &lt;&lt; \"FIRST COME FIRST SERVED SCHEDULING\";\n\n            c.fcfs();\n            break;\n\n        case 3:\n            cout &lt;&lt; \"SHORTEST JOB FIRST SCHEDULING\";\n            c.sjf();\n            break;\n\n        case 4:\n            cout &lt;&lt; \"ROUND ROBIN SCHEDULING\";\n            c.roundrobin();\n            break;\n\n        case 5:\n            break;\n\n        }\n\n        cout &lt;&lt; \"\\nEnter your choice : \";\n\n        cin &gt;&gt; ch;\n\n        getch();\n\n    } while (ch&lt;5);\n}\n</code></pre>\n\n<p>Here is the compiler error:</p>\n\n<blockquote>\n  <p>clrscr is undefined</p>\n</blockquote>\n"}, {"tags": ["c", "parsing", "compiler-errors", "include"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481701915, "post_id": 41137221, "comment_id": 69477925, "body": "The type-specifier for the declarator must be <code>unsigned int</code>, <code>signed int</code>, or <code>int</code>,"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481702205, "post_id": 41137221, "comment_id": 69478058, "body": "I don&#39;t understand. Are you saying the types here are wrong?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481702660, "post_id": 41137221, "comment_id": 69478273, "body": "try <code>unsigned   A:1, B:1, C:6;</code> (<code>unsigned char</code> GCC extension)"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481702914, "post_id": 41137221, "comment_id": 69478403, "body": "but I use unsigned char all over the project"}], "answers": [{"comments": [{"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1481703707, "post_id": 41137792, "comment_id": 69478794, "body": "1) if this is true then my 2nd error is just a by-product of the 1st?        2) I checked the files for &quot;100&quot; and didn&#39;t see any hits :( but I guess the token can be hiding in some other file included"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 1, "creation_date": 1481725532, "post_id": 41137792, "comment_id": 69492374, "body": "@noob: also, you can get a list of <code>#define</code>d symbols with gcc, or you can just grep all your headers; the former is more accurate, but the latter tells you where the defines are."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 2, "last_activity_date": 1481703522, "creation_date": 1481703522, "answer_id": 41137792, "question_id": 41137221, "link": "https://stackoverflow.com/questions/41137221/parse-error-caused-by-include-of-a-good-file/41137792#41137792", "title": "parse error caused by include of a good file", "body": "<p>Probably the header which causes the problem contains something like</p>\n\n<pre><code>#define A 100\n</code></pre>\n\n<p>which changes the meaning of the token <code>A</code>.</p>\n\n<p>That will only cause issues if the macro defined in the header is inadvertently used in another file; by themselves, the header and the other file are unproblematic.</p>\n"}], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "accepted_answer_id": 41137792, "answer_count": 1, "score": -1, "last_activity_date": 1481704777, "creation_date": 1481701352, "last_edit_date": 1592644375, "question_id": 41137221, "link": "https://stackoverflow.com/questions/41137221/parse-error-caused-by-include-of-a-good-file", "title": "parse error caused by include of a good file", "body": "<p>I'm debugging a very large project and I added in one file: <code>&quot;file_1.c&quot;</code> an include statement for another file <code>#include &quot;header_2.h&quot;</code>. I got 2 compilation errors:</p>\n<blockquote>\n<p>error (dcc:1633): parse error  near '100'   (Built from Project 'project_3')</p>\n<p>error (dcc:1100): member is incomplete   (Built from Project 'project_3')</p>\n</blockquote>\n<p>but the locations of the errors didn't make sense, because the code there was part of a typedef:</p>\n<pre><code>typedef struct \n{\n unsigned char    A:1,       // &lt;- first error here  (dcc:1633)\n                  B:1,        \n                  C:6;          \n}TYPE_A;\n\ntypedef struct\n{\n TYPE_A         D;        // &lt;- second error here  (dcc:1100)   \n TYPE_B         E; \n TYPE_C         F;         \n}FOO_T;\n</code></pre>\n<p>Now, this header <code>header_2.h</code> is included in other c files and gave me no problems.</p>\n<p>I thought that the case here could be circular include but I checked the header and there are include guards there. Once I remove the include, the parse errors disappeared and the compilation run OK (since the include was planted there for some code piece I removed).</p>\n<p>I also checked the actual include line (in file_1.c) to see if maybe there was a parse error there, but nope.</p>\n<p>What can cause this problem and how should I handle it?</p>\n<p><strong>Note: the header itself is error free. It is included in other c files and shows no errors there. Also, without this specific include, the compiler runs fine.</strong></p>\n"}, {"tags": ["c++", "c", "linux", "gcc", "shared-libraries"], "comments": [{"owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "edited": false, "score": 1, "creation_date": 1481700304, "post_id": 41136859, "comment_id": 69477158, "body": "Do you have any other c++ compile than g++ installed?"}, {"owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "edited": false, "score": 1, "creation_date": 1481700337, "post_id": 41136859, "comment_id": 69477172, "body": "Don&#39;t mix and match compilers, the name mangling won&#39;t match. Compile both the lib and <code>main.c</code> with either <code>gcc</code>, or <code>g++</code>, not both. You could also wrap the declarations with <code>extern &quot;C&quot;</code> and appropriate compiler guards if you really do need to use the lib in both C and C++."}, {"owner": {"reputation": 17784, "user_id": 1646322, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d9fd7a75e0d8ace7bb3276476786c2c0?s=128&d=identicon&r=PG", "display_name": "Ruslan Osmanov", "link": "https://stackoverflow.com/users/1646322/ruslan-osmanov"}, "edited": false, "score": 0, "creation_date": 1481701811, "post_id": 41136859, "comment_id": 69477864, "body": "<code>&#47;usr&#47;bin&#47;c++</code> is a standard name for C++ compiler. It can be any compiler on your system. For example, on my system it is the same as <code>g++</code>. You can check it with <code>ls -l &#47;usr&#47;bin&#47;{g,c}++</code>. On some systems <code>c++</code> is a symlink to <code>g++</code>. On my system it is just a copy of g++ (checked with <code>md5sum &#47;usr&#47;bin&#47;{g,c}++</code>). So it is impossible to answer unless you tell us which compiler is disguised under <code>&#47;usr&#47;bin&#47;c++</code>. By the way, the commands work with <code>g++</code>, so it is unlikely that your <code>c++</code> is <code>g++</code>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1481702573, "post_id": 41136859, "comment_id": 69478235, "body": "C and C++ are different languages. If you compile the library with a C compiler and your code with a C++ compiler, you need to ensure that the library&#39;s functions are declared with C linkage in C++."}, {"owner": {"reputation": 233, "user_id": 2740810, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a57640ab007f27018533bad43fd781c1?s=128&d=identicon&r=PG", "display_name": "phuong", "link": "https://stackoverflow.com/users/2740810/phuong"}, "edited": false, "score": 0, "creation_date": 1481703441, "post_id": 41136859, "comment_id": 69478657, "body": "I don&#39;t understand. /usr/bin/c++ is compiler in C++ right. If I change anything from C to Cpp. I also meet with the same problem."}, {"owner": {"reputation": 233, "user_id": 2740810, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a57640ab007f27018533bad43fd781c1?s=128&d=identicon&r=PG", "display_name": "phuong", "link": "https://stackoverflow.com/users/2740810/phuong"}, "reply_to_user": {"reputation": 17784, "user_id": 1646322, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d9fd7a75e0d8ace7bb3276476786c2c0?s=128&d=identicon&r=PG", "display_name": "Ruslan Osmanov", "link": "https://stackoverflow.com/users/1646322/ruslan-osmanov"}, "edited": false, "score": 0, "creation_date": 1481704478, "post_id": 41136859, "comment_id": 69479227, "body": "@RuslanOsmanov: Here is the link of my C++:  /usr/bin/c++ -&gt; /etc/alternatives/c++.  So please help me compile this shared library by /usr/bin/c++"}, {"owner": {"reputation": 17784, "user_id": 1646322, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d9fd7a75e0d8ace7bb3276476786c2c0?s=128&d=identicon&r=PG", "display_name": "Ruslan Osmanov", "link": "https://stackoverflow.com/users/1646322/ruslan-osmanov"}, "edited": false, "score": 0, "creation_date": 1481704962, "post_id": 41136859, "comment_id": 69479511, "body": "@JameLenon, once again: <code>cd &#47;etc&#47;alternatives; ls -l c++</code>"}, {"owner": {"reputation": 233, "user_id": 2740810, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a57640ab007f27018533bad43fd781c1?s=128&d=identicon&r=PG", "display_name": "phuong", "link": "https://stackoverflow.com/users/2740810/phuong"}, "reply_to_user": {"reputation": 17784, "user_id": 1646322, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d9fd7a75e0d8ace7bb3276476786c2c0?s=128&d=identicon&r=PG", "display_name": "Ruslan Osmanov", "link": "https://stackoverflow.com/users/1646322/ruslan-osmanov"}, "edited": false, "score": 0, "creation_date": 1481705427, "post_id": 41136859, "comment_id": 69479746, "body": "@RuslanOsmanov: c++ -&gt; /usr/bin/g++"}], "answers": [{"comments": [{"owner": {"reputation": 17784, "user_id": 1646322, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d9fd7a75e0d8ace7bb3276476786c2c0?s=128&d=identicon&r=PG", "display_name": "Ruslan Osmanov", "link": "https://stackoverflow.com/users/1646322/ruslan-osmanov"}, "edited": false, "score": 0, "creation_date": 1481700616, "post_id": 41136999, "comment_id": 69477288, "body": "<i>&quot;gcc is a C compiler while g++ is a C++ compiler&quot;</i> - GCC is C <i>and</i> C++ compiler. Read <i>NAME</i> section from the man page."}, {"owner": {"reputation": 1620, "user_id": 902384, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/46da49256462126dbe77187c073aa6c6?s=128&d=identicon&r=PG", "display_name": "Shiv", "link": "https://stackoverflow.com/users/902384/shiv"}, "reply_to_user": {"reputation": 17784, "user_id": 1646322, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d9fd7a75e0d8ace7bb3276476786c2c0?s=128&d=identicon&r=PG", "display_name": "Ruslan Osmanov", "link": "https://stackoverflow.com/users/1646322/ruslan-osmanov"}, "edited": false, "score": 0, "creation_date": 1481704696, "post_id": 41136999, "comment_id": 69479350, "body": "I know gcc means GNU Compiler Collection. Historically, gcc is the command for C language."}], "tags": [], "owner": {"reputation": 1620, "user_id": 902384, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/46da49256462126dbe77187c073aa6c6?s=128&d=identicon&r=PG", "display_name": "Shiv", "link": "https://stackoverflow.com/users/902384/shiv"}, "is_accepted": false, "score": 1, "last_activity_date": 1481700363, "creation_date": 1481700363, "answer_id": 41136999, "question_id": 41136859, "link": "https://stackoverflow.com/questions/41136859/usr-bin-c-not-compile-as-gcc-with-shared-library/41136999#41136999", "title": "/usr/bin/C++ not compile as gcc with Shared library", "body": "<p>The problem is coming probably because of name mangling of C++. /usr/bin/c++ ends up as /usr/bin/g++. gcc is a C compiler while g++ is a C++ compiler. You need to compile your library libfoo.so with g++ and then try to link. It should work.</p>\n"}, {"tags": [], "owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "is_accepted": true, "score": 2, "last_activity_date": 1481703081, "creation_date": 1481703081, "answer_id": 41137669, "question_id": 41136859, "link": "https://stackoverflow.com/questions/41136859/usr-bin-c-not-compile-as-gcc-with-shared-library/41137669#41137669", "title": "/usr/bin/C++ not compile as gcc with Shared library", "body": "<p>As others said, this is because different symbol naming between C and C++ compiled libraries, As C++ have overloaded functions the naming for each symbol should include type of arguments in symbol name or something which identifies the actual function or class method based on its arguments.\nUnlike C++, C doesn't have this issue, because of no function overloading and its standard ABI. if you want mix C/C++ files you have to compile all the C &amp; C++ codes with g++ and also add extern C keyword to definition of C codes</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n// your C definitions (only function definitions) goes here\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7295097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/257470dd0c005972c2f3e324584fc5ec?s=128&d=identicon&r=PG&f=1", "display_name": "strikr", "link": "https://stackoverflow.com/users/7295097/strikr"}, "is_accepted": false, "score": -1, "last_activity_date": 1481705021, "creation_date": 1481705021, "answer_id": 41138164, "question_id": 41136859, "link": "https://stackoverflow.com/questions/41136859/usr-bin-c-not-compile-as-gcc-with-shared-library/41138164#41138164", "title": "/usr/bin/C++ not compile as gcc with Shared library", "body": "<p>What is the version of gcc and c++ you are using ?</p>\n\n<p>Ideally within the <em>same</em> compiler tool-chain family there should be no error. </p>\n\n<p>In fact, i wrote the code, compiled and executed the same example without any issues.</p>\n\n<p>Please note the version of gcc/c++ i am using.</p>\n\n<pre><code>gcc (GCC) 6.2.1 20160830\ng++ (GCC) 6.2.1 20160830\n</code></pre>\n\n<p>i wrote a shell script file to execute the commands</p>\n\n<pre><code>strace c++ -c -Wall -Werror -fpic foo.c\nstrace c++ -shared -o libfoo.so foo.o\nstrace c++ -L. -Wall -o test main.c -lfoo\n</code></pre>\n\n<p>and collected the strace output of the compilation and linking. Please see the link below\n<a href=\"http://pastebin.com/nJpQuCfS\" rel=\"nofollow noreferrer\">http://pastebin.com/nJpQuCfS</a></p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 233, "user_id": 2740810, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a57640ab007f27018533bad43fd781c1?s=128&d=identicon&r=PG", "display_name": "phuong", "link": "https://stackoverflow.com/users/2740810/phuong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "accepted_answer_id": 41137669, "answer_count": 3, "score": 0, "last_activity_date": 1481705021, "creation_date": 1481699759, "question_id": 41136859, "link": "https://stackoverflow.com/questions/41136859/usr-bin-c-not-compile-as-gcc-with-shared-library", "title": "/usr/bin/C++ not compile as gcc with Shared library", "body": "<p>I try to work on shared library. </p>\n\n<p>In detail, I following this link:\n<a href=\"http://www.cprogramming.com/tutorial/shared-libraries-linux-gcc.html\" rel=\"nofollow noreferrer\">http://www.cprogramming.com/tutorial/shared-libraries-linux-gcc.html</a>.</p>\n\n<p>Everything ok with this command:</p>\n\n<pre><code>$ gcc -L/home/user/foo -Wl,-rpath=/home/user/foo -Wall -o test main.c -lfoo\n$ ./test\n</code></pre>\n\n<p>But when i change from gcc to /usr/bin/c++, ANd change commands to:</p>\n\n<pre><code>$ /usr/bin/c++ -L/home/user/foo -Wl,-rpath=/home/user/foo -Wall -o test2 main.c -lfoo\n/tmp/ccpEHbNV.o: In function `main':\nmain.c:(.text+0x16): undefined reference to `foo()'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>It can't find the method foo in my libfoo.so.</p>\n\n<p>I also try by another way with -rdynamic, It also work well with gcc:</p>\n\n<pre><code>gcc -rdynamic ./libfoo.so -Wl,-rpath=/home/user/foo -Wall -o test main.c -lfoo\n</code></pre>\n\n<p>But It also have the same error with /usr/bin/c++.</p>\n\n<p>Please show me how to make it work with /usr/bin/c++.</p>\n\n<p>Thank a lot.</p>\n"}, {"tags": ["c", "assembly", "x86", "att"], "answers": [{"comments": [{"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 3, "creation_date": 1481716631, "post_id": 41138744, "comment_id": 69486489, "body": "&quot;if we give the C code above to gcc we obtain back exactly the assembly you provided.&quot; -&gt; perfect reverse engineering. Great answer!"}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 11, "last_activity_date": 1481719505, "last_edit_date": 1495540801, "creation_date": 1481706892, "answer_id": 41138744, "question_id": 41136663, "link": "https://stackoverflow.com/questions/41136663/deciphering-x86-assembly-function/41138744#41138744", "title": "Deciphering x86 assembly function", "body": "<pre><code>  400f2a:   85 ff                   test   %edi,%edi\n  400f2c:   74 1d                   je     400f4b &lt;func2a+0x21&gt;\n</code></pre>\n\n<p>This is just an early exit for when <code>edi</code> is zero (<code>je</code> is the same as <code>jz</code>).</p>\n\n<pre><code>  400f2e:   b9 cd cc cc cc          mov    $0xcccccccd,%ecx\n  400f33:   89 f8                   mov    %edi,%eax\n  400f35:   f7 e1                   mul    %ecx\n  400f37:   c1 ea 03                shr    $0x3,%edx\n</code></pre>\n\n<p>This is a classic optimization trick; it is the integer arithmetic equivalent of dividing by multiplying by the inverse (see <a href=\"http://www.flounder.com/multiplicative_inverse.htm\" rel=\"nofollow noreferrer\">here for details</a>); in practice, here it's the same as saying <code>edx = edi / 10</code>; </p>\n\n<pre><code>  400f3a:   8d 04 92                lea    (%rdx,%rdx,4),%eax\n  400f3d:   01 c0                   add    %eax,%eax\n</code></pre>\n\n<p>Here it is exploiting <code>lea</code> to perform arithmetic (and it's way clearer in Intel syntax, where it is <code>lea eax,[rdx+rdx*4]</code> => <code>eax = edx*5</code>), then sums the result with itself. It all boils down to <code>eax = edx*10</code>.</p>\n\n<pre><code>  400f3f:   29 c7                   sub    %eax,%edi\n</code></pre>\n\n<p>Then, subtract it back to <code>edi</code>.</p>\n\n<hr>\n\n<p>So, all in all this is a complicated (but fast) way to compute the last decimal digit of <code>edi</code>; what we have until now is something like:</p>\n\n<pre><code>void func2a(unsigned edi) {\n    if(edi==0) return;\nlabel1:\n    edx=edi/10;\n    edi%=10;\n    // ...\n}\n</code></pre>\n\n<p>(<code>label1:</code> is there because <code>400f33</code> is a jump target later)</p>\n\n<hr>\n\n<p>Going on:</p>\n\n<pre><code>  400f41:   83 04 be 01             addl   $0x1,(%rsi,%rdi,4)\n</code></pre>\n\n<p>Again, this is way clearer to me in Intel syntax - <code>add dword [rsi+rdi*4],byte +0x1</code>. It is a regular increment into an array of 32-bit <code>int</code> (<code>rdi</code> is multiplied by 4); so, we can imagine that <code>rsi</code> points to an array of integers, indexed with the just-calculated last digit of <code>edi</code>.</p>\n\n<pre><code>void func2a(unsigned edi, int rsi[]) {\n    if(edi==0) return;\nlabel1:\n    edx=edi/10;\n    edi%=10;\n    rsi[edi]++;\n}\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>  400f45:   89 d7                   mov    %edx,%edi\n  400f47:   85 d2                   test   %edx,%edx\n  400f49:   75 e8                   jne    400f33 &lt;func2a+0x9&gt;\n</code></pre>\n\n<p>Move the result of the division we calculated above to <code>edi</code>, and loop if it's different from zero.</p>\n\n<pre><code>  400f4b:   f3 c3                   repz retq \n</code></pre>\n\n<p>Return (using <a href=\"https://stackoverflow.com/questions/20526361/what-does-rep-ret-mean\">an unusual encoding of the instruction that is optimal for certain AMD processors</a>).</p>\n\n<hr>\n\n<p>So, by rewriting the jumps with a <code>while</code> loop and giving some meaningful names...</p>\n\n<pre><code>// number is edi, digits_count is rsi, as per regular\n// x64 SystemV calling convention\nvoid count_digits(unsigned number, int digits_count[]) {\n    while(number) {\n        digits_count[number%10]++;\n        number/=10;\n    }\n}\n</code></pre>\n\n<p>I.e., this is a function that, given an integer, counts the occurrences of the single decimal digits, by incrementing the corresponding buckets in the <code>digits_count</code> array.</p>\n\n<hr>\n\n<p>Fun fact: if we give the C code above to <code>gcc</code> (almost any recent version at <code>-O1</code>) <a href=\"https://godbolt.org/g/rZSzIn\" rel=\"nofollow noreferrer\">we obtain back exactly the assembly you provided</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 7294779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24305151c9986ca5e7c87414482bec81?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/7294779/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 41138744, "answer_count": 1, "score": 2, "last_activity_date": 1481719505, "creation_date": 1481699071, "last_edit_date": 1481704382, "question_id": 41136663, "link": "https://stackoverflow.com/questions/41136663/deciphering-x86-assembly-function", "title": "Deciphering x86 assembly function", "body": "<p>I am currently working on phase 2 of the binary bomb assignment. I'm having trouble deciphering exactly what a certain function does when called. I've been stuck on it for days.</p>\n\n<p>The function is:</p>\n\n<pre><code>0000000000400f2a &lt;func2a&gt;:\n  400f2a:   85 ff                   test   %edi,%edi\n  400f2c:   74 1d                   je     400f4b &lt;func2a+0x21&gt;\n  400f2e:   b9 cd cc cc cc          mov    $0xcccccccd,%ecx\n  400f33:   89 f8                   mov    %edi,%eax\n  400f35:   f7 e1                   mul    %ecx\n  400f37:   c1 ea 03                shr    $0x3,%edx\n  400f3a:   8d 04 92                lea    (%rdx,%rdx,4),%eax\n  400f3d:   01 c0                   add    %eax,%eax\n  400f3f:   29 c7                   sub    %eax,%edi\n  400f41:   83 04 be 01             addl   $0x1,(%rsi,%rdi,4)\n  400f45:   89 d7                   mov    %edx,%edi\n  400f47:   85 d2                   test   %edx,%edx\n  400f49:   75 e8                   jne    400f33 &lt;func2a+0x9&gt;\n  400f4b:   f3 c3                   repz retq \n</code></pre>\n\n<p>It gets called in the larger function \"phase_2\":</p>\n\n<pre><code>0000000000400f4d &lt;phase_2&gt;: \n  400f4d:   53                      push   %rbx\n  400f4e:   48 83 ec 60             sub    $0x60,%rsp\n  400f52:   48 c7 44 24 30 00 00    movq   $0x0,0x30(%rsp)\n  400f59:   00 00 \n  400f5b:   48 c7 44 24 38 00 00    movq   $0x0,0x38(%rsp)\n  400f62:   00 00 \n  400f64:   48 c7 44 24 40 00 00    movq   $0x0,0x40(%rsp)\n  400f6b:   00 00 \n  400f6d:   48 c7 44 24 48 00 00    movq   $0x0,0x48(%rsp)\n  400f74:   00 00 \n  400f76:   48 c7 44 24 50 00 00    movq   $0x0,0x50(%rsp)\n  400f7d:   00 00 \n  400f7f:   48 c7 04 24 00 00 00    movq   $0x0,(%rsp)\n  400f86:   00 \n  400f87:   48 c7 44 24 08 00 00    movq   $0x0,0x8(%rsp)\n  400f8e:   00 00 \n  400f90:   48 c7 44 24 10 00 00    movq   $0x0,0x10(%rsp)\n  400f97:   00 00 \n  400f99:   48 c7 44 24 18 00 00    movq   $0x0,0x18(%rsp)\n  400fa0:   00 00 \n  400fa2:   48 c7 44 24 20 00 00    movq   $0x0,0x20(%rsp)\n  400fa9:   00 00 \n  400fab:   48 8d 4c 24 58          lea    0x58(%rsp),%rcx\n  400fb0:   48 8d 54 24 5c          lea    0x5c(%rsp),%rdx\n  400fb5:   be 9e 26 40 00          mov    $0x40269e,%esi\n  400fba:   b8 00 00 00 00          mov    $0x0,%eax\n  400fbf:   e8 6c fc ff ff          callq  400c30 &lt;__isoc99_sscanf@plt&gt;\n  400fc4:   83 f8 02                cmp    $0x2,%eax\n  400fc7:   74 05                   je     400fce &lt;phase_2+0x81&gt;\n  400fc9:   e8 c1 06 00 00          callq  40168f &lt;explode_bomb&gt;\n  400fce:   83 7c 24 5c 64          cmpl   $0x64,0x5c(%rsp)\n  400fd3:   76 07                   jbe    400fdc &lt;phase_2+0x8f&gt;\n  400fd5:   83 7c 24 58 64          cmpl   $0x64,0x58(%rsp)\n  400fda:   77 05                   ja     400fe1 &lt;phase_2+0x94&gt;\n  400fdc:   e8 ae 06 00 00          callq  40168f &lt;explode_bomb&gt;\n  400fe1:   48 8d 74 24 30          lea    0x30(%rsp),%rsi\n  400fe6:   8b 7c 24 5c             mov    0x5c(%rsp),%edi\n  400fea:   e8 3b ff ff ff          callq  400f2a &lt;func2a&gt;\n  400fef:   48 89 e6                mov    %rsp,%rsi\n  400ff2:   8b 7c 24 58             mov    0x58(%rsp),%edi\n  400ff6:   e8 2f ff ff ff          callq  400f2a &lt;func2a&gt;\n  400ffb:   bb 00 00 00 00          mov    $0x0,%ebx\n  401000:   8b 04 1c                mov    (%rsp,%rbx,1),%eax\n  401003:   39 44 1c 30             cmp    %eax,0x30(%rsp,%rbx,1)\n  401007:   74 05                   je     40100e &lt;phase_2+0xc1&gt;\n  401009:   e8 81 06 00 00          callq  40168f &lt;explode_bomb&gt;\n  40100e:   48 83 c3 04             add    $0x4,%rbx\n  401012:   48 83 fb 28             cmp    $0x28,%rbx\n  401016:   75 e8                   jne    401000 &lt;phase_2+0xb3&gt;\n  401018:   48 83 c4 60             add    $0x60,%rsp\n  40101c:   5b                      pop    %rbx\n  40101d:   c3                      retq   \n</code></pre>\n\n<p>I completely understand what phase_2 is doing, I just don't understand what func2a is doing and how it affects the values at 0x30(%rsp) and so on. Because of this I always get to the comparison statement at 0x401003, and the bomb eventually explodes there.</p>\n\n<p>My problem is I don't understand how the input (phase solution) is affecting the values at 0x30(%rsp) via func2a.</p>\n"}, {"tags": ["c", "eof", "getchar"], "comments": [{"owner": {"reputation": 1117, "user_id": 2844164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53780b9dd55b52418843419dd2e31d7d?s=128&d=identicon&r=PG", "display_name": "Quirk", "link": "https://stackoverflow.com/users/2844164/quirk"}, "edited": false, "score": 0, "creation_date": 1481697630, "post_id": 41136213, "comment_id": 69475948, "body": "It worked great for me when I put <code>^Z</code> on a separate line."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4706226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/93b44789b08b113226e0f3049357ec7a?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/4706226/wayne"}, "edited": false, "score": 0, "creation_date": 1481712208, "post_id": 41136261, "comment_id": 69483793, "body": "Can you please explain from where that character &#39;arrow&#39; came then ? I mean to say, the presence of h and i in output is fine but arrow thing is bothering me. I guess, ^Z shouldn&#39;t have been passed to the program despite of its presence in the given input ? Why is it getting passed ?"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 4, "last_activity_date": 1481697805, "last_edit_date": 1481697805, "creation_date": 1481697406, "answer_id": 41136261, "question_id": 41136213, "link": "https://stackoverflow.com/questions/41136213/input-buffer-flush/41136261#41136261", "title": "Input buffer flush", "body": "<p>The problem here is, a <code>char</code> is not sufficient to hold a value of <code>EOF</code>. You need to make use of an <code>int</code> type.</p>\n\n<p>Change the <code>char c;</code> to <code>int c;</code>.</p>\n\n<p>That said, the <code>getchar()</code> will return <em>any</em> pending items in the standard input. If you use the key combo after some input, the action would be similar as <em>flushing</em> the stream. To get the <code>EOF</code> returned from <code>getchar()</code>, you need to press the key combination one more time.</p>\n\n<p>In short, if you expect <code>getchar()</code> to return <code>EOF</code> on <kbd>CTRL</kbd>+<kbd>Z</kbd> make sure there's nothing in <code>stdin</code>.</p>\n\n<p>That said, for a hosted environment, the proper signature of <code>main()</code> is <code>int main(void)</code>, at least.</p>\n"}, {"tags": [], "owner": {"reputation": 8243, "user_id": 1629262, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/F9Q4g.jpg?s=128&g=1", "display_name": "doptimusprime", "link": "https://stackoverflow.com/users/1629262/doptimusprime"}, "is_accepted": false, "score": 1, "last_activity_date": 1481697430, "creation_date": 1481697430, "answer_id": 41136271, "question_id": 41136213, "link": "https://stackoverflow.com/questions/41136213/input-buffer-flush/41136271#41136271", "title": "Input buffer flush", "body": "<p>Refer <a href=\"http://www.cplusplus.com/reference/cstdio/getchar/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/cstdio/getchar/</a>\nIt says that return type of <code>getchar</code> is <code>int</code>. Compiler should have given warning. Please do not ignore such warnings.</p>\n\n<p>You are assigning <code>int</code> to <code>char</code> which will result in loss. Try to get it into <code>int</code> and print it.</p>\n\n<p>You can print <code>int</code> too in <code>printf</code> using <code>%c</code> and typecasting to <code>char</code>.</p>\n"}], "owner": {"reputation": 61, "user_id": 4706226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/93b44789b08b113226e0f3049357ec7a?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/4706226/wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1481697959, "creation_date": 1481697184, "last_edit_date": 1481697959, "question_id": 41136213, "link": "https://stackoverflow.com/questions/41136213/input-buffer-flush", "title": "Input buffer flush", "body": "<p>Consider the code below:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(){\nchar c;\nwhile( ( c=getchar() ) != EOF )\n        printf(\"%c\\n\",c);\nreturn 0; \n}\n</code></pre>\n\n<p>I gave the input as:  hi^Z </p>\n\n<p>The output was: </p>\n\n<blockquote>\n<pre><code>h\ni\n(an arrow pointing towards left) \n</code></pre>\n</blockquote>\n\n<p><em>[Sorry, I couldn't find character for the above arrow. ]</em></p>\n\n<p>Can someone please explain the output ? Since ^Z is part of the character string and there are characters to flush, I think ^Z shouldn't have been passed and thus the output should be,</p>\n\n<blockquote>\n<pre><code>h\ni\n(new line )\n</code></pre>\n</blockquote>\n\n<p>P.S - I am on windows and ^Z thus is EOF.</p>\n"}, {"tags": ["c", "linux", "hash", "include", "implementation"], "comments": [{"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1481698085, "post_id": 41136040, "comment_id": 69476123, "body": "Do you use compiler flags <code>-I</code> to specify the correct include directories?"}], "answers": [{"tags": [], "owner": {"reputation": 312, "user_id": 7204551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ed9da506b9c5cdb571443dff701a60?s=128&d=identicon&r=PG&f=1", "display_name": "Dipti Shiralkar", "link": "https://stackoverflow.com/users/7204551/dipti-shiralkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1481697984, "creation_date": 1481697984, "answer_id": 41136393, "question_id": 41136040, "link": "https://stackoverflow.com/questions/41136040/include-errors-while-working-in-the-kernel/41136393#41136393", "title": "Include errors while working in the kernel", "body": "<p>Looks like you are missing the Linux kernel headers which allow you to compile code against the Linux kernel.</p>\n\n<p>You should install linux headers. Which flavour you are using? Please change below commands accordingly.</p>\n\n<p>To install just the headers in Ubuntu:</p>\n\n<pre><code>$ sudo apt-get install linux-headers-$(uname -r)\n</code></pre>\n\n<p>To install the entire Linux kernel source in Ubuntu:</p>\n\n<pre><code>$ sudo apt-get install linux-source\n</code></pre>\n\n<p>Note that you should use the kernel headers that match the kernel you are running.</p>\n\n<p>And then you can add that to your Makefile as:</p>\n\n<pre><code>KDIR =//usr/src/linux-headers\n\nall:\n $(MAKE) -C $(KDIR) SUBDIRS=$(PWD) modules\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7249468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a66b7d4dfcd1fedca6e89311bc561ea?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/7249468/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563192781, "creation_date": 1481696379, "last_edit_date": 1563192781, "question_id": 41136040, "link": "https://stackoverflow.com/questions/41136040/include-errors-while-working-in-the-kernel", "title": "Include errors while working in the kernel", "body": "<p>I am making a implementation of Hash_Drbg.</p>\n\n<p>The original source code can be found here: <a href=\"https://github.com/torvalds/linux/blob/master/crypto/drbg.c\" rel=\"nofollow noreferrer\">https://github.com/torvalds/linux/blob/master/crypto/drbg.c</a> </p>\n\n<p>I have taken out the parts of the code I need for my implementation and think it should work when I compile it. </p>\n\n<p>When I compile I get errors regarding the includes.</p>\n\n<p>For example: </p>\n\n<pre><code>fatal error: crypto/drbg.h: No such file or directory. \n</code></pre>\n\n<p>This can be easily fixed by downloading the kernel and modifiying the include found at the top of the source code. When I do that, I am meet with the same error for the includes inside the <code>drbg.h</code> header.</p>\n\n<p>For example: </p>\n\n<pre><code>fatal error: linux/scatterlist.h: No such file or directory. \n</code></pre>\n\n<p>How can I fix these errors?</p>\n"}, {"tags": ["c", "bitmap"], "comments": [{"owner": {"reputation": 6964, "user_id": 2261657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de05cbfc9a0fbef64f55eb69e761bee5?s=128&d=identicon&r=PG", "display_name": "\u03b3\u03b7\u03c1\u03ac\u03c3\u03ba\u03c9 \u03b4&#39; \u03b1\u03b5\u03af \u03c0\u03bf\u03bb\u03bb\u03ac \u03b4\u03b9\u03b4\u03b1\u03c3\u03ba\u03cc\u03bc\u03b5", "link": "https://stackoverflow.com/users/2261657/%ce%b3%ce%b7%cf%81%ce%ac%cf%83%ce%ba%cf%89-%ce%b4-%ce%b1%ce%b5%ce%af-%cf%80%ce%bf%ce%bb%ce%bb%ce%ac-%ce%b4%ce%b9%ce%b4%ce%b1%cf%83%ce%ba%cf%8c%ce%bc%ce%b5"}, "edited": false, "score": 1, "creation_date": 1481736410, "post_id": 41135956, "comment_id": 69499594, "body": "42 bytes for each line is <b>not</b> multiple of <i>4</i>. So <i>2</i> padding bytes are added in the end to make them 44, which is multiple. The logic goes <code>44 * 24 = 1056</code>. The 2 padding bytes for each line they are not color information."}, {"owner": {"reputation": 6964, "user_id": 2261657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de05cbfc9a0fbef64f55eb69e761bee5?s=128&d=identicon&r=PG", "display_name": "\u03b3\u03b7\u03c1\u03ac\u03c3\u03ba\u03c9 \u03b4&#39; \u03b1\u03b5\u03af \u03c0\u03bf\u03bb\u03bb\u03ac \u03b4\u03b9\u03b4\u03b1\u03c3\u03ba\u03cc\u03bc\u03b5", "link": "https://stackoverflow.com/users/2261657/%ce%b3%ce%b7%cf%81%ce%ac%cf%83%ce%ba%cf%89-%ce%b4-%ce%b1%ce%b5%ce%af-%cf%80%ce%bf%ce%bb%ce%bb%ce%ac-%ce%b4%ce%b9%ce%b4%ce%b1%cf%83%ce%ba%cf%8c%ce%bc%ce%b5"}, "edited": false, "score": 0, "creation_date": 1481736837, "post_id": 41135956, "comment_id": 69499841, "body": "The values of <code>tred</code> array are not valid for a <i>bmp</i> image. The image you are having in the link is a png one!"}], "owner": {"reputation": 9, "user_id": 7178521, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b67fbd245d1e2fa0d3bf6a13a9bb53a7?s=128&d=identicon&r=PG&f=1", "display_name": "NeoNaN", "link": "https://stackoverflow.com/users/7178521/neonan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538997692, "creation_date": 1481695999, "last_edit_date": 1538997692, "question_id": 41135956, "link": "https://stackoverflow.com/questions/41135956/add-imagedata-to-bitmap-in-raw-bytes", "title": "Add imagedata to Bitmap in raw bytes", "body": "<p>I am trying to add imagedata to an existing bitmap.</p>\n\n<p>The existing bitmap is stored in an byte array:</p>\n\n<p>That's how the image looks like: <img src=\"https://i.stack.imgur.com/reYbV.png\" alt=\"\"></p>\n\n<p>If I want to add, let's say 2 lines of blue to the bottom, how could I do that?</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n\nconst char tred[] = {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,\n0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xC8,0xD1,0xF8,0x95,0xA7,0xF4,0x65,0x80,0xED,0xB0,0xBC,0xF6,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,\n0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xD0,0xD7,0xFA,0x48,0x68,0xEB,0x01,0x2E,0xE2,0x06,0x30,0xE4,\n0x12,0x3A,0xE4,0x0D,0x36,0xE5,0x71,0x8A,0xEF,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF4,\n0xF6,0xFD,0x35,0x58,0xE9,0x00,0x2B,0xE3,0x19,0x40,0xE6,0x21,0x46,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,\n0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xAD,0xBA,0xF6,0x00,0x27,0xE3,0x1A,0x41,0xE6,0x21,0x47,0xE7,0x21,0x47,\n0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,\n0x94,0xA6,0xF2,0x00,0x28,0xE3,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,\n0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xBB,0xC6,0xF7,0x00,0x27,0xE2,0x22,0x47,0xE7,0x21,0x47,0xE7,0x21,\n0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0xFF,0xFF,\n0xFF,0xFF,0xFF,0xFF,0x00,0x2C,0xE3,0x20,0x46,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,\n0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0xFF,0xFF,0xFF,0x67,0x82,0xEE,0x13,0x3C,0xE5,0x21,0x47,0xE7,\n0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,\n0x78,0x90,0xF0,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x2C,0xE3,0x20,0x46,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,\n0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0xC3,0xCD,0xF8,0x07,0x31,\n0xE4,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,\n0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0x8B,0x9F,0xF1,0x13,0x3B,0xE5,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,\n0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,\n0x00,0x00,0x78,0x90,0xF0,0x17,0x3E,0xE5,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,\n0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0x79,0x8F,0xF0,0x17,0x3E,0xE5,0x21,0x47,\n0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,\n0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0x8E,0xA2,0xF2,0x12,0x3A,0xE5,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,\n0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0xC9,\n0xD1,0xF9,0x05,0x30,0xE4,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,\n0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0xFF,0xFF,0xFF,0x04,0x2F,0xE3,0x20,0x46,0xE6,0x21,0x47,\n0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,\n0xE6,0x78,0x90,0xF0,0x00,0x00,0xFF,0xFF,0xFF,0x75,0x8C,0xEF,0x11,0x3A,0xE5,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,\n0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0xFF,0xFF,0xFF,0xFF,\n0xFF,0xFF,0x05,0x2F,0xE3,0x20,0x46,0xE6,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,\n0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xD0,0xD7,0xF9,0x00,0x25,0xE3,0x21,0x47,\n0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,\n0xF0,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xAE,0xBC,0xF6,0x00,0x26,0xE3,0x20,0x46,0xE6,0x21,0x47,0xE7,0x21,0x47,0xE7,\n0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,\n0xFF,0xFF,0xFF,0xFF,0xFF,0xC8,0xD1,0xF8,0x02,0x2D,0xE3,0x15,0x3D,0xE6,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,0x47,0xE7,0x21,\n0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,\n0xFE,0x51,0x6F,0xEB,0x00,0x27,0xE3,0x16,0x3D,0xE6,0x1F,0x46,0xE6,0x22,0x47,0xE7,0x21,0x47,0xE7,0x17,0x3E,0xE6,0x78,0x90,0xF0,0x00,0x00,\n0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xEB,0xEF,0xFC,0x65,0x7E,0xEE,\n0x0C,0x36,0xE3,0x00,0x2A,0xE3,0x0D,0x36,0xE4,0x0A,0x34,0xE4,0x70,0x89,0xEF,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,\n0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xE4,0xE8,0xFC,0xAE,0xBC,0xF6,0x7E,\n0x94,0xF0,0xBD,0xC7,0xF7,0x00,0x00 };\n\n\nint main(int argc, char* argv[]) {\n    BITMAPFILEHEADER bmfh;\n    BITMAPINFOHEADER bmih;\n\n    bmih.biSize = sizeof(BITMAPINFOHEADER);;\n    bmih.biWidth = 14;\n    bmih.biHeight = 96;\n    bmih.biPlanes = 1;\n    bmih.biBitCount = 24;\n    bmih.biCompression = 0;\n    bmih.biSizeImage = 0;\n    bmih.biXPelsPerMeter = 0;\n    bmih.biYPelsPerMeter = 0;\n    bmih.biClrUsed = 0;\n    bmih.biClrImportant = 0;\n\n    bmfh.bfType = 19778;\n    bmfh.bfSize = ((bmih.biWidth * bmih.biBitCount + 31) / 32) * 4 * bmih.biHeight;\n    bmfh.bfOffBits = (DWORD)sizeof(BITMAPFILEHEADER) + (DWORD)sizeof(BITMAPINFOHEADER); // 54\n    bmfh.bfReserved1 = 0;\n    bmfh.bfReserved2 = 0;\n\n    char* bmpData = (char*)malloc(bmfh.bfSize);\n\n    memcpy(bmpData, tred, sizeof(tred));\n\n    HANDLE h = CreateFile(\"C:\\\\tmp\\\\a.bmp\", GENERIC_WRITE, 0, 0, CREATE_ALWAYS, 0, 0);\n    DWORD d;\n    WriteFile(h, &amp;bmfh, sizeof(bmfh), &amp;d, 0);\n    WriteFile(h, &amp;bmih, sizeof(bmih), &amp;d, 0);\n    WriteFile(h, bmpData, bmfh.bfSize, &amp;d, 0);\n\n    CloseHandle(h);\n    delete[] bmpData;\n    return 0;\n}\n</code></pre>\n\n<p>What I do not understand: Original file is 14px*24px = 366px in total. In a 24bit Bitmap, there is RGB (3 Bytes) for each pixel, so that would be 366*3=1008bytes. The original file (without header) has 1056bytes.</p>\n\n<p>Maybe that's the reason why my approach, by adding 14*3=42bytes of 0xFF did not add an extra line?</p>\n"}]