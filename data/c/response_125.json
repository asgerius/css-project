[{"tags": ["c", "linux", "ipmi"], "comments": [{"owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1496275219, "post_id": 44296332, "comment_id": 75598993, "body": "What is the motherboard? Where the IPMI is implemented? I see no standard temperature sensor on consumer DIMM modules, there is only memory and small SPD EEPROM chip for model and timings, how it is possible to get temperature of memory? What if the &quot;DIMM temperature&quot; comes not from the DIMM module, or only some of modules have temperature sensor? Temperature should not be used to detect modules in DIMM slots. Probably, IPMI is not for DIMM detection (and DMI is - use dmidecode command on target linux with ssh)."}, {"owner": {"reputation": 569, "user_id": 3309645, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/ApXf7.jpg?s=128&g=1", "display_name": "charles.cc.hsu", "link": "https://stackoverflow.com/users/3309645/charles-cc-hsu"}, "reply_to_user": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1496276645, "post_id": 44296332, "comment_id": 75599296, "body": "As I understanding, there are SDR records read by IPMI sdr command, will get a linked list, one by one, contain the value and the name for each record. <code>Manufacturer: Supermicro Product Name: X10SDV-8C-TLN4F+</code> got from <code>sudo dmidecode -t 2</code>."}, {"owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1496277314, "post_id": 44296332, "comment_id": 75599459, "body": "What <code>dmidecode</code> says about your dimms, their count and name (model)?"}, {"owner": {"reputation": 569, "user_id": 3309645, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/ApXf7.jpg?s=128&g=1", "display_name": "charles.cc.hsu", "link": "https://stackoverflow.com/users/3309645/charles-cc-hsu"}, "reply_to_user": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1496296401, "post_id": 44296332, "comment_id": 75604257, "body": "<code>Number Of Devices is  4, DDR4, Manufacturer: Undefined</code> by command <code>$sudo dmidecode --type memory</code>"}, {"owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1496318437, "post_id": 44296332, "comment_id": 75618961, "body": "Are there 4 DDR4 with any nonzero fields like &quot;Installed size&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 569, "user_id": 3309645, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/ApXf7.jpg?s=128&g=1", "display_name": "charles.cc.hsu", "link": "https://stackoverflow.com/users/3309645/charles-cc-hsu"}, "edited": false, "score": 0, "creation_date": 1497401768, "post_id": 44471535, "comment_id": 76058901, "body": "I just compiled <code>ipmimonitoring-sensors.c</code> in <code>&#47;freeipmi-1.5.5&#47;contrib&#47;libipmimonitoring</code>, and used the parameter you mentioned <code>-v</code> or <code>--v</code>, but it still not work. there are not information for the non-plugin DIMM.  BTW, now we did not need the temperature of DIMM, we only want to know the DIMM type and slot information. So I&#39;ve traced the source code of <code>dmidecode</code> to get that. See <a href=\"https://stackoverflow.com/a/44483790/3309645\">Get hardware information from existed files in Linux using C</a>."}, {"owner": {"reputation": 303, "user_id": 1397356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce0f879462d19ef5855b3f61d408f95?s=128&d=identicon&r=PG", "display_name": "Albert Chu", "link": "https://stackoverflow.com/users/1397356/albert-chu"}, "reply_to_user": {"reputation": 569, "user_id": 3309645, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/ApXf7.jpg?s=128&g=1", "display_name": "charles.cc.hsu", "link": "https://stackoverflow.com/users/3309645/charles-cc-hsu"}, "edited": false, "score": 0, "creation_date": 1497438262, "post_id": 44471535, "comment_id": 76076315, "body": "The -v option is for the ipmi-sensors tool, not the libipmimonitoring example."}], "tags": [], "owner": {"reputation": 303, "user_id": 1397356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce0f879462d19ef5855b3f61d408f95?s=128&d=identicon&r=PG", "display_name": "Albert Chu", "link": "https://stackoverflow.com/users/1397356/albert-chu"}, "is_accepted": false, "score": 0, "last_activity_date": 1497085496, "creation_date": 1497085496, "answer_id": 44471535, "question_id": 44296332, "link": "https://stackoverflow.com/questions/44296332/get-all-dimm-information-from-ipmi-using-freeipmi-api/44471535#44471535", "title": "Get all DIMM information from IPMI using FreeIPMI API", "body": "<p>FreeIPMI maintainer here.  Generically speaking, most of the tools in FreeIPMI will not output information about a sensor if it is \"not available\".  (Internally, that maps to a variety of things that I won't detail.)  It appears ipmitool outputs some sensor info by default regardless of availability.</p>\n\n<p>Per your question regarding using an IPMI command.  Using FreeIPMI's ipmi-sensors, you can see the remaining DIMMs by using -v (or possibly -vv).</p>\n\n<p>Per your question in title regarding API, in the libipmimonitoring API, the key flag is IPMI_MONITORING_SENSOR_READING_FLAGS_IGNORE_NON_INTERPRETABLE_SENSORS.  Look for that in the example code and you'll probably see what to do.</p>\n"}], "owner": {"reputation": 569, "user_id": 3309645, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/ApXf7.jpg?s=128&g=1", "display_name": "charles.cc.hsu", "link": "https://stackoverflow.com/users/3309645/charles-cc-hsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2725, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497085496, "creation_date": 1496274352, "question_id": 44296332, "link": "https://stackoverflow.com/questions/44296332/get-all-dimm-information-from-ipmi-using-freeipmi-api", "title": "Get all DIMM information from IPMI using FreeIPMI API", "body": "<p>Here is the output from <code>$ipmitool -sensor</code>, they show all DIMM info. But FreeIPMI only have the DIMM info that have been plug-in. How can I get all Memory DIMM information by using FreeIPMI API in C? </p>\n\n<pre><code>$ sudo ipmitool sensor\nCPU Temp         | 59.000     | degrees C  | ok    | 0.000     | 0.000     | 0.000     | 99.000    | 104.000   | 104.000   \nSystem Temp      | 35.000     | degrees C  | ok    | -10.000   | -5.000    | 0.000     | 80.000    | 85.000    | 90.000    \nPeripheral Temp  | 49.000     | degrees C  | ok    | -10.000   | -5.000    | 0.000     | 80.000    | 85.000    | 90.000    \nDIMMA1 Temp      | na         |            | na    | na        | na        | na        | na        | na        | na        \nDIMMA2 Temp      | na         |            | na    | na        | na        | na        | na        | na        | na        \nDIMMB1 Temp      | 36.000     | degrees C  | ok    | -5.000    | 0.000     | 5.000     | 80.000    | 85.000    | 90.000    \nDIMMB2 Temp      | na         |            | na    | na        | na        | na        | na        | na        | na        \nFAN1             | 3800.000   | RPM        | ok    | 300.000   | 500.000   | 700.000   | 25300.000 | 25400.000 | 25500.000 \nFAN2             | 4100.000   | RPM        | ok    | 300.000   | 500.000   | 700.000   | 25300.000 | 25400.000 | 25500.000 \nFAN3             | 4100.000   | RPM        | ok    | 300.000   | 500.000   | 700.000   | 25300.000 | 25400.000 | 25500.000 \nFANA             | 4400.000   | RPM        | ok    | 300.000   | 500.000   | 700.000   | 25300.000 | 25400.000 | 25500.000 \n12V              | 12.000     | Volts      | ok    | 10.173    | 10.299    | 10.740    | 12.945    | 13.260    | 13.386    \n5VCC             | 4.922      | Volts      | ok    | 4.246     | 4.298     | 4.480     | 5.390     | 5.546     | 5.598     \n3.3VCC           | 3.248      | Volts      | ok    | 2.789     | 2.823     | 2.959     | 3.554     | 3.656     | 3.690     \nVBAT             | 3.047      | Volts      | ok    | 2.375     | 2.487     | 2.599     | 3.775     | 3.887     | 3.999     \nVcpu             | 1.809      | Volts      | ok    | 1.242     | 1.260     | 1.395     | 1.899     | 2.088     | 2.106     \nVDIMMAB          | 1.191      | Volts      | ok    | 0.948     | 0.975     | 1.047     | 1.344     | 1.425     | 1.443     \nVDIMMCD          | 1.209      | Volts      | ok    | 0.948     | 0.975     | 1.047     | 1.344     | 1.425     | 1.443     \n5VSB             | 4.974      | Volts      | ok    | 4.246     | 4.298     | 4.480     | 5.390     | 5.546     | 5.598     \n3.3VSB           | 3.197      | Volts      | ok    | 2.789     | 2.823     | 2.959     | 3.554     | 3.656     | 3.690     \n1.5V PCH         | 1.509      | Volts      | ok    | 1.320     | 1.347     | 1.401     | 1.644     | 1.671     | 1.698     \n1.2V BMC         | 1.218      | Volts      | ok    | 1.020     | 1.047     | 1.092     | 1.344     | 1.371     | 1.398     \n1.05V PCH        | 1.041      | Volts      | ok    | 0.870     | 0.897     | 0.942     | 1.194     | 1.221     | 1.248     \nChassis Intru    | 0x0        | discrete   | 0x0000| na        | na        | na        | na        | na        | na     \n</code></pre>\n\n<p>About the Memory information, I know that DIMMA1, A2 and B2 are not been plug-in, and DIMMB1 is 36.0 degree in Temperature.</p>\n\n<p>And here is the output from <code>ipmimonitoring-sensors</code> of FreeIPMI:</p>\n\n<pre><code>Record ID, Sensor Name, Sensor Number, Sensor Type, Sensor State, Sensor Reading, Sensor Units, Sensor Event/Reading Type Code, Sensor Event Bitmask, Sensor Event String\n4, Processor 1 CPU Temp, 1, Temperature, Nominal, 60.00, C, 1h, C0h, 'OK'\n71, System Board 1 System Temp, 11, Temperature, Nominal, 36.00, C, 1h, C0h, 'OK'\n138, System Board 2 Peripheral Temp, 14, Temperature, Nominal, 50.00, C, 1h, C0h, 'OK'\n339, Memory Device 68 DIMMB1 Temp, 180, Temperature, Nominal, 37.00, C, 1h, C0h, 'OK'\n473, Fan 1 FAN1, 65, Fan, Nominal, 3800.00, RPM, 1h, C0h, 'OK'\n540, Fan 2 FAN2, 66, Fan, Nominal, 4100.00, RPM, 1h, C0h, 'OK'\n607, Fan 3 FAN3, 67, Fan, Nominal, 4000.00, RPM, 1h, C0h, 'OK'\n674, Fan 5 FANA, 69, Fan, Nominal, 4300.00, RPM, 1h, C0h, 'OK'\n741, System Board 17 12V, 48, Voltage, Nominal, 12.00, V, 1h, C0h, 'OK'\n808, System Board 33 5VCC, 49, Voltage, Nominal, 4.92, V, 1h, C0h, 'OK'\n875, System Board 32 3.3VCC, 50, Voltage, Nominal, 3.25, V, 1h, C0h, 'OK'\n942, System Board 18 VBAT, 51, Voltage, Nominal, 3.05, V, 1h, C0h, 'OK'\n1009, Processor 2 Vcpu, 52, Voltage, Nominal, 1.81, V, 1h, C0h, 'OK'\n1076, Memory Device 1 VDIMMAB, 53, Voltage, Nominal, 1.19, V, 1h, C0h, 'OK'\n1143, Memory Device 2 VDIMMCD, 55, Voltage, Nominal, 1.21, V, 1h, C0h, 'OK'\n1210, System Board 15 5VSB, 56, Voltage, Nominal, 4.97, V, 1h, C0h, 'OK'\n1277, System Board 16 3.3VSB, 57, Voltage, Nominal, 3.20, V, 1h, C0h, 'OK'\n1344, System Board 19 1.5V PCH, 60, Voltage, Nominal, 1.51, V, 1h, C0h, 'OK'\n1411, System Board 20 1.2V BMC, 61, Voltage, Nominal, 1.22, V, 1h, C0h, 'OK'\n1478, System Board 21 1.05V PCH, 62, Voltage, Nominal, 1.04, V, 1h, C0h, 'OK'\n1545, System Chassis Chassis Intru, 170, Physical Security, Nominal, N/A, N/A, 6Fh, 0h, 'OK'\n</code></pre>\n\n<p>But no information for the DIMMA1, A2 and B2, because they are not plug-in. So I trace the code of impi-monitoring-sensor.c</p>\n\n<pre><code>if ((sensor_count = ipmi_monitoring_sensor_readings_by_record_id (ctx,\n                                                                  hostname,\n                                                                  ipmi_config,\n                                                                  sensor_reading_flags,\n                                                                  NULL, /* record_ids */\n                                                                  0,    /* record_ids_length */\n                                                                  NULL,\n                                                                  NULL)) &lt; 0)\n</code></pre>\n\n<p>and the config</p>\n\n<pre><code>static void\n_init_ipmi_config (struct ipmi_monitoring_ipmi_config *ipmi_config)\n{\n  assert (ipmi_config);\n\n  ipmi_config-&gt;driver_type = driver_type;\n  ipmi_config-&gt;disable_auto_probe = disable_auto_probe;\n  ipmi_config-&gt;driver_address = driver_address;\n  ipmi_config-&gt;register_spacing = register_spacing;\n  ipmi_config-&gt;driver_device = driver_device;\n\n  ipmi_config-&gt;protocol_version = protocol_version;\n  ipmi_config-&gt;username = username;\n  ipmi_config-&gt;password = password;\n  ipmi_config-&gt;k_g = k_g;\n  ipmi_config-&gt;k_g_len = k_g_len;\n  ipmi_config-&gt;privilege_level = privilege_level;\n  ipmi_config-&gt;authentication_type = authentication_type;\n  ipmi_config-&gt;cipher_suite_id = cipher_suite_id;\n  ipmi_config-&gt;session_timeout_len = session_timeout;\n  ipmi_config-&gt;retransmission_timeout_len = retransmission_timeout;\n\n  ipmi_config-&gt;workaround_flags = workaround_flags;\n}\n</code></pre>\n\n<p>I can assume the motherboard has 4 DIMM slot, and if they are not found in the FreeIPMI sensor output, I can guess they are not been plug-in. But how do I know the all DIMM slot in the motherboard by IPMI command?</p>\n"}, {"tags": ["c", "string", "pointers", "c-strings"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1496271589, "post_id": 44295911, "comment_id": 75598086, "body": "Why did you tag this as <code>C++</code>?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1496271655, "post_id": 44295911, "comment_id": 75598099, "body": "Why are you passing a pointer to <code>int</code> to <code>CheckString()</code>? And <code>i++</code> is probably not what you want here."}, {"owner": {"reputation": 1, "user_id": 8094667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fade7704b952f9b1c9ca2825084113?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8094667/alex"}, "edited": false, "score": 0, "creation_date": 1496271789, "post_id": 44295911, "comment_id": 75598129, "body": "hi david, ty for response... thats what i been asked... by 2 pointers."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496271977, "post_id": 44295911, "comment_id": 75598172, "body": "Yes, but why a pointer to <code>int</code>? Why not another pointer to <code>char</code>? And again, <code>i++</code> is wrong; this increments the value of the pointer, not the value pointed to."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496272612, "post_id": 44295911, "comment_id": 75598327, "body": "@AlexBoyev If you call recursion up to  <code>if (*str != &#39;\\0&#39;)</code>, <code>str[*i]</code> will cause out of array access."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1496274481, "post_id": 44295911, "comment_id": 75598825, "body": "<i>pointer 2 to the middle of the string.</i> Is this <code>&amp;str[length]</code> , not <code>&amp;length</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8094667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fade7704b952f9b1c9ca2825084113?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8094667/alex"}, "edited": false, "score": 0, "creation_date": 1496272785, "post_id": 44296115, "comment_id": 75598374, "body": "ye but using const chars is also prohibited, i should of mention it :/"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 1, "user_id": 8094667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fade7704b952f9b1c9ca2825084113?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8094667/alex"}, "edited": false, "score": 1, "creation_date": 1496272871, "post_id": 44296115, "comment_id": 75598405, "body": "@AlexBoyev It will be  a wrong function declaration if to remove the qualifier. That is the function in this case may not be applied to a constant string. However you may remove the qualifier if you want."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1496273865, "last_edit_date": 1496273865, "creation_date": 1496272615, "answer_id": 44296115, "question_id": 44295911, "link": "https://stackoverflow.com/questions/44295911/c-string-recursive-function-to-find-out-equality-from-middle/44296115#44296115", "title": "C string recursive function to find out equality from middle", "body": "<p>It seems you mean the following</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint CheckString(const char *s, size_t *i)\n{\n    return s[*i] == '\\0' || *s == s[*i] &amp;&amp; CheckString(s + 1, i);\n}\n\nint main( void )\n{\n    char *s = \"ADAMADAM\";\n    size_t i = strlen(s) / 2;\n\n    int result = CheckString(s, &amp;i);\n    printf(\"%s\\n\", result ? \"true\" : \"false\");\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output </p>\n\n<pre><code>true\n</code></pre>\n\n<p>Note: maybe you should calculate the value for the second argument the following way</p>\n\n<pre><code>    size_t i = ( strlen(s) + 1 ) / 2;\n</code></pre>\n\n<p>Think about this.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8094667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fade7704b952f9b1c9ca2825084113?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8094667/alex"}, "edited": false, "score": 0, "creation_date": 1496273890, "post_id": 44296233, "comment_id": 75598680, "body": "it works perfectly, didnt test for limit points... but could you explain how come the &#39;i&#39; stays the same without promoting it ?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 1, "user_id": 8094667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fade7704b952f9b1c9ca2825084113?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8094667/alex"}, "edited": false, "score": 0, "creation_date": 1496273993, "post_id": 44296233, "comment_id": 75598699, "body": "The value held by <code>*i</code> is just the distance from the front of the string to the middle. So, when you add 1 to <code>str</code>, <code>str + *i</code> points to the next character after the middle, and so on."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 1, "user_id": 8094667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fade7704b952f9b1c9ca2825084113?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8094667/alex"}, "edited": false, "score": 0, "creation_date": 1496274125, "post_id": 44296233, "comment_id": 75598737, "body": "@Alex-- Note that because of the way you calculate the middle of the string, both <code>ADAMADAM</code> and <code>MADAMADAM</code> return TRUE."}, {"owner": {"reputation": 1, "user_id": 8094667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fade7704b952f9b1c9ca2825084113?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8094667/alex"}, "edited": false, "score": 0, "creation_date": 1496274571, "post_id": 44296233, "comment_id": 75598841, "body": "str + *i ?... where can you see that ?  or i am missing something  ?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 1, "user_id": 8094667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fade7704b952f9b1c9ca2825084113?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8094667/alex"}, "edited": false, "score": 0, "creation_date": 1496274788, "post_id": 44296233, "comment_id": 75598883, "body": "<code>*(str + *i)</code> is eqivalent to <code>str[*i]</code>. The point is, you increment the <code>str</code> pointer with each recursive call. The distance to the character you check in the back half of the string remains constant."}], "tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 0, "last_activity_date": 1496274314, "last_edit_date": 1496274314, "creation_date": 1496273586, "answer_id": 44296233, "question_id": 44295911, "link": "https://stackoverflow.com/questions/44295911/c-string-recursive-function-to-find-out-equality-from-middle/44296233#44296233", "title": "C string recursive function to find out equality from middle", "body": "<p>The outer condition in the loop inside <code>CheckString()</code> should be checking for <code>*(str + *i) != '\\0'</code>, or equivalently, for <code>str[*i] != '\\0'</code>. Also, you do not need to increment <code>*i</code>, and certainly not <code>i</code>, since that is a pointer. The value <code>*i</code> is the distance between the characters being checked in the two halves of the string.</p>\n\n<p>The modified function could look like:</p>\n\n<pre><code>int CheckString(char *str, int *i) {\n    if (str[*i] != '\\0') {\n        if (*str == str[*i]) {\n            return CheckString(str+1,i);\n        } else {\n            return FALSE;\n        }\n    }\n    return TRUE;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1496346685, "last_edit_date": 1592644375, "creation_date": 1496346685, "answer_id": 44316004, "question_id": 44295911, "link": "https://stackoverflow.com/questions/44295911/c-string-recursive-function-to-find-out-equality-from-middle/44316004#44316004", "title": "C string recursive function to find out equality from middle", "body": "<p>The problem specification says (more or less):</p>\n<blockquote>\n<p>I've got to make a recursive function that will get 2 pointers:</p>\n<ol>\n<li>pointer 1 to index [0].</li>\n<li>pointer 2 to the middle of the string.</li>\n</ol>\n<p>I've got to check if the first part from 0 to middle is equal to the second part from middle to end, like: <code>ADAMADAM</code>.</p>\n</blockquote>\n<p>As an exercise in recursion, this is fine; as a way of implementing the functionality, recursion is overkill (iteration is fine).</p>\n<p>There is confusion (ambiguity) about the interface to the function \u2014 the wording of the question seems to suggest two <code>char *</code> values, but the code uses a pointer to an integer as the second argument.  That's singularly peculiar.  An integer value could make sense, but a pointer to an integer does not.</p>\n<p>We need to define the conditions carefully.  Taking the example string given (<code>char str1[] = &quot;ADAMADAM&quot;;</code>), the two pointers might be <code>char *p1 = &amp;str1[0]; char *p2 = &amp;str1[0] + strlen(str1) / 2;</code> \u2014 meaning <code>p1</code> points to the first <code>A</code> and <code>p2</code> to the third <code>A</code>.  Consider an alternative string: <code>char str2[] = &quot;MADAMADAM&quot;;</code>;  The equivalent formula would leave <code>p1</code> pointing at the first <code>M</code> and <code>p2</code> pointing at the second <code>M</code>.</p>\n<p>Assuming <code>p1</code> and <code>p2</code> are incremented in lock-step, then:</p>\n<ul>\n<li>The strings are different if, at any point before <code>*p2</code> equals <code>'\\0'</code>, <code>*p1 != *p2</code>.</li>\n<li>If <code>*p2</code> equals <code>'\\0'</code>, then the strings are the same.</li>\n<li>By definition, <code>p1</code> and <code>p2</code> point to the same array, so pointer differences are legitimate.</li>\n<li>Further, <code>p1</code> must be less than <code>p2</code> to be useful; <code>p1</code> equal to <code>p2</code> means the strings are identical trivially.</li>\n<li>There is a strong argument that the 'middle of the string' criterion means that either <code>p2[p2 - p1] == '\\0'</code> or <code>p2[p2 - p1 + 1] == '\\0'</code> (for even and odd string lengths respectively).  That is, the distance between the two pointers indicates where the end of the string must be.  It means that using <code>p1 = &amp;str[0]</code> and <code>p2 = &amp;str[2]</code> (on either of the sample strings) should fail because the end of string isn't in the right place.  And if the string was <code>&quot;AMAMAMAM&quot;</code>, using <code>&amp;str[0]</code> and <code>&amp;str[2]</code> should fail because the end of string isn't in the right place; ditto <code>&amp;str[0]</code> and <code>&amp;str[6]</code>.</li>\n<li>However, this 'strong argument' is also a design decision.  It would be feasible to simply demand that the substring from <code>p2</code> to EOS (end of string) is the same as the string from <code>p1</code> for the same length.  In that case, using <code>&amp;str[0]</code> with either <code>&amp;str[2]</code> or <code>&amp;str[6]</code> (or, indeed, with the normal <code>&amp;str[4]</code>) on <code>&quot;AMAMAMAM&quot;</code> would work fine.</li>\n</ul>\n<p>Using some of these observations leads to this code.  If you're really under instructions not to use <code>const</code>, simply remove the <code>const</code> qualifiers where they appear.  The code will work the same.</p>\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nstatic bool identical_halfstrings(const char *p1, const char *p2)\n{\n    assert(p1 &lt;= p2);\n    assert(strlen(p1) &gt;= strlen(p2) + (p2 - p1));\n    \n    if (*p2 == '\\0')\n        return true;\n    if (*p1 != *p2)\n        return false;\n    return identical_halfstrings(p1+1, p2+1);\n}\n\nint main(void)\n{\n    const char *strings[] =\n    {\n        &quot;ADAMADAM&quot;,\n        &quot;MADAMADAM&quot;,\n        &quot;nonsense&quot;,\n    };\n    enum { NUM_STRINGS = sizeof(strings) / sizeof(strings[0]) };\n\n    for (int i = 0; i &lt; NUM_STRINGS; i++)\n    {\n        const char *p1 = strings[i];\n        const char *p2 = strings[i] + strlen(strings[i]) / 2;\n        printf(&quot;[%s] ([%s]) = %s\\n&quot;, p1, p2,\n               identical_halfstrings(p1, p2) ? &quot;TRUE&quot; : &quot;FALSE&quot;);\n    }\n    return 0;\n}\n</code></pre>\n<p>The second assertion ensures that <code>p1</code> and <code>p2</code> are pointing to the same string \u2014 that there isn't a null byte between the locations pointed at by <code>p1</code> and <code>p2</code>.</p>\n<p>Test case output:</p>\n<pre><code>[ADAMADAM] ([ADAM]) = TRUE\n[MADAMADAM] ([MADAM]) = TRUE\n[nonsense] ([ense]) = FALSE\n</code></pre>\n<p>Just for the record, an iterative version of the same function is:</p>\n<pre><code>static bool identical_halfstrings(const char *p1, const char *p2)\n{\n    assert(p1 &lt;= p2);\n    assert(strlen(p1) &gt;= strlen(p2) + (p2 - p1));\n\n    while (*p2 != '\\0')\n    {\n        if (*p1++ != *p2++)\n            return false;\n    }\n    return true;\n}\n</code></pre>\n<p>It produces the same output for the sample data.</p>\n"}], "owner": {"reputation": 1, "user_id": 8094667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fade7704b952f9b1c9ca2825084113?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8094667/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1496346685, "creation_date": 1496271358, "last_edit_date": 1496273397, "question_id": 44295911, "link": "https://stackoverflow.com/questions/44295911/c-string-recursive-function-to-find-out-equality-from-middle", "title": "C string recursive function to find out equality from middle", "body": "<p>i feel kinda lost, since we started learning about pointers i kinda cant follow and i know its really important subject in C.</p>\n\n<p>anyway!</p>\n\n<p>so i got to make a recursive function, that will get 2 pointers:</p>\n\n<p>1) pointer to index [0]. </p>\n\n<p>2) pointer 2 to the middle of the string.</p>\n\n<p>now.. i gotta check if the first part from 0 to middle is equal from middle to end. like..... ADAMADAM.</p>\n\n<p>before i transfer the string i changed entire lower letters to capitals to avoid case sensitivity... so i got something like this.. but its refusing to work.</p>\n\n<p>also using constant is prohibited...</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#define TRUE 1\n#define FALSE 0\n#define SS 81\nint CheckString(char *,int *);\n\nint main() {\n    char str[SS];\n    int length,len,strcheck;\n    printf(\"Please enter a string:\\n\");\n    fgets(str,SS,stdin);\n\n    len=(strlen(str) - 1);  \n    if((len&gt;0)&amp;&amp;(str[len]=='\\n'))   // replacing '\\n' key to '\\0'\n        str[len]='\\0';\n\n    length=len/2;\n    strcheck=CheckString(str,&amp;length);\n    if (strcheck==FALSE)\n       printf(\"FALSE.\\n\");\n    else\n       printf(\"TRUE.\\n\");\n    return 0;\n}\n\n// function\nint CheckString(char *str, int *i) {\nif (*str != '\\0')\n    if (*str == str[*i])\n        return CheckString(str+1,i++);\n    else\n        return FALSE;\n    return TRUE;\n}\n</code></pre>\n\n<p>so i guess i got some problem with the pointers</p>\n"}, {"tags": ["c", "linux", "apr"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496270122, "post_id": 44295620, "comment_id": 75597653, "body": "I suspect a problem with <code>LDFLAGS</code>, The linker can&#39;t find the functions. Have you confirmed the <code>libapr-1</code> and <code>libaprutil-1</code> library names and their existence?"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1496270274, "post_id": 44295620, "comment_id": 75597704, "body": "have you tried compiling your code manually with gcc to make sure you are setting the flags properly?"}, {"owner": {"reputation": 89, "user_id": 8089453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0977058ca94b46b6e422e8b410e56f2b?s=128&d=identicon&r=PG&f=1", "display_name": "aprdrivesmecrazy", "link": "https://stackoverflow.com/users/8089453/aprdrivesmecrazy"}, "edited": false, "score": 0, "creation_date": 1496271419, "post_id": 44295620, "comment_id": 75598037, "body": "I confirmed the existence and names of libapr-1 and libaprutil-1 but if I try and compile my files individually I get errors akin to:     fatal error: apr_general.h: No such file or directory     compilation terminated."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 8089453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0977058ca94b46b6e422e8b410e56f2b?s=128&d=identicon&r=PG&f=1", "display_name": "aprdrivesmecrazy", "link": "https://stackoverflow.com/users/8089453/aprdrivesmecrazy"}, "edited": false, "score": 0, "creation_date": 1496282671, "post_id": 44296497, "comment_id": 75600621, "body": "Ok I did that but I am still getting the same errors. Do I need to change my Makefile after doing this?"}], "tags": [], "owner": {"reputation": 4790, "user_id": 4491743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aXCqO.jpg?s=128&g=1", "display_name": "Knud Larsen", "link": "https://stackoverflow.com/users/4491743/knud-larsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1496275721, "creation_date": 1496275721, "answer_id": 44296497, "question_id": 44295620, "link": "https://stackoverflow.com/questions/44295620/undefined-reference-to-installed-apr-c-library/44296497#44296497", "title": "Undefined reference to installed APR C library", "body": "<p>Linux Mint : Unless it's an old version, all later Mint have <code>libapr1</code>, <code>libaprutil1</code> version 1.5.0 or 1.5.2 or later installed by default.</p>\n\n<p>The get the complete apr, apr-util ... please do:</p>\n\n<pre><code>sudo apt update &amp;&amp; sudo apt install libapr1-dev libaprutil1-dev\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 8089453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0977058ca94b46b6e422e8b410e56f2b?s=128&d=identicon&r=PG&f=1", "display_name": "aprdrivesmecrazy", "link": "https://stackoverflow.com/users/8089453/aprdrivesmecrazy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 585, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496275721, "creation_date": 1496269572, "question_id": 44295620, "link": "https://stackoverflow.com/questions/44295620/undefined-reference-to-installed-apr-c-library", "title": "Undefined reference to installed APR C library", "body": "<p>I downloaded and installed the APR and APR-util C libraries but I can't use them in a project I am doing I keep getting the following errors (I am on Linux Mint):</p>\n\n<pre><code>undefined reference to `apr_pool_initialize'\nundefined reference to `apr_pool_create_ex'\netc...\n</code></pre>\n\n<p>My libraries were originally installed into /usr/local/APR. At first I thought that this file was just not in my cc include path to I copied the /apr/ directory into /usr/local/include and /usr/include both of which are in the include path but I got the exact same errors. I tried adding the lib folder in /apr/ into /etc/ld.so.conf.d/ and then running ldconfig as recommended by the website I am doing the project from but that didn't help either. I thought that I may have installed it improperly so I redid it but that didn't help either. I'm at a loss. If anyone could help me fix this I would really appreciate it. For reference this is the install script I used:</p>\n\n<pre><code>set -e\ncd /tmp\n\ncurl -L -O http://archive.apache.org/dist/apr/apr-1.4.6.tar.gz\n\ntar -xzvf apr-1.4.6.tar.gz\ncd apr-1.4.6\n\n./configure\nmake\nsudo make install\n\ncd /tmp\nrm -rf apr-1.4.6 apr-1.4.6.tar.gz\n\ncurl -L -O http://archive.apache.org/dist/apr/apr-util-1.4.1.tar.gz\n\ntar -xzvf apr-util-1.4.1.tar.gz\ncd apr-util-1.4.1\n\n./configure --with-apr=/usr/local/apr\n\nmake\nsudo make install\n\ncd /tmp\nrm -rf apr-util-1.4.1* apr-1.4.6*\n</code></pre>\n\n<p>And this is the Makefile I am using, all separations are tabs:</p>\n\n<pre><code>PREFIX?=/usr/local\nCFLAGS=-g -Wall -I${PREFIX}/apr/include/apr-1  -\nI${PREFIX}/apr/include/apr-util-1   -D_LARGEFILE64_SOURCE=1\nLDFLAGS=-L${PREFIX}/apr/lib -lapr-1 -pthread -laprutil-1\n\nall: devpkg\n\ndevpkg: bstrlib.o db.o shell.o commands.o\n\ninstall: all\n    install -d $(DESTDIR)/$(PREFIX)/bin/\n    install devpkg $(DESTDIR)/$(PREFIX)/bin/\n\nclean:\n    rm -f *.o\n    rm -f devpkg\n    rm -rf *.dSYM\n</code></pre>\n"}, {"tags": ["c", "rhel", "rsyslog"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1496269470, "post_id": 44295457, "comment_id": 75597437, "body": "I&#39;m voting to close this question as off-topic because your question is more properly asked on the StackExchange site <a href=\"http://unix.stackexchange.com/\"><b>Unix &amp; Linux</b></a>. You may also want to try the red-hat mailing list. StackOverflow is a programming Question &amp; Answer site."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496269667, "post_id": 44295457, "comment_id": 75597505, "body": "@DavidC.Rankin I wouldn&#39;t say it is completely off-topic here, as it is clear that it is the <code>openlog</code> is being called from their app."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496269837, "post_id": 44295457, "comment_id": 75597559, "body": "It&#39;s a borderline call, the question seems to ask for whether there is a known issue with <code>openlog</code> as it relates to RHEL 6.4 and doesn&#39;t really provide any code to evaluate. (at least that was my thought) Thanks for the feedback."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496311452, "post_id": 44295457, "comment_id": 75614150, "body": "@DavidC.Rankin I can see it both ways.  Post the code, the stack trace of the stuck process showing where it&#39;s stuck, and it stays here as it&#39;s then a coding question.  Without the code and stack trace, it&#39;s a configuration/&quot;Is this a known bug?&quot; question that should be moved."}, {"owner": {"reputation": 89, "user_id": 3053087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48b7fd06cc2026da7e27bd72a3a16a3c?s=128&d=identicon&r=PG&f=1", "display_name": "user3053087", "link": "https://stackoverflow.com/users/3053087/user3053087"}, "edited": false, "score": 0, "creation_date": 1496342644, "post_id": 44295457, "comment_id": 75635348, "body": "upgrading to 8.17 of rsyslog and tweaking the rsyslog.conf to use more threads and larger arraysize seems to have done the trick.  no hangs today."}, {"owner": {"reputation": 89, "user_id": 3053087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48b7fd06cc2026da7e27bd72a3a16a3c?s=128&d=identicon&r=PG&f=1", "display_name": "user3053087", "link": "https://stackoverflow.com/users/3053087/user3053087"}, "edited": false, "score": 0, "creation_date": 1496403605, "post_id": 44295457, "comment_id": 75660161, "body": "what I&#39;m guessing was going on it the non-tuned setup of rsyslog was not able to keep up with many process hammering at the /dev/log device and this contention resulted in the hang.  since putting 8.17 of rsyslog on with tuning tips the rsyslog site, has not re-occurred."}], "owner": {"reputation": 89, "user_id": 3053087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48b7fd06cc2026da7e27bd72a3a16a3c?s=128&d=identicon&r=PG&f=1", "display_name": "user3053087", "link": "https://stackoverflow.com/users/3053087/user3053087"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496268645, "creation_date": 1496268645, "question_id": 44295457, "link": "https://stackoverflow.com/questions/44295457/posting-a-flurry-of-msgs-to-rsyslog-causes-process-hangs-in-openlog", "title": "posting a flurry of msgs to rsyslog causes process hangs in openlog()", "body": "<p>We use the rsyslogd daemon for logging debug messages in several applications.  With full debug on, the server will hang in the openlog() call being made in the application to log messages.  Looks to be doing a lock in the kernel library code in glibc.</p>\n\n<p>Is this a known issue under load or are we exposing some contention issue in the kernel?  RHEL 6.4 running kernel 2.6.32-358.2.1 (i386).</p>\n\n<p>rsyslog version was 8.4.1 but we upgraded to latest this afternoon 8.17 and are still running tests to see if the problem continues.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 2, "creation_date": 1496269125, "post_id": 44295431, "comment_id": 75597290, "body": "Read the character, check if it&#39;s y or n, and set a boolean variable appropriately"}], "answers": [{"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 3, "last_activity_date": 1496269987, "creation_date": 1496269987, "answer_id": 44295690, "question_id": 44295431, "link": "https://stackoverflow.com/questions/44295431/convert-yes-or-no-to-boolean-format-for-a-special-code/44295690#44295690", "title": "convert yes or no to boolean format for a special code", "body": "<p>There are a number of errors in the posted code. <code>#define bool p</code> is wrong, since it redefines <code>bool</code> as a macro for <code>p</code>. Similarly, <code>#define y 1</code> and <code>#define n 0</code> do not do what you think, but define macros that replace occurrences of <code>y</code> and <code>n</code> in the source code with <code>1</code> and <code>0</code>, respectively.</p>\n\n<p>There is no <code>%B</code> conversion specifier in standard C (or any other C that I am aware of). And <code>&amp;p</code> takes the address of an undefined variable.</p>\n\n<p>Consider defining a variable <code>cont</code> as a <code>bool</code>, and changing its value based on user input to control your loop:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\nint main(void)\n{\n    bool cont = false;\n    char input;\n\n    do {\n        printf(\"Do you want to continue (y/n)? \");\n        scanf(\" %c\", &amp;input);\n\n        if (input == 'y' || input == 'Y') {\n            cont = true;\n        } else {\n            cont = false;\n        }\n    } while (cont);\n\n    return 0;\n}\n</code></pre>\n\n<p>Here, <code>cont</code> is only <code>true</code> when the user enters <code>y</code> or <code>Y</code>. Also note the space at the beginning of the <code>scanf()</code> format string: <code>\" %c\"</code>. This causes <code>scanf()</code> to skip over leading whitespaces, including newlines, that may be in the input stream (such as those left behind by previous calls to <code>scanf()</code>.</p>\n\n<p>Note that better code would check the value returned by <code>scanf()</code>, or might use <code>fgets()</code> and <code>sscanf()</code> instead of <code>scanf()</code>, more carefully validating the input.</p>\n\n<p>Sample interaction:</p>\n\n<pre><code>Do you want to continue (y/n)? Y\nDo you want to continue (y/n)? Y\nDo you want to continue (y/n)? N\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7394548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nDRLIVXHRe8/AAAAAAAAAAI/AAAAAAAAF24/SIPIG6fUcNU/photo.jpg?sz=128", "display_name": "Boukhaima Miryam", "link": "https://stackoverflow.com/users/7394548/boukhaima-miryam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1496270352, "creation_date": 1496268523, "question_id": 44295431, "link": "https://stackoverflow.com/questions/44295431/convert-yes-or-no-to-boolean-format-for-a-special-code", "title": "convert yes or no to boolean format for a special code", "body": "<p>I need to make a program which asks the user to enter either y or n as boolean values: here is what I mean:</p>\n\n<pre><code>#include&lt;stdbool.h&gt;\n#define bool p\n#define y 1\n#define n 0\ndo {\n    /*some code*/ \n\n    printf(\"do you want to continue?! y/n\");\n    scanf(\"%B\",&amp;p);\n}while (p=='y');\n</code></pre>\n\n<p>I had been struggling a lot with it, so please help me!</p>\n"}, {"tags": ["c", "pointers", "operator-precedence"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1496266242, "post_id": 44294935, "comment_id": 75596257, "body": "You&#39;re confusing &quot;precedence&quot; with &quot;order of evaluation&quot;.  &quot;precedence&quot; means the process of determining what the operands are for each operator; for example precedence tells us that the postfix-<code>++</code> is incrementing <code>p</code>, and not <code>(*p)</code>.  &quot;Precedence&quot; says little about whether such an increment happens before or after any other nearby operation."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 1, "creation_date": 1496267008, "post_id": 44294935, "comment_id": 75596557, "body": "@VidorVistrom: That is a bad analogy, because the time of actual incrementation for the expression is unspecified."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496267512, "post_id": 44294935, "comment_id": 75596751, "body": "A handy reference may help <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\"><b>C Operator Precedence</b></a>. (pay attention to the <i>associativity</i>)"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496267520, "post_id": 44294935, "comment_id": 75596752, "body": "@Olaf : IMHO the underlying problem of this kind of confusions is that people don&#39;t realize the importance of <i>expressions</i>. C&#39;s main conceptual entitiy  is an <i>expression</i> . Side-effects, order of evaluation, etc are only operational details; the <i>expression</i> always comes first."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1496267570, "post_id": 44294935, "comment_id": 75596771, "body": "&quot;i am new to programming and it really seems that i cant get the hang of it&quot;. Honestly, I don&#39;t know how <code>++*p++</code> works, but most importantly I don&#39;t want to know. You shouldn&#39;t either. First, you will <b>never ever</b> write code like this. Second, you will <i>almost</i> <b>never ever</b> encounter code like this. And if you have the bad fortune to come across this, then you simply curse the author, refactor it if needed and then move on. My advice: don&#39;t worry about it. In real life, <b>clarity is one of the most important aspects of a code</b>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1496267617, "post_id": 44294935, "comment_id": 75596791, "body": "@wildplasser: Fully agree. There are a lot of fundamental things people don&#39;t get a grasp on. In fact, C is very simple. One just has to understand how it works. Problem is particular questions about a specific expression will not help a bit. That&#39;s why one should learn C from a (didactical) <b>good</b> C book. Youtube videos and most online tutorials are the worst resource one can pick."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1496267739, "post_id": 44294935, "comment_id": 75596829, "body": "@bolov: &quot;You shouldn&#39;t either.&quot; - That&#39;s not even bad advice! Of course a programmer should know! It is not so much about the specific expression in the question, but to understand the reason <b>why</b> it works like that! With this aspect, the expression is a usefull."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1496267872, "post_id": 44294935, "comment_id": 75596879, "body": "&quot;Doctor, Doctor it hurts when I do this...&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1496267896, "post_id": 44294935, "comment_id": 75596892, "body": "@BoPersson: &quot;So don&#39;t do this! - That&#39;s 200\u20ac&quot;"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496268115, "post_id": 44294935, "comment_id": 75596963, "body": "@Olaf I understand what you are saying, and I even agree with you. My little outburst comes after seeing too many people trying to teach obscure <i>expressions</i> like that in the early stages of learning <code>C</code>. This leads to impresionate on the learner that <code>C</code> is complex and complicated to learn, which in turn leads to a lower motivation to learn. It also induces the ideea that this kind of code is an accepted practice. In this context I think it is more important to encourage focus on more important basic concepts at the expense of an in depth understanding of <code>C</code>. [cont]"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1496268273, "post_id": 44294935, "comment_id": 75597016, "body": "@bolov: To be honest: I also use such an expression sometimes (as long as it really is that short). But I use parenthesis to make it more clear. Not using parens is not an indicator for a good programmer."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496268297, "post_id": 44294935, "comment_id": 75597025, "body": "@Olaf [cont] I completely agree that as a programmer you should have a bearing of how this code works, but I would reserve acquiring this understanding and knowledge after you have some grip on C. Again, for me it&#39;s about compromising the pure truth for the sake of a more down to earth teaching"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496268377, "post_id": 44294935, "comment_id": 75597057, "body": "@Olaf adding parenthesis changes everything because it make the code clear. Clarity is the big issue with this code. You don&#39;t know what the code does unless you check a table. Adding parenthesis completely solves the issue. So yes, with parenthesis it&#39;s perfectly fine."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496268996, "post_id": 44294935, "comment_id": 75597236, "body": "@Olaf and bear in mind my comment comes as a direct response to the OP&#39;s comment about &quot;being new to programming&quot; and being frustrated on &quot;not getting the hang of it&quot;."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1496269219, "post_id": 44294935, "comment_id": 75597336, "body": "on the other hand, I might be completely wrong on my approach..."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496270536, "post_id": 44294935, "comment_id": 75597809, "body": "@Olaf: there is a good reason for <code>while (*dst++ = *src++);</code> being in the first 20 pages of K&amp;R. But: obviously most people skip&amp;ignore it. For the rest of their lives."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1496272638, "post_id": 44294935, "comment_id": 75598334, "body": "@wildplasser: K&amp;R is not what I consider a good C book anymore. C99 has changed the game and (hopefully) the next version will eventually get rid of some of the more nasty legacies (at the cost of compatibility - <b>YES</b>!), so it will be even less useful. (Just let me my hopes :-). Siad that: compact code is not always bad code, nor is longer code. It all depends. After all, I expect someone reading my professional code to be a professional, too, thus know the language. That does not imply deeply nested expression trees, though."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1496273458, "post_id": 44294935, "comment_id": 75598571, "body": "@bolov: What you write in the comments are actually the major reason why I&#39;m really not sure if C is a good language to start preogramming. On one hand, it is very basic, but then it has some implications languages like e.g. Pascal don&#39;t have: Side-effect expressions which have a preceedence/priority <b>and</b> sequence. OTOH, if these two properties are explained very early to a beginner, I experienced they very well get a good grasp on the language. (there are some other concepts, too, of course). After all it is more a problem of the qualtiy of the teachers. That&#39;s my major concern actually."}], "answers": [{"comments": [{"owner": {"reputation": 4501, "user_id": 1053930, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/EyjC7.jpg?s=128&g=1", "display_name": "Shashwat Kumar", "link": "https://stackoverflow.com/users/1053930/shashwat-kumar"}, "edited": false, "score": 0, "creation_date": 1496266574, "post_id": 44294977, "comment_id": 75596373, "body": "can you explain answer for ++*p++ is replaced by *p++ and relate with this ?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 4501, "user_id": 1053930, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/EyjC7.jpg?s=128&g=1", "display_name": "Shashwat Kumar", "link": "https://stackoverflow.com/users/1053930/shashwat-kumar"}, "edited": false, "score": 0, "creation_date": 1496266699, "post_id": 44294977, "comment_id": 75596423, "body": "That&#39;s not what the OP asks @ShashwatKumar, if I understand well."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1496266756, "post_id": 44294977, "comment_id": 75596448, "body": "<b>When</b> <code>*p</code> is incremented is not specified. The same for <code>p</code> itself. That&#39;s exactly one of the things OP confuses. That &#39;s a vital thing your answer should provide."}, {"owner": {"reputation": 4501, "user_id": 1053930, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/EyjC7.jpg?s=128&g=1", "display_name": "Shashwat Kumar", "link": "https://stackoverflow.com/users/1053930/shashwat-kumar"}, "edited": false, "score": 0, "creation_date": 1496266850, "post_id": 44294977, "comment_id": 75596488, "body": "right... but this is giving different result if following the rule in answer."}, {"owner": {"reputation": 4501, "user_id": 1053930, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/EyjC7.jpg?s=128&g=1", "display_name": "Shashwat Kumar", "link": "https://stackoverflow.com/users/1053930/shashwat-kumar"}, "edited": false, "score": 1, "creation_date": 1496267163, "post_id": 44294977, "comment_id": 75596615, "body": "and <code>You first increment where p points to and then you advance the pointer by one.</code> is wrong actually."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496269038, "post_id": 44294977, "comment_id": 75597252, "body": "No it isn&#39;t, what is taking place is actually <code>++*p; p++;</code> Look at the Section 6.5.2.4 (2) carefully. In the original expression, the result of <code>p++</code> is just <code>p</code> (the increment is applied as a <i>side-effect</i> after the expression has been fully evaluated). Leaving <code>++*p</code> (with a <i>side-effect</i> of <code>p++</code> applied after evaluation)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496275128, "post_id": 44294977, "comment_id": 75598975, "body": "@DavidC.Rankin: That&#39;s not correct. The expression is not the same as the two statements. There is no sequence point in the expression, thus <b>when</b> the increments take place is not specified. It could be as well e.g. <code>{int *t = p++; ++*t;</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1496277647, "post_id": 44294977, "comment_id": 75599556, "body": "I&#39;m not sure I follow. <code>{int *t = p++; ++*t;}</code> would not satisfy <b>both</b> 6.5.2.4 (2) &quot;<i>The result of the postfix ++ operator is the value of the operand.</i>&quot; and <i>operator precedence</i> at the same time with regard to <code>++*p++</code>. Here precedence and 6.5.2.4 requires <code>p++</code> equal <code>p</code> with a side effect of <code>p+1</code> at some point. <code>*p</code> at this point is <code>20</code> unless you are saying the side effect can apply between evaluating the postfix operator and application of the dereference operator. (is that what you are saying?)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496306343, "post_id": 44294977, "comment_id": 75610289, "body": "@DavidC.Rankin Sorry, I thought mentioning there is <b>no</b> sequence point and &quot;\u2026 thus when the increments take place is not specified&quot; were clear enough. I provided <b>one</b> possible implementation at the machine layer using C code for simplicity. Actually on architectures like 68K and other CISC with <i>indirect post-increment</i> addressing mode both could happen with the same, single instruction (<code>addq #1,(A0)+</code>, <code>p</code> in register <code>A0</code>). \u2026"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496306486, "post_id": 44294977, "comment_id": 75610366, "body": "@DavidC.Rankin \u2026This does not change much for unqualified objects, but for atomic and <code>volatile</code> <code>*p</code> (e.g. <code>volatile int * volatile p;</code>), it will change the behaviour completely from plain &quot;wrong&quot; (single statement) to correct (two statements, resp. one statement/one definition). Hoiwever, the problem is not the preceesdence, which all versions cover, but the <b>sequencing of the side-effects</b> relative to each other. As I wrote, for this specific expression it might be quite not very relevant, but as you might have noticed, I prefer to teach fishing instead of feeding a fish."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 2, "last_activity_date": 1496266176, "creation_date": 1496266176, "answer_id": 44294977, "question_id": 44294935, "link": "https://stackoverflow.com/questions/44294935/p-cant-understand-the-precedence-thing/44294977#44294977", "title": "++*p++ cant understand the precedence thing", "body": "<p>You first increment where <code>p</code> points to and then you advance the pointer by one.</p>\n\n<p>So, <code>p</code> points to 20, thus ++20 = 21.</p>\n\n<p>Then the pointer will be increased by once, and due to <a href=\"https://www.cs.umd.edu/class/sum2003/cmsc311/Notes/BitOp/pointer.html\" rel=\"nofollow noreferrer\">pointer's arithmetic</a>, it will point to next element of 20, which is 30, in your array.</p>\n\n<p>As M.M said, you are confusing, the <em>order of evaluation</em> with precedence. Read more about it <a href=\"http://en.cppreference.com/w/cpp/language/eval_order\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1496268416, "post_id": 44295159, "comment_id": 75597064, "body": "If I read the confusion the OP is having, it is due to being unclear on &quot;<i>The result of the postfix ++ operator is the value of the operand.</i>&quot; (<b>full-stop</b>, the result of <code>p++</code> is just <code>p</code>)... and that &quot;<i>As a side effect ... the value 1 of the appropriate type is added to it)</i>&quot;... <b>after</b> the expression has been fully evaluated. In effect, it could be refactored <code>++*p; p++;</code>."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496269108, "post_id": 44295159, "comment_id": 75597284, "body": "@DavidC.Rankin A good remark! I have updated my post with my bad English.:)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496269209, "post_id": 44295159, "comment_id": 75597334, "body": "Great explanation Vlad. It is a good exercise in understanding, but I agree with the comments &quot;the coder should be shot&quot; if it was actually coded that way <code>:)</code>"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 8, "last_activity_date": 1496269081, "last_edit_date": 1496269081, "creation_date": 1496267067, "answer_id": 44295159, "question_id": 44294935, "link": "https://stackoverflow.com/questions/44294935/p-cant-understand-the-precedence-thing/44295159#44295159", "title": "++*p++ cant understand the precedence thing", "body": "<p>From the C++ Standard (the same is valid for the C Standard)</p>\n\n<blockquote>\n  <p>5.2 Postfix expressions \n  1 Postfix expressions group <strong>left-to-right</strong>.</p>\n</blockquote>\n\n<p>Postfix expressions and <code>p++</code> is a postfix expression have higher priority than unary expressions.</p>\n\n<p>The C++ Standard</p>\n\n<blockquote>\n  <p>5.3 Unary expressions \n  1 Expressions with unary operators group <strong>right-to-left</strong>.</p>\n</blockquote>\n\n<p>In this expression <code>++*p</code> there are two unary subexpressions: <code>*p</code> and <code>++( *p )</code></p>\n\n<p>So the whole expression can be written like</p>\n\n<pre><code>++( *( p++ ) );\n</code></pre>\n\n<p>Take into account regarding the postfix expression ++ that (now it is the C Standard)</p>\n\n<blockquote>\n  <p>6.5.2.4 Postfix increment and decrement operators</p>\n  \n  <p>2 The result of the postfix ++ operator is the value of the operand.\n  As a side effect, the value of the operand object is incremented (that\n  is, the value 1 of the appropriate type is added to it).</p>\n</blockquote>\n\n<p>Let's consider the result of the expression statement</p>\n\n<pre><code>++( *( p++ ) );\n</code></pre>\n\n<p>subexpression <code>p++</code> has the value of its operand that is the address of type <code>int *</code> of the first element of the array. Then due to the dereferencing the expression <code>*( p++ )</code> yields the lvalue of the first element of the array that is <code>x[0]</code> and then its value is increased. So the first element of the arry now has the value 21.</p>\n\n<p>At the same time the postfix increment incremented the pointer <code>p</code> as its side effect (see the quote above from the C Standard). Its now points to the second element of the array.</p>\n\n<p>Thus the output will be</p>\n\n<pre><code>21 30\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1496272318, "creation_date": 1496272318, "answer_id": 44296062, "question_id": 44294935, "link": "https://stackoverflow.com/questions/44294935/p-cant-understand-the-precedence-thing/44296062#44296062", "title": "++*p++ cant understand the precedence thing", "body": "<blockquote>\n  <p>according to C operator precedence the postfix increment comes first</p>\n</blockquote>\n\n<p><strong>Precedence</strong> is not the same thing as <strong>order of evaluation</strong>.  </p>\n\n<p><strong>Precedence</strong> controls which operators are grouped with which operands.  In this case, the expression <code>++*p++;</code> is <em>parsed</em> as <code>++(*(p++))</code>.  </p>\n\n<p>The <strong>order of evaluation</strong> is</p>\n\n<ol>\n<li>Evaluate <code>p++</code>; the <em>result</em> of this evaluation is <code>&amp;x[0]</code>, and the <em>side effect</em> is to advance <code>p</code> to point to <code>x[1]</code>;</li>\n<li>Dereference the result of 1; the result of this evaluation is <code>x[0]</code>;</li>\n<li>Apply the prefix <code>++</code> operator to the result of 2; the <em>result</em> of this evaluation is <code>x[0] + 1</code>, with the <em>side effect</em> that the value stored in <code>x[0]</code> is incremented.  </li>\n</ol>\n\n<p>Remember that side effects do not have to be applied immediately upon evaluation; they may be deferred until a sequence point.  </p>\n"}], "owner": {"reputation": 37, "user_id": 8094394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6047ca0f57d7f508e660682ba8a2558e?s=128&d=identicon&r=PG&f=1", "display_name": "J.T", "link": "https://stackoverflow.com/users/8094394/j-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 938, "favorite_count": 0, "accepted_answer_id": 44295159, "answer_count": 3, "score": 1, "last_activity_date": 1496272318, "creation_date": 1496265990, "last_edit_date": 1496266106, "question_id": 44294935, "link": "https://stackoverflow.com/questions/44294935/p-cant-understand-the-precedence-thing", "title": "++*p++ cant understand the precedence thing", "body": "<p>running this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int x[]={20,30};\n    int *p=x;\n    ++*p++;\n    printf(\"%d %d\\n\",x[0],*p);\n    return 0;\n}\n</code></pre>\n\n<p>the output is 21 30 which is something that doesn't make sense to me because according to C operator precedence the postfix increment comes first though if that was the case in my opinion the output should be 20 31.For the record i am new to programming and it really seems that i cant get the hang of it so sorry if this question is stupid :) </p>\n"}, {"tags": ["python", "c", "distutils", "python-c-extension"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496266381, "post_id": 44294895, "comment_id": 75596296, "body": "You ar looking for the documentation. Search somewhere on python.org."}, {"owner": {"reputation": 117275, "user_id": 5393381, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/308ffa6266fda6d94bc56fbd9e9798f9?s=128&d=identicon&r=PG&f=1", "display_name": "MSeifert", "link": "https://stackoverflow.com/users/5393381/mseifert"}, "edited": false, "score": 0, "creation_date": 1496266398, "post_id": 44294895, "comment_id": 75596304, "body": "you&#39;re calling these functions directly or are the functions in <code>code.c</code> c-functions that can be called also from Python? In the first case you could just link to &quot;code.c&quot; (either include or like a library) and in the latter case just &quot;import&quot; the &quot;code.c&quot; python module. In case your looking for good answers, could you provide some example of the files and how you want to call them?"}, {"owner": {"reputation": 133, "user_id": 4261833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f86672c7adf2d5fb5e9af962cf0c36?s=128&d=identicon&r=PG&f=1", "display_name": "MFigueredo", "link": "https://stackoverflow.com/users/4261833/mfigueredo"}, "reply_to_user": {"reputation": 117275, "user_id": 5393381, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/308ffa6266fda6d94bc56fbd9e9798f9?s=128&d=identicon&r=PG&f=1", "display_name": "MSeifert", "link": "https://stackoverflow.com/users/5393381/mseifert"}, "edited": false, "score": 0, "creation_date": 1496267844, "post_id": 44294895, "comment_id": 75596868, "body": "@MSeifert See the EDIT. But briefly, the python code calls the function in <code>main.c</code>. And only <code>main.c</code> calls the function in <code>code.c</code>."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 4261833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f86672c7adf2d5fb5e9af962cf0c36?s=128&d=identicon&r=PG&f=1", "display_name": "MFigueredo", "link": "https://stackoverflow.com/users/4261833/mfigueredo"}, "edited": false, "score": 0, "creation_date": 1496269367, "post_id": 44295486, "comment_id": 75597397, "body": "It works perfectly if you remove the <code>.h</code> from the sources list. Thanks very much my friend!!!!"}, {"owner": {"reputation": 117275, "user_id": 5393381, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/308ffa6266fda6d94bc56fbd9e9798f9?s=128&d=identicon&r=PG&f=1", "display_name": "MSeifert", "link": "https://stackoverflow.com/users/5393381/mseifert"}, "reply_to_user": {"reputation": 133, "user_id": 4261833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f86672c7adf2d5fb5e9af962cf0c36?s=128&d=identicon&r=PG&f=1", "display_name": "MFigueredo", "link": "https://stackoverflow.com/users/4261833/mfigueredo"}, "edited": false, "score": 0, "creation_date": 1496269910, "post_id": 44295486, "comment_id": 75597581, "body": "@MFigueredo You&#39;re welcome. Just a question - I&#39;m not sure if I understand your comment correctly: <code>sources=[&#39;main.c&#39;, &#39;code.c&#39;]</code> (without the <code>code.h</code>) worked for you?"}], "tags": [], "owner": {"reputation": 117275, "user_id": 5393381, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/308ffa6266fda6d94bc56fbd9e9798f9?s=128&d=identicon&r=PG&f=1", "display_name": "MSeifert", "link": "https://stackoverflow.com/users/5393381/mseifert"}, "is_accepted": true, "score": 1, "last_activity_date": 1496268817, "creation_date": 1496268817, "answer_id": 44295486, "question_id": 44294895, "link": "https://stackoverflow.com/questions/44294895/using-multiples-c-codes-in-one-extension-module-python/44295486#44295486", "title": "Using multiples C codes in one extension module Python", "body": "<p>This is too long for a comment and I'm not sure that it will fix the problem. I think it's just because it doesn't compile <code>code.c</code> and <code>code.h</code> when they are not listed explicitly as source (see <a href=\"https://docs.python.org/distutils/setupscript.html#extension-names-and-packages\" rel=\"nofollow noreferrer\">\"Extension names and packages\"</a>).</p>\n\n<p>Personally I would use either the <a href=\"https://docs.python.org/distutils/setupscript.html#other-options\" rel=\"nofollow noreferrer\"><code>depends</code></a> argument for the <code>Extension</code>:    </p>\n\n<pre><code>from glob import glob\n\next =  [Extension('main',\n                  sources=['main.c'] ,\n                  depends=glob('*.c') + glob('*.h'),\n                  extra_compile_args=['-lpq'] ,\n                  extra_link_args=['-L/usr/local/pgsql/lib','-lpq'],\n                  language=['c']\n                  )\n        ]\n</code></pre>\n\n<p>or list all the files in <code>source</code>:</p>\n\n<pre><code>ext =  [Extension('main',\n                  sources=['main.c', 'code.h', 'code.c'] ,\n                  extra_compile_args=['-lpq'] ,\n                  extra_link_args=['-L/usr/local/pgsql/lib','-lpq'],\n                  language=['c']\n                  )\n        ]\n</code></pre>\n\n<p>Not sure if the order of the source files or depends files matters...</p>\n"}], "owner": {"reputation": 133, "user_id": 4261833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f86672c7adf2d5fb5e9af962cf0c36?s=128&d=identicon&r=PG&f=1", "display_name": "MFigueredo", "link": "https://stackoverflow.com/users/4261833/mfigueredo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 2, "accepted_answer_id": 44295486, "answer_count": 1, "score": 1, "last_activity_date": 1496270524, "creation_date": 1496265824, "last_edit_date": 1496270524, "question_id": 44294895, "link": "https://stackoverflow.com/questions/44294895/using-multiples-c-codes-in-one-extension-module-python", "title": "Using multiples C codes in one extension module Python", "body": "<p>I have used C code in a Python project like in <a href=\"https://www.tutorialspoint.com/python/python_further_extensions.htm\" rel=\"nofollow noreferrer\">this</a> tutorial.\nI built an extension so that it was possible to call the <code>A</code> function present in the <code>main.c</code> code through Python. However, function <code>A</code> calls other various functions that are present in a file called <code>code.c</code>, and I'm having trouble using those functions.</p>\n\n<p><strong>There are no problems if all the functions are placed in <code>main.c</code>, but I would like to modularize this project for organizational reasons!</strong></p>\n\n<p>The <code>setup.py</code> for building the modules is as follows.</p>\n\n<pre><code>ext       =  [\n                 Extension(\n                 'main',\n                 sources = ['main.c'] ,\n                 extra_compile_args=['-lpq'] ,\n                 extra_link_args = ['-L/usr/local/pgsql/lib','-lpq'],\n                 language=['c']\n                 )\n            ]\n\nsetup(name='project', version='1.0', ext_modules = ext)\n</code></pre>\n\n<p>How could I modify it so that the <code>code.c</code> functions could be used inside <code>main.c</code> without any problems?</p>\n\n<p>Here is an outline of the situation:</p>\n\n<h2>main.c</h2>\n\n<pre><code>#include &lt;Python.h&gt;\n#include \"code.h\"\n\n//....\n\nvoid send(char* name)\n{\n   //DO SOMETHING\n   function_from_code(name)\n}\n</code></pre>\n\n<h2>code.c</h2>\n\n<pre><code>.....\n\n#include \"code.h\"\n\nvoid function_from_code(char* name)\n{\n   //DO SOMETHING\n}  \n</code></pre>\n\n<p>and then the Python code:</p>\n\n<pre><code>import main\n\n...\n\nmain.send(\"My Name\")\n</code></pre>\n\n<p>So in this way, the python code calls the function of <code>module</code> main C (so far so good). At the moment <code>main.c</code> calls a function from <code>code.c</code>, it throws the following error:</p>\n\n<pre><code>ImportError: /usr/local/lib/python2.7/dist-packages/main.so: undefined symbol: function_from_code\n</code></pre>\n\n<p>Apparently, using <code>#include</code> is not enough.</p>\n"}, {"tags": ["c++", "c", "ada"], "comments": [{"owner": {"reputation": 561, "user_id": 4376373, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/100006052897811/picture?type=large", "display_name": "Patrick Kelly", "link": "https://stackoverflow.com/users/4376373/patrick-kelly"}, "edited": false, "score": 1, "creation_date": 1496264871, "post_id": 44294657, "comment_id": 75595708, "body": "pragma Export, or the related aspects if you&#39;re working with Ada 2012, are what you&#39;re looking for, at least by my understanding of your goal. You can write a script to generate those exports for you; that&#39;s what I&#39;d do."}, {"owner": {"reputation": 49, "user_id": 8094246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ddaae5648b1416c5d0e04d5014763ec?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/8094246/tony"}, "edited": false, "score": 0, "creation_date": 1496264981, "post_id": 44294657, "comment_id": 75595748, "body": "Sorry for confusion, I mean either C or C++ will do. Preferably C++."}, {"owner": {"reputation": 49, "user_id": 8094246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ddaae5648b1416c5d0e04d5014763ec?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/8094246/tony"}, "reply_to_user": {"reputation": 561, "user_id": 4376373, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/100006052897811/picture?type=large", "display_name": "Patrick Kelly", "link": "https://stackoverflow.com/users/4376373/patrick-kelly"}, "edited": false, "score": 0, "creation_date": 1496265511, "post_id": 44294657, "comment_id": 75595954, "body": "@PatrickKelly : Can you please elaborate on how you use the script? I have never used a script before to expose ADA functions to C. Or may be share a simple script. Thanks"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496266220, "post_id": 44294657, "comment_id": 75596245, "body": "C and C++ are different languages with typically different ABIs and interfaces. The ABIs are also platform-specific. As asked, your question is far too broad. I t does not show any research on your side (apart from some <code>pragma</code> which is not standard. As a sidenote: if Ada was picked for safety reasons, now using C or C++ definitively will break the safe chain. &quot;Nice and neat (and pinted in pink)&quot; are certainly not major preferences in a safety critical environment."}, {"owner": {"reputation": 1180, "user_id": 4766261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd4d03badb6ebc92b17af75766fdd57?s=128&d=identicon&r=PG", "display_name": "SiggiSv", "link": "https://stackoverflow.com/users/4766261/siggisv"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1496267813, "post_id": 44294657, "comment_id": 75596854, "body": "@Olaf Since when is <code>pragma export</code> not standard Ada? It can be found in the current standard right here: <a href=\"http://www.ada-auth.org/standards/aarm12_w_tc1/html/AA-J-15-5.html\" rel=\"nofollow noreferrer\">ada-auth.org/standards/aarm12_w_tc1/html/AA-J-15-5.html</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1180, "user_id": 4766261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd4d03badb6ebc92b17af75766fdd57?s=128&d=identicon&r=PG", "display_name": "SiggiSv", "link": "https://stackoverflow.com/users/4766261/siggisv"}, "edited": false, "score": 0, "creation_date": 1496268024, "post_id": 44294657, "comment_id": 75596935, "body": "@SiggiSv: Sorry, I though OP means the C-preprocessor <code>#pragma</code>. That&#39;s the problem with too broad and cross-tagged questions. Anyway, there is something similar required on the C and C++ side, too."}, {"owner": {"reputation": 561, "user_id": 4376373, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/100006052897811/picture?type=large", "display_name": "Patrick Kelly", "link": "https://stackoverflow.com/users/4376373/patrick-kelly"}, "edited": false, "score": 0, "creation_date": 1496269814, "post_id": 44294657, "comment_id": 75597553, "body": "@Tony I just mean one you write up. Exactly what language used would be whatever you&#39;re comfortable with. This is too dependent on how you want to expose the functions and procedures, so I can&#39;t give you a generic script. But basically you just need to insert a line after each, with pragma export(stuff...). Exactly like you would manually, but in the script you can do things like yank the name of the procedure, reformat it C++ style, and place the new name in the export."}, {"owner": {"reputation": 49, "user_id": 8094246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ddaae5648b1416c5d0e04d5014763ec?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/8094246/tony"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496273332, "post_id": 44294657, "comment_id": 75598539, "body": "@olaf The C++ part of the system is also verifiable and certifiable as per applicable safety standards. Its just that some parts of the system have a class of safety requirements that can only be met by Ada. I do understand the ABI interface and have some working set of API calls from C. It&#39;s just not scalable to add 1000 pragma export statements and translate parameters."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496273667, "post_id": 44294657, "comment_id": 75598623, "body": "@Tony: There is always Python \u2026 just write a small Python prgramm to parse the Ada code and add the pragmas as required (I refrain from using regexpr only; Some guru might provide you a some 100 chars sed construct, but that&#39;s not my thing)."}, {"owner": {"reputation": 22472, "user_id": 40851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RwWVj.jpg?s=128&g=1", "display_name": "Simon Wright", "link": "https://stackoverflow.com/users/40851/simon-wright"}, "edited": false, "score": 2, "creation_date": 1496301649, "post_id": 44294657, "comment_id": 75607189, "body": "You might get more traction over on <a href=\"https://groups.google.com/forum/#!forum/comp.lang.ada\" rel=\"nofollow noreferrer\">comp.lang.ada</a>. Here, the question is in danger of being closed: <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>. That said, since the existing Ada is safety-related you probably won\u2019t find awkward things like tagged types, access-to-subprogram, generics in the interface. If noone comes up with a tool, I\u2019d look at making an ASIS-based one: my <a href=\"https://sourceforge.net/projects/asis2xml/\" rel=\"nofollow noreferrer\">ASIS2XML</a> (the release is out of date, get the Code), or there\u2019s one for GNAT (<code>gnat2xml</code>, supported by <code>gnat2xsd</code>) buildable from their ASIS archive."}, {"owner": {"reputation": 49, "user_id": 8094246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ddaae5648b1416c5d0e04d5014763ec?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/8094246/tony"}, "edited": false, "score": 0, "creation_date": 1496324244, "post_id": 44294657, "comment_id": 75623446, "body": "Thanks Simon, I will post the question there too and check out sources you have mentioned."}, {"owner": {"reputation": 3643, "user_id": 608963, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fbb0a6e7d0e30d4904a3a22a7398c969?s=128&d=identicon&r=PG&f=1", "display_name": "Shark8", "link": "https://stackoverflow.com/users/608963/shark8"}, "edited": false, "score": 0, "creation_date": 1500505841, "post_id": 44294657, "comment_id": 77372026, "body": "@Tony -- Did you try adding &quot;with Convention =&gt; C_Plus_Plus, Export&quot; to the package heading? (I&#39;m assuming you&#39;re using Ada 2012.) -- I&#39;d like to know if that worked for you."}], "answers": [{"comments": [{"owner": {"reputation": 2330, "user_id": 7237062, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/z4Nky.jpg?s=128&g=1", "display_name": "LoneWanderer", "link": "https://stackoverflow.com/users/7237062/lonewanderer"}, "edited": false, "score": 1, "creation_date": 1497381207, "post_id": 44424742, "comment_id": 76051141, "body": "This is similar to this: <a href=\"https://stackoverflow.com/questions/42938883/interface-ada-dynamic-library-with-java-using-jna-and-adas-interface-c-packages/42938971#42938971\" title=\"interface ada dynamic library with java using jna and adas interface c packages\">stackoverflow.com/questions/42938883/&hellip;</a>. As @Shark8 stated, you can either add the <code>pragma export</code> on the methods you want to expose, or add a routing layer written with <code>pragma export</code> that makes the effective call to Ada procedures/functions. The additionnal layer can be useful is you have some types transformations to do : for isntance, if you have types with discriminents in inputs of your ada services. Since Ada structures can&#39;t always be mapped easily with C/C++"}], "tags": [], "owner": {"reputation": 3643, "user_id": 608963, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fbb0a6e7d0e30d4904a3a22a7398c969?s=128&d=identicon&r=PG&f=1", "display_name": "Shark8", "link": "https://stackoverflow.com/users/608963/shark8"}, "is_accepted": false, "score": 1, "last_activity_date": 1496881359, "creation_date": 1496881359, "answer_id": 44424742, "question_id": 44294657, "link": "https://stackoverflow.com/questions/44294657/expose-ada-api-to-c-c-the-scalable-way/44424742#44424742", "title": "Expose ADA API to C/C++ ( the Scalable way )", "body": "<p>You could try adding the <code>Export</code> and <code>Convention =&gt; X</code> aspects to the package if you're using an Ada 2012 compiler; example:</p>\n\n<pre><code>Package K with Export, Convention =&gt; C_Plus_Plus is\n\n    Function A( Input_1, Input_2 : Integer ) return Integer;\n\nEnd K;\n</code></pre>\n\n<p>This actually compiles, though since I don't have any C++ or C mixed-source projects to try this on I can't tell you if the results are strictly-speaking usable from the C++ side.</p>\n\n<p><strong><em>If that doesn't work</em></strong>, perhaps a better method would be to create a package especially for exporting the functions (and types) that will be used on the C++ side.</p>\n\n<pre><code>With\nSystem,\nInterfaces.C.Strings,\nInterfaces.C.Pointers;\n\nPackage K with Convention =&gt; C_Plus_Plus is\n\n    -------------\n    --  TYPES  --\n    -------------\n\n    Type CPP_Window_Handle is Private;\n    Subtype CPP_String is Interfaces.C.Strings.chars_ptr;\n\n    --------------\n    -- MODULES  --\n    --------------\n\n    Package UI_Module is\n        Procedure Set_Title( Window : CPP_Window_Handle; Text : CPP_String )\n        with Export;\n    End UI_Module;\n\nPrivate\n    Package STUB_TYPES is\n        Type Window is tagged null record;\n    End STUB_TYPES;\n    Use STUB_TYPES;\n\n    Type CPP_Window_Handle is not null access Window'Class\n    with Convention =&gt; C_Plus_Plus, Size =&gt; Interfaces.C.int'Size;\n\nEnd K;\n</code></pre>\n\n<p>Implemented as:</p>\n\n<pre><code>Package Body K is\n\n    Package STUB_FUNCTIONS is\n        Procedure Set_Window(Object : in out STUB_TYPES.Window'Class; Text : String) is null;\n        --'\n    End STUB_FUNCTIONS;\n\n    Package Ada_Dependencies renames STUB_FUNCTIONS;\n\n    Package Body UI_Module is\n        Procedure Set_Title( Window : CPP_Window_Handle; Text : CPP_String ) is\n            function Value (Item : CPP_String) return Interfaces.C.char_array\n              renames Interfaces.C.Strings.Value;\n            function Convert(Item     : Interfaces.C.char_array;\n                             Trim_Nul : Boolean := True) return String\n              renames Interfaces.C.To_Ada;\n        Begin\n            Ada_Dependencies.Set_Window(\n              Object =&gt; Window.all,\n              Text   =&gt; Convert( Value( Text ) )\n          );\n        End Set_Title;\n\n    End UI_Module;\n\nEnd K;\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8094246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ddaae5648b1416c5d0e04d5014763ec?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/8094246/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496881359, "creation_date": 1496264679, "last_edit_date": 1496265368, "question_id": 44294657, "link": "https://stackoverflow.com/questions/44294657/expose-ada-api-to-c-c-the-scalable-way", "title": "Expose ADA API to C/C++ ( the Scalable way )", "body": "<p>Recently, I came across a safety critical system that uses only Ada. The system provides about 3 packages with about 200-300 functions in each package as source. </p>\n\n<p>I need to access almost all of these function in another software system (very nice and neat) that is completely written in C/C++.</p>\n\n<p><strong>Goal:</strong> I need to expose these Ada functions to C/C++.</p>\n\n<p>I understand I can use <code>pragma Export()</code> construct to export the functions and interfaces.C package to  convert parameters between C and Ada.</p>\n\n<p>But, I was wondering if there's an easier or more scalable way to do this?</p>\n\n<ol>\n<li>Maybe expose the complete package somehow?</li>\n<li>Or develop an RPC Architecture?</li>\n<li>Or use a tool that creates the C/C++ declarations and Type Conversions?</li>\n</ol>\n\n<p>It would really help if somebody with similar experience could point me in the right direction. </p>\n\n<p>Remember I am <em>not</em> looking for an <a href=\"https://stackoverflow.com/questions/10817349/modern-ada-to-c-c-translator\">Ada to C translator</a></p>\n"}, {"tags": ["arrays", "c", "c-strings", "string-literals"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 24, "creation_date": 1496264690, "post_id": 44294649, "comment_id": 75595644, "body": "You haven&#39;t overwritten anything. You just pointed <code>fruit</code> at a different string."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1496264811, "post_id": 44294649, "comment_id": 75595691, "body": "try <code>const char * const fruit = &quot;banana&quot;;</code>"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 11, "creation_date": 1496264986, "post_id": 44294649, "comment_id": 75595750, "body": "A <code>char*</code> is not read-only. A string literal like <code>&quot;banana&quot;</code> or <code>&quot;apple&quot;</code> is read-only. C allows <code>char*</code> to point to a string literal."}, {"owner": {"reputation": 466, "user_id": 7786319, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1347f9c17226d9b3fc86dce269731c5?s=128&d=identicon&r=PG&f=1", "display_name": "sally2000", "link": "https://stackoverflow.com/users/7786319/sally2000"}, "edited": false, "score": 0, "creation_date": 1496265159, "post_id": 44294649, "comment_id": 75595830, "body": "right ok - so it&#39;s read-only because I can&#39;t actually change &#39;banana&#39; , I can just reallocate the pointer to some string somewhere else in memory?"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 4, "creation_date": 1496265251, "post_id": 44294649, "comment_id": 75595866, "body": "There&#39;s no reallocation happening. Both <code>&quot;banana&quot;</code> and <code>&quot;apple&quot;</code> are already allocated in static memory when the program starts. All you&#39;re doing is changing the value of <code>fruit</code> to be the address of where <code>&quot;apple&quot;</code> is stored."}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1496265263, "post_id": 44294649, "comment_id": 75595870, "body": "<code>char *fruit = &quot;banana&quot;</code> is read only memory, it just has &quot;banana&quot; in the read-only parts of the memory. making fruit a pointer to that makes any writing operation on this memory illegal."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1496265617, "post_id": 44294649, "comment_id": 75595998, "body": "@sally2000, think of it this way, when you declare a pointer and initialize it to point to <code>&quot;banna&quot;</code>, you initialize the pointer to point to the address of the first letter <code>&#39;b&#39;</code>. (e.g. in <code>char* fruit = &quot;banana&quot;;</code>). <code>fruit</code> (a pointer) just holds the <i>address of</i> <code>&#39;b&#39;</code> as its <i>value</i>. When you assign <code>fruit = &quot;apple&quot;;</code>, you are simply changing the value held by <code>fruit</code> to the <i>address of</i> <code>&#39;a&#39;</code>. So now <code>fruit</code> <i>points to</i> the <code>&#39;a&#39;</code> in <code>&quot;apple&quot;</code> (which allows access to <code>&quot;apple&quot;</code> as a <i>string</i>)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496267077, "post_id": 44294649, "comment_id": 75596580, "body": "To round out the excellent group of answers and comments, just be aware of an additional way to initialize <code>char *fruit</code> so that it DOES point to a modifiable array in memory. You can use a <i>compound literal</i> to initialize <code>fruit</code> to point to the modifiable <code>&quot;banana&quot;</code> using <code>char *fruit = (char []){ &quot;banana&quot; };</code> Here the <i>compound literal</i> (or <i>compound initializer</i>) is simply a <i>cast-to-type</i> prior to the string <code>&quot;banana&quot;</code>. It is available in C99 and later (and provided as an extension by some for earlier language standards)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496267348, "post_id": 44294649, "comment_id": 75596695, "body": "C does not have a concept of &quot;read-only memory&quot;. All guarantees are given by the programmer and it is his responsibility not to break this contract. For typical declarations, the compiler will report a diagnostic message, but there are ways to break the contract without. And a <code>char *</code> is a pointer which can be modified (no guarantees by the programmer)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496267538, "post_id": 44294649, "comment_id": 75596758, "body": "As a sidenote: If you have questions regarding what was taught, you should first talk to your teacher/tutor. He best should know what he wanted to say. As there are a lot of bad teachers around, a good C book as backup is strongly recommended, too."}], "answers": [{"comments": [{"owner": {"reputation": 466, "user_id": 7786319, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1347f9c17226d9b3fc86dce269731c5?s=128&d=identicon&r=PG&f=1", "display_name": "sally2000", "link": "https://stackoverflow.com/users/7786319/sally2000"}, "edited": false, "score": 1, "creation_date": 1496265676, "post_id": 44294690, "comment_id": 75596023, "body": "mm ok but if i use char[] instead e.g. fruit [10] = {&#39;a&#39;,&#39;p&#39;,&#39;p&#39;,&#39;l&#39;,&#39;e&#39;,&#39;\\0&#39;} is fruit here not also just a pointer to the memory address of &#39;a&#39;? how come I can change char[] but not char*?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 466, "user_id": 7786319, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1347f9c17226d9b3fc86dce269731c5?s=128&d=identicon&r=PG&f=1", "display_name": "sally2000", "link": "https://stackoverflow.com/users/7786319/sally2000"}, "edited": false, "score": 1, "creation_date": 1496265748, "post_id": 44294690, "comment_id": 75596048, "body": "@sally2000 If you are using a character array instead of a string literal and have a pointer to the first character of the character array then you may change it provided thatf the array is not declared with qualifier const."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 466, "user_id": 7786319, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1347f9c17226d9b3fc86dce269731c5?s=128&d=identicon&r=PG&f=1", "display_name": "sally2000", "link": "https://stackoverflow.com/users/7786319/sally2000"}, "edited": false, "score": 0, "creation_date": 1496265870, "post_id": 44294690, "comment_id": 75596101, "body": "@sally2000 Internally string literals are stored as arrays with the static storage duration that may not be changed."}, {"owner": {"reputation": 101, "user_id": 5503610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110011e042ac27183cb91d71b7ef72d9?s=128&d=identicon&r=PG", "display_name": "rackandboneman", "link": "https://stackoverflow.com/users/5503610/rackandboneman"}, "edited": false, "score": 1, "creation_date": 1496272033, "post_id": 44294690, "comment_id": 75598188, "body": "The string literal could be in read-only memory in some implementations (harvard-ish machines, or something running straight out of ROM, or a mmap-ed shared library on a modern protected mode system...) ... writing it would simply fail or even trigger a hardware exception... in other environments you would attempt and succeed..."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 466, "user_id": 7786319, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1347f9c17226d9b3fc86dce269731c5?s=128&d=identicon&r=PG&f=1", "display_name": "sally2000", "link": "https://stackoverflow.com/users/7786319/sally2000"}, "edited": false, "score": 2, "creation_date": 1496302110, "post_id": 44294690, "comment_id": 75607526, "body": "@sally2000:  <b>NO</b>  If you have an array, <code>fruit</code> is not a pointer - it is an array.  Now it is true that if you use the name of an array, it will decay into a pointer to char, but it <i>is</i> an array.  For instance if you write <code>char  fruit [10] = {&#39;a&#39;,&#39;p&#39;,&#39;p&#39;,&#39;l&#39;,&#39;e&#39;,&#39;\\0&#39;};</code> you can&#39;t then write <code>fruit = &quot;banana&quot;;</code>.  You will also find that <code>sizeof(fruit);</code> is 10, not <code>sizeof(char*)</code> (which is probably 4 or 8)."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 24, "last_activity_date": 1615712436, "last_edit_date": 1615712436, "creation_date": 1496264826, "answer_id": 44294690, "question_id": 44294649, "link": "https://stackoverflow.com/questions/44294649/if-chars-are-read-only-why-can-i-overwrite-them/44294690#44294690", "title": "If char*s are read only, why can I overwrite them?", "body": "<p>The presented code snippet does not change the string literals themselves. It only changes the values stored in the pointer <code>fruit</code>.</p>\n<p>You can imagine these lines</p>\n<pre><code>char* fruit = &quot;banana&quot;;\nfruit = &quot;apple&quot;;\n</code></pre>\n<p>the following way</p>\n<pre><code>char unnamed_static_array_banana[] = { 'b', 'a', 'n', 'a', 'n', 'a', '\\0' };\nchar *fruit = &amp;unnamed_static_array_banana[0];\nchar unnamed_static_array_apple[]  = { 'a', 'p', 'p', 'l', 'e', '\\0' };\nfruit = &amp;unnamed_static_array_apple[0];\n</code></pre>\n<p>These statements do not change the arrays that correspond to the string literals.</p>\n<p>On the other hand if you will try to write</p>\n<pre><code>char* fruit = &quot;banana&quot;;\nprintf(&quot;fruit is %s\\n&quot;, fruit);\nfruit[0] = 'h';\n^^^^^^^^^^^^^^\nprintf(&quot;fruit is %s\\n&quot;, fruit);\n</code></pre>\n<p>that is if you will try to change a string literal using a pointer that points to it (to the first character of the string literal) then the program will have undefined behavior.</p>\n<p>From the C Standard (6.4.5 String literals)</p>\n<blockquote>\n<p>7 It is unspecified whether these arrays are distinct provided their\nelements have the appropriate values. <strong>If the program attempts to\nmodify such an array, the behavior is undefined.</strong></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496285621, "post_id": 44294694, "comment_id": 75601326, "body": "&quot;fruit as a pointer to a constant character &quot;  --&gt; Disagree.  <a href=\"https://stackoverflow.com/questions/44294649/if-chars-are-read-only-why-can-i-overwrite-them#comment75598188_44294690\">@rackandboneman</a> comment says it well.  <code>fruit</code> is a <code>char *</code>.  With its original value, attempting to change what it points to is UB."}], "tags": [], "owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "is_accepted": false, "score": 2, "last_activity_date": 1496269801, "last_edit_date": 1496269801, "creation_date": 1496264835, "answer_id": 44294694, "question_id": 44294649, "link": "https://stackoverflow.com/questions/44294649/if-chars-are-read-only-why-can-i-overwrite-them/44294694#44294694", "title": "If char*s are read only, why can I overwrite them?", "body": "<p>What your course has taught you is correct!   </p>\n\n<p>When you defined <code>char* fruit = \"banana\"</code> in the first place you basically have <code>fruit</code> as a pointer to a <em>constant character</em> . The 7 bytes (including the null termination) of the string resides in the <code>.ro</code> section of the object file (section name would obviously vary depending on the platform).  </p>\n\n<p>When you reset the char pointer fruit to \"apple\" it just pointed to another memory location in the read only section which contains \"apple\"  </p>\n\n<p>Essentially when you say fruit is a <em>constant</em> it refers to <code>fruit</code> being a pointer to a <code>const</code> memory. If you would have defined it as a <code>const pointer to a const string</code> :-<br>\n<code>char* const fruit = \"banana\";</code><br>\n The compiler would have stopped you from resetting it to \"apple\"</p>\n"}, {"tags": [], "owner": {"reputation": 4900, "user_id": 1085937, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b66b1894c805a260947000d16658f845?s=128&d=identicon&r=PG", "display_name": "Jeeter", "link": "https://stackoverflow.com/users/1085937/jeeter"}, "is_accepted": false, "score": 3, "last_activity_date": 1496265042, "creation_date": 1496265042, "answer_id": 44294731, "question_id": 44294649, "link": "https://stackoverflow.com/questions/44294649/if-chars-are-read-only-why-can-i-overwrite-them/44294731#44294731", "title": "If char*s are read only, why can I overwrite them?", "body": "<p>Basically, when you perform</p>\n\n<pre><code>char* fruit = \"banana\";\n</code></pre>\n\n<p>You set up a pointer <code>fruit</code> to the first letter of \"banana\". When printing it out, C basically starts at the 'b' and keeps printing letters until it hits a <code>\\0</code> null character at the end.</p>\n\n<p>By then saying</p>\n\n<pre><code>fruit = \"apple\";\n</code></pre>\n\n<p>You've changed the pointer <code>fruit</code> to now point to the first letter of \"apple\"</p>\n"}, {"tags": [], "owner": {"reputation": 95405, "user_id": 12725, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/98df3c7cc17f088af555c5accbdb2509?s=128&d=identicon&r=PG", "display_name": "James Curran", "link": "https://stackoverflow.com/users/12725/james-curran"}, "is_accepted": false, "score": 3, "last_activity_date": 1496265090, "creation_date": 1496265090, "answer_id": 44294742, "question_id": 44294649, "link": "https://stackoverflow.com/questions/44294649/if-chars-are-read-only-why-can-i-overwrite-them/44294742#44294742", "title": "If char*s are read only, why can I overwrite them?", "body": "<p>First of all, <code>char*</code> aren't read-only.  <code>char * const</code>s are. And they are different from <code>char const *</code>.  And literal strings (e.g., \"banana\") should be, but aren't necessarily.</p>\n\n<pre><code>char * const  cpfruit = \"banana\";\ncpfruit = \"apple\";        // error\n\nchar const * cpfruit = \"banana\";\ncpfruit[0] = 'x';        // error\n\nchar * ncfruit = \"banana\";\nncfruit[0] = 'x';        // compile will allow, but may cause run-time error.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1496266190, "post_id": 44294922, "comment_id": 75596225, "body": "A nit, but the compiler will see the <i>string literals</i> <code>&quot;banana&quot;</code> and <code>&quot;apple&quot;</code> and provide storage for them in the <code>.rodata</code> (read-only data) section. (I think you are saying the same thing)"}, {"owner": {"reputation": 1778, "user_id": 1110642, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9330d13cc8dcc109f541b4eed800e8e?s=128&d=identicon&r=PG", "display_name": "arminb", "link": "https://stackoverflow.com/users/1110642/arminb"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496266251, "post_id": 44294922, "comment_id": 75596259, "body": "Yes, just wanted to keep it simple here."}], "tags": [], "owner": {"reputation": 1778, "user_id": 1110642, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9330d13cc8dcc109f541b4eed800e8e?s=128&d=identicon&r=PG", "display_name": "arminb", "link": "https://stackoverflow.com/users/1110642/arminb"}, "is_accepted": false, "score": 2, "last_activity_date": 1496265908, "creation_date": 1496265908, "answer_id": 44294922, "question_id": 44294649, "link": "https://stackoverflow.com/questions/44294649/if-chars-are-read-only-why-can-i-overwrite-them/44294922#44294922", "title": "If char*s are read only, why can I overwrite them?", "body": "<p>You are pointing your variable <code>fruit</code> to a different string. You are only overwriting the address (location). The compiler will see your constant string \"banana\" and \"apple\" and store them separately in program memory. Let's say the string \"banana\" goes to memory cell located at address <code>1</code> and \"apple\" gets stored to memory addesss <code>2</code>. Now when you do:</p>\n\n<pre><code>fruit = \"banana\";\n</code></pre>\n\n<p>the compiler will just assign <code>1</code> to variable <code>fruit</code>, which means it points to address <code>1</code> which containts the string <code>banana</code>. When you do:</p>\n\n<pre><code>fruit = \"apple\";\n</code></pre>\n\n<p>the compiler will assign <code>2</code> variable <code>fruit</code>, which means it points to addess <code>2</code> where the string <code>apple</code> is stored.</p>\n"}, {"tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": false, "score": 10, "last_activity_date": 1496266504, "last_edit_date": 1496266504, "creation_date": 1496266064, "answer_id": 44294953, "question_id": 44294649, "link": "https://stackoverflow.com/questions/44294649/if-chars-are-read-only-why-can-i-overwrite-them/44294953#44294953", "title": "If char*s are read only, why can I overwrite them?", "body": "<p>In your program, the expression <code>\"banana\"</code> denotes a string literal object in the program image, a character array. The value of the expression is of type <code>char *</code>, or \"pointer to character\". The pointer points to the first byte of that array, the character <code>'b'</code>.</p>\n\n<p>Your <code>char *fruit</code> variable also has type \"pointer to character\" and takes its initial value from this expression: it is initialized to a copy of the pointer to the data, not the data itself; it merely points to the <code>b</code>.</p>\n\n<p>When you assign <code>\"apple\"</code> to <code>fruit</code>, you're just replacing its pointer value with another one, so it now points to a different literal array.</p>\n\n<p>To modify the data itself, you need an expression such as:</p>\n\n<pre><code>char *fruit = \"banana\";\nfruit[0] = 'z';  /* try to turn \"banana\" into \"zanana\" */\n</code></pre>\n\n<p>According to the ISO C standard, the behavior of this is not defined. It <strong>could</strong> be that the <code>\"banana\"</code> array is read-only, but that is not required.</p>\n\n<p>C implementations can make string literals writable, or make it an option.</p>\n\n<p>(If you are able to modify a string literal, that doesn't mean that all is well.  Firstly, your program is still not well defined according to ISO C: it is not portable. Secondly, the C compiler is allowed to merge literals which have common content into the same storage. This means that two occurrences of <code>\"banana\"</code> in the program could in fact be exactly the same array. Furthermore, the string literal <code>\"nana\"</code> occurring somewhere in the program could be the suffix of the array <code>\"banana\"</code> occurring elsewhere; in other words, share the same storage. Modifying a literal can have surprising effects; the modification can appear in other literals.)</p>\n\n<p>Also \"static\" and \"read-only\" aren't synonymous. Most static storage in C is in fact modifiable. We can create a modifiable static character array which holds a string like this:</p>\n\n<pre><code>/* at file scope, i.e. outside of any function */\nchar fruit[] = \"banana\";\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>{\n  /* in a function */\n  static fruit[] = \"banana\";\n</code></pre>\n\n<p>If we leave out the array size, it is automatically sized from the initializing string literal, and includes space for the null terminating byte. In the function, we need <code>static</code> to put the array into static storage, otherwise we get a local variable.</p>\n\n<p>These arrays can be modified; <code>fruit[0] = 'z'</code> is well-defined behavior.</p>\n\n<p>Also, in these situations, <code>\"banana\"</code> doesn't denote a character array. The array is the variable <code>fruit</code>; the <code>\"banana\"</code> expression is just a piece of syntax which indicates the array's initial value:</p>\n\n<pre><code>char *fruit = \"banana\";  // \"banana\" is an object in program image\n                         // initial value is a pointer to that object\n\nchar fruit_array[] = \"apple\"; // \"apple\" is syntax giving initial value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 5, "last_activity_date": 1496266672, "creation_date": 1496266672, "answer_id": 44295074, "question_id": 44294649, "link": "https://stackoverflow.com/questions/44294649/if-chars-are-read-only-why-can-i-overwrite-them/44295074#44295074", "title": "If char*s are read only, why can I overwrite them?", "body": "<p>The <code>fruit</code> object is writable - it can be set to point to a different string literal.</p>\n\n<p>The <em>string literals</em> <code>\"banana\"</code> and <code>\"apple\"</code> are not writable.  You can modify <code>fruit</code> to point to a string literal, but if you do so then you should not attempt to modify the thing that <code>fruit</code> <em>points to</em>:</p>\n\n<pre><code>char *fruit = \"banana\"; // fruit points to first character of string literal\nfruit = \"apple\";        // okay, fruit points to first character of different string literal\n*fruit = 'A';           // not okay, attempting to modify contents of string literal\nfruit[1] = 'P';         // not okay, attempting to modify contents of string literal\n</code></pre>\n\n<p>Attempting to modify the contents of a string literal results in undefined behavior - your code may work as expected, or you may get a runtime error, or something completely unexpected may happen.  For safety's sake, if you're defining a variable to point to a string literal, you should declare it <code>const</code>:</p>\n\n<pre><code>const char *fruit = \"banana\";  // can also be written char const *\n</code></pre>\n\n<p>You can still assign <code>fruit</code> to point to different strings:</p>\n\n<pre><code>fruit = \"apple\";\n</code></pre>\n\n<p>but if you try to modify what <code>fruit</code> points to, the compiler will yell at you.  </p>\n\n<p>If you want to define a pointer that can only point to one specific string literal, then you can <code>const</code>-qualify the pointer as well:</p>\n\n<pre><code>const char * const fruit = \"banana\"; // can also be written char const * const\n</code></pre>\n\n<p>This way, if you try to either write to what <code>fruit</code> points to, or try to set <code>fruit</code> to point to a different object, the compiler will yell at you.  </p>\n"}, {"comments": [{"owner": {"reputation": 2143, "user_id": 601203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YECjP.png?s=128&g=1", "display_name": "hagello", "link": "https://stackoverflow.com/users/601203/hagello"}, "edited": false, "score": 0, "creation_date": 1566074273, "post_id": 57538758, "comment_id": 101543706, "body": "I think printing the address is a good idea to convince OP. I&#39;d upvote your answer if it showed how it is done."}, {"owner": {"reputation": 2143, "user_id": 601203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YECjP.png?s=128&g=1", "display_name": "hagello", "link": "https://stackoverflow.com/users/601203/hagello"}, "edited": false, "score": 0, "creation_date": 1566074370, "post_id": 57538758, "comment_id": 101543725, "body": "By the way, I do not know any standard that demands that string literals are put into read only memory. On some platforms this cannot even be enforced -- as there is not any MMU."}, {"owner": {"reputation": 21, "user_id": 9763949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sachin Mathad", "link": "https://stackoverflow.com/users/9763949/sachin-mathad"}, "reply_to_user": {"reputation": 2143, "user_id": 601203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YECjP.png?s=128&g=1", "display_name": "hagello", "link": "https://stackoverflow.com/users/601203/hagello"}, "edited": false, "score": 0, "creation_date": 1566184711, "post_id": 57538758, "comment_id": 101562801, "body": "@hagello thanks for the edit. I have added the code showing the different address location but the formatting completely off. Will have to work on that. But hope it convinces the OP."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1566186876, "post_id": 57538758, "comment_id": 101563098, "body": "Your code doesn&#39;t demonstrate that string literals are stored in read-only memory. They almost certainly aren&#39;t stored literally in ROM (memory whose contents physically cannot be modified). They&#39;re likely to be stored in memory that&#39;s configured by the OS to be read-only."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1566188883, "post_id": 57538758, "comment_id": 101563403, "body": "You&#39;re printing the value of <code>p</code>, not the address of <code>p</code>.  The address of <code>p</code> would be <code>&amp;p</code>."}, {"owner": {"reputation": 21, "user_id": 9763949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sachin Mathad", "link": "https://stackoverflow.com/users/9763949/sachin-mathad"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1566189237, "post_id": 57538758, "comment_id": 101563463, "body": "@M.M I am printing the address location pointer p is pointing to. I wanted to prove that the data is not overwritten, the address location it is pointing to changes."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1566189280, "post_id": 57538758, "comment_id": 101563473, "body": "@SachinMathad &quot;address location pointer p is pointing to&quot; is different from &quot;address of p&quot; which you said in your answer."}], "tags": [], "owner": {"reputation": 21, "user_id": 9763949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sachin Mathad", "link": "https://stackoverflow.com/users/9763949/sachin-mathad"}, "is_accepted": false, "score": 2, "last_activity_date": 1566205568, "last_edit_date": 1566205568, "creation_date": 1566065270, "answer_id": 57538758, "question_id": 44294649, "link": "https://stackoverflow.com/questions/44294649/if-chars-are-read-only-why-can-i-overwrite-them/57538758#57538758", "title": "If char*s are read only, why can I overwrite them?", "body": "<p>When you use <code>char *p=\"banana\";</code> the string banana is stored in a read only memory location. Following which when you enter <code>p=\"apple\";</code> the string apple is stored in some other memory location and the pointer is now pointing to the new memory location.</p>\n\n<p>You can confirm this by printing <code>p</code> just after each assignment.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(void)\n{\n    char *p = \"Banana\";\n    printf(\"p contains address of string constant 'Banana' at 0x%p\\n\", p);\n\n    p=\"Apple\";\n    printf(\"p contains address of string constant 'Apple' at 0x%p\\n\", p);\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7672, "user_id": 4999991, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/y69di.png?s=128&g=1", "display_name": "Foad", "link": "https://stackoverflow.com/users/4999991/foad"}, "is_accepted": false, "score": 2, "last_activity_date": 1581063769, "last_edit_date": 1581063769, "creation_date": 1581032057, "answer_id": 60105119, "question_id": 44294649, "link": "https://stackoverflow.com/questions/44294649/if-chars-are-read-only-why-can-i-overwrite-them/60105119#60105119", "title": "If char*s are read only, why can I overwrite them?", "body": "<p>when defining a C string, aka <code>char</code> array, by double quotations <code>\"...\"</code>, in the format below:</p>\n\n<pre><code>char * &lt;varName&gt; = \"&lt;someString&gt;\"\n</code></pre>\n\n<p>only the elements of the array are immutable (their content can not be changed). In other words, the <code>&lt;varName&gt;</code> has a <code>const char *</code> type (a mutable pointer towards a read-only memory). And every time you invoke the assignment operator with double quotations <code>&lt;varName&gt; = \"&lt;otherString&gt;\"</code> it changes the pointer value automatically. The below example should give a complete overview of the different possibilities:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    char * var_1 = \"Lorem\";\n    printf(\"1. %s , %p\\n\", var_1, var_1); // --&gt; 1. Lorem , 0x400640\n\n    var_1 = \"ipsu\";\n    printf(\"2. %s , %p\\n\", var_1, var_1); // --&gt; 2. ipsu , 0x400652\n\n    // var_1[0] = 'x'; // --&gt; Segmentation fault\n\n    var_1++;\n    printf(\"3. %s , %p\\n\", var_1, var_1); // --&gt; 3. psu , 0x400653\n\n    char var_2[] = {'L', 'o', 'r', 'e', 'm', '\\0'};\n    printf(\"4. %s , %p\\n\", var_2, var_2); // --&gt; 4. Lorem , 0x7ffed0fc5381\n\n    var_2[0] = 'x';\n    printf(\"5. %s , %p\\n\", var_2, var_2); // --&gt; 5. xorem , 0x7ffed0fc5381\n\n    // var_2++; //error: lvalue required as increment operand\n\n    char var_3[] = \"Lorem\";\n    printf(\"6. %s , %p\\n\", var_3, var_3); // --&gt; 6. Lorem , 0x7ffe36a42d5c\n\n    // var_3 = \"ipsu\"; // --&gt; error: assignment to expression with array type\n\n    var_3[0] = 'x';\n    printf(\"7. %s , %p\\n\", var_3, var_3); // --&gt; 7. xorem , 0x7ffe36a42d5c\n\n    char * const var_4 = \"Lorem\";\n\n    // var_4 = \"ipsu\"; // --&gt; error: assignment of read-only variable\n\n    // var_4[0] = 'x'; // --&gt; Segmentation fault\n\n    char const * var_5 = \"Lorem\";\n    printf(\"8. %s , %p\\n\", var_5, var_5); // --&gt; Lorem , 0x400720\n\n    var_5 = \"ipsu\";\n    printf(\"9. %s , %p\\n\", var_5, var_5); // --&gt; ipsu , 0x400732\n\n    // var_5[0] = 'x'; // --&gt; error: assignment of read-only location\n\n    const char * var_6 = \"Lorem\";\n    printf(\"10. %s , %p\\n\", var_6, var_6); // --&gt; 10. Lorem , 0x400760\n\n    var_6 = \"ipsu\";\n    printf(\"11. %s , %p\\n\", var_6, var_6); // --&gt; 11. ipsu , 0x400772\n\n    // var_6[0] = 'x'; // --&gt; error: assignment of read-only location\n\n    const char const * var_7 = \"Lorem\"; // clang only --&gt; warning: duplicate 'const' declaration specifier [-Wduplicate-decl-specifier]\n    printf(\"12. %s , %p\\n\", var_7, var_7); // --&gt; 12. Lorem , 0x400760\n\n    var_7 = \"ipsu\";\n    printf(\"13. %s , %p\\n\", var_7, var_7); // --&gt; 13. ipsu , 0x400772\n\n    // var_7[0] = 'x'; // --&gt; error: assignment of read-only location\n\n    char const const * var_8 = \"Lorem\"; // clang only --&gt; warning: duplicate 'const' declaration specifier [-Wduplicate-decl-specifier]\n    printf(\"14. %s , %p\\n\", var_8, var_8); // --&gt; 14. Lorem , 0x400790\n\n    var_8 = \"ipsu\";\n    printf(\"15. %s , %p\\n\", var_8, var_8); // --&gt; 15. ipsu , 0x4007a2\n\n    // var_8[0] = 'x'; // --&gt; error: assignment of read-only location\n\n    char const * const var_9 = \"Lorem\";\n\n    // var_9 = \"ipsu\"; // --&gt; error: assignment of read-only variable\n\n    // var_9[0] = 'x'; // --&gt; error: assignment of read-only location\n\n    const char var_10[] = {'L', 'o', 'r', 'e', 'm', '\\0'};\n\n    // var_10[0] = 'x'; // --&gt; error: assignment of read-only location\n\n    // var_10++; // --&gt; error: lvalue required as increment operand\n\n    char const var_11[] = {'L', 'o', 'r', 'e', 'm', '\\0'};\n\n    // var_11[0] = 'x'; // --&gt; error: assignment of read-only location \n\n    // var_11++; // --&gt; error: lvalue required as increment operand\n\n    const char var_12[] = \"Lorem\";\n\n    // var_12[0] = 'x'; // --&gt; error: assignment of read-only location\n\n    // var_12++; // --&gt; error: lvalue required as increment operand\n\n    char const var_13[] = \"Lorem\";\n\n    // var_13[0] = 'x'; // --&gt; error: assignment of read-only location\n\n    // var_13++; // --&gt; error: lvalue required as increment operand\n\n\n    return 0;\n}\n</code></pre>\n\n<p>this code was tested on GCC, Clang and Visual Studio.</p>\n\n<p>Basically, there are three possibilities:</p>\n\n<ul>\n<li><p>immutable pointer, mutable content</p>\n\n<ul>\n<li><code>char &lt;varName&gt;[] = {'L', 'o', 'r', 'e', 'm', '\\0'};</code></li>\n<li><code>char &lt;varName&gt;[] = \"Lorem\";</code></li>\n</ul></li>\n<li><p>mutable pointer, immutable content</p>\n\n<ul>\n<li><code>char * &lt;varName&gt; = \"Lorem\";</code></li>\n<li><code>char const * &lt;varName&gt; = \"Lorem\";</code></li>\n<li><code>const char * &lt;varName&gt; = \"Lorem\";</code></li>\n<li><code>const char const * &lt;varName&gt; = \"Lorem\";</code></li>\n<li><code>char const const * &lt;varName&gt; = \"Lorem\";</code></li>\n</ul></li>\n<li><p>immutable pointer, immutable content</p>\n\n<ul>\n<li><code>char * const &lt;varName&gt; = \"Lorem\";</code></li>\n<li><code>char const * const &lt;varName&gt; = \"Lorem\";</code></li>\n<li><code>const char * const &lt;varName&gt; = \"Lorem\";</code></li>\n<li><code>const char &lt;varName&gt;[] = {'L', 'o', 'r', 'e', 'm', '\\0'};</code></li>\n<li><code>char const &lt;varName&gt;[] = {'L', 'o', 'r', 'e', 'm', '\\0'};</code></li>\n<li><code>const char &lt;varName&gt;[] = \"Lorem\";</code></li>\n<li><code>char const &lt;varName&gt;[] = \"Lorem\";</code></li>\n</ul></li>\n</ul>\n\n<h2>Conclusion:</h2>\n\n<ul>\n<li><code>&lt;typing&gt; &lt;varName&gt;[] = &lt;string&gt;</code> always returns an immutable pointer and the mutability of the content is independant from the <code>&lt;array&gt;</code> format (<code>\"Lorem\"</code> or <code>{'L', 'o', 'r', 'e', 'm', '\\0'}</code>)</li>\n<li><code>&lt;typing&gt; * &lt;varName&gt; = \"someString\"</code> always returns immutable content</li>\n<li><code>&lt;typing&gt; * const &lt;varName&gt; = \"someString\"</code> always returns both immutable content and pointer</li>\n<li><code>char const &lt;other&gt;</code>, <code>char const &lt;other&gt;</code>, <code>const char const &lt;other&gt;</code>, and <code>char const const &lt;other&gt;</code> always create immutable content.</li>\n</ul>\n\n<p>I have tried to summerise C's array behavior <a href=\"https://www.reddit.com/r/learnprogramming/comments/ezm02g/understanding_c_arrays_correct_syntax/?utm_source=share&amp;utm_medium=web2x\" rel=\"nofollow noreferrer\">here</a> in detail. </p>\n"}], "owner": {"reputation": 466, "user_id": 7786319, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1347f9c17226d9b3fc86dce269731c5?s=128&d=identicon&r=PG&f=1", "display_name": "sally2000", "link": "https://stackoverflow.com/users/7786319/sally2000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4905, "favorite_count": 7, "accepted_answer_id": 44294690, "answer_count": 9, "score": 20, "last_activity_date": 1615712457, "creation_date": 1496264646, "last_edit_date": 1615712457, "question_id": 44294649, "link": "https://stackoverflow.com/questions/44294649/if-chars-are-read-only-why-can-i-overwrite-them", "title": "If char*s are read only, why can I overwrite them?", "body": "<p>My course taught me that char*s are static/read only so I thought that would mean you can't edit them after you have defined them. But when I run:</p>\n\n<pre><code>char* fruit = \"banana\";\nprintf(\"fruit is %s\\n\", fruit);\nfruit = \"apple\";\nprintf(\"fruit is %s\\n\", fruit);\n</code></pre>\n\n<p>Then it compiles fine and gives me:</p>\n\n<pre><code>fruit is banana\nfruit is apple\n</code></pre>\n\n<p>Why? Have I misunderstood what it means to be read-only? Sorry if this is obvious but I'm new to coding and I can't find the answer online.</p>\n"}, {"tags": ["java", "c", "jna", "rhel5"], "comments": [{"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1496263473, "post_id": 44294316, "comment_id": 75595097, "body": "<code>(GNU libgcj)</code> is not Oracle or Sun Java. It&#39;s part of gcc."}, {"owner": {"reputation": 1902, "user_id": 1046421, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0852f4a8b45b9bb902510d11895483c8?s=128&d=identicon&r=PG", "display_name": "Urhixidur", "link": "https://stackoverflow.com/users/1046421/urhixidur"}, "reply_to_user": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1496263823, "post_id": 44294316, "comment_id": 75595236, "body": "@Elliott Frisch That may be, but it&#39;s what RHEL 5.3 comes with. I have to live with it. Are you saying it doesn&#39;t conform to the Java 1.4 standard, a bit like the old Microsoft JVM used to?"}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1496264255, "post_id": 44294316, "comment_id": 75595434, "body": "Good luck. Even Java 1.7 is EOL, so I&#39;d argue an upgrade is passed due."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1496265006, "post_id": 44294316, "comment_id": 75595755, "body": "The exception is telling you that the class <code>com.sun.jna.Library</code> that Java is attempting to load from your JNA jar is written to a more recent classfile spec than any your Java implementation knows about.  It was almost certainly compiled with a newer version of the Java compiler than v1.4.  Your Java will never load it.  Your alternatives are to get or build JNA for your version of Java (unsure whether this is possible) or to get a newer Java (this certainly <i>is</i>, or at least <i>was</i>, possible; try OpenJDK)."}, {"owner": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1496299354, "post_id": 44294316, "comment_id": 75605727, "body": "@JohnBollinger Honestly, in my opinion, that&#39;s an acceptable answer right there"}], "answers": [{"comments": [{"owner": {"reputation": 1902, "user_id": 1046421, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0852f4a8b45b9bb902510d11895483c8?s=128&d=identicon&r=PG", "display_name": "Urhixidur", "link": "https://stackoverflow.com/users/1046421/urhixidur"}, "edited": false, "score": 0, "creation_date": 1496321481, "post_id": 44307482, "comment_id": 75621308, "body": "I suspected as much. Why is JNA hiding it&#39;s compatibility level so well? This is the kind of thing that ought to be covered first in the README. Sheesh."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1902, "user_id": 1046421, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0852f4a8b45b9bb902510d11895483c8?s=128&d=identicon&r=PG", "display_name": "Urhixidur", "link": "https://stackoverflow.com/users/1046421/urhixidur"}, "edited": false, "score": 0, "creation_date": 1496322525, "post_id": 44307482, "comment_id": 75622103, "body": "@Urhixidur, I&#39;d rate compatibility with Java 6 as <i>highly</i> compatible here in 2017.  Oracle has not provided even <i>paid</i> support for Java 1.4 since 2013.  For its part, Java 6 reached official end-of-life in 2013, though paid support may still be available for the time being.  The gij / gcj dimension is altogether different; Oracle&#39;s apparent position that it is an unsupported variant that they therefore don&#39;t need to think about seems altogether reasonable to me."}, {"owner": {"reputation": 1902, "user_id": 1046421, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0852f4a8b45b9bb902510d11895483c8?s=128&d=identicon&r=PG", "display_name": "Urhixidur", "link": "https://stackoverflow.com/users/1046421/urhixidur"}, "edited": false, "score": 0, "creation_date": 1496326219, "post_id": 44307482, "comment_id": 75625037, "body": "Yup, replacing JNA 4.4.0 with 3.5.2 did the trick. I can move on!"}], "tags": [], "owner": {"reputation": 7673, "user_id": 2311528, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/dLeM9.png?s=128&g=1", "display_name": "Lonzak", "link": "https://stackoverflow.com/users/2311528/lonzak"}, "is_accepted": true, "score": 3, "last_activity_date": 1496386894, "last_edit_date": 1592644375, "creation_date": 1496319879, "answer_id": 44307482, "question_id": 44294316, "link": "https://stackoverflow.com/questions/44294316/getting-jna-to-work-under-java-1-4/44307482#44307482", "title": "Getting JNA to work under Java 1.4", "body": "<p>1.)\nI checked the official JNA library classes with the following result:</p>\n<ul>\n<li>JNA 4.0.0 -&gt; compiled with 1.6</li>\n<li>JNA 3.5.0 -&gt; compiled with 1.4</li>\n<li>JNA 3.5.2 -&gt; compiled with 1.4</li>\n</ul>\n<p>And when looking exactly for that you'll find it, too:\n<a href=\"https://github.com/java-native-access/jna/blob/master/CHANGES.md\" rel=\"nofollow noreferrer\">Switch to 1.6</a> (In the release notes for version 4.0). Additionally there is an issue <a href=\"https://github.com/java-native-access/jna/issues/109\" rel=\"nofollow noreferrer\">#109</a>. So your last working version would be <a href=\"http://repo1.maven.org/maven2/net/java/dev/jna/jna/3.5.2/\" rel=\"nofollow noreferrer\">3.5.2</a>.</p>\n<p>2.) Regarding the exotic java version you may read <a href=\"https://stackoverflow.com/questions/1107870/is-gij-gnu-interpreter-for-java-stable-enough-for-commercial-use\">here</a>. Some quotes to give you some ideas:</p>\n<blockquote>\n<p>&quot;gij hasn't passed the Sun compatability test, and should be\nconsidered a separate platform for building, testing etc.&quot;</p>\n<p>&quot;GCJ is not equivalent to Sun's JDK or JRE, so you may find that\ncertain things you need aren't included in the API.</p>\n<p>&quot;gij is very ancient, and while I don't have references I doubt it's\nreliable enough to support commercial applications.&quot;</p>\n</blockquote>\n<p>Getting to run JNA correctly is sometimes tricky enough in a sun/oracle/open jdk - so this won't be a trivial task...</p>\n"}], "owner": {"reputation": 1902, "user_id": 1046421, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0852f4a8b45b9bb902510d11895483c8?s=128&d=identicon&r=PG", "display_name": "Urhixidur", "link": "https://stackoverflow.com/users/1046421/urhixidur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 44307482, "answer_count": 1, "score": 1, "last_activity_date": 1496386894, "creation_date": 1496263368, "question_id": 44294316, "link": "https://stackoverflow.com/questions/44294316/getting-jna-to-work-under-java-1-4", "title": "Getting JNA to work under Java 1.4", "body": "<p>For reasons not germane to this question, I'm stuck with an old RHEL/CentOS 5 system with Java 1.4 (<code>java version \"1.4.2\" gij (GNU libgcj) version 4.1.2 20080704 (Red Hat 4.1.2-44)</code>). According to the JNA documentation, it's supposed to work. However the example provided is off to a rocky start since it uses a feature of Java 1.5, namely <code>varargs</code> (<code>void printf(String format, Object... args)</code>). So I figured I'd try with a simpler C library call, <code>strerror</code>.</p>\n\n<pre><code>package ca...cl_client;\n\nimport com.sun.jna.Library;\nimport com.sun.jna.Native;\nimport com.sun.jna.Platform;\nimport com.sun.jna.Pointer;\n\npublic class MainJNA {\n    public interface CLibrary extends Library {\n        CLibrary INSTANCE = (CLibrary)\n            Native.loadLibrary((Platform.isWindows() ? \"msvcrt\" : \"c\"),\n                CLibrary.class);\n        Pointer strerror(int errno);\n    }\n\n    public static void main(String[] args) {\n        System.out.println(\"Hello, World\");\n\n        System.out.println(\"err 22 : \" + CLibrary.INSTANCE.strerror(22).getString(0)); //EINVAL\n    }\n}\n</code></pre>\n\n<p>So I deploy <code>jna-master.zip</code> locally and hook it up:</p>\n\n<pre><code>$ sudo -- ln -s /home/user/Downloads/Java/jna-master/dist/jna.jar /usr/lib/jvm/java-1.4.2-gcj-1.4.2.0/jre/lib/jna.jar\n$ export CLASS_PATH=.:/home/user/Downloads/Java/jna-master/dist/jna.jar\n</code></pre>\n\n<p>This compiles fine:</p>\n\n<pre><code>$ cd ~/Java\n$ javac ./ca/gc/drdc_rddc/linux/utilinux/cl_client/MainJNA.java\n</code></pre>\n\n<p>But it won't run:</p>\n\n<pre><code>$ java -cp $CLASS_PATH ca...cl_client.MainJNA\nHello, World\nException in thread \"main\" java.lang.ClassFormatError: com.sun.jna.Library (unrecognized class file version)\n   at java.lang.VMClassLoader.defineClass(libgcj.so.7rh)\n   at java.lang.ClassLoader.defineClass(libgcj.so.7rh)\n   at java.security.SecureClassLoader.defineClass(libgcj.so.7rh)\n   at java.net.URLClassLoader.findClass(libgcj.so.7rh)\n   at java.lang.ClassLoader.loadClass(libgcj.so.7rh)\n   at java.lang.ClassLoader.loadClass(libgcj.so.7rh)\n   at java.lang.VMClassLoader.defineClass(libgcj.so.7rh)\n   at java.lang.ClassLoader.defineClass(libgcj.so.7rh)\n   at java.security.SecureClassLoader.defineClass(libgcj.so.7rh)\n   at java.net.URLClassLoader.findClass(libgcj.so.7rh)\n   at java.lang.ClassLoader.loadClass(libgcj.so.7rh)\n   at java.lang.ClassLoader.loadClass(libgcj.so.7rh)\n   at ca...cl_client.MainJNA.main(MainJNA.java:19)\n</code></pre>\n\n<p>Compiling with <code>javac -cp $CLASS_PATH ...</code> makes no difference.</p>\n\n<p>I've tried this on both a 32-bit system and a 64-bit system (each RHEL 5.3), the error is the same.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "linux", "gcc", "glibc", "libc"], "comments": [{"owner": {"reputation": 298, "user_id": 7994314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lAry5T1ytg4/AAAAAAAAAAI/AAAAAAAAAAA/9bdsJACx_qA/photo.jpg?sz=128", "display_name": "Deathgrip", "link": "https://stackoverflow.com/users/7994314/deathgrip"}, "edited": false, "score": 2, "creation_date": 1496264138, "post_id": 44294173, "comment_id": 75595387, "body": "What are your <code>#include</code> directives in the source module that calls the <code>stat</code>, <code>fstat</code>, or <code>lstat</code> functions? Does it have the ones indicated in <code>man 2 stat</code>?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1496311813, "post_id": 44294173, "comment_id": 75614416, "body": "Did you do a completely clean build that recompiled every binary?"}, {"owner": {"reputation": 61, "user_id": 7851796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/161049412d9345892587d4c9e43d359e?s=128&d=identicon&r=PG&f=1", "display_name": "Jetson", "link": "https://stackoverflow.com/users/7851796/jetson"}, "edited": false, "score": 0, "creation_date": 1496317983, "post_id": 44294173, "comment_id": 75618630, "body": "My includes do include the ones in man 2 stat. And I did do a clean before recompiling every source file."}], "answers": [{"tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 7, "last_activity_date": 1496385893, "last_edit_date": 1496385893, "creation_date": 1496373938, "answer_id": 44320282, "question_id": 44294173, "link": "https://stackoverflow.com/questions/44294173/moving-to-different-linux-build-system-getting-error-undefined-symbol-stat/44320282#44320282", "title": "Moving to different Linux build system, getting error: undefined symbol: stat", "body": "<p>The problem you are facing is most likely the result of building your shared library with <code>ld</code>. User-level code on UNIX systems should <em>never</em> use <code>ld</code> directly. You should use the compiler driver (<code>g++</code> in your case) to perform the link instead.</p>\n\n<p>Example:</p>\n\n<pre><code>// t.c\n#include &lt;sys/stat.h&gt;\n\nvoid fn(const char *p)\n{\n  struct stat st;\n  stat(p, &amp;st);\n}\n\ngcc -fPIC -c t.c\nld -shared -o t.so t.o\nnm t.so | grep stat\n             U stat       ## problem: this library is not linked correctly\n</code></pre>\n\n<p>Compare to correctly linked library:</p>\n\n<pre><code>gcc -shared -o t.so t.o\nnm t.so | grep stat\n\n0000000000000700 t stat\n0000000000000700 t __stat\n                 U __xstat@@GLIBC_2.2.5\n</code></pre>\n\n<p>To find where the above local <code>stat</code> symbol came from, you could do this:</p>\n\n<pre><code>gcc  -shared -o t.so t.o -Wl,-y,stat\nt.o: reference to stat\n/usr/lib/x86_64-linux-gnu/libc_nonshared.a(stat.oS): definition of stat\n</code></pre>\n\n<p>Finally, the reason <code>U stat</code> disappears with optimization:</p>\n\n<pre><code>gcc -E t.c | grep -A2 ' stat '\n\nextern int stat (const char *__restrict __file,\n  struct stat *__restrict __buf) __attribute__ ((__nothrow__ , __leaf__)) __attribute__ ((__nonnull__ (1, 2)));\n\ngcc -E t.c -O | grep -A2 ' stat '\n\n__attribute__ ((__nothrow__ , __leaf__)) stat (const char *__path, struct stat *__statbuf)\n{\n   return __xstat (1, __path, __statbuf);\n</code></pre>\n\n<p>That's right: you get different preprocessed source depending on the optimization level.</p>\n"}], "owner": {"reputation": 61, "user_id": 7851796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/161049412d9345892587d4c9e43d359e?s=128&d=identicon&r=PG&f=1", "display_name": "Jetson", "link": "https://stackoverflow.com/users/7851796/jetson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2384, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1501167319, "creation_date": 1496262732, "last_edit_date": 1496374426, "question_id": 44294173, "link": "https://stackoverflow.com/questions/44294173/moving-to-different-linux-build-system-getting-error-undefined-symbol-stat", "title": "Moving to different Linux build system, getting error: undefined symbol: stat", "body": "<p>This may just be an issue with the build system I am migrating to, but I'll include differences in the two systems and how I encountered the problem.</p>\n\n<p>My old build system is a SLES 10 machine. The gcc/cpp/g++ version is 4.1.0</p>\n\n<p>My new system is on SLES 11 SP4, and the gcc/cpp/g++ version is 4.3.4.</p>\n\n<p>I am building a shared library; building and linking work fine on the new system. However, at <strong>load</strong> time on the new system, I get the following:</p>\n\n<pre><code>error ./mysharedlib.so: undefined symbol: stat\n</code></pre>\n\n<p>Since the stat() function is included from /usr/include/sys/stat.h, I looked at glibc on both systems. Old:</p>\n\n<pre><code># rpm -q -f /usr/include/sys/stat.h\nglibc-devel-2.4-31.2\n</code></pre>\n\n<p>and new:</p>\n\n<pre><code># rpm -q -f /usr/include/sys/stat.h\nglibc-devel-2.11.3-17.95.2\n</code></pre>\n\n<p>I also looked at objdump output related to stat() on the old system:</p>\n\n<pre><code># objdump -T mysharedlib.so | grep stat\n0000000000000000      D  *UND*  0000000000000000              __xstat\n\n# objdump -x mysharedlib.so | grep stat\n00000000000e3f8a l     F .text  0000000000000024              stat\n0000000000000000         *UND*  0000000000000000              __xstat\n</code></pre>\n\n<p>And the new system:</p>\n\n<pre><code># objdump -T mysharedlib.so | grep stat\n0000000000000000      D  *UND*  0000000000000000              stat\n0000000000000000      D  *UND*  0000000000000000              lstat\n# objdump -x mysharedlib.so | grep stat\n0000000000000000         *UND*  0000000000000000              stat\n0000000000000000         *UND*  0000000000000000              lstat\n</code></pre>\n\n<p>This tells me that on the old system, stat() was defined as a local function in the .text section of my actual shared object. Stat is undefined in mysharedlib on the new system.</p>\n\n<p>I did find some information on feature_test_macros and thought that might resolve the issue, so I included features.h before stat.h and updated my makefile to define _XOPEN_SOURCE:</p>\n\n<pre><code>cc -D_XOPEN_SOURCE=500  \n</code></pre>\n\n<p>This didn't resolve the problem.</p>\n\n<p>I also tried adding \"-lc\" to my ld flags to link in libc. This seemed like it should work, since that's where stat() is defined(I think), but it did not.</p>\n\n<p>At this point, I found this StackOverflow question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/16595201/why-does-o-to-gcc-cause-stat-to-resolve\">Why does -O to gcc cause &quot;stat&quot; to resolve?</a></p>\n\n<p>So I tried adding -O to my makefile when invoking g++ on the file that calls stat(). This seems to resolve the problem. I probably don't know enough about resolving symbols; however, this seems a bit hack-ish to me. Am I way off base there? If not, what's the correct way to resolve the load time error on the new system? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 7, "creation_date": 1496261782, "post_id": 44293915, "comment_id": 75594303, "body": "<code>char[][]</code> is not the same as <code>char**</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496261875, "post_id": 44293915, "comment_id": 75594352, "body": "<code>int fetchargs(char **argv){</code> --&gt; <code>int fetchargs(int col_size, char argv[][col_size]){</code> , call <code>fetchargs(MAX_LINE, argv);</code>"}, {"owner": {"reputation": 107, "user_id": 7084601, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/347c2ec314182f2d0a3bb327ecaba6ce?s=128&d=identicon&r=PG&f=1", "display_name": "naor.z", "link": "https://stackoverflow.com/users/7084601/naor-z"}, "edited": false, "score": 2, "creation_date": 1496262255, "post_id": 44293915, "comment_id": 75594519, "body": "wow! of course it&#39;s not the same..might be the hour.. char[][] is a matrix of characters"}, {"owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "edited": false, "score": 0, "creation_date": 1496262949, "post_id": 44293915, "comment_id": 75594868, "body": "Possible dup of <a href=\"https://stackoverflow.com/questions/4470950/why-cant-we-use-double-pointer-to-represent-two-dimensional-arrays\" title=\"why cant we use double pointer to represent two dimensional arrays\">stackoverflow.com/questions/4470950/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 743, "user_id": 5091033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d0737443a012e096ab556ef60a197f?s=128&d=identicon&r=PG&f=1", "display_name": "simo-r", "link": "https://stackoverflow.com/users/5091033/simo-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1496262249, "creation_date": 1496262249, "answer_id": 44294052, "question_id": 44293915, "link": "https://stackoverflow.com/questions/44293915/segmantation-fault-when-trying-to-access-array-of-character-pointers/44294052#44294052", "title": "Segmantation fault when trying to access array of character pointers", "body": "<p>That's how you should pass it to the function because it isn't a <code>char **</code>. You have to delete the <code>;</code> after the curly bracket.</p>\n\n<pre><code>/*Dim is your ARG_NUM and dim2 MAX_LINE*/\nint fetchargs(int dim1,int dim2,char pass[][MAX_LINE]){\n    /*Some stuff*/\n    return 1;\n}/*You've a semicolon here*/\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "is_accepted": true, "score": 1, "last_activity_date": 1496335695, "last_edit_date": 1496335695, "creation_date": 1496262788, "answer_id": 44294187, "question_id": 44293915, "link": "https://stackoverflow.com/questions/44293915/segmantation-fault-when-trying-to-access-array-of-character-pointers/44294187#44294187", "title": "Segmantation fault when trying to access array of character pointers", "body": "<p><code>char ** argv</code> is a <em>pointer to a pointer</em> of character(s) or a <code>double pointer</code><br>\nWhere as <code>argv[ARG_NUM][MAX_LINE]</code> is essentially a 2D array of characters</p>\n\n<h2>Bottom line here is to Honor the Data Types</h2>\n\n<pre><code>char argv[ARG_NUM][MAX_LINE];\n.........\n.........\nint fetchargs(char argv[][MAX_LINE]){\n  argv[0][0] = 'A'; \n  return 0;  \n};\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 7084601, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/347c2ec314182f2d0a3bb327ecaba6ce?s=128&d=identicon&r=PG&f=1", "display_name": "naor.z", "link": "https://stackoverflow.com/users/7084601/naor-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 44294187, "answer_count": 2, "score": 1, "last_activity_date": 1496335695, "creation_date": 1496261712, "question_id": 44293915, "link": "https://stackoverflow.com/questions/44293915/segmantation-fault-when-trying-to-access-array-of-character-pointers", "title": "Segmantation fault when trying to access array of character pointers", "body": "<p>so i've created a function that deals with a array of char pointers\nby using the [] operators.\nthe function</p>\n\n<pre><code>int fetchargs(char **argv){\nargv[0][0] = 'A';     \n};\n</code></pre>\n\n<p>will result in segmentation fault.\ni pass a array of character pointers that was initialized as follow</p>\n\n<pre><code>char argv[ARG_NUM][MAX_LINE];\n</code></pre>\n\n<p>trying to figure out the cause,but with not success</p>\n\n<p>what might be the issuse?</p>\n"}, {"tags": ["c", "arrays", "static"], "comments": [{"owner": {"reputation": 1828, "user_id": 2584754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Q3gFD.jpg?s=128&g=1", "display_name": "sturcotte06", "link": "https://stackoverflow.com/users/2584754/sturcotte06"}, "edited": false, "score": 0, "creation_date": 1496261065, "post_id": 44293723, "comment_id": 75593988, "body": "This does not make any sense. You need to choose: do you want a linked list or a dynamic array."}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1496261278, "post_id": 44293723, "comment_id": 75594079, "body": "can you post exact initial requirements, not your interpretation of them?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1496261511, "post_id": 44293723, "comment_id": 75594184, "body": "If you want us to help debug code, then present code.  We generally expect one <i>specific</i>, narrowly-focused question, backed by a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496261668, "post_id": 44293723, "comment_id": 75594254, "body": "If you want a statically allocated array of nodes, you can use two linked lists. One of used nodes, one of available nodes. When you free a node, you remove it from the active linked list, and add it to the head of the available linked list. When you want a new node, take it from the head of the available list. It&#39;s a bit more complex that that, but there is the basic idea. Moreover you can work with array indices instead of pointers."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1496261830, "post_id": 44293723, "comment_id": 75594336, "body": "Overall, though, if you want to avoid dynamically allocating <code>NODE</code>s, then you have no alternative to declaring all the nodes you could ever need statically, presumably as the elements of an array.  You will then need to track which are used and which are available.  Your options (1) and (2) are just different variations on this theme, and yes, such approaches have substantial overhead.  Also, they impose a hard limit on the program&#39;s item capacity."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496262012, "post_id": 44293723, "comment_id": 75594402, "body": "You could still dynamically <code>malloc</code> the array of available nodes to start with. I skimped a bit; if there are no nodes in the &quot;available&quot; linked list, you take the next unused one from the pre-allocated array. If there are no nodes there, you <code>realloc</code>a bunch more. This technique saves time over continual <code>malloc</code> and <code>free</code> operations for individual nodes."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1496263803, "post_id": 44293723, "comment_id": 75595231, "body": "see <a href=\"http://stackoverflow.com/a/39618642/905902\">stackoverflow.com/a/39618642/905902</a> for an example of creating lists and trees in statically allocated space. [note: this is <i>not</i> trivial, and might be too difficult for novice C-programmers]"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1496275468, "post_id": 44293723, "comment_id": 75599046, "body": "<a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">What is the XY problem?</a> ... and why is your question full of them?"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1496276052, "post_id": 44293723, "comment_id": 75599177, "body": "<a href=\"https://stackoverflow.com/questions/385506/when-is-optimisation-premature\">What is premature optimisation?</a> ... and why do you think your attempts at optimisation are <i>premature</i>?"}], "answers": [{"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 0, "last_activity_date": 1496281609, "last_edit_date": 1496281609, "creation_date": 1496276834, "answer_id": 44296629, "question_id": 44293723, "link": "https://stackoverflow.com/questions/44293723/how-can-i-implement-two-node-arrays-statically-and-also-efficiently/44296629#44296629", "title": "How can I implement two node arrays statically... and also efficiently?", "body": "<p>If you're going to use an array of pointers to nodes for each <em>list</em>, I don't see the need for using linked list concepts like previous and next pointers in the nodes, and instead the code could be array oriented.</p>\n\n<p>The question states that removing a node is done by replacing the node to be removed with the last node in the array, so the array order is not preserved. I assume that adding a node is done by appending a node to the end of an array.</p>\n\n<p>Each array structure could have a count of elements, index to <em>current</em> element, and array of pointers.</p>\n\n<p>There could be one structure for the free pool of elements (statically allocated), the rest of the structures would initially be empty (count == 0). Elements would be removed from or added to the end of the array of pointers for the free pool, similar to a stack.</p>\n\n<p>The item information could be included in the element structure as opposed to being handled via a pointer in the element structure.</p>\n\n<p>The logic for removing a node from the current position:</p>\n\n<pre><code>    free[count] = list[current];\n    free.count++;\n    list.count--;\n    if(list.count != 0)\n        list[current] = list[count];\n</code></pre>\n\n<p>The logic for appending a node:</p>\n\n<pre><code>    if(free.count != 0){\n        free.count--;\n        list[count] = free[count];\n        list.count++;\n    }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8093562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea570c848d60063b8485d8b8d5dc1526?s=128&d=identicon&r=PG&f=1", "display_name": "Aero", "link": "https://stackoverflow.com/users/8093562/aero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496281609, "creation_date": 1496260896, "last_edit_date": 1496273281, "question_id": 44293723, "link": "https://stackoverflow.com/questions/44293723/how-can-i-implement-two-node-arrays-statically-and-also-efficiently", "title": "How can I implement two node arrays statically... and also efficiently?", "body": "<pre><code>typedef struct NodeStruct NODE;\ntypedef struct ListStruct LIST; \n\nstruct NodeStruct {\n  void *item;\n  NODE *previous;\n  NODE *next;\n  int location;\n};\n\nstruct ListStruct {\n  int ListSize;\n  NODE *HeadNode;\n  NODE *CurrentNode;\n  NODE *TailNode;\n  NODE NodeArray[MaxNode];\n};\n\nNODE *HeadArray[MaxHead];\nstatic int HeadCount = -1;\nint HeadCurrent = 0;\nint i;\n</code></pre>\n\n<p>Fairly new at C, sorry to sound so very inexperienced ahead of time...</p>\n\n<p>I would like to implement the LIST abstract data type without the use of malloc() or free(), so by storing the nodes in statically allocated arrays.\nEach list element is a NODE, and can hold one \"item\".\nI need to be able to traverse through the nodes using next and previous, and have the notion of \"current\", \"tail\", \"head\".</p>\n\n<p>There are also two arrays... One array of pointers to the \"heads\", and so then for each head, there is an array of \"nodes\". I also need to be able to change the current item to one anywhere the middle (or front or end) of the list, be able to delete that node, and then <em>somehow</em> (this is the most confusing part to me) be able to use that spot in the array again, BUT, I can't traverse through the list to find a 'free' node because that's not efficient. </p>\n\n<p>I also need to do the same thing for the \"head\" array, so, there is a notion of max number of lists (which would mean the head array is full), and I also need to be able to delete an entire array of nodes, (which in turn, means I have to be able to delete a head node from that list as well and somehow be able to put one back there if i need that space). </p>\n\n<p>Problem is I've had a horribly awful time trying to implement this! The above code is the structure I have been working with so far, and I've tried two different ideas:</p>\n\n<p>1: Every time we \"remove\" a node from the array (which as far as I'm concerned is just setting it's ITEM to NULL and switching it's connected nodes nexts' and previous' to each other), we move the rightmost node in the array to this spot. When we add a new node, we always add it to that spot.  So, no searching, but absolutely a nightmare to implement (in my experience).</p>\n\n<p>2: Have a separate list (stack) of \"free nodes\", which I can take from when I need a new one. However, this means that I'd have to create all those nodes initially and maybe not use them which would not be good memory-wise. </p>\n\n<p>What I would really like to do, and can't figure out, is as follows:</p>\n\n<p>For the \"heads\" array: we have an array of pointers which points to the \"head\" of each node. \nFor the each \"heads\" we have, initially, an empty array of nodes.\nFor each empty array of nodes, we also have a list of \"free\" pointers, which are pointers to each free spot in the array, and when we insert a new item, we take the top address of this pointer array and that's where the new node will be placed in the node array. When we delete from the node array, we place that nodes address on top of the stack.</p>\n\n<p>However, I'm stuck on what ListCreate will look like, because that's just an empty array of nodes, and the head array won't actually be pointing to anything then. </p>\n\n<p>These are the specifications of what I'm working on so I can't change the requirements too much. ie, i can't not have an array of head pointers.</p>\n\n<p>Any ideas on how I can implement this efficiently and to these requirements? I just need help setting up the structures and what 'list create' will look like, and the general idea behind the manipulation of the nodes. I can figure all else out hopefully. I'm just really stuck on a general, efficient idea.</p>\n\n<p>Any help is appreciated. Thank you.</p>\n"}, {"tags": ["c++", "c", "sockets", "buffer", "flush"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1496259580, "post_id": 44293206, "comment_id": 75593164, "body": "You can&#39;t, really. For all you know those 6 bytes may have been lost on the Internet and need to be re-transmitted. This may make the packet arrive after subsequent packets. TCP will ensure the ordering, but there will be additional data in the stream to be picked up with <code>recv</code>. You will have to define a message protocol or switch from a stream-based network protocol to a message-based network protocol like UDP."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1496259868, "post_id": 44293206, "comment_id": 75593347, "body": "@user4581301 Umm, you&#39;ll have to explain yourself. How packets are received has nothing to do with being able to receive less data than the whole buffer. And I don&#39;t get what you mean with &quot;additional data in the stream to be picked up with recv.&quot; There is no need for any message protocol or UDP, <code>recv</code> should return what&#39;s available at that point anyway and not wait for full buffer. Arriving prices is not the same as arriving packets."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 3, "creation_date": 1496260186, "post_id": 44293206, "comment_id": 75593548, "body": "As for the question, why do you think it waits for 1024 bytes? If it does you&#39;ll only get one number printed since null will make the print end it there and not print any other numbers. Have you checked the return value of <code>recv</code>?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 3, "creation_date": 1496260362, "post_id": 44293206, "comment_id": 75593639, "body": "You MUST correctly and competely handle the result returned by system calls, especially recv().  It can return zero, above zero or below zero, all three of which mean different, important things."}, {"owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1496260380, "post_id": 44293206, "comment_id": 75593646, "body": "@SamiKuhmonen b/c prices are being printed in groups of 1024 characters, as shown in the last snippet."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 2, "creation_date": 1496260493, "post_id": 44293206, "comment_id": 75593716, "body": "Then you have something very much wrong since %s would stop printing after five characters and your output wouldn&#39;t be like that. Check the return value of <code>recv</code>. 1024 is not divisible by six so the printout would be garbled also."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 4, "creation_date": 1496260883, "post_id": 44293206, "comment_id": 75593904, "body": "You need to use a packet dump like wireshark to see whether the problem is sender or receiver.  Sender side, you need to <b>disable Nagle&#39;s algorithm</b> (set <code>TCP_NODELAY</code> option).  Receiver side, <code>O_NONBLOCK</code> as Akash suggests in his answer."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1496261052, "post_id": 44293206, "comment_id": 75593981, "body": "Note that the buffer size is not a characteristic of the socket, but rather a characteristic of your client and server (separately).  That size is not directly visible to <code>send()</code> and <code>recv()</code>, so it&#39;s really irrelevant.  In any case, both <code>send()</code> and <code>recv()</code> can and sometimes do transfer fewer bytes than you ask them to do."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1496261263, "post_id": 44293206, "comment_id": 75594072, "body": "Overall, I&#39;m not prepared to believe that the code fragments you have presented accurately represent the code that produced the output you presented.  You will get better answers, faster, if you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (with emphasis on &quot;minimal&quot;, &quot;complete&quot;, &quot;verifiable&quot;, and &quot;example&quot;)."}, {"owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1496262031, "post_id": 44293206, "comment_id": 75594415, "body": "@JohnBollinger I&#39;ve added the complete server- and client-side code."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1496262306, "post_id": 44293206, "comment_id": 75594554, "body": "<i>Perhaps</i> you are looking for the <code>TCP_NODELAY</code> socket option..."}], "answers": [{"comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 2, "creation_date": 1496295277, "post_id": 44293665, "comment_id": 75603821, "body": "This is wrong. <code>recv</code> returns any data available. The non-blocking behaviour is only related to <i>when there is no data available</i>. If there is one byte available then recv will return that and that&#39;s it. It won&#39;t wait for the whole buffer to be full. This is clearly documented."}], "tags": [], "owner": {"reputation": 144, "user_id": 4090593, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vAVi8n61-sY/AAAAAAAAAAI/AAAAAAAAACU/I42SYjcHZaQ/photo.jpg?sz=128", "display_name": "Akash Rawal", "link": "https://stackoverflow.com/users/4090593/akash-rawal"}, "is_accepted": false, "score": 3, "last_activity_date": 1496260676, "creation_date": 1496260676, "answer_id": 44293665, "question_id": 44293206, "link": "https://stackoverflow.com/questions/44293206/how-to-send-a-6-character-c-string-over-a-socket-connection-with-a-1024-byte-buf/44293665#44293665", "title": "How to send a 6-character c-string over a socket connection with a 1024 byte buffer, and force flush", "body": "<p>It is <code>recv()</code> that is buffering 1024 bytes.</p>\n\n<p>You have 2 options:</p>\n\n<ol>\n<li><p>Read character-by-character (buffer size = 1). Inefficient but simple.</p></li>\n<li><p>Set <code>O_NONBLOCK</code> using <code>fcntl()</code> on client side and use <code>select()</code> to wait till there is data to read and then call <code>recv()</code>. Complex, you could get any number of data or even partial data, but it is going to be efficient.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": false, "score": 3, "last_activity_date": 1496266930, "creation_date": 1496266930, "answer_id": 44295127, "question_id": 44293206, "link": "https://stackoverflow.com/questions/44293206/how-to-send-a-6-character-c-string-over-a-socket-connection-with-a-1024-byte-buf/44295127#44295127", "title": "How to send a 6-character c-string over a socket connection with a 1024 byte buffer, and force flush", "body": "<p>My apologies for lack of clarity in my comment. </p>\n\n<p>It is impossible to reliably separate data based solely on the packet in which it arrived. Disabling Nagle's Algorithm with TCP_NODELAY may greatly improve the likelihood of getting the desired behaviour but nothing can guarantee it.</p>\n\n<p>For example: </p>\n\n<pre><code>Message A is written and sent immediately\nMessage B is written and sent immediately\nMessage A is delayed on the network (too many possible reasons to list)\nMessage B arrives at receiver\nMessage A arrives at receiver  \nReceiver makes Messages A and B available\n</code></pre>\n\n<p><code>recv</code> will read everything from the buffer, Message A and Message B, up to the maximum number of bytes requested. Without some method of telling Message A from Message B, you cannot proceed.</p>\n\n<p>OK, but you know the length of Message A and Message B, 6 bytes, so you simply <code>recv</code> 6 bytes. Right?</p>\n\n<p>Almost. For a number of reasons, the sender may not be able to send the whole message in one packet and a <code>recv</code> for 6 bytes only returns, say, 2. </p>\n\n<p>The only way to be sure, other than <a href=\"https://www.youtube.com/watch?v=aCbfMkh940Q\" rel=\"nofollow noreferrer\">nuking the site from orbit</a>, is to loop on recv until all 6 bytes have been read.</p>\n\n<pre><code>bool receiveAll(int sock, \n                char * bufp, \n                size_t len)\n{\n    int result;\n    size_t offset = 0;\n\n    while (len &gt; 0)\n    { // loop until we have all of our data\n        result = recv(sock, &amp;bufp[offset], len, 0);\n        if (result &lt; 0)\n        { // Socket is in a bad state \n            // handle error\n            return false;\n        }\n        else if (result == 0)\n        { // socket closed\n            return false;\n        }\n        len -= result;\n        offset += result;\n    }\n    return true;\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>while(receiveAll(clientSocket, buffer 6)) {\n    printf(\"%s \",buffer);\n}\n</code></pre>\n\n<p>This will keep looping until the socket is closed or an error forces the loop to exit. No waiting is required, <code>recv</code> waits for you.</p>\n\n<p>What it doesn't have is a good mechanism for a polite shutdown of the client while the server is still running.</p>\n\n<p>This allows the sender to remain stupid. Otherwise the sender needs to do something similar making sure that it only ever sends full messages, and no messages ever straddle multiple packets. This is significantly more effort to get right than the loop in the <code>receiveAll</code> function. <a href=\"https://stackoverflow.com/a/44293665/4581301\">See Akash Rawal's answer</a> for hints on how to do this.</p>\n"}], "owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2117, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1496266930, "creation_date": 1496258875, "last_edit_date": 1496262009, "question_id": 44293206, "link": "https://stackoverflow.com/questions/44293206/how-to-send-a-6-character-c-string-over-a-socket-connection-with-a-1024-byte-buf", "title": "How to send a 6-character c-string over a socket connection with a 1024 byte buffer, and force flush", "body": "<p>EDIT1: Per request of John Bollinger, I've included the full client and server code below.</p>\n\n<hr>\n\n<p>I am sending 4-digit penny prices over a socket connection; e.g., 43.75, 29.43, 94.75, etc. Buffer size is set to 1024 bytes. At the moment, I am converting <code>float</code> prices to c-strings for transmission--not optimal, but I'm working on it. By my calculations, price size is 6 bytes: 4 digits, a decimal point, and the c-string terminating character <code>'\\0'</code>.</p>\n\n<p>The problem is that, on the client side, prices are not printed until the 1024-byte buffer is full. I would like each price tick sent and handled as it comes in, and force  a buffer flush, and have each tick to be handled separately. In other words, I'd like each price to be sent in a separate packet, and not buffer the 1024 bytes.</p>\n\n<p>How can I force each price tick to be handled separately? Thanks for your help. Sincerely, Keith :^)</p>\n\n<p>The socket connection code is taken from the following url:\n<a href=\"http://www.programminglogic.com/example-of-client-server-program-in-c-using-sockets-and-tcp/\" rel=\"nofollow noreferrer\">http://www.programminglogic.com/example-of-client-server-program-in-c-using-sockets-and-tcp/</a></p>\n\n<p>Server-side:</p>\n\n<pre><code>char buffer[1024]; // buffer set to 1024\nchar res[1024] // res contains the a float rounded and converted to a string.\n\n// res is copied into buffer, and then sent with size 6:\n// 22.49\\0 = 6 characters.\n\nstrcpy(buffer, res);\nsend(newSocket,buffer,6,0);\n</code></pre>\n\n<p>Client-side:</p>\n\n<pre><code>while(1) {\n    recv(clientSocket, buffer, 1024, 0);\n    printf(\"%s \",buffer);\n}\n</code></pre>\n\n<p>I would expect the prices to print as they arrive, like so:</p>\n\n<pre><code>pickledEgg$ 49.61\npickledEgg$ 50.20\npickledEgg$ 49.97\npickledEgg$ etc..\n</code></pre>\n\n<p>but 1024 bytes worth of prices are being buffered:</p>\n\n<pre><code>pickledEgg$ 49.61 50.20 49.97 49.86 49.52 50.24 49.79 49.52 49.84 50.29 49.83 49.97 50.34 49.81 49.84 49.50 50.08 50.06 49.54 50.04 50.09 50.08 49.54 50.43 49.97 50.33 50.29 50.08 50.43 50.02 49.86 50.06 50.24 50.33 50.43 50.25 49.58 50.25 49.79 50.43 50.04 49.63 49.88 49.86 49.93 50.22 50.38 50.02 49.79 50.41 49.56 49.88 49.52 49.59 50.34 49.97 49.93 49.63 50.06 50.38 50.15 50.43 49.95 50.40 49.77 50.40 49.68 50.36 50.13 49.95 50.29 50.18 50.09 49.66 50.06 50.04 50.38 49.95 49.56 50.18 49.86 50.13 50.09 49.88 49.74 49.91 49.88 49.70 49.56 50.43 49.58 49.74 49.88 49.54 49.63 50.15 49.97 49.79 49.52 49.59 49.77 50.31 49.81 49.88 50.47 50.36 50.40 49.86 49.81 49.97 49.54 50.18 50.11 50.13 50.08 50.36 50.06 50.45 50.06 50.13 50.38 49.65 49.88 50.29 49.70 50.00 50.45 49.68 50.29 50.47 50.29 50.09 50.27 49.59 50.45 50.24 50.47 49.88 50.11 49.77 49.86 50.16 49.97 50.47 50.31 49.56 49.84 50.38 50.02 50.40 49.52 49.90 50.09 49.90 50.20 49.81 50.38 50.15 49.99 49.70 50.11 49.77 49.79 49.88 49.88 49.75 50.13 50.36 49.63 49.74 50.1\n</code></pre>\n\n<p>EDIT1: Server-side code:</p>\n\n<pre><code>/****************** SERVER CODE ****************/\n\n#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;string.h&gt;\n\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nvoid reverse(char *str, int len)\n{\n    int i=0, j=len-1, temp;\n    while (i&lt;j)\n    {\n        temp = str[i];\n        str[i] = str[j];\n        str[j] = temp;\n        i++; j--;\n    }\n}\n\nint intToStr(int x, char str[], int d)\n{\n    int i = 0;\n    while (x)\n    {\n        str[i++] = (x%10) + '0';\n        x = x/10;\n    }\n\n    // If number of digits required is more, then\n    // add 0s at the beginning\n    while (i &lt; d)\n        str[i++] = '0';\n\n    reverse(str, i);\n    str[i] = '\\0';\n    return i;\n}\n\nvoid ftoa(float n, char *res, int afterpoint)\n{\n    // Extract integer part\n    int ipart = (int)n;\n\n    // Extract floating part\n    float fpart = n - (float)ipart;\n\n    // convert integer part to string\n    int i = intToStr(ipart, res, 0);\n\n    // check for display option after point\n    if (afterpoint != 0)\n    {\n        res[i] = '.';  // add dot\n\n        // Get the value of fraction part upto given no.\n        // of points after dot. The third parameter is needed\n        // to handle cases like 233.007\n//        fpart = fpart * pow(10, afterpoint);\n        fpart = fpart * 100;\n\n        intToStr((int)fpart, res + i + 1, afterpoint);\n    }\n}\nfloat randPrice() {\n    int b;\n    float d;\n    b = 4950 + rand() % 100 + 1;\n    d = (float)b/100;\n    return d;\n}\nvoid wait() {\n  int i, j, k;\n    for (i=0; i&lt;10000; ++i) {\n      for (j=0; j&lt;10000; ++j) {\n        k = i + j + i * j;\n      }\n    }  \n}\n\nint main(){\n  int welcomeSocket, newSocket;\n  char buffer[1024];\n  struct sockaddr_in serverAddr;\n  struct sockaddr_storage serverStorage;\n  socklen_t addr_size;\n\n  char res[1024];\n  float n;\n\n  srand(time(NULL));\n\n  /*---- Create the socket. The three arguments are: ----*/\n  /* 1) Internet domain 2) Stream socket 3) Default protocol (TCP in this case) */\n  welcomeSocket = socket(PF_INET, SOCK_STREAM, 0);\n\n  /*---- Configure settings of the server address struct ----*/\n  /* Address family = Internet */\n  serverAddr.sin_family = AF_INET;\n  /* Set port number, using htons function to use proper byte order */\n  serverAddr.sin_port = htons(7891);\n  /* Set IP address to localhost */\n  serverAddr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n  /* Set all bits of the padding field to 0 */\n  memset(serverAddr.sin_zero, '\\0', sizeof serverAddr.sin_zero);  \n\n  /*---- Bind the address struct to the socket ----*/\n  bind(welcomeSocket, (struct sockaddr *) &amp;serverAddr, sizeof(serverAddr));\n\n  /*---- Listen on the socket, with 5 max connection requests queued ----*/\n  if(listen(welcomeSocket,5)==0)\n    printf(\"Listening\\n\");\n  else\n    printf(\"Error\\n\");\n\n  /*---- Accept call creates a new socket for the incoming connection ----*/\n  addr_size = sizeof serverStorage;\n  newSocket = accept(welcomeSocket, (struct sockaddr *) &amp;serverStorage, &amp;addr_size);\n\n  /*---- Send prices to the socket of the incoming connection ----*/\n\n while(1) {\n    n = randPrice(); // Get a random, float price\n    ftoa(n, res, 2); // Convert price to string\n    strcpy(buffer, res); // copy to buffer\n    send(newSocket,buffer,6,0); // send buffer\n    wait();\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Client-side code:</p>\n\n<pre><code>/****************** CLIENT CODE ****************/\n\n#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;string.h&gt;\n\nvoid wait() {\n  int i, j, k;\n    for (i=0; i&lt;10000; ++i) {\n      for (j=0; j&lt;10000; ++j) {\n        k = i + j + i * j;\n      }\n    }  \n}\n\nint main(){\n  int clientSocket;\n  char buffer[1024];\n  struct sockaddr_in serverAddr;\n  socklen_t addr_size;\n\n  /*---- Create the socket. The three arguments are: ----*/\n  /* 1) Internet domain 2) Stream socket 3) Default protocol (TCP in this case) */\n  clientSocket = socket(PF_INET, SOCK_STREAM, 0);\n\n  /*---- Configure settings of the server address struct ----*/\n  /* Address family = Internet */\n  serverAddr.sin_family = AF_INET;\n  /* Set port number, using htons function to use proper byte order */\n  serverAddr.sin_port = htons(7891);\n  /* Set IP address to localhost */\n  serverAddr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n  /* Set all bits of the padding field to 0 */\n  memset(serverAddr.sin_zero, '\\0', sizeof serverAddr.sin_zero);  \n\n  /*---- Connect the socket to the server using the address struct ----*/\n  addr_size = sizeof serverAddr;\n  connect(clientSocket, (struct sockaddr *) &amp;serverAddr, addr_size);\n\n  /*---- Read the message from the server into the buffer ----*/\n\n  int r = 0;\n\n  while(1) {\n    r = recv(clientSocket, buffer, 1024, 0);\n    printf(\"recv value: %i\\n\", r);\n    printf(\"%s \",buffer);\n    wait();\n  }\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "macros", "printf", "c89", "ansi-c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1496258858, "post_id": 44293037, "comment_id": 75592775, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2524611/how-can-one-print-a-size-t-variable-portably-using-the-printf-family\">How can one print a size_t variable portably using the printf family?</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1496258921, "post_id": 44293037, "comment_id": 75592808, "body": "you can cast it, then use the <code>size_t</code> advice from the duplicate :/"}, {"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1496258962, "post_id": 44293037, "comment_id": 75592829, "body": "@AnttiHaapala seriously? how can I know that <code>BUFSIZ</code> is of type <code>size_t</code> if @Felix Palmen didn&#39;t give me the answer? My question is not about how to print <code>size_t</code>, its about <code>BUFSIZ</code> which I don&#39;t know even what type it is."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1496259132, "post_id": 44293037, "comment_id": 75592916, "body": "it is <i>a</i> size, which you can assume you can cast as <code>size_t</code> without loss of information."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496259197, "post_id": 44293037, "comment_id": 75592961, "body": "@BiteBytes I <i>assumed</i> in my answer because <code>size_t</code> is the rational pick for it ..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1496259244, "post_id": 44293037, "comment_id": 75592993, "body": "You have not even <i>shown</i> <code>BUFSIZ</code>. If it is a macro with an unqualified integer value, then it is of type <code>int</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496259323, "post_id": 44293037, "comment_id": 75593023, "body": "@WeatherVane the C library defines it, but as it is a size, I&#39;d treat it as <code>size_t</code>..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496259568, "post_id": 44293037, "comment_id": 75593155, "body": "@FelixPalmen interesting, MSVC does define <code>BUFSIZ</code> as <code>512</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496258533, "post_id": 44293104, "comment_id": 75592612, "body": "Pretty sure on 64-bit windows <code>sizeof(size_t) &gt; sizeof(unsigned long)</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496258644, "post_id": 44293104, "comment_id": 75592669, "body": "Oh, I guess you&#39;re right. And then you&#39;re doomed because <code>ll</code> doesn&#39;t work either ..."}, {"owner": {"reputation": 62898, "user_id": 567620, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/g8HIM.jpg?s=128&g=1", "display_name": "ely", "link": "https://stackoverflow.com/users/567620/ely"}, "edited": false, "score": 0, "creation_date": 1496258692, "post_id": 44293104, "comment_id": 75592690, "body": "The question specifies that <code>BUFSIZ</code> is used as a macro constant, so it may not be declared with type <code>size_t</code>. If the programmer needing to print this constant also has the freedom to redefine it, your solution seems reasonable. But if it exists in some legacy code or something, and it&#39;s not reasonable to change it (perhaps it&#39;s used in all kinds of strange scopes), then this would not be relevant."}, {"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "edited": false, "score": 0, "creation_date": 1496258700, "post_id": 44293104, "comment_id": 75592696, "body": "Microsoft&#39;s compiler doesn&#39;t let you specify the standard, so it&#39;s not an option anyway."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496259864, "post_id": 44293104, "comment_id": 75593342, "body": "Felix MSVC recent versions do support <code>%zu</code> format spec."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496259924, "post_id": 44293104, "comment_id": 75593378, "body": "@WeatherVane not last time I checked, a few days ago, on windows 10."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496259986, "post_id": 44293104, "comment_id": 75593432, "body": "That is a windows version, not a compiler version? I am on Windows 7 with MSVC 2015, having binned windows 10."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 4, "last_activity_date": 1496259783, "last_edit_date": 1496259783, "creation_date": 1496258432, "answer_id": 44293104, "question_id": 44293037, "link": "https://stackoverflow.com/questions/44293037/what-specifier-is-to-be-used-to-print-bufsiz-macro-constant-using-printf-in-c-c/44293104#44293104", "title": "What specifier is to be used to print BUFSIZ macro constant using printf in C (C89)", "body": "<p>I assume <code>BUFSIZ</code> is always a value fitting into <code>size_t</code> and there are no other guarantees.</p>\n\n<p>In that case: Yes, this is the <em>most correct</em> way to do it if you're limited to <a href=\"/questions/tagged/c89\" class=\"post-tag\" title=\"show questions tagged &#39;c89&#39;\" rel=\"tag\">c89</a>. The lack of a format length modifier suitable for <code>size_t</code> is one of the many shortcomings in this very old standard. In practice, if you're on a 64bit system with <code>LLP64</code> data model (this is, Win64), <code>size_t</code> is indeed larger than <code>long</code> and this code <em>can</em> break for large sizes. Thanks EOF for the hint. Still <em>in practice</em>: It probably should be defined reasonably and an I/O-Buffer sized <code>4G</code> or larger doesn't sound reasonable, so it really <em>is</em> unlikely to run into problems with the \"casting to <code>unsigned long</code>\" approach.</p>\n\n<p><em>Additional note</em>: There might be a valid reason to use this construct even with a compiler in <a href=\"/questions/tagged/c99\" class=\"post-tag\" title=\"show questions tagged &#39;c99&#39;\" rel=\"tag\">c99</a> or <a href=\"/questions/tagged/c11\" class=\"post-tag\" title=\"show questions tagged &#39;c11&#39;\" rel=\"tag\">c11</a> mode, and that is portability to the windows platform. Microsoft's <code>msvcrt</code> (the C runtime and standard library) doesn't support the <code>z</code> length modifier.</p>\n"}, {"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496259048, "post_id": 44293196, "comment_id": 75592870, "body": "Whether the size can be negative is irrelevant. Also, the type of the parameter to <code>setvbuf()</code> is not particularly relevant either, since an argument of any other integer type would automatically be converted to <code>size_t</code>, provided the prototype for <code>setvbuf()</code> is available, so <code>BUFSIZE</code> could be another integer type. In that case passing it to <code>printf()</code> is problematic because <code>printf()</code> is varargs."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496259170, "post_id": 44293196, "comment_id": 75592942, "body": "@EOF You contradict yourself.  If you say that whether the size is negative is irrelevant then what will be with the size when it will be converted to size_t? So it is your comment that is irrelevant and wrong."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496259316, "post_id": 44293196, "comment_id": 75593021, "body": "No. You simply do not understand the problem at hand. If you wanted to understand it, I&#39;d recommend reading in the C11 draft standard n1570 about <code>6.5.2.2 Function calls</code>, particularly the intricacies of argument conversion with regard to varargs-functions."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496259446, "post_id": 44293196, "comment_id": 75593097, "body": "@EOF Think about how negative value will be converted to size_t. And think about what the type of the parameter size of the function setvbuf that specifies the size of the buffer. And think also about what is the type of the value returned for example by the sizeof operator for a character array that is supplied to the function as an argument. So your comment does not make sense. It is irrelevant for my answer."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496259706, "post_id": 44293196, "comment_id": 75593247, "body": "As I said, negative values are irrelevant. It&#39;s really simple: 1. Have <code>BUFSIZ</code> be of type <code>T1</code>. 2. Call <code>setvbuf()</code> with <code>BUFSIZ</code> as <code>size</code>. Here, since <code>setvbuf()</code> has a prototype, <code>T1</code> will be converted to <code>size_t</code> automatically. 3. Call <code>printf()</code> with <code>BUFSIZ</code>. Here, since <code>printf()</code> is varags, <code>T1</code> <b>will not be converted</b>, so whatever random insane unspecified type <code>T1</code> was, you would need to have the right <code>%</code>-conversion specifier for. You don&#39;t."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496259818, "post_id": 44293196, "comment_id": 75593303, "body": "@VladfromMoscow did you mean <code>BUFSIZ</code> in your first code block?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496259833, "post_id": 44293196, "comment_id": 75593318, "body": "@EOF It is very important that size can not be negative, It means that there is no great sense to use a signed integer type to output the size. If the size is negative then the automatic conversion yields a wrong value. So all your comments do not make sense."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496259916, "post_id": 44293196, "comment_id": 75593374, "body": "@VladfromMoscow There are more distinct, <b>incompatible</b> integer types than just <code>signed</code> and <code>unsigned</code>."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1496259947, "post_id": 44293196, "comment_id": 75593399, "body": "@FelixPalmen I provided the description of the BUFSIZ from the standard. And then I provided the standard function that can be used to set the size of the buffer."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496260015, "post_id": 44293196, "comment_id": 75593446, "body": "@EOF I already wrote that all your comments do not make sense."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496260062, "post_id": 44293196, "comment_id": 75593475, "body": "@VladfromMoscow Writing that does not make it true."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1496258841, "creation_date": 1496258841, "answer_id": 44293196, "question_id": 44293037, "link": "https://stackoverflow.com/questions/44293037/what-specifier-is-to-be-used-to-print-bufsiz-macro-constant-using-printf-in-c-c/44293196#44293196", "title": "What specifier is to be used to print BUFSIZ macro constant using printf in C (C89)", "body": "<p>According to the C Standard (7.21 Input/output )</p>\n\n<pre><code>SETBUF\n</code></pre>\n\n<blockquote>\n  <p>which expands to an integer constant expression that is the size of\n  the buffer used by the setbuf function;</p>\n</blockquote>\n\n<p>It is unspecified what is the type of the constant.</p>\n\n<p>On the other hand the standard function <code>setvbuf</code> can be used to specify a user-supplied buffer or the buffer allocated by the function. It has the following declaration</p>\n\n<pre><code>int setvbuf(FILE * restrict stream,\nchar * restrict buf,\nint mode, size_t size);\n</code></pre>\n\n<p>where the parameter <code>size</code> of the type <code>size_t</code> specifies the size of the buffer. </p>\n\n<p>As the size can not be a negative number then you may output its value as having the type <code>size_t</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "edited": false, "score": 0, "creation_date": 1496265123, "post_id": 44293374, "comment_id": 75595810, "body": "so it&#39;s not necessarily a <code>size_t</code>, so why you keep on insisting  that my question is a duplicate of &quot;how to print size_t&quot;."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "edited": false, "score": 0, "creation_date": 1496269488, "post_id": 44293374, "comment_id": 75597441, "body": "@BiteBytes it is <code>size_t</code> after <code>(size_t)BUFSIZ</code>. And of course, you cannot print it portably without any cast, because its type is not specified."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 1, "last_activity_date": 1496259493, "creation_date": 1496259493, "answer_id": 44293374, "question_id": 44293037, "link": "https://stackoverflow.com/questions/44293037/what-specifier-is-to-be-used-to-print-bufsiz-macro-constant-using-printf-in-c-c/44293374#44293374", "title": "What specifier is to be used to print BUFSIZ macro constant using printf in C (C89)", "body": "<p>Well, it is easy to find proof that <code>BUFSIZ</code> is certainly not always of type <code>size_t</code>. Consider the following fragment <code>test.c</code>: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nBUFSIZ\n</code></pre>\n\n<p>Compile it on Linux and:</p>\n\n<pre><code>% gcc -E test.c|tail -n 2\n# 2 \"test.c\" 2\n8192\n</code></pre>\n\n<p>Thus, it certainly isn't of type <code>size_t</code> always. The constant migth be of type <code>int</code> but it might also not be an <code>int</code>, so the safest should be to assume that it can be <em>cast as <code>size_t</code></em> since the argument to <code>setvbuf</code> is also of type <code>size_t</code>.</p>\n\n<p>Then, use the advice from <a href=\"https://stackoverflow.com/questions/2524611/how-can-one-print-a-size-t-variable-portably-using-the-printf-family\">How can one print a size_t variable portably using the printf family?</a></p>\n"}], "owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1496265581, "creation_date": 1496258202, "last_edit_date": 1496265581, "question_id": 44293037, "link": "https://stackoverflow.com/questions/44293037/what-specifier-is-to-be-used-to-print-bufsiz-macro-constant-using-printf-in-c-c", "title": "What specifier is to be used to print BUFSIZ macro constant using printf in C (C89)", "body": "<p>Do we use <code>lu</code> and <code>unsigned long</code> cast like in:</p>\n\n<pre><code>printf(\"%lu\\n\", (unsigned long)BUFSIZ); /* 512 */\n</code></pre>\n\n<p>and hope for the best? or there is another way?</p>\n\n<p>And this is not a duplicate of: <a href=\"https://stackoverflow.com/questions/2524611/how-can-one-print-a-size-t-variable-portably-using-the-printf-family\">How can one print a size_t variable portably using the printf family?\n</a>simply because I don't know what <code>BUFSIZ</code> type is.</p>\n"}, {"tags": ["c", "algorithm", "performance", "loops", "image-processing"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1496256843, "post_id": 44292596, "comment_id": 75591638, "body": "One way to increase the speed would be to make the first row and the last row, the first column and the last column, special cases. Then you don&#39;t need to test the bounds for the typical pixel with 8 neighbours. Is <code>max</code> a function or a macro? Make sure it is inline."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1496257316, "post_id": 44292596, "comment_id": 75591909, "body": "When you calculate the maximum of three pixels in a row (for example 1/3, 2/3, 3/3) then you can use that value for the maximum pixel calculation of 2/2 and 2/4, which saves you some calculations. Maybe this can serve you as a start for further optimizations"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496258389, "post_id": 44292596, "comment_id": 75592532, "body": "Is this a one time pass though <code>img[]</code> or will the happen many times?"}, {"owner": {"reputation": 2389, "user_id": 3243499, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f14551e8ca190e92beaab157c3ebec7d?s=128&d=identicon&r=PG&f=1", "display_name": "user3243499", "link": "https://stackoverflow.com/users/3243499/user3243499"}, "reply_to_user": {"reputation": 14828, "user_id": 1377097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eFG0R.png?s=128&g=1", "display_name": "beaker", "link": "https://stackoverflow.com/users/1377097/beaker"}, "edited": false, "score": 0, "creation_date": 1496324318, "post_id": 44292596, "comment_id": 75623516, "body": "@beaker yes it was a typo. Edited. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 4, "last_activity_date": 1496256989, "creation_date": 1496256989, "answer_id": 44292680, "question_id": 44292596, "link": "https://stackoverflow.com/questions/44292596/fastest-way-to-calculate-maximum-pixel-gray-value-in-the-8-adjacency-of-every-pi/44292680#44292680", "title": "Fastest way to calculate maximum pixel gray value in the 8-adjacency of every pixel", "body": "<p>Yes, use a big <a href=\"/questions/tagged/if-else\" class=\"post-tag\" title=\"show questions tagged &#39;if-else&#39;\" rel=\"tag\">if-else</a> statement, instead of several <a href=\"/questions/tagged/if\" class=\"post-tag\" title=\"show questions tagged &#39;if&#39;\" rel=\"tag\">if</a> statements. That way, you won't have to evaluate all the statements, let alone the branch prediction.</p>\n\n<p>This should be a good way to start optimizing your code. Other than that, you can post in <a href=\"https://codereview.stackexchange.com/\">Code Review</a> for more. Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 15724, "user_id": 1716339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835fc3719b0118c68c4d202b3e5cbf18?s=128&d=identicon&r=PG", "display_name": "Aki Suihkonen", "link": "https://stackoverflow.com/users/1716339/aki-suihkonen"}, "is_accepted": false, "score": 2, "last_activity_date": 1496258888, "last_edit_date": 1496258888, "creation_date": 1496257859, "answer_id": 44292948, "question_id": 44292596, "link": "https://stackoverflow.com/questions/44292596/fastest-way-to-calculate-maximum-pixel-gray-value-in-the-8-adjacency-of-every-pi/44292948#44292948", "title": "Fastest way to calculate maximum pixel gray value in the 8-adjacency of every pixel", "body": "<p>Between any two adjacent pixels there are six shared expressions suggesting that there is potential of about 66% speed increase.</p>\n\n<p>In practise one can calculate maxima separately in vertical and horizontal directions:</p>\n\n<pre><code> for (i=0;i&lt;h-2;i++) {\n     for (j=0;j&lt;w;j++)\n        M[j] = max3(img[i][j], img[i+1][j], img[i+2]);\n     for (j=0;j&lt;w-2;j++)\n         Out[i][j] = max4(M[j], img[i][j+1], img[i+2][j+1], M[j+2];\n}\n</code></pre>\n\n<p>This completely avoids out-of-range testing and reduces comparisons slightly. The resulting image is of course 2 pixels shorter in each direction.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1496304243, "last_edit_date": 1496304243, "creation_date": 1496297388, "answer_id": 44299728, "question_id": 44292596, "link": "https://stackoverflow.com/questions/44292596/fastest-way-to-calculate-maximum-pixel-gray-value-in-the-8-adjacency-of-every-pi/44299728#44299728", "title": "Fastest way to calculate maximum pixel gray value in the 8-adjacency of every pixel", "body": "<p>You have eight special cases that happen more or less, and sometimes those cases can coincide, in cases you have only one row or only one column or both:</p>\n\n<pre><code>[]====+=====================================+====[]\n|| UL | Upper row                           | UR ||\n++----+-------------------------------------+----++\n|| Le | Main block                          | Ri ||\n|| ft |                                     | gh ||\n||  c |                                     | t  ||\n|| ol |                                     | co ||\n||    |                                     | l  ||\n||    |                                     |    ||\n++----+-------------------------------------+----++\n|| LL | Lower row                           | LR ||\n[]====+=====================================+====[]\n</code></pre>\n\n<p>I should use a different loop for each, so you know a priory what cells are accessible and don't have to do any tests.  You have to consider the special cases you can have in case the array has only one row or one column, but that's all.</p>\n\n<p>I'll assume you have an array of array pointers, as you don't tell, but it simplifies the access to the matrix cells with the <code>[]</code> operator.</p>\n\n<pre><code>inline int max2(int a, int b) \n{ \n    return a &gt; b ? a : b; \n}\ninline int max3(int a, int b, int c) \n{ \n    return max2(max2(a, b), c); \n}\ninline int max4(int a, int b, int c, int d) \n{ \n    return max2(max2(a, b), max2(c, d)); \n}\ninline int max6(\n        int a, int b, int c, \n        int d, int e, int f)\n{\n    return max2(max3(a, b, c), max3(d, e, f));\n}\ninline int max9(\n        int a, int b, int c, \n        int d, int e, int f, \n        int g, int h, int i)\n{\n    return max3(max3(a, b, c), max3(d, e, f), max3(g, h, i));\n}\n\nvoid max_value(int **in, int **out, int rows, int cols)\n{\n    if (rows &gt; 1) {\n        /* to avoid many calculations */\n        int rows_1 = rows - 1, rows_2 = rows - 2;\n\n        if (cols &gt; 1) { /* cols &gt; 1 &amp;&amp; rows &gt; 1 */\n            int cols_1 = cols - 1, cols_2 = cols - 2;\n\n            /* first consider the four corners */\n            /* UL */\n            out[0][0] = max4(\n                 in[0][0],          in[0][1], \n                 in[1][0],          in[1][1]);\n\n            /* LR */\n            out[rows_1][cols_1] = max4(\n                 in[rows_2][cols_2],in[rows_2][cols_1],\n                 in[rows_1][cols_2],in[rows_1][cols_1]);\n\n            /* LL */\n            out[rows_1][0] = max4(\n                 in[rows_2][0],     in[rows_2][1],\n                 in[rows_1][0],     in[rows_1][1]);\n\n            /* UR */\n            out[0][cols_1] = max4(\n                 in[0][cols_2],     in[1][cols_2],\n                 in[0][cols_1],     in[1][cols_1]);\n\n            /* next the two side columns */\n            for(row = 1; row &lt; rows_1; row++) {\n                /* left */\n                out[row][0] = max6(\n                 in[row-1][0],      in[row-1][1],\n                 in[row][0],        in[row][1],\n                 in[row+1][0],      in[row+1][1]); \n\n                /* right */\n                out[row][cols_1] = max6(\n                 in[row-1][cols_2], in[row-1][cols_1],\n                 in[row][cols_2],   in[row][cols_1],\n                 in[row+1][cols_2], in[row+1][cols_1]);\n            } /* for */\n\n            /* ... and the top/bottom rows */\n            for(col = 1; col &lt; cols_1; col++) {\n                /* top */\n                out[0][col] = max6(\n                 in[0][col-1], in[0][col], in[0][col+1],\n                 in[1][col-1], in[0][col], in[0][col+1]);\n                /* bottom */\n                out[row_1][col] = max6(\n                 in[row_2][col-1], in[row_2][col], in[row_2][col+1],\n                 in[row_1][col-1], in[row_1][col], in[row_1][col+1]);\n            } /* for */\n\n            /* and finally, the main block */\n            for(row=1; row &lt; row_1; row++) {\n                for(col=1; col &lt; col_1; col++) {\n                    out[row][col] = max9(\n                     in[row-1][col-1],in[row-1][col],in[row-1][col+1],\n                     in[row][col-1],in[row][col],in[row][col+1],\n                     in[row+1][col-1],in[row+1][col],in[row+1][col+1]);\n                } /* for */\n            } /* for */\n        } else { /* rows &gt; 1 &amp;&amp; cols == 1 */\n            /* we collapsed to three zones in one column */  \n            /* UL == UR */\n            out[0][0] = max2(\n                    in[0][0],\n                    in[1][0]);\n\n            /* LL == LR */\n            out[row_1][0] = max2(\n                    in[row_2][0],\n                    in[row_1][0]);\n\n            /* main block */\n            for(row = 1; row &lt; rows_1; row++) {\n                out[row][0] = max3(\n                    in[row-1][0],\n                    in[row][0],\n                    in[row+1][0]);\n            } /* for */\n        } /* if */\n    } else { /* rows == 1 */\n        /* the nine zones collapse to three */\n        if (cols &gt; 1) {\n            /* UL == LL */\n            out[0][0] = max2(in[0][0], in[0][1]);\n            /* UR == LR */\n            out[0][col_1] = max2(in[0][col_2], in[0][col_1]);\n            /* the main part */\n            for(col=1; col &lt; cols_1; col++)\n                out[0][col] = max3(in[0][col-1],in[0][col],in[0][col+1]);\n            } /* for */\n        } else { /* rows == 1 &amp;&amp; cols == 1 */\n            /* ... or one */\n            out[0][0] = in[0][0];\n        }\n    } /* if */\n} /* max_value */\n</code></pre>\n"}], "owner": {"reputation": 2389, "user_id": 3243499, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f14551e8ca190e92beaab157c3ebec7d?s=128&d=identicon&r=PG&f=1", "display_name": "user3243499", "link": "https://stackoverflow.com/users/3243499/user3243499"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1496324295, "creation_date": 1496256661, "last_edit_date": 1496324295, "question_id": 44292596, "link": "https://stackoverflow.com/questions/44292596/fastest-way-to-calculate-maximum-pixel-gray-value-in-the-8-adjacency-of-every-pi", "title": "Fastest way to calculate maximum pixel gray value in the 8-adjacency of every pixel", "body": "<p>I want to calculate the maximum pixel gray value in the 8-adjacency of every pixel in a given image.</p>\n\n<p>I am using the below code to achieve it in C.</p>\n\n<pre><code>        for(x = 0;x&lt;row;x++){\n            for(y = 0;y&lt;col;y++){\n                maxpixel = INT_MIN;\n                if((x-1)&gt;=0 &amp;&amp; (y-1)&gt;=0){\n                    maxpixel = max(maxpixel,img[x-1][y-1]);\n                }\n                if((x-1)&gt;=0){\n                    maxpixel = max(maxpixel,img[x-1][y]);\n                }\n                if((x-1)&gt;=0 &amp;&amp; (y+1)&lt;col){\n                    maxpixel = max(maxpixel,img[x-1][y+1]);\n                }\n                if((y+1)&lt;m){\n                    maxpixel = max(maxpixel,img[x][y+1]);\n                }\n                if((x+1)&lt;row &amp;&amp; (y+1) &lt;col){\n                    maxpixel = max(maxpixel,img[x+1][y+1]);\n                }\n                if((x+1)&lt;row){\n                    maxpixel = max(maxpixel,img[x+1][y]);\n                }\n                if((x+1)&lt;row &amp;&amp; (y-1)&gt;=0){\n                    maxpixel = max(maxpixel,img[x+1][y-1]);\n                }\n                if((y-1)&gt;=0){\n                    maxpixel = max(maxpixel,img[x][y-1]);\n                }\n                // do some other constant time operation.\n            }\n        }\n</code></pre>\n\n<p>The above code works as expected. However, this seems like very iterative as slow. </p>\n\n<p>Is there any scope of improvement to increase the speed ?</p>\n"}, {"tags": ["c", "user-defined-data-types"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1496253558, "post_id": 44291610, "comment_id": 75589879, "body": "I&#39;m sure the compiler didn&#39;t like it.  It&#39;s pretty far from valid C syntax."}, {"owner": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1496253808, "post_id": 44291610, "comment_id": 75590010, "body": "@JohnBollinger Is this doable in C though?  What if the data types are of the same size?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496253840, "post_id": 44291610, "comment_id": 75590030, "body": "Whatever you are trying to do: get it working properly with one data type first. Please make your mind up: same size or different size?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1496254043, "post_id": 44291610, "comment_id": 75590132, "body": "<a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">xyproblem.info</a> What are you trying to achieve?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1496254601, "post_id": 44291610, "comment_id": 75590398, "body": "<code>The variability in the bit field size prevented me from trying a union.</code> Uh... What? The rule is that a <code>union</code> is large enough to hold its largest member, at all times, i.e. regardless of which member is currently active. There is no &quot;variability&quot;."}, {"owner": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1496254634, "post_id": 44291610, "comment_id": 75590415, "body": "@n.m. OK-- there.  But it&#39;s not much different-- just more complicated."}], "answers": [{"comments": [{"owner": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "edited": false, "score": 0, "creation_date": 1496254716, "post_id": 44291973, "comment_id": 75590466, "body": "Probably the better thing to do at this point would be, to have an array of functions, and the function to be called would be determined by the index of the array.  Thanks!"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1496261358, "post_id": 44291973, "comment_id": 75594123, "body": "Also, conversion to <code>int *</code> is undefined already without dereference if the original pointer is not suitably aligned..."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1496262208, "post_id": 44291973, "comment_id": 75594494, "body": "Thanks, @AnttiHaapala, I have updated the answer to mention that."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1496262183, "last_edit_date": 1496262183, "creation_date": 1496254436, "answer_id": 44291973, "question_id": 44291610, "link": "https://stackoverflow.com/questions/44291610/an-array-of-data-types-in-c/44291973#44291973", "title": "An array of data types in C?", "body": "<p>Inside the function, you can convert <code>ptr</code> to type <code>char *</code> or <code>int *</code>, or to a pointer to a struct or union type, but every pointer points to exactly one type.  Such a conversion produces undefined behavior if the result would fail to be appropriately aligned for the pointer type, but that will not happen when casting to a type of object that <code>ptr</code> actually does point to.</p>\n\n<p>Furthermore, you can freely <em>access</em> the bytes of any object's representation via a pointer of character type (<code>char *</code>, <code>unsigned char *</code>, etc.).  If you attempt to access an object via a pointer to an object of a different, incompatible type, however, then you produce undefined behavior.  Accessing the pointed-to object is a separate consideration from converting the pointer to a different pointer type.</p>\n\n<p>Thus, you can do this:</p>\n\n<pre><code>void function(int index, void *ptr) {\n    // treat `ptr` as pointing to the first element of an array of int\n    int *pointer = ptr;\n    pointer[index]++;  // UB here if ptr really points to something other than int\n}\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>void function(int index, void *ptr) {\n    // treat `ptr` as pointing to the first element of an array of char\n    char *pointer = ptr;\n    pointer[index]++;\n}\n</code></pre>\n\n<p>and even this:</p>\n\n<pre><code>void function(int index, void *ptr, _Bool is_int_ptr) {\n    // Treat ptr as pointing to char or int depending on the value of is_int_ptr\n    if (is_int_ptr) {\n        int *pointer = ptr;\n        pointer[index]++;\n    } else {\n        char *pointer = ptr;\n        pointer[index]++;\n    }\n}\n</code></pre>\n\n<p>But the pointer value itself does not carry information about which type it points to.  You need a mechanism to tell the program which type it points to.  Ordinarily, that would be via the function parameter's declared type (making the function specific to that type), but you can convey it via a separate parameter, as in the last example.</p>\n"}], "owner": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 44291973, "answer_count": 1, "score": 0, "last_activity_date": 1496262183, "creation_date": 1496253202, "last_edit_date": 1496254590, "question_id": 44291610, "link": "https://stackoverflow.com/questions/44291610/an-array-of-data-types-in-c", "title": "An array of data types in C?", "body": "<p>I have two data types with different-sized fields of the same name.  I am trying to access these fields based on a parameter I pass in to a function--- say</p>\n\n<pre><code>struct smallindex\n{\n   unsigned char index;\n   unsigned int count;\n};\nstruct largeindex\n{\n   unsigned int index;\n   unsigned long count;\n};\n</code></pre>\n\n<p>This is possibly not an ideal thing to do-- but one way to implement this is, to have the function treat a pointer as a pointer of different sizes.  Say, something like:</p>\n\n<pre><code>void function(int index, void *ptr)\n{\n   array[] = {struct smallindex, struct largeindex};\n   array[index] *pointer = *ptr;\n   *pointer[1].index++;\n   return;\n}\n</code></pre>\n\n<p>However, the compiler does not like this at all.  I tried several other implementations-- but none of them worked.  The variability in the bit field size prevented me from trying a union.  Is this doable?</p>\n\n<p>Alternatively, if I pad the index sizes to make sure their size matches (but their positions of fields will still not match)-- is this doable then?</p>\n"}, {"tags": ["c", "function", "file", "stream"], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 7255573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/neBJ1.png?s=128&g=1", "display_name": "Pikappa", "link": "https://stackoverflow.com/users/7255573/pikappa"}, "edited": false, "score": 0, "creation_date": 1496253631, "post_id": 44291649, "comment_id": 75589916, "body": "Well, I added a fclose(fp) before the remove but still not working well. Everything into the file is deleted except for the file himself"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "reply_to_user": {"reputation": 172, "user_id": 7255573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/neBJ1.png?s=128&g=1", "display_name": "Pikappa", "link": "https://stackoverflow.com/users/7255573/pikappa"}, "edited": false, "score": 0, "creation_date": 1496254026, "post_id": 44291649, "comment_id": 75590118, "body": "@Pikappa, how do you know that? Do you mean you still can <code>fopen</code> the file without any errors?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1496254265, "post_id": 44291649, "comment_id": 75590230, "body": "Do you have another remove() linked that deletes everything inside a file?  Try unlink() instead, see if that works."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 172, "user_id": 7255573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/neBJ1.png?s=128&g=1", "display_name": "Pikappa", "link": "https://stackoverflow.com/users/7255573/pikappa"}, "edited": false, "score": 0, "creation_date": 1496255450, "post_id": 44291649, "comment_id": 75590879, "body": "@Pikappa, If you are on a system (e.g. Windows) that objects to deleting a file when a process has it open, then failure to delete is a routine possibility you just have to live with.  Even if the process attempting the deletion does not have it open, deletion can fail because some other process does."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 172, "user_id": 7255573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/neBJ1.png?s=128&g=1", "display_name": "Pikappa", "link": "https://stackoverflow.com/users/7255573/pikappa"}, "edited": false, "score": 1, "creation_date": 1496255624, "post_id": 44291649, "comment_id": 75590974, "body": "@Pikappa, Emptying the file in the event of a failure to delete is a surprising behavior, but I hesitate to comment on it without more information about the details of how such behavior was observed."}, {"owner": {"reputation": 172, "user_id": 7255573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/neBJ1.png?s=128&g=1", "display_name": "Pikappa", "link": "https://stackoverflow.com/users/7255573/pikappa"}, "edited": false, "score": 0, "creation_date": 1496256338, "post_id": 44291649, "comment_id": 75591379, "body": "Already tried with unlink(), same thing as remove(), the function emptying the file without deleting it.  Don&#39;t really know what&#39;s happening"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 172, "user_id": 7255573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/neBJ1.png?s=128&g=1", "display_name": "Pikappa", "link": "https://stackoverflow.com/users/7255573/pikappa"}, "edited": false, "score": 0, "creation_date": 1496256451, "post_id": 44291649, "comment_id": 75591435, "body": "@Pikappa please show the revised code, added to the question as an edit."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1496259141, "post_id": 44291649, "comment_id": 75592923, "body": "@JohnBollinger <code>fopen(&quot;...&quot;, &quot;w&quot;);</code> already truncates the file, not the attempt to delete it."}], "tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": false, "score": 5, "last_activity_date": 1496253334, "creation_date": 1496253334, "answer_id": 44291649, "question_id": 44291574, "link": "https://stackoverflow.com/questions/44291574/function-remove-in-c-does-not-delete-the-selected-file/44291649#44291649", "title": "Function &quot;remove()&quot; in C does not delete the selected file", "body": "<p>The file remains open, and deleting an open file is implementation-defined, so, deletion may or may not succeed. You'd better close the file <em>before</em> attempting to <code>remove</code> it. </p>\n"}, {"comments": [{"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1496255257, "post_id": 44291972, "comment_id": 75590768, "body": "Isn&#39;t fclose safe to call on NULL and not do anything?"}, {"owner": {"reputation": 2107, "user_id": 3770881, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9a575ab4e645630e948c8ae7eebeda74?s=128&d=identicon&r=PG&f=1", "display_name": "lpares12", "link": "https://stackoverflow.com/users/3770881/lpares12"}, "reply_to_user": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1496255889, "post_id": 44291972, "comment_id": 75591136, "body": "@PaulStelian <a href=\"https://stackoverflow.com/questions/32674141/if-file-pointer-is-null-do-i-have-to-use-fclose-c\" title=\"if file pointer is null do i have to use fclose c\">stackoverflow.com/questions/32674141/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2107, "user_id": 3770881, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9a575ab4e645630e948c8ae7eebeda74?s=128&d=identicon&r=PG&f=1", "display_name": "lpares12", "link": "https://stackoverflow.com/users/3770881/lpares12"}, "is_accepted": false, "score": 2, "last_activity_date": 1496254436, "creation_date": 1496254436, "answer_id": 44291972, "question_id": 44291574, "link": "https://stackoverflow.com/questions/44291574/function-remove-in-c-does-not-delete-the-selected-file/44291972#44291972", "title": "Function &quot;remove()&quot; in C does not delete the selected file", "body": "<p>Your code is messy and I think the last <code>fclose(fp)</code> is what's giving you this weird behaviour. First of all, you should always initialise variables, in your example <code>m</code> would generate an undefined behaviour when entering the second <code>if</code> statement (which should be inside the first <code>else</code> statement).</p>\n\n<p>Also, make sure to open the file for reading not for writing.</p>\n\n<pre><code>//sprintf(...)\nfp = open(str, \"r\");\nif(fp == NULL) printf(\"Database error\\n\");\nelse {\n    fp.close()\n    if(remove(str)) printf(\"Unable to delete the file\\n\");\n    else printf(\"Delete successful\\n\");\n}\n</code></pre>\n\n<p>You shouldn't add the last <code>fclose(fp)</code> since when you arrive to that point, it's already closed or it wasn't even opened in first place.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 0, "last_activity_date": 1496261569, "creation_date": 1496261569, "answer_id": 44293886, "question_id": 44291574, "link": "https://stackoverflow.com/questions/44291574/function-remove-in-c-does-not-delete-the-selected-file/44293886#44293886", "title": "Function &quot;remove()&quot; in C does not delete the selected file", "body": "<p>Instead of letting us guess why the file wasn't removed, use the <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.10.4\" rel=\"nofollow noreferrer\"><code>perror()</code></a> function yourself to get a <em>readable</em> and possibly <em>understandable</em> error message:</p>\n\n<pre><code>if (remove(str) == 0)\n    printf(\"Success\\n\");\nelse\n    perror(\"Unable to delete the file\");\n</code></pre>\n\n<p>Notice also that your logic is faulty: if the DB file cannot be opened for writing, the message <code>\"Database error\\n\"</code> will be printed; and <code>m</code> will remain unset, causing undefined behaviour!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10692570, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/602ee721804758425358c3a5c4719e5b?s=128&d=identicon&r=PG", "display_name": "user10692570", "link": "https://stackoverflow.com/users/10692570/user10692570"}, "is_accepted": false, "score": 0, "last_activity_date": 1542912353, "creation_date": 1542912353, "answer_id": 53436656, "question_id": 44291574, "link": "https://stackoverflow.com/questions/44291574/function-remove-in-c-does-not-delete-the-selected-file/53436656#53436656", "title": "Function &quot;remove()&quot; in C does not delete the selected file", "body": "<p>Using the file's path/name string instead of the pointer to the file in remove() should work. </p>\n"}], "owner": {"reputation": 172, "user_id": 7255573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/neBJ1.png?s=128&g=1", "display_name": "Pikappa", "link": "https://stackoverflow.com/users/7255573/pikappa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1542912353, "creation_date": 1496253073, "last_edit_date": 1496255141, "question_id": 44291574, "link": "https://stackoverflow.com/questions/44291574/function-remove-in-c-does-not-delete-the-selected-file", "title": "Function &quot;remove()&quot; in C does not delete the selected file", "body": "<p>I have this function:</p>\n\n<pre><code>void aggiornadatabase(void) {\n    FILE* fp;\n    int c=0;\n    char str[30];\n    int m;\n\n    sprintf(str, \"%s.csv\", utenti[posizioneuser].id);\n    printf(\"%s\\n\", str);\n    fp = fopen(str, \"w\");\n    if (fp == NULL)\n        printf(\"Database error\\n\");\n    else\n        m = remove(str);\n\n    if (m == 0)\n        printf(\"Success\\n\");\n    else\n        printf(\"Unable to delete the File\\n\");\n\n    fclose(fp);\n}\n</code></pre>\n\n<p>When this function executes, it deletes everything in the selected .csv file, but it does not delete the file itself (and indeed it prints \"Unable to delete the File\").</p>\n\n<p>Why this is happening?</p>\n"}, {"tags": ["c", "memory", "shared-libraries", "dlopen"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1496252850, "post_id": 44291485, "comment_id": 75589518, "body": "Why do you need to know this?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1496252919, "post_id": 44291485, "comment_id": 75589549, "body": "The shared object doesn&#39;t have to be a single block of memory. It can have different segments for text, data, BSS, just like an executable object file."}, {"owner": {"reputation": 25, "user_id": 8093565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e722ccefebee9a115e99d547296ebd7?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Gautam", "link": "https://stackoverflow.com/users/8093565/yash-gautam"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1496253169, "post_id": 44291485, "comment_id": 75589683, "body": "Can we know the offsets for data ? I want to make an offset table for the functions and data of the shared library."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1496253392, "post_id": 44291485, "comment_id": 75589793, "body": "Offset from what? The pointer returned by <code>dlopen</code> is opaque data, and may not have anything to do with the location of the shared object in memory."}], "answers": [{"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 0, "last_activity_date": 1496256501, "creation_date": 1496256501, "answer_id": 44292552, "question_id": 44291485, "link": "https://stackoverflow.com/questions/44291485/how-to-know-the-size-of-the-memory-allocation-of-a-shared-object-linked-at-runti/44292552#44292552", "title": "How to know the size of the memory allocation of a shared object linked at runtime?", "body": "<p>The dynamic linking of the shared library is a complete userspace process. You could do it on your own: Parse the ELF headers of the file, mmap the file into memory, do the dynamic linking with undefined symbols of the shared library etc pp. Then you know exactly where the library parts are located. But GNU libdl doesn't provide any information with regard to that.</p>\n\n<p>Another option is to dlopen() the library and parse /proc/self/maps for it. It usually has several mappings with different access permissions (code, rodata, rwdata, etc) depending on the elf header like that:</p>\n\n<pre><code>7fd6298f0000-7fd6298f5000 r-xp 00000000 fd:00 393441 /lib/x86_64-linux-gnu/libnss_dns-2.19.so\n7fd6298f5000-7fd629af4000 ---p 00005000 fd:00 393441 /lib/x86_64-linux-gnu/libnss_dns-2.19.so\n7fd629af4000-7fd629af5000 r--p 00004000 fd:00 393441 /lib/x86_64-linux-gnu/libnss_dns-2.19.so\n7fd629af5000-7fd629af6000 rw-p 00005000 fd:00 393441 /lib/x86_64-linux-gnu/libnss_dns-2.19.so\n</code></pre>\n\n<p>This should provide all information you need.</p>\n"}], "owner": {"reputation": 25, "user_id": 8093565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e722ccefebee9a115e99d547296ebd7?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Gautam", "link": "https://stackoverflow.com/users/8093565/yash-gautam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 44292552, "answer_count": 1, "score": 1, "last_activity_date": 1496256501, "creation_date": 1496252744, "question_id": 44291485, "link": "https://stackoverflow.com/questions/44291485/how-to-know-the-size-of-the-memory-allocation-of-a-shared-object-linked-at-runti", "title": "How to know the size of the memory allocation of a shared object linked at runtime?", "body": "<p>After linking a share library (.so) with dlopen, how can we know the size of the linked shared object i.e till what offset from the handle returned by dlopen is the shared library allocated.</p>\n"}, {"tags": ["c", "c11"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1496252588, "post_id": 44291402, "comment_id": 75589355, "body": "Where did you get this function from? If it has a documentation, it should tell what return value is."}, {"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 2, "creation_date": 1496252597, "post_id": 44291402, "comment_id": 75589360, "body": "<i>&quot;<b><a href=\"http://en.cppreference.com/w/c/thread/thrd_join\" rel=\"nofollow noreferrer\">Return value</a></b> <code>thrd_success</code> if successful, <code>thrd_error</code> otherwise.&quot;</i>"}, {"owner": {"reputation": 776, "user_id": 532501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y0sKg.jpg?s=128&g=1", "display_name": "Pavel Matuska", "link": "https://stackoverflow.com/users/532501/pavel-matuska"}, "edited": false, "score": 0, "creation_date": 1496252735, "post_id": 44291402, "comment_id": 75589445, "body": "So if I get <code>thrd_error</code>, the joining failed and <code>res</code> doesn&#39;t contain a valid value. If I get <code>thrd_success</code>, joining went OK and <code>res</code> contains the return value. Right?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1496252811, "post_id": 44291402, "comment_id": 75589494, "body": "What could be the alternative behavior?"}, {"owner": {"reputation": 776, "user_id": 532501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y0sKg.jpg?s=128&g=1", "display_name": "Pavel Matuska", "link": "https://stackoverflow.com/users/532501/pavel-matuska"}, "edited": false, "score": 0, "creation_date": 1496252976, "post_id": 44291402, "comment_id": 75589576, "body": "Well I wasn&#39;t given a list of the possible things that might go wrong when joining a thread. I thought that either the thread exits successfully, or not. Either way, the join happens. Perhaps I&#39;m mistaken in thinking that - that is a source of confusion for me."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1496253295, "post_id": 44291402, "comment_id": 75589736, "body": "Since, as you say, the return code is not informative, you cannot distinguish the errors, so you cannot trust the <code>res</code> value in case of <i>any</i> error."}, {"owner": {"reputation": 776, "user_id": 532501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y0sKg.jpg?s=128&g=1", "display_name": "Pavel Matuska", "link": "https://stackoverflow.com/users/532501/pavel-matuska"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1496253555, "post_id": 44291402, "comment_id": 75589874, "body": "@EugeneSh. Sounds perfectly reasonable. I guess I just got tangled up in it so badly that I needed an external point of view. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 776, "user_id": 532501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y0sKg.jpg?s=128&g=1", "display_name": "Pavel Matuska", "link": "https://stackoverflow.com/users/532501/pavel-matuska"}, "edited": false, "score": 0, "creation_date": 1496253668, "post_id": 44291557, "comment_id": 75589932, "body": "While not helpful to me personally, it is a good summary and a good fit for an accepted answer."}, {"owner": {"reputation": 4916, "user_id": 3991400, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5049bb61601c16ae408f5a56b5ed2518?s=128&d=identicon&r=PG&f=1", "display_name": "midor", "link": "https://stackoverflow.com/users/3991400/midor"}, "reply_to_user": {"reputation": 776, "user_id": 532501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y0sKg.jpg?s=128&g=1", "display_name": "Pavel Matuska", "link": "https://stackoverflow.com/users/532501/pavel-matuska"}, "edited": false, "score": 0, "creation_date": 1496261914, "post_id": 44291557, "comment_id": 75594366, "body": "If you can detail, what else you would need to know, I try to update my answer. I could add a pointer to the standard (C11 draft N1570 section 7.26.5.6), but I guess that is obvious."}], "tags": [], "owner": {"reputation": 4916, "user_id": 3991400, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5049bb61601c16ae408f5a56b5ed2518?s=128&d=identicon&r=PG&f=1", "display_name": "midor", "link": "https://stackoverflow.com/users/3991400/midor"}, "is_accepted": true, "score": 2, "last_activity_date": 1496253029, "creation_date": 1496253029, "answer_id": 44291557, "question_id": 44291402, "link": "https://stackoverflow.com/questions/44291402/difference-between-the-return-value-of-thrd-join-and-its-res-parameter/44291557#44291557", "title": "Difference between the return value of thrd_join and its res parameter?", "body": "<p>The thread is <a href=\"http://en.cppreference.com/w/c/thread/thrd_create\" rel=\"nofollow noreferrer\">started</a> with a function of <code>thrd_start_t</code> which is typedef for <code>int(*)(void*)</code>(cf. <a href=\"http://en.cppreference.com/w/c/thread\" rel=\"nofollow noreferrer\">here</a>), i.e. it takes a <code>void *</code>, and returns an <code>int</code>. The return value of this function is stored to the location pointed to by <code>res</code>. The return code of the call to<a href=\"http://en.cppreference.com/w/c/thread/thrd_join\" rel=\"nofollow noreferrer\"><code>thrd_join</code></a> itself is its return value.</p>\n"}, {"comments": [{"owner": {"reputation": 776, "user_id": 532501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y0sKg.jpg?s=128&g=1", "display_name": "Pavel Matuska", "link": "https://stackoverflow.com/users/532501/pavel-matuska"}, "edited": false, "score": 0, "creation_date": 1496253307, "post_id": 44291598, "comment_id": 75589741, "body": "That&#39;s too generic to be of any value. I obviously understand what return codes are for, but this specific case seemed different to me."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 776, "user_id": 532501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y0sKg.jpg?s=128&g=1", "display_name": "Pavel Matuska", "link": "https://stackoverflow.com/users/532501/pavel-matuska"}, "edited": false, "score": 0, "creation_date": 1496253387, "post_id": 44291598, "comment_id": 75589790, "body": "@PavelMatuska Not really different. If you use <code>scanf(&quot;%d&quot;, &amp;number)</code>, you should check  it&#39;s return value. And if it is not <code>1</code> you can&#39;t trust the value of <code>number</code>. Dunno why it is downvoted badly. Probably because of &quot;you can ignore those error codes&quot;."}, {"owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "reply_to_user": {"reputation": 776, "user_id": 532501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y0sKg.jpg?s=128&g=1", "display_name": "Pavel Matuska", "link": "https://stackoverflow.com/users/532501/pavel-matuska"}, "edited": false, "score": 0, "creation_date": 1496255544, "post_id": 44291598, "comment_id": 75590925, "body": "@PavelMatuska as EugeneSh said, I didn&#39;t see your case very different"}], "tags": [], "owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "is_accepted": false, "score": -2, "last_activity_date": 1496255398, "last_edit_date": 1496255398, "creation_date": 1496253153, "answer_id": 44291598, "question_id": 44291402, "link": "https://stackoverflow.com/questions/44291402/difference-between-the-return-value-of-thrd-join-and-its-res-parameter/44291598#44291598", "title": "Difference between the return value of thrd_join and its res parameter?", "body": "<p>That function is like many many functions in C where the function returns an \"error code\" signifying error or success and the function has an out parameter which holds the real output.   </p>\n\n<p>In some cases you can ignore those error codes , for example <code>printf</code> returns <code>int</code> too yet we mostly don't check for its return type.   </p>\n\n<p>When the error case has good probability it's good to check for errors then.  </p>\n\n<p>Notice that in languages like <code>java</code> or <code>C#</code> the function returns the real output and <code>Exceptions</code> are the way to represent possible errors. </p>\n"}], "owner": {"reputation": 776, "user_id": 532501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y0sKg.jpg?s=128&g=1", "display_name": "Pavel Matuska", "link": "https://stackoverflow.com/users/532501/pavel-matuska"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 44291557, "answer_count": 2, "score": 1, "last_activity_date": 1496255398, "creation_date": 1496252491, "question_id": 44291402, "link": "https://stackoverflow.com/questions/44291402/difference-between-the-return-value-of-thrd-join-and-its-res-parameter", "title": "Difference between the return value of thrd_join and its res parameter?", "body": "<p>I have a hard time understanding the usage of thrd_join. Its declaration is this:</p>\n\n<pre><code>int thrd_join( thrd_t thr, int *res );\n</code></pre>\n\n<p>The section reads:</p>\n\n<blockquote>\n  <p>If <strong>res</strong> is not a null pointer, the result code of the thread is put to the location pointed to by <strong>res</strong></p>\n</blockquote>\n\n<p>So I take it that the variable <strong>res</strong> contains the return code of the thread to be joined. What is the return value of <strong>thrd_join()</strong> used for then? Is that a code signifying that the join will be successful and that I can take contents of <strong>res</strong> seriously?</p>\n\n<p>Do I have that right?</p>\n"}, {"tags": ["c", "video", "ffmpeg", "libav"], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 1919599, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cb33462dd8d4e40926f74d9bd346ca4a?s=128&d=identicon&r=PG", "display_name": "DweebsUnited", "link": "https://stackoverflow.com/users/1919599/dweebsunited"}, "edited": false, "score": 0, "creation_date": 1496254664, "post_id": 44291819, "comment_id": 75590428, "body": "So to confirm I understand, after the av_seek_frame call, I should reencode all video packets received until I get a keyframe, at which point I can resume remux copying? Thank you."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 148, "user_id": 1919599, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cb33462dd8d4e40926f74d9bd346ca4a?s=128&d=identicon&r=PG", "display_name": "DweebsUnited", "link": "https://stackoverflow.com/users/1919599/dweebsunited"}, "edited": false, "score": 0, "creation_date": 1496283081, "post_id": 44291819, "comment_id": 75600737, "body": "I&#39;m not sure how <code>av_seek_frame</code> works on current ffmpeg, so I don&#39;t want to give you wrong advice. If it works by seeking to the previous keyframe and decoding up to the desired frame with the output thrown away, then I think you&#39;re right. If not, you might have to manually seek back to the previous keyframe and throw away decoded frames until you get the one you want."}, {"owner": {"reputation": 148, "user_id": 1919599, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cb33462dd8d4e40926f74d9bd346ca4a?s=128&d=identicon&r=PG", "display_name": "DweebsUnited", "link": "https://stackoverflow.com/users/1919599/dweebsunited"}, "edited": false, "score": 0, "creation_date": 1496755456, "post_id": 44291819, "comment_id": 75782270, "body": "So as it turns out, this video file just didn&#39;t contain any IDR frames, which means I was remuxing correctly. Running it on a video that did contain IDR frames works perfectly. TIL to expand my test set, and not trust one sample. Thank you for your help."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 2, "last_activity_date": 1496253899, "creation_date": 1496253899, "answer_id": 44291819, "question_id": 44291321, "link": "https://stackoverflow.com/questions/44291321/ffmpeg-trim-by-remux-doesnt-write-a-keyframe/44291819#44291819", "title": "FFMPEG trim by remux doesn&#39;t write a keyframe", "body": "<p>For frame-granularity remuxing (not just starting at a keyframe), at the very least you'll need to encode a keyframe to replace the non-key frame you started at, but if the stream uses B frames (common for mp4 with h264/etc.) then it may not suffice. The safest approach is to reencode everything from the frame you want to start with up until (but not including) the next keyframe, then simply remux-copy everything starting with the existing keyframe there.</p>\n"}], "owner": {"reputation": 148, "user_id": 1919599, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cb33462dd8d4e40926f74d9bd346ca4a?s=128&d=identicon&r=PG", "display_name": "DweebsUnited", "link": "https://stackoverflow.com/users/1919599/dweebsunited"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1496253899, "creation_date": 1496252166, "question_id": 44291321, "link": "https://stackoverflow.com/questions/44291321/ffmpeg-trim-by-remux-doesnt-write-a-keyframe", "title": "FFMPEG trim by remux doesn&#39;t write a keyframe", "body": "<p>I am using the FFMPEG libraries to trim video files. I do this all as a remux, with no encoding or decoding.</p>\n\n<p>Trimming currently works correctly with audio, but the trimmed video data appears as a solid color, with small squares of pixels changing. I believe this is because I am not catching/writing a keyframe. It is my understanding that av_seek_frame will seek to a keyframe, which does not seem to be the case..</p>\n\n<p>If need be, can I decode and then reencode just the first video frame I read after seeking? This will probably be more code than reencoding every frame, but speed is the primary issue here, not complexity.</p>\n\n<p>Thank you for any help. Also I apologize if I am misunderstanding something to do with video files, I'm still new to this.</p>\n\n<p>Example output frame:\n<a href=\"https://i.stack.imgur.com/ZoTMH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZoTMH.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Code, adapted from the remux example provided with ffmpeg:</p>\n\n<pre><code>const char *out_filename = \"aaa.mp4\";\n\nFILE *fp = fdopen(fd, \"r\");\nfseek(fp, 0, SEEK_SET);\n\nif ( fp ) {\n\n    // Build an ffmpeg file\n    char path[512];\n    sprintf(path, \"pipe:%d\", fileno(fp));\n\n    // Turn on verbosity\n    av_log_set_level( AV_LOG_DEBUG );\n    av_log_set_callback( avLogCallback );\n\n\n    av_register_all();\n    avcodec_register_all();\n\n\n    AVOutputFormat *ofmt = NULL;\n    AVFormatContext *ifmt_ctx = avformat_alloc_context(), *ofmt_ctx = NULL;\n    AVPacket pkt;\n    int ret, i;\n\n\n    if ((ret = avformat_open_input(&amp;ifmt_ctx, path, av_find_input_format(\"mp4\"), NULL)) &lt; 0) {\n        LOG(\"Could not open input file '%s'\", path);\n        goto end;\n    }\n\n    if ((ret = avformat_find_stream_info(ifmt_ctx, 0)) &lt; 0) {\n        LOG(\"Failed to retrieve input stream information\", \"\");\n        goto end;\n    }\n\n\n    avformat_alloc_output_context2(&amp;ofmt_ctx, NULL, NULL, out_filename);\n    if (!ofmt_ctx) {\n        LOG(\"Could not create output context\\n\");\n        ret = AVERROR_UNKNOWN;\n        goto end;\n    }\n\n    ofmt = ofmt_ctx-&gt;oformat;\n\n\n    for (i = 0; i &lt; ifmt_ctx-&gt;nb_streams; i++) {\n        AVStream *in_stream = ifmt_ctx-&gt;streams[i];\n        AVStream *out_stream = avformat_new_stream(ofmt_ctx, NULL);\n\n        if (!out_stream) {\n            LOG(\"Failed allocating output stream\\n\");\n            goto end;\n        }\n\n        ret = avcodec_parameters_copy(out_stream-&gt;codecpar, in_stream-&gt;codecpar);\n        if (ret &lt; 0) {\n            LOG(\"Failed to copy context from input to output stream codec context\\n\");\n            goto end;\n        }\n        out_stream-&gt;codecpar-&gt;codec_tag = 0;\n    }\n\n    if (!(ofmt-&gt;flags &amp; AVFMT_NOFILE)) {\n        ret = avio_open(&amp;ofmt_ctx-&gt;pb, out_filename, AVIO_FLAG_WRITE);\n        if (ret &lt; 0) {\n            LOG(\"Could not open output file '%s'\", out_filename);\n            goto end;\n        }\n    }\n\n    ret = avformat_write_header(ofmt_ctx, NULL);\n    if (ret &lt; 0) {\n        LOG(\"Error occurred when writing headers\\n\");\n        goto end;\n    }\n\n    ret = av_seek_frame(ifmt_ctx, -1, from_seconds * AV_TIME_BASE, AVSEEK_FLAG_ANY);\n    if (ret &lt; 0) {\n        LOG(\"Error seek\\n\");\n        goto end;\n    }\n\n    int64_t *dts_start_from;\n    int64_t *pts_start_from;\n    dts_start_from = (int64_t *) malloc(sizeof(int64_t) * ifmt_ctx-&gt;nb_streams);\n    memset(dts_start_from, 0, sizeof(int64_t) * ifmt_ctx-&gt;nb_streams);\n    pts_start_from = (int64_t *) malloc(sizeof(int64_t) * ifmt_ctx-&gt;nb_streams);\n    memset(pts_start_from, 0, sizeof(int64_t) * ifmt_ctx-&gt;nb_streams);\n\n    while (1) {\n        AVStream *in_stream, *out_stream;\n\n        ret = av_read_frame(ifmt_ctx, &amp;pkt);\n        LOG(\"while %d\", ret);\n        LOG(\"Packet size: %d\", pkt.size);\n        LOG(\"Packet stream: %d\", pkt.stream_index);\n        if (ret &lt; 0)\n            break;\n\n        in_stream = ifmt_ctx-&gt;streams[pkt.stream_index];\n        out_stream = ofmt_ctx-&gt;streams[pkt.stream_index];\n\n        if (av_q2d(in_stream-&gt;time_base) * pkt.pts &gt; end_seconds) {\n            av_packet_unref(&amp;pkt);\n            break;\n        }\n\n        if (dts_start_from[pkt.stream_index] == 0) {\n            dts_start_from[pkt.stream_index] = pkt.dts;\n            printf(\"dts_start_from: %s\\n\", av_ts_make_string((char[AV_TS_MAX_STRING_SIZE]){0},dts_start_from[pkt.stream_index]));\n        }\n        if (pts_start_from[pkt.stream_index] == 0) {\n            pts_start_from[pkt.stream_index] = pkt.pts;\n            printf(\"pts_start_from: %s\\n\", av_ts_make_string((char[AV_TS_MAX_STRING_SIZE]){0},pts_start_from[pkt.stream_index]));\n        }\n\n        /* copy packet */\n        pkt.pts = ::av_rescale_q_rnd(pkt.pts - pts_start_from[pkt.stream_index], in_stream-&gt;time_base, out_stream-&gt;time_base, (AVRounding) (AV_ROUND_NEAR_INF |\n                                                                                                                                            AV_ROUND_PASS_MINMAX));\n        pkt.dts = ::av_rescale_q_rnd(pkt.dts - dts_start_from[pkt.stream_index], in_stream-&gt;time_base, out_stream-&gt;time_base, (AVRounding) (AV_ROUND_NEAR_INF |\n                                                                                                                                            AV_ROUND_PASS_MINMAX));\n        if (pkt.pts &lt; 0) {\n            pkt.pts = 0;\n        }\n        if (pkt.dts &lt; 0) {\n            pkt.dts = 0;\n        }\n        pkt.duration = (int) av_rescale_q((int64_t) pkt.duration, in_stream-&gt;time_base, out_stream-&gt;time_base);\n        pkt.pos = -1;\n        printf(\"\\n\");\n\n        ret = av_interleaved_write_frame(ofmt_ctx, &amp;pkt);\n        if (ret &lt; 0) {\n            LOG(\"Error muxing packet\\n\");\n            break;\n        }\n        av_packet_unref(&amp;pkt);\n    }\n    free(dts_start_from);\n    free(pts_start_from);\n\n    av_write_trailer(ofmt_ctx);\n\n    end:\n    LOG(\"END\");\n\n    avformat_close_input(&amp;ifmt_ctx);\n\n    // Close output\n    if (ofmt_ctx &amp;&amp; !(ofmt-&gt;flags &amp; AVFMT_NOFILE))\n        avio_closep(&amp;ofmt_ctx-&gt;pb);\n    avformat_free_context(ofmt_ctx);\n\n    if (ret &lt; 0 &amp;&amp; ret != AVERROR_EOF) {\n        LOG(\"-- Error occurred: %s\\n\", av_err2str(ret));\n        return 1;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "modelica", "openmodelica"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 8092574, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f01001e621165d0d2b6dd4918208a4f2?s=128&d=identicon&r=PG&f=1", "display_name": "angusmax", "link": "https://stackoverflow.com/users/8092574/angusmax"}, "edited": false, "score": 0, "creation_date": 1496300923, "post_id": 44297569, "comment_id": 75606702, "body": "I have a few questions: 1) Doesn&#39;t <i>inner/outer</i> work just within the same package? (I want the <i>MyData</i> package to provide data accessible from all packages, like e.g. <i>Test</i>). 2) Since <i>SetTemperature</i> is done by <i>SingleTemperatureOverwrite</i> at the initial time and <i>TemperatureTest</i>&#39;s equation (containing <i>GetTemperature</i>) is evaluated at every step, shouldn&#39;t it work anyway? 3) What do you exactly mean with &quot;<i>using external object to enforce execution order</i>&quot;?"}, {"owner": {"reputation": 2937, "user_id": 934829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bcf5c6230b50780f3973962c27ccb48?s=128&d=identicon&r=PG", "display_name": "sjoelund.se", "link": "https://stackoverflow.com/users/934829/sjoelund-se"}, "reply_to_user": {"reputation": 101, "user_id": 8092574, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f01001e621165d0d2b6dd4918208a4f2?s=128&d=identicon&r=PG&f=1", "display_name": "angusmax", "link": "https://stackoverflow.com/users/8092574/angusmax"}, "edited": false, "score": 1, "creation_date": 1496313603, "post_id": 44297569, "comment_id": 75615655, "body": "Using inner/outer works with the entire model. You do need to add an inner object at the appropriate level and all outer instances will refer to the same inner instance (sharing that data). As for external object, it has a constructor which is always called before all other references to the external object. So you can set data in the constructor and access it later."}, {"owner": {"reputation": 101, "user_id": 8092574, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f01001e621165d0d2b6dd4918208a4f2?s=128&d=identicon&r=PG&f=1", "display_name": "angusmax", "link": "https://stackoverflow.com/users/8092574/angusmax"}, "edited": false, "score": 0, "creation_date": 1496327904, "post_id": 44297569, "comment_id": 75626397, "body": "Could you please provide an example? (I&#39;ve done 1000 tests, but none of them works...)"}], "tags": [], "owner": {"reputation": 2937, "user_id": 934829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bcf5c6230b50780f3973962c27ccb48?s=128&d=identicon&r=PG", "display_name": "sjoelund.se", "link": "https://stackoverflow.com/users/934829/sjoelund-se"}, "is_accepted": false, "score": 2, "last_activity_date": 1496284273, "creation_date": 1496284273, "answer_id": 44297569, "question_id": 44291114, "link": "https://stackoverflow.com/questions/44291114/access-data-in-external-c-module-from-modelica-in-read-overwrite-mode/44297569#44297569", "title": "Access data in external C module from Modelica, in read/overwrite mode", "body": "<p>There is no causal link between the two equations so they may execute in an arbitrary order. If you want global, mutable variables in Modelica, I suggest using the inner/outer concept instead of external C. (Or perhaps using external object to enforce execution order)</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 8092574, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f01001e621165d0d2b6dd4918208a4f2?s=128&d=identicon&r=PG&f=1", "display_name": "angusmax", "link": "https://stackoverflow.com/users/8092574/angusmax"}, "edited": false, "score": 0, "creation_date": 1500988856, "post_id": 45160679, "comment_id": 77570741, "body": "No. In your code <i>TestT</i> writes the entire <i>tValue</i> array, while I need the &quot;<i>TestT</i>&quot; component to write just one element of the array (at a specified index). Moreover, <i>TestT</i> should not need to &quot;be aware&quot; of the objects composing the &quot;global model&quot; (in your example, the <i>ExampleComponent</i> instances, <i>component1</i> and <i>component2</i>)."}, {"owner": {"reputation": 232, "user_id": 2024223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f396ec701ce567ae77b1a59ffe77218d?s=128&d=identicon&r=PG", "display_name": "user2024223", "link": "https://stackoverflow.com/users/2024223/user2024223"}, "reply_to_user": {"reputation": 101, "user_id": 8092574, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f01001e621165d0d2b6dd4918208a4f2?s=128&d=identicon&r=PG&f=1", "display_name": "angusmax", "link": "https://stackoverflow.com/users/8092574/angusmax"}, "edited": false, "score": 0, "creation_date": 1501137886, "post_id": 45160679, "comment_id": 77647712, "body": "I&#39;m not sure what you mean by &quot;TestT should not need to &quot;be aware&quot; of the objects composing the &quot;global model&quot;&quot;.  So do you want to do everything at the TestT level?"}, {"owner": {"reputation": 101, "user_id": 8092574, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f01001e621165d0d2b6dd4918208a4f2?s=128&d=identicon&r=PG&f=1", "display_name": "angusmax", "link": "https://stackoverflow.com/users/8092574/angusmax"}, "edited": false, "score": 0, "creation_date": 1501582600, "post_id": 45160679, "comment_id": 77830903, "body": "I want &quot;<i>ExampleComponent</i>&quot; to be a <b>library</b> component I can drag and drop in a blank &quot;workspace&quot; in the OpenModelica editor; the same for &quot;<i>TestT</i>&quot; (which could be part of a <b>different</b> package in the library). I will have up to 5 <i>TestT</i> components in the resulting global model (one for each element of the &quot;<i>tValue</i>&quot; array). Therefore, <i>TestT</i> should not declare any <i>ExampleComponent</i> object in its code (<i>TestT</i> should only &quot;know&quot; of (and be able to access) the &quot;global&quot; <i>tValue</i> array (defined by <i>ExampleComponent</i>))."}], "tags": [], "owner": {"reputation": 232, "user_id": 2024223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f396ec701ce567ae77b1a59ffe77218d?s=128&d=identicon&r=PG", "display_name": "user2024223", "link": "https://stackoverflow.com/users/2024223/user2024223"}, "is_accepted": false, "score": 0, "last_activity_date": 1500364471, "creation_date": 1500364471, "answer_id": 45160679, "question_id": 44291114, "link": "https://stackoverflow.com/questions/44291114/access-data-in-external-c-module-from-modelica-in-read-overwrite-mode/45160679#45160679", "title": "Access data in external C module from Modelica, in read/overwrite mode", "body": "<p>Would the following work for you?</p>\n\n<pre><code>package GlobalParameter\n  model ExampleComponent\n    outer parameter Real tValue[5];\n  end ExampleComponent;\n\n  model TestT\n    ExampleComponent component1;\n    ExampleComponent component2;\n    inner parameter Real tValue=1:5;\n  end TestT;\nend GlobalParameter;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 232, "user_id": 2024223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f396ec701ce567ae77b1a59ffe77218d?s=128&d=identicon&r=PG", "display_name": "user2024223", "link": "https://stackoverflow.com/users/2024223/user2024223"}, "is_accepted": false, "score": 0, "last_activity_date": 1501138829, "creation_date": 1501138829, "answer_id": 45343511, "question_id": 44291114, "link": "https://stackoverflow.com/questions/44291114/access-data-in-external-c-module-from-modelica-in-read-overwrite-mode/45343511#45343511", "title": "Access data in external C module from Modelica, in read/overwrite mode", "body": "<p>Ok how about this then:</p>\n\n<pre><code>package GlobalParameter\n\n  model SetTValue\n    outer Real tValue[5];\n    parameter Integer index;\n    parameter Real value;\n  equation \n    tValue[index] = value;\n  end SetTValue;\n\n  model TestT\n    SetTValue set1(index=1, value=1);\n    SetTValue set2(index=2, value=2);\n    SetTValue set3(index=3, value=3);\n    SetTValue set4(index=4, value=4);\n    SetTValue set5(index=5, value=5);\n\n    inner Real tValue[5];\n  end TestT;\nend GlobalParameter;\n</code></pre>\n\n<p>You do not need to make use of component# (where # is 1-5) but could just use them as a way to set elements of tValue.</p>\n\n<p>A disadvantage of this method is that the SetTValue model is not balanced also to set an index you need to create an instance of SetTValue.  However this approach avoids using external C code.</p>\n"}], "owner": {"reputation": 101, "user_id": 8092574, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f01001e621165d0d2b6dd4918208a4f2?s=128&d=identicon&r=PG&f=1", "display_name": "angusmax", "link": "https://stackoverflow.com/users/8092574/angusmax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1501138829, "creation_date": 1496251357, "question_id": 44291114, "link": "https://stackoverflow.com/questions/44291114/access-data-in-external-c-module-from-modelica-in-read-overwrite-mode", "title": "Access data in external C module from Modelica, in read/overwrite mode", "body": "<p>I'm developing a Modelica library, called \"<em>MyLib</em>\" (in the OpenModelica environment).</p>\n\n<p>I wrote the following external C module (\"<em>ExtTempDataLib.c</em>\"):</p>\n\n<pre><code>#ifndef __EXT_LIB_C\n#define __EXT_LIB_C\n\ndouble temperatures [] = {25, 18, 30, 21, 16};\n\ndouble GetTemperature(int index)\n{\n    // Modelica indexes start from 1\n    return temperatures[index - 1];\n}\n\nvoid SetTemperature(int index, double newTempVal)\n{\n    // Modelica indexes start from 1\n    temperatures[index - 1] = newTempVal;\n}\n\n#endif\n</code></pre>\n\n<p>It implements an array of numerical values (\"<em>temperatures</em>\") representing temperatures, which can be read/overwritten via the \"<em>GetTemperature(...)</em>\" and \"<em>SetTemperature(...)</em>\" functions.</p>\n\n<p>The goal is to provide to the Modelica library a set of <strong>global</strong> data (i.e. accessible by all models) that are <strong>not constant</strong>.</p>\n\n<p>Otherwise, I could simply declare the array as a constant inside my \"<em>MyData2</em>\" Modelica package:</p>\n\n<pre><code>constant Real temperatures [:] = {25, 18, 30, 21, 16};\n</code></pre>\n\n<p>and then directly access any of its elements (clearly in read-only mode) from any model by simply typing:</p>\n\n<pre><code>MyLib.MyData2.temperatures[index];\n</code></pre>\n\n<p>The \"<em>MyData</em>\" Modelica package:</p>\n\n<pre><code>within MyLib;\npackage MyData\n\nmodel SingleTemperatureOverwrite\n    parameter Integer index = 1 \"Temperature data index\";\n    parameter Real newVal = 50 \"New temperature value\";\nalgorithm \n    when initial() then\n        MyLib.MyData.SetTemperature(index, newVal);\n    end when;\nend SingleTemperatureOverwrite;\n\n\nfunction GetTemperature\n    input Integer index;\n    output Real temperature;    \n    external \"C\" temperature = GetTemperature(index);\n    annotation(Include = \"#include \\\"ExtTempDataLib.c\\\"\");  \nend GetTemperature;\n\n\nfunction SetTemperature\n    input Integer index;\n    input Real newTempVal;\n    external \"C\" SetTemperature(index, newTempVal);\n    annotation(Include = \"#include \\\"ExtTempDataLib.c\\\"\");\nend SetTemperature;\n\nend MyData;\n</code></pre>\n\n<p>defines:</p>\n\n<ul>\n<li>the \"<em>GetTemperature</em>\" and \"<em>SetTemperature</em>\" functions, which call the corresponding external C functions;</li>\n<li>the \"<em>SingleTemperatureOverwrite</em>\" model, which, at the initial time, overwrites the array value at the specified index with the specified new value (parameters \"<em>index</em>\" and \"<em>newVal</em>\", respectively).</li>\n</ul>\n\n<p>The \"<em>Test</em>\" Modelica package:</p>\n\n<pre><code>within MyLib;\npackage Test\n\nmodel TemperatureTest\n    parameter Integer index = 1 \"Temperature data index\";\n    Real temperature (start = 0) \"Temperature value\";\nequation\n    temperature = MyLib.MyData.GetTemperature(index);\nend TemperatureTest;\n\nend Test;\n</code></pre>\n\n<p>defines the \"<em>TemperatureTest</em>\" model, which reads the array value at the specified index (the \"<em>index</em>\" parameter) and \"copies\" it to the \"<em>temperature</em>\" variable.</p>\n\n<p>I created a Modelica test model, including just one instance of \"<em>SingleTemperatureOverwrite</em>\" and one of \"<em>TemperatureTest</em>\" (\"<em>singleTemperatureOverwrite1</em>\" and \"<em>temperatureTest1</em>\", respectively), leaving all parameters at their default value.</p>\n\n<p>The model compiles and executes correctly but, when I plot the \"<em>temperature</em>\" variable of \"<em>temperatureTest1</em>\", instead of getting \"50\", as I expected, I get \"25\" (i.e. the starting value of the first element of the array defined in the external C module).</p>\n\n<p>Can somebody please explain me what I'm doing wrong?</p>\n"}, {"tags": ["c", "arrays", "clion", "pointer-arithmetic"], "comments": [{"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 2, "creation_date": 1496250102, "post_id": 44290702, "comment_id": 75587926, "body": "It is printing whatever happens to be at that point in memory at that time. If you&#39;re doing something strange, why are you surprised to get a strange result?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 0, "creation_date": 1496250945, "post_id": 44290702, "comment_id": 75588466, "body": "@GradyPlayer While most of us will <i>get</i> the message, some of us may not (believe me, been there, seen that), better refrain from making those comments. Hope you got the part. :)"}, {"owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 1, "creation_date": 1496251337, "post_id": 44290702, "comment_id": 75588685, "body": "Well...That is undefined behavior for sure. Possible duplicate of <a href=\"https://stackoverflow.com/questions/10473573/why-is-out-of-bounds-pointer-arithmetic-undefined-behaviour\" title=\"why is out of bounds pointer arithmetic undefined behaviour\">stackoverflow.com/questions/10473573/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 4, "creation_date": 1496250702, "post_id": 44290740, "comment_id": 75588324, "body": "In this context I always feel a compulsion to point out that, while it is legal to form a pointer to one past the end of an array object, it is <i>not</i> legal to form a pointer to one before the beginning of an array object."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496252708, "post_id": 44290740, "comment_id": 75589431, "body": "@DavidBowling oh.. didn&#39;t know that.  I don&#39;t dispute it, but I have to ask, is there some reasoning behind that rule?  It would see to me that you could assemble any old pointer as long as you do nothing with it?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496253037, "post_id": 44290740, "comment_id": 75589616, "body": "@ThingyWotsit-- <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.6p8\" rel=\"nofollow noreferrer\">&quot;If both the pointer operand and the result point to elements of the same array object, or one past the last element of the array object, the evaluation shall not produce an overflow; otherwise, the behavior is undefined. If the result points one past the last element of the array object, it shall not be used as the operand of a unary * operator that is evaluated.</a> The &quot;otherwise... undefined&quot; part is crucial. This can come up when iterating an array in reverse. Going off the beginning may <i>seem</i> to &quot;work&quot;, but is UB."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 6, "last_activity_date": 1496251485, "last_edit_date": 1496251485, "creation_date": 1496250114, "answer_id": 44290740, "question_id": 44290702, "link": "https://stackoverflow.com/questions/44290702/pointer-arithmetic-with-one-past-array-element-and-then-dereference-what-will-b/44290740#44290740", "title": "Pointer arithmetic with one past array element and then dereference, what will be the outcome?", "body": "<p><strong>TL;DR:</strong> <em>Don't know, can't say.</em></p>\n\n<p>To elaborate, in your code</p>\n\n<pre><code>  printf(\"\\n*(meatBalls+5) \\t\\t %d \\n\", *(meatBalls+5));\n</code></pre>\n\n<p>causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">undefined behavior</a> as you try to <strong>access</strong> out of bound memory.</p>\n\n<p>Please note the emphasis on <strong>access</strong>. The pointer arithmetic in this case is well-defined (one past the last element), attempt to access in what causes the UB.</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a76.5.6 (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>[...] if the expression <code>P</code> points to the last\n  element of an array object, the expression <code>(P)+1</code> points one past the last element of the\n  array object, and if the expression <code>Q</code> points one past the last element of an array object,\n  the expression <code>(Q)-1</code> points to the last element of the array object. <strong>If both the pointer\n  operand and the result point to elements of the same array object, or one past the last\n  element of the array object, the evaluation shall not produce an overflow;</strong> otherwise, the\n  behavior is undefined. <strong>If the result points one past the last element of the array object, it\n  shall not be used as the operand of a unary <code>*</code> operator that is evaluated.</strong></p>\n</blockquote>\n\n<p>That said, <code>%p</code> expects its argument to be a <code>void*</code> and since <code>printf()</code> is a variadic function, no default argument promotion takes place. So, you need to cast all the arguments to <code>%p</code> to <code>(void *)</code></p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1496251134, "post_id": 44290744, "comment_id": 75588569, "body": "Isn&#39;t like in this case annex J.2 is out of context? That&#39;s normative, anyway."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 2, "last_activity_date": 1496250757, "last_edit_date": 1496250757, "creation_date": 1496250128, "answer_id": 44290744, "question_id": 44290702, "link": "https://stackoverflow.com/questions/44290702/pointer-arithmetic-with-one-past-array-element-and-then-dereference-what-will-b/44290744#44290744", "title": "Pointer arithmetic with one past array element and then dereference, what will be the outcome?", "body": "<p>Accessing elements beyond an array's bounds is undefined behaviour; so you can get any value, but your program could also crash. Here's how the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf\" rel=\"nofollow noreferrer\">C standard</a> defines undefined behaviour:</p>\n\n<blockquote>\n  <p>3.4.3 undefined behavior </p>\n  \n  <p>behavior, upon use of a nonportable or erroneous program construct or of erroneous data, for which this\n  International Standard imposes no requirements.</p>\n  \n  <p>NOTE: Possible undefined\n  behavior ranges from ignoring the situation completely with\n  unpredictable results, to behaving during translation or program\n  execution in a documented manner characteristic of the environment\n  (with or without the issuance of a diagnostic message), to terminating\n  a translation or execution (with the issuance of a diagnostic\n  message).</p>\n</blockquote>\n\n<p>And that's where the standard defines that your access is undefined behaviour:</p>\n\n<blockquote>\n  <p>J.2 Undefined behavior</p>\n  \n  <p>1 The behavior is undefined in the following circumstances:</p>\n  \n  <p>...</p>\n  \n  <ul>\n  <li>An array subscript is out of range, even if an object is apparently\n  accessible with the given subscript (as in the lvalue expression\n  a<a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf\" rel=\"nofollow noreferrer\">1</a>[7] given the declaration int a[4][5])</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 512, "user_id": 1816746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/079dff13a686c188ebd12e960ee4ec3e?s=128&d=identicon&r=PG", "display_name": "Wunderbread", "link": "https://stackoverflow.com/users/1816746/wunderbread"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 44290740, "answer_count": 2, "score": 1, "last_activity_date": 1496251485, "creation_date": 1496250003, "last_edit_date": 1496250388, "question_id": 44290702, "link": "https://stackoverflow.com/questions/44290702/pointer-arithmetic-with-one-past-array-element-and-then-dereference-what-will-b", "title": "Pointer arithmetic with one past array element and then dereference, what will be the outcome?", "body": "<p>If I dereference an array and add 5 which exceeds the elements available within the array what is the value that is printed? I am returning 32767 within my IDE which doesn't make much sense.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n\n    int i;\n    int meatBalls[5] = {1, 2, 3, 4, 5};\n\n    printf(\"%12s %18s %6s\\n\", \"Element\", \"Address\", \"Value\");\n\n    for(i=0; i &lt; 5; i++) {\n        printf(\"meatBalls[%d] \\t %p \\t %d \\n\", i, &amp;meatBalls[i], meatBalls[i]);\n    }\n\n    printf(\"\\nmeatBalls \\t\\t %p \\n\", meatBalls); /*already a pointer*/\n\n    /*dereference meatBalls and it will update to the value e.g. 1*/\n\n    printf(\"\\n*meatBalls \\t\\t %d \\n\", *meatBalls); /*dereference with asterisk*/\n\n    printf(\"\\n*(meatBalls+2) \\t\\t %d \\n\", *(meatBalls+2)); /*dereference but also go through the array from 0 + 2*/\n\n    printf(\"\\n*(meatBalls+4) \\t\\t %d \\n\", *(meatBalls+4));\n\n    printf(\"\\n*(meatBalls+5) \\t\\t %d \\n\", *(meatBalls+5)); /*what is the number that this returns?*/\n\n    return 0;\n}\n</code></pre>\n\n<p>This is the current output and has made me question the \"32767\":</p>\n\n<pre><code>     Element            Address  Value\nmeatBalls[0]     0x7fff5b714640      1 \nmeatBalls[1]     0x7fff5b714644      2 \nmeatBalls[2]     0x7fff5b714648      3 \nmeatBalls[3]     0x7fff5b71464c      4 \nmeatBalls[4]     0x7fff5b714650      5 \n\nmeatBalls        0x7fff5b714640 \n\n*meatBalls       1 \n\n*(meatBalls+2)       3 \n\n*(meatBalls+4)       5 \n\n*(meatBalls+5)       32767 \n</code></pre>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 684, "user_id": 6451802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-kAirbmmbfM0/AAAAAAAAAAI/AAAAAAAAACU/kuuL8JMyeQM/photo.jpg?sz=128", "display_name": "97amarnathk", "link": "https://stackoverflow.com/users/6451802/97amarnathk"}, "edited": false, "score": 1, "creation_date": 1496247848, "post_id": 44289995, "comment_id": 75586589, "body": "Make mask also a character."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1496248088, "post_id": 44289995, "comment_id": 75586715, "body": "I&#39;m not sure if I understand your question. That printf is called 5 times, and 5 characters are printed out."}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 1, "creation_date": 1496248209, "post_id": 44289995, "comment_id": 75586792, "body": "%c doesn&#39;t take only the last 4 bits. The problem is that when the mask becomes  16 (0x10) you or 1 with 1 (the character 48 is 0x30, with that bit already set)"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1496248374, "post_id": 44289995, "comment_id": 75586883, "body": "I have no idea why you are talking about 4 bits or what the problem is here. If you or 0x30 with 0x10 you get 0x30 which is <code>0</code> as is printed as the last character. There&#39;s nothing about four bits here. Could you clarify by asking a question?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1496248422, "post_id": 44289995, "comment_id": 75586924, "body": "It&#39;s undefined behavior.  Given <code>char c</code> and <code>int mask</code>, <code>c|mask</code> results in an <code>int</code>.  Calling <code>printf()</code> on an <code>int</code> with a <code>%c</code> format specifier results in undefined behavior."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1496249351, "post_id": 44289995, "comment_id": 75587467, "body": "@AndrewHenle No, the <code>%c</code> printf format specifier expects an <code>int</code>. There is no undefined behavior."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1496249365, "post_id": 44289995, "comment_id": 75587482, "body": "@AndrewHenle-- The <code>%c</code> conversion specifier expects an <code>int</code>: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.1p8\" rel=\"nofollow noreferrer\">&quot;If no l length modifier is present, the int argument is converted to an unsigned char, and the resulting character is written.&quot;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "reply_to_user": {"reputation": 25, "user_id": 7399616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yCUtYDhZ1FI/AAAAAAAAAAI/AAAAAAAAABg/HhK2hzAK3cY/photo.jpg?sz=128", "display_name": "D Andreea", "link": "https://stackoverflow.com/users/7399616/d-andreea"}, "edited": false, "score": 0, "creation_date": 1496248804, "post_id": 44290166, "comment_id": 75587135, "body": "Ok, pur \u0219i simplu prima dat\u0103 faci 48|1, care e 49. Apoi 48|2==50, apoi 48|4==52, apoi 48|3==56. Nimic special. &#206;ns\u0103 48|16==48, pentru c\u0103 al 5-lea bit de la dreapta e deja 1 \u0219i f\u0103c&#226;nd sau cu un alt 1 nu face nimic. (btw, we should keep it in English on this website/"}], "tags": [], "owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "is_accepted": false, "score": 0, "last_activity_date": 1496248269, "creation_date": 1496248269, "answer_id": 44290166, "question_id": 44289995, "link": "https://stackoverflow.com/questions/44289995/why-it-takes-only-the-last-4-bits-in-my-following-example/44290166#44290166", "title": "Why it takes only the last 4 bits in my following example?", "body": "<p>It takes them all, however the last time around you or that 1 with a bit that already is 1 (48 is 110000 in binary)</p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1496248274, "creation_date": 1496248274, "answer_id": 44290168, "question_id": 44289995, "link": "https://stackoverflow.com/questions/44289995/why-it-takes-only-the-last-4-bits-in-my-following-example/44290168#44290168", "title": "Why it takes only the last 4 bits in my following example?", "body": "<p>Character code 48 is usually <code>0</code>. When it's or'd with one, it prints digit 1.  Then it prints the digits 2, 4, 8. Finally, 48|16 = 48, so it prints 0.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1496248342, "creation_date": 1496248342, "answer_id": 44290190, "question_id": 44289995, "link": "https://stackoverflow.com/questions/44289995/why-it-takes-only-the-last-4-bits-in-my-following-example/44290190#44290190", "title": "Why it takes only the last 4 bits in my following example?", "body": "<p>Let's look at the binary representation of 48:</p>\n\n<pre><code>2^ 7 6 5 4 3 2 1 0\n   ---------------\n   0 0 1 1 0 0 0 0\n</code></pre>\n\n<p>The last 4 bits are not set.  On the first 4 iterations of the loop, the mask sets one of those bits in the result, and the result reflects the change.  On the last iteration, the mask is setting a bit which is already set, so there is no change for the last character printed.</p>\n\n<p>As for what is being printed, in ASCII 48 is the character code for <code>0</code>.  The following digits are in order after that one.  When you mask in the values for the first 4 iterations, because none of the bits in the value 48 are set in the mask, it is effectively the same as adding.  So the first 4 characters printed have ASCII values 49 (<code>1</code>), 50 (<code>2</code>), 52 (<code>4</code>), and 56 (<code>8</code>).  </p>\n"}], "owner": {"reputation": 25, "user_id": 7399616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yCUtYDhZ1FI/AAAAAAAAAAI/AAAAAAAAABg/HhK2hzAK3cY/photo.jpg?sz=128", "display_name": "D Andreea", "link": "https://stackoverflow.com/users/7399616/d-andreea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 44290190, "answer_count": 3, "score": 0, "last_activity_date": 1496248459, "creation_date": 1496247744, "question_id": 44289995, "link": "https://stackoverflow.com/questions/44289995/why-it-takes-only-the-last-4-bits-in-my-following-example", "title": "Why it takes only the last 4 bits in my following example?", "body": "<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n   char c=48;\n   int i, mask=01;\n\n   for(i=1; i&lt;=5; i++)\n   {\n       printf(\"%c\", c|mask);\n       mask = mask&lt;&lt;1;\n   }\n   return 0;\n}\n</code></pre>\n\n<p>I am learning for an exam, and this was a solved exercise with the answer: 12480 because %c takes only the last 4 bits. I don't understand why, as I know that sizeof char is 1 byte.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 0, "creation_date": 1496247850, "post_id": 44289896, "comment_id": 75586593, "body": "Okay, so what is the problem with your code? Why it does not work? How can random points create a square?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1496248883, "post_id": 44289896, "comment_id": 75587189, "body": "Well, for one, your thread proc has only one conditional <code>return</code> option. Unless that path is taken you don&#39;t return <i>anything</i>, and effectively make a liar out of that <code>void*</code> you claim your function returns. From that, <code>(void*)&amp;npontos_circulo</code> as the receiver of the phantom return result from your thread function will only get two possible outcomes (1) NULL, and (2) <i>undefined behavior</i>. <i>Neither</i> of those would be good candidates to dereference. Study more about how to pass data in/out of thread routine, and for all that is good in this world, <i>turn up your compiler warnings</i>."}, {"owner": {"reputation": 794, "user_id": 1328157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LwvtP.jpg?s=128&g=1", "display_name": "nachiketkulk", "link": "https://stackoverflow.com/users/1328157/nachiketkulk"}, "edited": false, "score": 0, "creation_date": 1496250768, "post_id": 44289896, "comment_id": 75588367, "body": "Have you tried debugging this code?"}], "owner": {"reputation": 13, "user_id": 8093157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca810d9f91913305f55b0086d825059?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8093157/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496247736, "creation_date": 1496247458, "last_edit_date": 1496247736, "question_id": 44289896, "link": "https://stackoverflow.com/questions/44289896/segmentation-fault-recorded-nucleus-image", "title": "Segmentation fault ( Recorded nucleus image)", "body": "<p>This is my project from shcool and i have this error and cant figure it out! if you can help i really appreciate!\nThis code is supposed to create an image of a circle with random points inside creating a square! i think i need to solve this with malloc but i cant understand how!</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n//Fun\u00e7\u00e3o que calcula o pi\n\nvoid*calc_pi(void*parameters)\n{\n    //inicializa\u00e7\u00e3o das variaveis\n\n    double npoints=100000000;\n    double x,y;\n    int i, circle_count=0;\n    double D; //diametro do circulo\n    double pi;\n\n    for (i=0; i &lt; npoints; i++)\n    {\n    x=(double)abs(rand())/RAND_MAX;\n    y=(double)abs(rand())/RAND_MAX;\n    D=sqrt(pow((x-0.5),2)+pow((y-0.5),2));\n\n\n    //confirmar pontos dentro do circulo \n\n        if (D&lt;=0.5)\n        {\n\n\n        pi=(double)4*circle_count/npoints;\n        printf(\"pi=%f\\n\",pi);\n        circle_count++;\n        return NULL;\n        }\n\n    }\n\n}\n\n\nint main()\n\n{\n    //iniciar variaveis \n    enter code here\n    double npoints=100000000;\n    double x,y;\n    int circle_count=0;\n    int i = 0 ;\n    double D;\n    double pi;\n    int numerothreads=5;\n    int numpontoscirculo;\n    double*npontos_circulo;\n    double oi=npoints/numerothreads;\n\n    //id da thread\n\n    pthread_t thread_id;\n\n    //criar uma thread que vai correr a funcao calc_pi\n    pthread_create(&amp;thread_id, NULL, &amp;calc_pi,&amp;oi);\n\n\n    //fazer fun\u00e7ao join para receber os dados threads, criar fun\u00e7ao join para cada thread\n\n    pthread_join(thread_id,(void*)&amp;npontos_circulo);\n    printf(\"O numero de pontos dentro do circulo:\\n\");\n//fazer um ciclo para chamar as threads\n\n\n    for(i=0;i&lt;5;i++)\n    {\n    printf(\"%lf\\n\",*(npontos_circulo+i));\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "answers": [{"comments": [{"owner": {"reputation": 1927, "user_id": 953419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f79e690bef0b6c98676b5751056e0a1?s=128&d=identicon&r=PG", "display_name": "seamus", "link": "https://stackoverflow.com/users/953419/seamus"}, "edited": false, "score": 1, "creation_date": 1496247086, "post_id": 44289746, "comment_id": 75586131, "body": "Love you (7 more characters)"}], "tags": [], "owner": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "is_accepted": true, "score": 3, "last_activity_date": 1496247041, "creation_date": 1496247041, "answer_id": 44289746, "question_id": 44289689, "link": "https://stackoverflow.com/questions/44289689/for-loop-not-recognizing-special-characters-inside-an-array-as-single-chars/44289746#44289746", "title": "For loop not recognizing special characters inside an array as single chars", "body": "<p>You probably meant to use a backward slash to represent the special characters:</p>\n\n<pre><code>\\0\n\\n\n</code></pre>\n\n<p>The forward slash does not make it a escape sequence, <code>/0</code> are two characters.</p>\n"}], "owner": {"reputation": 1927, "user_id": 953419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f79e690bef0b6c98676b5751056e0a1?s=128&d=identicon&r=PG", "display_name": "seamus", "link": "https://stackoverflow.com/users/953419/seamus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 44289746, "answer_count": 1, "score": -1, "last_activity_date": 1496247052, "creation_date": 1496246904, "question_id": 44289689, "link": "https://stackoverflow.com/questions/44289689/for-loop-not-recognizing-special-characters-inside-an-array-as-single-chars", "title": "For loop not recognizing special characters inside an array as single chars", "body": "<p>The below code is not finding '/n' and replacing with '/0'. Looks like the compiler thinks '/n' and '/0' are more than single characters and are expecting integer values. I have tried atoi(), however this did not work.</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>for (i=0; i&lt;sizeof(filename); i++){\n    if (filename[i] == ('/n')) {\n        filename[i]= ('/0');\n        break;\n    }\n}\n\ncreatebn.c:35:21: warning: multi-character character constant [-Wmultichar]\n                                    ^\ncreatebn.c:35:21: warning: incompatible integer to pointer conversion passing\n  'int' to parameter of type 'const char *' [-Wint-conversion]\n</code></pre>\n\n<p>On a modern mac, gcc compiler.</p>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1496246834, "post_id": 44289543, "comment_id": 75585977, "body": "You might as well read the anual page for <code>scanf</code> - Google it EDIT Here is it <a href=\"https://linux.die.net/man/3/scanf\" rel=\"nofollow noreferrer\">linux.die.net/man/3/scanf</a>"}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1496246906, "post_id": 44289543, "comment_id": 75586020, "body": "Space and new-line are the same: it separates the numbers. You might try TAB, as well. They are called &quot;white-space&quot;."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1496246959, "post_id": 44289543, "comment_id": 75586058, "body": "<code>%d</code> of <code>scanf</code>  works as expected as it skips the previous white-space characters."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496247780, "post_id": 44289543, "comment_id": 75586548, "body": "The scanf family of functions does not deal in lines. A single call to scanf does not read a line. A single call to scanf may read part of a line, or it may read many lines."}, {"owner": {"reputation": 3577, "user_id": 2176813, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Nv7lK.jpg?s=128&g=1", "display_name": "tambre", "link": "https://stackoverflow.com/users/2176813/tambre"}, "edited": false, "score": 0, "creation_date": 1496248624, "post_id": 44289543, "comment_id": 75587045, "body": "Please don&#39;t tag as C++, unless your code is actually C++. C and C++ are very different languages these days."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496248810, "post_id": 44289543, "comment_id": 75587140, "body": "&quot; I write suppose - 5 8 9 10 7 6 - then the program understands it &quot;  --&gt; What did you expect to happen?"}, {"owner": {"reputation": 139, "user_id": 8093027, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WfknCnSdk2A/AAAAAAAAAAI/AAAAAAAAAHw/uUb55OOxf5U/photo.jpg?sz=128", "display_name": "Ali Hasan", "link": "https://stackoverflow.com/users/8093027/ali-hasan"}, "edited": false, "score": 0, "creation_date": 1496249799, "post_id": 44289543, "comment_id": 75587760, "body": "The thing is that how the program understands the row of numbers as different numbers that too on the execution of different statements. It just not takes this as different integers, it executes a statement with a digit of the row &amp; then on the execution of the next statement it takes the next digit from the same row. The way how the whitespace - space, tab is understood is confusing. I was expecting an error instead of an output. Please recommend a page, article or maybe a book to understand the behavior of scanf."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496250335, "post_id": 44289543, "comment_id": 75588082, "body": "@AliHasan &quot;Please recommend a page, &quot;  --&gt; that was all ready provided on the first <a href=\"https://stackoverflow.com/questions/44289543/understanding-scanf-behaviour/44290563#comment75585977_44289543\">comment</a>.  IAC, SO is not a good place for general recommendations about learning a language, but good for specific problems."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496250646, "post_id": 44289543, "comment_id": 75588292, "body": "@AliHasan To be clear: <code>scanf(&quot;%d&quot;,&amp;number);</code> does <b>not</b> read a <i>line</i> of user input.  It reads  white-space then integer numeric text until something non-numeric is found."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496251987, "post_id": 44289543, "comment_id": 75589044, "body": "If you want to read about the <code>fscanf()</code> family of functions, <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.2\" rel=\"nofollow noreferrer\">best to go to straight to the source</a> and read about them in the Standard. If you need a good book about C basics, <a href=\"https://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">here is a list of C books maintained on SO</a>."}], "answers": [{"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1496247100, "post_id": 44289722, "comment_id": 75586138, "body": "%d does not read a <i>number</i> - It reads signed decimal integer. i.e. not a float, not hex...."}, {"owner": {"reputation": 2045, "user_id": 1077785, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/7131b485716736485a3d7a2e13846786?s=128&d=identicon&r=PG", "display_name": "Tomaz Canabrava", "link": "https://stackoverflow.com/users/1077785/tomaz-canabrava"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1496247516, "post_id": 44289722, "comment_id": 75586378, "body": "and that, for anyone starting on computers and programming is a number. let&#39;s not get too techical and confuse the newcomer."}], "tags": [], "owner": {"reputation": 2045, "user_id": 1077785, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/7131b485716736485a3d7a2e13846786?s=128&d=identicon&r=PG", "display_name": "Tomaz Canabrava", "link": "https://stackoverflow.com/users/1077785/tomaz-canabrava"}, "is_accepted": false, "score": 0, "last_activity_date": 1496246981, "creation_date": 1496246981, "answer_id": 44289722, "question_id": 44289543, "link": "https://stackoverflow.com/questions/44289543/understanding-scanf-behaviour/44289722#44289722", "title": "Understanding scanf behaviour", "body": "<p>when you press the keyboard, you are filling a buffer on your computer. the scanf will read the amount of consecutive data untill it hit a space, so \"1234    43\", on the code scanf(\"%d\") you are saying \"read <em>one</em> number\", and 1234 is <em>one</em> number, that's what it will read.</p>\n\n<p>But if you have a loop that will execute that scanf again, the number \"43\" is currently in the reading buffer, and scanf will read it without stopping.</p>\n\n<p>The manual for scanf doesn't explains that and it's a bit confusing for a newcomer to understand why the application is not stopping there to read a new number.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1496248659, "post_id": 44289754, "comment_id": 75587067, "body": "&quot;while separating inputs by an empty character&quot; --&gt; not quite.  Consider <code>&quot;4 23+67-21+99\\n&quot;</code>"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496248823, "post_id": 44289754, "comment_id": 75587150, "body": "@chux Perhaps it was a bit ambiguous, but I was explaining the specific problem the OP has, not the general workings of scanf. Otherwise you are correct."}], "tags": [], "owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "is_accepted": false, "score": 0, "last_activity_date": 1496247054, "creation_date": 1496247054, "answer_id": 44289754, "question_id": 44289543, "link": "https://stackoverflow.com/questions/44289543/understanding-scanf-behaviour/44289754#44289754", "title": "Understanding scanf behaviour", "body": "<p>Let me explain as simply as possible...</p>\n\n<p><code>scanf</code> reads bytes from the standard input stream <code>stdin</code>. </p>\n\n<p>Let's say the input you give is <code>\"23 67 21 99\\n\"</code> <em>(The \\n is from when you pressed Enter)</em>.</p>\n\n<p>Then each next call to <code>scanf</code> will start reading from this input buffer and it will interpret what is sees as whatever you tell it (<code>\"%d\"</code>, etc) while <em>separating inputs by an empty character</em>. This could be a new line, a space, a tab, etc. </p>\n\n<p>While there are still bytes to be read, <code>scanf</code> will <em>not</em> wait for you to input. That is what is happening here.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1496250033, "last_edit_date": 1496250033, "creation_date": 1496249555, "answer_id": 44290563, "question_id": 44289543, "link": "https://stackoverflow.com/questions/44289543/understanding-scanf-behaviour/44290563#44290563", "title": "Understanding scanf behaviour", "body": "<p>The <code>\"%d\"</code> in <code>scanf(\"%d\",&amp;number);</code> causes has 3 stages of scanning user text input into an <code>int</code>.</p>\n\n<ol>\n<li><p>0 or more leading whites-space, like <code>' '</code>, <code>'\\n'</code>, <code>'\\t'</code> and some others are read and discarded.</p></li>\n<li><p>Numeric text like <code>\"123\"</code>, <code>\"-123\"</code>, <code>\"+123\"</code> is read until until a non-numeric character is read.  (or end-of-file, or a rare input error).</p></li>\n<li><p>That non-numeric character is put back into <code>stdin</code> for subsequent input calls.</p></li>\n</ol>\n\n<p>If step 2 is successful in reading at least 1 digit, the function returns 1.  Good code checks the returned value.</p>\n\n<pre><code>if (scanf(\"%d\",&amp;number) != 1) Handle_UnexpectedInput();\n</code></pre>\n\n<p>The important thing is that <code>'\\n'</code> is not so special with <code>scanf(\"%d\",&amp;number);</code>.  It acts like a separator like another white-space or non-numeric text.  </p>\n\n<p><code>'\\n'</code> does cause the buffered <code>stdin</code> to accept the <em>line</em> of user input for processing by the various <code>scanf()</code> calls.</p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 8093027, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WfknCnSdk2A/AAAAAAAAAAI/AAAAAAAAAHw/uUb55OOxf5U/photo.jpg?sz=128", "display_name": "Ali Hasan", "link": "https://stackoverflow.com/users/8093027/ali-hasan"}, "edited": false, "score": 0, "creation_date": 1496250245, "post_id": 44290581, "comment_id": 75588023, "body": "This was helpful. But the way how the program goes back to the row of integers (with spaces) as program further executes is confusing. Like from the row 2 3 4 5 6 7 8 it will first take the digit 2, run a statement then for next statement it will take 3 from user execute it and then for next statement it will take 4 and execute it and so on... What my issue is why not an error. I may sound ridiculous. Can you please recommend me a book for basics of C to clear doubts like this. The behavior of scanf."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8084691"}, "reply_to_user": {"reputation": 139, "user_id": 8093027, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WfknCnSdk2A/AAAAAAAAAAI/AAAAAAAAAHw/uUb55OOxf5U/photo.jpg?sz=128", "display_name": "Ali Hasan", "link": "https://stackoverflow.com/users/8093027/ali-hasan"}, "edited": false, "score": 0, "creation_date": 1496250922, "post_id": 44290581, "comment_id": 75588459, "body": "<b>for(i=1; i&lt;n; i++)</b>   //loop starts        {            <b>scanf(&quot;%d&quot;, &amp;number);</b> // you enter a number            <b>if(number&gt;max)</b>    // if that number is greater than max,                 <b>max=number;</b>   /*then, max is now same as that number... But if number is less than max, if will not execute and max will still be the previously stored number. */ since this is in the loop, after this again the scanf will be called and all this code in this {...} will repeat. Scanf doesn&#39;t read the numbers from beginning everytime, the magic is in &#39;if&#39; condition.        }"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8084691"}, "is_accepted": false, "score": 0, "last_activity_date": 1496249620, "creation_date": 1496249620, "answer_id": 44290581, "question_id": 44289543, "link": "https://stackoverflow.com/questions/44289543/understanding-scanf-behaviour/44290581#44290581", "title": "Understanding scanf behaviour", "body": "<p>let's keep it simple. I assume you don't know anything about buffer or stdin.\nscanf is used to take input from user. Whenever you type a number and press 'space' or ' enter' on keyboard the number is entered into program for further purposes. When you type <strong>scanf(\"%d\",&amp;n);</strong> it mean take <strong>integer</strong> input from the user and <strong>store</strong> it on the address of <strong>variable n</strong>.</p>\n"}, {"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1496252485, "post_id": 44291223, "comment_id": 75589300, "body": "At the risk of complicating things, initial whitespace characters are not skipped over for the <code>%c</code>, <code>%n</code>, or <code>%[]</code> specifiers; this sometimes causes beginners trouble when a newline has been left behind in the input stream. Also, the first non-matching character is left in the input stream, often leading to problems for later calls to I/O functions."}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496252613, "post_id": 44291223, "comment_id": 75589369, "body": "@DavidBowling You&#39;re right but I am afraid that I have already made things complicated."}], "tags": [], "owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "is_accepted": false, "score": 1, "last_activity_date": 1496251749, "creation_date": 1496251749, "answer_id": 44291223, "question_id": 44289543, "link": "https://stackoverflow.com/questions/44289543/understanding-scanf-behaviour/44291223#44291223", "title": "Understanding scanf behaviour", "body": "<p>Here it is simplified explanation (not overly simplified, I hope) on how <code>scanf</code> works from a user point of view:</p>\n\n<p>The arguments are divided in two parts:</p>\n\n<ol>\n<li><p>The first part is a \u201cformat string\u201d. The string is made of at least\none format specifier. In its simplest form a specifier begins with\n<code>%</code> and it is followed by a letter that specifies the type of\nvariable you\u2019re expecting (<code>\u201c%d\u201d</code> \u2013 I\u2019m expecting an integer). The\nnumber of specifiers <strong>must</strong> match the number of parameters and types\nin the second part.</p></li>\n<li><p>The second part is made of one or more addresses to locations memory\nwhere the data you input will be stored. The pointed types <strong>must</strong>\nmatch the specifiers.</p></li>\n</ol>\n\n<p>When called, the function will repeat the following steps, starting with the first specifier and the first pointer, until the end of format string is detected:</p>\n\n<ol>\n<li>Read and discard any white-space until a non-white-space character is found (white-space: space, tab, NL, at least);</li>\n<li>Read characters up to first white-space or a character that do not match the expected input for current specifier;</li>\n<li>Convert them to the type of current specifier and</li>\n<li>Store the result in the location pointed by the current pointer. </li>\n</ol>\n\n<p>There are three typical <strong>beginner mistakes</strong> which will result in undefined behavior (crash, most likely):</p>\n\n<ol>\n<li>You forget the address-of operator <code>&amp;</code>.</li>\n<li>The specifier and the type do not match.</li>\n<li>The number of specifiers do not match the number of pointers.</li>\n</ol>\n\n<p><b></b></p>\n\n<pre><code>  int d;\n  scanf( \"%d\", d ); // no &amp;\n  scanf_s( \"%s\", &amp;d ); // s do not match int\n  scanf_s( \"%d%d\", &amp;d ); // too many specifiers\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1496254190, "creation_date": 1496254190, "answer_id": 44291901, "question_id": 44289543, "link": "https://stackoverflow.com/questions/44289543/understanding-scanf-behaviour/44291901#44291901", "title": "Understanding scanf behaviour", "body": "<p><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">From the horse's mouth</a>:</p>\n\n<blockquote>\n<strong>7.21.6.2 The fscanf function</strong><br>\n...<br>7&nbsp;&nbsp;&nbsp;&nbsp;A directive that is a conversion specification defines a set of matching input sequences, as\ndescribed below for each specifier. A conversion specification is executed in the\nfollowing steps:<br><br>\n8&nbsp;&nbsp;&nbsp;&nbsp;Input white-space characters (as specified by the <strong>isspace</strong> function) are skipped, unless\nthe specification includes a <strong>[</strong>, <strong>c</strong>, or <strong>n</strong> specifier.<sup>284)</sup><br><br>\n9&nbsp;&nbsp;&nbsp;&nbsp;An input item is read from the stream, unless the specification includes an <strong>n</strong> specifier. An\ninput item is defined as the longest sequence of input characters which does not exceed\nany specified field width and which is, or is a prefix of, a matching input sequence.<sup>285)</sup>\nThe first character, if any, after the input item remains unread. If the length of the input\nitem is zero, the execution of the directive fails; this condition is a matching failure unless\nend-of-file, an encoding error, or a read error prevented input from the stream, in which\ncase it is an input failure.<br><br>\n10&nbsp;&nbsp;&nbsp;&nbsp;Except in the case of a <strong>%</strong> specifier, the input item (or, in the case of a <strong>%n</strong> directive, the\ncount of input characters) is converted to a type appropriate to the conversion specifier. If\nthe input item is not a matching sequence, the execution of the directive fails: this\ncondition is a matching failure. Unless assignment suppression was indicated by a <strong>*</strong>, the\nresult of the conversion is placed in the object pointed to by the first argument following\nthe format argument that has not already received a conversion result. If this object\ndoes not have an appropriate type, or if the result of the conversion cannot be represented\nin the object, the behavior is undefined.<br>\n...<br>\n12&nbsp;&nbsp;&nbsp;&nbsp;The conversion specifiers and their meanings are:<br><br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>d</strong>&nbsp;&nbsp;&nbsp;&nbsp;Matches an optionally signed decimal integer, whose format is the same as<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expected for the subject sequence of the <strong>strtol</strong> function with the value 10\nfor<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the base argument. The corresponding argument shall be a pointer to\nsigned integer.<br>\n...\n<hr>\n<sup>\n284) These white-space characters are not counted against a specified field width.<br><br>\n285) <strong>fscanf</strong> pushes back at most one input character onto the input stream. Therefore, some sequences\nthat are acceptable to <strong>strtod</strong>, <strong>strtol</strong>, etc., are unacceptable to <strong>fscanf</strong>.\n</sup>\n</blockquote>\n\n<p>The processing for <code>scanf</code> is exactly the same; the only difference is that <code>scanf</code> always reads from standard input.</p>\n\n<p>Examples:</p>\n\n<p>Suppose you type <kbd>Space</kbd><kbd>Space</kbd><kbd>Space</kbd><kbd>1</kbd><kbd>2</kbd><kbd>3</kbd><kbd>Enter</kbd> in response to the first prompt; the input stream then contains the sequence <code>{' ', ' ', ' ', '1', '2', '3', '\\n'}</code>. When you call <code>scanf( \"%d\", &amp;n );</code>, <code>scanf</code> reads and discards the leading blank spaces, then reads and matches the sequence <code>{'1', '2', '3'}</code>, converts it to the integer value <code>123</code>, and assigns the result to <code>n</code>.  Since there was a successful conversion and assignment, <code>scanf</code> returns 1.  </p>\n\n<p>If the input stream contains the sequence <code>{' ', ' ', ' ', '1', '2', '.', '3', '\\n'}</code>, <code>scanf</code> reads and discards the leading blanks, then reads and matches the sequence <code>{'1', '2'}</code>, converts it to the integer value <code>12</code>, and assigns the result to <code>n</code>.  The input stream will still contain <code>{'.', '3', '\\n'}</code>.  Since there was a successful conversion and assignment, <code>scanf</code> will return 1.</p>\n\n<p>If the input stream contains the sequence <code>{'.', '3', '\\n'}</code>, then there is no matching sequence of characters (<code>'.'</code> is not a valid character in a decimal integer).  <code>scanf</code> will leave the <code>.</code> unread and leave the value of <code>n</code> unchanged.  Since there was not a successful conversion and assignment, <code>scanf</code> returns 0 to indicate a <em>matching failure</em>.  </p>\n\n<p>If an end-of-file is signaled on the input stream before any matching characters have been read, or if there's some other input error, <code>scanf</code> does not assign any new value to <code>n</code> and returns <code>EOF</code> to indicate an <em>input failure</em>.  </p>\n"}], "owner": {"reputation": 139, "user_id": 8093027, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WfknCnSdk2A/AAAAAAAAAAI/AAAAAAAAAHw/uUb55OOxf5U/photo.jpg?sz=128", "display_name": "Ali Hasan", "link": "https://stackoverflow.com/users/8093027/ali-hasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 861, "favorite_count": 1, "accepted_answer_id": 44291901, "answer_count": 6, "score": 0, "last_activity_date": 1496257419, "creation_date": 1496246493, "last_edit_date": 1496257419, "question_id": 44289543, "link": "https://stackoverflow.com/questions/44289543/understanding-scanf-behaviour", "title": "Understanding scanf behaviour", "body": "<p>I am very new to C programming. My sir gave this code to find the maximum of n numbers. When I do as Sir says things are perfect i.e Write a number when the line - Type the number of numbers and write numbers in a row like 7 8 9 10 when Type the numbers pop up. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nmain()\n{\n    int n, max, number, i;\n    printf(\"Type the number of numbers\");\n    scanf(\"%d\", &amp;n);\n    if(n&gt;0)\n    {\n        printf(\"Type the numbers\");\n        scanf(\"%d\",&amp;number);\n        max=number;\n        for(i=1; i&lt;n; i++)\n        {\n            scanf(\"%d\", &amp;number);\n            if(number&gt;max)\n                max=number;\n        }\n        printf(\"MAX=%d \\n\", max);\n    }\n}\n</code></pre>\n\n<p>But if I write suppose - 5 8 9 10 7 6 - then the program understands it like --\nIt puts n = 5 then puts number = 8 then loop executes number changes to 9 then number changes to 10 till 6 and then gves max.</p>\n\n<p>So how is <strong><em>scanf</em></strong> working here? It takes digit individually although they are written in a row with spaces?</p>\n"}, {"tags": ["c", "linux", "elf"], "comments": [{"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1496249158, "post_id": 44289501, "comment_id": 75587346, "body": "Isn&#39;t <code>sh_offset</code> the offset of the section in the file? Add it to the offset of the symbol in the section and you should get it."}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "edited": false, "score": 0, "creation_date": 1496372559, "post_id": 44289501, "comment_id": 75645470, "body": "<code>sh_table</code> is <code>malloc</code>ed in <code>main</code>, never initialized, and then used in <code>print_item</code>. Either you are not showing the entire program, or your program <i>doesn&#39;t work at all</i>. Indeed the program can&#39;t possibly compile. Please edit your question with <i>real</i> code, not vague and incomplete rendition of it."}], "answers": [{"tags": [], "owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "is_accepted": false, "score": 2, "last_activity_date": 1496442847, "creation_date": 1496442847, "answer_id": 44338313, "question_id": 44289501, "link": "https://stackoverflow.com/questions/44289501/extracting-string-from-elf-section-in-c/44338313#44338313", "title": "Extracting string from ELF section in C", "body": "<p>Before we can get to your question, there are several issues with your code:</p>\n\n<ol>\n<li>There are no includes.</li>\n<li><code>fread(elf_header,...</code> should be <code>fread(&amp;elf_header,...</code>.</li>\n<li><code>sh_table</code> is never read from the ELF file.</li>\n</ol>\n\n<p>Once those are fixed, the string data in the <code>.mydata</code> section can be read by copying <code>sh_table[i].sh_size</code> bytes of data from <code>sh_table[i].sh_offset</code> in the ELF file, where <code>i</code> is the index of the <code>.mydata</code> section.</p>\n\n<p>Here is the working code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;elf.h&gt;\n#include &lt;string.h&gt;\n\nvoid print_item(FILE* fd, Elf64_Ehdr eh, Elf64_Shdr sh_table[])\n{\n    int i;\n    char* sh_str;\n    char* buff;\n\n    buff = malloc(sh_table[eh.e_shstrndx].sh_size);\n\n    if(buff != NULL)\n    {\n        fseek(fd, sh_table[eh.e_shstrndx].sh_offset, SEEK_SET);\n        fread(buff, 1, sh_table[eh.e_shstrndx].sh_size, fd);\n    }\n    sh_str = buff;\n\n    for(i=0; i&lt;eh.e_shnum; i++)\n    {\n        if(!strcmp(\".mydata\", (sh_str + sh_table[i].sh_name)))\n        {\n            printf(\"Found section\\t\\\".mydata\\\"\\n\");\n            printf(\"at offset\\t0x%08x\\n\", (unsigned int)sh_table[i].sh_offset);\n            printf(\"of size\\t\\t0x%08x\\n\", (unsigned int)sh_table[i].sh_size);\n            break;\n        }\n    }\n\n    /*Code to print or store string data*/\n    if (i &lt; eh.e_shnum) {\n        char *mydata = malloc(sh_table[i].sh_size);\n        fseek(fd, sh_table[i].sh_offset, SEEK_SET);\n        fread(mydata, 1, sh_table[i].sh_size, fd);\n        puts(mydata);\n    } else {\n        // .mydata section not found\n    }\n\n}\n\nint main()\n{\n    FILE* fp = NULL; //Pointer used to access current file\n    char* program_name;\n    Elf64_Ehdr elf_header; //Elf header\n    Elf64_Shdr* sh_table; //Elf symbol table\n\n    program_name = \"/home/Testing/TEST\";\n    fp = fopen(program_name, \"r\");\n\n    fseek(fp, 0, SEEK_SET);\n    fread(&amp;elf_header, 1, sizeof(Elf64_Ehdr), fp);\n    sh_table = malloc(elf_header.e_shentsize*elf_header.e_shnum);\n\n    fseek(fp, elf_header.e_shoff, SEEK_SET);\n    fread(sh_table, 1, elf_header.e_shentsize*elf_header.e_shnum, fp);\n\n    print_item(fp, elf_header, sh_table);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8089928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/609faf4e17970badb7bd3f6a21959204?s=128&d=identicon&r=PG&f=1", "display_name": "dsmish", "link": "https://stackoverflow.com/users/8089928/dsmish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2286, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496442847, "creation_date": 1496246375, "question_id": 44289501, "link": "https://stackoverflow.com/questions/44289501/extracting-string-from-elf-section-in-c", "title": "Extracting string from ELF section in C", "body": "<p>I have created a new ELF section and added a line of text into it. I did this following the example seen here: <a href=\"https://stackoverflow.com/questions/1088128/adding-section-to-elf-file\">Adding section to ELF file</a>. I created a section called \".mydata\" and placed the string \"mydata saved string\" into it. I am trying to match the functionality of doing the following in the command in C:</p>\n\n<pre><code>$ readelf -p .mydata TEST\nString dump of section '.mydata':\n  [     0]    mydata saved string\n</code></pre>\n\n<p>I can find the section offset and the size of the section with the code</p>\n\n<pre><code>void print_item(FILE* fd, Elf64_Ehdr eh, Elf64_Shdr sh_table[])\n{\n    int i;\n    char* sh_str;\n    char* buff;\n\n    buff = malloc(sh_table[eh.e_shstrndx].sh_size);\n\n    if(buff != NULL)\n    {\n        fseek(fd, sh_table[eh.e_shstrndx].sh_offset, SEEK_SET);\n        fread(buff, 1, sh_table[eh.e_shstrndx].sh_size, fd);\n    }\n    sh_str = buff;\n\n    for(i=0; i&lt;eh.e_shnum; i++)\n    {\n        if(!strcmp(\".mydata\", (sh_str + sh_table[i].sh_name)))\n        {\n            printf(\"Found section\\t\\\".mydata\\\"\\n\");\n            printf(\"at offset\\t0x%08x\\n\", (unsigned int)sh_table[i].sh_offset);\n            printf(\"of size\\t\\t0x%08x\\n\", (unsigned int)sh_table[i].sh_size);\n            break;\n        }\n    }\n\n/*Code to print or store string data*/\n}\n\nint main()\n{\n    FILE* fp = NULL; //Pointer used to access current file\n    char* program_name;\n    Elf64_Ehdr elf_header; //Elf header\n    Elf64_Shdr* sh_table; //Elf symbol table\n\n    program_name = \"/home/Testing/TEST\";\n    fp = fopen(program_name, \"r\");\n\n    fseek(fp, 0, SEEK_SET);\n    fread(elf_header, 1, sizeof(Elf64_Ehdr), fp);\n    sh_table = malloc(elf_header.e_shentsize*elf_header.e_shnum);\n\n    print_item(fp, elf_header, sh_table);\n\n    return 0;\n}\n</code></pre>\n\n<p>Now that I have location, I am not sure the proper way to extract the string from the location. None of the ELF Section Header table entries (i.e. sh_name, sh_type ...) seem to be relevant in extracting the string. </p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1496246535, "post_id": 44289497, "comment_id": 75585804, "body": "You are printing <code>a</code>&#39;s <i>address</i>, but you are passing its <i>value</i> to your function.  Incidentally, your compiler should be warning you about an implicit integer-to-pointer conversion; if it isn&#39;t then turn up the warning level."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1496246617, "post_id": 44289497, "comment_id": 75585856, "body": "&quot;When the function prints out the memory address of the char,&quot; ---&gt; the function is attempting to print the address of a <code>char *</code>, not the address of a <code>char</code>."}, {"owner": {"reputation": 1, "user_id": 3911009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4954ba4c681855b000714ef3e880a62?s=128&d=identicon&r=PG&f=1", "display_name": "nkumar", "link": "https://stackoverflow.com/users/3911009/nkumar"}, "edited": false, "score": 0, "creation_date": 1496246904, "post_id": 44289497, "comment_id": 75586019, "body": "There is already a thread on this topic that can help you. <a href=\"https://stackoverflow.com/questions/14331411/passing-char-pointer-in-c\" title=\"passing char pointer in c\">stackoverflow.com/questions/14331411/passing-char-pointer-in&zwnj;&#8203;-c</a>"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1496246947, "post_id": 44289497, "comment_id": 75586050, "body": "With one substitution of the <code>*</code> with a <code>&amp;</code>, the syntax you tried to use is how references would work if you were using C++. But you&#39;re not: you&#39;re using C and pointers. So using the address-of and dereference operators is mandatory."}], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1496246593, "post_id": 44289536, "comment_id": 75585848, "body": "They are <i>also</i> not passing the pointer, but instead the value of the <code>char</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1496246623, "post_id": 44289536, "comment_id": 75585861, "body": "Yes, but that&#39;s not a complete solution, because the OP also has an error in his function call."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1496246745, "post_id": 44289536, "comment_id": 75585929, "body": "@JohnBollinger Ah, you are right, I missed that completely. Thank you very much!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1496247169, "post_id": 44289536, "comment_id": 75586177, "body": "&quot;You are printing <code>char*</code>, so it can go without a cast,&#39;  Hmmm, although a pedantic point, a <code>char *</code> need not have the same width/layout as <code>void *</code>.  Highly portable code needs the <code>void *</code> cast to go with <code>&quot;%p&quot;</code>."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496247410, "post_id": 44289536, "comment_id": 75586303, "body": "@chux That&#39;s odd - <a href=\"http://ideone.com/YX2PqS\" rel=\"nofollow noreferrer\">C99 compiler with all warnings turned on and treated as errors does not mind me passing <code>char*</code> to <code>printf</code> with <code>%p</code></a>. It <a href=\"http://ideone.com/NZNiW8\" rel=\"nofollow noreferrer\">reports an error when I try to pull the same trick with an <code>int*</code> pointer</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496248141, "post_id": 44289536, "comment_id": 75586749, "body": "Likely that compiler will also not complain about printing <code>signed char*</code>,  <code>unsigned char*</code> with <code>&quot;%p&quot;</code>.  The C spec does say &quot;The argument shall be a pointer to <code>void</code>.&quot;  I find no exception elsewhere in the spec that supports allowing <code>char*</code>."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1496250660, "post_id": 44289536, "comment_id": 75588299, "body": "@chux In C99 standard, 6.2.5, part 27, it says that &quot;A pointer to void shall have the same representation and alignment requirements as a pointer to a character type.&quot; That&#39;s why I think the compiler does not complain."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496250911, "post_id": 44289536, "comment_id": 75588451, "body": "@dasblinkenlight Interest <a href=\"https://stackoverflow.com/questions/44289497/how-to-manipulate-variable-in-function/44289536?noredirect=1#comment75588299_44289536\">point</a> and difficult to disagree with. I shall ponder that &quot;same representation&quot;."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 6, "last_activity_date": 1496246962, "last_edit_date": 1496246962, "creation_date": 1496246479, "answer_id": 44289536, "question_id": 44289497, "link": "https://stackoverflow.com/questions/44289497/how-to-manipulate-variable-in-function/44289536#44289536", "title": "How to manipulate variable in function?", "body": "<p>You are not using the pointer correctly: rather than assigning a new value to the object the pointer points to, you assign the pointer itself.</p>\n\n<p>The call should use the address-of operator, and the assignment should be with the dereference operator:</p>\n\n<pre><code>showString(&amp;a);\nprintf(\"a=%p\\n\", (void*)&amp;a);\n...\nvoid showString(char *c){\n    *c='b';\n    printf(\"c=%p\\n\", (void*)c);\n}\n</code></pre>\n\n<p>Now both printouts will produce the same address, and the value of <code>char a</code> in the calling function should change.</p>\n\n<p><strong>Note 1:</strong> The reason the compiler allowed <code>c = 'b'</code> assignment is somewhat odd: <code>'b'</code> is considered a character constant, <code>char</code> is considered an integral type, and C lets you assign integers to pointers with the assumption that you know what you are doing better than the compiler.</p>\n\n<p><strong>Note 2:</strong> When you print a pointer with <code>%p</code>, and the pointer type is neither <code>void*</code> nor <code>char*</code>, a cast to <code>void*</code> is required. You are printing <code>char*</code>, so it can go without a cast, but I added the cast anyway, in case you want to try this out with pointers of a different type.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1496246722, "post_id": 44289600, "comment_id": 75585914, "body": "Hmmm: <code>printf(&quot;c=%p\\n&quot;, &amp;c);</code> ?  You want to print the address of <code>c</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1496246737, "post_id": 44289600, "comment_id": 75585924, "body": "Note also, that if the to <code>printf()</code> calls are supposed to produce the same output, then the one in function <code>showString()</code> should print <code>c</code>, and <code>&amp;c</code>."}, {"owner": {"reputation": 40992, "user_id": 40106, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/164ca8ba426bdb10381290b9617d3ea7?s=128&d=identicon&r=PG&f=1", "display_name": "4thSpace", "link": "https://stackoverflow.com/users/40106/4thspace"}, "edited": false, "score": 0, "creation_date": 1496246853, "post_id": 44289600, "comment_id": 75585990, "body": "Thanks. Inside the function, <code>c</code> has a different memory address than outside the function. But I see the function change to the variable carries outside of the function. How is that possible since inside the function, the variable has a different memory address?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 40992, "user_id": 40106, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/164ca8ba426bdb10381290b9617d3ea7?s=128&d=identicon&r=PG&f=1", "display_name": "4thSpace", "link": "https://stackoverflow.com/users/40106/4thspace"}, "edited": false, "score": 0, "creation_date": 1496247050, "post_id": 44289600, "comment_id": 75586111, "body": "@4thSpace The <i>pointers</i> are located at different addresses, because you pass the <i>pointer</i> by value i.e. copy. Both pointers, wherever they themselves are located, hold the same value at their respective locations, and that value is the address of the same <code>char</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496247425, "post_id": 44289600, "comment_id": 75586316, "body": "What remains unclear is the output is <code>&quot;c=some_address\\n&quot;</code> and <code>&quot;c=b\\n&quot;</code>, yet in both cases, neither is correct as <code>c</code> is a pointer and does not have the value of <code>&amp;c</code> nor <code>*c</code>,"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496247481, "post_id": 44289600, "comment_id": 75586358, "body": "@chux <code>&amp;c</code> prints the address of the pointer itself. <code>*c</code> prints the <code>char</code> that is located at the address given by the value of the pointer. But the value of the pointer, i.e. the address of said <code>char</code>, is not printed here: that would require printing just <code>c</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1496247608, "post_id": 44289600, "comment_id": 75586438, "body": "@underscore_d Agree.  If I saw output <code>&quot;c=0x1234\\n&quot;</code>, I would expect <code>0x1234</code> to be the value of <code>c</code> and not its address nor the value of what it points to."}], "tags": [], "owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "is_accepted": true, "score": 3, "last_activity_date": 1496247146, "last_edit_date": 1496247146, "creation_date": 1496246649, "answer_id": 44289600, "question_id": 44289497, "link": "https://stackoverflow.com/questions/44289497/how-to-manipulate-variable-in-function/44289600#44289600", "title": "How to manipulate variable in function?", "body": "<p>Your function should look like</p>\n\n<pre><code>//function \nvoid showString(char *c) {\n    *c = 'b';\n    printf(\"c=%p\\n\", &amp;c); //&lt;---to print the address of C\n    printf(\"c=%c\\n\", *c);  //&lt;---to print the value that C is pointing\n}\n</code></pre>\n\n<p>and when you call it you should pass the Address of <strong><em>a</em></strong></p>\n\n<pre><code>char a = 'a';\nprintf(\"a=%p\\n\", &amp;a);\nshowString(&amp;a);   //&lt;---&amp;a and not a\n</code></pre>\n"}], "owner": {"reputation": 40992, "user_id": 40106, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/164ca8ba426bdb10381290b9617d3ea7?s=128&d=identicon&r=PG&f=1", "display_name": "4thSpace", "link": "https://stackoverflow.com/users/40106/4thspace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 1, "accepted_answer_id": 44289600, "answer_count": 2, "score": 1, "last_activity_date": 1496247146, "creation_date": 1496246360, "question_id": 44289497, "link": "https://stackoverflow.com/questions/44289497/how-to-manipulate-variable-in-function", "title": "How to manipulate variable in function?", "body": "<p>In the example below, I pass a char into a function as a pointer. When the function prints out the memory address of the char, it is a different address. Am I dealing with two different variables in this case? Isn't that the same result as if I didn't use a pointer in the function argument (same as pass by value)?</p>\n\n<pre><code>char a = 'a';\nprintf(\"a=%p\\n\", &amp;a);\nshowString(a);\n\n//function \nvoid showString(char *c){\n  c='b';\n  printf(\"c=%p\\n\", &amp;c);\n}\n</code></pre>\n\n<p><code>c</code> is assigned the value 'b'. But if I check <code>a</code> after the function call, it still has the value 'a'. How does the above need to change so the value assigned in the function carries over outside of the function?</p>\n"}, {"tags": ["c++", "c", "visual-studio", "static-linking", "mupdf"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1496245763, "post_id": 44289234, "comment_id": 75585279, "body": "C and C++ are different languages.  They have a common subset large enough to write programs in, but programs not specifically written and maintained to comply with both standards are highly likely to be invalid in one language or the other.  If you have a C library then build it with a C compiler.  MSVC++ is not a conforming C compiler when running in C mode, and it <i>certainly</i> is not a conforming C compiler when running in C++ mode.  Its C mode might be good enough to build your particular C code, however, especially if it&#39;s old code."}, {"owner": {"reputation": 39, "user_id": 8002688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e13efe62eefb530962e9b3eb4f99a3?s=128&d=identicon&r=PG&f=1", "display_name": "hardCode", "link": "https://stackoverflow.com/users/8002688/hardcode"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1496246544, "post_id": 44289234, "comment_id": 75585812, "body": "@ John Bollinger  I thought extern C must to solve any compatibility between C nand C++. (( Thanks for explanation."}, {"owner": {"reputation": 3577, "user_id": 2176813, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Nv7lK.jpg?s=128&g=1", "display_name": "tambre", "link": "https://stackoverflow.com/users/2176813/tambre"}, "edited": false, "score": 0, "creation_date": 1496246632, "post_id": 44289234, "comment_id": 75585865, "body": "You already posted this question. It was a duplicate. While I don&#39;t have the permissions to view the old question, which you deleted, in case it was closed for being a duplicate, then posting the same question after it&#39;s been removed/closed will result in a ban or other punishment."}, {"owner": {"reputation": 39, "user_id": 8002688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e13efe62eefb530962e9b3eb4f99a3?s=128&d=identicon&r=PG&f=1", "display_name": "hardCode", "link": "https://stackoverflow.com/users/8002688/hardcode"}, "edited": false, "score": 0, "creation_date": 1496246977, "post_id": 44289234, "comment_id": 75586070, "body": "Sorry but it&#39;s new question with new issues, which is not duplicated. Indeed,  my previous question was duplicated and was deleted."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1496246988, "post_id": 44289234, "comment_id": 75586072, "body": "@hardCode, no, not at all.  <code>extern &quot;C&quot;</code> expresses (in C++) that the function(s) so declared have <i>C linkage</i>.  That makes it possible to link them to and call them from C, but it has nothing to do with their implementation, which must still be conforming C++ (since the <code>extern &quot;C&quot;</code> syntax is a C++-only feature)."}, {"owner": {"reputation": 3577, "user_id": 2176813, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Nv7lK.jpg?s=128&g=1", "display_name": "tambre", "link": "https://stackoverflow.com/users/2176813/tambre"}, "edited": false, "score": 0, "creation_date": 1496247890, "post_id": 44289234, "comment_id": 75586607, "body": "There are many solutions listed on that answer. It&#39;s an obvious duplicate. You&#39;re failing to link with a library that implements that method, thus the linker can&#39;t find the implementation of the method and linking fails."}], "answers": [{"tags": [], "owner": {"reputation": 2275, "user_id": 5869304, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ed0827adc1d5b81f2125f83c44e7feb5?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5869304/joe"}, "is_accepted": true, "score": 0, "last_activity_date": 1496252904, "creation_date": 1496252904, "answer_id": 44291520, "question_id": 44289234, "link": "https://stackoverflow.com/questions/44289234/compiling-c-library-in-c-linking-issue-mupdf/44291520#44291520", "title": "Compiling C library in C++. Linking issue. MuPDF", "body": "<p>Either your linker is failing to find the import library for mupdf or you have a name mangling/decoration type issue.</p>\n\n<p>Once you download and build mupdf, there should be an import library for you to link to.  Are you linking to it?  Look in your project linker settings under Linker >> Input >> Additional Dependencies.   Have you added such an import?</p>\n\n<p>If not, add it in.  It shouldn't be hard to find.  It is likely right next to the mupdf DLL that you downloaded (or built).</p>\n\n<p>Assuming you have added it, your next step is to verify that you are properly finding it.    Look at the build output.  Are you getting a warning about it?  No, change the Linker >> General >> Show Progress to \"Display all progress messages\" and build again.  Is there a warning about the library or function?</p>\n\n<p>Last possibility that I can think of is that the DLL is actually exporting its functions as C++ (i.e. with name decoration), not as extern \"C\".  In that case and your extern \"C\" brackets don't belong there.  Or perhaps vice versa (i.e. maybe you failed to use extern \"C\" in all places you #include it).  I can see that your example uses it but is that all the places?</p>\n\n<p>If you are building the mupdf.DLL be sure it is being built the same way and with the same calling convention as your client code.  </p>\n"}], "owner": {"reputation": 39, "user_id": 8002688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e13efe62eefb530962e9b3eb4f99a3?s=128&d=identicon&r=PG&f=1", "display_name": "hardCode", "link": "https://stackoverflow.com/users/8002688/hardcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "closed_date": 1496254187, "accepted_answer_id": 44291520, "answer_count": 1, "score": 0, "last_activity_date": 1496252904, "creation_date": 1496245514, "question_id": 44289234, "link": "https://stackoverflow.com/questions/44289234/compiling-c-library-in-c-linking-issue-mupdf", "closed_reason": "Duplicate", "title": "Compiling C library in C++. Linking issue. MuPDF", "body": "<p>I tried multiple PDF lybrary and MUPDF is my last chance to build my own small PDF application. But here I also have problems. Before that I had problem with LNK4098: defaultlib 'MSVCRT', but I solved that to set for all MUPDF library /MDd version. Most errors is solved after that, but still I can't to solve this:</p>\n\n<pre><code>error LNK2001: unresolved external symbol \"void __cdecl pdfapp_open(struct pdfapp_s *,char *,int)\" (?pdfapp_open@@YAXPEAUpdfapp_s@@PEADH@Z)\n//more 3 errors\n</code></pre>\n\n<p>As MuPDF written on C, I do this:</p>\n\n<pre><code>extern \"C\" {\n#include &lt;pdfapp.h&gt;\n#include &lt;mupdf\\fitz\\context.h&gt;\n}\n</code></pre>\n\n<p>But I get this errors:</p>\n\n<pre><code>error LNK2001: unresolved external symbol pdfapp_open\n//more 3 errors\n</code></pre>\n\n<p>There is only three functions what I use in my application. I checked libs and headers linking, I set my project Debug, x64, /MDd also but I get the same. \nHonestly, I can't find this three functons in no one libs. I'm not a expert in programming but I know that functions strings should be finding in libs, doesn't? What does mean this errors in my case?</p>\n"}, {"tags": ["c", "gcc", "assembly", "hex", "inline-assembly"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1496245260, "post_id": 44289079, "comment_id": 75584942, "body": "Probably a good idea to mention which line gives the error."}, {"owner": {"reputation": 1, "user_id": 7822036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe0f05f445153d769ff0ffde5cfa2642?s=128&d=identicon&r=PG&f=1", "display_name": "a.vele", "link": "https://stackoverflow.com/users/7822036/a-vele"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1496245534, "post_id": 44289079, "comment_id": 75585109, "body": "Sorry.. It gives error on the first line.. error: invalid &#39;asm&#39;: operand number missing after %-letter asm volatile ("}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1496258722, "post_id": 44289079, "comment_id": 75592705, "body": "Why do you write this as inline assembly? That&#39;s prone to all sort of errors like the ones you experience."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1496258833, "post_id": 44289079, "comment_id": 75592764, "body": "Instead, create an assembly file (<code>.s</code>) and write the whole code in assembly."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7822036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe0f05f445153d769ff0ffde5cfa2642?s=128&d=identicon&r=PG&f=1", "display_name": "a.vele", "link": "https://stackoverflow.com/users/7822036/a-vele"}, "edited": false, "score": 0, "creation_date": 1496247530, "post_id": 44289825, "comment_id": 75586388, "body": "Thanks! I compiled it now succesfully, but it gives me Segmentation fault(core dumped) as output. Any idea why?"}, {"owner": {"reputation": 1015, "user_id": 7691497, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-46wzsjmiSDg/AAAAAAAAAAI/AAAAAAAAAAk/qjgRQMlHINA/photo.jpg?sz=128", "display_name": "Ben Steffan", "link": "https://stackoverflow.com/users/7691497/ben-steffan"}, "reply_to_user": {"reputation": 1, "user_id": 7822036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe0f05f445153d769ff0ffde5cfa2642?s=128&d=identicon&r=PG&f=1", "display_name": "a.vele", "link": "https://stackoverflow.com/users/7822036/a-vele"}, "edited": false, "score": 1, "creation_date": 1496247782, "post_id": 44289825, "comment_id": 75586552, "body": "@a.vele I suggest you do some debugging work yourself (i.e. compile with debug flags and step through your program with a debugger) and once you have identified the line in which the segfault happens (or even better, its cause), see if you can fix it yourself and if not, open up a new question, because the problem this question is about is now fixed. I&#39;ll be glad to help you if you become stuck :)"}], "tags": [], "owner": {"reputation": 1015, "user_id": 7691497, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-46wzsjmiSDg/AAAAAAAAAAI/AAAAAAAAAAk/qjgRQMlHINA/photo.jpg?sz=128", "display_name": "Ben Steffan", "link": "https://stackoverflow.com/users/7691497/ben-steffan"}, "is_accepted": false, "score": 2, "last_activity_date": 1496247257, "creation_date": 1496247257, "answer_id": 44289825, "question_id": 44289079, "link": "https://stackoverflow.com/questions/44289079/c-to-inline-assembly/44289825#44289825", "title": "C to inline assembly", "body": "<p>In gcc inline assembly, register names need to be prefixed with <strong>two</strong> percent signs, which you actually do in your second and third instruction, but forget everywhere else. Just replacing <code>%bx</code> with <code>%%bx</code> should fix your error.</p>\n"}], "owner": {"reputation": 1, "user_id": 7822036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe0f05f445153d769ff0ffde5cfa2642?s=128&d=identicon&r=PG&f=1", "display_name": "a.vele", "link": "https://stackoverflow.com/users/7822036/a-vele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496247257, "creation_date": 1496245117, "question_id": 44289079, "link": "https://stackoverflow.com/questions/44289079/c-to-inline-assembly", "title": "C to inline assembly", "body": "<p>i am supposed to to rewrite code from C to inline assembly. Code is transfering decimal numbers to hexadecimal.</p>\n\n<p>Code i am supposed to transfer is: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nstatic int a;\nint main() {\nchar str[]=\"XX je hex\\n\";\n\nif (scanf(\"%i\", &amp;a)==1) {\n\n   /* This part of code i am supposed to transfer */\n\n   int tmp = (a&gt;&gt;4)&amp;0x0f;\n   if (tmp &lt;= 9) {\n     tmp+='0';\n   } else {\n     tmp+='A'-10;\n   }\n   str[0]=tmp;\n   tmp = a&amp;0x0f;\n   if (tmp &lt;= 9) {\n     tmp+='0';\n   } else {\n     tmp+='A'-10;\n   }\n   str[1]=tmp;\n   /* Ends here */\n   write(1, str, 10);\n}\nreturn 0;\n}\n</code></pre>\n\n<p>So far i got this </p>\n\n<pre><code>asm volatile (\n\n        \"mov %a,%bx;\"\n        \"shrw $4,%%bx;\"\n        \"and $0x0f, %%bx;\"\n\n        \"cmp $9,%bx;\"\n        \"jle lessOrEq;\"\n        \"jg greater;\"\n\n        \"mov %bx,%str[0];\"\n\n        \"mov %a,%bx;\"\n        \"and $0x0f, %%bx;\"\n\n        \"cmp $9,%bx;\"\n        \"jle lessOrEq;\"\n        \"jg greater;\"\n\n\n        \"mov %bx,%str[1];\"\n\n        \"lessOrEq: add '0',%bx; ret;\"\n\n        \"greater: add 'A',%bx; sub 10,%bx; ret;\"  \n\n    :\"=c\"(str[0]), \"=d\" (str[1])\n    :\"a\"(a),\"c\"(str[0]),\"d\"(str[1])\n    :   \n);\n</code></pre>\n\n<p>and i am getting this error: Invalid 'asm': operand number missing after %-letter.</p>\n\n<p>Any idea what do i have wrong? Any advice would be appreciated.</p>\n"}, {"tags": ["c", "unix", "signals", "sigint"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1496244198, "post_id": 44288704, "comment_id": 75584228, "body": "The behavior of <code>signal</code> depends on the Unix variant you have. To get consistent behavior use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sigaction.html\" rel=\"nofollow noreferrer\"><code>sigaction</code></a> instead."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1496244205, "post_id": 44288704, "comment_id": 75584234, "body": "There is good documentation for signal handling in general and the <code>signal()</code> function in particular available online and via the <code>man</code> command."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1496244386, "post_id": 44288704, "comment_id": 75584358, "body": "Also note that <code>printf</code> is not considered to be a safe function to call in a signal handler."}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 2, "last_activity_date": 1496246002, "last_edit_date": 1496246002, "creation_date": 1496245163, "answer_id": 44289095, "question_id": 44288704, "link": "https://stackoverflow.com/questions/44288704/sigint-singal-is-being-catched-only-once/44289095#44289095", "title": "SIGINT singal is being catched only once", "body": "<p><code>signal</code> is highly implementation defined and you should use <code>sigaction</code> because of that. What you're observing are the so-called sysv semantics of <code>signal</code>--the signal is reset in the handler to <code>SIG_DFL</code> and it's not blocked from reexecution.</p>\n\n<p>You probably want something like:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n\n#define WRITE_LIT(fd, lit) write(fd, lit, sizeof lit - 1)\n\nvoid handler(int sig){\n        if(sig == SIGINT){\n            WRITE_LIT(2, \"Signal caught\\n\");\n            execl(\"./recreate\",\"./recreate\", (char*)NULL);\n            WRITE_LIT(2, \"Couldn't run ./recreate\\n\");\n            _exit(127);\n        }\n}\n\nint main(){\n    printf(\"Main start\\n\");\n    sigaction(SIGINT, &amp;(struct sigaction const){ \n        .sa_handler = handler, \n        .sa_flags = SA_NODEFER /*don't block signals for the new process image*/\n    },\n    0);\n    while(1);\n        return 0;\n}\n</code></pre>\n\n<p>This won't reset the signal and it won't block it either (the default is to block it for the duration of the handler) because the new process image likely won't want it blocked. </p>\n"}], "owner": {"reputation": 23, "user_id": 6101313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8dff65c6adb0d32e2805d455b66fc9?s=128&d=identicon&r=PG&f=1", "display_name": "EdgarC", "link": "https://stackoverflow.com/users/6101313/edgarc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 44289095, "answer_count": 1, "score": 0, "last_activity_date": 1496246002, "creation_date": 1496244096, "question_id": 44288704, "link": "https://stackoverflow.com/questions/44288704/sigint-singal-is-being-catched-only-once", "title": "SIGINT singal is being catched only once", "body": "<p>Here's a simple recreation of this issue:</p>\n\n<pre><code>void handler(int sig){\n        if(sig == SIGINT){\n                printf(\"Signal caught\\n\");\n                execl(\"./recreate\",\"./recreate\",NULL);\n        }\n}\n\nint main(){\n    printf(\"Main start\\n\");\n    signal(SIGINT,handler);\n    while(1);\n\n        return 0;\n}\n</code></pre>\n\n<p>It simply runs itself again after receiving the signal. What happens is that it is only able to read CTR+C from the terminal once. From the second point onward is simply writes ^C on the console. Do I need to reset the handler every time or something similar? Thanks in advance.</p>\n"}, {"tags": ["c", "variable-assignment"], "comments": [{"owner": {"reputation": 634, "user_id": 8016390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cb8a7992f3527dc9d50d8ff87de9dc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Gam", "link": "https://stackoverflow.com/users/8016390/gam"}, "edited": false, "score": 0, "creation_date": 1496242015, "post_id": 44287865, "comment_id": 75582572, "body": "Did you try to do it ?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 3, "creation_date": 1496242152, "post_id": 44287865, "comment_id": 75582687, "body": "It would in Python, but not in C."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1496242352, "post_id": 44287865, "comment_id": 75582836, "body": "that&#39;s not a <i>variable declaration in <b>C</i></b>."}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1496242527, "post_id": 44287944, "comment_id": 75582981, "body": "Wouldn&#39;t B be 2? I believe that the result of a sequence separated by the comma operator is the <i>last</i> element evaluated. Hence the value assigned will be 2. That is also what your quote says: &quot;<i>the result has its type and value</i>&quot;."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1496242570, "post_id": 44287944, "comment_id": 75583013, "body": "@PaulOgilvie It would, if the , operator had higher precedence than ="}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1496242585, "post_id": 44287944, "comment_id": 75583027, "body": "@PaulOgilvie The assignment operator has higher priority than the comma operator."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1496242619, "post_id": 44287944, "comment_id": 75583056, "body": "Thanks. Never too old to learn."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1496242661, "post_id": 44287944, "comment_id": 75583083, "body": "@PaulOgilvie I agree with you.:)"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 5, "last_activity_date": 1496245023, "last_edit_date": 1496245023, "creation_date": 1496242144, "answer_id": 44287944, "question_id": 44287865, "link": "https://stackoverflow.com/questions/44287865/what-does-the-comma-operator-mean/44287944#44287944", "title": "What does the comma operator mean?", "body": "<p>This expression</p>\n\n<pre><code>A, B = 0.0, 2;\n</code></pre>\n\n<p>is an expression with the comma operator (here are two comma operators). It can be presented like</p>\n\n<pre><code>( A ), ( B = 0.0 ), ( 2 );\n</code></pre>\n\n<p>As result the variable <code>B</code> will get the value 0.0. The variable <code>A</code> will be unchanged.</p>\n\n<p>From the C Standard (6.5.17 Comma operator)</p>\n\n<blockquote>\n  <p>2 The left operand of a comma operator is evaluated as a void\n  expression; there is a sequence point between its evaluation and that\n  of the right operand. Then the right operand is evaluated; the result\n  has its type and value</p>\n</blockquote>\n\n<p>So the value of the above expression is <code>2</code> and the type is <code>int</code>.  The value of the expression is not used. So the only its side effect is assigning the value <code>0.0</code> to the variable <code>B</code>.</p>\n"}], "owner": {"reputation": 69, "user_id": 7880056, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3de068e148fa0f275f412a999998016c?s=128&d=identicon&r=PG&f=1", "display_name": "Al B", "link": "https://stackoverflow.com/users/7880056/al-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1496244472, "answer_count": 1, "score": -2, "last_activity_date": 1496245023, "creation_date": 1496241940, "last_edit_date": 1496243959, "question_id": 44287865, "link": "https://stackoverflow.com/questions/44287865/what-does-the-comma-operator-mean", "closed_reason": "Duplicate", "title": "What does the comma operator mean?", "body": "<p>I've declared variables and their values before but I've never done this on a single line before. </p>\n\n<p>If I write   </p>\n\n<pre><code>A, B = 0.0, 2;\n</code></pre>\n\n<p>Does this mean </p>\n\n<pre><code>A = 0 \n</code></pre>\n\n<p>and </p>\n\n<pre><code>B = 2? \n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496242051, "post_id": 44287698, "comment_id": 75582606, "body": "1. Because the function is iterating from <code>cstr</code> and returning a <i>new value</i> which is then assigned to <code>cstr</code> (which can be <code>NULL</code>)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496242136, "post_id": 44287698, "comment_id": 75582673, "body": "What are the rules of engagement?  Are you allowed to use functions from <code>&lt;string.h&gt;</code>?  You are reimplementing a number of them.  It isn&#39;t the best way to deal with the problem, though.  You are always shrinking and never expanding the string.  You can do the job in a single pass keeping a read pointer that moves every cycle of the loop and a write pointer that moves only when the last character read was not a digit.  Don&#39;t forget to null terminate the string."}, {"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496242803, "post_id": 44287698, "comment_id": 75583189, "body": "@WeatherVane while( ( cstr = find_digit(cstr) ) is this mean the pointer cstr(right) which is result from find digit was given to pointer cstr (left) to replace the pointer that was passed from the calling function in main?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496243059, "post_id": 44287698, "comment_id": 75583382, "body": "The pointer was given to the function <code>find_digit</code> which iterated from the value it was given, then returned the value where it stopped iterating (a digit was found), or <code>NULL</code> (end of string found). The calling function updates <code>cstr</code>, otherwise you&#39;ll keep repeating what you already did."}, {"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496243082, "post_id": 44287698, "comment_id": 75583396, "body": "@JonathanLeffler can you give me more hint? what i could think of is to make one variable to count the digit then *(str-count)=*str using this to change the value.."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496243240, "post_id": 44287698, "comment_id": 75583515, "body": "<code>void delete_digits(char *cstr) { char *dst = cstr; char *src = cstr; char c; while ((c = *src++) != &#39;\\0&#39;) { if (!isdigit((unsigned char)c)) *dst++ = c; } *dst = &#39;\\0&#39;; }</code>"}, {"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496243244, "post_id": 44287698, "comment_id": 75583517, "body": "@WeatherVane i know in the first iteration it will return pointer that point 9 in &#39;ab98k&#39; for example. then will iterate again result in &#39;8k&#39; but at last iteration which is &#39;k&#39;, since there is no digit there, it will return null to delete digit function to terminate the while or not?"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496245797, "post_id": 44288350, "comment_id": 75585303, "body": "{ while( ( find_digit(cstr) ) ) move_left(cstr) ; } -&gt; why this remove first character and not from the one found? since the find digit function result is suppose to be pointer that point first digit?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496248365, "post_id": 44288350, "comment_id": 75586875, "body": "because cstr always points to the first character.  { while( (cstr = find_digit(cstr) ) ) move_left(cstr) ; }  -&gt; after every iteration cstr points to the digit found"}, {"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496249005, "post_id": 44288350, "comment_id": 75587266, "body": "but the   \t { while( ( find_digit(cstr) ) ) move_left(cstr) ; }  -&gt; find_digit will return pointer cstr that point to the digit that was found or not?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496252038, "post_id": 44288350, "comment_id": 75589072, "body": "cstr is a local variable in find_digit and  in the scope of while it will be another one (they have the same names but different scopes). This while should be != NULL to avoid warnings."}, {"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496254914, "post_id": 44288350, "comment_id": 75590572, "body": "is this mean result from find_digit function is suppose &quot;98k&quot; that will be return to the find_digit, but since the condition of while is while !=NULL,move_left (cstr ), the cstr here in delete_digit function point the first word, then will loop the while until it NULL.. (?)"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1496243176, "creation_date": 1496243176, "answer_id": 44288350, "question_id": 44287698, "link": "https://stackoverflow.com/questions/44287698/program-to-delete-digits-from-text/44288350#44288350", "title": "Program to delete digits from text", "body": "<p>Your </p>\n\n<pre><code>{ while( ( find_digit(cstr) ) ) move_left(cstr) ; }\n</code></pre>\n\n<p>removes first character (not the one found) from the string if find_digit(cstr) is != NULL</p>\n\n<p>it is easier to understand if you add a temporary variable</p>\n\n<pre><code>char *tmp;\nwhile( ( tmp = find_digit(cstr) ) ) move_left(tmp) ;\n</code></pre>\n\n<p>but this version will be less effective as it searches for a digit from the beginning of the string and the original version </p>\n\n<pre><code>    while (cstr = find_digit(cstr))\n         move_left(cstr);\n</code></pre>\n\n<p>only from the last found.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496243546, "post_id": 44288410, "comment_id": 75583716, "body": "Strictly strictly you should ensure that the argument to <code>isdigit()</code> is an <code>unsigned char</code> converted to <code>int</code>, not a (possibly signed, possibly negative) plain <code>char</code> that is converted to <code>int</code>.  Otherwise, the one pass algorithm is exactly the way to go."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496244063, "post_id": 44288410, "comment_id": 75584118, "body": "@JonathanLeffler Assuming ASCII, it wouldn&#39;t matter. Getting away from, it gets complicated anyway as we need to consider encoding. What about multibyte utf8-numerals from other languages??? Still, I added the cast..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496244188, "post_id": 44288410, "comment_id": 75584219, "body": "@JonathanLeffler By the way - what about systems where int and char have the same size??? I happened once to code for such one (TI DSP), both char and int having 16 bit..."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496244548, "post_id": 44288410, "comment_id": 75584442, "body": "On systems where <code>sizeof(char) == sizeof(int)</code>, you are less likely to need the cast.  It gets tricky.  The <code>isvwxyz()</code> functions take an <code>int</code> argument which is either an <code>unsigned char</code> (converted to <code>int</code>) or <code>EOF</code>.  On such systems, what is the value of <code>EOF</code>?  It has to be negative.  It is traditionally <code>-1</code> but that is not mandated.  There are design issues to resolve there.  Multi-byte codesets should be processed by code that is multi-byte aware \u2014 wide characters or UTF-8, UTF-16, etc.  The crucial point is that the byte 0xC4 is not passed as a negative number."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496245011, "post_id": 44288410, "comment_id": 75584776, "body": "And the &#39;strictly strictly&#39; prefix was an indication that this is a niggling detail often overlooked (except by the default compiler options I use \u2014 and since I use <code>-Werror</code> too, my code doesn&#39;t compile if I get lazy).  <i>[\u2026time passes\u2026]</i>  Hmmm; I just went to check that statement, and for some reason, I&#39;m no longer getting the error.  It probably has something to do with the <code>&lt;ctype.h&gt;</code> header defining: <code>__DARWIN_CTYPE_TOP_inline int isdigit(int _c) { return (__isctype(_c, _CTYPE_D)); }</code>.  This is macOS Sierra 10.12.5 and XCode 8.3.2.  I&#39;m sure it used to generate complaints in times past."}, {"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496246244, "post_id": 44288410, "comment_id": 75585608, "body": "why the while loop without assignment point to the first char and not the fund one although it has called the find_digit function? and your program much better only copy the non digit value to another pointer"}, {"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496248199, "post_id": 44288410, "comment_id": 75586785, "body": "@Aconcagua { while( ( find_digit(cstr) ) ) move_left(cstr) ; } -&gt; why this remove first character and not from the one found/return from the find_digit function? since the find digit function result is suppose to be pointer that point first digit? can you explain a bit more?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496295944, "post_id": 44288410, "comment_id": 75604059, "body": "@fiksx Passing a pointer means passing it as a <b>copy</b>. Both delete_digit and find_digit have their own version of such a pointer, and thus, although find_digit modifies its own pointer, this won&#39;t change the delete_digit&#39;s version at all. So, if you do not re-assign the pointer in delete_digit, it won&#39;t be modified and thus will stay where it was before - i. e. the start of the string..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496296221, "post_id": 44288410, "comment_id": 75604174, "body": "@fiksx Actually, you <i>can</i> find_digit let modify the delete_digit&#39;s version of the pointer. But for that, you have to pass a pointer to pointer to find_digit: <code>char* find_digit(char** cstr)</code> (notice the double asterix) and call it from delete_digits via <code>find_digit(&amp;cstr)</code>. Inside find_digit, you need to dereference cstr once more on every occurence: <code>for (; **cstr; ++*cstr)</code> etc."}, {"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496309669, "post_id": 44288410, "comment_id": 75612791, "body": "@aconcagua hello thanks for the further explanation!!!!!! ,,in in conclusion if the while dont have assignment &quot;while(find_digit(cstr)&quot;, the return copy from find_digit is just to determine the condition of the while loop as long as not NULL  , but the pointer that pass to the move_left function is the one that delete_digit has and it doesnt have any relation with the return copy pointer from find_digit,"}, {"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496309681, "post_id": 44288410, "comment_id": 75612798, "body": "@aconcagua but if i use &quot;while(cstr=find_digit(cstr)&quot; the return pointer from move_left will be insert to cstr again so it will change the pointer in delete digit!!!! i wonder about our code too, is there algorithm behind it?? or you just made it according to your logic then implement it with c syntax?"}, {"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496310735, "post_id": 44288410, "comment_id": 75613629, "body": "@aconcagua and in your code version: the first iteration after set both pointer point the same front word,, if non digit *str++ = *s; assign pointer s to str; then increment str by 1 then after the execution of for loop,,++src in for loop, is ++src and src++ has same result in this for loop? so basically you made s as pointer to evaluate if there is a digit, then move the non digit to *str then print it  ,, is there algorithm behind it.. (seems funn question but just wondering),, i can think another beginner version .. i will put it in edit"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496310812, "post_id": 44288410, "comment_id": 75613690, "body": "@fiksx Have a close look - you pass cstr (within delete_digits) to move_left - again as a copy! So original cstr (delete_digits) won&#39;t be modified within move_left. What is changed is the array where both cstr pointers point to, though. This is why you see the changes from move_left within delete_digits."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1496311198, "post_id": 44288410, "comment_id": 75613968, "body": "There is no difference between ++s and s++, as long as you do not evaluate the result. In the for loop, I don&#39;t, so select whichever you prefer (if you ever get to C++, this is not necesarily the same there, though...). Different is the if body: <code>*str++</code>: str is dereferenced with its value before incrementation, which is distinct from <code>*++str</code>."}, {"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496311361, "post_id": 44288410, "comment_id": 75614096, "body": "@aconcagua i know that in delete digit the pointer is still point the first number that was find, third position, assume &quot;ab98k&quot;, as the move_left will return the array value that has been move left so thats why i see change there right?? the point here the pointer is a copy.. so it doesnt effect the delete digit pointer, but the result change in the array will affect it (?)"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496311806, "post_id": 44288410, "comment_id": 75614411, "body": "@fiksx Errm - move_left returns void, i. e. nothing at all... Apart from that, I think you got it now. Imagine you have a video telephone, and you called a friend Alice from there. Imagine could have a copy of your phone and hand it to another person Bob. Bob now tells Alice to turn round (change the original array). Of course, you see Alice in changed position, too. Now Bob calls another person Charles (changes the pointer). Your own phone is still connected to Alice... Not sure if a nice example, but couldn&#39;t imagine up something better."}, {"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496316172, "post_id": 44288410, "comment_id": 75617429, "body": "@aconcagua thanks i kinda got it!!!!!!!!!!!!!!!!!!!!!!!!              supose make pointer call pdigit     ,,,,,,,,,,,,,,,,,,,,,,                                                                                           char * pdigit = find_digit(cstr); while( pdigit ) {   cstr = pdigit;   move_left(cstr);   pdigit = find_digit(cstr); }                                                                                                                        but in this code what the purpose of making pointer here??"}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": true, "score": 2, "last_activity_date": 1496298615, "last_edit_date": 1496298615, "creation_date": 1496243320, "answer_id": 44288410, "question_id": 44287698, "link": "https://stackoverflow.com/questions/44287698/program-to-delete-digits-from-text/44288410#44288410", "title": "Program to delete digits from text", "body": "<p>First question: If you pass an array to a function, the function actually receives a pointer to that array. You now can modify this pointer (the pointer itself, not the values pointed at) without modifying the original array at all. If you pass that pointer to another function, you actually pass a copy of that pointer, i. e. if you modify the new pointer in the second function, the pointer of the first function is not affected at all. This is important (among other places) especially for the move_left function being called from within delete_digits!</p>\n\n<p>Then, you need to reassign the pointer to be able to move through the string given:</p>\n\n<p>Now start condition is as follows:</p>\n\n<pre><code> \"ab98kk7\\0\" // for better illustration, I explicitly show the terminating 0 character...\n//^ str pointing to here\n</code></pre>\n\n<p>You now search for the first digit in the while loop:</p>\n\n<pre><code> \"ab98kk7\\0\"\n//  ^ str pointing to here after first assignment\n</code></pre>\n\n<p>And this is how your string looks after moving left:</p>\n\n<pre><code> \"ab8kk7\\0\\0\"\n//  ^ str STILL pointing to here\n// notice the duplicate \\0 at the end...\n</code></pre>\n\n<p>The next assignment in the loop won't modify str, as first letter, seen from pointer's view, is already a digit again, so no change, but after removal, the situation looks like this:</p>\n\n<pre><code> \"abkk7\\0\\0\\0\"\n//  ^ str STILL pointing to here\n</code></pre>\n\n<p>Finding next digit (assignment in while):</p>\n\n<pre><code> \"abkk7\\0\\0\\0\"\n//    ^ str NOW pointing to here\n</code></pre>\n\n<p>OK, lets skip the removal of the last digit... As then no further digit follows, NULL will be assigned to str and we leave the loop...</p>\n\n<p>If you change to the while loop without assignment, you will remove the entire string as long as any new digit is found:</p>\n\n<pre><code> \"ab98kk7\\0\"\n//  ^ str pointing to here after first assignment\n//^  still pointing to here without assignment!!! (as long as still any digits contained in the string)\n</code></pre>\n\n<p>With my example with the added digit at the end, you would clear out the string entirely...</p>\n\n<p>Second question is short: You are absolutely right...</p>\n\n<p>However, this algorithm is horribly inefficient, as you copy the whole rest of the string each time you eliminate a single character. You can do it much better, if you use two pointers:</p>\n\n<pre><code>void eliminateDigits(char* str)\n{\n    for(char* s = str; *s; ++s)\n    {\n        if(!isdigit((unsigned char)*s))\n            *str++ = *s;\n    }\n    *str = 0;\n}\n</code></pre>\n\n<p><em>Addendum</em> &ndash; in response to your comment:</p>\n\n<p>It might help to understand the issue by understanding the nature of pointers and passing them to functions:</p>\n\n<p>Actually, pointers are nothing more than a memory address &ndash; stored in a specific number of bytes (how many depends on the architecture you are writing the code for - on modern 64-bit hardware, this is typically eight bytes, older 32-bit hardware used only four of them). If you pass a pointer to a function, you actually copy this address onto the stack into the frame for this function.</p>\n\n<p>Let's imagine the stack now: </p>\n\n<pre><code>- return value of main (place holder!)\n- argv (assuming cdecl calling convention -&gt; arguments placed in reverse order)\n- argc\n- main's cstr, array of 200 bytes\n- main's format, array of 16 bytes\n</code></pre>\n\n<p>Calling delete_digits: </p>\n\n<pre><code>- return value of main (place holder!)\n- argv\n- argc\n- main's cstr, array of 200 bytes\n- main's format, array of 16 bytes\n- return value of delete_digits (place holder!)\n- delete_digits' cstr, pointer to main's cstr, 8 bytes\n</code></pre>\n\n<p>Within find_digit, you can simply add these few lines to above: </p>\n\n<pre><code>- return value of find_digit (place holder!)\n- find_digit's cstr, copy of delete_digits' pointer, thus pointing to main's cstr, too\n</code></pre>\n\n<p>Situation is as follows: </p>\n\n<pre><code>ab98k\\0      (main's array)\n^            (pointer of delete_digits)\n^            (pointer of find_digit)\n</code></pre>\n\n<p>find_digit (repeatedly) modifies its own variant of the pointer:</p>\n\n<pre><code>ab98k\\0      (main's array)\n^            (pointer of delete_digits)\n  ^          (pointer of find_digit before returning)\n</code></pre>\n\n<p>Without assignment, the last pointer on the stack is just removed (simply remove the last line above)! Only if you <em>do</em> assign, delete_digits's pointer will be adjusted, too:</p>\n\n<pre><code>ab98k\\0      (main's array)\n  ^          (pointer of delete_digits)\n</code></pre>\n\n<p>Same applies now for move_left:</p>\n\n<pre><code>ab98k\\0      (main's array)\n  ^          (pointer of delete_digits)\n  ^          (pointer of move_left)\n</code></pre>\n\n<p>move_left advances the pointer - by dereferencing it, it accesses, though, the address the pointer points to &ndash; which is the array of main(!):</p>\n\n<pre><code>ab88k\\0      (main's array)\n  ^          (pointer of delete_digits)\n   ^         (pointer of move_left)\n\nab8kk\\0      (main's array)\n  ^          (pointer of delete_digits)\n    ^        (pointer of move_left)\n\nab8k\\0\\0     (main's array)\n  ^          (pointer of delete_digits)\n    ^        (pointer of move_left before returning)\n</code></pre>\n\n<p>Notice that the delete_digits' pointer was not touched at all here (as wasn't either while find_digit modified its version...).</p>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "edited": false, "score": 0, "creation_date": 1496249280, "post_id": 44288473, "comment_id": 75587422, "body": "{ while( ( find_digit(cstr) ) ) move_left(cstr) ; } -&gt;  find digit function result is suppose to be pointer that point first digit, then why it removes first char.."}], "tags": [], "owner": {"reputation": 575, "user_id": 5372951, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10154278269606110/picture?type=large", "display_name": "Samuel Faure", "link": "https://stackoverflow.com/users/5372951/samuel-faure"}, "is_accepted": false, "score": 0, "last_activity_date": 1496243482, "creation_date": 1496243482, "answer_id": 44288473, "question_id": 44287698, "link": "https://stackoverflow.com/questions/44287698/program-to-delete-digits-from-text/44288473#44288473", "title": "Program to delete digits from text", "body": "<p>The function <code>find_digit</code> returns a pointer which send this pointer to a variable cstr which have NOTHING to do with the cstr in its own function. Each cstr is unique in its own function.</p>\n\n<p>So basically if the symbol is not a digit, it returns NULL and the while loop in delete_digit stops.</p>\n\n<p>The program will error if you dont assign cstr in the delete_digit function because the cstr is used inside the while loop.</p>\n\n<p>This answer your second question.</p>\n"}, {"comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1496244562, "post_id": 44288524, "comment_id": 75584458, "body": "Additionally, there is no operator+ accepting a plain char and a classic c string (<code>str[i] + &quot;&quot;;</code>). You could, though, simply do <code>noDigits += str[i];</code> Anyway, for this case, I&#39;d prefer the new range based for loop: <code>for(char c : str) { if(isdigit(c)) {} }</code>"}], "tags": [], "owner": {"reputation": 176, "user_id": 6501886, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cb938a1c774e1aa645d7c8afd7914745?s=128&d=identicon&r=PG&f=1", "display_name": "Jjoseph", "link": "https://stackoverflow.com/users/6501886/jjoseph"}, "is_accepted": false, "score": 0, "last_activity_date": 1496243612, "creation_date": 1496243612, "answer_id": 44288524, "question_id": 44287698, "link": "https://stackoverflow.com/questions/44287698/program-to-delete-digits-from-text/44288524#44288524", "title": "Program to delete digits from text", "body": "<p>Couldn't you just do...</p>\n\n<pre><code>string removeDigits(const string&amp; str) {\n\n   string noDigits;\n    for (int i = 0; i &lt; str.length(); ++i) {\n       if(!(isDigit(str[i]))) \n          noDigits += str[i] + \"\"; \n    }\nreturn noDigits;\n}\n</code></pre>\n\n<p>While isDigit is some helper function that checks if the char is [0-9] </p>\n"}], "owner": {"reputation": 175, "user_id": 8018369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-8E4VMudMRSM/AAAAAAAAAAI/AAAAAAAAAf4/ruyp_ajru38/photo.jpg?sz=128", "display_name": "fiksx", "link": "https://stackoverflow.com/users/8018369/fiksx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 44288410, "answer_count": 4, "score": 0, "last_activity_date": 1496310786, "creation_date": 1496241475, "last_edit_date": 1496310786, "question_id": 44287698, "link": "https://stackoverflow.com/questions/44287698/program-to-delete-digits-from-text", "title": "Program to delete digits from text", "body": "<p>This is program that deletes digits in text.  For example <code>ab98k</code> -> <code>abk</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\n// move characters starting at cstr+1 to the left by one position\nvoid move_left(char *cstr)\n{\n    while ((*cstr = *(cstr + 1)))\n        ++cstr;\n}\n\n// find the first occurrence of a decimal digit.\n// return pointer if found, NULL otherwise\nchar *find_digit(char *cstr)\n{\n    for ( ; *cstr; ++cstr)\n        if (isdigit(*cstr))\n            return cstr;\n\n    return NULL; // not found\n}\n\nvoid delete_digits(char *cstr) // remove decimal digits\n{\n    while (cstr = find_digit(cstr))\n        move_left(cstr);\n}\n\nint main()\n{\n// declare array of SZ characters\n    enum { SZ = 200 };\n    char cstr[SZ];\n\n// prepare format string to read at most SZ-1 characters\n    char format[16];\n    sprintf(format, \"%%%ds\", SZ - 1); // ie. \"%199s\" if SZ == 200\n\n    if (scanf(format, cstr)) // if attempted input was successful\n    {\n        delete_digits(cstr);\n        puts(cstr);\n    }\n}\n</code></pre>\n\n<p>My questions are: assume I input <code>ab98k</code></p>\n\n<pre><code> void delete_digits( char* cstr ) // remove decimal digits\n {\n     while( ( cstr = find_digit(cstr) ) )\n         move_left(cstr);\n }\n</code></pre>\n\n<p>In this function \"<code>cstr=find digit(cstr)</code>\", <code>cstr</code> is a pointer?</p>\n\n<p>I didn't understand why it has to store the <code>find_digit</code> result which is a pointer to the number digit to the pointer <code>cstr</code> again?</p>\n\n<p>The result of find_digit function is this, then why have to store it in pointer <code>cstr</code> again?</p>\n\n<p>ab98k.\n     ^</p>\n\n<p>What is the purpose? And when I change to <code>{ while( ( find_digit(cstr) ) ) move_left(cstr) ; }</code> the program seems to error.</p>\n\n<p>My second question:</p>\n\n<pre><code>char* find_digit(char* cstr)\n{\n    for (; *cstr; ++cstr)\n        if (isdigit(*cstr))\n            return cstr;\n    return NULL; // not found\n}\n</code></pre>\n\n<p>At the end of this function or when there is no digit, it will return NULL for last word 'k' in 'ab98k' right? It will return null to the <code>while</code> in the <code>delete_digit</code> function that will terminate it and return to <code>main</code>? So the purpose of NULL is to terminate for loop?</p>\n\n<p>another version</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\n  void deldigit(char *str)\n { char *res = str;\n int count=0;\n  while(*str!='\\0')\n  {\n  if(*str&gt;='1' &amp;&amp; *str&lt;='9')\n     { count++;}\n  else\n     {*(str-count)=*str; /* want this *str after increment to    overwrite *(str-count) */\n             }\n       str++;}\n    *(str - count)= '\\0';\n   printf(\"%s\",res);\n   }\n  int main()\n  { char str[100];\n\n   printf(\"inset word\");\n    scanf(\"%s\",&amp;str);\n       deldigit(str);\n  return 0;\n   }\n</code></pre>\n"}, {"tags": ["c", "tree", "segmentation-fault"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1496241329, "post_id": 44287551, "comment_id": 75582039, "body": "1) <code>eight = (struct node*)malloc(sizeof(struct node*));</code> --&gt; <code>eight = malloc(sizeof(struct node));</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1496241383, "post_id": 44287551, "comment_id": 75582086, "body": "Should be <code>sizeof (struct node)</code> - you&#39;re allocating enough memory for just a pointer."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1496241386, "post_id": 44287551, "comment_id": 75582087, "body": "<code>printf(&quot;%d\\n&quot;, temp-&gt;right-&gt;right-&gt;data);</code> What happens when <code>temp-&gt;right-&gt;right</code> is NULL?"}], "answers": [{"tags": [], "owner": {"reputation": 575, "user_id": 5372951, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10154278269606110/picture?type=large", "display_name": "Samuel Faure", "link": "https://stackoverflow.com/users/5372951/samuel-faure"}, "is_accepted": false, "score": 0, "last_activity_date": 1496244199, "last_edit_date": 1496244199, "creation_date": 1496243793, "answer_id": 44288600, "question_id": 44287551, "link": "https://stackoverflow.com/questions/44287551/binary-tree-top-view-segmentation-fault/44288600#44288600", "title": "Binary Tree Top View Segmentation Fault", "body": "<p>Your printf is trying to print a data attached to a NULL pointer. Like @Johnny said, <code>temp-&gt;right-&gt;right</code> might be null so <code>temp-&gt;right-&gt;right-&gt;data</code> segfault</p>\n\n<p>You should add a stop hook. Before :</p>\n\n<pre><code>printf(temp-&gt;right-&gt;right-&gt;data);\n</code></pre>\n\n<p>After:</p>\n\n<pre><code>if (temp-&gt;right-&gt;right)\n    printf(temp-&gt;right-&gt;right-&gt;data);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 743, "user_id": 5091033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d0737443a012e096ab556ef60a197f?s=128&d=identicon&r=PG&f=1", "display_name": "simo-r", "link": "https://stackoverflow.com/users/5091033/simo-r"}, "is_accepted": true, "score": 0, "last_activity_date": 1496259763, "last_edit_date": 1496259763, "creation_date": 1496252761, "answer_id": 44291490, "question_id": 44287551, "link": "https://stackoverflow.com/questions/44287551/binary-tree-top-view-segmentation-fault/44291490#44291490", "title": "Binary Tree Top View Segmentation Fault", "body": "<p>I just made an edit at the code and it compiles and doesn't give any error. I changed the way you use <code>malloc</code> to init a new node and deleted the <code>cast</code>. You also must check if <code>root-&gt;right-&gt;right</code> exists. Here it is with the three you show at the top of the code.</p>\n\n<pre><code>    /*      3\n *    /   \\\n *   5     2\n *  / \\   / \\\n * 1   4 6   7\n *  \\       /\n *   9     8\n */\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct node\n{\n    int data;\n    struct node* left;\n    struct node* right;\n};\n\nvoid top_view(struct node *root) {\n\n    int array[100] = {0};\n    int count = 0;\n    struct node *temp;\n\n    if (root) {\n        if (root-&gt;left) {\n            temp = root;\n            while (temp-&gt;left) {\n                printf(\"%d \", temp-&gt;left-&gt;data);\n                // array[count] = temp-&gt;left-&gt;data;\n                count++;\n                temp = temp-&gt;left;\n            }\n        }\n        array[count] = root-&gt;data;\n        printf(\"%d\\n\", array[count]);\n\n        if (root-&gt;right != NULL) {\n            printf(\"right %d\\n\", root-&gt;right-&gt;data);\n            temp = root;\n            /*You must check it*/\n            if(root-&gt;right-&gt;right != NULL){\n                printf(\"%p\\n\", temp-&gt;right-&gt;right);\n                printf(\"%d\\n\", temp-&gt;right-&gt;right-&gt;data);\n            }\n        }\n\n            /*for (int i = 0; i &lt; 100; i++) {\n             printf(\"%d \", array[i]);\n         }*/\n\n    } else {\n        return ;\n    }\n\n}\n\n\n\nint main(int argc, char const *argv[])\n{\n    struct node *nine = malloc(sizeof(struct node));\n    nine-&gt;data = 9;\n    nine-&gt;left = NULL;\n    nine-&gt;right = NULL;\n\n   /* struct node *ten = (struct node*)malloc(sizeof(struct node*));\n    ten-&gt;data = 10;\n    ten-&gt;left = NULL;\n    ten-&gt;right = NULL;*/\n\n    struct node *one = malloc(sizeof(struct node));\n    one-&gt;data = 1;\n    one-&gt;left = NULL;\n    one-&gt;right = nine;\n\n    struct node *four = malloc(sizeof(struct node));\n    four-&gt;data = 4;\n    four-&gt;left = NULL;\n    four-&gt;right = NULL;\n\n     struct node *five = malloc(sizeof(struct node));\n     five-&gt;data = 5;\n     five-&gt;left = one;\n     five-&gt;right = four;\n    /*You should cast the result of a malloc just if you need it*/\n    struct node *eight = malloc(sizeof(struct node));\n    eight-&gt;data = 8;\n    eight-&gt;left = NULL;\n    eight-&gt;right = NULL;\n\n    struct node *six = malloc(sizeof(struct node));\n    six-&gt;data = 6;\n    six-&gt;left = NULL;\n    six-&gt;right = NULL;\n\n    struct node *seven = malloc(sizeof(struct node));\n    seven-&gt;data = 7;\n    seven-&gt;left = eight;\n    seven-&gt;right = NULL;\n\n    struct node *two = malloc(sizeof(struct node));\n    two-&gt;data = 2;\n    two-&gt;left = six;\n    two-&gt;right = seven;\n\n    struct node *three = malloc(sizeof(struct node));\n    three-&gt;data = 3;\n    three-&gt;left = five;\n    three-&gt;right = two;\n\n    top_view(three);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3366, "user_id": 2193418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12788df365569bd764b6c51f7ed22199?s=128&d=identicon&r=PG&f=1", "display_name": "lqhcpsgbl", "link": "https://stackoverflow.com/users/2193418/lqhcpsgbl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 44291490, "answer_count": 2, "score": 0, "last_activity_date": 1496286626, "creation_date": 1496241053, "last_edit_date": 1496286626, "question_id": 44287551, "link": "https://stackoverflow.com/questions/44287551/binary-tree-top-view-segmentation-fault", "title": "Binary Tree Top View Segmentation Fault", "body": "<p>I am trying to solve a problem about binary tree, but I got something wrong with build a tree, maybe. It seems wired to me, why I got segmentation fault when I try to print out the data of a node:</p>\n\n<pre><code>//      3\n//    /   \\\n//   5     2\n//  / \\   / \\\n// 1   4 6   7\n//  \\       /\n//   9     8\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct node\n{\n    int data;\n    struct node* left;\n    struct node* right;\n};\n\nvoid top_view(struct node * root) {\n\n    int array[100] = {0};\n    int count = 0;\n    struct node * temp;\n\n    if (root) {\n        if (root-&gt;left) {\n            temp = root;\n            while (temp-&gt;left) {\n                printf(\"%d \", temp-&gt;left-&gt;data);\n                // array[count] = temp-&gt;left-&gt;data;\n                count++;\n                temp = temp-&gt;left;\n            }\n        }\n        array[count] = root-&gt;data;\n        printf(\"%d\\n\", array[count]);\n\n        if (root-&gt;right != NULL) {\n            printf(\"right %d\\n\", root-&gt;right-&gt;data);\n            temp = root;\n            printf(\"%p\\n\", temp-&gt;right-&gt;right);\n            printf(\"%d\\n\", temp-&gt;right-&gt;right-&gt;data);\n        }\n\n        // for (int i = 0; i &lt; 100; i++) {\n        //     printf(\"%d \", array[i]);\n        // }\n\n    } else {\n        return ;\n    }\n\n}\n\n\n\nint main(int argc, char const *argv[])\n{\n    // struct node *nine = (struct node*)malloc(sizeof(struct node*));\n    // nine-&gt;data = 9;\n    // nine-&gt;left = NULL;\n    // nine-&gt;right = NULL;\n\n    // struct node *ten = (struct node*)malloc(sizeof(struct node*));\n    // ten-&gt;data = 10;\n    // ten-&gt;left = NULL;\n    // ten-&gt;right = NULL;\n\n    // struct node *one = (struct node*)malloc(sizeof(struct node*));\n    // one-&gt;data = 1;\n    // one-&gt;left = ten;\n    // one-&gt;right = nine;\n\n    // struct node *four = (struct node*)malloc(sizeof(struct node*));\n    // four-&gt;data = 4;\n    // four-&gt;left = NULL;\n    // four-&gt;right = NULL;\n\n    // struct node *five = (struct node*)malloc(sizeof(struct node*));\n    // five-&gt;data = 5;\n    // five-&gt;left = one;\n    // five-&gt;right = four;\n\n    struct node *eight = (struct node*)malloc(sizeof(struct node*));\n    eight-&gt;data = 8;\n    eight-&gt;left = NULL;\n    eight-&gt;right = NULL;\n\n    struct node *six = (struct node*)malloc(sizeof(struct node*));\n    six-&gt;data = 6;\n    six-&gt;left = NULL;\n    six-&gt;right = NULL;\n\n    struct node *seven = (struct node*)malloc(sizeof(struct node*));\n    seven-&gt;data = 7;\n    seven-&gt;left = eight;\n    seven-&gt;right = NULL;\n\n    struct node *two = (struct node*)malloc(sizeof(struct node*));\n    two-&gt;data = 2;\n    two-&gt;left = six;\n    two-&gt;right = seven;\n\n    struct node *three = (struct node*)malloc(sizeof(struct node*));\n    three-&gt;data = 3;\n    three-&gt;left = NULL;\n    three-&gt;right = two;\n\n    top_view(three);\n\n    return 0;\n}\n</code></pre>\n\n<p>the output is this way:</p>\n\n<pre><code>3\nright 2\n0x7fc800000003\n[1]    2091 segmentation fault  ./a.out\n</code></pre>\n\n<p>where I went wrong with it?</p>\n"}, {"tags": ["c", "assembly", "x86", "instructions"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1496241472, "post_id": 44287482, "comment_id": 75582159, "body": "You should inspect non-debug code - i.e. code that has these unnecessary stores elided."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1496241886, "post_id": 44287482, "comment_id": 75582460, "body": "Compilers usually use very simple rules to break your source code down into a sequence of primitive steps (sometimes called &quot;intermediate code&quot;.) Then, they <i>optimize</i> the intermediate code to eliminate steps that are redundant or wasteful.  You appear to have compiled this code with optimizations turned off."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1496241957, "post_id": 44287482, "comment_id": 75582529, "body": "You compiled your code without optimizations. Unsurprisingly, compilers emit useless weird code when you tell them not to optimize!"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1496242319, "post_id": 44287482, "comment_id": 75582810, "body": "@fuz Your statement sounds a little like &quot;compiler suppliers make the difference between optimised output and non-optimised output by introducing chaff into the non-optimized output&quot;. I think the compiler suppliers could see that as an insult. Also, in my experience, the optimised version is much weirder, but with good, if complex, reasons."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1496246175, "post_id": 44287482, "comment_id": 75585558, "body": "@Yunnosch At least gcc turns off register allocation, uses a simpler instruction selector and generates extra shitty code without optimization. That requires extra code to support, so in a sense, yes, compiler writers do make code extra shitty without optimizations."}], "answers": [{"comments": [{"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1496241677, "post_id": 44287596, "comment_id": 75582307, "body": "Or, instead of eliminating the local variable, <code>a</code> from the source code, the programmer could turn on optimizations and let the compiler do it.  It might not be obvious from this simple example, but hand-optimizing source code usually makes it less readable, and usually is not as effective as letting the compiler do it."}, {"owner": {"reputation": 872, "user_id": 8077259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1wSe.jpg?s=128&g=1", "display_name": "caylee", "link": "https://stackoverflow.com/users/8077259/caylee"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1496241812, "post_id": 44287596, "comment_id": 75582397, "body": "You&#39;re absolutely right. My example should just show why the assembly lines come up."}], "tags": [], "owner": {"reputation": 872, "user_id": 8077259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1wSe.jpg?s=128&g=1", "display_name": "caylee", "link": "https://stackoverflow.com/users/8077259/caylee"}, "is_accepted": true, "score": 2, "last_activity_date": 1496241884, "last_edit_date": 1496241884, "creation_date": 1496241198, "answer_id": 44287596, "question_id": 44287482, "link": "https://stackoverflow.com/questions/44287482/troubleshooting-the-sense-of-this-asm-x86-code/44287596#44287596", "title": "Troubleshooting the sense of this asm x86 code", "body": "<p>The lines are seperate from each other:</p>\n\n<p>The first line belongs to the line <code>char* a = \"AAAA\";</code>, saving the value of the variable to RAM.</p>\n\n<p>The second line accesses the variable from RAM for the line <code>printf(\"%s\", a);</code> as the parameter.</p>\n\n<p>Technically, both lines would be optional, as you could have written:</p>\n\n<pre><code>printf(\"%s\", \"AAAA\");\n</code></pre>\n\n<p><strong>EDIT:</strong> For skipping this unnecessary code, you could enable automatic optimizations (for GCC: -O2)</p>\n"}, {"comments": [{"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1496248782, "post_id": 44289327, "comment_id": 75587120, "body": "OP wasn&#39;t asking what does <code>local_8h</code> mean.  OP was asking what is the purpose of the second instruction when the value that it loads into <code>rax</code> can not possibly be different from the value that already is in <code>rax</code>?  Answer is, because each of the two lines was generated from a different source code line, and optimization was turned off."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 0, "last_activity_date": 1496245808, "creation_date": 1496245808, "answer_id": 44289327, "question_id": 44287482, "link": "https://stackoverflow.com/questions/44287482/troubleshooting-the-sense-of-this-asm-x86-code/44289327#44289327", "title": "Troubleshooting the sense of this asm x86 code", "body": "<p>The problem is that your disassembler is broken (or at least \"too smart\") and \"helpfully\" giving you different, confusing, information from what one would normally expect.  These two lines:</p>\n\n<pre><code>|           0x000006af      488945f8       mov qword [local_8h], rax            \n|           0x000006b3      488b45f8       mov rax, qword [local_8h]\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>|           0x000006af      488945f8       mov qword [rbp-8h], rax            \n|           0x000006b3      488b45f8       mov rax, qword [rbp-8h]\n</code></pre>\n\n<p>They access memory in the stack frame indirectly via the <code>rbp</code> register.  Such memory is used by the compiler for local variables, thus the \"local\" in what the disassembler is showing.</p>\n"}], "owner": {"reputation": 21, "user_id": 8092568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaa0de9da5e43c43cb1ab0cc61ce8ca?s=128&d=identicon&r=PG&f=1", "display_name": "joe Doe", "link": "https://stackoverflow.com/users/8092568/joe-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 44287596, "answer_count": 2, "score": 1, "last_activity_date": 1496245808, "creation_date": 1496240890, "question_id": 44287482, "link": "https://stackoverflow.com/questions/44287482/troubleshooting-the-sense-of-this-asm-x86-code", "title": "Troubleshooting the sense of this asm x86 code", "body": "<p>First of all, here is the assembler code:</p>\n\n<pre><code>/           0x000006a0      55             push rbp                             \n|           0x000006a1      4889e5         mov rbp, rsp                         \n|           0x000006a4      4883ec10       sub rsp, 0x10                        \n|           0x000006a8      488d05b50000.  lea rax, str.AAAA           ; 0x764  \n\n|           0x000006af      488945f8       mov qword [local_8h], rax  \n|           0x000006b3      488b45f8       mov rax, qword [local_8h]\n\n|           0x000006b7      4889c6         mov rsi, rax                         \n|           0x000006ba      488d3da80000.  lea rdi, 0x00000769         ; \"%s\"   \n|           0x000006c1      b800000000     mov eax, 0                           \n|           0x000006c6      e895feffff     call sym.imp.printf         ;[2] ; i \n|           0x000006cb      b800000000     mov eax, 0                           \n|           0x000006d0      c9             leave                                \n\\           0x000006d1      c3             ret  \n</code></pre>\n\n<p>to this c program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n\n    char* a = \"AAAA\";\n\n    printf(\"%s\", a);\n    return 0;\n}\n</code></pre>\n\n<p>Especially I have a question to this code snipped:</p>\n\n<pre><code>|           0x000006af      488945f8       mov qword [local_8h], rax            \n|           0x000006b3      488b45f8       mov rax, qword [local_8h]\n</code></pre>\n\n<p>What is the sense of these two instructions? I only see the same instruction one way and than reversed. But why is that?</p>\n\n<p>Here are some further information to the executable:</p>\n\n<pre><code>blksz    0x0\nblock    0x100\nfd       6\nfile     demo\nformat   elf64\niorw     false\nmode     -r--\nsize     0x20e0\nhumansz  8.2K\ntype     DYN (Shared object file)\narch     x86\nbinsz    6559\nbintype  elf\nbits     64\ncanary   false\nclass    ELF64\ncrypto   false\nendian   little\nhavecode true\nintrp    /lib64/ld-linux-x86-64.so.2\nlang     c\nlinenum  true\nlsyms    true\nmachine  AMD x86-64 architecture\nmaxopsz  16\nminopsz  1\nnx       true\nos       linux\npcalign  0\npic      true\nrelocs   true\nrelro    partial relro\nrpath    NONE\nstatic   false\nstripped false\nsubsys   linux\nva       true\n</code></pre>\n"}, {"tags": ["c", "networking", "wireshark", "pcap"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1496240444, "post_id": 44287013, "comment_id": 75581352, "body": "It is not really stored in pcap files, but it can often be derived from the l2-header. This of course doesn&#39;t apply to incoming packets to broadcast/multicast or when the interface is in promiscuous mode"}, {"owner": {"reputation": 1, "user_id": 7320623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e153a4facef529fa15644db870bb3ba?s=128&d=identicon&r=PG&f=1", "display_name": "Rotato", "link": "https://stackoverflow.com/users/7320623/rotato"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1496241795, "post_id": 44287013, "comment_id": 75582388, "body": "Thanks for the answer!                                                 I&#39;m spying for example on 2 links, one between a computer and a switch, and one between the same switch and a second computer. So if I send a frame from the first to the second computer, the two captured frame (more like the same frame captured two times, before and after the switch) will have the same ethernet header so it won&#39;t help me to find which &quot;interfaces&quot; (which network tap) captured which frame."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1496241886, "post_id": 44287013, "comment_id": 75582461, "body": "Correct. Dump the links to different filenames to distinguish between them."}, {"owner": {"reputation": 1, "user_id": 7320623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e153a4facef529fa15644db870bb3ba?s=128&d=identicon&r=PG&f=1", "display_name": "Rotato", "link": "https://stackoverflow.com/users/7320623/rotato"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1496242453, "post_id": 44287013, "comment_id": 75582918, "body": "Yeah that&#39;s a clever workaround, thanks! I actually never saw the option &quot;marked packets only&quot; when yoh save a wireshark capture as I&#39;m a newbie to wireshark. Thanks a lot!"}], "owner": {"reputation": 1, "user_id": 7320623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e153a4facef529fa15644db870bb3ba?s=128&d=identicon&r=PG&f=1", "display_name": "Rotato", "link": "https://stackoverflow.com/users/7320623/rotato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 297, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496239611, "creation_date": 1496239611, "question_id": 44287013, "link": "https://stackoverflow.com/questions/44287013/getting-which-interface-received-each-packet-when-reading-pcap-files", "title": "Getting which interface received each packet when reading pcap files", "body": "<p>I'm using multiple network taps to listen on some links of an ethernet network. They're are connected to a computer on which I capture all the traffic that passes through those links, and I save that capture in order to analyze it with a C program that I wrote using pcap library.</p>\n\n<p>My problem is that I can't retrieve the interface on which each packets have been captured. This information is not present in the struct pcap_pkthdr. It should though be possible to get that information using the pcap library as wireshark indicates it on its user interface.</p>\n\n<p>Would someone know how to find this information about packets stored in pcap files?</p>\n"}, {"tags": ["c", "function", "struct", "linked-list", "parameter-passing"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1496239173, "post_id": 44286735, "comment_id": 75580390, "body": "<code>StudentList.Student = &amp;b;</code>: overwrites the pointer with the last one (c)..."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1496239303, "post_id": 44286735, "comment_id": 75580484, "body": "Your list only ever contains one node - also surprised that you don&#39;t get warnings/errors for the definition of <code>addStudent</code> as it differs from how you&#39;re using it."}, {"owner": {"reputation": 53, "user_id": 8083327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa7b2c05335ddecd4751e19753644ff8?s=128&d=identicon&r=PG&f=1", "display_name": "evangelia", "link": "https://stackoverflow.com/users/8083327/evangelia"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1496239404, "post_id": 44286735, "comment_id": 75580557, "body": "@Jean-Fran&#231;ois Fabre  I can not understand how I could resolve it ..."}, {"owner": {"reputation": 53, "user_id": 8083327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa7b2c05335ddecd4751e19753644ff8?s=128&d=identicon&r=PG&f=1", "display_name": "evangelia", "link": "https://stackoverflow.com/users/8083327/evangelia"}, "edited": false, "score": 0, "creation_date": 1496239490, "post_id": 44286735, "comment_id": 75580618, "body": "@ Chris Turner  I am using Dev-C++ compiler ... and I have no errors either warnings ..."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8092466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d80b99a866c41865d6264be5383edf56?s=128&d=identicon&r=PG&f=1", "display_name": "matt.robinson17", "link": "https://stackoverflow.com/users/8092466/matt-robinson17"}, "reply_to_user": {"reputation": 53, "user_id": 8083327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa7b2c05335ddecd4751e19753644ff8?s=128&d=identicon&r=PG&f=1", "display_name": "evangelia", "link": "https://stackoverflow.com/users/8083327/evangelia"}, "edited": false, "score": 1, "creation_date": 1496240369, "post_id": 44287012, "comment_id": 75581297, "body": "I usually dont like to change the format of the code as you may have your own reasons for doing things how you did. However, it might make more sense to store the pointer to the next node inside the Student struct. Then you could use the list struct to store things relative to the entire list. Like a head/tail pointer and all of your insert/pop/etc methods. That way, students would be individual nodes in your list. You would have only 1 list object to store the entire list."}], "tags": [], "owner": {"reputation": 29, "user_id": 8092466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d80b99a866c41865d6264be5383edf56?s=128&d=identicon&r=PG&f=1", "display_name": "matt.robinson17", "link": "https://stackoverflow.com/users/8092466/matt-robinson17"}, "is_accepted": false, "score": 1, "last_activity_date": 1496239610, "creation_date": 1496239610, "answer_id": 44287012, "question_id": 44286735, "link": "https://stackoverflow.com/questions/44286735/linked-lists-and-structures-in-c-passing-linked-list-and-structures-as-paramet/44287012#44287012", "title": "Linked Lists and Structures in C - Passing Linked List and Structures as Parameters in function (C)", "body": "<p>The addStudent method always overwrites previous nodes. So your list only ever contains 1 node. Also, to \"store\" a linked list, you would want to keep a pointer to the head (first element) of the list.</p>\n"}, {"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1496241743, "post_id": 44287085, "comment_id": 75582345, "body": "<code>elem-&gt;next-&gt;student = b;</code> assigns a <code>Student</code> to a <code>Student*</code> That is illegal"}, {"owner": {"reputation": 53, "user_id": 8083327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa7b2c05335ddecd4751e19753644ff8?s=128&d=identicon&r=PG&f=1", "display_name": "evangelia", "link": "https://stackoverflow.com/users/8083327/evangelia"}, "edited": false, "score": 0, "creation_date": 1496305118, "post_id": 44287085, "comment_id": 75609504, "body": "@elfuretto thank you for your help! but I have to create a body for the &quot;int addStudent(Student b, list StudentList)&quot;. It is not permitted to change the declaration of this function ...."}, {"owner": {"reputation": 13, "user_id": 8092330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5c72acbc1a54f0d7256eb0bf090445?s=128&d=identicon&r=PG&f=1", "display_name": "el furetto", "link": "https://stackoverflow.com/users/8092330/el-furetto"}, "edited": false, "score": 0, "creation_date": 1496314172, "post_id": 44287085, "comment_id": 75616080, "body": "You can&#39;t give a pointer parameters : int x=addStudent(b,StudentList); And call your fonction with a simple structure : int addStudent(Student b, list StudentList) What is the part of code you can change exactly ? only the addstudent body ? cause there is some problems in your code. Last question, is this a school project ?"}], "tags": [], "owner": {"reputation": 13, "user_id": 8092330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5c72acbc1a54f0d7256eb0bf090445?s=128&d=identicon&r=PG&f=1", "display_name": "el furetto", "link": "https://stackoverflow.com/users/8092330/el-furetto"}, "is_accepted": false, "score": 1, "last_activity_date": 1496244752, "last_edit_date": 1496244752, "creation_date": 1496239827, "answer_id": 44287085, "question_id": 44286735, "link": "https://stackoverflow.com/questions/44286735/linked-lists-and-structures-in-c-passing-linked-list-and-structures-as-paramet/44287085#44287085", "title": "Linked Lists and Structures in C - Passing Linked List and Structures as Parameters in function (C)", "body": "<p>Use a while to go to the last element with a pointer, then create your new element in your list\n    <code>\n    void addStudent(Student *b, list *StudentList)\n    list *elem;\n    elem = StudentList;\n    while (elem-&gt;next)\n        elem = elem-&gt;next;\n    //now you can create your elem\n    elem-&gt;next = malloc(sizeof(list));\n    elem-&gt;next-&gt;student = b;\n    elem-&gt;next-&gt;next = NULL;\n</code></p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1496241501, "last_edit_date": 1496241501, "creation_date": 1496239884, "answer_id": 44287109, "question_id": 44286735, "link": "https://stackoverflow.com/questions/44286735/linked-lists-and-structures-in-c-passing-linked-list-and-structures-as-paramet/44287109#44287109", "title": "Linked Lists and Structures in C - Passing Linked List and Structures as Parameters in function (C)", "body": "<p>You have two problems:</p>\n\n<p>1) You add the address of a local variable to the list</p>\n\n<p>2) You never expand the list, i.e. it always contain a single element</p>\n\n<p>To solve problem 1) change the <code>addStudent</code> function like:</p>\n\n<pre><code>int addStudent(Student* b, list* StudentList){\n                     ^^^     ^^^\n                   Use a pointer\n\n    StudentList-&gt;Student = b;\n                         ^^^\n                       Save the pointer\n\n    return 1;\n}\n</code></pre>\n\n<p>and call it like:</p>\n\n<pre><code>int x=addStudent(&amp;b, StudentList);\n                 ^^\n</code></pre>\n\n<p>To solve problem 2):</p>\n\n<p>You need to <code>malloc</code> a new list item and insert it into the current list.</p>\n\n<p>However, your current code is a bit strange as you also allocate a <code>list</code> in <code>main</code> but puts nothing into it. Instead it would seem better to only allocate <code>list</code> items in the <code>addStudent</code> function.</p>\n\n<p>A simple way to do that is:</p>\n\n<pre><code>// This function inserts new item in the front of the list\nlist*  addStudent(Student* b, list* StudentList){\n    list* t;\n    t = malloc(sizeof(list));\n    if (!t) exit(1);\n    t-&gt;next = StudentList;\n    t-&gt;Student = b;\n    return t;\n}\n\nint main()\n{\n    Student b={\"name 1\",\"Surname 1\",male,22,{\"Lesson 1\"}};  \n    Student c={\"name 2\",\"Surname 2\",female,32,{\"Lesson 2\"}};  \n\n    list* StudentList = NULL;\n\n    StudentList = addStudent(&amp;b, StudentList);\n    StudentList = addStudent(&amp;c, StudentList);\n\n    printlist(StudentList);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8083327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa7b2c05335ddecd4751e19753644ff8?s=128&d=identicon&r=PG&f=1", "display_name": "evangelia", "link": "https://stackoverflow.com/users/8083327/evangelia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1496305223, "creation_date": 1496238905, "last_edit_date": 1496305223, "question_id": 44286735, "link": "https://stackoverflow.com/questions/44286735/linked-lists-and-structures-in-c-passing-linked-list-and-structures-as-paramet", "title": "Linked Lists and Structures in C - Passing Linked List and Structures as Parameters in function (C)", "body": "<p>I have the following code and I am trying to make it more dynamic and reusable.\nWell, I have a struct named Student and struct list, which contains all the added students. I have a function \"int addStudent(Student b, list StudentList){\", and I am trying to pass the structs Student and StudentList as parameters. But the problem is that I am doing something wrong and my list does not contains all the Students added. It contains only the last one.\nCan you help me?</p>\n\n<p><strong>NOTE: I have to create a body for the <code>\"int addStudent(Student b, list StudentList)\"</code>. It is not permitted to change the declaration of this function</strong> ... this is very difficult for me and I need suggestions to work on ...</p>\n\n<p>thank you in advance!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAXSTRING 100\n#define MAXLessonS 100\n\ntypedef  enum genders{\n    female, \n    male\n} genders;\n\ntypedef struct Student\n{\n    char name[MAXSTRING];\n    char Surname[MAXSTRING];\n    enum genders gender;\n    int id;\n    char Lessons[MAXLessonS][MAXSTRING];\n} Student;\n\n\ntypedef struct list \n{\n    struct list * next;\n    struct Student * Student;\n} list;\n\nvoid printlist(list * StudentList) \n{\n    list * current = StudentList;\n    while (current != NULL) {\n        printf(\"Student ID      = %d\\n\", current-&gt;Student-&gt;id);\n        printf(\"Student name    = %s\\n\", current-&gt;Student-&gt;name);\n        printf(\"Student Surname = %s\\n\", current-&gt;Student-&gt;Surname);\n        printf(\"Student gender  = %d\\n\", current-&gt;Student-&gt;gender);\n        printf(\"Student Lesson  = %s\\n\", current-&gt;Student-&gt;Lessons);     \n        current = current-&gt;next;\n    }\n}\n\n\nint main()\n{\n    Student b={\"name 1\",\"Surname 1\",male,22,{\"Lesson 1\"}};  \n    Student c={\"name 2\",\"Surname 2\",female,32,{\"Lesson 2\"}};  \n\n    list* StudentList = NULL;\n    StudentList = malloc(sizeof(list));\n    StudentList-&gt;next = NULL;\n    //StudentList-&gt;next-&gt;next = NULL;\n\n    int x=addStudent(b,StudentList);\n    StudentList-&gt;next=NULL;\n    int xx=addStudent(c,StudentList);\n\n    printlist(StudentList);\n    return 0;\n}\n\nint addStudent(Student b, list StudentList){\n    //StudentList=malloc(sizeof(list));\n    StudentList.Student = &amp;b;\n    //StudentList.next-&gt;next=NULL; \n    //free(StudentList);\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "tcp", "linux-kernel", "kernel"], "owner": {"reputation": 35, "user_id": 2354874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d414d3a4143e523caf6a4a4ff69dac?s=128&d=identicon&r=PG", "display_name": "Luka Kunej", "link": "https://stackoverflow.com/users/2354874/luka-kunej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 477, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496238881, "creation_date": 1496238288, "last_edit_date": 1496238881, "question_id": 44286502, "link": "https://stackoverflow.com/questions/44286502/linux-implementation-tcp-rto-calculation", "title": "Linux implementation - TCP RTO calculation", "body": "<p>While reading the book \"TCP/IP illustrated Volume 1\" by Richard Stevens I ran into the information that there was a improvement in TCP regarding the calculation of RTO. </p>\n\n<p>The book states there are some possible problems in the standard approach because it uses a heavy weight given to the <em>rttvar</em> term. This can cause RTO to increase even if the RTT is decreasing. </p>\n\n<p>It later states that linux handles the case where the RTT is decreasing by giving it less weight to the new sample if it's below the \"lower end\" of the estimated RTT range (<em>srtt - mdev</em>) and provides the code snip:</p>\n\n<pre><code>if(m &lt; (srtt - mdev))\n    mdev = (31/32) * mdev + (1/32) * |srtt - m|\nelse\n    mdev = (3/4) * mdev + (1/4) * |srtt - m|\n</code></pre>\n\n<p>Where:\nsrtt = smooth round trip time, mdev = deviations of the new measurement vs srtt, and m = new rtt measurement. </p>\n\n<p>My problem is that I can't find this improvement in any linux distribution source code. The function <strong>static void tcp_rtt_estimator(struct sock *sk, long mrtt_us)</strong> inside linux's <strong>tcp_input.c</strong> file work's as described in RFC 6298, but I can't find the improvement mentioned in Steven's book.</p>\n\n<p>My question is was this improvement not implemented due to the unlikeliness of this problem accuring, or maybe was implemented in some versions but removed after testing and getting unsatisfying results, or something else? </p>\n\n<p>I've also come apon the information that there was a Technical conference in 2002 that addressed this improvement. (Proceedings of the FREENIX Track: 2002 USENIX Annual Technical Conference), but couldn't find what their conclusion was.</p>\n\n<p>If anyone has any information on the topic, I'd be very thankful.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1496236251, "post_id": 44285635, "comment_id": 75578186, "body": "You need to show more of the code including how the function is used.  Links to source are not appropriate for SO questions."}, {"owner": {"reputation": 218, "user_id": 2946062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05de1b7d2101dbf786bf65557ee212ed?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/2946062/howard"}, "edited": false, "score": 0, "creation_date": 1496236271, "post_id": 44285635, "comment_id": 75578209, "body": "<code>malloc</code> and <code>free</code> are the old C-style way of solving this problem. In c++ we have smart ptrs, as you mentioned <code>unique_ptr</code>. The smart ptrs offer free memory management for pointers (i.e. you don&#39;t have to clean up after yourself), and are the more preferred way to solve this problem in c++"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1496237174, "post_id": 44285635, "comment_id": 75578909, "body": "You should decide which language you are talking about. C and C++ are totally different languages. There is no such thing as <code>std::unique_ptr</code> in C."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1496237055, "post_id": 44285982, "comment_id": 75578800, "body": "Change <i>But since it now points to a local, the changes it makes are not seen outside the function.</i> to <i>But since <code>ret_ptr</code> is local, the changes made to it are not seen outside the function.</i>?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1496237697, "post_id": 44285982, "comment_id": 75579276, "body": "@NathanOliver I made changes to basically include both statements."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1496238062, "post_id": 44285982, "comment_id": 75579575, "body": "@dbush Thanks.  Great answer."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1496239767, "post_id": 44285982, "comment_id": 75580851, "body": "IMO you should have deleted your answer and posted the corrected interpretation in a new one; many original votes on this answer are for completely different content. Regardless, the new one is right."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 8, "last_activity_date": 1496238254, "last_edit_date": 1496238254, "creation_date": 1496236820, "answer_id": 44285982, "question_id": 44285635, "link": "https://stackoverflow.com/questions/44285635/pointer-to-local-variable-is-stored-outside-the-scope-of-this-variable/44285982#44285982", "title": "Pointer to local variable is stored outside the scope of this variable", "body": "<p>The <code>ret_ptr</code> parameter to the function in question is expected to point to a variable in the calling function.  This pointer is then dereferenced for both reading and writing this external variable.</p>\n\n<p>The <code>if (ret_ptr == NULL)</code> block checks whether the caller actually passed in the address of some variable.  If not, this pointer is then made to point to the local variable <code>unused</code> so that the pointer can still be safely dereferenced later in the code.  But since <code>ret_ptr</code> now points to a local, changes made by dereferencing it are not seen outside the function.  This is fine, since the caller passed in <code>NULL</code> for <code>ret_ptr</code>.  Similarly, since <code>ret_ptr</code> is a parameter, any changes to it are not visible outside of the function.</p>\n\n<p>Nothing needs to be refactored here. The code works as intended with regard to <code>ret_ptr</code>. This is a false positive from PVS-Studio.</p>\n\n<p>EDIT:</p>\n\n<p>This is <strong>NOT</strong> a false positive.  The <code>unused</code> variable is defined at a lower scope than <code>ret_ptr</code>, namely the scope of the first <code>if</code> block in the function.  After the <code>if</code> block, <code>ret_ptr</code> is then dereferenced.  If it was pointing to <code>ununsed</code>, that variable is now out of scope and dereferencing <code>ret_ptr</code> invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>To fix this, <code>unused</code> must be declared and assigned to above the <code>if</code> block:</p>\n\n<pre><code>gearman_job_st *gearman_worker_grab_job(gearman_worker_st *worker_shell,\n                                        gearman_job_st *job,\n                                        gearman_return_t *ret_ptr)\n{\n    gearman_return_t unused;\n    if (ret_ptr == NULL)\n    {\n        ret_ptr= &amp;unused;\n    }\n\n    if (worker_shell and worker_shell-&gt;impl())\n    {\n        ...\n    }\n\n    assert(*ret_ptr != GEARMAN_MAX_RETURN);\n    return NULL;\n}\n</code></pre>\n"}], "owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 1, "accepted_answer_id": 44285982, "answer_count": 1, "score": 1, "last_activity_date": 1496238254, "creation_date": 1496235890, "last_edit_date": 1496237871, "question_id": 44285635, "link": "https://stackoverflow.com/questions/44285635/pointer-to-local-variable-is-stored-outside-the-scope-of-this-variable", "title": "Pointer to local variable is stored outside the scope of this variable", "body": "<p>For the following code snippet, which is a part of <a href=\"https://github.com/p-alik/gearmand/blob/master/libgearman/worker.cc#L668-L672\" rel=\"nofollow noreferrer\">libgearman</a></p>\n\n<pre><code>gearman_job_st *gearman_worker_grab_job(gearman_worker_st *worker_shell,\n                                        gearman_job_st *job,\n                                        gearman_return_t *ret_ptr)\n{\n    if (worker_shell and worker_shell-&gt;impl())\n    {\n\n        ...\n\n        gearman_return_t unused;\n        if (ret_ptr == NULL)\n        {\n            ret_ptr= &amp;unused;\n        }\n        ...\n    }\n\n    assert(*ret_ptr != GEARMAN_MAX_RETURN);\n    return NULL;\n}\n</code></pre>\n\n<p><a href=\"https://www.viva64.com/en/w/V507/\" rel=\"nofollow noreferrer\">PVS-Studio</a> reported:</p>\n\n<pre><code>Viva64-EM\nfull\n671\n/nfs/home/xxx/src/gearmand/libgearman/worker.cc\nerror\nV506\nPointer to local variable 'unused' is stored outside the scope of this variable. Such a pointer will become invalid.\nfalse\n2\n    {\n      ret_ptr= &amp;unused;\n    }\n------------\n</code></pre>\n\n<p>Regarding the question <a href=\"https://stackoverflow.com/a/18473875/2789312\">Pointer to local variable outside the scope of its declaration</a>, if I understand that correctly, <code>malloc</code> and <code>free</code> should be used for refactoring. My question is if there is an other appropriate refactoring alternative. For instance using of <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow noreferrer\">std::unique_ptr</a>:</p>\n\n<p><code>ret_ptr = std::make_unique&lt;gearman_return_t&gt;();</code></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1496235440, "post_id": 44285364, "comment_id": 75577521, "body": "Did you read the warning until the end?"}, {"owner": {"reputation": 324, "user_id": 5420223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1899173098022a1cbaa366f11b7f1afd?s=128&d=identicon&r=PG&f=1", "display_name": "NeilB", "link": "https://stackoverflow.com/users/5420223/neilb"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1496236116, "post_id": 44285364, "comment_id": 75578067, "body": "@DeiDei: I see it now. &quot;warning: type defaults to \u2018int\u2019 in declaration of \u2018j\u2019&quot; is  actually telling that j=20 is a declaration. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 2, "creation_date": 1496235730, "post_id": 44285512, "comment_id": 75577736, "body": "Note that implicit int is only valid in C89 and invalid in C99 and later."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1496236123, "post_id": 44285512, "comment_id": 75578073, "body": "@DeiDei You are right, I should mention that this practice has been prohibited for quite a while."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1496236351, "post_id": 44285512, "comment_id": 75578252, "body": "The tentative definitions are also legal in C99 and C11. It is only the implicit int that &quot;stopped working&quot; in C99"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 6, "last_activity_date": 1496236631, "last_edit_date": 1496236631, "creation_date": 1496235537, "answer_id": 44285512, "question_id": 44285364, "link": "https://stackoverflow.com/questions/44285364/do-int-i-10-and-int-i-i-10-perform-different-functions-when-i-is-a-glob/44285512#44285512", "title": "Do &quot;int i = 10;&quot; and &quot;int i; i=10;&quot; perform different functions when i is a global variable?", "body": "<p>This line</p>\n\n<pre><code>j=20;\n</code></pre>\n\n<p>is not an assignment. It is a declaration of <code>j</code>, which uses an implicit type of <code>int</code>.</p>\n\n<p>C let you make multiple declarations of the same variable in the global scope, as long as they match:</p>\n\n<pre><code>int j;\nint j;\nint j = 20;\n</code></pre>\n\n<p>Pre-C99 C standards also assume the type of <code>int</code> when you do not specify any type.</p>\n\n<p>Here is how you can break your example:</p>\n\n<pre><code>double j;\nj = 20;\n</code></pre>\n\n<p>This does not compile, because <code>j</code> is declared as <code>double</code> and then re-declared as an <code>int</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 8044309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b31932d40f246c077a5a929d7f8fea2d?s=128&d=identicon&r=PG&f=1", "display_name": "Luca_65", "link": "https://stackoverflow.com/users/8044309/luca-65"}, "is_accepted": false, "score": 0, "last_activity_date": 1496260129, "creation_date": 1496260129, "answer_id": 44293527, "question_id": 44285364, "link": "https://stackoverflow.com/questions/44285364/do-int-i-10-and-int-i-i-10-perform-different-functions-when-i-is-a-glob/44293527#44293527", "title": "Do &quot;int i = 10;&quot; and &quot;int i; i=10;&quot; perform different functions when i is a global variable?", "body": "<p>int i;\nIs a tentative definition.\nThe following definition I=10; convert it to a declaration.</p>\n"}], "owner": {"reputation": 324, "user_id": 5420223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1899173098022a1cbaa366f11b7f1afd?s=128&d=identicon&r=PG&f=1", "display_name": "NeilB", "link": "https://stackoverflow.com/users/5420223/neilb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 44285512, "answer_count": 2, "score": 2, "last_activity_date": 1496260129, "creation_date": 1496235134, "last_edit_date": 1496236137, "question_id": 44285364, "link": "https://stackoverflow.com/questions/44285364/do-int-i-10-and-int-i-i-10-perform-different-functions-when-i-is-a-glob", "title": "Do &quot;int i = 10;&quot; and &quot;int i; i=10;&quot; perform different functions when i is a global variable?", "body": "<p>Please refer the program shown below. I get the following compiler warnings.</p>\n\n<p>bash-3.2$ gcc -Wall test1.c\ntest1.c:6: warning: data definition has no type or storage class\ntest1.c:6: warning: type defaults to \u2018int\u2019 in declaration of \u2018j\u2019</p>\n\n<p>Usually this warning is thrown when runtime operation is written outside the function. So I am questioning why in a global scope, \"int j; j=20\" throws warning but \"int i = 10\" does not?</p>\n\n<pre><code>   #include &lt;stdio.h&gt;\n\n   int i = 10;\n\n   int j;\n   j=20;\n\n   int\n   main(void)\n   {\n       int k;\n\n       k = 30;\n\n       printf(\"%d %d %d\\n\", i, j, k);\n\n       return 0;\n   }\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "multidimensional-array"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1496232505, "post_id": 44284362, "comment_id": 75575385, "body": "&quot;Even though s[2] and (s+2) refer to the same address, &quot; - they do not!"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496232661, "post_id": 44284362, "comment_id": 75575506, "body": "To begin with you have <i>undefined behavior</i> because you use the wrong format for the wrong type. <code>s[2]</code> is an array that decays to a pointer, <code>*(s + 2)</code> is the exact same as <code>s[2]</code> and as such also is a pointer, and <code>s + 2</code> is also a pointer. For pointers you need to use the <code>&quot;%p&quot;</code> format."}, {"owner": {"reputation": 13, "user_id": 8091711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d84ac8e57af7097de13509dae3e960a?s=128&d=identicon&r=PG&f=1", "display_name": "Manikanta Ankam", "link": "https://stackoverflow.com/users/8091711/manikanta-ankam"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496232688, "post_id": 44284362, "comment_id": 75575529, "body": "918019136 1434 918019136 918019136 This is what the output is. Are you sure they are not pointing to the same address.? @WeatherVane"}, {"owner": {"reputation": 13, "user_id": 8091711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d84ac8e57af7097de13509dae3e960a?s=128&d=identicon&r=PG&f=1", "display_name": "Manikanta Ankam", "link": "https://stackoverflow.com/users/8091711/manikanta-ankam"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496233072, "post_id": 44284362, "comment_id": 75575813, "body": "@Someprogrammerdude . I&#39;ve changed %d to %p (other than *s[2] because it&#39;s obvious that it returns a value) , but the output is same except for the fact that it is printing the addresses in hexadecimal format now. :D"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496233259, "post_id": 44284362, "comment_id": 75575946, "body": "So they do: your code confused me by a) adding a size to part of the variable: the <code>+2</code> is two of <i>what</i> size is not immediately clear, b) using the wrong types. If you have 64 bit pointers, the code would definitely not work."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8091711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d84ac8e57af7097de13509dae3e960a?s=128&d=identicon&r=PG&f=1", "display_name": "Manikanta Ankam", "link": "https://stackoverflow.com/users/8091711/manikanta-ankam"}, "edited": false, "score": 0, "creation_date": 1496234285, "post_id": 44284554, "comment_id": 75576690, "body": "Thankyou :D, you clarified most of the confusion but what is logical address mean.?"}, {"owner": {"reputation": 371, "user_id": 6513366, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yaOsDebgj9o/AAAAAAAAAAI/AAAAAAAAAUw/daIT_fXvT4k/photo.jpg?sz=128", "display_name": "Overflow 404", "link": "https://stackoverflow.com/users/6513366/overflow-404"}, "reply_to_user": {"reputation": 13, "user_id": 8091711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d84ac8e57af7097de13509dae3e960a?s=128&d=identicon&r=PG&f=1", "display_name": "Manikanta Ankam", "link": "https://stackoverflow.com/users/8091711/manikanta-ankam"}, "edited": false, "score": 0, "creation_date": 1496234511, "post_id": 44284554, "comment_id": 75576852, "body": "The logical address is the address at which s reside inside the process space."}], "tags": [], "owner": {"reputation": 371, "user_id": 6513366, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yaOsDebgj9o/AAAAAAAAAAI/AAAAAAAAAUw/daIT_fXvT4k/photo.jpg?sz=128", "display_name": "Overflow 404", "link": "https://stackoverflow.com/users/6513366/overflow-404"}, "is_accepted": false, "score": 0, "last_activity_date": 1496233307, "last_edit_date": 1496233307, "creation_date": 1496232904, "answer_id": 44284554, "question_id": 44284362, "link": "https://stackoverflow.com/questions/44284362/accessing-2d-array-elements-using-pointer-arithmetic-in-c/44284554#44284554", "title": "Accessing 2D array elements using pointer arithmetic in C", "body": "<p>s[2] and (s+2) link to the same address as you can see with a simple printf.\nThen you have an undefined behavior because <code>%d</code> refers to an integer but <code>s[2]</code>, <code>s+2</code> and <code>*(s+2)</code> are pointer and you have to use <code>%p</code> that refers a pointer.\nHere is your code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    int s[4][2] = {\n        {1234,56},\n        {1212,13},\n        {1434,80},\n        {1312,78}\n    };\n    printf(\"%p\\n\",s[2]);\n    printf(\"%d\\n\",*s[2]);\n    printf(\"%p\\n\",s+2);\n    printf(\"%p\\n\",*(s+2));\n    return 0;\n}\n</code></pre>\n\n<p>No, <code>*(s+2)</code> isn't mean <code>s[2][0]</code> it's only the logical address of the second element of s. You have to use <code>*(s[2])</code> for <code>s[2][0]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8091711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d84ac8e57af7097de13509dae3e960a?s=128&d=identicon&r=PG&f=1", "display_name": "Manikanta Ankam", "link": "https://stackoverflow.com/users/8091711/manikanta-ankam"}, "edited": false, "score": 0, "creation_date": 1496239444, "post_id": 44284712, "comment_id": 75580586, "body": "Thankyou for the answer, but it still itches me that if s+1 points to s[1][0], then why does *(s+1) doesn&#39;t print value at that address?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 13, "user_id": 8091711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d84ac8e57af7097de13509dae3e960a?s=128&d=identicon&r=PG&f=1", "display_name": "Manikanta Ankam", "link": "https://stackoverflow.com/users/8091711/manikanta-ankam"}, "edited": false, "score": 0, "creation_date": 1496239683, "post_id": 44284712, "comment_id": 75580781, "body": "@ManikantaAnkam Because <code>s + 1</code> is a <i>pointer</i> to an <i>array</i>, it&#39;s type is <code>int (*)[2]</code>. When you dereference it like <code>*(s + 1)</code> you get something which is of type <code>int[2]</code>, i.e. you get the <i>array</i> <code>s + 1</code> is pointing to. And that decays to a <i>pointer</i> of type <code>int *</code>. To get the value you need <i>another</i> dereference: <code>**(s + 1)</code>, which is equal to <code>s[1][0]</code>."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 6, "last_activity_date": 1496233354, "creation_date": 1496233354, "answer_id": 44284712, "question_id": 44284362, "link": "https://stackoverflow.com/questions/44284362/accessing-2d-array-elements-using-pointer-arithmetic-in-c/44284712#44284712", "title": "Accessing 2D array elements using pointer arithmetic in C", "body": "<p>Lets take a look at how your array look in memory:</p>\n\n<pre>\n+---------+---------+---------+---------+---------+---------+---------+---------+\n| s[0][0] | s[0][1] | s[1][0] | s[1][1] | s[2][0] | s[2][1] | s[3][0] | s[3][1] |\n+---------+---------+---------+---------+---------+---------+---------+---------+\n^         ^         ^                                                           ^\n|         |         |                                                           |\n&s[0][0]  &s[0][1]  &s[1][1]                                                    |\n|                   |                                                           |\n&s[0]               &s[1]                                                       |\n|                   |                                                           |\ns[0]                s[1]                                                        |\n|                   |                                                           |\ns                   s+1                                                         |\n|                                                                               |\n&s                                                                              &s+1\n</pre>\n\n<p>Now lets take <code>s[0][0]</code>, you have <em>five</em> possible pointers that can point to that location:</p>\n\n<ol>\n<li><code>&amp;s[0][0]</code>. This is of type <code>int *</code>.</li>\n<li><code>&amp;s[0]</code>. This is of type <code>int (*)[2]</code>.</li>\n<li><code>s[0]</code>. This will decay to a pointer to the first element in <code>s[0]</code>, and is equal to 1.</li>\n<li><code>s</code>. This will decay to a pointer to the first element in <code>s</code>, and is equal to 2.</li>\n<li><code>&amp;s</code>. A pointer to the array, of type <code>int (*)[4][2]</code>.</li>\n</ol>\n\n<p>As you can see you can have many different pointers to the exact same location, but they can mean different things which makes a whole lot of difference semantically.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8091711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d84ac8e57af7097de13509dae3e960a?s=128&d=identicon&r=PG&f=1", "display_name": "Manikanta Ankam", "link": "https://stackoverflow.com/users/8091711/manikanta-ankam"}, "edited": false, "score": 0, "creation_date": 1496328871, "post_id": 44284728, "comment_id": 75627228, "body": "everything what you&#39;ve said is clear to me and I&#39;ve tried implementing that to pass a 2D array to a function. Here is what my code looks like, display(s,4,2) is the function call in main, and the implementation is void display(int *q,int row,int col), inside here in two for loops I&#39;ve tried to display each element using printf(&quot;%d&quot;, *(*(q+i)+j)), but it doesn&#39;t work for some reason, but on searching, I&#39;ve found *(q+i*col+j) will work. Can you please explain me why the earlier one didn&#39;t work.?"}, {"owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "reply_to_user": {"reputation": 13, "user_id": 8091711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d84ac8e57af7097de13509dae3e960a?s=128&d=identicon&r=PG&f=1", "display_name": "Manikanta Ankam", "link": "https://stackoverflow.com/users/8091711/manikanta-ankam"}, "edited": false, "score": 0, "creation_date": 1496728780, "post_id": 44284728, "comment_id": 75764932, "body": "@ManikantaAnkam because in the declaration of function <code>display</code> you state that you expect the first argument as <code>int *q</code> but you pass <code>s</code>, which is equivalent to <code>int **</code>."}], "tags": [], "owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "is_accepted": false, "score": 0, "last_activity_date": 1496234127, "last_edit_date": 1496234127, "creation_date": 1496233392, "answer_id": 44284728, "question_id": 44284362, "link": "https://stackoverflow.com/questions/44284362/accessing-2d-array-elements-using-pointer-arithmetic-in-c/44284728#44284728", "title": "Accessing 2D array elements using pointer arithmetic in C", "body": "<blockquote>\n  <p>Even though s[2] and (s+2) refer to the same address, why does *(s[2]) prints the value (i.e., 1434 ) but *(s+2) prints the same address what (s+2) has printed. Isn't *(s+2) mean value at address of 3rd 1D array(i.e., s[2][0])?</p>\n</blockquote>\n\n<p><code>s</code>, apart from the array name, is also a <em>pointer</em> to the first element of the array, which is the first line.</p>\n\n<p>In general, keep in mind that :</p>\n\n<pre><code>s[i][j]\n</code></pre>\n\n<p>is equivalent to :</p>\n\n<pre><code>*(s[i] + j)\n</code></pre>\n\n<p>as well as to :</p>\n\n<pre><code>*(*(s + i) + j)\n</code></pre>\n\n<p>So <code>s[i]</code> is equivalent to <code>*(s+i)</code> and to <code>*(*(s+i) + 0)</code>.</p>\n\n<p>Based on these, you can see that :</p>\n\n<ul>\n<li><code>s[2]</code> is the same as <code>*(s+2)</code> and indicates <em>the third element of your array</em>. This is the address of the third line of your array, exactly the same with the address of the first element of the third line of your array.</li>\n<li><code>*(s[2])</code> means <code>*(*(s+2))</code>, and indicates the <strong><em>content of the third element of your array</em></strong>. This is the content of the first element of the third line of your array (i.e., <code>1434</code>).</li>\n</ul>\n\n<p>If you want to print <code>s[2][0]</code>, this is equivalent to <code>*(*(s+2) + 0)</code> or simply <code>*(*s[2])</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 8091711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d84ac8e57af7097de13509dae3e960a?s=128&d=identicon&r=PG&f=1", "display_name": "Manikanta Ankam", "link": "https://stackoverflow.com/users/8091711/manikanta-ankam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 992, "favorite_count": 0, "closed_date": 1496233728, "accepted_answer_id": 44284712, "answer_count": 3, "score": 1, "last_activity_date": 1496234127, "creation_date": 1496232334, "question_id": 44284362, "link": "https://stackoverflow.com/questions/44284362/accessing-2d-array-elements-using-pointer-arithmetic-in-c", "closed_reason": "Duplicate", "title": "Accessing 2D array elements using pointer arithmetic in C", "body": "<p>I have this code in which I've been trying to figure out a doubt on pointer,array combination.</p>\n\n<pre><code>int main()\n{\n  int s[4][2] = {\n    {1234,56},\n    {1212,13},\n    {1434,80},\n    {1312,78}\n  };\n  printf(\"%d\\n\",s[2]);\n  printf(\"%d\\n\",*s[2]);\n  printf(\"%d\\n\",s+2);\n  printf(\"%d\\n\",*(s+2));\n  return 0;\n}\n</code></pre>\n\n<p><strong>And the doubt is:</strong>\n           Even though s[2] and (s+2) refer to the same address, why does *(s[2]) prints the value (i.e., 1434 ) but *(s+2) prints the same address what (s+2) has printed. Isn't *(s+2) mean value at address of 3rd 1D array(i.e., s[2][0])?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 13, "creation_date": 1496231822, "post_id": 44284082, "comment_id": 75574834, "body": "It&#39;s a <a href=\"http://en.cppreference.com/w/c/language/compound_literal\" rel=\"nofollow noreferrer\"><i>compound literal</i></a>."}, {"owner": {"reputation": 331, "user_id": 3515407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a9cc7f7f9ed85fe8870b6aee6e1e8b3?s=128&d=identicon&r=PG&f=1", "display_name": "ltWolfik", "link": "https://stackoverflow.com/users/3515407/ltwolfik"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496233805, "post_id": 44284082, "comment_id": 75576358, "body": "@Someprogrammerdude Thanks! It is that, i would like."}], "answers": [{"tags": [], "owner": {"reputation": 567, "user_id": 2102106, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab3fa85eb8c922243316f53755d1b5c3?s=128&d=identicon&r=PG", "display_name": "Johannes Mols", "link": "https://stackoverflow.com/users/2102106/johannes-mols"}, "is_accepted": false, "score": 0, "last_activity_date": 1496231744, "creation_date": 1496231744, "answer_id": 44284147, "question_id": 44284082, "link": "https://stackoverflow.com/questions/44284082/curly-braces-as-argument-of-function/44284147#44284147", "title": "Curly braces as argument of function", "body": "<p>You're creating an array with <code>pthread[]</code>. You can pass values in the curly braces if you define a length for the argument.</p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1496231835, "post_id": 44284171, "comment_id": 75574847, "body": "is an empty brace-enclosed list considered a valid syntax? AFAIR, it must contain at least one element."}, {"owner": {"reputation": 567, "user_id": 2102106, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab3fa85eb8c922243316f53755d1b5c3?s=128&d=identicon&r=PG", "display_name": "Johannes Mols", "link": "https://stackoverflow.com/users/2102106/johannes-mols"}, "edited": false, "score": 0, "creation_date": 1496231973, "post_id": 44284171, "comment_id": 75574965, "body": "Yes, it&#39;s a valid syntax. You don&#39;t need to write the curly braces in that case but you can."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 3, "creation_date": 1496233347, "post_id": 44284171, "comment_id": 75576006, "body": "@JohannesMols-- it is not valid syntax, it is a constraint violation to use empty braces with an initializer."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 2, "creation_date": 1496234464, "post_id": 44284171, "comment_id": 75576825, "body": "<code>int my_array[] = (int[]){10, 20, 30};</code> gives <code>error: array initialized from non-constant array expression</code>. Perhaps you meant <code>int *my_array = (int[]){10, 20, 30};</code>?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496360072, "post_id": 44284171, "comment_id": 75642743, "body": "Note that GCC (7.1.0 tested) permits the compound literal as initializer unless you turn on <code>-pedantic</code> warnings/errors.  For example, using <code>gcc -O3 -g -std=c11 -Wall -Wextra -Werror -pedantic -c di59.c</code> generates the error (would be warning without <code>-Werror</code>): <code>di59.c:1:18: error: initializer element is not constant [-Werror=pedantic]</code> <code>int my_array[] = (int[]){10, 20, 30};</code> but leave the <code>-pedantic</code> out of the options and it is given a clean bill of health.  The &#39;cast&#39; portion of the compound literal should be removed as a basic initializer, of course: <code>int my_array[] = { 10, 20, 30 };</code>."}], "tags": [], "owner": {"reputation": 8064, "user_id": 5910563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/snpEp.jpg?s=128&g=1", "display_name": "Horia Coman", "link": "https://stackoverflow.com/users/5910563/horia-coman"}, "is_accepted": false, "score": 0, "last_activity_date": 1496231787, "creation_date": 1496231787, "answer_id": 44284171, "question_id": 44284082, "link": "https://stackoverflow.com/questions/44284082/curly-braces-as-argument-of-function/44284171#44284171", "title": "Curly braces as argument of function", "body": "<p>What you're dealing with there is an array initializer, which happens to be the empty array. You'd usually find it as:</p>\n\n<pre><code>int my_array[] = (int[]){10, 20, 30};\n</code></pre>\n\n<p>And it would initialize <code>my_array</code> to contain three elements. Here there are no elements, hence the awkward syntax.</p>\n"}, {"tags": [], "owner": {"reputation": 1017, "user_id": 2072005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba025189d0d4e0fe5a3e6b2b9062be3?s=128&d=identicon&r=PG", "display_name": "Jonatan Goebel", "link": "https://stackoverflow.com/users/2072005/jonatan-goebel"}, "is_accepted": false, "score": 1, "last_activity_date": 1496232188, "creation_date": 1496232188, "answer_id": 44284302, "question_id": 44284082, "link": "https://stackoverflow.com/questions/44284082/curly-braces-as-argument-of-function/44284302#44284302", "title": "Curly braces as argument of function", "body": "<p>It's a <a href=\"http://en.cppreference.com/w/c/language/compound_literal\" rel=\"nofollow noreferrer\">compound literal</a> as mentioned by @some-programmer-dude.</p>\n\n<p>In this specific case it is use to create an array to store the thread_id and discharge it later without the need of creating an extra variable. That is necessary because <code>pthread_create</code> does not accept NULL as argument for <code>thread_id</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1496240728, "post_id": 44284354, "comment_id": 75581573, "body": "And as a perverted side-effect, the thread is not joinable because the code doesn&#39;t save the <code>pthread_t</code> accessibly.  In effect, the thread is detached, without the benefit of being formally detached.  As a way of creating a thread, it leaves a lot to be desired."}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 0, "creation_date": 1496254915, "post_id": 44284354, "comment_id": 75590574, "body": "I <i>think</i> every type in C can be properly initialized with <code>{ 0 }</code>, but it&#39;s not clear to me why the empty braces aren&#39;t allowed: given that any individual element of the object being initialized is allowed to be implicit, why not make that true for them all at once? (and <code>{ 0 }</code> might be technically permissible for many types, but not &quot;right&quot; in the sense of being clean to read)"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496256305, "post_id": 44284354, "comment_id": 75591358, "body": "@Leushenko-- Offhand I can&#39;t think of a type that <code>{ 0 }</code> would not work for, though there may be warnings about missing braces. IAC, I think that what you say about initializers with missing elements makes sense, if I understand you correctly. I believe that some feel like this is a &quot;bug&quot; in the C spec that C++ gets right. Incidentally, your observation that <code>{ 0 }</code> may not be &quot;right&quot; for a particular type is why I double-checked that <code>pthread_t</code> is an <code>unsigned long</code>!"}], "tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": true, "score": 19, "last_activity_date": 1496245299, "last_edit_date": 1496245299, "creation_date": 1496232322, "answer_id": 44284354, "question_id": 44284082, "link": "https://stackoverflow.com/questions/44284082/curly-braces-as-argument-of-function/44284354#44284354", "title": "Curly braces as argument of function", "body": "<p>This is a <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.2.5\" rel=\"noreferrer\">compound literal</a>, with a constraint violation since <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.9\" rel=\"noreferrer\">initializer braces cannot be empty</a>:</p>\n\n<pre><code>(pthread_t[]){}\n</code></pre>\n\n<p>Using <code>gcc -std=c99 -Wall -Wextra -Wpedantic</code> this produces the warning:</p>\n\n<pre><code>compound_literal_pthread.c:6:36: warning: ISO C forbids empty initializer braces [-Wpedantic]\n     pthread_t *ptr = (pthread_t []){};\n</code></pre>\n\n<p>The result seems to be a pointer to <code>pthread_t</code>, though I don't see this behavior documented in the gcc manual. Note that empty braces are allowed as initializers in C++, where they are equivalent to <code>{ 0 }</code>. This behavior seems to be supported for C, but undocumented, by gcc. I suspect that is what is happening here, making the above expression equivalent to:</p>\n\n<pre><code>(pthread_t[]){ 0 }\n</code></pre>\n\n<p>On my system, <code>pthread_t</code> is a <code>typedef</code> for <code>unsigned long</code>, so this expression would create an array of <code>pthread_t</code> containing only a <code>0</code> element. This array would decay to a pointer to <code>pthread_t</code> in the function call.</p>\n"}], "owner": {"reputation": 331, "user_id": 3515407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a9cc7f7f9ed85fe8870b6aee6e1e8b3?s=128&d=identicon&r=PG&f=1", "display_name": "ltWolfik", "link": "https://stackoverflow.com/users/3515407/ltwolfik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3606, "favorite_count": 2, "accepted_answer_id": 44284354, "answer_count": 4, "score": 22, "last_activity_date": 1496245299, "creation_date": 1496231551, "question_id": 44284082, "link": "https://stackoverflow.com/questions/44284082/curly-braces-as-argument-of-function", "title": "Curly braces as argument of function", "body": "<p>I've noticed in some source code the line:</p>\n\n<pre><code>if(pthread_create((pthread_t[]){}, 0, start_thread, pthread_args)) {\n...\n</code></pre>\n\n<p>It works correctly, but how to understand the first argument?\nIt seems, that curly braces converts to <code>pthread_t[]</code> type.</p>\n\n<p>P.s. I googled, but didn't find answer, only some guesses (some form of initialization, or legacy feature of c?)</p>\n"}, {"tags": ["c", "pointers", "linux-kernel"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1496231518, "post_id": 44284039, "comment_id": 75574583, "body": "<i>Questions seeking debugging help (why isn&#39;t this code working?) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.</i>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1496231522, "post_id": 44284039, "comment_id": 75574587, "body": "Kindly show your reseacrh / debugging effort so far. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496231565, "post_id": 44284039, "comment_id": 75574622, "body": "You <i>check</i> it before you dereference the pointer? Like in <code>if (xx != NULL) { ... }</code>?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1496233745, "post_id": 44284039, "comment_id": 75576305, "body": "You can easily derive if it was the first or second dereference which caused havoc by disassembling the code around the EIP when the oops happened."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1496233751, "post_id": 44284039, "comment_id": 75576308, "body": "Put some asserts and yo&#39;ull find out which one is NULL."}], "answers": [{"comments": [{"owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "edited": false, "score": 0, "creation_date": 1496235483, "post_id": 44284093, "comment_id": 75577549, "body": "I don&#39;t think this comment is sound. Slapping a null check is the typical wrong thing to do - most of the time the bug is that the pointer is null in the first place. The advice to split the expression is sometimes usable, but if the crash is not easily reproducible it is useless and no further hints were provided."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "edited": false, "score": 0, "creation_date": 1496296850, "post_id": 44284093, "comment_id": 75604454, "body": "@employeeofthemonth <code>Slapping a null check is the typical wrong thing to do</code> care to elaborate? <code>most of the time the bug is that the pointer is null in the first place</code>..well that is what the check is for."}, {"owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "edited": false, "score": 0, "creation_date": 1496329569, "post_id": 44284093, "comment_id": 75627776, "body": "if the pointer must not be null and you change if (foo-&gt;bar) to if (foo &amp;&amp; foo-&gt;bar), then you are attempting to paper over the bug. Sounds like exactly what you don&#39;t want to do. Note I don&#39;t mind adding a null check for <i>debugging</i> purposes."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1496232229, "last_edit_date": 1496232229, "creation_date": 1496231588, "answer_id": 44284093, "question_id": 44284039, "link": "https://stackoverflow.com/questions/44284039/kernel-oops-at-double-pointer-dereference/44284093#44284093", "title": "kernel oops at double pointer dereference", "body": "<p>In general, to avoid tese type of NULL pointer dereference, we use the style</p>\n\n<pre><code>  if (xx &amp;&amp; xx-&gt;yy)\n</code></pre>\n\n<p>where, the dereference is only evaluated if <code>xx</code> is not NULL.</p>\n\n<p>As per the short-circuit operator property, in this case, logical AND, the RHS operand is evaluated only if the LHS is evaluated to TRUE. So, for the above example, </p>\n\n<ul>\n<li>when <code>xx</code> is NULL, the dereference is prohibited.</li>\n<li>when <code>xx</code>is not NULL, the dereference takes place.</li>\n</ul>\n\n<blockquote>\n  <p><em>So how to know which field is NULL xx or xx->yy</em></p>\n</blockquote>\n\n<p>Break down the operations, put debug prints and run again if you want to know the NULL-ity  of a pointer. That's a generic advice.</p>\n"}, {"comments": [{"owner": {"reputation": 840, "user_id": 3928580, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/KxgEZ.jpg?s=128&g=1", "display_name": "Saturn", "link": "https://stackoverflow.com/users/3928580/saturn"}, "edited": false, "score": 0, "creation_date": 1496290659, "post_id": 44285449, "comment_id": 75602522, "body": "yes you are right, I disassemble the vmlinux and went to the location of crash using PC. and after analyzing assembly code, I was able to find the exact pointer which was NULL. thanks for help"}], "tags": [], "owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "is_accepted": false, "score": 2, "last_activity_date": 1496235384, "creation_date": 1496235384, "answer_id": 44285449, "question_id": 44284039, "link": "https://stackoverflow.com/questions/44284039/kernel-oops-at-double-pointer-dereference/44285449#44285449", "title": "kernel oops at double pointer dereference", "body": "<p>In the kernel source tree there is scripts/decodecode. Once you feed it the oops you will human-readable assembly surrounding the crashing instruction.</p>\n\n<p>You will have to analyze how it fits the source tree from there. It's a mandatory skill for anyone doing kernel programming and is not that hard to do most of the time. One easy shortcut is to check offsets of dereferenced fields and see how it relates to the crashing address.</p>\n"}], "owner": {"reputation": 840, "user_id": 3928580, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/KxgEZ.jpg?s=128&g=1", "display_name": "Saturn", "link": "https://stackoverflow.com/users/3928580/saturn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1496291103, "creation_date": 1496231458, "last_edit_date": 1496291103, "question_id": 44284039, "link": "https://stackoverflow.com/questions/44284039/kernel-oops-at-double-pointer-dereference", "title": "kernel oops at double pointer dereference", "body": "<p>I am getting a NULL pointer dereference issue in linux kernel. Using addr2line on PC I am able to get the line number in code. But the line where this oops is occuring is a double pointer dereference. </p>\n\n<pre><code>eg. xx-&gt;yy-&gt;zz\n</code></pre>\n\n<p>Here we are dereferencing xx and xx->yy in one line.</p>\n\n<pre><code>addr2line -f -e vmlinux c03200f8\nfunc\nlmn/uva/hello.c:101\n\n101: if(xx-&gt;yy-&gt;zz==hello)\n</code></pre>\n\n<p>So how to know which field is NULL xx or xx->yy?</p>\n"}, {"tags": ["c++", "c", "linux", "ipc", "shared-memory"], "comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 3, "creation_date": 1496231338, "post_id": 44283900, "comment_id": 75574421, "body": "You need to use <code>shmctl(shmid, IPC_RMID, NULL);</code> to remove the shared memory segment."}, {"owner": {"reputation": 243, "user_id": 7333045, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b02e6dfe639726497e6096b5e5ee0cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Wonter", "link": "https://stackoverflow.com/users/7333045/wonter"}, "reply_to_user": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 1, "creation_date": 1496231602, "post_id": 44283900, "comment_id": 75574653, "body": "when the shmid_ds::shm_nattch == 0, the shared memory segment will be removed automatically????@Gaurav Pathak"}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1496232923, "post_id": 44283900, "comment_id": 75575701, "body": "No, it just indicates whether your shared memory is attached with any process or not. If shmid_ds-&gt;shm_nattach == 0 then it means it can be attached to another process."}], "answers": [{"tags": [], "owner": {"reputation": 1563, "user_id": 2530921, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/WPszy.jpg?s=128&g=1", "display_name": "VINOTH ENERGETIC", "link": "https://stackoverflow.com/users/2530921/vinoth-energetic"}, "is_accepted": true, "score": 2, "last_activity_date": 1496233175, "last_edit_date": 1496233175, "creation_date": 1496232900, "answer_id": 44284553, "question_id": 44283900, "link": "https://stackoverflow.com/questions/44283900/shared-memory-segment-cant-be-removed-after-call-shmdt/44284553#44284553", "title": "shared memory segment can&#39;t be removed after call shmdt()", "body": "<blockquote>\n  <p>shmdt() detaches the shared memory segment located at the address\n  specified by shmaddr from the address space of the calling process.\n  The to-be-detached segment must be currently attached with shmaddr\n  equal to the value returned by the attaching shmat() call.</p>\n</blockquote>\n\n<p>shmdt only <strong>detaches</strong> the calling process from attached memory. It will <strong>not</strong> <strong>remove</strong> the shared memory created by the process.<br>\nFor more information please read the man page of the respective system calls.</p>\n"}], "owner": {"reputation": 243, "user_id": 7333045, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b02e6dfe639726497e6096b5e5ee0cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Wonter", "link": "https://stackoverflow.com/users/7333045/wonter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 44284553, "answer_count": 1, "score": 0, "last_activity_date": 1496233175, "creation_date": 1496231135, "last_edit_date": 1496232148, "question_id": 44283900, "link": "https://stackoverflow.com/questions/44283900/shared-memory-segment-cant-be-removed-after-call-shmdt", "title": "shared memory segment can&#39;t be removed after call shmdt()", "body": "<p>i called shmdt() successfully, but shared memory segment can't be removed..</p>\n\n<p>this is my code:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    key_t key = ftok(\".\", 'T');\n    if (key == -1) {\n        fprintf(stderr, \"get key failed, error: %s\\n\", strerror(errno));\n        exit(1);\n    }\n\n    int shmid = shmget(key, sizeof(int) * 10, IPC_CREAT);\n    if (shmid == -1) {\n        fprintf(stderr, \"get shmid failed, error: %s\\n\", strerror(errno));\n        exit(1);\n    }\n\n    void* shmaddr = shmat(shmid, NULL, 0);\n    if (shmaddr == (void*)-1) {\n        fprintf(stderr, \"get shmaddr failed, error: %s\\n\", strerror(errno));\n        exit(1);\n    }\n\n    if (shmdt(shmaddr) == -1) {\n        fprintf(stderr, \"detach failed, error: %s\\n\", strerror(errno));\n        exit(1);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>after that, i execute <code>ipcs -m</code></p>\n\n<pre><code># ipcs -m\n\n------ Shared Memory Segments --------\nkey        shmid      owner      perms      bytes      nattch     status      \n0x00000000 1179648    root       0          4          0                       \n0x00000000 1212417    root       0          4          0                       \n0x00000000 1245186    root       0          4          0                       \n0x00000000 1277955    root       0          4          0                       \n0x00000000 1310724    root       0          4          0                       \n0x00000000 1343493    root       0          4          0                       \n0x00000000 1376262    root       0          4          0                       \n0x00000000 1409031    root       0          4          0                       \n0x00000000 1441800    root       0          4          0                       \n0x00000000 1474569    root       0          4          0                       \n0x54010004 1671178    root       0          40         0                       \n0x00000000 1540107    root       0          4          0  \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 11, "creation_date": 1496229554, "post_id": 44283357, "comment_id": 75573118, "body": "Namespace std is not C, it&#39;s C++."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1496229587, "post_id": 44283357, "comment_id": 75573147, "body": "This is not C, <code>using namespace</code> is C++. Remove that, and make sure you build as C."}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1496229731, "post_id": 44283357, "comment_id": 75573240, "body": "How have you managed to compile the code when you say the program doesn&#39;t wait for input and prints meaningless characters?"}, {"owner": {"reputation": 3702, "user_id": 3072027, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/SRlfQ.jpg?s=128&g=1", "display_name": "bert", "link": "https://stackoverflow.com/users/3072027/bert"}, "edited": false, "score": 0, "creation_date": 1496230042, "post_id": 44283357, "comment_id": 75573461, "body": "Doesn&#39;t the compiler just ignore <code>using namespace std;</code> because it&#39;s never actually referenced?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1496230157, "post_id": 44283357, "comment_id": 75573539, "body": "Your code compiles and works fine with a C++ compiler. If you want it to compile with a C compiler you need to remove the <code>using namespace std;</code> line, then it will also compile and work. So please tell us a bit more of what exactly you are doing, which OS you have, which compiler, version, IDE, what youb type where etc."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1496230424, "post_id": 44283357, "comment_id": 75573750, "body": "what can happen here is: 1) the code doesn&#39;t compile 2) you&#39;re running an old, unrelated executable with the same name."}, {"owner": {"reputation": 1107, "user_id": 1193829, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/aW9kf.jpg?s=128&g=1", "display_name": "Priyanka.Patil", "link": "https://stackoverflow.com/users/1193829/priyanka-patil"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1496230814, "post_id": 44283357, "comment_id": 75574031, "body": "@MichaelWalz: Just trying out online <a href=\"https://www.codechef.com/ide\" rel=\"nofollow noreferrer\">codechef.com/ide</a>"}, {"owner": {"reputation": 1107, "user_id": 1193829, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/aW9kf.jpg?s=128&g=1", "display_name": "Priyanka.Patil", "link": "https://stackoverflow.com/users/1193829/priyanka-patil"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1496230951, "post_id": 44283357, "comment_id": 75574120, "body": "@Jean-Fran&#231;oisFabre: 1)It compiled fine and 2)Just trying out online codechef.com/ide"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1496231207, "post_id": 44283357, "comment_id": 75574302, "body": "why using online platforms to test your code? what&#39;s wrong with local installations?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1496231220, "post_id": 44283357, "comment_id": 75574318, "body": "Please refrain from stating <code>I am new to X and Y</code>...that is having no context with the question being asked."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 2, "creation_date": 1496231325, "post_id": 44283357, "comment_id": 75574405, "body": "On codechef, have you selected the custom input? It works fine on <a href=\"https://ideone.com/XTJy1s\" rel=\"nofollow noreferrer\">ideone</a>..."}, {"owner": {"reputation": 1107, "user_id": 1193829, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/aW9kf.jpg?s=128&g=1", "display_name": "Priyanka.Patil", "link": "https://stackoverflow.com/users/1193829/priyanka-patil"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1496231410, "post_id": 44283357, "comment_id": 75574492, "body": "@Bob__ : Thanks.. This is want i had missed."}, {"owner": {"reputation": 1107, "user_id": 1193829, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/aW9kf.jpg?s=128&g=1", "display_name": "Priyanka.Patil", "link": "https://stackoverflow.com/users/1193829/priyanka-patil"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1496231457, "post_id": 44283357, "comment_id": 75574530, "body": "@Jean-Fran&#231;ois Fabre :Will prefer it next time."}], "answers": [{"comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 4, "creation_date": 1496229792, "post_id": 44283425, "comment_id": 75573283, "body": "Now the next question probably would be &quot;How can I make <code>scanf()</code> to accept spaces?&quot;"}, {"owner": {"reputation": 1107, "user_id": 1193829, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/aW9kf.jpg?s=128&g=1", "display_name": "Priyanka.Patil", "link": "https://stackoverflow.com/users/1193829/priyanka-patil"}, "edited": false, "score": 0, "creation_date": 1496230851, "post_id": 44283425, "comment_id": 75574053, "body": "Nope.Checked after removing namespace."}, {"owner": {"reputation": 371, "user_id": 6513366, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yaOsDebgj9o/AAAAAAAAAAI/AAAAAAAAAUw/daIT_fXvT4k/photo.jpg?sz=128", "display_name": "Overflow 404", "link": "https://stackoverflow.com/users/6513366/overflow-404"}, "edited": false, "score": 0, "creation_date": 1496231177, "post_id": 44283425, "comment_id": 75574278, "body": "Have you already tryed with scanf(&quot; %19s&quot;, name); instead of scanf(&quot;%19s&quot;, name); ? Maybe you have to consume the newline character."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1496231355, "post_id": 44283425, "comment_id": 75574437, "body": "<code>in C there isn&#39;t namespace</code>.... <b><i>my whole life is a lie then</i></b> , care to elaborate the chapter 6.2.3, <code>C11</code>?"}, {"owner": {"reputation": 371, "user_id": 6513366, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yaOsDebgj9o/AAAAAAAAAAI/AAAAAAAAAUw/daIT_fXvT4k/photo.jpg?sz=128", "display_name": "Overflow 404", "link": "https://stackoverflow.com/users/6513366/overflow-404"}, "edited": false, "score": 0, "creation_date": 1496231753, "post_id": 44283425, "comment_id": 75574779, "body": "I mean namespace as &#39;using namespace std;&#39; not namespace as struct etc"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1496232043, "post_id": 44283425, "comment_id": 75575028, "body": "@Overflow404 So, care to change the statement to avoid confusion? ..probably add <code>keyword</code>....just a suggestion."}], "tags": [], "owner": {"reputation": 371, "user_id": 6513366, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yaOsDebgj9o/AAAAAAAAAAI/AAAAAAAAAUw/daIT_fXvT4k/photo.jpg?sz=128", "display_name": "Overflow 404", "link": "https://stackoverflow.com/users/6513366/overflow-404"}, "is_accepted": false, "score": 5, "last_activity_date": 1496232236, "last_edit_date": 1496232236, "creation_date": 1496229662, "answer_id": 44283425, "question_id": 44283357, "link": "https://stackoverflow.com/questions/44283357/reading-a-string-in-c/44283425#44283425", "title": "Reading a string in C", "body": "<p>In C this line:</p>\n\n<pre><code>using namespace std;\n</code></pre>\n\n<p>doesn't exist.</p>\n\n<p>Here is your code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    char name[20];\n    printf(\"Enter name: \");\n    scanf(\"%19s\", name);\n    printf(\"Your name is %s\", name);\n    return 0;\n}\n</code></pre>\n\n<p>Hint: assuming that your buffer is 20, use <code>scanf(\"%19s\", name);</code> to prevent buffer overflow.</p>\n"}], "owner": {"reputation": 1107, "user_id": 1193829, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/aW9kf.jpg?s=128&g=1", "display_name": "Priyanka.Patil", "link": "https://stackoverflow.com/users/1193829/priyanka-patil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "answer_count": 1, "score": -6, "last_activity_date": 1496232236, "creation_date": 1496229471, "last_edit_date": 1496231182, "question_id": 44283357, "link": "https://stackoverflow.com/questions/44283357/reading-a-string-in-c", "title": "Reading a string in C", "body": "<p>I am trying to read a name and print it. But the control doesn't wait for me to enter the name and directly prints the output with some meaningless characters.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nusing namespace std;\n\nint main() {\n    char name[20];\n    printf(\"Enter name: \");\n    scanf(\"%s\", name);\n    printf(\"Your name is %s\", name);\n    return 0;\n}\n</code></pre>\n\n<p>Any mistakes here?</p>\n"}, {"tags": ["c++", "c", "multithreading", "thread-safety"], "comments": [{"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 1, "creation_date": 1496229419, "post_id": 44283313, "comment_id": 75573029, "body": "mutex? why are you doing this yourself? use something like boost::log."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1496229730, "post_id": 44283313, "comment_id": 75573238, "body": "the fact that there is a macro involved is rather irrelevant. The threads dont even see the macro because it gets expanded by the preprocessor way before you start a thread"}, {"owner": {"reputation": 814, "user_id": 6263041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ir86i.png?s=128&g=1", "display_name": "The Techel", "link": "https://stackoverflow.com/users/6263041/the-techel"}, "edited": false, "score": 3, "creation_date": 1496229772, "post_id": 44283313, "comment_id": 75573271, "body": "why using that vararg-crap in C++?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1496230356, "post_id": 44283313, "comment_id": 75573699, "body": "What will <code>foo str</code> do? seems syntactically invalid."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1496234412, "post_id": 44283313, "comment_id": 75576783, "body": "C or C++? The posted code is pure C."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 814, "user_id": 6263041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ir86i.png?s=128&g=1", "display_name": "The Techel", "link": "https://stackoverflow.com/users/6263041/the-techel"}, "edited": false, "score": 0, "creation_date": 1496234451, "post_id": 44283313, "comment_id": 75576809, "body": "@TheTechel The code is tagged C and C++."}], "answers": [{"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 2, "last_activity_date": 1496229828, "creation_date": 1496229828, "answer_id": 44283480, "question_id": 44283313, "link": "https://stackoverflow.com/questions/44283313/how-to-implement-the-function-thread-safe/44283480#44283480", "title": "How to implement the function thread safe", "body": "<p>You're looking to protect an internal buffer. Obviously you can't apply a mutex or atomic lock in the function because that buffer is used outside the function.</p>\n\n<p>Ignoring the obvious flaw in the design and implementation (fixed length buffer with no protection, etc...) there is one way to protect the buffer.</p>\n\n<p>That is to make it thread_local:</p>\n\n<pre><code>char* foo(const char *fmt, ...) {\n\n  // thread_local\n  thread_local static char logmsg[200]; //Maximum log Msg String length\n\n  va_list args;\n  va_start(args, fmt);\n  std::vsprintf(logmsg,fmt, args);\n  va_end(args);\n  return logmsg;\n}\n</code></pre>\n\n<p>As long as you don't marshal the returned pointer between threads, you're good.</p>\n\n<p>Note that thread_local is a c++11 feature, and the apple compiler still doesn't implement it when compiling for iOS. The workaround for that nonsense is <code>boost::thread_specific_ptr</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496239954, "post_id": 44286609, "comment_id": 75580988, "body": "You can&#39;t safely reuse <code>args</code> without intervening calls to <code>va_end()</code> and a new <code>va_start()</code>.  You don&#39;t need two variables.  What you can&#39;t do is call <code>va_start()</code>, then call <code>vsnprintf()</code> the first time, then call it a second time without the <code>va_end()</code> and another <code>va_start()</code>."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496240217, "post_id": 44286609, "comment_id": 75581184, "body": "@JonathanLeffler Thanks.  I can never remember particulars like that, so I tend to err on the side of caution.  I&#39;d rather write code that I <i>know</i> is safe than code that I <i>think</i> should be safe."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1496238592, "creation_date": 1496238592, "answer_id": 44286609, "question_id": 44283313, "link": "https://stackoverflow.com/questions/44283313/how-to-implement-the-function-thread-safe/44286609#44286609", "title": "How to implement the function thread safe", "body": "<p>Here's pure C answer that produces a string that's fully usable by any thread, doesn't rely on a static buffer that will be overwritten by the next use, and doesn't risk a buffer overrun:</p>\n\n<pre><code>char *foo( const char *fmt, ... )\n{\n    // start with what's likely enough memory\n    char local_buffer[ 128 ];\n\n    va_list args;\n    va_start( args, fmt );\n\n    int bytes_needed = vsnprintf( local_buffer, sizeof( local_buffer ), fmt, args );\n\n    va_end( args );\n\n    // if the string fit, duplicate the string dynamically and return\n    if ( bytes_needed &lt; sizeof( local_buffer )\n    {\n        return( strdup( local_buffer );\n    }\n\n    // didn't fit, but we do know how long it needs to be\n    char *buffer = malloc( bytes_needed + 1 );\n    if ( !buffer )\n    {\n        return( NULL );\n    }\n\n    // can't safely reuse args\n    va_list args2;\n    va_start( args2, fmt );\n\n    vsnprintf( buffer, bytes_needed, fmt, args2 );\n\n    va_end( args2 );\n\n    return( buffer );\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7167317, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-iqC7eWk7Ngg/AAAAAAAAAAI/AAAAAAAAGt4/qnO0UPznRWQ/photo.jpg?sz=128", "display_name": "Balaganesh.V", "link": "https://stackoverflow.com/users/7167317/balaganesh-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 1, "answer_count": 2, "score": -3, "last_activity_date": 1496238592, "creation_date": 1496229325, "last_edit_date": 1496230184, "question_id": 44283313, "link": "https://stackoverflow.com/questions/44283313/how-to-implement-the-function-thread-safe", "title": "How to implement the function thread safe", "body": "<p>I am calling a function(that returns string) from macro . Multiple threads can use this macro in the system. </p>\n\n<h2>E.g :</h2>\n\n<pre><code>#define LOG(app,str) printf(\"App =%d\\n, Ouptut String = %s\\n\",app, \nfoo str );\n\n\nchar* foo(const char *fmt, ...) {\nstatic char logmsg[200]; //Maximum log Msg String length\nva_list args;\nva_start(args, fmt);\nvsprintf(logmsg,fmt, args);\nva_end(args);\nreturn logmsg;\n}\n\n\n\nLOG Macro Usage : LOG(15,(\"Msg=%s\\n\",strvariable));\n</code></pre>\n\n<p>Now in my case function <code>foo()</code> is not thread safe. Any way how to make this macro/func as thread safe without using mutex locks???? </p>\n"}, {"tags": ["c", "windows", "sockets", "blocking", "nonblocking"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1496230511, "post_id": 44283011, "comment_id": 75573819, "body": "I&#39;m no expert, but I think this is because sockets are non-blocking by default. Did you check for that?"}, {"owner": {"reputation": 141, "user_id": 5104550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9582996539b8a282a796455236c0a636?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Philipp", "link": "https://stackoverflow.com/users/5104550/carl-philipp"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1496233315, "post_id": 44283011, "comment_id": 75575988, "body": "They behave unblocking if I use the MSG_PEEK flag in the recvfrom() function but then I can&#39;t receive anything anymore, the recvfrom returns always -1. If I don&#39;t use MSG_PEEK, the recvfrom() is blocking."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1496249523, "post_id": 44283011, "comment_id": 75587587, "body": "The code works for me (at least <code>ioctlsocket</code> returns 0) using <i>VStudio 2015</i> on <i>Win10</i>.  I suppose that you have <code>#include &lt;WinSock2.h&gt;</code> (<b>before</b> <code>#include &lt;Windows.h&gt;</code>, if present). Did you try a newer <i>Windows Sockets</i> version: e.g. <code>WORD wVersionRequested = MAKEWORD(2, 2);</code>?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1496264834, "post_id": 44283011, "comment_id": 75595698, "body": "this may be depend from windows version, or some else. for me <code>ioctlsocket</code>  return 0 - no error. however in windows <code>non-blocking</code> socket is obsolete and UB. really windows used synchronous or asynchronous (so called overlapped) sockets. look for <code>WSA_FLAG_OVERLAPPED</code> in <code>WSASocket</code>. <code>socket</code> is call <code>WSASocket</code> with overlapped flag - <i>The socket that is created will have the overlapped attribute as a default</i> (from <i>socket</i> function page). you need not non-blocking - but overlapped(asynchronous( i/o. this ioctl not need at all. obsolete"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1496273329, "post_id": 44283011, "comment_id": 75598538, "body": "@unwind, no, sockets are not non-blocking by default.  (Not according to the documentation, anyway.)  The underlying handle is <i>asynchronous</i> by default, but that&#39;s not at all the same thing."}, {"owner": {"reputation": 141, "user_id": 5104550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9582996539b8a282a796455236c0a636?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Philipp", "link": "https://stackoverflow.com/users/5104550/carl-philipp"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1496332656, "post_id": 44283011, "comment_id": 75630084, "body": "@CristiFati your thought about the &quot;<b>before</b>&quot; is quite a hint. I got this warning but because I develob against a third party application with a very complex structure, I did not know how to include winsock2 before windows header. I have fixed the issue by multithreading, which is better anyway because I can do better update handling. Thanks to all of you."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1496342385, "post_id": 44283011, "comment_id": 75635206, "body": "Including <i>WinSock2.h</i> after <i>Windows.h</i> (which includes <i>WinSock.h</i>) triggers tons of compile errors (mainly redefinitions), it&#39;s a common known issue, I&#39;d say. Anyway as I said before the code works fine for me (I don&#39;t know if it actually sets the NB flag, since I didn&#39;t do any further tests)."}], "owner": {"reputation": 141, "user_id": 5104550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9582996539b8a282a796455236c0a636?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Philipp", "link": "https://stackoverflow.com/users/5104550/carl-philipp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 423, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1496243547, "creation_date": 1496228522, "last_edit_date": 1496243547, "question_id": 44283011, "link": "https://stackoverflow.com/questions/44283011/ioctlsocket-fails-with-10045", "title": "ioctlsocket() fails with 10045", "body": "<p>I have a fairly simple piece of C code which should create a non-blocking socket under Windows:</p>\n\n<pre><code>int iResult;\nu_long iMode = 1;\n\nWORD wVersionRequested = MAKEWORD(1,1);       \nWSADATA wsaData;                              \n\nWSAStartup(wVersionRequested, &amp;wsaData);\n\nclient_s = socket(AF_INET, SOCK_DGRAM, 0);\n\nif (client_s == INVALID_SOCKET) {\n    printf(\"Error at socket(): %ld\\n\", WSAGetLastError());\n    WSACleanup();\n    return -1;\n}\n\niResult = ioctlsocket(client_s, FIONBIO, &amp;iMode); \n\nif (iResult != NO_ERROR){\nprintf(\"ioctlsocket failed with error: %ld\\n\",WSAGetLastError());\n}\n</code></pre>\n\n<p>However, it always returns with error code 10045 which means unsupported operation on a socket. It is not described in the possible errors for <code>ioctlsocket()</code> and as I understand closer related to receiving processes. </p>\n\n<p>I've already checked for errors thrown by the <code>WSAStartup()</code> but everything works correctly until then.</p>\n\n<p><code>client_s</code> is correctly defined as a socket so I don't really see the point of failure.</p>\n"}, {"tags": ["c", "clang", "dangling-pointer", "address-sanitizer"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496226063, "post_id": 44281933, "comment_id": 75570807, "body": "This is a really hard case actually. First of all you have to remember that arguments to a function must be evaluated before they are used in a function call, which means the second call to <code>f</code> happens <i>before</i> the call to <code>printf</code>. That in turn most likely mean that the location of the local variables in the function <code>f</code> will be exactly the same in the second call as in the first, which in turn means that the pointer <code>G</code> is actually pointing to the correct location in the second call."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496231190, "post_id": 44281933, "comment_id": 75574291, "body": "@olaf I do not understand what element of your list is missing. Code is there and is certainly short, desired behavior: a warning, obtained behavior: no warning. Thanks for the link. Oh that&#39;s right you didn&#39;t provide a link. Don&#39;t worry, I know what a Minimal, Complete, and Verifiable example is."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1496231270, "post_id": 44281933, "comment_id": 75574364, "body": "@Olaf You removed the C tag and now I agree that after your change, the question is nonsensical. It doesn&#39;t even specify the programming language! You made it so though, not me."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1496231585, "post_id": 44281933, "comment_id": 75574639, "body": "Adding again the C tag because for all I know, there exists a programming language in which my program is syntactically valid and does not have undefined behavior. This question couldn&#39;t make sense if it were asked about that programming language. And you need to understand C in order to understand the question."}], "answers": [{"comments": [{"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1496234200, "post_id": 44281996, "comment_id": 75576622, "body": "1) Clang 5 is not available as far as I know"}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1496234252, "post_id": 44281996, "comment_id": 75576665, "body": "2) Are you saying that if I upgraded to that hypothetical Clang 5\u2014and used the <code>-fsanitize-address-use-after-scope</code> option, then ASan would detect the problem?"}], "tags": [], "owner": {"reputation": 4990, "user_id": 384309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7bd479977c0b02d7a46e72d46eab0054?s=128&d=identicon&r=PG", "display_name": "Alistra", "link": "https://stackoverflow.com/users/384309/alistra"}, "is_accepted": false, "score": -1, "last_activity_date": 1496225780, "creation_date": 1496225780, "answer_id": 44281996, "question_id": 44281933, "link": "https://stackoverflow.com/questions/44281933/clangs-asan-does-not-detect-dangling-pointer-use/44281996#44281996", "title": "Clang&#39;s ASan does not detect dangling pointer use", "body": "<p>Your version: <code>clang version 3.8.0-2ubuntu4 (tags/RELEASE_380/final)</code></p>\n\n<p>Header of page: <code>Clang 5 documentation</code></p>\n\n<p>You have to update your <code>clang</code></p>\n"}, {"comments": [{"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1496243431, "post_id": 44287544, "comment_id": 75583637, "body": "Thanks! See my complementary answer."}], "tags": [], "owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "is_accepted": true, "score": 1, "last_activity_date": 1496241020, "creation_date": 1496241020, "answer_id": 44287544, "question_id": 44281933, "link": "https://stackoverflow.com/questions/44281933/clangs-asan-does-not-detect-dangling-pointer-use/44287544#44287544", "title": "Clang&#39;s ASan does not detect dangling pointer use", "body": "<p>You are talking about use-after-return errors here. These should be supported by ASan but disabled by default due to significantly higher memory overhead (see e.g. <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizerUseAfterReturn\" rel=\"nofollow noreferrer\">here</a> for details). To enable, run with <code>ASAN_OPTIONS=detect_stack_use_after_return=1</code>.</p>\n\n<p>Unfortunately I can't check whether it works on your particular case but if it doesn't, you should probly file a bug at <a href=\"https://github.com/google/sanitizers/issues\" rel=\"nofollow noreferrer\">ASan's tracker</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "edited": false, "score": 1, "creation_date": 1496252762, "post_id": 44288576, "comment_id": 75589462, "body": "&quot;not detected at -O2&quot; - unfortunately GCC and Clang like to exploit UB and ASan developers chose to not alter this behavior. Also check the &quot;Why didn&#39;t ASan report an obviously invalid memory access in my code?&quot; question in <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizer\" rel=\"nofollow noreferrer\">FAQ</a>."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "edited": false, "score": 0, "creation_date": 1496306729, "post_id": 44288576, "comment_id": 75610536, "body": "&quot;ASan developers chose to not alter this behavior&quot; - probly because compiler should emit a warning when exploiting undefined behavior (and if it doesn&#39;t, it could be considered as bug in compiler)."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "edited": false, "score": 0, "creation_date": 1496309774, "post_id": 44288576, "comment_id": 75612862, "body": "@yugr \u201cif it doesn&#39;t, it could be considered as bug in compiler\u201d This is not what the developers of Clang and GCC say. There is a three-blog-post essay by Chris Lattner, but so sum them up: No, and it won&#39;t happen. <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow noreferrer\">blog.llvm.org/2011/05/what-every-c-programmer-should-know.ht&zwnj;&#8203;ml</a>"}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "edited": false, "score": 0, "creation_date": 1496310040, "post_id": 44288576, "comment_id": 75613066, "body": "@yugr One idea that is currently too widespread for its truth value is that sanitizers such as ASan, UBSan, \u2026 are an exhaustive solution to the problem. It is while working on a blog post on this subject that I ended up testing the C program in this question."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "edited": false, "score": 0, "creation_date": 1496311107, "post_id": 44288576, "comment_id": 75613896, "body": "True, sanitizers try really hard but are not exhaustive. Default options are quite permissive (for a fuller list see Asan&#39;s FAQ), unrelated compiler passes may prevent sanitizers from detecting errors (which should arguably be reported and fixed, either by Asan or Clang devs), finally some low level memory bugs can not be uncovered due to tool limitations. Finally, MemorySanitizer (tool for detecting uninitialized values) is still prohibitively hard to integrate to production systems."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "edited": false, "score": 1, "creation_date": 1499776253, "post_id": 44288576, "comment_id": 77042838, "body": "For completeness, the final article has been published <a href=\"https://blog.regehr.org/archives/1520\" rel=\"nofollow noreferrer\">here</a>."}], "tags": [], "owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "is_accepted": false, "score": 0, "last_activity_date": 1496244251, "last_edit_date": 1496244251, "creation_date": 1496243729, "answer_id": 44288576, "question_id": 44281933, "link": "https://stackoverflow.com/questions/44281933/clangs-asan-does-not-detect-dangling-pointer-use/44288576#44288576", "title": "Clang&#39;s ASan does not detect dangling pointer use", "body": "<p>yugr has pointed me to the correct way to activate detection of the error in my test program. This functionality already exists in Clang 3.8.</p>\n\n<p>For completeness, the results with Clang 3.8 are below. It is interesting that the issue is detected at the default optimization level but is not detected at <code>-O2</code>.</p>\n\n<pre><code>$ clang -fsanitize=address t.c -Wall\n$ ASAN_OPTIONS=detect_stack_use_after_return=1 ./a.out \n=================================================================\n==21949==ERROR: AddressSanitizer: stack-use-after-return on address 0x7f5eeb100060 ...\nREAD of size 4 at 0x7f5eeb100060 thread T0\n...\n$ clang -O2 -fsanitize=address t.c -Wall\n$ ASAN_OPTIONS=detect_stack_use_after_return=1 ./a.out\n1\n</code></pre>\n"}], "owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 0, "accepted_answer_id": 44287544, "answer_count": 3, "score": 0, "last_activity_date": 1496244251, "creation_date": 1496225607, "last_edit_date": 1496231532, "question_id": 44281933, "link": "https://stackoverflow.com/questions/44281933/clangs-asan-does-not-detect-dangling-pointer-use", "title": "Clang&#39;s ASan does not detect dangling pointer use", "body": "<p>In the context of a tool comparison, I do not want to be unfair to ASan if it can detect the problem in the program below:</p>\n\n<pre><code>$ cat t.c\n#include &lt;stdio.h&gt;\n\nint *G;\n\nint f(void) {\n  int l = 1;\n  int res = *G;\n  G = &amp;l;\n  return res + *G;\n}\n\nint main(void) {\n  int x = 2;\n  G = &amp;x;\n  f();\n  printf(\"%d\\n\", f());\n}\n$ clang -v\nclang version 3.8.0-2ubuntu4 (tags/RELEASE_380/final)\nTarget: x86_64-pc-linux-gnu\nThread model: posix\nInstalledDir: /usr/bin\nFound candidate GCC installation: /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9\n...\n$ clang -O2 -fsanitize=address t.c\n$ ./a.out \n1\n$ clang -fsanitize=address t.c\n$ ./a.out \n2\n</code></pre>\n\n<p>The first occurence of <code>G</code> the second time <code>f</code> is called invokes undefined behavior, because <code>G</code> is indeterminate at that point. In addition, <code>G</code> is immediately dereferenced, making this the sort of memory error that one may expect ASan to detect. It is part of ASan's specifications that it sometimes fails to detect problems of the kind it is supposed to find, but I want to know if I could have used it to find this particular problem here.</p>\n\n<p>I found the option <code>-fsanitize-address-use-after-scope</code> <a href=\"https://clang.llvm.org/docs/AddressSanitizer.html\" rel=\"nofollow noreferrer\">here</a>, but this option does not work in the version of Clang I am using:</p>\n\n<pre><code>$ clang -fsanitize=address t.c -fsanitize-address-use-after-scope\nclang: error: unknown argument: '-fsanitize-address-use-after-scope'\n</code></pre>\n\n<p>Is there an ASan version that flags an error at the execution of the above program, with or without special commandline options?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1496225127, "post_id": 44281707, "comment_id": 75570138, "body": "Was <code>s</code> allocated by <code>malloc</code> (or <code>calloc</code>)? Then yes you should probably <code>free</code> it <i>somewhere</i>."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 1, "creation_date": 1496225165, "post_id": 44281707, "comment_id": 75570178, "body": "So long as <code>s</code> is pointing at a dynamically allocated object, <code>free(s)</code> is fine :) Although, set does not look like a pointer, have you typedef&#39;d it?"}, {"owner": {"reputation": 613, "user_id": 5699459, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05582bd8882323cab522470ed6de92c6?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5699459/michael"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1496225533, "post_id": 44281707, "comment_id": 75570435, "body": "The set is malloc&#39;d by a function called newSet which is called by main. Drop here means to dispose. Should I free the pointer in this function or leave it to the caller to dispose of it in main?  @George, it is a typedef&#39;d pointer :)"}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 5699459, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05582bd8882323cab522470ed6de92c6?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5699459/michael"}, "edited": false, "score": 0, "creation_date": 1496225863, "post_id": 44281762, "comment_id": 75570674, "body": "If the final free() isn&#39;t called here it will be the next line in the calling function. By convention should the free be here or should it be in the calling function?"}, {"owner": {"reputation": 1505, "user_id": 2641513, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bGWLp.jpg?s=128&g=1", "display_name": "zoska", "link": "https://stackoverflow.com/users/2641513/zoska"}, "edited": false, "score": 0, "creation_date": 1496226557, "post_id": 44281762, "comment_id": 75571129, "body": "By convention it depends on name of function, this is what unwind explained to you. If function name suggests freeing, free. Moreover, is Set a typedef for a pointer? If yes, then you are making user more confused."}, {"owner": {"reputation": 613, "user_id": 5699459, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05582bd8882323cab522470ed6de92c6?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5699459/michael"}, "edited": false, "score": 0, "creation_date": 1496226867, "post_id": 44281762, "comment_id": 75571363, "body": "dropSet() is part of an ADT, the user will never &quot;see&quot; it. Thank you for the clarity :)"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 2, "last_activity_date": 1496225122, "creation_date": 1496225122, "answer_id": 44281762, "question_id": 44281707, "link": "https://stackoverflow.com/questions/44281707/convention-for-freeing-c-adts/44281762#44281762", "title": "Convention for freeing C ADTs", "body": "<p>That of course depends on what \"drop\" means for a Set. Does it mean \"clear this Set, make it empty\" or does it mean \"delete this Set, it's no longer valid\".</p>\n\n<p>If it's the former, then the final <code>free()</code> should not be there, but otherwise it should.</p>\n\n<p>Since \"drop\" (at least to me) is not clear, it's hard to answer this with certainty.</p>\n\n<p>I would suggest renaming the function (to perhaps <code>freeSet()</code> or <code>deleteSet()</code>, or whatever the inverse of the function that creates a set would be) and documenting the semantics (i.e. what it does) to make it really clear. Then decide on the code.</p>\n"}], "owner": {"reputation": 613, "user_id": 5699459, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05582bd8882323cab522470ed6de92c6?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5699459/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 44281762, "answer_count": 1, "score": 0, "last_activity_date": 1496225757, "creation_date": 1496224992, "last_edit_date": 1496225757, "question_id": 44281707, "link": "https://stackoverflow.com/questions/44281707/convention-for-freeing-c-adts", "title": "Convention for freeing C ADTs", "body": "<p>When writing a free function for an ADT what is the convention for freeing the passed pointer?</p>\n\n<pre><code>void dropSet(Set s) {\n   if (s == NULL) {\n      return;\n   }\n   Node next, curr = s-&gt;elems;\n   while (curr != NULL) {\n      next = curr-&gt;next;\n      dropNode(curr);\n      curr = next;\n   }\n   free(s)   // &lt;== Should this line be here or no?\n   s = NULL; // &lt;== Should this line be here or no?\n}\n</code></pre>\n\n<p>** <strong>Edit</strong> **</p>\n\n<p>The set is malloc'd by a function called newSet which is called by the user. Drop here means to dispose of the set. If free(s) is not called here it will be the next line called in main. I understand in an isolated implementation ultimately whichever way I do it makes no difference but as a convention in the wider community should I be freeing the pointer in this function and setting it to NULL or leaving it to the caller to free it where it's called from?</p>\n"}, {"tags": ["c", "segmentation-fault", "undefined-behavior"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1496223084, "post_id": 44280905, "comment_id": 75568598, "body": "<code>int a[]= {};</code> is no use - you must define the array <i>after</i> you know its size."}, {"owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "edited": false, "score": 0, "creation_date": 1496223200, "post_id": 44280905, "comment_id": 75568691, "body": "<a href=\"https://stackoverflow.com/questions/1677157/can-size-of-array-be-determined-at-run-time-in-c\" title=\"can size of array be determined at run time in c\">stackoverflow.com/questions/1677157/&hellip;</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1496246414, "post_id": 44280905, "comment_id": 75585724, "body": "the posted code does not compile! It causes the compiler to output two messages:  1) <code>5:12: warning: ISO C forbids empty initializer braces [-Wpedantic]</code>  and 2) <code>5:7: error: zero or negative size array &#39;a&#39;</code>  When compiling always enable the warnings.  Then fix those warnings.   (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -pedantic</code> )"}], "answers": [{"comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1496223277, "post_id": 44280957, "comment_id": 75568759, "body": "Only if <code>__STDC_NO_VLA__</code> is <i>not</i> defined as a macro identifier."}, {"owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1496223413, "post_id": 44280957, "comment_id": 75568868, "body": "@DeiDei the OP does not mention such a macro definition in his program... That&#39;s why I did not mention this."}, {"owner": {"reputation": 21, "user_id": 6864829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e1fde56b54c1c0b6f4f61d626a8bf65?s=128&d=identicon&r=PG&f=1", "display_name": "Vasanth", "link": "https://stackoverflow.com/users/6864829/vasanth"}, "edited": false, "score": 0, "creation_date": 1496233742, "post_id": 44280957, "comment_id": 75576302, "body": "Hi Marievi and others...Thanks for your inputs. Its clear now and thanks for introducing the C11 standards which gave me some insight"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496246734, "post_id": 44280957, "comment_id": 75585922, "body": "compiling this answer results in: 1) <code>12:5: error: variable sized objct may not be initialized.</code> 2) <code>12:30: warning: ISO C forbids empty initializer braces [-Wpedantic]</code>"}], "tags": [], "owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "is_accepted": false, "score": 1, "last_activity_date": 1496296866, "last_edit_date": 1496296866, "creation_date": 1496223107, "answer_id": 44280957, "question_id": 44280905, "link": "https://stackoverflow.com/questions/44280905/array-of-unknown-bound-usage-in-c-programming/44280957#44280957", "title": "Array of unknown bound usage in C programming", "body": "<blockquote>\n  <p>I would like to know why the output is undefined and what will be implication when I try to assign value to an array of unknown bound</p>\n</blockquote>\n\n<p>The size of variable <code>a</code> will be <code>0</code>, as <code>num_of_elements</code> has not been <code>scanf</code>'ed at that point, so you can't store anything in it.</p>\n\n<p>The solution is to declare the array <strong><em>after</em></strong> you have read its size from the user. This means :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int num_of_elements;\n    int count = 0;\n\n    printf(\"Enter the number of elements:\\n\");\n    scanf(\"%d\", &amp;num_of_elements);\n\n    //define here your array\n    int a[num_of_elements];\n\n    ...\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 1, "last_activity_date": 1496223452, "creation_date": 1496223452, "answer_id": 44281104, "question_id": 44280905, "link": "https://stackoverflow.com/questions/44280905/array-of-unknown-bound-usage-in-c-programming/44281104#44281104", "title": "Array of unknown bound usage in C programming", "body": "<p>As a first hint, when you try to compile this with <code>gcc</code>using <code>-pedantic</code>, it will refuse to compile:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ gcc -std=c11 -Wall -Wextra -pedantic -ocrap.exe crap.c\ncrap.c: In function 'main':\ncrap.c:5:12: warning: ISO C forbids empty initializer braces [-Wpedantic]\n   int a[]= {};\n            ^\ncrap.c:5:7: error: zero or negative size array 'a'\n   int a[]= {};\n       ^\n</code></pre>\n\n<p>And indeed, the size of such a variable is <code>0</code>, so you can't store <em>anything</em>  in it.</p>\n\n<p>Still it is a valid syntax and has its uses, for example as a \"flexible array member\" of a structure:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct foo\n{\n    int bar;\n    int baz[];\n};\n\n[...]\n\nstruct foo *myfoo = malloc(sizeof(struct foo) + 5 * sizeof(int));\n// myfoo-&gt;baz can now hold 5 integers\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6864829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e1fde56b54c1c0b6f4f61d626a8bf65?s=128&d=identicon&r=PG&f=1", "display_name": "Vasanth", "link": "https://stackoverflow.com/users/6864829/vasanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1496296866, "creation_date": 1496222984, "last_edit_date": 1496223628, "question_id": 44280905, "link": "https://stackoverflow.com/questions/44280905/array-of-unknown-bound-usage-in-c-programming", "title": "Array of unknown bound usage in C programming", "body": "<p>I output of below code is undefined when I ran multiple times. I would like to know why the output is undefined and what will be implication when I try to assign value to an array of unknown bound.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n  int a[]= {};\n  int num_of_elements;\n  int count = 0;\n\n  printf(\"Enter the number of elements:\\n\");\n  scanf(\"%d\",&amp;num_of_elements);\n\n  printf(\"Enter the numbers:\\n\");\n  for(count=0; count&lt;num_of_elements; ++count)\n  {\n    scanf(\"%d\", &amp;a[count]);\n  }\n  printf(\"\\n\");\n\n  for(count=0; count&lt;num_of_elements; count++)\n  {\n    printf(\"%d,   \", a[count]);\n  }\n  printf(\"\\n\");\n\n  return 0;\n}\n</code></pre>\n\n<p>Output when run at different times:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Enter the number of elements:\n2\n\nEnter the numbers:\n1 2\n\n0,   0,\n</code></pre>\n\n<hr>\n\n<pre class=\"lang-none prettyprint-override\"><code>Enter the number of elements:\n3\n\nEnter the numbers:\n1 2 3\n\n0,   0,   2,\n</code></pre>\n\n<hr>\n\n<pre class=\"lang-none prettyprint-override\"><code>Enter the number of elements:\n4\n\nEnter the numbers:\n1 2 3 4\n\n0,   0,   2,   3,\nSegmentation fault\n</code></pre>\n\n<hr>\n\n<pre class=\"lang-none prettyprint-override\"><code>Enter the number of elements:\n5\n\nEnter the numbers:\n1 2 3 4 5\n\n0,   0,   2,   3,   4,\nSegmentation fault\n</code></pre>\n"}, {"tags": ["c", "function", "file", "struct", "fopen"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1496222618, "post_id": 44280664, "comment_id": 75568249, "body": "Read up on keywords &quot;loop&quot; and &quot;string length&quot; that should help you getting further. To a point where you can ask specific questions concerning what seems to be a a homework assignment."}, {"owner": {"reputation": 1699, "user_id": 4891815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/niZw9.jpg?s=128&g=1", "display_name": "Gnqz", "link": "https://stackoverflow.com/users/4891815/gnqz"}, "edited": false, "score": 0, "creation_date": 1496222685, "post_id": 44280664, "comment_id": 75568299, "body": "Not checking the results from fopen() and fprintf() is asking for trouble."}, {"owner": {"reputation": 310, "user_id": 5674968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cc331b88886d57d18286c139e72e0345?s=128&d=identicon&r=PG&f=1", "display_name": "R. Joiny", "link": "https://stackoverflow.com/users/5674968/r-joiny"}, "edited": false, "score": 0, "creation_date": 1496223558, "post_id": 44280664, "comment_id": 75568973, "body": "Read up the man pages for <code>fopen</code> and <code>getline</code> that could help you get it working"}], "answers": [{"tags": [], "owner": {"reputation": 2544, "user_id": 3374593, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b52e8f3dbba2dd84cee919766d30125d?s=128&d=identicon&r=PG&f=1", "display_name": "L&#230;rne", "link": "https://stackoverflow.com/users/3374593/l%c3%a6rne"}, "is_accepted": true, "score": 1, "last_activity_date": 1496236962, "last_edit_date": 1496236962, "creation_date": 1496223666, "answer_id": 44281200, "question_id": 44280664, "link": "https://stackoverflow.com/questions/44280664/writing-into-txt-file-in-c-and-printing-data-out/44281200#44281200", "title": "Writing into txt file in C and printing data out", "body": "<ul>\n<li>First, make sure to check the return code from <code>fopen</code>.  If it couldn't open the file, you should stop the function there.</li>\n<li>Don't use scanf to scan string.  It's unsafe as the string result is potentially unbound, use <code>scanf_s</code> or <code>fgets</code> instead.</li>\n<li>To compute a minimum or a sum, use an <em>accumulator</em>.  A variable, you update on each step to match what you're trying to compute.  E.g. to compute the index of the min value of an array of <code>int</code>s,</li>\n</ul>\n\n<p>.</p>\n\n<pre><code>//the array\nint arr[] = {3,1,4,2,3,0};\n\n//accumulators\nint min_value = INT_MAX; /* INT_MAX defined in \"limits.h\" */\nint min_index = -1;\n\n//steps\nfor( int i = 0; i &lt; 6; ++i ) {\n    if( arr[i] &lt; min_value ) {\n        min_value = arr[i];\n        min_index = i;\n    }\n}\n</code></pre>\n\n<ul>\n<li>To loop, use a <code>do{...}while(...);</code> loop, and use <code>strncmp</code> to compare C strings (it returns <code>0</code> if they are the same).</li>\n</ul>\n"}], "owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 44281200, "answer_count": 1, "score": 0, "last_activity_date": 1496236962, "creation_date": 1496222414, "last_edit_date": 1592644375, "question_id": 44280664, "link": "https://stackoverflow.com/questions/44280664/writing-into-txt-file-in-c-and-printing-data-out", "title": "Writing into txt file in C and printing data out", "body": "<p>I have to make program which requires user to:</p>\n<blockquote>\n<p>enter surname (17 letters max)</p>\n<p>enter name (11 letters max)</p>\n<p>enter subject (20 letters max)</p>\n<p>enter number of points (number between 0 and 50)</p>\n</blockquote>\n<p>Entering need to repeat and ends afer you write END as a surname, and then close txt file</p>\n<p>After that, I have to write function that opens txt file, reads it and print all data from it in this format:</p>\n<pre><code>surname|name|subject|points\n-----------------------------\n-----------------------------\ndoe|jane|math|36\ndoe|john|programming|45\n</code></pre>\n<p>In same function I have to find which entry have lowest number of points, and then print it (if there are two with same number of points then print last one that is found). After that, in the same function I have to calculate how big file is and print it in bytes.</p>\n<p>I managed to write code to enter name and write it into the txt file, but I can't make the rest of the program, anyone have an idea how to?</p>\n<p>This is my code:</p>\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    FILE *inputfile = NULL;\n    FILE *outfile = NULL;\n    struct imenik\n    {\n        char surname[17 + 1];\n        char name[11 + 1];\n        char subject[20 + 1];\n        int points;\n    } imen;\n\n    outfile = fopen(&quot;new.txt&quot;, &quot;w&quot;);\n\n    printf(&quot;Enter surname: &quot;);\n    scanf(&quot;%s &quot;, imen.surname);\n\n    printf(&quot;Enter name: &quot;);\n    scanf(&quot;%s &quot;, imen.name);\n\n    printf(&quot;Enter course: &quot;);\n    scanf(&quot;%s &quot;, imen.subject);\n\n    printf(&quot;Enter points (0 - 50): &quot;);\n    scanf(&quot;%d &quot;, &amp;imen.points);\n\n\n    printf(&quot;\\n %s|%s|%s|%d&quot;, imen.name, imen.surname, imen.subject, imen.points);\n\n    fprintf(outfile, &quot;\\n %s|%s|%s|%d&quot;, imen.name, imen.surname, imen.subject, imen.points);\n    fclose(outfile);\n    \n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "directory"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1496221578, "post_id": 44280263, "comment_id": 75567500, "body": "Well, look about the error ? <code>perror()</code> for example."}, {"owner": {"reputation": 9, "user_id": 8090881, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212265691616354/picture?type=large", "display_name": "Simone Boattini", "link": "https://stackoverflow.com/users/8090881/simone-boattini"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496223399, "post_id": 44280263, "comment_id": 75568858, "body": "it joins in the first if and print &quot;Cannot open directory&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 1, "creation_date": 1496221997, "post_id": 44280414, "comment_id": 75567787, "body": "It&#39;s still too short because he also adds a trailing <code>&#47;</code>."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1496223381, "post_id": 44280414, "comment_id": 75568843, "body": "Then use <code>errno</code> and try <a href=\"http://man7.org/linux/man-pages/man1/strace.1.html\" rel=\"nofollow noreferrer\">strace(1)</a> on your program. Don&#39;t forget to compile with all warnings &amp; debug info (<code>gcc -Wall -Wextra -g</code>) and <b>use the debugger <code>gdb</code></b>"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 2, "last_activity_date": 1496222771, "last_edit_date": 1496222771, "creation_date": 1496221763, "answer_id": 44280414, "question_id": 44280263, "link": "https://stackoverflow.com/questions/44280263/cannot-open-directory-a-second-time/44280414#44280414", "title": "Cannot open directory a second time", "body": "<pre><code>char newPath[strlen(path)+strlen(dir)];  //WRONG!\n</code></pre>\n\n<p>is certainly wrong. You need to reserve one extra byte for the terminating 0 and you are adding a <code>/</code>. So it should be </p>\n\n<pre><code>char newPath[strlen(path)+strlen(dir)+2];\n</code></pre>\n\n<p>BTW, consider using <a href=\"http://man7.org/linux/man-pages/man3/snprintf.3.html\" rel=\"nofollow noreferrer\">snprintf(3)</a> or <a href=\"http://man7.org/linux/man-pages/man3/asprintf.3.html\" rel=\"nofollow noreferrer\">asprintf(3)</a> instead of your <code>strcat</code> calls.</p>\n\n<p>I am not sure that calling <a href=\"http://man7.org/linux/man-pages/man2/chdir.2.html\" rel=\"nofollow noreferrer\">chdir(2)</a> is a wise idea, and you certainly should check that it went well. See <a href=\"http://man7.org/linux/man-pages/man3/perror.3.html\" rel=\"nofollow noreferrer\">perror(3)</a>, <a href=\"http://man7.org/linux/man-pages/man3/errno.3.html\" rel=\"nofollow noreferrer\">errno(3)</a>, <a href=\"http://man7.org/linux/man-pages/man3/strerror.3.html\" rel=\"nofollow noreferrer\">strerror(3)</a>.</p>\n\n<p>Look also into <a href=\"http://man7.org/linux/man-pages/man3/nftw.3.html\" rel=\"nofollow noreferrer\">nftw(3)</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 8045197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29482fe7963eb3e2c9d4fb6af0eaba98?s=128&d=identicon&r=PG&f=1", "display_name": "Yeongbae", "link": "https://stackoverflow.com/users/8045197/yeongbae"}, "is_accepted": false, "score": 1, "last_activity_date": 1496224452, "creation_date": 1496224452, "answer_id": 44281502, "question_id": 44280263, "link": "https://stackoverflow.com/questions/44280263/cannot-open-directory-a-second-time/44281502#44281502", "title": "Cannot open directory a second time", "body": "<p>in struct dirent, member d_name contains name without path. This means that parameter passed to the function, opendir(), does not have path to file or directory so that error ENOENT happens. </p>\n\n<p>lets say you have directory /home/usr/folder1/folder2. and you call </p>\n\n<p><code>scandir(\"/home/usr/folder1/\", 2, type, ...) // I understood only first two parameters.</code></p>\n\n<p>this functions seems to work but when the function calls itself recursively to search /home/usr/folder1/folder2  </p>\n\n<p><code>if (depth&gt;1 || depth&lt;=-1)\n   scanDir(entry-&gt;d_name,depth-1,type,newPath,gtsize,attrib);</code></p>\n\n<p>the first parameter passed to the scandir this time is \"folder2\" not \"/home/usr/folder1/folder2\" so opendir(dir) gives error named ENOENT</p>\n\n<p>and one more thing you should be careful is that readdir() function is not reentrant function so that calling readdir() function may result in not expected error. in your code, it looks like the function gives result as you want. However, I think \"how it works\" may be different from what you think. if the code becomes complicated, i recommends to use readdir_r() function which is re-entrant version of readdir</p>\n\n<p>according to the man page of readdir:</p>\n\n<blockquote>\n  <p>On success, readdir() returns a pointer to a dirent structure.  (This\n         structure may be statically allocated; do not attempt to free(3) it.)</p>\n</blockquote>\n\n<p>after recursively calling scandir() function, in each stack of function, your entry becomes NUll pointer since the structure is statically allocated.</p>\n\n<p>another suggestion for you function is that using nftw() or scandir() functions offered by linux. especially nftw is really powerful and does most of you want.</p>\n"}], "owner": {"reputation": 9, "user_id": 8090881, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212265691616354/picture?type=large", "display_name": "Simone Boattini", "link": "https://stackoverflow.com/users/8090881/simone-boattini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496224452, "creation_date": 1496221352, "last_edit_date": 1496222479, "question_id": 44280263, "link": "https://stackoverflow.com/questions/44280263/cannot-open-directory-a-second-time", "title": "Cannot open directory a second time", "body": "<p>I have a problem opening the same directory on second call.\nFor example i first open folder1/folder2; then if i call the function i'm using on folder1 it says it cannot open it. I though I would close all directories in a path and tried to do it but with no results.\nThis is my code</p>\n\n<pre><code>void scanDir(char *dir, int depth, char type, char *path, long gtsize, int attrib)\n{\n    DIR *dp;\n    struct dirent *entry;\n    struct stat statbuf;\n    char newPath[strlen(path)+strlen(dir)];\n    if((dp = opendir(dir)) == NULL) {\n        fprintf(stderr,\"Cannot open directory %s\\n because of e\", dir);\n        exit(10);\n        return;\n    }\n    strcpy(newPath, path);\n    strcat(newPath, dir);\n    if (type!='f' &amp;&amp; testAttrib(attrib, dir))\n        printf(\"%s\\n\", newPath); \n    strcat(newPath, \"/\");\n    chdir(dir);\n    while((entry = readdir(dp)) != NULL) {\n        stat(entry-&gt;d_name,&amp;statbuf);\n\n        if(S_ISDIR(statbuf.st_mode) &amp;&amp; testAttrib(attrib, entry-&gt;d_name)) {\n            if(!strcmp(\".\",entry-&gt;d_name) || !strcmp(\"..\",entry-&gt;d_name))\n               continue; // ignore . and ..\n            if (depth&gt;1 || depth&lt;=-1)\n                scanDir(entry-&gt;d_name,depth-1,type,newPath,gtsize,attrib);\n        }\n        if(S_ISREG(statbuf.st_mode) &amp;&amp; type!='d' &amp;&amp; testAttrib(attrib, entry-&gt;d_name)) {\n                off_t sizeF = statbuf.st_size;\n                char filePath[100];\n                strcpy(filePath, newPath);\n                strcat(filePath, entry-&gt;d_name);\n                if(sizeF&gt;=gtsize)\n                    printf(\"%s \\n\", filePath);\n            }\n    }\n    chdir(\"..\");\n    closedir(dp);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "char", "frequency"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1496220998, "post_id": 44280054, "comment_id": 75567064, "body": "What motivated you to settle on the constant 75?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1496221128, "post_id": 44280054, "comment_id": 75567155, "body": "Maybe <code>- &#39;a&#39;</code> should be <code>- &#39;0&#39;</code>"}, {"owner": {"reputation": 4880, "user_id": 2412895, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/p3J02.jpg?s=128&g=1", "display_name": "KarelG", "link": "https://stackoverflow.com/users/2412895/karelg"}, "edited": false, "score": 0, "creation_date": 1496221156, "post_id": 44280054, "comment_id": 75567173, "body": "You need to count the characters based on the input. That&#39;s not what you do (your code is also not safe). Also please lookup to the ASCII table. If you only check between <code>0</code> and <code>z</code>, you&#39;re excluding a space character and including symbols like <code>:</code>,  <code>;</code> , ect ... A huffman algorithm doesn&#39;t take account if a character is between 0 - z. If the character isn&#39;t present, add it to the array."}, {"owner": {"reputation": 307, "user_id": 7764757, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-zdi1PZp3eW0/AAAAAAAAAAI/AAAAAAAAA1o/HgGlfSRve9w/photo.jpg?sz=128", "display_name": "Anh Minh Tran", "link": "https://stackoverflow.com/users/7764757/anh-minh-tran"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1496221183, "post_id": 44280054, "comment_id": 75567190, "body": "@Bathsheba I&#39;m trying to follow ASCII, the range &#39;0&#39; to &#39;z&#39; is the range 48 to 122, a range of 75 characters."}, {"owner": {"reputation": 307, "user_id": 7764757, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-zdi1PZp3eW0/AAAAAAAAAAI/AAAAAAAAA1o/HgGlfSRve9w/photo.jpg?sz=128", "display_name": "Anh Minh Tran", "link": "https://stackoverflow.com/users/7764757/anh-minh-tran"}, "reply_to_user": {"reputation": 4880, "user_id": 2412895, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/p3J02.jpg?s=128&g=1", "display_name": "KarelG", "link": "https://stackoverflow.com/users/2412895/karelg"}, "edited": false, "score": 0, "creation_date": 1496221298, "post_id": 44280054, "comment_id": 75567281, "body": "@KarelG The input will only contain alphabetical character and an array of 10 numbers"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1496221681, "post_id": 44280054, "comment_id": 75567562, "body": "@AnhMinhTran: Don&#39;t do it like that. Write portable code instead which will probably wind up tidier anyway. That is, don&#39;t assume ASCII <i>encoding</i> and base something around the literal &quot;0...9A..Za...z&quot;."}, {"owner": {"reputation": 4880, "user_id": 2412895, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/p3J02.jpg?s=128&g=1", "display_name": "KarelG", "link": "https://stackoverflow.com/users/2412895/karelg"}, "edited": false, "score": 1, "creation_date": 1496221865, "post_id": 44280054, "comment_id": 75567687, "body": "@AnhMinhTran Don&#39;t forget that there are non alphanumeric characters between <code>9</code> and <code>A</code>, and <code>Z</code> and <code>a</code> ..."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 4880, "user_id": 2412895, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/p3J02.jpg?s=128&g=1", "display_name": "KarelG", "link": "https://stackoverflow.com/users/2412895/karelg"}, "edited": false, "score": 0, "creation_date": 1496221998, "post_id": 44280054, "comment_id": 75567790, "body": "@KarelG: Absolutely. In EBCDIC it&#39;s worse still."}, {"owner": {"reputation": 4880, "user_id": 2412895, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/p3J02.jpg?s=128&g=1", "display_name": "KarelG", "link": "https://stackoverflow.com/users/2412895/karelg"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1496222405, "post_id": 44280054, "comment_id": 75568097, "body": "@Bathsheba you must live in the past \ud83d\ude1b"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1496222513, "post_id": 44280054, "comment_id": 75568182, "body": "No, I just like to write portable C. There&#39;s a whole plethora of functions to help you; <code>isalpha</code>, <code>tolower</code>, <code>toupper</code>, &amp;c. Note the standard insists that 0-9 are always consecutive, but pretty much anything else goes."}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 7764757, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-zdi1PZp3eW0/AAAAAAAAAAI/AAAAAAAAA1o/HgGlfSRve9w/photo.jpg?sz=128", "display_name": "Anh Minh Tran", "link": "https://stackoverflow.com/users/7764757/anh-minh-tran"}, "edited": false, "score": 0, "creation_date": 1496221459, "post_id": 44280184, "comment_id": 75567399, "body": "Chaging to what you suggest would change the output of the program to count once for each letter from a - j though some is not in the input"}], "tags": [], "owner": {"reputation": 35, "user_id": 8045197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29482fe7963eb3e2c9d4fb6af0eaba98?s=128&d=identicon&r=PG&f=1", "display_name": "Yeongbae", "link": "https://stackoverflow.com/users/8045197/yeongbae"}, "is_accepted": false, "score": 0, "last_activity_date": 1496221162, "creation_date": 1496221162, "answer_id": 44280184, "question_id": 44280054, "link": "https://stackoverflow.com/questions/44280054/cant-read-number-char-frequency/44280184#44280184", "title": "Cant read number char frequency", "body": "<p>I guess chaning the code</p>\n\n<p><code>count[data[c] - 'a']++;</code></p>\n\n<p>to </p>\n\n<p><code>count[data[c] - '0']++;</code></p>\n\n<p>if data[c] is less than 75, then count[data[c] - 'a'] does not work</p>\n"}, {"comments": [{"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496221700, "post_id": 44280321, "comment_id": 75567578, "body": "Forgot to change the <code>printf</code>, fixing it"}, {"owner": {"reputation": 307, "user_id": 7764757, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-zdi1PZp3eW0/AAAAAAAAAAI/AAAAAAAAA1o/HgGlfSRve9w/photo.jpg?sz=128", "display_name": "Anh Minh Tran", "link": "https://stackoverflow.com/users/7764757/anh-minh-tran"}, "edited": false, "score": 0, "creation_date": 1496221890, "post_id": 44280321, "comment_id": 75567709, "body": "Thanks for the answer, but this counts characters that does not appear in the input for some reasons. There are also counted characters that the console cannot present so it show it as ? with a square. What do you think can be a reason for this"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 307, "user_id": 7764757, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-zdi1PZp3eW0/AAAAAAAAAAI/AAAAAAAAA1o/HgGlfSRve9w/photo.jpg?sz=128", "display_name": "Anh Minh Tran", "link": "https://stackoverflow.com/users/7764757/anh-minh-tran"}, "edited": false, "score": 0, "creation_date": 1496222837, "post_id": 44280321, "comment_id": 75568423, "body": "@AnhMinhTran I forgot to change the printing. Now it should work just fine. Does it ?"}, {"owner": {"reputation": 307, "user_id": 7764757, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-zdi1PZp3eW0/AAAAAAAAAAI/AAAAAAAAA1o/HgGlfSRve9w/photo.jpg?sz=128", "display_name": "Anh Minh Tran", "link": "https://stackoverflow.com/users/7764757/anh-minh-tran"}, "edited": false, "score": 0, "creation_date": 1496225076, "post_id": 44280321, "comment_id": 75570105, "body": "can you explain to me how it works? The program still cant read capital letter though, and &quot;0,1,9&quot; cant be read. Can you explain to me the logic of the 2 lower &quot;count&quot; code below?"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 307, "user_id": 7764757, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-zdi1PZp3eW0/AAAAAAAAAAI/AAAAAAAAA1o/HgGlfSRve9w/photo.jpg?sz=128", "display_name": "Anh Minh Tran", "link": "https://stackoverflow.com/users/7764757/anh-minh-tran"}, "edited": false, "score": 0, "creation_date": 1496233056, "post_id": 44280321, "comment_id": 75575803, "body": "@AnhMinhTran I tried to comment and explain what I did. Is it more clear ?  Also, I added my output with the exact same code. Yours is different ?"}], "tags": [], "owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "is_accepted": true, "score": 0, "last_activity_date": 1496232973, "last_edit_date": 1496232973, "creation_date": 1496221502, "answer_id": 44280321, "question_id": 44280054, "link": "https://stackoverflow.com/questions/44280054/cant-read-number-char-frequency/44280321#44280321", "title": "Cant read number char frequency", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    FILE *fb;\n    char data[255];\n    int c = 0;\n    int count[75] = { 0 };\n    fb = fopen(\"Input.txt\", \"r\");\n    fgets(data, 255, fb);\n\n    /* Start finding frequency*/\n    while (data[c] != '\\0')\n    {\n        if (data[c] &gt;= 'a' &amp;&amp; data[c] &lt;= 'z') // here you check normal letters\n            count[data[c] - 'a']++;\n        else if (data[c] &gt;= 'A' &amp;&amp; data[c] &lt;= 'Z')\n            count[data[c] - 'A' + 26]++; // Capital letters will be stored after lower cases\n        else if (data[c] &gt;= '0' &amp;&amp; data[c] &lt;= '9')\n            count[data[c] - '0' + 51]++; // Numbers will be stored after capital letters\n        c++;\n    }\n\n    // count[] is initialized as following : \n    // From count[0] to count[25] == Occurence of low case characters\n    // From count[26] to count[51] == Occurence of capital characters\n    // From count[52] to count[61] == Occurence of numbers from 0 to 9\n\n    for (c = 0; c &lt; 61; c++)\n    {\n        /** Printing only those characters\n        whose count is at least 1 */\n        if (count[c] != 0) {\n            if (c &lt; 26)\n                printf(\"%c occurs %d times in the entered string.\\n\", c + 'a', count[c]); \n\n                // Starting from 'a', iterating until 'z'\n            else if (c &lt; 52)\n                printf(\"%c occurs %d times in the entered string.\\n\", c + 'A' - 26, count[c]);\n\n                // Same as for low case characters\n                // Substracting 26 because we already have iterated through the first 26 low case characters\n                // Starting from 'A' until 'Z'\n\n            else if (c &gt;= 52)\n                printf(\"%c occurs %d times in the entered string.\\n\", c + '0' - 51, count[c]);\n\n                // Same as for characters\n                // Substracting 51 because we already have iterated through low cases and capital characters\n                // Starting from '0' until '9'\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The problem is that, considering the <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">ascii table</a>, you were storing the capital letters and numbers in a negative indice of your array <code>count</code>by substracting <code>'a'</code>which is equal to <code>97</code>in ASCII. This should work but I couldn't test it yet so be careful with it. </p>\n\n<p>For the printing, we do the same thing for low case characters, then capital characters and then numbers : we start from the first one : <code>'a'</code>, then <code>'A'</code>, then <code>'0'</code>, iterate until the last one using c and printing them all. We use the fact that in C, <code>'a' + 1 = 'b'</code>, <code>'A' + 1 = 'B'</code> etc. </p>\n\n<p>For the input <code>Fred Fish 12345678</code> the output with this code is : </p>\n\n<pre><code>d occurs 1 times in the entered string.\ne occurs 1 times in the entered string.\nh occurs 1 times in the entered string.\ni occurs 1 times in the entered string.\nr occurs 1 times in the entered string.\ns occurs 1 times in the entered string.\nF occurs 2 times in the entered string.\n1 occurs 1 times in the entered string.\n2 occurs 1 times in the entered string.\n3 occurs 1 times in the entered string.\n4 occurs 1 times in the entered string.\n5 occurs 1 times in the entered string.\n6 occurs 1 times in the entered string.\n7 occurs 1 times in the entered string.\n8 occurs 1 times in the entered string.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3543, "user_id": 6329118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a20c0ed8a82fd967952e2539203af9?s=128&d=identicon&r=PG&f=1", "display_name": "CWLiu", "link": "https://stackoverflow.com/users/6329118/cwliu"}, "is_accepted": false, "score": 0, "last_activity_date": 1496223051, "last_edit_date": 1496223051, "creation_date": 1496222125, "answer_id": 44280563, "question_id": 44280054, "link": "https://stackoverflow.com/questions/44280054/cant-read-number-char-frequency/44280563#44280563", "title": "Cant read number char frequency", "body": "<p>You should modify the <code>'a'</code> to <code>'0'</code> in your code to take all capital letters and numerics into account.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n       ...\n    /* snippet */\n       ...    \n\n    while (data[c] != '\\0')\n    {   \n        if( data[c] &gt;= '0' &amp;&amp; data[c] &lt;= 'z')\n        count[data[c] - '0']++;\n        c++;                                                                                                                                                                                                 \n    }   \n\n    for (c = 0; c &lt; 75; c++)\n    {   \n        /** Printing only those characters\n         whose count is at least 1 */\n\n        if (count[c] != 0)\n            printf(\"%c occurs %d times in the entered string.\\n\",c+'0',count[c]);\n    }   \n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 7764757, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-zdi1PZp3eW0/AAAAAAAAAAI/AAAAAAAAA1o/HgGlfSRve9w/photo.jpg?sz=128", "display_name": "Anh Minh Tran", "link": "https://stackoverflow.com/users/7764757/anh-minh-tran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 44280321, "answer_count": 3, "score": -1, "last_activity_date": 1496232973, "creation_date": 1496220782, "last_edit_date": 1496220925, "question_id": 44280054, "link": "https://stackoverflow.com/questions/44280054/cant-read-number-char-frequency", "title": "Cant read number char frequency", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    FILE *fb;\n    char data[255];\n    int c=0;\n    int count[75] = {0};\n    fb = fopen(\"Input.txt\", \"r\");\n    fgets(data, 255, fb);\n\n    /* Start finding frequency*/\n    while (data[c] != '\\0')\n    {\n        if( data[c] &gt;= '0' &amp;&amp; data[c] &lt;= 'z')\n        count[data[c] - 'a']++;\n\n        c++;\n    }    \n    for (c = 0; c &lt; 75; c++)\n    {\n        /** Printing only those characters\n            whose count is at least 1 */\n\n        if (count[c] != 0)\n            printf(\"%c occurs %d times in the entered string.\\n\",c+'a',count[c]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Example input file: \"Fred Fish 12345678\"</p>\n\n<p>I am able to handle space from the input file, but the program does not read Frequency of capital letter as well as number character. What can I change in the program help fixing the problem. After reading the freq, my plan is to save the file so that I can compress using HUffman</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496220904, "post_id": 44280007, "comment_id": 75567016, "body": "Look at the generated code. My guess is that temporary values are stored on the CPU stack, while the return values are returned in a CPU register (that then might be pushed onto the stack)."}, {"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496221214, "post_id": 44280007, "comment_id": 75567211, "body": "@Someprogrammerdude that is an interesting case. I am going to collect some intel on this. I hope it goes not beyond my actual skills."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1496221292, "post_id": 44280007, "comment_id": 75567277, "body": "The C language does not make any requirements how/where these are stored or the compiler does not convert this to iterative machine code. On the same architecture, they most likely use the same facilities as functional PLs. Note that on a machine with <b>finite</b> storage, there cannot be an <b>in</b>finite number of bits stored. Anyway, we are not a tutoring site. These basics will be explained by general computing/CS books and more detailed books about programming and compiler construction. You question is in fact not bound to a specific programming language (and definitively not about F#)."}, {"owner": {"reputation": 8452, "user_id": 621427, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0eFAm.png?s=128&g=1", "display_name": "robkuz", "link": "https://stackoverflow.com/users/621427/robkuz"}, "edited": false, "score": 0, "creation_date": 1496221408, "post_id": 44280007, "comment_id": 75567361, "body": "I dont know if I get your problem but it seems to me this should be solveable with some <code>fold</code>ing, no? <a href=\"https://fpish.net/blog/anton.tayanovskyy/id/1453/http~3a~2f~2fwww.intellifactory.com~2fblogs~2fanton.tayanovskyy~2f2009~2f12~2f11~2fFoldr-or-FoldBack-on-Infinite-F~21sharp~21-Sequences.article\" rel=\"nofollow noreferrer\">fpish.net/blog/anton.tayanovskyy/id/1453/&hellip;</a>"}, {"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496221639, "post_id": 44280007, "comment_id": 75567539, "body": "@Olaf, you are right, the F# code here is just an example to, hopefully, help me to communicate the problem to the community. Apparently, I just get the nose in an issue that goes beyond my actual competences. In any case, thank you a lot for the details you provided me."}, {"owner": {"reputation": 1777, "user_id": 976686, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ede54d46af9980731445194bc6603312?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/976686/simon"}, "edited": false, "score": 0, "creation_date": 1496222028, "post_id": 44280007, "comment_id": 75567810, "body": "Recursive functions store internal state on the stack. Which causes potential stack overflow, so it is a bad practise."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1496222056, "post_id": 44280007, "comment_id": 75567828, "body": "@Worice: As long as you accept it at the moment and take learning it as a challenge, all is fine. Too bad most people today feel personally offended being told they need to learn more to understand something. So heads up,  you have a good attitude."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1777, "user_id": 976686, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ede54d46af9980731445194bc6603312?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/976686/simon"}, "edited": false, "score": 1, "creation_date": 1496222151, "post_id": 44280007, "comment_id": 75567906, "body": "@Simon: 1) There is no stack in the C language. 2) Wether this will result in recursive machine code, too depends on the actual problem and the toolchain. Modern compilers try to avoid recursive code, because it has a lot of negative implications, e.g. for memory available. But that is all implementation specific."}, {"owner": {"reputation": 1777, "user_id": 976686, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ede54d46af9980731445194bc6603312?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/976686/simon"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1496222873, "post_id": 44280007, "comment_id": 75568440, "body": "@Olaf No stack in C ? No call stack ? You mean virtually the C compiler can manage that with no allocation ... but in reality your gcc will stack overflow."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 1777, "user_id": 976686, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ede54d46af9980731445194bc6603312?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/976686/simon"}, "edited": false, "score": 0, "creation_date": 1496223261, "post_id": 44280007, "comment_id": 75568746, "body": "@Simon What Olaf means is that the C standard don&#39;t define anything about a stack."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1777, "user_id": 976686, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ede54d46af9980731445194bc6603312?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/976686/simon"}, "edited": false, "score": 0, "creation_date": 1496224503, "post_id": 44280007, "comment_id": 75569666, "body": "@Simon: 1) gcc is not the only compiler. 2) x86 is not the only architecture, not even the most sold single architecture 3) You confuse implementation and standard. Please read about the differences. 4) There are architectures which don&#39;t <b>necessarily</b> use a stack <b>for the variables</b>. See PIC, good HC08 compilers (option) 5) The compiler micht choose to inline all functions -&gt; no stack at all. 6) As I wrote, even on x86 the compiler might convert certain recursive functions to interative machine code (simplest case: tail-recursion)."}, {"owner": {"reputation": 1777, "user_id": 976686, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ede54d46af9980731445194bc6603312?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/976686/simon"}, "edited": false, "score": 0, "creation_date": 1496936534, "post_id": 44280007, "comment_id": 75877956, "body": "1) but one of the most pro eminent 2) The processor architecture is irrelevant here, it&#39;s compiler design. And ARM doesn&#39;t change anything here 3) You sure love standards 4) idem 2). 5) How do inline recursive code ? infinite code ? 6) it might, for simple cases. In general it won&#39;t. Tail call elimination isn&#39;t part of the C standard."}], "owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496221671, "creation_date": 1496220640, "last_edit_date": 1496221671, "question_id": 44280007, "link": "https://stackoverflow.com/questions/44280007/hidden-counter", "title": "Hidden counter?", "body": "<p>In order to count occurrences, for example, with F# I could do:</p>\n\n<pre><code>let l = [1, 2, 3, 3, 3, 4, 5, 5];\nlet rec f (l: int list) (n: int) :int =\n    match l, n with\n    | [], _                     -&gt; 0\n    | [x], n                    -&gt; 1\n    | x::xs when x &lt;&gt; n         -&gt; f(xs, n)\n    | x::xs when x = n          -&gt; 1 + f(xs, n)\n</code></pre>\n\n<p>With C,I usually use a counter, that store the result each time it is incremented, conceptually similar to:</p>\n\n<pre><code>i += 1 + f(xs, n);\nreturn i;\n</code></pre>\n\n<p>Please consider this problem, where we have an infinite number of blue and red marbles. The function should compute the number\nof sequences of n marbles such that it never happens that three marbles with the same colours are consecutive.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint count(int k, char last, char prev);\nint up_count(int n);\n\nint main(int argc, char const *argv[]){\n        int n;\n        printf(\"\\n\\nNumber of marbles:\\n\\n\");\n        scanf(\"%d\", &amp;n);\n        printf(\"\\n\\nSequences: %d\\n\\n\", up_count(n));\n        return 0;\n}\n\n\n\nint count(int k, char last, char prev){\n        if(k == 0)\n                return 1;\n        else{\n                if(last == prev)\n                        return (last == 'R') ? count(k - 1, 'B', last) : count(k - 1, 'R', last);\n                else\n                        return count(k - 1, 'R', last) + count(k - 1, 'B', last);\n        }       \n}       \n\nint up_count(int k){\n        return count(k, 'x', 'y');\n}\n</code></pre>\n\n<p>Where do <code>up_count</code> and <code>count</code> store the increasing amount of sequences? According to my brief experience, without an accumulator, the function should just return <code>1</code> when it comes to the base case.</p>\n"}, {"tags": ["c", "gcc", "casting", "type-conversion"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496220641, "post_id": 44279944, "comment_id": 75566847, "body": "First of all, can you please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> and show us? And then also tell us <i>where</i> you get the error? As e.g. a comment in the code?"}, {"owner": {"reputation": 171, "user_id": 3540903, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e7d6294ea0afcffc67e1a3e7a9df05b4?s=128&d=identicon&r=PG&f=1", "display_name": "CodeTry", "link": "https://stackoverflow.com/users/3540903/codetry"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496220940, "post_id": 44279944, "comment_id": 75567034, "body": "I have all the code possible for this problem which makes it quite complete and self-explanatory."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496221079, "post_id": 44279944, "comment_id": 75567123, "body": "Well, then... So now you have to tell us if you&#39;re programming in C or C++? The two languages are <i>very</i> different even if they sometimes look the same. My guess is that you&#39;re programming in C++, and in that case all you need is a <a href=\"http://en.cppreference.com/w/cpp/language/const_cast\" rel=\"nofollow noreferrer\"><code>const_cast</code></a>."}, {"owner": {"reputation": 171, "user_id": 3540903, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e7d6294ea0afcffc67e1a3e7a9df05b4?s=128&d=identicon&r=PG&f=1", "display_name": "CodeTry", "link": "https://stackoverflow.com/users/3540903/codetry"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496221180, "post_id": 44279944, "comment_id": 75567185, "body": "Sorry for that , i am using C. I got suggestion as C++ and i added it. Have removed it now."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496221269, "post_id": 44279944, "comment_id": 75567253, "body": "Then I don&#39;t really see how you would get that warning? <code>&amp;a</code> is a <code>const char **</code> which you cast to <code>char **</code> which is all fine in C. You <i>do</i> get the error on the <code>abc</code> call line? Not somewhere else?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496221377, "post_id": 44279944, "comment_id": 75567335, "body": "@Someprogrammerdude they&#39;re using a compile switch to warn about this cast even though it&#39;s legal code  (the theory being that this sort of coding practice can lead to silent UB)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496221816, "post_id": 44279944, "comment_id": 75567656, "body": "Both of those casts are <i>wrong</i> IMO. You already have the correct one, but decided to tell the compiler it&#39;s not. If you do this on many places then I would say the warning was added without due consideration, otherwise if it&#39;s only one or a few places then disable the warning for those calls using pragmas."}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 3540903, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e7d6294ea0afcffc67e1a3e7a9df05b4?s=128&d=identicon&r=PG&f=1", "display_name": "CodeTry", "link": "https://stackoverflow.com/users/3540903/codetry"}, "edited": false, "score": 0, "creation_date": 1496222108, "post_id": 44280382, "comment_id": 75567875, "body": "Could you please help me understand how would (char **)(uintptr_t)&amp;a and (char **)(uintptr_t *)&amp;a be different in the above case ? The compiler doesnot complain about both, it compiles without any warning."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 171, "user_id": 3540903, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e7d6294ea0afcffc67e1a3e7a9df05b4?s=128&d=identicon&r=PG&f=1", "display_name": "CodeTry", "link": "https://stackoverflow.com/users/3540903/codetry"}, "edited": false, "score": 1, "creation_date": 1496222242, "post_id": 44280382, "comment_id": 75567974, "body": "@CodeTry <code>a</code> might not be correctly aligned for <code>uintptr_t</code>, and in both cases the standard doesn&#39;t guarantee that a series of casts like this produces the intended result  (the only guarantee is a round trip cast back to exactly the same type). If you don&#39;t get a warning for your second suggestion, try using <code>void *</code> instead of <code>uintptr_t *</code> (it doesn&#39;t make much sense to use <code>uintptr_t *</code> anyway)"}, {"owner": {"reputation": 171, "user_id": 3540903, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e7d6294ea0afcffc67e1a3e7a9df05b4?s=128&d=identicon&r=PG&f=1", "display_name": "CodeTry", "link": "https://stackoverflow.com/users/3540903/codetry"}, "edited": false, "score": 0, "creation_date": 1496222845, "post_id": 44280382, "comment_id": 75568430, "body": "Actually yes, void * should work. Thanks a lot for your time."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1496222878, "last_edit_date": 1496222878, "creation_date": 1496221662, "answer_id": 44280382, "question_id": 44279944, "link": "https://stackoverflow.com/questions/44279944/wcast-qual-cast-discards-attribute-const-qualifier-from-pointer-targe/44280382#44280382", "title": "-Wcast-qual: cast discards \u2018__attribute__((const))\u2019 qualifier from pointer target type", "body": "<p>Firstly, the macro <code>SIZE_T_CAST</code> is a poor idea. Just use the right type in the first place.</p>\n\n<p>The codes <code>(char **)(uintptr_t)&amp;a</code> and <code>(char **)(void *)&amp;a</code> are likely to work , although not guaranteed by the C Standard.  </p>\n\n<p>However it would be much better coding style to not use the cast. Instead make a wrapper function, e.g. in the header file you could have:</p>\n\n<pre><code>#pragma GCC diagnostic push\n#pragma GCC diagnostic ignored \"-Wcast-qual\"\ninline void const_abc(const char ** p)\n{\n    abc( (char **)p );\n}\n#pragma GCC diagnostic pop\n</code></pre>\n\n<p>and then in the rest of the code, call <code>const_abc</code> when you have a <code>const char **</code> argument.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/13249756/explicit-ignore-warning-from-wcast-qual-cast-discards-attribute-const\">See here</a> for more info about disabling the warning for particular parts of the code.</p>\n"}], "owner": {"reputation": 171, "user_id": 3540903, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e7d6294ea0afcffc67e1a3e7a9df05b4?s=128&d=identicon&r=PG&f=1", "display_name": "CodeTry", "link": "https://stackoverflow.com/users/3540903/codetry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 941, "favorite_count": 0, "accepted_answer_id": 44280382, "answer_count": 1, "score": 0, "last_activity_date": 1496222878, "creation_date": 1496220465, "last_edit_date": 1496221139, "question_id": 44279944, "link": "https://stackoverflow.com/questions/44279944/wcast-qual-cast-discards-attribute-const-qualifier-from-pointer-targe", "title": "-Wcast-qual: cast discards \u2018__attribute__((const))\u2019 qualifier from pointer target type", "body": "<p>For the code :</p>\n\n<pre><code>static const char *a = NULL;\nabc((char **)&amp;a);\n</code></pre>\n\n<p>abc method is defined as :</p>\n\n<pre><code>abc(char** a)\n</code></pre>\n\n<p>I get error (warning treated as error) as :</p>\n\n<pre><code>  error: cast discards '__attribute__((const))' qualifier from pointer target type [-Werror=cast-qual]\n</code></pre>\n\n<p>To fix this , i added :</p>\n\n<pre><code>#ifdef _PTR_CAST_\n#define SIZE_T_CAST uintptr_t \n#else\n#define SIZE_T_CAST size_t\n#endif\n</code></pre>\n\n<p>My problem is , should the api call be </p>\n\n<pre><code>abc( (char **)(SIZE_T_CAST)&amp;a); or\nabc( (char **)(SIZE_T_CAST *)&amp;a);\n</code></pre>\n\n<p>It doesnot complain for both , but what is the correct way ?</p>\n"}, {"tags": ["c", "linux", "makefile", "linux-kernel"], "comments": [{"owner": {"reputation": 409, "user_id": 5106317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Zfye.jpg?s=128&g=1", "display_name": "Ozgur Murat", "link": "https://stackoverflow.com/users/5106317/ozgur-murat"}, "edited": false, "score": 1, "creation_date": 1496220299, "post_id": 44279759, "comment_id": 75566592, "body": "I think <code>c++</code> tag doesn&#39;t apply for this question."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1496222078, "post_id": 44279759, "comment_id": 75567850, "body": "For compile kernel module you need <i>some files from kernel build directory</i> (that is source directory after building the kernel) even if you don&#39;t use <code>kbuild</code> for your purposes. You need configuration options, as they are used (as macros) by Linux headers. You need versions of kernel core symbols from <code>Module.symvers</code> file. Describing whole build process without <code>kbuild</code> seems <i>too broad</i> for Stack Overflow."}], "answers": [{"tags": [], "owner": {"reputation": 34900, "user_id": 493161, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef45d137e9629d3fbe9c5f84997ac5ff?s=128&d=identicon&r=PG", "display_name": "jcomeau_ictx", "link": "https://stackoverflow.com/users/493161/jcomeau-ictx"}, "is_accepted": false, "score": 0, "last_activity_date": 1500155832, "creation_date": 1500155832, "answer_id": 45123078, "question_id": 44279759, "link": "https://stackoverflow.com/questions/44279759/how-to-build-external-kernel-module-without-kernel-source-tree/45123078#45123078", "title": "how to Build external kernel module without kernel source tree", "body": "<p>your immediate problem is that \"asm/thread_info.h\" is not in your <code>CPATH</code> and not specified in any of your <code>-I</code> parameters. you need to locate that file on your system and put its root into either the <code>CPATH</code> environment variable or an <code>-I</code> directive.</p>\n\n<p>to make this clear, if you locate the file at <code>/usr/local/include/linux/asm/thread_info.h</code>, you must precede your <code>arm-linux-gnueabihf-gcc</code> with <code>CPATH=/usr/local/include/linux</code>, or insert <code>-I /usr/local/include/linux</code> somewhere in the command line, perhaps right after <code>arm-linux-gnueabihf-gcc</code>.</p>\n\n<p>there will likely be other problems, but that should get you to the next step.</p>\n"}, {"comments": [{"owner": {"reputation": 34900, "user_id": 493161, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef45d137e9629d3fbe9c5f84997ac5ff?s=128&d=identicon&r=PG", "display_name": "jcomeau_ictx", "link": "https://stackoverflow.com/users/493161/jcomeau-ictx"}, "edited": false, "score": 0, "creation_date": 1500216580, "post_id": 45123782, "comment_id": 77229282, "body": "this requires kbuild though, and the OP stated he doesn&#39;t have that available in his build environment."}], "tags": [], "owner": {"reputation": 123, "user_id": 7537382, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/d122f0d9352681b61b68de562cc52785?s=128&d=identicon&r=PG&f=1", "display_name": "Mustafa", "link": "https://stackoverflow.com/users/7537382/mustafa"}, "is_accepted": false, "score": 0, "last_activity_date": 1500163181, "creation_date": 1500163181, "answer_id": 45123782, "question_id": 44279759, "link": "https://stackoverflow.com/questions/44279759/how-to-build-external-kernel-module-without-kernel-source-tree/45123782#45123782", "title": "how to Build external kernel module without kernel source tree", "body": "<p>you can build kernel modules with (.ko files) Make file like,</p>\n\n<p>Create Makefile with name \"Makefile\" then write this code into it;</p>\n\n<pre><code>obj-m += drivername.o\nall:\nmake -c /lib/modules/$(shell uname -r)/build M=$(PWD) modules\nclean:\nmake -c /lib/modules/$(shell uname -r)/build M=$(PWD) clean\n</code></pre>\n\n<p>Then open terminal and write <code>make</code> command in the same directory which driver is placed. this will generate .o and .ko files of the driver .</p>\n\n<p>with to insert the driver write <code>insmod</code>\nthe driver will be loaded to your kernel. </p>\n\n<p>if I didnt understand wrong it would help to you</p>\n"}], "owner": {"reputation": 39, "user_id": 6464391, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-a8Ng2kb69hk/AAAAAAAAAAI/AAAAAAAAAAo/shXdHvC1qUM/photo.jpg?sz=128", "display_name": "sahbi.m", "link": "https://stackoverflow.com/users/6464391/sahbi-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1154, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1500163181, "creation_date": 1496219956, "last_edit_date": 1496235638, "question_id": 44279759, "link": "https://stackoverflow.com/questions/44279759/how-to-build-external-kernel-module-without-kernel-source-tree", "title": "how to Build external kernel module without kernel source tree", "body": "<p>I have a 3rd party SW package that compile both kernel modules and user space applications. Unfortunately, this 3rd party is very complex, and doesn't use Kbuild for building kernel modules (I tried without success).</p>\n\n<p>I tried to build a simple driver with the lines below:</p>\n\n<pre><code>    arm-linux-gnueabihf-gcc  -D__KERNEL__ -Wall -include /lib/modules/4.4.62-18.6-default/build/include/generated/autoconf.h -MD -MP   -Werror -O2 -I /usr/src/linux-4.4.62-18.6/include -I /src/include -DMODULE -c -o hello_dkm.o hello_dkm.c  \n    $(LD) -o $(debug_target) $(LD_COMMON_FLAGS) -g $(debug_Objs)\n</code></pre>\n\n<p>I have got:</p>\n\n<pre><code>fatal error: /usr/src/linux-4.4.62-18.6/include/linux/thread_info.h:54:29: fatal error: asm/thread_info.h: No such file or directory\n</code></pre>\n\n<hr>\n\n<p>Appendix</p>\n\n<ul>\n<li>plateform: Altera Cyclone V SoC, ARM cortex A9 dual core</li>\n<li>Kernel: linux Altera 3.7.0</li>\n<li>host: Linux openSuse 42</li>\n</ul>\n\n<p>PS: In my team's project plateform it is hard to use the classic compiling line using the kernel source tree:\n    <code>$(MAKE) -C $(KDIR) SUBDIRS=$(PWD) modules</code></p>\n\n<p>Thanks in advance,</p>\n"}, {"tags": ["c", "sockets", "raspberry-pi", "ethernet"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1496220628, "post_id": 44279616, "comment_id": 75566833, "body": "&quot;Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam. Instead, describe the problem and what has been done so far to solve it.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 8091017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vUqGd.jpg?s=128&g=1", "display_name": "Guirish Salgaonkar", "link": "https://stackoverflow.com/users/8091017/guirish-salgaonkar"}, "is_accepted": false, "score": 1, "last_activity_date": 1496224959, "creation_date": 1496224959, "answer_id": 44281690, "question_id": 44279616, "link": "https://stackoverflow.com/questions/44279616/read-values-from-spi-gpio-bus-and-send-values-over-ethernet/44281690#44281690", "title": "Read values from SPI (GPIO bus) and send values over ethernet", "body": "<p>You can refer below mentioned link to establish a client/server connection using sockets with RPi with C implementation. Hope it helps you.</p>\n\n<p><a href=\"http://cs.smith.edu/dftwiki/index.php/Tutorial:_Client/Server_on_the_Raspberry_Pi\" rel=\"nofollow noreferrer\">http://cs.smith.edu/dftwiki/index.php/Tutorial:_Client/Server_on_the_Raspberry_Pi</a></p>\n"}], "owner": {"reputation": 457, "user_id": 4939357, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8ddd497e5a10f46bb05f371d0d217a10?s=128&d=identicon&r=PG&f=1", "display_name": "Ferguson", "link": "https://stackoverflow.com/users/4939357/ferguson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1496224959, "creation_date": 1496219590, "question_id": 44279616, "link": "https://stackoverflow.com/questions/44279616/read-values-from-spi-gpio-bus-and-send-values-over-ethernet", "title": "Read values from SPI (GPIO bus) and send values over ethernet", "body": "<p>I'm new to C and for a homework exam I must implement a simple server socket program which sends some data in a loop and if the client is connected to the server socket(have done it with Arduino but need the same functionallity on raspberrypi or other sbc). </p>\n\n<p>For example (arduino style):</p>\n\n<pre><code>EthernetServer server = EthernetServer(23);\n// start listening for clients\nserver.begin();\nint i = 0;\nwhile(true){\n  i++;\n\n  EthernetClient client = server.available();\n  if (client) {\n     while (client.connected()) {\n     if (client.available()) {\n      client.print(i);\n     }\n    }\n   }\n   client.stop;\n} \n</code></pre>\n\n<p>I have a SBC (single board computer) with GPIO buss. My program must:</p>\n\n<ul>\n<li>read values from SPI bus (infinite loop)</li>\n<li>if the client is connected to the server scoket It must send some values to the client. </li>\n</ul>\n\n<p>I know how to implement this kind of app in Java but in C, I don't have enaugh knowledge. \nI'am looking for some kind of library or example on how to implement it.</p>\n\n<p>regards</p>\n"}, {"tags": ["c", "hex", "ascii"], "comments": [{"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496217616, "post_id": 44278908, "comment_id": 75564892, "body": "<code>printf</code>is a <i>printing</i> function, I don&#39;t see why you&#39;d use it to make a conversion ? And if you want to return a <code>char</code>and not a <code>string</code>, the <code>decimalNumber</code>parameter shall be <code>&lt; 16</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1496217617, "post_id": 44278908, "comment_id": 75564894, "body": "Isn&#39;t the function supposed to <i>return</i> something?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7171623"}, "edited": false, "score": 0, "creation_date": 1496218664, "post_id": 44278908, "comment_id": 75565534, "body": "Its better to use <code>&#39;A&#39;</code> and <code>&#39;0&#39;</code> instead of 65 and 48 as these characters now become independent of the character sets."}], "answers": [{"comments": [{"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496218206, "post_id": 44279105, "comment_id": 75565247, "body": "I would declare an <code>enum</code>or at least const variables to avoid <code>48</code>and <code>55</code> magical numbers. Not obvious I think to understand the conversion to ASCII"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7012028"}, "edited": false, "score": 0, "creation_date": 1496222759, "post_id": 44279105, "comment_id": 75568354, "body": "&quot;char *decimalToHexadecimal(long int decimalNumber)&quot; what is going on here actually? Why function as pointer?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1496224068, "post_id": 44279105, "comment_id": 75569342, "body": "This prints <code>4321</code> since digits are extracted from the least-significant end, but the string is built left-to-right. Fail, in my opinion."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1496224826, "post_id": 44279105, "comment_id": 75569904, "body": "@unwind, correct, I mentioned this in the answer: <i>The function is still not quite what you want. I leave it as an exercise to correct it.</i>"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1496221763, "last_edit_date": 1496221763, "creation_date": 1496218066, "answer_id": 44279105, "question_id": 44278908, "link": "https://stackoverflow.com/questions/44278908/user-defined-function-without-printf-returns-hexadecimal-value/44279105#44279105", "title": "User-defined function without printf, returns hexadecimal value", "body": "<p>Read the chapter about strings in your C textbook.</p>\n\n<p>One solution is to return a <em>pointer</em> to char:</p>\n\n<pre><code>char *decimalToHexadecimal(long int decimalNumber)\n{\n  long int quotient;\n  long int remainder;\n  static char hexDecNum[100];  // must be static\n\n  quotient = decimalNumber;\n  int i = 0;  //               //   &lt;&lt;&lt;&lt; you forgot to declare i\n  while (quotient != 0)\n  {\n    remainder = quotient % 16;\n\n    // to convert integer into character\n    if (remainder &lt; 10)\n    {\n      remainder = remainder + 48;\n    }\n    else\n    {\n      remainder = remainder + 55;\n    }\n    hexDecNum[i++] = remainder;\n    quotient = quotient / 16;\n  }\n  hexDecNum[i] = 0;            //    &lt;&lt;&lt; you forgot the NUL string terminator\n  return hexDecNum;            //    &lt;&lt;&lt; you forgot to return something\n}\n\nint main() \n{\n  printf(\"%s\\n\", decimalToHexadecimal(0x1234));\n}\n</code></pre>\n\n<p>The <code>hexDecNum</code> buffer must be static, because you are returning a <em>pointer</em> to this buffer, and this buffer will cease to exist once you have returned from the <code>decimalToHexadecimal</code> function, because it's a local variable. Modern compilers will usually emit a warning if you return the address of a local variable.</p>\n\n<p>The function is still not quite what you want. I leave it as an exercise to correct it.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Another approach for conversion is this: the decimal number is actually represented as a binary number (as all numbers BTW), so we don't even need division; we just can decompose the number into 4 bit nibbles (0000 to 1111) and transform these nibbles into a hexadecimal digits (0..9, A..F):</p>\n\n<pre><code>char *decimalToHexadecimal(long int decimalNumber)\n{\n  static char hexDecNum[100];\n  int i;   \n  for (i = 0; i &lt; sizeof(decimalNumber) * 2; i++)\n  {\n    int digit = decimalNumber &amp; 0xf;\n\n    if (digit &gt;= 10)\n      digit += 'A' - 10;  // better than writing 55\n    else\n      digit += '0';       // better than writing 48\n\n    hexDecNum[i] = digit;    \n    decimalNumber &gt;&gt;= 4;\n  }\n\n  hexDecNum[i] = 0;\n  return hexDecNum;\n}\n</code></pre>\n\n<p>The function suffers from the same problem as your original function. Improving it is left as an exercise.</p>\n"}, {"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1496225289, "post_id": 44281220, "comment_id": 75570262, "body": "Certainly a very elegant solution, but maybe a bit beyond of the scope of the OP. Just upvoted."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 2, "last_activity_date": 1496223702, "creation_date": 1496223702, "answer_id": 44281220, "question_id": 44278908, "link": "https://stackoverflow.com/questions/44278908/user-defined-function-without-printf-returns-hexadecimal-value/44281220#44281220", "title": "User-defined function without printf, returns hexadecimal value", "body": "<p>It's better to use an explicit string of the desired character set, that way you can remove any assumptions about the encoding, which is very good for portability.</p>\n\n<p>Although C requires that the digits 0 through 9 are encoded using adjacent code points (i.e. <code>'1'</code> - <code>'0'</code> must equal <code>1</code>, and so on), no such guarantee is made for the letters.</p>\n\n<p>Also, returning a string requires heap allocation, a static buffer (which makes the function harder to use), or simply accepting the string from the caller which is often the best choice.</p>\n\n<p>It's important to realize that the typical technique of extracting the remainder from division by 16 (or just masking out the four right-most bits) generates bits \"from the right\", whereas typical string-building runs from the left. This has to be taken into account as well, or you'd generate <code>\"d00f\"</code> when given <code>0xf00d</code>.</p>\n\n<p>Here's how it could look:</p>\n\n<pre><code>char * num2hex(char *buf, size_t buf_max, unsigned long number)\n{\n   if(buf_max &lt; 2)\n     return NULL;\n   char * put = buf + buf_max; // Work backwards.\n   *--put = '\\0';  // Terminate the resulting string.\n   do\n   {\n     if(put == buf)\n       return NULL;\n     const unsigned int digit = number &amp; 15;\n     *--put = \"0123456789abcdef\"[digit];\n     number &gt;&gt;= 4;\n   } while(number != 0);\n   return put;\n}\n</code></pre>\n\n<p>This function returns the start of the built string (which is \"right-aligned\" in the provided buffer, so it's not at the start of it), or <code>NULL</code> if it runs out of space.</p>\n\n<p>Note: yeah, this is perhaps a bit too terse, of course the digit set could be extracted out and given a name, but it's also pretty obvious what its purpose is, and indexing a literal is handy (some people don't seem to realize it's doable) and somewhat instructive to show off.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7012028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1248, "favorite_count": 0, "accepted_answer_id": 44279105, "answer_count": 2, "score": 0, "last_activity_date": 1496223702, "creation_date": 1496217480, "last_edit_date": 1496218929, "question_id": 44278908, "link": "https://stackoverflow.com/questions/44278908/user-defined-function-without-printf-returns-hexadecimal-value", "title": "User-defined function without printf, returns hexadecimal value", "body": "<pre><code>char decimalToHexadecimal(long int decimalNumber)\n{\n    long int quotient;\n    long int remainder;\n    static char hexDecNum[100];\n    int i=0;\n\n    quotient = decimalNumber;\n\n    while (quotient != 0)\n    {\n\n        remainder = quotient % 16;\n\n        // to convert integer into character\n        if (remainder &lt; 10)\n        {\n            remainder = remainder + 48;\n        }\n        else\n        {\n            remainder = remainder + 55;\n        }\n        hexDecNum[i++] = remainder;\n        quotient = quotient / 16;\n    }\n}\n</code></pre>\n\n<p>This user defined function will convert decimal number to hexadecimal number.\nI wanted to make function that will not use any library function like printf,scanf etc. I and to get return hexadecimal value of a decimal number from this function.\nBut, I am confused how to get return hexadecimal number from this function? </p>\n"}, {"tags": ["c", "file-io"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496217261, "post_id": 44278814, "comment_id": 75564635, "body": "Pleased don&#39;t spam with unrelated language tags. If you&#39;re programming in C then don&#39;t add C++."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1496217304, "post_id": 44278814, "comment_id": 75564670, "body": "As for your problem, after the <code>fgets</code> loop, where is the file-pointer positioned? I suggest you read about the <a href=\"http://en.cppreference.com/w/c/io/rewind\" rel=\"nofollow noreferrer\"><code>rewind</code></a> function."}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1496217344, "post_id": 44278814, "comment_id": 75564699, "body": "You need to reset the internal file position to reread the lines so as to count them. In C, you may be interested in the fseek function. Look it up"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1496217348, "post_id": 44278814, "comment_id": 75564703, "body": "You must <a href=\"https://linux.die.net/man/3/rewind\" rel=\"nofollow noreferrer\">rewind or fseek</a> the file at the start between two loops."}, {"owner": {"reputation": 1, "user_id": 7730809, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155278997481320/picture?type=large", "display_name": "RAWRheart", "link": "https://stackoverflow.com/users/7730809/rawrheart"}, "edited": false, "score": 0, "creation_date": 1496217383, "post_id": 44278814, "comment_id": 75564722, "body": "I&#39;m not entirely sure what is meant by the, sorry first semester doing this."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1496217403, "post_id": 44278814, "comment_id": 75564741, "body": "Actually, if you&#39;re just counting lines, why can&#39;t you do it in the same loop where you do <code>fgets</code>? You <i>do</i> know that <code>fgets</code> reads a <i>line</i>?"}, {"owner": {"reputation": 1, "user_id": 7730809, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155278997481320/picture?type=large", "display_name": "RAWRheart", "link": "https://stackoverflow.com/users/7730809/rawrheart"}, "edited": false, "score": 0, "creation_date": 1496217733, "post_id": 44278814, "comment_id": 75564955, "body": "Thanks so much, used the rewind function and everything is working fine now, though curious how the code fragment would have to look to include the line count int the same loop as the print lines"}, {"owner": {"reputation": 1, "user_id": 7730809, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155278997481320/picture?type=large", "display_name": "RAWRheart", "link": "https://stackoverflow.com/users/7730809/rawrheart"}, "edited": false, "score": 0, "creation_date": 1496217759, "post_id": 44278814, "comment_id": 75564976, "body": "also literally second question posted so dont know how to mark top answers or anything :S"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1496217997, "post_id": 44278814, "comment_id": 75565115, "body": "Look for checkmark to the left of the answer, you can click it"}], "answers": [{"tags": [], "owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 1, "last_activity_date": 1496219705, "last_edit_date": 1496219705, "creation_date": 1496219365, "answer_id": 44279535, "question_id": 44278814, "link": "https://stackoverflow.com/questions/44278814/why-is-the-number-of-lines-showing-as-0-when-i-also-print-the-lines-out-but-work/44279535#44279535", "title": "Why is the number of lines showing as 0 when I also print the lines out but works fine when its just the line count", "body": "<p>Here is a quick overview of how working with files is done in most programming languages:</p>\n\n<p>When you <em>open</em> a file in a program you obtain a <strong>handle</strong> to that file. What the handle representation is depends on the language. In <code>c</code> it is the <code>FILE</code> structure. The handle contains - among other things - a <strong>file position indicator</strong>. Every read and write to that file through this handle happens at that position. Usually a read/write operation advances this file position indicator. Think about it: how do consecutive reads <em>know</em> to each read where the previous one left? You don't provide an argument to the read function telling it where to read from. You just \"say\" <code>read</code>. What happens is that each <code>read</code> call reads at the file position indicator and then advances this indicator, thus when the next <code>read</code> happens the handle has an updated file position indicator.</p>\n\n<p>So the solution to your problem is - as mentioned in the comments - to <em>put</em> this position indicator to the beginning of the file. In <code>c</code> this can be done with <a href=\"http://en.cppreference.com/w/c/io/rewind\" rel=\"nofollow noreferrer\">rewind</a>.</p>\n\n<hr>\n\n<blockquote>\n  <p>curious how the code fragment would have to look to include the line\n  count int the same loop as the print lines</p>\n</blockquote>\n\n<p>Simple. Pseudocode:</p>\n\n<pre><code>line_count = 0\nwhile (read line successful)\n{\n    print line\n    increment line_count\n}\n\nprint line_count\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7730809, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155278997481320/picture?type=large", "display_name": "RAWRheart", "link": "https://stackoverflow.com/users/7730809/rawrheart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496219705, "creation_date": 1496217143, "last_edit_date": 1496219659, "question_id": 44278814, "link": "https://stackoverflow.com/questions/44278814/why-is-the-number-of-lines-showing-as-0-when-i-also-print-the-lines-out-but-work", "title": "Why is the number of lines showing as 0 when I also print the lines out but works fine when its just the line count", "body": "<p>So both the code to print the lines from the txt file and the code to count the lines in the txt file work fine when the other is commented out but when i try to have both work only the code that comes first works e.g. if i put the code to print out the lines first, the line count is always zero. However if i put the code to count the lines first, the number is correct but the lines from the txt file are not printed :S</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char const *argv[])\n{\n    const int SIZE = 128;\n    char line[SIZE];\n    FILE *srcFile;\n    int c;\n    int count = 0;  // Line counter (result)\n\n    if (argc == 1)\n    {\n        printf(\"No command line arguments given!\\n\");\n        return 1;\n    }\n\n    srcFile = fopen(argv[1], \"r\");\n\n    if (srcFile == NULL)\n    {\n        perror(\"\\n*** FILE OPEN FAILED ***\");\n    }\n    else\n    {   \n        printf(\"\\n*** FILE OPEN SUCCESSFUL ***\\n\\n\"); \n    }\n\n    while(fgets(line, SIZE, srcFile) != NULL)\n    {\n        printf(\"%s\", line);\n    }\n\n    for (c = fgetc(srcFile); c != EOF; c = fgetc(srcFile))\n    {\n        if (c == '\\n')\n        {\n            count ++;\n        }\n    }\n\n    if(c != '\\n' &amp;&amp; count != 0) \n    {   \n        count ++;\n    }\n\n    printf(\"The file %s has %d lines\\n \", argv[1], count);\n\n    fclose(srcFile);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "variables"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1496215403, "post_id": 44278219, "comment_id": 75563478, "body": "Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1496215422, "post_id": 44278219, "comment_id": 75563489, "body": "gets() is non-standard, use <code>fgets()</code>."}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1496215876, "post_id": 44278219, "comment_id": 75563777, "body": "Is <code>is_linux</code> global / static variable or automatic? For test add <code>static</code> in the definition."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496215933, "post_id": 44278219, "comment_id": 75563824, "body": "Note that <code>sscanf(&quot;str, &quot;%d&quot;, &amp;is_linux)</code> is incorrect.  An <code>unsigned long</code> should be read using <code>%lu</code> or a related conversion specification with the <code>l</code> length modifier specified.  On a 64-bit (non-Windows) machine, the chances are that your scan sets only 4 bytes of an 8-byte integer; the other 4 bytes are probably not zero, so your tests fail.  Why don&#39;t you print <code>is_linux</code> \u2014 carefully: <code>printf(&quot;is_linux = %lu\\n&quot;, is_linux);</code>?"}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1496215973, "post_id": 44278219, "comment_id": 75563845, "body": "It is better to use <code>strtol</code> instead of <code>sscanf</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496216486, "post_id": 44278219, "comment_id": 75564166, "body": "Are you working on a Windows machine, or a 64-bit Unix-like machine, or a 32-bit Unix-like machine?  It matters.  Your code is dubious because it is using the wrong conversion specification, but if <code>sizeof(int) == sizeof(long)</code> \u2014 as it does on most 32-bit systems and Windows 64, but not on 64-bit Unix-like systems \u2014 then you might get away with it.  From the results you&#39;re seeing, you&#39;re probably working on a 64-bit Unix-like machine with a 64-bit compilation mode."}], "answers": [{"comments": [{"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1496215623, "post_id": 44278285, "comment_id": 75563619, "body": "In many cases <code>unsigned long</code> has the same size like <code>unsigned int</code>. Maybe the reason is different."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 1, "creation_date": 1496215709, "post_id": 44278285, "comment_id": 75563677, "body": "@i486 It&#39;s also a signedness problem, despite having same size."}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1496215816, "post_id": 44278285, "comment_id": 75563737, "body": "In the question the value is <code>1</code> and sign does not affect."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1496216089, "post_id": 44278285, "comment_id": 75563924, "body": "@i486 does the problem go away if you use <code>%lu</code>?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 3, "creation_date": 1496219870, "post_id": 44278285, "comment_id": 75566302, "body": "I find it way too amusing that someone called i486 would say that <code>unsigned long</code> has the same size as <code>unsigned int</code>."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 5, "last_activity_date": 1496215494, "creation_date": 1496215494, "answer_id": 44278285, "question_id": 44278219, "link": "https://stackoverflow.com/questions/44278219/does-is-linux-variable-have-special-meaning/44278285#44278285", "title": "Does &quot;is_linux&quot; variable have special meaning?", "body": "<p>In your code</p>\n\n<pre><code>  sscanf(str,\"%d\",&amp;is_linux);\n</code></pre>\n\n<p>causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">undefined behavior</a>.</p>\n\n<p><code>is_linux</code> is of type <code>unsigned long</code>, it demands the conversion specifier to be <code>lu</code>.</p>\n\n<p>Passing wrong (mismatched) type of argument to any conversion specifier  causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">undefined behavior</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1496216282, "creation_date": 1496216282, "answer_id": 44278540, "question_id": 44278219, "link": "https://stackoverflow.com/questions/44278219/does-is-linux-variable-have-special-meaning/44278540#44278540", "title": "Does &quot;is_linux&quot; variable have special meaning?", "body": "<p>No. You should be able to use the variable name.  <code>is_linux</code> is not reserved and it's not a keyword. Worst-case scenario, it could (but shouldn't) be a macro (<code>linux</code> commonly is, unfortunately). Preemptively, or if you get compilation errors because it is a macro on your platform, you could <code>#undef</code> it first. \n(Make sure the rest of your code is correct.)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7498488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3760da8cc9caa5c46ca487964a8431a4?s=128&d=identicon&r=PG&f=1", "display_name": "nuji", "link": "https://stackoverflow.com/users/7498488/nuji"}, "is_accepted": false, "score": 0, "last_activity_date": 1496279039, "creation_date": 1496279039, "answer_id": 44296904, "question_id": 44278219, "link": "https://stackoverflow.com/questions/44278219/does-is-linux-variable-have-special-meaning/44296904#44296904", "title": "Does &quot;is_linux&quot; variable have special meaning?", "body": "<p>The datatype you are assigning to is_linux is not compatible. You set it as a long, but giving it an int so when you check with your if statement you are checking for a long value, not int.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8090286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c91e233880831d812b928813e106910?s=128&d=identicon&r=PG&f=1", "display_name": "russel", "link": "https://stackoverflow.com/users/8090286/russel"}, "is_accepted": false, "score": 0, "last_activity_date": 1496282914, "creation_date": 1496282914, "answer_id": 44297390, "question_id": 44278219, "link": "https://stackoverflow.com/questions/44278219/does-is-linux-variable-have-special-meaning/44297390#44297390", "title": "Does &quot;is_linux&quot; variable have special meaning?", "body": "<p>Thank you so much, there.\nAll comments were very helpful to me for finding root cause.\nActually, it was very simple reason, data type.\nSimply, I changed %d to %lu in both of sscanf and printf and got correct answer.</p>\n\n<p>My machine was 64bit lunux system and it treated unsigned long as 8-byte unit.\nAnd also, I misunderstood %d could cover all the integer data types.\nAnyway, I'm very appreciate all you guy's comments. Thank you :)</p>\n"}], "owner": {"reputation": 13, "user_id": 8090286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c91e233880831d812b928813e106910?s=128&d=identicon&r=PG&f=1", "display_name": "russel", "link": "https://stackoverflow.com/users/8090286/russel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 44278285, "answer_count": 4, "score": 0, "last_activity_date": 1496282914, "creation_date": 1496215322, "last_edit_date": 1496215771, "question_id": 44278219, "link": "https://stackoverflow.com/questions/44278219/does-is-linux-variable-have-special-meaning", "title": "Does &quot;is_linux&quot; variable have special meaning?", "body": "<p>I don't understand why the result of the <code>if</code> statement below is always incorrect:</p>\n\n<pre><code>unsigned long is_linux;\nprintf(\"plz. enter a digit : \");\n\ngets(str);\nsscanf(str,\"%d\",&amp;is_linux);\n\nprintf(\"the value of is_linux = %d \\n\",is_linux);\nif(is_linux==1)\n    printf(\"Here is 1 ! \\n\");\nelse\n    printf(\"There is 0 ! \\n\");\n</code></pre>\n\n<p>I can only get \"There is 0 !\" statement, even if I entered \"1\". Furthermore, <code>printf()</code> statement displays the value of <code>is_linux</code> (1) correctly:</p>\n\n<blockquote>\n<pre><code>plz. enter a digit : 1\nthe value of is_linux = 1 \nThere is 0 !\n</code></pre>\n</blockquote>\n\n<p>It works well if I change the variable to another name, for instance,<code>test</code>. Is there any reason for not using <code>is_linux</code> variable ? I've compiled above source code using <code>gcc</code> at <code>x86_64-redhat-linux</code>.</p>\n"}, {"tags": ["c", "mqtt", "iot", "libmosquitto"], "comments": [{"owner": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1496222727, "post_id": 44277880, "comment_id": 75568320, "body": "of course the other question here is why you can&#39;t just bridge the 2 brokers, instead of using a client in the middle?"}, {"owner": {"reputation": 39, "user_id": 6463265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0317d344f145a39f7f0ea1350cee7096?s=128&d=identicon&r=PG&f=1", "display_name": "pzydziak", "link": "https://stackoverflow.com/users/6463265/pzydziak"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1496222963, "post_id": 44277880, "comment_id": 75568510, "body": "I have to modify content of messages to publish based on messages from first one broker."}], "answers": [{"tags": [], "owner": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "is_accepted": false, "score": 1, "last_activity_date": 1496216825, "creation_date": 1496216825, "answer_id": 44278715, "question_id": 44277880, "link": "https://stackoverflow.com/questions/44277880/mosquitto-subscribe-to-one-broker-and-push-to-another-using-c/44278715#44278715", "title": "Mosquitto - subscribe to one broker and push to another using C", "body": "<p>Yes,</p>\n\n<p>You need two totally separate instances of client. Which means two separate instances the <code>mosquitto</code> structure returned by the <code>mosquitto_new()</code> function. One for each broker.</p>\n\n<p>At the moment you are re-using the same structure so it is only holding the details of the last call to <code>mosquitto_connect()</code></p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 6463265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0317d344f145a39f7f0ea1350cee7096?s=128&d=identicon&r=PG&f=1", "display_name": "pzydziak", "link": "https://stackoverflow.com/users/6463265/pzydziak"}, "edited": false, "score": 0, "creation_date": 1496221957, "post_id": 44279585, "comment_id": 75567753, "body": "Thanks, I already managed that problem, but thanks to your answer I know  how to use third mosquitto_new arg."}], "tags": [], "owner": {"reputation": 9633, "user_id": 429431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ee7eb6c9044a977de255270ea1125c?s=128&d=identicon&r=PG", "display_name": "ralight", "link": "https://stackoverflow.com/users/429431/ralight"}, "is_accepted": true, "score": 2, "last_activity_date": 1496219511, "creation_date": 1496219511, "answer_id": 44279585, "question_id": 44277880, "link": "https://stackoverflow.com/questions/44277880/mosquitto-subscribe-to-one-broker-and-push-to-another-using-c/44279585#44279585", "title": "Mosquitto - subscribe to one broker and push to another using C", "body": "<p>Something like this should do the job (I've not tested it though). You'll have to add error checking.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;mosquitto.h&gt;\n\n\nvoid on_connect1(struct mosquitto *mosq, void *obj, int result)\n{\n    int rc = MOSQ_ERR_SUCCESS;\n\n    if(!result){\n        mosquitto_subscribe(mosq, NULL, \"/v1/topic1\", 0);\n    }else{\n        fprintf(stderr, \"%s\\n\", mosquitto_connack_string(result));\n    }\n}\n\nvoid on_message1(struct mosquitto *mosq, void *obj, const struct mosquitto_message *message)\n{\n    struct mosquitto *mosq2 = (struct mosquitto *)obj;\n\n    mosquitto_publish(mosq, NULL, \"/v1/topic2\", message-&gt;payloadlen, message-&gt;payload, message-&gt;qos, message-&gt;retain);\n}\n\nint main(int argc, char *argv[])\n{\n    struct mosquitto *mosq1, *mosq2;\n\n    mosquitto_lib_init();\n\n    mosq2 = mosquitto_new(NULL, true, NULL);\n    mosq1 = mosquitto_new(NULL, true, mosq2);\n\n    mosquitto_connect_callback_set(mosq1, on_connect1);\n    mosquitto_message_callback_set(mosq1, on_message1);\n\n    mosquitto_connect(mosq2, \"mqtt.example.io\", 1883, 60);\n    mosquitto_connect(mosq1, \"localhost\", 1883, 60);\n\n    mosquitto_loop_start(mosq2);\n    mosquitto_loop_forever(mosq1, -1, 1);\n\n    mosquitto_destroy(mosq1);\n    mosquitto_destroy(mosq2);\n\n    mosquitto_lib_cleanup();\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1589897332, "post_id": 61890867, "comment_id": 109471214, "body": "You missed the requirement to modify the message on the way through the middle (in the comments under the question)"}, {"owner": {"reputation": 1, "user_id": 5127804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5697f26e5d2a2f293e44019c263ff35a?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5127804/dev"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1589917893, "post_id": 61890867, "comment_id": 109482744, "body": "Yes, it is just a pass through. The publish can be done to a different server. You can also change the message after the read."}], "tags": [], "owner": {"reputation": 1, "user_id": 5127804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5697f26e5d2a2f293e44019c263ff35a?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5127804/dev"}, "is_accepted": false, "score": 0, "last_activity_date": 1589893475, "last_edit_date": 1589893475, "creation_date": 1589890626, "answer_id": 61890867, "question_id": 44277880, "link": "https://stackoverflow.com/questions/44277880/mosquitto-subscribe-to-one-broker-and-push-to-another-using-c/61890867#61890867", "title": "Mosquitto - subscribe to one broker and push to another using C", "body": "<p>This command line using mosquitto can do the job:</p>\n\n<pre><code>mosquitto_sub -h localhost -t '#'  | {  while [ 1 -lt 2 ] ;   do   read message ;   if [[ \"$message\" != \"$prev_message\" ]]; then  mosquitto_pub -h localhost -t \"tenewtest\" -m \"$message\" ; prev_message=$message ; fi ;    done ;  }\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6463265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0317d344f145a39f7f0ea1350cee7096?s=128&d=identicon&r=PG&f=1", "display_name": "pzydziak", "link": "https://stackoverflow.com/users/6463265/pzydziak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3839, "favorite_count": 0, "accepted_answer_id": 44279585, "answer_count": 3, "score": 1, "last_activity_date": 1589893475, "creation_date": 1496214294, "last_edit_date": 1496215572, "question_id": 44277880, "link": "https://stackoverflow.com/questions/44277880/mosquitto-subscribe-to-one-broker-and-push-to-another-using-c", "title": "Mosquitto - subscribe to one broker and push to another using C", "body": "<p>Is it possible and if so how to archive it that one application using libmosquitto get messages from one broker and publish it to another?</p>\n\n<p><img src=\"https://i.stack.imgur.com/9Wl1N.png\" alt=\"Schematics\"></p>\n\n<p>Its pretty simple to just change topic in mosquito_publish function, but set of broker takes place in </p>\n\n<pre><code>mosquitto_connect(mosq, \"localhost\",1883 , 60); \n</code></pre>\n\n<p>Running mosquitto_connet second time\ne.g.</p>\n\n<pre><code> mosquitto_connect(mosq, \"mqtt.example.io\",1883 , 60); \n</code></pre>\n\n<p>ends up connecting to last one.</p>\n\n<p>I tried to create two mosquitto structs but I dont know how to inform second one about message form subbed channel in order to get info from it, change it and push to proper broker. </p>\n"}, {"tags": ["c", "ubuntu", "floating-point", "64-bit", "ieee-754"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1496213998, "post_id": 44277743, "comment_id": 75562553, "body": "&quot;What are you <i>doing</i> wrong?&quot; \u2014 nothing.  It&#39;s your expectations that seem to be askew.  You initialized the <code>float</code> array to a series of integer values, and you see those values printed, and seem to be surprised by this result.  What result are you after?  (Also, you should provide an actual MCVE \u2014 <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> \u2014 to ensure you show the real code.)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 4, "creation_date": 1496214039, "post_id": 44277743, "comment_id": 75562578, "body": "<code>printf(&quot;u[%d] = %f\\n&quot;, u_ptr[i]);</code> Undefined behavior here?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1496214086, "post_id": 44277743, "comment_id": 75562607, "body": "Just for anyone else wondering the first hex integer in decimal is 1066736946"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1496214109, "post_id": 44277743, "comment_id": 75562625, "body": "<code>printf(&quot;u[%d] = %f\\n&quot; u_ptr[i]);</code> ---&gt; <code>printf(&quot;u[%d] = %f\\n&quot;, i, u_ptr[i]);</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496214327, "post_id": 44277743, "comment_id": 75562755, "body": "The second code contains a cast (which could be omitted without changing the result) that converts the integer value to the corresponding <code>float</code>.  If you&#39;re looking to copy the bits from the integer to the <code>float</code>, you need to handle that differently \u2014 it gets messy around there, because you aren&#39;t encouraged to do it.  You could try a union: <code>union { float f; uint32_t u; } v;</code> and then assign the integer to <code>v.u</code> and print <code>v.f</code>, but that&#39;s technically undefined behaviour."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1496214361, "post_id": 44277743, "comment_id": 75562771, "body": "Float might not have the &quot;precision&quot; or &quot;range&quot; to show integer values in that range. Check the sizes. For example a 32bit float has no way of storing a 32bit integer, with bits in the highest byte and lowest byte set."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1496214390, "post_id": 44277743, "comment_id": 75562792, "body": "You are misunderstanding what your init really does: it is assigning integers to float, not directly its hex float representation."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496214502, "post_id": 44277743, "comment_id": 75562884, "body": "If you want hexadecimal floating point values, then I suggest you read e.g. <a href=\"http://en.cppreference.com/w/c/language/floating_constant\" rel=\"nofollow noreferrer\">this floating point constant reference</a>."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496214562, "post_id": 44277743, "comment_id": 75562925, "body": "@JonathanLeffler is using Unions to cast bits really UB? I thought that was the standard way for type punning?"}, {"owner": {"reputation": 809, "user_id": 1163200, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/76b64a8c9aab74ab2322a84905e29e3c?s=128&d=identicon&r=PG", "display_name": "Raj", "link": "https://stackoverflow.com/users/1163200/raj"}, "edited": false, "score": 0, "creation_date": 1496214568, "post_id": 44277743, "comment_id": 75562929, "body": "Shouldn&#39;t the hexadecimals be interpreted as a IEEE 754 formatted number especially given the fact that my desired data type is a float?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496214660, "post_id": 44277743, "comment_id": 75562985, "body": "No; the hexadecimals will not be interpreted as an IEEE 754 formatted number.  You&#39;d have to use the hexadecimal floating point format suggested by others."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1496214711, "post_id": 44277743, "comment_id": 75563023, "body": "@AjayBrahmakshatriya: Yes, it is undefined behaviour, but yes, it is also the way it is generally done.  I&#39;m not going to quote the standard, but the information is there in the standard."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1496214762, "post_id": 44277743, "comment_id": 75563067, "body": "@Raj Please <a href=\"https://stackoverflow.com/posts/44277743/edit\">edit</a> your question and <b>give an example of value you are expecting</b>. I am guessing you want to reinterpret bits of unsigned type as float type without numeric conversion, but it&#39;s impossible to know unless you clarify."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496214849, "post_id": 44277743, "comment_id": 75563124, "body": "@JonathanLeffler Are you thinking of C++ or C89? Union type punning was allowed in C99."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1496215600, "post_id": 44277743, "comment_id": 75563607, "body": "In C11, footnote 95 in &#167;6.7.2.1 <b>Structure and union specifiers</b> says: <i>If the member used to read the contents of a union object is not the same as the member last used to store a value in the object, the appropriate part of the object representation of the value is reinterpreted as an object representation in the new type as described in 6.2.6 (a process sometimes called \u2018\u2018type punning\u2019\u2019). This might be a trap representation.</i> You&#39;re right, @user694733, that C11 (and presumably C99; I&#39;ve not checked) makes it legal but a little precarious. It&#39;s iffy, but you&#39;ll usually get away with it."}], "answers": [{"comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1496216495, "post_id": 44278145, "comment_id": 75564170, "body": "@NilsPipenbrinck ...and where do you ensure <code>sizeof(float == sizeof(uint32_t)</code>.....;)"}, {"owner": {"reputation": 76939, "user_id": 15955, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e95618da1c880d3f324319567ca52591?s=128&d=identicon&r=PG", "display_name": "Nils Pipenbrinck", "link": "https://stackoverflow.com/users/15955/nils-pipenbrinck"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1496218874, "post_id": 44278145, "comment_id": 75565686, "body": "@LPs float is defined as 32 bit in the IEEE 754 floating-point standard."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1496219032, "post_id": 44278145, "comment_id": 75565775, "body": "The standard does not say anything about float and double size. ;)"}], "tags": [], "owner": {"reputation": 76939, "user_id": 15955, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e95618da1c880d3f324319567ca52591?s=128&d=identicon&r=PG", "display_name": "Nils Pipenbrinck", "link": "https://stackoverflow.com/users/15955/nils-pipenbrinck"}, "is_accepted": true, "score": 4, "last_activity_date": 1496215763, "last_edit_date": 1496215763, "creation_date": 1496215074, "answer_id": 44278145, "question_id": 44277743, "link": "https://stackoverflow.com/questions/44277743/incorrect-single-precision-floating-point-representation-on-ubuntu-64-bit/44278145#44278145", "title": "Incorrect single precision floating point representation on ubuntu 64 bit", "body": "<p>The problem is, that you initialize your array with large integer values, not the hex representation of the floats. With your hex constants starting with values around 0x3f it's pretty clear that these are floating point data with values around 1.0. </p>\n\n<p>As far as I know there is no direct way to initialize a float array with hex constants (if there is one, community, please tell me!). </p>\n\n<p>So you have to define your data-array as int and convert it to float as you use it. <strong>IMPORTANT:</strong> Directly casting the pointer from int to float will break the aliasing rule of C and may result in code that looks correct but misbehaves. </p>\n\n<p>Converting between the two data-types via memcpy is safe though and the compiler is usually smart enough to spot this and optimize it out.</p>\n\n<p>So this solution here does what you want: </p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nuint32_t u[4] = {0x3f951d32, 0x3f207887, 0x3d99c3a0, 0x3eb405d2};\n\nvoid ScaleFunction(uint32_t *u_ptr)\n{\n  for(int i = 0; i &lt; 4; i++)\n  {\n      float temp;\n      memcpy (&amp;temp, &amp;u[i], sizeof (float));\n      printf(\"u[%d] = %f\\n\", i, temp);\n  }\n  // And a lot more\n}\n\n\nvoid main (int argc, char **args)\n{\n  ScaleFunction (u);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1496216409, "last_edit_date": 1496216409, "creation_date": 1496215364, "answer_id": 44278236, "question_id": 44277743, "link": "https://stackoverflow.com/questions/44277743/incorrect-single-precision-floating-point-representation-on-ubuntu-64-bit/44278236#44278236", "title": "Incorrect single precision floating point representation on ubuntu 64 bit", "body": "<p>You code cannot work as you think: you are assigning integers to your float. You are not assigning the HEX values as float.</p>\n\n<p>Best thing you can do is to have a init array and copy it to your <code>float</code> array</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;assert.h&gt;\n\nuint32_t init[] = {0x3f951d32u, 0x3f207887u, 0x3d99c3a0u, 0x3eb405d2u};\n\nvoid ScaleFunction(float *u_ptr, size_t size)\n{\n  for(size_t i = 0; i &lt; size; i++)\n  {\n    printf(\"u[%zu] = %f\\n\", i, u_ptr[i]);\n  }\n  // And a lot more\n}\n\nint main (void)\n{\n    assert ( sizeof(float) == sizeof(uint32_t) );\n\n    float u[sizeof(init)/sizeof(init[0])];\n\n    memcpy(u, init, sizeof(init));\n\n    ScaleFunction(u, sizeof(init)/sizeof(init[0]));\n}\n</code></pre>\n"}], "owner": {"reputation": 809, "user_id": 1163200, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/76b64a8c9aab74ab2322a84905e29e3c?s=128&d=identicon&r=PG", "display_name": "Raj", "link": "https://stackoverflow.com/users/1163200/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 44278145, "answer_count": 2, "score": 1, "last_activity_date": 1496216409, "creation_date": 1496213846, "last_edit_date": 1496215005, "question_id": 44277743, "link": "https://stackoverflow.com/questions/44277743/incorrect-single-precision-floating-point-representation-on-ubuntu-64-bit", "title": "Incorrect single precision floating point representation on ubuntu 64 bit", "body": "<p>I have the following data.</p>\n\n<pre><code>float u[4] = {0x3f951d32, 0x3f207887, 0x3d99c3a0, 0x3eb405d2};\nScaleFunction(u);\n\nvoid ScaleFunction(float *u_ptr)\n{\n  for(int i = 0; i &lt; 4; i++)\n  {\n    printf(\"u[%d] = %f\\n\", u_ptr[i]);\n  }\n  // And a lot more\n}\n</code></pre>\n\n<p>The application containing the snippet above is executed on a 64 bit machine running ubuntu 16.10.</p>\n\n<p>Much to my chagrin, the floating point numbers are incorrectly interpreted as: 1066736960.000000, 1059092608.000000, 1033487232.000000 and 1051985344.000000.</p>\n\n<p>The numbers when printed in hexadecimal confirm that the caller passes the correct values to callee. </p>\n\n<p>What am I doing wrong here?</p>\n\n<p>I even tried the following with no joy.</p>\n\n<pre><code>uint32_t u[4] = {0x3f951d32, 0x3f207887, 0x3d99c3a0, 0x3eb405d2};\nScaleFunction(u);\n\nvoid ScaleFunction(uint32_t *u_ptr)\n{\n  float ut[4];\n  for(int i = 0; i &lt; 4; i++)\n  {\n    ut[i] = (float) u_ptr[i];\n    printf(\"ut[%d] = %f\\n\", ut[i]);\n  }\n  // And a lot more\n}\n</code></pre>\n\n<p>I expect to interpret the hexadecimals in the callee as:\n    1.1649, 0.6268, 0.075, 0.5516</p>\n"}, {"tags": ["c", "enums", "properties", "gtk3"], "answers": [{"comments": [{"owner": {"reputation": 1427, "user_id": 1599887, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/31758de16279cc43ba0bf6094dc4260b?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1599887/alex"}, "edited": false, "score": 0, "creation_date": 1497250174, "post_id": 44478988, "comment_id": 75979450, "body": "Uff ... ok, that was surprisingly easy, thanks :D   ... think I will ask the gtk3 people to add these methods to the doc"}], "tags": [], "owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "is_accepted": true, "score": 1, "last_activity_date": 1497136948, "creation_date": 1497136948, "answer_id": 44478988, "question_id": 44277618, "link": "https://stackoverflow.com/questions/44277618/install-style-property-in-gtk3-of-type-enum/44478988#44478988", "title": "install style-property in gtk3 of type enum", "body": "<p>Use <code>gtk_shadow_type_get_type()</code> to retrieve the GType. (For better or for worse, the <code>_get_type()</code> methods usually do not show up in the API documentation.)</p>\n"}], "owner": {"reputation": 1427, "user_id": 1599887, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/31758de16279cc43ba0bf6094dc4260b?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1599887/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 44478988, "answer_count": 1, "score": 2, "last_activity_date": 1497136948, "creation_date": 1496213444, "question_id": 44277618, "link": "https://stackoverflow.com/questions/44277618/install-style-property-in-gtk3-of-type-enum", "title": "install style-property in gtk3 of type enum", "body": "<p>I want to install a enum-style- property using <a href=\"https://developer.gnome.org/gobject/stable/gobject-Standard-Parameter-and-Value-Types.html#g-param-spec-enum\" rel=\"nofollow noreferrer\">g_param_spec_enum</a>:</p>\n\n<pre><code>  gtk_widget_class_install_style_property(gobject_class, g_param_spec_enum(\n          \"shadow-type\",                //name\n          \"shadow-type\",                //nick\n          \"type of shadow\",             //blurb\n          GtkShadowType,                //type\n          GTK_SHADOW_NONE,              //default\n          G_PARAM_READWRITE ));         //flags\n</code></pre>\n\n<p>However <a href=\"https://developer.gnome.org/gtk3/stable/gtk3-Standard-Enumerations.html#GtkShadowType\" rel=\"nofollow noreferrer\">GtkShadowType</a> is not a GType, so it will not work this way:</p>\n\n<pre><code>thunar-statusbar.c:106:12: error: expected expression before \u2018GtkShadowType\u2019\n            GtkShadowType,    //type\n</code></pre>\n\n<p>Any idea how I can get a GType out of GtkShadowType?</p>\n\n<p>My current fix is, to just use <code>g_param_spec_int</code> instead:</p>\n\n<pre><code>  gtk_widget_class_install_style_property(gobject_class, g_param_spec_int (\n          \"shadow-type\",                //name\n          \"shadow-type\",                //nick\n          \"the type of the shadow\",     //blurb\n          GTK_SHADOW_NONE,              //min\n          GTK_SHADOW_ETCHED_OUT,        //max\n          GTK_SHADOW_NONE,              //default\n          G_PARAM_READWRITE));         //flags\n</code></pre>\n\n<p>Seems to work, but is not the official way to deal with enums.</p>\n"}, {"tags": ["c", "string", "input", "char", "scanf"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1496212907, "post_id": 44277437, "comment_id": 75561944, "body": "Welcome to Stack Overflow! <a href=\"https://stackoverflow.com/a/38325926/2173917\"><code>fflush(stdin);</code> is undefined behaviour, don&#39;t do it.</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496213015, "post_id": 44277437, "comment_id": 75561995, "body": "Which platform are you working on?  If you&#39;re on Windows, you will get different behaviour than if you&#39;re on a Unix-like system.  See <a href=\"https://stackoverflow.com/questions/2979209/using-fflushstdin\">Using <code>fflush(stdin)</code></a> for the details.  You should check the return value from <code>scanf()</code> each time you use it."}, {"owner": {"reputation": 3, "user_id": 8090064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914b37b7d53728819f12da3f16de2ea8?s=128&d=identicon&r=PG&f=1", "display_name": "ayush ", "link": "https://stackoverflow.com/users/8090064/ayush"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496213153, "post_id": 44277437, "comment_id": 75562065, "body": "@JonathanLeffler i am working on Mac ,i also checked my input on ideone.com"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496213194, "post_id": 44277437, "comment_id": 75562079, "body": "If you&#39;re on a Mac, then <code>fflush(stdin)</code> is at best a no-op.  After reading the <code>5</code>, the <code>scanf(&quot;%c&quot;, &amp;c);</code> reads a <code>t</code>; the next <code>scanf(&quot;%d&quot;, &amp;n);</code> fails (but you ignored this) without changing <code>n</code>, and the <code>scanf(&quot;%c&quot;, &amp;c);</code> reads a <code>t</code>.  This continues for 5 iterations, and then the loop terminates because of the count (<code>m</code>) dropping to 0.  You&#39;d get better enlightenment if you entered <code>5tuvwx</code>."}, {"owner": {"reputation": 3, "user_id": 8090064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914b37b7d53728819f12da3f16de2ea8?s=128&d=identicon&r=PG&f=1", "display_name": "ayush ", "link": "https://stackoverflow.com/users/8090064/ayush"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496213642, "post_id": 44277437, "comment_id": 75562348, "body": "@JonathanLeffler that&#39;s exactly what i am asking , why the next <code>scanf(&quot;%d&quot;,&amp;n);</code> fails and i tried the input 5tuvwx ."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496213825, "post_id": 44277437, "comment_id": 75562455, "body": "The <code>scanf(&quot;%d&quot;, &amp;n)</code> fails because the next character is <code>t</code> (or <code>u</code>) and neither of those is a valid integer.  Did you see <code>5t &#47; 5u &#47; 5v &#47; 5w &#47; 5x</code> when you typed <code>5tuvwx</code>?"}, {"owner": {"reputation": 3, "user_id": 8090064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914b37b7d53728819f12da3f16de2ea8?s=128&d=identicon&r=PG&f=1", "display_name": "ayush ", "link": "https://stackoverflow.com/users/8090064/ayush"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496214698, "post_id": 44277437, "comment_id": 75563010, "body": "@JonathanLeffler , ya i saw <code>5t &#47; 5u &#47; 5v &#47; 5w &#47; 5x</code> , so if there are no valid integer , in the buffer , and we need input of integer , then we have to flush the input buffer , there is no other way.?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496214868, "post_id": 44277437, "comment_id": 75563138, "body": "You can&#39;t <code>fflush()</code> the input buffer on Unix systems \u2014 you can on Windows (see the question I referenced earlier).  You could read until the newline: <code>int c; while ((c = getchar()) != EOF &amp;&amp; c != &#39;\\n&#39;) ;</code>.  You could read the line with <code>fgets()</code> and then scan it with <code>sscanf()</code> or <code>strtol()</code> or some other suitable function.  Either way works; what you&#39;re trying doesn&#39;t.  If you typed <code>5tuv</code>, then you&#39;d get a chance to enter another integer afterwards."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8090064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914b37b7d53728819f12da3f16de2ea8?s=128&d=identicon&r=PG&f=1", "display_name": "ayush ", "link": "https://stackoverflow.com/users/8090064/ayush"}, "edited": false, "score": 0, "creation_date": 1496214276, "post_id": 44277491, "comment_id": 75562729, "body": "@sauravghosh  ` while ((c = getchar()) != &#39;\\n&#39; &amp;&amp; c != EOF) { }`   where to put this line in my code."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 3, "user_id": 8090064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914b37b7d53728819f12da3f16de2ea8?s=128&d=identicon&r=PG&f=1", "display_name": "ayush ", "link": "https://stackoverflow.com/users/8090064/ayush"}, "edited": false, "score": 0, "creation_date": 1496214374, "post_id": 44277491, "comment_id": 75562783, "body": "@ayush A) define <code>c</code> as <code>int</code> B) use instead of <code>fflush(stdin);</code>"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1496213434, "last_edit_date": 1496213434, "creation_date": 1496213045, "answer_id": 44277491, "question_id": 44277437, "link": "https://stackoverflow.com/questions/44277437/char-in-buffer-preventing-input-of-integer/44277491#44277491", "title": "char in buffer preventing input of integer", "body": "<p>First of all, see this thread about <a href=\"https://stackoverflow.com/a/38325926/2173917\"><code>fflush(stdin);</code> being undefined behaviour</a>, simply don't do it.</p>\n\n<p>You can roll your own function go get this done. Something along the line of</p>\n\n<pre><code>  while ((c = getchar()) != '\\n' &amp;&amp; c != EOF) { }\n</code></pre>\n\n<p>should do the job nicely.</p>\n\n<p>That said,</p>\n\n<pre><code>   puts(&amp;c);  \n</code></pre>\n\n<p>also  causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, as <code>&amp;c</code> does not point to a <em>string</em>. Variable <code>c</code> is of type <code>char</code>, it's not a <code>char</code> array with a mandatory null-termination required to be considered as <em>string</em>. so, due to memory overrun, you're essentially accessing out of bound memory which causes the UB.</p>\n\n<p>Probably you want to use <a href=\"https://linux.die.net/man/3/puts\" rel=\"nofollow noreferrer\"><code>putchar()</code></a> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496215715, "post_id": 44277647, "comment_id": 75563681, "body": "Not my down-vote, but I suggest you illustrate how you&#39;d use <code>getchar()</code> to clean up.  Note that the OP typed <code>5ttttt</code> as the first input line \u2014 you need to handle that correctly too."}, {"owner": {"reputation": 155, "user_id": 5793907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/915bf7644117e74a5068633e5d11421f?s=128&d=identicon&r=PG&f=1", "display_name": "Najat", "link": "https://stackoverflow.com/users/5793907/najat"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496216148, "post_id": 44277647, "comment_id": 75563966, "body": "@Jonathan Laffler Thank you."}], "tags": [], "owner": {"reputation": 155, "user_id": 5793907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/915bf7644117e74a5068633e5d11421f?s=128&d=identicon&r=PG&f=1", "display_name": "Najat", "link": "https://stackoverflow.com/users/5793907/najat"}, "is_accepted": false, "score": -1, "last_activity_date": 1496216418, "last_edit_date": 1496216418, "creation_date": 1496213549, "answer_id": 44277647, "question_id": 44277437, "link": "https://stackoverflow.com/questions/44277437/char-in-buffer-preventing-input-of-integer/44277647#44277647", "title": "char in buffer preventing input of integer", "body": "<p>Avoid <code>fflush(stdin)</code>. Instead of <code>fflush(stdin)</code> you can use <code>getchar()</code>.\nAfter giving an integer input by <code>scanf(\"%d\", &amp;n)</code> you'll press an Enter, right? That <code>\\n</code> (new line character) will be taken by <code>getchar()</code> and you can safely take a character input by <code>scanf(\"%c\", &amp;c)</code>. Otherwise the <code>\\n</code> will be taken by <code>c</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 8090064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914b37b7d53728819f12da3f16de2ea8?s=128&d=identicon&r=PG&f=1", "display_name": "ayush ", "link": "https://stackoverflow.com/users/8090064/ayush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496228217, "creation_date": 1496212840, "last_edit_date": 1496213337, "question_id": 44277437, "link": "https://stackoverflow.com/questions/44277437/char-in-buffer-preventing-input-of-integer", "title": "char in buffer preventing input of integer", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    int n,m=5;\n    char c;\n    while(m&gt;0)\n    {\n        m--;\n        scanf(\"%d\",&amp;n);\n        if(n==42)\n        break;\n        printf(\"%d\",n);\n        fflush(stdin);\n        scanf(\"%c\",&amp;c);\n        puts(&amp;c);       \n    }\n    return 0;\n}\n</code></pre>\n\n<p>Although I know that when a enter is pressed after entering a number at first <code>scanf</code>, it(enter) is taken as input by the second <code>scanf</code>, but my doubt is that, when I give <code>5ttttt</code> as input , the output is </p>\n\n<pre><code>5t\n5t\n5t\n5t\n5t\n</code></pre>\n\n<p>as there is no integer in input buffer, why it is not asking for input of integer|\nSecond question is, even if we follow the above behavior, then on giving input of <code>5t</code> and then pressing enter should take two characters as buffer ('t' and 'enter') but only t is taken in buffer and the output is</p>\n\n<pre><code>5t\n</code></pre>\n\n<p>but I expected the output</p>\n\n<pre><code>5t\n5\n</code></pre>\n\n<p>as 'enter' would be taken in buffer and it will not ask for integer input in the second iteration of loop. </p>\n"}, {"tags": ["c", "heap-memory"], "comments": [{"owner": {"reputation": 7381, "user_id": 7802200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Adik7.png?s=128&g=1", "display_name": "Arya McCarthy", "link": "https://stackoverflow.com/users/7802200/arya-mccarthy"}, "edited": false, "score": 0, "creation_date": 1496211449, "post_id": 44277048, "comment_id": 75561188, "body": "We need more detail. Which line does it crash on, for instance?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1496211635, "post_id": 44277048, "comment_id": 75561280, "body": "Welcome to StackOverflow.   Please take the <a href=\"https://stackoverflow.com/tour\">tour</a>,   learn asking good questions stackoverflow.com/help/how-to-ask,   make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 1, "creation_date": 1496211653, "post_id": 44277048, "comment_id": 75561290, "body": "As an aside: <code>strdup()</code> is a nicer way to duplicate strings than  <code>malloc()&#47;strcpy()</code> combinations."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1496211691, "post_id": 44277048, "comment_id": 75561312, "body": "@MichaelBurr The drawback is that <code>strdup</code> is not a standard function. Though I don&#39;t know any C compiler or system that doesn&#39;t come with it."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1496212335, "post_id": 44277048, "comment_id": 75561647, "body": "You will also want to look at the obligatory &quot;there is NO need to cast the return of <code>malloc</code>&quot;, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\"><b>Do I cast the result of malloc?</b></a> ."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 1, "creation_date": 1496213027, "post_id": 44277048, "comment_id": 75561999, "body": "Just because something isn&#39;t in the C standard doesn&#39;t mean it&#39;s not useful."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1496221489, "post_id": 44277048, "comment_id": 75567419, "body": "<code>strdup</code> is in POSIX and available also in Windows, so it is quite portable for desktop programs. When it fails to compile on some obscure platform, it is easy to provide an emulation."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 4, "last_activity_date": 1496211550, "creation_date": 1496211550, "answer_id": 44277085, "question_id": 44277048, "link": "https://stackoverflow.com/questions/44277048/allocating-memory-for-structures-in-c/44277085#44277085", "title": "Allocating memory for structures in c", "body": "<p>When you do</p>\n\n<pre><code>newnode = malloc(sizeof(struct data));\n</code></pre>\n\n<p>you only allocate memory for the actual <em>structure</em>. But since the structure contains pointers, you need to make those pointers point somewhere valid. The single <code>malloc</code> call doesn't know anything about the contents of the structure, or how much extra memory it should allocate for all the pointers.</p>\n\n<p>If, for example, you declare a single normal pointer variable you would not expect to be able to just use it as a destination for a <code>strcpy</code> call without allocating memory, would you?</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 8066932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf8115ec13822c35bf960a192c5c742?s=128&d=identicon&r=PG&f=1", "display_name": "Kyon Bugsy", "link": "https://stackoverflow.com/users/8066932/kyon-bugsy"}, "edited": false, "score": 0, "creation_date": 1496212213, "post_id": 44277138, "comment_id": 75561580, "body": "Thanks a lot both to you and @SomeProgrammerDude . That makes sense"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 4, "last_activity_date": 1496212066, "last_edit_date": 1496212066, "creation_date": 1496211765, "answer_id": 44277138, "question_id": 44277048, "link": "https://stackoverflow.com/questions/44277048/allocating-memory-for-structures-in-c/44277138#44277138", "title": "Allocating memory for structures in c", "body": "<p>With <code>newnode = (struct data*)malloc(sizeof(struct data))</code>, you allocate memory only for <code>struct data</code>, which is a set of pointers, but you do not allocate any memory for that where these pointers are pointing to and where you will copy your strings to. So you have to allocate memory for each string separately, either by using <code>malloc</code> as in the second part of your question, or by using <code>strdup</code>, which does <code>malloc</code> and <code>strcpy</code> in one command:</p>\n\n<pre><code>struct data{\nchar *key;\nchar *fname;\nchar *lname;\nchar *grade;\nstruct data *next;\n};\n\n\n newnode = (struct data*)malloc(sizeof(struct data));\n newnode-&gt;lname = strdup(lname);\n newnode-&gt; grade = strdup(grade);\n newnode-&gt; key = strdup(key);\n newnode-&gt; fname = strdup(fname);\n newnode-&gt;next=NULL;\n</code></pre>\n\n<p>It's worth noting that <code>strdup</code> requires a string as input, i.e. a pointer that is not <code>NULL</code> and that points to a <code>\\0</code>-terminated sequence of characters.</p>\n"}, {"comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 1, "creation_date": 1496213199, "post_id": 44277270, "comment_id": 75562084, "body": "<code>strncpy()</code> is terrible for most uses - you need to jump through hoops to ensure that the destination is properly terminated."}, {"owner": {"reputation": 743, "user_id": 5091033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d0737443a012e096ab556ef60a197f?s=128&d=identicon&r=PG&f=1", "display_name": "simo-r", "link": "https://stackoverflow.com/users/5091033/simo-r"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1496213559, "post_id": 44277270, "comment_id": 75562309, "body": "@MichaelBurr If the source string is properly terminated and you use strncpy in the right way it improves security and robustness of you code avoiding buffer overflows."}, {"owner": {"reputation": 5698, "user_id": 270280, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d8209c0118ceb99fe4ed98c0c079c0bf?s=128&d=identicon&r=PG", "display_name": "harald", "link": "https://stackoverflow.com/users/270280/harald"}, "edited": false, "score": 1, "creation_date": 1496253223, "post_id": 44277270, "comment_id": 75589713, "body": "@BetaRunner, strncpy has it&#39;s uses, but not as a &quot;safe&quot; version of strcpy. Sadly it&#39;s a much misunderstood function. Also the buffer returned by malloc may contain garbage, so there&#39;s no guarantee that the pointers in the stuct are NULL. Most likely they are not."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1496260913, "post_id": 44277270, "comment_id": 75593918, "body": "@BetaRunner: Microsoft <a href=\"https://msdn.microsoft.com/en-us/library/bb288454.aspx\" rel=\"nofollow noreferrer\">disallows <code>strncpy()</code> in their own code</a> (and newer MSVC compilers warn about it by default for everyone) because of documented problems in its use.  And here&#39;s <a href=\"http://yarchive.net/comp/linux/strncpy.html\" rel=\"nofollow noreferrer\">a quote from Linus Torvalds about <code>strncpy()</code></a>: &quot;<code>strncpy()</code> is a frigging disaster when it comes to &#39;\\0&#39;, in many ways. We should probably disallow using <code>strncpy()</code>&quot;"}, {"owner": {"reputation": 743, "user_id": 5091033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d0737443a012e096ab556ef60a197f?s=128&d=identicon&r=PG&f=1", "display_name": "simo-r", "link": "https://stackoverflow.com/users/5091033/simo-r"}, "edited": false, "score": 0, "creation_date": 1496261096, "post_id": 44277270, "comment_id": 75594007, "body": "You&#39;re right guys, I read a lot about it now and I agree with you."}], "tags": [], "owner": {"reputation": 743, "user_id": 5091033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d0737443a012e096ab556ef60a197f?s=128&d=identicon&r=PG&f=1", "display_name": "simo-r", "link": "https://stackoverflow.com/users/5091033/simo-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1496255103, "last_edit_date": 1496255103, "creation_date": 1496212227, "answer_id": 44277270, "question_id": 44277048, "link": "https://stackoverflow.com/questions/44277048/allocating-memory-for-structures-in-c/44277270#44277270", "title": "Allocating memory for structures in c", "body": "<p>When you <code>malloc</code> a structure with <code>char *</code> inside it doesn't point anywhere (at least is <code>NULL</code>) so you've to <code>malloc</code> it as a normal sequence of characters also because you <strong>must</strong> know the size of the destination string. You can do it in your way using <code>malloc</code> and <code>strcpy</code> or just <code>strdup</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 8066932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf8115ec13822c35bf960a192c5c742?s=128&d=identicon&r=PG&f=1", "display_name": "Kyon Bugsy", "link": "https://stackoverflow.com/users/8066932/kyon-bugsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 44277138, "answer_count": 3, "score": 1, "last_activity_date": 1496255103, "creation_date": 1496211400, "question_id": 44277048, "link": "https://stackoverflow.com/questions/44277048/allocating-memory-for-structures-in-c", "title": "Allocating memory for structures in c", "body": "<pre><code>struct data{\nchar *key;\nchar *fname;\nchar *lname;\nchar *grade;\nstruct data *next;\n};\n\n\n newnode = (struct data*)malloc(sizeof(struct data));\n strcpy(newnode-&gt;lname,lname);\n strcpy(newnode-&gt;grade,grade);\n strcpy(newnode-&gt;key,key);\n strcpy(newnode-&gt;fname,fname);\n newnode-&gt;next=NULL;\n</code></pre>\n\n<p>So i was working on hashtables. The above code crashes while</p>\n\n<pre><code>struct data *newnode;\nnewnode = (struct data*)malloc(sizeof(struct data));\nnewnode-&gt;lname=(char*)malloc(strlen(lname)+1);\nnewnode-&gt;fname=(char*)malloc(strlen(fname)+1);\nnewnode-&gt;grade=(char*)malloc(strlen(grade)+1);\nnewnode-&gt;key=(char*)malloc(strlen(key)+1);\n\nstrcpy(newnode-&gt;lname,lname);\nstrcpy(newnode-&gt;grade,grade);\nstrcpy(newnode-&gt;key,key);\nstrcpy(newnode-&gt;fname,fname);\nnewnode-&gt;next=NULL;\n</code></pre>\n\n<p>this code seems to run. Why is that? As far as i understand i've already allocated memory for my struct in the heap. Why would i have to do it for each object specifically? Is there something else im missing? Cause i really don't understand why the bottom example would work.</p>\n"}, {"tags": ["c", "multithreading", "printf", "reentrancy"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 6, "creation_date": 1496210477, "post_id": 44276776, "comment_id": 75560709, "body": "Short answer : no, <code>squareOfInteger()</code> need to be thread safe by itself."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1496211283, "post_id": 44276776, "comment_id": 75561079, "body": "Why do you think so?...What kind of magic do you imagine behind printf?..."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1496211324, "post_id": 44276776, "comment_id": 75561112, "body": "OP, can you explain what you mean by &quot;threadsafe&quot; and &quot;non reentrant&quot;? Especially how that could be changed from unsafe to safe by being called from another function. We seem to have different understandings of those terms."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496211448, "post_id": 44276776, "comment_id": 75561186, "body": "@Stargateur You probably have to explain your understanding of &quot;thread safe&quot; to be helpful for OP. Though I am pretty sure that you and me agree much better on the term than you and OP."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 3, "creation_date": 1496211979, "post_id": 44276776, "comment_id": 75561446, "body": "You are not passing a function call. I am sure a call is not a type in C. What you are passing is the result of the call. It is the same as <code>int res = squareOfIntger(5);</code> and then passing <code>res</code>."}, {"owner": {"reputation": 181, "user_id": 5830837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfef22d268d33c2a31fbfd4e95f135?s=128&d=identicon&r=PG&f=1", "display_name": "Shuvam", "link": "https://stackoverflow.com/users/5830837/shuvam"}, "edited": false, "score": 0, "creation_date": 1496214522, "post_id": 44276776, "comment_id": 75562897, "body": "calling a function squareOfIntger() from a threadsafe function (printf in this case) does not mean that squareOfIntger() will be threadsafe!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 181, "user_id": 5830837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfef22d268d33c2a31fbfd4e95f135?s=128&d=identicon&r=PG&f=1", "display_name": "Shuvam", "link": "https://stackoverflow.com/users/5830837/shuvam"}, "edited": false, "score": 0, "creation_date": 1496215815, "post_id": 44276776, "comment_id": 75563736, "body": "@ShuvamDas: Note that <code>squareOfInteger()</code> will be called before <code>printf()</code> is called \u2014 it will be called while the arguments to <code>printf()</code> are being evaluated, but the call to <code>squareOfInteger()</code> will be complete before <code>printf()</code> is actually called."}, {"owner": {"reputation": 181, "user_id": 5830837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfef22d268d33c2a31fbfd4e95f135?s=128&d=identicon&r=PG&f=1", "display_name": "Shuvam", "link": "https://stackoverflow.com/users/5830837/shuvam"}, "edited": false, "score": 0, "creation_date": 1496218347, "post_id": 44276776, "comment_id": 75565325, "body": "So is the case with arguments of a function. Isn&#39;t it?I fail to see the point. Wouldn&#39;t the evaluation of args always be done in the same thread that has invoked the function in the first place? or am I missing something here?"}], "answers": [{"tags": [], "owner": {"reputation": 1118, "user_id": 8074683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e8Ik8.jpg?s=128&g=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/8074683/anton"}, "is_accepted": false, "score": 2, "last_activity_date": 1496219143, "creation_date": 1496219143, "answer_id": 44279459, "question_id": 44276776, "link": "https://stackoverflow.com/questions/44276776/passing-function-call-as-a-parameter-to-printf-reentrancy/44279459#44279459", "title": "Passing function call as a parameter to printf &amp; Reentrancy", "body": "<p>No. Counterexample:</p>\n\n<pre><code>int squareOfInteger(int x)\n{\n    static int val;\n    val = x*x; /* Possible race condition here */\n    return val;\n}\n</code></pre>\n\n<p>This function is evaluated by different threads (concurrently) before <code>printf</code> is called and the result is handed over to <code>printf</code>.</p>\n"}], "owner": {"reputation": 75, "user_id": 7167317, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-iqC7eWk7Ngg/AAAAAAAAAAI/AAAAAAAAGt4/qnO0UPznRWQ/photo.jpg?sz=128", "display_name": "Balaganesh.V", "link": "https://stackoverflow.com/users/7167317/balaganesh-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496219143, "creation_date": 1496210297, "last_edit_date": 1496213718, "question_id": 44276776, "link": "https://stackoverflow.com/questions/44276776/passing-function-call-as-a-parameter-to-printf-reentrancy", "title": "Passing function call as a parameter to printf &amp; Reentrancy", "body": "<p>As per my knowledge , <code>printf()</code> is threadsafe and not reentrant.\nNow if I pass the result of a function call as a parameter like this: </p>\n\n<pre><code>printf(\"\\\"%d\\\" squared is \\\"%d\\\".\\n\", 5, squareOfInteger(5));\n</code></pre>\n\n<p>will the function <code>squareofInteger</code> also become threadsafe in a multithreaded program?</p>\n"}, {"tags": ["c", "linux", "unix", "pthreads"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1496211476, "post_id": 44276732, "comment_id": 75561201, "body": "The program code shown in the question is not the code of the program that produced the output you show in the question.  That makes it impossible for us to answer your question.  Get the code and output consistent before asking questions (or giving answers).  Also note that the thread functions are supposed to return a <code>void *</code> value \u2014 add <code>return 0;</code>.  You don&#39;t wait for the threads to complete; that may be a factor in the problem, though I reserve judgement on that."}, {"owner": {"reputation": 131, "user_id": 5654243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87824348249ab773193efacbc0b8cfbc?s=128&d=identicon&r=PG&f=1", "display_name": "E V Ravi", "link": "https://stackoverflow.com/users/5654243/e-v-ravi"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496212035, "post_id": 44276732, "comment_id": 75561475, "body": "Thanks  Jonathan Leffler , i have corrected my Question. still i am getting the same output as posted earlier."}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 2, "creation_date": 1496212787, "post_id": 44276732, "comment_id": 75561876, "body": "Your program is probably terminating before the threads are done,Abnormal termination of program may lead to such behavior, you should call pthread_join for both threads prior to returning from main"}, {"owner": {"reputation": 131, "user_id": 5654243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87824348249ab773193efacbc0b8cfbc?s=128&d=identicon&r=PG&f=1", "display_name": "E V Ravi", "link": "https://stackoverflow.com/users/5654243/e-v-ravi"}, "edited": false, "score": 0, "creation_date": 1496212941, "post_id": 44276732, "comment_id": 75561958, "body": "Nope nos, I haven&#39;t run a code other than the one i posted. thanks!"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496295696, "post_id": 44276732, "comment_id": 75603960, "body": "@JonathanLeffler, I cannot guess how do you deduct that the program listing is not the same as the program producing the output.  Can you explain?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1496305980, "post_id": 44276732, "comment_id": 75610040, "body": "@LuisColorado: the code presented was edited after I pointed out the problem. If you look at the revision history, you&#39;ll see that the output always said <code>t1 = \u2026</code> but the code did not, for example."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496306556, "post_id": 44276732, "comment_id": 75610413, "body": "People need to read the specification of POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/flockfile.html\" rel=\"nofollow noreferrer\"><code>flockfile()</code></a> and <code>funlockfile()</code>.  That page says: <i>All functions that reference (<code>FILE *</code>) objects, except those with names ending in <code>_unlocked</code>, shall behave as if they use <code>flockfile()</code> and <code>funlockfile()</code> internally to obtain ownership of these (<code>FILE *</code>) objects.</i>  Thus, if thread 1 is executing <code>printf()</code>, all other threads are locked out from accessing <code>stdout</code> until thread 1&#39;s call is effectively complete (it has called <code>funlockfile(stdout)</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 5654243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87824348249ab773193efacbc0b8cfbc?s=128&d=identicon&r=PG&f=1", "display_name": "E V Ravi", "link": "https://stackoverflow.com/users/5654243/e-v-ravi"}, "edited": false, "score": 0, "creation_date": 1496212635, "post_id": 44277133, "comment_id": 75561799, "body": "Hi Marian I agree with your 1st &amp; 2nd points. And YES I am executing ./a.out  multiiple times , but I am unable to understand how come the outputs get mixed if i execute same program again and again."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1496217245, "post_id": 44277133, "comment_id": 75564625, "body": "Your scenario does not include the command line ./a.out for RUN2 which should be visible between the output of RUN1 and RUN2."}, {"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1496217933, "post_id": 44277133, "comment_id": 75565077, "body": "@Gerhardh Because printf shall be thread-safe, I guess that the supposed 3 &quot;hello worlds&quot; are due to a human misunderstanding of the output. It is on OP to say, if this was the case or not."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1496218369, "post_id": 44277133, "comment_id": 75565349, "body": "@Jean-BaptisteYun&#232;s according to the example in the question, it is not <code>a.out; a.out</code> but separate commands with the second entered after first exited."}, {"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1496219159, "post_id": 44277133, "comment_id": 75565846, "body": "@Gerhardh As pointed in comments, samples shown in the question are not authentic."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1496219379, "post_id": 44277133, "comment_id": 75565973, "body": "@Marian outputs are real, I experienced them very easily."}], "tags": [], "owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "is_accepted": false, "score": 0, "last_activity_date": 1496216356, "last_edit_date": 1496216356, "creation_date": 1496211744, "answer_id": 44277133, "question_id": 44276732, "link": "https://stackoverflow.com/questions/44276732/unable-to-understand-pthread-create-behaviour-in-the-following-program/44277133#44277133", "title": "Unable to understand pthread_create() behaviour in the following program?", "body": "<p>When the main program terminates sub threads are terminated as well.</p>\n\n<p>It can happen that both sub-threads are executed before the main task finishes. In this case you see two \"hello worlds\" and the output as you show in the question. </p>\n\n<p>Also it can happen that the main program finishes before one or both threads print the output. In this case you can see one or no \"hello world\" at all. </p>\n\n<p>I do not see any possibility that a single run of this program prints it 3 times. I suppose that you are executing the program in a loop and the output of two runs is mixed together. ADDED: For example, imagine the following scenario: RUN1: prints two numbers, then subthreads are scheduled and they print one \"hello world\" each, then RUN1 main is scheduled back and program finishes. Next, RUN2 is launched. In this case both subthreads are scheduled before the main program prints the numbers.</p>\n\n<p>So you see an output like:</p>\n\n<pre><code>t1=346236763               (RUN1 - main)\nt2=876237623               (RUN1 - main)\nhello, world               (RUN1 - subthread)\nhello, world               (RUN1 - subthread)\nhello, world               (RUN2 - subthread)\nhello, world               (RUN2 - subthread)\nt1=3786768623              (RUN2 - main)\nt2=7843473478              (RUN2 - main)\n</code></pre>\n\n<p>the output can be wrongly interpreted as if there were 4 \"hello worlds\" written by a single run.</p>\n"}, {"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1496296086, "post_id": 44278617, "comment_id": 75604124, "body": "Jean-Baptiste, I&#39;m afraid the three messages case is also not covered by your solution and he will have to protect the <code>FILE</code> instance with a <code>mutex</code> or similar protection.  See my answer, as it illustrates one possibility of such a race, involving <i>only</i> the two threads, and not considering the <i>atexit</i> flushing of <code>stdout</code> made by <code>main</code>."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1496305589, "post_id": 44278617, "comment_id": 75609796, "body": "@LuisColoradoYour explanation is almost the same of mine. And 3 messages are easy to generate as the second thread just needs to run after main flushed everything but not closed stdout..."}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 4, "last_activity_date": 1496242991, "last_edit_date": 1496242991, "creation_date": 1496216532, "answer_id": 44278617, "question_id": 44276732, "link": "https://stackoverflow.com/questions/44276732/unable-to-understand-pthread-create-behaviour-in-the-following-program/44278617#44278617", "title": "Unable to understand pthread_create() behaviour in the following program?", "body": "<p>You experienced a thread-safety problem. I ran your code several times in Linux 16.04 and it produces many different outputs, while the one with 3 <code>hello world</code> message being rare it exists. More frequently there is no output at all which means that <code>main</code> terminates faster than threads being able to finish their outputs. Sometime partial outputs are produced like:</p>\n\n<pre><code>t1=xxxx\nt2=yyyy\nhe\n</code></pre>\n\n<p>That means that the <code>main</code> is exiting while only one thread was able to push some characters in the stdout buffer. Remember that a normal return from <code>main</code> is equivalent to a call to <code>exit</code> which flushes stdio buffers.</p>\n\n<p>While I am unable to really understand what happens behind the scene when you observe 3 messages, I suspect that there exists a run race that let the <code>main</code> flushing a buffer that is currently being flush by one of the threads. Without examining very carefully the source code of <code>printf</code> it is very hard to say more. A possible (rough) scenario would looks like:</p>\n\n<ol>\n<li>thread1 fills the buffers and enters the flushing but is preempted at the very beginning of it</li>\n<li>main exits, so enters the flushing and terminates it and is preempted at the very end of it thus producing <code>hello world</code></li>\n<li>thread1 finishes its flushing producing <code>hello world</code></li>\n<li>thread2 produces <code>hello world</code></li>\n<li>main gets the CPU and terminates the process.</li>\n</ol>\n\n<p><code>printf</code> is not defined as thread-safe, which means that implementors may realize it as such or not (probably not in most cases). So you need, as with any function that uses some shared resource, some mutex to prevents buffer concurrency and such.</p>\n\n<p>In your case, this should be roughly solved (3 outputs) by joining the threads in the main which will prevent <code>main</code> exiting/flushing before threads termination. But be aware that this will not solve other concurrency problems (two threads accessing the same buffer...).</p>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 5654243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87824348249ab773193efacbc0b8cfbc?s=128&d=identicon&r=PG&f=1", "display_name": "E V Ravi", "link": "https://stackoverflow.com/users/5654243/e-v-ravi"}, "edited": false, "score": 0, "creation_date": 1496301150, "post_id": 44299276, "comment_id": 75606862, "body": "It sometimes prints &quot;hello, world&quot; 4 times also."}, {"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 0, "creation_date": 1496303973, "post_id": 44299276, "comment_id": 75608762, "body": "Manual page of <code>pthreads</code> claims that <code>printf</code> shall be thread safe. On the other hand <code>printf</code> is not reentrant, i.e. it shall not be interrupted and re-called for the second time in the same thread. This is probably what happens in this example when the main program aborts subthreads."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 0, "creation_date": 1496304630, "post_id": 44299276, "comment_id": 75609229, "body": "@Marian, sorry, but reentrancy is a pre-requisite for a call to be thread safe.  You have to protect the buffer used in the FILE structure.  reentrancy or thread safety of <code>printf</code> is a design decision of <code>printf</code> itself.  It depends on the implementation of <code>printf</code> to want to be compatible with the implementation of the thread library.  Pthreads library cannot argue that some other routine not implemented in the pthread library <b>is</b> implemented as such, It can <b>require</b> <code>printf</code> to be thread safe, but cannot say that something implemented elsewhere <b>is</b> something."}, {"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1496306734, "post_id": 44299276, "comment_id": 75610540, "body": "@Jean-BaptisteYun&#232;s When I type <code>man pthreads</code> I see: &quot;POSIX.1-2001 and POSIX.1-2008 require that all functions specified in the standard shall be thread-safe, except for the following functions:&quot; followed by a list of function where <code>printf</code> is not listed."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 0, "creation_date": 1496317201, "post_id": 44299276, "comment_id": 75618108, "body": "@Marian right I misread the manual. Then Linux is not POSIX compliant..."}, {"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1496325695, "post_id": 44299276, "comment_id": 75624628, "body": "@Jean-BaptisteYun&#232;s Or it is caused by <code>exit</code> which is not thread safe."}], "tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 2, "last_activity_date": 1496295531, "last_edit_date": 1592644375, "creation_date": 1496295531, "answer_id": 44299276, "question_id": 44276732, "link": "https://stackoverflow.com/questions/44276732/unable-to-understand-pthread-create-behaviour-in-the-following-program/44299276#44299276", "title": "Unable to understand pthread_create() behaviour in the following program?", "body": "<p>Well, let me show an scenario where this can happen.  You probably know (if you don't, please read the appropiate manual page) that <code>printf()</code> is one of the functions that is not thread safe of the standard library (there is a list in the <code>pthread_&lt;something&gt;</code>, somewhere) and you probably also know that <code>printf(3)</code> stores its data in a buffer previously to issue the <code>write(2)</code> system call to actually write the data to stdout.</p>\n<ol>\n<li>Thread A (I deliverately selected different labels as you, to make both threads indistinguishable, so Thread A can be either thread) makes a <code>printf()</code> call that puts a compllete <code>&quot;Hello, world\\n&quot;</code> message in the buffer, and prepares to <code>write(2)</code> it, as a consequence of the terminal being a <strong>tty</strong> device and a <code>\\n</code> ends the output string.</li>\n<li>Thread B takes control and makes a second call to the same <code>printf(2)</code>data (and fills the same buffer with a second copy of <code>&quot;Hello, world\\n&quot;</code>) and for the same reason, prepares and completely executes a <code>write(2)</code> syscall of the whole buffer (which now contains two messages) flushes the buffer.  this makes <code>&quot;Hello, world\\n&quot;</code> to appear twice.</li>\n<li>Thread A, which has been blocked by means of the first <code>write(2)</code> system call (both threads cannot make simultaneous <code>write(2)</code> calls to the same inode ---this is warranted by the system kernel) flushes <strong>it's view</strong> (which probably is stored in its stack, and includes only the reference to the first message) of the buffer (which finished at the end of the first <code>&quot;Hello, world\\n&quot;</code>) and makes another write of one more <code>&quot;Hellow, world\\n&quot;</code> message)</li>\n</ol>\n<p>Final score: Three <code>&quot;Hellow, world\\n&quot;</code> messages at the terminal.</p>\n<h1>NOTE</h1>\n<p>The most probable thing is that getting three messages is difficult to happen, as you need one of the threads to bypass the other in the time <code>printf</code> decides it is time to flush the buffer, after filling it (which is a short time) and then get first into the blocking <code>write(2)</code> call (as explained before, both threads cannot be involved in a <code>write(2)</code> call at the same time to the same file, that's not permitted by the kernel)</p>\n"}], "owner": {"reputation": 131, "user_id": 5654243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87824348249ab773193efacbc0b8cfbc?s=128&d=identicon&r=PG&f=1", "display_name": "E V Ravi", "link": "https://stackoverflow.com/users/5654243/e-v-ravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1496295531, "creation_date": 1496210069, "last_edit_date": 1496220076, "question_id": 44276732, "link": "https://stackoverflow.com/questions/44276732/unable-to-understand-pthread-create-behaviour-in-the-following-program", "title": "Unable to understand pthread_create() behaviour in the following program?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n\nvoid *thread_func(void *arg)\n{\n        printf(\"hello, world \\n\");\n        return 0;\n}\n\nint main(void)\n{\n        pthread_t t1, t2;\n\n        pthread_create(&amp;t1, NULL, thread_func, NULL);\n        pthread_create(&amp;t2, NULL, thread_func, NULL);\n\n        printf(\"t1 = %d\\n\",t1);\n        printf(\"t2 = %d\\n\",t2);\n\n        return 0;\n}\n</code></pre>\n\n<p>The above program creates two threads, where each thread prints \"Hello World\".</p>\n\n<p>So, as per my understanding, the \"Hello world\" should print a maximum 2 times.</p>\n\n<p>However, <strong>while executing the same program multiple times</strong>(back to back), there are scenarios where \"Hello world\" is being printed <strong>more</strong> than <strong>2</strong> times. So I am unclear how it is getting printed an unexpected number of times?   </p>\n\n<p>Here are the sample outputs:</p>\n\n<pre><code>[rr@ar ~]$ ./a.out\nt1 = 1290651392\nt2 = 1282258688\nhello, world\nhello, world\n\n\n[rr@ar ~]$ ./a.out\nt1 = 1530119936\nt2 = 1521727232\nhello, world\nhello, world\nhello, world\n</code></pre>\n\n<p>As shown above, after executing the program for many times, <strong>\"hello, world\"</strong> is printed <strong>3</strong> times. Can anyone please advise <strong>how come it got printed 3 times?</strong></p>\n"}, {"tags": ["c", "encryption", "memory-leaks", "openssl", "rsa"], "comments": [{"owner": {"reputation": 626, "user_id": 4690576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a328eeb1bb069c34be414a5e7bcda10?s=128&d=identicon&r=PG", "display_name": "AmeyaVS", "link": "https://stackoverflow.com/users/4690576/ameyavs"}, "edited": false, "score": 0, "creation_date": 1496209255, "post_id": 44276494, "comment_id": 75560113, "body": "Try using Valgrind to see the memory leak report."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 2, "creation_date": 1496213526, "post_id": 44276494, "comment_id": 75562286, "body": "Please show the leak. Also see <a href=\"https://wiki.openssl.org/index.php/Library_Initialization\" rel=\"nofollow noreferrer\">Library Initialization</a> on the OpenSSL wiki. It shows you how to startup and shutdown the library. And <a href=\"https://stackoverflow.com/q/34794272/608639\">Memory leak in OpenSSL?</a>, <a href=\"https://stackoverflow.com/q/21532371/608639\">Memory leak in OpenSSL function EVP_PKEY_keygen</a>, <a href=\"https://stackoverflow.com/q/11759725/608639\">OpenSSL::SSL_library_init() memory leak</a>, <a href=\"https://stackoverflow.com/q/18503993/608639\">Memory leak in OpenSSL function EVP_EncryptFinal_ex</a> on Stack Overflow."}], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 2255802, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a5ebe83e1bd2d9942dda944c5aa004bf?s=128&d=identicon&r=PG", "display_name": "Yu-Chih", "link": "https://stackoverflow.com/users/2255802/yu-chih"}, "edited": false, "score": 0, "creation_date": 1496297918, "post_id": 44279263, "comment_id": 75604959, "body": "Hey, you are my hero! The problem I post is detected by ASN and it is caused by other issues. But your post helps me to stop the annoying Valgrind warning!!"}], "tags": [], "owner": {"reputation": 2014, "user_id": 6267288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f86a7e2f0811a9e18031ed7c0af917a?s=128&d=identicon&r=PG&f=1", "display_name": "OlivierM", "link": "https://stackoverflow.com/users/6267288/olivierm"}, "is_accepted": true, "score": 3, "last_activity_date": 1496218521, "creation_date": 1496218521, "answer_id": 44279263, "question_id": 44276494, "link": "https://stackoverflow.com/questions/44276494/rsa-new-and-rsa-generate-key-ex-make-memory-leakage/44279263#44279263", "title": "RSA_new and RSA_generate_key_ex make memory leakage", "body": "<p>I tried your program (after fixing typos such as <code>RAS_generate_key_ex</code> -> <code>RSA_generate_key_ex</code> and <code>EVP_PKEY pkey = EVP_PKEY_new()</code> -> <code>EVP_PKEY* pkey = EVP_PKEY_new()</code>).</p>\n\n<p>I had now this source:</p>\n\n<pre><code>#include &lt;openssl/ssl.h&gt;\n#include &lt;openssl/rsa.h&gt;\n#include &lt;openssl/evp.h&gt;\n\nint main() {\n  BIGNUM e;\n  BN_init(&amp;e);\n  BN_set_word(&amp;e, 17);\n  RSA *rsa = RSA_new();\n  RSA_generate_key_ex(rsa, 1024, &amp;e, NULL);\n  EVP_PKEY* pkey = EVP_PKEY_new();\n  EVP_PKEY_set1_RSA(pkey, rsa);\n  RSA_free(rsa);\n  BN_free(&amp;e);\n  //MINE_COPY_KEY(pkey); // I copy the pkey to other location at here //\n  EVP_PKEY_free(pkey);\n  return 0;\n}\n</code></pre>\n\n<p>Valgrind says:</p>\n\n<pre><code>==18061== \n==18061== LEAK SUMMARY:\n==18061==    definitely lost: 0 bytes in 0 blocks\n==18061==    indirectly lost: 0 bytes in 0 blocks\n==18061==      possibly lost: 0 bytes in 0 blocks\n==18061==    still reachable: 220 bytes in 6 blocks\n==18061==         suppressed: 0 bytes in 0 blocks\n==18061== Reachable blocks (those to which a pointer was found) are not shown.\n==18061== To see them, rerun with: --leak-check=full --show-leak-kinds=all\n==18061== \n==18061== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n==18061== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Adding <code>CRYPTO_cleanup_all_ex_data();</code> at the end of the program makes Valgring happy :-)</p>\n\n<pre><code>==18212== HEAP SUMMARY:\n==18212==     in use at exit: 0 bytes in 0 blocks\n==18212==   total heap usage: 457 allocs, 457 frees, 31,748 bytes allocated\n==18212== \n==18212== All heap blocks were freed -- no leaks are possible\n==18212== \n==18212== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n==18212== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>See: <a href=\"https://stackoverflow.com/a/21533000/6267288\">https://stackoverflow.com/a/21533000/6267288</a></p>\n"}], "owner": {"reputation": 335, "user_id": 2255802, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a5ebe83e1bd2d9942dda944c5aa004bf?s=128&d=identicon&r=PG", "display_name": "Yu-Chih", "link": "https://stackoverflow.com/users/2255802/yu-chih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2525, "favorite_count": 0, "accepted_answer_id": 44279263, "answer_count": 1, "score": 2, "last_activity_date": 1577046186, "creation_date": 1496209131, "last_edit_date": 1496213365, "question_id": 44276494, "link": "https://stackoverflow.com/questions/44276494/rsa-new-and-rsa-generate-key-ex-make-memory-leakage", "title": "RSA_new and RSA_generate_key_ex make memory leakage", "body": "<p>I am developing an app which needs an RSA key to encrypt certain user data. I use openssl and everything works fine. However, the app keeps alarming a memory leakage at RSA_new and RSA_generate_key_ex (which I thought it should not be because I release all the properties created by me).</p>\n\n<p>Here is my code to generate the RSA key:</p>\n\n<pre><code>BIGNUM e;\nBN_init(&amp;e);\nBN_set_word(&amp;e, 17);\nRSA *rsa = RSA_new(); // Direct leak of 191 bytes in 1 object (RSA_new-&gt;RSA_new_method-&gt;...)\nRAS_generate_key_ex(rsa, 1024, &amp;e, NULL); // Indirect leak of 279 bytes in 1 object (RAS_generate_key_ex-&gt;rsa_builtin_keygen...)\nEVP_PKEY pkey = EVP_PKEY_new();\nEVP_PKEY_set1_RSA(pkey, rsa);\nRSA_free(rsa);\nBN_free(&amp;e);\nMINE_COPY_KEY(pkey); // I copy the pkey to other location at here //\nEVP_PKEY_free(pkey);\n</code></pre>\n\n<p>I thought everything allocated by me (e, pkey, rsa) is already released by \"RSA_free, EVP_PKEY_free, and BN_free\" but it still have complain on memory leakage in my Linux x64 machine</p>\n"}, {"tags": ["c", "gcc", "makefile"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496209596, "post_id": 44276419, "comment_id": 75560277, "body": "Run <code>make -j2 bootstrap</code> and don&#39;t interrupt/kill the process.  This builds the compiler in three stages \u2014 the first uses the bootstrap compiler to build GCC; the second uses the GCC that was just built to build GCC again; the third builds GCC yet again, making sure that the result is the same.  On a MacBook Pro (15&quot;, 2016), I use <code>make -j8 bootstrap</code> and the entire process (3 phases) took just over an hour.  That&#39;s with SSD rather than spinning disks.  It shouldn&#39;t take all day unless you&#39;ve got a very antiquated machine.  Can you afford to use <code>-j4</code> or <code>-j8</code>?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496209852, "post_id": 44276419, "comment_id": 75560376, "body": "Also note the <a href=\"https://gcc.gnu.org/install/configure.html\" rel=\"nofollow noreferrer\">install instructions</a>: <i>First, we highly recommend that GCC be built into a separate directory from the sources which does not reside within the source tree. This is how we generally build GCC; building where srcdir == objdir should still work, but doesn\u2019t get extensive testing; building where objdir is a subdirectory of srcdir is unsupported.</i>  You are building with <i>objdir</i> as a subdirectory of <i>srcdir</i> \u2014 according to the docs, your build is unsupported."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496209898, "post_id": 44276419, "comment_id": 75560395, "body": "With the source in <code>\u2026&#47;gcc-7.1.0</code>, I create <code>\u2026&#47;gcc-7.1.0-obj</code>, then use <code>cd \u2026&#47;gcc-7.1.0-obj; ..&#47;gcc-7.1.0&#47;configure \u2026</code> and <code>make -j8 bootstrap</code>."}, {"owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496211430, "post_id": 44276419, "comment_id": 75561175, "body": "@JonathanLeffler I have 2 cores - stable at 2400 Mhz kept currently at around +44.0 C degree Celsius and I feel the full process is taking too long. But whatever you said that on some MacBook is taking over an hour so my definition of long I guess is not relevant in the case. Thanks for the extensive info though."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496212040, "post_id": 44276419, "comment_id": 75561480, "body": "My machine has <i>Processor Name:\tIntel Core i7   Processor Speed:\t2.7 GHz   Number of Processors:\t1   Total Number of Cores:\t4   L2 Cache (per Core):\t256 KB   L3 Cache:\t8 MB   Memory:\t16 GB</i>  I&#39;d guess you should look for it to take a couple of hours \u2014 4 tops \u2014 unless you have very slow disks.  (If you have very little spare disk space, that could be a factor.  IIRC, the full build, source plus object, takes a couple of GiB, though 7.1.0 is smaller than 6.3.0 because it doesn&#39;t have the Java compiler any more.)"}], "answers": [{"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 2, "last_activity_date": 1496328109, "last_edit_date": 1496328109, "creation_date": 1496327645, "answer_id": 44310405, "question_id": 44276419, "link": "https://stackoverflow.com/questions/44276419/what-is-gcc-make-process-doing/44310405#44310405", "title": "What is gcc make process doing?", "body": "<p>If you want to disable the normal gcc 3-stage bootstrapping process (rebuilding the compiler with itself to test things), use <code>--disable-bootstrap</code> as an option to configure.  This will configure the Makefile to just build gcc once.</p>\n\n<p>As for what the default (bootstrap) process is doing:</p>\n\n<ul>\n<li>compile gcc with the system compiler to create the \"stage1\" compiler</li>\n<li>recompile everything with the stage1 compiler to produce the stage2 compiler</li>\n<li>recompile everything with the stage2 compiler to produce the stage3 compiler</li>\n<li>compares the stage2 and stage3 compiler (binaries) to ensure that they are identical.</li>\n</ul>\n\n<p>If that last check fails, then something went wrong with the build process.</p>\n"}], "owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496328109, "creation_date": 1496208783, "question_id": 44276419, "link": "https://stackoverflow.com/questions/44276419/what-is-gcc-make-process-doing", "title": "What is gcc make process doing?", "body": "<p>So I I've downloaded gcc-7.1.0 source archive from the gcc ftp server and I've configured it like this:</p>\n\n<pre><code>../configure --enable-languages=c --disable-multilib\n</code></pre>\n\n<p>As the sub-directory is where I've extracted the source. The current directory is named 'objdir'.</p>\n\n<p>Now if I run <code>make -j 2</code> after like 5 mins initially and now for like 1 ~ 2 when I only modify single source file in the project - the <code>CC1</code> which is essentially what we are compiling is created/updated in <code>objdir/gcc</code> with about 110MB in total size - a totally working driver which I can use/debug etc. But then after like 3 or 4 seconds this files is moved into <code>objdir/prev-gcc</code> and then I've waited no more than lets say 20min.</p>\n\n<p>I think I'll continue killing the make process after the <code>prev-gcc</code> directory is created and work with what's there but I'm wondering what is the reason for this quirk. Like what is the reason for the make process to move the totally working compiled binaries to <code>objdir/prev-gcc</code> and then continue doing something seemingly very (I remember waiting whole day to complete once) long or am I missing something obvious here.</p>\n"}, {"tags": ["c", "arm", "raspberry-pi2"], "comments": [{"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 3, "creation_date": 1496205066, "post_id": 44275519, "comment_id": 75558572, "body": "You should be able to compile C code for whatever platform you want. What are these files and what&#39;s the problem you&#39;re having?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 2, "creation_date": 1496205778, "post_id": 44275519, "comment_id": 75558806, "body": "You need a compiler, in this case a cross compiler for the ARM platform. Maybe you can try clang. It comes with the ARM target. The assembly can be generated using the <code>-S</code> flag with the clang compiler."}, {"owner": {"reputation": 1, "user_id": 8023516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a3175e7506917c6cd3e54bc35bfbd0?s=128&d=identicon&r=PG&f=1", "display_name": "Roy.L", "link": "https://stackoverflow.com/users/8023516/roy-l"}, "reply_to_user": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 0, "creation_date": 1496212153, "post_id": 44275519, "comment_id": 75561547, "body": "@CarlNorum I am trying to setup a memory reader software in c using Raspberry Pi2, however the binaries and platform are different"}, {"owner": {"reputation": 1, "user_id": 8023516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a3175e7506917c6cd3e54bc35bfbd0?s=128&d=identicon&r=PG&f=1", "display_name": "Roy.L", "link": "https://stackoverflow.com/users/8023516/roy-l"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1496212157, "post_id": 44275519, "comment_id": 75561553, "body": "@AjayBrahmakshatriya I have installed the gnu, gcc, libc and binutils compilers using Raspbian terminal, are that appropriate enough to cross compile? I have encountered some errors during cross-compiling stages"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1496212270, "post_id": 44275519, "comment_id": 75561605, "body": "You need not compile the code on your Raspberry. You can compile it on your desktop with appropriate target and then move the files to the Rasp."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 1, "creation_date": 1496216488, "post_id": 44275519, "comment_id": 75564168, "body": "Not that if your code makes much use of the API calls etc in &#39;#include &quot;windows.h&quot; &#39;, then you may have a considerable task in front of you;("}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1496225618, "post_id": 44275519, "comment_id": 75570501, "body": "yes if you have setup gcc, etc on raspian then you are ready to go, it is not a cross compiler at that point it is a native compiler and works even better."}, {"owner": {"reputation": 1, "user_id": 8023516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a3175e7506917c6cd3e54bc35bfbd0?s=128&d=identicon&r=PG&f=1", "display_name": "Roy.L", "link": "https://stackoverflow.com/users/8023516/roy-l"}, "edited": false, "score": 0, "creation_date": 1496307352, "post_id": 44275519, "comment_id": 75611026, "body": "How do i actually change the API of &quot;include #windows.h&quot; in my .c file to the appropriate one to be use for Pi? Any guides or suggestions?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8023516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a3175e7506917c6cd3e54bc35bfbd0?s=128&d=identicon&r=PG&f=1", "display_name": "Roy.L", "link": "https://stackoverflow.com/users/8023516/roy-l"}, "edited": false, "score": 0, "creation_date": 1497334976, "post_id": 44339540, "comment_id": 76019986, "body": "Thanks will try it out!"}, {"owner": {"reputation": 1, "user_id": 8023516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a3175e7506917c6cd3e54bc35bfbd0?s=128&d=identicon&r=PG&f=1", "display_name": "Roy.L", "link": "https://stackoverflow.com/users/8023516/roy-l"}, "edited": false, "score": 0, "creation_date": 1497343457, "post_id": 44339540, "comment_id": 76025092, "body": "when i input gcc -S &quot;scanAdd.c -o scanAdd.s&quot; with error:  scanAdd.c:1:21: fatal error: windows.h: No such file or directory #include &lt;windows.h&gt;                                   ^ compilation terminated.  Why is this error occurring again? hmm"}], "tags": [], "owner": {"reputation": 5185, "user_id": 6202327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AFtrB.png?s=128&g=1", "display_name": "Makogan", "link": "https://stackoverflow.com/users/6202327/makogan"}, "is_accepted": false, "score": 1, "last_activity_date": 1496455265, "creation_date": 1496455265, "answer_id": 44339540, "question_id": 44275519, "link": "https://stackoverflow.com/questions/44275519/converting-c-source-to-arm-assembly/44339540#44339540", "title": "Converting C source to ARM assembly", "body": "<p>Any c compiler can generate assembly code from C code, if your objective is specifically to generate assembly code for arm then you'll need a cross compiler such as the <a href=\"https://developer.arm.com/open-source/gnu-toolchain/gnu-rm\" rel=\"nofollow noreferrer\">GNU arm embedded toolchain</a>.</p>\n\n<p>For gcc on particular you just need to use the <code>-S</code> option when compiling, so the line looks something like:</p>\n\n<pre><code>gcc -S -source.c -o output.s\n</code></pre>\n\n<p>Of course you'll need to include any headers and include directories for it to compile.</p>\n\n<p>if you simply want to cross compile it, then simply do the full compilation assemblage and linking process. Depending on how low level the c code is it's actually possible for it not to work on the pi 2 (but it will compile)</p>\n"}], "owner": {"reputation": 1, "user_id": 8023516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a3175e7506917c6cd3e54bc35bfbd0?s=128&d=identicon&r=PG&f=1", "display_name": "Roy.L", "link": "https://stackoverflow.com/users/8023516/roy-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8210, "favorite_count": 2, "answer_count": 1, "score": -3, "last_activity_date": 1496455265, "creation_date": 1496204032, "question_id": 44275519, "link": "https://stackoverflow.com/questions/44275519/converting-c-source-to-arm-assembly", "title": "Converting C source to ARM assembly", "body": "<p>I am trying to convert .c files for ARM (ARMv7l for Raspberry Pi2) but I could not find any online converter or understand how it works. Previously these .c files were executable in Windows platform and thus unable to execute on Pi's arm architecture. Does anybody can assist me in this?</p>\n"}, {"tags": ["c", "gcc", "sublimetext3", "sublimetext"], "comments": [{"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 1, "creation_date": 1496204509, "post_id": 44275399, "comment_id": 75558406, "body": "What does the actual command look like and what error message do you get?"}, {"owner": {"reputation": 41, "user_id": 2276520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d770a9561d9924cb8174c6f91c349864?s=128&d=identicon&r=PG", "display_name": "user2276520", "link": "https://stackoverflow.com/users/2276520/user2276520"}, "reply_to_user": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1496217975, "post_id": 44275399, "comment_id": 75565104, "body": "Thanks, I had added the error message with pictures."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1496222023, "post_id": 44275399, "comment_id": 75567805, "body": "If you look at <code>shell_cmd</code> in the second screen shot there is no Include option. Why it isn&#39;t picked up I can&#39;t tell."}, {"owner": {"reputation": 41, "user_id": 2276520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d770a9561d9924cb8174c6f91c349864?s=128&d=identicon&r=PG", "display_name": "user2276520", "link": "https://stackoverflow.com/users/2276520/user2276520"}, "reply_to_user": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1496375337, "post_id": 44275399, "comment_id": 75646029, "body": "Thanks.  I gave up and switch to use Dev++ and CodeLite."}], "owner": {"reputation": 41, "user_id": 2276520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d770a9561d9924cb8174c6f91c349864?s=128&d=identicon&r=PG", "display_name": "user2276520", "link": "https://stackoverflow.com/users/2276520/user2276520"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 377, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496217841, "creation_date": 1496203283, "last_edit_date": 1496217841, "question_id": 44275399, "link": "https://stackoverflow.com/questions/44275399/how-to-add-extra-include-lib-path-to-sublime-to-compile-pure-c-with-gcc", "title": "How to add extra include/lib path to Sublime (to compile pure C with gcc)", "body": "<p>I mananged to add sublime-build as follows:</p>\n\n<pre><code>{\n\"cmd\": [\"gcc -Wall ${file} -o ./bin/${file_base_name} -I${file_path}/lib &amp;&amp; ./bin/${file_base_name}\"],\n\"selector\": \"source.c\",\n\"working_dir\": \"${file_path}\",\n\"shell\": true,\n\n\n\"variants\": [\n    {\n        \"name\": \"Run\",\n        \"cmd\": [\"gcc -Wall ${file} -o ./bin/${file_base_name} -I${file_path}/lib &amp;&amp; open ./bin/${file_base_name}\"],\n        \"working_dir\": \"${file_path}\",\n        \"shell\": true\n\n    }\n ]\n\n}\n</code></pre>\n\n<p>But I failed to add extra include and libraries path to this \"New Build System\".  Please help me, many thanks!</p>\n\n<p>If I test with simple C file, it is okay so other issues can be eliminated:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fhAo9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fhAo9.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I want to add extra \"include\", I get \"fatal error: pcap.h: No such file or directory\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/mPW8e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mPW8e.png\" alt=\"enter image description here\"></a></p>\n\n<p>...even though I had added this extra \"include\" path to system environment path and the file in question has been there, as you can see from the pictures.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NxuGU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NxuGU.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "swift", "swizzle"], "comments": [{"owner": {"reputation": 3080, "user_id": 5546312, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/TT1Ho.jpg?s=128&g=1", "display_name": "D4ttatraya", "link": "https://stackoverflow.com/users/5546312/d4ttatraya"}, "edited": false, "score": 0, "creation_date": 1496246042, "post_id": 44275397, "comment_id": 75585467, "body": "Look at this <a href=\"https://stackoverflow.com/a/39562888/5546312\">SO post answer</a>"}, {"owner": {"reputation": 31, "user_id": 7824787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eea8024b09ef36e29e7bf4fdd54668a?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Kay", "link": "https://stackoverflow.com/users/7824787/y-kay"}, "reply_to_user": {"reputation": 3080, "user_id": 5546312, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/TT1Ho.jpg?s=128&g=1", "display_name": "D4ttatraya", "link": "https://stackoverflow.com/users/5546312/d4ttatraya"}, "edited": false, "score": 0, "creation_date": 1496279610, "post_id": 44275397, "comment_id": 75599947, "body": "Most of results online in not required. I wanner insert some code before system method, not exchange simply. And the main trouble is how to use the IMP I am holding to perform a method"}], "owner": {"reputation": 31, "user_id": 7824787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eea8024b09ef36e29e7bf4fdd54668a?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Kay", "link": "https://stackoverflow.com/users/7824787/y-kay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496246506, "creation_date": 1496203255, "last_edit_date": 1496246506, "question_id": 44275397, "link": "https://stackoverflow.com/questions/44275397/how-to-insert-a-custom-method-when-a-system-method-call", "title": "How to insert a custom method when a system method call?", "body": "<p>I'm translating an Objective-C project to Swift.</p>\n\n<p>I want to perform custom method when a system method is calling.</p>\n\n<p>Code in Objective-C: He used a C-Type method, swizzling method. perform custom method and continue running system method:</p>\n\n<pre><code>void dzn_original_implementation(id self, SEL _cmd)\n{\n    // Fetch original implementation from lookup table\n    Class baseClass = dzn_baseClassToSwizzleForTarget(self);\n    NSString *key = dzn_implementationKey(baseClass, _cmd);\n\n    NSDictionary *swizzleInfo = [_impLookupTable objectForKey:key];\n    NSValue *impValue = [swizzleInfo valueForKey:DZNSwizzleInfoPointerKey];\n\n    IMP impPointer = [impValue pointerValue];\n\n    // We then inject the additional implementation for reloading the empty\n    // dataset\n    // Doing it before calling the original implementation does update the\n    // 'isEmptyDataSetVisible' flag on time.\n    [self dzn_reloadEmptyDataSet];\n\n    // If found, call original implementation\n    if (impPointer) {\n        ((void(*)(id,SEL))impPointer)(self,_cmd);\n    }\n}\n</code></pre>\n\n<p>What should I do in Swift? How to perform method form it's IMP?</p>\n\n<blockquote>\n  <p>And this func isn't prepared for reloadData() only, but endUpdate() either!</p>\n</blockquote>\n"}, {"tags": ["c", "arrays", "sum"], "comments": [{"owner": {"reputation": 626, "user_id": 4690576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a328eeb1bb069c34be414a5e7bcda10?s=128&d=identicon&r=PG", "display_name": "AmeyaVS", "link": "https://stackoverflow.com/users/4690576/ameyavs"}, "edited": false, "score": 4, "creation_date": 1496202439, "post_id": 44275216, "comment_id": 75557890, "body": "Why do you need a scanf for the result array? (&quot;scanf(&quot;%d&quot;, &amp;v3[i]);&quot;)"}, {"owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "reply_to_user": {"reputation": 626, "user_id": 4690576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a328eeb1bb069c34be414a5e7bcda10?s=128&d=identicon&r=PG", "display_name": "AmeyaVS", "link": "https://stackoverflow.com/users/4690576/ameyavs"}, "edited": false, "score": 0, "creation_date": 1496202620, "post_id": 44275216, "comment_id": 75557936, "body": "I just wanted to show the result for the user. But as I am new to C, I am newbie to this stuff."}, {"owner": {"reputation": 626, "user_id": 4690576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a328eeb1bb069c34be414a5e7bcda10?s=128&d=identicon&r=PG", "display_name": "AmeyaVS", "link": "https://stackoverflow.com/users/4690576/ameyavs"}, "edited": false, "score": 0, "creation_date": 1496202957, "post_id": 44275216, "comment_id": 75558019, "body": "Read the answers more carefully."}, {"owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "reply_to_user": {"reputation": 626, "user_id": 4690576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a328eeb1bb069c34be414a5e7bcda10?s=128&d=identicon&r=PG", "display_name": "AmeyaVS", "link": "https://stackoverflow.com/users/4690576/ameyavs"}, "edited": false, "score": 0, "creation_date": 1496203060, "post_id": 44275216, "comment_id": 75558046, "body": "The final result continue being the same as from the old code, I don&#39;t know what is happening. Even if I put the printf out of the for or inside and with the modifications that the answers said, it&#39;s the same result."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1496205164, "post_id": 44275216, "comment_id": 75558602, "body": "Your main problem here is that you either compiled your program with no warnings enabled or that you ignored the warning(s)."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1496208574, "post_id": 44275216, "comment_id": 75559871, "body": "So if the input is <code>1 2 3 4 5 6</code>, you want the output <code>5 7 9</code> ?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496240135, "post_id": 44275216, "comment_id": 75581113, "body": "Please note that there really wasn&#39;t a need for the screen shot.  You should have copied and pasted the text in the screen shot directly into the question, indented as &#39;code&#39; (select it and use the <b><code>{}</code></b> button above the edit window to indent it), and possibly add <code>&lt;!-- language: lang-none --&gt;</code> above it on an unindented line of its own with a blank line above and below."}, {"owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1496266712, "post_id": 44275216, "comment_id": 75596431, "body": "@4386427 Exactly, is what I want."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "edited": false, "score": 0, "creation_date": 1496203281, "post_id": 44275242, "comment_id": 75558110, "body": "It does not work the same way, because the end result does not have the actual sum of the two vectors."}], "tags": [], "owner": {"reputation": 2860, "user_id": 5410835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PCfZO.jpg?s=128&g=1", "display_name": "Douglas Daseeco", "link": "https://stackoverflow.com/users/5410835/douglas-daseeco"}, "is_accepted": false, "score": 0, "last_activity_date": 1496202188, "creation_date": 1496202188, "answer_id": 44275242, "question_id": 44275216, "link": "https://stackoverflow.com/questions/44275216/how-to-sum-two-arrays-in-another-array-in-c/44275242#44275242", "title": "How to sum two arrays in another array in C?", "body": "<p>Delete the third scanf and you don't want the ampersand before the v3 in the printf.</p>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 8023038, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e6de43018420da4f54a0632ae66e4469?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8023038/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1496202303, "creation_date": 1496202303, "answer_id": 44275255, "question_id": 44275216, "link": "https://stackoverflow.com/questions/44275216/how-to-sum-two-arrays-in-another-array-in-c/44275255#44275255", "title": "How to sum two arrays in another array in C?", "body": "<p>First, initialize your array so you won't have a garbage.</p>\n\n<pre><code>`int v1[3] = {0,0,0}, v2[3] = {0,0,0}, v3[3] = {0,0,0};`\n</code></pre>\n\n<p>in adding both arrays, </p>\n\n<pre><code>for(int i = 0; i &lt; 3; i++){\n    v3[i] = v1[i] + v2[i];\n    printf(\"total: %d\", v3[i]);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "edited": false, "score": 0, "creation_date": 1496202839, "post_id": 44275260, "comment_id": 75557993, "body": "Is still showing  Total : 6487568. Even after I removed the scanf, why is that happening ? If I let &amp;v3[i] he just show that, and If I remove, he shows the Total as 2."}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "reply_to_user": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "edited": false, "score": 0, "creation_date": 1496202952, "post_id": 44275260, "comment_id": 75558017, "body": "You need to remove &amp; from printf as well"}, {"owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "edited": false, "score": 0, "creation_date": 1496203251, "post_id": 44275260, "comment_id": 75558103, "body": "It does not work the same way, because the end result does not have the actual sum of the two vectors."}], "tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": false, "score": 0, "last_activity_date": 1496202315, "creation_date": 1496202315, "answer_id": 44275260, "question_id": 44275216, "link": "https://stackoverflow.com/questions/44275216/how-to-sum-two-arrays-in-another-array-in-c/44275260#44275260", "title": "How to sum two arrays in another array in C?", "body": "<p>If you want to store result in v3, you need to remove <code>scanf(\"%d\", &amp;v3[i]);</code> from last loop</p>\n\n<p>You need to change </p>\n\n<pre><code>printf(\"Total : %d \", &amp;v3[i]);//you are passing address here, where printf expects value\n</code></pre>\n\n<p>to </p>\n\n<pre><code>printf(\"Total : %d \", v3[i]);\n</code></pre>\n\n<p>Also you should add a space before %d in each scanf so that it takes care of enter hit from previous input\neg</p>\n\n<pre><code>scanf(\" %d\", &amp;v1[i]);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "edited": false, "score": 0, "creation_date": 1496203274, "post_id": 44275261, "comment_id": 75558108, "body": "It does not work the same way, because the end result does not have the actual sum of the two vectors."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "edited": false, "score": 1, "creation_date": 1496208930, "post_id": 44275261, "comment_id": 75560004, "body": "@Novatec: your code didn&#39;t show that calculation, nor did the question mention it.  Changing the rules isn&#39;t fair \u2014 in extreme cases, the question becomes a &#39;chameleon question&#39;, and they&#39;re bad."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496208964, "post_id": 44275261, "comment_id": 75560018, "body": "Arguably, the code should check the return value from each of the surviving <code>scanf()</code> calls.  But your basic diagnosis is correct."}, {"owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496239881, "post_id": 44275261, "comment_id": 75580925, "body": "@JonathanLeffler I am sorry for what I did here, your code too works, thanks for helping me. I am new to C, so for me, the third scanf would read the third array and would work, but as it seems, it don&#39;t. Again, thanks for the help."}], "tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 2, "last_activity_date": 1496206657, "last_edit_date": 1496206657, "creation_date": 1496202325, "answer_id": 44275261, "question_id": 44275216, "link": "https://stackoverflow.com/questions/44275216/how-to-sum-two-arrays-in-another-array-in-c/44275261#44275261", "title": "How to sum two arrays in another array in C?", "body": "<p>What is the purpose of scanf inside the third for loop?</p>\n\n<p>I think remove <code>scanf</code> inside third for loop:</p>\n\n<pre><code> scanf(\"%d\", &amp;v3[i]);\n</code></pre>\n\n<p>Also, remove <code>&amp;</code> in printf:</p>\n\n<pre><code>printf(\"Total : %d \", v3[i]);\n</code></pre>\n\n<p><strong>Full code:</strong> This code working fine on <strong>GCC</strong> compiler.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n        int v1[3],v2[3],v3[3], i;\n\n        for(i  = 0 ; i &lt; 3; i++)\n        {\n                printf(\"Type a number : \\n\");\n                scanf(\"%d\", &amp;v1[i]);\n        }\n\n        for(i  = 0 ; i &lt; 3; i++)\n        {\n                printf(\"Type a number : \\n\");\n                scanf(\"%d\", &amp;v2[i]);\n        }\n\n        for(i  = 0 ; i &lt; 3; i++)\n        {\n                v3[i] = v1[i] + v2[i];\n\n                printf(\"Total : %d\\n\", v3[i]);\n        }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "edited": false, "score": 0, "creation_date": 1496203254, "post_id": 44275280, "comment_id": 75558104, "body": "It does not work the same way, because the end result does not have the actual sum of the two vectors."}], "tags": [], "owner": {"reputation": 21, "user_id": 8088034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bec78941154fa73632e18076c7a038d0?s=128&d=identicon&r=PG", "display_name": "Meet Parekh", "link": "https://stackoverflow.com/users/8088034/meet-parekh"}, "is_accepted": false, "score": 0, "last_activity_date": 1496202440, "creation_date": 1496202440, "answer_id": 44275280, "question_id": 44275216, "link": "https://stackoverflow.com/questions/44275216/how-to-sum-two-arrays-in-another-array-in-c/44275280#44275280", "title": "How to sum two arrays in another array in C?", "body": "<p>It is because you added a scanf function in the last for loop which does the summation.\nSo if you just remove that scanf line it will work great.\nOld code:</p>\n\n<pre><code>int v1[3],v2[3],v3[3]; for(int i = 0 ; i &lt; 3; i++) { printf(\"Type a  number : \\n\"); scanf(\"%d\", &amp;v1[i]); } for(int i = 0 ; i &lt; 3; i++) {  printf(\"Type a number : \\n\"); scanf(\"%d\", &amp;v2[i]); } for(int i = 0 ; i &lt; 3; i++) { v3[i] = v1[i] + v2[i]; scanf(\"%d\", &amp;v3[i]);    printf(\"Total : %d \", &amp;v3[i]); }\n</code></pre>\n\n<p>New code should be</p>\n\n<pre><code>int v1[3],v2[3],v3[3]; for(int i = 0 ; i &lt; 3; i++) { printf(\"Type a number : \\n\"); scanf(\"%d\", &amp;v1[i]); } for(int i = 0 ; i &lt; 3; i++) { printf(\"Type a number : \\n\"); scanf(\"%d\", &amp;v2[i]); } for(int i = 0 ; i &lt; 3; i++) { v3[i] = v1[i] + v2[i];  printf(\"Total : %d \", &amp;v3[i]); }\n</code></pre>\n\n<p>That should do it.</p>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "edited": false, "score": 0, "creation_date": 1496239656, "post_id": 44275582, "comment_id": 75580750, "body": "It worked the code, thanks. But as I am new to C, I don&#39;t know what that /t means. Could you explain to me, please ?"}, {"owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "edited": false, "score": 0, "creation_date": 1496240011, "post_id": 44275582, "comment_id": 75581030, "body": "And what this (int argc, char** argv) will do ? Sorry for the newbie question."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1496240284, "post_id": 44275582, "comment_id": 75581234, "body": "The <code>int main(int argc, char **argv)</code> is the form for the <code>main()</code> function when you use command line arguments.  This code doesn&#39;t use command line arguments; the main function should be defined using <code>int main(void)</code> to indicate that it is ignoring any command line arguments.  The <code>\\t</code> (note the backslash, not forward slash <code>&#47;t</code>) is a tab.  That&#39;s covered in any basic book on C."}, {"owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496266767, "post_id": 44275582, "comment_id": 75596456, "body": "@JonathanLeffler Thanks for explaning to me, I started to learn C almost 3 months ago, so a lot of things are new to me."}], "tags": [], "owner": {"reputation": 181, "user_id": 5830837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfef22d268d33c2a31fbfd4e95f135?s=128&d=identicon&r=PG&f=1", "display_name": "Shuvam", "link": "https://stackoverflow.com/users/5830837/shuvam"}, "is_accepted": true, "score": 2, "last_activity_date": 1496204438, "creation_date": 1496204438, "answer_id": 44275582, "question_id": 44275216, "link": "https://stackoverflow.com/questions/44275216/how-to-sum-two-arrays-in-another-array-in-c/44275582#44275582", "title": "How to sum two arrays in another array in C?", "body": "<p>What do you exactly want? Summation of each element from two arrays into a new third array? That's it right?</p>\n\n<pre><code>int main(int argc, char** argv) {\n    int v1[3],v2[3],v3[3];\n\n    for(int i  = 0 ; i &lt; 3; i++) {\n      printf(\"Type a number for v1 :\\t\");\n      scanf(\"%d\", &amp;v1[i]);\n\n      printf(\"Type a number for v2 :\\t\");\n      scanf(\"%d\", &amp;v2[i]);\n      // Add here\n      v3[i] = v1[i] + v2[i]; // Mind you that this could lead to integer overflow.\n  }\n\n  printf(\"\\nResult Arr :\\n\");\n  for(int i  = 0 ; i &lt; 3; i++)\n    printf(\"%d\\n\", v3[i]);\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 5281077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/792639344168648/picture?type=large", "display_name": "Leandro Mont", "link": "https://stackoverflow.com/users/5281077/leandro-mont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16809, "favorite_count": 0, "accepted_answer_id": 44275582, "answer_count": 6, "score": 0, "last_activity_date": 1496206657, "creation_date": 1496201985, "question_id": 44275216, "link": "https://stackoverflow.com/questions/44275216/how-to-sum-two-arrays-in-another-array-in-c", "title": "How to sum two arrays in another array in C?", "body": "<p>I want to try to get two arrays and sum them to another array, but it just doens't work, and I don't know why.</p>\n\n<p><strong>My code :</strong> </p>\n\n<pre><code>int v1[3],v2[3],v3[3];\n\nfor(int i  = 0 ; i &lt; 3; i++) {\n    printf(\"Type a number : \\n\");\n    scanf(\"%d\", &amp;v1[i]);\n}\n\nfor(int i  = 0 ; i &lt; 3; i++) {\n    printf(\"Type a number : \\n\");\n    scanf(\"%d\", &amp;v2[i]);\n}\n\nfor(int i  = 0 ; i &lt; 3; i++) {\n v3[i] = v1[i] + v2[i];\n scanf(\"%d\", &amp;v3[i]);\n\n printf(\"Total : %d \", &amp;v3[i]);\n}\n</code></pre>\n\n<p>And when I get to type all the 6 numbers, he just don't show Total, and I have to type more to go to exit screen.</p>\n\n<p><strong>Screenshot :</strong> </p>\n\n<p><a href=\"https://i.stack.imgur.com/paCF5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/paCF5.png\" alt=\"\"></a></p>\n"}, {"tags": ["c", "sockets", "endianness"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496210769, "post_id": 44274977, "comment_id": 75560854, "body": "(( I advice you to read about <a href=\"http://man7.org/linux/man-pages/man3/getaddrinfo.3.html\" rel=\"nofollow noreferrer\"><code>getaddrinfo()</code></a> to write more modern C ))"}], "answers": [{"comments": [{"owner": {"reputation": 3787, "user_id": 5437543, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ad76496c936d384dac2888bae0126dde?s=128&d=identicon&r=PG&f=1", "display_name": "StoneThrow", "link": "https://stackoverflow.com/users/5437543/stonethrow"}, "edited": false, "score": 0, "creation_date": 1496212824, "post_id": 44275564, "comment_id": 75561898, "body": "Ah: I misunderstood <code>hton[sl]</code> and <code>ntoh[sl]</code>: I thought they <i>guaranteed</i> the output was network or host byte ordered, respectively. But when I think about it, that&#39;d be impossible to implement, so the only thing those functions can do is make an architecture-dependent decision whether to be a no-op or a byteswap."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1496221814, "post_id": 44275564, "comment_id": 75567654, "body": "UNIX sockets are in no way replaceable by named pipes. First of all, with one named pipe there can be only one named connection. And AFAIK you cannot send ancillary data (file descriptors) over named pipes."}], "tags": [], "owner": {"reputation": 23625, "user_id": 2868801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec5567811049b7ce8192be0bc0246d1?s=128&d=identicon&r=PG&f=1", "display_name": "dave_thompson_085", "link": "https://stackoverflow.com/users/2868801/dave-thompson-085"}, "is_accepted": true, "score": 5, "last_activity_date": 1496204326, "creation_date": 1496204326, "answer_id": 44275564, "question_id": 44274977, "link": "https://stackoverflow.com/questions/44274977/struct-sockaddr-in-member-byte-order-for-bind/44275564#44275564", "title": "struct sockaddr_in member byte order for bind()", "body": "<blockquote>\n  <p>Why is ntohs() used on adr_inet.sin_port in the first instance, but htons() in the second?</p>\n</blockquote>\n\n<p>The first is a mistake, but in practice works anyway. </p>\n\n<p>Nowadays practically all machines use 8-bit bytes and either consistent big-endian or consistent little-endian formats. On the former both <code>hton[sl]</code> and <code>ntoh[sl]</code> are no-ops; on the latter <em>both</em> reverse the byte order, and thus actually do the same thing even though their intended semantics are different. Thus using the wrong one still works on all systems you're likely to run a program on.</p>\n\n<p>Back when the socket API was designed this wasn't always the case; for example the then-popular PDP-11 somewhat infamously used <a href=\"http://catb.org/jargon/html/M/middle-endian.html\" rel=\"noreferrer\">'middle-endian'</a> (!) aka 'NUXI' order for 32-bit.</p>\n\n<blockquote>\n  <p>Why is neither ntohs() nor htons() used on adr_inet.sin_family?</p>\n</blockquote>\n\n<p>Again in ancient times the Internet Protocol stack was only one of several (up to a dozen or so) competing network technologies. The <code>family</code> field distinguishes different types of <code>sockaddr_*</code> structures for these different protocols, which did not all follow the Internet 'rule' for big-endian, at least not consistently. As there was no universal network representation for <code>family</code> they just left it in host order -- which is usually more convenient for host software.</p>\n\n<p>Nowadays in practice nobody uses any families but INET, INET6, and sometimes UNIX -- and the latter can be replaced by using named pipes in the filesystem which is usually at least as good.</p>\n"}, {"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1496210814, "post_id": 44276832, "comment_id": 75560873, "body": "Even on a system with 64-bit <code>unsigned long</code>, if you only use the bottom 32 bits, storing to or from a <code>uint32_t</code> will work.  At worst, you might get a warning about a narrowing implicit conversion."}, {"owner": {"reputation": 112, "user_id": 5369639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb78c4138601ea97d574c3ee60446996?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Plemmons", "link": "https://stackoverflow.com/users/5369639/matthew-plemmons"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1496221329, "post_id": 44276832, "comment_id": 75567305, "body": "Yeah, you&#39;re exactly right.  I should have been more clear about that in my post.  Still, the use of those datatypes might be considered a little out of date in this context.  Or &quot;short-sighted&quot; as the author wrote in that comment above the newer conversion prototypes."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1496254743, "post_id": 44276832, "comment_id": 75590481, "body": "Yes. The historical Unix API created a lot of problems by assuming that <code>unsigned long</code> was the right length to hold a pointer, a file offset, the number of seconds since 1970, etc.\u2014and also that it was exactly 32 bits long. These days, most compilers let you choose which one of those assumptions should be correct and POSIX guarantees that there is a compiler flag to make <code>long</code> wide enough to hold any of those types. But it\u2019s better to use the type you really mean."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1497806954, "post_id": 44276832, "comment_id": 76221307, "body": "Oh, side note for anyone who comes by later: to get the modern definitions, set a feature-test macro before including the system headers, such as <code>_XOPEN_SOURCE</code> and/or <code>_POSIX_C_SOURCE</code> on POSIX/Linux/glibc, or <code>_WIN32_WINNT</code> on Windows.  These change which declarations are active in the header files."}], "tags": [], "owner": {"reputation": 112, "user_id": 5369639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb78c4138601ea97d574c3ee60446996?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Plemmons", "link": "https://stackoverflow.com/users/5369639/matthew-plemmons"}, "is_accepted": false, "score": 1, "last_activity_date": 1496210569, "creation_date": 1496210569, "answer_id": 44276832, "question_id": 44274977, "link": "https://stackoverflow.com/questions/44274977/struct-sockaddr-in-member-byte-order-for-bind/44276832#44276832", "title": "struct sockaddr_in member byte order for bind()", "body": "<blockquote>\n  <p>Why is neither <code>ntohs()</code> nor <code>htons()</code> used on <code>adr_inet.sin_family</code>?</p>\n</blockquote>\n\n<p><code>adr_inet.sin_family</code> is initialized to the value of <code>AF_INET</code>.  This is defined in <code>bits/socket.h</code> (which is called by <code>netinet/in.h</code> in your example) as:</p>\n\n<pre><code>#define PF_INET     2   /* IP protocol family.  */\n</code></pre>\n\n<p>and then,</p>\n\n<pre><code>#define AF_INET     PF_INET\n</code></pre>\n\n<p>So <code>AF_INET</code> is just a way for the program to identify the associated socket as a TCP/IP connection.  It won't actually hold the value of an IPv4 address itself, so there's no need to perform an endian conversion on it.</p>\n\n<p>Also, note that in newer iterations of C, <code>netinet/in.h</code> has a comment that states the following:</p>\n\n<pre><code>/* Functions to convert between host and network byte order.\n\n   Please note that these functions normally take `unsigned long int' or\n`unsigned short int' values as arguments and also return them.  But\nthis was a short-sighted decision since on different systems the types\nmay have different representations but the values are always the same.  */ \nextern uint32_t ntohl (uint32_t __netlong) __THROW __attribute__ ((__const__));\nextern uint16_t ntohs (uint16_t __netshort)\n        __THROW __attribute__ ((__const__));\nextern uint32_t htonl (uint32_t __hostlong)\n        __THROW __attribute__ ((__const__));\nextern uint16_t htons (uint16_t __hostshort)\n        __THROW __attribute__ ((__const__));\n</code></pre>\n\n<p>Whereas the website you're referencing cites the older use of <code>unsigned long</code> and <code>unsigned short</code>\ndatatypes for the conversion functions.  So there's a chance you may encounter issues running code from that site if\nyou're using a newer version of C.</p>\n"}], "owner": {"reputation": 3787, "user_id": 5437543, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ad76496c936d384dac2888bae0126dde?s=128&d=identicon&r=PG&f=1", "display_name": "StoneThrow", "link": "https://stackoverflow.com/users/5437543/stonethrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2301, "favorite_count": 0, "accepted_answer_id": 44275564, "answer_count": 2, "score": 0, "last_activity_date": 1496210569, "creation_date": 1496200071, "question_id": 44274977, "link": "https://stackoverflow.com/questions/44274977/struct-sockaddr-in-member-byte-order-for-bind", "title": "struct sockaddr_in member byte order for bind()", "body": "<p>I'm learning socket programming and am confused by what I feel is inconsistent use of <code>htons()</code> and family of functions in my learning material. I'm currently reading <a href=\"http://alas.matf.bg.ac.rs/manuals/lspe/snode=27.html\" rel=\"nofollow noreferrer\">this site</a> which has the following code segment:</p>\n\n<pre><code>001 1:       struct sockaddr_in adr_inet;\n002 2:       int adr_len;\n003 3:\n004 4:       memset(&amp;adr_inet,0,sizeof adr_inet);\n005 5:\n006 6:       adr_inet.sin_family = AF_INET;\n007 7:       adr_inet.sin_port = ntohs(0);\n008 8:       adr_inet.sin_addr.s_addr = ntohl(INADDR_ANY);\n009 9:       adr_len = sizeof adr_inet;\n</code></pre>\n\n<p>A subsequent example further down at the same noted site has the following code segment:</p>\n\n<pre><code>030 30:      struct sockaddr_in adr_inet;/* AF_INET */\n...\n042 42:      /* Create an AF_INET address */\n043 43:      memset(&amp;adr_inet,0,sizeof adr_inet);\n044 44:\n045 45:      adr_inet.sin_family = AF_INET;\n046 46:      adr_inet.sin_port = htons(9000);\n047 47:      memcpy(&amp;adr_inet.sin_addr.s_addr,IPno,4);\n048 48:      len_inet = sizeof adr_inet;\n049 49:\n050 50:      /* Now bind the address to the socket */\n051 51:      z = bind(sck_inet,\n052 52:          (struct sockaddr *)&amp;adr_inet,\n053 53:          len_inet);\n</code></pre>\n\n<p><strong>Question</strong>:</p>\n\n<p>Why is <code>ntohs()</code> used on <code>adr_inet.sin_port</code> in the first instance, but <code>htons()</code> in the second?</p>\n\n<p><strong>Question</strong>:</p>\n\n<p>Why is neither <code>ntohs()</code> nor <code>htons()</code> used on <code>adr_inet.sin_family</code>?</p>\n\n<p>The noted site doesn't explain <em>why</em> <code>ntohs()</code> or <code>htons()</code> are used in their respective examples; it only says to \"note the use of\" said functions.</p>\n\n<p>I understand endianness and that network byte order is big-endian order. My questions is more about when do you want a <code>struct sockaddr_in</code>'s members in network vs. host byte order? In the second code example, <code>.sin_port</code> is set to network byte order before being passed to <code>bind()</code>. I can see the case for passing data to this function in either network or host byte order: <code>bind()</code> is a \"network-related\" function, so maybe it needs its data in network byte order; on the other hand <code>bind()</code> is executed on the host, so why shouldn't accept data in host byte order?</p>\n"}, {"tags": ["c", "memory-management", "free"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 4, "creation_date": 1496200255, "post_id": 44274976, "comment_id": 75557381, "body": "<i>if the argument does not match a pointer earlier returned by a memory management function, or if the space has been deallocated by a call to free or realloc, the behavior is undefined.</i>"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1496216699, "post_id": 44274976, "comment_id": 75564303, "body": "That would compile?  foo is not a pointer.   What happened when you tried it?"}, {"owner": {"reputation": 37, "user_id": 5225360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9d9aa34f8d6bf1fbcfb142cafff2f07?s=128&d=identicon&r=PG&f=1", "display_name": "Aizen", "link": "https://stackoverflow.com/users/5225360/aizen"}, "edited": false, "score": 0, "creation_date": 1496266862, "post_id": 44274976, "comment_id": 75596498, "body": "I&#39;m sorry. Let me re write the question"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5225360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9d9aa34f8d6bf1fbcfb142cafff2f07?s=128&d=identicon&r=PG&f=1", "display_name": "Aizen", "link": "https://stackoverflow.com/users/5225360/aizen"}, "edited": false, "score": 0, "creation_date": 1496267186, "post_id": 44275119, "comment_id": 75596628, "body": "If that&#39;s the case, is there any way for a piece of code to know if the pointer is pointing to a dynamically allocated memory or static allocated memory?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 37, "user_id": 5225360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9d9aa34f8d6bf1fbcfb142cafff2f07?s=128&d=identicon&r=PG&f=1", "display_name": "Aizen", "link": "https://stackoverflow.com/users/5225360/aizen"}, "edited": false, "score": 0, "creation_date": 1496403705, "post_id": 44275119, "comment_id": 75660225, "body": "@Aizen The only way the code (or the programmer) can &quot;know&quot; is by remembering it itself.  There is nothing like an <code>is_malloced_pointer(p)</code> function that will tell you."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 0, "last_activity_date": 1496201304, "creation_date": 1496201304, "answer_id": 44275119, "question_id": 44274976, "link": "https://stackoverflow.com/questions/44274976/c-free-function-called-on-static-memory-on-not-dynamically-allocated-memory/44275119#44275119", "title": "C free() function called on static memory (on not dynamically allocated memory)", "body": "<p>It's against the rules, so just about anything might happen.  <code>free()</code> might print an error message.  The program might crash with a segmentation violation or other memory access error.  The error might be silently ignored.  Or the error might lead to corruption of the malloc/free heap such that an error or crash might happen during some later call to malloc or free.</p>\n"}], "owner": {"reputation": 37, "user_id": 5225360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9d9aa34f8d6bf1fbcfb142cafff2f07?s=128&d=identicon&r=PG&f=1", "display_name": "Aizen", "link": "https://stackoverflow.com/users/5225360/aizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 44275119, "answer_count": 1, "score": -4, "last_activity_date": 1496267116, "creation_date": 1496200067, "last_edit_date": 1496267116, "question_id": 44274976, "link": "https://stackoverflow.com/questions/44274976/c-free-function-called-on-static-memory-on-not-dynamically-allocated-memory", "title": "C free() function called on static memory (on not dynamically allocated memory)", "body": "<p>What will happen if I call free() with non dynamically allocated pointer as the argument?</p>\n\n<p>E.g</p>\n\n<pre><code>some_struct foo;\nfunction(&amp;foo);\n\nvoid function(some_struct* param){\n    free(param);\n}\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 697, "user_id": 2410610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb37edc9b4e821407a2e0440e064e87?s=128&d=identicon&r=PG", "display_name": "Chris Pierce", "link": "https://stackoverflow.com/users/2410610/chris-pierce"}, "edited": false, "score": 0, "creation_date": 1496200197, "post_id": 44274942, "comment_id": 75557360, "body": "<a href=\"https://stackoverflow.com/questions/581657/why-do-i-have-to-write-mypointervar-only-sometimes-in-objective-c\" title=\"why do i have to write mypointervar only sometimes in objective c\">stackoverflow.com/questions/581657/&hellip;</a> This might help you understand the pointers a bit more clearly."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1496200549, "post_id": 44274942, "comment_id": 75557454, "body": "<code>*sp1[3]</code> is an <i>array of pointers to char</i>, <code>(*sp2)[5]</code> is a <i>pointer to array 5 of type char</i>, <code>sp3[][5]</code> is a 2D array (array of arrays <i>char[5]</i>). <b>Note:</b>, in each of the last two cases you invoke undefined behavior when you fail to provide adequate storage for, e.g. <code>&quot;this 2&quot;</code> (which is 6-chars + 1-char for the <i>nul-terminating</i> char). Your <code>5</code> needs to be, at minimum, <code>7</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1496200862, "post_id": 44274942, "comment_id": 75557530, "body": "<code>char c</code> declares <code>c</code> as an <i>uninitialized</i> character. <code>*p = &amp;c</code> creates <code>p</code> as a <i>pointer to char</i> (there is only 1-char of storage), <code>p++;</code> causes <code>p</code> to point outside of the storage allocated for <code>c</code>, any attempt to dereference <code>p</code> invokes undefined behavior."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496206399, "post_id": 44274942, "comment_id": 75559021, "body": "&quot;<i>In this function lineptr is the name of an array</i>&quot; -- well yes and no. <code>lineptr</code> may have been an <i>array of pointers</i> each to the beginning of one of <code>nlines</code> lines, but when passed as a parameter to a function, the array is converted to a <i>pointer</i>, so what you actually have in the function is a <i>pointer to pointer to char</i> or <code>char **</code> which you can easily increment. (had it been a 2D array, the parameter would have been <code>char (*lineptr)[WIDTH], int nlines...</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8089437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec414c30b736a15d5500b60c159e93bd?s=128&d=identicon&r=PG&f=1", "display_name": "jacktown", "link": "https://stackoverflow.com/users/8089437/jacktown"}, "edited": false, "score": 0, "creation_date": 1496329524, "post_id": 44275540, "comment_id": 75627735, "body": "Thank you very much. This is the first time I ask on &quot;stackoverflow&quot;,I am astonished by you passion and professional answer, I learn a lot including many minutiae which I didn&#39;t realize before.Thanks sincerely."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 25, "user_id": 8089437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec414c30b736a15d5500b60c159e93bd?s=128&d=identicon&r=PG&f=1", "display_name": "jacktown", "link": "https://stackoverflow.com/users/8089437/jacktown"}, "edited": false, "score": 0, "creation_date": 1496368560, "post_id": 44275540, "comment_id": 75644684, "body": "Glad to help. C is probably one of the most elegant and flexible languages you can learn. It gives you bit-level control over memory, but it requires that you measure and account for the memory you use. C will make you a better programmer no matter what language you choose, because you will have learned how to account for, and manage memory at the byte and bit level. Good luck with your coding."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1496204163, "creation_date": 1496204163, "answer_id": 44275540, "question_id": 44274942, "link": "https://stackoverflow.com/questions/44274942/detailed-difference-between-pointer-and-array/44275540#44275540", "title": "Detailed difference between pointer and array", "body": "<p>It is unclear what you code is attempting to accomplish other than simply wrestling with <em>pointers</em> and arrays to try and wrap your head around their use (which is an excellent use of your C learning time).</p>\n\n<p>With that in mind, let's look at your declarations and try and help make sense out of them. First let's look at <code>c</code> and <code>p</code> (I have initialized 'c' for you to avoid working with an uninitialized value):</p>\n\n<pre><code>    char c = 'a',\n        *p = &amp;c,\n</code></pre>\n\n<p><code>c</code> is simply declared as a <code>char</code> with automatic storage for <code>1-char</code> created on the function stack. <code>p</code> is declared as a character pointer (or <em>pointer to char</em>) and its value is initialized to the <em>address of</em> <code>c</code> </p>\n\n<p>(a pointer is simply a variable that holds the address of something else as its value. a normal variable, e.g. <code>c</code> holds an immediate-value, <code>'a'</code> in this case. <code>p</code> simply holds the address of <code>c</code> as its value, e.g. <code>p</code> points to <code>c</code>)</p>\n\n<p>You next declare an <em>array of pointers</em> that are initialized to hold the addresses of the <em>string literals</em> provided in the <em>initializer</em>, e.g.</p>\n\n<pre><code>        *sp1[] = {\"this 1\",\"this 2\", \"this 3\"},\n</code></pre>\n\n<p><strong>note:</strong> you do not need to specify <code>3</code> if you are providing initialization of each of the pointers.</p>\n\n<p>Here you effectively declare an array of <code>3-pointers</code> <em>to char *</em>. Where <code>sp1[0]</code> points to <code>\"this 1\"</code>, <code>sp1[1]</code> points to <code>\"this 2\"</code>, etc...</p>\n\n<p>Next you declare a <em>pointer to an array 5 char</em> (or pointer to an array of 5-chars) <strong>Note:</strong> as in my comment, that is insufficient by 2-chars, so it is declared as a pointer to an array of <code>7-chars</code> below. Now here is where you need to take care. Since you declare a <em>pointer to an array</em> it itself does not have any storage allocated for 7-chars, (it is just a pointer to something that already holds 7-chars). You have a few options. </p>\n\n<p>Since <code>sp3</code> is of type <code>char[][7]</code>, you can declare <code>sp2</code> after <code>sp3</code> and assign it the address of a compatible array, e.g. </p>\n\n<pre><code>    *sp1[] = {\"this 1\",\"this 2\", \"this 3\"},\n    sp3[][7] = {\"this 1\",\"this 2\", \"this 3\"},\n    (*sp2)[7] = sp3,  \n</code></pre>\n\n<p>to have <code>sp2</code> point to the beginning of <code>sp3</code>, or you can create storage for the literals following your <code>sp2</code> declaration by using the C99 <em>compound literal</em>, e.g.</p>\n\n<pre><code>        *sp1[] = {\"this 1\",\"this 2\", \"this 3\"},\n        /* using a compound literal to create storage */\n        (*sp2)[7] = (char [][7]){\"this 1\",\"this 2\", \"this 3\"},  \n        sp3[][7] = {\"this 1\",\"this 2\", \"this 3\"},\n</code></pre>\n\n<p>And finally, you can dynamically allocate storage for <code>sp2</code> (which we will leave for another time). Now since you are just wrestling with pointers here, you see you cannot simply <em>increment</em> <code>sp3</code> it is an array, but... you can declare a pointer to its beginning and increment that as part of your exercise, e.g.</p>\n\n<pre><code>        sp3[][7] = {\"this 1\",\"this 2\", \"this 3\"},\n        *p3 = *sp3; /* pointer to first element in sp3 */\n</code></pre>\n\n<p>Now putting all the pieces of the puzzle together and exercising the increment of each of your pointers, you can do something similar to the following. (<strong>note:</strong> I do not derefernce the value of <code>p</code> after incrementing <code>p++</code>, instead I derefernce <code>p - 1</code> so that it still points to valid storage)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid test1 (void);\n\nint main (void) {\n    test1();\n    return 0;\n}\n\nvoid test1 (void) {\n    char c = 'a',\n        *p = &amp;c,\n        *sp1[] = {\"this 1\",\"this 2\", \"this 3\"},\n        /* using a compound literal to create storage */\n        (*sp2)[7] = (char [][7]){\"this 1\",\"this 2\", \"this 3\"},  \n        sp3[][7] = {\"this 1\",\"this 2\", \"this 3\"},\n        *p3 = *sp3; /* pointer to first element in sp3 */\n\n    p++;        /* advance p to one-char-past-c     */\n    (*sp1)++;   /* advance pointer to sp1[0] by one */\n    sp2++;      /* advance pointer to next char[7]  */\n    p3++;       /* advance pointer to sp3[0] by one */\n\n    printf (\"(p - 1): %c\\n*sp1: %s\\n*sp2: %s\\np3  : %s\\n\",\n            *(p - 1), *sp1, *sp2, p3);\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/arrayptrinc\n(p - 1): a\n*sp1: his 1\n*sp2: this 2\np3  : his 1\n</code></pre>\n\n<p><strong>Note:</strong> the output is the same if you chose to declare <code>sp2</code> after <code>sp3</code> and have <code>sp2</code> point to the beginning of <code>sp3</code> with:</p>\n\n<pre><code>    char c = 'a',\n        *p = &amp;c,\n        *sp1[] = {\"this 1\",\"this 2\", \"this 3\"},\n        sp3[][7] = {\"this 1\",\"this 2\", \"this 3\"},\n        (*sp2)[7] = sp3,  \n        *p3 = *sp3; /* pointer to first element in sp3 */\n</code></pre>\n\n<p>While I'm not sure this is exactly what you had in mind, I think it is close to where you were going with your exercise. If not, let me know. Look things over and let me know if you have any further questions.</p>\n"}], "owner": {"reputation": 25, "user_id": 8089437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec414c30b736a15d5500b60c159e93bd?s=128&d=identicon&r=PG&f=1", "display_name": "jacktown", "link": "https://stackoverflow.com/users/8089437/jacktown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 44275540, "answer_count": 1, "score": 1, "last_activity_date": 1496237378, "creation_date": 1496199808, "last_edit_date": 1496237378, "question_id": 44274942, "link": "https://stackoverflow.com/questions/44274942/detailed-difference-between-pointer-and-array", "title": "Detailed difference between pointer and array", "body": "<p>Below is the code in C:</p>\n\n<pre><code>void test1(void);\n\nint main(){\n    test1();\n    return 0;\n}\n\nvoid test1(void){\n    char c,\n        *p = &amp;c,\n        *sp1[3] = {\"this 1\",\"this 2\", \"this 3\"},    //pointers array\n        (*sp2)[5] = {\"this 1\",\"this 2\", \"this 3\"},  \n        //2 dimensions array declaration in method 1 \n        sp3[][5] = {\"this 1\",\"this 2\", \"this 3\"};   \n        //2 dimensions array declaration in method 2\n\n    p++;    //ok \n    sp1++;  //error \n    sp2++;  //ok\n    sp3++;  //error     \n}\n</code></pre>\n\n<p>I've read that a pointer is a variable, so increment is ok for it, but an array name is not a variable, so assignment is not acceptable.</p>\n\n<p>In the code above, <code>p</code> is a pointer, so an increment is right; <code>sp1</code>, <code>sp3</code> are both array names and increment causes errors, but why is it ok for <code>sp2</code>?</p>\n\n<p>In the same book, there is a function as below:</p>\n\n<pre><code>//print lines \nvoid writelines(char *lineptr[],int nlines){\n    while(--nlines &gt;= 0){\n        printf(\"%s\\n\",*lineptr++);\n    }\n}\n</code></pre>\n\n<p>In this function <code>lineptr</code> is the name of an array, but an increment is applied on it. Why? Is it because the parameter is converted by value in C, so <code>lineptr</code> is actually a pointer?</p>\n"}, {"tags": ["c++", "c", "cmake", "linker"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496198739, "post_id": 44274770, "comment_id": 75557072, "body": "Why not make the test project a <i>sub-project</i> (in a subfolder) of the library project? Then you can do <code>TARGET_LINK_LIBRARIES(sshtest sshserial)</code> and CMake set up the makefiles to link with the library automatically."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496198817, "post_id": 44274770, "comment_id": 75557095, "body": "Also, you <i>do</i> use <code>extern &quot;C&quot;</code> when declaring the functions when being compiled by a C++ compiler?"}, {"owner": {"reputation": 12911, "user_id": 466694, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c46901df373341451a24d5dbb59f5b9a?s=128&d=identicon&r=PG", "display_name": "nakiya", "link": "https://stackoverflow.com/users/466694/nakiya"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496198828, "post_id": 44274770, "comment_id": 75557099, "body": "@Someprogrammerdude : I can try that for now, and I will. But later I want to use the C library in other projects so it&#39;s not a permanent solution I guess."}, {"owner": {"reputation": 12911, "user_id": 466694, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c46901df373341451a24d5dbb59f5b9a?s=128&d=identicon&r=PG", "display_name": "nakiya", "link": "https://stackoverflow.com/users/466694/nakiya"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496198846, "post_id": 44274770, "comment_id": 75557102, "body": "@Someprogrammerdude : The library is built in C"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1496198958, "post_id": 44274770, "comment_id": 75557130, "body": "Yes, and that&#39;s most likely the problem. C and C++ are different in many regards, for one C++ uses <a href=\"https://en.wikipedia.org/wiki/Name_mangling\" rel=\"nofollow noreferrer\"><i>name mangling</i></a>, to support overloading among other things. That means functions declarations of non-C++ libraries needs to be prefixed or surrounded by <code>extern &quot;C&quot;</code> to inhibit name mangling, since C doesn&#39;t &quot;mangle&quot; names."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496199052, "post_id": 44274770, "comment_id": 75557153, "body": "Just please tell me, do the header file (which I assume you include in the C++ project) contain <i>any</i> <code>extern &quot;C&quot;</code>?"}, {"owner": {"reputation": 12911, "user_id": 466694, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c46901df373341451a24d5dbb59f5b9a?s=128&d=identicon&r=PG", "display_name": "nakiya", "link": "https://stackoverflow.com/users/466694/nakiya"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496199130, "post_id": 44274770, "comment_id": 75557171, "body": "@Someprogrammerdude : No, the header in the library doesn&#39;t (and cannot) have <code>extern &quot;C&quot;</code> as it&#39;s written in C itself. And if you look at the symbols indicated by the <code>nm</code> command, they are not mangled (The leading underscore is fine as far as I know)."}], "answers": [{"comments": [{"owner": {"reputation": 12911, "user_id": 466694, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c46901df373341451a24d5dbb59f5b9a?s=128&d=identicon&r=PG", "display_name": "nakiya", "link": "https://stackoverflow.com/users/466694/nakiya"}, "edited": false, "score": 0, "creation_date": 1496199293, "post_id": 44274859, "comment_id": 75557201, "body": "As I indicated in the comments on the post, The library is built in C so I don&#39;t need to decorate the exported symbols with <code>extern &quot;C&quot;</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 12911, "user_id": 466694, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c46901df373341451a24d5dbb59f5b9a?s=128&d=identicon&r=PG", "display_name": "nakiya", "link": "https://stackoverflow.com/users/466694/nakiya"}, "edited": false, "score": 3, "creation_date": 1496199337, "post_id": 44274859, "comment_id": 75557211, "body": "@nakiya If you want to use the functions in C++, then you <b><i>need</i></b> it! End of story! Just <i>try</i> it."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 12911, "user_id": 466694, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c46901df373341451a24d5dbb59f5b9a?s=128&d=identicon&r=PG", "display_name": "nakiya", "link": "https://stackoverflow.com/users/466694/nakiya"}, "edited": false, "score": 1, "creation_date": 1496222627, "post_id": 44274859, "comment_id": 75568258, "body": "@nakiya or, if it is a 3rd-party library, you could just bracket the <code>#include</code> with <code>extern &quot;C&quot; {..}</code>."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1496199297, "last_edit_date": 1496199297, "creation_date": 1496199230, "answer_id": 44274859, "question_id": 44274770, "link": "https://stackoverflow.com/questions/44274770/linker-cannot-find-symbols-in-library/44274859#44274859", "title": "Linker cannot find symbols in library", "body": "<p>The problem is that C++ uses <a href=\"https://en.wikipedia.org/wiki/Name_mangling\" rel=\"nofollow noreferrer\"><em>name mangling</em></a>. To inhibit that you need to declare the C functions with <code>extern \"C\"</code>, but only when being compiled by a C++ compiler. You can check this with the <code>__cplusplus</code> macro, which is defined when compiling C++, but not when compiling C.</p>\n\n<p>In the header file where you declare the function prototypes, do something like</p>\n\n<pre><code>#ifdef __cplusplus\n// Being compiled by a C++ compiler, inhibit name mangling\nextern \"C\" {\n#endif\n\n// All your function prototype declarations here\n\n#ifdef __cplusplus\n}  // End of extern \"C\"\n#endif\n</code></pre>\n"}], "owner": {"reputation": 12911, "user_id": 466694, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c46901df373341451a24d5dbb59f5b9a?s=128&d=identicon&r=PG", "display_name": "nakiya", "link": "https://stackoverflow.com/users/466694/nakiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1352, "favorite_count": 1, "accepted_answer_id": 44274859, "answer_count": 1, "score": 2, "last_activity_date": 1496199297, "creation_date": 1496198443, "question_id": 44274770, "link": "https://stackoverflow.com/questions/44274770/linker-cannot-find-symbols-in-library", "title": "Linker cannot find symbols in library", "body": "<p>I built a C library using CMake. Here's the CMakeLists file for the library:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.7)\nproject(sshserial)\n\nset(CMAKE_C_STANDARD 99)\n\ninclude_directories(BEFORE SYSTEM ${CMAKE_SOURCE_DIR}/common/include)\nlink_directories(${CMAKE_SOURCE_DIR}/common/lib)\n\nset(SOURCE_FILES sshserial.c sshserial.h)\nadd_library(sshserial ${SOURCE_FILES})\n\nTARGET_LINK_LIBRARIES(sshserial libssh.a)\n</code></pre>\n\n<p>I use this library in a C++ program. Here's the CMakeLists file for the program:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.7)\nproject(sshtest)\n\nset(CMAKE_CXX_STANDARD 11)\n\ninclude_directories(BEFORE SYSTEM ${CMAKE_SOURCE_DIR}/common/include)\nlink_directories(${CMAKE_SOURCE_DIR}/common/lib)\n\nset(SOURCE_FILES main.cpp)\nadd_executable(sshtest ${SOURCE_FILES})\n\nTARGET_LINK_LIBRARIES(sshtest libsshserial.a)\n</code></pre>\n\n<p>I have copied the library in the correct folder. When I run <code>nm</code> on the library I get this:</p>\n\n<pre><code>$ nm libsshserial.a \n\nlibsshserial.a(sshserial.c.o):\n                 U ___error\n                 U ___stack_chk_fail\n                 U ___stack_chk_guard\n                 U ___stderrp\n                 U ___stdinp\n0000000000000330 T _create_session\n                 U _exit\n                 U _fgets\n                 U _fprintf\n                 U _free\n                 U _getpass\n0000000000000490 T _read_from_session\n                 U _ssh_channel_close\n                 U _ssh_channel_free\n                 U _ssh_channel_new\n                 U _ssh_channel_open_session\n                 U _ssh_channel_read\n                 U _ssh_channel_request_exec\n                 U _ssh_channel_send_eof\n                 U _ssh_connect\n                 U _ssh_disconnect\n                 U _ssh_free\n                 U _ssh_get_error\n                 U _ssh_get_hexa\n                 U _ssh_get_pubkey_hash\n                 U _ssh_is_server_known\n                 U _ssh_new\n                 U _ssh_options_set\n                 U _ssh_print_hexa\n                 U _ssh_userauth_password\n                 U _ssh_write_knownhost\n                 U _strerror\n                 U _strncasecmp\n0000000000000000 T _verify_knownhost\n                 U _write\n</code></pre>\n\n<p>When I try to build the program, I get this linker errors:</p>\n\n<pre><code>Undefined symbols for architecture x86_64:\n  \"create_session()\", referenced from:\n      _main in main.cpp.o\n  \"read_from_session(ssh_session_struct*)\", referenced from:\n      _main in main.cpp.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake[3]: *** [sshtest] Error 1\nmake[2]: *** [CMakeFiles/sshtest.dir/all] Error 2\nmake[1]: *** [CMakeFiles/sshtest.dir/rule] Error 2\nmake: *** [sshtest] Error 2\n</code></pre>\n\n<p>I've been stuck here for some time and I am sure I'm missing something trivial. What am I doing wrong?</p>\n\n<p>P.S. I'm on Mac</p>\n\n<pre><code>$ uname -a\nDarwin XXXXXX 15.6.0 Darwin Kernel Version 15.6.0: Tue Apr 11 16:00:51 PDT 2017; root:xnu-3248.60.11.5.3~1/RELEASE_X86_64 x86_64\n</code></pre>\n"}, {"tags": ["c", "function-pointers", "powerpc", "ucos"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496196974, "post_id": 44274542, "comment_id": 75556693, "body": "Just <i>jump</i> to the function? Or define a variable that is a pointer to a function, assign it to point to the location of the function you want to call, and use the function pointer variable as an actual function?"}, {"owner": {"reputation": 1, "user_id": 8089211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1301384159915670/picture?type=large", "display_name": "Henk Jeong", "link": "https://stackoverflow.com/users/8089211/henk-jeong"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496197960, "post_id": 44274542, "comment_id": 75556904, "body": "It does not matter which one. What I want to know is how to use other image functions."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496198496, "post_id": 44274542, "comment_id": 75557026, "body": "You should know at which address the image is loaded. You also should know (or can easily find out) the offset of the function in the image. Add the two and you have the address to the function, which you can then initialize the function pointer to point to the address and can then call the function."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496198530, "post_id": 44274542, "comment_id": 75557036, "body": "My suggestion if you have two images, is to have one being just a &quot;boot image&quot; that initializes the hardware, then jumps to (or calls) a function in the second image which then is the application image which does all the work. Then all you need is to call a single function in the second image from the first, simplifying everything quite a bit."}, {"owner": {"reputation": 1, "user_id": 8089211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1301384159915670/picture?type=large", "display_name": "Henk Jeong", "link": "https://stackoverflow.com/users/8089211/henk-jeong"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496199050, "post_id": 44274542, "comment_id": 75557152, "body": "Thanks for the friendly answer. But unfortunately, the main program continues. Then i have to replace it with a function created by an external program. Therefore, it is difficult to simplify."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496244991, "post_id": 44274542, "comment_id": 75584764, "body": "are you saying you have &#39;boot loader&#39; image that loads the &#39;function image via RS232?  If so, then run the boot loader, Amongst the items loaded is the &#39;start&#39; address (not necessarily the first address) of the function image. At the reboot address, save the &#39;start&#39; address, then force a reboot of the processor.   As the processor reboots, it gets the &#39;start&#39; address of the &#39;function image&#39; and executes that image.  Note: this assumes each image can run by itself."}, {"owner": {"reputation": 1, "user_id": 8089211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1301384159915670/picture?type=large", "display_name": "Henk Jeong", "link": "https://stackoverflow.com/users/8089211/henk-jeong"}, "edited": false, "score": 0, "creation_date": 1496306548, "post_id": 44274542, "comment_id": 75610405, "body": "It will load and run the image from the boot loader. That&#39;s not what I want. I just call the function and then return to the original image. It is okay to call a function, but the simple operation function is executed, but it is killed when it tries to process the string. This means that the &#39;.data&#39; area is not loaded.I am looking for a way to load the image&#39;s data, sdata, bss, etc. into RAM."}], "owner": {"reputation": 1, "user_id": 8089211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1301384159915670/picture?type=large", "display_name": "Henk Jeong", "link": "https://stackoverflow.com/users/8089211/henk-jeong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496222671, "creation_date": 1496196607, "last_edit_date": 1496222671, "question_id": 44274542, "link": "https://stackoverflow.com/questions/44274542/is-it-possible-to-call-a-function-from-another-image-on-mpc5674fnxp-ppc", "title": "Is it possible to call a function from another image on MPC5674F(NXP PPC)?", "body": "<p>My question is explained below.</p>\n\n<p><img src=\"https://i.stack.imgur.com/Ic4rn.png\" alt=\"enter image description here\"></p>\n\n<ol>\n<li>Build the main image.</li>\n<li>Download main image using JTAG.</li>\n<li>Build the application image.</li>\n<li>Download app image using RS232.</li>\n<li>Run main image.</li>\n<li>Call the func_a in the application image from the main().</li>\n</ol>\n\n<p>Is it possible on this system?\nPlease let me know what to do if possible.</p>\n\n<p>Thank you,\nRegards,\nHenk</p>\n"}, {"tags": ["c", "gdb", "core"], "answers": [{"tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 1, "last_activity_date": 1496212678, "creation_date": 1496212678, "answer_id": 44277388, "question_id": 44274528, "link": "https://stackoverflow.com/questions/44274528/c-program-to-mimic-gdb-call-function-to-execute-on-core/44277388#44277388", "title": "C program to mimic gdb call function to execute on core", "body": "<blockquote>\n  <p>Is it possible to write a program to load the core and call this function by linking the library which dumps the Trie. ( I am thinking of using Python gdb module, but that would require me to convert the C program to Python).</p>\n</blockquote>\n\n<p>Sure: you can build your source into a shared library, wrap your shared library into Python and have Python load and call it.</p>\n\n<p>But it likely much easier to convert your C program into plain Python instead.</p>\n"}], "owner": {"reputation": 21, "user_id": 3651452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01d2434ddb66bd2bb3590910191505d?s=128&d=identicon&r=PG&f=1", "display_name": "Umesh", "link": "https://stackoverflow.com/users/3651452/umesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496212678, "creation_date": 1496196468, "question_id": 44274528, "link": "https://stackoverflow.com/questions/44274528/c-program-to-mimic-gdb-call-function-to-execute-on-core", "title": "C program to mimic gdb call function to execute on core", "body": "<p>In my program, IP prefixes are stored as a Trie.  I would like to dump the trie from linux coredump generated by the program.  I already have a C function which traverses through the tree and prints the prefixes stored in Tree.  However, using gdb I can't dump the trie by calling this function.  Is it possible to write a program to load the core and call this function by linking the library which dumps the Trie. ( I am thinking of using Python gdb module, but that would require me to convert the C program to Python).</p>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["c", "go", "openssl", "blowfish"], "comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1496194382, "post_id": 44274221, "comment_id": 75556165, "body": "Interesting.  Try PHP for a tie-breaker  :)  .  I&#39;ve used one C++ blowfish source (Jim Conger&#39;s) that used a different byte order in its output than everyone else&#39;s, but that isn&#39;t the issue here."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1496194612, "post_id": 44274221, "comment_id": 75556226, "body": "You should probably find some <a href=\"https://www.google.com/search?q=blowfish+test+vectors\" rel=\"nofollow noreferrer\">Blowfish test vectors</a> and see which (if any) arrives at the correct result."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1496211155, "post_id": 44274221, "comment_id": 75561024, "body": "According to the <a href=\"https://linux.die.net/man/3/bf_encrypt\" rel=\"nofollow noreferrer\"><code>BF_encrypt</code> man page</a>: <i>&quot;BF_encrypt() and BF_decrypt() are the lowest level functions for Blowfish encryption. They encrypt/decrypt the first 64 bits of the vector pointed by data, using the key key. These functions should not be used unless you implement &#39;modes&#39; of Blowfish. The alternative is to use BF_ecb_encrypt(). If you still want to use these functions, you should be aware that they take each 32-bit chunk in host-byte order, which is little-endian on little-endian platforms and big-endian on big-endian ones&quot;</i>."}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 3, "last_activity_date": 1496211174, "creation_date": 1496211174, "answer_id": 44276988, "question_id": 44274221, "link": "https://stackoverflow.com/questions/44274221/blowfish-results-are-different-between-openssl-and-golang/44276988#44276988", "title": "Blowfish results are different between OpenSSL and Golang", "body": "<p>The problem is in the endianness of variable <code>data</code> and <code>encrypted</code>. In the C code, <code>data</code> (8-bytes) is converted from byte array to <code>unsigned int</code>(32-bit little-endian), then being encrypted in place. It affects the endianness of both input and encrypted result. To get same result in Golang, you must perform endian conversion, e.g.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n\n    \"encoding/binary\"\n\n    \"golang.org/x/crypto/blowfish\"\n)\n\nfunc convertEndian(in []byte) ([]byte, error) {\n    //Read byte array as uint32 (little-endian)\n    var v1, v2 uint32\n    buf := bytes.NewReader(in)\n    if err := binary.Read(buf, binary.LittleEndian, &amp;v1); err != nil {\n        return nil, err\n    }\n    if err := binary.Read(buf, binary.LittleEndian, &amp;v2); err != nil {\n        return nil, err\n    }\n\n    //convert uint32 to byte array\n    out := make([]byte, 8)\n    binary.BigEndian.PutUint32(out, v1)\n    binary.BigEndian.PutUint32(out[4:], v2)\n\n    return out, nil\n}\n\nfunc main() {\n    key := []byte{0xc9, 0x04, 0xa7, 0xa8, 0x5b, 0xbd, 0x97, 0x53, 0x24, 0xc5, 0x08, 0x3e, 0xd9, 0x6f, 0xf0, 0x22, 0xf2, 0x5e, 0x06, 0x2d, 0xa1, 0xd5, 0x75, 0xb2, 0x46, 0x2c, 0x2c, 0x98, 0xd8, 0xd6, 0x4d, 0x9d}\n    data := []byte{0x53, 0x8b, 0x77, 0x59, 0x83, 0x4d, 0x34, 0x18}\n\n    //Add: This is equal to: (unsigned int *)data in C\n    cdata, _ := convertEndian(data)\n\n    cipher, err := blowfish.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"key: %x\\n\", key)\n    fmt.Printf(\"data: %x\\n\", cdata)\n\n    encrypted := make([]byte, 8)\n    cipher.Encrypt(encrypted, cdata)\n    fmt.Printf(\"encrypted-1: %x\\n\", encrypted)\n\n    //Add: This is equal to {uint32, uint32} --&gt; byte array\n    ce, _ := convertEndian(encrypted)\n    fmt.Printf(\"encrypted-2: %02x\\n\", ce)\n}\n</code></pre>\n"}], "owner": {"reputation": 11881, "user_id": 1930219, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5ae618e4950c81bf0d83d17c2c2ddaab?s=128&d=identicon&r=PG", "display_name": "Alex Netkachov", "link": "https://stackoverflow.com/users/1930219/alex-netkachov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 44276988, "answer_count": 1, "score": 1, "last_activity_date": 1496211174, "creation_date": 1496193876, "last_edit_date": 1496196024, "question_id": 44274221, "link": "https://stackoverflow.com/questions/44274221/blowfish-results-are-different-between-openssl-and-golang", "title": "Blowfish results are different between OpenSSL and Golang", "body": "<p>I want to read VIM encoded files in Go. <a href=\"https://gist.github.com/grafi-tt/94015cc8c8f656420fb019a9c1e22f0f\" rel=\"nofollow noreferrer\">This code</a> works good enough for small file so I've decided to convert it to Go. Key generation works fine, but Blowfish encoding does not. I've traced the problem to different outcome from BF_encrypt and cipher.Encrypt(...).</p>\n\n<p><em>Input</em></p>\n\n<pre><code>key: c904a7a85bbd975324c5083ed96ff022f25e062da1d575b2462c2c98d8d64d9d\ndata: 538b7759834d3418\n</code></pre>\n\n<p><em>Output</em></p>\n\n<pre><code>Golang: b5cf33144acbc794\nC:      90baa70ec3e44867\n</code></pre>\n\n<p>Golang code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang.org/x/crypto/blowfish\"\n)\n\nfunc main() {\n    key := []byte{0xc9, 0x04, 0xa7, 0xa8, 0x5b, 0xbd, 0x97, 0x53, 0x24, 0xc5, 0x08, 0x3e, 0xd9, 0x6f, 0xf0, 0x22, 0xf2, 0x5e, 0x06, 0x2d, 0xa1, 0xd5, 0x75, 0xb2, 0x46, 0x2c, 0x2c, 0x98, 0xd8, 0xd6, 0x4d, 0x9d}\n    data := []byte{0x53, 0x8b, 0x77, 0x59, 0x83, 0x4d, 0x34, 0x18}\n\n    cipher, err := blowfish.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"key: %x\\n\", key)\n    fmt.Printf(\"data: %x\\n\", data)\n\n    encrypted := make([]byte, 8)\n    cipher.Encrypt(encrypted, data)\n    fmt.Printf(\"encrypted: %x\\n\", encrypted)\n}\n</code></pre>\n\n<p>C code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;openssl/blowfish.h&gt;\n#include &lt;openssl/sha.h&gt;\n\n/*\nclang test1.c -o test1 \\\n-I/usr/local/Cellar/openssl/1.0.2k/include \\\n-L/usr/local/Cellar/openssl/1.0.2k/lib \\\n-lcrypto\n./test1\n*/\n\nint main(int argc, char *argv[]) {\n    unsigned char key[32] = {0xc9, 0x04, 0xa7, 0xa8, 0x5b, 0xbd, 0x97, 0x53, 0x24, 0xc5, 0x08, 0x3e, 0xd9, 0x6f, 0xf0, 0x22, 0xf2, 0x5e, 0x06, 0x2d, 0xa1, 0xd5, 0x75, 0xb2, 0x46, 0x2c, 0x2c, 0x98, 0xd8, 0xd6, 0x4d, 0x9d};\n    unsigned char data[8] = {0x53, 0x8b, 0x77, 0x59, 0x83, 0x4d, 0x34, 0x18};\n\n    BF_KEY bf_key;\n    BF_set_key(&amp;bf_key, 32, key);\n\n    printf(\"key: \");\n    for (int j = 0; j &lt; 32; j++) printf(\"%02x\", key[j]);\n    printf(\"\\n\");\n    printf(\"data: \");\n    for (int j = 0; j &lt; 8; j++) printf(\"%02x\", data[j]);\n    printf(\"\\n\");\n\n    BF_encrypt((unsigned int*)data, &amp;bf_key);\n\n    printf(\"encrypted: \");\n    for (int j = 0; j &lt; 8; j++) printf(\"%02x\", data[j]);\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Can you see where the problem is?</p>\n"}, {"tags": ["c", "parallel-processing", "openmp", "openacc", "pgi"], "comments": [{"owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 0, "creation_date": 1496218847, "post_id": 44274167, "comment_id": 75565668, "body": "Why have you tagged this with the&quot;openmp&quot; tag? There is no OpenMP here..."}], "answers": [{"tags": [], "owner": {"reputation": 658, "user_id": 2108046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3fc0b5573d8bf49d788f942d49ddb7?s=128&d=identicon&r=PG", "display_name": "Ruyk", "link": "https://stackoverflow.com/users/2108046/ruyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1496219416, "creation_date": 1496219416, "answer_id": 44279553, "question_id": 44274167, "link": "https://stackoverflow.com/questions/44274167/openacc-must-have-routine-information-error/44279553#44279553", "title": "OpenACC must have routine information error", "body": "<p>When using OpenACC, the parallel regions are offloaded to a device, like a GPU. GPU devices normally don't have access to the entire system or the IO, and have a reduced subset of the standard library implemented.\nIn your case, the <strong>fwrite</strong> function call cannot be offloaded to a device, since you cannot access the disk from the accelerator.\nYou could do that in OpenMP, where parallel regions are executed on CPU or MIC threads, which typically have access to the entire system library.\nThe <strong>acc routine</strong> directive that PGC is suggesting would allow you to annotate any function to create a device version of it. </p>\n"}, {"tags": [], "owner": {"reputation": 3901, "user_id": 3204484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7Cc9.jpg?s=128&g=1", "display_name": "Mat Colgrove", "link": "https://stackoverflow.com/users/3204484/mat-colgrove"}, "is_accepted": false, "score": 2, "last_activity_date": 1496250844, "creation_date": 1496250844, "answer_id": 44290973, "question_id": 44274167, "link": "https://stackoverflow.com/questions/44274167/openacc-must-have-routine-information-error/44290973#44290973", "title": "OpenACC must have routine information error", "body": "<p>Since you can't access a file from the GPU, you'll want to capture the results to arrays, copy them back to the host, and then output the results to a file.  </p>\n\n<p>Also, the \"present\" clause indicates that you've already copied the data over to the device and the program will abort if it's not there.  Given the usage, I think you meant to use \"private\", which indicates that the variable should be private to the execution level.  However scalars are private by default in OpenACC, so there's no need to manually privatize these variables.  If you do manually privatize a variable, be sure to put it at the correct loop level.  For example, if you privatize \"Zx\" on the outer loop, it will only private to that loop level.  It would be shared by all the vectors of the inner loop!  Again, here, it's best to just let the compiler handle privatizing the scalars, but just be mindful of where you privatize things in the few cases where you have to manually privatize variables.</p>\n\n<p>Here's a corrected version of your code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main()\n{\n    /* screen ( integer) coordinate */\n    int iX,iY;\n    const int iXmax = 800;\n    const int iYmax = 800;\n    /* world ( double) coordinate = parameter plane*/\n    double Cx,Cy;\n    const double CxMin=-2.5;\n    const double CxMax=1.5;\n    const double CyMin=-2.0;\n    const double CyMax=2.0;\n    /* */\n    double PixelWidth=(CxMax-CxMin)/iXmax;\n    double PixelHeight=(CyMax-CyMin)/iYmax;\n    /* color component ( R or G or B) is coded from 0 to 255 */\n    /* it is 24 bit color RGB file */\n    const int MaxColorComponentValue=255;\n    FILE * fp;\n    char *filename=\"new1.ppm\";\n    char *comment=\"# \";/* comment should start with # */\n    static unsigned char color[3];\n    unsigned char red[iXmax][iYmax];\n    unsigned char blue[iXmax][iYmax];\n    unsigned char green[iXmax][iYmax];\n    /* Z=Zx+Zy*i  ;   Z0 = 0 */\n    double Zx, Zy;\n    double Zx2, Zy2; /* Zx2=Zx*Zx;  Zy2=Zy*Zy  */\n    /*  */\n    int Iteration;\n    const int IterationMax=200;\n    /* bail-out value , radius of circle ;  */\n    const double EscapeRadius=2;\n    double ER2=EscapeRadius*EscapeRadius;\n    /*create new file,give it a name and open it in binary mode  */\n    fp= fopen(filename,\"wb\"); /* b -  binary mode */\n    /*write ASCII header to the file*/\n    fprintf(fp,\"P6\\n %s\\n %d\\n %d\\n %d\\n\",comment,iXmax,iYmax,MaxColorComponentValue);\n    /* compute and write image data bytes to the file*/\n    #pragma acc parallel loop copyout(red,blue,green)\n    for(iY=0;iY&lt;iYmax;iY++)\n    {\n        Cy=CyMin + iY*PixelHeight;\n        if (fabs(Cy)&lt; PixelHeight/2) Cy=0.0; /* Main antenna */\n        #pragma acc loop\n        for(iX=0;iX&lt;iXmax;iX++)\n        {\n            Cx=CxMin + iX*PixelWidth;\n            /* initial value of orbit = critical point Z= 0 */\n            Zx=0.0;\n            Zy=0.0;\n            Zx2=Zx*Zx;\n            Zy2=Zy*Zy;\n            /* */\n            #pragma acc loop\n            for (Iteration=0;Iteration&lt;IterationMax &amp;&amp; ((Zx2+Zy2)&lt;ER2);Iteration++)\n            {\n                Zy=2*Zx*Zy + Cy;\n                Zx=Zx2-Zy2 +Cx;\n                Zx2=Zx*Zx;\n                Zy2=Zy*Zy;\n            };\n            /* compute  pixel color (24 bit = 3 bytes) */\n            if (Iteration==IterationMax)\n            { /*  interior of Mandelbrot set = black */\n                red[iX][iY]=0;\n                blue[iX][iY]=0;\n                green[iX][iY]=0;\n            }\n            else\n            { /* exterior of Mandelbrot set = white */\n                red[iX][iY]=255;\n                blue[iX][iY]=255;\n                green[iX][iY]=255;\n            };            }\n    }\n\n\n    /*write color to the file*/\n    for(iY=0;iY&lt;iYmax;iY++) {\n        for(iX=0;iX&lt;iXmax;iX++) {\n            color[0] = red[iX][iY];\n            color[1] = blue[iX][iY];\n            color[2] = green[iX][iY];\n            fwrite(color,1,3,fp);\n        }\n    }\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8003517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a67deaf74378c5ac0efdd1550e06551?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Munley", "link": "https://stackoverflow.com/users/8003517/chris-munley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1497, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496250844, "creation_date": 1496193265, "question_id": 44274167, "link": "https://stackoverflow.com/questions/44274167/openacc-must-have-routine-information-error", "title": "OpenACC must have routine information error", "body": "<p>I am trying to parallelize a simple mandelbrot c program, yet I get this error that has to do with not including acc routine information. Also, I am not sure whether I should be copying data in and out of the parallel section. PS I am relatively new to parallel programming, so any advice with learning it would be appreciated.</p>\n\n<p>(Warning when compiled)</p>\n\n<pre><code>PGC-S-0155-Procedures called in a compute region must have acc routine information: fwrite (mandelbrot.c: 88)\nPGC-S-0155-Accelerator region ignored; see -Minfo messages  (mandelbrot.c: 51)\nmain:\n     51, Accelerator region ignored\n     88, Accelerator restriction: call to 'fwrite' with no acc routine information\nPGC/x86-64 Linux 16.10-0: compilation completed with severe errors\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\nint main()\n{\n    /* screen ( integer) coordinate */\n    int iX,iY;\n    const int iXmax = 800;\n    const int iYmax = 800;\n    /* world ( double) coordinate = parameter plane*/\n    double Cx,Cy;\n    const double CxMin=-2.5;\n    const double CxMax=1.5;\n    const double CyMin=-2.0;\n    const double CyMax=2.0;\n    /* */\n    double PixelWidth=(CxMax-CxMin)/iXmax;\n    double PixelHeight=(CyMax-CyMin)/iYmax;\n    /* color component ( R or G or B) is coded from 0 to 255 */\n    /* it is 24 bit color RGB file */\n    const int MaxColorComponentValue=255;\n    FILE * fp;\n    char *filename=\"new1.ppm\";\n    char *comment=\"# \";/* comment should start with # */\n    static unsigned char color[3];\n    /* Z=Zx+Zy*i  ;   Z0 = 0 */\n    double Zx, Zy;\n    double Zx2, Zy2; /* Zx2=Zx*Zx;  Zy2=Zy*Zy  */\n    /*  */\n    int Iteration;\n    const int IterationMax=200;\n    /* bail-out value , radius of circle ;  */\n    const double EscapeRadius=2;\n    double ER2=EscapeRadius*EscapeRadius;\n    /*create new file,give it a name and open it in binary mode  */\n    fp= fopen(filename,\"wb\"); /* b -  binary mode */\n    /*write ASCII header to the file*/\n    fprintf(fp,\"P6\\n %s\\n %d\\n %d\\n %d\\n\",comment,iXmax,iYmax,MaxColorComponentValue);\n    /* compute and write image data bytes to the file*/\n    #pragma acc parallel loop present(CyMin, iY, PixelHeight, iX, iXmax, CxMin, PixelWidth, Zx, Zy, Zx2, Zy2, Iteration, IterationMax)\n    for(iY=0;iY&lt;iYmax;iY++)\n    {\n        Cy=CyMin + iY*PixelHeight;\n        if (fabs(Cy)&lt; PixelHeight/2) Cy=0.0; /* Main antenna */\n        #pragma acc loop\n        for(iX=0;iX&lt;iXmax;iX++)\n        {\n            Cx=CxMin + iX*PixelWidth;\n            /* initial value of orbit = critical point Z= 0 */\n            Zx=0.0;\n            Zy=0.0;\n            Zx2=Zx*Zx;\n            Zy2=Zy*Zy;\n            /* */\n            #pragma acc loop\n            for (Iteration=0;Iteration&lt;IterationMax &amp;&amp; ((Zx2+Zy2)&lt;ER2);Iteration++)\n            {\n                Zy=2*Zx*Zy + Cy;\n                Zx=Zx2-Zy2 +Cx;\n                Zx2=Zx*Zx;\n                Zy2=Zy*Zy;\n            };\n            /* compute  pixel color (24 bit = 3 bytes) */\n            if (Iteration==IterationMax)\n            { /*  interior of Mandelbrot set = black */\n                color[0]=0;\n                color[1]=0;\n                color[2]=0;\n            }\n            else\n            { /* exterior of Mandelbrot set = white */\n                color[0]=255; /* Red*/\n                color[1]=255;  /* Green */\n                color[2]=255;/* Blue */\n            };\n            /*write color to the file*/\n            fwrite(color,1,3,fp);\n        }\n    }\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "visual-studio-2010", "compiler-errors"], "comments": [{"owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1496188553, "post_id": 44273627, "comment_id": 75554905, "body": "It&#39;s not exactly a pretty solution, but you can also force VC to compile the file as CPP without renaming it. The command line flag is <code>&#47;TP</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "edited": false, "score": 0, "creation_date": 1496189875, "post_id": 44273752, "comment_id": 75555222, "body": "I am trying to avoid wrapping around C++ methods"}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "edited": false, "score": 1, "creation_date": 1496192757, "post_id": 44273752, "comment_id": 75555784, "body": "@Zakir Why are you keen to avoid wrappers? If it&#39;s to avoid repeating code, then you can use tools like T4 with EnvDTE (both built-in to Visual Studio) to automatically generate a <code>.h</code> file for C based on your C++ code, and also use it to automatically generate a wrapper too."}, {"owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1496194607, "post_id": 44273752, "comment_id": 75556225, "body": "@Dai - I will play around with the tools Tnx!"}], "tags": [], "owner": {"reputation": 258, "user_id": 8083690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrIvk.png?s=128&g=1", "display_name": "Sam Pagenkopf", "link": "https://stackoverflow.com/users/8083690/sam-pagenkopf"}, "is_accepted": true, "score": 5, "last_activity_date": 1496189280, "creation_date": 1496189280, "answer_id": 44273752, "question_id": 44273627, "link": "https://stackoverflow.com/questions/44273627/calling-c-functions-from-a-c-src/44273752#44273752", "title": "Calling C++ functions from a C src", "body": "<p>First, <code>::</code> is not valid in C.</p>\n\n<p>Second, including a header is equivalent to copy-pasting a .h file into your C file. Your header must be valid C. Here's some deeper insight:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/2744181/how-to-call-c-function-from-c\">How to call C++ function from C?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/7281441/elegantly-call-c-from-c\">Elegantly call C++ from C</a></p>\n\n<p>Though, my alternative advice is, compile your C as C++. There's a chance it would take minimal or no work to turn out as valid C++.</p>\n"}], "owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 44273752, "answer_count": 1, "score": 2, "last_activity_date": 1496191871, "creation_date": 1496188291, "question_id": 44273627, "link": "https://stackoverflow.com/questions/44273627/calling-c-functions-from-a-c-src", "title": "Calling C++ functions from a C src", "body": "<p>I have mixed code base of C/C++ in a MS Visual Studio 2010 project and am trying to call a static function defined in C++ file from a C src file. Right now I get it to work by renaming the C src to CPP (a.c -> a.cpp) Just wondering if there's a more graceful way of getting around it (turning some magic compiler flags on etc) without doing any large scale surgery to the code base(like using opaque pointers as suggested in <a href=\"https://stackoverflow.com/questions/17739999/calling-c-function-from-a-c-code\">this</a> thread)</p>\n\n<p><em>Pls note my code base is pretty complex, I have created this small VS snippet to reproduce the error with bare minimum demonstrable code</em></p>\n\n<h2>a.c</h2>\n\n<pre><code>#include \"b.h\"\n\nvoid test()\n{\n  B::func();\n}\n</code></pre>\n\n<h2>b.h</h2>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nclass B{\npublic:\n  static void func();\n};\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<h2>b.cpp</h2>\n\n<pre><code>#include \"b.h\"\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nvoid B::func()\n{\n  return;\n}\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p><strong>Error:- In MS Visual Studio 2010</strong></p>\n\n<pre><code>1&gt;c:\\.....\\b.h(5): error C2061: syntax error : identifier 'B'\n1&gt;c:\\.....\\b.h(5): error C2059: syntax error : ';'\n1&gt;c:\\.....\\b.h(5): error C2449: found '{' at file scope (missing function header?)\n1&gt;c:\\.....\\b.h(8): error C2059: syntax error : '}'\n</code></pre>\n"}, {"tags": ["c", "pointers", "stack", "setjmp"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 9, "creation_date": 1496187774, "post_id": 44273496, "comment_id": 75554707, "body": "There&#39;s no way to implement <code>setjmp</code> and <code>longjmp</code> yourself in standard C. If this is really your assignment, you&#39;re going to be diving deep into undefined behavior land."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1496187819, "post_id": 44273496, "comment_id": 75554714, "body": "It&#39;s undefined behaviour to write your own function with the same name as a standard library function (even if you didn&#39;t include the header) . You shoudl call your functions something else"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1496187849, "post_id": 44273496, "comment_id": 75554724, "body": "Your <code>setjmp(r)</code> reads an uninitialized variable, which is also undefined behaviour in this context  , not clear what you are trying to do there"}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1496187966, "post_id": 44273496, "comment_id": 75554754, "body": "@M.M he tries to somehow save an address of a function parameter on stack to re-set $rsp later on based on the saved value <i>cries hysterically in x64</i>"}, {"owner": {"reputation": 345, "user_id": 3806257, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a480ce63f3ad0c64f1ec1acbb3dd66d3?s=128&d=identicon&r=PG&f=1", "display_name": "adventuredoge", "link": "https://stackoverflow.com/users/3806257/adventuredoge"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1496188011, "post_id": 44273496, "comment_id": 75554770, "body": "@user2357112 I&#39;m fully aware of this and think the homework given to us is really a terrible and dangerous way to teach programming, however, I&#39;m still required to do the assignment if I want to get a decent grade for the class."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "edited": false, "score": 0, "creation_date": 1496188025, "post_id": 44273496, "comment_id": 75554776, "body": "@iehrlich maybe passing <code>&amp;r</code> would match the intent better then"}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1496188104, "post_id": 44273496, "comment_id": 75554799, "body": "@M.M it&#39;s still a road to nowhere, since the offset between &amp;r and $rsp in the caller is unknown. At this point, I just wanted to clarify this moment for you :)"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1496188191, "post_id": 44273496, "comment_id": 75554822, "body": "@adventuredoge: Show us your actual assignment. You&#39;ve probably misunderstood what it&#39;s about."}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "edited": false, "score": 0, "creation_date": 1496188210, "post_id": 44273496, "comment_id": 75554827, "body": "@adventuredoge to my mind, it&#39;s actually a perfect and safest way to teach programming, since you can&#39;t just copy this homework mindlessly. That&#39;s why you are here - and you are learning something. Your teacher is awesome."}, {"owner": {"reputation": 345, "user_id": 3806257, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a480ce63f3ad0c64f1ec1acbb3dd66d3?s=128&d=identicon&r=PG&f=1", "display_name": "adventuredoge", "link": "https://stackoverflow.com/users/3806257/adventuredoge"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1496188387, "post_id": 44273496, "comment_id": 75554873, "body": "@user2357112 here&#39;s the instructions to my assignment: <a href=\"https://drive.google.com/open?id=0BxnhsPyPkMIsVXNTZnFyek1hdzg\" rel=\"nofollow noreferrer\">drive.google.com/open?id=0BxnhsPyPkMIsVXNTZnFyek1hdzg</a>"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1496188622, "post_id": 44273496, "comment_id": 75554919, "body": "Oh geeze, it really is just telling you to implement setjmp and longjmp. It&#39;s in the specific context of a MIPS simulator and a specific compiler, though. You&#39;re going to need to rely on the details of those things."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1496188866, "post_id": 44273496, "comment_id": 75554971, "body": "Seriously, though, no asm or builtins? How do they expect you to manipulate registers? Hopefully they provide something that isn&#39;t apparent from just this assignment sheet. The use of the uninitialized, apparently-useless <code>r</code> argument is straight from the assignment, too, and this thing has pre-standard, K&amp;R-style function definitions. I sympathize with you, but I don&#39;t know if there&#39;s much we can do to help."}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "edited": false, "score": 0, "creation_date": 1496189570, "post_id": 44273496, "comment_id": 75555141, "body": "At this point, I simply wrote a letter to the guy. Unfortunately, It was only after I sent the mail I realized there are actually number of them, but I <i>hope</i> I was lucky enough to pick the right target ^_^"}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496195762, "post_id": 44273496, "comment_id": 75556450, "body": "@DavidC.Rankin The overview (first full paragraph) makes it clear that isn&#39;t the intent: &quot;In this project, you will write the code of two C functions called setjmp() and longjmp()\u2026&quot;"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496195834, "post_id": 44273496, "comment_id": 75556465, "body": "Right you are, the non-highlighted part makes that clear. This will be fun..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1496222118, "post_id": 44273496, "comment_id": 75567881, "body": "@adventuredoge at this point I would consider <i>finding another school</i>."}], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 3806257, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a480ce63f3ad0c64f1ec1acbb3dd66d3?s=128&d=identicon&r=PG&f=1", "display_name": "adventuredoge", "link": "https://stackoverflow.com/users/3806257/adventuredoge"}, "edited": false, "score": 0, "creation_date": 1496190479, "post_id": 44273834, "comment_id": 75555347, "body": "Thank you! I&#39;ll experiment with this."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1496244468, "post_id": 44273834, "comment_id": 75584395, "body": "The stack grows downward, so you need positive offsets from locals to access the <code>lr</code>, not negative offsets."}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 4, "last_activity_date": 1496190034, "creation_date": 1496190034, "answer_id": 44273834, "question_id": 44273496, "link": "https://stackoverflow.com/questions/44273496/implementing-setjmp-and-longjmp-in-c-without-built-in-functions-or-assembly-get/44273834#44273834", "title": "Implementing setjmp and longjmp in C without built in functions or assembly (getting incorrect return values)", "body": "<p>Implementing <code>setjmp()</code> and <code>longjmp()</code> requires access to the stack pointer. Unfortunately, the assignment you're working from has <em>explicitly</em> banned you from using every sensible method to do this (i.e, using assembly, or using compiler builtins to access the stack pointer).</p>\n\n<p>What's worse is, they've mangled the definition of <code>setjmp()</code> and <code>longjmp()</code> in their sample code. The argument needs to be a type that resolves to an array (e.g, <code>typedef int jmp_buf[1]</code>), not an <code>int</code>\u2026</p>\n\n<p>Anyways. You need some way to reliably find the old stack pointer from a stack frame in C. Probably the best way of doing this will be to define an array on the stack, then look \"behind\" it\u2026</p>\n\n<pre><code>void get_sp(void) {\n    int x[1];\n    sp = x[-1]; // or -2 or -3, etc\u2026\n</code></pre>\n\n<p>The exact offset will depend on what compiler you're using, as well as possibly on what arguments your function takes and what other local variables the function has. <strong>You will need to experiment a bit to get this right.</strong> Run your application in the simulator, and/or look at the generated assembly, to make sure you're picking up the right value.</p>\n\n<p>The same trick will probably work to set the stack pointer when \"returning\" from <code>longjmp()</code>. However, certain compiler optimizations may make this difficult, especially on architectures with a link register -- such as MIPS. Make sure compiler optimizations are disabled. If all else fails, you may need to call a dummy function in <code>longjmp()</code> to force the compiler to save the link register on the stack, rather than leaving it in a register (where it can't be overwritten).</p>\n"}, {"tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": false, "score": 3, "last_activity_date": 1496247076, "last_edit_date": 1496247076, "creation_date": 1496218277, "answer_id": 44279163, "question_id": 44273496, "link": "https://stackoverflow.com/questions/44273496/implementing-setjmp-and-longjmp-in-c-without-built-in-functions-or-assembly-get/44279163#44279163", "title": "Implementing setjmp and longjmp in C without built in functions or assembly (getting incorrect return values)", "body": "<p>You are going to need to deal with the link register, the stack pointer, and the frame pointer (you would normally also have to save and restore all of the save registers, but I don't think we need to in order to make this example work).</p>\n\n<p>Take a look at the <code>arg3caller</code> function <a href=\"http://winfred-lu.blogspot.com/2009/12/mips-calling-convention-with-gcc.html\" rel=\"nofollow noreferrer\">here</a>.  Upon entry, it stores the link register and the frame pointer on the stack, and sets the frame pointer to point to the new stack frame.  It then calls <code>args3</code>, sets the return value, and, most importantly, copies the frame pointer back into the stack pointer.  It then pops the link register and the original frame pointer from where the stack pointer is now located, and jumps to the link register.  If you look at <code>args3</code>, it saves the frame pointer into the stack and then restores it from the stack.</p>\n\n<p>So, <code>arg3caller</code> can be <code>longjmp</code>, but if you want it to return with a different stack pointer than it entered with, you are going to have to change the frame pointer, because the frame pointer gets copied into the stack pointer at then end.  The frame pointer can be modified by having <code>args3</code> (a dummy function called by <code>longjmp</code>) modify the copy of the frame pointer that it saved in the stack.</p>\n\n<p>You will need to make <code>setjmp</code> also call a dummy function in order to get the link register and frame pointer stored on the stack in the same way.  You can then copy the link register and frame pointer out of <code>setjmp</code>'s stack frame into globals (normally, <code>setjmp</code> would copy stuff into the provided <code>jmpbuf</code>, but here, the arguments to <code>setjmp</code> and <code>longjmp</code> are useless, so you have to use globals), as well as the address of the frame.  Then, <code>longjmp</code> must copy the saved link register and frame pointer back into the same address, and have the dummy leaf function change the saved frame pointer to that same address.  Thus, the dummy leaf function will copy that address into the frame pointer and return to <code>longjmp</code>, which will copy it into the stack pointer.  It will then restore the frame pointer and the link register from that stack frame (that you populated), thus returning with everything in the state that it was when <code>setjmp</code> originally returned (except the return value will be different).</p>\n\n<p>Note that you can access these fields by using the negative indexing of a local array trick described by @duskwuff.  You should initially compile with the <code>-S</code> flag so that you can see what asm gcc is generating so that you can see where the important registers are being saved in the stack (and how your code might perturb all of that).</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I don't have immediate access to a MIPS gcc, but I found <a href=\"https://godbolt.org\" rel=\"nofollow noreferrer\">this</a>, and put it in MIPS gcc 5.4 mode.  Playing around, I found that non-leaf functions store <code>lr</code> and <code>fp</code> immediately below where the argument would be placed on the stack (the argument is actually passed in <code>a0</code>, but gcc leaves room for it on the stack in case the callee needs to store it).  By having <code>setjmp</code> call a leaf function, we can ensure that <code>setjmp</code> is a non-leaf so that its <code>lr</code> is saved on the stack.  We can then save the address of the arg, and the <code>lr</code> and <code>fp</code> that are stored immediately below it (using negative indexing), and return 0.  Then, in <code>longjmp</code>, we can call a leaf function to ensure the <code>lr</code> is saved on the stack, but also have the leaf change <em>its</em> stacked <code>fp</code> to the saved <code>sp</code>.  Upon return to <code>longjmp</code>, the <code>fp</code> will be pointing at the original frame, which we can re-populate with the saved <code>lr</code> and <code>fp</code>.  Returning from <code>longjmp</code> will copy the <code>fp</code> back into the <code>sp</code> and restore the <code>lr</code> and <code>fp</code> from our re-populated frame, making it appear that we are returning from <code>setjmp</code>.  This time however, we return 1 so the caller can differentiate the true return from <code>setjmp</code> to the fake one engineered by <code>longjmp</code>.</p>\n\n<p>Note that I have only eyeballed this code, and have not actually executed it!!  Also, it must be compiled with optimization disabled (<code>-O0</code>).  If you enable any kind of optimization, the compiler inlines the leaf functions and turns both <code>setjmp</code> and <code>longjmp</code> into empty functions.  You should see what your compiler does with this to understand how the stack frames are constructed.  Again, we're well and truly in the land of undefined behavior, and even changes in gcc version could upset everything.  You should also single step the program (using <code>gdb</code> or <code>spim</code>) to make sure you understand what's going on. </p>\n\n<pre><code>struct jmpbuf {\n    int lr;\n    int fp;\n    int *sp;\n};\n\nstatic struct jmpbuf ctx;\n\nstatic void setjmp_leaf(void) { }\n\nint setjmp(int arg)\n{\n    // call the leaf so that our lr is saved\n    setjmp_leaf();\n\n    // the address of our arg should be immediately\n    // above the lr and fp\n    ctx.sp = &amp;arg;\n\n    // lr is immediately below arg\n    ctx.lr = (&amp;arg)[-1];\n\n    // fp is below that\n    ctx.fp = (&amp;arg)[-2];\n\n    return 0;\n}\n\nstatic void longjmp_leaf(int arg)\n{\n    // overwrite the caller's frame pointer\n    (&amp;arg)[-1] = (int)ctx.sp;\n}\n\nint longjmp(int arg)\n{\n    // call the leaf so that our lr is saved\n    // but also to change our fp to the save sp\n    longjmp_leaf(arg);\n\n    // repopulate the new stack frame with the saved\n    // lr and fp.  &amp;arg is calculated relative to fp,\n    // which was modified by longjmp_leaf.  &amp;arg isn't\n    // where it used to be!\n    (&amp;arg)[-1] = ctx.lr;\n    (&amp;arg)[-2] = ctx.fp;\n\n    // this should restore the saved fp and lr\n    // from the new frame, so it looks like we're\n    // returning from setjmp\n    return 1;\n}\n</code></pre>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 345, "user_id": 3806257, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a480ce63f3ad0c64f1ec1acbb3dd66d3?s=128&d=identicon&r=PG&f=1", "display_name": "adventuredoge", "link": "https://stackoverflow.com/users/3806257/adventuredoge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1964, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1496247076, "creation_date": 1496187444, "last_edit_date": 1496189655, "question_id": 44273496, "link": "https://stackoverflow.com/questions/44273496/implementing-setjmp-and-longjmp-in-c-without-built-in-functions-or-assembly-get", "title": "Implementing setjmp and longjmp in C without built in functions or assembly (getting incorrect return values)", "body": "<p>I'm trying to test 2 of my functions that sort of mimic setjmp and longjmp for a homework - which is pretty difficult since we're not allowed to use built in functions or assembly asm() to implement the longjmp and setjmp functions. (Yes, <a href=\"https://drive.google.com/open?id=0BxnhsPyPkMIsVXNTZnFyek1hdzg\" rel=\"noreferrer\">that's really the assignment</a>.)</p>\n\n<p><strong>Problem</strong>: I keep getting wrong return values. So, in short, when main() calls foo() and foo() calls bar(), and bar() calls longjump(), then bar() should not return to foo() but instead setjmp() should return to main with return value of 1 which should print \"error\" (see main() below). </p>\n\n<p>Instead, my output comes out as: </p>\n\n<pre><code>start foo\nstart bar\nsegmentation fault\n</code></pre>\n\n<p>The segmentation fault, i tried fixing by initializing the pointer *p with malloc, but that didn't seem to do anything. Although, would the segmentation fault, be the reason why im not getting the correct return values?</p>\n\n<p><strong>code:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint setjmp(int v);\nint longjmp(int v);\nint foo(void);\nint bar(void);\nint *add;\n\n\nint main(void) {\n\n    int r;\n\n    r = setjmp(r);\n    if(r == 0) {\n        foo();\n        return(0);\n    } else {\n        printf(\"error\\n\");\n        return(2);\n    }\n\n}\n\nint _main(void) {\n    return(0);\n}\n\nint setjmp(int v)\n{\n    add = &amp;v;\n    return(0);\n}\n\nint longjmp(int v)\n{\n    int *p;\n    p = &amp;v;\n    *(p - 1) = *add;\n    return(1);\n}\n\nint foo(void) {\n    printf(\"start foo\\n\");\n    bar();\n    return(0);\n}\n\nint bar(void) {\n    int d;\n    printf(\"start bar\\n\");\n    longjmp(d);\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "performance", "simd", "altivec"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1496206034, "post_id": 44273494, "comment_id": 75558894, "body": "<i>How</i> are you measuring this? How <i>often</i> did you measure this? In what <i>order</i> are you running the two tests? Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1496227474, "post_id": 44273494, "comment_id": 75571738, "body": "Those times seem very high - are you compiling with optimisation enabled (e.g. <code>-O3</code>) ? Also, what CPU are you using and what is the clock speed ?"}, {"owner": {"reputation": 149, "user_id": 1452175, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2347005b2da130e1e57d66e1d2455f6b?s=128&d=identicon&r=PG", "display_name": "shaboinkin", "link": "https://stackoverflow.com/users/1452175/shaboinkin"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496231190, "post_id": 44273494, "comment_id": 75574292, "body": "@eof I editted my post containing a working example. At first i was only running once, but I now loop through the two routines I&#39;m measuring and the times are consistent. Adding takes 81ms and multiplying takes 48ms.  As stated in my post, I was simply using std::chrono::high_resolution_clock to measure the times. Is there a better alternative?"}, {"owner": {"reputation": 149, "user_id": 1452175, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2347005b2da130e1e57d66e1d2455f6b?s=128&d=identicon&r=PG", "display_name": "shaboinkin", "link": "https://stackoverflow.com/users/1452175/shaboinkin"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1496231194, "post_id": 44273494, "comment_id": 75574296, "body": "@PaulR, I&#39;m using NXP&#39;s T2080 board which contains a quad core e6500 CPU at 1.8GHz. I was using -O2, not O3."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1496232974, "post_id": 44273494, "comment_id": 75575734, "body": "@shaboinkin: OK - presumably this is gcc, but <code>-O2</code> should be OK. I would try <code>-O3</code> anyway. I think you might also want to try manually unrolling the add loop by a factor of 2, as you have a lot of overhead on each iteration for just one add instruction."}, {"owner": {"reputation": 149, "user_id": 1452175, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2347005b2da130e1e57d66e1d2455f6b?s=128&d=identicon&r=PG", "display_name": "shaboinkin", "link": "https://stackoverflow.com/users/1452175/shaboinkin"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1496234470, "post_id": 44273494, "comment_id": 75576827, "body": "@PaulR I understand loop unrolling but not with a potentially variable number of iterations that needs to be done. Could you explain what you mean by &quot;a factor of 2&quot;? Does this mean to do additional adds within each iteration? Add, store, increment pointers, add, store, increment, then loop again?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1496235868, "post_id": 44273494, "comment_id": 75577848, "body": "Yes, manual unrolling the add loop by a factor of 2 would be 4 x vec_ld, 2 x vec_add, 2 x vec_st. Use hard-coded offsets for the loads and stores and then only increment the pointers once per loop iteration (<code>+= 2</code>). This helps to bury some of the load/store latencies and also reduces the loop overheads."}, {"owner": {"reputation": 149, "user_id": 1452175, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2347005b2da130e1e57d66e1d2455f6b?s=128&d=identicon&r=PG", "display_name": "shaboinkin", "link": "https://stackoverflow.com/users/1452175/shaboinkin"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1496248821, "post_id": 44273494, "comment_id": 75587147, "body": "@PaulR I tried O3 with no difference. Unrolling didn&#39;t make a difference either, so I did it by a factor of 4 and curiously, it&#39;s taking about 1ms longer than without the unrolling."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1496250417, "post_id": 44273494, "comment_id": 75588139, "body": "It&#39;s possible that the compiler is already unrolling the loop, so it may not help. I think the next thing I would do is look at the generated code and/or run the code under a (sampling) profiler."}, {"owner": {"reputation": 149, "user_id": 1452175, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2347005b2da130e1e57d66e1d2455f6b?s=128&d=identicon&r=PG", "display_name": "shaboinkin", "link": "https://stackoverflow.com/users/1452175/shaboinkin"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1496251849, "post_id": 44273494, "comment_id": 75588970, "body": "@PaulR That&#39;s what I just did actually. I edited my post to include what I recorded using the perf tool. So while less instructions are required to perform the addition, it seems that memory access is the bottleneck, no?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1496263445, "post_id": 44273494, "comment_id": 75595083, "body": "Yes, it could be a DRAM bandwidth bottleneck, although I would have thought this would be much the same limitation for both routines. Try reducing the total size of your data to something that will fit comfortably in L2 cache (you&#39;ll need to increase the no of iterations to still get a reasonable timing interval of course)."}, {"owner": {"reputation": 4311, "user_id": 1669370, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/E2t7h.jpg?s=128&g=1", "display_name": "Regis Portalez", "link": "https://stackoverflow.com/users/1669370/regis-portalez"}, "edited": false, "score": 0, "creation_date": 1496307936, "post_id": 44273494, "comment_id": 75611461, "body": "My two cents : isn&#39;t that related to the fact that you multiply int16 and add int32? vector of int16 likely are twice wider than vectors of int32..."}, {"owner": {"reputation": 149, "user_id": 1452175, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2347005b2da130e1e57d66e1d2455f6b?s=128&d=identicon&r=PG", "display_name": "shaboinkin", "link": "https://stackoverflow.com/users/1452175/shaboinkin"}, "reply_to_user": {"reputation": 4311, "user_id": 1669370, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/E2t7h.jpg?s=128&g=1", "display_name": "Regis Portalez", "link": "https://stackoverflow.com/users/1669370/regis-portalez"}, "edited": false, "score": 0, "creation_date": 1496318797, "post_id": 44273494, "comment_id": 75619196, "body": "@RegisPortalez My understanding is that each vector instruction always processes 16 bytes of data. The vec_add instruction, regardless of if it processes 16 bytes of chars, shorts, or ints, uses an instruction, vadduwm, which requires only 1 cycle. And the vec_mule/vec_mulo instruction for a processing shorts maps to an instruction, vmuleuh, which requires 4 cycles. Multiplying chars requires a different instruction however, it also requires 4 cycles."}, {"owner": {"reputation": 4311, "user_id": 1669370, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/E2t7h.jpg?s=128&g=1", "display_name": "Regis Portalez", "link": "https://stackoverflow.com/users/1669370/regis-portalez"}, "edited": false, "score": 0, "creation_date": 1496326212, "post_id": 44273494, "comment_id": 75625032, "body": "in your code, you allocate size * sizeof(int16), which is half of size*sizeof(int32). Since you code is memory bound, and TestMultiply operates on half the size, it runs twice faster (or close to, since the write array has the same size). You probably have a 1.5X speedup"}, {"owner": {"reputation": 149, "user_id": 1452175, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2347005b2da130e1e57d66e1d2455f6b?s=128&d=identicon&r=PG", "display_name": "shaboinkin", "link": "https://stackoverflow.com/users/1452175/shaboinkin"}, "reply_to_user": {"reputation": 4311, "user_id": 1669370, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/E2t7h.jpg?s=128&g=1", "display_name": "Regis Portalez", "link": "https://stackoverflow.com/users/1669370/regis-portalez"}, "edited": false, "score": 0, "creation_date": 1496344211, "post_id": 44273494, "comment_id": 75636202, "body": "@RegisPortalez wow..not sure how I completely missed that."}], "answers": [{"tags": [], "owner": {"reputation": 4311, "user_id": 1669370, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/E2t7h.jpg?s=128&g=1", "display_name": "Regis Portalez", "link": "https://stackoverflow.com/users/1669370/regis-portalez"}, "is_accepted": true, "score": 2, "last_activity_date": 1496327224, "creation_date": 1496327224, "answer_id": 44310229, "question_id": 44273494, "link": "https://stackoverflow.com/questions/44273494/simd-with-altivec-why-is-multiplying-two-vectors-faster-than-adding-two-vectors/44310229#44310229", "title": "SIMD with Altivec: why is multiplying two vectors faster than adding two vectors?", "body": "<p>It's related to sizes of your input buffers. </p>\n\n<p>in one case (TestAdd) : </p>\n\n<pre><code>int size = 10'485'760;\nint bytes = size * sizeof(int32_t);\n\nint32_t* inputABuffer = (int32_t*) memalign(64, bytes);\nint32_t* inputBBuffer = (int32_t*) memalign(64, bytes);\nint32_t* outputBuffer = (int32_t*) memalign(64, bytes);\n</code></pre>\n\n<p>you allocate 3 * size * 4 bytes (sizeof(int32_t) = 4)</p>\n\n<p>in the other (test_mul) : </p>\n\n<pre><code>int size = 10'485'760;\nint16_t* inputABuffer = (int16_t*) memalign(64, size * sizeof(int16_t));\nint16_t* inputBBuffer = (int16_t*) memalign(64, size * sizeof(int16_t));\nint32_t* outputBuffer = (int32_t*) memalign(64, size * sizeof(int32_t));\n</code></pre>\n\n<p>you allocate size*4 + 2*size*2 (sizeof(int16_t) = 2)</p>\n\n<p>Since this code is entirely memory bound, second code is (3*4) / (4 + 2*2) = <strong>1.5x faster</strong>. </p>\n\n<p>This is in line with your measurements since 2.15 / 1.5 = 1.43, which is close to 1.58. </p>\n"}], "owner": {"reputation": 149, "user_id": 1452175, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2347005b2da130e1e57d66e1d2455f6b?s=128&d=identicon&r=PG", "display_name": "shaboinkin", "link": "https://stackoverflow.com/users/1452175/shaboinkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 44310229, "answer_count": 1, "score": 0, "last_activity_date": 1496327224, "creation_date": 1496187437, "last_edit_date": 1496251753, "question_id": 44273494, "link": "https://stackoverflow.com/questions/44273494/simd-with-altivec-why-is-multiplying-two-vectors-faster-than-adding-two-vectors", "title": "SIMD with Altivec: why is multiplying two vectors faster than adding two vectors?", "body": "<p>I've been implementing basic math operations using altivec as a way to learn simd for an upcoming project. Also, just as a way to see the performance benefit of it, I track how long it takes to perform the operations, but I came across something odd.</p>\n\n<p>The first thing I did was add two vectors together and subtract two vectors. This works fine. The next thing I did was multiply two vectors together. However, multiplying is faster than adding, even though less clock cycles are used to add verses multiplying according to what my particular CPU's datasheet says about the instructions being used.</p>\n\n<p>I have two arrays that are each 10MBs large and run them through these two routines:</p>\n\n<pre><code>void av_AddValues(int32_t* intArrayA, int32_t* intArrayB, int32_t* outputBuffer, int size)\n{\n  int iterations = size / (sizeof(__vector int32_t) / sizeof(int32_t));\n\n  __vector int32_t* tempA = (__vector int32_t *) intArrayA;\n  __vector int32_t* tempB = (__vector int32_t *) intArrayB;\n  __vector int32_t* tempOut = (__vector int32_t *) outputBuffer;\n  for(int i = 0; i &lt; iterations; i++)\n  {\n    __vector int32_t sum = vec_add(*tempA, *tempB);\n    vec_st(sum, 0, tempOut);\n\n    tempA++;\n    tempB++;\n    tempOut++;\n  }\n}\n\n  void av_MultiplyValues(int16_t* intArrayA, int16_t* intArrayB, int32_t* outputBuffer, int size)\n  {\n    int iterations = size / (sizeof(__vector int16_t) / sizeof(int16_t));\n    __vector int16_t* tempA = (__vector int16_t *) intArrayA;\n    __vector int16_t* tempB = (__vector int16_t *) intArrayB;\n    __vector int32_t* tempOut = (__vector int32_t *) outputBuffer;\n\n\n    for(int i = 0; i &lt; iterations; i++)\n    {\n      __vector int32_t productEven = vec_mule(*tempA, *tempB);\n      __vector int32_t productOdd = vec_mulo(*tempA, *tempB);\n\n      __vector int32_t mergedProductHigh = vec_mergeh(productEven, productOdd);\n      __vector int32_t mergedProductLow = vec_mergel(productEven, productOdd);\n\n      vec_st(mergedProductHigh, 0, tempOut);\n      tempOut++;\n      vec_st(mergedProductLow, 0, tempOut);\n\n      tempA++;\n      tempB++;\n      tempOut++;\n    }\n  }\n</code></pre>\n\n<p>On my particular platform, av_AddValues takes 81ms to process and av_MultiplyValues takes 48ms to process. (Times recorded using std::chrono::high_resolution_clock)</p>\n\n<p>Why does multiplying take less time to process than adding? </p>\n\n<p>I don't think adding 32bit values verses multiplying 16bit values makes a difference considering the __vector type always processing 16 bytes of data. </p>\n\n<p>My first thought was that since adding numbers together is such a trivial task, the CPU finishes the operation faster than it can fetch data from memory. Whereas with multiplying, this latency of fetching is hidden by the fact the CPU is busy doing work and never has to wait as long. </p>\n\n<p>Is this a correct assumption to make?</p>\n\n<p>Full code:</p>\n\n<pre><code>#include &lt;chrono&gt;\n#include &lt;random&gt;\n#include &lt;limits&gt;\n\n#include &lt;iostream&gt;\n#include &lt;cassert&gt;\n#include &lt;cstring&gt;\n#include &lt;cstdint&gt;\n#include &lt;malloc.h&gt;\n\n#include &lt;altivec.h&gt;\n#undef vector\n\nvoid GenerateRandom16bitValues(int16_t* inputABuffer, int16_t* inputBBuffer, int32_t* outputBuffer, int size);\nvoid GenerateRandom32bitValues(int32_t* inputABuffer, int32_t* inputBBuffer, int32_t* outputBuffer, int size);\nvoid TestAdd();\nvoid TestMultiply();\nvoid av_AddValues(int32_t* intArrayA, int32_t* intArrayB, int32_t* outputBuffer, int size);\nvoid av_MultiplyValues(int16_t* intArrayA, int16_t* intArrayB, int32_t* outputBuffer, int size);\n\nint main()\n{\n  TestAdd();\n  TestMultiply();\n}\n\nvoid GenerateRandom16bitValues(int16_t* inputABuffer, int16_t* inputBBuffer, int32_t* outputBuffer, int size)\n{\n  std::random_device rd;\n  std::mt19937 gen(rd());\n  std::uniform_int_distribution&lt;&gt; dis(std::numeric_limits&lt;int16_t&gt;::min(), std::numeric_limits&lt;int16_t&gt;::max());\n\n  for(int i = 0; i &lt; size; i++)\n  {\n    inputABuffer[i] = dis(gen);\n    inputBBuffer[i] = dis(gen);\n    outputBuffer[i] = 0;\n  }\n}\n\nvoid GenerateRandom32bitValues(int32_t* inputABuffer, int32_t* inputBBuffer, int32_t* outputBuffer, int size)\n{\n  std::random_device rd;\n  std::mt19937 gen(rd());\n  std::uniform_int_distribution&lt;&gt; dis(std::numeric_limits&lt;int32_t&gt;::min(), std::numeric_limits&lt;int32_t&gt;::max());\n\n  for(int i = 0; i &lt; size; i++)\n  {\n    inputABuffer[i] = dis(gen);\n    inputBBuffer[i] = dis(gen);\n    outputBuffer[i] = 0;\n  }\n}\n\nvoid TestAdd()\n{\n    int size = 10'485'760;\n    int bytes = size * sizeof(int32_t);\n\n    int32_t* inputABuffer = (int32_t*) memalign(64, bytes);\n    int32_t* inputBBuffer = (int32_t*) memalign(64, bytes);\n    int32_t* outputBuffer = (int32_t*) memalign(64, bytes);\n    assert(inputABuffer != nullptr);\n    assert(inputBBuffer != nullptr);\n    assert(outputBuffer != nullptr);\n\n    GenerateRandom32bitValues(inputABuffer, inputBBuffer, outputBuffer, size);\n\n    for(int i = 0; i &lt; 20; i++)\n    {\n      auto start = std::chrono::high_resolution_clock::now();\n      av_AddValues(inputABuffer, inputBBuffer, outputBuffer, size);\n      auto end = std::chrono::high_resolution_clock::now();\n      auto diff = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end - start);\n\n      for(int k = 0; k &lt; size; k++)\n      {\n        assert(outputBuffer[k] == (inputABuffer[k] + inputBBuffer[k]));\n      }\n\n      std::cout &lt;&lt; \"Vector Sum - \" &lt;&lt; diff.count() &lt;&lt; \"ms\\n\";\n      memset(outputBuffer, 0, size);\n    }\n}\n\nvoid TestMultiply()\n{\n    int size = 10'485'760;\n    int16_t* inputABuffer = (int16_t*) memalign(64, size * sizeof(int16_t));\n    int16_t* inputBBuffer = (int16_t*) memalign(64, size * sizeof(int16_t));\n    int32_t* outputBuffer = (int32_t*) memalign(64, size * sizeof(int32_t));\n    assert(inputABuffer != nullptr);\n    assert(inputBBuffer != nullptr);\n    assert(outputBuffer != nullptr);\n\n    GenerateRandom16bitValues(inputABuffer, inputBBuffer, outputBuffer, size);\n\n    for(int i = 0; i &lt; 20; i++)\n    {\n      auto start = std::chrono::high_resolution_clock::now();\n      av_MultiplyValues(inputABuffer, inputBBuffer, outputBuffer, size);\n      auto end = std::chrono::high_resolution_clock::now();\n      auto diff = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end - start);\n\n      for(int k = 0; k &lt; size; k++)\n      {\n        assert(outputBuffer[k] == (inputABuffer[k] * inputBBuffer[k]));\n      }\n\n      std::cout &lt;&lt; \"Vector product - \" &lt;&lt; diff.count() &lt;&lt; \"ms\\n\";\n      memset(outputBuffer, 0, size);\n    }\n}\n\nvoid av_AddValues(int32_t* intArrayA, int32_t* intArrayB, int32_t* outputBuffer, int size)\n{\n  int iterations = size / (sizeof(__vector int32_t) / sizeof(int32_t));\n\n  __vector int32_t* tempA = (__vector int32_t *) intArrayA;\n  __vector int32_t* tempB = (__vector int32_t *) intArrayB;\n  __vector int32_t* tempOut = (__vector int32_t *) outputBuffer;\n\n  for(int i = 0; i &lt; iterations; i++)\n  {\n    __vector int32_t sum = vec_add(*tempA, *tempB);\n    vec_st(sum, 0, tempOut);\n\n    tempA++;\n    tempB++;\n    tempOut++;\n  }\n}\n\nvoid av_MultiplyValues(int16_t* intArrayA, int16_t* intArrayB, int32_t* outputBuffer, int size)\n{\n  int iterations = size / (sizeof(__vector int16_t) / sizeof(int16_t));\n  __vector int16_t* tempA = (__vector int16_t *) intArrayA;\n  __vector int16_t* tempB = (__vector int16_t *) intArrayB;\n  __vector int32_t* tempOut = (__vector int32_t *) outputBuffer;\n  for(int i = 0; i &lt; iterations; i++)\n  {\n    __vector int32_t productEven = vec_mule(*tempA, *tempB);\n    __vector int32_t productOdd = vec_mulo(*tempA, *tempB);\n\n    __vector int32_t mergedProductHigh = vec_mergeh(productEven, productOdd);\n    __vector int32_t mergedProductLow = vec_mergel(productEven, productOdd);\n\n    vec_st(mergedProductHigh, 0, tempOut);\n    tempOut++;\n    vec_st(mergedProductLow, 0, tempOut);\n\n    tempA++;\n    tempB++;\n    tempOut++;\n  }\n}\n</code></pre>\n\n<p>Output of perf stat and perf record:</p>\n\n<pre><code>  Adding\n   Performance counter stats for './alti':\n\n         2151.146080      task-clock (msec)         #    0.999 CPUs utilized          \n                   9      context-switches          #    0.004 K/sec                  \n                   0      cpu-migrations            #    0.000 K/sec                  \n               30957      page-faults               #    0.014 M/sec                  \n          3871497132      cycles                    #    1.800 GHz                    \n     &lt;not supported&gt;      stalled-cycles-frontend  \n     &lt;not supported&gt;      stalled-cycles-backend   \n          1504538891      instructions              #    0.39  insns per cycle        \n           234038234      branches                  #  108.797 M/sec                  \n              687912      branch-misses             #    0.29% of all branches        \n           270305159      L1-dcache-loads           #  125.656 M/sec                  \n            79819113      L1-dcache-load-misses     #   29.53% of all L1-dcache hits  \n     &lt;not supported&gt;      LLC-loads                \n     &lt;not supported&gt;      LLC-load-misses          \n\n         2.152697186 seconds time elapsed\n\n\n  CPU Utilization\n    76.04%  alti     alti                 [.] av_AddValues    \n\n  Multiply\n\n  Performance counter stats for './alti':\n\n         1583.016640      task-clock (msec)         #    0.999 CPUs utilized          \n                   4      context-switches          #    0.003 K/sec                  \n                   0      cpu-migrations            #    0.000 K/sec                  \n               20717      page-faults               #    0.013 M/sec                  \n          2849050875      cycles                    #    1.800 GHz                    \n     &lt;not supported&gt;      stalled-cycles-frontend  \n     &lt;not supported&gt;      stalled-cycles-backend   \n          1520409634      instructions              #    0.53  insns per cycle        \n           179185029      branches                  #  113.192 M/sec                  \n              535437      branch-misses             #    0.30% of all branches        \n           205341530      L1-dcache-loads           #  129.715 M/sec                  \n            27124936      L1-dcache-load-misses     #   13.21% of all L1-dcache hits  \n     &lt;not supported&gt;      LLC-loads                \n     &lt;not supported&gt;      LLC-load-misses          \n\n         1.584145737 seconds time elapsed\n\n\n  CPU Utilization\n    60.35%  alti     alti               [.] av_MultiplyValues       \n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1496186125, "post_id": 44273294, "comment_id": 75554310, "body": "<code>list = currP-&gt;next;</code> is important, as it is meaningless to the <i>caller</i>. the value of list, a pointer, is just that; a <i>value</i>. You need to either pass the pointer by address (a pointer to pointer) or utilize the otherwise unused return result to always return the list head and utilize it accordingly."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496186545, "post_id": 44273294, "comment_id": 75554423, "body": "You should not try to do linked list in C before understand C basic."}], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 6044264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2d52296c121703ff0ec78ea27c0dea?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Fighter", "link": "https://stackoverflow.com/users/6044264/phil-fighter"}, "is_accepted": false, "score": 0, "last_activity_date": 1496234466, "creation_date": 1496234466, "answer_id": 44285125, "question_id": 44273294, "link": "https://stackoverflow.com/questions/44273294/deleting-an-element-from-a-linked-list/44285125#44285125", "title": "Deleting an element from a linked list", "body": "<p>First: It seems that no element for the deletion was found. If it was found the <code>return</code> statement would end the function and the <code>printList(list)</code> function would not be called. </p>\n\n<p>Second: Use <code>break</code> to jump out of the <code>for</code> loop instead of <code>return</code>.</p>\n\n<p>Third: your <code>deleteElement()</code> should return the pointer to <code>list</code> for that case you <code>free</code> the first element. Then, inside the function the list is set to the new first element but if you don't return the new address your list is just a freed element and could cause a segmentation fault when you call the element the next time.</p>\n"}], "owner": {"reputation": 435, "user_id": 5698052, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/434d5a14472ab4af358f565d8d107b2b?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/5698052/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496234466, "creation_date": 1496185955, "last_edit_date": 1496196206, "question_id": 44273294, "link": "https://stackoverflow.com/questions/44273294/deleting-an-element-from-a-linked-list", "title": "Deleting an element from a linked list", "body": "<p>I have some issues with deleting an element from a given linked list. Here's what I've got: </p>\n\n<pre><code>void deleteElement(node *list)\n{\n    node *currP, *prevP = NULL;\n\n    for (currP = list; currP != NULL; prevP = currP, currP = currP-&gt;next) {\n\n        if(currP-&gt;info.name[0] == 'A') {  /* Found it. */\n            if (prevP == NULL) {\n                list = currP-&gt;next;\n            } else {\n                prevP-&gt;next = currP-&gt;next;\n            }\n\n            free(currP);\n            return;\n        }\n    }\n    printList(list);\n}\n</code></pre>\n\n<p>Written in that way the printList function prints me the whole list and it's like nothing had been deleted. Any ideas on what's wrong? </p>\n"}, {"tags": ["c", "directive"], "comments": [{"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 2, "creation_date": 1496180737, "post_id": 44272447, "comment_id": 75552780, "body": "<code>##</code> might work: <code>#define FUNCTION(k) FUNCTION ## k</code>. Even if this does work, you can only do it by literal (i.e., you can&#39;t use a variable from your code). Another way is to use function pointers and do the selection dynamically in your code. Without more information, it would be hard to help."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 2, "creation_date": 1496180748, "post_id": 44272447, "comment_id": 75552785, "body": "Why do you think <code>#define</code> is  a function? Also why do this - just to make code unreadable?"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1496180790, "post_id": 44272447, "comment_id": 75552797, "body": "@EdHeal. Good call, this does look like a potential XY problem. OP, please provide more information."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1496180809, "post_id": 44272447, "comment_id": 75552813, "body": "First, those aren&#39;t functions; they&#39;re preprocessor macros. Second, how does passing a constant as a macro argument make this <i>any</i> easier than specifying a different macro name in the first place? Whether you somehow used <code>FUNCTION(1)</code> or <code>FUNCTION1</code>, you&#39;re still typing <code>FUNCTION</code> and you&#39;re still typing <code>1</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1496181082, "post_id": 44272447, "comment_id": 75552930, "body": "@WhozCraig Maybe instead of <code>1</code> he uses another macro: <code>#define BLAH 1</code> then <code>FUNCTION(BLAH)</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1496181135, "post_id": 44272447, "comment_id": 75552953, "body": "There is only one function and that is <code>printf</code>! A macro is no way a function. And this is an XY problem."}, {"owner": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "reply_to_user": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1496181540, "post_id": 44272447, "comment_id": 75553085, "body": "@MadPhysicist How do you make a dynamic function selection in the code?  Do you have an example?"}, {"owner": {"reputation": 47629, "user_id": 900873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/704ea9ee0d9090f571599bdf5f95eb39?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/900873/kevin"}, "edited": false, "score": 1, "creation_date": 1496182275, "post_id": 44272447, "comment_id": 75553279, "body": "If you need to choose at runtime, you&#39;d generally use real functions (as opposed to preprocessor macros) and an array of function pointers you index into. But I suspect there&#39;s a better solution for you, so tell us what your end goal is."}, {"owner": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "reply_to_user": {"reputation": 47629, "user_id": 900873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/704ea9ee0d9090f571599bdf5f95eb39?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/900873/kevin"}, "edited": false, "score": 0, "creation_date": 1496182903, "post_id": 44272447, "comment_id": 75553489, "body": "@Kevin OK.  I updated it.  Though I still don&#39;t understand, why in this case not asking the &quot;minimal working example&quot; is not the desired thing..."}], "answers": [{"comments": [{"owner": {"reputation": 474, "user_id": 7881015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7fstm8cSRSI/AAAAAAAAAAI/AAAAAAAAAd4/i75UzXckPQE/photo.jpg?sz=128", "display_name": "Ho Zong", "link": "https://stackoverflow.com/users/7881015/ho-zong"}, "reply_to_user": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "edited": false, "score": 0, "creation_date": 1496184100, "post_id": 44272647, "comment_id": 75553822, "body": "I read that after wrote my answer. I do not know why others answer in comments?"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 1, "creation_date": 1496194665, "post_id": 44272647, "comment_id": 75556234, "body": "It was my comment. I wasn&#39;t sure what OP wanted at the time, so didn&#39;t answer. Have an upvote."}, {"owner": {"reputation": 474, "user_id": 7881015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7fstm8cSRSI/AAAAAAAAAAI/AAAAAAAAAd4/i75UzXckPQE/photo.jpg?sz=128", "display_name": "Ho Zong", "link": "https://stackoverflow.com/users/7881015/ho-zong"}, "edited": false, "score": 0, "creation_date": 1496224571, "post_id": 44272647, "comment_id": 75569716, "body": "The real functional solution is also a good one, and more usual. There can be cases though when you want to solve it in compile time, for example performance reasons, also when the other function is never invoked in that place, eg. developing for different architectures. It is also possible in this case that the other function not even exists on that arch."}], "tags": [], "owner": {"reputation": 474, "user_id": 7881015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7fstm8cSRSI/AAAAAAAAAAI/AAAAAAAAAd4/i75UzXckPQE/photo.jpg?sz=128", "display_name": "Ho Zong", "link": "https://stackoverflow.com/users/7881015/ho-zong"}, "is_accepted": false, "score": 4, "last_activity_date": 1496181653, "creation_date": 1496181653, "answer_id": 44272647, "question_id": 44272447, "link": "https://stackoverflow.com/questions/44272447/can-you-choose-define-based-on-parameter/44272647#44272647", "title": "Can you choose #define based on parameter?", "body": "<p>You can paste the macro argument into other words without separator, using the <code>##</code> construct. So here this will work:</p>\n\n<pre><code>#define FUNCTION(k) FUNCTION##k\n</code></pre>\n\n<p><a href=\"https://tio.run/##S9ZNT07@/185My85pzQlVcGmuCQlM18vw45LOSU1LTMvVcEt1M85xNPfz1ChoCgzryRNQyktP19JE0PeCC6flFiERd4YLh@TB5TGkNfI1oSzlZWzubiAihVyEzPzFDQ0Faq5OOHqDDWtkXhGKDxjIK/2/38A\" rel=\"nofollow noreferrer\" title=\"C (gcc) \u2013 Try It Online\">Try it online!</a></p>\n"}, {"comments": [{"owner": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "edited": false, "score": 0, "creation_date": 1496183145, "post_id": 44272827, "comment_id": 75553557, "body": "What is the effect of the <code>(void)</code> when you say <code>func0(void)</code>?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "edited": false, "score": 0, "creation_date": 1496183208, "post_id": 44272827, "comment_id": 75553572, "body": "(void) = Without parameters"}, {"owner": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "edited": false, "score": 0, "creation_date": 1496183228, "post_id": 44272827, "comment_id": 75553580, "body": "Why not just say <code>()</code> then?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "edited": false, "score": 1, "creation_date": 1496183344, "post_id": 44272827, "comment_id": 75553617, "body": "() = can take anything for its arguments"}, {"owner": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "edited": false, "score": 0, "creation_date": 1496183424, "post_id": 44272827, "comment_id": 75553640, "body": "I never heard that...  can you give a reference so I can read where the passed arguments would go for a <code>()</code> function?"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 2, "creation_date": 1496194602, "post_id": 44272827, "comment_id": 75556221, "body": "I fully endorse this message:)"}, {"owner": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "reply_to_user": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1496248419, "post_id": 44272827, "comment_id": 75586921, "body": "@MadPhysicist It looks like both of the answers to this question are based off of your single comment.  Now <i>that</i>, is pretty genius. :D"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 2, "last_activity_date": 1496182810, "creation_date": 1496182810, "answer_id": 44272827, "question_id": 44272447, "link": "https://stackoverflow.com/questions/44272447/can-you-choose-define-based-on-parameter/44272827#44272827", "title": "Can you choose #define based on parameter?", "body": "<p>@MadPhysicist suggests something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstatic void func0(void) { printf(\"0\\n\"); }\nstatic void func1(void) { printf(\"1\\n\"); }\nstatic void func2(void) { printf(\"2\\n\"); }\nstatic void func3(void) { printf(\"3\\n\"); }\n\nstatic void (*func[])(void) = {func0, func1, func2, func3};\n\nint main(void)\n{\n    func[1]();\n    return 0;\n}\n</code></pre>\n\n<p>This has an advantage: you are not limited to compile time literals:</p>\n\n<pre><code>for (int i = 0; i &lt; 3; i++) {\n     FUNCTION(i); /* invalid */\n     func[i](); /* valid */\n}\n</code></pre>\n"}], "owner": {"reputation": 826, "user_id": 1715099, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/623042c376d81e406a14cfd5607b127c?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1715099/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 44272827, "answer_count": 2, "score": 0, "last_activity_date": 1496182823, "creation_date": 1496180606, "last_edit_date": 1496182823, "question_id": 44272447, "link": "https://stackoverflow.com/questions/44272447/can-you-choose-define-based-on-parameter", "title": "Can you choose #define based on parameter?", "body": "<p>To simplify a commonly occurring bitmap lookup, I decided to write a macro for it.  This macro would take in parameters array, position, and number of bits per entry.  The latter is always 1, 2, or 3, to be determined at compile time.</p>\n\n<p>The macros for one and two bits per entry are quite simple:</p>\n\n<pre><code>#define 1BITLOOKUP(array, index) (array[index / CHAR_BIT] &gt;&gt; (index % CHAR_BIT)) &amp; 1\n#define 2BITLOOKUP(array, index) (array[2 * index / CHAR_BIT] &gt;&gt; (2 * index % CHAR_BIT)) &amp; (0x11)\n</code></pre>\n\n<p>However, three-bit bitmap will be more complex, since it will cross byte boundaries.  For the sake of efficiency, I do not wish to include that code when I am only using one- and two- bit lookups.  So I would like to use a macro of the sort</p>\n\n<pre><code>#define BITMAPLOOKUP(array, index, k) kBITLOOKUP(array, index)\n</code></pre>\n\n<p>However, this does not work.  Is there a workaround?</p>\n\n<p>NOTE: This has been updated to a non-minimal working example, as per request of multiple commenters.</p>\n"}, {"tags": ["c", "floating-point", "nan"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1496180549, "post_id": 44272414, "comment_id": 75552707, "body": "<code>fflush(stdin);</code> should not be used."}, {"owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 2, "creation_date": 1496181748, "post_id": 44272414, "comment_id": 75553140, "body": "Money not initialized"}, {"owner": {"reputation": 7293, "user_id": 5994041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dWWF9.png?s=128&g=1", "display_name": "Peter Badida", "link": "https://stackoverflow.com/users/5994041/peter-badida"}, "reply_to_user": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 1, "creation_date": 1496186663, "post_id": 44272414, "comment_id": 75554449, "body": "@VidorVistrom That&#39;s priceless! :D"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1496187102, "post_id": 44272414, "comment_id": 75554563, "body": "maybe you intended <code>static float money;</code>  (which is not very good design but would work)"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8088711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b72cdd387be5879a19f8e2b42fc30b?s=128&d=identicon&r=PG&f=1", "display_name": "naynay", "link": "https://stackoverflow.com/users/8088711/naynay"}, "edited": false, "score": 0, "creation_date": 1496228771, "post_id": 44272458, "comment_id": 75572611, "body": "Thanks for the help!"}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 3, "last_activity_date": 1496180641, "creation_date": 1496180641, "answer_id": 44272458, "question_id": 44272414, "link": "https://stackoverflow.com/questions/44272414/running-c-program-returns-1-qnan0-instead-of-number-stored-in-floating-point-v/44272458#44272458", "title": "Running C program returns -1.#QNAN0 instead of number stored in floating-point variable", "body": "<p>The variable <code>money</code> is uninitialized in the function <code>moneyup</code> when used in expression</p>\n\n<pre><code>money=(float)money+m;\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8088711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b72cdd387be5879a19f8e2b42fc30b?s=128&d=identicon&r=PG&f=1", "display_name": "naynay", "link": "https://stackoverflow.com/users/8088711/naynay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 44272458, "answer_count": 1, "score": -1, "last_activity_date": 1496180641, "creation_date": 1496180441, "last_edit_date": 1496180608, "question_id": 44272414, "link": "https://stackoverflow.com/questions/44272414/running-c-program-returns-1-qnan0-instead-of-number-stored-in-floating-point-v", "title": "Running C program returns -1.#QNAN0 instead of number stored in floating-point variable", "body": "<p>Before going on, I'd like to say that this is my first time here and I don't know how things work yet so please pardon any errors on my part.</p>\n\n<p>When compiled,(source code below) everything works fine except for the content of the float disp which is equal to -1.#QNAN0. Any help on this? Thanks in advance. Some parts of the code are not complete like the switch-case structure. Please temporarily that(Unless it affects the result).</p>\n\n<p>The source code for the C program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nfloat moneyup(float m);\n\n\n int main()\n{\nchar name[20];\nchar x;\nint y;\nfloat disp;\nint hunger;\n\nprintf(\"\\t\\t**********************************************\\n\");\nprintf(\"\\t\\t*                                            *\\n\");\nprintf(\"\\t\\t*             How To Get Rich Quick!         *\\n\");\nprintf(\"\\t\\t*                                            *\\n\");\nprintf(\"\\t\\t**********************************************\\n\");\nprintf(\"\\nThis is an experimental command line interface game made by NayNay AKA Nathan\\n\");\nprintf(\"\\nPlease pardon the poor user interface.\");\n\nfor(;;)\n{\n    printf(\"\\nPlease enter your name(one only)\");\n    scanf(\"%s\", &amp;name);\n    printf(\"\\nThe name you entered is %s. Is this correct? (type y/n for yes or no)\\n\");\n    fflush(stdin);\n    x=getchar();\n\n    if(x=='y')                                                  /*This part with the for loop is used to get the name of the*/\n    {                                                           /*user and confirm the correctness of that name. If the name is*/\n        printf(\"Okay! Moving on...\");                           /*wrong, the user has the option to change it. Bulletproofing used*/\n        break;                                                  /*here*/\n    }\n    else if(x=='n')\n    {\n        printf(\"Alright let's try again.\");\n        continue;\n    }\n    else\n    {\n        printf(\"Let's try this again.\");\n        continue;\n    }\n}\nprintf(\"\\nOkay %s, Let's get this story started\",name);\nprintf(\"\\n\\nOne sad dreary morning, %s got up from sleep and went to the kitchen to get breakfast.\");\nprintf(\"\\nUnfortunately for him his pantry only contained a bunch of cockroaches going at it and laying their eggs everywhere\");\nprintf(\"\\nHe then checked his pockets and pulled out his last 5-dollar bill. That was all he had left,\");\nprintf(\"\\nHe bought a sandwich for $2 and decides to start a business with $3 as capital\");\nprintf(\"\\n\\nChoose how to start\");\nprintf(\"\\n1. Begging.\");\nprintf(\"\\n2. Mow lawns.\");\nprintf(\"\\n3. Apply for post of newspaper boy.\");\nfflush(stdin);\ny=getchar();\n\nswitch(y)\n{\n    case '1':\n        printf(\"You begged for 6 hours and got $5.25\\n\");\n        disp=moneyup(5.25);\n        printf(\"You now have $%f\\n\",disp);\n}\nreturn 0;\n}\n\nfloat moneyup(float m)\n{\nfloat money;\n\nmoney=(float)money+m;\nreturn(money);\n}\n</code></pre>\n"}, {"tags": ["c", "tr24731"], "answers": [{"comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 2, "creation_date": 1496180922, "post_id": 44272430, "comment_id": 75552857, "body": "And <code>__STDC_WANT_LIB_EXT1__</code> was also introduced in C11 isn&#39;t it?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 3, "creation_date": 1496181261, "post_id": 44272430, "comment_id": 75552993, "body": "@KeineLust: Strictly, it was introduced by the TR 24731-1 technical report, but as far as standards go, yes, it was added to C11.  However, you also have to check that <code>__STDC_LIB_EXT1__</code> is defined by the implementation to see whether adding <code>__STDC_WANT_LIB_EXT1__</code> will have any effect.  I&#39;m not aware of a standard Unix implementation that provides that.  See also <a href=\"https://stackoverflow.com/questions/372980/do-you-use-the-tr-24731-safe-functions\">Do you use the TR 24731 &#39;safe&#39; functions?</a>"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 7, "last_activity_date": 1496359747, "last_edit_date": 1496359747, "creation_date": 1496180508, "answer_id": 44272430, "question_id": 44272394, "link": "https://stackoverflow.com/questions/44272394/undefined-symbols-for-architecture-x86-64-gets-s/44272430#44272430", "title": "Undefined symbols for architecture x86_64: &quot;_gets_s&quot;", "body": "<p>The <code>gets_s()</code> function is defined in Annex K of ISO/IEC 9899:2011, the current C standard, and in TR 24731-1.  It is optional.  It is not widely implemented \u2014 in fact, it is essentially only available on Microsoft systems using the Microsoft C libraries.  Similar comments apply to the other <code>_s</code> functions \u2014 they're defined in Annex K and not generally implemented anywhere except under Microsoft's compilers.</p>\n\n<p>Note that you can test whether the Annex K functions in general are available on an implementation by testing whether <code>__STDC_LIB_EXT1__</code> is set by the compiler.  It should have a value of <code>200509L</code> for conformance with the original TR 24731-1 or <code>201112L</code> for conformance with Annex K.  If that is defined by the implementation, your code should define <code>__STDC_WANT_LIB_EXT1__</code> to expose the definitions of the Annex K functions.</p>\n\n<p>You will need to use different functions:</p>\n\n<ul>\n<li>For <code>gets_s()</code>, the standard <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fgets.html\" rel=\"nofollow noreferrer\"><code>fgets()</code></a> is probably the closest, but it includes the newline at the end of the input which <code>gets_s()</code> does not. Also, <code>gets_s()</code> truncates the output string on an error \u2014 if there isn't a newline before there is no space left; it also reads to the next newline if that happens.  The <code>fgets()</code> function does none of these.</li>\n<li>For <code>strnlen_s()</code>, use <a href=\"http://man7.org/linux/man-pages/man3/strnlen.3.html\" rel=\"nofollow noreferrer\"><code>strnlen()</code></a>, available on macOS Sierra (and Mac OS X) and Linux.</li>\n<li>For <code>strcat_s()</code>, probably use <a href=\"https://linux.die.net/man/3/strlcat\" rel=\"nofollow noreferrer\"><code>strlcat()</code></a>, again available on macOS Sierra and Linux.</li>\n<li>For <code>strtok_s()</code>, probably use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strtok_r.html\" rel=\"nofollow noreferrer\"><code>strtok_r()</code></a>, which is a standard part of POSIX.  Note that the interface to <code>strtok_r()</code> is different from the interface to <code>strtok_s()</code>, but the functionality is essentially the same.</li>\n</ul>\n"}], "owner": {"reputation": 153, "user_id": 5937903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c6b0debe838846c627cb7d33734d276?s=128&d=identicon&r=PG&f=1", "display_name": "cblanto7", "link": "https://stackoverflow.com/users/5937903/cblanto7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 1, "accepted_answer_id": 44272430, "answer_count": 1, "score": 1, "last_activity_date": 1523721254, "creation_date": 1496180354, "last_edit_date": 1523721254, "question_id": 44272394, "link": "https://stackoverflow.com/questions/44272394/undefined-symbols-for-architecture-x86-64-gets-s", "title": "Undefined symbols for architecture x86_64: &quot;_gets_s&quot;", "body": "<p>I am attempting to compile an example program from an the book Beginning C 5th Ed. by Ivor Horton. Attempting to compile it on OSX and I am getting the following output from gcc:</p>\n\n<pre><code>$ gcc program6_07.c \nprogram6_07.c:18:59: warning: format specifies type 'int' but the argument has\n      type 'size_t' (aka 'unsigned long') [-Wformat]\n          \"Terminate input by entering an empty line:\\n\", str_len);\n                                                          ^~~~~~~\nprogram6_07.c:23:5: warning: implicit declaration of function 'gets_s' is\n      invalid in C99 [-Wimplicit-function-declaration]\n    gets_s(buf, buf_len);                                  // Read a lin...\n    ^\nprogram6_07.c:24:9: warning: implicit declaration of function 'strnlen_s' is\n      invalid in C99 [-Wimplicit-function-declaration]\n    if(!strnlen_s(buf, buf_len))                           // Empty lin...\n        ^\nprogram6_07.c:27:8: warning: implicit declaration of function 'strcat_s' is\n      invalid in C99 [-Wimplicit-function-declaration]\n    if(strcat_s(str, str_len, buf))                        // Concatenat...\n       ^\nprogram6_07.c:33:60: warning: data argument not used by format string\n      [-Wformat-extra-args]\n  printf(\"The words in the prose that you entered are:\\n\", str);\n         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  ^\nprogram6_07.c:37:18: warning: implicit declaration of function 'strtok_s' is\n      invalid in C99 [-Wimplicit-function-declaration]\n  char * pWord = strtok_s(str, &amp;str_len, delimiters, &amp;ptr);  // Find 1st word\n                 ^\nprogram6_07.c:37:10: warning: incompatible integer to pointer conversion\n      initializing 'char *' with an expression of type 'int' [-Wint-conversion]\n  char * pWord = strtok_s(str, &amp;str_len, delimiters, &amp;ptr);  // Find 1st word\n         ^       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nprogram6_07.c:45:13: warning: incompatible integer to pointer conversion\n      assigning to 'char *' from 'int' [-Wint-conversion]\n      pWord = strtok_s(NULL, &amp;str_len, delimiters, &amp;ptr);    // Find sub...\n            ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n8 warnings generated.\nUndefined symbols for architecture x86_64:\n  \"_gets_s\", referenced from:\n      _main in program6_07-4a1c4c.o\n  \"_strcat_s\", referenced from:\n      _main in program6_07-4a1c4c.o\n  \"_strnlen_s\", referenced from:\n      _main in program6_07-4a1c4c.o\n  \"_strtok_s\", referenced from:\n      _main in program6_07-4a1c4c.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>the code of the program is as follows: </p>\n\n<pre><code>// Program 6.7 Find all the words\n#define __STDC_WANT_LIB_EXT1__ 1                           // Make optional versions of functions available\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\nint main(void)\n{\n  char delimiters[] = \" \\\".,;:!?)(\";                       // Prose delimiters\n  char buf[100];                                           // Buffer for a line of keyboard input\n  char str[1000];                                          // Stores the prose to be tokenized\n  char* ptr = NULL;                                        // Pointer used by strtok_s()\n  str[0] = '\\0';                                           // Set 1st character to null\n\n  size_t str_len = sizeof(str);\n  size_t buf_len = sizeof(buf);\n  printf(\"Enter some prose that is less than %d characters.\\n\"\n          \"Terminate input by entering an empty line:\\n\", str_len);\n\n  // Read multiple lines of prose from the keyboard\n  while(true)\n  {\n    gets_s(buf, buf_len);                                  // Read a line of input\n    if(!strnlen_s(buf, buf_len))                           // Empty line ends input\n      break;\n\n    if(strcat_s(str, str_len, buf))                        // Concatenate the line with str\n    {\n      printf(\"Maximum permitted input length exceeded.\");\n      return 1;\n    }\n  }\n  printf(\"The words in the prose that you entered are:\\n\", str);\n\n  // Find and list all the words in the prose\n  unsigned int word_count = 0;\n  char * pWord = strtok_s(str, &amp;str_len, delimiters, &amp;ptr);  // Find 1st word\n  if(pWord)\n  {\n    do\n    {\n      printf(\"%-18s\", pWord);\n      if(++word_count % 5 == 0)\n        printf(\"\\n\");\n      pWord = strtok_s(NULL, &amp;str_len, delimiters, &amp;ptr);    // Find subsequent words\n    }while(pWord);                                           // NULL ends tokenizing\n    printf(\"\\n%u words found.\\n\", word_count);\n  }\n  else\n    printf(\"No words found.\\n\");\n\n  return 0;\n}\n</code></pre>\n\n<p>I had thought that I had defined optional functions but I guess I have not? Is this just a dated book or a bad example or am I doing something wrong when I attempt to compile it?</p>\n"}, {"tags": ["c", "malloc", "valgrind", "free", "dynamic-allocation"], "comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1496179038, "post_id": 44271967, "comment_id": 75552085, "body": "Type <code>1</code> or <code>2</code> ...it will still be the same. The only thing which it will change is <code>2,064 bytes allocated</code>. Now take a look and think, why."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1496179118, "post_id": 44271967, "comment_id": 75552124, "body": "I cannot reproduce the behavior you describe.  When I build your code and run it under Valgrind, it reports one allocation and one free, just as you expect."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1496179229, "post_id": 44271967, "comment_id": 75552176, "body": "@JohnBollinger Not on my system (linux mint). if I type <code>2</code> I have: <code>total heap usage: 3 allocs, 3 frees, 2,056 bytes allocated</code> if I type <code>3</code> I have: <code>total heap usage: 3 allocs, 3 frees, 2,060 bytes allocated</code> ..... and so  on. <code>2,056</code> =&gt; <code>2,060</code> =&gt; ` 2064`"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1496181340, "post_id": 44271967, "comment_id": 75553020, "body": "What @duskwuff explained is that if you remove the <code>scanf()</code> part you will have only two allocs instead of three. Or better remove <code>printf()</code> too. Try the following <a href=\"http://ideone.com/TycpTO\" rel=\"nofollow noreferrer\">Program</a> and you will see the difference like <a href=\"https://pastebin.com/raw/xZJ8MSri\" rel=\"nofollow noreferrer\">Here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 5, "last_activity_date": 1496179585, "creation_date": 1496179585, "answer_id": 44272187, "question_id": 44271967, "link": "https://stackoverflow.com/questions/44271967/valgrind-shows-more-memory-allocated-than-actually-is/44272187#44272187", "title": "Valgrind shows more memory allocated than actually is", "body": "<p>Valgrind keeps track of <em>all</em> memory allocations which occur in your application, including ones made internally by the C library. It is not (and cannot) be limited to allocations you make explicitly, as the C library can return pointers to memory which it has allocated internally.</p>\n\n<p>Many standard I/O implementations will allocate buffers for use by <code>printf()</code> and/or <code>scanf()</code>, which is probably what accounts for the numbers you're seeing.</p>\n"}], "owner": {"reputation": 312, "user_id": 6032037, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEWJ8.png?s=128&g=1", "display_name": "gmelodie", "link": "https://stackoverflow.com/users/6032037/gmelodie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1282, "favorite_count": 3, "accepted_answer_id": 44272187, "answer_count": 1, "score": 2, "last_activity_date": 1532533796, "creation_date": 1496178758, "last_edit_date": 1532533796, "question_id": 44271967, "link": "https://stackoverflow.com/questions/44271967/valgrind-shows-more-memory-allocated-than-actually-is", "title": "Valgrind shows more memory allocated than actually is", "body": "<p>I was writting some simple code in C to test some memory allocation and pointers:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n\nint *randomAlloc(int n) {\n    int *address = NULL, i = 0;\n\n    address = malloc (n * sizeof(int));\n    for (i = 0; i &lt; n ; i++){\n        *(address + i) = i ;\n    }\n    return address;\n\n}\n\nint main(int argc, char* argv[] ) {\n\n    int *address;\n    int n;\n    printf(\"Type vector size: \");\n    scanf(\"%d\", &amp;n);\n    address = randomAlloc(n);\n\n    free(address);\n}\n</code></pre>\n\n<p>Yet for some reason when I type 4 as input valgrind outputs:</p>\n\n<pre><code>==2375== Memcheck, a memory error detector\n==2375== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==2375== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==2375== Command: ./a.out\n==2375== \nType vector size: 4\n==2375== \n==2375== HEAP SUMMARY:\n==2375==     in use at exit: 0 bytes in 0 blocks\n==2375==   total heap usage: 3 allocs, 3 frees, 2,064 bytes allocated\n==2375== \n==2375== All heap blocks were freed -- no leaks are possible\n==2375== \n==2375== For counts of detected and suppressed errors, rerun with: -v\n==2375== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>There is only one alloc and one free at the code. As n = 4, I'd expect it to alloc 4*4(sizeof(int))=16 bytes. Where is this comming from?</p>\n"}, {"tags": ["c", "stm32", "led"], "answers": [{"comments": [{"owner": {"reputation": 277, "user_id": 6332643, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/899374090172723/picture?type=large", "display_name": "Ana Matijanovic", "link": "https://stackoverflow.com/users/6332643/ana-matijanovic"}, "edited": false, "score": 0, "creation_date": 1496182510, "post_id": 44272685, "comment_id": 75553366, "body": "Thank you for your answer.  Can you shortly explain me these if statements, what means dir,pin and why excatly 15,11,5..?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 277, "user_id": 6332643, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/899374090172723/picture?type=large", "display_name": "Ana Matijanovic", "link": "https://stackoverflow.com/users/6332643/ana-matijanovic"}, "edited": false, "score": 0, "creation_date": 1496183633, "post_id": 44272685, "comment_id": 75553715, "body": "Yes - it actually toggles the uC&#39;s pin defined in the pin variable. on the first iteration it will be PB1, then PB2 .. PB4 id pin == 5 it jumps to the PB11 and continues to PB15 when it has to change the direction. dir is for incrementing or decrementing the pin value. So when pin reaches 15 dir changes to  0 and pin-- is executed instead of pin++."}, {"owner": {"reputation": 277, "user_id": 6332643, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/899374090172723/picture?type=large", "display_name": "Ana Matijanovic", "link": "https://stackoverflow.com/users/6332643/ana-matijanovic"}, "edited": false, "score": 0, "creation_date": 1496245252, "post_id": 44272685, "comment_id": 75584939, "body": "Ok understood. I hope you can answer me on one more question. Line with prescaler TIM_TimeBaseInitStructure.TIM_Prescaler = (64000-1); Why 64000 and why -1?"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1496241919, "last_edit_date": 1496241919, "creation_date": 1496181945, "answer_id": 44272685, "question_id": 44271416, "link": "https://stackoverflow.com/questions/44271416/understanding-code-for-led-light-for-stm32f334r8/44272685#44272685", "title": "Understanding code for LED light for stm32f334R8?", "body": "<p>In many interrupts you need to clear the interrupt pending flag. If you don't when you exit from the handler, the interrupt will be called again. Every interrupt is described in the Reference manual of your micro. For example SPI interrupt pending flag is cleared by writing or reading from the DR register. Another one requires that bit to be cleared by the programmer.</p>\n\n<p>The rule of thumb: clear the flag as soon as you enter the interrupt. </p>\n\n<p>If the interrupt can be triggered by more than one event, the programmer should check which one was the source of the exception.</p>\n"}], "owner": {"reputation": 277, "user_id": 6332643, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/899374090172723/picture?type=large", "display_name": "Ana Matijanovic", "link": "https://stackoverflow.com/users/6332643/ana-matijanovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1496399191, "creation_date": 1496176322, "last_edit_date": 1496399191, "question_id": 44271416, "link": "https://stackoverflow.com/questions/44271416/understanding-code-for-led-light-for-stm32f334r8", "title": "Understanding code for LED light for stm32f334R8?", "body": "<pre><code>#include \"stm32f30x_conf.h\"\n\nuint16_t read_pos(void);\nvoid PC_Conf(void);\nuint8_t get_bit(uint8_t, uint8_t);\n\n// PROCESSORTACT = 64 MHz\n// AHB  Prescaler = 1\n// APB1 Prescaler = 2\n// APB2 Prescaler = 1\n\nlong pin = 1;\nlong dir = 1;\nchar recvd;\n\nint main(void){\n    /*\n\n    */\n    //Definitions\n    GPIO_InitTypeDef GPIO_Initstructure;\n    TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;\n    NVIC_InitTypeDef NVIC_NVICInitStructure;\n\n    //ENABLE CLOCK\n    RCC_AHBPeriphClockCmd(RCC_AHBPeriph_GPIOB, ENABLE);\n    RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2, ENABLE);\n\n    //GPIO\n    GPIO_Initstructure.GPIO_Mode=GPIO_Mode_OUT;\n    GPIO_Initstructure.GPIO_OType=GPIO_OType_PP;\n    GPIO_Initstructure.GPIO_Pin=GPIO_Pin_All;\n    GPIO_Initstructure.GPIO_PuPd=GPIO_PuPd_NOPULL;\n    GPIO_Initstructure.GPIO_Speed=GPIO_Speed_50MHz;\n    GPIO_Init(GPIOB, &amp;GPIO_Initstructure);\n\n    //TIMER\n    TIM_TimeBaseInitStructure.TIM_Prescaler = (64000-1); //TIM2 cycle to 1kHz\n    TIM_TimeBaseInitStructure.TIM_Period = 500; //Every 500ms\n    TIM_TimeBaseInit(TIM2,&amp;TIM_TimeBaseInitStructure);\n\n    //NVIC\n    NVIC_NVICInitStructure.NVIC_IRQChannel=TIM2_IRQn;\n    NVIC_NVICInitStructure.NVIC_IRQChannelCmd=ENABLE;\n    NVIC_NVICInitStructure.NVIC_IRQChannelPreemptionPriority=0;\n    NVIC_NVICInitStructure.NVIC_IRQChannelSubPriority=0;\n    NVIC_Init(&amp;NVIC_NVICInitStructure);\n\n    //Enable everything\n    TIM_Cmd(TIM2, ENABLE);\n    TIM_ITConfig(TIM2, TIM_IT_Update, ENABLE);\n\n  /* Infinite loop */\n  while (1)\n  {\n  }\n}\n\nvoid TIM2_IRQHandler(void)\n{   \n    GPIOB-&gt;ODR &amp;= 0;\n    GPIOB-&gt;ODR ^=1&lt;&lt;pin;\n\n    //Pin to new value\n    if(dir == 1)\n    {\n        if(pin == 5)\n            pin=11;\n        else if(pin == 15)\n        {   pin-=1;\n            dir = 0;\n        }\n        else\n            pin+=1;\n    }\n    else\n    {\n        if(pin == 11)\n            pin = 5;\n        else if(pin == 1)\n        {\n            pin+=1;\n            dir = 1;\n        }\n        else\n            pin-=1;\n    }\n\n    TIM_ClearITPendingBit(TIM2,TIM_IT_Update);\n}\n</code></pre>\n\n<p>I have trouble understanding this code. First part is okay, but I don't understand the last function. </p>\n\n<p>Can someone explain me simply what is going on in the last part of this code in <code>TIM2_IRQHandler(void)</code>?</p>\n\n<p>I am new in this, any help would be welcome.</p>\n"}, {"tags": ["c#", "c", "visual-studio", "dll", "dllimport"], "comments": [{"owner": {"reputation": 420, "user_id": 2402579, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bb1d4419e9733ed40efef27c87e8ac8?s=128&d=identicon&r=PG&f=1", "display_name": "javier_el_bene", "link": "https://stackoverflow.com/users/2402579/javier-el-bene"}, "edited": false, "score": 3, "creation_date": 1496176240, "post_id": 44271340, "comment_id": 75550776, "body": "Check <a href=\"https://stackoverflow.com/questions/11425202/is-it-possible-to-call-a-c-function-from-c-net\" title=\"is it possible to call a c function from c net\">stackoverflow.com/questions/11425202/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/2874603/is-it-possible-to-embed-c-code-in-a-c-sharp-project\" title=\"is it possible to embed c code in a c sharp project\">stackoverflow.com/questions/2874603/&hellip;</a>"}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1496176374, "post_id": 44271340, "comment_id": 75550848, "body": "Your code looks fine to me. What happens when you try to run it? (Note that you do need to export the <code>pinfo</code> function first). Use <code>__declspec( dllexport )</code>"}, {"owner": {"reputation": 57, "user_id": 8088414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108f80ed1d1a4dec01a6c00c8ca3d56d?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8088414/j-doe"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1496176793, "post_id": 44271340, "comment_id": 75551053, "body": "@dai I added that line, I am unsure how to run it because I have a visual studio project and then a simple.c file that is not associated with my visual studio project, I am unsure how to link them"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1496176902, "post_id": 44271340, "comment_id": 75551107, "body": "Read the documentation on how to create a dll. Did you do that?"}], "answers": [{"comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1496181067, "post_id": 44271567, "comment_id": 75552924, "body": "Everything from &quot;Note that your DllImport declaration is incorrect&quot; is wrong. The unmanaged function is cdecl and the default marshaling is fine."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1496181249, "post_id": 44271567, "comment_id": 75552989, "body": "No, you are wrong. Default marshaling is to null terminated character array using prevailing character set. Which defaults to ANSI on desktop windows. All documented. You should read the documentation."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1496181575, "post_id": 44271567, "comment_id": 75553094, "body": "@DavidHeffernan My mistake. I did further reading and I misread the documentation. I&#39;ve removed the incorrect assertions from my answer."}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": false, "score": 0, "last_activity_date": 1496181612, "last_edit_date": 1592644375, "creation_date": 1496176922, "answer_id": 44271567, "question_id": 44271340, "link": "https://stackoverflow.com/questions/44271340/passing-into-c-code-from-c-code-in-visual-studio/44271567#44271567", "title": "passing into c code from c# code in visual studio", "body": "<p>There are 3 main steps for getting P/Invoke (<code>DllImport</code>) working in .NET:</p>\n<ol>\n<li><p>Export the function from the C/C++ project.</p>\n<p>In Visual C++, use the <code>__declspec( dllexport )</code> and <code>extern &quot;C&quot;</code> modifiers to, respectively, tell the compiler to export the function in the DLL so it is visible by name, and to not <em>mangle</em> the name either - otherwise the compiler will remove the function entirely if it has no callers inside the project (&quot;dead-code removal&quot;). Functions can also be exported by an ordinal number instead, which presumably is not what you're interested in.</p>\n</li>\n<li><p>Ensure you're building for the same ISA.</p>\n<p>When you use P/Invoke  in .NET, the DLL you reference will be loaded into the hosting .NET process, so the DLL must be built to the same CPU instruction-set as the current .NET process. .NET projects run in <code>AnyCPU</code> mode by default, but in recent versions of Visual Studio they &quot;prefer&quot; 32-bit (x86) mode instead of 64-bit (x64 / AMD64). To prevent any confusion, decide if you want 32-bit or 64-bit mode and force your .NET project to build only for that ISA and then set your C/C++ project to build for that ISA too.</p>\n</li>\n<li><p>Ensure the target DLL file is located in the <code>PATH</code> of the .NET executable - typically this means simply placing it in the same <code>bin</code> output directory as the built .NET executable.</p>\n<p>Note that as this DLL file is not a .NET assembly there is no concept of a &quot;project reference&quot; or &quot;assembly reference&quot;, so you need to configure your project specifically so that Visual Studio (MSBuild) will copy the DLL file to your <code>bin</code> folder - you can do this by adding the DLL file to your .NET project root in Solution Explorer, then selecting the file and open the Properties window and choose &quot;Build action: Content.&quot; and &quot;Copy to output directory: Always&quot;.</p>\n</li>\n</ol>\n<p>Regarding &quot;linking&quot; - <em>DLLs are not linked at compile-time</em> - the clue is in the name: &quot;dynamic-linking&quot;: the linking is performed at runtime by the operating system, not by the compiler.</p>\n<p>For more information on P/Invoke, I recommend reading this QA: <a href=\"https://stackoverflow.com/questions/15660722/why-are-cdecl-calls-often-mismatched-in-the-standard-p-invoke-convention\">Why are Cdecl calls often mismatched in the &quot;standard&quot; P/Invoke Convention?</a></p>\n"}], "owner": {"reputation": 57, "user_id": 8088414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108f80ed1d1a4dec01a6c00c8ca3d56d?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8088414/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "closed_date": 1496182834, "answer_count": 1, "score": -2, "last_activity_date": 1496181612, "creation_date": 1496175982, "last_edit_date": 1496176740, "question_id": 44271340, "link": "https://stackoverflow.com/questions/44271340/passing-into-c-code-from-c-code-in-visual-studio", "closed_reason": "Duplicate", "title": "passing into c code from c# code in visual studio", "body": "<p>I am confused on how to reference my c code from my c# code. I have read around and realized that DLL's are useful, but I do not understand how to connect my dll. From my understanding I make the dll from my c code? Please help</p>\n\n<p><strong>C# (visual studio code)</strong></p>\n\n<pre><code>public partial class Form1: Form{\n  [DllImport(\"simple.dll\", CallingConvention = CallingConvention.Cdec1)]\n  public static extern void pinfo(string str);\n\n  private void button1_Click(object sender, EventArgs e){\n      pinfo(\"yay\");\n  }\n}\n</code></pre>\n\n<p><strong>C code - simple.c</strong></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n__declspec( dllexport ) void pinfo(char* str){\n    printf(\"You are in the method %s\\n, str);\n}\n\nint main(void){\n}\n</code></pre>\n\n<p>my question is how do I connect the c code to the c# code so that the line \"You are in the method yay\" prints out? I do not understand how to link a dll file to visual studio or how to create the dll file. thanks</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 721925, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/V8n57.jpg?s=128&g=1", "display_name": "Curnelious", "link": "https://stackoverflow.com/users/721925/curnelious"}, "edited": false, "score": 0, "creation_date": 1496175875, "post_id": 44271257, "comment_id": 75550583, "body": "Thanks a lot! So why is my arg wrong? Isn&#39;t it a pointer to strings?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 1, "user_id": 721925, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/V8n57.jpg?s=128&g=1", "display_name": "Curnelious", "link": "https://stackoverflow.com/users/721925/curnelious"}, "edited": false, "score": 2, "creation_date": 1496176038, "post_id": 44271257, "comment_id": 75550668, "body": "@Curnelious; As a function parameter <code>char*[]</code> is equivalent to <code>char**</code>."}, {"owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "edited": false, "score": 0, "creation_date": 1496176474, "post_id": 44271257, "comment_id": 75550887, "body": "Well <code>char*[]</code> reduces to pointer to the 1st element of an array of characters where as <code>char (*)[MAX_WORD_LEN]</code> reduces to a pointer to an array of characters with each array element being MAX_WORD_LEN characters wide"}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 5, "last_activity_date": 1496175925, "last_edit_date": 1496175925, "creation_date": 1496175704, "answer_id": 44271257, "question_id": 44271196, "link": "https://stackoverflow.com/questions/44271196/passing-array-string-into-function-pointer/44271257#44271257", "title": "Passing array string into function pointer?", "body": "<p><code>void(*flashReadDelegate)(char*[])=0;</code> is wrong. Your function pointer should be like this  </p>\n\n<pre><code>void (*flashReadDelegate)(char (*)[MAX_WORD_LEN]);  \n</code></pre>\n\n<p>You have not mentioned the prototype of the function to which <code>flashReadDelegate</code> is pointing. I am assuming that it's prototype would be   </p>\n\n<pre><code>void func(char (*)[MAX_WORD_LEN]);\n</code></pre>\n\n<p>Now, in the function call <code>(*flashReadDelegate)(content);</code>, the argument array <code>content</code> will be converted to a pointer to an array of <code>MAX_WORD_LEN</code> <code>char</code>s (<code>(*)[MAX_WORD_LEN]</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 2014, "user_id": 6267288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f86a7e2f0811a9e18031ed7c0af917a?s=128&d=identicon&r=PG&f=1", "display_name": "OlivierM", "link": "https://stackoverflow.com/users/6267288/olivierm"}, "is_accepted": false, "score": 1, "last_activity_date": 1496176624, "creation_date": 1496176624, "answer_id": 44271485, "question_id": 44271196, "link": "https://stackoverflow.com/questions/44271196/passing-array-string-into-function-pointer/44271485#44271485", "title": "Passing array string into function pointer?", "body": "<p>Your declaration of <code>content</code> is not a <strong>pointer to strings</strong>. It is an <strong>array of MAX_NUM_WORDS strings of MAX_WORD_LEN characters</strong>.</p>\n\n<p>If you want an <strong>array of strings</strong> you would need to declare <code>content</code> as: static char* content[MAX_NUM_WORDS];`</p>\n"}], "owner": {"reputation": 1, "user_id": 721925, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/V8n57.jpg?s=128&g=1", "display_name": "Curnelious", "link": "https://stackoverflow.com/users/721925/curnelious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 1, "accepted_answer_id": 44271257, "answer_count": 2, "score": 2, "last_activity_date": 1496176624, "creation_date": 1496175474, "question_id": 44271196, "link": "https://stackoverflow.com/questions/44271196/passing-array-string-into-function-pointer", "title": "Passing array string into function pointer?", "body": "<p>I guess something is fundamentally wrong, I would like to send this global :</p>\n\n<pre><code>static char content[MAX_NUM_WORDS][MAX_WORD_LEN];\n</code></pre>\n\n<p>as an argument to a function pointer , where the function pointer def :</p>\n\n<pre><code>void(*flashReadDelegate)(char*[])=0;\n</code></pre>\n\n<p>and calling it with :</p>\n\n<pre><code>//save some data in (which prints ok)\nstrcpy(content[record_desc.record_id],toSave);\n\n// ***Send the delegate out\n(*flashReadDelegate)(content);  // ** here there is a compiler warnning about the argument\n</code></pre>\n\n<p>So how should the pointer argument look like if I want to send <code>content</code> ?</p>\n"}, {"tags": ["c", "reverse"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1496172182, "post_id": 44270273, "comment_id": 75548589, "body": "Do you also have a warning about calling an undeclared function <code>reverse()</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1496172187, "post_id": 44270273, "comment_id": 75548592, "body": "You should also be getting a warning about an implicit declaration of function <code>reverse()</code>.  If not, then turn up your compiler&#39;s warning level.  In the absence of an in-scope prototype at the point where you call that function, the compiler assumes that its return type is <code>int</code>."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 2, "creation_date": 1496172311, "post_id": 44270273, "comment_id": 75548655, "body": "@xing <code>reverse</code> is in another unit, is better to <code>#include &quot;reverse.h&quot;</code> before <code>main</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1496172721, "post_id": 44270273, "comment_id": 75548871, "body": "It is illegal to call a function that had not been declared. If your compiler doesn&#39;t warn you about this, it&#39;s too old, upgrade it."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8048857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a452d9d8a3a4979aae6a8fa65cccbf65?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8048857/mike"}, "edited": false, "score": 0, "creation_date": 1496172840, "post_id": 44270386, "comment_id": 75548947, "body": "I added the declaration into my main.c file, but am still getting the same error.  I realize its better form to create a header file, so I will do that.  But I am assuming if adding the declaration to the main.c file is still giving me the same warning, creating a header will still give me the warning also?"}, {"owner": {"reputation": 23, "user_id": 8048857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a452d9d8a3a4979aae6a8fa65cccbf65?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8048857/mike"}, "edited": false, "score": 0, "creation_date": 1496173034, "post_id": 44270386, "comment_id": 75549050, "body": "So problem 1 fixed, I was declaring as &#39;char reverse&#39; instead of &#39;char *reverse&#39;.  I&#39;ve set it up as you suggested but am still getting the lingering undefined reference to reverse"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 23, "user_id": 8048857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a452d9d8a3a4979aae6a8fa65cccbf65?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8048857/mike"}, "edited": false, "score": 1, "creation_date": 1496173753, "post_id": 44270386, "comment_id": 75549493, "body": "@Mike: &quot;undefined reference&quot; sounds like a link-time error. How to fix that depends on what compiler you&#39;re using, but if you&#39;re using gcc, the simplest approach is <code>gcc reverse.c main.c -o main</code>. Or <code>gcc -c reverse.c ; gcc -c main.c ; gcc reverse.o main.o -o main</code>. Or any of a myriad of variations, including setting up a <code>Makefile</code> or equivalent."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 4, "last_activity_date": 1496172369, "creation_date": 1496172369, "answer_id": 44270386, "question_id": 44270273, "link": "https://stackoverflow.com/questions/44270273/why-am-i-getting-the-format-s-expects-argument-of-type-char-but-err/44270386#44270386", "title": "Why am I getting the &quot;format &#39;%s&#39; expects argument of type &#39;char *&#39; but....&quot; error here?", "body": "<p>If that's your entire <code>main.c</code> source file, then the compiler doesn't see a declaration of your <code>reverse</code> function.</p>\n\n<p>In C89/C90, a call to an undeclared function would create an implicit declaration of that function returning a result of type <code>int</code>. If the function actually returns something other than <code>int</code>, as yours does, then the behavior is undefined.</p>\n\n<p>C99 dropped this \"implicit <code>int</code>\" rule, making any call to an undeclared function a <em>constraint violation</em>, requiring a diagnostic.  You should find out how to coax your compiler to diagnose such a call.</p>\n\n<p>The fix is to make a declaration of <code>reverse</code> visible in <code>main.c</code>.  The best way to do this is to create a header file, most likely <code>reverse.h</code>, that contains the declaration:</p>\n\n<pre><code>#ifndef REVERSE_H\n#define REVERSE_H\n\nchar *reverse(char *word);\n\n#endif\n</code></pre>\n\n<p>and <code>#include</code> that header in both <code>main.c</code> and <code>reverse.c</code>.  (Including it in <code>main.c</code> provides the declaration so the call can be compiled correctly. Including it in <code>reverse.c</code> lets the compiler conform that the declaration and definition are consistent.)</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 8048857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a452d9d8a3a4979aae6a8fa65cccbf65?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8048857/mike"}, "edited": false, "score": 0, "creation_date": 1496172693, "post_id": 44270422, "comment_id": 75548849, "body": "Thanks, however I added just that at the start of my main.c file and I am getting exactly the same error as before :/"}], "tags": [], "owner": {"reputation": 9511, "user_id": 7023590, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/82052fbf0815ce82c4eded8fd941be14?s=128&d=identicon&r=PG&f=1", "display_name": "MarianD", "link": "https://stackoverflow.com/users/7023590/mariand"}, "is_accepted": false, "score": 1, "last_activity_date": 1496172542, "creation_date": 1496172542, "answer_id": 44270422, "question_id": 44270273, "link": "https://stackoverflow.com/questions/44270273/why-am-i-getting-the-format-s-expects-argument-of-type-char-but-err/44270422#44270422", "title": "Why am I getting the &quot;format &#39;%s&#39; expects argument of type &#39;char *&#39; but....&quot; error here?", "body": "<p>As you didn't include the declaration of your <code>reverse()</code> function in the <code>main.c</code> file (module), the compiler (with suppressed appropriate warning flag) suppose it returns <code>int</code>.</p>\n\n<p>So include the statement</p>\n\n<pre><code>char *reverse(char *word);\n</code></pre>\n\n<p>at the start of your <code>main.c</code> file.</p>\n"}, {"tags": [], "owner": {"reputation": 371, "user_id": 6513366, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yaOsDebgj9o/AAAAAAAAAAI/AAAAAAAAAUw/daIT_fXvT4k/photo.jpg?sz=128", "display_name": "Overflow 404", "link": "https://stackoverflow.com/users/6513366/overflow-404"}, "is_accepted": false, "score": 0, "last_activity_date": 1496174243, "last_edit_date": 1496174243, "creation_date": 1496173103, "answer_id": 44270588, "question_id": 44270273, "link": "https://stackoverflow.com/questions/44270273/why-am-i-getting-the-format-s-expects-argument-of-type-char-but-err/44270588#44270588", "title": "Why am I getting the &quot;format &#39;%s&#39; expects argument of type &#39;char *&#39; but....&quot; error here?", "body": "<p>The problem was\u200b the type of the reverse function. Here is an alternative code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nvoid reverse(char *word)\n{\n    size_t i;\n    size_t length = strlen(word);\n    size_t tmp;\n    for (i = 0; i &lt; (length / 2); i++) {\n        tmp = length-i-1;\n        /* This is a xor swap. */\n        word[i] ^= word[tmp];\n        word[tmp] ^= word[i];\n        word[i] ^= word[tmp];\n    }\n}\n\nint main (int argc, char * argv [])\n{\n    char word[] = \"Happy Birthday!\";\n    printf(\"%s\\n\", word);\n    reverse(word);\n    printf(\"%s\\n\", word);\n    reverse(word);\n    printf(\"%s\\n\", word);\n    printf(\"%s\\n\", word);\n    system (\"Pause\");\n    return 0;\n}\n</code></pre>\n\n<p>Here is the proof:\n<a href=\"https://ideone.com/xp4lDj\" rel=\"nofollow noreferrer\">Run code</a></p>\n"}], "owner": {"reputation": 23, "user_id": 8048857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a452d9d8a3a4979aae6a8fa65cccbf65?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8048857/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 44270386, "answer_count": 3, "score": 0, "last_activity_date": 1496174243, "creation_date": 1496171989, "question_id": 44270273, "link": "https://stackoverflow.com/questions/44270273/why-am-i-getting-the-format-s-expects-argument-of-type-char-but-err", "title": "Why am I getting the &quot;format &#39;%s&#39; expects argument of type &#39;char *&#39; but....&quot; error here?", "body": "<p>I'm pretty new to C and still catching onto the basics.  I am writing a very simple practice exercise which takes a phrase and reverses it.  I'm sure there are other problems with this code, but primarily on compilation of main.c, I am continually getting the error </p>\n\n<p><em>main.c:14:9: warning: format '%s' expects argument of type char* but argument 2 has type 'int'   command not found</em></p>\n\n<p>I have no idea why I am getting that error, could someone help me understand why?  Thank you!</p>\n\n<p>My main.c</p>\n\n<pre><code>int main (int argc, char * argv [])\n{\n\nchar word[] = \"Happy Birthday!\";\n\nprintf(\"%s\\n\", word);\nreverse(word);\nprintf(\"%s\\n\", word);\nprintf(\"%s\\n\", reverse(word));\nprintf(\"%s\\n\", word);\n\nsystem (\"Pause\");\nreturn 0;\n}\n</code></pre>\n\n<p>My reverse.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nchar *reverse(char *word)\n{\nchar *rev;\nchar *i;\nchar temp;\n\nrev = word;\nfor (i = word; *i != '\\0'; i++)\n{\n        if (i - word &gt; 1)\n                for (i--; word &lt; i; word++, i--)\n                {\n                        temp = *word;\n                        *word = *i;\n                        *i = temp;\n                }\n\nreturn rev;\n}\n</code></pre>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1496170614, "post_id": 44269859, "comment_id": 75547766, "body": "There&#39;s a stray semicolon in the code..."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496170628, "post_id": 44269859, "comment_id": 75547777, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496170669, "post_id": 44269859, "comment_id": 75547805, "body": "Also, please don&#39;t post pictures of code or text in general. Copy-paste the actual text instead."}, {"owner": {"reputation": 11, "user_id": 7473340, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b9aWGihZMOM/AAAAAAAAAAI/AAAAAAAAACU/2SfJNuyWZLA/photo.jpg?sz=128", "display_name": "Carlos Pinto", "link": "https://stackoverflow.com/users/7473340/carlos-pinto"}, "edited": false, "score": 0, "creation_date": 1496170685, "post_id": 44269859, "comment_id": 75547814, "body": "Wow really? that&#39;s pretty embarassing... Pretty weird that the compiler doesn&#39;t throw a warning about it :/"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496170734, "post_id": 44269859, "comment_id": 75547842, "body": "Why should the compiler warn about it? The code, as shown, is perfectly legal in all respects of the language. The <i>logic</i> on the other hand... :)"}, {"owner": {"reputation": 270, "user_id": 639680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf2c7f6b67f2cac38e3caa5403c9ba27?s=128&d=identicon&r=PG&f=1", "display_name": "Fabiano Salles", "link": "https://stackoverflow.com/users/639680/fabiano-salles"}, "edited": false, "score": 0, "creation_date": 1496170747, "post_id": 44269859, "comment_id": 75547849, "body": "Yes. Your if (i!=0); is causing the problem. Remove the semicolon and you should be fine."}, {"owner": {"reputation": 11, "user_id": 7473340, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b9aWGihZMOM/AAAAAAAAAAI/AAAAAAAAACU/2SfJNuyWZLA/photo.jpg?sz=128", "display_name": "Carlos Pinto", "link": "https://stackoverflow.com/users/7473340/carlos-pinto"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496170780, "post_id": 44269859, "comment_id": 75547875, "body": "@Someprogrammerdude I&#39;ll make sure to do that in the future, but mind explaining to me why would that matter?"}, {"owner": {"reputation": 11, "user_id": 7473340, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b9aWGihZMOM/AAAAAAAAAAI/AAAAAAAAACU/2SfJNuyWZLA/photo.jpg?sz=128", "display_name": "Carlos Pinto", "link": "https://stackoverflow.com/users/7473340/carlos-pinto"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496170849, "post_id": 44269859, "comment_id": 75547905, "body": "@Someprogrammerdude Why would an if statement with no consequences be used? Seems like a useless thing that the compiler should warn me about, no?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496170852, "post_id": 44269859, "comment_id": 75547908, "body": "The syntax of an <code>if</code> statement is <code>if (&lt;expression&gt;) &lt;statement&gt;</code>. The semicolon on its own is a separate statement, an <i>empty</i> statement that doesn&#39;t do anything but still a valid statement. The code you show is equal to <code>if (i != 0) { &#47;* empty *&#47; }</code>."}, {"owner": {"reputation": 3529, "user_id": 2036035, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/746fc48544cf535f52f1247079e5a927?s=128&d=identicon&r=PG", "display_name": "hythis", "link": "https://stackoverflow.com/users/2036035/hythis"}, "edited": false, "score": 0, "creation_date": 1496172160, "post_id": 44269859, "comment_id": 75548580, "body": "@CarlosPinto I would caution on using non English naming in code.  The problem isn&#39;t that people who speak English can&#39;t read it, but that <i>no one else except people who speak your language can</i>.   If this project isn&#39;t public, or is just for personal use it doesn&#39;t matter, but notice how you are using both English and Spanish here.   A real use case where this screwed a developer is with <a href=\"https://github.com/nineties/py-videocore\" rel=\"nofollow noreferrer\">this project</a>. The lack of English documentation and transperancy of what he was doing lead people to not take claims he made later seriously on QPU capabilities."}], "answers": [{"tags": [], "owner": {"reputation": 270, "user_id": 639680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf2c7f6b67f2cac38e3caa5403c9ba27?s=128&d=identicon&r=PG&f=1", "display_name": "Fabiano Salles", "link": "https://stackoverflow.com/users/639680/fabiano-salles"}, "is_accepted": true, "score": 1, "last_activity_date": 1496170971, "creation_date": 1496170971, "answer_id": 44270004, "question_id": 44269859, "link": "https://stackoverflow.com/questions/44269859/c-weird-conditional-printf-behavior/44270004#44270004", "title": "C: Weird conditional printf behavior", "body": "<p>There is one semicolon after the if statement that is causing the problem.</p>\n\n<pre><code>if (i!=0);\n{\n     //this will always execute\n}\n</code></pre>\n\n<p>change it to</p>\n\n<pre><code>if (i!=0)\n{\n  //this will execute if i != 0\n}\n</code></pre>\n\n<p>The compiler does not warn you because the first statement is syntactically valid.</p>\n"}], "owner": {"reputation": 11, "user_id": 7473340, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b9aWGihZMOM/AAAAAAAAAAI/AAAAAAAAACU/2SfJNuyWZLA/photo.jpg?sz=128", "display_name": "Carlos Pinto", "link": "https://stackoverflow.com/users/7473340/carlos-pinto"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "closed_date": 1496174018, "accepted_answer_id": 44270004, "answer_count": 1, "score": -6, "last_activity_date": 1496175317, "creation_date": 1496170482, "last_edit_date": 1496175317, "question_id": 44269859, "link": "https://stackoverflow.com/questions/44269859/c-weird-conditional-printf-behavior", "closed_reason": "Not suitable for this site", "title": "C: Weird conditional printf behavior", "body": "<pre><code>while(fscanf(f, \"%s %s\", logIn, pass) == 2){\n    i = tabela_insere(logPass, logIn, pass);\n    if(i != 0);\n    {\n        tabela_apaga(logPass);\n        printf(\"%d diferente de 0???\\n\", i);\n        return;\n    }\n}\n</code></pre>\n\n<p>Pretty straight forward: What is wrong here?</p>\n\n<p>So this cycle only prints anything if the result of that function \"tabela_insere()\" is different from 0, but as we can see from the printf outcome, i is 0... Why does it print then?</p>\n\n<p>I don't think it matters but here are all variable types used:</p>\n\n<pre><code>int i; //not a global variable aka can't be changed in the function\nchar logIn[26],\n     pass[26];\ntabela_dispersao *logPass; //it's an hash table\n</code></pre>\n\n<p>I'm using MinGW to compile, no errors or warnings.</p>\n"}, {"tags": ["c", "arrays", "sum"], "answers": [{"tags": [], "owner": {"reputation": 297030, "user_id": 1226963, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/yjY1E.png?s=128&g=1", "display_name": "rmaddy", "link": "https://stackoverflow.com/users/1226963/rmaddy"}, "is_accepted": false, "score": 4, "last_activity_date": 1496170828, "creation_date": 1496170828, "answer_id": 44269970, "question_id": 44269402, "link": "https://stackoverflow.com/questions/44269402/xcode-giving-wrong-sum-for-simple-c-array/44269970#44269970", "title": "Xcode giving wrong sum for simple C array", "body": "<p>Your <code>for</code> loop goes too far. You need <code>i &lt; n</code>, not <code>&lt;=</code>. You are reading past the array into unknown memory. That extra value can be filled with anything. In some cases it might be 0 which accidentally gave you the correct result even though the code is wrong.</p>\n"}], "owner": {"reputation": 7, "user_id": 8038397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/033a61a9361e38fad9d4d2c14c7bd725?s=128&d=identicon&r=PG&f=1", "display_name": "cpersonal", "link": "https://stackoverflow.com/users/8038397/cpersonal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496170828, "creation_date": 1496168923, "last_edit_date": 1496170756, "question_id": 44269402, "link": "https://stackoverflow.com/questions/44269402/xcode-giving-wrong-sum-for-simple-c-array", "title": "Xcode giving wrong sum for simple C array", "body": "<p>I have tested my code in both Xcode and an online C Compiler, and for some reason Xcode prints a value of 1606416234 when the correct sum should be 10. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint sum_array(int x[], int n);\n    int main(void) {\n    // insert code here...\n    printf(\"Hello, World!\\n\");\n    int y[4]={1,2,3,4};\n    printf(\"%d\\n\", sum_array(y, 4));\n\n\n    return 0;\n}\n\nint sum_array(int x[], int n){\n    int i, sum=0;\n    for (i= 0; i&lt;=n; i++){\n        sum+=x[i];\n    }\n    return sum;\n}\n</code></pre>\n\n<p>Why does Xcode give me such a large number?</p>\n"}, {"tags": ["c", "regex", "regular-language"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1496168329, "post_id": 44269020, "comment_id": 75546481, "body": "Read <a href=\"http://man7.org/linux/man-pages/man3/regex.3.html\" rel=\"nofollow noreferrer\"><code>man regcomp</code></a> to find out what <code>REG_NOSUB</code> does, then remove it from your code."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1496168438, "post_id": 44269020, "comment_id": 75546550, "body": "Also, instead of passing 0, NULL to <a href=\"http://man7.org/linux/man-pages/man3/regexec.3.html\" rel=\"nofollow noreferrer\"><code>regexec()</code></a>, pass the number of elements in, and an array of, <code>regmatch_t</code>. The initial element in the array will represent the entire match."}], "answers": [{"tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 1, "last_activity_date": 1496167942, "creation_date": 1496167942, "answer_id": 44269150, "question_id": 44269020, "link": "https://stackoverflow.com/questions/44269020/how-to-find-which-index-of-the-expression-matches-with-the-regular-expression/44269150#44269150", "title": "How to find which index of the expression matches with the regular expression", "body": "<p>You can use <code>strstr</code>:</p>\n\n<pre><code>char str[] = \"jkimsdfs\";\nchar *ptr;\n\nif ((ptr = strstr(str, \"kim\"))) {\n     if ((ptr - str) == 1) {\n         /* Match */\n     }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "is_accepted": false, "score": 0, "last_activity_date": 1496169323, "creation_date": 1496169323, "answer_id": 44269515, "question_id": 44269020, "link": "https://stackoverflow.com/questions/44269020/how-to-find-which-index-of-the-expression-matches-with-the-regular-expression/44269515#44269515", "title": "How to find which index of the expression matches with the regular expression", "body": "<p>Perhaps the docs say to get a match location it would be  </p>\n\n<pre><code>size_t     nmatch = 2;\nregmatch_t pmatch[2];\n\nstatus = regexec(&amp;w, exp, nmatch, pmatch, 0);\nif ( status == 0 )\n{\n    printf( \"Matched \\\"%.*s\\\" at position %d.\\n\",\n         pmatch[1].rm_eo - pmatch[1].rm_so, &amp;exp[pmatch[1].rm_so],\n         pmatch[1].rm_so);\n}\nelse\n    printf( \"Match not found\\n\" );    \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8050114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f3e3070c31f4a9c29fa1ae95c54007?s=128&d=identicon&r=PG&f=1", "display_name": "Sal Ha", "link": "https://stackoverflow.com/users/8050114/sal-ha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1496169323, "creation_date": 1496167563, "last_edit_date": 1496168208, "question_id": 44269020, "link": "https://stackoverflow.com/questions/44269020/how-to-find-which-index-of-the-expression-matches-with-the-regular-expression", "title": "How to find which index of the expression matches with the regular expression", "body": "<p>How do I modify this code so that it'll find the index the regex matches with. Basically suppose I had \"kim\" as my test expression. And my test string is \"jkimsdfs\". How can I show that \"jkimsdfs\" matches with \"kim\" at index 1.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;regex.h&gt;\n\nint main () {\n\n        char word[100]; //sets the limit of characters within word to 99(0-99\n\n        char exp[100]; //sets the limit of characters within exp to 99(0-99)\n\n        regex_t w; //contains size_t. This field holds the number of\n        //parenthetical subexpressions in the regular expression that was compiled.\n\n        int status; // integer status\n\n        printf(\"Test Expression: \"); //print \"Test Expression\"\n\n        fgets(word,100,stdin); //\n\n        word[strlen(word)-1] = '\\0';\n        status = regcomp(&amp;w,word,REG_EXTENDED|REG_NOSUB);\n        printf(\"%d\\n\", status);\n        printf(\"Validity of regex, if 0 than it matches: %d\\n\",status);\n        if (status) return 1;\n        while (1) {\n            printf(\"Test String: \");\n            fgets(exp,100,stdin);\n            exp[strlen(exp)-1] = '\\0';\n            if (strlen(exp) &lt; 1)\n            break;\n            status = regexec(&amp;w,exp,(size_t)0,NULL,0);\n            printf(\"Matched:  %d\\n\",status);\n            printf(\"%d\\n\", status);\n            }\n            regfree(&amp;w);\n        return 0;\n        }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 5, "creation_date": 1496166753, "post_id": 44268775, "comment_id": 75545598, "body": "To be of length 3 you need to declare <code>char password[4];</code> instead of <code>char password[3];</code>, also, use <code>&quot;%3s&quot;</code> in <code>scanf</code> in order to avoid buffer overflows."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8087805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7833e6fcbb705e597b8fe98a941c7b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammed Companiwala", "link": "https://stackoverflow.com/users/8087805/mohammed-companiwala"}, "edited": false, "score": 0, "creation_date": 1496263313, "post_id": 44268898, "comment_id": 75595027, "body": "Solved. It was mistake of array size. Silly mistake!.  Thanks a lot"}], "tags": [], "owner": {"reputation": 743, "user_id": 5091033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d0737443a012e096ab556ef60a197f?s=128&d=identicon&r=PG&f=1", "display_name": "simo-r", "link": "https://stackoverflow.com/users/5091033/simo-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1496169596, "last_edit_date": 1496169596, "creation_date": 1496167135, "answer_id": 44268898, "question_id": 44268775, "link": "https://stackoverflow.com/questions/44268775/c-programming-operator/44268898#44268898", "title": "C programming - Operator", "body": "<p>Firstly you've to declare the password array of size 4 because you've a <code>\\0</code> character at the end of your word. Here's the code, I just changed few lines.</p>\n\n<pre><code>int main(){\nint i=0, letter=0, digit=0, character=0;\nint attempt=0;\nchar password[4]; /*For a string of 3 character you must declare it of 4 because '\\0' */\nwhile(attempt&lt;3){\n    printf(\"\\nAttempt: %d\\n\", attempt);\n    printf(\"\\nPlease enter the 3 character password containing Letter in upper case, digit &amp; special character: \\n\");\n    scanf(\" %3s\", password);\n    for(i=0; i&lt;=2; i++){\n        if(isalpha(password[i])){\n            if(isupper(password[i])){\n                letter=1;\n                continue;\n            }else{\n            printf(\"Wrong Password (Upper case letter needed)\\n\");\n            break;\n            }\n        }else if(isdigit(password[i])){\n            digit=1;\n            continue;\n        }else{\n            character=1;\n        }\n    }\n    if(letter==1 &amp;&amp; digit==1 &amp;&amp; character==1){\n        printf(\"You have entered correct password\\n\");\n        break;\n    }\n    printf(\"You have entered wrong password Try again\\n\");\n    attempt++; /*You can increase it here because if you enter the correct password you'll exit*/\n}\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 8087805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7833e6fcbb705e597b8fe98a941c7b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammed Companiwala", "link": "https://stackoverflow.com/users/8087805/mohammed-companiwala"}, "edited": false, "score": 0, "creation_date": 1496263423, "post_id": 44269877, "comment_id": 75595072, "body": "Solved. It was mistake of array size. Silly mistake!. Thanks a lot"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1496170538, "creation_date": 1496170538, "answer_id": 44269877, "question_id": 44268775, "link": "https://stackoverflow.com/questions/44268775/c-programming-operator/44269877#44269877", "title": "C programming - Operator", "body": "<p>You have one very serious bug in your program. The <code>password</code> array is too short to hold a string of 3 characters. Remember that C strings requires a NUL-termination. This means that to store the string \"Ab!\" you really need 4 bytes of memory as it will be stored as <code>'a''b''!''\\0'</code>. Since you have only reserved 3 bytes for password, your code will write outside the reserved memory if the user enters 3 characters. That is undefined behavior.</p>\n\n<blockquote>\n  <p>Can that explain why your code continues infinitely?</p>\n</blockquote>\n\n<p>Well, if you have undefined behavior, it is said that anything can happen - so yes! What may happen is that when writing the <code>'\\0'</code> (i.e. 0) outside <code>password</code> it may overwrite (parts of) <code>attempt</code> and set it back to zero. It is hard to say whether this is what happens as it depends on the specific system.</p>\n\n<p>So the important thing is:</p>\n\n<pre><code>char password[3]; --&gt; char password[4];\n</code></pre>\n\n<p>Next thing:</p>\n\n<p>You need to reset the counters in each attempt. That is:</p>\n\n<pre><code>while(attempt&lt;3)\n{\n    letter=0;\n    digit=0;\n    character=0;\n    ....\n</code></pre>\n\n<p>If you don't, you may get false positives as the result from one attempt is carried on to the next.</p>\n\n<p>Finally - never ever do:</p>\n\n<pre><code>    scanf(\" %s\", password);\n</code></pre>\n\n<p>The user can overflow the input buffer (i.e. <code>password</code>) by typing more than 3 letters before hitting enter. Instead use <code>fgets</code>. If you really want <code>scanf</code> at least put at limit to the length of the input like:</p>\n\n<pre><code>    scanf(\" %3s\", password);\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8087805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7833e6fcbb705e597b8fe98a941c7b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammed Companiwala", "link": "https://stackoverflow.com/users/8087805/mohammed-companiwala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1496170538, "creation_date": 1496166663, "last_edit_date": 1496169242, "question_id": 44268775, "link": "https://stackoverflow.com/questions/44268775/c-programming-operator", "title": "C programming - Operator", "body": "<p>I have written a simple code which accepts password from user and checks if it contains UpperCase letter, digit and special character. The password should of length 3.</p>\n\n<p>Problem: </p>\n\n<p>User should get three trials before it ends. Code works perfectly well in case if the password is correct but in case of wrong it keeps on asking infinitely. I think that increment operator for increasing the attempt is not working (or I am making any mistake).</p>\n\n<p>Thanks for help.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main()\n{\n    int i=0, letter=0, digit=0, character=0;\n    int attempt=0;\n    char password[3];\n\n    while(attempt&lt;3)\n    {\n        printf(\"\\nAttempt: %d\\n\", attempt);\n        printf(\"\\nPlease enter the 3 character password containing Letter in upper case, digit &amp; special character: \\n\");\n        scanf(\" %s\", password);\n\n        for(i=0; i&lt;=2; i++)\n        {\n            if(isalpha(password[i]))\n            {\n                if(isupper(password[i]))\n                {\n                    letter=1;\n                    continue;\n                }\n                else\n                {\n                    printf(\"Wrong Password (Upper case letter needed)\\n\");\n                    break;\n                }\n            }\n            else if(isdigit(password[i]))\n            {\n                digit=1;\n                continue;\n            }\n            else\n            {\n                character=1;\n            }\n        }\n        if(letter==1 &amp;&amp; digit==1 &amp;&amp; character==1)\n        {\n            printf(\"You have entered correct password\\n\");\n            break;\n        }\n        else\n        {\n            printf(\"You have entered wrong password Try again\\n\");\n            attempt++;\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "bsd"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3177100"}, "edited": false, "score": 0, "creation_date": 1501411985, "post_id": 44268054, "comment_id": 77758629, "body": "If you haven&#39;t tried it yet, using  p_rttables found in /usr/src/sbin/route/show.c helps printing out the default gateway."}], "owner": {"reputation": 634, "user_id": 2066010, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RrcxN.png?s=128&g=1", "display_name": "b degnan", "link": "https://stackoverflow.com/users/2066010/b-degnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496163944, "creation_date": 1496163944, "question_id": 44268054, "link": "https://stackoverflow.com/questions/44268054/c-getting-the-default-gateway-for-an-ip-address-on-bsd", "title": "C: Getting the default gateway for an IP address on BSD", "body": "<p>I am trying to find a way to get default gateway for an IPv4 address in C.  I have created code that iterates through all of the IP addresses via the getifaddrs() function. This gives me a list of valid IPs, and I filter out those that start with 127.* and 169.*.  I then want to get the gateway for that IP address, but I've come across some hiccups (net/route.c source code is difficult to understand without context)  </p>\n\n<p>Does a function exist that allows me to pass an IP address and get the gateway for that IP address?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5868, "user_id": 3270037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6HVI4.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3270037/nick"}, "edited": false, "score": 0, "creation_date": 1496163241, "post_id": 44267827, "comment_id": 75543821, "body": "Because an arrays size has to be a constant, and a const variable is a const variable, not a constant, it means it cannot be changed"}, {"owner": {"reputation": 5858, "user_id": 1530549, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9acb42e69fdeeaf6474022411fe61725?s=128&d=identicon&r=PG", "display_name": "Scooter", "link": "https://stackoverflow.com/users/1530549/scooter"}, "edited": false, "score": 2, "creation_date": 1496163269, "post_id": 44267827, "comment_id": 75543830, "body": "Just a another deficiency in the language."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 5, "creation_date": 1496163301, "post_id": 44267827, "comment_id": 75543844, "body": "...which was fixed in C++."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1496163412, "post_id": 44267827, "comment_id": 75543905, "body": "<code>const int sz;</code> is an external symbol. It could be overridden at runtime with stuff like LD_PRELOAD. If you added <code>static</code>, then I guess it&#39;s just an arbitrary restriction of the C language (C++ does away with it after all and there were no major issues with it AFAIK)."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1496163491, "post_id": 44267827, "comment_id": 75543952, "body": "@Mgetz <code>const</code> is enough."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 3, "creation_date": 1496163508, "post_id": 44267827, "comment_id": 75543965, "body": "@Mgetz <code>const</code> integral variables implicitly become <code>constexpr</code> if they have a <code>constexpr</code> initializer."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1496163511, "post_id": 44267827, "comment_id": 75543968, "body": "@Mgetz C++ can have <code>const</code> &quot;variables&quot; as compile-time constants. The definition in the code in the question would be such a case."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 10, "creation_date": 1496163638, "post_id": 44267827, "comment_id": 75544035, "body": "You&#39;re lucky the code doesn&#39;t build, because if it did you would have <i>undefined behavior</i> writing to a zero-sized array."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1496174911, "post_id": 44267827, "comment_id": 75550091, "body": "Other dupes: <a href=\"https://stackoverflow.com/q/40599032/2455888\">stackoverflow.com/q/40599032/2455888</a>, <a href=\"https://stackoverflow.com/q/11541088/2455888\">stackoverflow.com/q/11541088/2455888</a>"}], "answers": [{"tags": [], "owner": {"reputation": 743, "user_id": 5091033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d0737443a012e096ab556ef60a197f?s=128&d=identicon&r=PG&f=1", "display_name": "simo-r", "link": "https://stackoverflow.com/users/5091033/simo-r"}, "is_accepted": false, "score": 4, "last_activity_date": 1539865156, "last_edit_date": 1539865156, "creation_date": 1496164581, "answer_id": 44268234, "question_id": 44267827, "link": "https://stackoverflow.com/questions/44267827/in-c-why-cant-a-const-variable-be-used-as-an-array-size-initializer/44268234#44268234", "title": "In C, why can&#39;t a const variable be used as an array size initializer?", "body": "<p>In a very simple way because the compiler must know the dimension of the array at compilation time and since you can initialize <code>const variable</code> at run time you can't do it. So the size of statically declared arrays <strong>must</strong> be a <em>constant expression</em> and a <code>const variable</code> is not it. For  <em>constant expression</em> you should use either a macro (<code>#define</code>) or <code>enum</code>. That's explicitly for your case (at file scope) and if you use a minimum standard of <code>c99</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1538488249, "post_id": 44268451, "comment_id": 92153825, "body": "It cannot be asserted without qualification that a <code>const</code>-qualified variable is not a <i>constant expression</i>. Although the C standard does not require a <i>constant expression</i> to include a <code>const</code>-qualified variable, C 2018 6.6 10 says \u201cAn implementation may accept other forms of constant expressions.\u201d (And the same text is in C 1999.)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1538491681, "post_id": 44268451, "comment_id": 92155964, "body": "C is also different from C++ in that <code>10</code> is not called a <i>numeric literal</i>, but an <i>integer constant</i>.  Aside: C&#39;s   <i>literals</i>, <i>string</i> and <i>compound</i>, can have their addresses taken, unlike an integer constant."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 17, "last_activity_date": 1496165430, "creation_date": 1496165430, "answer_id": 44268451, "question_id": 44267827, "link": "https://stackoverflow.com/questions/44267827/in-c-why-cant-a-const-variable-be-used-as-an-array-size-initializer/44268451#44268451", "title": "In C, why can&#39;t a const variable be used as an array size initializer?", "body": "<p>In C, a <code>const</code>-qualified variable is not a <em>constant expression</em><sup>1</sup>.  A constant expression is something that can be evaluated at compile time - a numeric literal like <code>10</code> or <code>3.14159</code>, a string literal like <code>\"Hello\"</code>, a <code>sizeof</code> expression, or some expression made up of the same like <code>10 + sizeof \"Hello\"</code>.     </p>\n\n<p>For array declarations at file scope (outside the body of any function) or as members of <code>struct</code> or <code>union</code> types, the array dimension <em>must</em> be a constant expression.  </p>\n\n<p>For <code>auto</code> arrays (arrays declared within the body of a function that are not <code>static</code>), you <em>can</em> use a variable or expression whose value isn't known until runtime, but only in C99 or later.</p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>C++ is different in this regard - in that language, a <code>const</code>-qualified variable <em>does</em> count as a constant expression.\n</ol>\n\n<p></sup></p>\n"}, {"tags": [], "owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "is_accepted": false, "score": 15, "last_activity_date": 1537050250, "last_edit_date": 1537050250, "creation_date": 1496165462, "answer_id": 44268465, "question_id": 44267827, "link": "https://stackoverflow.com/questions/44267827/in-c-why-cant-a-const-variable-be-used-as-an-array-size-initializer/44268465#44268465", "title": "In C, why can&#39;t a const variable be used as an array size initializer?", "body": "<p>This is because in C <code>const</code> actually means <em>read only</em>. Quoting <a href=\"http://c-faq.com/decl/constasconst.html\" rel=\"noreferrer\">C FAQ 1.18 and 1.19</a>:</p>\n\n<blockquote>\n  <p>The const qualifier really means ``read-only''; an object so qualified is a run-time object which cannot (normally) be assigned to. The value of a const-qualified object is therefore not a constant expression in the full sense of the term, and cannot be used for array dimensions, case labels, and the like. (C is unlike C++ in this regard.) When you need a true compile-time constant, use a preprocessor #define (or perhaps an enum).</p>\n  \n  <p>References: ISO Sec. 6.4 \n  H&amp;S Secs. 7.11.2,7.11.3 pp. 226-7 </p>\n</blockquote>\n\n<p>There are two ways of dealing with it:</p>\n\n<ol>\n<li>Use <code>#define</code> instead of <code>const</code></li>\n<li>Use <code>enum { sz = 12 };</code></li>\n</ol>\n"}], "owner": {"reputation": 143, "user_id": 8069559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0FUpo.jpg?s=128&g=1", "display_name": "Mahmoud Tmam", "link": "https://stackoverflow.com/users/8069559/mahmoud-tmam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9224, "favorite_count": 6, "closed_date": 1496174887, "accepted_answer_id": 44268451, "answer_count": 3, "score": 14, "last_activity_date": 1539865156, "creation_date": 1496163090, "last_edit_date": 1496173272, "question_id": 44267827, "link": "https://stackoverflow.com/questions/44267827/in-c-why-cant-a-const-variable-be-used-as-an-array-size-initializer", "closed_reason": "Duplicate", "title": "In C, why can&#39;t a const variable be used as an array size initializer?", "body": "<p>In the following code, const int cannot be used as an array size:</p>\n\n<pre><code>const int sz = 0;\ntypedef struct\n{\n   char s[sz];\n} st;\n\nint main()\n{\n   st obj;\n   strcpy(obj.s, \"hello world\");\n   printf(\"%s\", obj.s);\n   return 0;\n}\n</code></pre>\n"}]