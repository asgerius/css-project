[{"tags": ["c", "linux", "gcc"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1502927914, "post_id": 45724653, "comment_id": 78407037, "body": "<i>... find out why the program is crashing randomly</i> <code>double free or corruption (!prev):</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502928441, "post_id": 45724653, "comment_id": 78407147, "body": "It would be much easier to use <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">Valgrind</a> to find out where you&#39;re double-freeing the memory."}, {"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 1, "creation_date": 1502929549, "post_id": 45724653, "comment_id": 78407367, "body": "The numbers become more useful when you enable or install debugging info."}], "owner": {"reputation": 3305, "user_id": 3355076, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7e4d588409a85426aabe6a1a94a5789e?s=128&d=identicon&r=PG", "display_name": "Christopher Reid", "link": "https://stackoverflow.com/users/3355076/christopher-reid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502927726, "creation_date": 1502927726, "question_id": 45724653, "link": "https://stackoverflow.com/questions/45724653/understanding-c-backtraces-in-error-logs", "title": "Understanding C backtraces in error logs", "body": "<p>I've recently started writing C programs to parse and analyze a massive data stream in real-time. One thing I'm having trouble understanding, is (a) error stack traces, and (b) their usefulness in debugging problems. Anyways, I'm hoping someone can help me mentally parse what I see here, or at least to have some idea of what it means, or if I should even bother trying to understand. I really want to find out why the program is crashing randomly.</p>\n\n<pre><code>*** Error in `/home/user_name/project_folder/the_program/the_program': double free or corruption (!prev): 0x000000000242a8b0 ***\n======= Backtrace: =========\n/lib/x86_64-linux-gnu/libc.so.6(+0x777e5)[0x7f5c695227e5]\n/lib/x86_64-linux-gnu/libc.so.6(+0x8037a)[0x7f5c6952b37a]\n/lib/x86_64-linux-gnu/libc.so.6(cfree+0x4c)[0x7f5c6952f53c]\n/home/user_name/project_folder/the_program/the_program[0x401e8c]\n/home/user_name/project_folder/the_program/the_program[0x4020c3]\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf0)[0x7f5c694cb830]\n/home/user_name/project_folder/the_program/the_program[0x401329]\n======= Memory map: ========\n00400000-00403000 r-xp 00000000 ca:01 1051590                            /home/user_name/project_folder/the_program/the_program\n00602000-00603000 r--p 00002000 ca:01 1051590                            /home/user_name/project_folder/the_program/the_program\n00603000-00604000 rw-p 00003000 ca:01 1051590                            /home/user_name/project_folder/the_program/the_program\n023e7000-02438000 rw-p 00000000 00:00 0                                  [heap]\n7f5c54000000-7f5c54021000 rw-p 00000000 00:00 0\n7f5c54021000-7f5c58000000 ---p 00000000 00:00 0\n7f5c5c000000-7f5c5c0b1000 rw-p 00000000 00:00 0\n7f5c5c0b1000-7f5c60000000 ---p 00000000 00:00 0\n7f5c622d2000-7f5c622dd000 r-xp 00000000 ca:01 395465                     /lib/x86_64-linux-gnu/libnss_files-2.23.so\n7f5c622dd000-7f5c624dc000 ---p 0000b000 ca:01 395465                     /lib/x86_64-linux-gnu/libnss_files-2.23.so\n7f5c624dc000-7f5c624dd000 r--p 0000a000 ca:01 395465                     /lib/x86_64-linux-gnu/libnss_files-2.23.so\n7f5c624dd000-7f5c624de000 rw-p 0000b000 ca:01 395465                     /lib/x86_64-linux-gnu/libnss_files-2.23.so\n7f5c624de000-7f5c624e4000 rw-p 00000000 00:00 0\n7f5c624e4000-7f5c624ef000 r-xp 00000000 ca:01 395468                     /lib/x86_64-linux-gnu/libnss_nis-2.23.so\n7f5c624ef000-7f5c626ee000 ---p 0000b000 ca:01 395468                     /lib/x86_64-linux-gnu/libnss_nis-2.23.so\n7f5c626ee000-7f5c626ef000 r--p 0000a000 ca:01 395468                     /lib/x86_64-linux-gnu/libnss_nis-2.23.so\n7f5c626ef000-7f5c626f0000 rw-p 0000b000 ca:01 395468                     /lib/x86_64-linux-gnu/libnss_nis-2.23.so\n7f5c626f0000-7f5c62706000 r-xp 00000000 ca:01 395461                     /lib/x86_64-linux-gnu/libnsl-2.23.so\n7f5c62706000-7f5c62905000 ---p 00016000 ca:01 395461                     /lib/x86_64-linux-gnu/libnsl-2.23.so\n7f5c62905000-7f5c62906000 r--p 00015000 ca:01 395461                     /lib/x86_64-linux-gnu/libnsl-2.23.so\n7f5c62906000-7f5c62907000 rw-p 00016000 ca:01 395461                     /lib/x86_64-linux-gnu/libnsl-2.23.so\n7f5c62907000-7f5c62909000 rw-p 00000000 00:00 0\n7f5c62909000-7f5c62911000 r-xp 00000000 ca:01 395474                     /lib/x86_64-linux-gnu/libnss_compat-2.23.so\n7f5c62911000-7f5c62b10000 ---p 00008000 ca:01 395474                     /lib/x86_64-linux-gnu/libnss_compat-2.23.so\n7f5c62b10000-7f5c62b11000 r--p 00007000 ca:01 395474                     /lib/x86_64-linux-gnu/libnss_compat-2.23.so\n7f5c62b11000-7f5c62b12000 rw-p 00008000 ca:01 395474                     /lib/x86_64-linux-gnu/libnss_compat-2.23.so\n7f5c62b12000-7f5c62b13000 ---p 00000000 00:00 0\n7f5c62b13000-7f5c63313000 rw-p 00000000 00:00 0\n7f5c63313000-7f5c63314000 ---p 00000000 00:00 0\n7f5c63314000-7f5c63b14000 rw-p 00000000 00:00 0\n7f5c63b14000-7f5c63b1b000 r-xp 00000000 ca:01 5289                       /usr/lib/x86_64-linux-gnu/libffi.so.6.0.4\n7f5c63b1b000-7f5c63d1a000 ---p 00007000 ca:01 5289                       /usr/lib/x86_64-linux-gnu/libffi.so.6.0.4\n7f5c63d1a000-7f5c63d1b000 r--p 00006000 ca:01 5289                       /usr/lib/x86_64-linux-gnu/libffi.so.6.0.4\n7f5c63d1b000-7f5c63d1c000 rw-p 00007000 ca:01 5289                       /usr/lib/x86_64-linux-gnu/libffi.so.6.0.4\n7f5c63d1c000-7f5c63d25000 r-xp 00000000 ca:01 395466                     /lib/x86_64-linux-gnu/libcrypt-2.23.so\n7f5c63d25000-7f5c63f24000 ---p 00009000 ca:01 395466                     /lib/x86_64-linux-gnu/libcrypt-2.23.so\n7f5c63f24000-7f5c63f25000 r--p 00008000 ca:01 395466                     /lib/x86_64-linux-gnu/libcrypt-2.23.so\n7f5c63f25000-7f5c63f26000 rw-p 00009000 ca:01 395466                     /lib/x86_64-linux-gnu/libcrypt-2.23.so\n7f5c63f26000-7f5c63f54000 rw-p 00000000 00:00 0\n7f5c63f54000-7f5c64023000 r-xp 00000000 ca:01 5360                       /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6\n7f5c64023000-7f5c64223000 ---p 000cf000 ca:01 5360                       /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6\n7f5c64223000-7f5c64226000 r--p 000cf000 ca:01 5360                       /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6\n7f5c64226000-7f5c64228000 rw-p 000d2000 ca:01 5360                       /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6\n7f5c64228000-7f5c64229000 rw-p 00000000 00:00 0\n7f5c64229000-7f5c64270000 r-xp 00000000 ca:01 4236                       /usr/lib/x86_64-linux-gnu/libhx509.so.5.0.0\n7f5c64270000-7f5c6446f000 ---p 00047000 ca:01 4236                       /usr/lib/x86_64-linux-gnu/libhx509.so.5.0.0\n7f5c6446f000-7f5c64471000 r--p 00046000 ca:01 4236                       /usr/lib/x86_64-linux-gnu/libhx509.so.5.0.0\n7f5c64471000-7f5c64473000 rw-p 00048000 ca:01 4236                       /usr/lib/x86_64-linux-gnu/libhx509.so.5.0.0\n7f5c64473000-7f5c64474000 rw-p 00000000 00:00 0\n7f5c64474000-7f5c64482000 r-xp 00000000 ca:01 4177                       /usr/lib/x86_64-linux-gnu/libheimbase.so.1.0.0\n7f5c64482000-7f5c64681000 ---p 0000e000 ca:01 4177                       /usr/lib/x86_64-linux-gnu/libheimbase.so.1.0.0\n7f5c64681000-7f5c64682000 r--p 0000d000 ca:01 4177                       /usr/lib/x86_64-linux-gnu/libheimbase.so.1.0.0\n7f5c64682000-7f5c64683000 rw-p 0000e000 ca:01 4177                       /usr/lib/x86_64-linux-gnu/libheimbase.so.1.0.0\n7f5c64683000-7f5c646aa000 r-xp 00000000 ca:01 4178                       /usr/lib/x86_64-linux-gnu/libwind.so.0.0.0\n7f5c646aa000-7f5c648aa000 ---p 00027000 ca:01 4178                       /usr/lib/x86_64-linux-gnu/libwind.so.0.0.0\n7f5c648aa000-7f5c648ab000 r--p 00027000 ca:01 4178                       /usr/lib/x86_64-linux-gnu/libwind.so.0.0.0\n7f5c648ab000-7f5c648ac000 rw-p 00028000 ca:01 4178                       /usr/lib/x86_64-linux-gnu/libwind.so.0.0.0\n7f5c648ac000-7f5c64922000 r-xp 00000000 ca:01 333                        /usr/local/lib/libgmp.so.10.3.2\n7f5c64922000-7f5c64b21000 ---p 00076000 ca:01 333                        /usr/local/lib/libgmp.so.10.3.2\n7f5c64b21000-7f5c64b22000 r--p 00075000 ca:01 333                        /usr/local/lib/libgmp.so.10.3.2\n7f5c64b22000-7f5c64b23000 rw-p 00076000 ca:01 333                        /usr/local/lib/libgmp.so.10.3.2\n7f5c64b23000-7f5c64b55000 r-xp 00000000 ca:01 600                        /usr/lib/x86_64-linux-gnu/libhogweed.so.4.2\n7f5c64b55000-7f5c64d54000 ---p 00032000 ca:01 600                        /usr/lib/x86_64-linux-gnu/libhogweed.so.4.2\n7f5c64d54000-7f5c64d55000 r--p 00031000 ca:01 600                        /usr/lib/x86_64-linux-gnu/libhogweed.so.4.2\n7f5c64d55000-7f5c64d56000 rw-p 00032000 ca:01 600                        /usr/lib/x86_64-linux-gnu/libhogweed.so.4.2\n7f5c64d56000-7f5c64d8a000 r-xp 00000000 ca:01 1177                       /usr/lib/x86_64-linux-gnu/libnettle.so.6.2\n7f5c64d8a000-7f5c64f89000 ---p 00034000 ca:01 1177                       /usr/lib/x86_64-linux-gnu/libnettle.so.6.2\n7f5c64f89000-7f5c64f8b000 r--p 00033000 ca:01 1177                       /usr/lib/x86_64-linux-gnu/libnettle.so.6.2\n7f5c64f8b000-7f5c64f8c000 rw-p 00035000 ca:01 1177                       /usr/lib/x86_64-linux-gnu/libnettle.so.6.2\n7f5c64f8c000-7f5c64f9d000 r-xp 00000000 ca:01 12275                      /usr/lib/x86_64-linux-gnu/libtasn1.so.6.5.1\n7f5c64f9d000-7f5c6519d000 ---p 00011000 ca:01 12275                      /usr/lib/x86_64-linux-gnu/libtasn1.so.6.5.1\n7f5c6519d000-7f5c6519e000 r--p 00011000 ca:01 12275                      /usr/lib/x86_64-linux-gnu/libtasn1.so.6.5.1\n7f5c6519e000-7f5c6519f000 rw-p 00012000 ca:01 12275                      /usr/lib/x86_64-linux-gnu/libtasn1.so.6.5.1\n7f5c6519f000-7f5c651d0000 r-xp 00000000 ca:01 27656                      /usr/lib/x86_64-linux-gnu/libidn.so.11.6.15\n7f5c651d0000-7f5c653d0000 ---p 00031000 ca:01 27656                      /usr/lib/x86_64-linux-gnu/libidn.so.11.6.15\n7f5c653d0000-7f5c653d1000 r--p 00031000 ca:01 27656                      /usr/lib/x86_64-linux-gnu/libidn.so.11.6.15\n7f5c653d1000-7f5c653d2000 rw-p 00032000 ca:01 27656                      /usr/lib/x86_64-linux-gnu/libidn.so.11.6.15\n7f5c653d2000-7f5c6542c000 r-xp 00000000 ca:01 5344                       /usr/lib/x86_64-linux-gnu/libp11-kit.so.0.1.0\n7f5c6542c000-7f5c6562b000 ---p 0005a000 ca:01 5344                       /usr/lib/x86_64-linux-gnu/libp11-kit.so.0.1.0\n7f5c6562b000-7f5c65635000 r--p 00059000 ca:01 5344                       /usr/lib/x86_64-linux-gnu/libp11-kit.so.0.1.0\n7f5c65635000-7f5c65637000 rw-p 00063000 ca:01 5344                       /usr/lib/x86_64-linux-gnu/libp11-kit.so.0.1.0\n7f5c65637000-7f5c65650000 r-xp 00000000 ca:01 396860                     /lib/x86_64-linux-gnu/libz.so.1.2.8\n7f5c65650000-7f5c6584f000 ---p 00019000 ca:01 396860                     /lib/x86_64-linux-gnu/libz.so.1.2.8\n7f5c6584f000-7f5c65850000 r--p 00018000 ca:01 396860                     /lib/x86_64-linux-gnu/libz.so.1.2.8\n7f5c65850000-7f5c65851000 rw-p 00019000 ca:01 396860                     /lib/x86_64-linux-gnu/libz.so.1.2.8\n7f5c65851000-7f5c65866000 r-xp 00000000 ca:01 5740                       /usr/lib/x86_64-linux-gnu/libroken.so.18.1.0\n7f5c65866000-7f5c65a65000 ---p 00015000 ca:01 5740                       /usr/lib/x86_64-linux-gnu/libroken.so.18.1.0\n7f5c65a65000-7f5c65a66000 r--p 00014000 ca:01 5740                       /usr/lib/x86_64-linux-gnu/libroken.so.18.1.0\n7f5c65a66000-7f5c65a67000 rw-p 00015000 ca:01 5740                       /usr/lib/x86_64-linux-gnu/libroken.so.18.1.0\n7f5c65a67000-7f5c65a97000 r-xp 00000000 ca:01 4139                       /usr/lib/x86_64-linux-gnu/libhcrypto.so.4.1.0\n7f5c65a97000-7f5c65c97000 ---p 00030000 ca:01 4139                       /usr/lib/x86_64-linux-gnu/libhcrypto.so.4.1.0\n7f5c65c97000-7f5c65c98000 r--p 00030000 ca:01 4139                       /usr/lib/x86_64-linux-gnu/libhcrypto.so.4.1.0\n7f5c65c98000-7f5c65c99000 rw-p 00031000 ca:01 4139                       /usr/lib/x86_64-linux-gnu/libhcrypto.so.4.1.0\n7f5c65c99000-7f5c65c9a000 rw-p 00000000 00:00 0\n7f5c65c9a000-7f5c65d39000 r-xp 00000000 ca:01 4227                       /usr/lib/x86_64-linux-gnu/libasn1.so.8.0.0\n7f5c65d39000-7f5c65f38000 ---p 0009f000 ca:01 4227                       /usr/lib/x86_64-linux-gnu/libasn1.so.8.0.0\n7f5c65f38000-7f5c65f39000 r--p 0009e000 ca:01 4227                       /usr/lib/x86_64-linux-gnu/libasn1.so.8.0.0\n7f5c65f39000-7f5c65f3c000 rw-p 0009f000 ca:01 4227                       /usr/lib/x86_64-linux-gnu/libasn1.so.8.0.0\n7f5c65f3c000-7f5c65fc0000 r-xp 00000000 ca:01 4181                       /usr/lib/x86_64-linux-gnu/libkrb5.so.26.0.0\n7f5c65fc0000-7f5c661bf000 ---p 00084000 ca:01 4181                       /usr/lib/x86_64-linux-gnu/libkrb5.so.26.0.0\n7f5c661bf000-7f5c661c2000 r--p 00083000 ca:01 4181                       /usr/lib/x86_64-linux-gnu/libkrb5.so.26.0.0\n7f5c661c2000-7f5c661c5000 rw-p 00086000 ca:01 4181                       /usr/lib/x86_64-linux-gnu/libkrb5.so.26.0.0\n7f5c661c5000-7f5c661c6000 rw-p 00000000 00:00 0\n7f5c661c6000-7f5c661ce000 r-xp 00000000 ca:01 4196                       /usr/lib/x86_64-linux-gnu/libheimntlm.so.0.1.0\n7f5c661ce000-7f5c663cd000 ---p 00008000 ca:01 4196                       /usr/lib/x86_64-linux-gnu/libheimntlm.so.0.1.0\n7f5c663cd000-7f5c663ce000 r--p 00007000 ca:01 4196                       /usr/lib/x86_64-linux-gnu/libheimntlm.so.0.1.0\n7f5c663ce000-7f5c663cf000 rw-p 00008000 ca:01 4196                       /usr/lib/x86_64-linux-gnu/libheimntlm.so.0.1.0\n7f5c663cf000-7f5c663d2000 r-xp 00000000 ca:01 396800                     /lib/x86_64-linux-gnu/libkeyutils.so.1.5\n7f5c663d2000-7f5c665d1000 ---p 00003000 ca:01 396800                     /lib/x86_64-linux-gnu/libkeyutils.so.1.5\n7f5c665d1000-7f5c665d2000 r--p 00002000 ca:01 396800                     /lib/x86_64-linux-gnu/libkeyutils.so.1.5\n7f5c665d2000-7f5c665d3000 rw-p 00003000 ca:01 396800                     /lib/x86_64-linux-gnu/libkeyutils.so.1.5\n7f5c665d3000-7f5c666f6000 r-xp 00000000 ca:01 595                        /usr/lib/x86_64-linux-gnu/libgnutls.so.30.6.2\n7f5c666f6000-7f5c668f5000 ---p 00123000 ca:01 595                        /usr/lib/x86_64-linux-gnu/libgnutls.so.30.6.2\n7f5c668f5000-7f5c66900000 r--p 00122000 ca:01 595                        /usr/lib/x86_64-linux-gnu/libgnutls.so.30.6.2\n7f5c66900000-7f5c66902000 rw-p 0012d000 ca:01 595                        /usr/lib/x86_64-linux-gnu/libgnutls.so.30.6.2\n7f5c66902000-7f5c66903000 rw-p 00000000 00:00 0\n7f5c66903000-7f5c66940000 r-xp 00000000 ca:01 4179                       /usr/lib/x86_64-linux-gnu/libgssapi.so.3.0.0\n7f5c66940000-7f5c66b40000 ---p 0003d000 ca:01 4179                       /usr/lib/x86_64-linux-gnu/libgssapi.so.3.0.0\n7f5c66b40000-7f5c66b41000 r--p 0003d000 ca:01 4179                       /usr/lib/x86_64-linux-gnu/libgssapi.so.3.0.0\n7f5c66b41000-7f5c66b43000 rw-p 0003e000 ca:01 4179                       /usr/lib/x86_64-linux-gnu/libgssapi.so.3.0.0\n7f5c66b43000-7f5c66b44000 rw-p 00000000 00:00 0\n7f5c66b44000-7f5c66b5d000 r-xp 00000000 ca:01 5357                       /usr/lib/x86_64-linux-gnu/libsasl2.so.2.0.25\n7f5c66b5d000-7f5c66d5d000 ---p 00019000 ca:01 5357                       /usr/lib/x86_64-linux-gnu/libsasl2.so.2.0.25\n7f5c66d5d000-7f5c66d5e000 r--p 00019000 ca:01 5357                       /usr/lib/x86_64-linux-gnu/libsasl2.so.2.0.25\n7f5c66d5e000-7f5c66d5f000 rw-p 0001a000 ca:01 5357                       /usr/lib/x86_64-linux-gnu/libsasl2.so.2.0.25\n7f5c66d5f000-7f5c66d76000 r-xp 00000000 ca:01 395476                     /lib/x86_64-linux-gnu/libresolv-2.23.so\n7f5c66d76000-7f5c66f76000 ---p 00017000 ca:01 395476                     /lib/x86_64-linux-gnu/libresolv-2.23.so\n7f5c66f76000-7f5c66f77000 r--p 00017000 ca:01 395476                     /lib/x86_64-linux-gnu/libresolv-2.23.so\n7f5c66f77000-7f5c66f78000 rw-p 00018000 ca:01 395476                     /lib/x86_64-linux-gnu/libresolv-2.23.so\n7f5c66f78000-7f5c66f7a000 rw-p 00000000 00:00 0\n7f5c66f7a000-7f5c66f87000 r-xp 00000000 ca:01 12285                      /usr/lib/x86_64-linux-gnu/liblber-2.4.so.2.10.5\n7f5c66f87000-7f5c67187000 ---p 0000d000 ca:01 12285                      /usr/lib/x86_64-linux-gnu/liblber-2.4.so.2.10.5\n7f5c67187000-7f5c67188000 r--p 0000d000 ca:01 12285                      /usr/lib/x86_64-linux-gnu/liblber-2.4.so.2.10.5\n7f5c67188000-7f5c67189000 rw-p 0000e000 ca:01 12285                      /usr/lib/x86_64-linux-gnu/liblber-2.4.so.2.10.5\n7f5c67189000-7f5c67193000 r-xp 00000000 ca:01 5328                       /usr/lib/x86_64-linux-gnu/libkrb5support.so.0.1\n7f5c67193000-7f5c67392000 ---p 0000a000 ca:01 5328                       /usr/lib/x86_64-linux-gnu/libkrb5support.so.0.1\n7f5c67392000-7f5c67393000 r--p 00009000 ca:01 5328                       /usr/lib/x86_64-linux-gnu/libkrb5support.so.0.1\n7f5c67393000-7f5c67394000 rw-p 0000a000 ca:01 5328                       /usr/lib/x86_64-linux-gnu/libkrb5support.so.0.1\n7f5c67394000-7f5c67397000 r-xp 00000000 ca:01 396774                     /lib/x86_64-linux-gnu/libcom_err.so.2.1\n7f5c67397000-7f5c67596000 ---p 00003000 ca:01 396774                     /lib/x86_64-linux-gnu/libcom_err.so.2.1\n7f5c67596000-7f5c67597000 r--p 00002000 ca:01 396774                     /lib/x86_64-linux-gnu/libcom_err.so.2.1\n7f5c67597000-7f5c67598000 rw-p 00003000 ca:01 396774                     /lib/x86_64-linux-gnu/libcom_err.so.2.1\n7f5c67598000-7f5c675c4000 r-xp 00000000 ca:01 5325                       /usr/lib/x86_64-linux-gnu/libk5crypto.so.3.1\n7f5c675c4000-7f5c677c3000 ---p 0002c000 ca:01 5325                       /usr/lib/x86_64-linux-gnu/libk5crypto.so.3.1\n7f5c677c3000-7f5c677c5000 r--p 0002b000 ca:01 5325                       /usr/lib/x86_64-linux-gnu/libk5crypto.so.3.1\n7f5c677c5000-7f5c677c6000 rw-p 0002d000 ca:01 5325                       /usr/lib/x86_64-linux-gnu/libk5crypto.so.3.1\n7f5c677c6000-7f5c677c7000 rw-p 00000000 00:00 0\n7f5c677c7000-7f5c6788a000 r-xp 00000000 ca:01 5327                       /usr/lib/x86_64-linux-gnu/libkrb5.so.3.3\n7f5c6788a000-7f5c67a8a000 ---p 000c3000 ca:01 5327                       /usr/lib/x86_64-linux-gnu/libkrb5.so.3.3\n7f5c67a8a000-7f5c67a97000 r--p 000c3000 ca:01 5327                       /usr/lib/x86_64-linux-gnu/libkrb5.so.3.3\n7f5c67a97000-7f5c67a99000 rw-p 000d0000 ca:01 5327                       /usr/lib/x86_64-linux-gnu/libkrb5.so.3.3\n7f5c67a99000-7f5c67a9c000 r-xp 00000000 ca:01 395473                     /lib/x86_64-linux-gnu/libdl-2.23.so\n7f5c67a9c000-7f5c67c9b000 ---p 00003000 ca:01 395473                     /lib/x86_64-linux-gnu/libdl-2.23.so\n7f5c67c9b000-7f5c67c9c000 r--p 00002000 ca:01 395473                     /lib/x86_64-linux-gnu/libdl-2.23.so\n7f5c67c9c000-7f5c67c9d000 rw-p 00003000 ca:01 395473                     /lib/x86_64-linux-gnu/libdl-2.23.so\n7f5c67c9d000-7f5c67cea000 r-xp 00000000 ca:01 704                        /usr/lib/x86_64-linux-gnu/libldap_r-2.4.so.2.10.5\n7f5c67cea000-7f5c67ee9000 ---p 0004d000 ca:01 704                        /usr/lib/x86_64-linux-gnu/libldap_r-2.4.so.2.10.5\n7f5c67ee9000-7f5c67eeb000 r--p 0004c000 ca:01 704                        /usr/lib/x86_64-linux-gnu/libldap_r-2.4.so.2.10.5\n7f5c67eeb000-7f5c67eec000 rw-p 0004e000 ca:01 704                        /usr/lib/x86_64-linux-gnu/libldap_r-2.4.so.2.10.5\n7f5c67eec000-7f5c67eee000 rw-p 00000000 00:00 0\n7f5c67eee000-7f5c67f35000 r-xp 00000000 ca:01 5305                       /usr/lib/x86_64-linux-gnu/libgssapi_krb5.so.2.2\n7f5c67f35000-7f5c68134000 ---p 00047000 ca:01 5305                       /usr/lib/x86_64-linux-gnu/libgssapi_krb5.so.2.2\n7f5c68134000-7f5c68136000 r--p 00046000 ca:01 5305                       /usr/lib/x86_64-linux-gnu/libgssapi_krb5.so.2.2\n7f5c68136000-7f5c68138000 rw-p 00048000 ca:01 5305                       /usr/lib/x86_64-linux-gnu/libgssapi_krb5.so.2.2\n7f5c68138000-7f5c68352000 r-xp 00000000 ca:01 395917                     /lib/x86_64-linux-gnu/libcrypto.so.1.0.0\n7f5c68352000-7f5c68551000 ---p 0021a000 ca:01 395917                     /lib/x86_64-linux-gnu/libcrypto.so.1.0.0\n7f5c68551000-7f5c6856d000 r--p 00219000 ca:01 395917                     /lib/x86_64-linux-gnu/libcrypto.so.1.0.0\n7f5c6856d000-7f5c68579000 rw-p 00235000 ca:01 395917                     /lib/x86_64-linux-gnu/libcrypto.so.1.0.0\n7f5c68579000-7f5c6857c000 rw-p 00000000 00:00 0\n7f5c6857c000-7f5c685da000 r-xp 00000000 ca:01 395918                     /lib/x86_64-linux-gnu/libssl.so.1.0.0\n7f5c685da000-7f5c687da000 ---p 0005e000 ca:01 395918                     /lib/x86_64-linux-gnu/libssl.so.1.0.0\n7f5c687da000-7f5c687de000 r--p 0005e000 ca:01 395918                     /lib/x86_64-linux-gnu/libssl.so.1.0.0\n7f5c687de000-7f5c687e5000 rw-p 00062000 ca:01 395918                     /lib/x86_64-linux-gnu/libssl.so.1.0.0\n7f5c687e5000-7f5c687fb000 r-xp 00000000 ca:01 396789                     /lib/x86_64-linux-gnu/libgcc_s.so.1\n7f5c687fb000-7f5c689fa000 ---p 00016000 ca:01 396789                     /lib/x86_64-linux-gnu/libgcc_s.so.1\n7f5c689fa000-7f5c689fb000 rw-p 00015000 ca:01 396789                     /lib/x86_64-linux-gnu/libgcc_s.so.1\n7f5c689fb000-7f5c68b03000 r-xp 00000000 ca:01 395479                     /lib/x86_64-linux-gnu/libm-2.23.so\n7f5c68b03000-7f5c68d02000 ---p 00108000 ca:01 395479                     /lib/x86_64-linux-gnu/libm-2.23.so\n7f5c68d02000-7f5c68d03000 r--p 00107000 ca:01 395479                     /lib/x86_64-linux-gnu/libm-2.23.so\n7f5c68d03000-7f5c68d04000 rw-p 00108000 ca:01 395479                     /lib/x86_64-linux-gnu/libm-2.23.so\n7f5c68d04000-7f5c68e76000 r-xp 00000000 ca:01 28090                      /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.21\n7f5c68e76000-7f5c69076000 ---p 00172000 ca:01 28090                      /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.21\n7f5c69076000-7f5c69080000 r--p 00172000 ca:01 28090                      /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.21\n7f5c69080000-7f5c69082000 rw-p 0017c000 ca:01 28090                      /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.21\n7f5c69082000-7f5c69086000 rw-p 00000000 00:00 0\n7f5c69086000-7f5c6909e000 r-xp 00000000 ca:01 395467                     /lib/x86_64-linux-gnu/libpthread-2.23.so\n7f5c6909e000-7f5c6929d000 ---p 00018000 ca:01 395467                     /lib/x86_64-linux-gnu/libpthread-2.23.so\n7f5c6929d000-7f5c6929e000 r--p 00017000 ca:01 395467                     /lib/x86_64-linux-gnu/libpthread-2.23.so\n7f5c6929e000-7f5c6929f000 rw-p 00018000 ca:01 395467                     /lib/x86_64-linux-gnu/libpthread-2.23.so\n7f5c6929f000-7f5c692a3000 rw-p 00000000 00:00 0\n7f5c692a3000-7f5c692aa000 r-xp 00000000 ca:01 395470                     /lib/x86_64-linux-gnu/librt-2.23.so\n7f5c692aa000-7f5c694a9000 ---p 00007000 ca:01 395470                     /lib/x86_64-linux-gnu/librt-2.23.so\n7f5c694a9000-7f5c694aa000 r--p 00006000 ca:01 395470                     /lib/x86_64-linux-gnu/librt-2.23.so\n7f5c694aa000-7f5c694ab000 rw-p 00007000 ca:01 395470                     /lib/x86_64-linux-gnu/librt-2.23.so\n7f5c694ab000-7f5c6966b000 r-xp 00000000 ca:01 395484                     /lib/x86_64-linux-gnu/libc-2.23.so\n7f5c6966b000-7f5c6986b000 ---p 001c0000 ca:01 395484                     /lib/x86_64-linux-gnu/libc-2.23.so\n7f5c6986b000-7f5c6986f000 r--p 001c0000 ca:01 395484                     /lib/x86_64-linux-gnu/libc-2.23.so\n7f5c6986f000-7f5c69871000 rw-p 001c4000 ca:01 395484                     /lib/x86_64-linux-gnu/libc-2.23.so\n7f5c69871000-7f5c69875000 rw-p 00000000 00:00 0\n7f5c69875000-7f5c698a2000 r-xp 00000000 ca:01 8152                       /usr/lib/x86_64-linux-gnu/libpq.so.5.9\n7f5c698a2000-7f5c69aa1000 ---p 0002d000 ca:01 8152                       /usr/lib/x86_64-linux-gnu/libpq.so.5.9\n7f5c69aa1000-7f5c69aa4000 r--p 0002c000 ca:01 8152                       /usr/lib/x86_64-linux-gnu/libpq.so.5.9\n7f5c69aa4000-7f5c69aa5000 rw-p 0002f000 ca:01 8152                       /usr/lib/x86_64-linux-gnu/libpq.so.5.9\n7f5c69aa5000-7f5c69b23000 r-xp 00000000 ca:01 46107                      /usr/local/lib/libzmq.so.5.0.0\n7f5c69b23000-7f5c69d23000 ---p 0007e000 ca:01 46107                      /usr/local/lib/libzmq.so.5.0.0\n7f5c69d23000-7f5c69d28000 r--p 0007e000 ca:01 46107                      /usr/local/lib/libzmq.so.5.0.0\n7f5c69d28000-7f5c69d29000 rw-p 00083000 ca:01 46107                      /usr/local/lib/libzmq.so.5.0.0\n7f5c69d29000-7f5c69d4f000 r-xp 00000000 ca:01 395462                     /lib/x86_64-linux-gnu/ld-2.23.so\n7f5c69f2c000-7f5c69f41000 rw-p 00000000 00:00 0\n7f5c69f4b000-7f5c69f4e000 rw-p 00000000 00:00 0\n7f5c69f4e000-7f5c69f4f000 r--p 00025000 ca:01 395462                     /lib/x86_64-linux-gnu/ld-2.23.so\n7f5c69f4f000-7f5c69f50000 rw-p 00026000 ca:01 395462                     /lib/x86_64-linux-gnu/ld-2.23.so\n7f5c69f50000-7f5c69f51000 rw-p 00000000 00:00 0\n7ffc90bb9000-7ffc90bda000 rw-p 00000000 00:00 0                          [stack]\n7ffc90bf4000-7ffc90bf6000 r--p 00000000 00:00 0                          [vvar]\n7ffc90bf6000-7ffc90bf8000 r-xp 00000000 00:00 0                          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 1313, "user_id": 2128362, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5cafa422780635664d84e3f0bba392cf?s=128&d=identicon&r=PG", "display_name": "jackarms", "link": "https://stackoverflow.com/users/2128362/jackarms"}, "edited": false, "score": 1, "creation_date": 1502926946, "post_id": 45724513, "comment_id": 78406820, "body": "Other than dynamically allocating the memory, you could see if you can have <code>level_data</code> be a flexible array in the struct <a href=\"https://stackoverflow.com/questions/8687671/how-to-initialize-a-structure-with-flexible-array-member\" title=\"how to initialize a structure with flexible array member\">stackoverflow.com/questions/8687671/&hellip;</a>"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1502927352, "post_id": 45724513, "comment_id": 78406922, "body": "@jackarms-- dynamic allocation is still needed with a FAM."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1502927391, "post_id": 45724513, "comment_id": 78406935, "body": "<code>const</code> doesn&#39;t mean &quot;constant&quot;. A constant expression is one that can be evaluated at compile time. The <code>const</code> keyword should perhaps have been spelled <code>readonly</code>, because that&#39;s what it really means. This valid declaration: <code>const int r = rand();</code> demonstrates the difference (note that it&#39;s valid only at block scope, not at file scope)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502943312, "post_id": 45724513, "comment_id": 78410410, "body": "Are you using C99 or  C11 with VLA availablilty?"}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1502927322, "post_id": 45724576, "comment_id": 78406913, "body": "The <code>(char*)</code> cast is unnecessary and ill-advised."}, {"owner": {"reputation": 488, "user_id": 1894697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e31e63c623c67fad9d407a84729c725?s=128&d=identicon&r=PG", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/1894697/chrisb"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1502927598, "post_id": 45724576, "comment_id": 78406967, "body": "@KeithThompson Yes, but many compilers pop annoying warnings because the signature of <code>malloc</code> is <code>void *malloc(size_t size)</code>."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 3, "creation_date": 1502927761, "post_id": 45724576, "comment_id": 78407002, "body": "Not C compilers."}, {"owner": {"reputation": 488, "user_id": 1894697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e31e63c623c67fad9d407a84729c725?s=128&d=identicon&r=PG", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/1894697/chrisb"}, "edited": false, "score": 1, "creation_date": 1502927954, "post_id": 45724576, "comment_id": 78407046, "body": "Ooops indeed! Here is a good analysis: <a href=\"https://stackoverflow.com/questions/3477741/why-does-c-require-a-cast-for-malloc-but-c-doesnt\" title=\"why does c require a cast for malloc but c doesnt\">stackoverflow.com/questions/3477741/&hellip;</a>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1502930068, "post_id": 45724576, "comment_id": 78407465, "body": "Also don&#39;t forget to check whether the allocation succeeded: <code>if (level_data == NULL) { &#47;* handle allocation failure *&#47; }</code>"}], "tags": [], "owner": {"reputation": 488, "user_id": 1894697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e31e63c623c67fad9d407a84729c725?s=128&d=identicon&r=PG", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/1894697/chrisb"}, "is_accepted": true, "score": 2, "last_activity_date": 1502956414, "last_edit_date": 1502956414, "creation_date": 1502927143, "answer_id": 45724576, "question_id": 45724513, "link": "https://stackoverflow.com/questions/45724513/use-return-value-of-function-as-array-size-initialiser-in-c/45724576#45724576", "title": "Use return value of function as array size initialiser in C", "body": "<p>The size of the array has to be known at compilation time. If you want to allocate memory dynamically you have to use <code>malloc</code>.</p>\n\n<pre><code>char *level_data = malloc(get_terminal_size());\nif (level_data == NULL)\n{ /* handle allocation failure */ }\n/* ...Do something with your array... */\nfree(level_data);\n</code></pre>\n\n<p>People in comments, thank you for the corrections.</p>\n"}, {"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1502930579, "post_id": 45724879, "comment_id": 78407574, "body": "C has had VLAs since C99; the problem here is that a <code>struct</code> can&#39;t have a VLA member."}, {"owner": {"reputation": 104, "user_id": 6395690, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/950842084772b5ac70fbfe995cc63c78?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6395690/jeremy"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1502974417, "post_id": 45724879, "comment_id": 78428986, "body": "Shoot, I actually hadn&#39;t realized that was supported.  Thanks for the heads up, I have something exciting to learn today."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1502976365, "post_id": 45724879, "comment_id": 78430541, "body": "Introduced in C99, then made optional in C11 (but commonly available). There are some disadvantages to VLAs, too: they are typically stack-allocated, so limited in size; when it fails, allocation fails silently, whereas with <code>malloc()</code> you can check the return value for <code>NULL</code>; VLAs can&#39;t be defined at file-scope. They are particularly handy for dynamic allocation of true multi-dimensional arrays; you might see <a href=\"https://stackoverflow.com/a/42094467/6879826\">this answer</a> for details."}], "tags": [], "owner": {"reputation": 104, "user_id": 6395690, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/950842084772b5ac70fbfe995cc63c78?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6395690/jeremy"}, "is_accepted": false, "score": -2, "last_activity_date": 1502929746, "creation_date": 1502929746, "answer_id": 45724879, "question_id": 45724513, "link": "https://stackoverflow.com/questions/45724513/use-return-value-of-function-as-array-size-initialiser-in-c/45724879#45724879", "title": "Use return value of function as array size initialiser in C", "body": "<p>ChrisB is correct, you cannot set the length of an array dynamically in C.  I think the reason for this \"quirk\" is important to understand when coming from other languages.</p>\n\n<p>Every value and variable in C needs a spot in memory, and each program is allocated a chunk of memory to store its values.  This is divided into the <em>stack</em>, and the <em>heap</em>.</p>\n\n<p>The heap is a big chunk of memory reserved for later allocation.  When you run <code>malloc</code>, what you get back is a pointer to a small section of the heap you can use as you'd like.</p>\n\n<p>The stack is where we store memory that functions need to do their work.  If your program looks like</p>\n\n<pre><code>void my_function(void) {\n    int a = 1;\n    return;\n}\nint main(void) {\n    int x = 0; // (A)\n    x++;\n    my_function(); // (B)\n    x++;\n    return 0;\n}\n</code></pre>\n\n<p>When we're at (A), the stack reserves an int-sized spot to store <code>x</code>, as it's played around with.  When we're at (B), we still need to hold the space for <code>x</code> in memory, but we also need space for <code>a</code> now.</p>\n\n<p>The \"stack\" is packed tightly to make use of the available space, and to pack it tightly, the compiler needs to know exactly how much space on the stack each function needs for its local variables.  The heap is less tightly packed, and so doesn't have the same requirement.</p>\n"}, {"comments": [{"owner": {"reputation": 345, "user_id": 4890559, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a40d3bb67e60314ed1be5a19cfe23265?s=128&d=identicon&r=PG&f=1", "display_name": "tobycode", "link": "https://stackoverflow.com/users/4890559/tobycode"}, "edited": false, "score": 1, "creation_date": 1502957612, "post_id": 45724970, "comment_id": 78417204, "body": "Thank you very much for the detailed answer! Definitely learned something new about flexible array members, but I&#39;ll go the char pointer route as it seems relatively easy to implement (especially because I&#39;m loading in level data from files and can just strcpy it in)"}], "tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 2, "last_activity_date": 1502955110, "last_edit_date": 1502955110, "creation_date": 1502930446, "answer_id": 45724970, "question_id": 45724513, "link": "https://stackoverflow.com/questions/45724513/use-return-value-of-function-as-array-size-initialiser-in-c/45724970#45724970", "title": "Use return value of function as array size initialiser in C", "body": "<p>A fixed length array must be declared with a positive integer constant value in the brackets so that its size may be known at compile-time; note that a <code>const int</code> is not a compile-time constant, but instead a read-only value. C has had variable length arrays since C99, which can be sized at runtime with variables instead of (compile-time) constants. If the posted code was compiled under C99, then this was interpreted as a VLA:</p>\n\n<pre><code>char level_data[get_terminal_size()];\n</code></pre>\n\n<p>VLAs were made optional in C11, but they appear to be well-supported in most C11 implementations. Under C89, the above declaration would raise an error since there is no support for VLAs here. But in more modern C implementations that support VLAs, the problem is that a <code>struct</code> can not contain a VLA member.</p>\n\n<h2>With Dynamic Allocation</h2>\n\n<p>To obtain an array member in a <code>struct</code> that has its length determined at runtime, you could use either a pointer to dynamically allocated memory, or a flexible array member. A flexible array member is an incomplete array type declared as the last member of a <code>struct</code> with more than one named member. The size of such a <code>struct</code> is calculated as if the FAM were omitted:</p>\n\n<pre><code>struct level {\n    int id;\n    size_t data_sz;\n    char level_data[];\n};\n</code></pre>\n\n<p>To use a FAM, you will need to allocate memory for the <code>struct</code> plus memory for the FAM. You may wish to store the size of the FAM in the <code>struct</code>, and you will still need to remember to <code>free</code> the allocation when you are finished with it. Here is an example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define DATA_ARRAY_SZ  10;\n\nstruct level {\n    int id;\n    size_t data_sz;\n    char level_data[];\n};\n\nsize_t get_size(void);\n\nint main(void)\n{\n    size_t size = get_size();\n    struct level *my_level;\n    my_level = malloc(sizeof *my_level\n                      + sizeof *my_level-&gt;level_data * size);\n    if (my_level == NULL) {\n        perror(\"Unable to allocate memory\");\n        exit(EXIT_FAILURE);\n    }\n\n    my_level-&gt;data_sz = size;\n    for (size_t i = 0; i &lt; my_level-&gt;data_sz; i++) {\n        my_level-&gt;level_data[i] = 'a' + i;\n    }\n\n    for (size_t i = 0; i &lt; my_level-&gt;data_sz; i++) {\n        printf(\"%c\", my_level-&gt;level_data[i]);\n    }\n    putchar('\\n');\n\n    /* Free allocated memory */\n    free(my_level);\n\n    return 0;\n}\n\nsize_t get_size(void)\n{\n    return DATA_ARRAY_SZ;\n}\n</code></pre>\n\n<h2>Without Dynamic Allocation</h2>\n\n<p>If VLAs are available, there is a simpler option that does not require dynamic allocation. You could declare <code>level_data</code> as a pointer to <code>char</code>, and declare a VLA of the needed size at runtime, assigning the address of the first element of the VLA to <code>level_data</code>. Since there is no dynamic allocation, there is nothing to deallocate later. This approach also does not suffer from a limitation of structures with flexible array members: they can't be used as members of other <code>struct</code>s or arrays. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define DATA_ARRAY_SZ  10;\n\nstruct level {\n    int id;\n    size_t data_sz;\n    char *level_data;\n};\n\nsize_t get_size(void);\n\nint main(void)\n{\n    size_t size = get_size();\n    char data_arr[size];\n\n    struct level my_level = { .data_sz = size, .level_data = data_arr };\n\n    for (size_t i = 0; i &lt; my_level.data_sz; i++) {\n        my_level.level_data[i] = 'a' + i;\n    }\n\n    for (size_t i = 0; i &lt; my_level.data_sz; i++) {\n        printf(\"%c\", my_level.level_data[i]);\n    }\n    putchar('\\n');\n\n    return 0;\n}\n\nsize_t get_size(void)\n{\n    return DATA_ARRAY_SZ;\n}\n</code></pre>\n"}], "owner": {"reputation": 345, "user_id": 4890559, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a40d3bb67e60314ed1be5a19cfe23265?s=128&d=identicon&r=PG&f=1", "display_name": "tobycode", "link": "https://stackoverflow.com/users/4890559/tobycode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 45724576, "answer_count": 3, "score": 3, "last_activity_date": 1502956414, "creation_date": 1502926682, "question_id": 45724513, "link": "https://stackoverflow.com/questions/45724513/use-return-value-of-function-as-array-size-initialiser-in-c", "title": "Use return value of function as array size initialiser in C", "body": "<p>I've written a function in C to get the size of the terminal:</p>\n\n<pre><code>int get_terminal_size()\n{\n    struct winsize w;\n    ioctl(STDOUT_FILENO, TIOCGWINSZ, &amp;w);\n\n    return w.ws_row * w.ws_col;\n}\n</code></pre>\n\n<p>However, I want to use it as the size parameter when initialising an array in a struct:</p>\n\n<pre><code>struct level\n{\n    [...]\n    char level_data[get_terminal_size()];\n}\n</code></pre>\n\n<p>However, this doesn't compile, as the compiler tells me that the initialiser element needs to be constant (which makes sense, but assigning the return value to a <code>const int</code> doesn't work either).</p>\n\n<p>Is there any other way of doing what I need to do in C?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "declaration"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1502926127, "post_id": 45724358, "comment_id": 78406641, "body": "error at <code>extern int i;</code> : Duplicate identifiers in the same scope. Try <code>{ extern int i; printf(&quot;%d\\n&quot;, i); }</code>"}, {"owner": {"reputation": 452, "user_id": 7247051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad026d36f38a1088e8ce7a1786da9c31?s=128&d=identicon&r=PG&f=1", "display_name": "Ihdina", "link": "https://stackoverflow.com/users/7247051/ihdina"}, "edited": false, "score": 0, "creation_date": 1502926495, "post_id": 45724358, "comment_id": 78406721, "body": "replace extern int i=1; with int i=1;"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502926716, "post_id": 45724358, "comment_id": 78406766, "body": "You already have a local variable <code>i</code> in the <code>main()</code>; you can&#39;t get at the global one.  Local variables hide the global ones.  This is not C++ where you have the scope resolution operator to help.  And it&#39;s bad practice to shadow global variables (GCC will warn if you specify <code>-Wshadow</code>).  And it&#39;s worse practice to want to access both in a single function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3284469"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502928530, "post_id": 45724358, "comment_id": 78407161, "body": "@JonathanLeffler Nice to know it is bad practice. My example is more for studying scope and linkage purpose."}], "answers": [{"comments": [{"owner": {"reputation": 452, "user_id": 7247051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad026d36f38a1088e8ce7a1786da9c31?s=128&d=identicon&r=PG&f=1", "display_name": "Ihdina", "link": "https://stackoverflow.com/users/7247051/ihdina"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502927384, "post_id": 45724518, "comment_id": 78406934, "body": "@JonathanLeffler, yes I missing block scope linkage. Now it works."}], "tags": [], "owner": {"reputation": 452, "user_id": 7247051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad026d36f38a1088e8ce7a1786da9c31?s=128&d=identicon&r=PG&f=1", "display_name": "Ihdina", "link": "https://stackoverflow.com/users/7247051/ihdina"}, "is_accepted": false, "score": 4, "last_activity_date": 1502927271, "last_edit_date": 1502927271, "creation_date": 1502926703, "answer_id": 45724518, "question_id": 45724358, "link": "https://stackoverflow.com/questions/45724358/error-extern-declaration-of-i-follows-declaration-with-no-linkage/45724518#45724518", "title": "error: extern declaration of &#39;i&#39; follows declaration with no linkage", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint i=1;  // external variable\n\nint main()\n{\n    int i=2;            // local variable\n    printf(\"%d\\n\", i);  // print local variable i==2\n\n    {\n    extern int i;       // point to external variable\n    printf(\"%d\\n\", i);  // print external variable i==1\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1612908763, "post_id": 45724586, "comment_id": 116912659, "body": "Re \u201clocals can&#39;t have external linkage\u201d: Linkage is a property of identifiers, and identifiers in block scope certainly can have external linkage. The reason <code>int i=2; extern int i;</code> has a conflict is C 2018 (and 2011 and earlier) 6.7 3 gives the constraint that, if an identifier has no linkage (which the <code>i</code> in <code>int i-2;</code> satisfies), there shall be no more than one declaration of it in the same scope and namespace, with certain exceptions for typedef names and tags."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1502927245, "creation_date": 1502927245, "answer_id": 45724586, "question_id": 45724358, "link": "https://stackoverflow.com/questions/45724358/error-extern-declaration-of-i-follows-declaration-with-no-linkage/45724586#45724586", "title": "error: extern declaration of &#39;i&#39; follows declaration with no linkage", "body": "<p>Once you define a variable named <code>i</code> inside your <code>main</code> function, the <code>i</code> at file scope is masked and cannot be accessed (unless you have its address).</p>\n\n<p>When you later add the declaration <code>extern int i</code>, this conflicts with the local variable named <code>i</code> at the same scope since locals can't have external linkage.  It does <strong>not</strong> give you access to the global <code>i</code>.</p>\n\n<p>When you remove the local <code>i</code>, the <code>extern int i</code> declaration matches up with the definition at file scope, so there is no error.  As for the warning on <code>extern int i=1;</code>, that did <em>not</em> go away for me on gcc 4.1.2, so that depends on the compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6441097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a29c395cc07e7b2d2a97d7ebb9aaa7dc?s=128&d=identicon&r=PG&f=1", "display_name": "rIz", "link": "https://stackoverflow.com/users/6441097/riz"}, "is_accepted": false, "score": 0, "last_activity_date": 1502995443, "creation_date": 1502995443, "answer_id": 45742827, "question_id": 45724358, "link": "https://stackoverflow.com/questions/45724358/error-extern-declaration-of-i-follows-declaration-with-no-linkage/45742827#45742827", "title": "error: extern declaration of &#39;i&#39; follows declaration with no linkage", "body": "<p><strong>Question: What is the reason of the \"error: extern declaration of 'i' follows declaration with no linkage\", where \"declaration with no linkage\" refers to int i=2;?</strong><br>\nAnswer: We do not need to use the <em>extern</em> keyword here on line 3 when it is a single file in a program and there is no other file in the same program or other location on the same file where the variable <em>int i</em> has its definition. There are two main reasons we can use <em>extern</em> keyword in C:<br>\n 1. When we want to declare a variable explicitly/globally but without its definition.<br>\n 2. To make the variable globally visible from any other file in a multi-file program or other location of the same file (see Ihdina's exmaple for this scenario).<br>\nCompiling your code on my system I get the following error,<br>\n<em>error: extern declaration of 'i' follows non-extern declaration</em> . \nwhich totally makes sense that the compiler detects the <em>extern</em> on line 9 as a duplicate declaration of the same variable <em>int i</em> on line 7.  </p>\n\n<p><strong>Question: After I remove int i=2 in main,\nthe error is gone,\nthe warning \"warning: 'i' initialized and declared 'extern'\" on extern int i=1; also disappear . Why is that?</strong><br>\nAnswer: After removing the <em>int i=2;</em> the error was gone on my system but still I have the following warning message:<br>\n<em>warning: 'extern' variable has an initializer [-Wextern-initializer]</em> \nBasically my system (<em>Apple LLVM version 8.1.0 (clang-802.0.42)</em>) does not like the explicit initialization with <em>extern</em> keyword. So, you should modify your code as per Ihdina's answer which compiles without error.  </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3284469"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1522, "favorite_count": 0, "accepted_answer_id": 45724586, "answer_count": 3, "score": 3, "last_activity_date": 1611102336, "creation_date": 1502925592, "last_edit_date": 1611102336, "question_id": 45724358, "link": "https://stackoverflow.com/questions/45724358/error-extern-declaration-of-i-follows-declaration-with-no-linkage", "title": "error: extern declaration of &#39;i&#39; follows declaration with no linkage", "body": "<p>In the following program, I thought that <code>extern int i;</code> will change the following <code>i</code> to refer to the <code>i</code> defined outside <code>main</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nextern int i=1; // warning: 'i' initialized and declared 'extern'\n\nint main()\n{\n    int i=2;\n    printf(\"%d\\n\", i);\n    extern int i; // error: extern declaration of 'i' follows declaration with no linkage\n    printf(\"%d\\n\", i);\n    return 0;\n}\n</code></pre>\n\n<p>What is the reason of the \"error: extern declaration of 'i' follows declaration with no linkage\", where \"declaration with no linkage\" refers to <code>int i=2;</code>?</p>\n\n<p>After I remove <code>int i=2</code> in <code>main</code>, </p>\n\n<ul>\n<li>the error is gone,</li>\n<li>the warning \"warning: 'i' initialized and declared 'extern'\" on <code>extern int i=1;</code> also disappear . Why is that?</li>\n</ul>\n\n<p>Thank you for explanations!</p>\n"}, {"tags": ["c", "compiler-errors", "microcontroller", "avr", "atmelstudio"], "comments": [{"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1502924772, "post_id": 45724234, "comment_id": 78406315, "body": "Put relevant code in your question (copy-paste it, then select it and click the <code>{}</code> icon so it is correctly formatted)."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7576883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9bdb6792a33c48f814609f6c11d2bb?s=128&d=identicon&r=PG", "display_name": "Mahmoud Hamdy", "link": "https://stackoverflow.com/users/7576883/mahmoud-hamdy"}, "edited": false, "score": 0, "creation_date": 1502925881, "post_id": 45724349, "comment_id": 78406589, "body": "oh :O  Thanks so much ."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502928794, "post_id": 45724349, "comment_id": 78407220, "body": "Source files are never executed anyway. The compiled and linked executable file - yes"}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 4, "last_activity_date": 1502925503, "creation_date": 1502925503, "answer_id": 45724349, "question_id": 45724234, "link": "https://stackoverflow.com/questions/45724234/avr-io-ports-can-not-be-global/45724349#45724349", "title": "AVR IO Ports can not be global", "body": "<p>A line of code like <code>DDRA |= 0xFF</code> is a statement. It performs a specific action (like setting all the bits of <code>DDRA</code>) when it is executed.</p>\n\n<p>A statement must appear in a function, so that it will be executed as part of that function. It can't be placed at the top level of a source file, because source files are not executed -- only functions are.</p>\n"}], "owner": {"reputation": 1, "user_id": 7576883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9bdb6792a33c48f814609f6c11d2bb?s=128&d=identicon&r=PG", "display_name": "Mahmoud Hamdy", "link": "https://stackoverflow.com/users/7576883/mahmoud-hamdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 45724349, "answer_count": 1, "score": -1, "last_activity_date": 1504577456, "creation_date": 1502924680, "last_edit_date": 1504577456, "question_id": 45724234, "link": "https://stackoverflow.com/questions/45724234/avr-io-ports-can-not-be-global", "title": "AVR IO Ports can not be global", "body": "<p>I was writing an AVR code on Atmel Studio and by mistake I forgot to write the IO port settings (DDRx , PORTx ,...etc) in the main , instead I put it outside the main as shown:</p>\n\n<pre><code>#include &lt;avr/io.h&gt;\n#define F_CPU 1000000UL\n#include &lt;util/delay.h&gt;\n#include &lt;avr/interrupt.h&gt;\n\nvoid delay_250ms();\nuint8_t t_hr = 0 , t_min = 0 , t_sec = 0 , i = 0 , tempp;\nuint8_t start_stopwatch = 0;\nDDRA |= 0xFF;\nPORTA = 0x00;\nDDRD = 0x00;\nPORTD |= 0xFF;\n</code></pre>\n\n<p>then I got that error:</p>\n\n<blockquote>\n  <ul>\n  <li>expected <code>)</code> before <code>(</code> token</li>\n  <li>expected identifier or <code>(</code> before <code>volatile</code></li>\n  <li>expected <code>)</code> before <code>(</code> token</li>\n  <li>expected identifier or <code>(</code> before <code>volatile</code></li>\n  <li>expected <code>)</code> before <code>(</code> token\n  \u2026</li>\n  </ul>\n</blockquote>\n\n<p>When I added them back to the main function there were no errors</p>\n\n<p>The question is why I can't add them outside the main ?\nDo I miss some point ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1502919495, "post_id": 45723328, "comment_id": 78404619, "body": "no, the signature is only based on the name."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502919521, "post_id": 45723328, "comment_id": 78404628, "body": "functions are extern by default. If I do understand you well - the type is not"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1502919567, "post_id": 45723328, "comment_id": 78404645, "body": "No.  You do nothing different depending on whether the function is inline or not, or if it is static or not; there is nothing about the type of the return value (or argument list) in that information.  The <code>_Noreturn</code> case is slightly different, but it still isn&#39;t a part of the type."}, {"owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "edited": false, "score": 3, "creation_date": 1502919799, "post_id": 45723328, "comment_id": 78404744, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2322736/what-is-the-difference-between-function-declaration-and-signature\">what is the difference between function declaration and signature?</a>"}], "owner": {"user_type": "does_not_exist", "display_name": "user3284469"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502919556, "creation_date": 1502919106, "last_edit_date": 1502919556, "question_id": 45723328, "link": "https://stackoverflow.com/questions/45723328/are-the-function-specifiers-and-the-storage-class-specifiers-part-of-the-type-of", "title": "Are the function specifiers and the storage class specifiers part of the type of a function?", "body": "<p>When we define a function in C, </p>\n\n<pre><code>extern/static inline/_Noreturn myfunction(){};\n</code></pre>\n\n<p>are the function specifiers  (e.g. <code>inline</code>  or <code>_Noreturn</code>) , and  the storage class specifiers  (e.g. <code>extern</code>  or  <code>static</code>)  part of the type of the function? </p>\n"}, {"tags": ["c", "pointers", "memory-management", "malloc"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1502918375, "post_id": 45723164, "comment_id": 78404195, "body": "undefined behaviour. that&#39;s all. it works, .... or not"}, {"owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "edited": false, "score": 0, "creation_date": 1502918684, "post_id": 45723164, "comment_id": 78404303, "body": "The behavior of your code is undefined. When you assign value, it may work but could be corrupted next time you use this location. You may be corrupting a particular location after just writing on it as well"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1502919074, "post_id": 45723164, "comment_id": 78404463, "body": "UB is like shooting in the small room. Ricochets may kill or injure  you, but nothing my happen as well"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502919509, "post_id": 45723164, "comment_id": 78404624, "body": "depends on memory management in your kernel. If <code>malloc</code> returns a valid pointer, then your kernel has allocated <i>at least</i> the amount of memory you requested; it could potentially allocate more. However, you certainly cannot and should not count on that behavior; accessing beyond your chunk of memory is UB."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502919704, "post_id": 45723164, "comment_id": 78404702, "body": "Xtx What do you expect to have happened with <code>*(ptr + 2) = 3;</code>?"}, {"owner": {"reputation": 83, "user_id": 6817975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3105b56021b2ecf439c7ed5121b2b76b?s=128&d=identicon&r=PG&f=1", "display_name": "Xtx", "link": "https://stackoverflow.com/users/6817975/xtx"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502919953, "post_id": 45723164, "comment_id": 78404805, "body": "@chux Maybe got segmentation fault or an other error."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1502920095, "post_id": 45723164, "comment_id": 78404883, "body": "Try <code>free()</code>ing that pointer - you may get the crash you expected."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502920354, "post_id": 45723164, "comment_id": 78404988, "body": "@Xtx That is the deal about C, when code breaks various rules, the language is not <i>specified</i> to catch the transgression.  Code is on its own:  <a href=\"https://i.ytimg.com/vi/2unTOA4bw-M/hqdefault.jpg\" rel=\"nofollow noreferrer\">no training wheels</a>."}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502919958, "post_id": 45723457, "comment_id": 78404809, "body": "Yes definitely there is another language possible in the question tagged <code>C</code>."}], "tags": [], "owner": {"reputation": 100, "user_id": 7863842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aecfd9f39d1563ed855f39219101856?s=128&d=identicon&r=PG&f=1", "display_name": "MEHM-", "link": "https://stackoverflow.com/users/7863842/mehm"}, "is_accepted": true, "score": 0, "last_activity_date": 1502919721, "creation_date": 1502919721, "answer_id": 45723457, "question_id": 45723164, "link": "https://stackoverflow.com/questions/45723164/malloc-how-it-allocate-the-address/45723457#45723457", "title": "Malloc, how it allocate the address?", "body": "<p>Malloc and free function as parts of a memory manager. They help you manage memory use, so your program does not accidentally overlap data in the same memory space. Your program typically has access to the entire writable memory space (This is OS and language dependent) at all times. Malloc and Free help you keep track of which memory you are currently using. When you call malloc, you are requesting a block of free memory from the memory manager. It returns to you a pointer to the start of that memory block (and you know where it ends, because you requested the size), and assures you that additional calls to malloc will not return that same memory until that block has been freed. It is up to you to make sure that your program does not write outside of the memory space you allocate, and that you free any memory you allocate.</p>\n"}], "owner": {"reputation": 83, "user_id": 6817975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3105b56021b2ecf439c7ed5121b2b76b?s=128&d=identicon&r=PG&f=1", "display_name": "Xtx", "link": "https://stackoverflow.com/users/6817975/xtx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1679, "favorite_count": 0, "closed_date": 1502919998, "accepted_answer_id": 45723457, "answer_count": 1, "score": 0, "last_activity_date": 1502919721, "creation_date": 1502918335, "question_id": 45723164, "link": "https://stackoverflow.com/questions/45723164/malloc-how-it-allocate-the-address", "closed_reason": "Duplicate", "title": "Malloc, how it allocate the address?", "body": "<p>I know that the malloc, allocate the contigous blocks of memory and return the first address of the allocation, which we keep in a pointer an use it.</p>\n\n<p>I have the following question:</p>\n\n<p>I discovered that if I allocate a number of bytes less than necessary or if try to access something which exceeds the bytes allocated the program still work.</p>\n\n<pre><code>int *ptr;\nptr = (int*)malloc(sizeof(int) * 2);\n*ptr = 1;\n*(ptr + 1) = 2;\n*(ptr + 2) = 3;\n</code></pre>\n\n<p>After my mind, <code>*(ptr + 2) = 3;</code> should not work but it still work. I think because <code>*(ptr + 1)</code> is followed by <code>*(ptr + 2)</code> in memory.</p>\n\n<p>My question is why it work and if it work like this why we don't use malloc for allocate only the first element of anything?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1502918247, "post_id": 45723132, "comment_id": 78404139, "body": "<i>never</i> use <code>gets</code>."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1502918259, "post_id": 45723132, "comment_id": 78404146, "body": "I would recommend to use <code>fgets</code> instead of <code>gets</code>, its error-prone"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1502918338, "post_id": 45723132, "comment_id": 78404176, "body": "that said, I don&#39;t know why this wouldn&#39;t work. Use <code>scanf(&quot;%19s&quot; ...)</code> to protect against buffer overflow"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1502918355, "post_id": 45723132, "comment_id": 78404188, "body": "The obsolete <code>gets</code> consumes <i>only</i> the newline left in the input buffer after the previous <code>scanf</code>. Don&#39;t mix your methods."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8399444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JISV3.jpg?s=128&g=1", "display_name": "Alona Rose Bellucci", "link": "https://stackoverflow.com/users/8399444/alona-rose-bellucci"}, "edited": false, "score": 0, "creation_date": 1502919131, "post_id": 45723238, "comment_id": 78404489, "body": "do you mean by fflush?"}, {"owner": {"reputation": 528, "user_id": 1848032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Upm9V.jpg?s=128&g=1", "display_name": "E. van Putten", "link": "https://stackoverflow.com/users/1848032/e-van-putten"}, "reply_to_user": {"reputation": 11, "user_id": 8399444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JISV3.jpg?s=128&g=1", "display_name": "Alona Rose Bellucci", "link": "https://stackoverflow.com/users/8399444/alona-rose-bellucci"}, "edited": false, "score": 0, "creation_date": 1502919472, "post_id": 45723238, "comment_id": 78404613, "body": "Actually I meant reading characters from the standard input until it is no longer a special character like newline (\\n)."}, {"owner": {"reputation": 11, "user_id": 8399444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JISV3.jpg?s=128&g=1", "display_name": "Alona Rose Bellucci", "link": "https://stackoverflow.com/users/8399444/alona-rose-bellucci"}, "edited": false, "score": 0, "creation_date": 1502919777, "post_id": 45723238, "comment_id": 78404734, "body": "well... you gave me an idea :) I just write this command line twice."}, {"owner": {"reputation": 11, "user_id": 8399444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JISV3.jpg?s=128&g=1", "display_name": "Alona Rose Bellucci", "link": "https://stackoverflow.com/users/8399444/alona-rose-bellucci"}, "edited": false, "score": 0, "creation_date": 1502919904, "post_id": 45723238, "comment_id": 78404786, "body": "this is my &quot;solution&quot; : \t\t\tgets(edu.classes[i].students[j].name); \t\t\tgets(edu.classes[i].students[j].name);"}, {"owner": {"reputation": 528, "user_id": 1848032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Upm9V.jpg?s=128&g=1", "display_name": "E. van Putten", "link": "https://stackoverflow.com/users/1848032/e-van-putten"}, "reply_to_user": {"reputation": 11, "user_id": 8399444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JISV3.jpg?s=128&g=1", "display_name": "Alona Rose Bellucci", "link": "https://stackoverflow.com/users/8399444/alona-rose-bellucci"}, "edited": false, "score": 0, "creation_date": 1502919954, "post_id": 45723238, "comment_id": 78404806, "body": "But scanf with %s also skips the leading whitespace. Besides <code>scanf</code> can be told not to read more than a certain amount of characters while <code>gets</code> can crash your program."}, {"owner": {"reputation": 11, "user_id": 8399444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JISV3.jpg?s=128&g=1", "display_name": "Alona Rose Bellucci", "link": "https://stackoverflow.com/users/8399444/alona-rose-bellucci"}, "edited": false, "score": 0, "creation_date": 1502920165, "post_id": 45723238, "comment_id": 78404912, "body": "I have already tried scanf with %s and it worked well"}], "tags": [], "owner": {"reputation": 528, "user_id": 1848032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Upm9V.jpg?s=128&g=1", "display_name": "E. van Putten", "link": "https://stackoverflow.com/users/1848032/e-van-putten"}, "is_accepted": false, "score": 0, "last_activity_date": 1502920160, "last_edit_date": 1502920160, "creation_date": 1502918678, "answer_id": 45723238, "question_id": 45723132, "link": "https://stackoverflow.com/questions/45723132/structs-why-gets-function-is-not-working-compared-to-scanf/45723238#45723238", "title": "structs - why gets function is not working compared to scanf?", "body": "<p>I think it is seeing the newline character that was produced due to hitting the enter key. <code>gets</code> then stops reading. Try eating those special characters before <code>gets</code> sees them. Or use scanf with <code>%s</code> which eats any leading whitespace as you have seen it works.</p>\n"}], "owner": {"reputation": 11, "user_id": 8399444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JISV3.jpg?s=128&g=1", "display_name": "Alona Rose Bellucci", "link": "https://stackoverflow.com/users/8399444/alona-rose-bellucci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "closed_date": 1502918565, "answer_count": 1, "score": 0, "last_activity_date": 1502920160, "creation_date": 1502918205, "question_id": 45723132, "link": "https://stackoverflow.com/questions/45723132/structs-why-gets-function-is-not-working-compared-to-scanf", "closed_reason": "Duplicate", "title": "structs - why gets function is not working compared to scanf?", "body": "<p>gets(edu.classes[i].students[j].name);</p>\n\n<p>I would like to know why the compiler skips this line after debugging and does not input into name? Is it legal to invoke gets function on that way?</p>\n\n<p>Note: Once I use scanf(\"%s\" , ... ) - it works!</p>\n\n<p>scanf(\"%s\",edu.classes[i].students[j].name);</p>\n\n<p>(I know that I did not free the memory allocations and checked if the allocations were not failed  - I know that it is necessary! It's only time issue) :)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define SIZE 20\n\ntypedef struct\n{\nchar name[SIZE];\nint id;\n}Student;\n\ntypedef struct\n{\nStudent *students;\nint num_students;\nchar teacher[SIZE];\n}Class;\n\ntypedef struct\n{\nClass *classes;\nint num_classes;\n}Education;\n\nint main()\n{\nint i, j;\nEducation edu;\nputs(\"how many classes?\");\nscanf(\"%d\", &amp;(edu.num_classes));\nedu.classes = (Class*)malloc((edu.num_classes) * sizeof(Class));\nif (edu.classes == NULL)\n{\n    printf(\"ERROR allocation\\n\");\n    exit(1);\n}\nfor (i = 0; i &lt; edu.num_classes; i++)\n{\n    puts(\"enter num of students\");\n    scanf(\"%d\", &amp;(edu.classes[i].num_students));\n    edu.classes[i].students = (Student*)malloc((edu.classes[i].num_students) \n* sizeof(Student));\n    for (j = 0; j &lt; edu.classes[i].num_students; j++)\n    {\n        puts(\"enter student's name\");\n        gets(edu.classes[i].students[j].name); // this is the problematic line\n        puts(\"enter id\");\n        scanf(\"%d\", &amp;(edu.classes[i].students[j].id));\n    }\n}\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 4, "creation_date": 1502916704, "post_id": 45722784, "comment_id": 78403509, "body": "You&#39;re returning the address of a local variable. This is a grave mistake which your compiler should&#39;ve warned you about."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502916845, "post_id": 45722784, "comment_id": 78403574, "body": "<code>char arr[11];</code> --&gt; <code>static char arr[11];</code>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502917196, "post_id": 45722784, "comment_id": 78403730, "body": "Also, UB aside, you can just change that to <code>printf(&quot;%s\\n&quot;, arr);</code>. In this case, <code>arr</code> will decay to a pointer to its first element (<code>char*</code>) and that will <code>printf</code> just fine .. no need for <code>res</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 871334, "user_id": 157247, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/4HovX.jpg?s=128&g=1", "display_name": "T.J. Crowder", "link": "https://stackoverflow.com/users/157247/t-j-crowder"}, "edited": false, "score": 0, "creation_date": 1502917394, "post_id": 45722784, "comment_id": 78403807, "body": "@T.J.Crowder This is the usage assumed by OP. (Make a copy if necessary) note that <code>printf(&quot;%s\\n&quot;, numberToBinary(4));</code> will cause a memory leak if memory is secured using <code>malloc</code>."}, {"owner": {"reputation": 871334, "user_id": 157247, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/4HovX.jpg?s=128&g=1", "display_name": "T.J. Crowder", "link": "https://stackoverflow.com/users/157247/t-j-crowder"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502917440, "post_id": 45722784, "comment_id": 78403823, "body": "@BLUEPIXY: I don&#39;t see that the OP said they wanted to reuse the same buffer for two completely unrelated calls, and create the crosstalk that would invite in their app."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 871334, "user_id": 157247, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/4HovX.jpg?s=128&g=1", "display_name": "T.J. Crowder", "link": "https://stackoverflow.com/users/157247/t-j-crowder"}, "edited": false, "score": 0, "creation_date": 1502917704, "post_id": 45722784, "comment_id": 78403924, "body": "@T.J.Crowder It is the same as reuse you say. In my case it is speculation from the code."}, {"owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "edited": false, "score": 0, "creation_date": 1502917921, "post_id": 45722784, "comment_id": 78404010, "body": "Change <code>char arr[11];</code> to  <code>static char arr[11];</code>and <code>printf(&quot;%s\\n&quot;, res);&#39; to </code>printf(&quot;%s\\n&quot;, arr);`  finally return <code>arr</code>"}], "answers": [{"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": true, "score": 1, "last_activity_date": 1502917502, "last_edit_date": 1502917502, "creation_date": 1502916843, "answer_id": 45722832, "question_id": 45722784, "link": "https://stackoverflow.com/questions/45722784/value-of-string-changes-after-function-ends/45722832#45722832", "title": "value of string changes after function ends", "body": "<p>Returning address of local variable leads to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, becouse it is not in scope (ended its lifetime) in the time you are passing it to <code>printf()</code>.</p>\n\n<p>You have to pass an array to function as parameter, or allocate <code>char* res</code> on <code>heap</code> (<em>dynamic storage duration</em>).</p>\n\n<p>Example</p>\n\n<pre><code>char* res = malloc (amountOfBytesYouNeed);\nif (res == NULL) { /*err msg*/ exit(-1); }\n// Store data to res insted of arr\nreturn res;\n\n//\nchar * ptr = numberToBinary(4);\nprintf(\"%s\\n\", ptr);\nfree(ptr); // !\n</code></pre>\n"}], "owner": {"reputation": 2009, "user_id": 4614264, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/7ogks.jpg?s=128&g=1", "display_name": "Yazan W Yusuf", "link": "https://stackoverflow.com/users/4614264/yazan-w-yusuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1502916911, "accepted_answer_id": 45722832, "answer_count": 1, "score": 0, "last_activity_date": 1502917502, "creation_date": 1502916628, "question_id": 45722784, "link": "https://stackoverflow.com/questions/45722784/value-of-string-changes-after-function-ends", "closed_reason": "Duplicate", "title": "value of string changes after function ends", "body": "<p>I'be build this function to convert integers to binary strings</p>\n\n<pre><code>char* numberToBinary(int num){\n    char arr[11];\n    int x=1;\n    for(int i=0;i&lt;10;i++){\n        arr[9 - i] = (num &amp; x)?'1':'0';\n        x = x&lt;&lt;1;\n    }\n    arr[10] = '\\0';\n    char* res = &amp;arr[0];\n    printf(\"%s\\n\", res);//prints 0000000100\n    return res;\n}\nprintf(\"%s\\n\", numberToBinary(4));//prints changeable binary data\n</code></pre>\n\n<p>The problem is inside the function the variable <code>res</code> has the correct answer, but it looks like the retrieved value from the function <code>I guess</code> is the location of the variable res, which has been de-located from memory.</p>\n\n<p>How can I make the function <code>numberToBinary</code> return a string inside of something else.</p>\n"}, {"tags": ["c", "virtual-keyboard"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8377060"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1502916728, "post_id": 45722735, "comment_id": 78403521, "body": "@Internal Server Error I am trying to print the Virtual Key Codes of the letters that I write, I am using <code>HOOK</code> procedure for it. But when I get the vk codes they&#39;re the same for both upper and lower case letters? i want to be able identify if it&#39;s lower or not, how do I achieve it ?"}, {"owner": {"reputation": 752, "user_id": 7654030, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/852379ca630c9bca3c121b1e54ad4a19?s=128&d=identicon&r=PG&f=1", "display_name": "Austin_Anderson", "link": "https://stackoverflow.com/users/7654030/austin-anderson"}, "edited": false, "score": 1, "creation_date": 1502916902, "post_id": 45722735, "comment_id": 78403595, "body": "there is no notion of lowercase vs upper case for key codes, because they correspond to the keys on your keyboard. The difference would be you checking for the key code <code>VK_LSHIFT</code> or <code>VK_RSHIFT</code> being pressed while the letter key code is pressed"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1502916909, "post_id": 45722735, "comment_id": 78403604, "body": "maybe in conjunction with shift, 0x10?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1502917023, "post_id": 45722735, "comment_id": 78403661, "body": "Virtual key codes in <i>what</i> context? The linked page say &quot;A key&quot; the point being the physical <i>key</i> pressed. They don&#39;t also chart &quot;a key&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8377060"}, "reply_to_user": {"reputation": 752, "user_id": 7654030, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/852379ca630c9bca3c121b1e54ad4a19?s=128&d=identicon&r=PG&f=1", "display_name": "Austin_Anderson", "link": "https://stackoverflow.com/users/7654030/austin-anderson"}, "edited": false, "score": 0, "creation_date": 1502917701, "post_id": 45722735, "comment_id": 78403920, "body": "@Austin_Anderson thanks, that&#39;s what I should do, definitely!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8377060"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502917714, "post_id": 45722735, "comment_id": 78403930, "body": "@yano thanks that&#39;s true"}, {"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 1, "creation_date": 1502920659, "post_id": 45722735, "comment_id": 78405101, "body": "Remember that you can also have combinations of VK_CONTROL and VK_ALT in addition to VK_SHIFT."}], "owner": {"user_type": "does_not_exist", "display_name": "user8377060"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 611, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503592900, "creation_date": 1502916416, "last_edit_date": 1503592900, "question_id": 45722735, "link": "https://stackoverflow.com/questions/45722735/virtual-key-codes-defining", "title": "Virtual Key codes defining", "body": "<p>Hello I have checked <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx\" rel=\"nofollow noreferrer\"> Virtual Key Codes MSDN </a> in C and it shows character <code>A</code> as  <code>0x41</code> , I wanted to know how I'd be able to get the difference between a lower case and an upper case letter in C? is there an attribute for it</p>\n\n<p>I have checked and it returns the same VK code for both upper and lower case letters.</p>\n"}, {"tags": ["c", "file", "scanf"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1502916066, "post_id": 45722639, "comment_id": 78403226, "body": "<code>inodeText</code> buffer is only 10 bytes long. Is it enough?"}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1502916087, "post_id": 45722639, "comment_id": 78403233, "body": "longest word i can see is <code>bytes</code> i think it is"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1502916314, "post_id": 45722639, "comment_id": 78403355, "body": "Where is <code>bytesArray</code> defined?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502916776, "post_id": 45722639, "comment_id": 78403540, "body": "Are the <code>1.</code> and <code>2.</code> etc in the input example part of the text being scanned? If they are, then the second format spec should be <code>%s</code>."}, {"owner": {"reputation": 25, "user_id": 7096815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d756f15f7790b154e4cffddcb7b2da6?s=128&d=identicon&r=PG&f=1", "display_name": "K. Vu", "link": "https://stackoverflow.com/users/7096815/k-vu"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1502917023, "post_id": 45722639, "comment_id": 78403662, "body": "@dbush bytesArray is defined outside this method&#39;s scope. I have just added it to the code block for readibility. The line numbers are not part of the file, I only added them to call out the lines easier. inodeText is only meant to contain the string &#39;inode&#39; so yes that buffer is enough."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7096815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d756f15f7790b154e4cffddcb7b2da6?s=128&d=identicon&r=PG&f=1", "display_name": "K. Vu", "link": "https://stackoverflow.com/users/7096815/k-vu"}, "edited": false, "score": 0, "creation_date": 1502917238, "post_id": 45722892, "comment_id": 78403749, "body": "How could I have missed this. Such an easy fix. Thank you!"}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1502917669, "post_id": 45722892, "comment_id": 78403905, "body": "Iam wondering why we can pass more specifiers than variables and cant find it anywhere. Could you explain it in a few rows or post some link?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1502918181, "post_id": 45722892, "comment_id": 78404114, "body": "but in the code <code>long bytesArray[380000000];</code> should fit (unless stack explodes first :))"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1502918765, "post_id": 45722892, "comment_id": 78404335, "body": "@FilipKo\u010dica-- you can&#39;t: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.2p2\" rel=\"nofollow noreferrer\">&quot;If there are insufficient arguments for the format, the behavior is undefined.&quot;</a>. But the <code>*</code> suppresses assignment."}, {"owner": {"reputation": 25, "user_id": 7096815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d756f15f7790b154e4cffddcb7b2da6?s=128&d=identicon&r=PG&f=1", "display_name": "K. Vu", "link": "https://stackoverflow.com/users/7096815/k-vu"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1502919835, "post_id": 45722892, "comment_id": 78404753, "body": "@Jean-Fran&#231;ois Fabre the inode on line 4 is 100m but the the bytesArray is only initialized for 38m values therefore causing a segmentation fault!"}, {"owner": {"reputation": 25, "user_id": 7096815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d756f15f7790b154e4cffddcb7b2da6?s=128&d=identicon&r=PG&f=1", "display_name": "K. Vu", "link": "https://stackoverflow.com/users/7096815/k-vu"}, "edited": false, "score": 0, "creation_date": 1502920099, "post_id": 45722892, "comment_id": 78404884, "body": "Hmm can someone point out why my question has a negative rating? I am new to Stack Overflow so there are still some conventions I&#39;d like to learn and follow."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1502953526, "post_id": 45722892, "comment_id": 78414744, "body": "that&#39;s because this is a &quot;why isn&#39;t this code working&quot; kind of question, probably with poor &quot;replay value&quot; for others. but that&#39;s not a very bad question either. some questions get 5 to 10 downvotes. Not yours."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1502917085, "creation_date": 1502917085, "answer_id": 45722892, "question_id": 45722639, "link": "https://stackoverflow.com/questions/45722639/segmentation-fault-with-sscanf-on-big-number/45722892#45722892", "title": "Segmentation fault with sscanf on big number", "body": "<p>You're using the inode number as the index <code>bytesArray</code>.  You don't show how big this array is, but I'm betting it's much smaller than 100663302.  So you're writing past the end of the array.  This invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>Rather than using the inode number as an index, use a <code>struct</code> which contains both the inode number and the file size, and use an array of those along with a count of the element in the array.</p>\n\n<pre><code>struct entry {\n    int inode;\n    int nbytes;\n};\n\nstruct entry entryArray[10];   // assuming there are no more than 10 lines in the file\nint arrayLen = 0;\n\n...\n\nwhile(fgets(line, sizeof(line), myfile)) {\n    int x = (sscanf(line, \"%s %ld %*s %*d %*s %*d %*[bytes] %d %*[^\\n]\", inodeText, &amp;inode, &amp;mybytes));\n    if(x &gt; 1) {\n        entryArray[arrayLen].inode = inode;\n        entryArray[arrayLen].nbytes = mybytes;\n        arrayLen++;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7096815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d756f15f7790b154e4cffddcb7b2da6?s=128&d=identicon&r=PG&f=1", "display_name": "K. Vu", "link": "https://stackoverflow.com/users/7096815/k-vu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 45722892, "answer_count": 1, "score": -1, "last_activity_date": 1502917085, "creation_date": 1502916004, "last_edit_date": 1502916824, "question_id": 45722639, "link": "https://stackoverflow.com/questions/45722639/segmentation-fault-with-sscanf-on-big-number", "title": "Segmentation fault with sscanf on big number", "body": "<p>I am fairly new in C and I'm  trying to read a large file (>30m lines) line by line and store some values of each line into an array. The format of the input file is:</p>\n\n<pre><code>1. inode    100660 uid  66322 gid  66068 bytes       5848 blks        128\n2. inode    100662 uid  66492 gid  66076 bytes        159 blks          0\n3. inode    100647 uid  66419 gid  66068 bytes        235 blks          0\n4. inode 100663302 uid  66199 gid  66068 bytes        131 blks          0\n5. inode 100663311 uid  66199 gid  66068 bytes        134 blks          0\n</code></pre>\n\n<p>And this is my code:</p>\n\n<pre><code>void loadArrayFromFile(char * filename) {\nlong bytesArray[380000000];\nFILE * myfile;\nmyfile = fopen(filename, \"r\");\nchar line[1024];\nchar inodeText[10];\nlong int inode = 0;\nint mybytes = 0;\n\nif(myfile == NULL) {\n    printf(\"No file found \\n\");\n    exit(EXIT_FAILURE);\n}\n\nwhile(fgets(line, sizeof(line), myfile)) {\n    int x = (sscanf(line, \"%s %ld %*s %*d %*s %*d %*[bytes] %d %*[^\\n]\", inodeText, &amp;inode, &amp;mybytes));\n    if(x &gt; 1) {\n        bytesArray[inode] = mybytes;\n    }\n}\n</code></pre>\n\n<p>This <strong>code works fine for the first 3 lines</strong>, however when it reaches line 4 I get a Segmentation Fault (core dumped) error. I suspect it has something to do with the inode value being too large to store into an int even though the max value an int can store is 2147483647. Can anyone help me out as to what the issue is?</p>\n"}, {"tags": ["c", "types", "incomplete-type"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1502915703, "post_id": 45722539, "comment_id": 78403081, "body": "struct in forward declaration"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1502915857, "post_id": 45722539, "comment_id": 78403137, "body": "<code>void</code> is an incomplete type that cannot be completed."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1502916149, "last_edit_date": 1502916149, "creation_date": 1502915849, "answer_id": 45722593, "question_id": 45722539, "link": "https://stackoverflow.com/questions/45722539/is-there-a-non-array-incomplete-type/45722593#45722593", "title": "Is there a non-array incomplete type?", "body": "<p>Yes, <code>void</code> is also an incomplete type, which can <strong>never</strong> be complete.</p>\n\n<p>Also, as mentioned in other answers, a declaration of a structure or union of unknown content (i.e., a forward declaration) is also an incomplete type. Remember, this turns to a complete type once it is declared with it's members (defining content).</p>\n\n<p>To add, quoting <code>C11</code>, chapter \u00a76.2.5/P1</p>\n\n<blockquote>\n  <p>[...] At various points within a translation unit an object type may be\n  incomplete (lacking sufficient information to determine the size of objects of that type) or\n  complete (having sufficient information).</p>\n</blockquote>\n\n<p>P19,</p>\n\n<blockquote>\n  <p>The <code>void</code> type comprises an empty set of values; it is an incomplete object type that\n  cannot be completed.</p>\n</blockquote>\n\n<p>and, P22,</p>\n\n<blockquote>\n  <p>An array type of unknown size is an incomplete type. It is completed, for an identifier of that type, by specifying the size in a later declaration (with internal or external linkage). A structure or union type of unknown content (as described in (6.7.2.3) is an incomplete type. It is completed, for all declarations of that type, by declaring the same structure or union tag with its defining content later in the same scope.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1502915866, "creation_date": 1502915866, "answer_id": 45722597, "question_id": 45722539, "link": "https://stackoverflow.com/questions/45722539/is-there-a-non-array-incomplete-type/45722597#45722597", "title": "Is there a non-array incomplete type?", "body": "<p>A forward declaration of a <code>struct</code> or <code>union</code> without a latter definition of its contents is also an incomplete type.</p>\n\n<p>From section 6.2.5 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>:</p>\n\n<blockquote>\n  <p><em>22</em> An array type of unknown size is an incomplete type. It is completed, for an identifier of that type, by specifying the size in a\n  later declaration (with internal or external linkage). <strong>A structure or\n  union type of unknown content (as described in 6.7.2.3) is an\n  incomplete type. It is completed, for all declarations of that type,\n  by declaring the same structure or union tag with its defining content\n  later in the same scope.</strong></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 602, "user_id": 6738494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HDxVP.jpg?s=128&g=1", "display_name": "RazaUsman_k", "link": "https://stackoverflow.com/users/6738494/razausman-k"}, "is_accepted": false, "score": 5, "last_activity_date": 1502915941, "creation_date": 1502915941, "answer_id": 45722617, "question_id": 45722539, "link": "https://stackoverflow.com/questions/45722539/is-there-a-non-array-incomplete-type/45722617#45722617", "title": "Is there a non-array incomplete type?", "body": "<p>An incomplete type is a type that describes an identifier but lacks information needed to determine the size of the identifier. An \"incomplete type\" can be</p>\n\n<ul>\n<li><p>A structure type whose members you have not yet specified.</p></li>\n<li><p>A union type whose members you have not yet specified.</p></li>\n<li><p>An array type whose dimension you have not yet specified.</p></li>\n</ul>\n\n<p>The void type is an incomplete type that cannot be completed</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1502919281, "last_edit_date": 1502919281, "creation_date": 1502918939, "answer_id": 45723294, "question_id": 45722539, "link": "https://stackoverflow.com/questions/45722539/is-there-a-non-array-incomplete-type/45723294#45723294", "title": "Is there a non-array incomplete type?", "body": "<p>For reference, what is <em>incomplete</em>, <em>complete</em>?</p>\n\n<blockquote>\n  <p>At various points within a translation unit an object type may be\n  <em>incomplete</em> (lacking sufficient information to determine the size of objects of that type) or <em>complete</em> (having sufficient information).  C11 \u00a76.2.5 1</p>\n</blockquote>\n\n<hr>\n\n<p>In addition to potentially <code>struct</code>, <code>union</code>, arrays and always <code>void</code>, <code>enum</code> are temporarily <em>incomplete</em> in that their size is incomplete until the <code>}</code></p>\n\n<blockquote>\n  <p>... The enumerated type is incomplete until immediately after the <code>}</code> that terminates the list of enumerator declarations, and complete thereafter. C11 \u00a76.7.2.2 4</p>\n</blockquote>\n\n<pre><code>int main() {\n  enum ee1 { a1 = 0, b1 = sizeof(int), c1 };\n  printf(\"%zu\\n\", sizeof(enum ee1));  // OK\n\n  // error: invalid application of 'sizeof' to incomplete type 'enum ee2'\n  //                                        v--------------v \n  enum ee2 { a2 = 0, b2 = sizeof(int), c2 = sizeof(enum ee2) }; // Bad\n  printf(\"%zu\\n\", sizeof(enum ee2)); // OK\n}\n</code></pre>\n\n<p>Further</p>\n\n<blockquote>\n  <p>All declarations of structure, union, or enumerated types that have the same scope and use the same tag declare the same type. Irrespective of whether there is a tag or what other declarations of the type are in the same translation unit, <strong>the type is incomplete until immediately after the closing brace of the list defining the content, and complete thereafter</strong>. \u00a76.7.2.3 4</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 45723294, "answer_count": 4, "score": 3, "last_activity_date": 1502919281, "creation_date": 1502915660, "last_edit_date": 1502916237, "question_id": 45722539, "link": "https://stackoverflow.com/questions/45722539/is-there-a-non-array-incomplete-type", "title": "Is there a non-array incomplete type?", "body": "<p>All I have found in C11 Standard  for incomplete types are incomplete array types. </p>\n\n<p>I was wondering if there is a non-array incomplete type.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 426, "user_id": 8430461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7432679f8bb55e1cc858e76fd88b1d?s=128&d=identicon&r=PG&f=1", "display_name": "ihpar", "link": "https://stackoverflow.com/users/8430461/ihpar"}, "edited": false, "score": 1, "creation_date": 1502915576, "post_id": 45722432, "comment_id": 78403040, "body": "Also: <code>x[i].nation==0;</code> will evaluate to <code>bool</code> I think you meant <code>x[i].nation=0;</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1502915616, "post_id": 45722432, "comment_id": 78403050, "body": "<code>x[i].nation==&#39;e&#39;</code> ? and <code>&amp;x[i]==1;</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 2, "last_activity_date": 1502915402, "creation_date": 1502915402, "answer_id": 45722467, "question_id": 45722432, "link": "https://stackoverflow.com/questions/45722432/c-structure-usage/45722467#45722467", "title": "C: Structure usage", "body": "<p>You have to change</p>\n\n<pre><code>scanf(\"%c\",&amp;n);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>scanf(\" %c\",&amp;n); // Skip leading whitespaces\n</code></pre>\n\n<hr>\n\n<p>Arrays in C are passed by pointer, so for</p>\n\n<pre><code>char name2[10];\n</code></pre>\n\n<p>You dont have to use reference operator</p>\n\n<pre><code>scanf(\"%s\",&amp;name2);\n</code></pre>\n\n<p>just simply do</p>\n\n<pre><code>scanf(\"%s\",name2);  // Will pass an arrays address\n</code></pre>\n\n<p>Also it would be nice to limit input, or buffer overflow may occur and it would lead to undefined behavior</p>\n\n<pre><code>scanf(\"%9s\",name2);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8474583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f606690768d88ddd08c6c5ca4f5995c7?s=128&d=identicon&r=PG&f=1", "display_name": "amr hisham", "link": "https://stackoverflow.com/users/8474583/amr-hisham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "closed_date": 1502915503, "answer_count": 1, "score": 0, "last_activity_date": 1502915402, "creation_date": 1502915215, "question_id": 45722432, "link": "https://stackoverflow.com/questions/45722432/c-structure-usage", "closed_reason": "Duplicate", "title": "C: Structure usage", "body": "<p>the lines after printf(\"enter nation\\n\"); to printf(\"enter m or f\\n\"); not executing like the codeblock can't see it as it prints the two line together with no chance for me to enter anything in between.. this problem always happen when i use struct</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nstruct emp\n{\n\nint salary;\nint age;\nchar name[10];\nchar m:1;\nchar nation:1;\n\n};\nint main()\n{\nint i,k;\nchar g,n;\nchar name2[10];\nstruct emp x[3];\nfor(i=0;i&lt;3;i++)\n\n    {\n         printf(\"enter name\\n\");\n         scanf(\"%s\",&amp;name2);\n         strcpy(x[i].name,name2);\n\n\n        printf(\"enter salary\\n\");\n         scanf(\"%d\",&amp;x[i].salary);\n        printf(\"enter age\\n\");\n         scanf(\"%d\",&amp;x[i].age);\n\n\n\n          printf(\"enter nation\\n\");\n</code></pre>\n\n<p>cant see the next 3 lines and jump to enter m or f</p>\n\n<pre><code>          scanf(\"%c\",&amp;n);\n          if(n=='e'){x[i].nation==0;}\n          else {x[i].nation==1;}\n\n          printf(\"enter m or f\\n\");\n</code></pre>\n\n<p>cant see those lines too</p>\n\n<pre><code>          scanf(\"%c\",&amp;g);\n          if(g=='f'){x[i].m=0;}\n          else if(g=='m'){&amp;x[i]==1;}\n\n\n\n    }\n\n    for(k=0;k&lt;3;k++)\n        {\n            if(x[i].nation=='e')\n            {\n                puts(x[i].name);\n                printf(\"%d\\n\",x[i].salary);\n                printf(\"%d\\n\",x[i].age);\n                if(x[i].m==0)\n                printf(\"female\\n\");\n                else {printf(\"male\\n\");}\n                printf(\"egyptian\");\n\n                }\n\n\n        }\n\nreturn 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "tcp", "socket.io"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1502911113, "post_id": 45720867, "comment_id": 78400927, "body": "No help. There is no way to reliable check if the TCP peer has disconnected."}, {"owner": {"reputation": 8989, "user_id": 22093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c6e38ce98538f43d56ebcae7d3e5fc2f?s=128&d=identicon&r=PG", "display_name": "dswatik", "link": "https://stackoverflow.com/users/22093/dswatik"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1502911436, "post_id": 45720867, "comment_id": 78401050, "body": "@SergeyA I just can&#39;t accept that... there has got to be a way otherwise what good is it?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1502911717, "post_id": 45720867, "comment_id": 78401196, "body": "Embrace reality, mate."}, {"owner": {"reputation": 8989, "user_id": 22093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c6e38ce98538f43d56ebcae7d3e5fc2f?s=128&d=identicon&r=PG", "display_name": "dswatik", "link": "https://stackoverflow.com/users/22093/dswatik"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1502911828, "post_id": 45720867, "comment_id": 78401254, "body": "@SergeyA Unfortunately I don&#39;t think my client will appreciate that answer."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1502911961, "post_id": 45720867, "comment_id": 78401331, "body": "What do you mean with <i>&quot;disconnects abruptly&quot;</i>? If the peer does a clean TCP shutdown then you will notice it. If the client system crashed, lost internet connectivity or  a firewall lost the state and blocks further data you will only notice if you write data to the peer and get an error after some time because no ACK was received for the data you&#39;ve send. Or you might use TCP keep alive to check for problems."}, {"owner": {"reputation": 8989, "user_id": 22093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c6e38ce98538f43d56ebcae7d3e5fc2f?s=128&d=identicon&r=PG", "display_name": "dswatik", "link": "https://stackoverflow.com/users/22093/dswatik"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1502912061, "post_id": 45720867, "comment_id": 78401377, "body": "@SteffenUllrich Yes that is what I mean it lost internet connection..."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 3, "creation_date": 1502912144, "post_id": 45720867, "comment_id": 78401417, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6404008/how-to-detect-a-tcp-socket-disconnection-with-c-berkeley-socket\">How to detect a TCP socket disconnection (with C Berkeley socket)</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1502912182, "post_id": 45720867, "comment_id": 78401433, "body": "Joking aside, this is what it is. This is a nature of TCP communication. The best you can do is to make your devices hearbeating while downloading, and set a threshold for X missing heartbeats to consider device dead and forcefully disconnect it."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1502912272, "post_id": 45720867, "comment_id": 78401477, "body": "@SteffenUllrich, keep alive is not going to help, since OP is already writing to it. But it is not reliable in any way."}, {"owner": {"reputation": 8989, "user_id": 22093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c6e38ce98538f43d56ebcae7d3e5fc2f?s=128&d=identicon&r=PG", "display_name": "dswatik", "link": "https://stackoverflow.com/users/22093/dswatik"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1502912520, "post_id": 45720867, "comment_id": 78401589, "body": "@SergeyA Correct ... It is in the process of writing and had wrote a packet already to the device and just dropped dead at that point... as there is no logic to know that it dropped, this is what I am currently trying to fix but have not been able to do so reliably."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1502912561, "post_id": 45720867, "comment_id": 78401607, "body": "@SergeyA <i>This is a nature of TCP communication.</i> It&#39;s the nature of <b><i>all</i></b> communications.  How do you know when the entity you&#39;re communicating with simply and completely disappears?  There is no way to tell.  You can only infer the disappearance after some period of time."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1502912794, "post_id": 45720867, "comment_id": 78401700, "body": "@AndrewHenle, I actually wanted to say exactly that, but than decided that I do not want to go into argument about &#39;but cell phones do detect when you loose connection to your counterparty&#39;, and decided to limit my statement to TCP. And there are other arguments as well, which I just don&#39;t feel like engaging in."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1502912994, "post_id": 45720867, "comment_id": 78401785, "body": "@SergeyA LOL :-D If someone wants to make that argument and display their ignorance of both communication theory and cell phone networks, let &#39;em.  Because if you drop that cellphone into a perfect Faraday cage it won&#39;t be detecting those lost connections anytime soon."}, {"owner": {"reputation": 8989, "user_id": 22093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c6e38ce98538f43d56ebcae7d3e5fc2f?s=128&d=identicon&r=PG", "display_name": "dswatik", "link": "https://stackoverflow.com/users/22093/dswatik"}, "edited": false, "score": 0, "creation_date": 1502913127, "post_id": 45720867, "comment_id": 78401861, "body": "Well here is the issue I have with that whole cell phone argument ... I don&#39;t think they are using TCP? But I don&#39;t really know never really researched that so can&#39;t say one way or another... I would assume voice over IP does, if not UDP at least.."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1502913524, "post_id": 45720867, "comment_id": 78402054, "body": "@dswatik There&#39;s a whole lot more going on with your cell phone&#39;s phone calls than a single, simple TCP connection between you and the person you&#39;re talking to.  Again, though, if you cut <i>all</i> those channels by putting the phone into a Faraday cage, it won&#39;t be able to detect that the one call was lost (although given all that the communication channels a cell phone uses, it might very well be designed to handle that situation.  How fast can your phone properly detect &quot;No Signal&quot;? And that&#39;s likely to be really fast because the timeouts in cell protocols are likely shorter)"}, {"owner": {"reputation": 8989, "user_id": 22093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c6e38ce98538f43d56ebcae7d3e5fc2f?s=128&d=identicon&r=PG", "display_name": "dswatik", "link": "https://stackoverflow.com/users/22093/dswatik"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1502913667, "post_id": 45720867, "comment_id": 78402117, "body": "@AndrewHenle Yeah I figured it&#39;s like comparing apples to oranges ..."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1502913710, "post_id": 45720867, "comment_id": 78402139, "body": "(cont) The only thing you can do is select your &quot;we haven&#39;t heard from you at all&quot; timeout value so that you balance the risk of false positives for lost connections that were just slow against your desire to detect actual lost connections as fast as possible.  I&#39;m guessing the default TCP timeout of 2 minutes is too long?"}, {"owner": {"reputation": 8989, "user_id": 22093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c6e38ce98538f43d56ebcae7d3e5fc2f?s=128&d=identicon&r=PG", "display_name": "dswatik", "link": "https://stackoverflow.com/users/22093/dswatik"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1502913999, "post_id": 45720867, "comment_id": 78402277, "body": "@AndrewHenle Yeah ..."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1502936729, "post_id": 45720867, "comment_id": 78408880, "body": "@dswatik: Since you are using linux, consider using the linux-specific TCP socket options as described in <a href=\"http://man7.org/linux/man-pages/man7/tcp.7.html\" rel=\"nofollow noreferrer\">man 7 tcp</a> to set the timeouts as needed, and the <code>TCP_LINGER2</code> socket option to limit how long the kernel will &quot;remember&quot; a dropped connection, as well as the general socket options described in <a href=\"http://man7.org/linux/man-pages/man7/socket.7.html\" rel=\"nofollow noreferrer\">man 7 socket</a>. I personally would use a configuration file to define the options/values used, with a HUP signal telling the service to reload config: these are practical details."}, {"owner": {"reputation": 8989, "user_id": 22093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c6e38ce98538f43d56ebcae7d3e5fc2f?s=128&d=identicon&r=PG", "display_name": "dswatik", "link": "https://stackoverflow.com/users/22093/dswatik"}, "edited": false, "score": 0, "creation_date": 1503679908, "post_id": 45720867, "comment_id": 78731206, "body": "What we ended up doing is kind of a hack but works... I have two things I look at before recycling the app as needed. When a device connects I increment a counter that tells me I have devices downloading. Then as they are downloading I keep updating a time stamp. Then where we end up when we reached the max connections I look at both the counter and time stamp.. If the counter is &gt; 0 I look at the time stamp and each time a device tries to connect when we are at max and the time stamp is more than 2 mins from current time I figure all is good to restart."}], "owner": {"reputation": 8989, "user_id": 22093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c6e38ce98538f43d56ebcae7d3e5fc2f?s=128&d=identicon&r=PG", "display_name": "dswatik", "link": "https://stackoverflow.com/users/22093/dswatik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502909118, "creation_date": 1502909118, "question_id": 45720867, "link": "https://stackoverflow.com/questions/45720867/c-socket-epollrdhup-not-reliable", "title": "C Socket EPOLLRDHUP not reliable", "body": "<p>I have a C program that uses epoll_ctl.</p>\n\n<p>It waits for connections on a specific port, and when a device connects it determines if the device needs an updated firmware version or not. If it does, it sends the firmware version found on the linux host.</p>\n\n<p>Where I am having trouble is detecting if the device receiving the update disconnects abruptly. </p>\n\n<p>As I need to know this as the server only allows x# of devices to connect and then when the 1 device connects that exeeds this limit I need to restart the service. But only if I know that no devices are getting updates at the time.</p>\n\n<p>I tried checking EPOLLRDHUP but this doesn't seem to work reliably. Any help would be appreciated thanks.</p>\n"}, {"tags": ["c", "arrays", "multithreading"], "comments": [{"owner": {"reputation": 1318, "user_id": 42552, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d3d8778bfd7699f34e9346683b4458db?s=128&d=identicon&r=PG", "display_name": "JosephDoggie", "link": "https://stackoverflow.com/users/42552/josephdoggie"}, "edited": false, "score": 1, "creation_date": 1502909027, "post_id": 45720829, "comment_id": 78399963, "body": "The same <i>absolute</i> memory location can be modified by more than one thread, always."}, {"owner": {"reputation": 658, "user_id": 3400223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd6d233b213516be1ba5a3b97f06cca4?s=128&d=identicon&r=PG&f=1", "display_name": "user3400223", "link": "https://stackoverflow.com/users/3400223/user3400223"}, "edited": false, "score": 0, "creation_date": 1502909198, "post_id": 45720829, "comment_id": 78400052, "body": "Since you&#39;re not setting any of the same address spaces, I don&#39;t think you&#39;ll run into any multithreading issues."}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1502909227, "post_id": 45720829, "comment_id": 78400068, "body": "This depends on the architecture. What processor are you using?"}, {"owner": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "reply_to_user": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1502909302, "post_id": 45720829, "comment_id": 78400102, "body": "@templatetypedef i7 6700k and an AMD on my other computer, i don&#39;t even know the model but it&#39;s 64  bits"}, {"owner": {"reputation": 18493, "user_id": 8176478, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bfdd0a05bddc5a0bcaf042597babdef?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/8176478/mkr"}, "edited": false, "score": 0, "creation_date": 1502909353, "post_id": 45720829, "comment_id": 78400117, "body": "There should not be any problem as long as same element is not being accessed at the same time by different thread."}, {"owner": {"reputation": 3863, "user_id": 1158990, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/75c96a358578ef004ae24e4204e9cd0b?s=128&d=identicon&r=PG", "display_name": "gbtimmon", "link": "https://stackoverflow.com/users/1158990/gbtimmon"}, "reply_to_user": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1502909412, "post_id": 45720829, "comment_id": 78400146, "body": "@templatetypedef How could that depend on architecture?"}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "reply_to_user": {"reputation": 3863, "user_id": 1158990, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/75c96a358578ef004ae24e4204e9cd0b?s=128&d=identicon&r=PG", "display_name": "gbtimmon", "link": "https://stackoverflow.com/users/1158990/gbtimmon"}, "edited": false, "score": 2, "creation_date": 1502909538, "post_id": 45720829, "comment_id": 78400196, "body": "@gbtimmon Imagine there&#39;s a processor that has word-level agreement across different cores about the state of memory. If one core writes to one byte of a word and another core writes to a different byte of the same word, it would be possible that neither one sees collectively what all the bytes in that word look like."}, {"owner": {"reputation": 3863, "user_id": 1158990, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/75c96a358578ef004ae24e4204e9cd0b?s=128&d=identicon&r=PG", "display_name": "gbtimmon", "link": "https://stackoverflow.com/users/1158990/gbtimmon"}, "reply_to_user": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1502909596, "post_id": 45720829, "comment_id": 78400217, "body": "@templatetypedef Very interesting, thank you"}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "reply_to_user": {"reputation": 3863, "user_id": 1158990, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/75c96a358578ef004ae24e4204e9cd0b?s=128&d=identicon&r=PG", "display_name": "gbtimmon", "link": "https://stackoverflow.com/users/1158990/gbtimmon"}, "edited": false, "score": 0, "creation_date": 1502909657, "post_id": 45720829, "comment_id": 78400249, "body": "@gbtimmon I&#39;m actually not sure if any processor actually does this, though. Now I&#39;m wondering if I&#39;m just psyching myself out. :-)"}, {"owner": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "edited": false, "score": 0, "creation_date": 1502909706, "post_id": 45720829, "comment_id": 78400272, "body": "Since my question seems to be answered, what should I do to &quot;solve&quot; the post ?"}, {"owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "reply_to_user": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1502909816, "post_id": 45720829, "comment_id": 78400317, "body": "@templatetypedef you are talking about multi-core. The question is about multi threading. In multithreading, these could be only one core. Isn&#39;t it?"}, {"owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 0, "creation_date": 1502910632, "post_id": 45720829, "comment_id": 78400692, "body": "Related/duplicate? <a href=\"https://stackoverflow.com/q/25697057/1025391\">stackoverflow.com/q/25697057/1025391</a>"}, {"owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 2, "creation_date": 1502910702, "post_id": 45720829, "comment_id": 78400730, "body": "Usually it&#39;s reasonable to have some patience waiting for detailed answers. Maybe someone from another timezone would like to share their insights as well."}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "reply_to_user": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "edited": false, "score": 1, "creation_date": 1502910779, "post_id": 45720829, "comment_id": 78400770, "body": "@MCG You can have multithreading on both a single-core or a multi-core machine, so again the answer would have to depend on the architecture."}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 3, "last_activity_date": 1502911004, "creation_date": 1502911004, "answer_id": 45721347, "question_id": 45720829, "link": "https://stackoverflow.com/questions/45720829/can-two-threads-write-to-different-element-of-the-same-array/45721347#45721347", "title": "Can two threads write to different element of the same array?", "body": "<p>On all systems I have met it is not a functional problem to have different threads write to different elements of the same array. On some systems it may however be a performance problem due to threads on different cores accessing data in the same cache line. The HW will solve the functional part but performance may be bad.</p>\n\n<p>The functional problem doesn't start until you want one thread to read data written by another thread. At that time you'll need a mechanism (e.g. mutex, semaphore, atomic operations, etc.) to ensure that written data is visible to all other threads.</p>\n"}, {"tags": [], "owner": {"reputation": 1876, "user_id": 2353816, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/t5smr.jpg?s=128&g=1", "display_name": "Anders Cedronius", "link": "https://stackoverflow.com/users/2353816/anders-cedronius"}, "is_accepted": false, "score": 1, "last_activity_date": 1502911812, "last_edit_date": 1502911812, "creation_date": 1502911053, "answer_id": 45721363, "question_id": 45720829, "link": "https://stackoverflow.com/questions/45720829/can-two-threads-write-to-different-element-of-the-same-array/45721363#45721363", "title": "Can two threads write to different element of the same array?", "body": "<p>If the threads execute on the same core it will be a serial write process where you will set the different bytes just as 'linear' code would in one thread. However, you would not necessarily know in what order (in the normal case). Meaning what thread is executing in what order when.</p>\n\n<p>However, if the writes occur from two different cores the cache line will be marked shared between the respective cores cache and the write operation will be announced using an RFO message. That will impact the performance.</p>\n\n<p>So, in other words, keep writes to the same cache line in the same core as much as you can.</p>\n\n<p>More information can be found here ->\n<a href=\"https://www.akkadia.org/drepper/cpumemory.pdf\" rel=\"nofollow noreferrer\">What Every Programmer Should Know About Memory</a></p>\n\n<p>/Anders</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1502916736, "post_id": 45721518, "comment_id": 78403528, "body": "Multiple writes to the same location can produce a data race by themselves, without any concurrent readers, by the standard&#39;s definition of &quot;data race&quot;.  Other than that, although I think this answer is correct with respect to the question posed, its wording is very confusing.  Perhaps you mean to say &quot;[...] for <i>different elements of</i> a single array&quot;?"}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1502916914, "post_id": 45721518, "comment_id": 78403609, "body": "@JohnBollinger You&#39;re right. However, I consider writing more demanding than reading, which is why if reading causes a race, then definitely writing does too (I corrected/improved my answer). I couldn&#39;t understand your suggestion. Please suggest an edit and I&#39;ll modify my answer."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1502918158, "post_id": 45721518, "comment_id": 78404101, "body": "I&#39;ve actually made the edit I suggest.  By all means edit further or revert if you don&#39;t like it.  I hesitated to do this at first because it&#39;s a rather substantial change, but for that same reason, I don&#39;t know how to suggest such an edit any more compactly, given that my first attempt did not adequately convey my intent."}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1502918275, "post_id": 45721518, "comment_id": 78404155, "body": "@JohnBollinger Thanks. It&#39;s alright :)"}], "tags": [], "owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "is_accepted": true, "score": 7, "last_activity_date": 1502918046, "last_edit_date": 1502918046, "creation_date": 1502911625, "answer_id": 45721518, "question_id": 45720829, "link": "https://stackoverflow.com/questions/45720829/can-two-threads-write-to-different-element-of-the-same-array/45721518#45721518", "title": "Can two threads write to different element of the same array?", "body": "<p>By definition, a race condition happens when 1 or more threads write data to the same location in memory while others read from it (or write to it, too). Would multiple threads each modifying a different array element be writing to the same location in memory? The answer is no. Each array element has a region of memory reserved for it alone within the region attributed the overall array.  Modifications of different elements therefore do not write to any of the same memory locations.</p>\n\n<p>Actually I asked this question a very long time ago <a href=\"https://stackoverflow.com/questions/12620183/scheduling-system-for-fitting\">here</a>, and based part of my PhD work on that. I fitted hundreds of curves (least-squares fitting) in parallel, while updating a single array that has the results by multiple threads.</p>\n"}], "owner": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3359, "favorite_count": 4, "closed_date": 1503004847, "accepted_answer_id": 45721518, "answer_count": 3, "score": 7, "last_activity_date": 1502927470, "creation_date": 1502908941, "last_edit_date": 1502927470, "question_id": 45720829, "link": "https://stackoverflow.com/questions/45720829/can-two-threads-write-to-different-element-of-the-same-array", "closed_reason": "Duplicate", "title": "Can two threads write to different element of the same array?", "body": "<p>I was wondering whether or not two threads could modify elements of the same array.</p>\n\n<p>If I have <code>unsigned char array[4]</code>, can thread1 set <code>array[0]</code> and <code>array[1]</code> to 'A' and thread2 set <code>array[2]</code> and <code>array[3]</code> to 'B' at the same time without problems?</p>\n"}, {"tags": ["c#", "c", "vb.net", "visual-studio"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1502904296, "post_id": 45719530, "comment_id": 78397537, "body": "That approach is not going to work, you would need to use p/invoke - <a href=\"https://docs.microsoft.com/en-gb/cpp/dotnet/calling-native-functions-from-managed-code\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-gb/cpp/dotnet/&hellip;</a> - There are going to be significantly easier options using a different .Net HTTP server implementation such as httpListener."}, {"owner": {"reputation": 488, "user_id": 1894697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e31e63c623c67fad9d407a84729c725?s=128&d=identicon&r=PG", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/1894697/chrisb"}, "edited": false, "score": 0, "creation_date": 1502911312, "post_id": 45719530, "comment_id": 78400994, "body": "You need to create your own interface for the C dll and provide entry point (export) for the functions you want PInvoke in C#. You can start here: <a href=\"https://www.codeproject.com/Articles/403285/P-Invoke-Tutorial-Basics-Part\" rel=\"nofollow noreferrer\">codeproject.com/Articles/403285/P-Invoke-Tutorial-Basics-Par&zwnj;&#8203;t</a>"}], "owner": {"reputation": 94, "user_id": 3276211, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/673410805/picture?type=large", "display_name": "araad1992", "link": "https://stackoverflow.com/users/3276211/araad1992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502910861, "creation_date": 1502903823, "last_edit_date": 1502910861, "question_id": 45719530, "link": "https://stackoverflow.com/questions/45719530/how-can-i-use-a-dll-written-in-c", "title": "How can I use a DLL written in C", "body": "<p>I'm a newbie in <em>DLL management</em>.</p>\n\n<p>It turns out that I need to use the GNU Libmicrohttpd library found at this <a href=\"https://www.gnu.org/software/libmicrohttpd/\" rel=\"nofollow noreferrer\">link</a> </p>\n\n<p>In this library, the problem I have found is that it is written in <strong>C</strong> and the project I am doing is in <strong>.Net</strong> and when I try to add the DLL in Visual studio it marks the following error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JeAJW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JeAJW.jpg\" alt=\"Error\"></a></p>\n\n<p>What possibility can I have to add it to the project? I appreciate your cooperation.</p>\n"}, {"tags": ["c", "wireshark", "tcp-ip", "tshark"], "comments": [{"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1502907006, "post_id": 45719172, "comment_id": 78398992, "body": "Dump the hex of the packet and show us that.  It might be as simple as an endian issue."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1502907529, "post_id": 45719172, "comment_id": 78399257, "body": "strncat() does not copy bytes."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1502980039, "post_id": 45719172, "comment_id": 78433359, "body": "this line: strncat((char*)buffer,(char*)pseudo_segment,12); has a 254:1 probability of failing because the buffer[] array, first byte has not been previously set to 0x00 AND the data is not a char string AND may contain some 0x00 bytes.   Suggest using <code>memcpy()</code>"}, {"owner": {"reputation": 53, "user_id": 8400194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TkQLw.png?s=128&g=1", "display_name": "ssharma", "link": "https://stackoverflow.com/users/8400194/ssharma"}, "edited": false, "score": 0, "creation_date": 1502985973, "post_id": 45719172, "comment_id": 78437685, "body": "Yes, I&#39;ve fixed that after I was notified to use <code>memcpy()</code>. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8400194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TkQLw.png?s=128&g=1", "display_name": "ssharma", "link": "https://stackoverflow.com/users/8400194/ssharma"}, "edited": false, "score": 0, "creation_date": 1502907858, "post_id": 45720529, "comment_id": 78399428, "body": "Thank you very much! I was banging my head against the wall trying to figure this out. :)"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 53, "user_id": 8400194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TkQLw.png?s=128&g=1", "display_name": "ssharma", "link": "https://stackoverflow.com/users/8400194/ssharma"}, "edited": false, "score": 0, "creation_date": 1502908035, "post_id": 45720529, "comment_id": 78399514, "body": "@ssharma unfortunately, the misuse of C library strxxx() calls in network code is legendary. So legendary that it was the first thing I looked for in your code. You need to be very careful any time you find yourself typing &#39;str&#39; :)"}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 53, "user_id": 8400194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TkQLw.png?s=128&g=1", "display_name": "ssharma", "link": "https://stackoverflow.com/users/8400194/ssharma"}, "edited": false, "score": 0, "creation_date": 1502908049, "post_id": 45720529, "comment_id": 78399519, "body": "@ssharma I looked at it on and off for quite a while myself :-D"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1502979842, "post_id": 45720529, "comment_id": 78433212, "body": "Note: the hard coded lengths and offset is a very poor idea.  Suggest using: ` <code>sizeof(struct tcphdr)</code> and  <code>sizeof(struct iphdr)</code>.  Also, some of the code is expecting one of those lengths to be 32 bytes, not 20"}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": true, "score": 3, "last_activity_date": 1502907652, "creation_date": 1502907652, "answer_id": 45720529, "question_id": 45719172, "link": "https://stackoverflow.com/questions/45719172/bogus-tcp-header-length-when-examining-packets-in-tshark/45720529#45720529", "title": "Bogus TCP Header Length When Examining Packets in Tshark", "body": "<p>I think your problem is here</p>\n\n<pre><code>strncat((char*)buffer,(char*)tcpbuf,20); // copy only 20 bytes...this ensures that no extra bytes are catted\nstrncat((char*)buffer,(char*)ipbuf,20);\n</code></pre>\n\n<p>The headers aren't strings so you may only be copying part of each header.  Try something like this;</p>\n\n<pre><code>memcpy((char*)buffer, (char*)tcpbuf, 20);\nmemcpy((char*)buffer+20, (char*)ipbuf, 20);\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8400194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TkQLw.png?s=128&g=1", "display_name": "ssharma", "link": "https://stackoverflow.com/users/8400194/ssharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1503, "favorite_count": 0, "accepted_answer_id": 45720529, "answer_count": 1, "score": 2, "last_activity_date": 1502907652, "creation_date": 1502902622, "question_id": 45719172, "link": "https://stackoverflow.com/questions/45719172/bogus-tcp-header-length-when-examining-packets-in-tshark", "title": "Bogus TCP Header Length When Examining Packets in Tshark", "body": "<p>I was trying to send a TCP <code>SYN</code> packet to a server on my machine on port <code>8000</code>. Then, I wanted to check if the server responded with a <code>SYN ACK</code>. If this was the case, then I would send back a <code>RST</code> packet to abort the connection. However, when I sniff the <code>SYN</code> packet that I send out it tells me the TCP header has a bogus length of 0, which isn't the case. The sniffer I used was <code>tshark</code>, by the way. Here's my code: </p>\n\n<p>In the <code>main</code> function, I run this: </p>\n\n<pre><code>FLAGS f = SYN;\n\ntcp_scan(\"127.0.0.1\",8000,f,0);\n</code></pre>\n\n<p>This function assembles the IP header:</p>\n\n<pre><code>struct iphdr* assemble_ip(char* dest,unsigned int proto) {\n\n    /* Assemble IP Layer */\n\n    struct iphdr* iph;\n\n    iph = malloc(sizeof(struct iphdr)); // allocate memory\n\n    if (iph == NULL) { // if the ip header is NULL\n\n         err();\n         return NULL;\n\n    }\n\n    srand((unsigned int)time(NULL)); // seed random number generator\n\n    /* Hardcoded values */\n\n    iph-&gt;version = 4; // the version\n    iph-&gt;tos = 0; // type of services\n    iph-&gt;ihl = 5; // internet header length\n    iph-&gt;id = htons(rand() % 65536);  // random id\n    iph-&gt;ttl = rand() % 257; // ttl\n    iph-&gt;frag_off = 0; // fragment offset\n\n    if (iph-&gt;ttl &lt; 64) iph-&gt;ttl += 64; // if TTL is not sufficient\n\n    iph-&gt;tot_len = htons(iph-&gt;ihl*4); // the internet header length\n\n    /* User defined values */\n\n    iph-&gt;saddr = inet_addr(client); // source address\n    iph-&gt;daddr = inet_addr(dest); // destination address\n    iph-&gt;protocol = proto; // protocol\n\n    iph-&gt;check = 0; // set to zero for later calculation\n\n    return iph;\n\n    }\n</code></pre>\n\n<p>This function assembles the TCP header:</p>\n\n<pre><code>struct tcphdr* assemble_tcp(unsigned int sport,unsigned int dport,FLAGS f) {\n\n    /* Assemble TCP layer */\n\n    struct tcphdr* tcph;\n\n    tcph = malloc(sizeof(struct tcphdr)); // allocate tcp header\n\n    if (tcph == NULL) { // if tcp is NULL\n\n         err();\n         return NULL;\n\n    }\n\n\n    bzero(tcph,sizeof(struct tcphdr));\n\n    srand((unsigned int)time(NULL)); // seed random number generator\n\n    /* Hardcoded values */\n\n    tcph-&gt;seq = htonl(rand() % 65001); // generate random sequence number\n    tcph-&gt;ack_seq = 0; // ack sequence should be 0\n    tcph-&gt;doff = 5; // set data offset\n    tcph-&gt;window = htons(rand() % 65536); // set window size\n\n    /* Increase values by random value above 64 */\n\n    if (ntohs(tcph-&gt;seq) &lt; 64) tcph-&gt;seq += (rand() % 101 + 64);\n    if (ntohs(tcph-&gt;window) &lt; 64) tcph-&gt;window += (rand() % 101 + 64);\n\n    /* User-defined values */\n\n    tcph-&gt;source = htons(sport); // source port\n    tcph-&gt;dest = htons(dport);  // destination port\n    tcph = set_flags(tcph,f); // set the TCP flags\n\n    /* Set urgent ptr if URG flag is set*/\n\n    if (tcph-&gt;urg == 1) tcph-&gt;urg_ptr = 1;\n    else tcph-&gt;urg_ptr = 0;\n\n    tcph-&gt;check = 0; // set the checksum to 0 for other calculations\n\n\n    return tcph;\n\n    }\n</code></pre>\n\n<p>Also, I do compute the checksum of the headers. For my purposes, when calculating the checksum, the IP header is always 20 bytes long, since I'm not sending any data or options. That means that there are 10 16-bit words in the header. The TCP header is also going to be 20 bytes long since I didn't add any options or data. Here's the code: </p>\n\n<pre><code>unsigned short ip_checksum(struct iphdr* iph) {\n\n    /* Acquire IP checksum */\n\n    /*\n\n    Checksum for Internet Protocol:\n    One's complement of the one's complement sum of the 16 bit words in the header.\n    So we get the first 16 bits of the header then add it to the sum, and then\n    we get the next 16 bits, and add it, and so on.\n    ...0100101010110101 -&gt; \"...\" represents more bits \n    1111111111111111 -&gt; this is 131071 in base 10 \n    0000100101010110101 -&gt; notice how the \"...\" bits are now 0's\n\n    */\n\n    /* One's complement sum */\n\n    unsigned long long* ptr;\n    unsigned long long hdr;\n    unsigned short sum = 0;\n    unsigned long mask = 131071;\n\n    ptr = (unsigned long long*)iph;  // cast structure\n    hdr = *ptr; // get hdr \n\n    for (int i = 0; i &lt; 10; i++) { // 20 bytes -&gt; 160 bits / 16 bits = 10 words\n\n            sum += (hdr &amp; mask); // add to sum\n\n            hdr &gt;&gt;= 16; // shift the next 16 bits\n\n  }\n\n  sum = ~sum; // inverse \n\n  return sum;\n\n  }\n</code></pre>\n\n<p>TCP Checksum: </p>\n\n<pre><code>  unsigned short tcp_checksum(struct tcphdr* tcph,struct iphdr* iph)  {\n\n          /* Calculate TCP checksum */\n\n          struct pseudo_hdr* pseudo_hdr;\n          u_char* buffer;\n          u_char* segment;\n          u_char* pseudo_segment;\n          unsigned short sum = 0;\n          unsigned long mask = 131071;\n          unsigned long long* ptr;\n          unsigned long long hdr;\n\n          pseudo_hdr = malloc(sizeof(struct pseudo_hdr)); // allocate memory\n          buffer = malloc(32); // allocate for 32 bytes of information \n\n          if (pseudo_hdr == NULL || buffer == NULL) { // if memory wasn't allocated properly\n\n              err();\n              if (pseudo_hdr != NULL) free(pseudo_hdr);\n              if (buffer != NULL) free(buffer);\n              return 0;\n\n          }\n\n          pseudo_hdr-&gt;saddr = (unsigned long)iph-&gt;saddr; // we add the  cast because the fields if of type u_int_32\n          pseudo_hdr-&gt;daddr = (unsigned long)iph-&gt;daddr; // same reason for adding the cast as above\n          memset(&amp;pseudo_hdr-&gt;reserved,0,8); // set these 8 bits to 0\n          pseudo_hdr-&gt;proto = IPPROTO_TCP; // this will always be 6\n          pseudo_hdr-&gt;len = htons(tcph-&gt;doff*4); // length of tcp header\n\n          /* Place both headers into a buffer */\n\n          segment = (u_char*)tcph; \n          pseudo_segment = (u_char*)pseudo_hdr; \n\n          /* Concactenate */\n\n          strncat((char*)buffer,(char*)pseudo_segment,12); // first the pseudo header \n          strncat((char*)buffer,(char*)segment,20); // then the TCP segment \n\n          /* Calculate checksum just like IP checksum */\n\n          ptr = (unsigned long long*)buffer; // convert buffer \n\n          hdr = *ptr; // dereference for clarity in following clode\n\n          for (int i = 0; i &lt; 16; i++) { // 32 bytes -&gt; 256 bits / 16 bits = 16 words\n\n               sum += (hdr &amp; mask); // apply mask to header and add to sum\n\n               hdr &gt;&gt;= 16;  // shift the next 16 bits\n\n           }\n\n\n           sum = ~sum; // bitwise NOT operation\n\n           return sum;\n\n           };\n</code></pre>\n\n<p>Here's all of the functions I stated above put together: </p>\n\n<pre><code>int tcp_scan(char* ipaddr,unsigned int port,FLAGS f,unsigned int justsend) {\n\n    /* Do a TCP port scan */\n\n    u_char* buffer;\n    u_char recvbuf[65535];\n    u_char* ipbuf;\n    u_char* tcpbuf;\n    int s;\n    size_t bufsize;\n    size_t size;\n    struct sockaddr_in sa;\n    struct sockaddr_in recvstruct;\n    struct msghdr msg;\n    struct iovec iv[1];\n    struct iphdr* iph;\n    struct tcphdr* tcph;\n    FLAGS rst = RST;\n\n    srand((unsigned int)time(NULL)); // seed random number generator\n\n    bufsize = sizeof(struct tcphdr) + sizeof(struct iphdr); // store size in variable\n\n    buffer = malloc(bufsize); // allocate memory to buffer\n    iph = assemble_ip(ipaddr,IPPROTO_TCP); // set the ip address to provided and protocol as TCP\n    tcph = assemble_tcp(rand() % 65536,port,f); // set flag, source port as rand, and dest port as supplied port num\n\n    if (iph == NULL || tcph == NULL || buffer == NULL) { // if error occurs\n\n           err();\n\n           /* Deallocate memory to variables that still have it */\n\n           if (iph != NULL) free(iph);\n           if (tcph != NULL) free(tcph);\n           if (buffer != NULL) free(buffer);\n\n           return -1;\n\n     }\n\n           /* Now compute checksum */\n\n           iph-&gt;check = htons(ip_checksum(iph));\n           tcph-&gt;check = htons(tcp_checksum(tcph,iph)); \n\n           /* Store headers in buffer */\n\n           ipbuf = (u_char*)iph;\n           tcpbuf = (u_char*)tcph;\n\n           /* Concactenate to buffer */\n\n           strncat((char*)buffer,(char*)tcpbuf,20); // copy only 20 bytes...this ensures that no extra bytes are catted\n           strncat((char*)buffer,(char*)ipbuf,20); // do same thing but with ip header\n\n           /* Create a socket */\n\n           s = create_socket(); // create a raw socket\n\n           if (s == -1) return -1;  // if the socket wasn't able to be created\n\n\n           /* Clear memory */\n\n           bzero(&amp;sa,sizeof(struct sockaddr_in));\n           bzero(&amp;recvstruct,sizeof(struct sockaddr_in));\n           bzero(&amp;msg,sizeof(struct msghdr));\n           bzero(&amp;iv,sizeof(struct iovec));\n\n           /* For analyze_packet() */\n\n           sa.sin_family = AF_INET; // address family\n           sa.sin_addr.s_addr = inet_addr(ipaddr); // convert ip address\n           sa.sin_port = htons(port); // port number\n\n           /* For sendmsg() */\n\n          iv[0].iov_base = buffer;\n          iv[0].iov_len = bufsize;\n\n          msg.msg_name = &amp;sa; // caller allocated buffer\n          msg.msg_namelen = sizeof(struct sockaddr_in); // specify size of buffer\n          msg.msg_iov = iv; // iov structure array\n          msg.msg_iovlen = 1; // the length of the array\n          msg.msg_control = NULL; // for ancillary data\n          msg.msg_controllen = 0; // sizeof ancillary data\n\n\n          if (sendmsg(s,&amp;msg,0) == -1) {\n\n              err();\n              return -1;\n\n          }\n\n          printf(\"Sent\\n\");\n\n          if (justsend) return 0; // exit cleanly\n\n          bzero(&amp;recvstruct,sizeof(struct sockaddr_in)); // clear structure\n\n          size = sizeof(struct sockaddr_in); // acquire size of recv structure\n\n          for(int i = 0; i &lt; 100; i++) { // loop until we've received 100 packets\n\n                 printf(\"Receiving\\n\");\n                 bzero(recvbuf,65535); // clear memory\n\n                 if (recvfrom(s,recvbuf,sizeof(recvbuf),0,(struct sockaddr*)&amp;recvstruct,(socklen_t*)&amp;size) == -1) { // recv\n\n                      err();\n                      return -1;\n\n                 }\n\n                 if (analyze_packet(recvbuf,sa,recvstruct) == 0) { // if packet is what we wanted\n\n                      printf(\"\\ttcp %d is open\\n\",port); // print out that port is opened\n                      tcp_scan(ipaddr,port,rst,-1); // abort connection with RST flag\n                      break;\n\n                  }\n\n\n             }\n\n           return 0;\n\n}\n</code></pre>\n\n<p>Alright, now that you've seen those, here's the 'tshark' command I used to sniff the packets: </p>\n\n<pre><code>sudo tshark -o tcp.check_checksum:TRUE # I also wanted to check the checksum value to make sure it was OK\n</code></pre>\n\n<p>Now here's the command to run the program: </p>\n\n<pre><code>sudo ./netmap enp0s3 # enp0s3 is the interface I'm sending packets on\n</code></pre>\n\n<p>After running both of these in separate terminals, <code>tshark</code> provides this output: </p>\n\n<pre><code>1    0.000000    10.0.2.15 -&gt; 127.0.0.1    TCP 74 31280-&gt;8000 [&lt;None&gt;] Seq=1 Win=0, bogus TCP header length (0, must be 20)\n</code></pre>\n\n<p>Please note that the declarations for <code>struct iphdr</code> and <code>struct tcphdr</code> are located in the system header files <code>&lt;netinet/ip.h&gt;</code> and <code>&lt;netinet/tcp.h&gt;</code>, respectively. </p>\n\n<p>I'm really lost as to how to solve this issue. In fact, I'm not certain what is causing the issue, in the first place. According to my knowledge there's no way to specify the length of the TCP header. Any help would be appreciated.</p>\n"}, {"tags": ["c", "file", "scanf", "hyphen"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502902231, "post_id": 45719050, "comment_id": 78396315, "body": "Perhaps a <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>scanf</code> (and family)</a> reference could be useful? Especially about the format string. Something any <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">good beginners book</a> or any good online tutorial should have told you as well."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502902463, "post_id": 45719050, "comment_id": 78396423, "body": "How do you know that the second number won&#39;t be read?  You don&#39;t test the return value from <code>fscanf()</code>, so you&#39;ve no idea whether either conversion worked?  It isn&#39;t clear why you don&#39;t use <code>if (fscanf(&quot;%f-%f&quot;, &amp;x.horarioentrada, *x.horariosaida) != 2) { \u2026oops; something went wrong\u2026 }</code> \u2014 and the &#39;oops&#39; part is when it becomes better to use <code>fgets()</code> to read the line of input and <code>sscanf()</code> to parse it; then you can see what was causing trouble more easily.  Are the structure members actually of type <code>float</code>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1502903798, "post_id": 45719050, "comment_id": 78397233, "body": "You seem satisfied with the answer but I cannot reproduce. A text file containing your <code>19.3-20.3</code> scans and prints <code>19.299999 -20.299999</code>. I realise you didn&#39;t want to scan the <code>-</code> but I do not get &quot;The second number won&#39;t be read.&quot;"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502903974, "post_id": 45719050, "comment_id": 78397333, "body": "Note that if you fail to open the file, you report the error, but then proceed to use the null file pointer, which will probably crash and certainly won&#39;t work correctly.  It is good to report the problem; it is better if the error message identifies the file that can&#39;t be opened by name; it is better still if you ensure that you don&#39;t use the failed file stream \u2014 in the <code>for</code> loop of <code>fclose()</code> call \u2014 once you&#39;ve identified that there is a problem."}, {"owner": {"reputation": 3, "user_id": 8473738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c17f2cf08422e478332ddfb7cd257de?s=128&d=identicon&r=PG&f=1", "display_name": "Supra", "link": "https://stackoverflow.com/users/8473738/supra"}, "edited": false, "score": 0, "creation_date": 1502908454, "post_id": 45719050, "comment_id": 78399691, "body": "At first it didn&#39;t work, but if you have spacing in the txt file and in the fscanf line it works fine for me. file: 13.30 - 20.30 line: fscanf(f,&quot;%f - %f&quot;,&amp;x.horarioentrada,&amp;x.horariosaida);"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502909457, "post_id": 45719050, "comment_id": 78400165, "body": "&quot;The second number won&#39;t be read.&quot; is certainly an error in OP&#39;s post."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502902503, "post_id": 45719115, "comment_id": 78396450, "body": "Negative numbers are fine \u2014 using the code in the question (not your answer) the 19.30-20.30 should be read as +19.30 and -20.30 without problem, shouldn&#39;t it?  Note that&#39;s not disputing the fix (which is what I&#39;d expect, give or take checking the result of the function call); it just isn&#39;t clear that that the diagnosis is correct."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502902699, "post_id": 45719115, "comment_id": 78396562, "body": "@JonathanLeffler It gets read as +19.30 and +20.30.  This is assuming the hyphen is the delimiter."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502902798, "post_id": 45719115, "comment_id": 78396624, "body": "Yes \u2014 I&#39;ve clarified my comment to asking why your diagnosis of the code in the question is right; I still don&#39;t dispute that what you&#39;re suggesting is a fix to the problem."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502902939, "post_id": 45719115, "comment_id": 78396697, "body": "@JonathanLeffler The way I read it, the file contains numbers separated by a hyphen.  The part about &quot;the code works if the hyphen is removed&quot; sounds like experimentation on OP&#39;s part, reinforced by &quot;but I am doing a job for school purposes <i>and the hyphen is needed</i>&quot;."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502903365, "post_id": 45719115, "comment_id": 78396954, "body": "We&#39;re probably arguing over nothing, but\u2026the code <code>#include &lt;stdio.h&gt;</code> \u2014 <code>int main(void) { float x, y; if (sscanf(&quot;19.30-20.30&quot;, &quot;%f%f&quot;, &amp;x, &amp;y) != 2) printf(&quot;Oops!\\n&quot;); else printf(&quot;%+6.2f %+6.2f\\n&quot;, x, y); return 0; }</code> is equivalent to the OP&#39;s code and the desired input and produces as output <code>+19.30 -20.30</code>. Granted, the original has two <code>fscanf()</code> calls instead of one <code>sscanf()</code> call, but the code is equivalent, not identical. And the result is the same \u2014 two numbers successfully read, one negative.  I&#39;m not for a second disputing the fix.  I&#39;m just not understanding the original problem."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502903536, "post_id": 45719115, "comment_id": 78397056, "body": "Given that the OP is happy with the answer, which is what I&#39;d suggest anyway, we can let it subside.  I&#39;m still unhappy that I don&#39;t see why the original code &quot;didn&#39;t work&quot; \u2014 or how it was known not to work.  But the fix seems to work and is fine with me.  So, let sleeping dogs lie."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1502902368, "creation_date": 1502902368, "answer_id": 45719115, "question_id": 45719050, "link": "https://stackoverflow.com/questions/45719050/scanning-from-file-two-floats-with-hyphen-between/45719115#45719115", "title": "Scanning from file two floats with hyphen between", "body": "<p>You need to include the \"-\" character as part of the <code>scanf</code> format.  That way, the character is skipped over:</p>\n\n<pre><code>fscanf(f, \"%f-%f\", &amp;x.horarioentrada, &amp;x.horariosaida);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8473738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c17f2cf08422e478332ddfb7cd257de?s=128&d=identicon&r=PG&f=1", "display_name": "Supra", "link": "https://stackoverflow.com/users/8473738/supra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 45719115, "answer_count": 1, "score": 0, "last_activity_date": 1502903754, "creation_date": 1502902115, "last_edit_date": 1502903754, "question_id": 45719050, "link": "https://stackoverflow.com/questions/45719050/scanning-from-file-two-floats-with-hyphen-between", "title": "Scanning from file two floats with hyphen between", "body": "<p>I am trying to scan from a .txt file with two floats with an hyphen in between them. The code works if the hyphen is removed, but I am doing a job for school purposes and the hyphen is needed.</p>\n\n<p>The function is supposed to load the info from the file to an array.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;estruturas.h&gt;\n#include &lt;funcoes.h&gt;\n\nvoid loadmedicos(medico *pmedico,int total){\n\n    FILE *f;\n    medico x; //medico is a typedefined struct with 2 floats\n    f=fopen(\"medicos.txt\",\"rt\");\n\n    if(f==NULL){\n        printf(\"Ocorreu um erro ao abrir 'medicos.txt'!\\n\\n\");\n    }\n    for(int i=0;i&lt;total;i++){\n        fscanf(f,\"%f\",&amp;x.horarioentrada);\n        fscanf(f,\"%f\",&amp;x.horariosaida);\n        *(pmedico+i)=x;\n    }\n\n    fclose(f);\n}\n</code></pre>\n\n<p>If the .txt contains:</p>\n\n<pre><code>19.30 20.30\n</code></pre>\n\n<p>Then it will read correctly and output those numbers.  If the file contains:</p>\n\n<pre><code>19.30-20.30\n</code></pre>\n\n<p>The second number won't be read.  Why is that and how can I fix it?</p>\n"}, {"tags": ["python", "c", "cython"], "comments": [{"owner": {"reputation": 30745, "user_id": 182675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IO04V.jpg?s=128&g=1", "display_name": "ndim", "link": "https://stackoverflow.com/users/182675/ndim"}, "edited": false, "score": 0, "creation_date": 1502904980, "post_id": 45718915, "comment_id": 78397904, "body": "Shouldn&#39;t that be <code>from world import world</code>?"}, {"owner": {"reputation": 30745, "user_id": 182675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IO04V.jpg?s=128&g=1", "display_name": "ndim", "link": "https://stackoverflow.com/users/182675/ndim"}, "edited": false, "score": 0, "creation_date": 1502905033, "post_id": 45718915, "comment_id": 78397939, "body": "Also, if something does not work when I run a program with <code>--force</code>, it might be a good idea to look at what is being forced here."}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1502913014, "post_id": 45718915, "comment_id": 78401792, "body": "I think part of your problem is that you are trying to compile two different .pyx files into one module, which doesn&#39;t work. Each .pyx file translates into one module."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 8473731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/740501f7e9adad9741ee8d755ee0ab6e?s=128&d=identicon&r=PG&f=1", "display_name": "ARN", "link": "https://stackoverflow.com/users/8473731/arn"}, "edited": false, "score": 0, "creation_date": 1502912149, "post_id": 45719274, "comment_id": 78401420, "body": "Sorry, typo. That&#39;s not the problem."}], "tags": [], "owner": {"reputation": 113, "user_id": 8302055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qVQZ2.jpg?s=128&g=1", "display_name": "rytse", "link": "https://stackoverflow.com/users/8302055/rytse"}, "is_accepted": false, "score": 0, "last_activity_date": 1502903012, "creation_date": 1502903012, "answer_id": 45719274, "question_id": 45718915, "link": "https://stackoverflow.com/questions/45718915/call-python-file-with-python-imports-from-c-using-cython/45719274#45719274", "title": "Call python file with python imports from C using cython", "body": "<p><code>import world</code> imports the <em>module</em>, not the function.</p>\n\n<p>In order to call <code>world()</code> from a different module, you must use <code>world.world()</code></p>\n"}, {"comments": [{"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1502964679, "post_id": 45723864, "comment_id": 78422092, "body": "If you compile world.pyx to a separate file like the &quot;import&quot; mechanism expects then it&#39;ll work correctly."}], "tags": [], "owner": {"reputation": 111, "user_id": 8473731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/740501f7e9adad9741ee8d755ee0ab6e?s=128&d=identicon&r=PG&f=1", "display_name": "ARN", "link": "https://stackoverflow.com/users/8473731/arn"}, "is_accepted": false, "score": 0, "last_activity_date": 1502922003, "creation_date": 1502922003, "answer_id": 45723864, "question_id": 45718915, "link": "https://stackoverflow.com/questions/45718915/call-python-file-with-python-imports-from-c-using-cython/45723864#45723864", "title": "Call python file with python imports from C using cython", "body": "<p>One solution seems to be to add a call to <code>PyInit_world();</code> in the main function. Cython adds this function to <code>world.c</code>, even though in this case it does not generate a header file, so we get a warning, but it works. </p>\n\n<p>Is there a way to have <code>hello.c</code> call <code>PyInit_world()</code> automatically, so that <code>main.c</code> doesn't need to know about that? In that way, the C include hierarchy would mirror the python one.</p>\n"}], "owner": {"reputation": 111, "user_id": 8473731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/740501f7e9adad9741ee8d755ee0ab6e?s=128&d=identicon&r=PG&f=1", "display_name": "ARN", "link": "https://stackoverflow.com/users/8473731/arn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 795, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1502922003, "creation_date": 1502901616, "question_id": 45718915, "link": "https://stackoverflow.com/questions/45718915/call-python-file-with-python-imports-from-c-using-cython", "title": "Call python file with python imports from C using cython", "body": "<p>This question is based on <a href=\"https://stackoverflow.com/questions/22589868/call-python-code-from-c-via-cython\">this one</a>, but with a twist. I want to compile a python function using cython, then call it in C. In this simple case, it works, but when I try to import another python module from my python code, it doesn't work.</p>\n\n<p>world.pyx</p>\n\n<pre><code>def world():\n    return 10\n</code></pre>\n\n<p>hello.pyx</p>\n\n<pre><code>import world\n\ndef hello():\n    ret = 5 + world()\n    return ret\n\ncdef public int call_hello():\n    return hello()\n</code></pre>\n\n<p>main.c</p>\n\n<pre><code>#include &lt;Python.h&gt;\n#include \"hello.h\"\n\nint main() {\n  Py_Initialize();\n  PyInit_hello();\n  int v = call_hello();\n\n  printf(\"the value is %d\\n\",v);\n\n  Py_Finalize();\n  return 0;\n}\n\ncython -3 --force world.pyx hello.pyx\nclang -c world.c hello.c main.c -I/Users/aneben/.pyenv/versions/3.6.1/Python.framework/Versions/3.6/include/python3.6m -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes\nclang -L/Users/aneben/.pyenv/versions/3.6.1/Python.framework/Versions/3.6/lib/python3.6/config-3.6m-darwin -lpython3.6m -ldl -framework CoreFoundation world.o hello.o main.o  -o main\n</code></pre>\n\n<p>If I simply move the <code>world</code> function into <code>hello.pyx</code>, then it works fine. But it doesn't work as written when I import it.</p>\n\n<p>./main</p>\n\n<pre><code>NameError: name 'hello' is not defined\nException ignored in: 'hello.call_hello'\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1502901343, "post_id": 45718718, "comment_id": 78395826, "body": "Simple: don&#39;t use sscanf. Use <code>strtol</code> and play with the array directly."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502905435, "post_id": 45718718, "comment_id": 78398151, "body": "Since all the numeric conversions in <code>sscanf()</code> and family skip over leading white space, you have to work every bit as hard as in chux&#39;s answer using <code>sscanf()</code> \u2014 it is really not the appropriate tool.  And careful use of <code>strtol()</code> is likely to be a good way to deal with it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502905895, "post_id": 45718718, "comment_id": 78398385, "body": "@JonathanLeffler Note that <code>strtol()</code> and family also skip leading white-space.  Using <code>strtol()</code> is the better function primarily due to well defined OF handling - something that detailed by OP yet. <code>strtol()</code> has minor <code>int&#47;long</code> type concerns."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1502906117, "post_id": 45718718, "comment_id": 78398495, "body": "@chux: true \u2014 I didn&#39;t make it clear that <code>strtol()</code> also skips leading white space, but that was part of the &#39;careful use&#39; qualifier, albeit one that should probably have been stated clearly.  I wonder why the input format must be so rigorous.  In general, the <a href=\"https://en.wikipedia.org/wiki/Robustness_principle\" rel=\"nofollow noreferrer\">Robustness Principle</a> says &quot;be generous in what you accept; be careful in what you generate&quot;.  I wonder if that should be applied here."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502906378, "post_id": 45718718, "comment_id": 78398673, "body": "Are signs allowed in the data (<code>-3 +4</code>)?  All the normal tools will allow signs through; if there should be no signs, then you have another set of validation  to do \u2014 and <code>sscanf()</code> becomes even less appropriate.  You&#39;d need to check that you have a digit at the start, a digit at the end, only digits and a single space in between, and that the values in the digit strings are convertible safely.  Fiddly!"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1502907854, "post_id": 45718718, "comment_id": 78399427, "body": "Among the many other problems with the <code>*scanf()</code> functions, they have undefined behavior on numeric overflow."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1502989197, "post_id": 45718718, "comment_id": 78439606, "body": "strongly suggest reading in a whole line, then write your own parser to parse that line.  The scanf() family of functions are not the appropriate tools for what you want to do."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502905660, "post_id": 45718850, "comment_id": 78398267, "body": "Excellent demonstration of both the power of <code>sscanf()</code> et al and also of the intricacy of getting it all right when you need to be stringent."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502905898, "post_id": 45718850, "comment_id": 78398389, "body": "Silly Q time: when will the first <code>%n</code> in your format string return a value that isn&#39;t 0?  Do you want a space before it?  Or can you simply test <code>isspace(buf[0])</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502906053, "post_id": 45718850, "comment_id": 78398455, "body": "Yes, using <code>isspace(buf[0])</code> or the pedatic <code>isspace((unsigned char) buf[0])</code> would simplify code - good eye.  A singular advantage to <code>&quot;%n%d&quot;</code> is that it is symmetric for the 2 <code>int</code>s."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1502908898, "last_edit_date": 1502908898, "creation_date": 1502901358, "answer_id": 45718850, "question_id": 45718718, "link": "https://stackoverflow.com/questions/45718718/sscanf-usage-in-very-specific-format/45718850#45718850", "title": "sscanf usage in very specific format", "body": "<p>Step 1: read the line (note OP implies code is starting with a string so this step is illustrative.)</p>\n\n<pre><code>char buf[100];\nif (fgets(buf, sizeof buf, stdin) == NULL) Handle_EOF_or_Error();\n// strip potential \\n\nbuf[strcspn(buf, \"\\n\")] = '\\0';\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>check if only two numbers are entered separated by only ONE space, with no leading or trailing whitespace at all</p>\n</blockquote>\n\n<p>Step 2: Scan per format.  <code>\"%d\"</code> allows for leading whitespace - so code needs to see what is before the numeric text.  Use <code>\"%n\"</code> to store the scan offset for later  whitespace detection.  <code>%*1[ ]</code> to scan (not save) 1 and exactly 1 space.</p>\n\n<pre><code>int i[2];\nint sep[3];\nint cnt = sscanf(buf, \"%n%d%*1[ ]%n%d%n\", &amp;sep[0], &amp;i[0], &amp;sep[1], &amp;i[1], &amp;sep[2]);\n\n// 2 int            leading space?        leading space?        \\0 ?\nif (cnt != 2 || isspace(buf[sep[0]]) || isspace(buf[sep[1]]) || buf[sep[2]]) {\n  Handle_Bad_Input();\n} else {\n  Success();\n}\n</code></pre>\n\n<hr>\n\n<p>Simplification idea per <a href=\"https://stackoverflow.com/questions/45718718/sscanf-usage-in-very-specific-format/45718850?noredirect=1#comment78398389_45718850\">@Jonathan Leffler</a></p>\n\n<pre><code>int i[2];\nint sep[2];\nint cnt = sscanf(buf, \"%d%*1[ ]%n%d%n\", &amp;i[0], &amp;sep[0], &amp;i[1], &amp;sep[1]);\n\n// 2 int        leading space?     leading space?          \\0 ?\nif (cnt != 2 || isspace(buf[0]) || isspace(buf[sep[0]]) || buf[sep[1]]) { \n</code></pre>\n\n<hr>\n\n<p>Note: pedantic code would cast the <code>char</code> with <code>(unsigned char)</code> to handle negative <code>char</code> as <code>is...()</code> functions are defined for the <code>unsigned char</code> range and <code>EOF</code>.</p>\n\n<pre><code>isspace(buf[...]) --&gt; isspace((unsigned char) buf[...]) \n</code></pre>\n\n<h2>---</h2>\n\n<p>A more robust approach would call a helper function to assess the integer - which can be crafted per code's needs.  Using <code>strtol()</code> is a good starting point for define-ness and overflow detection.</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdlib.h&gt;\n\n// Return error status\nbool scan_int(const char **input, int *dest) {\n  errno = 0;\n  const char *s = *input;\n\n  if (isspace((unsigned char) *s) {\n    // reject leading space\n    return true;\n  }\n\n  char *endptr;\n  long num = strtol(s, &amp;endptr, 10);\n  if (s == endptr) {\n    // no conversion\n    return true;\n  }\n  *input = (const char *) endptr;\n  if (errno == ERANGE) {\n    // Overflow\n    return true;\n  }\n#if LONG_MAX &gt; INT_MAX  || LONG_MIN &lt; INT_MIN\n  if (num &gt; INT_MAX || num &lt; INT_MIN) {\n    errno = ERANGE;\n    // Overflow\n    return true;\n  }\n#endif\n  *dest = (int) num;\n  return false;\n}\n\n// Return error status - On success, return false\nbool sz_int_space_int(const char *input, int *dest) {\n  return scan_int(&amp;input, &amp;dest[0]) || *input++ != ' '\n      || scan_int(&amp;input, &amp;dest[1]) || *input;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502915565, "post_id": 45721275, "comment_id": 78403037, "body": "1st one is good and novel.  2nd one has minor issue (implementation-defined or an implementation-defined signal is raised)  of <code>some_int = some_long</code>."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502915940, "post_id": 45721275, "comment_id": 78403171, "body": "@chux: yes, a minor issue but correct. To avoid it, a simple implementation of <code>strtoi()</code> as a wrapper on <code>strtol()</code> with some extra tests would do the job. How do you like the third one?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502916277, "post_id": 45721275, "comment_id": 78403328, "body": "3rd one looks fully functionally correct to me too with its &quot;sscanf append %c, but fail to read  into it&quot; code."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1502916655, "last_edit_date": 1502916655, "creation_date": 1502910716, "answer_id": 45721275, "question_id": 45718718, "link": "https://stackoverflow.com/questions/45718718/sscanf-usage-in-very-specific-format/45721275#45721275", "title": "sscanf usage in very specific format", "body": "<p>If you only deal with positive integers without leading signs, here is a simpler solution:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint validate_string(const char *buf, int *int1, int *int2) {\n    size_t len1, len2;\n    /* return non 0 if and only if line has the correct format\n       and int1 and int2 contain the converted numbers */\n    return (len1 = strspn(buf, \"0123456789\")) &gt; 0\n    &amp;&amp;     buf[len1] == ' '\n    &amp;&amp;     (len2 = strspn(buf + len1 + 1, \"0123456789\")) &gt; 0\n    &amp;&amp;     buf[len1 + len2 + 1] == '\\0'\n    &amp;&amp;     sscanf(buf, \"%d%d\", int1, int2) == 2);\n}\n</code></pre>\n\n<p>Note however that this solution does not adequately test for potential overflow in the numeric conversions.</p>\n\n<p>Here is an alternative with <code>strtol()</code></p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n\nint parse_int(int *dest, const char *buf, char **pp)\nint validate_string(const char *buf, int *int1, int *int2) {\n    char *p1, *p2;\n    return !isspace((unsigned char)*buf)\n    &amp;&amp;     ((*int1 = strtol(buf, &amp;p1, 10)), p1 &gt; buf)\n    &amp;&amp;     *p1++ == ' '\n    &amp;&amp;     !isspace((unsigned char)*p1)\n    &amp;&amp;     ((*int2 = strtol(p1, &amp;p2, 10)), p2 &gt; p1)\n    &amp;&amp;     *p2 == '\\0');\n}\n</code></pre>\n\n<p>Modified to avoid implementation defined behavior commmented by chux:</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stdlib.h&gt;\n\nint parse_int(int *dest, const char *buf, char **pp) {\n    long val;\n    if (isspace((unsigned char)*buf)\n        return 0;\n    val = strtol(buf, pp, 10);\n    if (*pp &lt;= buf)\n        return 0;\n    if (val &lt; INT_MIN) {\n        val = INT_MIN;\n        errno = ERANGE;\n    } else\n    if (val &gt; INT_MAX) {\n        val = INT_MAX;\n        errno = ERANGE;\n    }\n    *dest = (int)val;\n    return 1;\n}\n\nint validate_string(const char *buf, int *int1, int *int2) {\n    char *p1, *p2;\n    return parse_int(int1, buf, &amp;p1)\n    &amp;&amp;     *p1++ == ' '\n    &amp;&amp;     parse_int(int2, p1, &amp;p2)\n    &amp;&amp;     *p2 == '\\0');\n}\n</code></pre>\n\n<p>Here is one with just a single <code>scanf()</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint validate_string(const char *buf, int *int1, int *int2) {\n    int p1, p2, p3;\n    char c;\n    return sscanf(buf, \" %n%d%1*[ ]%n %n%d%c\", &amp;p1, int1, &amp;p2, &amp;p3, int2, &amp;c) == 2\n        &amp;&amp; p1 == 0 &amp;&amp; p2 == p3;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8473648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b996a20092c7b888640c0174ff0b941d?s=128&d=identicon&r=PG&f=1", "display_name": "Sizzler", "link": "https://stackoverflow.com/users/8473648/sizzler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 45718850, "answer_count": 2, "score": 2, "last_activity_date": 1502916655, "creation_date": 1502900881, "question_id": 45718718, "link": "https://stackoverflow.com/questions/45718718/sscanf-usage-in-very-specific-format", "title": "sscanf usage in very specific format", "body": "<p>I'm trying to use sscanf with a string that is exactly in the following format:</p>\n\n<blockquote>\n  <p>integer1 integer2</p>\n</blockquote>\n\n<p>so that i can store int1 and int2 into an array</p>\n\n<p>I want sscanf to check if only two numbers are entered separated by only ONE space, with no leading or trailing whitespace at all.\nExamples of what should and shouldn't work:</p>\n\n<p>Should</p>\n\n<pre><code>4 7\n</code></pre>\n\n<p>Shouldn't</p>\n\n<pre><code>   4 7\n4 7[WHITESPACE] \n4    7\n4 7a\n</code></pre>\n\n<p>I've been trying to use it in the following way</p>\n\n<pre><code>sscanf(str,\"%d %d\",&amp;value1,&amp;value2);\n\nif (*STRING CONTAINS INVALID CHARACTERS OR WHITESPACE*){\n    exit from parent function }\n</code></pre>\n"}, {"tags": ["c", "file", "pointers"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1502900776, "post_id": 45718627, "comment_id": 78395508, "body": "Try using <code>fgets()</code> to fetch lines of input, and <code>sscanf()</code> to parse the input."}], "answers": [{"comments": [{"owner": {"reputation": 122, "user_id": 5616674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHTcw.jpg?s=128&g=1", "display_name": "Manoz Biswas", "link": "https://stackoverflow.com/users/5616674/manoz-biswas"}, "edited": false, "score": 0, "creation_date": 1502903562, "post_id": 45719208, "comment_id": 78397073, "body": "Thank you very much"}], "tags": [], "owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "is_accepted": true, "score": 1, "last_activity_date": 1502902758, "creation_date": 1502902758, "answer_id": 45719208, "question_id": 45718627, "link": "https://stackoverflow.com/questions/45718627/how-to-read-the-list-of-number-in-c/45719208#45719208", "title": "How to read the list of number in c", "body": "<p>Please try if the following program can help you. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct product {\n    char name[30];\n    int qty;\n    float price;\n};\n\nint main(void) {\n    int count = 0;\n    char line[100];\n    FILE *fptr;\n    fptr = fopen(\"file.txt\", \"r\");\n    fscanf(fptr, \"%d\", &amp;count); // count = 3\n    struct product *p = malloc(sizeof(struct product));\n    int i = 0;\n    double sum = 0;\n    while (i &lt; count + 2 &amp;&amp; fgets(line, sizeof(line), fptr) != NULL) {\n        if (i &gt; 1) {\n            sscanf(line, \"%s %d %f\\n\", (*p).name, &amp;(*p).qty, &amp;(*p).price);\n            sum = sum + (*p).price;\n        }\n        i++;\n    }\n    printf(\"sum: %f\\n\", sum);\n    free(p);\n    return 0;\n}\n</code></pre>\n\n<p>Test</p>\n\n<pre><code>$ gcc main.c                                                                   \n$ ./a.out                                                                      \nsum: 60.000000\n$ \n</code></pre>\n"}], "owner": {"reputation": 122, "user_id": 5616674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHTcw.jpg?s=128&g=1", "display_name": "Manoz Biswas", "link": "https://stackoverflow.com/users/5616674/manoz-biswas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 2, "closed_date": 1503004858, "accepted_answer_id": 45719208, "answer_count": 1, "score": -4, "last_activity_date": 1502902758, "creation_date": 1502900546, "last_edit_date": 1502901096, "question_id": 45718627, "link": "https://stackoverflow.com/questions/45718627/how-to-read-the-list-of-number-in-c", "closed_reason": "Needs more focus", "title": "How to read the list of number in c", "body": "<p>I have a file which includes product name, product quantity and product price in the following format. </p>\n\n<pre><code>file.txt\n\n3\nProduct   Qty  Price\nTv        2    10\nMobile    3    20\nComputer  5    30\n</code></pre>\n\n<p>I want to read the number of products from the integer (such as 3) given above the product list and count the total price of the products. The program will use struct to read the product details such as</p>\n\n<pre><code>struct product {         \n    Char name[30];\n    int qty ;\n    float price;        \n} \n</code></pre>\n\n<p>What are the best practices to make this program easier?</p>\n"}, {"tags": ["c", "gcc", "c99"], "comments": [{"owner": {"reputation": 684, "user_id": 4970667, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FWd3x.jpg?s=128&g=1", "display_name": "Quentin", "link": "https://stackoverflow.com/users/4970667/quentin"}, "edited": false, "score": 0, "creation_date": 1502898964, "post_id": 45718136, "comment_id": 78394386, "body": "What are you trying to do with <code>{}</code> ? Initialize the content of <code>data</code> ?"}, {"owner": {"reputation": 381, "user_id": 3392696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/964e6436abb523ab1d902c5ec768e665?s=128&d=identicon&r=PG&f=1", "display_name": "Tic", "link": "https://stackoverflow.com/users/3392696/tic"}, "reply_to_user": {"reputation": 684, "user_id": 4970667, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FWd3x.jpg?s=128&g=1", "display_name": "Quentin", "link": "https://stackoverflow.com/users/4970667/quentin"}, "edited": false, "score": 0, "creation_date": 1502967923, "post_id": 45718136, "comment_id": 78424450, "body": "Yes (like { 0 } which is valid C). The problem is that the team uses C++ / C on a daily basis and it is easy for someone to use this without thinking (even if in C++, this would be struct X data {};)"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1502899772, "last_edit_date": 1592644375, "creation_date": 1502899081, "answer_id": 45718189, "question_id": 45718136, "link": "https://stackoverflow.com/questions/45718136/how-can-i-specify-to-gcc-that-init-in-c-shouldnt-compile/45718189#45718189", "title": "How can I specify to gcc that {} init in C shouldn&#39;t compile?", "body": "<p>No, the empty initializer is not standard C. It is a gcc extension. <a href=\"https://stackoverflow.com/a/41889559/2173917\">See this</a> for a detailed description.</p>\n<p>By specifying <code>-std=gnu99</code>, you allowed the GNU extensions to be used. You can force the compiler to only allow the standard conforming code, by specifying <code>-std=cXX</code> option.</p>\n<p>From the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/C-Dialect-Options.html#C-Dialect-Options\" rel=\"nofollow noreferrer\">gcc online manual</a> (<em>emphasis mine</em>)</p>\n<blockquote>\n<p><code>-std=</code></p>\n<p>The compiler can accept several base standards, such as \u2018c90\u2019 or \u2018c++98\u2019, and GNU dialects of those standards, such as \u2018gnu90\u2019 or \u2018gnu++98\u2019. <strong>When a base standard is specified, the compiler accepts all programs following that standard plus those using GNU extensions that do not contradict it.</strong> For example, -std=c90 turns off certain features of GCC that are incompatible with ISO C90, such as the asm and typeof keywords, but not other GNU extensions that do not have a meaning in ISO C90, such as omitting the middle term of a ?: expression. On the other hand, <strong>when a GNU dialect of a standard is specified, all features supported by the compiler are enabled, even when those features change the meaning of the base standard.</strong> As a result, some strict-conforming programs may be rejected. The particular standard is used by -Wpedantic to identify which features are GNU extensions given that version of the standard. For example -std=gnu90 -Wpedantic warns about C++ style \u2018//\u2019 comments, while -std=gnu99 -Wpedantic does not.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1502899109, "creation_date": 1502899109, "answer_id": 45718201, "question_id": 45718136, "link": "https://stackoverflow.com/questions/45718136/how-can-i-specify-to-gcc-that-init-in-c-shouldnt-compile/45718201#45718201", "title": "How can I specify to gcc that {} init in C shouldn&#39;t compile?", "body": "<p>The <code>-pedantic</code> option will cause a warning to be displayed in this case, and <code>-Werror</code> will cause all warnings to be treated as errors.</p>\n\n<p>For example:</p>\n\n<pre><code>x1.c: In function \u2018f\u2019:\nx1.c:11:19: error: ISO C forbids empty initializer braces [-Werror=pedantic]\n   struct X data = {};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502956340, "post_id": 45718594, "comment_id": 78416462, "body": "That being said, gcc compiling with <code>-std=c11 -pedantic-errors</code> is probably the most strictly conforming C compiler ever made."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 3, "last_activity_date": 1502900421, "last_edit_date": 1592644375, "creation_date": 1502900421, "answer_id": 45718594, "question_id": 45718136, "link": "https://stackoverflow.com/questions/45718136/how-can-i-specify-to-gcc-that-init-in-c-shouldnt-compile/45718594#45718594", "title": "How can I specify to gcc that {} init in C shouldn&#39;t compile?", "body": "<p>If you want to reject code containing GNU-specific extensions, use <code>-std=c99 -pedantic-errors</code> (<code>-pedantic</code> will issue diagnostics for non-standard extensions, but it won't necessarily reject the code outright).  However, if you want to guarantee ISO conformance, be aware that this isn't a 100% solution.  From the <code>gcc</code> man page:</p>\n<blockquote>\n<p>Some users try to use <code>-pedantic</code> to check programs for strict ISO C conformance.  They soon find that it does not do quite what they want: it finds some non-ISO practices, but not all---only those for which ISO C requires a diagnostic, and some others for which diagnostics have been added.</p>\n<p>A feature to report any failure to conform to ISO C might be useful in some instances, but would require considerable additional work and would be quite different from <code>-pedantic</code>.  We don't have plans to support such a feature in the near future.</p>\n</blockquote>\n"}], "owner": {"reputation": 381, "user_id": 3392696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/964e6436abb523ab1d902c5ec768e665?s=128&d=identicon&r=PG&f=1", "display_name": "Tic", "link": "https://stackoverflow.com/users/3392696/tic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 45718594, "answer_count": 3, "score": 0, "last_activity_date": 1502900421, "creation_date": 1502898862, "last_edit_date": 1502899703, "question_id": 45718136, "link": "https://stackoverflow.com/questions/45718136/how-can-i-specify-to-gcc-that-init-in-c-shouldnt-compile", "title": "How can I specify to gcc that {} init in C shouldn&#39;t compile?", "body": "<p>with gcc using <code>-std=gnu99</code>, the following code compiles:</p>\n\n<pre><code>void f()\n{\n  struct X data = {};\n  // do something with data\n}\n</code></pre>\n\n<p>Is this valid C ?\nIs this a gnu extension ?</p>\n\n<p>How can I tell gcc to not accept this kind of init ?</p>\n\n<p>I want to ensure compatibility with other compilers (like visual 2015 for example)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "edited": false, "score": 0, "creation_date": 1502897886, "post_id": 45717653, "comment_id": 78393591, "body": "Really, are you implementing oscillator?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502897997, "post_id": 45717653, "comment_id": 78393686, "body": "Call it &quot;timer&quot; or something... it is not an &quot;oscillator&quot; for sure."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502898414, "post_id": 45717653, "comment_id": 78394002, "body": "Other than that - it is unclear (at least to me) what is the intended use and what is the problem. Can you demonstrate with a code example?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502903564, "post_id": 45717653, "comment_id": 78397075, "body": "is it a Raspberry PI? If it is you have to patch the kernel with the RT patch first. If not and it is an RTOS project on uC - just use hardware timer interrupt."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502903872, "post_id": 45717653, "comment_id": 78397267, "body": "@Eugene Sh. it is. He toggles something with  <code>NegLogicSignal(output);</code> So it is some kind of oscillator"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502903921, "post_id": 45717653, "comment_id": 78397298, "body": "Um.. OK. I am convinced."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502915013, "post_id": 45717653, "comment_id": 78402793, "body": "The division in <code>((p-&gt;period)&#47;(2*p-&gt;T))</code> can be expensive in time.  If members are integers, a non-division solution is possible.  Best to post enough code that allows <code>void OSC()</code> to compile.  Shows how it is called too to add even more clarity."}, {"owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "edited": false, "score": 0, "creation_date": 1502927121, "post_id": 45717653, "comment_id": 78406863, "body": "Do you have a time interrupt in your system which can be used? That is the timer fires X times every p-&gt;period invoking appropriate interrupt handler which would go through a list of osc object and setting output signal for those whose time has come."}], "answers": [{"comments": [{"owner": {"reputation": 569, "user_id": 6006544, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/dd1ce8be57e814c5564600bcfc5786e3?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6006544/steve"}, "edited": false, "score": 0, "creation_date": 1502912563, "post_id": 45721144, "comment_id": 78401610, "body": "Thank you for your reaction ChrisB. I have been using the oscillator for LEDs blinking and similar stuff. I think it is task with soft deadline. I would like to save the Timer/Counter peripheral for stuff which needs more precise timing for example the modulator."}, {"owner": {"reputation": 569, "user_id": 6006544, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/dd1ce8be57e814c5564600bcfc5786e3?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6006544/steve"}, "edited": false, "score": 0, "creation_date": 1502913154, "post_id": 45721144, "comment_id": 78401871, "body": "I would like to have similar timing precision and flexibility like with the Timer/Counter peripheral but in software and ability to have several independent oscillator instances."}, {"owner": {"reputation": 488, "user_id": 1894697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e31e63c623c67fad9d407a84729c725?s=128&d=identicon&r=PG", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/1894697/chrisb"}, "reply_to_user": {"reputation": 569, "user_id": 6006544, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/dd1ce8be57e814c5564600bcfc5786e3?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6006544/steve"}, "edited": false, "score": 0, "creation_date": 1502923836, "post_id": 45721144, "comment_id": 78406077, "body": "What if you create a task with execution period 10ms which toggles the LED once ever 25 executions? So all of your tasks have appropriate execution period."}, {"owner": {"reputation": 569, "user_id": 6006544, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/dd1ce8be57e814c5564600bcfc5786e3?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6006544/steve"}, "edited": false, "score": 0, "creation_date": 1503039325, "post_id": 45721144, "comment_id": 78457812, "body": "I have maybe found a solution (please see the original post) but as soon as I have programmed this idea I have found it isn&#39;t functional. I have been struggling why."}], "tags": [], "owner": {"reputation": 488, "user_id": 1894697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e31e63c623c67fad9d407a84729c725?s=128&d=identicon&r=PG", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/1894697/chrisb"}, "is_accepted": false, "score": 0, "last_activity_date": 1502910522, "last_edit_date": 1502910522, "creation_date": 1502910221, "answer_id": 45721144, "question_id": 45717653, "link": "https://stackoverflow.com/questions/45717653/software-implementation-of-an-oscillator-in-c/45721144#45721144", "title": "Software implementation of an oscillator in C", "body": "<p>Threads of RTOS are very useful when you perform tasks with soft deadline. Soft deadline means that if the execution delays the system will not fail. In your case, the oscillator has a hard deadline e.g. if the duty cycle of PWM is not precise and stable the motor will not be having the desirable constant angular velocity. In this case you have to use the available Timer/Counter peripheral of the MCU. </p>\n\n<p>You can set a timer to interrupt the CPU on a given interval and toggle the output in the ISR (Interrupt Service Routine). Using this approach the load of time-counting is moved from the CPU to the timer peripheral, allowing both precise oscillating output and smooth execution of other tasks.</p>\n\n<p>You do not make clear which RTOS or MCU/CPU you are using, but all of them have timer/counter peripherals. If not supported directly from the RTOS, look in the CPU vendor datasheet.</p>\n"}], "owner": {"reputation": 569, "user_id": 6006544, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/dd1ce8be57e814c5564600bcfc5786e3?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6006544/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1503036350, "creation_date": 1502897514, "last_edit_date": 1503036350, "question_id": 45717653, "link": "https://stackoverflow.com/questions/45717653/software-implementation-of-an-oscillator-in-c", "title": "Software implementation of an oscillator in C", "body": "<p>I have been developing a control software in C language. I have decided to spent\nsome time with development general function blocks usable in other programs which I will develop in future (some type of library). My software is divided into two main parts from application point of view. One part is the <em>control part</em> \n(PI controller, modulator, phase locked loop etc.) and the second one is <em>logic \npart</em> (finite state machine of the application etc.). The logic part works with logic signals. These signals are procesed by software implementation of logic gates and flip-flops. My goal is to also implement some software version of an oscillator. I mean some function block which is able to produce oscillations between 0 and 1 with prescribed period and duty cycle at its output. In principle I can have several such oscillators in one program. So I have\ndecided to implement the oscillator in following manner. The oscillations production is done by a function and each instance of the oscillator is implemented by an instance of previously defined structure. The structure contains as main items the <em>oscillations period</em>, <em>duty cycle</em> and <em>oscillator execution period</em> i.e. execution period of the RTOS task in which the instance of the oscillator is placed. Based on the oscillations period and task execution period produces the oscillator function the oscillations</p>\n\n<pre><code>void OSC(uint32_t output, Osc_t *p){\n\n    // p-&gt;T is the task execution period in ms\n    // p-&gt;period is the desired oscillations period in ms\n    // p-&gt;counter is the internal state of the oscillator\n    p-&gt;delay_count = (uint16_t)((p-&gt;period)/(2*p-&gt;T));\n\n    if(++(p-&gt;counter) &gt;= p-&gt;delay_count){\n        p-&gt;counter = 0;\n        NegLogicSignal(output);\n    }\n}   \n</code></pre>\n\n<p>}</p>\n\n<p>Below is the structure which contains the state of individual oscillator instances</p>\n\n<pre><code>typedef struct{\n float period;         // period of the oscillations (ms)\n float T;              // function execution period (ms)\n uint16_t counter;     // initial number of execution periods\n uint16_t delay_count; // number of execution periods corresponding to half \n                       // period\n}Osc_t;\n</code></pre>\n\n<p>and the usage of oscillator function is following</p>\n\n<pre><code>Debug_LED_Oscillator_state.T = 1;        // T = 1 ms\nDebug_LED_Oscillator_state.period = 500; // period 0.5 s = 500 ms\nOSC(LDbgLedOsc, &amp;Debug_LED_Oscillator_state);\n</code></pre>\n\n<p>My problem is that I had to place one of my oscillators in the fastest task (task with execution period 1 ms) \nbecause I wasn't able to achieve the period 500 ms (half period 250 ms) in another tasks because the rest of my tasks have inapproprite execution periods for 500 ms (20 ms and 100 ms i.e. 250/20 = 12.5 - not an integer value and 250/100 = 2.5 - also not an integer value). The problem is that I have the rest of application logic in another task. </p>\n\n<p>The intended use is to produce logic signal for LEDs blinking pattern. The problem is that I had to move the oscillator to logically different task only because I am not able to achieve desired timing accuracy in the logicaly appropriate task (because of non integer values of the quotient half_period/execution_period). I am thinking about different implementation which enables place the oscillator to logicaly appropriate task and achieve the desired timing accuracy. </p>\n\n<p>I have thought following solution. I will define set of global variables (uint16_t Timer_1ms, uint16_t Timer_5ms etc.). These global variables will be incremented in highest priority task (in my case Task_1ms). I will redefine OSC function</p>\n\n<pre><code>void OSC(uint32_t output, Osc_t *p){\n\nfloat act_time;\n\ntaskENTER_CRITICAL();\n\n    switch(p-&gt;timer_type){\n\n        case TMR_1MS:\n            act_time = Timer_1ms;\n        break;\n\n        case TMR_5MS:\n            act_time = Timer_5ms;\n        break;\n\n    }\n\ntaskEXIT_CRITICAL();\n\n\nif(p-&gt;init){\n\n    SetLogicSignal(output);\n\n    switch(p-&gt;timer_type){\n\n        case TMR_1MS:\n            p-&gt;delta = ((p-&gt;period)/(2*1*p-&gt;T));\n        break;\n\n        case TMR_5MS:\n            p-&gt;delta = ((p-&gt;period)/(2*5*p-&gt;T));\n        break;\n\n    }\n\n    p-&gt;stop_time = (act_time + p-&gt;delta);\n    p-&gt;init  = FALSE;\n\n}\n\nif(act_time &gt;= (p-&gt;stop_time)){\n\n    NegLogicSignal(output);\n    p-&gt;stop_time = (act_time + p-&gt;delta);\n\n}\n</code></pre>\n\n<p>}</p>\n\n<p>and oscillator structure</p>\n\n<pre><code>// oscillator state \ntypedef struct{\n  float   period;      // period of the oscillations (ms)\n  float   T;           // function execution period (ms)           \n  float   delta;       // half_period in timer counts   \n  float   stop_time;   // timer counts when to negate the output\n  BOOL    init;        // force initialization of the timer\n  timer_e timer_type; \n}Osc_t;\n</code></pre>\n\n<p>I have tried this solution and it seems to be not functional. Does anybody have an idea why? Thanks in advance for any sugestions.</p>\n"}, {"tags": ["android", "c", "sendto"], "comments": [{"owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "edited": false, "score": 0, "creation_date": 1503003912, "post_id": 45717623, "comment_id": 78447272, "body": "This could be a bug in the network driver. What driver and kernel version are you using?"}, {"owner": {"reputation": 766, "user_id": 308131, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/295984787ed9f045fedc7b277c2020ae?s=128&d=identicon&r=PG", "display_name": "webgenius", "link": "https://stackoverflow.com/users/308131/webgenius"}, "reply_to_user": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "edited": false, "score": 0, "creation_date": 1503919512, "post_id": 45717623, "comment_id": 78794038, "body": "driver - Broadcom WLAN driver, Kernel version - 4.1.15"}], "owner": {"reputation": 766, "user_id": 308131, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/295984787ed9f045fedc7b277c2020ae?s=128&d=identicon&r=PG", "display_name": "webgenius", "link": "https://stackoverflow.com/users/308131/webgenius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502897402, "creation_date": 1502897402, "question_id": 45717623, "link": "https://stackoverflow.com/questions/45717623/sendto-system-call-returning-with-einval", "title": "sendto system call returning with EINVAL", "body": "<p>I'm making an executable in Android. This will be used for sending ARP packets, but the sendto command is failing with EINVAL.\nThe same piece of code is working on ARM, but failing on Cortex A9.\n Here is the code snippet:</p>\n\n<pre><code>int sendArp( const char *iface, const char *src_ip, const char * trgt_ip)\n{\n    int  status, frame_length, bytes;\n    arp_hdr arphdr;\n    uint8_t src_mac[6] ={0};\n    uint8_t dst_mac[6] ={0};\n    uint8_t ether_frame[ARP_LEN] = {0};\n    struct addrinfo hints, *res;\n    struct sockaddr_in *ipv4;\n    struct sockaddr_ll send_struct;\n    struct ifreq ifr;\n    int sd =-1;\n    int recValue = -1;\n    pthread_t thread;\n\n    if(iface == NULL || src_ip == NULL || trgt_ip == NULL)\n        return -1;\n\n    if ((sd = socket (PF_PACKET, SOCK_RAW, htons (ETH_P_ALL))) &lt; 0) {\n        ALOG (\"socket() failed \");\n        goto out;\n    }\n    memset (&amp;ifr, 0, sizeof (ifr));\n    snprintf (ifr.ifr_name, sizeof (ifr.ifr_name), \"%s\", iface);\n    if (ioctl (sd, SIOCGIFHWADDR, &amp;ifr) &lt; 0) {\n        ALOG (\"ioctl() failed to get source MAC address \");\n        goto out;\n    }\n\n    // Copy source MAC address.\n    memcpy (src_mac, ifr.ifr_hwaddr.sa_data, 6 * sizeof (uint8_t));\n\n    memset (&amp;send_struct, 0, sizeof (send_struct));\n    if ((send_struct.sll_ifindex = if_nametoindex (iface)) == 0) {\n        ALOG (\"if_nametoindex() failed to obtain iface index \");\n        goto out;\n    }\n\n    memset (dst_mac, 0xff, 6 * sizeof (uint8_t));\n\n    ALOG (\"Iface '%s' index='%i', src=%s : dest=%s\\n\", iface, send_struct.sll_ifindex, src_ip, trgt_ip);\n\n    memset (&amp;hints, 0, sizeof (struct addrinfo));\n    hints.ai_family = AF_INET;\n    hints.ai_socktype = SOCK_STREAM;\n    hints.ai_flags = hints.ai_flags | AI_CANONNAME;\n\n    if ((status = inet_pton (AF_INET, src_ip, &amp;arphdr.sender_ip)) != 1) {\n        fprintf (stderr, \"inet_pton() failed for source IP address.\\nError message: %s\", strerror (status));\n        goto out;\n    }\n\n    if ((status = getaddrinfo (trgt_ip, NULL, &amp;hints, &amp;res)) != 0) {\n        fprintf (stderr, \"getaddrinfo() failed - %s\\n\", strerror (status));\n        goto out;\n    }\n    ipv4 = (struct sockaddr_in *) res-&gt;ai_addr;\n    memcpy (&amp;arphdr.target_ip, &amp;ipv4-&gt;sin_addr, 4 * sizeof (uint8_t));\n    freeaddrinfo (res);\n\n    send_struct.sll_family = AF_PACKET;\n    send_struct.sll_protocol = htons(ETH_P_ARP);\n    send_struct.sll_hatype = htons(ARPHRD_ETHER);\n    send_struct.sll_pkttype = (PACKET_BROADCAST);\n    memcpy (send_struct.sll_addr, src_mac, 6 * sizeof (uint8_t));\n    send_struct.sll_halen = 6;\n    send_struct.sll_addr[6] = 0x00;\n    send_struct.sll_addr[7] = 0x00;\n\n    arphdr.htype = htons (1);\n    arphdr.ptype = htons (ETH_P_IP);\n    arphdr.hlen = 6;\n    arphdr.plen = 4;\n\n    arphdr.opcode = htons (ARPOP_REQUEST);\n\n    memcpy (&amp;arphdr.sender_mac, src_mac, 6 * sizeof (uint8_t));\n    memset (&amp;arphdr.target_mac, 0, 6 * sizeof (uint8_t));\n    frame_length = 6 + 6 + 2 + ARP_HDRLEN;\n\n    memcpy (ether_frame, dst_mac, 6 * sizeof (uint8_t));\n    memcpy (ether_frame + 6, src_mac, 6 * sizeof (uint8_t));\n\n    ether_frame[12] = ETH_P_ARP / 256;\n    ether_frame[13] = ETH_P_ARP % 256;\n\n    memcpy (ether_frame + ETH_HDRLEN, &amp;arphdr, ARP_HDRLEN * sizeof (uint8_t));\n\n    // Send ethernet frame to socket.\n    if ((bytes = sendto (sd, ether_frame, frame_length, 0, (struct sockaddr *) &amp;send_struct, sizeof (send_struct))) &lt;= 0) {\n        ALOG (\"sendto() failed: error=%s\", strerror(errno));\n        goto out;\n    }\n    ALOG(\"ARP sent, bytes[%d]\", bytes);\n\n   recValue = arpRecv(sd, (uint8_t*)arphdr.target_ip);\n   ALOG(\"main::thread_ret=%d\", recValue);\nout:\n    if(sd){\n        shutdown(sd,2);\n        close(sd);\n    }\n    return recValue;\n}\n\nint main(int argc, const char **argv) {\n    return sendArp(\"wlan0\", \"10.10.10.10\", \"20.20.20.20\");\n}\n</code></pre>\n\n<p>From the code snippet, I'm getting the error:</p>\n\n<pre><code>sendto() failed\n</code></pre>\n\n<p>The Kernel error I'm seeing is:</p>\n\n<pre><code>packet size is too short (42 &lt;= 62)\n</code></pre>\n\n<p>I have tried modifying socket flags and played around the code a lot, but couldn't figure out the root cause. Any help is greatly appreciated.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "spi"], "comments": [{"owner": {"reputation": 23, "user_id": 5837216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdc57c0232ce32a561d0f5e7c5e8234?s=128&d=identicon&r=PG&f=1", "display_name": "Guido Claessen", "link": "https://stackoverflow.com/users/5837216/guido-claessen"}, "edited": false, "score": 1, "creation_date": 1502972462, "post_id": 45717462, "comment_id": 78427550, "body": "So I came to learn that the Slave select can only be held LOW for a certain time before it automatically goes back to HIGH because of a time out standard of the SPI protocol. This causes the Slave Select to only stay low for a very short time (uS). This is too fast to see any effect on an LED, it just appears lit constantly. After i obtained an oscilloscope it became clear. So the code works :D"}], "owner": {"reputation": 23, "user_id": 5837216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdc57c0232ce32a561d0f5e7c5e8234?s=128&d=identicon&r=PG&f=1", "display_name": "Guido Claessen", "link": "https://stackoverflow.com/users/5837216/guido-claessen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 657, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502896966, "creation_date": 1502896966, "question_id": 45717462, "link": "https://stackoverflow.com/questions/45717462/smartfusion2-mss-spi-communication", "title": "Smartfusion2 MSS SPI communication", "body": "<p>I am working with the Microsemi Smartfusion2 development kit from Arrow. It uses the Smartfusion2 M2S010-FG484 FPGA. (<a href=\"https://www.arrow.com/en/products/sf2plus-dev-kit/arrow-development-tools\" rel=\"nofollow noreferrer\">https://www.arrow.com/en/products/sf2plus-dev-kit/arrow-development-tools</a>)</p>\n\n<p>I am new to the Smartfusion2, I am trying to establish a connection between the Smartfusion2 FPGA and Arduino using the microcontroller subsystem (MSS) and programing ti in Softconsole. The problem is that I can't seem to get it to work. While trying to debug, I attached an LED (i had to improvise since I don't have an oscilloscope) to pin 3 of the arduino connector (J2) on the development board. This pin should contain the slave select 3 (pin J18 on the FPGA) as indicated in the datasheet on page 16 (<a href=\"https://static4.arrow.com/-/media/images/part-detail-pages/sf2-plus/new-sf2-files/sf2plus_user_guide_v1p1.pdf?la=zh-cn\" rel=\"nofollow noreferrer\">https://static4.arrow.com/-/media/images/part-detail-pages/sf2-plus/new-sf2-files/sf2plus_user_guide_v1p1.pdf?la=zh-cn</a>) and in the I/O editor of Libero SoC.</p>\n\n<p>With the following code I am trying to toggle the LED/Select and deselect the specified slave (Slave 3). But nothing happens. The Slave select is active low but the LED is always on and never turns off.</p>\n\n<pre><code>    /*\n * main.c\n *\n *  Created on: Aug 16, 2017\n */\n\n#include \"drivers/mss_gpio/mss_gpio.h\"\n#include \"drivers/mss_spi/mss_spi.h\"\n#include &lt;stdio.h&gt;\n\n/*Delay function in milliseconds, for 100MHz clock*/\nvoid Delay(uint32_t Delayms){\n    uint32_t i = 0;\n    uint32_t DelayValue = Delayms*2000; //1000ms*100000 = 100000000 (100MHz)\n    for(i = 0; i &lt;= DelayValue; i++){\n    }\n}\n\n/*Configuration for SPI0*/\nvoid ConfigSPI1(void){\n    /*Initialize and Configure SPI1*/\n    MSS_SPI_init(&amp;g_mss_spi1);\n\n    MSS_SPI_disable(&amp;g_mss_spi1); //Disable SPI1\n\n    /*Configure SPI1 as master, protocol mode, clk speed, frame size*/\n    MSS_SPI_configure_master_mode(\n            &amp;g_mss_spi1,        //Selects SPI1 for configuration\n            MSS_SPI_SLAVE_3,    //Set the target device as slave 3\n            MSS_SPI_MODE2,      //Serial peripheral interface operating mode\n            64u,                //Divider used on APB bus (PCLK) clock in order to generate the SPI clock\n            12);                //Number of bits making up the frame, max = 32\n\n    MSS_SPI_enable(&amp;g_mss_spi1); //Enable SPI1\n}\n\n/*SPI0 test function*/\nvoid SPI1Test(void){\n    MSS_SPI_set_slave_select(&amp;g_mss_spi1, MSS_SPI_SLAVE_3);     //Used by a MSS SPI master to select a specific slave\n    MSS_SPI_transfer_frame(&amp;g_mss_spi1, 0xaaa);                 //Transfers \"0xaaa\" to the selected slave (slave 3)\n    Delay(1000);      // I used this delay for testing, to keep the SS low for a longer time to be able to see the LED turn off\n    MSS_SPI_clear_slave_select(&amp;g_mss_spi1, MSS_SPI_SLAVE_3);   //Used by a MSS SPI master to deselect a specific slave\n}\n\nint main(){\n\n    /*Configure modules*/\n    ConfigSPI1();\n\n    /*Infinite loop*/\n    for(;;){\n        SPI1Test();\n        Delay(3000);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Does anyone see a mistake in my code that might be causing the problem? or maybe have an working example code for me?</p>\n\n<p>I wrote another program to toggle pin J18/the slave select 3 pin with the gpio driver, and that worked, it toggled the LED. I am also pretty certain that the design in Libero SoC is correct and imported correctly.</p>\n\n<p>Thank you for your time!</p>\n"}, {"tags": ["c", "contiki"], "answers": [{"tags": [], "owner": {"reputation": 6567, "user_id": 2435820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J6uQT.png?s=128&g=1", "display_name": "kfx", "link": "https://stackoverflow.com/users/2435820/kfx"}, "is_accepted": true, "score": 1, "last_activity_date": 1502914316, "creation_date": 1502914316, "answer_id": 45722212, "question_id": 45717362, "link": "https://stackoverflow.com/questions/45717362/contiki-difference-between-rtimer-now-and-clock-time/45722212#45722212", "title": "Contiki difference between RTIMER_NOW() and clock_time()", "body": "<p>The two functions:</p>\n\n<ul>\n<li><p><code>RTIMER_NOW()</code> - returns the uptime in real-time timer (<code>rtimer</code>) ticks modulo <code>rtimer</code> overflow value. For example, on a platforms where <code>RTIMER_ARCH_SECOND</code> is 32768 and the overflow happens every 2 seconds, the value will always be between 0 and 65535, inclusive.</p></li>\n<li><p><code>clock_time()</code> - returns the uptime in clock ticks. Unlike the rtimer ticks, these are monotonic (that is, always nondecreasing). By default there are 128 ticks per second (the constant <code>CLOCK_SECOND</code> defines this).</p></li>\n</ul>\n\n<p>Your other questions:</p>\n\n<ol>\n<li><p>Use <code>uint32_t</code>, then values will always fit in a 32-bit integer. Otherwise on platforms where <code>int</code> is 16 bits, values of type <code>rtimer_ticks_t</code> and/or <code>clock_time_t</code> might not fit in it.</p></li>\n<li><p>How do you possibly think that would work? What is the vaulue of \"simulation time\" when the code is executing on real nodes? The answer is no, the emulated nodes in Cooja have no idea about the \"simulation time\".</p></li>\n</ol>\n"}], "owner": {"reputation": 51, "user_id": 6093781, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/aAWDS.jpg?s=128&g=1", "display_name": "vrizz", "link": "https://stackoverflow.com/users/6093781/vrizz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1063, "favorite_count": 2, "accepted_answer_id": 45722212, "answer_count": 1, "score": 3, "last_activity_date": 1502914316, "creation_date": 1502896682, "question_id": 45717362, "link": "https://stackoverflow.com/questions/45717362/contiki-difference-between-rtimer-now-and-clock-time", "title": "Contiki difference between RTIMER_NOW() and clock_time()", "body": "<p>I would like to know the difference between </p>\n\n<pre><code>RTIMER_NOW() \n</code></pre>\n\n<p>and </p>\n\n<pre><code>clock_time() \n</code></pre>\n\n<p>function.</p>\n\n<ol>\n<li>Can I store the values they return in an int variable?</li>\n<li>Do they return the time referred to the whole simulation or to the single mote that call them? If a mote starts its main process 5 sec after the first event in the simulation, does these functions return the value of the simulation or the (value of simulation - 5 sec)?</li>\n</ol>\n\n<p>Thank you.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5703, "user_id": 4899193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b65fc5fb7ab727d1f770206d6b5325?s=128&d=identicon&r=PG", "display_name": "Usagi Miyamoto", "link": "https://stackoverflow.com/users/4899193/usagi-miyamoto"}, "edited": false, "score": 2, "creation_date": 1502895617, "post_id": 45716965, "comment_id": 78392008, "body": "Try <code>strcat()</code> instead of <code>strcpy()</code>..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502895699, "post_id": 45716965, "comment_id": 78392058, "body": "<code>malloc(size + argc);</code> should be <code>malloc(size + (argc - 1) + 1);</code> for the <code>argc-1</code> spaces characters and the 1 null character - but same end result.  Suggest change in comment."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502895738, "post_id": 45716965, "comment_id": 78392089, "body": "@chux I was thinking the exact same thing. Should it be mentioned in an answer? As you say, same end result...."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502895824, "post_id": 45716965, "comment_id": 78392161, "body": "@FelixPalmen It is that &quot;malloc size + argc for space characters&quot; mis-leads even though <code>size + argc</code> is the right size.  IAC, a minor  issue for OP."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 1, "creation_date": 1502895933, "post_id": 45716965, "comment_id": 78392226, "body": "Dont forget to <code>free</code> @zeudarius"}, {"owner": {"reputation": 112, "user_id": 8473241, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1857531534515163/picture?type=large", "display_name": "nextdarius", "link": "https://stackoverflow.com/users/8473241/nextdarius"}, "edited": false, "score": 0, "creation_date": 1502896101, "post_id": 45716965, "comment_id": 78392325, "body": "thanks so much. it works now. i&#39;m learning programming and i&#39;m not very good. i&#39;ll free the memory"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 2, "creation_date": 1502896365, "post_id": 45716965, "comment_id": 78392503, "body": "Do you have a problem with for loops?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502897002, "post_id": 45716965, "comment_id": 78392967, "body": "@zeudarius you <i>might</i> want to <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">accept an answer</a> (you don&#39;t have to, of course). This gives its author some reputation (and also a little to yourself), but, more importantly, helps future readers to know at a glance that the answer solved the problem."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 5, "last_activity_date": 1502895590, "creation_date": 1502895590, "answer_id": 45717028, "question_id": 45716965, "link": "https://stackoverflow.com/questions/45716965/concatenate-arguments-using-strcpy/45717028#45717028", "title": "Concatenate arguments using strcpy", "body": "<p><code>strcpy()</code> <strong>copies</strong> a string, as implied by the name. So each time you call it, you overwrite your existing string. You are looking for <code>strcat()</code>, which concatenates by searching the first <code>0</code> byte in the destination and copying there.</p>\n\n<p>You can just replace <code>strcpy()</code> by <code>strcat()</code> in your code if you initialize <code>concat[0] = 0;</code> first.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502896585, "post_id": 45717308, "comment_id": 78392647, "body": "I <b>could</b> see an advantage if you reuse the results from your previous calls to <code>strlen()</code> .. but the way you&#39;re doing it, it does the same as <code>strcat()</code> with just more lines of code."}, {"owner": {"reputation": 390, "user_id": 5301368, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Dxd9-hUEN0/AAAAAAAAAAI/AAAAAAAAClE/XEfCnbBtUxU/photo.jpg?sz=128", "display_name": "Trion", "link": "https://stackoverflow.com/users/5301368/trion"}, "edited": false, "score": 0, "creation_date": 1502896660, "post_id": 45717308, "comment_id": 78392713, "body": "I guessed that OP wants to use strcpy for some reason, so I used it. I agree strcat is what is needed here"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1502896820, "post_id": 45717308, "comment_id": 78392842, "body": "looks more likely they just weren&#39;t aware of strcat"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502899274, "post_id": 45717308, "comment_id": 78394595, "body": "@FelixPalmen (and Chris), The code here is carefully avoiding the quadratic behaviour of <code>strcat()</code> repeatedly scanning over the leading section of the string to find where the concatenation should occur.  This is  carefully crafted code.  It could be revised to use <code>memmove()</code> (or <code>memcpy()</code>) instead of <code>strcpy()</code>; then the length would be computed before the first copy operation in the loop. It might be tempting to create a VLA <code>size_t argl[argc];</code> and initialize the elements of that with the length of each argument in the first loop \u2014 saving recomputing the length in the concatenation ops."}, {"owner": {"reputation": 390, "user_id": 5301368, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Dxd9-hUEN0/AAAAAAAAAAI/AAAAAAAAClE/XEfCnbBtUxU/photo.jpg?sz=128", "display_name": "Trion", "link": "https://stackoverflow.com/users/5301368/trion"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502900987, "post_id": 45717308, "comment_id": 78395630, "body": "@JonathanLeffler :-) Revisited, now I use array to retrieve values. I&#39;ll keep the <code>strcpy()</code> for now as OP might want to use it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502904789, "post_id": 45717308, "comment_id": 78397793, "body": "@JonathanLeffler thanks for pointing this out! I expected exactly what you describe for an optimization (and was indeed thinking about adding something like this to my answer <i>bevore</i> this answer was written) .. but I completely missed the fact that this answer <i>already</i> saves on quite a lot of scanning. So leaving an upvote here for an optimized approach :)"}], "tags": [], "owner": {"reputation": 390, "user_id": 5301368, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Dxd9-hUEN0/AAAAAAAAAAI/AAAAAAAAClE/XEfCnbBtUxU/photo.jpg?sz=128", "display_name": "Trion", "link": "https://stackoverflow.com/users/5301368/trion"}, "is_accepted": false, "score": 2, "last_activity_date": 1502900862, "last_edit_date": 1502900862, "creation_date": 1502896497, "answer_id": 45717308, "question_id": 45716965, "link": "https://stackoverflow.com/questions/45716965/concatenate-arguments-using-strcpy/45717308#45717308", "title": "Concatenate arguments using strcpy", "body": "<p><strong>strcpy</strong> copies the source's characters into the pointer, as you always use the same address i.e. the start of that string, it keeps overwriting your old string.\nIt can work if you add an offset by the amount of characters already copied, this way you copy the string properly and get it concatenated</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nint main(int argc, char **argv)\n{\n    int kar = 1;\n    int size = 0;\n    char *concat;\n\n    size_t argl[argc];\n\n    //find size to malloc concat\n    while (kar &lt; argc)\n    {\n            unsigned int arglen = strlen(argv[kar]);\n            size += arglen;\n            argl[kar] = arglen; // Save the length\n            kar++;\n    }\n\n    //malloc size + argc for space characters\n    concat = malloc(size + argc + 1);\n    kar = 1;\n\n    unsigned int offset = 0;\n    while (kar &lt; argc)\n    {\n            strcpy(concat+offset,argv[kar]);\n            offset += argl[kar];  // Offset by the length\n            strcpy(concat+offset,\" \");\n            offset += 1;\n            kar++;\n    }\n    printf(\"%s\",concat);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502905393, "post_id": 45717360, "comment_id": 78398132, "body": "Your second invocation of <code>snprintf()</code> flawed.  You should capture the length from the first, add it to the destination, subtract it from the length.  It&#39;s important not to use user input as the &#39;format string&#39;; if the user includes <code>%d</code> \u2014 or worse, <code>%n</code> \u2014 in the string, life gets fraught.  You should use something like: <code>int offset = snprintf(destination, sizeof(destination), &quot;%s&quot;, source); offset = snprintf(destination+offset, sizeof(destination)-offset, &quot;%s&quot;, extra);</code> \u2014 assuming you can&#39;t simply do <code>snprintf(destination, sizeof(destination), &quot;%s%s&quot;, source, extra);</code> which is still simpler."}, {"owner": {"reputation": 11, "user_id": 8464271, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6f15318cf76fe3d94b8a542548bc544f?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/8464271/ryan"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502908247, "post_id": 45717360, "comment_id": 78399598, "body": "You are right. Thanks for catching that. That was me being lazy. Fixed."}], "tags": [], "owner": {"reputation": 11, "user_id": 8464271, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6f15318cf76fe3d94b8a542548bc544f?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/8464271/ryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1502908398, "last_edit_date": 1502908398, "creation_date": 1502896675, "answer_id": 45717360, "question_id": 45716965, "link": "https://stackoverflow.com/questions/45716965/concatenate-arguments-using-strcpy/45717360#45717360", "title": "Concatenate arguments using strcpy", "body": "<p>Consider using <code>snprintf()</code>; it will also work and is easier to use in some situations.</p>\n\n<p><code>snprintf(destination, buffer_size, source)</code> is basically a <code>strcpy</code>, and the return value tells you how many bytes were copied.</p>\n\n<p><code>snprintf(destination + strlen(destination), buffersize - strlen(destination), new string to add on)</code></p>\n\n<p>this does a concatenation but also allows you to insert variables using format <code>%d</code>, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1502897202, "creation_date": 1502897202, "answer_id": 45717549, "question_id": 45716965, "link": "https://stackoverflow.com/questions/45716965/concatenate-arguments-using-strcpy/45717549#45717549", "title": "Concatenate arguments using strcpy", "body": "<p>For starters you should include the header <code>&lt;stdlib.h&gt;</code> where the functions <code>malloc</code> and <code>free</code> are declared.</p>\n\n<p>In general <code>argc</code> can be equal to 0. So it is better explicitly to reserve one byte to the terminating zero instead of using the expression <code>size + argc</code>.</p>\n\n<p>The function <code>strcpy</code> overwrites the previous content of the target string. You should use the function only once when the first command line parameter is being copied. In all other cases you should use standard function <code>strcat</code>.</p>\n\n<p>Also you should free the allocated memory before exiting the program.</p>\n\n<p>The program can look the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main( int argc, char * argv[] )\n{\n    size_t n = 0;\n\n    for ( int i = 1; i &lt; argc; i++ ) n += strlen( argv[i] );\n\n    if ( argc &gt; 1 ) n += argc - 2;\n\n    ++n;\n\n    char *s = malloc( n );\n\n    s[0] = '\\0';\n\n    for ( int i = 1; i &lt; argc; i++ )\n    {\n        if ( i == 1 )\n        {\n            strcpy( s, argv[i] );\n        }            \n        else\n        {            \n            strcat( s, \" \" );\n            strcat( s, argv[i] );\n        }\n    }\n\n    puts( s );\n\n    free( s );\n\n    return 0;\n}\n</code></pre>\n\n<p>If to specify command line arguments like</p>\n\n<pre><code>first second third\n</code></pre>\n\n<p>then the output will be</p>\n\n<pre><code>first second third\n</code></pre>\n"}], "owner": {"reputation": 112, "user_id": 8473241, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1857531534515163/picture?type=large", "display_name": "nextdarius", "link": "https://stackoverflow.com/users/8473241/nextdarius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 45717028, "answer_count": 4, "score": 2, "last_activity_date": 1502908398, "creation_date": 1502895450, "question_id": 45716965, "link": "https://stackoverflow.com/questions/45716965/concatenate-arguments-using-strcpy", "title": "Concatenate arguments using strcpy", "body": "<p>I want to concatenate all my arguments into a char pointer using strcpy. I'm doing this but my output is only a space.</p>\n\n<p>I'm using 3 variables: '<strong>concat</strong>' ( which should be my output ) , '<strong>size</strong>' to get the length of all the arguments and '<strong>kar</strong>' which is my iterator for arguments.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nint main(int argc, char **argv)\n{\n    int kar;\n    int size;\n    char *concat;\n\n    kar = 1;\n    size = 0;\n    //find size to malloc concat\n    while (kar &lt; argc)\n    {\n            size = size + strlen(argv[kar]);\n            kar++;\n    }\n    //malloc size + argc for space characters\n    concat = malloc(size + argc);\n    kar = 1;\n    while (kar &lt; argc)\n    {\n            strcpy(concat,argv[kar]);\n            strcpy(concat,\" \");\n            kar++;\n    }\n    printf(\"%s\",concat);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1502894743, "post_id": 45716669, "comment_id": 78391369, "body": "Cool story. So, where are you stuck?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1502894748, "post_id": 45716669, "comment_id": 78391374, "body": "try this: <code>sprintf(tab2,&quot;%x&quot;,atoi(tab)+0x6000);</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1502895350, "post_id": 45716669, "comment_id": 78391831, "body": "Please give us more information. It&#39;s quite unclear what exactly you want."}, {"owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "edited": false, "score": 0, "creation_date": 1502897712, "post_id": 45716669, "comment_id": 78393473, "body": "Can you please post the code as suggested?"}], "answers": [{"tags": [], "owner": {"reputation": 157, "user_id": 6232777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zfMwD.jpg?s=128&g=1", "display_name": "Stealing", "link": "https://stackoverflow.com/users/6232777/stealing"}, "is_accepted": false, "score": 1, "last_activity_date": 1502911627, "creation_date": 1502911627, "answer_id": 45721520, "question_id": 45716669, "link": "https://stackoverflow.com/questions/45716669/how-to-convert-an-integer-string-to-an-hex-string-c/45721520#45721520", "title": "how to convert an &#39;integer&#39; string to an &#39;hex&#39; string C", "body": "<p>You can add integers together regardless of the base because they are all stored as binary values anyway.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void){\n\n    char tab[] = \"10\";\n    int num = atoi(tab);\n    int num2 = 0x6000;\n    int sum = num + num2;\n    char tab2[20];\n\n    sprintf(tab2, \"%04X\", sum);\n    puts(tab2);\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8415804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e3ea80375c5a66b8a8e25b9b034b42e?s=128&d=identicon&r=PG&f=1", "display_name": "MrsIl", "link": "https://stackoverflow.com/users/8415804/mrsil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": -9, "last_activity_date": 1502911627, "creation_date": 1502894648, "question_id": 45716669, "link": "https://stackoverflow.com/questions/45716669/how-to-convert-an-integer-string-to-an-hex-string-c", "title": "how to convert an &#39;integer&#39; string to an &#39;hex&#39; string C", "body": "<p>I have in an integer value as string, <code>tab[10]=\"10\"</code> and i want to convert it to an hex value <code>h=A</code> add it another value <code>0x6000</code> and store it as a string in another array <code>tab2[50]=\"600A\"</code> in C </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502893718, "post_id": 45716210, "comment_id": 78390602, "body": "<code>Ate</code> --&gt; <code>Eat</code> ?"}, {"owner": {"reputation": 95, "user_id": 6040399, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/IMYTi.jpg?s=128&g=1", "display_name": "Freddykong", "link": "https://stackoverflow.com/users/6040399/freddykong"}, "edited": false, "score": 0, "creation_date": 1502893782, "post_id": 45716210, "comment_id": 78390645, "body": "First, read this documentation : <a href=\"http://devdocs.io/c/io/fread\" rel=\"nofollow noreferrer\">devdocs.io/c/io/fread</a>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502894220, "post_id": 45716210, "comment_id": 78390975, "body": "yes, you could use <code>fscanf</code> to read comma-delimited records..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502894258, "post_id": 45716210, "comment_id": 78391000, "body": "<a href=\"https://stackoverflow.com/questions/15091284/read-comma-separated-input-with-scanf\" title=\"read comma separated input with scanf\">stackoverflow.com/questions/15091284/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502894153, "post_id": 45716440, "comment_id": 78390921, "body": "<code>%s</code> reads a space delimited string, not a comma-delimited string."}, {"owner": {"reputation": 684, "user_id": 4970667, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FWd3x.jpg?s=128&g=1", "display_name": "Quentin", "link": "https://stackoverflow.com/users/4970667/quentin"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502897416, "post_id": 45716440, "comment_id": 78393268, "body": "@BLUEPIXY Exact, I fixed it."}, {"owner": {"reputation": 11, "user_id": 8472954, "user_type": "registered", "profile_image": "https://graph.facebook.com/1396075297180248/picture?type=large", "display_name": "Archie", "link": "https://stackoverflow.com/users/8472954/archie"}, "edited": false, "score": 0, "creation_date": 1502973807, "post_id": 45716440, "comment_id": 78428509, "body": "now i do have a code, but, i cant get what i want from the txt file like"}], "tags": [], "owner": {"reputation": 684, "user_id": 4970667, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FWd3x.jpg?s=128&g=1", "display_name": "Quentin", "link": "https://stackoverflow.com/users/4970667/quentin"}, "is_accepted": false, "score": 0, "last_activity_date": 1502897334, "last_edit_date": 1502897334, "creation_date": 1502894018, "answer_id": 45716440, "question_id": 45716210, "link": "https://stackoverflow.com/questions/45716210/how-to-make-a-c-program-that-can-read-a-data-and-copy-some-in-a-variable/45716440#45716440", "title": "How to make a C program that can read a data and copy some in a variable?", "body": "<p>There is different ways to read data from a <code>FILE *</code> in C :</p>\n\n<ul>\n<li>You read only one character : <code>int fgetc(FILE *fp);</code>.</li>\n<li>You read a whole line : <code>char *fgets(char *buf, int n, FILE *fp);</code> (take care to <code>buf</code>, it must point to allocate memory).</li>\n<li>You read a formatted string, which is your case here : <code>int fscanf(FILE *stream, const char *format, ...)</code>, it works like <code>printf()</code> :</li>\n</ul>\n\n<p>This way :</p>\n\n<pre><code>char name[20], action[20], item[20];\nFILE *f = fopen(\"myfile.txt\", \"r\");\n\nif (! f)\n    return;\n\nif (3 == fscanf(f, \"%19[^,\\n],%19[^,\\n],%19[^,\\n]\\n\", name, action, item))\n    printf(\"%s %s %s\\n\", name, action, item)\n</code></pre>\n\n<p><code>%30[^,\\n],</code> here is used to read of whole object of your line, except <code>,</code> or <code>\\n</code>, which will read item by item the content of your string.</p>\n"}, {"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": true, "score": 0, "last_activity_date": 1502894301, "creation_date": 1502894301, "answer_id": 45716539, "question_id": 45716210, "link": "https://stackoverflow.com/questions/45716210/how-to-make-a-c-program-that-can-read-a-data-and-copy-some-in-a-variable/45716539#45716539", "title": "How to make a C program that can read a data and copy some in a variable?", "body": "<ul>\n<li><p>You are reading characters from file until you receive new line character (<code>\\n</code>) or fill an array, then you return characters stored in an array passed by caller.</p></li>\n<li><p>From this returned array you may get separated values with <code>strtok</code>.</p></li>\n<li><p>Repeat until you receive <code>0</code> from <code>getline</code> (Getline received <code>EOF</code> from file.)</p></li>\n</ul>\n\n<p>Here is simple example with your own <code>getline</code> function which you may modify.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint getline(char s[],int lim, FILE * fp)\n{\n    int c, i;\n    for (i=0; i &lt; lim-1 &amp;&amp; (c=fgetc(fp))!=EOF &amp;&amp; c!='\\n'; ++i)\n    {\n        s[i] = c;\n    }\n    if (c == '\\n')\n    {\n        s[i] = c;\n        ++i;\n    }\n    s[i] = '\\0';\n    return i;\n}\n\nint main()\n{\n    FILE * fp = fopen(\"c:\\\\textfile.txt\", \"r\");\n\n    char line[100];\n    char * ptr;\n\n    while (getline(line, 100, fp))\n    {\n        ptr = strtok(line, \",\");\n\n        while( ptr != NULL )\n        {\n           printf(\" %s\\n\", ptr);\n\n           ptr = strtok(NULL, \",\");\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>I\nAte\nCookies\n\nShe\nDrink\nCoffee\n\nTom\nWears\nPyjamas\n</code></pre>\n\n<p>Storing strings into variable isnt tough, here is an example</p>\n\n<pre><code>strcpy(name, ptr);\n</code></pre>\n\n<p>But be careful, writing outside of bounds have <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<pre><code>strncpy(name, ptr, 100); You can limit number of copied characters with strncpy, but be careful, this function is error-prone.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1033, "user_id": 3410010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFRd3.jpg?s=128&g=1", "display_name": "yadhu", "link": "https://stackoverflow.com/users/3410010/yadhu"}, "is_accepted": false, "score": 0, "last_activity_date": 1502894446, "creation_date": 1502894446, "answer_id": 45716592, "question_id": 45716210, "link": "https://stackoverflow.com/questions/45716210/how-to-make-a-c-program-that-can-read-a-data-and-copy-some-in-a-variable/45716592#45716592", "title": "How to make a C program that can read a data and copy some in a variable?", "body": "<p>You can do like this, </p>\n\n<ol>\n<li>Go on reading characters from a file, after every character is read compare with ',' character. </li>\n<li>If the character read is ',' then you have finished reading the name, otherwise store it in a character array and continue reading the file. </li>\n<li>Once you hit ',' character, terminate the character array with null character(Now you have a complete name with you).</li>\n<li>Compare this character array with a string you receive as input using a strcmp(String compare function). If its it matches decide what you wanna do?</li>\n</ol>\n\n<p>I hope i am clear.</p>\n"}, {"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 0, "last_activity_date": 1502899922, "last_edit_date": 1502899922, "creation_date": 1502899480, "answer_id": 45718322, "question_id": 45716210, "link": "https://stackoverflow.com/questions/45716210/how-to-make-a-c-program-that-can-read-a-data-and-copy-some-in-a-variable/45718322#45718322", "title": "How to make a C program that can read a data and copy some in a variable?", "body": "<p>start with like this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define DATA_FILE \"data.txt\"\n#define LEN 19\n#define SIZE (LEN+1)\n//Stringification\n#define S_(n) #n\n#define S(n) S_(n)\n\nenum { NOT_FOUND, FIND };\n\nint pull_data(const char name[SIZE], char action[SIZE], char item[SIZE]){\n    int ret = NOT_FOUND;\n\n    FILE *fp = fopen(DATA_FILE, \"r\");//fileopen --&gt; fopen\n    if(fp == NULL){\n        perror(\"fopen:\");\n        exit(EXIT_FAILURE);\n    } else {\n        char nametxt[SIZE];\n        *action = *item = 0;\n        while(fscanf(fp, \"%\" S(LEN) \"[^,],%\" S(LEN) \"[^,],%\" S(LEN) \"[^\\n]%*c\", //\"%19[^,],%19[^,],%19[^\\n]%*c\"\n            nametxt, action, item) == 3){\n            if(strcmp(name, nametxt) == 0){//Use strcmp for comparison of strings\n                ret = FIND;\n                break;\n            }\n        }\n    }\n    fclose(fp);\n    return ret;\n}\n\nint main(void){\n    char name[SIZE], action[SIZE], item[SIZE];\n\n    printf(\"Enter name: \\n\");//prinf --&gt; printf\n    if(scanf(\"%\" S(LEN) \"s\", name) == 1){\n        if(pull_data(name, action, item) == FIND){\n            printf(\"%s\\n%s\\n%s\\n\", name, action, item);\n        } else {\n            printf(\"%s not found.\\n\", name);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8472954, "user_type": "registered", "profile_image": "https://graph.facebook.com/1396075297180248/picture?type=large", "display_name": "Archie", "link": "https://stackoverflow.com/users/8472954/archie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 2, "accepted_answer_id": 45716539, "answer_count": 4, "score": -1, "last_activity_date": 1502899922, "creation_date": 1502893452, "last_edit_date": 1502898222, "question_id": 45716210, "link": "https://stackoverflow.com/questions/45716210/how-to-make-a-c-program-that-can-read-a-data-and-copy-some-in-a-variable", "title": "How to make a C program that can read a data and copy some in a variable?", "body": "<p>I'm a student, I am wondering...\nHow can I make a program that can Get some data from my text file to a variable on my program and print them</p>\n\n<p>Example:</p>\n\n<h2>My Text File</h2>\n\n<pre><code>I,Ate,Cookies\nShe,Drink,Coffee\nTom,Wears,Pyjamas\n</code></pre>\n\n<h2>My code</h2>\n\n<pre><code>main()\n{\n    FILE *fp=fileopen(\"c:\\\\textfile.txt\",\"r\");\n    char name[20],action[20],item[20];\n    prinf(\"Enter name: \\n\");\n    scanf(\"%s\",&amp;name);\n\n    /* I dont Know what to do next */\n}\n</code></pre>\n\n<hr>\n\n<p>I though about some checking code: </p>\n\n<pre><code>if (name==nametxt)  /*nametxt is the first line on the text file */\n{\n    printf(\"%s\\n %s\\n %s\\n\",name,action,item);\n}\n</code></pre>\n\n<p>If the name is \"I\",the output would look like this : <br></p>\n\n<pre><code> Enter name:\n I\n I\n Eat\n Cookies\n</code></pre>\n\n<p>A help will satisfy my curiosity thanks in advance</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1502893554, "post_id": 45716151, "comment_id": 78390483, "body": "Look the last line of original code <code>*sb = 0; &#47;* Set value of pointer to zero *&#47;</code> setting to NULL the pointer which address has been passed to the function. Tells you something?"}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 2, "last_activity_date": 1502893406, "creation_date": 1502893406, "answer_id": 45716194, "question_id": 45716151, "link": "https://stackoverflow.com/questions/45716151/why-does-the-argument-use-an-address-of-a-pointer-here/45716194#45716194", "title": "Why does the argument use an address of a pointer here?", "body": "<p>Because this prevents dangling pointers. Although it should be</p>\n\n<pre><code>*sb = NULL;\n</code></pre>\n\n<p>instead.</p>\n\n<p>This way, after calling <code>dispose(&amp;sb)</code> you can check if <code>sb == NULL</code> prior to dereferencing it and prevent dereferencing a pointer that has been freed.</p>\n\n<p>And in your case, <code>sb = 0</code> has no effect because you never use <code>sb</code> after that.</p>\n\n<p>Also, being <code>freeStrings</code> a paramter I would argue that this is a flaw design. If the author wanted to have dual <code>free()</code> behavior which is already bad, they should have had a <code>freeStrings</code> member in the structure and then there would be a lot of control over whether the strings were owned by the structure or not.</p>\n"}, {"tags": [], "owner": {"reputation": 3180, "user_id": 4875869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Et6rMvbhpQ4/AAAAAAAAAAI/AAAAAAAAAIM/tGpQoqm18cs/photo.jpg?sz=128", "display_name": "Kirill Bulygin", "link": "https://stackoverflow.com/users/4875869/kirill-bulygin"}, "is_accepted": false, "score": 0, "last_activity_date": 1502893476, "creation_date": 1502893476, "answer_id": 45716224, "question_id": 45716151, "link": "https://stackoverflow.com/questions/45716151/why-does-the-argument-use-an-address-of-a-pointer-here/45716224#45716224", "title": "Why does the argument use an address of a pointer here?", "body": "<p>In your example, <code>sb = 0; /* Set value of pointer to zero */</code> actually sets the value of the <em>local</em> variable <code>sb</code> to zero. That's the reason.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6679648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MfgS0.jpg?s=128&g=1", "display_name": "Jova", "link": "https://stackoverflow.com/users/6679648/jova"}, "is_accepted": false, "score": 0, "last_activity_date": 1502984244, "creation_date": 1502984244, "answer_id": 45739467, "question_id": 45716151, "link": "https://stackoverflow.com/questions/45716151/why-does-the-argument-use-an-address-of-a-pointer-here/45739467#45739467", "title": "Why does the argument use an address of a pointer here?", "body": "<p>Pointer is variable type just like <code>int, float</code>, etc... So, if you want to change it's value in a function, you have to pass a reference to it as an argument. That is why you have <code>**sb</code> as parameter instead of <code>*sb</code>.</p>\n"}], "owner": {"reputation": 211, "user_id": 3806361, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b7dc3b2ab5bbbfbc2154ef2b574b7abf?s=128&d=identicon&r=PG&f=1", "display_name": "BugRepairMan", "link": "https://stackoverflow.com/users/3806361/bugrepairman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 45716194, "answer_count": 3, "score": 1, "last_activity_date": 1502984244, "creation_date": 1502893312, "question_id": 45716151, "link": "https://stackoverflow.com/questions/45716151/why-does-the-argument-use-an-address-of-a-pointer-here", "title": "Why does the argument use an address of a pointer here?", "body": "<p>I found an string buffer implemented in C here (<a href=\"https://sites.google.com/site/rickcreamer/Home/cc/c-implementation-of-stringbuffer-functionality\" rel=\"nofollow noreferrer\">https://sites.google.com/site/rickcreamer/Home/cc/c-implementation-of-stringbuffer-functionality</a>). There is a function called <strong>dispose()</strong>, one of whose argument is an address of a pointer:</p>\n\n<pre><code>void dispose( SB **sb, int freeStrings ) {\n    if ( !sb || !*sb || !(*sb)-&gt;ptrList )\n        return; /* TODO: Decide if should abort here or take other action */\n    if ( freeStrings ) {\n        for ( int i = 0; i &lt; (*sb)-&gt;count; ++i )\n            free( (*sb)-&gt;ptrList[ i ] );\n    }\n    free( (*sb)-&gt;ptrList );\n    free( *sb );\n    *sb = 0; /* Set value of pointer to zero */\n}\n</code></pre>\n\n<p>I cannot understand why its first argument is the address of the pointer, rather than the pointer. What I would convert the function to is: </p>\n\n<pre><code>void dispose( SB *sb, int freeStrings ) {\n    if ( !sb || !sb-&gt;ptrList )\n        return; /* TODO: Decide if should abort here or take other action */\n    if ( freeStrings ) {\n        for ( int i = 0; i &lt; sb-&gt;count; ++i )\n            free( sb-&gt;ptrList[ i ] );\n    }\n    free( sb-&gt;ptrList );\n    free( sb );\n    sb = 0; /* Set value of pointer to zero */\n}\n</code></pre>\n\n<p>Do I miss something here?</p>\n"}, {"tags": ["c", "alsa", "mixer"], "comments": [{"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1502894130, "post_id": 45716092, "comment_id": 78390903, "body": "there is other function prototype <a href=\"https://developer.blackberry.com/playbook/native/reference/com.qnx.doc.neutrino.audio/topic/libs/snd_mixer_open.html\" rel=\"nofollow noreferrer\">developer.blackberry.com/playbook/native/reference/&hellip;</a>"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1502894182, "post_id": 45716092, "comment_id": 78390942, "body": "<a href=\"https://stackoverflow.com/questions/21483929/set-mixer-as-default-alsa-api\" title=\"set mixer as default alsa api\">stackoverflow.com/questions/21483929/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1502894283, "post_id": 45716496, "comment_id": 78391024, "body": "In the future, some mode bits might be used."}], "tags": [], "owner": {"reputation": 60, "user_id": 2216655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tpMoy.jpg?s=128&g=1", "display_name": "Simon Aldrich", "link": "https://stackoverflow.com/users/2216655/simon-aldrich"}, "is_accepted": true, "score": 1, "last_activity_date": 1502894423, "last_edit_date": 1502894423, "creation_date": 1502894194, "answer_id": 45716496, "question_id": 45716092, "link": "https://stackoverflow.com/questions/45716092/alsa-snd-mixer-open-open-mode/45716496#45716496", "title": "Alsa snd_mixer_open() &#39;open mode&#39;", "body": "<p>From the source in <a href=\"http://git.alsa-project.org/?p=alsa-lib.git;a=blob;f=src/mixer/mixer.c;h=3a79c8e91efb0f6c67c0ba365b54eb6f72679d69;hb=HEAD#l68\" rel=\"nofollow noreferrer\">alsa-lib/src/mixer.c:68</a> the \"mode\" argument is flagged as unused:</p>\n\n<pre><code>int snd_mixer_open(snd_mixer_t **mixerp, int mode ATTRIBUTE_UNUSED)\n</code></pre>\n\n<p>and the source of the function bears that out. So it looks like it's safe to use any int there (I'd personally just go with 0).</p>\n"}], "owner": {"reputation": 142, "user_id": 7492244, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5702e8b82b30a476ff8fdfacde19ffaf?s=128&d=identicon&r=PG", "display_name": "Ploppz", "link": "https://stackoverflow.com/users/7492244/ploppz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 45716496, "answer_count": 1, "score": 0, "last_activity_date": 1502894423, "creation_date": 1502893159, "question_id": 45716092, "link": "https://stackoverflow.com/questions/45716092/alsa-snd-mixer-open-open-mode", "title": "Alsa snd_mixer_open() &#39;open mode&#39;", "body": "<p>In the <a href=\"http://www.alsa-project.org/alsa-doc/alsa-lib/group___mixer.html#ga240cfebce7d68f22875d76e99cf19394\" rel=\"nofollow noreferrer\">documentation</a> for snd_mixer_open, the description for the second parameter <code>int mode</code> is: \"open mode\". But I can't find any further information about which symbolic values to use in the same module. After some searching, I found that in the snd_ctl/control module, there are symbolic values like SND_CTL_NONBLOCK and SND_CTL_ASYNC, and also SND_CTL_READONLY. But I have still no indication which ones are ok to use in the <code>snd_mixer_open</code> function! And as these are prefixed with 'SND_CTL' I have the impression they are only meant for functions of the snd_ctl module.</p>\n\n<p>(What I'm generally trying to achieve, is to be able to read the volume level of the master channel of the default sound card.)</p>\n"}, {"tags": ["c", "design-patterns"], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502893428, "post_id": 45715839, "comment_id": 78390372, "body": "This will not keep most compilers happy though, let along static analysers. They tend to dislike assignment inside conditions and <code>goto</code> both. Although this code is ok, I believe there are better ways."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502893473, "post_id": 45715839, "comment_id": 78390417, "body": "a paranthesized assignment is fine for the compilers I know, and <code>goto</code> of course is, as well."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502893744, "post_id": 45715839, "comment_id": 78390619, "body": "None of it will slip past a MISRA-C checker however."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502893813, "post_id": 45715839, "comment_id": 78390671, "body": "Fortunately, I can ignore their nonsense :) (Don&#39;t get me wrong on this, there are good intentions behind it, but it&#39;s <b>always</b> a problem to give some definitive <b>always</b> / <b>never</b> rules)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502894117, "post_id": 45715839, "comment_id": 78390891, "body": "@Lundin btw, because of such rules, people come up with <a href=\"https://stackoverflow.com/a/45249553/2371524\">&quot;creatively disguised gotos&quot;</a>. Awesome readability ;)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 3, "last_activity_date": 1502892546, "creation_date": 1502892546, "answer_id": 45715839, "question_id": 45715762, "link": "https://stackoverflow.com/questions/45715762/the-right-pattern-for-sequence-of-allocations-and-operations-which-may-fail/45715839#45715839", "title": "The right pattern for sequence of allocations and operations which may fail", "body": "<p>That's the (IMHO) <strong>one good use</strong> for <code>goto</code> (and a common C idiom):</p>\n\n<pre><code>    type *obj1 = 0;\n    type *obj2 = 0;\n    type *obj3 = 0;\n\n    if (!(obj1 = create1())) goto error;\n    if (!(obj2 = create2())) goto error;\n    if (!(obj3 = create3())) goto error;\n\n    // your logic here\n\n    return 0; // success\n\nerror:\n    free(obj3);\n    free(obj2);\n    free(obj1);\n    return -1; // failure\n</code></pre>\n\n<p>Or, if you need to free the allocated resources in success case as well, like this:</p>\n\n<pre><code>    type *obj1 = 0;\n    type *obj2 = 0;\n    type *obj3 = 0;\n    int success = -1;\n\n    if (!(obj1 = create1())) goto error;\n    if (!(obj2 = create2())) goto error;\n    if (!(obj3 = create3())) goto error;\n\n    success = 0; // success\n\n    // your logic here\n\nerror:\n    free(obj3);\n    free(obj2);\n    free(obj1);\n    return success;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502893267, "post_id": 45716132, "comment_id": 78390240, "body": "Another huge advantage of this is that you don&#39;t have to endure the <code>goto</code> debate yet again..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502893361, "post_id": 45716132, "comment_id": 78390322, "body": "I don&#39;t think there&#39;s much of a debate for using <code>goto</code> in exactly this scenario. But if you want to avoid it no matter what, that&#39;s probably the simplest way around."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502893568, "post_id": 45716132, "comment_id": 78390495, "body": "@FelixPalmen Give them a couple of hours and the debate will start. Did you not hear the news? <a href=\"http://homepages.cwi.nl/~storm/teaching/reader/Dijkstra68.pdf\" rel=\"nofollow noreferrer\">GoTo considered harmful</a>!  :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502893610, "post_id": 45716132, "comment_id": 78390531, "body": "of course, <b>breaking</b> news after 50 years ;) (but to be serious, I feel that almost the entire C community agrees that this scenario is a <i>positive</i> example for <code>goto</code>. Still nice to see a simple way to avoid it)"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1502893262, "creation_date": 1502893262, "answer_id": 45716132, "question_id": 45715762, "link": "https://stackoverflow.com/questions/45715762/the-right-pattern-for-sequence-of-allocations-and-operations-which-may-fail/45716132#45716132", "title": "The right pattern for sequence of allocations and operations which may fail", "body": "<p>The best way to handle this is often to use a couple of internal wrapper functions. Keep the allocation separate from the algorithm. Initialize the variables to 0 (NULL) and take advantage of <code>free(NULL)</code> being a well-defined no-op, meaning that everything will get cleaned up no matter which function that failed.</p>\n\n<pre><code>static int allocate (type1** X1, type2** X2, type3** X3)\n{\n  *X1 = type1_new(); if(*X1 == NULL) return 0;\n  *X2 = type2_new(); if(*X2 == NULL) return 0;\n  *X3 = type3_new(); if(*X3 == NULL) return 0;\n  return 1;\n}\n\nint Ugly_Calculation (void)\n{\n  type1* X1 = 0;\n  type2* X2 = 0;\n  type3* X3 = 0;\n\n  int result = allocate(&amp;X1, &amp;X2, &amp;X3);\n  if(result != 0)\n  {\n    result = PerformCalculation(X1, X2, X3);\n  }\n\n  free(X1);\n  free(X2);\n  free(X3);\n\n  return result;\n}\n</code></pre>\n"}], "owner": {"reputation": 2700, "user_id": 2073232, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/34d37f91d37f0c15a136b18065743372?s=128&d=identicon&r=PG", "display_name": "V-X", "link": "https://stackoverflow.com/users/2073232/v-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1502893262, "creation_date": 1502892335, "question_id": 45715762, "link": "https://stackoverflow.com/questions/45715762/the-right-pattern-for-sequence-of-allocations-and-operations-which-may-fail", "title": "The right pattern for sequence of allocations and operations which may fail", "body": "<p>I have a piece of code which looks almost like this (this is simplified just to show the structure):</p>\n\n<pre><code>int Ugly_Calculation(void)\n{\n    type1 *X1 = type1_new();\n    if (!X1) return 0;\n    type2 *X2 = type2_new(X1);\n    if (!X2) return 0;\n    type3 *X3 = type3_new(X1, X2);\n    if (!X3) return 0;\n    int result = PerformCalculation(X1, X2, X3);\n    free(X3);\n    free(X2);\n    free(X1);\n    return result;\n}\n</code></pre>\n\n<p>It allocates some objects and uses them for some calculation and frees the objects. The <em>typeX_new</em> functions quite often return zero, so the memory is usually not freed correctly. </p>\n\n<p>In my first iteration, I have rewritten the code in following way:</p>\n\n<pre><code>typedef struct\n{\n    type1 *X1;\n    type2 *X2;\n    type3 *X3;\n} ugly_context;\n\nvoid free_ctx(ugly_context *ctx)\n{\n    free(ctx-&gt;X1);\n    free(ctx-&gt;X2);\n    free(ctx-&gt;X3);\n}\n\nint Ugly_Calculation(void)\n{\n    ugly_context ctx = {NULL, NULL, NULL};\n\n    ctx-&gt;X1 = type1_new();\n    if (!ctx-&gt;X1)\n    {\n        free_ctx(&amp;ctx);\n        return 0;\n    }\n    ctx-&gt;X2 = type1_new(ctx-&gt;X1);\n    if (!ctx-&gt;X2)\n    {\n        free_ctx(&amp;ctx);\n        return 0;\n    }\n    ctx-&gt;X3 = type1_new(ctx-&gt;X1, ctx-&gt;X2);\n    if (!ctx-&gt;X3)\n    {\n        free_ctx(&amp;ctx);\n        return 0;\n    }\n    int result = PerformCalculation(X1, X2, X3);\n    free_ctx(&amp;ctx);\n    return result; \n}\n</code></pre>\n\n<p>My first fix is safe, but it has lost the readability of the original code.\nMy second idea is following:</p>\n\n<pre><code>type2 *type2_new_check(type1 *X1)\n{\n   type2 *result = NULL;\n   if (X1)\n   {\n       result = type2_new(X1);\n   }\n   return result;\n}\n\ntype3 *type3_new_check(type1 *X1, type2 *X2)\n{\n   type3 *result = NULL;\n   if (X1 &amp;&amp; X2)\n   {\n       result = type3_new(X1, X2);\n   }\n   return result;\n}\n\nint PerformCalculation_check(type1 *X1, type2 *X2, type3 *X3)\n{\n    int result = 0;\n    if (X1 &amp;&amp; X2 &amp;&amp; X3)\n    {\n       result = PerformCalculation(X1, X2, X3);\n    }\n    return result;\n}\n\nint Ugly_Calculation(void)\n{\n    type1 *X1 = type1_new();\n    type2 *X2 = type2_new_check(X1);\n    type3 *X3 = type3_new_check(X1, X2);\n    int result = PerformCalculation_check(X1, X2, X3);\n    free(X3);\n    free(X2);\n    free(X1);\n    return result;\n}\n</code></pre>\n\n<p>The code readability is OK and early exits are gone, but it is pretty long for method with 3 memory blocks.</p>\n\n<p>My real code is not 3 allocations, but 15, so the method becomes very creepy and ugly. Is there any nice way, how to solve this pattern without excessive checks and freeing? (The best would be to break the method to smaller parts that are cleanly manageable by checks, but I'd like to avoid that for some reason)</p>\n"}, {"tags": ["c", "gcc", "memory-alignment"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502892113, "post_id": 45715606, "comment_id": 78389324, "body": "You told the compiler to align and then you want to do not."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502892228, "post_id": 45715606, "comment_id": 78389396, "body": "You can&#39;t do anything about the trailing padding, that&#39;s expected with an aligned object. The best you could hope for is that <code>variable3</code> is placed before your <code>struct</code> ... maybe an option for optimizing for size (like <code>-Os</code>) would help."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502892293, "post_id": 45715606, "comment_id": 78389441, "body": "1) Has nothing to do with the aligned extension - structs must be allocated at even addresses, simple as that."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502893096, "post_id": 45715606, "comment_id": 78390090, "body": "@Lundin on 8-bit systems as well?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502893783, "post_id": 45715606, "comment_id": 78390647, "body": "@PeterJ Well... yes, since they tend to have 1 byte alignment :)"}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1502892234, "creation_date": 1502892234, "answer_id": 45715719, "question_id": 45715606, "link": "https://stackoverflow.com/questions/45715606/side-effects-of-using-attribute-alignedx/45715719#45715719", "title": "side effects of using __attribute__((aligned(X))", "body": "<p>I do not see any other way but to declare an additional segment in your linker script and to place the variable there. Place this segment past the .bss and .data segments and you are done :)</p>\n"}], "owner": {"reputation": 1, "user_id": 8472862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e64ab94254f2e02b5cc7ee198a57eb?s=128&d=identicon&r=PG&f=1", "display_name": "vituzzo", "link": "https://stackoverflow.com/users/8472862/vituzzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502892234, "creation_date": 1502891905, "question_id": 45715606, "link": "https://stackoverflow.com/questions/45715606/side-effects-of-using-attribute-alignedx", "title": "side effects of using __attribute__((aligned(X))", "body": "<p>So i'm seeing an interesting compiler behavior when using the <strong>attribute</strong>((aligned(x)) directive. (i'm using GCC)</p>\n\n<p>consider the following structure</p>\n\n<pre><code>typedef struct \n{\n  char buffer[4096] __attribute__((aligned(4096));\n  int y;\n} s1;\n</code></pre>\n\n<p>The structure size is 4100 bytes and must be in 4K aligned address,\nwhen looking at the generated .map file i see the structure is indeed aligned to 4k address but with additional 2 unwanted side effects:</p>\n\n<ol>\n<li><p>There is a padding in between the variable located before my aligned structure - since it is a waste of space how can i make the compiler to try and fill this space with other variables?</p></li>\n<li><p>Not only the structure address is aligned, it also became size aligned, i.e. the variable after it starts also at offset aligned to 4K (i.e. 8K are allocated for a 4100 bytes structure), see below for more details.</p></li>\n</ol>\n\n<p><strong>My question</strong>: how do i make the compiler to try and optimize the padding and place variables there (e.g. variables following it) and how do i prevent the compiler to align the structure size to its aligned address?</p>\n\n<pre><code>0x00012524      variable1 \n0x00012534      [padding]\n0x00013000      my_struct (0x4100 bytes but consumes 8192)\n0x00015000      variable3 \n</code></pre>\n\n<p>Thanks\nVito</p>\n"}, {"tags": ["c", "gcc", "floating-point", "scanf"], "comments": [{"owner": {"reputation": 3080, "user_id": 7590993, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/10154373026397157/picture?type=large", "display_name": "Hariom Singh", "link": "https://stackoverflow.com/users/7590993/hariom-singh"}, "edited": false, "score": 1, "creation_date": 1502891351, "post_id": 45715307, "comment_id": 78388785, "body": "<a href=\"https://stackoverflow.com/questions/12560291/set-back-default-precision-c\" title=\"set back default precision c\">stackoverflow.com/questions/12560291/&hellip;</a>"}, {"owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "reply_to_user": {"reputation": 3080, "user_id": 7590993, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/10154373026397157/picture?type=large", "display_name": "Hariom Singh", "link": "https://stackoverflow.com/users/7590993/hariom-singh"}, "edited": false, "score": 4, "creation_date": 1502891442, "post_id": 45715307, "comment_id": 78388848, "body": "@HariomSingh How is that linked question related? It&#39;s not even in the same language."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1502891630, "post_id": 45715307, "comment_id": 78388978, "body": "@Toby question was originally double-tagged with <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a>, removed it because neither the code nor the text refers to C++."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1502891719, "post_id": 45715307, "comment_id": 78389050, "body": "read <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format#Precision_limits_on_integer_values\" rel=\"nofollow noreferrer\">Precision limits on integer values</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1502891844, "post_id": 45715307, "comment_id": 78389131, "body": "...and maybe you need <code>double</code> instead of <code>float</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1502891904, "post_id": 45715307, "comment_id": 78389175, "body": "And this can also be of interest: <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502893980, "post_id": 45715307, "comment_id": 78390789, "body": "Chaitanya Vaishampayan: Curious what was your expectation of what values  <code>float</code> would have trouble? did you expect all possible numeric inputs to print out the same?"}, {"owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 0, "creation_date": 1502895215, "post_id": 45715307, "comment_id": 78391721, "body": "see <a href=\"https://en.wikipedia.org/wiki/IEEE_754\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/IEEE_754</a>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502893632, "post_id": 45715635, "comment_id": 78390545, "body": "Off by 1: The ~16000000 is about right, but typical <code>float</code> has 24 bits of precision.  23 are directly encoded and 1 implied.  This first inexact conversion of an integer to <code>float</code> is with 16,777,217 (0x1000001), a 25-bit integer."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502893773, "post_id": 45715635, "comment_id": 78390637, "body": "@chux Good catch.  Updated to reflect."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 5, "last_activity_date": 1502893759, "last_edit_date": 1502893759, "creation_date": 1502891961, "answer_id": 45715635, "question_id": 45715307, "link": "https://stackoverflow.com/questions/45715307/why-is-scanf-taking-the-wrong-input-for-large-float-numbers/45715635#45715635", "title": "Why is scanf taking the wrong input for large float numbers?", "body": "<p>Floating point types have a limited precision.  For a <code>float</code> on your machine, which appears to be 32 bit, it has 24 bits  of precision (23 explictly stored, 1 implied).  That means integers greater than ~16000000, which require more than 24 bits to store, can't be represented exactly with this datatype.</p>\n\n<p>For example, the value 123456789 you used has a binary representation of:</p>\n\n<pre><code>111 0101 1011 1100 1101 0001 0101\n</code></pre>\n\n<p>This value takes up 27 bits which is more than is available.  So it is rounded to the closest value that can be stored with 23 bits, which is 123456792.  In binary:</p>\n\n<pre><code>111 0101 1011 1100 1101 0001 1000\n</code></pre>\n\n<p>For this value, the lower 3 bits with value 0 are not explicitly stored.</p>\n"}], "owner": {"reputation": 187, "user_id": 7105441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vXOKh40bCF0/AAAAAAAAAAI/AAAAAAAAAAA/ISRQp5Ex3NE/photo.jpg?sz=128", "display_name": "Chaitanya Vaishampayan", "link": "https://stackoverflow.com/users/7105441/chaitanya-vaishampayan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 1, "closed_date": 1502895803, "accepted_answer_id": 45715635, "answer_count": 1, "score": -1, "last_activity_date": 1502893759, "creation_date": 1502891075, "last_edit_date": 1502892021, "question_id": 45715307, "link": "https://stackoverflow.com/questions/45715307/why-is-scanf-taking-the-wrong-input-for-large-float-numbers", "closed_reason": "Duplicate", "title": "Why is scanf taking the wrong input for large float numbers?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main() { \nfloat k;\n    scanf(\"%f\", &amp;k);\n    printf(\"%f\", k);\n} \n</code></pre>\n\n<p>In this simple program when I enter a number containing at most 8 digits then it is displayed correctly.</p>\n\n<p>But if I exceed 8 digits i.e. for the input <code>123456789</code> the output is <code>123456792</code>. </p>\n\n<p>Why this is happening? Well the fun fact is that if I enter any number between <code>123456789</code> and <code>123456796</code> then it always shows <code>123456792</code>.</p>\n\n<p>Is it something related to the 8 decimal precision of floating numbers?</p>\n"}, {"tags": ["c++", "c", "gio", "gdbus"], "comments": [{"owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1502891725, "post_id": 45715286, "comment_id": 78389055, "body": "Yes, C is a different language to C++. Do you want answers in C <i>or</i> C++?"}, {"owner": {"reputation": 57058, "user_id": 476681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/v9mVv.jpg?s=128&g=1", "display_name": "B\u0408\u043e\u0432\u0438\u045b", "link": "https://stackoverflow.com/users/476681/b%d0%88%d0%be%d0%b2%d0%b8%d1%9b"}, "reply_to_user": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1502891767, "post_id": 45715286, "comment_id": 78389086, "body": "@Toby I know they are different, but the answer should be the same for both C and C++."}], "answers": [{"comments": [{"owner": {"reputation": 4022, "user_id": 2931197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e3379958588750196bc49f6925ab62?s=128&d=identicon&r=PG&f=1", "display_name": "Philip Withnall", "link": "https://stackoverflow.com/users/2931197/philip-withnall"}, "edited": false, "score": 0, "creation_date": 1502922923, "post_id": 45717281, "comment_id": 78405804, "body": "\u201cThis is nowhere to be found, and is not documented anywhere.\u201d It <i>is</i> documented: the GObject manual. This is a standard GObject type definition, and the assumption is that if you\u2019re using <code>gdbus-codegen</code>, you have read about how to use GObject. Here\u2019s the manual: <a href=\"https://developer.gnome.org/gobject/stable/index.html\" rel=\"nofollow noreferrer\">developer.gnome.org/gobject/stable/index.html</a>"}, {"owner": {"reputation": 57058, "user_id": 476681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/v9mVv.jpg?s=128&g=1", "display_name": "B\u0408\u043e\u0432\u0438\u045b", "link": "https://stackoverflow.com/users/476681/b%d0%88%d0%be%d0%b2%d0%b8%d1%9b"}, "reply_to_user": {"reputation": 4022, "user_id": 2931197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e3379958588750196bc49f6925ab62?s=128&d=identicon&r=PG&f=1", "display_name": "Philip Withnall", "link": "https://stackoverflow.com/users/2931197/philip-withnall"}, "edited": false, "score": 0, "creation_date": 1502950411, "post_id": 45717281, "comment_id": 78412981, "body": "@PhilipWithnall Thanks. There is not even one example showing this. All are with &quot;g_signal_connect&quot;"}], "tags": [], "owner": {"reputation": 57058, "user_id": 476681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/v9mVv.jpg?s=128&g=1", "display_name": "B\u0408\u043e\u0432\u0438\u045b", "link": "https://stackoverflow.com/users/476681/b%d0%88%d0%be%d0%b2%d0%b8%d1%9b"}, "is_accepted": false, "score": 0, "last_activity_date": 1502896380, "creation_date": 1502896380, "answer_id": 45717281, "question_id": 45715286, "link": "https://stackoverflow.com/questions/45715286/how-to-use-types-generated-by-gdbus-codegen/45717281#45717281", "title": "How to use types generated by gdbus-codegen?", "body": "<p>After playing with the example, finally I figured out the answers, and how to gain access to the interface structure, and how to set it. This is nowhere to be found, and is not documented anywhere.</p>\n\n<hr>\n\n<p>After looking into the generated source file, the function <code>GType min_min_bus_gdbus_get_type (void)</code> may be defined in a huge macro garble, but I am not sure of it's functionality, and how to use it.</p>\n\n<hr>\n\n<p>There is a way to access the <code>struct MinMinBusGDBUSIface</code> by use of the <code>MIN_MIN_BUS_GDBUS_GET_IFACE</code> macro (again in the generated header).</p>\n\n<p>To set the function callback, this line in the example:</p>\n\n<pre><code>g_signal_connect (interface, \n                  \"handle-hello-world\", \n                  G_CALLBACK (on_handle_hello_world), NULL);\n</code></pre>\n\n<p>can be replaced by:</p>\n\n<pre><code>MinMinBusGDBUSIface* iface = MIN_MIN_BUS_GDBUS_GET_IFACE(interface);\niface-&gt;handle_hello_world = &amp;on_handle_hello_world;\n</code></pre>\n\n<p>and the callback has to be modified to has the same signature as the function callback:</p>\n\n<pre><code>static gboolean\non_handle_hello_world (MinMinBusGDBUS *interface, \n                       GDBusMethodInvocation *invocation,\n                       const gchar *greeting)\n</code></pre>\n"}], "owner": {"reputation": 57058, "user_id": 476681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/v9mVv.jpg?s=128&g=1", "display_name": "B\u0408\u043e\u0432\u0438\u045b", "link": "https://stackoverflow.com/users/476681/b%d0%88%d0%be%d0%b2%d0%b8%d1%9b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 834, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502896380, "creation_date": 1502891015, "question_id": 45715286, "link": "https://stackoverflow.com/questions/45715286/how-to-use-types-generated-by-gdbus-codegen", "title": "How to use types generated by gdbus-codegen?", "body": "<p>I am implementing a dbus server, and to simplify things, I decided to use <code>gdbus-codegen</code>.</p>\n\n<p><a href=\"https://fatminmin.com/blog/dbus-gdbus-hello-world.html\" rel=\"nofollow noreferrer\">This hello world example</a> and <a href=\"https://github.com/chiehmin/gdbus_test\" rel=\"nofollow noreferrer\">it's repository</a> are going to generate header and source files. Then it do this to connect the signal to the function:</p>\n\n<pre><code>g_signal_connect (interface, \n                  \"handle-hello-world\", \n                  G_CALLBACK (on_handle_hello_world), NULL);\n</code></pre>\n\n<p>My questions are next:</p>\n\n<ul>\n<li>what is the function <code>GType min_min_bus_gdbus_get_type (void)</code> supposed to do? It is declared, but not defined in generated files.</li>\n<li>instead of connecting signal to a callback function (as described above), can I somehow use the <code>struct MinMinBusGDBUSIface</code>, declared in the generated header?</li>\n</ul>\n\n<hr>\n\n<p>Any example that I found on the net, are having these two things (<code>*_get_type (void)</code> function declaration, and <code>struct *Iface</code> declared in the generated header. How to use them?</p>\n"}, {"tags": ["c", "unix", "file-io", "concurrency"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502890692, "post_id": 45715071, "comment_id": 78388308, "body": "Processes doesn&#39;t really share descriptors, even if they are related (e.g. forked) and have the same number and reference the same file. It&#39;s still two distinct descriptors with their own buffering. Another process might still delete or modify the file between the polling and the reading or writing of the file, leading to other problems."}, {"owner": {"reputation": 6794, "user_id": 412808, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3daaea0ebce68c00202f395eb796724c?s=128&d=identicon&r=PG", "display_name": "Giacomo Tesio", "link": "https://stackoverflow.com/users/412808/giacomo-tesio"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502891043, "post_id": 45715071, "comment_id": 78388589, "body": "Well AFAIK, this is not true for all Unix derivative (at least it&#39;s not true for Plan 9... :-D).    Still I&#39;m not sure this answer my question for Linux/BSD either: since you don&#39;t tell the kernel how much your are going to read, how buffers could be relevant?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502891288, "post_id": 45715071, "comment_id": 78388753, "body": "Well buffers aren&#39;t really relevant, but what&#39;s is important is that it&#39;s two distinct and different file descriptors. Having two processes (no matter if one was forked from another) reading from the same file is simply not a problem. One process will not block the other if both are only reading from the file."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1502891667, "post_id": 45715071, "comment_id": 78389009, "body": "Unless the file descriptor is non-blocking you can block in read regardless of what poll&amp;co returns. Also, poll&amp;co are meaningless on normal files and will (or at least should) return that the file is always readable. The answer is: no one does anything to prevent this race because it&#39;s a meaningless race. In a real scenario when one thread is in poll and the other one reads from the fd, the polling thread will at worst wake up, read from the fd, get an error because the fd is non-blocking and go back into poll."}, {"owner": {"reputation": 6794, "user_id": 412808, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3daaea0ebce68c00202f395eb796724c?s=128&d=identicon&r=PG", "display_name": "Giacomo Tesio", "link": "https://stackoverflow.com/users/412808/giacomo-tesio"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1502892327, "post_id": 45715071, "comment_id": 78389469, "body": "@Art I tried to clarify that I&#39;m obviously thinking about file descriptors that can block on read/write."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1502892376, "post_id": 45715071, "comment_id": 78389504, "body": "Actually, to add to my previous comment. Very old implementations of select on quite a few systems had spurious wakeups where select could report a file descriptor readable despite there not being anything to read from it. It hasn&#39;t been a problem for decades, but nothing prevents you from having two threads poll on the same fd or have the same fd twice in one poll call. The general idea with select/poll/etc has always been that you must be aware of the TOCTOU issue and deal with it. That&#39;s why poll&amp;co on anything that isn&#39;t non-blocking is almost always an error."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1502892752, "post_id": 45715071, "comment_id": 78389814, "body": "@GiacomoTesio That manual page lies. You can have a read block for ever on an NFS file despite select always returning true for them. Also, every read can always block for other things, like locks, memory, etc. Waiting for the disk to get your data for example isn&#39;t considered blocking even though it can take quite some time. The term &quot;blocking&quot; isn&#39;t very well defined, it should be something like &quot;wait for data to become available that doesn&#39;t have a reasonable upper bound in time&quot;."}, {"owner": {"reputation": 6794, "user_id": 412808, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3daaea0ebce68c00202f395eb796724c?s=128&d=identicon&r=PG", "display_name": "Giacomo Tesio", "link": "https://stackoverflow.com/users/412808/giacomo-tesio"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1502901776, "post_id": 45715071, "comment_id": 78396069, "body": "@Art probably the sum of your comments qualify as an answer: this is a well known race that programmers are expected to know and avoid. Do you mind to write it down as such. Note that I&#39;m also interested in the historical backgrounds. Given what you wrote, I&#39;m a bit surprised that this family of system calls is not a common cause/target of DoS attacks."}], "answers": [{"tags": [], "owner": {"reputation": 124, "user_id": 8283102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd364df21977eb17d0d27b31851acbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit", "link": "https://stackoverflow.com/users/8283102/rohit"}, "is_accepted": false, "score": 0, "last_activity_date": 1502894709, "creation_date": 1502894709, "answer_id": 45716693, "question_id": 45715071, "link": "https://stackoverflow.com/questions/45715071/is-this-a-possible-race-with-select-poll-epoll-kqueue/45716693#45716693", "title": "Is this a possible race with select/poll/epoll/kqueue?", "body": "<p>When reading through file ,read will automatically return once EOF is reached.Whether this question is related to SOCKET reading?</p>\n"}], "owner": {"reputation": 6794, "user_id": 412808, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3daaea0ebce68c00202f395eb796724c?s=128&d=identicon&r=PG", "display_name": "Giacomo Tesio", "link": "https://stackoverflow.com/users/412808/giacomo-tesio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502894709, "creation_date": 1502890467, "last_edit_date": 1502892270, "question_id": 45715071, "link": "https://stackoverflow.com/questions/45715071/is-this-a-possible-race-with-select-poll-epoll-kqueue", "title": "Is this a possible race with select/poll/epoll/kqueue?", "body": "<p>I'm studying the semantics of <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pselect.html\" rel=\"nofollow noreferrer\">select()</a>/<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/poll.html\" rel=\"nofollow noreferrer\">poll()</a>/<a href=\"http://man7.org/linux/man-pages/man7/epoll.7.html\" rel=\"nofollow noreferrer\">epoll()</a> and <a href=\"https://www.freebsd.org/cgi/man.cgi?query=kqueue&amp;sektion=2\" rel=\"nofollow noreferrer\">kqueue()</a> to decide how to emulate them in user space for my <a href=\"http://jehanne.io/\" rel=\"nofollow noreferrer\">operating system</a>. </p>\n\n<p>Note that I only care about <strong>file read/write/exceptions</strong> multiplexing, not signals, child process states, timers and so on... </p>\n\n<p>I've read several resource about them, their comparison, their advantages and their issues, but I can't find anything about a particular race that to my understanding affects all of them.</p>\n\n<p>Suppose you have a multiplexing process waiting in a <code>select</code> (or in any other of group) for a file to be readable. After the <code>select</code> returns, but before the process can <code>read</code> that specific fd, another process sharing that same descriptor <code>read</code> the file. As far as I can tell, the <code>read</code> in the multiplexing process will block (until more data are available).</p>\n\n<p>I know that this is a bug in the application (the multiplexed descriptors should not be available to any other process concurrently using them) but still I'd like to know if it's a possible scenario and if the various operating systems do anything to prevent such race.<br>\nIndeed, despite being probably complex, they <strong>could</strong> prevent the race, for example blocking the read of a particular descriptor \"returned as readable\" by <code>select</code> on all but the multiplexing process, till such process has consumed the event (aka <code>read</code> the fd). Obviously for more exotic events, this may be impossible, but I'm considering only files reads/writes here.</p>\n\n<p><strong>Note:</strong> this question is about the race, not the specifics of each system call, so please do not try to explain the differences/advantages and so on, if they are not related to this particular race.</p>\n\n<p><strong>Edit</strong> To clarify, I'm thinking about files that can actually block on read/write, since as explained by the select(2) manual on Linux</p>\n\n<blockquote>\n  <p>A file descriptor is considered ready if it is possible to perform a\n  corresponding I/O operation (e.g., read(2) without blocking, or\n  sufficiently small write(2)).</p>\n</blockquote>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1502889458, "post_id": 45714595, "comment_id": 78387404, "body": "Note<code>fgets()</code>takes three arguments. (and <code>gets()</code> was removed from the library, so it should not exist)"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1502889501, "post_id": 45714595, "comment_id": 78387441, "body": "<code>fgets(&quot;%s&quot;,&amp;payroll[size].name.first);</code> --&gt; <code>scanf(&quot;%14s&quot;, payroll[size-1].name.first);</code> ?"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1502889863, "post_id": 45714595, "comment_id": 78387725, "body": "Just a style suggestion, but you should aim for consistent and meaningful names for variables and arguments. <code>size</code> isn&#39;t good when you are referring to an index, and half your functions seem to use <code>n</code> for the same purpose."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1502889875, "post_id": 45714595, "comment_id": 78387735, "body": "<code>gets</code> does not exist in stdio.h, it has been removed from the standard. That&#39;s why you get the <i>implicit declaration</i> warning"}, {"owner": {"reputation": 35, "user_id": 7366544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f069aab66472b9919636d0ad7523e6a8?s=128&d=identicon&r=PG&f=1", "display_name": "DumbDrw", "link": "https://stackoverflow.com/users/7366544/dumbdrw"}, "edited": false, "score": 0, "creation_date": 1502890057, "post_id": 45714595, "comment_id": 78387854, "body": "yeah my code is not complete yet coz i was trying the scanf/gets first before putting loop for the size thanks guys its really hard to learn in ubuntu tho but i need to learn haha"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502890253, "post_id": 45714595, "comment_id": 78387996, "body": "Because the gets() function was flagged as obsolete 18 years ago, and completely removed 6 years ago. It does no longer exist in standard C."}], "owner": {"reputation": 35, "user_id": 7366544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f069aab66472b9919636d0ad7523e6a8?s=128&d=identicon&r=PG&f=1", "display_name": "DumbDrw", "link": "https://stackoverflow.com/users/7366544/dumbdrw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1989, "favorite_count": 0, "closed_date": 1502890217, "answer_count": 0, "score": 1, "last_activity_date": 1502889222, "creation_date": 1502889222, "question_id": 45714595, "link": "https://stackoverflow.com/questions/45714595/c-warning-implicit-declaration-of-function-gets-wimplicit-function-declara", "closed_reason": "Duplicate", "title": "C -warning: implicit declaration of function \u2018gets\u2019 [-Wimplicit-function-declaration]", "body": "<p>I'm trying to input strings in my C structure but it says <strong><em>\"warning: implicit declaration of function \u2018gets\u2019 [-Wimplicit-function-declaration]\"</em></strong> I used to code in Dev-c ++ and I'm practicing at GCC does anyone can help me how to do it.</p>\n\n<p>here is my code:\npayroll.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include\"payroll.h\"\n\nvoid readName(p payroll[], int size){\n\nfgets(\"%s\",&amp;payroll[size].name.first);\n\n\n}\n</code></pre>\n\n<p>and in my payroll.h</p>\n\n<pre><code>struct namerec{\n\n    char first[15];\n    char middle[15];\n    char last[15];\n\n};\n\ntypedef struct payrecord{\n    int id;\n    struct namerec name;\n    float hours,rate;\n    float regular,overtime;\n    float gross, tax_whh, net;\n}p;\n\nvoid readName(p payroll[], int size);\nvoid printName(p payroll[], int size);\nvoid printSummary(double gross, double tax);\nvoid readRecord(p payroll[], int n);\nvoid printRecord(p payroll[], int n);\ndouble calcRecords(p payroll[], int n,double *taxptr);\n</code></pre>\n"}, {"tags": ["c", "operators", "expression", "language-lawyer"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1502889735, "post_id": 45714554, "comment_id": 78387641, "body": "I <b>think</b> the C standard doesn&#39;t even specify a <i>postfix operator</i>, only a <i>postfix expression</i>."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1502890048, "post_id": 45714554, "comment_id": 78387846, "body": "Does &quot;postfix expression&quot; have meaning outside C?"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 2, "creation_date": 1502891003, "post_id": 45714554, "comment_id": 78388561, "body": "language-lawyer questions can be interesting. But your latest ones seem to be in the form of &quot;Is an expression an expression&quot;?"}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "reply_to_user": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1502891393, "post_id": 45714554, "comment_id": 78388814, "body": "@bolov &quot;Is an expression an expression&quot;  I never asked anything like that. I don&#39;t think you understand my previous questions."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1502891559, "post_id": 45714554, "comment_id": 78388933, "body": "@FelixPalmen It mentions <i>postfix operator</i> in the title of the section, and writes about things like <code>[]</code> being a &quot;subscript operator&quot;. However, it does not mention &quot;infix operator&quot; anywhere in the standard, so I think OP&#39;s first question is moot."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1502891788, "post_id": 45714554, "comment_id": 78389103, "body": "@Tim don&#39;t take it so literally. In my opinion your questions deal with trivial or uninteresting standard wording. And by uninteresting I mean this: getting an answer for it won&#39;t change the way we program. What do I care if the standard calls <code>.</code> and <code>-&gt;</code>  infix operators, postfix operators, simply operators or anything else. It won&#39;t change the way I understand how they work, it won&#39;t change the way we use them in code, it won&#39;t change the way I explain them to students."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1502891984, "post_id": 45714554, "comment_id": 78389240, "body": "@IanAbbott My question is whether the standard follows the definition of postfix in general. Infix is a general concept outside of C, so is postfix. There is nothing moot in my questions."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1502892128, "post_id": 45714554, "comment_id": 78389331, "body": "<a href=\"https://www.youtube.com/watch?v=FFEoX2LFrVU\" rel=\"nofollow noreferrer\">youtube.com/watch?v=FFEoX2LFrVU</a>"}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1502892173, "post_id": 45714554, "comment_id": 78389358, "body": "@FelixPalmen The C Standard does define <code>postfix operators</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1502892189, "post_id": 45714554, "comment_id": 78389367, "body": "@Tim My guess is that the standard writers decided to keep the &quot;Postfix operators&quot; title for historical reasons after compound literals were added to the standard."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1502892455, "post_id": 45714554, "comment_id": 78389568, "body": "@Ian: Thanks. 1) What are the operands and operators of compound literal then? 2) Note that <code>-&gt;</code> and <code>.</code> have been there, unlike compound literals. That is another confusion."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1502892548, "post_id": 45714554, "comment_id": 78389635, "body": "The standard doesn&#39;t mention &quot;compound literal operator&quot; anywhere, so I&#39;d be disinclined to call it an operator, even though it is in the &quot;Postfix operators&quot; section. Rather, the &quot;compound literal&quot; is just a &quot;postfix expression&quot;."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1502892602, "post_id": 45714554, "comment_id": 78389679, "body": "@Ian So do you mean that it is possible that compound literals don&#39;t have operators?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1502892933, "post_id": 45714554, "comment_id": 78389956, "body": "@Tim &quot;<i>So do you mean that it is possible that compound literals don&#39;t have operators?</i>&quot; IMHO, yes. They could have called the section &quot;<i>Postfix operators and compound literals</i>&quot;, but that&#39;s a bit long-winded."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1502893367, "post_id": 45714554, "comment_id": 78390324, "body": "@Tim, I take your point about <code>.</code> and <code>-&gt;</code> being more like infix operators, but I tend to think of infix operators as operating on two <i>values</i> or <i>objects</i>. Besides, they have to call the section something, and &quot;<i>Postfix operators, structure and union member operators, and compound literals</i>&quot; doesn&#39;t have a nice ring to it. What would <i>you</i> call the section?"}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1502893608, "post_id": 45714554, "comment_id": 78390529, "body": "@IanAbbott I would need to understand the intention of the authors for grouping those operators under a section, to guess what name would be better. Note that  in general, postfix can take any finite number of operands, instead of just one, and is just listed after all its operands."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1502893868, "post_id": 45714554, "comment_id": 78390704, "body": "@Tim: &quot;Postfix&quot; is a good <i>enough</i> name for how these operators behave with respect to their operands.  They&#39;re all postfix-<i>ish</i>, at least.  Practicality wins out over pedantry."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1502894040, "post_id": 45714554, "comment_id": 78390828, "body": "@JohnBode I focus more on what the operator and operands are for each of the &quot;postfix expressions&quot;, than renaming the &quot;postfix expression&quot; section. So what do you think of what the operators and operands are for the &quot;postfix expressions&quot; in my post?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1502894740, "post_id": 45714554, "comment_id": 78391366, "body": "@Tim: What the language definition says they are.  The operands of the <code>[]</code> operator are the array expression and the index.  The operands of the <code>()</code> operator are the function expression and parameter expressions.  The operands of the <code>.</code> and <code>-&gt;</code> operators are the <code>struct</code> (or <code>struct</code> pointer) expressions and the member name.  They&#39;re lumped together with the postfix <code>++</code> and <code>--</code> operators to make sure they all have the same precedence."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1502894883, "post_id": 45714554, "comment_id": 78391463, "body": "@JohnBode Thanks. 1) What about compound literals? Do you think there is no operator or operand? 2) <code>()</code> and <code>[]</code> are unary operators, as mentioned in the accepted reply here <a href=\"https://stackoverflow.com/questions/45615818/in-a-function-call-what-is-the-operator-and-what-are-the-operands\" title=\"in a function call what is the operator and what are the operands\">stackoverflow.com/questions/45615818/&hellip;</a>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1502895535, "post_id": 45714554, "comment_id": 78391949, "body": "@Tim The intention of the grouping is to define the hierarchy of the different forms of expression; basically, operator precedence."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1503005503, "post_id": 45714554, "comment_id": 78447991, "body": "@Tim you could compare this with <a href=\"https://docs.python.org/3/reference/grammar.html\" rel=\"nofollow noreferrer\">the Python grammar</a> - many of the symbol names there are <i>completely ridiculous</i> (<code>test_nocond</code>, <code>testlist_comp</code>, <code>lambdef_nocond</code>)- but one just needs to invent <i>some</i> name for these non-terminals."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1502898390, "post_id": 45716830, "comment_id": 78393979, "body": "Thanks. I upvoted, though the standard doesn&#39;t address the confusions that I have. So it is unlike that &quot;All of this is pretty obvious if you read and understand the standard.&quot; I updated my post to explain more. 1. Instead of me &quot;call the parts that make up the language&quot;, it was the standard which calls the parts after <code>.</code>. and <code>-&gt;</code> as the second operands."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1502898404, "post_id": 45716830, "comment_id": 78393987, "body": "2. (a) and (b) The C standard doesn&#39;t say that &quot;it is after the postfix expression; that makes it a postfix operator.&quot; I am not sure what that mean either.  In general outside C, an operator is called postfix, if it appears after all its operands.  2(c)   my intuition from reading the books on C so far suggests that initialization parts are not   operands or operators, so I doubt that <code>{}</code> is part of the operator of compound literal."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1502899301, "post_id": 45716830, "comment_id": 78394625, "body": "I doubted. But your reply about it makes more sense. So I tended to think of <code>{}</code> as part of compound literal operator."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1502900070, "post_id": 45716830, "comment_id": 78395061, "body": "The Standard says that an operator is a punctuator that specifies an operation to be performed, and that <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.6p2\" rel=\"nofollow noreferrer\">&quot;other forms of operator also exist in some contexts&quot;</a>. Maybe the notation for compound literals should be thought of as belonging to this class."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 5, "last_activity_date": 1502901959, "last_edit_date": 1502901959, "creation_date": 1502895088, "answer_id": 45716830, "question_id": 45714554, "link": "https://stackoverflow.com/questions/45714554/how-to-understand-compound-literal-operator-and-are-postfix-operat/45716830#45716830", "title": "How to understand [], (), compound literal operator, . and -&gt; are postfix operators?", "body": "<ol>\n<li><p>The language specification defines the syntax, and doesn't care what you call the parts that make up the language.</p>\n\n<p>In <code>abc-&gt;def</code>, the first operand is <code>abc</code>, and <code>-&gt;</code> is the operator and <code>def</code> is the second operand, but it is restricted to an identifier is the name of a member of the structure or union of the type that the first operand (which may be a full-blown <code>postfix-expression</code>) identifies.  You can't write general expressions on the RHS of the <code>-&gt;</code> operator \u2014 <code>abc-&gt;3</code> doesn't work, and neither does <code>abc-&gt;(x + y)</code>.  Similar comments apply to the <code>.</code> operator, mutatis mutandis.</p>\n\n<p>If you want to think of this as an infix operator, you may do so.  That's your privilege.  It won't help you understand the standard.</p></li>\n<li><p>(a) The <code>[]</code> operator follows a postfix expression; it is after the postfix expression; that makes it a postfix operator.<br>\n(b) The <code>()</code> function-call operator follows a postfix expression; it is after a postfix expression; that makes it a postfix operator.<br>\n(c) The compound literal operator is all of <code>(type){</code> and <code>}</code>.  Since the <code>{ \u2026 }</code> comes after the <code>(type)</code> part, and since it behaves like other postfix operators in the syntax, it is reasonable to regard it as a postfix operator.  The standard says it is one; it really doesn't matter anyway.  The language works as specified.</p></li>\n<li><p>The cast operators are separately grouped, and a kind of 'prefix operator'.  They are distinct from compound literals.  The expression after a cast cannot start with an <code>{</code>; the literal after the 'cast notation' in a compound literal can only start with a <code>{</code>.  The presence or absence of <code>{</code> is determinative of whether the construct is a cast or a compound literal.</p></li>\n</ol>\n\n<p>All of this is pretty obvious if you read and understand the standard.</p>\n\n<hr>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>(a) and (b) The C standard doesn't say that \"it is after the postfix expression; that makes it a postfix operator.\" I am not sure what that mean either. In general outside C, an operator is called postfix, if it appears after all its operands.</li>\n  </ol>\n</blockquote>\n\n<p>The standard says that one of the ways of building a <em>postfix-expression</em> is:</p>\n\n<blockquote>\n  <p><em>postfix-expression</em> <code>[</code> <em>expression</em> <code>]</code></p>\n</blockquote>\n\n<p>From where I'm sitting, <em>\"The <code>[]</code> operator follows a postfix expression; it is after the postfix expression; that makes it a postfix operator\"</em> seems a reasonably accurate description of that portion of the syntax.  The <code>[</code> and <code>]</code> appear after a prior <em>postfix-expression</em>.  I'm not sure what else you'd understand by a 'postfix operator' than 'an operator that comes after something', and the <code>[]</code> comes after 'something'.</p>\n\n<blockquote>\n  <p>2(c) my intuition from reading the books on C so far suggests that initialization parts are not operands or operators, so I doubt that <code>{}</code> is part of the operator of compound literal.</p>\n</blockquote>\n\n<p>A compound literal consists of a type name enclosed in round brackets (parentheses) followed by an initializer list enclosed in curly brackets (braces).  It takes all of that to make a compound literal.  I don't see how the <code>{}</code> could not be a part of the compound literal \u2014 the syntax says it is, and \u2026 well, if you want to think of it as something separate, I can't stop you, but you're making your own life more difficult by doing so and making life very difficult for those people on SO trying to help you.  It really isn't clear from this side of my screen how you manage to come up with these new ways to misinterpret the plain text of the standard so cleverly and deviously.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1502904390, "last_edit_date": 1502904390, "creation_date": 1502902530, "answer_id": 45719146, "question_id": 45714554, "link": "https://stackoverflow.com/questions/45714554/how-to-understand-compound-literal-operator-and-are-postfix-operat/45719146#45719146", "title": "How to understand [], (), compound literal operator, . and -&gt; are postfix operators?", "body": "<p><strong>Edit</strong></p>\n\n<p>I'm operating on a bit of a sleep deficit, combined with a little too much coffee, so my mental processes aren't operating as clearly as they could, hence the confused sludge in my original response.</p>\n\n<p>These operators are called \"postfix operators\" because they follow a <em>postfix-expression</em>, not because of the number or position of their operands.  Similarly, prefix operators are called \"unary operators\" because they precede a <em>unary-expression</em>.  \"Cast operators\" precede a <em>cast-expression</em>, \"multiplicative operators\" follow <em>multiplicative-expressions</em>, etc.  IOW, the operators are named for the types of expressions they apply to, not because of the operator's intrinsic properties.  </p>\n\n<p><strong>Original</strong></p>\n\n<p>You're overthinking things to an extent.</p>\n\n<p>The primary reason <code>()</code>, <code>[]</code>, <code>.</code>, <code>-&gt;</code>, and compound literals are grouped with postfix <code>++</code> and <code>--</code> is to make sure they all have the same (highest level of) precedence; that expressions like <code>&amp;a[i]</code>, <code>*f(x)</code>, and <code>a + b-&gt;c</code> are all <em>parsed</em> as <code>&amp;(a[i])</code>, <code>*(f(x))</code>, and <code>a + (b-&gt;c)</code>.  The choice of the term \"postfix\" to describe these operators is unfortunate if you insist on being pedantic about its meaning<sup>1</sup>, but it kinda-sorta makes sense in context.  The main reason they're called \"postfix operators\" is that they follow a <em>postfix-expression</em>, not because of the number or position of operands.  </p>\n\n<p>The language standard is <em>mostly</em> well-written and precise, but there are some areas where it could be better.  This may be one of those areas.  </p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>Note that the standard uses \"unary\" as opposed to \"prefix\" to describe the leading <code>*</code>, <code>&</code>, <code>++</code>, <code>--</code>, and <code>sizeof</code> operators, even though they hew far more closely to the idea of a prefix operator than the postfix operators do.  Again, it's because these operators precede a <em>unary-expression</em>, not because of the number or position of operands.\n</ol>\n\n<p></sup></p>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 45716830, "answer_count": 2, "score": -6, "last_activity_date": 1502904390, "creation_date": 1502889134, "last_edit_date": 1502897139, "question_id": 45714554, "link": "https://stackoverflow.com/questions/45714554/how-to-understand-compound-literal-operator-and-are-postfix-operat", "title": "How to understand [], (), compound literal operator, . and -&gt; are postfix operators?", "body": "<p>In its own definition, a postfix operator is an operator specified after all of its operands.</p>\n\n<p>In C11 Standard, a postfix operator is defined as:</p>\n\n<blockquote>\n  <p>6.5.2  Post\ufb01x operators</p>\n  \n  <p>Syntax</p>\n\n<pre><code>post\ufb01x-expression:\n\n    primary-expression\n    post\ufb01x-expression [ expression ]\n    post\ufb01x-expression ( argument-expression-listopt )\n    post\ufb01x-expression . identi\ufb01er\n    post\ufb01x-expression -&gt; identi\ufb01er\n    post\ufb01x-expression ++\n    post\ufb01x-expression --\n    ( type-name ) { initializer-list }\n    ( type-name ) { initializer-list , }\n</code></pre>\n</blockquote>\n\n<ol>\n<li><p>The standard calls the two parts before and after <code>.</code> and <code>-&gt;</code> as\noperands, which I highlighted in bold in the following quote. Does it mean <code>.</code> and <code>-&gt;</code> are actually infix\noperators, in spite of being called postfix operators in the\nstandard?</p>\n\n<blockquote>\n  <p>6.5.2.3  Structure and union members</p>\n  \n  <p>Constraints</p>\n  \n  <p>1 <strong>The  \ufb01rst  operand</strong>  of  the . operator  shall  have  an atomic, \n  quali\ufb01ed,  or  unquali\ufb01ed structure or union type, and <strong>the second\n  operand</strong> shall name a member of that type.</p>\n  \n  <p>2 <strong>The  \ufb01rst  operand</strong>  of  the -> operator  shall  have  type \n  \u2018\u2018pointer  to  atomic,  quali\ufb01ed,  or unquali\ufb01ed  structure\u2019\u2019 or\n  \u2018\u2018pointer  to  atomic,  quali\ufb01ed,  or  unquali\ufb01ed  union\u2019\u2019,  and  <strong>the\n  second operand</strong> shall name a member of the type pointed to.</p>\n</blockquote></li>\n<li><p>The subsections for  <code>[]</code>, <code>()</code> and compound literals don't mention\nthe word \"operands\". So </p>\n\n<ul>\n<li>are <code>[]</code>  and <code>()</code> both unary postfix operators, with a (function) pointer name before them as their only operand, and what inside <code>[]</code> and <code>()</code> are not operands?  This is what <a href=\"https://stackoverflow.com/a/45616000/156458\">the accpeted reply</a> says <a href=\"https://stackoverflow.com/questions/45615818/in-a-function-call-what-is-the-operator-and-what-are-the-operands\">In a function call, what is the operator, and what are the operands?</a></li>\n<li>What is the operator of  compound literals, <code>()</code>, <code>(type-name)</code> or something else? <code>initializer-list</code> within <code>{}</code> might be not operand(s), just like the array index in <code>[]</code> and function arguments in <code>()</code>. <code>{}</code> might be not part of the operator, because it is used for enclosing the initializers. If the operator of compound literals is <code>(type-name)</code>, does the compound literal operator not take any operand?</li>\n</ul></li>\n<li><p>Although cast operators are not postfix operators in C, it looks confusingly almost the\nsame as compound literal operators.</p>\n\n<blockquote>\n  <p>6.5.4  Cast operators Syntax</p>\n\n<pre><code>cast-expression:\n\n    unary-expression\n    ( type-name ) cast-expression\n</code></pre>\n  \n  <p>Constraints 2 Unless the type name speci\ufb01es a void type, the type name\n  shall specify atomic, quali\ufb01ed, or unquali\ufb01ed scalar type, and the\n  <strong>operand</strong> shall have scalar type.</p>\n</blockquote>\n\n<p>So is a cast operator <code>()</code> or <code>(type-name)</code>? Is its operand\n<code>cast-expression</code>, or both <code>type-name</code> and <code>cast-expression</code>?</p></li>\n</ol>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "timer", "sensors", "iot", "contiki"], "comments": [{"owner": {"reputation": 51, "user_id": 6093781, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/aAWDS.jpg?s=128&g=1", "display_name": "vrizz", "link": "https://stackoverflow.com/users/6093781/vrizz"}, "reply_to_user": {"reputation": 2575, "user_id": 4711812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87100b6114369140256e64e7ebab7ec9?s=128&d=identicon&r=PG&f=1", "display_name": "muXXmit2X", "link": "https://stackoverflow.com/users/4711812/muxxmit2x"}, "edited": false, "score": 0, "creation_date": 1502889108, "post_id": 45714363, "comment_id": 78387139, "body": "I&#39;ve tried with RTIMER_NOW(), but it returns a value of rtimer_clock_t type and I need int. My goal is to be able to distinguish at the Receiver which message has been prepared later than the other"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6093781, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/aAWDS.jpg?s=128&g=1", "display_name": "vrizz", "link": "https://stackoverflow.com/users/6093781/vrizz"}, "edited": false, "score": 0, "creation_date": 1502890696, "post_id": 45715040, "comment_id": 78388312, "body": "OK, but I don&#39;t need this, the mote output comes from Cooja and I want to be able to access the time"}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "reply_to_user": {"reputation": 51, "user_id": 6093781, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/aAWDS.jpg?s=128&g=1", "display_name": "vrizz", "link": "https://stackoverflow.com/users/6093781/vrizz"}, "edited": false, "score": 0, "creation_date": 1502891321, "post_id": 45715040, "comment_id": 78388772, "body": "So get output from Cooja, store it and then convert it like i did ? <code>char * input = CoojaOutput</code> Thats exactly what you asked for."}, {"owner": {"reputation": 51, "user_id": 6093781, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/aAWDS.jpg?s=128&g=1", "display_name": "vrizz", "link": "https://stackoverflow.com/users/6093781/vrizz"}, "edited": false, "score": 0, "creation_date": 1502893396, "post_id": 45715040, "comment_id": 78390347, "body": "Yes, but in this way I have to access the text script, and I want to avoid, I would like to use functions like RTIMER_NOW() ad so on. Thank you"}, {"owner": {"reputation": 51, "user_id": 6093781, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/aAWDS.jpg?s=128&g=1", "display_name": "vrizz", "link": "https://stackoverflow.com/users/6093781/vrizz"}, "edited": false, "score": 0, "creation_date": 1502894005, "post_id": 45715040, "comment_id": 78390800, "body": "maybe a function like clock_second() but getting millisec could be better.."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "reply_to_user": {"reputation": 51, "user_id": 6093781, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/aAWDS.jpg?s=128&g=1", "display_name": "vrizz", "link": "https://stackoverflow.com/users/6093781/vrizz"}, "edited": false, "score": 0, "creation_date": 1502894678, "post_id": 45715040, "comment_id": 78391320, "body": "Then multiply seconds * 1000 and youve got miliseconds."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "reply_to_user": {"reputation": 51, "user_id": 6093781, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/aAWDS.jpg?s=128&g=1", "display_name": "vrizz", "link": "https://stackoverflow.com/users/6093781/vrizz"}, "edited": false, "score": 0, "creation_date": 1502896145, "post_id": 45715040, "comment_id": 78392352, "body": "So maybe its time to create <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> since your question doesnt contain much informations."}], "tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 0, "last_activity_date": 1502890355, "creation_date": 1502890355, "answer_id": 45715040, "question_id": 45714363, "link": "https://stackoverflow.com/questions/45714363/contiki-timestamp-value-as-int/45715040#45715040", "title": "Contiki Timestamp value as int", "body": "<p>I would recommend you to use function <a href=\"http://www.cplusplus.com/reference/cstring/strtok/\" rel=\"nofollow noreferrer\">strtok()</a> to find string you need i.e. <code>00</code> or <code>39</code>.</p>\n\n<p>and <a href=\"http://www.cplusplus.com/reference/cstdlib/strtol/\" rel=\"nofollow noreferrer\"><code>strtol()</code></a> to conversion from string to long integer. Anyway, stay <strong>away</strong> from <code>atoi()</code>.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/17710018/why-shouldnt-i-use-atoi\">Why shouldn't one use atoi()</a>.</p>\n\n<p>Here is example, convertion from minutes/seconds to miliseconds is up to you.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char input[] = \"00:39.841   ID:6    unicast message ready to be sent\";\n    char * ptr;\n\n\n    long minutes  = 0,\n         seconds  = 0,\n         milisecs = 0;\n\n    ptr     = strtok(input, \":\");\n    if (ptr == NULL) { fprintf(stderr, \"Wrong input minutes.\"); return 1; }\n    minutes = strtol(ptr, (char **)NULL, 10);\n\n    ptr     = strtok(&amp;input[3], \".\");\n    if (ptr == NULL) { fprintf(stderr, \"Wrong input seconds.\"); return 1; }\n    seconds = strtol(ptr, (char **)NULL, 10);\n\n    ptr     = strtok(&amp;input[6], \" \");\n    if (ptr == NULL) { fprintf(stderr, \"Wrong input milisecs.\"); return 1; }\n    milisecs = strtol(ptr, (char **)NULL, 10);\n\n    printf(\"%ld - %ld - %ld\\n\", minutes, seconds, milisecs);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6093781, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/aAWDS.jpg?s=128&g=1", "display_name": "vrizz", "link": "https://stackoverflow.com/users/6093781/vrizz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502890355, "creation_date": 1502888689, "question_id": 45714363, "link": "https://stackoverflow.com/questions/45714363/contiki-timestamp-value-as-int", "title": "Contiki Timestamp value as int", "body": "<p>I would like to send the value of the timestamp of a simulation as int. To be more clear, if the mote output is:</p>\n\n<pre><code>00:39.841   ID:6    unicast message ready to be sent\n</code></pre>\n\n<p>I want to be able to put in my message the value 00:39.841 in milliseconds. How can I do?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "compiler-construction", "lexical-analysis"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1502888878, "post_id": 45714323, "comment_id": 78386955, "body": "Note: <code>strspn()</code> and <code>strcspn()</code> are handy functions. (and <code>strtok()</code> is a disaster waiting to happen;-) And: IMHO there is too much state floating around in this lexer."}, {"owner": {"reputation": 473, "user_id": 4028638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d3666e4dc1f9952bc22d1d77484497f?s=128&d=identicon&r=PG&f=1", "display_name": "vadim_hr", "link": "https://stackoverflow.com/users/4028638/vadim-hr"}, "edited": false, "score": 0, "creation_date": 1502889107, "post_id": 45714323, "comment_id": 78387138, "body": "Did you look into &quot;Recursive descent parser&quot; (here for example  <a href=\"https://en.wikipedia.org/wiki/Recursive_descent_parser\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Recursive_descent_parser</a>)?"}, {"owner": {"reputation": 1, "user_id": 8472080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3140a9895ec7bca63adc2b0aa582bf9?s=128&d=identicon&r=PG&f=1", "display_name": "Sanju", "link": "https://stackoverflow.com/users/8472080/sanju"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1502889330, "post_id": 45714323, "comment_id": 78387314, "body": "@wildplasser too much state?"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1502889653, "post_id": 45714323, "comment_id": 78387580, "body": "Please note that, since C99, including <code>&lt;stdbool.h&gt;</code> you can use <code>true</code> and <code>false</code>."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1502890085, "post_id": 45714323, "comment_id": 78387877, "body": "Also note that with <code>&quot; \\t\\r\\n\\v\\f(){};&quot;&quot;&quot;</code> the preprocessor is adding an empty literal string to <code>&quot; \\t\\r\\n\\v\\f(){};&quot;</code>. You probably wanted something like <code>char delimit[]=&quot; \\t\\r\\n\\v\\f(){};\\&quot;\\&#39;&quot;;</code>."}, {"owner": {"reputation": 1205, "user_id": 2655905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b78614e85e3c08eed9e43ab7197a90f3?s=128&d=identicon&r=PG", "display_name": "Stuart", "link": "https://stackoverflow.com/users/2655905/stuart"}, "edited": false, "score": 1, "creation_date": 1502893040, "post_id": 45714323, "comment_id": 78390042, "body": "I don&#39;t know what you mean by &quot;the arrays which are printed in the last just mix up each other and some another input is generated&quot;. It would make it easier to assist you if you showed the input you are putting in, the output you are getting and the output you are expecting."}], "owner": {"reputation": 1, "user_id": 8472080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3140a9895ec7bca63adc2b0aa582bf9?s=128&d=identicon&r=PG&f=1", "display_name": "Sanju", "link": "https://stackoverflow.com/users/8472080/sanju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 836, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1502888699, "creation_date": 1502888605, "last_edit_date": 1502888699, "question_id": 45714323, "link": "https://stackoverflow.com/questions/45714323/lexical-analyser-using-c", "title": "Lexical Analyser using C", "body": "<p>I have done the program as reading a string and then converted to a file input. For a single line, it is getting output. I also want to display character,integer and floating point constants and symbols in the output.\nFor a multiline or for a c program as input, the arrays which are printed in the last just mix up each other and some another input is generated. Anyone have idea how this happen?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;ctype.h&gt; \n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\n#define KEYWORDS 32\n#define OPERATORS 25\n#define DEBUG_MODE 1\n\ntypedef enum {FALSE,TRUE} boolean;\n\nchar *trimString(char *str)\n{\n  char *end;\n\n  // Trim leading space\n  while(isspace((unsigned char)*str)) str++;\n\n  if(*str == 0)  // All spaces?\n    return str;\n\n  // Trim trailing space\n  end = str + strlen(str) - 1;\n  while(end &gt; str &amp;&amp; isspace((unsigned char)*end)) end--;\n\n  // Write new null terminator\n  *(end+1) = 0;\n\n  return str;\n}\n\nint main()\n{\n    char delimit[]=\" \\t\\r\\n\\v\\f(){};\"\"\";\n    char str[80],filename[40],*token,*keyword[30],*identifier[30],*operator[30],*literal[30],tmp[80];\n    int state=0,i=0,j=0,k=0,l=0,m=0,c,ch=0,isKeyword=0,isOperator=0;\n    boolean isComment=FALSE;\n\n    char* key[] = {\"auto\",\"break\", \"case\", \"char\", \"const\", \"continue\", \"default\", \"do\", \"double\", \"else\", \"enum\", \"extern\", \"float\", \"for\", \"goto\", \"if\", \"int\", \"long\",\"register\", \"return\", \"short\",\"signed\", \"sizeof\", \"static\",\"struct\", \"switch\",\"typedef\",\"union\", \"unsigned\", \"void\",\"volatile\", \"while\"};\n\n    char* operators[] = {\"+\", \"-\", \"/\", \"*\", \"%\", \"=\", \"+=\", \"++\", \"--\", \"-=\", \"*=\", \"/=\", \"%=\", \"==\", \"&gt;\", \"&lt;\", \"!=\", \"&gt;=\", \"&lt;=\", \"&amp;&amp;\", \"||\", \"!\", \"&lt;&lt;\", \"&gt;&gt;\", \"sizeof\"};\n\n    printf(\"Enter the filename: \");\n    gets(filename);\n\n    FILE* file = fopen(filename, \"r\");\n\n    if(file==NULL)\n    {\n        printf(\"\\nError opening file with filename : \\'%s\\'!!\\n\\n\",filename);\n        exit(0);\n    }\n    while (fgets(str, sizeof(str), file))\n    {   \n        //Skip=FALSE;\n        str[sizeof(str)-1]='\\0';\n        if((str[0]=='#') || (str[0]=='\\n')) //remove preprocessor directives and blank lines\n            goto gotoNextLine;\n\n        if(str[0]=='/')\n        {\n            if(str[1]=='/')\n                goto gotoNextLine;\n            else if(str[1]=='*')\n            {\n                isComment=TRUE;\n                goto gotoNextLine;\n            }\n        }\n\n\n        if(DEBUG_MODE)      \n            printf(\"\\n\\n**isComment=%d**\\n\\n\",isComment);\n\n        if(isComment)       // skip block comments\n        {   \n            c=0;\n            while(str[c]!='\\0')\n            {\n                if(str[c]=='*')\n                {\n                    if(str[c+1]=='/')\n                    {\n                        isComment=FALSE;\n                        for (i=c+2; str[i]!='\\0'; i++) \n                            tmp[ch++] = str[i];\n                        strcpy(str,tmp);\n                        break;\n                    }\n\n                }\n                if(DEBUG_MODE)\n                    printf(\"\\n\\n**The comment loop**\\n\\n\");\n                c++;\n            }\n        }\n\n        if(!isComment)\n        {\n            for (token = strtok(str, delimit); token != NULL; token = strtok(NULL, delimit)) \n            {   \n                isKeyword=0;\n                isOperator=0;\n\n                if(DEBUG_MODE)      \n                    printf(\"\\n\\n**token=%s**\\n\\n\",token);\n\n                for (i=0;i&lt;OPERATORS;i++)\n                {\n                    if(!strcmp(trimString(token),operators[i]))\n                    {\n                        isOperator=1;\n                        operator[l++]=token;\n                        break;//goto nextToken;\n                    }\n                }\n\n                if(DEBUG_MODE)      \n                    printf(\"\\n\\n**isOperator=%d**\\n\\n\",isOperator);\n\n                if(!isOperator)\n                {\n                    for (i=0;i&lt;KEYWORDS;i++)\n                    {\n                        if(!strcasecmp(trimString(token),key[i]))\n                        {\n                            isKeyword=1;\n                            keyword[j++]=token;\n                            break;//goto nextToken;\n                        }\n                    }\n                }\n\n\n                if(DEBUG_MODE)      \n                    printf(\"\\n\\n**isKeyword=%d**\\n\\n\",isKeyword);\n\n\n                if(!isKeyword &amp;&amp; !isOperator)           \n                {\n                    i=ch=state=0;\n                    if(token[0]=='\"')\n                    {\n                        for (i=1; str[i]!='\"'; i++) \n                            tmp[ch++] = token[i];\n                        strcpy(token,tmp);\n                        literal[m++]=token;\n                        goto nextToken;\n                    }\n                    while(token[i]!='\\0')\n                    {\n                        if((token[0]=='#') || (token[0]=='\\n'))\n                            goto nextToken;\n                        switch(state)\n                        {\n                            case 0: if(isalpha(token[i]) || token[i]=='_')\n                                {\n                                    state=1;\n                                    i++;\n                                }\n                                else\n                                    state=2;\n                                break;\n                            case 1: if(isalnum(token[i]) || token[i]=='_')  \n                                {\n                                    state=1;\n                                    i++;\n                                }\n                                else\n                                    state=2;\n                                break;\n                            case 2: goto nextToken;\n                        }\n\n                    }\n\n                    if(state==1)\n                    {\n                        identifier[k++]=token;\n                        if(DEBUG_MODE)      \n                            printf(\"\\n\\n**Identifier_True=%s**\\n\\n\",token);\n\n                    }\n                }\n\n                nextToken: ;\n            }\n        }\n        gotoNextLine: ;\n    }\n\n    if(DEBUG_MODE)      \n        printf(\"\\n\\n**Keywords_Count=%d**\\n\\n\",j);\n\n    if(j)\n    {\n        printf(\"\\nKeywords: \\n\");\n        for(i=0;i&lt;j;i++)\n        {\n            printf(\"%s\",keyword[i]);\n            if((i+1)&lt;j)\n                printf(\", \");   \n        }\n        printf(\"\\n\");\n    }\n\n    if(DEBUG_MODE)      \n        printf(\"\\n\\n**Operators_Count=%d**\\n\\n\",l);\n\n    if(l)\n    {\n        printf(\"\\nOperators: \\n\");\n        for(i=0;i&lt;l;i++)\n        {\n            printf(\"%s\",operator[i]);\n            if((i+1)&lt;l)\n                printf(\", \");\n        }\n        printf(\"\\n\");\n    }\n\n    if(DEBUG_MODE)      \n        printf(\"\\n\\n**Identifiers_Count=%d**\\n\\n\",k);\n\n    if(k)\n    {\n        printf(\"\\nIdentifiers: \\n\");\n        for(i=0;i&lt;k;i++)\n        {\n            printf(\"%s\",identifier[i]);\n            if((i+1)&lt;k)\n                printf(\", \");   \n        }\n    }\n\n\n    printf(\"\\n\");\n    fclose(file);\n\n}\n</code></pre>\n"}, {"tags": ["c", "bit-fields"], "comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1502889002, "post_id": 45714318, "comment_id": 78387050, "body": "Prepare an instance with well-recognizable bit patterns for each field, <code>memcpy</code> it to a suitably sized <code>unsigned char</code> array and see where each field has gone."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7931482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe68ad32803b3229d8de1654c99a965?s=128&d=identicon&r=PG&f=1", "display_name": "danielwestfall", "link": "https://stackoverflow.com/users/7931482/danielwestfall"}, "edited": false, "score": 0, "creation_date": 1502890254, "post_id": 45714458, "comment_id": 78387997, "body": "Sorry to sound like a complete beginner but what is ABI? And where can I check it?"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 1, "user_id": 7931482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe68ad32803b3229d8de1654c99a965?s=128&d=identicon&r=PG&f=1", "display_name": "danielwestfall", "link": "https://stackoverflow.com/users/7931482/danielwestfall"}, "edited": false, "score": 0, "creation_date": 1502890393, "post_id": 45714458, "comment_id": 78388086, "body": "@danielwestfall <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Application_binary_interface</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1, "user_id": 7931482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe68ad32803b3229d8de1654c99a965?s=128&d=identicon&r=PG&f=1", "display_name": "danielwestfall", "link": "https://stackoverflow.com/users/7931482/danielwestfall"}, "edited": false, "score": 0, "creation_date": 1502890415, "post_id": 45714458, "comment_id": 78388107, "body": "@danielwestfall The ABI is the &quot;application binary interface&quot;, a low-level framework for your specific system that specifies how things are allocated in memory, among other things."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1502888908, "creation_date": 1502888908, "answer_id": 45714458, "question_id": 45714318, "link": "https://stackoverflow.com/questions/45714318/determine-order-of-a-bitfield-c/45714458#45714458", "title": "Determine Order of a Bitfield C", "body": "<p>According to <code>C11</code>, chapter \u00a76.7.2.1/P11</p>\n\n<blockquote>\n  <p>[....] The order of allocation of bit-fields within a unit (high-order to\n  low-order or low-order to high-order) is implementation-defined. The alignment of the\n  addressable storage unit is unspecified.</p>\n</blockquote>\n\n<p>The best way to know, is to check your compiler documentation and the ABI on your platform.</p>\n"}], "owner": {"reputation": 1, "user_id": 7931482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe68ad32803b3229d8de1654c99a965?s=128&d=identicon&r=PG&f=1", "display_name": "danielwestfall", "link": "https://stackoverflow.com/users/7931482/danielwestfall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 790, "favorite_count": 0, "closed_date": 1502890495, "answer_count": 1, "score": 0, "last_activity_date": 1502890522, "creation_date": 1502888593, "question_id": 45714318, "link": "https://stackoverflow.com/questions/45714318/determine-order-of-a-bitfield-c", "closed_reason": "Duplicate", "title": "Determine Order of a Bitfield C", "body": "<p>How do I determine the order of a bitfield? I can change an element of a bitfield by doing x.c where x is a variable of the struct type. I have tried to bitmask it and print it out, but I can only print each element in the struct and not the entire variable. I have tried to assign a pointer to the elements of a bitfield but it comes up with an error. What is the best way to determine the order of a bitfield for a C compiler? For example which order would this struct be represented as?</p>\n\n<pre><code>struct bit_fields\n{\nunsigned int a : 6,\n             b : 8,\n             c : 18;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1502887528, "post_id": 45713899, "comment_id": 78385867, "body": "did you enable optimization? did you check the generated assembly?"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1502887531, "post_id": 45713899, "comment_id": 78385872, "body": "I believe this is compiler dependant and of course, platform too."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502887541, "post_id": 45713899, "comment_id": 78385875, "body": "1.) measure two otherwise <b>identical</b> programs for something reliable 2.) enable compiler optimizations."}, {"owner": {"reputation": 190, "user_id": 934925, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/60a5ebb06cd3d8c76a3d62afe255f14e?s=128&d=identicon&r=PG", "display_name": "Rajat Kothari", "link": "https://stackoverflow.com/users/934925/rajat-kothari"}, "edited": false, "score": 0, "creation_date": 1502887652, "post_id": 45713899, "comment_id": 78385964, "body": "GCC version used: 4.8.5 20150623"}, {"owner": {"reputation": 190, "user_id": 934925, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/60a5ebb06cd3d8c76a3d62afe255f14e?s=128&d=identicon&r=PG", "display_name": "Rajat Kothari", "link": "https://stackoverflow.com/users/934925/rajat-kothari"}, "edited": false, "score": 0, "creation_date": 1502887686, "post_id": 45713899, "comment_id": 78385991, "body": "Yes compiled with both optimization flag enabled/disabled still results are pretty much same"}, {"owner": {"reputation": 190, "user_id": 934925, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/60a5ebb06cd3d8c76a3d62afe255f14e?s=128&d=identicon&r=PG", "display_name": "Rajat Kothari", "link": "https://stackoverflow.com/users/934925/rajat-kothari"}, "edited": false, "score": 0, "creation_date": 1502887721, "post_id": 45713899, "comment_id": 78386015, "body": "Please mention reasons in comment for downvoting"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502887781, "post_id": 45713899, "comment_id": 78386055, "body": "Can you show us <i>how</i> you build it? And have you compared the generated (assembly) code of the two loops (with optimizations enabled)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1502887818, "post_id": 45713899, "comment_id": 78386081, "body": "Your method is flawed. Doing the same thing <b>twice</b> will probably benefit from e.g. cache. Use two separate programs. And then, this test case is silly, a good optimizing compiler could decide not to emit a loop <i>at all</i>."}, {"owner": {"reputation": 190, "user_id": 934925, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/60a5ebb06cd3d8c76a3d62afe255f14e?s=128&d=identicon&r=PG", "display_name": "Rajat Kothari", "link": "https://stackoverflow.com/users/934925/rajat-kothari"}, "edited": false, "score": 0, "creation_date": 1502887847, "post_id": 45713899, "comment_id": 78386101, "body": "Used online compiler link: <a href=\"https://www.tutorialspoint.com/compile_c_online.php\" rel=\"nofollow noreferrer\">tutorialspoint.com/compile_c_online.php</a>, updated built command as gcc -O3 -Wall -o main *.c"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1502890422, "post_id": 45713899, "comment_id": 78388114, "body": "Change the order of the tests and see what happens."}], "answers": [{"comments": [{"owner": {"reputation": 190, "user_id": 934925, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/60a5ebb06cd3d8c76a3d62afe255f14e?s=128&d=identicon&r=PG", "display_name": "Rajat Kothari", "link": "https://stackoverflow.com/users/934925/rajat-kothari"}, "edited": false, "score": 0, "creation_date": 1502888465, "post_id": 45714163, "comment_id": 78386617, "body": "please can you share the result as well as the compilers used."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1502888488, "post_id": 45714163, "comment_id": 78386635, "body": "While you should add a &quot;<i>most likely</i>&quot; or something (you <b>could</b> find a compiler generating different code from these inputs), it&#39;s still a good answer."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502888506, "post_id": 45714163, "comment_id": 78386651, "body": "You can do it yourself"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 3, "last_activity_date": 1502888647, "last_edit_date": 1502888647, "creation_date": 1502888193, "answer_id": 45714163, "question_id": 45713899, "link": "https://stackoverflow.com/questions/45713899/why-ifi-is-taking-more-time-than-if0-i/45714163#45714163", "title": "Why if(i) is taking more time than if(0 != i)", "body": "<p>It is not the truth. The code is exactly the same. Have checked with 4 popular compilers:</p>\n\n<p>examples gcc x86-64</p>\n\n<p>-O0</p>\n\n<pre><code>if(i)\n    cmp     DWORD PTR [rbp-4], 0\n    je      .L3\n\nif(0 != i)\n    cmp     DWORD PTR [rbp-4], 0\n    je      .L7\n</code></pre>\n\n<p>-O3</p>\n\n<pre><code>if(i) ....\n    test    rax, rax\n    lea     ebx, [rdx+1]\n    jne     .L13\n    mov     ebx, edx\n    jmp     .L3\n\nif(0 != i) ...\n    test    rax, rax\n    lea     ebx, [rdx+1]\n    jne     .L15\n    mov     ebx, edx\n    jmp     .L6\n</code></pre>\n\n<p>PS I hate this ridiculous form <code>0 != i</code> instead of <code>i != 0</code></p>\n\n<p>PS2 maybe somewhere in the universe exist C compilers generating different code for those conditions but <code>i</code> is an exact equivalent of <code>i != 0</code> so it quite difficult to imagine, but everything is possible.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 0, "last_activity_date": 1502889464, "creation_date": 1502889464, "answer_id": 45714688, "question_id": 45713899, "link": "https://stackoverflow.com/questions/45713899/why-ifi-is-taking-more-time-than-if0-i/45714688#45714688", "title": "Why if(i) is taking more time than if(0 != i)", "body": "<p>This is just wrong, but your method is flawed. You should make sure your program does only <strong>one</strong> of the tests at a time and you should make sure that the loop <strong>needs</strong> to execute. Here's a modified version that corrects these methodic issues:</p>\n\n<pre><code>#include &lt;sys/time.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint test1(void)\n{\n    int j = 0;\n    int i;\n    for(i = 0; i &lt; 0xFFFFFF; i++)\n    {\n        int x = rand();\n        if(x)\n        {\n            j++;\n        }\n    }\n    return j;\n}\n\nint test2(void)\n{\n    int j = 0;\n    int i;\n    for(i = 0; i &lt; 0xFFFFFF; i++)\n    {\n        int x = rand();\n        if(0 != x)\n        {\n            j++;\n        }\n    }\n    return j;\n}\n\nint main(int argc, char **argv)\n{\n    int which = 0;\n    if (argc&gt;1) which = atoi(argv[1]);\n    srand(1);\n\n    struct timeval lBefore,lAfter,lResult;\n\n    timerclear(&amp;lBefore);\n    timerclear(&amp;lAfter);\n    gettimeofday(&amp;lBefore,NULL);\n\n    int j = which ? test2() : test1();\n\n    gettimeofday(&amp;lAfter,NULL);\n    timersub(&amp;lAfter,&amp;lBefore,&amp;lResult);\n    printf(\"[%d]%ld:%ld\\n\",j,lResult.tv_sec,lResult.tv_usec);   \n}\n</code></pre>\n\n<p>Results on the website you linked:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>sh-4.2$ main 0\n[16777215]0:199145\nsh-4.2$ main 0\n[16777215]0:211709\nsh-4.2$ main 0\n[16777215]0:193211\nsh-4.2$ main 0\n[16777215]0:184544\nsh-4.2$ main 0\n[16777215]0:196465\nsh-4.2$ main 1\n[16777215]0:202904\nsh-4.2$ main 1\n[16777215]0:206235\nsh-4.2$ main 1\n[16777215]0:183214\nsh-4.2$ main 1\n[16777215]0:203317\nsh-4.2$ main 1\n[16777215]0:207389\n</code></pre>\n\n<p>So you see there's no difference at all.</p>\n"}], "owner": {"reputation": 190, "user_id": 934925, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/60a5ebb06cd3d8c76a3d62afe255f14e?s=128&d=identicon&r=PG", "display_name": "Rajat Kothari", "link": "https://stackoverflow.com/users/934925/rajat-kothari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1502892829, "creation_date": 1502887473, "last_edit_date": 1502892829, "question_id": 45713899, "link": "https://stackoverflow.com/questions/45713899/why-ifi-is-taking-more-time-than-if0-i", "title": "Why if(i) is taking more time than if(0 != i)", "body": "<p>Why if(i) is taking more time than if(0 != i), please suggest which is a better way to check for arguments to a function.</p>\n\n<p>Please find below code snippet:</p>\n\n<pre><code>#include &lt;sys/time.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    struct timeval  lBefore,lAfter,lResult;\n    int i,j = 0;\n\n    timerclear(&amp;lBefore);\n    timerclear(&amp;lAfter);\n\n    gettimeofday(&amp;lBefore,NULL);\n\n    for(i = 0; i &lt; 0xFFFFFF; i++)\n    {\n        if(i)\n        {\n            j++;\n        }\n    }\n\n    gettimeofday(&amp;lAfter,NULL);\n\n    timersub(&amp;lAfter,&amp;lBefore,&amp;lResult);\n\n    printf(\"[%d]%ld:%ld\\n\",j,lResult.tv_sec,lResult.tv_usec);\n\n    j = 0;\n\n    gettimeofday(&amp;lBefore,NULL);\n\n    for(i = 0; i &lt; 0xFFFFFF; i++)\n    {\n        if(0 != i)\n        {\n            j++;\n        }\n    }\n\n    gettimeofday(&amp;lAfter,NULL);\n\n    timersub(&amp;lAfter,&amp;lBefore,&amp;lResult);\n\n    printf(\"[%d]%ld:%ld\\n\",j,lResult.tv_sec,lResult.tv_usec);\n\n    return 0;\n}\n</code></pre>\n\n<p>Code output:</p>\n\n<pre><code>sh-4.2$ main\n</code></pre>\n\n<blockquote>\n  <p>[16777214]0:79030<br>\n  [16777214]0:55605<br>\n  sh-4.2$ main<br>\n  [16777214]0:76910<br>\n  [16777214]0:53657<br>\n  sh-4.2$ main<br>\n  [16777214]0:74696<br>\n  [16777214]0:51295</p>\n</blockquote>\n"}, {"tags": ["c", "arrays", "fortran", "fortran-iso-c-binding"], "comments": [{"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1502887019, "post_id": 45713637, "comment_id": 78385483, "body": "You can temporarily dimension your array to 1 if it is empty."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1502887166, "post_id": 45713637, "comment_id": 78385604, "body": "... Or have a dummy array ready for the occasion."}, {"owner": {"reputation": 24099, "user_id": 3157076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mB4zi.png?s=128&g=1", "display_name": "francescalus", "link": "https://stackoverflow.com/users/3157076/francescalus"}, "edited": false, "score": 3, "creation_date": 1502889632, "post_id": 45713637, "comment_id": 78387558, "body": "What is the interface for <code>c_mysub</code>?  Why do you wish to pass a scalar array element to it, even when the array may have no elements?"}, {"owner": {"reputation": 5062, "user_id": 1280439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18afee2ca2391bf36237de79d765eca4?s=128&d=identicon&r=PG", "display_name": "Ian Bush", "link": "https://stackoverflow.com/users/1280439/ian-bush"}, "edited": false, "score": 0, "creation_date": 1502892855, "post_id": 45713637, "comment_id": 78389896, "body": "Just to back up francescalus why are you not just passing the array?"}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 1, "creation_date": 1502899912, "post_id": 45713637, "comment_id": 78394989, "body": "Normally you should pass just  <code>array</code>, not <code>array(1)</code>. Hard to say more if you don&#39;t show the real code. There is some risk of <code>array</code> being non-contiguous and <code>array(1)</code> will avoid creating a temporary copy and that could actually be wrong."}, {"owner": {"reputation": 160, "user_id": 1904419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39d37936b9196c1bd27da76c2a608b3?s=128&d=identicon&r=PG", "display_name": "redwizard792", "link": "https://stackoverflow.com/users/1904419/redwizard792"}, "edited": false, "score": 0, "creation_date": 1502901835, "post_id": 45713637, "comment_id": 78396098, "body": "I added more details and renamed the functions."}, {"owner": {"reputation": 160, "user_id": 1904419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39d37936b9196c1bd27da76c2a608b3?s=128&d=identicon&r=PG", "display_name": "redwizard792", "link": "https://stackoverflow.com/users/1904419/redwizard792"}, "edited": false, "score": 0, "creation_date": 1502903567, "post_id": 45713637, "comment_id": 78397078, "body": "I&#39;m sorry I made another modification to show files I am testing with."}], "answers": [{"comments": [{"owner": {"reputation": 160, "user_id": 1904419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39d37936b9196c1bd27da76c2a608b3?s=128&d=identicon&r=PG", "display_name": "redwizard792", "link": "https://stackoverflow.com/users/1904419/redwizard792"}, "edited": false, "score": 0, "creation_date": 1502902696, "post_id": 45719092, "comment_id": 78396557, "body": "What does the f_mysub look like in that case? The <code>c_mysub</code> will have <code>int[] arr</code> as argument, right?"}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "reply_to_user": {"reputation": 160, "user_id": 1904419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39d37936b9196c1bd27da76c2a608b3?s=128&d=identicon&r=PG", "display_name": "redwizard792", "link": "https://stackoverflow.com/users/1904419/redwizard792"}, "edited": false, "score": 0, "creation_date": 1502902803, "post_id": 45719092, "comment_id": 78396626, "body": "Now I only realized you have a wrong interface, you must indeed correct it."}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "reply_to_user": {"reputation": 160, "user_id": 1904419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39d37936b9196c1bd27da76c2a608b3?s=128&d=identicon&r=PG", "display_name": "redwizard792", "link": "https://stackoverflow.com/users/1904419/redwizard792"}, "edited": false, "score": 0, "creation_date": 1502902934, "post_id": 45719092, "comment_id": 78396690, "body": "The C argument can be array or pointer, it does not matter. <code>int *array</code> is fine."}, {"owner": {"reputation": 24099, "user_id": 3157076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mB4zi.png?s=128&g=1", "display_name": "francescalus", "link": "https://stackoverflow.com/users/3157076/francescalus"}, "edited": false, "score": 0, "creation_date": 1502903120, "post_id": 45719092, "comment_id": 78396792, "body": "Is it not the case that an array of zero size is not interoperable with any C array?"}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 0, "creation_date": 1502903530, "post_id": 45719092, "comment_id": 78397048, "body": "I was just going to check that. It possibly is not. But in practice, whatever address is passed, it should not be dereferenced. Even a null pointer can be passed. One could add an if and pass a <code>c_null_pointer</code> instead, but I don&#39;t think it is worth it. I just have to check no bad stuff happens on the Fortran side."}, {"owner": {"reputation": 160, "user_id": 1904419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39d37936b9196c1bd27da76c2a608b3?s=128&d=identicon&r=PG", "display_name": "redwizard792", "link": "https://stackoverflow.com/users/1904419/redwizard792"}, "edited": false, "score": 0, "creation_date": 1502903751, "post_id": 45719092, "comment_id": 78397204, "body": "I have tested your suggested change and no errors with -fbounds-check."}], "tags": [], "owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "is_accepted": true, "score": 1, "last_activity_date": 1502902895, "last_edit_date": 1502902895, "creation_date": 1502902252, "answer_id": 45719092, "question_id": 45713637, "link": "https://stackoverflow.com/questions/45713637/whats-the-right-way-to-pass-a-fortran-zero-length-arrays-to-c/45719092#45719092", "title": "What&#39;s the right way to pass a Fortran zero-length arrays to C?", "body": "<p>I do not see any reason to pass <code>array(1)</code> as actual argument. The whole array <code>array</code> should be passed.</p>\n\n<pre><code>  call f_mysub( size(array) , array )\n</code></pre>\n\n<p>and the interface must be changed to pass an array and not just a scalar</p>\n\n<pre><code>  integer(C_INT) :: arr(*)\n</code></pre>\n\n<p>Passing the first element (even to an array argument) could easily cause incorrect behaviour if <code>array</code> is not contiguous - which is theoretically possible given it is assumed shape dummy argument (with <code>(:)</code>).</p>\n\n<p>If you pass the whole array and size <code>0</code> then just make sure no element is actually dereferenced from the pointer in the C procedure (which should already be the case if it is well-written).</p>\n"}], "owner": {"reputation": 160, "user_id": 1904419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39d37936b9196c1bd27da76c2a608b3?s=128&d=identicon&r=PG", "display_name": "redwizard792", "link": "https://stackoverflow.com/users/1904419/redwizard792"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 1, "accepted_answer_id": 45719092, "answer_count": 1, "score": 1, "last_activity_date": 1502903374, "creation_date": 1502886712, "last_edit_date": 1502903374, "question_id": 45713637, "link": "https://stackoverflow.com/questions/45713637/whats-the-right-way-to-pass-a-fortran-zero-length-arrays-to-c", "title": "What&#39;s the right way to pass a Fortran zero-length arrays to C?", "body": "<p>I have the following kind of subroutine wrapper to pass a Fortran array to a <code>ISO_C_BINDING</code>-bound C function. </p>\n\n<pre><code>subroutine mysub( array )\n  integer, dimension(:) :: array\n  call f_mysub( size(array) , array(1) )\nend subroutine\n</code></pre>\n\n<p>The problem is that if the array is of size 0 then <code>array(1)</code> is out-of-bounds. What's the right way to handle this situation? </p>\n\n<p>In general I cannot avoid the call, i.e. with a <code>if( size(array) &gt; 0 )</code> because the call may be important to register, e.g. it is actually a class method, naturally with different signature than above, and could clear an existing array.</p>\n\n<h2>Example Files</h2>\n\n<p>The C routine is <code>c_mysub.c</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid c_mysub( size_t* size, int* arr )\n{\n    printf(\"size=%d\\n\",*size);\n    for(size_t i=0; i&lt;*size; ++i)\n    {\n        printf(\"element %d=%d\\n\",i,arr[i]);\n    }\n}\n</code></pre>\n\n<p>The main Fortran file is <code>mysub.f90</code></p>\n\n<pre><code>module mysub_I\ninterface\nsubroutine f_mysub( size, arr) BIND(C,name=\"c_mysub\")\n    use,intrinsic :: ISO_C_BINDING\n    integer(C_SIZE_T) :: size\n    integer(C_INT) :: arr\nend subroutine\nend interface\nend module\n\nmodule mysub_M\nuse mysub_I\ncontains\n\nsubroutine mysub( array )\n  use ISO_C_BINDING\n  integer, dimension(:) :: array\n  call f_mysub( int(size(array),C_SIZE_T) , array(1) )\nend subroutine\n\nend module\n\nprogram main\nuse mysub_M\ninteger, allocatable :: x(:)\n\nallocate( x(7) )\nx=1\n\ncall mysub( x )\n\ndeallocate( x )\nallocate( x(0) )\n\ncall mysub( x )\n\nend\n</code></pre>\n\n<p>Compile the C with <code>gcc -c c_mysub.c</code> and the Fortran with <code>gfortran -fbounds-check c_mysub.o mysub.f90</code>, which gives the following error when you run the code, balking at the second call with size=0.</p>\n\n<pre><code>size=7\n0:1\n1:1\n2:1\n3:1\n4:1\n5:1\n6:1\nAt line 18 of file mysub.f90\nFortran runtime error: Index '1' of dimension 1 of array 'array' above upper bound of 0\n</code></pre>\n\n<p>Compiling with bounds check off behaves as expected.</p>\n\n<pre><code>size=7\n0:1\n1:1\n2:1\n3:1\n4:1\n5:1\n6:1\nsize=0\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault", "malloc"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1502886209, "post_id": 45713405, "comment_id": 78384800, "body": "<code>word_array</code> is a pointer, but <i>where does it point?</i>"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1502886220, "post_id": 45713405, "comment_id": 78384811, "body": "Undefined behavior for using the value of an object with automatic storage duration while it is indeterminate."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1502886252, "post_id": 45713405, "comment_id": 78384838, "body": "Also, being a <a href=\"http://wiki.c2.com/?ThreeStarProgrammer\" rel=\"nofollow noreferrer\">three-start programmer</a> is <i>not</i> something to strive for."}, {"owner": {"reputation": 11, "user_id": 8472469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf842a6e6c6a19e8bfe03b11e5f444fe?s=128&d=identicon&r=PG&f=1", "display_name": "Sam45505", "link": "https://stackoverflow.com/users/8472469/sam45505"}, "edited": false, "score": 0, "creation_date": 1502886522, "post_id": 45713405, "comment_id": 78385053, "body": "I have to use the three star cause it&#39;s in the prototype my professor gave us"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1502886669, "post_id": 45713405, "comment_id": 78385177, "body": "Then you should probably pass the address of a pointer-to-pointer to <code>char</code>, i.e. have <code>char **word_array; split_allocate(..., &amp;word_array);</code> <i>And</i> allocate memory in the function, like <code>*word_array = malloc(...)</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502886785, "post_id": 45713405, "comment_id": 78385275, "body": "Also Your logic is wrong. E.g 1) You need to skip the spaces. 2) This will not get the last word."}, {"owner": {"reputation": 1726, "user_id": 3303195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eb06736ba2b216feb60aa0d6831fff9?s=128&d=identicon&r=PG", "display_name": "faintsignal", "link": "https://stackoverflow.com/users/3303195/faintsignal"}, "edited": false, "score": 0, "creation_date": 1502887050, "post_id": 45713405, "comment_id": 78385507, "body": "What steps have you taken in attempting to debug the problem?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1502887416, "post_id": 45713405, "comment_id": 78385794, "body": "<code>(*word_array)[j][k+1] </code> I bet that it does not do what you @Sam45505 think it does"}], "answers": [{"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 1, "last_activity_date": 1502888296, "creation_date": 1502888296, "answer_id": 45714194, "question_id": 45713405, "link": "https://stackoverflow.com/questions/45713405/segmentation-fault-i-dont-know-why/45714194#45714194", "title": "Segmentation fault, I don&#39;t know why", "body": "<p>I would recommend you to replace</p>\n\n<pre><code>if(c!=' ' &amp;&amp; c!='\\t' &amp;&amp; c!='\\n')\n</code></pre>\n\n<p>with </p>\n\n<pre><code>if(!isspace(c))  // Iam easier and more readable\n</code></pre>\n\n<p>from <code>ctype.h</code>. Which detects all these characters</p>\n\n<pre><code>' '      space \n'\\t'     horizontal tab \n'\\n'     newline\n'\\v'     vertical tab \n'\\f'     feed \n'\\r'     carriage return\n</code></pre>\n\n<hr>\n\n<p>Also you should change <code>char*** word_array;</code> (three star general) to <code>pointer to pointer</code> which is enough. Then alloc memory on <code>heap</code> (<em>dynamic storage duration</em>). You didnt do it and it caused <a href=\"https://en.wikipedia.org/wiki/Segmentation_fault\" rel=\"nofollow noreferrer\">segmentaion fault</a> (dereferencing uninitialzed pointer).</p>\n\n<pre><code>char ** word_array = malloc (sizeof(char *) * ROWS);\nfor (int i = 0; i &lt; ROWS; ++i)\n{\n    word_array[i] = malloc (sizeof(char) * ROW_LEN);\n}\n</code></pre>\n\n<p>You shouldn't cast <code>malloc()</code>'s return value because it may lead to <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">problems</a>.</p>\n\n<p>Also you should check number of rows, and if needed use <code>realloc</code> to get more rows, because accessing out of bounds leads to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<hr>\n\n<p>Instead of copying character by character use <code>strcpy</code>, since you know there is enough space. Its more readable and easier.</p>\n\n<pre><code>for(k=0 ; tmp[k] != '\\0' ; k++){\n    (*word_array)[j][k]=tmp[k];\n}\n</code></pre>\n\n<p>to</p>\n\n<pre><code>strcpy(word_array[j], tmp); // In case word_array is char **\n</code></pre>\n\n<hr>\n\n<p>I can see spaces in your string but you arent skiping them, this may help</p>\n\n<pre><code>while ((c=s[id_s++]) &amp;&amp; isspace(c))\n    ;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8472469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf842a6e6c6a19e8bfe03b11e5f444fe?s=128&d=identicon&r=PG&f=1", "display_name": "Sam45505", "link": "https://stackoverflow.com/users/8472469/sam45505"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "answer_count": 1, "score": -7, "last_activity_date": 1502888296, "creation_date": 1502886075, "last_edit_date": 1502886429, "question_id": 45713405, "link": "https://stackoverflow.com/questions/45713405/segmentation-fault-i-dont-know-why", "title": "Segmentation fault, I don&#39;t know why", "body": "<p>I have a seg fault but I don't know why. \nI know it should be working but it kee telling me there is a seg fault someone has a solution?\nPlease someone help I need to know for my BA.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint split_allocate(const char* s, char*** word_array){\n    char c;\n    char tmp[100];\n    int id_s,i=0, j=0,k;\n    for(id_s =0 ; (c=s[id_s])!='\\0' ; id_s++){\n        printf(\"%c\\n\", c);\n        if(c!=' ' &amp;&amp; c!='\\t' &amp;&amp; c!='\\n'){\n            tmp[i]=c;\n            i++;\n            printf(\"i if : %d\\n\", i);\n            continue;\n        }\n        tmp[i]='\\0';\n        printf(\"i else : %d &amp; tmp : %s\\n\", i, tmp);\n        (*word_array)[j] = (char*)malloc(sizeof(char)*(i+1));\n        printf(\"666\\n\");\n        if(NULL== (*word_array)[j]){\n            return -1;\n        }\n        for(k=0 ; tmp[k] != '\\0' ; k++){\n            (*word_array)[j][k]=tmp[k];\n        }\n        (*word_array)[j][k+1]='\\0';\n        j++;\n        printf(\"j for : %d\\n\", j);\n        i=0;\n    }\n    return j;\n}\n\nint main(void) {\n    char* s = \"Salut,   cet examen\\n a l'air long...\";\n    char*** word_array;\n    printf(\"number of words :%d\\n\", split_allocate(s,word_array));\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "gcc", "cygwin"], "comments": [{"owner": {"reputation": 684, "user_id": 4970667, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FWd3x.jpg?s=128&g=1", "display_name": "Quentin", "link": "https://stackoverflow.com/users/4970667/quentin"}, "edited": false, "score": 0, "creation_date": 1502884938, "post_id": 45712951, "comment_id": 78383883, "body": "Could you post the code your error is referencing ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502884972, "post_id": 45712951, "comment_id": 78383903, "body": "This should have nothing to do with the build-system. Can you please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> of the <i>code</i> to show us?"}, {"owner": {"reputation": 12289, "user_id": 3764804, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/fZQON.png?s=128&g=1", "display_name": "BullyWiiPlaza", "link": "https://stackoverflow.com/users/3764804/bullywiiplaza"}, "edited": false, "score": 0, "creation_date": 1502885063, "post_id": 45712951, "comment_id": 78383976, "body": "I actually realized using <code>static inline</code> everywhere fixes the problem"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502885586, "post_id": 45712951, "comment_id": 78384347, "body": "And if you wonder why you must be using <code>static inline</code> (and can&#39;t find a duplicate question, of which I&#39;m certain there exists a few) then you should probably post that as a new question. Together with a MCVE!"}], "owner": {"reputation": 12289, "user_id": 3764804, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/fZQON.png?s=128&g=1", "display_name": "BullyWiiPlaza", "link": "https://stackoverflow.com/users/3764804/bullywiiplaza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 728, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502884674, "creation_date": 1502884674, "question_id": 45712951, "link": "https://stackoverflow.com/questions/45712951/cmake-inline-functions-undefined-reference", "title": "CMake inline functions undefined reference", "body": "<p>I have a code base which I'm compiling for 2 different architectures. The one is <code>PowerPC</code> and the other is <code>x86</code>. For <code>PowerPC</code> I'm using a <code>Makefile</code> with <code>GCC</code> and the code base compiles just fine. For <code>x86</code> however I'm using <code>CMake</code> in <a href=\"https://www.jetbrains.com/clion/\" rel=\"nofollow noreferrer\"><code>CLion</code></a> with <code>Cygwin</code> on <code>Windows</code> and I'm getting <code>undefined reference</code> errors for each called <code>inline</code> function:</p>\n\n<pre><code>CMakeFiles/my_project.dir/main.c.o: In function `wrapper_function':\n/cygdrive/d/src/header.h:13: undefined reference to `inline_function'\n/cygdrive/d/src/header.h:13:(.text+0x26): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `inline_function'\n</code></pre>\n\n<p>I made sure that all <code>inline</code> functions are in header files only. Also, I need them to be declared as <code>inline</code> because I want self-contained functions without sub procedures so removing that tag is not desired.</p>\n\n<p>My <code>CMake</code> file looks like this:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.6)\nproject(my_project)\n\nset(CMAKE_CXX_STANDARD 11)\n\nset(SOURCE_FILES\n        main.c\n        src/header.h)\nadd_executable(my_project${SOURCE_FILES})\n</code></pre>\n\n<p>How do I fix the linker error without changing the code base? If possible, an entry in the <code>CMake</code> file would be the optimal solution.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 0, "creation_date": 1502882225, "post_id": 45712052, "comment_id": 78382125, "body": "range = (int **) malloc(sizeof(max-min));"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502882292, "post_id": 45712052, "comment_id": 78382160, "body": "Nobody here will write the code for you. If you go to www.google.com and type in the title of your question, &quot;malloc double pointer&quot;, there are plenty of examples regarding the allocation part."}, {"owner": {"reputation": 1699, "user_id": 4891815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/niZw9.jpg?s=128&g=1", "display_name": "Gnqz", "link": "https://stackoverflow.com/users/4891815/gnqz"}, "reply_to_user": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 0, "creation_date": 1502882356, "post_id": 45712052, "comment_id": 78382203, "body": "Then read how to use malloc and what a for loop is. @Rajeshkumar you this will allocate just the difference between min and max in bytes, also avoid casting the result from malloc."}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1502882431, "post_id": 45712052, "comment_id": 78382250, "body": "What is your code so far, you should show your effort so that we can help you at a specific problem."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1502882772, "post_id": 45712052, "comment_id": 78382494, "body": "With this declaration, you should <b>pass</b> a pointer from calling code.   Then just do <code>size_t size = max - min + 1; *range = malloc(size * sizeof **range);</code>"}, {"owner": {"reputation": 1699, "user_id": 4891815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/niZw9.jpg?s=128&g=1", "display_name": "Gnqz", "link": "https://stackoverflow.com/users/4891815/gnqz"}, "edited": false, "score": 1, "creation_date": 1502882983, "post_id": 45712052, "comment_id": 78382616, "body": "What&#39;s the use of the i variable and why *10?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1502882998, "post_id": 45712052, "comment_id": 78382624, "body": "like <a href=\"http://ideone.com/iS0kDY\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1502883249, "post_id": 45712052, "comment_id": 78382778, "body": "@AndreKampling surely. Added."}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1563207670, "post_id": 45712052, "comment_id": 100615097, "body": "In C, do not cast the result of a call to <code>malloc()</code>, <code>realloc()</code>, or <code>calloc()</code> - it is unnecessary and potentially masks the serious error of a missing prototype."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 4, "last_activity_date": 1502883516, "creation_date": 1502883516, "answer_id": 45712577, "question_id": 45712052, "link": "https://stackoverflow.com/questions/45712052/malloc-double-pointer/45712577#45712577", "title": "Malloc double pointer", "body": "<p>Ok, let's spot the errors:</p>\n\n<pre><code>void double_min_max(int **range, int min, int max)\n{\n    range = (int **)malloc(sizeof(int)* 10);\n</code></pre>\n\n<p>The cast with malloc is unnecessary and could even <a href=\"https://stackoverflow.com/q/605845/2371524\">lead to problems</a>. Don't do this.</p>\n\n<p>Then you want to assign to <code>*range</code>, not to <code>range</code>. <code>range</code> is local to your function (all arguments are passed <em>by value</em> in C), so modifying it will never have any effect visible to the calling code. When you call this function, you should pass a <em>pointer to a pointer</em>, so the pointer can be modified by the function through <code>*range</code>.</p>\n\n<p>Finally, this should be obvious, but you should <strong>calculate</strong> the required size from your <code>min</code> and <code>max</code>. The <code>10</code> is just a ... uhm ... <em>very rough guess</em>. Not a good idea.</p>\n\n<pre><code>    int i = 0;\n        while (min &lt; max)\n        {\n        **range[i] = min;\n</code></pre>\n\n<p>This is wrong. <code>[]</code> does dereference the pointer, so you have three levels of dereferencing here. But it's only a <em>pointer to pointer</em>, not <em>pointer to pointer to pointer</em>. Also, indexing precedes the normal dereference, not what you want. Use <code>(*range)[i]</code> instead.</p>\n\n<pre><code>        i++;\n        min++;\n    }\n}\n</code></pre>\n\n<p>A sensible implementation could look like this:</p>\n\n<pre><code>size_t double_min_max(int **range, int min, int max)\n{\n    // check for valid input\n    if (min &gt; max) return 0;\n\n    // calculate required size\n    size_t size = max - min + 1;\n\n    *range = malloc(size * sizeof **range);\n\n    // check allocation succeeded:\n    if (!*range) return 0;\n\n    for (size_t i = 0; i &lt; size; ++i)\n    {\n        (*range)[i] = min++;\n    }\n    return size;\n}\n</code></pre>\n\n<p>Call it like this:</p>\n\n<pre><code>int *range;\nsize_t result = double_min_max(&amp;range, 10, 20);\n\n// result should now be 11, the size of the array `range` points to\n\n// when done:\nfree(range);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502885468, "post_id": 45712797, "comment_id": 78384256, "body": "<i>It should rather be <code>*range[i]=anIntValue</code>.</i> I think that this will mislead OP."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502913978, "post_id": 45712797, "comment_id": 78402264, "body": "@BLUEPIXY: Uups, thanks!"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 0, "last_activity_date": 1502913952, "last_edit_date": 1502913952, "creation_date": 1502884266, "answer_id": 45712797, "question_id": 45712052, "link": "https://stackoverflow.com/questions/45712052/malloc-double-pointer/45712797#45712797", "title": "Malloc double pointer", "body": "<p>With <code>**range = malloc...</code>, you actually access/assign the first integer value to which the \"pointer to pointer to int\" (this is what <code>int **range</code> denotes) points. \nThis should be <code>*range = malloc...</code> instead. Further, <code>**range[i]</code> is illegal, as <code>**range</code> is an integer value, not an array or pointer, such that the  <code>**range[i]=min</code> dereferences an integer value (which in this context is illegal/undefined behaviour). It should rather be <code>*range[i]=min</code>.</p>\n\n<p>So the complete code including some necessary checks, the use of the function and also the use of the result could look as follows:</p>\n\n<pre><code>int double_min_max(int **range, int min, int max) {\n\n    // range is a pointer PPI to a pointer PI pointing to one (or more consecutive) integers I\n    // *range is the \"value\" of PI, i.e. the pointer to the memory block representing the sequence of integers\n\n    if (min &gt;= max)  // check if the range is valid\n        return 0;\n\n    if (!range) // check if you may assign a value to *range\n        return 0;\n\n    int size = max - min;\n    int *intArray = malloc(size * sizeof(int));\n    if (!intArray) // did malloc fail?\n        return 0;\n\n    // fill the range\n    for (int i=0; i&lt;size; i++) {\n        intArray[i] = min+i;\n    }\n\n    // let *range point to the malloced and filled array\n    *range = intArray;\n\n    // return the size of the array.\n    return size;\n}\n\nint main() {\n\n    int *myRange = NULL;\n    int size = double_min_max(&amp;myRange, -30, -10);\n\n    if (size &amp;&amp; myRange) {\n        for (int i=0; i&lt;size; i++) {\n            printf(\"%d \", myRange[i]);\n        }\n        free(myRange);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8446716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d156ab795add64e7a167fe13f21e72ff?s=128&d=identicon&r=PG&f=1", "display_name": "nextdarius", "link": "https://stackoverflow.com/users/8446716/nextdarius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2028, "favorite_count": 0, "closed_date": 1502903125, "accepted_answer_id": 45712577, "answer_count": 2, "score": -4, "last_activity_date": 1502913952, "creation_date": 1502882089, "last_edit_date": 1502882858, "question_id": 45712052, "link": "https://stackoverflow.com/questions/45712052/malloc-double-pointer", "closed_reason": "Needs details or clarity", "title": "Malloc double pointer", "body": "<p>My function prototype should look like this:</p>\n\n<pre><code>void double_min_max(int **range, int min, int max)\n</code></pre>\n\n<p>I have to fill 'range' with number from min to max.</p>\n\n<p>I don't know how to malloc the double pointer and how to assign every element the number min.</p>\n\n<pre><code>void    double_min_max(int **range, int min, int max)\n{\n    range = (int **)malloc(sizeof(int)* 10);\n    int i = 0;\n        while (min &lt; max)\n        {\n        **range[i] = min;\n        i++;\n        min++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "xcode", "rounding"], "comments": [{"owner": {"reputation": 8545, "user_id": 4323935, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/yPVSE.png?s=128&g=1", "display_name": "dpr", "link": "https://stackoverflow.com/users/4323935/dpr"}, "edited": false, "score": 1, "creation_date": 1502882850, "post_id": 45712010, "comment_id": 78382538, "body": "Hello and welcome to StackOverflow. Please take some time to read the help page, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. And more importantly, please read <a href=\"http://meta.stackexchange.com/q/156810/204922\">the Stack Overflow question checklist</a>. You might also want to learn about <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Examples</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502928296, "post_id": 45712010, "comment_id": 78407119, "body": "Maybe <code>%.3f</code> \u2014 but you really need to supply code (and sample data \u2014 but not a 20x20 example; maybe 5x5 or 4x4 or 3x3 would suffice) and actual and required output."}], "owner": {"reputation": 1, "user_id": 8472149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cc93f533e51c2ae79569a7f7a670685?s=128&d=identicon&r=PG&f=1", "display_name": "chisholm", "link": "https://stackoverflow.com/users/8472149/chisholm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502928336, "creation_date": 1502881977, "last_edit_date": 1502928336, "question_id": 45712010, "link": "https://stackoverflow.com/questions/45712010/c-language-rounding-up-on-xcode", "title": "c language rounding up on Xcode", "body": "<p>I'm pretty new to coding and languages.\nI'm using Xcode and have input and printed to screen a table of data 20x20 in size.</p>\n\n<p>I just wondered what is the easiest way to get all that data rounded up to 3dp?</p>\n"}, {"tags": ["c++", "c", "assembly", "visual-studio-2017", "inline-assembly"], "comments": [{"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1502881923, "post_id": 45711675, "comment_id": 78381920, "body": "Making function inline makes sense only if function body is rather small so there is a benefit of replacing it&#39;s call with it&#39;s body. I somehow doubt that you assembly functions are that small and simple."}, {"owner": {"reputation": 11, "user_id": 8472000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23bd54560d453f90da8274d47e98dacf?s=128&d=identicon&r=PG&f=1", "display_name": "PastaWithGarlicOil", "link": "https://stackoverflow.com/users/8472000/pastawithgarlicoil"}, "reply_to_user": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1502882049, "post_id": 45711675, "comment_id": 78382008, "body": "@VTT It is meant to be used as an anti-debugging method, i have generated lot of condition with jumps etc, they differ each time, they do all kind of instructions with loops, restoring original register values, that&#39;s why i don&#39;t want the <code>call</code> for each of them. As it would be easy to see that it&#39;s junk call"}, {"owner": {"reputation": 11, "user_id": 8472000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23bd54560d453f90da8274d47e98dacf?s=128&d=identicon&r=PG&f=1", "display_name": "PastaWithGarlicOil", "link": "https://stackoverflow.com/users/8472000/pastawithgarlicoil"}, "reply_to_user": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1502882315, "post_id": 45711675, "comment_id": 78382173, "body": "@VTT basically it changes the control flow graph, that&#39;s why its crucial to not make this calls, and iline all the generated blocks. In Mingw64 i had no problem doing that, but i&#39;m not very familiar with msvc compiler is it even possible to do?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502883083, "post_id": 45711675, "comment_id": 78382682, "body": "@PastaWithGarlicOil check if their linker is capable to do so. It require linker to be capable of the link time optimisations. You need to check the documentation. did you check with the debugger or just the generated listing? If the latter it can be like this as information about potential link time inlining is in the object file and the function call is replaced by the function body during the link stage"}, {"owner": {"reputation": 11, "user_id": 8472000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23bd54560d453f90da8274d47e98dacf?s=128&d=identicon&r=PG&f=1", "display_name": "PastaWithGarlicOil", "link": "https://stackoverflow.com/users/8472000/pastawithgarlicoil"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502883371, "post_id": 45711675, "comment_id": 78382841, "body": "@PeterJ i checked with the debugger"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502883580, "post_id": 45711675, "comment_id": 78382979, "body": "@PeterJ - Link time code generation is not supported for .asm files, but would normally use compiler intrinsics for any &quot;interesting&quot; machine instructions. Inline functions as code obfuscation was apparently not considered by Microsoft.  :-)"}, {"owner": {"reputation": 11, "user_id": 8472000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23bd54560d453f90da8274d47e98dacf?s=128&d=identicon&r=PG&f=1", "display_name": "PastaWithGarlicOil", "link": "https://stackoverflow.com/users/8472000/pastawithgarlicoil"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502883606, "post_id": 45711675, "comment_id": 78382995, "body": "@PeterJ thanks i will look trough all linker directives, maybe there are some link time optimisations"}, {"owner": {"reputation": 11, "user_id": 8472000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23bd54560d453f90da8274d47e98dacf?s=128&d=identicon&r=PG&f=1", "display_name": "PastaWithGarlicOil", "link": "https://stackoverflow.com/users/8472000/pastawithgarlicoil"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1502883819, "post_id": 45711675, "comment_id": 78383140, "body": "@BoPersson so sad, Do you know, is it possible to just insert machine codes inside the function body at compile time? something like <code>_asm _emit</code>?"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1502969651, "post_id": 45711675, "comment_id": 78425628, "body": "@Pasta - No, there really isn&#39;t any use for that, except for your attempt to make the code harder to read. All &quot;real&quot; use of inline assembly can be replaced with compiler intrinsics for useful instructions that the compiler might not use itself. There are hundreds, if not thousands, such instructions built into the compiler. <a href=\"https://docs.microsoft.com/cpp/intrinsics/x64-amd64-intrinsics-list\" rel=\"nofollow noreferrer\">docs.microsoft.com/cpp/intrinsics/x64-amd64-intrinsics-list</a>"}], "owner": {"reputation": 11, "user_id": 8472000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23bd54560d453f90da8274d47e98dacf?s=128&d=identicon&r=PG&f=1", "display_name": "PastaWithGarlicOil", "link": "https://stackoverflow.com/users/8472000/pastawithgarlicoil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 395, "favorite_count": 0, "closed_date": 1502883026, "answer_count": 0, "score": 1, "last_activity_date": 1502881777, "creation_date": 1502880979, "last_edit_date": 1502881777, "question_id": 45711675, "link": "https://stackoverflow.com/questions/45711675/x64-assembly-in-visual-studio-as-inline-function", "closed_reason": "Duplicate", "title": "X64 Assembly in visual studio, as inline function", "body": "<p>I'm trying to embedd my x64 assembler code into c++, as i know x64 <code>__asm</code> is not allowed in x64, so what i tried, is i made an asm defintion like this in <code>func.asm</code>:</p>\n\n<pre><code>.code\nproc_testing PROC\n\npush rcx\npop rcx\n\nproc_testing ENDP\nEND\n</code></pre>\n\n<p>And in my C code, <code>main.c</code>:</p>\n\n<pre><code>#include \"stdafx.h\"\n\nextern\"C\" void inline proc_testing();\nint main()\n{\n    proc_testing();\n    return 0;\n}\n</code></pre>\n\n<p>I tought that <code>inline</code> keyword would make the compiler not to call <code>proc_testing()</code> but to place its code inside the main. Unfortunately it still make a <code>call proc_testing</code>. In masm you have a keyword <code>MACRO</code> also, but here i cannot use this, i get compilation error if use <code>MACRO</code> instead of <code>PROC</code>, i tried to do it like this:</p>\n\n<pre><code>.code\nproc_testing MACRO\npush rcx\npop rcx\n\nproc_testing ENDM\nEND\n</code></pre>\n\n<p>This way i get an error: <code>unmatched macro nesting</code>.</p>\n\n<p>So i have a two question actually:</p>\n\n<p>1) Can the masm assembly in x64 in visual studio be inline? So when i use <code>proc_testing();</code> it will not do the <code>call proc_testing</code> but actually place the code of <code>proc_testing</code> inside the <code>main</code>.</p>\n\n<p>2) Can you make masm <code>MACRO</code> to work outside the <code>.asm</code> file? If So how can i achieve that? </p>\n\n<p>So basically i need to get rid of the <code>call</code> and place the assembly code directly at link/compile time. The assembler code is generated dynamically using some engine, so i cannot use compiler intrinsics, i would need to rewrite the asm generator for that.</p>\n\n<p>And finally, if all the variants are not possible, can i do an analogy of <code>_asm _emit</code>, to just place the machine code in hex, in the <code>.text</code> inside the specific places?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1502881503, "post_id": 45711458, "comment_id": 78381670, "body": "This is worst version of insertion/bubble sort."}], "answers": [{"comments": [{"owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "edited": false, "score": 1, "creation_date": 1502881554, "post_id": 45711687, "comment_id": 78381715, "body": "I agree with you. The concept is definitely <code>insertion sort</code> but with swapping inefficiency which are avoidables. Plus the <code>i</code> is shared between the <code>while</code> and the <code>for</code> which makes for further inefficiency."}], "tags": [], "owner": {"reputation": 529, "user_id": 6101580, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205983900385237/picture?type=large", "display_name": "Tom&#225;\u0161 Zahradn&#237;\u010dek", "link": "https://stackoverflow.com/users/6101580/tom%c3%a1%c5%a1-zahradn%c3%ad%c4%8dek"}, "is_accepted": false, "score": 4, "last_activity_date": 1502881362, "last_edit_date": 1502881362, "creation_date": 1502881020, "answer_id": 45711687, "question_id": 45711458, "link": "https://stackoverflow.com/questions/45711458/is-this-bubble-sort-or-insertion-sort-in-c/45711687#45711687", "title": "Is this Bubble sort or insertion sort in C?", "body": "<p>Looks like both/neither for me. It may be insert sort, because you always take first element in unsorted part of array and puts it into correct place in sorted part of array. However, insertion is not done by moving all necessary elements 1 element right and then inserting selected element to correct place (which i would say, standard insert sort does), but instead it swaps selected element with 1 element to the left, until selected element is in correct place.</p>\n\n<p>Because of \"sorted\" and \"unsorted\" part of array, I would say insert sort.</p>\n\n<p>Because of swapping neighbour elements, I would say bubble sort.</p>\n\n<p>However, it seems more like insert sort to me. If instead of (inefficient) swapping, you would instead only move left element to right, and only finally write selected element to left (final, correct position of selected element), It would be a nice insert sort</p>\n"}, {"comments": [{"owner": {"reputation": 529, "user_id": 6101580, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205983900385237/picture?type=large", "display_name": "Tom&#225;\u0161 Zahradn&#237;\u010dek", "link": "https://stackoverflow.com/users/6101580/tom%c3%a1%c5%a1-zahradn%c3%ad%c4%8dek"}, "edited": false, "score": 0, "creation_date": 1502882826, "post_id": 45712205, "comment_id": 78382526, "body": "I disagree that it is only right to left / left to right difference. In bubble sort, last element in array moves up to 1 position every iteration of outer loop. In question, last element is not moved at all until last iteration of outer loop."}, {"owner": {"reputation": 601, "user_id": 3985387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fe430573d32326faacc88805afe5fc7?s=128&d=identicon&r=PG&f=1", "display_name": "Hakes", "link": "https://stackoverflow.com/users/3985387/hakes"}, "reply_to_user": {"reputation": 529, "user_id": 6101580, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205983900385237/picture?type=large", "display_name": "Tom&#225;\u0161 Zahradn&#237;\u010dek", "link": "https://stackoverflow.com/users/6101580/tom%c3%a1%c5%a1-zahradn%c3%ad%c4%8dek"}, "edited": false, "score": 0, "creation_date": 1502882909, "post_id": 45712205, "comment_id": 78382571, "body": "@Tom&#225;\u0161Zahradn&#237;\u010dek is right if this is the reverse of bubblesort the smallest element should be at first index."}], "tags": [], "owner": {"reputation": 1438, "user_id": 7857932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZSRpb.jpg?s=128&g=1", "display_name": "Ghulam Moinul Quadir", "link": "https://stackoverflow.com/users/7857932/ghulam-moinul-quadir"}, "is_accepted": false, "score": 0, "last_activity_date": 1502882511, "creation_date": 1502882511, "answer_id": 45712205, "question_id": 45711458, "link": "https://stackoverflow.com/questions/45711458/is-this-bubble-sort-or-insertion-sort-in-c/45712205#45712205", "title": "Is this Bubble sort or insertion sort in C?", "body": "<p>This is a <code>Bubble Sort</code>algorithm. Only difference between <code>Bubble Sort</code> algorithm and your algorithm is that <code>Bubble Sort</code> algorithm sorts the rightmost elements first and then so on and your algorithm is sorting the leftmost elements first.</p>\n\n<p><strong>Analysis:</strong></p>\n\n<p>Your Algo:</p>\n\n<pre><code>&lt;---------\n &lt;--------\n  &lt;-------\n   &lt;------\n    &lt;-----\n     &lt;----\n      &lt;---\n       &lt;--\n        &lt;-\n         &lt;\n</code></pre>\n\n<p>Bubble Sort Algo:</p>\n\n<pre><code>------&gt;\n-----&gt;\n----&gt;\n---&gt;\n--&gt;\n-&gt;\n&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 601, "user_id": 3985387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fe430573d32326faacc88805afe5fc7?s=128&d=identicon&r=PG&f=1", "display_name": "Hakes", "link": "https://stackoverflow.com/users/3985387/hakes"}, "is_accepted": false, "score": 2, "last_activity_date": 1502882574, "creation_date": 1502882574, "answer_id": 45712234, "question_id": 45711458, "link": "https://stackoverflow.com/questions/45711458/is-this-bubble-sort-or-insertion-sort-in-c/45712234#45712234", "title": "Is this Bubble sort or insertion sort in C?", "body": "<p>I would say closer to insertion sort as you create sorted chunks by finding the first misfit. Rather than iterating whole array and pushing the largest element to the end (like in bubble sort)</p>\n\n<p>It is closer to the standard version of insertion sort, where you swap elements until you find the right place in the sorted chunk. However, after you insert your element you start your index from wrong index, as it has created a sorted sub array.</p>\n\n<p>This helps visualize the two sorting algorithms:\n<a href=\"https://visualgo.net/bn/sorting\" rel=\"nofollow noreferrer\">https://visualgo.net/bn/sorting</a></p>\n"}], "owner": {"reputation": 39, "user_id": 8471886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51437304b73bb64364c70b6a65b0f81c?s=128&d=identicon&r=PG&f=1", "display_name": "Jafar Habshee", "link": "https://stackoverflow.com/users/8471886/jafar-habshee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1502884692, "creation_date": 1502880364, "last_edit_date": 1502884692, "question_id": 45711458, "link": "https://stackoverflow.com/questions/45711458/is-this-bubble-sort-or-insertion-sort-in-c", "title": "Is this Bubble sort or insertion sort in C?", "body": "<p>I have written this code by understanding the insertion sort algo. My teacher says its bubble sort but my friends are saying it is insertion. Could someone please check and brief me on this.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid sort(int n) {\n  int i, j;\n  float arr[n], k;\n  for (i = 0; i &lt;= n - 1; i++) {\n    printf(\"Enter the number\");\n    scanf(\"%f\", &amp;arr[i]);\n  }\n\n  for (i = 1; i &lt;= n - 1; i++) {\n    j=i\n    while (arr[j] &lt; arr[j - 1] &amp;&amp; j &gt; 0) {\n      k = arr[j - 1];\n      arr[j - 1] = arr[j];\n      arr[j] = k;\n      /*printf(\"\\n\\t%f\",arr[j]);*/\n      j--;\n      /*printf(\"\\n%d\",j);*/\n    }\n    /*printf(\"\\n%d\",x[i]);*/\n  }\n  for (i = 0; i &lt; n; i++) {\n    printf(\"\\n%f\", arr[i]);\n  }\n}\n\nint main() {\n  int t;\n  printf(\"Enter the number of values to be sorted\");\n  scanf(\"%d\", &amp;t);\n  sort(t);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "shell", "email"], "comments": [{"owner": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "edited": false, "score": 3, "creation_date": 1502880338, "post_id": 45711417, "comment_id": 78380806, "body": "Look at the email headers"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502880472, "post_id": 45711417, "comment_id": 78380900, "body": "Besides the headers, the &quot;text&quot; in a base64-encoded message doesn&#39;t really contain much whitespace. A &quot;normal&quot; text would have some, as well as some punctuation characters (usually). You could also check the length if it&#39;s multiple of four (including padding of <code>&#39;=&#39;</code> at the end). Even combined it&#39;s not a 100% certain way to detect it, but it&#39;s definitely a hint."}, {"owner": {"reputation": 94, "user_id": 7763996, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/852f371407cfaf2dc04a7793cee75b99?s=128&d=identicon&r=PG&f=1", "display_name": "shinwari_afg", "link": "https://stackoverflow.com/users/7763996/shinwari-afg"}, "edited": false, "score": 0, "creation_date": 1502880811, "post_id": 45711417, "comment_id": 78381151, "body": "I need a better solution than downloading all the headers and then deciding on that matter whether to decode or not, that&#39;s computationally very expensive."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1502881125, "post_id": 45711417, "comment_id": 78381403, "body": "Make a histogram. In base64, the 64 possible characters are distributed uniformly."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502881277, "post_id": 45711417, "comment_id": 78381512, "body": "Can you please try to be more specific about the header-thing... Do you want to fetch <i>all</i> messages or only those that are (or are not) base64 encoded? If you want to fetch all messages then you need the headers as well, and parsing them is not that computationally expensive on a relative modern system. And even if you only want to fetch some messages, getting the headers and deciding which message bodies to fetch is way better than to fetch all messages and try to decode them."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1502884307, "post_id": 45711417, "comment_id": 78383471, "body": "<i>I need a better solution than downloading all the headers and then deciding on that matter whether to decode or not, that&#39;s computationally very expensive.</i>  You&#39;ve already downloaded the entire email, haven&#39;t you? And why do you think it&#39;s computationally intensive to read the headers? Have you benchmarked how much time it takes to read headers and compared it to how much time it takes to download the email itself?  And even if it is computationally intensive, I don&#39;t know how you can possibly process an email <i>without</i> parsing the headers."}, {"owner": {"reputation": 94, "user_id": 7763996, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/852f371407cfaf2dc04a7793cee75b99?s=128&d=identicon&r=PG&f=1", "display_name": "shinwari_afg", "link": "https://stackoverflow.com/users/7763996/shinwari-afg"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502896549, "post_id": 45711417, "comment_id": 78392625, "body": "@Someprogrammerdude  Nope, not all, I fetch only one unseen email at a time, but after fetching i have to decode it to a plain text or a multimedia file, it works fine, but 1 email in 10 is actually not base64 encoded while my program decodes every email it fetches, so that one email which is plain text and not base64 encoded ends up as some corrupts data or empty file...Basically i want to skip decoding that email which is simple plain text and not base64 text."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1502897118, "post_id": 45711417, "comment_id": 78393043, "body": "@wildplasser, that&#39;s only true if the data that&#39;s been base64-encoded is compressed or random."}, {"owner": {"reputation": 94, "user_id": 7763996, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/852f371407cfaf2dc04a7793cee75b99?s=128&d=identicon&r=PG&f=1", "display_name": "shinwari_afg", "link": "https://stackoverflow.com/users/7763996/shinwari-afg"}, "edited": false, "score": 0, "creation_date": 1502897318, "post_id": 45711417, "comment_id": 78393189, "body": "To be more simple, I want to detect whether a string or a text file is a base64 encoded text or plain text."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502928151, "post_id": 45711417, "comment_id": 78407088, "body": "If you see any characters outside the 64 characters used to encode Base-64, plus = for padding, plus newline, then you can be fairly sure it isn&#39;t Base-64.  If you don&#39;t see any tabs or spaces, it is not (normal) plain text.  The smaller the fragment, the easier it is to confuse plain text with Base64.  Indeed, you may not be able to distinguish reliably: a line containing just <code>Apoplexy</code>, for example, could give someone apoplexy if they&#39;re trying to decide whether that&#39;s plain text or Base-64.  It&#39;s a weird character sequence when decoded as Base-64 (0x02 0x9A 0x29 0x95 0xEC 0x72) but valid."}, {"owner": {"reputation": 94, "user_id": 7763996, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/852f371407cfaf2dc04a7793cee75b99?s=128&d=identicon&r=PG&f=1", "display_name": "shinwari_afg", "link": "https://stackoverflow.com/users/7763996/shinwari-afg"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1503086544, "post_id": 45711417, "comment_id": 78486808, "body": "@JonathanLeffler I implemented this technique , but it is not a solution , it is easily confused with words like Hellolol , Apoplexy etc....Wasted my time on that, I&#39;m stuck."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1503094172, "post_id": 45711417, "comment_id": 78489837, "body": "The problem is that other than looking at surrounding information \u2014 headers etc \u2014 there&#39;s nothing to tell you whether an 8-character word is a word or Base64 encoded data.  The problem is irresolvable."}, {"owner": {"reputation": 94, "user_id": 7763996, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/852f371407cfaf2dc04a7793cee75b99?s=128&d=identicon&r=PG&f=1", "display_name": "shinwari_afg", "link": "https://stackoverflow.com/users/7763996/shinwari-afg"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1503137348, "post_id": 45711417, "comment_id": 78498694, "body": "@JonathanLeffler I moved to get it done via headers fields, but new problem arises, see here: [link] (<a href=\"https://stackoverflow.com/questions/45765611/libcurl-imaps-doesnt-returns-header-field-content-transfer-encoding-or-conte\" title=\"libcurl imaps doesnt returns header field content transfer encoding or conte\">stackoverflow.com/questions/45765611/&hellip;</a>)"}], "owner": {"reputation": 94, "user_id": 7763996, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/852f371407cfaf2dc04a7793cee75b99?s=128&d=identicon&r=PG&f=1", "display_name": "shinwari_afg", "link": "https://stackoverflow.com/users/7763996/shinwari-afg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 573, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502896801, "creation_date": 1502880235, "last_edit_date": 1502896801, "question_id": 45711417, "link": "https://stackoverflow.com/questions/45711417/how-to-detect-if-a-text-is-base64-encoded-or-is-a-plain-text-c-linux", "title": "How to detect if a text is base64 encoded or is a plain text.? ( C, Linux)", "body": "<p>I'm having issues with an email client that I'm working on, basically when I fetch an email I have to decode it via base64 tools, I have automated the process by directly downloading unseen new emails and then it is auto decoded and gives me the actual email text or attachment, but the problem is that some emails to my gmail accounts are in plain text and html which when automatically decoded gives me just empty files instead of the plain text.</p>\n\n<p>So i want to know if there is any way by which i can detect the text format before trying to decode it, because decoding a simple plain text or html actually corrupts the data.</p>\n\n<p>This would help me decode only those emails which is base64 encoded instead of decoding every and all emails that i fetch from my gmail account.</p>\n\n<p>I'm on linux, doing it in C and shell.</p>\n\n<p>Would really appreciate your help.</p>\n\n<blockquote>\n  <p>Edit: I fetch only one unseen email (Body, one or two sections\n  excluding headers) at a time, but after fetching i have to decode it\n  to a plain text or a multimedia file, it works fine, but one email in\n  10 is actually not base64 encoded and is a simple plain text while my\n  program decodes every email it fetches, so that one email which is\n  plain text and not base64 encoded ends up as some empty file... </p>\n  \n  <p>So I want to skip decoding that email which is simple plain text and\n  not base64 text.</p>\n</blockquote>\n"}, {"tags": ["c", "gcc", "autoconf"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1502880819, "post_id": 45711402, "comment_id": 78381155, "body": "How about adding a <code>configure.ac</code> check for the special functions? If it doesn&#39;t exist, even though the feature macro is defined, then it doesn&#39;t exist."}, {"owner": {"reputation": 1044, "user_id": 1257349, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ab33efa9ebe6a1658a00ddf92d6ac5bf?s=128&d=identicon&r=PG", "display_name": "meijuh", "link": "https://stackoverflow.com/users/1257349/meijuh"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502882305, "post_id": 45711402, "comment_id": 78382165, "body": "@Someprogrammerdude, this might  not be such a bad idea because you can of course use e.g. clang to compile on Linux which does not define <code>__GNUC__</code>."}], "owner": {"reputation": 1044, "user_id": 1257349, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ab33efa9ebe6a1658a00ddf92d6ac5bf?s=128&d=identicon&r=PG", "display_name": "meijuh", "link": "https://stackoverflow.com/users/1257349/meijuh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502880201, "creation_date": 1502880201, "question_id": 45711402, "link": "https://stackoverflow.com/questions/45711402/how-to-check-if-a-feature-macro-has-effect", "title": "How to check if a feature macro has effect?", "body": "<p>In C, what is the correct way to check if a feature macro has any effect?</p>\n\n<p>For example, if <code>configure.ac</code> contains the macro <code>AC_USE_SYSTEM_EXTENSIONS</code> then it will define <code>_GNU_SOURCE</code> on whatever OS. However, if we compile on OSX then <code>_GNU_SOURCE</code> will not have any effect. But on GNU systems it does, so how can I check if _GNU_SOURCE enables a feature, such as <code>qsort_r</code>?</p>\n\n<p><code>man feature_test_macros</code> says I should not include <code>features.h</code>, since it could be different on every system, meaning I can not use <code>__USE_GNU</code>.</p>\n\n<p>The other option would be to check if <code>__GNUC__</code> is defined, or possibly if both <code>__GNUC__</code> and <code>_GNU_SOURCE</code> are defined?</p>\n"}, {"tags": ["c++", "c", "gcc", "clang"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502879846, "post_id": 45711269, "comment_id": 78380462, "body": "You can&#39;t really mix object files created by different compilers. And a static library is nothing more than an archive of object files."}, {"owner": {"reputation": 474, "user_id": 3868435, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b991bfce5f73a9349b2f36412cd4108d?s=128&d=identicon&r=PG&f=1", "display_name": "peterSweter", "link": "https://stackoverflow.com/users/3868435/petersweter"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502880283, "post_id": 45711269, "comment_id": 78380769, "body": "At all ? I have error related with stack protector and setting -fno-stack-protector helped. Are there some tricks like that to fix that ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502880684, "post_id": 45711269, "comment_id": 78381044, "body": "Well, it <i>might</i> be possible if you link with the GCC runtime (e.g. <code>-lgcc</code> or similar). I would personally still try to avoid the mixing anyway."}], "owner": {"reputation": 474, "user_id": 3868435, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b991bfce5f73a9349b2f36412cd4108d?s=128&d=identicon&r=PG&f=1", "display_name": "peterSweter", "link": "https://stackoverflow.com/users/3868435/petersweter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 682, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502879749, "creation_date": 1502879749, "question_id": 45711269, "link": "https://stackoverflow.com/questions/45711269/clang-undefined-reference-to-fprintf-chk", "title": "clang undefined reference to `__fprintf_chk&#39;", "body": "<p>I am trying to link to my project some static libraries compiled with gcc-5.\nIn my project i use clang to build. I have following errors:</p>\n\n<pre><code>undefined reference to 'stderr'\nundefined reference to '__fprintf_chk'\nundefined reference to '__vfprintf_chk'\n</code></pre>\n"}, {"tags": ["c", "ncurses", "braille"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1502879021, "post_id": 45710987, "comment_id": 78379907, "body": "so, does it work with <code>stdio</code>? Looks like some encoding problem, but could be a bug in your ncurses&#39; handling of multi-byte characters."}, {"owner": {"reputation": 581, "user_id": 4615851, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/339e86a6b90c32c90c5133555b849b21?s=128&d=identicon&r=PG&f=1", "display_name": "Klas. S", "link": "https://stackoverflow.com/users/4615851/klas-s"}, "edited": false, "score": 0, "creation_date": 1502879417, "post_id": 45710987, "comment_id": 78380167, "body": "It seems to work with <code>stdio</code>, I am running version 6.0.20160910 of ncurses"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 1, "creation_date": 1502882087, "post_id": 45710987, "comment_id": 78382032, "body": "Maybe this would help: <a href=\"https://stackoverflow.com/a/6249265/8051589\">stackoverflow.com/a/6249265/8051589</a>?"}, {"owner": {"reputation": 581, "user_id": 4615851, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/339e86a6b90c32c90c5133555b849b21?s=128&d=identicon&r=PG&f=1", "display_name": "Klas. S", "link": "https://stackoverflow.com/users/4615851/klas-s"}, "edited": false, "score": 1, "creation_date": 1502882205, "post_id": 45710987, "comment_id": 78382114, "body": "Yes!! Thank you, I called <code>setlocale()</code> after <code>initscr()</code>, so it didn&#39;t work. If I call if before, it works!"}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1502958921, "post_id": 45710987, "comment_id": 78418007, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19373027/how-can-i-print-%ef%be%9f%e3%83%ae%ef%be%9f-with-ncurses\">How can I print (\u261e\uff9f\u30ee\uff9f)\u261e with Ncurses?</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1503004141, "post_id": 45710987, "comment_id": 78447385, "body": "do we close as a duplicate? :D"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 2, "last_activity_date": 1502882187, "creation_date": 1502882187, "answer_id": 45712089, "question_id": 45710987, "link": "https://stackoverflow.com/questions/45710987/print-braille-characters-in-ncurses/45712089#45712089", "title": "Print braille characters in ncurses", "body": "<p>With some experimentation, I found what is probably wrong:</p>\n\n<ol>\n<li><p>Your program uses the <code>C</code> locale by default. This assumes ASCII encoding. It's not a problem when you output multi-byte characters with <code>stdio</code>, because these functions just deliver the bytes <em>as is</em> to the console. But <code>ncurses</code> actually uses the locale, so it can know things like how many bytes make a character (important for exact positioning) etc. Change your program as following:</p>\n\n<pre><code>#include &lt;curses.h&gt;\n#include &lt;locale.h&gt;\n\nint main(int argc, char *argv[])\n{\n    // initialize locale to system's default:\n    setlocale(LC_ALL, \"\");\n\n    // now init and use curses ...\n</code></pre></li>\n<li><p>If you still get garbled output, your system's <code>libncurses</code> doesn't handle unicode. In that case, link <code>ncursesw</code> instead of <code>ncurses</code> and you should be done.</p></li>\n</ol>\n"}], "owner": {"reputation": 581, "user_id": 4615851, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/339e86a6b90c32c90c5133555b849b21?s=128&d=identicon&r=PG&f=1", "display_name": "Klas. S", "link": "https://stackoverflow.com/users/4615851/klas-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 45712089, "answer_count": 1, "score": 4, "last_activity_date": 1502888848, "creation_date": 1502878914, "last_edit_date": 1502882000, "question_id": 45710987, "link": "https://stackoverflow.com/questions/45710987/print-braille-characters-in-ncurses", "title": "Print braille characters in ncurses", "body": "<p>I attempted to print braille characters in ncurses.</p>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;ncurses.h&gt;\n\nchar *str = \n    \" \u2801\u2802\u2803\u2804\u2805\u2806\u2807\u2808\u2809\u280a\u280b\u280c\u280d\u280e\u280f\\n\"\n    \"\u2810\u2811\u2812\u2813\u2814\u2815\u2816\u2817\u2818\u2819\u281a\u281b\u281c\u281d\u281e\u281f\\n\"\n    \"\u2820\u2821\u2822\u2823\u2824\u2825\u2826\u2827\u2828\u2829\u282a\u282b\u282c\u282d\u282e\u282f\\n\"\n    \"\u2830\u2831\u2832\u2833\u2834\u2835\u2836\u2837\u2838\u2839\u283a\u283b\u283c\u283d\u283e\u283f\\n\";\n\n\nint main(int argc, const char *argv[]) {\n    initscr();\n    printw(\"%s\", str);\n    getch();\n    printf(\"%s\", curses_version());\n    endwin();\n    printf(\"%s\", str);\n    return 0;\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code> ?~A?~B?~C?~D?~E?~F?~G?~H?~I?~J?~K?~L?~M?~N?~O\n?~P?~Q?~R?~S?~T?~U?~V?~W?~X?~Y?~Z?~[?~\\?~]?~^?~_\n\u2820\u2821\u2822\u2823\u2824\u2825\u2826\u2827\u2828\u2829\u282a\u282b\u282c\u282d\u282e\u282f\n\u2830\u2831\u2832\u2833\u2834\u2835\u2836\u2837\u2838\u2839\u283a\u283b\u283c\u283d\u283e\u283f\n</code></pre>\n\n<p>How do I output all characters correctly?</p>\n\n<p>Update: I also tried <code>printf</code> which seems to work, <code>addstr</code> produces the same output as <code>printw</code>. </p>\n\n<p>If I change the locale with <code>setlocale(LC_ALL, \"\");</code> I get the output:</p>\n\n<pre><code>  A B C D E F G H I J K L M N O\n P Q R S T U V W X Y Z [ \\ ] ^ _\n\u2820\u2821\u2822\u2823\u2824\u2825\u2826\u2827\u2828\u2829\u282a\u282b\u282c\u282d\u282e\u282f\n\u2830\u2831\u2832\u2833\u2834\u2835\u2836\u2837\u2838\u2839\u283a\u283b\u283c\u283d\u283e\u283f\n</code></pre>\n"}, {"tags": ["c", "timer", "signals", "posix"], "comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1502878412, "post_id": 45710741, "comment_id": 78379513, "body": "Why are you set the time after you delete timer?"}, {"owner": {"reputation": 59, "user_id": 7346433, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208928343179925/picture?type=large", "display_name": "Claudio Santoro", "link": "https://stackoverflow.com/users/7346433/claudio-santoro"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1502878841, "post_id": 45710741, "comment_id": 78379789, "body": "I&#39;m setting fields to 0 to disarm timer; however, also without that lines program doesn&#39;t run.."}], "owner": {"reputation": 59, "user_id": 7346433, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208928343179925/picture?type=large", "display_name": "Claudio Santoro", "link": "https://stackoverflow.com/users/7346433/claudio-santoro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502878194, "creation_date": 1502878194, "question_id": 45710741, "link": "https://stackoverflow.com/questions/45710741/c-timer-settime-error-invalid-argument-after-timer-delete", "title": "C, timer_settime() error: invalid argument, after timer_delete()?", "body": "<p>I'm doing a simple program where I repeatedly create and destroy some timers; with first timer, program runs correctly, creating and destroying timers; but with second timer, when I do timer_settime(), i get error \"Invalid argument\"; without timer delete, only disarming timer, code runs correctly; why this?</p>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;unistd.h&gt;\n\n\nint d,x = 0;\n\nvoid err_exit(char* str)\n{\n    perror(str);\n    exit(EXIT_FAILURE);\n}\n\n\nvoid sighandler(int sig, siginfo_t *si, void *uc)\n{\n    (void) sig;\n    (void) uc;\n    d = si-&gt;si_value.sival_int;\n    ++x;\n}\n\n\n\nvoid handle_signal(struct sigaction* sa)\n{\n    sa-&gt;sa_flags = SA_SIGINFO;\n    sa-&gt;sa_sigaction = sighandler;\n    sigemptyset(&amp;sa-&gt;sa_mask);\n    if (sigaction(SIGRTMAX,sa,NULL) == -1)\n        err_exit(\"sigaction\");\n}\n\n\n\nvoid create_timer(struct sigevent* sev,timer_t* timer_id,int i)\n{\n    union sigval s;\n    s.sival_int = i+11;\n    printf(\"value: %d\\n\",i);\n    sev-&gt;sigev_notify = SIGEV_SIGNAL;\n    sev-&gt;sigev_signo = SIGRTMAX;\n    sev-&gt;sigev_value = s;\n\n\n    timer_create(CLOCK_REALTIME,sev,timer_id);\n\n}\n\n\nvoid set_timer(timer_t timer_id,struct itimerspec* ts,int j)\n{\n    if(ts == NULL)\n        printf(\"itimerspec null\\n\");\n    printf(\"creating timer %ju\\n\",timer_id);\n    if (timer_settime(timer_id, 0, ts, NULL) == -1){\n        printf(\"errno code: %d\\n\",errno);\n        err_exit(\"timer_settime\");\n    }\n}\n\n\n\nvoid initialize_timerspec(struct itimerspec* ts)\n{\n    ts-&gt;it_value.tv_sec = 2;\n    ts-&gt;it_value.tv_nsec = 5;\n    ts-&gt;it_interval.tv_sec = 0;\n    ts-&gt;it_interval.tv_nsec = 0;\n}\n\n\n\nvoid reset_timer(timer_t timer_id,int j)\n{\n\n    printf(\"ok1\\n\");\n\n    struct itimerspec its;\n    memset((void*)&amp;its, 0, sizeof(its));\n    printf(\"tv_sec %d   tv_nsec %d    tv_sec2 %d   tv_nsec2 %d\\n\",its.it_value.tv_sec,its.it_value.tv_nsec,its.it_interval.tv_sec,its.it_interval.tv_nsec);\n    printf(\"disarming timer  %ju\\n\",timer_id);\n    if(timer_settime(timer_id, 0, &amp;its, NULL) == -1)\n        err_exit(\"disarming timer\\n\");\n    if (timer_delete(timer_id) == -1){\n            printf(\"errno code: %d\\n\",errno);\n            err_exit(\"timer_settime\");\n    }\n    printf(\"ok2\\n\");\n\n    printf(\"delete timer\\n\");\n}\n\n\n\nvoid* thread(void* arg)\n{\n    (void) arg;\n    sleep(10);\n    printf(\"awake thread\\n\");\n\n    return NULL;\n}\n\n\n\n\n\nint main()\n{\n    struct sigaction sa;\n    struct itimerspec ts[10];\n    struct sigevent sev[10];\n    timer_t timer_id[10];\n    int j;\n\n\n    handle_signal(&amp;sa);\n\n    for(j = 0; j &lt; 10; j++){\n        create_timer(&amp;(sev[j]),&amp;(timer_id[j]),j);\n        initialize_timerspec(&amp;(ts[j]));\n        set_timer(&amp;(timer_id[j]),&amp;(ts[j]),j);\n        reset_timer(timer_id[j],j);\n    }\n\n    sleep(10);\n\n    printf(\"d = %d\\n\",d);\n    printf(\"received signal  %d times\\n\",x);\n\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "sorting"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 3, "creation_date": 1502878070, "post_id": 45710609, "comment_id": 78379314, "body": "How can the code be fine and wrong at the same time?"}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 1, "creation_date": 1502878399, "post_id": 45710609, "comment_id": 78379497, "body": "@FelixPalmen: I guess it is &quot;fine&quot; in the sense that it compiles and runs without crashing. &lt;g&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7528536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d96acf5cd379be216ed21c141c35ce84?s=128&d=identicon&r=PG&f=1", "display_name": "codie", "link": "https://stackoverflow.com/users/7528536/codie"}, "edited": false, "score": 0, "creation_date": 1502880001, "post_id": 45710830, "comment_id": 78380575, "body": "thnx sir I got what u said.Now code is working fine :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 3, "last_activity_date": 1502878439, "creation_date": 1502878439, "answer_id": 45710830, "question_id": 45710609, "link": "https://stackoverflow.com/questions/45710609/why-this-selection-sort-code-not-giving-correct-output/45710830#45710830", "title": "Why this Selection Sort code not giving correct output?", "body": "<p>Two errors here:</p>\n\n<pre><code>for(int i=0;i&lt;(n-2);i++)\n</code></pre>\n\n<p>Why <code>-2</code>? You miss to compare the last elements this way, should be <code>-1</code>. The parantheses are unnecessary, but add some spaces instead to make it readable:</p>\n\n<pre><code>for (int i = 0; i &lt; n-1; i++)\n</code></pre>\n\n<p>Then, the next loop is wrong as well:</p>\n\n<pre><code>for(int j=0;j&lt;n;j++)\n</code></pre>\n\n<p>By starting at 0 again, you compare with what you <strong>already sorted</strong> and destroy it. Change it to this:</p>\n\n<pre><code>for (int j = i+1; j &lt; n; j++)\n</code></pre>\n\n<hr>\n\n<p>For problems like this, you should really read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>. The rubber duck would have helped you.</p>\n"}, {"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1502879887, "post_id": 45710990, "comment_id": 78380490, "body": "Way to many work there, keep it <a href=\"http://ideone.com/rTgArL\" rel=\"nofollow noreferrer\">simple</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502882523, "post_id": 45710990, "comment_id": 78382311, "body": "Well, not sure whether explaining the algorithm was <i>necessary</i>, but maybe it helps someone. Still, you should fix the formatting of your answer to make it more readable."}], "tags": [], "owner": {"reputation": 1, "user_id": 8236973, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6-CBDpanyv4/AAAAAAAAAAI/AAAAAAAAK94/btK_zyqKMy0/photo.jpg?sz=128", "display_name": "abhishek honey", "link": "https://stackoverflow.com/users/8236973/abhishek-honey"}, "is_accepted": false, "score": 0, "last_activity_date": 1502878919, "creation_date": 1502878919, "answer_id": 45710990, "question_id": 45710609, "link": "https://stackoverflow.com/questions/45710609/why-this-selection-sort-code-not-giving-correct-output/45710990#45710990", "title": "Why this Selection Sort code not giving correct output?", "body": "<p>You have made some silly mistakes, the selection sort algorithm works like this:: </p>\n\n<p>The selection sort algorithm sorts an array by repeatedly finding the minimum element (considering ascending order) from unsorted part and putting it at the beginning. The algorithm maintains two subarrays in a given array.</p>\n\n<p>1) The subarray which is already sorted.\n2) Remaining subarray which is unsorted.</p>\n\n<p>In every iteration of selection sort, the minimum element (considering ascending order) from the unsorted subarray is picked and moved to the sorted subarray.</p>\n\n<p>arr[] = 64 25 12 22 11</p>\n\n<p>// Find the minimum element in arr[0...4]\n// and place it at beginning\n11 25 12 22 64</p>\n\n<p>// Find the minimum element in arr[1...4]\n// and place it at beginning of arr[1...4]\n11 12 25 22 64</p>\n\n<p>// Find the minimum element in arr[2...4]\n// and place it at beginning of arr[2...4]\n11 12 22 25 64</p>\n\n<p>// Find the minimum element in arr[3...4]\n// and place it at beginning of arr[3...4]\n11 12 22 25 64 </p>\n\n<p>So your code should be like this:::</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nvoid sort(int arr[],int n);\nint main()\n{\n   int a[]={2,7,1,5};\n   sort(a,4);\n   return 0;\n}\n\nvoid sort(int arr[],int n)\n{\n   int i,j,temp;\n   int imin;\n   for(int i=0;i&lt;(n-1);i++)\n   {\n      imin=i;\n      for(int j=i+1;j&lt;n;j++)\n      {\n         if(arr[j]&lt;arr[imin])\n         {\n            imin=j;\n         }\n      }\n      temp=arr[i];\n      arr[i]=arr[imin];\n      arr[imin]=temp;\n\n   }\n   int k;\n   for(k=0;k&lt;n;k++)\n   {\n      printf(\"\\n%d\\n\",arr[k]);\n   }\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7528536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d96acf5cd379be216ed21c141c35ce84?s=128&d=identicon&r=PG&f=1", "display_name": "codie", "link": "https://stackoverflow.com/users/7528536/codie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1502912512, "answer_count": 2, "score": -1, "last_activity_date": 1502878919, "creation_date": 1502877823, "last_edit_date": 1502878015, "question_id": 45710609, "link": "https://stackoverflow.com/questions/45710609/why-this-selection-sort-code-not-giving-correct-output", "closed_reason": "Not suitable for this site", "title": "Why this Selection Sort code not giving correct output?", "body": "<p>When I run the code I got result <code>7215</code> which is obviously not correct. The code is fine there is no error in terminal only the output is wrong. Please help I know this is a basic sorting algorithm but I am new to programming.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nvoid sort(int arr[],int n);\nint main()\n{\n   int a[]={2,7,1,5};\n   sort(a,4);\n   return 0;\n}\n\nvoid sort(int arr[],int n)\n{\n   int i,j,temp;\n   int imin;\n   for(int i=0;i&lt;(n-2);i++)\n   {\n      imin=i;\n      for(int j=0;j&lt;n;j++)\n      {\n         if(arr[j]&lt;arr[imin])\n         {\n            imin=j;\n         }\n      }\n      temp=arr[i];\n      arr[i]=arr[imin];\n      arr[imin]=temp;\n   }\n   int k;\n   for(k=0;k&lt;n;k++)\n   {\n      printf(\"\\n%d\\n\",arr[k]);\n   }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1502877419, "post_id": 45710383, "comment_id": 78378886, "body": "<code>printf(&quot;distance[%d]=%d\\n&quot;, i,distance[i][i]);</code> are keys in <code>distance</code> correctly used?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1502877431, "post_id": 45710383, "comment_id": 78378892, "body": "What&#39;s the <code>+1</code> for? You don&#39;t pass it to your function, so it assumes a wrong array geometry."}], "answers": [{"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1502877612, "post_id": 45710480, "comment_id": 78379007, "body": "@FelixPalmen; Thanks. Corrected that."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1502877754, "post_id": 45710480, "comment_id": 78379102, "body": "I think the only problem was here <code>Initialize(distance, nodesCount);</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 3, "creation_date": 1502877877, "post_id": 45710480, "comment_id": 78379183, "body": "@Michi no, for passing a VLA, the size argument must appear <b>before</b> the VLA itself"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1502877903, "post_id": 45710480, "comment_id": 78379205, "body": "@FelixPalmen You right, I was missing something here :D"}, {"owner": {"reputation": 29, "user_id": 6223152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-R8lvO91TMWk/AAAAAAAAAAI/AAAAAAAAAFU/x3eYTaGyNQQ/photo.jpg?sz=128", "display_name": "Chen Phillis", "link": "https://stackoverflow.com/users/6223152/chen-phillis"}, "edited": false, "score": 0, "creation_date": 1502880174, "post_id": 45710480, "comment_id": 78380687, "body": "but one more thing: I tried only to swap the argument, but the result is wrong. it only gets solved when I fix the (nodesCount+1) part. what is the magic here? I cannot see any differences between nodesCount and nodesCount+1 methods"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1502880885, "post_id": 45710480, "comment_id": 78381209, "body": "Magic is <code>int (*distance)[nodesCount]</code> and <code>int (*distance)[nodesCount + 1]</code> declares <code>distance</code> a pointer to different data types."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 3, "last_activity_date": 1502878774, "last_edit_date": 1502878774, "creation_date": 1502877467, "answer_id": 45710480, "question_id": 45710383, "link": "https://stackoverflow.com/questions/45710383/2d-array-update-in-function-in-c/45710480#45710480", "title": "2D array update in function in c", "body": "<p>In</p>\n\n<pre><code>void Initialize(int (*distance)[nodesCount], int nodesCount) \n</code></pre>\n\n<p>compiler has no idea what is <code>nodesCount</code> in <code>int (*distance)[nodesCount]</code> because it has not seen it yet declared. This should be   </p>\n\n<pre><code>void Initialize(int nodesCount, int (*distance)[nodesCount]) \n</code></pre>\n\n<p>Then, you should pass <code>nodesCount+1</code> to <code>Initialize</code> function  </p>\n\n<pre><code>Initialize(nodesCount+1, distance);\n</code></pre>\n\n<p>Note that in function <code>Initialize</code>you have to change every occurrence of  <code>&lt;=nodesCount</code> in <code>for</code> loops to <code>&lt;nodesCount</code>.  </p>\n\n<pre><code>for (i=0; i&lt;nodesCount; ++i){ /* ... */ }\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6223152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-R8lvO91TMWk/AAAAAAAAAAI/AAAAAAAAAFU/x3eYTaGyNQQ/photo.jpg?sz=128", "display_name": "Chen Phillis", "link": "https://stackoverflow.com/users/6223152/chen-phillis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 45710480, "answer_count": 1, "score": 0, "last_activity_date": 1502879586, "creation_date": 1502877164, "last_edit_date": 1502879586, "question_id": 45710383, "link": "https://stackoverflow.com/questions/45710383/2d-array-update-in-function-in-c", "title": "2D array update in function in c", "body": "<p>I was trying to use the function <code>Initialize</code> to update the value of array <code>distance</code>, here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define NOT_CONNECTED -1\n\nint nodesCount;\n\nvoid Initialize(int (*distance)[nodesCount], int nodesCount) {\n    int i, j;\n    for(i = 0; i &lt;= nodesCount; ++i) {\n        for(j = 0; j &lt;= nodesCount; ++j) {\n            distance[i][j] = NOT_CONNECTED;\n        }\n        distance[i][i] = 0;\n    }\n    for(int i = 0; i &lt;= nodesCount; i++)\n        printf(\"distance[%d] = %d\\n\", i, distance[i][i]);\n\n}\n\nint main() {\n    scanf(\"%d\", &amp;nodesCount);\n\n    int distance[nodesCount + 1][nodesCount + 1];\n    Initialize(distance, nodesCount);\n\n    for(int i = 0; i &lt;= nodesCount; i++)\n        printf(\"distance[%d] = %d\\n\", i, distance[i][i]);\n}\n</code></pre>\n\n<p>But the test result printed out shows the updated array value is wired, could anybody explain what might have happened to this code?</p>\n\n<pre><code>distance[0] = 0\ndistance[1] = 0\ndistance[2] = 0\ndistance[3] = 0\ndistance[4] = 0\ndistance[5] = 0\ndistance[0] = 0\ndistance[1] = -1\ndistance[2] = -1\ndistance[3] = -1\ndistance[4] = -1\ndistance[5] = 32677\n</code></pre>\n"}, {"tags": ["c", "arm", "embedded", "stm32", "spi"], "answers": [{"tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1502877498, "creation_date": 1502877498, "answer_id": 45710493, "question_id": 45709748, "link": "https://stackoverflow.com/questions/45709748/write-spi-dummy-bytes-using-dma-circular-mode/45710493#45710493", "title": "Write SPI dummy bytes using DMA circular mode", "body": "<p>Enable DMA in normal mode and set number of elements to <code>27</code>. </p>\n\n<p>Later, disable memory increase for memory and for peripheral and your approach will work.</p>\n"}], "owner": {"reputation": 105, "user_id": 5208079, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-8fAk7NcvnOo/AAAAAAAAAAI/AAAAAAAAAEs/VLG_9UI1O80/photo.jpg?sz=128", "display_name": "Mlezi", "link": "https://stackoverflow.com/users/5208079/mlezi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1063, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1502877498, "creation_date": 1502875341, "question_id": 45709748, "link": "https://stackoverflow.com/questions/45709748/write-spi-dummy-bytes-using-dma-circular-mode", "title": "Write SPI dummy bytes using DMA circular mode", "body": "<p>I am trying to read a fixed number of bytes (27 bytes in total) from an SPI slave device using DMA. I'm running an STM32F4 chip. </p>\n\n<p>\"In order to read from the SPI bus, a clock needs to be generated. So you need to write in order to read.\" I set up my DMA controller to write a dummy byte (0xFF) in circular mode.</p>\n\n<pre><code>uint8_t tx_buffer[] = {0xFF};\n\nDMA_InitStruct.DMA_Mode = DMA_Mode_Circular;\nDMA_InitStruct.DMA_BufferSize = 1;\nDMA_InitStruct.DMA_Memory0BaseAddr = (uint32_t)tx_buffer;\n</code></pre>\n\n<p>and my Rx dma stream is setup using double buffer mode:</p>\n\n<pre><code>uint8_t rx_buffer0[27];\nuint8_t rx_buffer1[27];\n\nDMA_InitStruct.DMA_Mode = DMA_Mode_Normal;\nDMA_InitStruct.DMA_BufferSize = 27;\nDMA_InitStruct.DMA_Memory0BaseAddr = (uint32_t)rx_buffer0;\n\nDMA_DoubleBufferModeConfig(DMA2_Stream0, (uint32_t)rx_buffer1, DMA_Memory_0);\nDMA_DoubleBufferModeCmd(DMA2_Stream0, ENABLE);\n</code></pre>\n\n<p>(I have omitted other irrelevant initialisations.)</p>\n\n<p>After the 27 bytes are received a Transfer Complete interrupt is triggered.</p>\n\n<pre><code>void DMA2_Stream0_IRQHandler(void)\n{\n    if(DMA_GetITStatus(DMA2_Stream0, DMA_IT_TCIF0) == SET)\n    {\n        DMA_ClearITPendingBit(DMA2_Stream0, DMA_IT_TCIF0);\n        DMA_Cmd(DMA2_Stream1, DISABLE); // disable Tx circular writes\n    }\n}\n</code></pre>\n\n<p>The problem is as follows: I see correct data in the first buffer. But while the interrupt triggers the Tx circular DMA continues, filling the first few bytes of the second buffer until it is disabled.</p>\n\n<p>I want to avoid reserving 27 bytes for dummy data, so is there any way to stop a circular DMA stream after a fixed amount of cycles?   </p>\n"}, {"tags": ["c", "gcc", "macros"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 2, "creation_date": 1502875009, "post_id": 45709473, "comment_id": 78377142, "body": "@Pyjong: please <b>edit your question</b> to improve it and motivate it."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1502875760, "post_id": 45709473, "comment_id": 78377699, "body": "Until you can explain <i>why</i> you &lt;del&gt;need&lt;/del&gt; want this, you&#39;re unlikely to get good answers that address your needs.  Can you explain why using <code>-D</code> doesn&#39;t achieve what you need?  Are you targeting a new platform, for instance?  (Or a new variant of an existing platform)  Are you trying to build some uncooperative source you don&#39;t want to change?  Are you simply trying to understand how GCC initialises itself?  Any of these are valid reasons to be interested, but they all make for very different answers."}, {"owner": {"reputation": 2747, "user_id": 220594, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2471c61947385b1d7c0be89482373c26?s=128&d=identicon&r=PG", "display_name": "Pyjong", "link": "https://stackoverflow.com/users/220594/pyjong"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1502876018, "post_id": 45709473, "comment_id": 78377889, "body": "@TobySpeight I do not agree. I like the answers bellow. And yes, new platform."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1502876179, "post_id": 45709473, "comment_id": 78377996, "body": "If you&#39;re targeting a new platform, you&#39;ll need to (create and) edit its spec file.  I suggest you <a href=\"https://stackoverflow.com/posts/45709473/edit\">edit</a> your question to indicate that this is what you&#39;re trying to achieve, to avoid contributors wasting their time with answers that are not appropriate to this more specific question."}, {"owner": {"reputation": 2747, "user_id": 220594, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2471c61947385b1d7c0be89482373c26?s=128&d=identicon&r=PG", "display_name": "Pyjong", "link": "https://stackoverflow.com/users/220594/pyjong"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1502876536, "post_id": 45709473, "comment_id": 78378257, "body": "@Toby Ok that&#39;s what I got in one of the answers. Please be honest and admit the only reason for time wasted here is everyone boo-hooing about not knowing how to do it. Except for you and Basile, the two who actually told me how to do it."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1502876545, "post_id": 45709473, "comment_id": 78378264, "body": "Without additional motivations I voted to close that question as unclear. It surely is some <a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">XY problem</a>."}, {"owner": {"reputation": 2747, "user_id": 220594, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2471c61947385b1d7c0be89482373c26?s=128&d=identicon&r=PG", "display_name": "Pyjong", "link": "https://stackoverflow.com/users/220594/pyjong"}, "edited": false, "score": 0, "creation_date": 1502876609, "post_id": 45709473, "comment_id": 78378325, "body": "Why, I will accept your answer once I make it work.."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1502876845, "post_id": 45709473, "comment_id": 78378477, "body": "@Pyjong, please don&#39;t accuse people of dishonesty, especially when we&#39;re trying to help improve your question so that it&#39;s useful for more readers than just yourself.  I&#39;m leaving this question now."}, {"owner": {"reputation": 2747, "user_id": 220594, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2471c61947385b1d7c0be89482373c26?s=128&d=identicon&r=PG", "display_name": "Pyjong", "link": "https://stackoverflow.com/users/220594/pyjong"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1502877067, "post_id": 45709473, "comment_id": 78378657, "body": "@TobySpeight Ok, I am sorry I didn&#39;t mean to be rude. Thanks for help."}], "answers": [{"comments": [{"owner": {"reputation": 2747, "user_id": 220594, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2471c61947385b1d7c0be89482373c26?s=128&d=identicon&r=PG", "display_name": "Pyjong", "link": "https://stackoverflow.com/users/220594/pyjong"}, "edited": false, "score": 0, "creation_date": 1502876133, "post_id": 45709557, "comment_id": 78377966, "body": "Yeah I think I&#39;m going to try this. Thanks."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 2747, "user_id": 220594, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2471c61947385b1d7c0be89482373c26?s=128&d=identicon&r=PG", "display_name": "Pyjong", "link": "https://stackoverflow.com/users/220594/pyjong"}, "edited": false, "score": 0, "creation_date": 1502876236, "post_id": 45709557, "comment_id": 78378039, "body": "I&#39;m sure you are wrong in trying this. Just add appropriately your <code>gcc</code> script and have a good <code>$PATH</code> using it. Could you please <i>improve your question</i> by motivating it appropriately (so add a few paragraphs explaining your motivations)."}, {"owner": {"reputation": 2747, "user_id": 220594, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2471c61947385b1d7c0be89482373c26?s=128&d=identicon&r=PG", "display_name": "Pyjong", "link": "https://stackoverflow.com/users/220594/pyjong"}, "edited": false, "score": 0, "creation_date": 1502892896, "post_id": 45709557, "comment_id": 78389926, "body": "Ok, no. On closer look I do agree with you that what you&#39;re suggesting is wrong. Answer I was looking for is in gcc\\config. Thanks for your effort though."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 4, "last_activity_date": 1502876620, "last_edit_date": 1502876620, "creation_date": 1502874822, "answer_id": 45709557, "question_id": 45709473, "link": "https://stackoverflow.com/questions/45709473/how-do-you-add-specify-predefined-macros-for-gcc/45709557#45709557", "title": "How do you add/specify predefined macros for GCC?", "body": "<p>You might consider providing some (or improving yours) <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Spec-Files.html\" rel=\"nofollow noreferrer\">spec file</a>.</p>\n\n<p>You could patch the <a href=\"https://gcc.gnu.org/viewcvs/gcc/branches/gcc-7-branch/gcc/c-family/c-cppbuiltin.c\" rel=\"nofollow noreferrer\"><code>gcc/c-family/c-cppbuiltin.c</code> file</a> of the source code of GCC. </p>\n\n<p>You could <a href=\"https://gcc.gnu.org/onlinedocs/gccint/Plugins.html\" rel=\"nofollow noreferrer\">code</a> then <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Overall-Options.html\" rel=\"nofollow noreferrer\">use</a> a GCC plugin defining additional predefined macros.</p>\n\n<p>But I am sure it is a <strong>very bad idea</strong>; I recommend instead passing <em>explicitly</em> some <code>-D</code> flag to your compiler; your question smells badly as some <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY problem</a>. You need to <em>motivate your question</em>.</p>\n\n<p>You could instead organize your <a href=\"https://en.wikipedia.org/wiki/PATH_(variable)\" rel=\"nofollow noreferrer\">PATH variable</a> and add appropriately some <code>gcc</code> shell script adding that <code>-DMACRO</code> option and explicitly invoking e.g. <code>/usr/bin/gcc</code> with it.</p>\n"}, {"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 2, "creation_date": 1502875911, "post_id": 45709891, "comment_id": 78377809, "body": "There is no need to move <code>&#47;usr&#47;bin&#47;gcc</code> to <code>&#47;usr&#47;bin&#47;gcc.original</code>. Just add an appropriate <code>gcc</code> shell script (and have a well ordered <code>$PATH</code>)"}], "tags": [], "owner": {"reputation": 428, "user_id": 2516697, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/3nNCJ.jpg?s=128&g=1", "display_name": "s.paszko", "link": "https://stackoverflow.com/users/2516697/s-paszko"}, "is_accepted": false, "score": 1, "last_activity_date": 1502875962, "last_edit_date": 1502875962, "creation_date": 1502875762, "answer_id": 45709891, "question_id": 45709473, "link": "https://stackoverflow.com/questions/45709473/how-do-you-add-specify-predefined-macros-for-gcc/45709891#45709891", "title": "How do you add/specify predefined macros for GCC?", "body": "<p></p>\n\n<p>On Linux you can </p>\n\n<ul>\n<li><p>use an alias:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>alias gcc=\"gcc -DMACRO1 -DMACRO2\"\n</code></pre></li>\n<li><p>Copy old <code>/usr/bin/gcc</code> to <code>/usr/bin/gcc.original</code>. Make your own shell script and name it <code>/usr/bin/gcc</code>, inside which you have </p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>exec /usr/bin/gcc.original -DMACRO1 -DMACRO2 \"$@\"\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 2747, "user_id": 220594, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2471c61947385b1d7c0be89482373c26?s=128&d=identicon&r=PG", "display_name": "Pyjong", "link": "https://stackoverflow.com/users/220594/pyjong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "closed_date": 1502878227, "answer_count": 2, "score": -6, "last_activity_date": 1502876620, "creation_date": 1502874608, "last_edit_date": 1502874681, "question_id": 45709473, "link": "https://stackoverflow.com/questions/45709473/how-do-you-add-specify-predefined-macros-for-gcc", "closed_reason": "Needs details or clarity", "title": "How do you add/specify predefined macros for GCC?", "body": "<p>important thing: <code>-D</code> does not apply here.</p>\n\n<p>Is it possible to declare macros that appear in every compilation (much like predefined macros) in some dynamic manner (meaning I'm lazy to recompile gcc)? or do I have to recompile my gcc? Should I have to recompile, how do I specify my predefined macros?</p>\n"}, {"tags": ["c", "json", "cjson"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 7, "creation_date": 1502873474, "post_id": 45709054, "comment_id": 78376098, "body": "and what is the question...?"}, {"owner": {"reputation": 67098, "user_id": 1235698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90fd9ad4efef8eb93209f42183c48f3e?s=128&d=identicon&r=PG", "display_name": "Marcin Orlowski", "link": "https://stackoverflow.com/users/1235698/marcin-orlowski"}, "edited": false, "score": 3, "creation_date": 1502873490, "post_id": 45709054, "comment_id": 78376112, "body": "Welcome to StackOverflow. Unfortunately this is neither a tutorial site nor web search replacement. We can help solve <a href=\"https://stackoverflow.com/help/on-topic\">certain problems</a>, but it&#39;s <b>your</b> job to <a href=\"http://meta.stackoverflow.com/questions/261592\">put some efforts</a> in the first place, incl. elementary <a href=\"https://google.com/\" rel=\"nofollow noreferrer\">(re)search</a>"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1502873692, "post_id": 45709054, "comment_id": 78376248, "body": "Edit your question to show us what you have tried and what the actual problem is."}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 1, "creation_date": 1502874142, "post_id": 45709054, "comment_id": 78376549, "body": "And what is the problem/output?"}, {"owner": {"reputation": 113, "user_id": 4833530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7bb38fc13b3c8c72e240b14ec30c1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/4833530/abhishek"}, "edited": false, "score": 0, "creation_date": 1502877519, "post_id": 45709054, "comment_id": 78378957, "body": "Marcin Orlowski  - for your info i  am putting effort before asking the question &amp; after posting it until i got the answer. and thanks for letting me know that this is not the tutorial site.by the way i got the answer ."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4833530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7bb38fc13b3c8c72e240b14ec30c1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/4833530/abhishek"}, "edited": false, "score": 0, "creation_date": 1502875779, "post_id": 45709781, "comment_id": 78377708, "body": "it is not Fixed it will come from some string array."}, {"owner": {"reputation": 113, "user_id": 4833530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7bb38fc13b3c8c72e240b14ec30c1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/4833530/abhishek"}, "edited": false, "score": 0, "creation_date": 1502875914, "post_id": 45709781, "comment_id": 78377812, "body": "string carType[]={&quot;BMW&quot;, &quot;Mercides&quot;, &quot;Audi&quot;, &quot;Farari&quot;}; string carID[]={&quot;bmw11&quot;, &quot;m22&quot;, &quot;a33&quot;, &quot;f44&quot;};"}, {"owner": {"reputation": 41796, "user_id": 1870232, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rbI29.jpg?s=128&g=1", "display_name": "P0W", "link": "https://stackoverflow.com/users/1870232/p0w"}, "reply_to_user": {"reputation": 113, "user_id": 4833530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7bb38fc13b3c8c72e240b14ec30c1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/4833530/abhishek"}, "edited": false, "score": 0, "creation_date": 1502876286, "post_id": 45709781, "comment_id": 78378085, "body": "@Abhishek You need to mention this in your post, we don&#39;t have psychic  ability to read people mind."}, {"owner": {"reputation": 41796, "user_id": 1870232, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rbI29.jpg?s=128&g=1", "display_name": "P0W", "link": "https://stackoverflow.com/users/1870232/p0w"}, "reply_to_user": {"reputation": 113, "user_id": 4833530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7bb38fc13b3c8c72e240b14ec30c1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/4833530/abhishek"}, "edited": false, "score": 0, "creation_date": 1502877006, "post_id": 45709781, "comment_id": 78378602, "body": "@Abhishek Updated my post."}], "tags": [], "owner": {"reputation": 41796, "user_id": 1870232, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rbI29.jpg?s=128&g=1", "display_name": "P0W", "link": "https://stackoverflow.com/users/1870232/p0w"}, "is_accepted": false, "score": 1, "last_activity_date": 1502876986, "last_edit_date": 1502876986, "creation_date": 1502875448, "answer_id": 45709781, "question_id": 45709054, "link": "https://stackoverflow.com/questions/45709054/create-json-object-using-cjson-h/45709781#45709781", "title": "create json object using cJSON.h", "body": "<p>If the json string is fixed you could simply use <code>cJSON_Parse</code> function, to do that you need to have the <code>char*</code> to it  :</p>\n\n<pre><code>   const char* const json_string = \n\"{ \\\n  \\\"cars\\\": [\\\n    {\\\n      \\\"CarType\\\": \\\"BMW\\\",\\\n      \\\"carID\\\": \\\"bmw123\\\"\\\n    },\\\n    {\\\n      \\\"CarType\\\": \\\"mercedes\\\",\\\n      \\\"carID\\\": \\\"merc123\\\"\\\n    },\\\n    {\\\n      \\\"CarType\\\": \\\"volvo\\\",\\\n      \\\"carID\\\": \\\"vol123r\\\"\\\n    },\\\n    {\\\n      \\\"CarType\\\": \\\"ford\\\",\\\n      \\\"carID\\\": \\\"ford123\\\"\\\n    }\\\n  ]\\\n}\\\n\";\n\n   cJSON * root = cJSON_Parse(json_string);  /* Play with root */\n\n   //char *rendered = cJSON_Print(root);\n</code></pre>\n\n<p>Updated as per request , <strong>when input array is not fixed</strong>:</p>\n\n<pre><code>   const char* const carType[] ={\"BMW\", \"Mercides\", \"Audi\", \"Farari\"}; \n   const char* const carID[]  ={\"bmw11\", \"m22\", \"a33\", \"f44\"} ;\n\n   size_t max_size = 4;\n   cJSON *root,*car;\n\n   root  = cJSON_CreateObject();\n   car=  cJSON_CreateArray();\n\n   for( size_t i = 0; i &lt; max_size; ++i )\n   {\n      cJSON* item  = cJSON_CreateObject(); \n      cJSON_AddItemToObject(item, \"CarType\", cJSON_CreateString( carType[i] ));\n      cJSON_AddItemToObject(item, \"carID\", cJSON_CreateString(carID[i]));\n\n      cJSON_AddItemToArray(car, item);\n   }\n\n\n   cJSON_AddItemToObject( root, \"cars\", car );\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 4833530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7bb38fc13b3c8c72e240b14ec30c1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/4833530/abhishek"}, "edited": false, "score": 0, "creation_date": 1502877141, "post_id": 45710205, "comment_id": 78378705, "body": "Thanks for your time &amp; effort."}, {"owner": {"reputation": 1357, "user_id": 773102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/St5U2.gif?s=128&g=1", "display_name": "Jonny Schubert", "link": "https://stackoverflow.com/users/773102/jonny-schubert"}, "edited": false, "score": 1, "creation_date": 1527240266, "post_id": 45710205, "comment_id": 88063351, "body": "Never forget to free dynamic memory at the end by calling cJSON_Delete(root) and to free the string allocated by cJSON."}, {"owner": {"reputation": 7529, "user_id": 47733, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8d29a2ec53709fb1a607e6203a6210fa?s=128&d=identicon&r=PG", "display_name": "lsalamon", "link": "https://stackoverflow.com/users/47733/lsalamon"}, "edited": false, "score": 1, "creation_date": 1567713990, "post_id": 45710205, "comment_id": 102056001, "body": "Calling free (out) is required or memory leak will occur."}], "tags": [], "owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "is_accepted": true, "score": 14, "last_activity_date": 1567755008, "last_edit_date": 1567755008, "creation_date": 1502876664, "answer_id": 45710205, "question_id": 45709054, "link": "https://stackoverflow.com/questions/45709054/create-json-object-using-cjson-h/45710205#45710205", "title": "create json object using cJSON.h", "body": "<p>The following code will show you how to use the cJSON functions like <code>cJSON_CreateObject()</code>, <code>cJSON_CreateArray()</code>, <code>cJSON_AddItemToObject()</code> and <code>cJSON_AddItemToArray()</code>.</p>\n\n<p>You have to add the <code>cars</code> array to the <code>root</code> object. After that you have to create each <code>car</code> as object containing items which are the <code>CarType</code> and <code>carID</code>. Each <code>car</code> object has to be added to the <code>cars</code> array.</p>\n\n<p>It it also very well documentated with examples <a href=\"https://github.com/DaveGamble/cJSON\" rel=\"noreferrer\">here at GitHub</a>.</p>\n\n<p><strong>Edit #1:</strong></p>\n\n<p>As @JonnySchubert pointed out, it's necessary to free allocated ressources. But it's enough to free the root node in this case, because adding an item to an array or object transfers it's ownership. In other words: freeing the root node will cause freeing all nodes under root also. From the GitHub ressource I linked above:</p>\n\n<blockquote>\n  <p>For every value type there is a <code>cJSON_Create...</code> function that can be used to create an item of that type. All of these will allocate a <code>cJSON</code> struct that can later be deleted with <code>cJSON_Delete</code>. Note that you have to delete them at some point, otherwise you will get a memory leak. <strong>Important:</strong> If you have added an item to an array or an object already, you <strong>mustn't</strong> delete it with <code>cJSON_Delete</code>. Adding it to an array or object transfers its ownership so that when that array or object is deleted, it gets deleted as well.</p>\n</blockquote>\n\n<p><strong>Edit #2:</strong></p>\n\n<p>@lsalamon mentioned that you have to free the return value of cJSON_Print, see <a href=\"https://stackoverflow.com/a/27394515/8051589\">here on SO for example</a> and <a href=\"https://github.com/DaveGamble/cJSON#printing\" rel=\"noreferrer\">the documentation</a>.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"cJSON.h\"\n\nint main()\n{\n   char *out;\n   cJSON *root, *cars, *car;\n\n   /* create root node and array */\n   root = cJSON_CreateObject();\n   cars = cJSON_CreateArray();\n\n   /* add cars array to root */\n   cJSON_AddItemToObject(root, \"cars\", cars);\n\n   /* add 1st car to cars array */\n   cJSON_AddItemToArray(cars, car = cJSON_CreateObject());\n   cJSON_AddItemToObject(car, \"CarType\", cJSON_CreateString(\"BMW\"));\n   cJSON_AddItemToObject(car, \"carID\", cJSON_CreateString(\"bmw123\"));\n\n   /* add 2nd car to cars array */\n   cJSON_AddItemToArray(cars, car = cJSON_CreateObject());\n   cJSON_AddItemToObject(car, \"CarType\", cJSON_CreateString(\"mercedes\"));\n   cJSON_AddItemToObject(car, \"carID\", cJSON_CreateString(\"mercedes123\"));\n\n   /* print everything */\n   out = cJSON_Print(root);\n   printf(\"%s\\n\", out);\n   free(out);\n\n   /* free all objects under root and root itself */\n   cJSON_Delete(root)\n\n   return 0;\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>{\n    \"cars\": [{\n            \"CarType\":  \"BMW\",\n            \"carID\":    \"bmw123\"\n        }, {\n            \"CarType\":  \"mercedes\",\n            \"carID\":    \"mercedes123\"\n        }]\n}\n</code></pre>\n\n<p>This code just add 2 cars to show the usage. In your real application you should do that with C arrays and a <code>for</code> loop.</p>\n"}, {"comments": [{"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1502877210, "post_id": 45710360, "comment_id": 78378745, "body": "Yes would work but names are wrong in usage here as you using <code>root</code> <b>not</b> as root object. Further you have just an array <code>car</code> without a root object."}], "tags": [], "owner": {"reputation": 113, "user_id": 4833530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7bb38fc13b3c8c72e240b14ec30c1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/4833530/abhishek"}, "is_accepted": false, "score": 0, "last_activity_date": 1502877104, "creation_date": 1502877104, "answer_id": 45710360, "question_id": 45709054, "link": "https://stackoverflow.com/questions/45709054/create-json-object-using-cjson-h/45710360#45710360", "title": "create json object using cJSON.h", "body": "<p>Another solution i got -</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"cJSON.h\"\n\nint main (void){\n    char field_name[32], value[32], *out;\n    cJSON *root,*car;\n\n    root  = cJSON_CreateObject();\n    car=  cJSON_CreateArray();\n\n\n    cJSON_AddItemToObject(root, \"CarType\", cJSON_CreateString(\"BMW\"));\n    cJSON_AddItemToObject(root, \"carID\", cJSON_CreateString(\"bmws123\"));\n    cJSON_AddItemToArray(car, root);\n\n    root=NULL;\n    root  = cJSON_CreateObject();\n\n    cJSON_AddItemToObject(root, \"CarType\", cJSON_CreateString(\"Mercedies\"));\n    cJSON_AddItemToObject(root, \"carID\", cJSON_CreateString(\"mer123\"));\n    cJSON_AddItemToArray(car, root);\n\n\n\n    out = cJSON_Print(car);\n    printf(\"%s\\n\",out);\n\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 4833530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7bb38fc13b3c8c72e240b14ec30c1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/4833530/abhishek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12526, "favorite_count": 4, "accepted_answer_id": 45710205, "answer_count": 3, "score": 6, "last_activity_date": 1567755008, "creation_date": 1502873435, "last_edit_date": 1502877064, "question_id": 45709054, "link": "https://stackoverflow.com/questions/45709054/create-json-object-using-cjson-h", "title": "create json object using cJSON.h", "body": "<p>I am trying to create JSON object like below but I am not able to add the second item in it e.g:</p>\n\n<pre><code>\"CarType\": \"mercedes\",\n\"carID\": \"merc123\"\n</code></pre>\n\n<p>and also other items.</p>\n\n<p>I want to create JSON like this:</p>\n\n<pre><code>{\n  cars: [\n    {\n      \"CarType\": \"BMW\",\n      \"carID\": \"bmw123\"\n    },\n    {\n      \"CarType\": \"mercedes\",\n      \"carID\": \"merc123\"\n    },\n    {\n      \"CarType\": \"volvo\",\n      \"carID\": \"vol123r\"\n    },\n    {\n      \"CarType\": \"ford\",\n      \"carID\": \"ford123\"\n    }\n  ]\n};\n</code></pre>\n\n<p>I have tried so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"cJSON.h\"\n\nint main (void){\n    char field_name[32], value[32], *out;\n    cJSON *root,*car;\n\n    root  = cJSON_CreateObject();\n    car=  cJSON_CreateArray();\n\n    cJSON_AddItemToObject(root, \"CarType\", cJSON_CreateString(\"BMW\"));\n    cJSON_AddItemToObject(root, \"carID\", cJSON_CreateString(\"bmw123\"));\n    cJSON_AddItemToArray(car, root);\n\n    out = cJSON_Print(car);\n    printf(\"%s\\n\",out);\n\n    return 0;\n}\n</code></pre>\n\n<p>My Output is something like this (indentation is exactly as showed here):</p>\n\n<pre><code>[{\n        \"CarType\":  \"BMW\",\n        \"carID\":    \"bmw123\"\n    }]\n</code></pre>\n"}, {"tags": ["c", "multithreading", "winapi", "thread-local-storage"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1502875848, "post_id": 45708954, "comment_id": 78377770, "body": "if your DLL assign data to some thread - it must not be unloaded until it not free this data (on thread exit). so or your DLL must not be unloaded at all in this case. or you need  increment reference count to DLL when you assign data to thread. and decrement reference count to DLL when you release this data"}], "answers": [{"comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1502875583, "post_id": 45709788, "comment_id": 78377575, "body": "but question was - if dll will be unloaded <i>before</i> some threads, for which tls data allocated, terminated"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1502876573, "post_id": 45709788, "comment_id": 78378287, "body": "yes, you right. this (keep track of the pointers) one of possible solution."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1502877863, "post_id": 45709788, "comment_id": 78379172, "body": "Fls really the best solution here and it show that root of problem with Tls is not well design it functional initially by windows"}, {"owner": {"reputation": 639, "user_id": 1671661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8db94e53e65d244d49d87e506907a6?s=128&d=identicon&r=PG", "display_name": "KonstantinL", "link": "https://stackoverflow.com/users/1671661/konstantinl"}, "edited": false, "score": 0, "creation_date": 1502898391, "post_id": 45709788, "comment_id": 78393980, "body": "&quot;If the thread is executing a fiber and the fiber is switched, the FLS is also switched.&quot; - typo in doc? It seems should be &quot;and the <i>thread</i> is switched&quot;."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1502908837, "post_id": 45709788, "comment_id": 78399859, "body": "No, the doc is correct. Did you even read the entire doc on what fibers actually are? A single thread can run multiple fibers and switch between them at will (that is the whole point of fibers - manual scheduling).  So, when a thread switches between fibers, the thread&#39;s FLS is switched accordingly, just as the doc says."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 6, "last_activity_date": 1502878888, "last_edit_date": 1502878888, "creation_date": 1502875466, "answer_id": 45709788, "question_id": 45708954, "link": "https://stackoverflow.com/questions/45708954/free-tls-pointers-for-every-thread/45709788#45709788", "title": "Free TLS pointers for every thread", "body": "<p>Per the documentation you linked to:</p>\n\n<blockquote>\n  <p>When a thread terminates, the entry-point function is called with the DLL_THREAD_DETACH value and the memory for that thread is freed.</p>\n</blockquote>\n\n<p>That is the ideal time when the memory pointed to by the TLS slot should be freed, if the thread did not already do so before terminating.  This is demonstrated in the example code provided:</p>\n\n<pre><code>case DLL_THREAD_DETACH:\n    // Release the allocated memory for this thread.\n    lpvData = TlsGetValue(dwTlsIndex);\n    if (lpvData != NULL)\n        LocalFree((HLOCAL) lpvData);\n    break;\n\ncase DLL_PROCESS_DETACH:\n    // Release the allocated memory for this thread.\n    lpvData = TlsGetValue(dwTlsIndex);\n    if (lpvData != NULL)\n        LocalFree((HLOCAL) lpvData);\n    // Release the TLS index.\n    TlsFree(dwTlsIndex);\n    break;\n</code></pre>\n\n<p>However, per the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682583.aspx\" rel=\"noreferrer\">DllMain entry point</a> documentation:</p>\n\n<blockquote>\n  <p>When a DLL is unloaded from a process as a result of an unsuccessful load of the DLL, termination of the process, <strong>or a call to\u00a0<code>FreeLibrary</code></strong>, the system does not call the DLL's entry-point function with the <code>DLL_THREAD_DETACH</code>\u00a0value for the individual threads of the process. The DLL is only sent a <code>DLL_PROCESS_DETACH</code>\u00a0notification. <strong>DLLs can take this opportunity to clean up all resources for all threads known to the DLL</strong>.</p>\n</blockquote>\n\n<p>So, you would have to keep track of the pointers you store in per-thread TLS slots in such a way that any pointers not already freed by the <code>DLL_THREAD_DETACH</code> handler can be later freed by the <code>DLL_PROCESS_DETACH</code> handler.  For instance, by storing the pointers in a global thread-safe list.</p>\n\n<hr>\n\n<p><strong>Update</strong>: an alternative solution would be to have the <code>DLL_PROCESS_DETACH</code> handler enumerate running threads, accessing the TIB/TEB (Thread Information/Environment Block) struct for each thread. <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms684283.aspx\" rel=\"noreferrer\"><code>NtQueryInformationThread()</code></a> can be used to <a href=\"https://stackoverflow.com/questions/18301032/\">retrieve a pointer to a thread's TIB/TEB</a>. Amongst other things, <a href=\"https://www.microsoft.com/msj/archive/S2CE.aspx\" rel=\"noreferrer\">the TIB/TEB also contains a pointer to the thread's TLS array</a>.</p>\n\n<hr>\n\n<p><strong>Update</strong>: On Vista+, an alternative solution is to use FLS (fiber local storage) instead of TLS (thread local storage). The <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682664.aspx\" rel=\"noreferrer\"><code>FlsAlloc()</code></a> function takes an optional callback. The <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682665.aspx\" rel=\"noreferrer\"><code>FlsCallback</code></a> documentation states:</p>\n\n<blockquote>\n  <p>An application-defined function. If the FLS slot is in use,\u00a0FlsCallback\u00a0is called on fiber deletion, thread exit, and <strong>when an FLS index is freed</strong>.</p>\n</blockquote>\n\n<p>And the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682667.aspx\" rel=\"noreferrer\"><code>FlsFree()</code></a> documentation states:</p>\n\n<blockquote>\n  <p>Freeing an FLS index frees the index for all instances of FLS in the current process. <strong>Freeing an FLS index also causes the associated callback routine to be called for each fiber, if the corresponding FLS slot contains a non-NULL value</strong>.</p>\n</blockquote>\n\n<p>Per the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682661.aspx\" rel=\"noreferrer\">Fibers</a> documentation:</p>\n\n<blockquote>\n  <p>A fiber can use\u00a0fiber local storage\u00a0(FLS) to create a unique copy of a variable for each fiber. <strong>If no fiber switching occurs, FLS acts exactly the same as\u00a0thread local storage. The FLS functions (<code>FlsAlloc</code>, <code>FlsFree</code>,\u00a0<code>FlsGetValue</code>, and\u00a0<code>FlsSetValue</code>) manipulate the FLS associated with the current thread</strong>. If the thread is executing a fiber and the fiber is switched, the FLS is also switched.</p>\n</blockquote>\n"}], "owner": {"reputation": 1199, "user_id": 3825101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yJgje.png?s=128&g=1", "display_name": "macro_controller", "link": "https://stackoverflow.com/users/3825101/macro-controller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 2, "accepted_answer_id": 45709788, "answer_count": 1, "score": 6, "last_activity_date": 1502878888, "creation_date": 1502873115, "last_edit_date": 1502876596, "question_id": 45708954, "link": "https://stackoverflow.com/questions/45708954/free-tls-pointers-for-every-thread", "title": "Free TLS pointers for every thread", "body": "<p>Reading the following page in MSDN:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686997.aspx\" rel=\"nofollow noreferrer\">Using Thread Local Storage in a Dynamic-Link Library</a></p>\n\n<p>I can't understand who is responsible for freeing the memory pointed by the TLS slot of each thread in the case of a <code>FreeLibrary()</code> call.</p>\n\n<p>From what I understand, if I have several running threads, all of them allocated memory inside a TLS slot in a given index. When <code>FreeLibrary()</code> is called, only <code>DLL_PROCESS_DETACH</code> is triggered, so only the thread which receives the <code>DLL_PROCESS_DETACH</code> notification has a chance to call <code>LocalFree()</code> on its own data stored in the TLS slot, before calling <code>TlsFree()</code> on the index. This causes a memory leak in all of the other threads that don't have a chance to call <code>LocalFree()</code> on their data, as they don't receive a <code>DLL_THREAD_DETACH</code> notification. </p>\n\n<p>Can someone explain when and where  the buffers stored in TLS slots of each thread should be freed? </p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1502872314, "post_id": 45708594, "comment_id": 78375354, "body": "and what&#39;s the output of <code>ldd</code> for your program? If it&#39;s your own program, show code..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6617295"}, "edited": false, "score": 0, "creation_date": 1502872886, "post_id": 45708594, "comment_id": 78375738, "body": "for safe, I run the program, which is libcurl offical test progarm, too.But the result is the same as before"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6617295"}, "edited": false, "score": 0, "creation_date": 1502872938, "post_id": 45708594, "comment_id": 78375772, "body": "I think , libcurl is on /usr/local/lib ,so ,I want to add this path to ldconfig config"}, {"owner": {"reputation": 7087, "user_id": 1389898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00f2a3f2624a47edc48464d4929a7508?s=128&d=identicon&r=PG", "display_name": "dlmeetei", "link": "https://stackoverflow.com/users/1389898/dlmeetei"}, "edited": false, "score": 0, "creation_date": 1502875344, "post_id": 45708594, "comment_id": 78377411, "body": "Looks like <code>ln -S &#47;path&#47;to&#47;libcjson.1.5.7 &#47;path&#47;to&#47;libcjson.so</code> will fix it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6617295"}, "edited": false, "score": 0, "creation_date": 1502937224, "post_id": 45708594, "comment_id": 78408994, "body": "/path/to/libcjson.1.5.7 is the symbolic link of libcjson.so ,so we could not link them."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6617295"}, "is_accepted": true, "score": 0, "last_activity_date": 1594101196, "last_edit_date": 1594101196, "creation_date": 1502937316, "answer_id": 45725753, "question_id": 45708594, "link": "https://stackoverflow.com/questions/45708594/libcjson-so-cannot-open-shared-object-file-no-such-file-or-directory/45725753#45725753", "title": "libcjson.so: cannot open shared object file: No such file or directory", "body": "<p>At last , I found that <em><strong>ldconfig</strong></em> default path is <code>/usr/lib</code>, but my dynamic library is in <code>/usr/local/lib</code>. So I add this path to ldconfig's config.</p>\n<p>When we copy the library, we should get that some library just symbolic link. After copy to somewhere, it can not work normally.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6617295"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1784, "favorite_count": 1, "accepted_answer_id": 45725753, "answer_count": 1, "score": 1, "last_activity_date": 1594101196, "creation_date": 1502871895, "last_edit_date": 1502875384, "question_id": 45708594, "link": "https://stackoverflow.com/questions/45708594/libcjson-so-cannot-open-shared-object-file-no-such-file-or-directory", "title": "libcjson.so: cannot open shared object file: No such file or directory", "body": "<p>My OS is Centos 7 </p>\n\n<p>when I run <code>ldconfig -p</code> , I can see that \"libcjson.so.1.5.7 (libc6,x86-64) => /lib/libcjson.so.1.5.7\"</p>\n\n<p>then I run my program, it print that </p>\n\n<pre><code>\"libcjson.so: cannot open shared object file: No such file or directory\"\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 7, "creation_date": 1502869750, "post_id": 45707881, "comment_id": 78373742, "body": "You did not check if <code>fp</code> is <code>NULL</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502870986, "post_id": 45707881, "comment_id": 78374515, "body": "@alinsoar: found a better one, a duplicate should have the problem of not checking a pointer returned by a library call..."}], "answers": [{"comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 3, "creation_date": 1502869892, "post_id": 45707948, "comment_id": 78373826, "body": "<a href=\"http://skull.piratehaven.org/~bapper/298c/ten-commandments.html\" rel=\"nofollow noreferrer\">The Ten Commandments for C Programmers</a>, items 2 and 6. ;-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1502869924, "post_id": 45707948, "comment_id": 78373844, "body": "haha, nice document :)"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1502870045, "post_id": 45707948, "comment_id": 78373918, "body": "It&#39;s positively ancient (I&#39;ve seen this in the 80&#39;s...), but most items are still surprisingly topical. ;-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1502870331, "post_id": 45707948, "comment_id": 78374095, "body": "@DevSolar well, I don&#39;t necessarily agree with item 3 there. Often good, but imagine you&#39;re dealing with pointer types: either the cast is unnecessary (and all is fine) or you&#39;re accessing an object through a wrong type (UB) and a cast would just silence the compiler about it..."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1502870606, "post_id": 45707948, "comment_id": 78374266, "body": "Items 4 and 9 are artifacts of a bygone era as well, but an interesting glimpse of the past. The rest is pure gold to this day. ;-)"}, {"owner": {"reputation": 1, "user_id": 8471128, "user_type": "registered", "profile_image": "https://graph.facebook.com/1594619743929678/picture?type=large", "display_name": "DuKangaroo", "link": "https://stackoverflow.com/users/8471128/dukangaroo"}, "edited": false, "score": 0, "creation_date": 1502870969, "post_id": 45707948, "comment_id": 78374506, "body": "So does that mean that the file I&#39;m trying to open doesn&#39;t exist?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 1, "user_id": 8471128, "user_type": "registered", "profile_image": "https://graph.facebook.com/1594619743929678/picture?type=large", "display_name": "DuKangaroo", "link": "https://stackoverflow.com/users/8471128/dukangaroo"}, "edited": false, "score": 0, "creation_date": 1502871027, "post_id": 45707948, "comment_id": 78374541, "body": "@DuKangaroo no, it means opening it fails. The file not existing is <b>one</b> possible reason, others include wrong permissions etc."}, {"owner": {"reputation": 1, "user_id": 8471128, "user_type": "registered", "profile_image": "https://graph.facebook.com/1594619743929678/picture?type=large", "display_name": "DuKangaroo", "link": "https://stackoverflow.com/users/8471128/dukangaroo"}, "edited": false, "score": 0, "creation_date": 1502871710, "post_id": 45707948, "comment_id": 78374972, "body": "Thank you so much!! I&#39;ve managed to get that part working now."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 4, "last_activity_date": 1502869790, "creation_date": 1502869790, "answer_id": 45707948, "question_id": 45707881, "link": "https://stackoverflow.com/questions/45707881/invalid-read-of-size-4-while-using-fgets-from-a-file/45707948#45707948", "title": "Invalid read of size 4 while using fgets from a file", "body": "<p>This line</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>==4545==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\n</code></pre>\n\n<p>tells you you're dereferencing a <code>NULL</code> pointer (Address <code>0x0</code> ...)!</p>\n\n<p>With the code you show, this can only mean <code>fopen</code> failed and returned <code>0</code>/<code>NULL</code>. Always check the return values of your function calls.</p>\n"}], "owner": {"reputation": 1, "user_id": 8471128, "user_type": "registered", "profile_image": "https://graph.facebook.com/1594619743929678/picture?type=large", "display_name": "DuKangaroo", "link": "https://stackoverflow.com/users/8471128/dukangaroo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1086, "favorite_count": 0, "closed_date": 1502870938, "answer_count": 1, "score": 0, "last_activity_date": 1502870950, "creation_date": 1502869603, "last_edit_date": 1502869943, "question_id": 45707881, "link": "https://stackoverflow.com/questions/45707881/invalid-read-of-size-4-while-using-fgets-from-a-file", "closed_reason": "Duplicate", "title": "Invalid read of size 4 while using fgets from a file", "body": "<p>I'm having trouble figuring out why my code is having a seg fault while reading code from a file in c. I've attached the code and valgrind output below. Thanks for any help!</p>\n\n<pre><code>FILE *fp;\nfp = fopen(\"filename\", \"r\");\nchar line[100];\nwhile (fgets(line, 100, fp) != NULL) {\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code>==4545== Invalid read of size 4\n==4545==    at 0x4E9E34B: fgets (iofgets.c:50)\n==4545==    by 0x401289: main (game.c:180)\n==4545==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\n==4545==\n==4545==\n==4545== Process terminating with default action of signal 11 (SIGSEGV)\n==4545==  Access not within mapped region at address 0x0\n==4545==    at 0x4E9E34B: fgets (iofgets.c:50)\n==4545==    by 0x401289: main (game.c:180)\n</code></pre>\n"}, {"tags": ["c", "cuda", "cublas"], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 3070401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b076280ff87c6c5de2230694163462cf?s=128&d=identicon&r=PG&f=1", "display_name": "pentschev", "link": "https://stackoverflow.com/users/3070401/pentschev"}, "is_accepted": true, "score": 3, "last_activity_date": 1502873967, "creation_date": 1502873967, "answer_id": 45709248, "question_id": 45707766, "link": "https://stackoverflow.com/questions/45707766/cublasdgemm-weird-results/45709248#45709248", "title": "cublasDGemm weird results", "body": "<p>First issue is you are filling your matrix A in row-major format. To fix that, simply swap i and j indices. In column-major format, the leading dimension should be the number of rows, in your case, N.</p>\n\n<pre><code>for (j = 0; j &lt; N; j++) { \n    for (i = 0; i &lt; M; i++) {\n        a[IDX2C(j,i,N)] = (double)(i * M + j + 1);\n        printf (\"%7.0f\", a[IDX2C(j,i,N)]);\n    }\n    printf (\"\\n\");\n}\n</code></pre>\n\n<p>You are also swapping dimensions in the cublasDgemm call, it should look like:</p>\n\n<pre><code>stat = cublasDgemm(handle, CUBLAS_OP_N, CUBLAS_OP_T, N, N, M, &amp;alpha, devPtrA, N, devPtrA, N, &amp;beta, devPtrC, N);\n</code></pre>\n\n<p>And at the end, you used M as the leading dimension of the C matrix, where it should have been N:</p>\n\n<pre><code>printf (\"%7.0f\", c[IDX2C(i,j,N)]);\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 3119551, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a730139a769fed5f21deb84183f11b34?s=128&d=identicon&r=PG", "display_name": "loukwn", "link": "https://stackoverflow.com/users/3119551/loukwn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 45709248, "answer_count": 1, "score": 0, "last_activity_date": 1502873967, "creation_date": 1502869261, "last_edit_date": 1502870265, "question_id": 45707766, "link": "https://stackoverflow.com/questions/45707766/cublasdgemm-weird-results", "title": "cublasDGemm weird results", "body": "<p>I am trying to use cublasDgemm() to calculate the product of a matrix by its transpose. The input matrix and the output i am expecting from my code are the following (A and C respectively):</p>\n\n<pre><code>    | 1 4 7 |        | 66 78 |\nA = | 2 5 8 |    C = | 78 93 |\n</code></pre>\n\n<p>However I get weird results and it is a bit difficult to me to understand the dimensions that cublas/cuda uses (column-major). Any tip would be appreciated!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;cuda_runtime.h&gt;\n#include \"cublas_v2.h\"\n#define M 3\n#define N 2\n#define IDX2C(i,j,ld) (((j)*(ld))+(i))\n\nint main (void){\n    cudaError_t cudaStat;    \n    cublasStatus_t stat;\n    cublasHandle_t handle;\n    int i, j;\n    double *devPtrA, *devPtrC;\n    double *a = 0, *c = 0;\n\n    const double alpha = 1;\n    const double beta = 0;\n\n    // initialize host arrays\n    a = (double *)malloc (M * N * sizeof (*a));\n    c = (double *)malloc (N * N * sizeof (*c));\n    if (!a || !c) {\n        printf (\"host memory allocation failed\");\n        return EXIT_FAILURE;\n    }\n\n    // fill input array\n    for (j = 0; j &lt; N; j++) {\n        for (i = 0; i &lt; M; i++) {\n            a[IDX2C(i,j,M)] = (double)(i * M + j + 1);\n            printf (\"%7.0f\", a[IDX2C(i,j,M)]);\n        }\n        printf (\"\\n\");\n    }\n\n    // set device to 0 (for double processing)\n    cudaStat = cudaSetDevice(0);\n    if (cudaStat != cudaSuccess) {\n        printf(\"could not set device 0\");\n        return EXIT_FAILURE;\n    }\n\n    // allocate device arrays\n    cudaStat = cudaMalloc ((void**)&amp;devPtrA, M*N*sizeof(*a));\n    if (cudaStat != cudaSuccess) {\n        printf (\"device memory allocation of A failed\");\n        return EXIT_FAILURE;\n    }\n    cudaStat = cudaMalloc ((void**)&amp;devPtrC, N*N*sizeof(*c));\n    if (cudaStat != cudaSuccess) {\n        printf (\"device memory allocation of C failed\");\n        return EXIT_FAILURE;\n    }\n\n    // create the cublas handle\n    stat = cublasCreate(&amp;handle);\n    if (stat != CUBLAS_STATUS_SUCCESS) {\n        printf (\"CUBLAS initialization failed\\n\");\n        return EXIT_FAILURE;\n    }\n\n    // set the matrix a\n    stat = cublasSetMatrix (M, N, sizeof(*a), a, M, devPtrA, M);\n    if (stat != CUBLAS_STATUS_SUCCESS) {\n        printf (\"data download failed\");\n        cudaFree (devPtrA);\n        cudaFree (devPtrC);\n        cublasDestroy(handle);\n        return EXIT_FAILURE;\n    }\n\n    stat = cublasDgemm(handle, CUBLAS_OP_N, CUBLAS_OP_T, M, M, N, &amp;alpha, devPtrA, M, devPtrA, M, &amp;beta, devPtrC, M);\n    if (stat!= CUBLAS_STATUS_SUCCESS) {\n        switch (stat) {\n            case CUBLAS_STATUS_NOT_INITIALIZED:\n                printf(\"CUBLAS_STATUS_NOT_INITIALIZED\\n\");\n                break;\n            case CUBLAS_STATUS_INVALID_VALUE:\n                printf(\"CUBLAS_STATUS_INVALID_VALUE\\n\");\n                break;\n            case CUBLAS_STATUS_ARCH_MISMATCH:\n                printf(\"CUBLAS_STATUS_ARCH_MISMATCH\\n\");\n                break;\n            case CUBLAS_STATUS_EXECUTION_FAILED:\n                printf(\"CUBLAS_STATUS_EXECUTION_FAILED\\n\");\n                break;\n            default:\n                printf(\"??\\n\");\n        } \n\n        printf(\"Error: %d\\n\", (int)stat);\n        cudaFree (devPtrA);\n        cudaFree (devPtrC);\n        cublasDestroy(handle);\n        return EXIT_FAILURE;\n    }\n\n    // get matrix c\n    stat = cublasGetMatrix (N, N, sizeof(*c), devPtrC, N, c, N);\n    if (stat != CUBLAS_STATUS_SUCCESS) {\n        printf (\"data upload failed\");\n        cudaFree (devPtrC);\n        cublasDestroy(handle);\n        return EXIT_FAILURE;\n    }\n\n    // cleanup cuda/cublas\n    cudaFree (devPtrA);\n    cudaFree (devPtrC);\n    cublasDestroy(handle);\n\n    // print result\n    for (j = 0; j &lt; N; j++) {\n        for (i = 0; i &lt; N; i++) {\n            printf (\"%7.0f\", c[IDX2C(i,j,M)]);\n        }\n        printf (\"\\n\");\n    }\n\n    // clear host data\n    free(a);\n    free(c);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "performance", "switch-statement", "lookup-tables"], "comments": [{"owner": {"reputation": 6633, "user_id": 2378300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/852aed09b52c7514ed23f75f2921f6cc?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/2378300/jonas"}, "edited": false, "score": 8, "creation_date": 1502869210, "post_id": 45707685, "comment_id": 78373386, "body": "Your timings include the call to <code>printf</code>, which could lead to inaccurate results."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 4, "creation_date": 1502869463, "post_id": 45707685, "comment_id": 78373569, "body": "You should have a look at the generated assembly code."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 5, "creation_date": 1502869483, "post_id": 45707685, "comment_id": 78373581, "body": "and if you have optimization turned on, both <code>switch</code> and <code>if</code> will be optimized away with a good optimizing compiler."}, {"owner": {"reputation": 6633, "user_id": 2378300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/852aed09b52c7514ed23f75f2921f6cc?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/2378300/jonas"}, "edited": false, "score": 6, "creation_date": 1502869565, "post_id": 45707685, "comment_id": 78373632, "body": "Note that if you compile both of the with <code>-O3</code> they are identical, the compiler identifies <code>n=3</code> and removes everything related to the other cases (including the <code>if</code> and <code>switch</code>)."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1502869943, "post_id": 45707685, "comment_id": 78373856, "body": "I recommend not trying to out-optimise modern compilers in general. In a very specific usecase (which better does not contain <code>printf()</code> or working on a single case) measure and take the faster one, without trying to reason why. That however will not be portable or survive even the tiniest change of circumstances."}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1502870608, "post_id": 45707685, "comment_id": 78374269, "body": "I just made an edit to the code to add it back. Otherwise it will not even compile."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1502870842, "post_id": 45707685, "comment_id": 78374431, "body": "@Yunnosch the deleted code was redundant and the C tag is correct, because this is a valid C and C++ program."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1502870959, "post_id": 45707685, "comment_id": 78374500, "body": "Use the <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">godbolt.org</a> compiler explorer which shows you instantly the generated assembly code. You can chose different compilers and you can specify all compilation flags. Also change <code>n = 3</code> to <code>n = rand()</code> so the optimizer won&#39;t optimize most of the code away."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 6633, "user_id": 2378300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/852aed09b52c7514ed23f75f2921f6cc?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/2378300/jonas"}, "edited": false, "score": 0, "creation_date": 1502871767, "post_id": 45707685, "comment_id": 78375002, "body": "@Jonas no, if n== 4 then the <code>default</code> case is used where we have just a <code>break</code>, but this is the <code>break</code> for the <code>switch</code> statement, not for the <code>for</code> loop."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1502872374, "post_id": 45707685, "comment_id": 78375398, "body": "The difference is less than 1.5%. Unless it&#39;s very consistent, you can&#39;t draw any conclusions from it."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1502872773, "post_id": 45707685, "comment_id": 78375665, "body": "Voting to close this as &quot;cannot be reproduced&quot; since the incorrect benchmarking is the culprit."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1502875168, "post_id": 45707685, "comment_id": 78377264, "body": "This is a meaningless question on oh so many levels. C++ doesn&#39;t have any performance figures of its own, it&#39;s a specification. Specific code compiled with a speciific version of gcc  has performance figures, different from tnat of other code, or of code compiled with a different version of gcc, or on a different machine. There is no single answer like &quot;lookup is faster&quot; or &quot;switch is faster&quot; which is valid beyond your specific example."}], "answers": [{"comments": [{"owner": {"reputation": 570, "user_id": 3831520, "user_type": "registered", "accept_rate": 11, "profile_image": "https://i.stack.imgur.com/DuZxI.jpg?s=128&g=1", "display_name": "TuanPM", "link": "https://stackoverflow.com/users/3831520/tuanpm"}, "edited": false, "score": 0, "creation_date": 1502870607, "post_id": 45708022, "comment_id": 78374267, "body": "I used gcc version 4.8.4 with default option. I will try with no optimization compiler."}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "reply_to_user": {"reputation": 570, "user_id": 3831520, "user_type": "registered", "accept_rate": 11, "profile_image": "https://i.stack.imgur.com/DuZxI.jpg?s=128&g=1", "display_name": "TuanPM", "link": "https://stackoverflow.com/users/3831520/tuanpm"}, "edited": false, "score": 8, "creation_date": 1502870754, "post_id": 45708022, "comment_id": 78374370, "body": "@tuanpm No! As I said, timing unoptimized code is meaningless! It will tell you nothing at all."}], "tags": [], "owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "is_accepted": false, "score": 9, "last_activity_date": 1502870016, "creation_date": 1502870016, "answer_id": 45708022, "question_id": 45707685, "link": "https://stackoverflow.com/questions/45707685/c-performance-of-switch-statement-vs-lookup-tables/45708022#45708022", "title": "C++: Performance of Switch Statement vs Lookup tables", "body": "<p>If you are compiling with optimizations, your code has no switch and no lookup table. I's just a for loop which calls <code>printf()</code> many times with the same fixed string. Any minimally reasonable compiler will in fact detect that <code>n = 3</code> is never changed and optimize it out. Maybe you can add a <code>n = rand() % 4;</code> just inside the loop.</p>\n\n<p>On the other end if you are not compiling with optimizations, taking timings is meaningless.</p>\n\n<p>Coming to your question, I expect the lookup table to be faster than the switch statement, since the switch statement will totally thrash the Branch Prediction, while the if will be no problem, being always true.</p>\n"}, {"tags": [], "owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1502874830, "creation_date": 1502874830, "answer_id": 45709561, "question_id": 45707685, "link": "https://stackoverflow.com/questions/45707685/c-performance-of-switch-statement-vs-lookup-tables/45709561#45709561", "title": "C++: Performance of Switch Statement vs Lookup tables", "body": "<p>Your benchmark is entirely inadequate to measure <code>switch</code>/lookup-table performance: Virtually all time is spend within the <code>printf()</code> calls. If there is any effect from the <code>switch</code>/lookup-table difference, it is dwarfed by the measurement-noise due to the large total runtime.</p>\n\n<hr>\n\n<p>For reference: I expect a table lookup in a hot, tight loop to be only about ten clock-cycles. On a 2 GHz CPU, that's just 0.05 seconds for all 10000000 iterations (rough estimate, can easily be wrong by a factor of two, but that doesn't affect the overall assessment). That's on the order on 1% of your total runtime!</p>\n"}], "owner": {"reputation": 570, "user_id": 3831520, "user_type": "registered", "accept_rate": 11, "profile_image": "https://i.stack.imgur.com/DuZxI.jpg?s=128&g=1", "display_name": "TuanPM", "link": "https://stackoverflow.com/users/3831520/tuanpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1987, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1502874830, "creation_date": 1502869060, "last_edit_date": 1502873454, "question_id": 45707685, "link": "https://stackoverflow.com/questions/45707685/c-performance-of-switch-statement-vs-lookup-tables", "title": "C++: Performance of Switch Statement vs Lookup tables", "body": "<p>I tried to compare the performance of <code>switch</code> statement and lookup tables as below.</p>\n\n<p>This is the code using <code>switch</code> statement</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int n = 3;\n\n    for (long i = 0; i &lt; 10000000; ++i) {  \n        switch (n) {\n        case 0:\n            printf(\"Alpha\");\n            break;\n        case 1:\n            printf(\"Beta\");\n            break;\n        case 2:\n            printf(\"Gamma\");\n            break;\n        case 3:\n            printf(\"Delta\");\n            break;\n        default:\n            break;\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>And here is the code using lookup tables:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstatic char const * const Greek[4] = {\n  \"Alpha\",\n  \"Beta\",\n  \"Gamma\",\n  \"Delta\"\n};\n\nint main()\n{\n    int n = 3;\n\n    for (long i = 0; i &lt; 10000000; ++i) {  \n        if (n &gt;= 0 &amp;&amp; n &lt; 4) {\n            printf(Greek[n]);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I run two program on ubuntu 14.04, gcc version 4.8.4, using perf version 4.4.13 to analyze performance. And result:</p>\n\n<ul>\n<li>Switch Statement: 6.764077822 seconds</li>\n<li>Lookup tables: 6.665140483 seconds</li>\n</ul>\n\n<p>I don't know why Switch Statement run slower than Lookup tables. As I known, Switch Statement using jump table, i think it should run faster than Lookup tables in my program (it has additional if statement).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 5, "creation_date": 1502867962, "post_id": 45707342, "comment_id": 78372647, "body": "hah, no <code>==</code> for strings, please. use <code>strcmp()</code>."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 3, "creation_date": 1502868092, "post_id": 45707342, "comment_id": 78372719, "body": "<code>if (strcmp(myNumber, &quot;Name&quot;) == 0)</code>"}, {"owner": {"reputation": 53, "user_id": 8415804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e3ea80375c5a66b8a8e25b9b034b42e?s=128&d=identicon&r=PG&f=1", "display_name": "MrsIl", "link": "https://stackoverflow.com/users/8415804/mrsil"}, "edited": false, "score": 0, "creation_date": 1502868100, "post_id": 45707342, "comment_id": 78372725, "body": ":o did not though of it Thks"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1502870937, "post_id": 45707342, "comment_id": 78374483, "body": "Also always check return value of any <code>*scanf</code> functions, as a habit. It can save a lot of grief and grey hair."}, {"owner": {"reputation": 53, "user_id": 8415804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e3ea80375c5a66b8a8e25b9b034b42e?s=128&d=identicon&r=PG&f=1", "display_name": "MrsIl", "link": "https://stackoverflow.com/users/8415804/mrsil"}, "edited": false, "score": 0, "creation_date": 1502874729, "post_id": 45707342, "comment_id": 78376953, "body": "How to check <code>*scanf</code> return value  and what if i Want to do <code>switch(myType)</code> knowing that switch can take only interger walues ?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1502884021, "post_id": 45707342, "comment_id": 78383277, "body": "<code>&quot;%[^_]%*c%[^_]%s&quot;</code> requires three arguments for input. Argument is insufficient. This will probably cause segment faults."}], "owner": {"reputation": 53, "user_id": 8415804, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e3ea80375c5a66b8a8e25b9b034b42e?s=128&d=identicon&r=PG&f=1", "display_name": "MrsIl", "link": "https://stackoverflow.com/users/8415804/mrsil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "closed_date": 1502868046, "answer_count": 0, "score": 0, "last_activity_date": 1502868584, "creation_date": 1502867939, "last_edit_date": 1502868584, "question_id": 45707342, "link": "https://stackoverflow.com/questions/45707342/c-compare-two-strings-one-of-them-is-from-sscanf", "closed_reason": "Duplicate", "title": "C: compare two strings one of them is from sscanf", "body": "<p>I want to compare two strings i use a code similar to the following one but its not working </p>\n\n<pre class=\"lang-C prettyprint-override\"><code>int main (void){\n  char function[100]=\"my_Name\";\n  char myType[50]={0};\n  char myNumber[50]={0};\n  sscanf(function, \"%[^_]%*c%[^_]%s\",myType,myNumber);\n  if (myNumber==\"Name\")\n  {\n    //do stuff\n  }\n  return 0;\n}\n</code></pre>\n\n<p>my <code>if</code>condition is not verified, How can I solve my problem?</p>\n"}, {"tags": ["c", "string", "file"], "comments": [{"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1502867601, "post_id": 45707204, "comment_id": 78372403, "body": "<code>strcat(data,timeStamp)</code> -&gt; UB detected."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1502867605, "post_id": 45707204, "comment_id": 78372405, "body": "In C all string literals are <i>read-only</i> arrays with only enough size to fit the string and the string terminator. So you are both attempting to write to read-only data, and write out of bounds."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1502867792, "post_id": 45707204, "comment_id": 78372517, "body": "Find a tutorial on C strings. They are just null terminated char arrays, and like any other array you must never read or write past the end of array..."}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1502867906, "post_id": 45707204, "comment_id": 78372607, "body": "Minor: <code>fclose(fptr);</code> might not get executed if <code>fptr</code> is <code>NULL</code>."}, {"owner": {"reputation": 755, "user_id": 7509514, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NU1Dh.jpg?s=128&g=1", "display_name": "Deepak Pookkote", "link": "https://stackoverflow.com/users/7509514/deepak-pookkote"}, "edited": false, "score": 0, "creation_date": 1502868346, "post_id": 45707204, "comment_id": 78372866, "body": "@ Sourav Ghosh : how come its duplicate mahn?? just check my code ..? wt else we can do to figure out our errors other than this..this is too much"}], "answers": [{"comments": [{"owner": {"reputation": 755, "user_id": 7509514, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NU1Dh.jpg?s=128&g=1", "display_name": "Deepak Pookkote", "link": "https://stackoverflow.com/users/7509514/deepak-pookkote"}, "edited": false, "score": 2, "creation_date": 1502868928, "post_id": 45707230, "comment_id": 78373225, "body": "this one is working for me.                                                                      char data[500]=&quot;867330029590851,144311,140817,130294,0801536,15,0&zwnj;&#8203;0,-1380021593,,N,,,,&zwnj;&#8203;,180717034311,,,,,4.&zwnj;&#8203;18,,,,,,,,NA&quot;;     char timeStamp[500]=&quot;14-08-17,14-45-38,&quot;;      char currentTimeStamp[500];       strcat(timeStamp,data);                                        printf(&quot;%s\\n&quot;,timeStamp);"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 755, "user_id": 7509514, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NU1Dh.jpg?s=128&g=1", "display_name": "Deepak Pookkote", "link": "https://stackoverflow.com/users/7509514/deepak-pookkote"}, "edited": false, "score": 0, "creation_date": 1502869725, "post_id": 45707230, "comment_id": 78373726, "body": "@DeepakVijay; Yes, that will work because  <code>timeStamp</code> is now an array of chars and it has enough space to hold <code>data</code> string."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7893901"}, "reply_to_user": {"reputation": 755, "user_id": 7509514, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NU1Dh.jpg?s=128&g=1", "display_name": "Deepak Pookkote", "link": "https://stackoverflow.com/users/7509514/deepak-pookkote"}, "edited": false, "score": 1, "creation_date": 1502946133, "post_id": 45707230, "comment_id": 78411168, "body": "@DeepakVijay : yes it will work and you don&#39;t have  to store it in an another variable you can simple use like this..                                               strcat(timeStamp,data); printf(&quot;%s\\n&quot;,timeStamp);     //this will work for you ..."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 1, "last_activity_date": 1502867936, "last_edit_date": 1502867936, "creation_date": 1502867585, "answer_id": 45707230, "question_id": 45707204, "link": "https://stackoverflow.com/questions/45707204/how-to-fix-segmentation-fault-core-dumped-while-i-use-strcat-in-file-operation/45707230#45707230", "title": "how to fix Segmentation fault (core dumped) while i use strcat in file operations", "body": "<p><code>data</code> is a string literal and any attempt to modify it will invoke undefined behavior.  </p>\n\n<p>On the other hand, while using <code>strcat</code> there must be enough space in the destination array to hold the source string.  </p>\n\n<pre><code>char *data=\"867330029590851,144311,140817,130294,0801536,15,00,-1380021593,,N,,,,,180717034311,,,,,4.18,,,,,,,,NA\";\nchar *timeStamp=\"14-08-17,14:45:38\";\nchar *currentTimeStamp = malloc(strlen(data) + strlen(timeStamp) + 1);\nstrcat(currentTimeStamp, data);\nstrcat(currentTimeStamp, timeStamp);\n</code></pre>\n"}], "owner": {"reputation": 755, "user_id": 7509514, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NU1Dh.jpg?s=128&g=1", "display_name": "Deepak Pookkote", "link": "https://stackoverflow.com/users/7509514/deepak-pookkote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1502867675, "accepted_answer_id": 45707230, "answer_count": 1, "score": -1, "last_activity_date": 1502867987, "creation_date": 1502867503, "question_id": 45707204, "link": "https://stackoverflow.com/questions/45707204/how-to-fix-segmentation-fault-core-dumped-while-i-use-strcat-in-file-operation", "closed_reason": "Duplicate", "title": "how to fix Segmentation fault (core dumped) while i use strcat in file operations", "body": "<p>i have written code for storing data in a text file and i have separated my data into 2 strings . and  i did concatenate 2  strings using strcat . but while running its showing segmentation fault(core dumped)..</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid main()\n{\n    FILE *fptr;\n    char *data=\"867330029590851,144311,140817,130294,0801536,15,00,-1380021593,,N,,,,,180717034311,,,,,4.18,,,,,,,,NA\";\n    char *timeStamp=\"14-08-17,14:45:38\";\n\n    char *currentTimeStamp=strcat(data,timeStamp);\n\n\n    /*  open for writing */\n    fptr = fopen(\"RedisData.txt\", \"w\");\n\n    if (fptr == NULL)\n    {\n        printf(\"File does not exists \\n\");\n        return;\n    }\n    // printf(\"string \\n\");\n    // scanf(\"%s\", data);\n\n    printf(\"%s\\n\",currentTimeStamp);\n\n    fprintf(fptr,\"currentTimeStamp= %s\\n\",currentTimeStamp);\n\n\n    fprintf(fptr, \"Data    = %s\\n\", data);\n    fprintf(fptr, \"TimeStamp     = %s\\n\", timeStamp);\n    fclose(fptr);\n}\n</code></pre>\n"}, {"tags": ["c", "multidimensional-array", "pointer-to-array"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1502866720, "post_id": 45706956, "comment_id": 78371864, "body": "Avoid multi-dimensional arrays in C. Consider using <a href=\"https://en.wikipedia.org/wiki/Flexible_array_member\" rel=\"nofollow noreferrer\">flexible array members</a> to implement your own matrix abstract data type, like <a href=\"https://stackoverflow.com/a/41410503/841108\">here</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1502866730, "post_id": 45706956, "comment_id": 78371874, "body": "Be careful when using strings and fixed-sized arrays, you have to remember that a string of three characters really need space for <i>four</i> characters, to include the terminating null character <code>&#39;\\0&#39;</code>."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 1, "creation_date": 1502866759, "post_id": 45706956, "comment_id": 78371883, "body": "Note that <code>&quot;sam&quot;</code> actually requires 4 bytes, as it includes the string termination character"}], "answers": [{"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 7, "last_activity_date": 1502866744, "creation_date": 1502866744, "answer_id": 45707002, "question_id": 45706956, "link": "https://stackoverflow.com/questions/45706956/how-to-use-pointer-to-multi-dimentional-array-in-c-language/45707002#45707002", "title": "How to use pointer to multi dimentional array in C language?", "body": "<p>You should not print <code>arr[2][2]</code> because you are accessing array out of bounds. Also note that there is no space for <code>'\\0'</code> character to be stored in in the given array.    </p>\n\n<pre><code>char arr[2][4] = {\"sam\",\"ali\"}  \nchar(*ptr)[4] = arr;\n</code></pre>\n\n<p>Using <code>ptr</code> you can access the elements of <code>arr</code> as <code>ptr[1][2]</code>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 3, "last_activity_date": 1502867613, "last_edit_date": 1502867613, "creation_date": 1502866999, "answer_id": 45707074, "question_id": 45706956, "link": "https://stackoverflow.com/questions/45706956/how-to-use-pointer-to-multi-dimentional-array-in-c-language/45707074#45707074", "title": "How to use pointer to multi dimentional array in C language?", "body": "<p>This:</p>\n\n<pre><code>char(*ptr)[3]=arr;\n</code></pre>\n\n<p>isn't a <em>pointer to a multi dimensional array</em>, it's a <em>pointer to one-dimensional array of size <code>3</code></em>. But that's fine because a pointer can always also point to an <em>array</em> of the type it points to. So you have <code>ptr</code> point to an array of <em>one-dimensional arrays of size <code>3</code></em>. So far just for clarifying the terms.</p>\n\n<p>Your immediate problem are just wrong indices. Indices are based on <code>0</code>, not <code>1</code>, so with</p>\n\n<pre><code>char arr[2][3]={\"sam\",\"ali\"}\n</code></pre>\n\n<p>valid indices for the first dimension of <code>arr</code> are just <code>0</code> and <code>1</code>. The element you're looking for would be at <code>ptr[1][2]</code>.</p>\n\n<hr>\n\n<p>With the <em>pointer arithmetics notation</em> in your question, you actually had the indices right, so I can't see where your problem was in <strong>this</strong> case. The following prints <code>i</code> as expected:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    char arr[2][3]={\"sam\",\"ali\"};\n    char(*ptr)[3]=arr;\n    printf(\"%c\\n\", *(*(ptr+1)+2));\n}\n</code></pre>\n\n<p>Note this is completely equivalent to the more readable <code>ptr[1][2]</code>.</p>\n\n<hr>\n\n<p><em>Side note:</em> if you expected your elements to be <em>strings</em> -- they aren't, see <a href=\"https://stackoverflow.com/a/45707002/2371524\">haccks' answer</a> for the explanation (a string must end with a <code>'\\0'</code>, your string literals do, but your array needs the room to hold it).</p>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1502891122, "post_id": 45708992, "comment_id": 78388646, "body": "&quot;<i>you did not initialize it.</i>&quot; it isn&#39;t even defined."}], "tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 0, "last_activity_date": 1502873243, "creation_date": 1502873243, "answer_id": 45708992, "question_id": 45706956, "link": "https://stackoverflow.com/questions/45706956/how-to-use-pointer-to-multi-dimentional-array-in-c-language/45708992#45708992", "title": "How to use pointer to multi dimentional array in C language?", "body": "<pre><code>char arr[2][3]={\"sam\",\"ali\"}\n</code></pre>\n\n<p>is desugared into</p>\n\n<pre><code>char arr[2][3]={{'s','a','m'},\n                {'a','l','i'}}\n</code></pre>\n\n<p>Next,</p>\n\n<pre><code>char(*ptr)[3]=arr;\n</code></pre>\n\n<p>means <code>a pointer to an array of 3 elements of type char</code>.</p>\n\n<p><code>arr[2][2]</code> is undefined because you did not initialize it.  </p>\n\n<p>However, if you wanted to select the element <code>i</code> that means arr[1][2], which is desugared into <code>*(*(arr+1)+2)</code>.  This can be expressed as <em>(</em>(ptr+1)+2) because the <code>sizeof(*ptr)</code> is the same as the <code>sizeof(*arr)</code>.</p>\n"}], "owner": {"reputation": 85, "user_id": 8002691, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/i4J7O.jpg?s=128&g=1", "display_name": "Mohamed Moustafa", "link": "https://stackoverflow.com/users/8002691/mohamed-moustafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 45707074, "answer_count": 3, "score": 2, "last_activity_date": 1502873613, "creation_date": 1502866628, "last_edit_date": 1502873613, "question_id": 45706956, "link": "https://stackoverflow.com/questions/45706956/how-to-use-pointer-to-multi-dimentional-array-in-c-language", "title": "How to use pointer to multi dimentional array in C language?", "body": "<p>I have 2-D array</p>\n\n<pre><code>char arr[2][3]={\"sam\",\"ali\"}\n</code></pre>\n\n<p>and pointer to this array</p>\n\n<pre><code>char(*ptr)[3]=arr;\n</code></pre>\n\n<p>How can I use this pointer to print <code>arr[2][2]</code> which in this case is <code>i</code>.\nI've tried <code>* (*(ptr+1)+2)</code> the same way I am dealing with the array but didn't work so can any one help and tell me how to deal with pointer to array in this case to print element <code>[2][2]</code>.</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "embedded", "embedded-linux"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502864413, "post_id": 45706232, "comment_id": 78370643, "body": "If you keep rewriting files over flash storage, you will wear out the flash faster than if you don&#39;t. The file system may help protect you by spreading the writes out more evenly. However, the objective should probably be to avoid having to write the entire file so often. There are 1440 minutes in a day; if you need to write the whole file once a minute, and your flash is rated for 100,000 write cycles, then you have the potential to wear out your drives quickly. (There&#39;s a factor for &quot;if the file is 1% of the size of the drive, then you can write it 100 times before you go through one cycle)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502864481, "post_id": 45706232, "comment_id": 78370663, "body": "See, for instance, results from a Google search on &#39;ssd wear leveling&#39; such as <a href=\"http://searchsolidstatestorage.techtarget.com/definition/wear-leveling\" rel=\"nofollow noreferrer\">searchsolidstatestorage.techtarget.com/definition/wear-level&zwnj;&#8203;ing</a> and <a href=\"https://en.wikipedia.org/wiki/Wear_leveling\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Wear_leveling</a>."}, {"owner": {"reputation": 487, "user_id": 2357995, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e0e3bfbc91a6e23d0964b15bcf2223e8?s=128&d=identicon&r=PG", "display_name": "amar", "link": "https://stackoverflow.com/users/2357995/amar"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502867409, "post_id": 45706232, "comment_id": 78372270, "body": "Is there a way to find the embedded linux system shutdown before it gets off.  is there a way to save before the power fail or system shutdown. please give me an example."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502869433, "post_id": 45706232, "comment_id": 78373544, "body": "SIGPWR signal?  Otherwise, not sure."}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1502864250, "creation_date": 1502864250, "answer_id": 45706312, "question_id": 45706232, "link": "https://stackoverflow.com/questions/45706232/is-write-system-call-to-a-file-reduce-the-memory-write-cycle-how-to-handle/45706312#45706312", "title": "Is write system call to a file reduce the memory write cycle how to handle", "body": "<p>It could depend upon the computer, the file system, the mount options, the kernel (and version).</p>\n\n<p>Perhaps (and actually probably) your file is sitting in the <a href=\"https://en.wikipedia.org/wiki/Page_cache\" rel=\"nofollow noreferrer\">page cache</a> and <a href=\"http://man7.org/linux/man-pages/man2/write.2.html\" rel=\"nofollow noreferrer\">write(2)</a>-ing it often does not update the flash memory every time.</p>\n\n<p>You could use something else that a plain file (e.g. a database, or use <a href=\"http://sqlite.org/\" rel=\"nofollow noreferrer\">sqlite</a>) or write your own data daemon to avoid that. If you need that to stay in a file, perhaps consider writing your own <a href=\"https://en.wikipedia.org/wiki/Filesystem_in_Userspace\" rel=\"nofollow noreferrer\">FUSE</a> </p>\n\n<p><sup>We cannot help more without actual code and much more details in your question.</sup></p>\n"}], "owner": {"reputation": 487, "user_id": 2357995, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e0e3bfbc91a6e23d0964b15bcf2223e8?s=128&d=identicon&r=PG", "display_name": "amar", "link": "https://stackoverflow.com/users/2357995/amar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1502871064, "creation_date": 1502863888, "last_edit_date": 1502871064, "question_id": 45706232, "link": "https://stackoverflow.com/questions/45706232/is-write-system-call-to-a-file-reduce-the-memory-write-cycle-how-to-handle", "title": "Is write system call to a file reduce the memory write cycle how to handle", "body": "<p>I have to read/write a single file multiple times in a day. say may be every second, I have to update the file.</p>\n\n<p>how does this effect the memory(I am using Emmc flash).</p>\n\n<p>since emmc having the defined write cycle over which it will corrupt, please suggest me a best way to handle this. </p>\n\n<p>how about using the <strong>mmap and msync</strong>, is there any possibility to avoid writes..?</p>\n\n<p>if I am using a mmap and writing frequently is it will also write in flash every time I write into the shared mapped memory.?</p>\n"}, {"tags": ["mysql", "c", "linux"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6617295"}, "is_accepted": true, "score": 0, "last_activity_date": 1502982971, "creation_date": 1502982971, "answer_id": 45738969, "question_id": 45706096, "link": "https://stackoverflow.com/questions/45706096/version-libmysqlclient-20-0-not-found/45738969#45738969", "title": "version `libmysqlclient_20.0&#39; not found", "body": "<p>the library of the mysql is in /usr/local/mysql,but lsconfig's default path is /usr/lib,so add the </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6617295"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 0, "accepted_answer_id": 45738969, "answer_count": 1, "score": 0, "last_activity_date": 1502982971, "creation_date": 1502863274, "question_id": 45706096, "link": "https://stackoverflow.com/questions/45706096/version-libmysqlclient-20-0-not-found", "title": "version `libmysqlclient_20.0&#39; not found", "body": "<p>my machine is CentOS Linux release 7.3.1611 (Core) </p>\n\n<p>my code written with c </p>\n\n<p>mysql's version is mariadb</p>\n\n<p>I copy the libmysqlclient.so.20 from /usr/lib64/mysql to /lib64 but fount an error:</p>\n\n<p>version `libmysqlclient_20.0' not found </p>\n"}, {"tags": ["c", "visual-studio", "visual-studio-2015", "awesomium"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502858735, "post_id": 45705105, "comment_id": 78368648, "body": "Welcome to Stack Overflow.  Please read the <a href=\"https://stackoverflow.com/tour\">About</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> pages soon.  Note that a standard close reason is <i>Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam.</i>  This is basically asking us to find an off-site resource."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502859108, "post_id": 45705105, "comment_id": 78368763, "body": "Try looking under <a href=\"http://http://wiki.awesomium.net/\" rel=\"nofollow noreferrer\">http://wiki.awesomium.net</a> and follow links.  You may manage to find code to download (but the <a href=\"http://www.awesomium.com/download\" rel=\"nofollow noreferrer\">awesomium.com/download</a> link leads to the &quot;We&#39;re building something awesome&quot; page with the option to sign up for emails.  I note that the GitHub pages backing the site appear to have been last updated in 2016, which (I my estimation) bodes ill for the product \u2014 it&#39;s a long time not to be available."}, {"owner": {"reputation": 2710, "user_id": 3737186, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/PYtA4.png?s=128&g=1", "display_name": "Sjoerd222888", "link": "https://stackoverflow.com/users/3737186/sjoerd222888"}, "edited": false, "score": 1, "creation_date": 1504254092, "post_id": 45705105, "comment_id": 78951835, "body": "You could try writing an email to the address specified on the website. But I would strongly recommend to refactor your project and use an alternative like <a href=\"https://bitbucket.org/xilium/xilium.cefglue/overview\" rel=\"nofollow noreferrer\">CefGlue</a>, <a href=\"https://github.com/cefsharp/CefSharp\" rel=\"nofollow noreferrer\">CefSharp</a> or <a href=\"https://bitbucket.org/chromiumfx/chromiumfx\" rel=\"nofollow noreferrer\">ChromiumFX</a> instead."}, {"owner": {"reputation": 2710, "user_id": 3737186, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/PYtA4.png?s=128&g=1", "display_name": "Sjoerd222888", "link": "https://stackoverflow.com/users/3737186/sjoerd222888"}, "reply_to_user": {"reputation": 321, "user_id": 9115825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP6Dg.gif?s=128&g=1", "display_name": "PspSetProcessPpmPolicy", "link": "https://stackoverflow.com/users/9115825/pspsetprocessppmpolicy"}, "edited": false, "score": 1, "creation_date": 1518683195, "post_id": 45705105, "comment_id": 84608142, "body": "@PspSetProcessPpmPolicy I would suggest <a href=\"https://bitbucket.org/chromiumembedded/cef\" rel=\"nofollow noreferrer\">CEF</a>. The libraries I mentioned are basically just wrappers for CEF."}, {"owner": {"reputation": 2710, "user_id": 3737186, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/PYtA4.png?s=128&g=1", "display_name": "Sjoerd222888", "link": "https://stackoverflow.com/users/3737186/sjoerd222888"}, "reply_to_user": {"reputation": 321, "user_id": 9115825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP6Dg.gif?s=128&g=1", "display_name": "PspSetProcessPpmPolicy", "link": "https://stackoverflow.com/users/9115825/pspsetprocessppmpolicy"}, "edited": false, "score": 0, "creation_date": 1518784818, "post_id": 45705105, "comment_id": 84657563, "body": "@PspSetProcessPpmPolicy I am not a legal person so I will not give any explicit legal advice. According to their web-site it is using a BSD-license. You may want to consult the <a href=\"https://en.wikipedia.org/wiki/BSD_licenses\" rel=\"nofollow noreferrer\">Wikipedia article about BSD-licences</a>."}, {"owner": {"reputation": 139, "user_id": 4936144, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/jQjlP.gif?s=128&g=1", "display_name": "BuddyRoach", "link": "https://stackoverflow.com/users/4936144/buddyroach"}, "edited": false, "score": 0, "creation_date": 1579319497, "post_id": 45705105, "comment_id": 105736310, "body": "i have the install somewhere i believe. if youre still interested, reply to this."}], "answers": [{"tags": [], "owner": {"reputation": 1147, "user_id": 3417153, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7e687378c61a380ef127fa2304b7c4ec?s=128&d=identicon&r=PG&f=1", "display_name": "Mike N.", "link": "https://stackoverflow.com/users/3417153/mike-n"}, "is_accepted": false, "score": 11, "last_activity_date": 1514083502, "last_edit_date": 1514083502, "creation_date": 1504420276, "answer_id": 46020895, "question_id": 45705105, "link": "https://stackoverflow.com/questions/45705105/awesomium-sdk-download/46020895#46020895", "title": "Awesomium sdk download", "body": "<p>Version 1.7.5 of the SDK is currently downloadable from the Wayback Machine:</p>\n\n<ul>\n<li><a href=\"https://web.archive.org/web/20170402001925/http://www.awesomium.com/downloads/awesomium_1_7_5_1_sdk_win.exe\" rel=\"noreferrer\">For Windows</a></li>\n<li><a href=\"https://web.archive.org/web/20151018175051/http://www.awesomium.com/downloads/awesomium_1_7_5_sdk_mac.dmg\" rel=\"noreferrer\">For Mac</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2710, "user_id": 3737186, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/PYtA4.png?s=128&g=1", "display_name": "Sjoerd222888", "link": "https://stackoverflow.com/users/3737186/sjoerd222888"}, "is_accepted": false, "score": 2, "last_activity_date": 1518785164, "creation_date": 1518785164, "answer_id": 48827108, "question_id": 45705105, "link": "https://stackoverflow.com/questions/45705105/awesomium-sdk-download/48827108#48827108", "title": "Awesomium sdk download", "body": "<p>While Awesomium is not maintained any longer a good alternative is <a href=\"https://bitbucket.org/chromiumembedded/cef/overview\" rel=\"nofollow noreferrer\">CEF</a>. It is a little more difficult to use to use but the documentation is quite extensive so you should get started easily. Questions get answered quite quickly on the <a href=\"http://magpcss.org/ceforum/\" rel=\"nofollow noreferrer\">official CEF forum</a> according to my experience.</p>\n"}], "owner": {"reputation": 75, "user_id": 8217614, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/64c5748cfdf73dc835b09ce7e9712f8f?s=128&d=identicon&r=PG&f=1", "display_name": "Stephanie Sotelo", "link": "https://stackoverflow.com/users/8217614/stephanie-sotelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12887, "favorite_count": 4, "answer_count": 2, "score": 5, "last_activity_date": 1595500439, "creation_date": 1502857479, "question_id": 45705105, "link": "https://stackoverflow.com/questions/45705105/awesomium-sdk-download", "title": "Awesomium sdk download", "body": "<p>Is there a way to download Awesomium latest sdk or for visual studio 2015 since their website is down?\nI need it for a project I found for visual basic which Awesomium core and some functions are required..</p>\n"}, {"tags": ["c", "linux", "memory-management", "linux-kernel", "paging"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502857554, "post_id": 45705066, "comment_id": 78368270, "body": "This is proobably the wrong place to do it though..."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502857679, "post_id": 45705066, "comment_id": 78368307, "body": "Why don&#39;t you just pin the virtual address corresponding to the <code>mmap</code> memory? It will automatically fetch the pages from disk (or whatever device) and avoid any page faults in user/kernel mode."}, {"owner": {"reputation": 484, "user_id": 6421681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-gZN1tFHAS_0/AAAAAAAAAAI/AAAAAAAAAGo/c8XZSrjQuEM/photo.jpg?sz=128", "display_name": "Yolo Voe", "link": "https://stackoverflow.com/users/6421681/yolo-voe"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502857732, "post_id": 45705066, "comment_id": 78368327, "body": "@AnttiHaapala Can you let me know where you think I should start, please? Also, I mean to fill out the <code>pte</code> only for files that are <code>mmap</code>ed, not for the entire PMEM device, if that was causing any misunderstanding."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502857756, "post_id": 45705066, "comment_id": 78368331, "body": "Also, <i>to see if not taking any pagefaults gives us better performance in PMEM</i> this is kind of guaranteed if you are going to read all the content from the file. No page fault is better an 1 page fault per page."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502857847, "post_id": 45705066, "comment_id": 78368357, "body": "@peanutlover sorry, I am not <i>that much</i> of Linux kernel expert, just saying that it would be a bit ugly to start filling the page table exactly <i>in</i> there... Also, have you experimented with <code>madvise</code> flags yet?"}, {"owner": {"reputation": 484, "user_id": 6421681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-gZN1tFHAS_0/AAAAAAAAAAI/AAAAAAAAAGo/c8XZSrjQuEM/photo.jpg?sz=128", "display_name": "Yolo Voe", "link": "https://stackoverflow.com/users/6421681/yolo-voe"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502858330, "post_id": 45705066, "comment_id": 78368511, "body": "@AjayBrahmakshatriya I agree. I should be more specific. We want to see <i>how much better</i> it is. Also, I don&#39;t completely get what <i>pin</i> is, but from the looks of it, it seems to bring pages into memory and lock it there. In <code>dax</code> mode, you don&#39;t bring the stuff in memory. You access the device directly without any memory access (the device is byte-addressable and gives DDR latencies). Do you have any other suggestions? Thanks."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502858513, "post_id": 45705066, "comment_id": 78368567, "body": "@peanutlover pin doesn&#39;t just bring the content to the memory. Depending on the type of the physical address, it creates mapping in the page table. It just basically gives you the guarantee that there won&#39;t be a page fault on any access on the pages which are pinned. I think that is what you are trying to do too. You are trying to force insert all the mappings in the page table."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502858626, "post_id": 45705066, "comment_id": 78368614, "body": "@peanutlover There is a minor flaw with your logic though (I think). The OS doesn&#39;t guarantee that these mappings will remain forever. The OS can chose to evict the mapping ( although I can&#39;t think of any reason why it would do so since there is no RAM involved/consumed here). But pinning gives you the guarantee until you explicitly unpin."}, {"owner": {"reputation": 484, "user_id": 6421681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-gZN1tFHAS_0/AAAAAAAAAAI/AAAAAAAAAGo/c8XZSrjQuEM/photo.jpg?sz=128", "display_name": "Yolo Voe", "link": "https://stackoverflow.com/users/6421681/yolo-voe"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502858683, "post_id": 45705066, "comment_id": 78368633, "body": "@AnttiHaapala Thanks for the suggestion! I looked into it, and, wow, TIL something awesome! I&#39;ll probably go through and read it&#39;s source code. Maybe that&#39;ll help. Using <code>madvise</code> flags I don&#39;t think would be helpful in this case. I have updated the question with more details (which the comment above reiterates). Essentially, I am not fetching anything into memory. I just need the page tables completely filled out."}, {"owner": {"reputation": 484, "user_id": 6421681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-gZN1tFHAS_0/AAAAAAAAAAI/AAAAAAAAAGo/c8XZSrjQuEM/photo.jpg?sz=128", "display_name": "Yolo Voe", "link": "https://stackoverflow.com/users/6421681/yolo-voe"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502858788, "post_id": 45705066, "comment_id": 78368665, "body": "@AjayBrahmakshatriya That sounds very, very promising! Thanks! I&#39;ll look more into it and update my findings tomorrow!"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502858851, "post_id": 45705066, "comment_id": 78368694, "body": "@peanutlover worst case, you can look the Page fault handler. Since it has to create the mapping and you can pick up the code from there."}, {"owner": {"reputation": 484, "user_id": 6421681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-gZN1tFHAS_0/AAAAAAAAAAI/AAAAAAAAAGo/c8XZSrjQuEM/photo.jpg?sz=128", "display_name": "Yolo Voe", "link": "https://stackoverflow.com/users/6421681/yolo-voe"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502859336, "post_id": 45705066, "comment_id": 78368824, "body": "@AjayBrahmakshatriya I actually went down that route first. I forgot why, but I got stuck somewhere. One of the functions that pagefault handler eventually ended up calling had access to some data that I didn&#39;t have access to I think... Not sure. I might have to go down that path again. Anyways, will keep you updated."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502859855, "post_id": 45705066, "comment_id": 78368951, "body": "@peanutlover I did not think of this before, but why don&#39;t you simply fault into all the pages once by reading 1 byte per page in <code>mmap</code> itself (if that doesn&#39;t break semantics for your device) ? Here you don&#39;t have to reimplement any functionality?"}, {"owner": {"reputation": 484, "user_id": 6421681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-gZN1tFHAS_0/AAAAAAAAAAI/AAAAAAAAAGo/c8XZSrjQuEM/photo.jpg?sz=128", "display_name": "Yolo Voe", "link": "https://stackoverflow.com/users/6421681/yolo-voe"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502860042, "post_id": 45705066, "comment_id": 78368999, "body": "@AjayBrahmakshatriya Yeah. We&#39;ve a new memory allocator, too, so it could be like a config in it or something. But it&#39;s not upto me unfortunately."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502860115, "post_id": 45705066, "comment_id": 78369016, "body": "@peanutlover Yes, it can be done from user space too. You don&#39;t need any kernel changes."}, {"owner": {"reputation": 484, "user_id": 6421681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-gZN1tFHAS_0/AAAAAAAAAAI/AAAAAAAAAGo/c8XZSrjQuEM/photo.jpg?sz=128", "display_name": "Yolo Voe", "link": "https://stackoverflow.com/users/6421681/yolo-voe"}, "edited": false, "score": 0, "creation_date": 1502860144, "post_id": 45705066, "comment_id": 78369020, "body": "I guess we care about that overhead since this will likely be going in a very extensively used Redis environment."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502866786, "post_id": 45705066, "comment_id": 78371902, "body": "@peanutlover I think something like adjusting <code>MADV_WILLNEED</code> or creating a similar flag, would be something you&#39;d need..."}], "answers": [{"comments": [{"owner": {"reputation": 484, "user_id": 6421681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-gZN1tFHAS_0/AAAAAAAAAAI/AAAAAAAAAGo/c8XZSrjQuEM/photo.jpg?sz=128", "display_name": "Yolo Voe", "link": "https://stackoverflow.com/users/6421681/yolo-voe"}, "edited": false, "score": 0, "creation_date": 1502900446, "post_id": 45713936, "comment_id": 78395306, "body": "First things first, I like your username! It suits you. You have saved me quite a bit of trouble."}, {"owner": {"reputation": 484, "user_id": 6421681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-gZN1tFHAS_0/AAAAAAAAAAI/AAAAAAAAAGo/c8XZSrjQuEM/photo.jpg?sz=128", "display_name": "Yolo Voe", "link": "https://stackoverflow.com/users/6421681/yolo-voe"}, "edited": false, "score": 0, "creation_date": 1502902547, "post_id": 45713936, "comment_id": 78396476, "body": "Yep. I agree with your second point, but in this case I think pre-loading <code>pte</code>s shouldn&#39;t lead to performance mis-attribution. I&#39;ll keep your point in mind and be careful, though! Thanks for reminding me!"}], "tags": [], "owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "is_accepted": true, "score": 2, "last_activity_date": 1502887575, "creation_date": 1502887575, "answer_id": 45713936, "question_id": 45705066, "link": "https://stackoverflow.com/questions/45705066/in-the-kernel-space-how-does-one-get-the-physical-addresses-corresponding-to-a/45713936#45713936", "title": "In the kernel space, how does one get the physical addresses corresponding to a file on ext4-formatted disk", "body": "<p>First of all mmap support MAP_POPULATE flag specifically to avoid page faults. In principle it may be it does not work with dax, but that's unlikely.</p>\n\n<p>Second of all it seems you don't have any measurements of the current state of affairs. Just \"changing something and checking the difference\" is a fundamentally wrong approach. In particular it may be the actual bottleneck will be removed as an unintended consequence of the change and the win will end up being misattributed. You can start by using 'perf' to get basic numbers and generating flamegraphs ( <a href=\"http://www.brendangregg.com/FlameGraphs/cpuflamegraphs.html\" rel=\"nofollow noreferrer\">http://www.brendangregg.com/FlameGraphs/cpuflamegraphs.html</a> ). If you do a lot of i/o over a small range, page faults should have a negligible effect.</p>\n"}], "owner": {"reputation": 484, "user_id": 6421681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-gZN1tFHAS_0/AAAAAAAAAAI/AAAAAAAAAGo/c8XZSrjQuEM/photo.jpg?sz=128", "display_name": "Yolo Voe", "link": "https://stackoverflow.com/users/6421681/yolo-voe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 45713936, "answer_count": 1, "score": 2, "last_activity_date": 1553064526, "creation_date": 1502857281, "last_edit_date": 1553064526, "question_id": 45705066, "link": "https://stackoverflow.com/questions/45705066/in-the-kernel-space-how-does-one-get-the-physical-addresses-corresponding-to-a", "title": "In the kernel space, how does one get the physical addresses corresponding to a file on ext4-formatted disk", "body": "<p>If you're here:</p>\n\n<p><a href=\"https://github.com/torvalds/linux/blob/master/fs/ext4/file.c#L360\" rel=\"nofollow noreferrer\">https://github.com/torvalds/linux/blob/master/fs/ext4/file.c#L360</a> <br>\n<br>\nYou have access to these two structs inside the <code>ext4_file_mmap</code> function:</p>\n\n<pre><code>struct file *file, struct vm_area_struct *vma\n</code></pre>\n\n<p>I am changing the implementation of this function for <code>dax</code> mode so that the page tables get entirely filled out for the file the moment you call <code>mmap</code> (to see how much better performance not taking any <code>pagefaults</code> gives us).</p>\n\n<p>I have managed to get the following done so far (assuming I have access to to the two structs that <code>ext4_file_mmap</code> has access to):</p>\n\n<pre><code>// vm_area_struct defined in /include/linux/mm_types.h : 284\n// file defined in /include/linux/fs.h : 848\n\nloff_t file_size = file_inode(file)-&gt;i_size;\nunsigned long start_va = vma-&gt;vm_start;\n</code></pre>\n\n<p>Now, the difficulty lies here. How do I get the physical addresses (blocks? Not sure if <code>dax</code> uses blocks) associated with this file?</p>\n\n<p>I have spent the last couple of days staring at the linux source code, trying to make sense of stuff, and boy have I been successful. </p>\n\n<p>Any help, hint,or  suggestion is greatly appreciated!\nThanks!</p>\n\n<p>Some updates: When you <code>mmap</code> a file in <code>dax</code> mode, you don't fetch anything into memory. The device, in this case PMEM, is byte-addressable and gives DDR latencies, so it's accessed directly (no memory in between). Certain <code>pte</code>s lead to the access of this PMEM device instead of memory.</p>\n"}, {"tags": ["c", "gcc", "data-structures", "segmentation-fault"], "comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1502857388, "post_id": 45705047, "comment_id": 78368230, "body": "<a href=\"http://stackoverflow.com/q/605845/995714\">Don&#39;t cast the result of <code>malloc</code> in C</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": true, "score": 2, "last_activity_date": 1502858555, "last_edit_date": 1502858555, "creation_date": 1502857356, "answer_id": 45705080, "question_id": 45705047, "link": "https://stackoverflow.com/questions/45705047/c-change-the-position-of-the-conditions-in-while-loop-leads-to-segmentation-fa/45705080#45705080", "title": "C - Change the position of the conditions in while loop leads to Segmentation fault in C?", "body": "<pre><code>(hashArray[hashIndex] != NULL &amp;&amp; hashArray[hashIndex]-&gt;key != -1)\n</code></pre>\n\n<p>It works because here, if first condition is false, the second one does not get executed \u2014 that is behavior of <code>&amp;&amp;</code> operator \u2014 so in case <code>hashArray[hashIndex]</code> is NULL, it does not access invalid memory by accessing <code>hashArray[hashIndex]-&gt;key</code></p>\n"}, {"tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 1, "last_activity_date": 1502857399, "creation_date": 1502857399, "answer_id": 45705089, "question_id": 45705047, "link": "https://stackoverflow.com/questions/45705047/c-change-the-position-of-the-conditions-in-while-loop-leads-to-segmentation-fa/45705089#45705089", "title": "C - Change the position of the conditions in while loop leads to Segmentation fault in C?", "body": "<p><code>C</code> has short circuit evaluation for boolean <code>&amp;&amp;</code>. This means that if the first expression evaluates to false, the second won't be evaluated and false will be returned directly.</p>\n\n<p>Now in your case </p>\n\n<pre><code>while(hashArray[hashIndex] != NULL &amp;&amp; hashArray[hashIndex]-&gt;key != -1)\n</code></pre>\n\n<p>if <code>hashArray[hashIndex]</code> turns out to be <code>NULL</code>, the second part won't be evaluated.</p>\n\n<p>This means you are safe.</p>\n\n<p>But what happens when you switch the order and <code>hashArray[hashIndex]</code> is indeed <code>NULL</code>? You dereference <code>NULL</code> before checking it and hence you get a Seg Fault.</p>\n\n<p>So the best solution for you is to keep it as is.</p>\n"}, {"tags": [], "owner": {"reputation": 7050, "user_id": 8033585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbcd92ce2da15d74815d79b2908132d3?s=128&d=identicon&r=PG&f=1", "display_name": "AGN Gazer", "link": "https://stackoverflow.com/users/8033585/agn-gazer"}, "is_accepted": false, "score": 1, "last_activity_date": 1502858627, "last_edit_date": 1502858627, "creation_date": 1502857797, "answer_id": 45705156, "question_id": 45705047, "link": "https://stackoverflow.com/questions/45705047/c-change-the-position-of-the-conditions-in-while-loop-leads-to-segmentation-fa/45705156#45705156", "title": "C - Change the position of the conditions in while loop leads to Segmentation fault in C?", "body": "<p>The problem is that in the first case you first check <code>hashArray[hashIndex] != NULL</code> and access <code>key</code> member <em>only</em> if the object exists. The second version will attempt to access the <code>key</code> member before making sure that object was created. </p>\n\n<p>In other words, in the second version it may happen that <code>hashArray[hashIndex]</code> is <code>NULL</code> and so your first part of the condition (<code>hashArray[hashIndex]-&gt;key</code>) is equivalent to <code>NULL-&gt;key</code>, which leads to access violation. </p>\n"}], "owner": {"reputation": 119, "user_id": 7211497, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/1344427825608597/picture?type=large", "display_name": "Nguy\u1ec5n Thanh V\u0169", "link": "https://stackoverflow.com/users/7211497/nguy%e1%bb%85n-thanh-v%c5%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1502872582, "accepted_answer_id": 45705080, "answer_count": 3, "score": 1, "last_activity_date": 1502858627, "creation_date": 1502857110, "question_id": 45705047, "link": "https://stackoverflow.com/questions/45705047/c-change-the-position-of-the-conditions-in-while-loop-leads-to-segmentation-fa", "closed_reason": "Duplicate", "title": "C - Change the position of the conditions in while loop leads to Segmentation fault in C?", "body": "<p>I have a function to insert an element to a hash table like this in my program:</p>\n\n<pre><code>void insert(int key,int data)\n{\n    struct DataItem *newdata = (struct DataItem*) malloc(sizeof(struct DataItem));\n    int  hashIndex;\n\n    newdata-&gt;key = key;\n    newdata-&gt;data = data;\n\n    hashIndex = hashCode(key);\n\n    while(hashArray[hashIndex] != NULL &amp;&amp; hashArray[hashIndex]-&gt;key != -1)\n    {\n        ++hashIndex;\n        hashIndex %= MAX_SIZE;\n    }   \n\n    hashArray[hashIndex] = newdata;\n}\n</code></pre>\n\n<p>This works without any problem. However, when I change the position of the condition in while loop to this:</p>\n\n<pre><code>while(hashArray[hashIndex]-&gt;key != -1 &amp;&amp; hashArray[hashIndex] != NULL )\n</code></pre>\n\n<p>There \u00eds an \"Segmentation Fault\" error. And the program pointer stops at the while loop when I call the insert function.</p>\n\n<p>I'm wondering what is the problem?</p>\n"}, {"tags": ["c++", "c", "unix", "compiler-construction", "ubuntu-16.04"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1502856993, "post_id": 45705008, "comment_id": 78368122, "body": "<a href=\"http://rosecompiler.org/ROSE_HTML_Reference/installation.html\" rel=\"nofollow noreferrer\">rosecompiler.org/ROSE_HTML_Reference/installation.html</a>"}, {"owner": {"reputation": 101, "user_id": 6387835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d96bc10e1816b035e4029775ea3e263a?s=128&d=identicon&r=PG&f=1", "display_name": "user666", "link": "https://stackoverflow.com/users/6387835/user666"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502857875, "post_id": 45705008, "comment_id": 78368368, "body": "I installed boost1.58.0 by using &#39;&#39;apt-get install libboost-all-dev&#39;&#39;. Then what is my boost installation directory?"}], "answers": [{"tags": [], "owner": {"reputation": 124, "user_id": 8157656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5db0a1f35a9d1f6a57763b84f5c04a60?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Nelson", "link": "https://stackoverflow.com/users/8157656/cole-nelson"}, "is_accepted": false, "score": 1, "last_activity_date": 1504123059, "creation_date": 1504123059, "answer_id": 45968751, "question_id": 45705008, "link": "https://stackoverflow.com/questions/45705008/how-to-install-rose-compiler-on-ubuntu/45968751#45968751", "title": "How to install Rose compiler on Ubuntu?", "body": "<p>The ROSE installation process is a mangled mess. If you can, use their <a href=\"http://www.rosecompiler.org/Ubuntu-ROSE-Demo-V3.tar.gz\" rel=\"nofollow noreferrer\">pre-built image</a>. If you can't, I'd recommend running <a href=\"https://github.com/rose-compiler/rose-develop/blob/master/scripts/2017-03-ROSE-Unbuntu-16.04-VM-setup.sh\" rel=\"nofollow noreferrer\">this shell script</a> instead. Note that the part with downloading Java does not work, so <strong>before running the script</strong> download <strong>JDK 7u51</strong> from <a href=\"http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html\" rel=\"nofollow noreferrer\">Oracle</a> and leave it in the Downloads folder (do not move or rename!) for the script to pick up. This was working as of ~1 month ago (July 2017). No guarantees if it still works.</p>\n\n<p>Also note that the installation process takes a lot of time. The entire ~2 million line project needs to be compiled on your machine. After installation, don't even think about moving any of its folders or dependencies. Best of luck.</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 2338442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FfWKz.jpg?s=128&g=1", "display_name": "Atanu Barai", "link": "https://stackoverflow.com/users/2338442/atanu-barai"}, "is_accepted": false, "score": 1, "last_activity_date": 1583121923, "creation_date": 1583121923, "answer_id": 60482415, "question_id": 45705008, "link": "https://stackoverflow.com/questions/45705008/how-to-install-rose-compiler-on-ubuntu/60482415#60482415", "title": "How to install Rose compiler on Ubuntu?", "body": "<p>If you are using Ubuntu 18.04 or CenOS/RHEL 7 then you can install rose using apt/yum. <a href=\"https://github.com/rose-compiler/rose/wiki/How-to-Set-Up-ROSE\" rel=\"nofollow noreferrer\">https://github.com/rose-compiler/rose/wiki/How-to-Set-Up-ROSE</a> has all the information regarding this.</p>\n"}], "owner": {"reputation": 101, "user_id": 6387835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d96bc10e1816b035e4029775ea3e263a?s=128&d=identicon&r=PG&f=1", "display_name": "user666", "link": "https://stackoverflow.com/users/6387835/user666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1583121923, "creation_date": 1502856742, "last_edit_date": 1502886692, "question_id": 45705008, "link": "https://stackoverflow.com/questions/45705008/how-to-install-rose-compiler-on-ubuntu", "title": "How to install Rose compiler on Ubuntu?", "body": "<p>I am new to Linux. I have been asked to install rose compiler. I installed the dependency Boost by using</p>\n\n<pre><code>apt-get install libboost-all-dev\n</code></pre>\n\n<p>which installed boost1.58.0 but now when I use</p>\n\n<pre><code>apt-cache search rose\n</code></pre>\n\n<p>I cant understand which package is for the rose compiler from the list provided. I downloaded rose from the github repository <a href=\"https://github.com/rose-compiler/rose\" rel=\"nofollow noreferrer\">https://github.com/rose-compiler/rose</a> but I cant understand how to install it.</p>\n"}, {"tags": ["c", "string", "loops", "reverse"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1502856513, "post_id": 45704958, "comment_id": 78367996, "body": "<code>scanf(&quot;%s&quot;..</code> -&gt; <code>scanf(&quot;%99s&quot;...</code>, lookup <code>strlen</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 3, "creation_date": 1502856556, "post_id": 45704958, "comment_id": 78368007, "body": "<code>printf(&quot;%s&quot;,words[i]); --&gt; printf(&quot;%c&quot;, words[i]);</code>"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1502856989, "post_id": 45704958, "comment_id": 78368119, "body": "<code>while (i&lt;=0) {</code> is <code>i</code> always going to be greater than zero. Hence this condition is always false"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1502860483, "post_id": 45705040, "comment_id": 78369121, "body": "<b>Always</b>, always <b>validate user input.</b> int rtn; <code>if ((rtn = scanf (&quot;%s&quot;, words)) != 1) { if (rtn == EOF) { &#47;* handle user canceled input *&#47; }; &#47;* handle input failure *&#47;}</code> Then the loops, <code>for (; words[i]; i++) {}; while (i--) printf (&quot;%c&quot;, words[i]);</code> (there is no need for <code>stdlib.h</code> in the code)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502889361, "post_id": 45705040, "comment_id": 78387334, "body": "Seems odd to add <code>i--;</code> before the loop when <code>while (i&gt;0)</code> (without <code>=</code>) would do the job."}, {"owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502903204, "post_id": 45705040, "comment_id": 78396838, "body": "@chux without i--, i would be pointing to &#39;\\0&#39;. As David C. Rankin  said while(i--) would do the job."}], "tags": [], "owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "is_accepted": true, "score": 1, "last_activity_date": 1502865636, "last_edit_date": 1502865636, "creation_date": 1502857065, "answer_id": 45705040, "question_id": 45704958, "link": "https://stackoverflow.com/questions/45704958/reversing-string-in-c-using-loops/45705040#45705040", "title": "Reversing String in c using loops....", "body": "<p>There are few mistakes in your program.</p>\n\n<ol>\n<li><p>After you have reached the end of the string.You should do i-- as your array index of i will be pointing to <code>'\\0'</code>.</p></li>\n<li><p>Your while loop checks for <code>&lt;=</code> but it should be <code>&gt;=</code>.</p></li>\n<li><p>Use <code>%c</code> for printing chararcters. <code>%s</code> is used to print strings and not char.</p></li>\n</ol>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    char words[100];\n    int i=0;\n    printf(\"Enter a word/sentence: \");\n    scanf(\"%s\", words);\n\n    while (words[i]!='\\0') {\n        ++i;\n    }\n    i--;\n    printf(\"\\nThe Reverse is: \");\n    while (i&gt;=0) {\n       printf(\"%c\",words[i]);\n       i--;\n    }\n return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502864038, "post_id": 45705993, "comment_id": 78370477, "body": "The answer couldn&#39;t have been clearer. I just want to ask if there is any specific reason for the string initialiser for <code>words</code> ?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1502864713, "post_id": 45705993, "comment_id": 78370765, "body": "You always want to initialize your arrays to all <i>zero</i>, that way regardless of any error in logic, if you read less than <code>sizeof (array)</code> chars, your string will <b>always be nul-terminated</b> <code>:)</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502865096, "post_id": 45705993, "comment_id": 78370950, "body": "Fair enough, just that for automatic arrays (of good enough size), it will be expensive. Nevertheless a good practice."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502867605, "post_id": 45705993, "comment_id": 78372406, "body": "Initialization is cheap from an efficiency standpoint. Using the default initializer, whether with <code>words = &quot;&quot;</code> or <code>words = {0}</code> accomplishes the same thing. When you initialize to zero, you are only initializing the first element, all remaining elements are made zero by the default initialization process -- lightning fast, and well worth the 0.00472 microsecond or initialization time (or whatever it is in the real world)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502889919, "post_id": 45705993, "comment_id": 78387763, "body": "&quot;your string will always be nul-terminated&quot; --&gt; maybe.  Consider <code>if (rtn == EOF)</code>, on input error, the contents of <code>words</code> is not certain.  As much as initializing variables is a worthy guide (I an not a fan off initializing large arrays when <code>words[0] = 0;</code> would suffice and perhaps 100x faster), checking return values is even more beneficial."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1502910921, "post_id": 45705993, "comment_id": 78400838, "body": "Well, perhaps I should have been more clear. Since on anything other than <code>rtn = 1</code> the result is <code>return 1;</code> I assumed that as a qualification to the &quot;your string will always be nul-terminated&quot; statement, but yes, I agree, there are no guarantees if an input-failure occurs and you proceed with the string. Whether you do <code>words[0] = 0;</code> or <code>words[MAXC] = &quot;&quot;</code> it is likely to be one OP. That won&#39;t always be true when the array size grows and exceeds the combined register sizes, but point taken on large arrays, especially if repeatedly initialized within a loop."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 3, "last_activity_date": 1502862842, "creation_date": 1502862842, "answer_id": 45705993, "question_id": 45704958, "link": "https://stackoverflow.com/questions/45704958/reversing-string-in-c-using-loops/45705993#45705993", "title": "Reversing String in c using loops....", "body": "<p>While you already have an answer, there are a few additional points you need to consider before you have a solution that doesn't have the potential to invoke <em>Undefined behavior</em>.</p>\n\n<p>First, <strong><em>always, always</em></strong> validate <strong><em>all user input.</em></strong> For all you know a cat could have gone to sleep on the <code>'L'</code> key (with millions being entered), or a more likely case, the user just decides to type a 100-char sentence (or more) which leaves 'words' as an <em>array of chars</em> that is NOT <em>nul-terminated</em> and thus not a valid <em>string</em> in C. Your loop to get the length now invokes <em>Undefined Behavior</em> by reading beyond the end of <code>words</code> off into the stack until the first random '0' is encounter or a <em>SegFault</em> occurs.</p>\n\n<p>To prevent this behavior (you should really just use <code>fgets</code>) but with <code>scanf</code> you can provide a <em>field-width</em> modifier to prevent reading more than <code>length - 1</code> chars. This insures space for the <em>nul-terminating</em> character. </p>\n\n<p>Further, the <code>\"%s\"</code> <em>conversion-specifier</em> stops conversion on the <em>first whitespace</em> character encountered -- making your <code>\"Enter a .../sentence\"</code> an impossibility because <code>scanf (\"%s\", words)</code> will stop reading after the first word (at the first <em>whitespace</em>.</p>\n\n<p>To correct this problem (you should really just use <code>fgets</code>) or with <code>scanf</code> you can use a <em>character class</em> (stuff between <code>[...]</code>) as the <em>conversion specifier</em> that will read until a <code>'\\n'</code> is encountered., e.g. <code>scanf (\"%[^\\n]\", words)</code>. However, recall, that is still not good enough because more than 99-chars can be entered leaving the string un-terminated at 100 and invoking <em>Undefined Behavior</em> at character 101 (off the end of the array). </p>\n\n<p>To prevent this problem (ditto on <code>fgets</code>), or include the <em>field-width</em> modifier, e.g. <code>scanf (\"%99[^\\n]\", words)</code>. Now no more than 99-chars will be read regardless of the cat sleeping on the <code>'L'</code> key.</p>\n\n<p>Putting that altogether, you could do something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAXC 100    /* if you need a constant, define one */\n\nint main(void) {\n\n    char words[MAXC] = \"\";\n    int i = 0, rtn = 0;     /* rtn - capture the return of scanf  */\n\n    printf (\"Enter a word/sentence : \");\n    if ((rtn = scanf (\"%99[^\\n]\", words)) != 1) {   /* validate ! */\n        if (rtn == EOF)     /* user cancel? [ctrl+d] or [ctrl+z]? */ \n            fprintf (stderr, \"user input canceled.\\n\");\n        else                    /* did an input failure occur ? */\n            fprintf (stderr, \"error: invalid input - input failure.\\n\");\n        return 1;               /* either way, bail */\n    }\n\n    for (; words[i]; i++) {}    /* get the length */\n\n    printf (\"Reversed word/sentence: \");\n    while (i--)\n        putchar (words[i]);     /* no need for printf to output 1-char */\n    putchar ('\\n');\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/strrevloops\nEnter a word/sentence : My dog has fleas.\nReversed word/sentence: .saelf sah god yM\n</code></pre>\n\n<p>Look things over and let me know if you have any further questions.</p>\n"}], "owner": {"reputation": 3, "user_id": 8470266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ac8d73fc117667400bdcea37d4928b?s=128&d=identicon&r=PG&f=1", "display_name": "Shariul", "link": "https://stackoverflow.com/users/8470266/shariul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 45705040, "answer_count": 2, "score": 0, "last_activity_date": 1502865636, "creation_date": 1502856367, "question_id": 45704958, "link": "https://stackoverflow.com/questions/45704958/reversing-string-in-c-using-loops", "title": "Reversing String in c using loops....", "body": "<p>I have created a code reverse a string but for some reason it is not working. But I think my logic is right. Then why is it not working??</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    char words[100];\n    int i=0;\n    printf(\"Enter a word/sentence: \");\n    scanf(\"%s\", words);\n\n    while (words[i]!='\\0') {\n           ++i;\n    }\n    printf(\"\\nThe Reverse is: \");\n    while (i&lt;=0) {\n         printf(\"%s\",words[i]);\n         i--;\n     }\n     return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 2, "creation_date": 1502856121, "post_id": 45704896, "comment_id": 78367887, "body": "Essentially, the grammar nonterminal <i>meow-expression</i> includes both actual <i>meow</i> expressions and every expression whose top-level operator is of higher precedence than <i>meow</i> (in fact, this is how the precedence of operators are specified in the standard)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502856460, "post_id": 45704896, "comment_id": 78367979, "body": "Look at the entire grammar for expressions generally; they&#39;re mostly structured along those lines.  For example, <i>primary expression</i> does not follow this layout, but the next one, <i>postfix-expression</i> does: <code>postfix-expression:</code> \u2014 <code>primary-expression</code> \u2014 <code>postfix-expression [ expression ]</code> \u2014 <code>postfix-expression ( argument-expression-listopt )</code> \u2026  A postfix-expression is either a primary-expression or one of a sequence of possible postfix-expressions."}], "answers": [{"comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1502856399, "post_id": 45704933, "comment_id": 78367962, "body": "A <i>constant-expression</i> had better be constant, though. That nonterminal is only used in places where an actual constant expression is required."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1502857445, "post_id": 45704933, "comment_id": 78368238, "body": "Thanks. (1) &quot;they are named for their positions in the precedence hierarchy.&quot; Is it correct that in the syntax of a nonterminal,  the second line is always another nonterminal which is right before the nonterminal in precedence order, and the third line and below are definitions of the nonterminal?"}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1502857588, "post_id": 45704933, "comment_id": 78368278, "body": "(2) A conditional expression isn&#39;t a constant expression, so why does &quot;the grammar will allow any conditional-expression where a constant is required&quot;?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1502858165, "post_id": 45704933, "comment_id": 78368454, "body": "@Tim: Why does your text editor allow you to write <code>f(x)</code> where a constant is required? It&#39;s not your text editor&#39;s job to enforce that, and it&#39;s not the grammar&#39;s job either. As for the syntax in which these grammar rules are expressed, each line after the first one (with the colon) is a sequence the nonterminal can expand to."}], "tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1502856544, "last_edit_date": 1502856544, "creation_date": 1502856156, "answer_id": 45704933, "question_id": 45704896, "link": "https://stackoverflow.com/questions/45704896/how-to-understand-the-syntax-of-conditional-assignment-and-constant-expressions/45704933#45704933", "title": "How to understand the syntax of conditional, assignment and constant expressions?", "body": "<p><code>conditional-expression</code>, <code>assignment-expression</code>, and <code>constant-expression</code> are nonterminals in the grammar. Their names should not be taken to imply that a <code>conditional-expression</code> has to actually involve a conditional operator, or that an <code>assignment-expression</code> has to involve an assignment; they are named for their positions in the precedence hierarchy.</p>\n\n<p>In particular, <code>constant-expression</code> expands to <code>conditional-expression</code> because constant-ness is not a grammatical notion. It's not the grammar's job to exclude non-constants where a constant is required; that job is handled in other parts of a compiler. The grammar will allow any <code>conditional-expression</code> where a constant is required.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1502888411, "post_id": 45709047, "comment_id": 78386585, "body": "Thanks. I was wondering how to understand the syntax of constant-expression? 1) Does it not specify the definition of constant expressions? 2) Does it only specify that the operator of conditional expressions has a higher precedence than some operators in constant-expression? But the constant -expression may have arithmetic operators, which have higher precedence than the operators of conditional expressions."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1502873417, "creation_date": 1502873417, "answer_id": 45709047, "question_id": 45704896, "link": "https://stackoverflow.com/questions/45704896/how-to-understand-the-syntax-of-conditional-assignment-and-constant-expressions/45709047#45709047", "title": "How to understand the syntax of conditional, assignment and constant expressions?", "body": "<p>Chapter 6.5 is very poorly written and is hard to understand. The key is this:</p>\n\n<p>C11 6.5/3</p>\n\n<blockquote>\n  <p>The grouping of operators and operands is indicated by the syntax.</p>\n</blockquote>\n\n<p>Meaning that operator precedence is actually not specified explicitly anywhere in the standard! Instead we are supposed to look at the syntax for each operator and figure it out. </p>\n\n<p>All operators build a chain of operator precedence, so for each sub chapter of 6.5, the previous group of operators is mentioned just to indicate that it has higher precedence.</p>\n\n<p>Starting from the top we have <code>primary-expression</code> (6.5.1) with the highest precedence. In the next group, postfix operators, the previous group will be mentioned to show that it has higher precedence:</p>\n\n<pre><code>postfix-expression:\n  primary-expression\n  postfix-expression [ expression ]\n  ...\n</code></pre>\n\n<p>This doesn't mean that primary expression is a postfix expression, but rather that the syntax for a postfix expression is <code>primary-expression postfix-expression ...</code></p>\n\n<p>It goes on like this throughout the whole chapter 6.5. It might sound royally stupid and that's just because it <em>is</em> royally stupid.</p>\n\n<p>Note 85) tries to provide a bit of help:</p>\n\n<blockquote>\n  <p>The syntax specifies the precedence of operators in the evaluation of an expression, which is the same\n  as the order of the major subclauses of this subclause, highest precedence first.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 45704933, "answer_count": 2, "score": -2, "last_activity_date": 1502873417, "creation_date": 1502855880, "question_id": 45704896, "link": "https://stackoverflow.com/questions/45704896/how-to-understand-the-syntax-of-conditional-assignment-and-constant-expressions", "title": "How to understand the syntax of conditional, assignment and constant expressions?", "body": "<p>From C11 Standard</p>\n\n<ol>\n<li><blockquote>\n  <p>6.5.15  Conditional operator</p>\n  \n  <p>Syntax</p>\n\n<pre><code>conditional-expression:\n    logical-OR-expression\n    logical-OR-expression ? expression : conditional-expression\n</code></pre>\n</blockquote>\n\n<p>Is a logical-OR-expression a conditional-expression, because it is\ndegeneration of a conditional expression?</p></li>\n<li><blockquote>\n  <p>6.5.16  Assignment operators</p>\n  \n  <p>Syntax</p>\n\n<pre><code>assignment-expression:\n    conditional-expression\n    unary-expression  assignment-operator  assignment-expression\n</code></pre>\n</blockquote>\n\n<p>Does it mean that a conditional-expression is an assignment\nexpression? Why is it?</p></li>\n<li><blockquote>\n  <p>6.6  Constant expressions</p>\n  \n  <p>Syntax</p>\n\n<pre><code>constant-expression:    \n    conditional-expression\n</code></pre>\n</blockquote>\n\n<p>Does the syntax of a constant expression mean that constant\nexpression and constant-expression are the same concept?</p></li>\n</ol>\n\n<p>Thanks.</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1502855863, "creation_date": 1502855863, "answer_id": 45704894, "question_id": 45704799, "link": "https://stackoverflow.com/questions/45704799/why-shouldnt-the-value-of-an-object-be-accessed-using-the-following-operators-i/45704894#45704894", "title": "Why shouldn&#39;t the value of an object be accessed using the following operators in address constant expressions?", "body": "<p>This statement is best illustrated with a simple example:</p>\n\n<pre><code>static struct {\n    int id;\n    int count;\n} items[20];\n\nint *midCount = &amp;items[10].count;\n</code></pre>\n\n<p>Above, <code>midCount</code> is an address constant pointing to <code>count</code> field of <code>items</code> struct at index ten. The address-of operator is applied to the result of member access and array subscript operators in order to obtain the address. However, <code>int</code> object at the said address is <em>not</em> accessed, in accordance with the specification.</p>\n\n<p>Here is an expression that accesses the object at the same location as the address-of expression above:</p>\n\n<pre><code>int count = items[10].count;\n</code></pre>\n\n<blockquote>\n  <p>Why shouldn't the value of an object accessed by using those operators?</p>\n</blockquote>\n\n<p>Because it is not required to compute the address constant. The compiler can compute the offset of <code>count</code> inside <code>items</code> array, and apply this offset during the loading, when <code>items</code> is bound to memory, without reading or writing the location itself. This is similar to the behavior of <code>sizeof</code> operator, which does not evaluate its expressions:</p>\n\n<pre><code>size_t sz = sizeof(items[10].count); // No memory access\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502856272, "post_id": 45704905, "comment_id": 78367924, "body": "Changed the example from <code>&amp;(a++)</code> because <code>++</code> returns an rvalue."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 1, "last_activity_date": 1502856696, "last_edit_date": 1502856696, "creation_date": 1502855963, "answer_id": 45704905, "question_id": 45704799, "link": "https://stackoverflow.com/questions/45704799/why-shouldnt-the-value-of-an-object-be-accessed-using-the-following-operators-i/45704905#45704905", "title": "Why shouldn&#39;t the value of an object be accessed using the following operators in address constant expressions?", "body": "<p>I think the restriction on accessing the value is not during runtime but during translation. One is not allowed to dereference a constant expression pointer in a constant expression.</p>\n\n<p>For instance</p>\n\n<pre><code>// global scope\nint a = 0;\nint *b = (a++ , &amp;a);\n</code></pre>\n\n<p>We do not want the compiler to keep track of the state of <code>a</code> while building the initial value of <code>b</code>.</p>\n\n<p>Also the actual value at that address might not be known to the compiler because it might be defined in another translation unit with some constant initializer.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1502858216, "post_id": 45705165, "comment_id": 78368471, "body": "Thanks. Is <code>int y=x</code> an error because initializers to static or external objects must be constant expressions?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1502859926, "post_id": 45705165, "comment_id": 78368967, "body": "No, no, that was just an analogy to set up the explanation using <code>int a[5];</code> There is nothing wrong with <code>int x = 10, y = x;</code> the integers assign <i>values</i>.and not an <i>address constant</i> depending on anything in the computation."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1502864329, "post_id": 45705165, "comment_id": 78370604, "body": "@Tim Yes, that&#39;s correct (David is mistaken to say that there&#39;s nothing wrong with initializing <code>y</code> with <code>x</code>)"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1502857888, "creation_date": 1502857888, "answer_id": 45705165, "question_id": 45704799, "link": "https://stackoverflow.com/questions/45704799/why-shouldnt-the-value-of-an-object-be-accessed-using-the-following-operators-i/45705165#45705165", "title": "Why shouldn&#39;t the value of an object be accessed using the following operators in address constant expressions?", "body": "<p>It is saying that an expression forming an address constant is not allowed to depend on the value of an object.</p>\n\n<p>This is analogous to a simpler case:</p>\n\n<pre><code>// at file scope\nint x = 10;        // OK, 10 is an integer constant expression\nint y = x;         // Error, x is the value of an object\n</code></pre>\n\n<p>For the address constant case, it is reminding us that the computation of the address constant should not read the value of an object in forming that computation, e.g.:</p>\n\n<pre><code>int a[5];                // OK\nint *p = &amp;a[1];          // OK\nint *q = &amp;a[1] + a[0];   // Error, uses value of a[0]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 45705165, "answer_count": 3, "score": 0, "last_activity_date": 1502857888, "creation_date": 1502855218, "last_edit_date": 1592644375, "question_id": 45704799, "link": "https://stackoverflow.com/questions/45704799/why-shouldnt-the-value-of-an-object-be-accessed-using-the-following-operators-i", "title": "Why shouldn&#39;t the value of an object be accessed using the following operators in address constant expressions?", "body": "<p>I have been trying to undersand the following quote from C11 Standard</p>\n<blockquote>\n<p><strong>6.6  Constant expressions</strong></p>\n<p>...</p>\n<ol start=\"9\">\n<li><strong>An address constant</strong> is a null pointer, a pointer to an lvalue designating an object of static\nstorage duration, or a pointer to a function designator; it shall be created explicitly using\nthe unary &amp; operator or an integer constant cast to pointer type, or implicitly by the use of\nan expression of array or function type. The array-subscript [] and member-access .\nand -&gt; operators, the address &amp; and indirection * unary operators, and pointer casts may\nbe  used  in  the  creation  of  an  address  constant,  but  <strong>the  value  of  an  object  shall  not  be\naccessed by use of these operators.</strong></li>\n</ol>\n</blockquote>\n<p>How are the values of an object  accessed by using those operators, although they shouldn't be?  Could you give some examples?</p>\n<p>Why shouldn't the value of an object accessed by using those operators?</p>\n<p>Thanks.</p>\n"}, {"tags": ["c", "cmake", "clion"], "comments": [{"owner": {"reputation": 7633, "user_id": 4093778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j10KcVcKn4A/AAAAAAAAAAI/AAAAAAAAAdE/AgrehO6_eJo/photo.jpg?sz=128", "display_name": "Anders", "link": "https://stackoverflow.com/users/4093778/anders"}, "edited": false, "score": 1, "creation_date": 1502863304, "post_id": 45704732, "comment_id": 78370185, "body": "Please, don&#39;\u1e97 add screenshots, rather add the content of the actual files instead. And the text of the error message. This makes it easier to read."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1502864989, "post_id": 45704732, "comment_id": 78370897, "body": "Consider also compiling on the command line, or writing manually your own <code>Makefile</code>"}, {"owner": {"reputation": 491, "user_id": 4957623, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/i5ZhQ.jpg?s=128&g=1", "display_name": "dogewang", "link": "https://stackoverflow.com/users/4957623/dogewang"}, "edited": false, "score": 0, "creation_date": 1502873309, "post_id": 45704732, "comment_id": 78375996, "body": "The underlying reason of this error is :i choose (c library) when i open a new project,i should choose (c executable),and everything will be fine"}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502863557, "post_id": 45706094, "comment_id": 78370284, "body": "I am afraid the issue here is that the c file is directly being executed and not compiled. See &quot;Cannot run program F:/c_cpp/library.c&quot;. The error code 193 also confirms the same. See <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms681382(v=vs.85).aspx\" rel=\"nofollow noreferrer\">error codes</a>"}, {"owner": {"reputation": 7633, "user_id": 4093778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j10KcVcKn4A/AAAAAAAAAAI/AAAAAAAAAdE/AgrehO6_eJo/photo.jpg?sz=128", "display_name": "Anders", "link": "https://stackoverflow.com/users/4093778/anders"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502864385, "post_id": 45706094, "comment_id": 78370633, "body": "Yes, he&#39;s also tryhing to execute <code>library.c</code>, hence I asked him to execute <code>hello</code> after doing the other changes..."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502864460, "post_id": 45706094, "comment_id": 78370658, "body": "Actually he is trying to run <code>c_cpp</code> which is analogous to your <code>hello</code>. I think the issue is not with the CMakeLists.txt but with the build system target"}, {"owner": {"reputation": 491, "user_id": 4957623, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/i5ZhQ.jpg?s=128&g=1", "display_name": "dogewang", "link": "https://stackoverflow.com/users/4957623/dogewang"}, "edited": false, "score": 0, "creation_date": 1502864878, "post_id": 45706094, "comment_id": 78370840, "body": "I  take your advice and delete &#39;library.c&#39;,&#39;library.h&#39;,get the result i want. I just want to simply execute my c file,the build system really confuse me.I haven&#39;t touch c for many years."}, {"owner": {"reputation": 7633, "user_id": 4093778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j10KcVcKn4A/AAAAAAAAAAI/AAAAAAAAAdE/AgrehO6_eJo/photo.jpg?sz=128", "display_name": "Anders", "link": "https://stackoverflow.com/users/4093778/anders"}, "edited": false, "score": 0, "creation_date": 1502864958, "post_id": 45706094, "comment_id": 78370879, "body": "Well, when building an executable, you need to use <code>add_executable()</code>, not <code>add_library()</code>, which in turn is used to build either a static and dynamic library."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1502865049, "post_id": 45706094, "comment_id": 78370923, "body": "You cannot <i>simply execute a C file</i>, you practically need to compile it (into some executable)."}], "tags": [], "owner": {"reputation": 7633, "user_id": 4093778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j10KcVcKn4A/AAAAAAAAAAI/AAAAAAAAAdE/AgrehO6_eJo/photo.jpg?sz=128", "display_name": "Anders", "link": "https://stackoverflow.com/users/4093778/anders"}, "is_accepted": true, "score": 3, "last_activity_date": 1502864393, "last_edit_date": 1502864393, "creation_date": 1502863270, "answer_id": 45706094, "question_id": 45704732, "link": "https://stackoverflow.com/questions/45704732/cannot-run-c-file-in-clion/45706094#45706094", "title": "Cannot run c file in clion", "body": "<p>Your building a library, which you can't execute.</p>\n\n<p>If <code>hello.c</code> is an application using your library, change</p>\n\n<pre><code>add_library(c_cpp ${SOURCE_FILES})\n</code></pre>\n\n<p>to</p>\n\n<pre><code>add_executable(hello ${SOURCE_FILES})\n</code></pre>\n\n<p>After which you should be able to run <code>hello</code>.</p>\n"}], "owner": {"reputation": 491, "user_id": 4957623, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/i5ZhQ.jpg?s=128&g=1", "display_name": "dogewang", "link": "https://stackoverflow.com/users/4957623/dogewang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2051, "favorite_count": 0, "accepted_answer_id": 45706094, "answer_count": 1, "score": 2, "last_activity_date": 1502865193, "creation_date": 1502854599, "last_edit_date": 1502865193, "question_id": 45704732, "link": "https://stackoverflow.com/questions/45704732/cannot-run-c-file-in-clion", "title": "Cannot run c file in clion", "body": "<p>I configure CLion toolchain with MinGW and set environment variable in Windows 7, and I also can use GCC to complile and built and run <code>hello.c</code> in <code>cmd</code> console.</p>\n\n<pre><code>F:\\c_cpp\\\n|-- cmake-build-debug\\\n|-- CMakeLists.txt\n|-- hello.c\n|-- library.c\n`-- library.h\n</code></pre>\n\n<p>The following is my CMake file:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.8)\nproject(c_cpp)\n\nset(CMAKE_C_STANDARD 99)\n\nset(SOURCE_FILES library.c library.h hello.c)\nadd_library(c_cpp ${SOURCE_FILES})\n</code></pre>\n\n<p>When I click run button and choose \"run c_cpp\", the error happened.</p>\n\n<blockquote>\n  <p>Error running 'c_cpp': Cannot run program \"F:\\c_cpp\\library.c\" (in directory \"F:\\c_cpp\"): CreateProcess error=193, %1 \u4e0d\u662f\u6709\u6548\u7684 Win32 \u5e94\u7528\u7a0b\u5e8f\u3002</p>\n</blockquote>\n\n<p>What should I do?</p>\n"}, {"tags": ["c", "arrays", "struct", "char"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502852720, "post_id": 45704467, "comment_id": 78367134, "body": "and how do you enter the data?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1502852751, "post_id": 45704467, "comment_id": 78367140, "body": "Mixing <code>scanf()</code> with <code>fgets()</code> --&gt; no-no.  <code>fgets()</code> simple consumed the left over <code>&#39;\\n&#39;</code> from the prior <code>scanf(&quot;%d&quot;,&amp;p.s);</code>  Many dupes on this one/"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1502852833, "post_id": 45704467, "comment_id": 78367160, "body": "What chux said. You can fix this quickly by adding a space after <code>%d</code>, like this: <code>scanf(&quot;%d &quot;,&amp;p.s);</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502852891, "post_id": 45704467, "comment_id": 78367169, "body": "hmm yeah should close as a dupe because of the prompts"}, {"owner": {"reputation": 11, "user_id": 7724535, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2325ccb7a2c22864d2bbcb36992e189?s=128&d=identicon&r=PG&f=1", "display_name": "ohhimark", "link": "https://stackoverflow.com/users/7724535/ohhimark"}, "edited": false, "score": 0, "creation_date": 1502853117, "post_id": 45704467, "comment_id": 78367217, "body": "Thank you! That seems to be helping. I just tried it again with your edit and it&#39;s receiving data but not printing the &quot;Hometown&quot; prompt."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502853964, "post_id": 45704467, "comment_id": 78367407, "body": "<code>fgets(p.hometown, 20, stdin);</code> --&gt; <code>scanf(&quot; %19[^\\n]%*1[\\n]&quot;, p.hometown)</code> is a cheap - non-elegant fix.  Better to read all with <code>fgets()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7724535, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2325ccb7a2c22864d2bbcb36992e189?s=128&d=identicon&r=PG&f=1", "display_name": "ohhimark", "link": "https://stackoverflow.com/users/7724535/ohhimark"}, "edited": false, "score": 0, "creation_date": 1502853508, "post_id": 45704561, "comment_id": 78367305, "body": "Thank you! That fixed it :)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502853741, "post_id": 45704561, "comment_id": 78367352, "body": "<code>scan(%s, p.hometown);</code> will not work for town names that contains a space - which is quite common.  Neither does that protect against buffer overflow."}, {"owner": {"reputation": 3364, "user_id": 693294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5935d56f077497b60c12cf86b9d2e1?s=128&d=identicon&r=PG", "display_name": "Gilbert", "link": "https://stackoverflow.com/users/693294/gilbert"}, "edited": false, "score": 0, "creation_date": 1502877957, "post_id": 45704561, "comment_id": 78379238, "body": "I would use %.20s as well to be sure if you have a full 20 characters it doesn&#39;t overrun into garbage land."}], "tags": [], "owner": {"reputation": 1, "user_id": 8467800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9f9115575c4426c9b9d878964fbdba9?s=128&d=identicon&r=PG", "display_name": "user8467800", "link": "https://stackoverflow.com/users/8467800/user8467800"}, "is_accepted": false, "score": 0, "last_activity_date": 1502853368, "creation_date": 1502853368, "answer_id": 45704561, "question_id": 45704467, "link": "https://stackoverflow.com/questions/45704467/trying-to-make-a-structure-wont-let-me-input-a-string/45704561#45704561", "title": "Trying to make a structure, won&#39;t let me input a string", "body": "<p>The local variable might already contains garbage.</p>\n\n<p>Try to memset before you use for string,\nSo that proper null will be terminated.</p>\n\n<p>Try to acquire your input with following scan(%s,  p.hometown);</p>\n\n<p>For strings no need of &amp; for collecting the string.</p>\n\n<p>If you still face the issue, please let me know.</p>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 4863837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P8dJF.jpg?s=128&g=1", "display_name": "Mat&#250;\u0161 Olejn&#237;k", "link": "https://stackoverflow.com/users/4863837/mat%c3%ba%c5%a1-olejn%c3%adk"}, "is_accepted": false, "score": 0, "last_activity_date": 1502876651, "creation_date": 1502876651, "answer_id": 45710199, "question_id": 45704467, "link": "https://stackoverflow.com/questions/45704467/trying-to-make-a-structure-wont-let-me-input-a-string/45710199#45710199", "title": "Trying to make a structure, won&#39;t let me input a string", "body": "<p>This also works for town names that contains a space and is protected against buffer overflow too.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\n#define HOMETOWN_SIZE 20\n\nint main(){\n    struct person {\n        int age;\n        int s;\n        char hometown[HOMETOWN_SIZE + 1]; //+ 1 for terminating null character\n    } p;\n\n    printf(\"Age: \");\n    scanf(\"%d\", &amp;p.age);\n\n    printf(\"Siblings: \");\n    scanf(\"%d\", &amp;p.s);\n\n    printf(\"Hometown: \\n\");\n    getchar(); //just for consume new line from previous scanf\n    fgets(p.hometown, HOMETOWN_SIZE + 1, stdin); //fgets reads n-1 characters\n\n    //don't want new line in hometown name\n    if (p.hometown[strlen(p.hometown) - 1] == '\\n')\n        p.hometown[strlen(p.hometown) - 1] = '\\0';\n\n    printf(\"Age \\t Siblings \\t Hometown\\n\");\n    printf(\"%d   \\t %d        \\t        %s\\n\", p.age, p.s, p.hometown);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 6571851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a5yABTIACSc/AAAAAAAAAAI/AAAAAAAADAU/Za4zG0D9Djg/photo.jpg?sz=128", "display_name": "Sashakt Pathak", "link": "https://stackoverflow.com/users/6571851/sashakt-pathak"}, "is_accepted": false, "score": 0, "last_activity_date": 1502877376, "creation_date": 1502877376, "answer_id": 45710454, "question_id": 45704467, "link": "https://stackoverflow.com/questions/45704467/trying-to-make-a-structure-wont-let-me-input-a-string/45710454#45710454", "title": "Trying to make a structure, won&#39;t let me input a string", "body": "<p>Try flushing the Buffer memory before taking character array input<br>\nlike this </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\nint main()\n{\n struct person{\n    int age;\n    int s;\n    char hometown[20];\n}p;\n\nprintf(\"Age: \");\nscanf(\"%d\",&amp;p.age);\n\nprintf(\"Siblings: \");\nscanf(\"%d\",&amp;p.s);\nprintf(\"Hometown: \\n\");\nfflush(stdin);\nfgets(p.hometown, 20, stdin);\n\nprintf(\"Age \\t Siblings \\t Hometown\\n\");\nprintf(\"%d   \\t %d        \\t        %s\\n\",p.age,p.s,p.hometown);\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7724535, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2325ccb7a2c22864d2bbcb36992e189?s=128&d=identicon&r=PG&f=1", "display_name": "ohhimark", "link": "https://stackoverflow.com/users/7724535/ohhimark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1502877376, "creation_date": 1502852547, "last_edit_date": 1502852634, "question_id": 45704467, "link": "https://stackoverflow.com/questions/45704467/trying-to-make-a-structure-wont-let-me-input-a-string", "title": "Trying to make a structure, won&#39;t let me input a string", "body": "<p>I'm trying to make a structure with the three variables int age, int siblings, and <code>char[]</code> hometown but it's not letting me insert the hometown string when the program is run. The integers work properly but it'll just skip right over the array and leave it blank. I've tried using gets and <code>fgets</code> but nothing seems to be working. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\nint main()\n{\n    struct person{\n        int age;\n        int s;\n        char hometown[20];\n    }p;\n\n    printf(\"Age: \");\n    scanf(\"%d\",&amp;p.age); \n\n    printf(\"Siblings: \");\n    scanf(\"%d\",&amp;p.s);\n\n    printf(\"Hometown: \\n\");\n    fgets(p.hometown, 20, stdin);   \n\n    printf(\"Age \\t Siblings \\t Hometown\\n\");\n    printf(\"%d   \\t %d        \\t        %s\\n\",p.age,p.s,p.hometown);\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "encryption", "optimization"], "comments": [{"owner": {"reputation": 15724, "user_id": 1716339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835fc3719b0118c68c4d202b3e5cbf18?s=128&d=identicon&r=PG", "display_name": "Aki Suihkonen", "link": "https://stackoverflow.com/users/1716339/aki-suihkonen"}, "edited": false, "score": 0, "creation_date": 1502855427, "post_id": 45704142, "comment_id": 78367714, "body": "How many bytes/bits are encrypted using the same subkey? (You suggest 16 but Kasumi AFAIK encrypts data in 8-byte chunks?) And how about adding the sbox generator functions?"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1502881089, "post_id": 45704142, "comment_id": 78381368, "body": "So all the three variants are equivalent? Did you profile them, can you share some numbers, how much they differ, or eventually where most of the time is spend? Or if possible (short enough), add some init code to make the code <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, so one can try himself, but still adding some context about your current position (how much you are off the requirements) would be nice."}, {"owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "edited": false, "score": 1, "creation_date": 1503774499, "post_id": 45704142, "comment_id": 78756709, "body": "@Bai, can you add some numbers of L1 cache misses?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1503845933, "post_id": 45704142, "comment_id": 78770929, "body": "Use C11 <code>_Alignas(32) u16 arr[16];</code> to make sure the 256b store doesn&#39;t fault.  (If it didn&#39;t already, maybe you&#39;re using a compiler that compiles <code>_mm256_store_si256</code> to <code>vmovdqu</code>.  Some compilers (like gcc) will compile it to <code>vmovdqa</code>, so it will fault on unaligned instead of potentially running slower (e.g. for a cache-line split).  I guess that&#39;s just your reference implementation, not what you&#39;re optimizing, but on CPUs with slow gathers it might be better.  Do the first 2 elements with a <code>_mm_cvtsi128_si32</code> (and unpack with scalar mask/shift) so you get started with lower latency."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1503846497, "post_id": 45904267, "comment_id": 78771108, "body": "Nice analysis of the cache-miss problem.  But you&#39;re mixing up latency and throughput when you&#39;re describing it.  Latency isn&#39;t a problem when out-of-order execution can hide it.  It&#39;s not latency directly that&#39;s a problem here, because each iteration is independent.  I think limited memory concurrency will be the real bottleneck here; for example a Skylake CPU only has 10 line-fill buffers to track outstanding requests for L1D cache lines.  So you can&#39;t keep nearly as many cache misses in-flight as this code can generate. (See also <a href=\"https://stackoverflow.com/a/43574756/224132\">Latency Bound</a>)"}, {"owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1503847761, "post_id": 45904267, "comment_id": 78771493, "body": "The 31 cycles latency will fill a lot in the ROB lowering the throughput. The 10 outstanding limited will just make it worse."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1503848273, "post_id": 45904267, "comment_id": 78771627, "body": "The OP didn&#39;t say what hardware, but even Sandybridge has a 168 entry ROB.  (And a 160 entry integer PRF).  But yeah, the ROB and/or RS will fill up from cache-miss latency before they could get enough iterations in flight for 2 loads per clock throughput.  But remember that&#39;s an <i>average</i> latency, and when one iteration stalls, the outstanding loads in other iterations can make progress."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1503848346, "post_id": 45904267, "comment_id": 78771647, "body": "Anyway, that many cache misses are going to suck, but a simple analysis assuming latency = average might not tell you exactly which microarchitectural resource you bottleneck on."}, {"owner": {"reputation": 95, "user_id": 8448591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19f24dee1052363cf8e1a2e01948364d?s=128&d=identicon&r=PG&f=1", "display_name": "Bai", "link": "https://stackoverflow.com/users/8448591/bai"}, "edited": false, "score": 0, "creation_date": 1504408817, "post_id": 45904267, "comment_id": 78999678, "body": "Thank you very much, I have tried to use use s7+s9\uff0cthe miss chance can be decreased.  but according my experiment\uff0cthe result became worse. maybe in other parts of my code, I use Avx instruction."}], "tags": [], "owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "is_accepted": false, "score": 1, "last_activity_date": 1503831942, "creation_date": 1503831942, "answer_id": 45904267, "question_id": 45704142, "link": "https://stackoverflow.com/questions/45704142/how-to-optimize-the-kasumi-algorithm-s-boxes/45904267#45904267", "title": "How to optimize the KASUMI algorithm S-boxes?", "body": "<p>This piece of code might explain the performance problem along with your comment below it.</p>\n\n<pre><code>static u16 FI(__m256i in, u16 subkey) {\n    u16 arr[16];        \n    _mm256_store_si256((__m256i*)arr, in);\n    u8 i;           \n    for(i = 0; i &lt; 16; i++)\n    {\n        arr[i] = (u16)(s16[arr[i]] ^ subkey);\n        arr[i] = (arr[i] &lt;&lt; 7) | (arr[i] &gt;&gt; 9);\n        arr[i] = s16[arr[i]];\n    }\n    in = _mm256_load_si256((__m256i*)arr);\n}\n</code></pre>\n\n<blockquote>\n  <p>S16-box has 65536 elements, so maybe some cache miss will happen.</p>\n</blockquote>\n\n<p>The average x64 processor has only 32KB of L1 (AMD's sometimes has 64K but lets ignore that for now). </p>\n\n<p>This means that with random access patterns your 64K array will get a cache hit rate of 32KB/64KB * 100% = 50%, if no other data structures uses any L1 and your not running hypertrhreading which could also use some L1 on the other thread.</p>\n\n<p>Lets simplify this to saying that you only have 16KB of the 64KB giving a 75% miss chance for each access. So your loops has data dependencies between each line, ie. the next statement can't start before the previous is done. Luckily each iteration is data independent from the others.</p>\n\n<pre><code>arr[i] = (u16)(s16[arr[i]] ^ subkey);\narr[i] = (arr[i] &lt;&lt; 7) | (arr[i] &gt;&gt; 9);\narr[i] = s16[arr[i]];\n</code></pre>\n\n<p><code>arr</code> will almost certainly be in L1 cache at this time, incurring only a 4 cycle startup cost, each access to s16 will on average cost 0.25*4+0.75*12 = 1+9 = 10 cycles. This gives the following approximate latency cost for each statement (ignoring the cost of the stores and reloads of arr[i], presume arr[i] is stored in a register)</p>\n\n<pre><code>arr[i] = (u16)(s16[arr[i]] ^ subkey); // arr: 4 + S16: 10 + ^:1\narr[i] = (arr[i] &lt;&lt; 7) | (arr[i] &gt;&gt; 9); // &lt;&lt; : 1 + |: 1\narr[i] = s16[arr[i]]; // s16 : 10 + store arr : 4\n</code></pre>\n\n<p>31 cycles latency for each iteration, luckily there is no data dependencies between each iteration. Each iteration takes approximately 3 cycles to issue, so the last will be finished in ~3*16+31=79 cycles assuming perfect branch prediction and ignoring the data hazards on the assignment of <code>in</code> at the end.</p>\n\n<p>Your next code which I presume is this loop rewritten to AVX2 will have a lot of the same load dependencies and exactly the same cache misses, the loop overhead will be gone but some longer latency AVX instruction might increase the time. The average time will still be the ~31 cycles latency + some AVX latency + 16 loads / (max 2 load per cycles), lets say 40 cycles.</p>\n\n<p>If you had not merged the S7 and S9 they would only take (128+512)*2 bytes and would almost certainly alway be in the L1 cache when you run a longer coding. The loop latency would then fall to half at the cost of double the number of loads and your full AVX to something like 15 + 32 load / 2 per cycle, lets say 30 cycles.</p>\n\n<p>The good news is that each 16 byte iteration seems to be independent from the previous so they could overlap in time. But your are ultimately limited by the amount of loads and stores, one initial load, 32 loads from s7+s9 and one store, with a max of 2 store or load limit the best possible throughput to 16 bytes / ((1+32+1)/2) cycles.</p>\n\n<p>This is making a lot of optimistic assumptions, only real measurements of the 2 different codes (s16 vs s7+s9) can decide what is best.</p>\n"}], "owner": {"reputation": 95, "user_id": 8448591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19f24dee1052363cf8e1a2e01948364d?s=128&d=identicon&r=PG&f=1", "display_name": "Bai", "link": "https://stackoverflow.com/users/8448591/bai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1503831942, "creation_date": 1502850011, "question_id": 45704142, "link": "https://stackoverflow.com/questions/45704142/how-to-optimize-the-kasumi-algorithm-s-boxes", "title": "How to optimize the KASUMI algorithm S-boxes?", "body": "<p>Thank you very much, I am trying to optimizing the Kasumi algorithm written in C. There has S-box in FI function which uses to encrypt the data, S7-box has 127 elements and S9-box has 512 elements. the FI function code like:</p>\n\n<pre><code>static u16 FI(u16 in, u16 subkey)\n{\n    static u16 s7[] = {...};\n    static u16 s9[] = {...};\n\n    nine = (u16)(in&gt;&gt;7);\n    seven = (u16)(in&amp;0x7F);\n    /* Now run the various operations */\n    nine = (u16)(S9[nine] ^ seven);\n    seven = (u16)(S7[seven] ^ (nine &amp; 0x7F));\n    seven ^= (subkey&gt;&gt;9);\n    nine ^= (subkey&amp;0x1FF);\n    nine = (u16)(S9[nine] ^ seven);\n    seven = (u16)(S7[seven] ^ (nine &amp; 0x7F));\n    in = (u16)((seven&lt;&lt;9) + nine);\n    return( in );\n}\n</code></pre>\n\n<p>u16 represents unsigned short.</p>\n\n<p>By some transformation. I merge S7-box and S9-box to S16-box, and I use avx instruction to make 16 data parallel. the code of FI function like:</p>\n\n<pre><code>static u16 FI(__m256i in, u16 subkey)\n{\n    u16 arr[16];        \n    _mm256_store_si256((__m256i*)arr, in);\n    u8 i;           \n    for(i = 0; i &lt; 16; i++)\n    {\n        arr[i] = (u16)(s16[arr[i]] ^ subkey);\n        arr[i] = (arr[i] &lt;&lt; 7) | (arr[i] &gt;&gt; 9);\n        arr[i] = s16[arr[i]];\n    }\n    in = _mm256_load_si256((__m256i*)arr);\n}\n</code></pre>\n\n<p>S16-box has 65536 elements, so maybe some cache miss will happen. I also use gather instruction like:</p>\n\n<pre><code>inline static __m256i FI( __m256i in, u16 subkey )\n{\n    __m256i _tmp = _mm256_set1_epi32(0xffff);\n    __m256i even_sequence = _mm256_and_si256(in, _tmp);\n    __m256i odd_sequence = _mm256_srli_epi32(in, 16);\n    even_sequence = _mm256_i32gather_epi32((int const*)s16, even_sequence, 2); \n    __m256i _subkey = _mm256_set1_epi16(subkey);\n    even_sequence = _mm256_xor_si256(even_sequence, _subkey);\n    even_sequence = _mm256_and_si256(even_sequence, _tmp);\n    odd_sequence = _mm256_i32gather_epi32((int const*)s16, odd_sequence, 2); \n    odd_sequence = _mm256_xor_si256(odd_sequence, _subkey);\n    odd_sequence = _mm256_and_si256(odd_sequence, _tmp);\n    // rotate\n    __m256i hi = _mm256_slli_epi16(even_sequence, 7); \n    __m256i lo = _mm256_srli_epi16(even_sequence, 9); \n    even_sequence = _mm256_or_si256(hi, lo);\n    //same for odd\n    hi = _mm256_slli_epi16(odd_sequence, 7); \n    lo = _mm256_srli_epi16(odd_sequence, 9); \n    odd_sequence = _mm256_or_si256(hi, lo);\n    even_sequence = _mm256_i32gather_epi32((int const*)s16, even_sequence, 2); \n    odd_sequence = _mm256_i32gather_epi32((int const*)s16, odd_sequence, 2); \n    even_sequence = _mm256_and_si256(even_sequence, _tmp);\n    odd_sequence = _mm256_slli_epi32(odd_sequence, 16);\n    in = _mm256_or_si256(even_sequence, odd_sequence);  \n\n    return in; \n}\n</code></pre>\n\n<p>but the performance cannot meet requirements, I also think about the bit-slice. I read a paper which can make 128 datas parallel but need some hardware support.  i think bit tranpose operation is time-consuming and there are many constraint. </p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["c", "winsock"], "comments": [{"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1502852373, "post_id": 45704139, "comment_id": 78367071, "body": "Are you able to ping to public ip from the machine where you run the client, if yes, you need to check if port where server listens is forwarded in router setting"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502855098, "post_id": 45704139, "comment_id": 78367632, "body": "<code>server.sin_addr.s_addr = inet_addr(&quot;127.0.0.1&quot;); --&gt; server.sin_addr.s_addr = inet_addr(&quot;0.0.0.0&quot;);</code> this makes it bind on all interfaces."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1503681957, "post_id": 45704139, "comment_id": 78732307, "body": "Note; server leaks &#39;newSocket&#39; on each connection."}], "answers": [{"comments": [{"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1502858103, "post_id": 45704801, "comment_id": 78368433, "body": "&quot;Or, you can bind your server to all available network interfaces&quot; - GOLD! Wish I&#39;d known this piece of info earlier, many thanks. :)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1502858295, "post_id": 45704801, "comment_id": 78368500, "body": "@enhzflep is that some sarcasm I am not getting?"}, {"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 2, "creation_date": 1502934021, "post_id": 45704801, "comment_id": 78408301, "body": "nope, it&#39;s the comment that goes along with my upvote. I&#39;d never known that I could bind to 0.0.0.0 before and was thrilled learn. :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8377060"}, "edited": false, "score": 0, "creation_date": 1503694337, "post_id": 45704801, "comment_id": 78737983, "body": "and also, by they way, that still didn&#39;t solve the problem, i put the public ip"}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 15, "last_activity_date": 1502856164, "last_edit_date": 1502856164, "creation_date": 1502855227, "answer_id": 45704801, "question_id": 45704139, "link": "https://stackoverflow.com/questions/45704139/winsock-programming-connecting-to-a-public-ip/45704801#45704801", "title": "Winsock programming connecting to a public ip", "body": "<p>The issue is with your server.  You are binding it to <code>127.0.0.1</code>. This means your server will only bind to the loopback interface, so only clients running on the same machine as the server will be able to connect to the server using this same interface.</p>\n\n<p>If you want your server to accept clients from a public network interface, you have to bind to that interface's IP instead:</p>\n\n<pre><code>server.sin_addr.s_addr = inet_addr(\"&lt;IP belonging to the public interface&gt;\");\n</code></pre>\n\n<p>Or, you can bind your server to all available network interfaces:</p>\n\n<pre><code>server.sin_addr.s_addr = inet_addr(\"0.0.0.0\");\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>server.sin_addr.s_addr = INADDR_ANY;\n</code></pre>\n\n<p>Note that you can only bind to IP(s) that belong to the machine that the server is running on.  If the public IP the client is trying to connect to belongs to a NAT/router, you must bind the server to its local LAN IP that is connected to the NAT/router, and then set up port forwarding on the NAT/router to forward packets from an open port on the NAT/router's public IP to the listening port on the server's LAN IP.  If the NAT/router supports uPNP, your server can setup the port forwarding programmably.  Otherwise, the NAT/router's admin has to setup the forwarding manually.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8377060"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 780, "favorite_count": 2, "accepted_answer_id": 45704801, "answer_count": 1, "score": -19, "last_activity_date": 1503595004, "creation_date": 1502849986, "question_id": 45704139, "link": "https://stackoverflow.com/questions/45704139/winsock-programming-connecting-to-a-public-ip", "title": "Winsock programming connecting to a public ip", "body": "<p>I am trying to connect to my pc publicly from another computer and it returns <code>10060</code> error code from the connect function.</p>\n\n<p>When I <code>bind</code> the server with <code>inet_addr(\"127.0.0.1\")</code> from the local machine \nand connect with a client with that it works.</p>\n\n<p>I have tried to connect with the server's public ip with the same client code down below, it return <code>10060</code> can anyone help?</p>\n\n<p>server</p>\n\n<pre><code>#include&lt;winsock2.h&gt;\n\nint main(){\n    WSADATA ws;\n    SOCKET s, newSocket;\n    struct sockaddr_in server, client;\n    int c;\n\n    if(WSAStartup(MAKEWORD(2,2), &amp;ws) != 0){\n        puts(\"error wsastartup\");\n        printf(\"wsa error at %d\", GetLastError());\n    }\n\n    if((s=socket(AF_INET, SOCK_STREAM, IPPROTO_TCP)) == INVALID_SOCKET){\n\n        printf(\"socket error at %d\", GetLastError());\n    }\n\n    server.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    server.sin_port = htons(8888);\n    server.sin_family = AF_INET;\n\n    if(bind(s, (struct sockaddr*)&amp;server, sizeof(server)) == SOCKET_ERROR){\n        printf(\"socket error at %d\", GetLastError());\n    }else{\n        puts(\"bind done\");\n    }\n\n    listen(s, 3);\n    puts(\"Waiting for incoming connections\");\n\n    c = sizeof(struct sockaddr_in);\n\n    char *message = \"hello client i got ur message\";    \n\n    while((newSocket = accept(s, (struct sockaddr*) &amp;client, &amp;c)) != INVALID_SOCKET){\n        puts(\"connection accepted\");\n        send(newSocket, message, strlen(message), 0);\n    }\n\n    if(newSocket == INVALID_SOCKET){\n        printf(\"accept failed iwth the code %d\", GetLastError());\n        return 1;\n    }\n\n    getchar();\n\n    closesocket(s);\n    WSACleanup();\n    return 0;\n}\n</code></pre>\n\n<p>this is the client</p>\n\n<pre><code>#include &lt;winsock2.h&gt;\n\nint main(){\n\n    WSADATA ws;\n    SOCKET s;\n    struct sockaddr_in server;\n    char *message = \"hello this is a message\";\n\n    if(WSAStartup(MAKEWORD(2,2 ), &amp;ws) != 0){\n        printf(\"wsa error at %d\", GetLastError());\n    }else{\n        puts(\"wsa done\");\n    }\n\n    if((s = socket(AF_INET, SOCK_STREAM, 0)) == INVALID_SOCKET){\n        printf(\"invalid socket at %d\", GetLastError());\n    }\n\n    server.sin_family = AF_INET;\n    server.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    server.sin_port = htons(8888);\n\n    if(connect(s, (struct sockaddr*)&amp;server, sizeof(server)) &lt; 0){\n        printf(\"connection err %d\", GetLastError());\n    }else{\n        puts(\"connected\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "rotation"], "comments": [{"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1502847426, "post_id": 45703833, "comment_id": 78365938, "body": "When you say it is being deformed, is it being deformed after the first rotation, or is it progressively becoming more deformed as you continue to rotate?"}, {"owner": {"reputation": 973, "user_id": 8068739, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1411013638978567/picture?type=large", "display_name": "Theo Walton", "link": "https://stackoverflow.com/users/8068739/theo-walton"}, "reply_to_user": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1502847458, "post_id": 45703833, "comment_id": 78365951, "body": "once it completes a full cycle it goes back to its original position"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1502847657, "post_id": 45703833, "comment_id": 78366010, "body": "If that answer doesn&#39;t describe what you&#39;re seeing, just say so and I&#39;ll delete it."}, {"owner": {"reputation": 973, "user_id": 8068739, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1411013638978567/picture?type=large", "display_name": "Theo Walton", "link": "https://stackoverflow.com/users/8068739/theo-walton"}, "reply_to_user": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1502847975, "post_id": 45703833, "comment_id": 78366084, "body": "I don&#39;t think it is precision loss because the some of the deformations can be quite violent as opposed to a steady loss of form. But your answer is something I didn&#39;t consider so thank you"}, {"owner": {"reputation": 973, "user_id": 8068739, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1411013638978567/picture?type=large", "display_name": "Theo Walton", "link": "https://stackoverflow.com/users/8068739/theo-walton"}, "reply_to_user": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1502848274, "post_id": 45703833, "comment_id": 78366151, "body": "ok I am really stupid I forgot to return after the <code>if (d == 0)</code>"}, {"owner": {"reputation": 973, "user_id": 8068739, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1411013638978567/picture?type=large", "display_name": "Theo Walton", "link": "https://stackoverflow.com/users/8068739/theo-walton"}, "reply_to_user": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1502848335, "post_id": 45703833, "comment_id": 78366163, "body": "changed but still doesn&#39;t work :/"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 2, "creation_date": 1502851449, "post_id": 45703833, "comment_id": 78366873, "body": "arctan(y/x) = arctan((-y)/(-x)), which means a rotation defined that way cannot cover the entire unit circle. What you should do, instead, is use the traditional rotation formula: let <code>c = cos(d)</code> and <code>s = sin(d)</code>, where <code>d</code> is the amount of rotation (in radians in C). Then, <code>x_new = c*x_old - s*y_old</code> and <code>y_new = s*x_old + c*y_old</code>. Note that you must not mix old (unrotated) and new (rotated) coordinates when calculating; the calculations are done on the old coordinates only. Otherwise you get taffy, stretchy results."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502852541, "post_id": 45703833, "comment_id": 78367099, "body": "What is the range of <code>int rot_amount</code> used?"}, {"owner": {"reputation": 973, "user_id": 8068739, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1411013638978567/picture?type=large", "display_name": "Theo Walton", "link": "https://stackoverflow.com/users/8068739/theo-walton"}, "edited": false, "score": 0, "creation_date": 1502852595, "post_id": 45703833, "comment_id": 78367111, "body": "for this just assume its always 1"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502863037, "post_id": 45703833, "comment_id": 78370085, "body": "Which purpose should this server: <code>atan(INFIN)</code>? If you have constant angle, you can just use a constant (<code>M_PI&#47;2</code>) instead of calling a function."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502863312, "post_id": 45703833, "comment_id": 78370190, "body": "Not related to your problem, but you could calculate the length <code>sqrt(d * d + e * e)</code> once in advance and don&#39;t call the function twice. BTW: If you mean <code>y</code> and <code>z</code>, why do you call the variables <code>d</code> and <code>e</code> instead?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502890184, "post_id": 45703833, "comment_id": 78387946, "body": "@Gerhardh Note that <code>M_PI</code> is not available from a compliant std C library.  <code>acos(0)</code> is a substitute that provides a portable <code>\u03c0&#47;2</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502890233, "post_id": 45703833, "comment_id": 78387983, "body": "Simplification: <code>sqrt(d * d + e * e)</code> --&gt; <code>hypot(d,  e)</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502890420, "post_id": 45703833, "comment_id": 78388112, "body": "@chux, the code already uses <code>M_PI &#47; 50</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502891278, "post_id": 45703833, "comment_id": 78388741, "body": "@Gerhardh Fair point."}], "answers": [{"tags": [], "owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "is_accepted": false, "score": 3, "last_activity_date": 1502847627, "creation_date": 1502847627, "answer_id": 45703869, "question_id": 45703833, "link": "https://stackoverflow.com/questions/45703833/i-cant-tell-if-this-rotation-function-is-working-as-expected/45703869#45703869", "title": "I can&#39;t tell if this rotation function is working as expected", "body": "<p>You are experiencing the accumulation of errors in the calculations.  This is caused by the nature of how numbers are represented in computers.</p>\n\n<p>The typical way to handle this problem in computer graphics is to keep the object's coordinates fixed and translate them to the position required for the frame being rendered.  In your case, this would mean that rather than progressively rotating the object, leave the object in its original position and simply calculate the translation to the current angle around the X-axis based on where it should currently be displayed.</p>\n\n<p>In other words, if you are translating 360 degrees total 20 degrees at a time, display the translated coordinates at 20 degrees in the first iteration and the translated coordinates at 40 degrees in the second iteration rather than actually translating 20 degrees each time.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1502891539, "last_edit_date": 1502891539, "creation_date": 1502890798, "answer_id": 45715201, "question_id": 45703833, "link": "https://stackoverflow.com/questions/45703833/i-cant-tell-if-this-rotation-function-is-working-as-expected/45715201#45715201", "title": "I can&#39;t tell if this rotation function is working as expected", "body": "<blockquote>\n  <p>... the shape I am rotating is getting deformed  ...</p>\n</blockquote>\n\n<p><code>atan(e / d)</code> loses the 4 quadrant nature of <code>a-&gt;y, a-&gt;z;</code>.  Consider that with OP's code, if the <code>y,z</code> are negated, the same result ensues. <a href=\"https://stackoverflow.com/questions/45703833/i-cant-tell-if-this-rotation-function-is-working-as-expected?noredirect=1#comment78366873_45703833\">@Nominal Animal</a></p>\n\n<pre><code>    d = -(a-&gt;y);\n    e = -(a-&gt;z);\n    ...\n    atan(e / d)\n</code></pre>\n\n<p>Instead use a 4 quadrant arctangent.  </p>\n\n<blockquote>\n  <p><code>double atan2(double y, double x);</code><br>\n  The <code>atan2</code> functions compute the value of the arc tangent of <code>y</code>/<code>x</code>, using the signs of both arguments to determine the quadrant of the return value. A domain error may occur if both arguments are zero.</p>\n</blockquote>\n\n<p>Other suggested improvements below too.</p>\n\n<pre><code>#include &lt;math.h&gt;\n\nstatic void xrotate_coor(t_coor *a, int rot_amount) {\n  double d = a-&gt;y;\n  double e = a-&gt;z;\n  double r = hypot(d, e);  // vs. sqrt(d * d + e * e)\n\n  if (r) {\n    double angle = atan2(e, d);\n    angle += rot_amount * (M_PI / 50);\n    a-&gt;y = r * cos(angle);\n    a-&gt;z = r * sin(angle);\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 973, "user_id": 8068739, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1411013638978567/picture?type=large", "display_name": "Theo Walton", "link": "https://stackoverflow.com/users/8068739/theo-walton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 45715201, "answer_count": 2, "score": 2, "last_activity_date": 1502891539, "creation_date": 1502847355, "last_edit_date": 1502848373, "question_id": 45703833, "link": "https://stackoverflow.com/questions/45703833/i-cant-tell-if-this-rotation-function-is-working-as-expected", "title": "I can&#39;t tell if this rotation function is working as expected", "body": "<p>So I derived a rotation function like this:</p>\n\n<ul>\n<li><p>I want to rotate (a, b, c) around the x axis</p></li>\n<li><p>the value of <code>a</code> will not change</p></li>\n<li><p>this is equivalent to rotating (b, c) around the origin in a 2d map</p></li>\n<li><p>for a 2d map in polar coordinates, rotating <code>d</code> degrees is as simple as:\n<code>\u03b8 = \u03b8 + d</code></p></li>\n<li><p>for a point P(x, y), <code>x = Rcos(\u03b8)</code> and <code>y = Rsin(\u03b8)</code></p></li>\n<li><p>so let Q be the point after rotation, then <code>Q = (Rcos(\u03b8 + d), Rsin(\u03b8 + d))</code></p></li>\n</ul>\n\n<p>since R<sup>2</sup> = x<sup>2</sup> + y<sup>2</sup> and \u03b8 = arctan(y/x):</p>\n\n<p>Q = (sqrt(x<sup>2</sup> + y<sup>2</sup>) * cos(arctan(y/x) + d, sqrt(x<sup>2</sup> + y<sup>2</sup>) * sin(arctan(y/x) + d)</p>\n\n<p>I then made a C function that given a coordinate: <code>a</code> and <code>rot_amount</code> (usually 1) it would rotate my coordinate for me.</p>\n\n<pre><code>static void     xrotate_coor(t_coor *a, int rot_amount)\n{\n        double d;\n        double e;\n\n        d = a-&gt;y;\n        e = a-&gt;z;\n        if (e == 0 &amp;&amp; d == 0)\n                return ;\n        if (d == 0)\n        {\n                a-&gt;y = sqrt(d * d + e * e) * cos(atan(INFIN) + rot_amount * M_PI / 50);\n                a-&gt;z = sqrt(d * d + e * e) * sin(atan(INFIN) + rot_amount * M_PI / 50);\n                return  ;\n        }\n        a-&gt;y = sqrt(d * d + e * e) * cos(atan(e / d) + rot_amount * M_PI / 50);\n        a-&gt;z = sqrt(d * d + e * e) * sin(atan(e / d) + rot_amount * M_PI / 50);\n}\n</code></pre>\n\n<p>INFIN is a macro I set to 999999.</p>\n\n<p>I am not sure if it is correct though since using this formula the shape I am rotating is getting deformed so I feel like there is a flaw in my logic somewhere...</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1502845226, "post_id": 45703511, "comment_id": 78365426, "body": "If you can&#39;t use <code>scanf</code> how do you plan on getting the input?"}, {"owner": {"reputation": 1, "user_id": 8469731, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210237525670698/picture?type=large", "display_name": "Kristyna Williams", "link": "https://stackoverflow.com/users/8469731/kristyna-williams"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1502845887, "post_id": 45703511, "comment_id": 78365554, "body": "YOU DON&#39;T GET INPUT, YOU JUST CREATE THE VARIABLES AND CHANGE THEM AROUND"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1502846099, "post_id": 45703511, "comment_id": 78365597, "body": "You don&#39;t need to shout, however you do need to work on your question description since it says <code>Need to create a program that reads in a date</code> and your printf asks for input."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1502847714, "post_id": 45703511, "comment_id": 78366027, "body": "Your formula for figuring out if it&#39;s a leap year isn&#39;t really correct.  You may want to check into leap centuries."}, {"owner": {"reputation": 1, "user_id": 8469731, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210237525670698/picture?type=large", "display_name": "Kristyna Williams", "link": "https://stackoverflow.com/users/8469731/kristyna-williams"}, "edited": false, "score": 0, "creation_date": 1502848114, "post_id": 45703511, "comment_id": 78366115, "body": "I wasn&#39;t shouting, my caps lock was on sorry :)"}, {"owner": {"reputation": 1, "user_id": 8469731, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210237525670698/picture?type=large", "display_name": "Kristyna Williams", "link": "https://stackoverflow.com/users/8469731/kristyna-williams"}, "edited": false, "score": 0, "creation_date": 1502848806, "post_id": 45703511, "comment_id": 78366291, "body": "And thanks for pointing the wrong formula out, in fact I have used the leapyear variable instead of the year variable in the brackets"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1502845693, "creation_date": 1502845693, "answer_id": 45703637, "question_id": 45703511, "link": "https://stackoverflow.com/questions/45703511/c-program-that-reads-in-a-date-and-prints-out-the-next-day-date/45703637#45703637", "title": "C program that reads in a date and prints out the next day date", "body": "<p>After you add 1 to the day, check to see if that value is greater than the number of days in that month.  If so, set the day to 1 and add 1 to the month.  Then check if month is greater than 12, and if so set the month to 1 and add 1 to the year.</p>\n\n<p>As for determining the number of days in a month, all months except February have the same number of days whether or not the year is a leap year.  Right now you're checking if the year is a leap year for those other months.  You can leave that check out and just check the month number.</p>\n\n<pre><code>if (month == 12 || month == 1 || month == 3 || month == 5 \n     || month == 7 || month == 8 || month == 10 ) {\n    leapdays = 31;\n}\nif (month == 4 || month == 6 || month == 9 || month == 11) {\n    leapdays = 30;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1502857963, "post_id": 45703998, "comment_id": 78368385, "body": "You should be using functions; you should only test for a leap year if you are dealing with February; you should be using <code>scanf()</code> or similar to read the values to be processed \u2014 at the moment, you have to recompile the program to change the date.  How many days are in December, January, March, May, July, August, October in a non-leapyear?   It seems odd to have the test for leap year in <code>if ((leapyear) &amp;&amp; (month == 12 || month == 1 || month == 3 || month == 5 || month == 7 || month == 8 || month == 10 )) { leapdays = 31; }</code>. Similarly for April, June, September and November?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502858277, "post_id": 45703998, "comment_id": 78368493, "body": "OTOH, if you learn about <code>scanf()</code> next week, maybe you don&#39;t know about functions other than <code>main()</code> \u2026 it will be easier to write readable code when you learn to write functions.  The problems with days in the month are there regardless of whether you use functions or not."}], "tags": [], "owner": {"reputation": 1, "user_id": 8469731, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210237525670698/picture?type=large", "display_name": "Kristyna Williams", "link": "https://stackoverflow.com/users/8469731/kristyna-williams"}, "is_accepted": false, "score": -1, "last_activity_date": 1502848862, "creation_date": 1502848862, "answer_id": 45703998, "question_id": 45703511, "link": "https://stackoverflow.com/questions/45703511/c-program-that-reads-in-a-date-and-prints-out-the-next-day-date/45703998#45703998", "title": "C program that reads in a date and prints out the next day date", "body": "<p>Got it right :) thanks for all the help</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n    int day, month, year, ndays, leapdays;\n    bool leapyear;\n    int main () {\n        day = 31;\n        month = 12;\n        year = 2010;\n        ndays = day + 1;\n        leapyear = false;\n        printf (\"Enter a date in the form day month year: %d %d %d \\n\", day, month, year);\n        if (year % 4 == 0) {\n            leapyear = true;\n        }\n        if (year % 100 == 0) {\n            leapyear = false;\n        }\n        if (year % 400 == 0) {\n            leapyear = true;\n        }\n        if ((leapyear) &amp;&amp; (month == 12 || month == 1 || month == 3 || month == 5 || month == 7 || month == 8 || month == 10 )) {\n            leapdays = 31;\n        }\n        if ((leapyear) &amp;&amp; (month == 4 || month == 6 || month == 9 || month == 11 )) {\n            leapdays = 30;\n        }\n        if ((leapyear) &amp;&amp; (month == 2 )) {\n            leapdays = 29;\n        } else if (leapyear == false) {\n            leapdays = 28;\n        }\n        if ((leapdays == 31) &amp;&amp; (day == 31)) {\n            ndays = 1;\n            month = month + 1;\n        }else if ((leapdays == 30) &amp;&amp; (day == 30)) {\n                    ndays = 1;\n                    month = month + 1;\n\n        }else if ((leapdays == 29) &amp;&amp; (day == 29)) {\n                        ndays = 1;\n                     month = month + 1;\n        }else if ((leapdays == 28) &amp;&amp; (day == 28)) {\n                    ndays = 1;\n                    month = month + 1;\n        }else if ((month == 12) &amp;&amp; (day == 31)) {\n                   ndays = 1;\n                    month = 1;\n                   year = year + 1;\n        }\n\n\n        printf (\"The date of the next day is: %d/%d/%d\", ndays, month, year);\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1502892816, "creation_date": 1502892816, "answer_id": 45715951, "question_id": 45703511, "link": "https://stackoverflow.com/questions/45703511/c-program-that-reads-in-a-date-and-prints-out-the-next-day-date/45715951#45715951", "title": "C program that reads in a date and prints out the next day date", "body": "<p>Consider a different flow.  First find the days per month first, then test if at end of month, and end of year.</p>\n\n<pre><code>  int year, month, day;\n  // set year, month, day in some fashion\n\n  day++;  // tomorrow\n\n  int days_per_month = 31;\n  if (month == 4 || month == 6 || month == 9 || month == 11) {\n    days_per_month = 30;\n  } else if (month == 2) {\n    days_per_month = 28;\n    if (year % 4 == 0) {\n      days_per_month = 29;\n      if (year % 100 == 0) {\n        days_per_month = 28;\n        if (year % 400 == 0) {\n          days_per_month = 29;\n        }\n      }\n    }\n  }\n  if (day &gt; days_per_month) {\n    day = 1;\n    month++;\n    if (month &gt; 12) {\n      month = 1;\n      year++;\n    }\n  }\n</code></pre>\n\n<p>Other improvement would use helper functions, enumerated types and various defines.  Yet this code seems to reflect OP's level.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5791536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1903ffc7c610055218d03998272c31?s=128&d=identicon&r=PG&f=1", "display_name": "phamuc", "link": "https://stackoverflow.com/users/5791536/phamuc"}, "is_accepted": false, "score": 1, "last_activity_date": 1556031405, "creation_date": 1556031405, "answer_id": 55814019, "question_id": 45703511, "link": "https://stackoverflow.com/questions/45703511/c-program-that-reads-in-a-date-and-prints-out-the-next-day-date/55814019#55814019", "title": "C program that reads in a date and prints out the next day date", "body": "<p>Short and simpler. Only check for leap year when needed.</p>\n\n<pre><code>int main()\n{\n   int Iyear, Imonth, Iday;\n\n   Iyear = 2016;\n   Imonth = 4;\n   Iday = 24;\n\n   printf (\"Enter a date in the form day month year: %d %d %d \\n\", Iday, Imonth, Iyear);\n\n   NextDate(&amp;Iyear, &amp;Imonth, &amp;Iday);\n\n   printf (\"The date of the next day is: %d/%d/%d\", Iday, Imonth, Iyear);\n}\n\nvoid NextDate(int *year, int *month, int *day)\n{\n    int daysInMonth[12] = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};\n\n    *day = *day +1;\n    if (( *month == 2 ) &amp;&amp; (*day == 29))\n    {\n        // Leap year checking, if yes, Feb is 29 days.\n        if(*year % 400 == 0 || (*year % 100 != 0 &amp;&amp; *year % 4 == 0))\n        {\n            daysInMonth[1] = 29;\n        }\n    }\n\n    if (*day &gt; daysInMonth[*month -1])\n    {\n        *day = 1;\n        *month = *month +1;\n        if (*month &gt; 12)\n        {\n            *month = 1;\n            *year = *year +1;\n        }\n    }\n}\n</code></pre>\n\n<p></p>\n"}], "owner": {"reputation": 1, "user_id": 8469731, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210237525670698/picture?type=large", "display_name": "Kristyna Williams", "link": "https://stackoverflow.com/users/8469731/kristyna-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17808, "favorite_count": 0, "answer_count": 4, "score": -3, "last_activity_date": 1556031405, "creation_date": 1502844547, "last_edit_date": 1502845449, "question_id": 45703511, "link": "https://stackoverflow.com/questions/45703511/c-program-that-reads-in-a-date-and-prints-out-the-next-day-date", "title": "C program that reads in a date and prints out the next day date", "body": "<p>Hi I have just started learning C language at University. Now I am faced  with a problem I just don't know how to solve. So far we have only used \n library and nothing else, also scanf is a topic we are going to \nlearn next week. For now we just use printf for everything.\nI have learned how to say if a year is a leap year or not, however, my task is the next one: Need to create a program that reads in a date and prints out the next day date with output like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Enter a date in the form day month year: 17 5 2010\nThe date of the next day is: 18/5/2010\n</code></pre>\n\n<p>My dilemma is that I have no idea on what operations to use or how to set the code to make sure that leap year is considered and for example if today's date is 28 2 2010 the next date needs to be 1 3 2010 because it wasn't leap year.\nThe only library used is  and there is no scanf yet (with scanf yet)\nSo far I got this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint day, month, year, ndays, leapdays;\nbool leapyear;\nint main () {\n    day = 28;\n    month = 2;\n    year = 2010;\n    ndays = day + 1;\n    leapdays = 31;\n    leapyear = false;\n    if (leapyear % 4 == 0) {\n        leapyear = true;\n    }\n    if (leapyear % 100 == 0) {\n        leapyear = false;\n    }\n    if (leapyear % 400 == 0) {\n        leapyear = true;\n    }\n    if ((leapyear) &amp;&amp; (month == 12 || month == 1 || month == 3 || month == 5 \n         || month == 7 || month == 8 || month == 10 )) {\n        leapdays = 31;\n    }\n    if ((leapyear) &amp;&amp; (month == 4 || month == 6 || month == 9 || month == 11 \n         )) {\n        leapdays = 30;\n    }\n    if ((leapyear) &amp;&amp; (month == 2 )) {\n        leapdays = 29;\n    } else if ((leapyear == false) &amp;&amp; (month == 2)) {\n        leapdays = 28;\n    }\n    printf (\"Enter a date in the form day month year: %d %d %d \\n\", day, \n             month, year);\n    printf (\"The date of the next day is: %d/%d/%d\", ndays, month, year);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "function", "prototype", "conventions"], "answers": [{"tags": [], "owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "is_accepted": true, "score": 1, "last_activity_date": 1502845370, "last_edit_date": 1502845370, "creation_date": 1502844131, "answer_id": 45703470, "question_id": 45703451, "link": "https://stackoverflow.com/questions/45703451/calling-convention-attribute-on-the-right-of-a-pointer/45703470#45703470", "title": "Calling convention attribute on the right of a pointer", "body": "<p>There are three functions in this declaration:</p>\n\n<ul>\n<li><code>_set_new_handler</code>, the function that is being declared;</li>\n<li>the function pointer that is being returned;</li>\n<li>the function pointer that is taken as a parameter.</li>\n</ul>\n\n<p>The first <code>__cdecl</code> applies to the function pointer that is being returned, the second one to the function that is being declared.</p>\n"}], "owner": {"reputation": 387, "user_id": 3727742, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b4bcccc967d573511341bb51286bb492?s=128&d=identicon&r=PG&f=1", "display_name": "def", "link": "https://stackoverflow.com/users/3727742/def"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 45703470, "answer_count": 1, "score": 0, "last_activity_date": 1502845370, "creation_date": 1502843935, "question_id": 45703451, "link": "https://stackoverflow.com/questions/45703451/calling-convention-attribute-on-the-right-of-a-pointer", "title": "Calling convention attribute on the right of a pointer", "body": "<p>In my compiler's printout of a function prototype looks like this:</p>\n\n<pre><code>   int (__cdecl*__cdecl _set_new_handler(int (__cdecl*)(unsigned int)))(unsigned int)\n</code></pre>\n\n<p>I understand that __cdecl on the left of the asterisk specifies an attribute of a pointee. In this case it is a calling convention of a function to which the given pointer refers. It's akin 'const char *' denotes immutability of a data, pointed to, and not a pointer itself. I wander why is there __cdecl on the right of the same asterisk? Following the above logic it would mean an attribute of a pointer, like 'const char * const' means a constant pointer. But '__cdecl' is applicable only to the functions.</p>\n"}, {"tags": ["c", "pipe"], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1502853785, "creation_date": 1502853785, "answer_id": 45704626, "question_id": 45703410, "link": "https://stackoverflow.com/questions/45703410/parent-process-hangs-after-calling-waitpid/45704626#45704626", "title": "parent process hangs after calling waitpid", "body": "<p>You problem is that in the parent, you carefully close <code>myPipe[0]</code>, and then mysteriously decide to write to it instead of the still open <code>myPipe[1]</code>.  If you error checked your system calls, you'd know that you'd failed to send any data to the child.  As it is, the child is still waiting for the data to arrive, and won't exit, and the parent is waiting for the child that won't exit to exit, so you have a deadlock.</p>\n\n<p>I'm using the error reporting functions from <code>stderr.c</code> and <code>stderr.h</code> \u2014 the code for which is available from GitHub (<a href=\"https://github.com/jleffler/soq/tree/master/src/libsoq\" rel=\"nofollow noreferrer\">https://github.com/jleffler/soq/tree/master/src/libsoq</a>) to report errors (and progress).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include \"stderr.h\"\n\nstatic int myPipe[2];\n\nint main(int argc, char **argv)\n{\n    pid_t pid;\n    int value;\n    int status;\n    err_setarg0(argv[0]);\n    err_setlogopts(ERR_PID|ERR_MICRO);\n\n    if (pipe(myPipe) != 0)\n        err_syserr(\"pipe failed: \");\n\n    // call fork()\n    printf(\"CS201 - Assignment 3 Premium - I. Forgot\\n\");\n    pid = fork();\n    if (pid &lt; 0)\n        err_syserr(\"fork failed: \");\n    else if (pid == 0)\n    {\n        // -- running in child process --\n        int sum = 0;\n        if (close(myPipe[1]) != 0)\n            err_syserr(\"failed to close write end of pipe in child: \");\n\n        for (int i = argc; i &gt; 1; i--)\n        {\n            if (read(myPipe[0], &amp;value, sizeof(value)) != sizeof(value))\n                err_syserr(\"failed to read from parent: \");\n            sum += value;\n        }\n        if (close(myPipe[0]) != 0)\n            err_syserr(\"failed to close read end of pipe in child: \");\n\n        err_remark(\"Exiting: sum = %d\\n\", sum);\n        return sum;\n    }\n    else\n    {\n        // -- running in parent process --\n        int sum = 0;\n        close(myPipe[0]);\n\n        for (int i = argc; i &gt; 1; i--)\n        {\n            value = atoi(argv[i - 1]);\n            err_remark(\"Writing: %d\\n\", value);\n            if (write(myPipe[1], &amp;value, sizeof(value)) != sizeof(value))\n                err_syserr(\"failed to write to child: \");\n        }\n        if (waitpid(pid, &amp;status, 0) != pid)\n            err_syserr(\"failed to wait for child %d: \", pid);\n        sum = status;\n\n        printf(\"sum = %d\\n\", sum);\n        if (WIFEXITED(status))\n            printf(\"exit status: %d\\n\", WEXITSTATUS(status));\n        return 0;\n    }\n}\n</code></pre>\n\n<p>And example output (source code in <code>fp71.c</code>, program <code>fp71</code>):</p>\n\n<pre><code>$ gcc -O3 -g -I./inc -std=c11 -Wall -Wextra -Werror -Wmissing-prototypes \\\n&gt;     -Wstrict-prototypes fp71.c -o fp71 -L./lib -lsoq \n$ fp71 1 2 4 7\nCS201 - Assignment 3 Premium - I. Forgot\nfp71: 2017-08-15 20:11:48.453688 - pid=86097: Writing: 7\nfp71: 2017-08-15 20:11:48.454267 - pid=86097: Writing: 4\nfp71: 2017-08-15 20:11:48.454275 - pid=86097: Writing: 2\nfp71: 2017-08-15 20:11:48.454281 - pid=86097: Writing: 1\nfp71: 2017-08-15 20:11:48.454348 - pid=86098: Exiting: sum = 14\nsum = 3584\nexit status: 14\n$\n</code></pre>\n\n<p>The decimal value 3584 corresponds to hexadecimal 0x0E00.  If you analzye that with <code>WIFEXITED()</code> and <code>WEXITSTATUS</code>, then that is equivalent to <code>14</code>, as you'd expect.  (See also <a href=\"https://stackoverflow.com/questions/179565/exitcodes-bigger-than-255-possible/179652?s=6|0.0000#179652\">Exit values bigger than 255 \u2014 possible?</a>)</p>\n"}], "owner": {"reputation": 117, "user_id": 8419779, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/821b497c875751967147fc97cb814f38?s=128&d=identicon&r=PG&f=1", "display_name": "csStudent", "link": "https://stackoverflow.com/users/8419779/csstudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502853785, "creation_date": 1502843582, "last_edit_date": 1502844845, "question_id": 45703410, "link": "https://stackoverflow.com/questions/45703410/parent-process-hangs-after-calling-waitpid", "title": "parent process hangs after calling waitpid", "body": "<p>When I run this in gdb the parent hangs at waitpid, and I'm not sure why. The parent is supposed to take arguments from argv and send them to the child via a pipe. Then the parent is supposed to receive the sum of the arguments from the child via it's return. Not sure why it's doing this.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/poll.h&gt;\n\nstatic int myPipe[2];\n\nint main(int argc, char **argv)\n{\n    pid_t pid;\n    int value;\n    int status;\n    // set up pipe\n\n    if(pipe(myPipe))\n    {\n        printf(\"pipe error\\n\");\n        return -1;\n    }\n\n    // call fork()\n    printf(\"CS201 - Assignment 3 Premium - I. Forgot\\n\");\n    pid = fork();\n    if (pid == 0) {\n        // -- running in child process --\n        int     sum = 0;\n        close(myPipe[1]);\n\n        for(int i = argc; i &gt; 1; i--)\n        {\n            read(myPipe[0], &amp;value, sizeof(value));\n            sum += value;\n        }\n\n        // Return sum of numbers.\n        return sum;\n        }\n    else {\n        // -- running in parent process --\n        int sum = 0;\n        close(myPipe[0]);\n\nfor(int i = argc; i &gt; 1; i--)\n        {\n            value = atoi(argv[i-1]);\n            write(myPipe[0], &amp;value, sizeof(value));\n        }\n        waitpid(pid, &amp;status, 0);\n        sum = status;\n\n        printf(\"sum = %d\\n\", sum);\n        return 0;\n        }\n</code></pre>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1502842754, "post_id": 45703316, "comment_id": 78364932, "body": "Why not give an example of an input for which your code doesn&#39;t work? For that input, say what output you expect and what your program returns instead."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502842915, "post_id": 45703316, "comment_id": 78364983, "body": "Please research &quot;change&quot; questions. The advice is to work with integers and cents. <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>"}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 1, "creation_date": 1502842999, "post_id": 45703316, "comment_id": 78365002, "body": "A few suggestions: use integers (with all monetary amounts in pennies), you don&#39;t need the final .01 while loop (the remaining amount <i>is</i> the number of pennies); replace the word &quot;amount&quot; throughout by &quot;count&quot;,"}, {"owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "edited": false, "score": 0, "creation_date": 1502843054, "post_id": 45703316, "comment_id": 78365018, "body": "What is cs50.h ? Does it contains definition of get/_float(...) function?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502844330, "post_id": 45703316, "comment_id": 78365249, "body": "Similar code <a href=\"https://codereview.stackexchange.com/q/173091/29485\">Printing values of float and int for a simple calculation</a> recently reviewed."}, {"owner": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "edited": false, "score": 1, "creation_date": 1502844761, "post_id": 45703316, "comment_id": 78365329, "body": "@MCG look at the tag info for <code>cs50</code>. It contains a library that handles certain basic IO tasks, with the theory that it allows the students to concentrate on what is more important. Personally, I think it a bad idea in the sense that in C such details <i>are</i> one of the important things that a student needs to learn."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502849117, "post_id": 45703316, "comment_id": 78366355, "body": "Rather than <code>while (n&#47;.1 &gt;=1);</code>, use <code>while (n &gt;= (0.01 - 0.005));</code> ..."}], "answers": [{"comments": [{"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 193, "user_id": 7994787, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-v4BStZAIkR0/AAAAAAAAAAI/AAAAAAAAAEY/2jX6LZjzeOA/photo.jpg?sz=128", "display_name": "R_C", "link": "https://stackoverflow.com/users/7994787/r-c"}, "edited": false, "score": 0, "creation_date": 1502998367, "post_id": 45704622, "comment_id": 78444481, "body": "Glad I could help!"}, {"owner": {"reputation": 193, "user_id": 7994787, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-v4BStZAIkR0/AAAAAAAAAAI/AAAAAAAAAEY/2jX6LZjzeOA/photo.jpg?sz=128", "display_name": "R_C", "link": "https://stackoverflow.com/users/7994787/r-c"}, "edited": false, "score": 0, "creation_date": 1502999927, "post_id": 45704622, "comment_id": 78445300, "body": "One more thing. It doesn&#39;t seem to accept 4.2   It should be 18 but it returns 22"}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 193, "user_id": 7994787, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-v4BStZAIkR0/AAAAAAAAAAI/AAAAAAAAAEY/2jX6LZjzeOA/photo.jpg?sz=128", "display_name": "R_C", "link": "https://stackoverflow.com/users/7994787/r-c"}, "edited": false, "score": 0, "creation_date": 1502999961, "post_id": 45704622, "comment_id": 78445330, "body": "What do you mean by 4.2? oh."}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 193, "user_id": 7994787, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-v4BStZAIkR0/AAAAAAAAAAI/AAAAAAAAAEY/2jX6LZjzeOA/photo.jpg?sz=128", "display_name": "R_C", "link": "https://stackoverflow.com/users/7994787/r-c"}, "edited": false, "score": 0, "creation_date": 1503000033, "post_id": 45704622, "comment_id": 78445363, "body": "When I run it on my machine, it returns 18. It must be some other bug on your end"}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 193, "user_id": 7994787, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-v4BStZAIkR0/AAAAAAAAAAI/AAAAAAAAAEY/2jX6LZjzeOA/photo.jpg?sz=128", "display_name": "R_C", "link": "https://stackoverflow.com/users/7994787/r-c"}, "edited": false, "score": 0, "creation_date": 1503000765, "post_id": 45704622, "comment_id": 78445725, "body": "No, please make a new question if you have a different problem"}], "tags": [], "owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "is_accepted": true, "score": 2, "last_activity_date": 1502853767, "creation_date": 1502853767, "answer_id": 45704622, "question_id": 45703316, "link": "https://stackoverflow.com/questions/45703316/learning-c-need-some-assistance-with-greedy-cs50-solution/45704622#45704622", "title": "Learning C, need some assistance with &quot;Greedy&quot; CS50 solution", "body": "<p>Since you did not include test cases, I did my own. Here are some of the cases for which your algorithm does not return the correct answer:</p>\n\n<blockquote>\n  <p>.04, .11, .17, .19, .21, .26, .32, etc.</p>\n</blockquote>\n\n<p>These cases all fail when calculating the number of pennies (in the final do-while loop), and they all return one less coin then they should. This is because of error with floating-point numbers. With print statements, I discovered that when the division for the final penny was being calculated, the same thing occurred each time:</p>\n\n<blockquote>\n  <p>n/.01 = 0.99999999</p>\n</blockquote>\n\n<p>This is obviously not intended, as this should be equal to 1, and the final penny should be added to the total. Thus, your code, which works in theory, is broken because of floating-point numbers.</p>\n\n<p>To avoid this, you could do any number of things, such as keeping track of dollars and cents separately as integers, change the condition to be <code>n/.01 &gt;= .9999</code> instead of <code>n/.01 &gt;= 1</code>, treat the amount of money you are doing the calculations on as an integer number of cents, or any other number of things.</p>\n\n<p>Personally, I prefer that last option, treating the amount of money as an integer number of cents. This is easy to do, as all you have to do to convert from dollars to cents is multiply by 100. Thus, the easiest thing to do is to use this same algorithm, except use integers.</p>\n\n<p>Thus, the code would look something like this:</p>\n\n<pre><code>int main(){\n    float n;\n    //code that parses in the amount of money, n now stores that amount\n    int cents = (int)(n * 100);\n    int minimumamountofcoins = 0;\n    if (cents/25 &gt;= 1){\n        while (cents/25 &gt;= 1)\n        {\n            cents -= 25;\n            minimumamountofcoins++;\n        }\n\n    }\n    if (cents/10 &gt;= 1){\n        while (cents/10 &gt;= 1)\n        {\n            cents -= 10;\n            minimumamountofcoins++;\n        }\n    }\n    if(cents/5 &gt;= 1){\n        while (cents/5 &gt;= 1)\n        {\n            cents -= 5;\n            minimumamountofcoins++;\n        }\n    }\n    if (cents/1 &gt;= 1){\n        while (cents/1 &gt;= 1)\n        {\n            cents -= 1;\n            minimumamountofcoins++;\n        }\n    }\n    printf(\"The minimum amount of coins is %d\\n\", minimumamountofcoins);\n}\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 7994787, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-v4BStZAIkR0/AAAAAAAAAAI/AAAAAAAAAEY/2jX6LZjzeOA/photo.jpg?sz=128", "display_name": "R_C", "link": "https://stackoverflow.com/users/7994787/r-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 1, "accepted_answer_id": 45704622, "answer_count": 1, "score": 2, "last_activity_date": 1597675320, "creation_date": 1502842539, "last_edit_date": 1503000543, "question_id": 45703316, "link": "https://stackoverflow.com/questions/45703316/learning-c-need-some-assistance-with-greedy-cs50-solution", "title": "Learning C, need some assistance with &quot;Greedy&quot; CS50 solution", "body": "<p>I am very new to C. I come from a python background. I would like to know where I went wrong with my code.</p>\n\n<p>I am doing the cs50 greedy problem. What is wrong with my code? It works with some numbers but others don't work. I am trying to get an input from the user asking how much change to give back, then calculate the minimum number of coins I can give back using only $.25, $.10, $.05, $.01</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\n\nint main(void)\n{\n    float n;\n    do\n    {\n        n = get_float(\"How much change is owed?\\n\");\n    }\n    while(n == EOF); \n    int minimumamountofcoins = 0;\n    if (n/.25 &gt;=1){\n        do \n        {\n            n -= .25;\n            minimumamountofcoins++;\n        }\n        while (n/.25 &gt;= 1);\n    }\n    if (n/.1 &gt;=1){\n        do\n        {\n            n -= .1;\n            minimumamountofcoins++;\n        }\n        while (n/.1 &gt;=1);\n    }\n    if(n/.05 &gt;=1){\n        do\n        {\n            n -= .05;\n            minimumamountofcoins++;\n        }\n        while (n/.05 &gt;=1);\n    }\n    if (n/.01 &gt;=1){\n        do\n        {\n            n -= .01;\n            minimumamountofcoins++;\n        }\n        while (n/.01 &gt;=1);\n    }\n    printf(\"The minimum amount of coins is %d\\n\", minimumamountofcoins);\n}\n</code></pre>\n\n<p>New code: (works perfectly except when entering 4.2)</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\n\nint main(void)\n{\n    float n;\n    do\n    {\n        n = get_float(\"How much change is owed?\\n\");\n    }\n    while(n == EOF);\n\n    int cents = (int)(n * 100);\n    int minimumamountofcoins = 0;\n    if (cents/25 &gt;= 1){\n        while (cents/25 &gt;= 1)\n        {\n            cents -= 25;\n            minimumamountofcoins++;\n        }\n\n    }\n    if (cents/10 &gt;= 1){\n        while (cents/10 &gt;= 1)\n        {\n            cents -= 10;\n            minimumamountofcoins++;\n        }\n    }\n    if(cents/5 &gt;= 1){\n        while (cents/5 &gt;= 1)\n        {\n            cents -= 5;\n            minimumamountofcoins++;\n        }\n    }\n    if (cents/1 &gt;= 1){\n        while (cents/1 &gt;= 1)\n        {\n            cents -= 1;\n            minimumamountofcoins++;\n        }\n    }\n    printf(\"The minimum amount of coins is %d\\n\", minimumamountofcoins);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "arduino", "arduino-uno", "arduino-ide"], "comments": [{"owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "edited": false, "score": 0, "creation_date": 1502842817, "post_id": 45703261, "comment_id": 78364953, "body": "How do you enter input? What error message do you see?"}, {"owner": {"reputation": 11, "user_id": 8431358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d91defebac845f15e4eae51c56f5a2?s=128&d=identicon&r=PG&f=1", "display_name": "L.Davies", "link": "https://stackoverflow.com/users/8431358/l-davies"}, "reply_to_user": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "edited": false, "score": 0, "creation_date": 1502843490, "post_id": 45703261, "comment_id": 78365097, "body": "I&#39;m using an arduino and the arduino IDE. When I open the serial monitor it asks for the user to input either A, S, M, D, or P. When I enter A currently, it outputs the error message --------ERROR------ that I have in each function, and then asks for the user to input again. If I leave it at 1, 2, 3, 4, 5 it works and then continues to ask the user to enter the first number etc. I want it to take string input, but I have tried this and cannot do it for some reason."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8431358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d91defebac845f15e4eae51c56f5a2?s=128&d=identicon&r=PG&f=1", "display_name": "L.Davies", "link": "https://stackoverflow.com/users/8431358/l-davies"}, "edited": false, "score": 0, "creation_date": 1502889506, "post_id": 45704711, "comment_id": 78387449, "body": "I have changed the Serial.parseInt() to Serial.read() and left the theOperator = dataInput(); as it is because if I change the dataInput() to Serial.read() in the loop or as globally defined it just loops the &quot;Enter your chosen operator&quot; and does not allow me to input. However, if I leave it as dataInput(), I can input the A, S, M, D and P, but when I input the first number afterwards it&#39;s outputting weird values like 1 is 49, and 123 is an -----ERROR----- and adds these two and outputs 98? I am very confused."}, {"owner": {"reputation": 192, "user_id": 8022450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wwcJr.jpg?s=128&g=1", "display_name": "Grifplex", "link": "https://stackoverflow.com/users/8022450/grifplex"}, "reply_to_user": {"reputation": 11, "user_id": 8431358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d91defebac845f15e4eae51c56f5a2?s=128&d=identicon&r=PG&f=1", "display_name": "L.Davies", "link": "https://stackoverflow.com/users/8431358/l-davies"}, "edited": false, "score": 0, "creation_date": 1502906991, "post_id": 45704711, "comment_id": 78398983, "body": "Don&#39;t change data input, just the character read in the loop."}, {"owner": {"reputation": 11, "user_id": 8431358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d91defebac845f15e4eae51c56f5a2?s=128&d=identicon&r=PG&f=1", "display_name": "L.Davies", "link": "https://stackoverflow.com/users/8431358/l-davies"}, "edited": false, "score": 0, "creation_date": 1502909694, "post_id": 45704711, "comment_id": 78400266, "body": "I don&#39;t quite understand what I&#39;m meant to change"}], "tags": [], "owner": {"reputation": 192, "user_id": 8022450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wwcJr.jpg?s=128&g=1", "display_name": "Grifplex", "link": "https://stackoverflow.com/users/8022450/grifplex"}, "is_accepted": false, "score": 0, "last_activity_date": 1502854485, "creation_date": 1502854485, "answer_id": 45704711, "question_id": 45703261, "link": "https://stackoverflow.com/questions/45703261/inputting-a-single-string-char-into-serial-monitor/45704711#45704711", "title": "Inputting a single String/Char into Serial Monitor", "body": "<p>In your <code>char dataInput()</code> function you are taking the serial input with <code>Serial.parseInt()</code> which when inputting 'A' parseInt will return 0. See the <a href=\"https://www.arduino.cc/en/Reference/ParseInt\" rel=\"nofollow noreferrer\">documentation</a>. In order to read a char use <code>Serial.read()</code> to get a single character.</p>\n\n<pre><code>void loop() {\n\n  Serial.println (\"Enter your chosen operator\");\n  Serial.println (\"A for Addition, S for Subtraction, M for Multiplication,\");\n  Serial.println (\"D for Division, and P for Potentiometer: \");\n\n  // Takes an input from the user\n  char theOperator = Serial.read();\n\n  switch(theOperator) {\n    case 'A':\n    // If input is equal to 1, carry out function 'addition()'\n      addition();\n      break;\n    case 'S':\n    // If input is equal to 2, carry out function 'subtraction()'\n      subtraction();\n      break;\n    case 'M':\n    // If input is equal to 3, carry out function 'multiplication()'\n      multiplication();\n      break;\n    case 'D':\n    // If input is equal to 4, carry out function 'division()'\n      division();\n      break;\n  case 'P':\n    // If input is equal to 5, carry out function 'potentiometer()'\n    potentiometer();\n    break;\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8431358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d91defebac845f15e4eae51c56f5a2?s=128&d=identicon&r=PG&f=1", "display_name": "L.Davies", "link": "https://stackoverflow.com/users/8431358/l-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502854485, "creation_date": 1502842155, "question_id": 45703261, "link": "https://stackoverflow.com/questions/45703261/inputting-a-single-string-char-into-serial-monitor", "title": "Inputting a single String/Char into Serial Monitor", "body": "<p>I'm having issues with inputting a string/character into the serial monitor, and I'm a beginner at programming therefore I don't know how to solve it.</p>\n\n<p>I have an if/else statement which works like a switch case statement. I did begin with a switch case but I was developing a lot of problems with it, one being inputting a string/character (A, S, M, D, P) to point to each case. I know a switch case is for ints so I gave up and moved on to multiple if/else statements.</p>\n\n<p>I have tried (in void loop()),</p>\n\n<pre><code>char theOperator = dataInput();\n\nif (theOperator == 'A') {\n  // If input is equal to 1, carry out function 'addition()'\n  addition();\n}\n</code></pre>\n\n<p>but it displays the error message I have in the 'addition' function. </p>\n\n<p>Here is where the code for the input is used (globally defined),</p>\n\n<pre><code>char theOperator;\n\nchar dataInput() {\n  while (!Serial.available()) {\n    // Wait for the user to enter value\n  }\n  return Serial.parseInt();\n}\n</code></pre>\n\n<p>I have tried similar things like Serial.read(), but this either loops the start of my program and does not allow me to input a value, or it just won't take the value at all.</p>\n\n<p>Any help would be appreciated, I will post my full code below so that you might understand my program (the issue of the if/else etc is at the top).</p>\n\n<p>*EDIT: Forgot to mention, I can do something like,</p>\n\n<pre><code>char theOperator = dataInput();\n\n  if (theOperator == 1) {\n    // If input is equal to 1, carry out function 'addition()'\n    addition();\n  }\n</code></pre>\n\n<p>And this works. However I want it to take A, S, M, D, or P instead of 1, 2, 3, 4, 5. </p>\n\n<pre><code>#define LED_RED 5\n#define LED_ORANGE 6\n#define LED_YELLOW 9\n#define LED_GREEN 10\n#define LED_BLUE 11\n\nint potValue;\n\n#define potPin A0\n\n// Limits the range of the numbers entered to between -99 and 999\nlong firstNumber = constrain(firstNumber, -99, 999);\nlong secondNumber = constrain(secondNumber, -99, 999);\nlong value;\n\nchar theOperator;\n\nchar dataInput() {\n  while (!Serial.available()) {\n    // Wait for the user to enter value\n  }\n  return Serial.parseInt();\n}\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\nvoid setup() {\n\n  Serial.begin(9600);\n\n  pinMode(LED_RED, OUTPUT);\n  pinMode(LED_ORANGE, OUTPUT);\n  pinMode(LED_YELLOW, OUTPUT);\n  pinMode(LED_GREEN, OUTPUT);\n  pinMode(LED_BLUE, OUTPUT);\n\n  pinMode(potPin, INPUT);\n}\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\nvoid loop() {\n\n  Serial.println (\"Enter your chosen operator\");\n  Serial.println (\"A for Addition, S for Subtraction, M for Multiplication,\");\n  Serial.println (\"D for Division, and P for Potentiometer: \");\n\n  // Takes an input from the user\n  char theOperator = dataInput();\n\n  if (theOperator == 'A') {\n    // If input is equal to 1, carry out function 'addition()'\n    addition();\n  }\n  else if (theOperator == 'S') {\n    // If input is equal to 2, carry out function 'subtraction()'\n    subtraction();\n  }\n  else if (theOperator == 'M') {\n    // If input is equal to 3, carry out function 'multiplication()'\n    multiplication();\n  }\n  else if (theOperator == 'D') {\n    // If input is equal to 4, carry out function 'division()'\n    division();\n  }\n  else if (theOperator == 'P') {\n    // If input is equal to 5, carry out function 'potentiometer()'\n    potentiometer();\n  }\n}\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\nvoid addition() {\n\n  Serial.println (\"A\");\n  Serial.println (\"Please enter first number in format nnn: \");\n  firstNumber = dataInput(); // Asks the user to input the first set of numbers\n\n  /* Message must be in format cnnnnnn\n     therefore first number must be greater than or equal to -99 and less than or equal to 999*/\n  if (firstNumber &gt;= -99 &amp;&amp; firstNumber &lt;= 999) {\n    Serial.println (firstNumber); // Prints the first set of numbers for the user to view\n  }\n  else {\n    /* If the data input does not match the format cnnnnnn then this error message will display\n       if the input is invalid the red LED will also turn on */\n    digitalWrite(LED_RED, HIGH);\n    Serial.println (\"--------------- ERROR ---------------\");\n  }\n\n  Serial.println (\"Please enter second number in format nnn: \");\n  secondNumber = dataInput(); // Asks the user to input the second set of numbers\n\n  /* Message must be in format cnnnnnn\n     therefore second number must be greater than or equal to -99 and less than or equal to 999*/\n  if (secondNumber &gt;= -99 &amp;&amp; secondNumber &lt;= 999) {\n    // The LED will turn off if it was previously on because this is a valid input\n    digitalWrite(LED_RED, LOW);\n    Serial.println (secondNumber); // Prints the second set of numbers for the user to view\n  }\n  else {\n    digitalWrite(LED_RED, HIGH);\n    Serial.println (\"--------------- ERROR ---------------\");\n  }\n\n  /* Give time for the red error LED to stay on\n     for the user to notice he/she has made an invalid input */\n  delay(500);\n  digitalWrite(LED_RED, LOW);\n\n  // As this case is for addition, it will add the first and second numbers\n  value = (firstNumber + secondNumber);\n\n  Serial.print(\"Value: \");\n  // Prints the value of the two sets of numbers so that the user can see the value of their message\n  Serial.println(value);\n\n  /////// The 'sign' flag ///////\n  if (value &gt;= 1) {\n    // If value is a positive number (excluding 0) turn orange LED on\n    digitalWrite(LED_ORANGE, HIGH);\n  }\n  else if (value &lt;= -1) {\n    // If value is a negative number, turn orange LED off\n    digitalWrite(LED_ORANGE, LOW);\n  }\n  else if (value == 0) {\n    // If value is equal to 0, set orange LED at half brightness\n    int brightness;\n    // Changes the brightness of the LED so that it is half bright\n    brightness++;\n    brightness %= 128;\n    analogWrite(LED_ORANGE, brightness);\n  }\n\n  /////// The 'even' flag ///////\n  if ((value % 2) == 0) {\n    // If the modulo is equal to 0, it's an even\n    digitalWrite(LED_BLUE, HIGH);\n  } else {\n    // If the modulo is not equal to 0, it's an odd\n    digitalWrite(LED_BLUE, LOW);\n  }\n}\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\nvoid subtraction() {\n\n  Serial.println (\"S\");\n  Serial.println (\"Please enter the first number in format nnn: \");\n  firstNumber = dataInput();\n\n  /* Message must be in format cnnnnnn\n     therefore first number must be greater than or equal to -99 and less than or equal to 999*/\n  if (firstNumber &gt;= -99 &amp;&amp; firstNumber &lt;= 999) {\n    Serial.println (firstNumber); // Prints the first set of numbers for the user to view\n  }\n  else {\n    /* If the data input does not match the format cnnnnnn then this error message will display\n       if the input is invalid the red LED will also turn on */\n    digitalWrite(LED_RED, HIGH);\n    Serial.println (\"--------------- ERROR ---------------\");\n  }\n\n  Serial.println (\"Please enter second number in format nnn: \");\n  secondNumber = dataInput();\n\n  /* Message must be in format cnnnnnn\n     therefore second number must be greater than or equal to -99 and less than or equal to 999*/\n  if (secondNumber &gt;= -99 &amp;&amp; secondNumber &lt;= 999) {\n    digitalWrite(LED_RED, LOW);\n    Serial.println (secondNumber); // Prints the second set of numbers for the user to view\n  }\n  else {\n    digitalWrite(LED_RED, HIGH);\n    Serial.println (\"--------------- ERROR ---------------\");\n  }\n\n  /* Give time for the red error LED to stay on\n     for the user to notice he/she has made an invalid input */\n  delay(500);\n  digitalWrite(LED_RED, LOW);\n\n  // As this case is for subtraction, it will subtract the first and second numbers\n  value = (firstNumber - secondNumber);\n  Serial.print(\"Value: \");\n  // Prints the value of the two sets of numbers so that the user can see the value of their message\n  Serial.println(value);\n\n  /////// The 'sign' flag ///////\n  if (value &gt;= 1) {\n    // If value is a positive number (excluding 0) turn orange LED on\n    digitalWrite(LED_ORANGE, HIGH);\n  }\n  else if (value &lt;= -1) {\n    // If value is a negative number, turn orange LED off\n    digitalWrite(LED_ORANGE, LOW);\n  }\n  else if (value == 0) {\n    // If value is equal to 0, set orange LED at half brightness\n    int brightness;\n    // Changes the brightness of the LED so that it is half bright\n    brightness++;\n    brightness %= 128;\n    analogWrite(LED_ORANGE, brightness);\n  }\n\n  /////// The 'even' flag ///////\n  if ((value % 2) == 0) {\n    // If the modulo is equal to 0, it's an even\n    digitalWrite(LED_BLUE, HIGH);\n  } else {\n    // If the modulo is not equal to 0, it's an odd\n    digitalWrite(LED_BLUE, LOW);\n  }\n}\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\nvoid multiplication() {\n\n  Serial.println (\"M\");\n  Serial.println (\"Please enter the first number in format nnn: \");\n  firstNumber = dataInput();\n\n  /* Message must be in format cnnnnnn\n     therefore first number must be greater than or equal to -99 and less than or equal to 999*/\n  if (firstNumber &gt;= -99 &amp;&amp; firstNumber &lt;= 999) {\n    Serial.println (firstNumber); // Prints the first set of numbers for the user to view\n  }\n  else {\n    /* If the data input does not match the format cnnnnnn then this error message will display\n       if the input is invalid the red LED will also turn on */\n    digitalWrite(LED_RED, HIGH);\n    Serial.println (\"--------------- ERROR ---------------\");\n  }\n\n  Serial.println (\"Please enter second number in format nnn: \");\n  secondNumber = dataInput();\n\n  /* Message must be in format cnnnnnn\n     therefore second number must be greater than or equal to -99 and less than or equal to 999*/\n  if (secondNumber &gt;= -99 &amp;&amp; secondNumber &lt;= 999) {\n    digitalWrite(LED_RED, LOW);\n    Serial.println (secondNumber); // Prints the second set of numbers for the user to view\n  }\n  else {\n    digitalWrite(LED_RED, HIGH);\n    Serial.println (\"--------------- ERROR ---------------\");\n  }\n\n  /* Give time for the red error LED to stay on\n     for the user to notice he/she has made an invalid input */\n  delay(500);\n  digitalWrite(LED_RED, LOW);\n\n  // As this case is for multiplication, it will multiply the first and second numbers\n  value = (firstNumber * secondNumber);\n  Serial.print(\"Value: \");\n  // Prints the value of the two sets of numbers so that the user can see the value of their message\n  Serial.println(value);\n\n  /////// The 'sign' flag ///////\n  if (value &gt;= 1) {\n    // If value is a positive number (excluding 0) turn orange LED on\n    digitalWrite(LED_ORANGE, HIGH);\n  }\n  else if (value &lt;= -1) {\n    // If value is a negative number, turn orange LED off\n    digitalWrite(LED_ORANGE, LOW);\n  }\n  else if (value == 0) {\n    // If value is equal to 0, set orange LED at half brightness\n    int brightness;\n    // Changes the brightness of the LED so that it is half bright\n    brightness++;\n    brightness %= 128;\n    analogWrite(LED_ORANGE, brightness);\n  }\n\n  /////// The 'even' flag ///////\n  if ((value % 2) == 0) {\n    // If the modulo is equal to 0, it's an even\n    digitalWrite(LED_BLUE, HIGH);\n  } else {\n    // If the modulo is not equal to 0, it's an odd\n    digitalWrite(LED_BLUE, LOW);\n  }\n}\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\nvoid division() {\n\n  Serial.println (\"D\");\n  Serial.println (\"Please enter the first number in format nnn: \");\n  firstNumber = dataInput();\n\n  /* Message must be in format cnnnnnn\n     therefore first number must be greater than or equal to -99 and less than or equal to 999\n     Division by 0 is not allowed */\n  if (firstNumber &gt;= -99 &amp;&amp; firstNumber &lt;= 999 &amp;&amp; firstNumber != 0) {\n    Serial.println (firstNumber); // Prints the first set of numbers for the user to view\n  }\n  else if (firstNumber == 0) {\n    /* If the data input does not match the format cnnnnnn or if the input is\n       equal to 0 then this error message will display, and if the input is invalid\n       the red LED will also turn on, or if the input equals to 0 the LED will flash\n       and stay on at half brightness */\n    blinkError();\n    Serial.println (\"--------------- ERROR ---------------\");\n  }\n  else {\n    digitalWrite(LED_RED, HIGH);\n  }\n\n  Serial.println (\"Please enter second number in format nnn: \");\n  secondNumber = dataInput();\n\n  /* Message must be in format cnnnnnn\n     therefore second number must be greater than or equal to -99 and less than or equal to 999\n     Division by 0 is not allowed */\n  if (secondNumber &gt;= -99 &amp;&amp; secondNumber &lt;= 999 &amp;&amp; secondNumber != 0) {\n    digitalWrite(LED_RED, LOW);\n    Serial.println (secondNumber); // Prints the second set of numbers for the user to view\n  }\n  else if (secondNumber == 0) {\n    blinkError();\n    Serial.println (\"--------------- ERROR ---------------\");\n  }\n  else {\n    digitalWrite(LED_RED, HIGH);\n    Serial.println (\"--------------- ERROR ---------------\");\n  }\n\n  /* Give time for the red error LED to stay on\n     for the user to notice he/she has made an invalid input */\n  delay(500);\n  digitalWrite(LED_RED, LOW);\n\n  // As this case is for division, it will divide the first and second numbers\n  value = (firstNumber / secondNumber);\n  Serial.print(\"Value: \");\n  // Prints the value of the two sets of numbers so that the user can see the value of their message\n  Serial.println(value);\n\n  /////// The 'sign' flag ///////\n  if (value &gt;= 1) {\n    // If value is a positive number (excluding 0) turn orange LED on\n    digitalWrite(LED_ORANGE, HIGH);\n  }\n  else if (value &lt;= -1) {\n    // If value is a negative number, turn orange LED off\n    digitalWrite(LED_ORANGE, LOW);\n  }\n  else if (value == 0) {\n    // If value is equal to 0, set orange LED at half brightness\n    int brightness;\n    // Changes the brightness of the LED so that it is half bright\n    brightness++;\n    brightness %= 128;\n    analogWrite(LED_ORANGE, brightness);\n  }\n\n  /////// The 'even' flag ///////\n  if ((value % 2) == 0) {\n    // If the modulo is equal to 0, it's an even\n    digitalWrite(LED_BLUE, HIGH);\n  } else {\n    // If the modulo is not equal to 0, it's an odd\n    digitalWrite(LED_BLUE, LOW);\n  }\n}\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\nvoid potentiometer() {\n\n  Serial.println(\"P\");\n\n  do {\n    if (potValue &gt;= 0 &amp;&amp; potValue &lt;= 6) {\n      /* If the value on the potentiometer is greater than or equal to 0,\n         or less than or equal to 6, the red LED will turn on */\n\n      potValue = analogRead(potPin); // Reads the value on the pin\n      potValue = map(potValue, 0, 1023, 0, 31); // Changes the default range from 0 to 1023 to 0 to 31\n\n      // Converts the DEC value of the potentiometer to BIN\n      Serial.println(potValue, BIN);\n      delay(500);\n\n      digitalWrite(LED_RED, HIGH);\n      digitalWrite(LED_ORANGE, LOW);\n      digitalWrite(LED_YELLOW, LOW);\n      digitalWrite(LED_GREEN, LOW);\n      digitalWrite(LED_BLUE, LOW);\n    }\n    else if (potValue &gt;= 7 &amp;&amp; potValue &lt;= 12) {\n      /* If the value on the potentiometer is greater than or equal to 3,\n         or less than or equal to 12, the orange LED will turn on */\n\n      potValue = analogRead(potPin); // Reads the value on the pin\n      potValue = map(potValue, 0, 1023, 0, 31); // Changes the default range from 0 to 1023 to 0 to 31\n\n      Serial.println(potValue, BIN);\n      delay(500);\n\n      digitalWrite(LED_RED, LOW);\n      digitalWrite(LED_ORANGE, HIGH);\n      digitalWrite(LED_YELLOW, LOW);\n      digitalWrite(LED_GREEN, LOW);\n      digitalWrite(LED_BLUE, LOW);\n    }\n    else if (potValue &gt;= 13 &amp;&amp; potValue &lt;= 18) {\n      /* If the value on the potentiometer is greater than or equal to 13,\n         or less than or equal to 18, the yellow LED will turn on */\n\n      potValue = analogRead(potPin); // Reads the value on the pin\n      potValue = map(potValue, 0, 1023, 0, 31); // Changes the default range from 0 to 1023 to 0 to 31\n\n      Serial.println(potValue, BIN);\n      delay(500);\n\n      digitalWrite(LED_RED, LOW);\n      digitalWrite(LED_ORANGE, LOW);\n      digitalWrite(LED_YELLOW, HIGH);\n      digitalWrite(LED_GREEN, LOW);\n      digitalWrite(LED_BLUE, LOW);\n    }\n    else if (potValue &gt;= 19 &amp;&amp; potValue &lt;= 24) {\n      /* If the value on the potentiometer is greater than or equal to 19,\n         or less than or equal to 24, the green LED will turn on */\n\n      potValue = analogRead(potPin); // Reads the value on the pin\n      potValue = map(potValue, 0, 1023, 0, 31); // Changes the default range from 0 to 1023 to 0 to 31\n\n      Serial.println(potValue, BIN);\n      delay(500);\n\n      digitalWrite(LED_RED, LOW);\n      digitalWrite(LED_ORANGE, LOW);\n      digitalWrite(LED_YELLOW, LOW);\n      digitalWrite(LED_GREEN, HIGH);\n      digitalWrite(LED_BLUE, LOW);\n    }\n    else if (potValue &gt;= 25 &amp;&amp; potValue &lt;= 31) {\n      /*If the value on the potentiometer is greater than or equal to 25,\n        or less than or equal to 31, the blue LED will turn on */\n\n      potValue = analogRead(potPin); // Reads the value on the pin\n      potValue = map(potValue, 0, 1023, 0, 31); // Changes the default range from 0 to 1023 to 0 to 31\n\n      Serial.println(potValue, BIN);\n      delay(500);\n\n      digitalWrite(LED_RED, LOW);\n      digitalWrite(LED_ORANGE, LOW);\n      digitalWrite(LED_YELLOW, LOW);\n      digitalWrite(LED_GREEN, LOW);\n      digitalWrite(LED_BLUE, HIGH);\n    }\n  } while (true);\n}\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\nvoid blinkError() {\n\n  /////// The 'error' flag ///////\n\n  int brightness = 0;\n\n  // The for loop will loop 5 times\n  for (int x = 0; x &lt; 5; x++) {\n\n    digitalWrite(LED_RED, HIGH);\n    delay(100);\n    digitalWrite(LED_RED, LOW);\n    delay(100);\n\n    // Changes the brightness of the LED so that it is half bright\n    brightness++;\n    brightness %= 128;\n    analogWrite(LED_RED, brightness);\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "compiler-construction", "bison", "flex-lexer"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 7867026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zGAGU.jpg?s=128&g=1", "display_name": "omn_1", "link": "https://stackoverflow.com/users/7867026/omn-1"}, "edited": false, "score": 0, "creation_date": 1502842551, "post_id": 45703292, "comment_id": 78364883, "body": "Is there a better way to print the error line number like the gcc or clang compiler does?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 273, "user_id": 7867026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zGAGU.jpg?s=128&g=1", "display_name": "omn_1", "link": "https://stackoverflow.com/users/7867026/omn-1"}, "edited": false, "score": 0, "creation_date": 1502842741, "post_id": 45703292, "comment_id": 78364929, "body": "@omn_1 I do not use them. Please post in the question what you would expect the compiler&#39;s report to be."}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "reply_to_user": {"reputation": 273, "user_id": 7867026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zGAGU.jpg?s=128&g=1", "display_name": "omn_1", "link": "https://stackoverflow.com/users/7867026/omn-1"}, "edited": false, "score": 1, "creation_date": 1502843470, "post_id": 45703292, "comment_id": 78365092, "body": "@omn_1: gcc uses a hand-built lexer, which makes this easier than it is in lex, but the technique is straightforward: tag each lexeme with its source line (and/or additional re-locating information). Then, when there is an error, during error recovery, use the saved information to print a more interesting line than &quot;the current line&quot;."}, {"owner": {"reputation": 273, "user_id": 7867026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zGAGU.jpg?s=128&g=1", "display_name": "omn_1", "link": "https://stackoverflow.com/users/7867026/omn-1"}, "edited": false, "score": 0, "creation_date": 1502883242, "post_id": 45703292, "comment_id": 78382777, "body": "@WeatherVane i would like to have instead of lines 6 and 7 , 2 and 6."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1502842372, "creation_date": 1502842372, "answer_id": 45703292, "question_id": 45702875, "link": "https://stackoverflow.com/questions/45702875/yylineno-giving-unexpected-results-for-error-report/45703292#45703292", "title": "yylineno giving unexpected results for error report", "body": "<p>In the C code example the line numbers of the errors are correct. There is no requirement for the missing <code>;</code> after <code>int a</code> on line 2 to be on that line and not on, say, line 4, 5, or even line 6 as <code>;int o</code>.</p>\n\n<p>The <code>int o</code> on line 6 also has a missing <code>;</code> which is only revealed when <code>}</code> is met on line 7.</p>\n\n<p>Neither of those missing <code>;</code> is required to be on the same line as its definition, so the first line number where it <em>might</em> have appeared is not reported. Instead the last line number where it <em>must</em> have appeared is reported.</p>\n\n<p>Your example pasted into a MSVC program reports the same pattern of line numbers for the errors.</p>\n"}], "owner": {"reputation": 273, "user_id": 7867026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zGAGU.jpg?s=128&g=1", "display_name": "omn_1", "link": "https://stackoverflow.com/users/7867026/omn-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 1, "accepted_answer_id": 45703292, "answer_count": 1, "score": 0, "last_activity_date": 1502882429, "creation_date": 1502838885, "last_edit_date": 1502882429, "question_id": 45702875, "link": "https://stackoverflow.com/questions/45702875/yylineno-giving-unexpected-results-for-error-report", "title": "yylineno giving unexpected results for error report", "body": "<p>I am trying to understand the basic concepts of creating a compiler. I've tried to write one very basic c compiler and I encountered some problems. When I am trying to print where a syntax error has occurred with the variable yylineno, I get some of the line numbers wrong. Does anyone know why? I've searched the internet but I can't find a clear answer ,thanks.</p>\n\n<p>comp.l file:</p>\n\n<pre><code>%{\n#include &lt;stdio.h&gt;    \n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\nextern int yylineno;\nextern FILE* yyin;\n//extern char* yytext;\nvoid yyerror(char *s);\n\n\n%}\n\n\n%union {char* var;} \n\n%token INT FLOAT CHAR DOUBLE VOID\n%token FOR WHILE \n%token IF ELSE PRINTF \n%token STRUCT \n%token NUM \n%token INCLUDE\n%token DOT\n%token &lt;var&gt; ID\n%right '='\n%left AND OR\n%left '&lt;' '&gt;' LE GE EQ NE LT GT\n%error-verbose\n\n%%\n\nstart:  Function \n    | Declaration\n    ;\n\n/* Declaration block */\nDeclaration: Type Assignment ';' \n    | Assignment ';'    \n    | FunctionCall ';'  \n    | ArrayUsage ';'    \n    | Type ArrayUsage ';'   \n    | StructStmt ';'    \n    | Arg ';'\n    | error {yyerrok;}\n    ;\n\n/* Assignment block */\nAssignment: ID '=' Assignment \n    | ID '=' FunctionCall   \n    | ID '=' ArrayUsage     \n    | ArrayUsage '=' Assignment\n    | ID ',' Assignment   \n    | NUM ',' Assignment\n    | ID '+' Assignment    \n    | ID '-' Assignment    \n    | ID '*' Assignment     \n    | ID '/' Assignment     \n    | NUM '+' Assignment   \n    | NUM '-' Assignment\n    | NUM '*' Assignment\n    | NUM '/' Assignment\n    | '\\'' Assignment '\\''  \n    | '(' Assignment ')'\n    | '-' '(' Assignment ')'\n    | '-' NUM\n    | '-' ID  \n    |   NUM\n    |   ID  \n    ;\n\n/* Function Call Block */\nFunctionCall : ID'('')'\n    | ID'('Assignment')'\n    ;\n\n/* Array Usage */\nArrayUsage : ID'['Assignment']'  \n    | ID'['error ']' {yyerrok;}\n    ;\n\n/* Function block */\nFunction: Type ID '(' ArgListOpt ')' CompoundStmt  \n\nArgListOpt: ArgList\n    |\n    ;\n\nArgList:  ArgList ',' Arg\n    | Arg\n    ;\n\nArg:    Type ID\n    ;\n\nCompoundStmt:   CompoundStmt '{' StmtList '}'\n    |  '{' StmtList '}'\n    | '{' StmtList {yyerror(\"Missing '}'\"); YYERROR;}\n    |  StmtList '}' {yyerror(\"Missing '{'\"); YYERROR;}\n    ;\n\nStmtList:   StmtList Stmt\n    |\n    ;\n\nStmt: WhileStmt\n    | Declaration\n    | ForStmt\n    | IfStmt\n    | PrintFunc\n    | ';'\n    ;\n\n/* Type Identifier block */\nType: INT \n    | FLOAT\n    | CHAR\n    | DOUBLE\n    | VOID \n    ;\n\n/* Loop Blocks */ \nWhileStmt: WHILE '(' Expr ')' Stmt  \n    | WHILE '(' Expr ')' CompoundStmt \n    ;\n\n/* For Block */\nForStmt: FOR '(' Expr ';' Expr ';' Expr ')' Stmt \n       | FOR '(' Expr ';' Expr ';' Expr ')' CompoundStmt \n       | FOR '(' Expr ')' Stmt \n       | FOR '(' Expr ')' CompoundStmt \n    ;\n\n/* IfStmt Block */\nIfStmt : IF '(' Expr ')' Stmt \n    ;\n\n/* Struct Statement */\nStructStmt : STRUCT ID '{' Type Assignment '}'  \n    ;\n\n/* Print Function */\nPrintFunc : PRINTF '(' Expr ')' ';'\n    ;\n\n/*Expression Block*/\nExpr:   \n    | Expr LE Expr \n    | Expr GE Expr\n    | Expr NE Expr\n    | Expr EQ Expr\n    | Expr GT Expr\n    | Expr LT Expr\n    | Assignment\n    | ArrayUsage\n    ;\n\n%%\n\nint count = 0;\n\n\n\n\n\n\n\nint main() {\n\n    int i;\n\n    for(i=0; i&lt;100; i++) {\n\n        variables[i] = \" \";\n\n     }\n\n    yyin = stdin;\n\n    do { \n\n        yyparse();\n\n    } while(!feof(yyin));\n\n    return 0;\n}\n\n\n\n\n\nvoid yyerror(char* s) {\n\n\n\n\n    printf(\"Error : %s  at line %d \\n\", s, yylineno);\n\n}   \n</code></pre>\n\n<p>comp.y file:</p>\n\n<pre><code>alpha [a-zA-Z]\ndigit [0-9]\n\n%{\n#include \"y.tab.h\"\n#include &lt;stdio.h&gt;\n\nint line_n = 1;\n\n%}\n\n%option  nodefault yylineno\n\n\n\n%%\n\n\n[\\t\\n]+                      {;}\n\"int\"                        {return INT;}\n\"float\"                      {return FLOAT;}\n\"char\"                       { return CHAR;}\n\"void\"                       {return VOID;}\n\"double\"                     {return DOUBLE;}\n\"for\"                        {return FOR;}\n\"while\"                      {return WHILE;}\n\"if\"                         {return IF;}\n\"else\"                       {return ELSE;}\n\"printf\"                     {return PRINTF;}\n\"struct\"                     {return STRUCT;}\n^\"#include \".+               {;}\n{digit}+                     {return NUM;}\n{alpha}({alpha}|{digit})*    {yylval.var = strdup(yytext);return ID;}\n\"&lt;=\"                         {return LE;}\n\"&gt;=\"                         {return GE;}\n\"==\"                         {return EQ;}\n\"!=\"                         {return NE;}\n\"&gt;\"                          {return GT;}\n\"&lt;\"                          {return LT;}\n\".\"                          {return DOT;}\n\\/\\/.*                       {;}\n\\/\\*(.*\\n)*.*\\*\\/            {;}\n[ \\t\\r\\n]+                   {;}\n.                            {return *yytext;}\n\n\n%%\n\n\n\nint yywrap (void) {return 1;}\n</code></pre>\n\n<p>For example, when i try to check to following code:</p>\n\n<pre><code>1.int main(){\n2.   int a\n3.\n4. \n5. \n6.   int o \n7.}\n</code></pre>\n\n<p>I get :</p>\n\n<p><strong>Error : syntax error, unexpected INT, expecting ';'  at line 6</strong> </p>\n\n<p><strong>Error : syntax error, unexpected '}', expecting ';'  at line 7</strong> </p>\n"}, {"tags": ["c", "pointers", "binary-tree", "genetic-programming"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502834262, "post_id": 45702148, "comment_id": 78362708, "body": "What does your debugger say"}, {"owner": {"reputation": 1445, "user_id": 3920548, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/AgJeZ.jpg?s=128&g=1", "display_name": "Robbie", "link": "https://stackoverflow.com/users/3920548/robbie"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502834396, "post_id": 45702148, "comment_id": 78362751, "body": "&quot;Read access violation&quot; when attempting to do anything with either node-&gt;left or node-&gt;right"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1502834422, "post_id": 45702148, "comment_id": 78362757, "body": "<code>parents[0] = &amp;parent1;</code> :  <code>parent1</code> is local variable in function."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502838545, "post_id": 45702148, "comment_id": 78363959, "body": "This is slightly unusual as a case of returning pointers to local variables because it isn&#39;t a local array, and memory is allocated to hold the pointers, but the pointers are still to the local variables <code>parent1</code> and <code>parent2</code>, and they&#39;re no longer valid once the function returns."}], "answers": [{"tags": [], "owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "is_accepted": true, "score": 4, "last_activity_date": 1502834645, "creation_date": 1502834645, "answer_id": 45702253, "question_id": 45702148, "link": "https://stackoverflow.com/questions/45702148/c-function-returning-pointer-to-garbage-memory/45702253#45702253", "title": "C Function returning pointer to garbage memory", "body": "<p>Your <code>subtree_crossover()</code> function is taking two nodes as values. The function will receive copies, which will then live on the stack until the function exits, at which point they will become invalid. Unfortunately, the function later sticks their addresses into an array that it returns. Therefore, the result of <code>subtree_crossover()</code> is going to contain two invalid pointers to garbage data.</p>\n\n<p>You could initialize <code>parents</code> as a <code>struct node *</code> instead of a <code>struct node **</code>, and make it twice the size of a <code>struct node</code>. Then, you could just copy the nodes into the array. This would avoid the issue. Alternatively, you could copy the nodes onto the heap, so that you could return a <code>struct node **</code>. You'd then have to remember to eventually free the copies, though.</p>\n"}], "owner": {"reputation": 1445, "user_id": 3920548, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/AgJeZ.jpg?s=128&g=1", "display_name": "Robbie", "link": "https://stackoverflow.com/users/3920548/robbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "closed_date": 1502838475, "accepted_answer_id": 45702253, "answer_count": 1, "score": 0, "last_activity_date": 1502834645, "creation_date": 1502834129, "question_id": 45702148, "link": "https://stackoverflow.com/questions/45702148/c-function-returning-pointer-to-garbage-memory", "closed_reason": "Duplicate", "title": "C Function returning pointer to garbage memory", "body": "<p>I am writing a program that, given a set of inputs and outputs, figures out what the equation is. The way the program works is by randomly generating binary trees and putting them through a genetic algorithm to see which is the best.</p>\n\n<p>All the functions I have written work individually, but there is either one or two that do not. </p>\n\n<p>In the program I use two structs, one for a node in the binary tree and the other to keep track of how accurate each tree is given the data (its fitness):</p>\n\n<pre><code>struct node {\n    char value; \n    struct node *left, *right;\n};\n\nstruct individual {\n    struct node *genome;\n    double fitness;\n};\n</code></pre>\n\n<p>One function I use to randomly create trees is a subtree crossover function, which randomly merges two trees, returning two trees that are sort of a mixture of each other. The function is as follows:</p>\n\n<pre><code>struct node **subtree_crossover(struct node parent1, struct node parent2) {\n    struct node *xo_nodes[2];\n\n    for (int i = 0; i &lt; 2; i++) {\n        struct node *parent = (i ? &amp;parent2 : &amp;parent1);\n\n        // Find the subtree at the crossover point\n        xo_nodes[i] = get_node_at_index(&amp;parent, random_index);\n    }\n\n    else {\n        // Swap the nodes\n        struct node tmp = *xo_nodes[0];\n\n        *xo_nodes[0] = *xo_nodes[1];\n        *xo_nodes[1] = tmp;\n\n    }\n\n    struct node **parents = malloc(sizeof(struct node *) * 2);\n    parents[0] = &amp;parent1;\n    parents[1] = &amp;parent2;\n\n    return parents;\n}\n</code></pre>\n\n<p>Another function used one that takes two populations (list of individuals) and selects the best from both, returning the next population. It is as follows:</p>\n\n<pre><code>struct individual *generational_replacement(struct individual *new_population,\n    int size, struct individual *old_population) {\n\n    int elite_size = 3;\n\n    struct individual *population = malloc(sizeof(struct individual) * (elite_size + size));\n\n    int i;\n\n    for (i = 0; i &lt; size; i++) {\n        population[i] = new_population[i];\n    }\n\n    for (i; i &lt; elite_size; i++) {\n        population[i] = old_population[i];\n    }\n\n    sort_population(population);\n\n    population = realloc(population, sizeof(struct individual) * size);\n\n    return population;\n}\n</code></pre>\n\n<p>Then there is the function that essentially is the main part of the program. This functions loops through a population, randomly modifies them and chooses the best among them across multiple generations. From this, it selects the best individual (the highest fitness) and returns it. It is as follows:</p>\n\n<pre><code>struct individual *search_loop(struct individual *population) {\n\n    int pop_size = 10;\n    int tourn_size = 3;\n    int new_pop_i = 0;\n    int generation = 1\n\n    struct individual *new_population = malloc(sizeof(struct individual) * pop_size);\n\n    while (generation &lt; 10) {\n        while (new_pop_i &lt; pop_size) {\n\n            // Insert code where random subtrees are chosen\n\n            struct node **nodes = subtree_crossover(random_subtree_1, random_subtree_2);\n\n            // Insert code to add the trees to new_population\n        }\n\n        population = generational_replacement(new_population, pop_size, population);\n\n        // Insert code to sort population by fitness value\n    }\n\n    return &amp;population[0];\n}\n</code></pre>\n\n<p>The issue I am having is that the search_loop function returns a pointer to an individual that is filled with garbage values. To narrow down the causes, I began to comment out code. By commenting out either subtree_crossover() or generational_replacement() the function returns a valid individual. Based on this, my guess is that the error is caused by either subtree_crossover() or generational_replacement(). </p>\n\n<p>Obviously, this is a heavily reduced version of the code I am using, but I believe it still will show the error that I am getting. If you would like to view the full source code, look in the development branch of this project: <a href=\"https://github.com/dyingpie1/pony_gp_c/tree/Development\" rel=\"nofollow noreferrer\">https://github.com/dyingpie1/pony_gp_c/tree/Development</a></p>\n\n<p>Any help would be greatly appreciated. I have been trying to figure this out for multiple days.</p>\n"}, {"tags": ["c", "pointers", "nodes"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1502832804, "post_id": 45701852, "comment_id": 78362126, "body": "&#39;struct TreeNode node;&#39; - local var, and you return a pointer to it:("}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1502832819, "post_id": 45701852, "comment_id": 78362132, "body": "<code>printf(&quot;&amp;s\\n&quot;</code> that can&#39;t be!!"}, {"owner": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1502832870, "post_id": 45701852, "comment_id": 78362155, "body": "@Jean-Fran&#231;oisFabre Typo, it was <code>%s</code> not <code>$s</code>."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 1, "creation_date": 1502832967, "post_id": 45701852, "comment_id": 78362194, "body": "A general suggestion: replace <code>malloc()</code>/<code>strcpy()</code> sequences with calls to <code>strdup()</code>."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 3, "creation_date": 1502832974, "post_id": 45701852, "comment_id": 78362201, "body": "Typo?  Always copy/paste the exact code you tested, even if it seems quicker to type it in again:("}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1502833237, "post_id": 45701852, "comment_id": 78362299, "body": "<code>sizeof (char)</code> is 1 by definition."}], "answers": [{"comments": [{"owner": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 0, "creation_date": 1502833085, "post_id": 45701926, "comment_id": 78362242, "body": "Oh, so it will result in undefined behavior? Then shouldn&#39;t a, b, c and d be null or some junk, or return an error? What causes a, b, c and d&#39;s value to all equal node d&#39;s value?"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 1, "creation_date": 1502833126, "post_id": 45701926, "comment_id": 78362265, "body": "Undefined behavior means you can&#39;t expect any particular behavior."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1502833146, "post_id": 45701926, "comment_id": 78362270, "body": "Node d&#39;s value is junk when you&#39;re expecting node a&#39;s value, node b&#39;s value, or node c&#39;s value. It&#39;s likely that the implementation just happened to re-use the same address."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 1, "creation_date": 1502833313, "post_id": 45701926, "comment_id": 78362322, "body": "@user2719875 &#39;d&#39; was the last one you created.  The UB mainifested, in this case, as all four instances &#39;overlaying&#39;, and so all the four pointers pointing at the same, last instance, which happened to still be lying around under the stack pointer.  Tomorrow, it&#39;s nasal demons.."}, {"owner": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 0, "creation_date": 1502833451, "post_id": 45701926, "comment_id": 78362387, "body": "@DavidSchwartz Okay got it, so that is why the latter code works (it allocates memory on the heap and returns pointer to that). I&#39;m just learning C, so my questions are a bit basic, but in the latter code, when doing <code>struct TreeNode* node = malloc(sizeof(struct TreeNode));</code>, node is just pointing to a block of memory the size of a TreeNode, right? At what point in the code does node become and actual tree node? Because two lines down, <code>node-&gt;child = NULL;</code> is there, so the block of memory has a child / became an actual struct node."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1502833707, "post_id": 45701926, "comment_id": 78362475, "body": "What is the difference between &quot;an actual TreeNode&quot; and &quot;a block of memory the size of a TreeNode&quot;?"}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 2, "last_activity_date": 1502832943, "creation_date": 1502832943, "answer_id": 45701926, "question_id": 45701852, "link": "https://stackoverflow.com/questions/45701852/multiple-node-values-all-point-to-the-same-value-even-when-using-malloc-and-strc/45701926#45701926", "title": "multiple node values all point to the same value even when using malloc and strcpy", "body": "<pre><code>struct TreeNode* create_node(const char* value) {\n    struct TreeNode node;\n    node.value = malloc(sizeof(char) * (strlen(value) + 1));\n    strcpy(node.value, value);\n    node.sibling = NULL;\n    node.child = NULL;\n    struct TreeNode* node_ptr = &amp;node;\n    return node_ptr;\n}\n</code></pre>\n\n<p>The struct <code>node</code> is local to this function, so it ceases to exist when the function returns. But you return a pointer to it. What is the caller supposed to do with a pointer to an object that no longer exists?</p>\n"}, {"comments": [{"owner": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 0, "creation_date": 1502833776, "post_id": 45702027, "comment_id": 78362505, "body": "Okay thanks. I made this reply to another answer, but I&#39;ll ask it again here (just learning C so questions are basic). In the latter code, when doing <code>struct TreeNode* node = malloc(sizeof(struct TreeNode));</code>, node is just pointing to a block of memory the size of a TreeNode, right? At what point in the code does node become an actual tree node? Because two lines down, <code>node-&gt;child = NULL;</code> is there, so the block of memory has a child / became an actual struct node."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "reply_to_user": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 1, "creation_date": 1502834215, "post_id": 45702027, "comment_id": 78362686, "body": "By calling <code>malloc(sizeof(struct TreeNode));</code> system will get you enough space for <code>sizeof(char *)</code> + <code>2*(sizeof(struct TreeNode*))</code> + <code>padding</code>, and you are storing an address of this block into pointer to struct variable. By dereferencing you can get on each variable in struct and set it. <code>node-&gt;child = NULL;</code> means that to that 8 or 4 Bytes for pointer is stored NULL, otherwise there would be stored address of another node if you have done <code>node-&gt;child = &amp;anotherNode;</code> Hope you understand now @user2719875 :-)"}], "tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": true, "score": 1, "last_activity_date": 1502833929, "last_edit_date": 1502833929, "creation_date": 1502833494, "answer_id": 45702027, "question_id": 45701852, "link": "https://stackoverflow.com/questions/45701852/multiple-node-values-all-point-to-the-same-value-even-when-using-malloc-and-strc/45702027#45702027", "title": "multiple node values all point to the same value even when using malloc and strcpy", "body": "<blockquote>\n  <p>2) Why does the latter work, and the former doesn't?</p>\n</blockquote>\n\n<p>Becouse you are returning address of local variable. In the time you are dereferencing pointer is the local variable out of scope (ended it's lifetime) which leads to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>. In function you have to return pointer only to variable(declared in function) with <em>dynamic storage duration</em>.</p>\n\n<hr>\n\n<blockquote>\n  <p>3) In the latter, shouldn't it be node->value = malloc(sizeof(char) *\n  (strlen(value) + 1)); rather than just node->value =\n  malloc(strlen(value) + 1);</p>\n</blockquote>\n\n<p>Size of <code>char</code> is <code>1B</code> by standard.</p>\n\n<p><strong>C99, section 6.5.3.4</strong></p>\n\n<blockquote>\n  <p>When applied to an operand that has type char, unsigned char, or\n  signed char, (or a qualified version thereof) the result is 1.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>1) Why do they all have the same value?</p>\n</blockquote>\n\n<p>Becouse <code>UB</code>, change <code>create_node</code> to: </p>\n\n<pre><code>struct TreeNode* create_node(const char* value)\n{\n    struct TreeNode * node = (struct TreeNode*)malloc (sizeof(struct TreeNode));\n    node-&gt;value = malloc(sizeof(char) * (strlen(value) + 1));\n    strcpy(node-&gt;value, value);\n    node-&gt;sibling = NULL;\n    node-&gt;child = NULL;\n    return node;\n}\n</code></pre>\n\n<p>and it won't :-)</p>\n"}], "owner": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 45702027, "answer_count": 2, "score": -3, "last_activity_date": 1502833929, "creation_date": 1502832536, "last_edit_date": 1502833147, "question_id": 45701852, "link": "https://stackoverflow.com/questions/45701852/multiple-node-values-all-point-to-the-same-value-even-when-using-malloc-and-strc", "title": "multiple node values all point to the same value even when using malloc and strcpy", "body": "<p>Edit: just trying to learn C and coming from a Python background, hopefully I don't get downvoted too much for this.</p>\n\n<p>I have this struct:</p>\n\n<pre><code>struct TreeNode {\n    char *value;\n    struct TreeNode *sibling;\n    struct TreeNode *child;\n};\n</code></pre>\n\n<p>I have this code to create nodes:</p>\n\n<pre><code>struct TreeNode* create_node(const char* value) {\n    struct TreeNode node;\n    node.value = malloc(sizeof(char) * (strlen(value) + 1));\n    strcpy(node.value, value);\n    node.sibling = NULL;\n    node.child = NULL;\n    struct TreeNode* node_ptr = &amp;node;\n    return node_ptr;\n}\n</code></pre>\n\n<p>and this is the code in another function which creates the node (where values is an array of strings):</p>\n\n<pre><code>struct TreeNode a = create_node(values[0]);\nstruct TreeNode b = create_node(values[1]);\nstruct TreeNode c = create_node(values[2]);\nstruct TreeNode d = create_node(values[3]);\nprintf(\"%s\\n\", a-&gt;value);\nprintf(\"%s\\n\", b-&gt;value);\nprintf(\"%s\\n\", c-&gt;value);\nprintf(\"%s\\n\", d-&gt;value);\n</code></pre>\n\n<p>When I compile and run this, it prints <code>values[3]</code> four times (meaning the value for node a, b, c and d are all <code>values[3]</code>). </p>\n\n<p>Question 1) Why do they all have the same value?</p>\n\n<p>Note: Code which works properly is:</p>\n\n<pre><code>struct TreeNode* create_node(const char* value) {\n    struct TreeNode* node = malloc(sizeof(struct TreeNode));\n    node-&gt;value = malloc(strlen(value) + 1);\n    strcpy(node-&gt;value, value);\n    node-&gt;child = NULL;\n    node-&gt;sibling = NULL;\n    return node;\n}\n</code></pre>\n\n<p>Question 2) Why does the latter work, and the former doesn't?</p>\n\n<p>Question 3) In the latter, shouldn't it be <code>node-&gt;value = malloc(sizeof(char) * (strlen(value) + 1));</code> rather than just <code>node-&gt;value = malloc(strlen(value) + 1);</code>?</p>\n"}, {"tags": ["c", "string", "memory", "malloc", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 1, "creation_date": 1502831487, "post_id": 45701592, "comment_id": 78361524, "body": "Would someone care to explain the downvote so I can improve this question?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502831506, "post_id": 45701592, "comment_id": 78361527, "body": "<i>Where</i> this &quot;Hello world&quot; is supposed to be stored?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1502831518, "post_id": 45701592, "comment_id": 78361537, "body": "There is a fundamental difference in the way that arrays are handled as arguments/return values."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1502831586, "post_id": 45701592, "comment_id": 78361570, "body": "<code>char *</code> means &quot;pointer to char&quot;,  not &quot;block of 70 characters&quot;"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1502831813, "post_id": 45701592, "comment_id": 78361673, "body": "I found the dup... eventually:("}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1502831888, "post_id": 45701592, "comment_id": 78361703, "body": "@MartinJames Well, the OP is claiming that &quot;<i>I understand that result is a local variable in the concat function</i>&quot;. Which makes it more &quot;unclear&quot; than dup."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502832281, "post_id": 45701592, "comment_id": 78361866, "body": "The difference between the two codes is, in other words, the difference between the value type and the reference type. You can return the value as a value type  like <a href=\"http://ideone.com/OmcCRX\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 28330, "user_id": 298054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dffcc86140441472cfb6119375a9d7?s=128&d=identicon&r=PG", "display_name": "jweyrich", "link": "https://stackoverflow.com/users/298054/jweyrich"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502832808, "post_id": 45701592, "comment_id": 78362130, "body": "@EugeneSh.: I disagree with <i>unclear</i>. The question was posted because OP does not know about memory layout nor the difference between stack and heap. Therefore, OP would have a hard time deducing the correct wording to search for it. I&#39;d close as <i>dup</i>, at most."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1502834793, "post_id": 45701592, "comment_id": 78362908, "body": "I close it as a dup because I have the hammer - it is faster."}], "answers": [{"tags": [], "owner": {"reputation": 930, "user_id": 2945940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bbd95bb0d1468cd30e4f0edc1c47790?s=128&d=identicon&r=PG&f=1", "display_name": "Kaizhe Huang", "link": "https://stackoverflow.com/users/2945940/kaizhe-huang"}, "is_accepted": false, "score": 0, "last_activity_date": 1502831597, "creation_date": 1502831597, "answer_id": 45701635, "question_id": 45701592, "link": "https://stackoverflow.com/questions/45701592/why-do-we-have-to-malloc-in-this-string-function-c/45701635#45701635", "title": "Why do we have to malloc in this string function c?", "body": "<pre><code>char * concat(const char *s1, const char *s2) {\n    char result[70];\n    strcpy(result, s1);\n    strcat(result, s2);\n    return result;\n}\n</code></pre>\n\n<p>In your function, the result array is freed after the function call, so \n<code>char *s3 = concat(s1, s2);</code> pointer s3 is pointing to an invalid address.</p>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1502833335, "post_id": 45701686, "comment_id": 78362333, "body": "It is a classical example of the UB."}, {"owner": {"reputation": 2622, "user_id": 1834967, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Fdxei.jpg?s=128&g=1", "display_name": "Felix Guo", "link": "https://stackoverflow.com/users/1834967/felix-guo"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502833432, "post_id": 45701686, "comment_id": 78362379, "body": "UB being undefined behaviour?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502833521, "post_id": 45701686, "comment_id": 78362408, "body": "Yo my friend. The Undefined Behaviour"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1502833856, "post_id": 45701686, "comment_id": 78362531, "body": "Your &#39;because usually...&#39; is very wrong. This is not while compiler doesn&#39;t give an error."}], "tags": [], "owner": {"reputation": 2622, "user_id": 1834967, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Fdxei.jpg?s=128&g=1", "display_name": "Felix Guo", "link": "https://stackoverflow.com/users/1834967/felix-guo"}, "is_accepted": false, "score": -1, "last_activity_date": 1502831816, "creation_date": 1502831816, "answer_id": 45701686, "question_id": 45701592, "link": "https://stackoverflow.com/questions/45701592/why-do-we-have-to-malloc-in-this-string-function-c/45701686#45701686", "title": "Why do we have to malloc in this string function c?", "body": "<p>Returning a primitive like an <code>int</code> and returning a string is fundamentally different in C. A string is not a primitive object and is actually a character array. Just like how you cannot declare an array in a function locally, then return that array, you cannot simply return the string. The compiler does not throw an error, but instead a warning, because usually, the stack frame where the contents of <code>result</code> is stored is not cleared when the function returns, so for a short time after exiting the function, you <strong>MIGHT</strong> be still able to the pointer returned, but don't count on it. </p>\n\n<p>The fundamental difference here is that <code>malloc</code> will allocate space on the heap, which will not be overwritten unless explicitly told otherwise, whereas simply declaring an array in a function does not guarantee that the space the array occupies will still be accessible / readable after the exit of the function (hence a local variable).</p>\n"}, {"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 0, "last_activity_date": 1502834508, "creation_date": 1502834508, "answer_id": 45702227, "question_id": 45701592, "link": "https://stackoverflow.com/questions/45701592/why-do-we-have-to-malloc-in-this-string-function-c/45702227#45702227", "title": "Why do we have to malloc in this string function c?", "body": "<p>There are ways to make this function work without dynamic memory allocations. For example, you can ditch all hopes if being multi-threading compatible and declare a static variable inside the function. Illustration:</p>\n\n<pre><code>char* concat() {\n    static char result[70];\n    // ... rest of the code\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1502835377, "last_edit_date": 1502835377, "creation_date": 1502834624, "answer_id": 45702249, "question_id": 45701592, "link": "https://stackoverflow.com/questions/45701592/why-do-we-have-to-malloc-in-this-string-function-c/45702249#45702249", "title": "Why do we have to malloc in this string function c?", "body": "<p>From the C Standard (6.2.4 Storage durations of objects)</p>\n\n<blockquote>\n  <p>1 <strong>An object has a storage duration that determines its lifetime.</strong>\n  There are four storage durations: static, thread, <strong>automatic</strong>, and\n  allocated. Allocated storage is described in 7.22.3.</p>\n  \n  <p>2 The lifetime of an object is the portion of program execution during\n  which storage is guaranteed to be reserved for it. An object exists,\n  has a constant address,33) and retains its last-stored value\n  throughout its lifetime.34) <strong>If an object is referred to outside of\n  its lifetime, the behavior is undefined. The value of a pointer\n  becomes indeterminate when the object it points to (or just past)\n  reaches the end of its lifetime.</strong></p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>6 For such an object that does not have a variable length array type,\n  its lifetime extends from entry into the block with which it is\n  associated until execution of that block ends in any way...</p>\n</blockquote>\n\n<p>In this function definition</p>\n\n<pre><code>char * concat(const char *s1, const char *s2) {\n    char result[70];\n    strcpy(result, s1);\n    strcat(result, s2);\n    return result;\n}\n</code></pre>\n\n<p>the variable <code>result</code> has the automatic storage duration. Its lifetime is ended after exiting the function. So as it is written in the Standard</p>\n\n<blockquote>\n  <p>If an object is referred to outside of its lifetime, the behavior is\n  undefined.</p>\n</blockquote>\n\n<p>If to allocate the array dynamically then its lifetime will not end after exiting the function and a pointer that points to it will be valid. You can access the allocated memory outside the function where it was allocated.</p>\n\n<p>As for this function definition</p>\n\n<pre><code>int ret() {\n\n    int a = 4;\n    return a;\n}\n</code></pre>\n\n<p>then the function returns the object itself. If you returned the object indirectly through a pointer like this</p>\n\n<pre><code>int * ret() {\n\n    int a = 4;\n    return &amp;a;\n}\n</code></pre>\n\n<p>then you had the same problem as with the first program that is the program will have undefined behavior if you try to access the variable <code>a</code> using the returned pointer.</p>\n\n<p>Take into account that functions can return an object of the type <code>int</code> but they can not return an array.</p>\n"}], "owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "closed_date": 1502834749, "answer_count": 4, "score": -1, "last_activity_date": 1502835377, "creation_date": 1502831376, "question_id": 45701592, "link": "https://stackoverflow.com/questions/45701592/why-do-we-have-to-malloc-in-this-string-function-c", "closed_reason": "Duplicate", "title": "Why do we have to malloc in this string function c?", "body": "<pre><code>char * concat(const char *s1, const char *s2) {\n    char result[70];\n    strcpy(result, s1);\n    strcat(result, s2);\n    return result;\n}\nint main() {\n    char *s1 = \"Hello\";\n    char *s2 = \" World!\";\n    char *s3 = concat(s1, s2);\n    printf(\"%s\\n\", s3);\n\n    return 0;\n}\n</code></pre>\n\n<p>This program just calls the <code>concat</code> function which returns a <code>char *</code> that is the concat of <code>s1 and s2</code>. However, upon compiling, I get the error <code>address of stack memory associated with local variable 'result' returned</code>.</p>\n\n<p>So I understand that <code>result</code> is a local variable in the concat function, but not really why we have to malloc it. Why doesn't result just get returned with <code>Hello World</code> as it's value?</p>\n\n<p>If you consider a program like this:</p>\n\n<pre><code>int ret() {\n\n    int a = 4;\n    return a;\n}\nint main() {\n    int b = ret();\n    printf(\"%d\\n\", b); // 4\n\n    return 0;\n}\n</code></pre>\n\n<p>there is no error. I don't have to malloc the int. <code>a</code> is local, but I still return it and it still works.</p>\n\n<p>I want to know what's the main difference between concat and ret, and why concat <strong>must</strong> dynamically allocate memory. Thank you.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1502831969, "post_id": 45701591, "comment_id": 78361752, "body": "Apart from anything else, &quot;%d&quot; is the wrong format specifier for a pointer."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1502832616, "post_id": 45701591, "comment_id": 78362030, "body": "@MartinJames <code>ptr-p</code> and <code>*ptr-a</code> are a difference (as integer), not a pointer. Also <code>**ptr</code> is <code>int</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1502832754, "post_id": 45701591, "comment_id": 78362102, "body": "The author of this code should be locked away from any computer."}, {"owner": {"reputation": 47, "user_id": 7737064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-84PV7s-i3pc/AAAAAAAAAAI/AAAAAAAAABA/foe0jIFyjTA/photo.jpg?sz=128", "display_name": "Zubair Noor", "link": "https://stackoverflow.com/users/7737064/zubair-noor"}, "edited": false, "score": 0, "creation_date": 1502833322, "post_id": 45701591, "comment_id": 78362325, "body": "i am sorry the result is &quot;1 1 3&quot; , i just need the explanation of this code."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502839266, "post_id": 45701591, "comment_id": 78364104, "body": "@EugeneSh. we cannot sanction profs/TA&#39;s in such a manner."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502839286, "post_id": 45701591, "comment_id": 78364108, "body": "@BLUEPIXY you&#39;re right.  I had stars in my eyes."}], "answers": [{"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1502836075, "post_id": 45702348, "comment_id": 78363282, "body": "A good explanation of the pointer arithmetic, yet the posted code generates warnings and has undefined behavior due to a mismatch between format specifiers and arguments: <code>ptr - p</code> and <code>*ptr - a</code> have type <code>ptrdiff_t</code>. The correct <code>printf()</code> format specifier is <code>%td</code>: <code>printf(&quot;\\n%td %td %d\\n&quot;,ptr-p,*ptr-a,**ptr);</code>."}, {"owner": {"reputation": 529, "user_id": 6101580, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205983900385237/picture?type=large", "display_name": "Tom&#225;\u0161 Zahradn&#237;\u010dek", "link": "https://stackoverflow.com/users/6101580/tom%c3%a1%c5%a1-zahradn%c3%ad%c4%8dek"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1502837996, "post_id": 45702348, "comment_id": 78363823, "body": "@DavidBowling Thanks for pointing out. I wasn&#39;t really sure of that expression&#39;s result type, and didn&#39;t bother to assure myself whether it is actually <code>int</code> (as i first expected). However, I assume that <code>ptrdiff_t</code> will be mostly same as <code>int</code> on today&#39;s usual platforms."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1502838708, "post_id": 45702348, "comment_id": 78363996, "body": "Actually, <code>ptrdiff_t</code> is likely to be a <code>typedef</code> of <code>long int</code>. <code>t</code> is a length modifier that can be used with <code>d</code>, <code>i</code>, <code>o</code>, <code>u</code>, <code>x</code>, <code>X</code>, or <code>n</code>. The warning on my system is: <i>warning: format \u2018%d\u2019 expects argument of type \u2018int\u2019, but argument 2 has type \u2018long int\u2019 [-Wformat=]</i>."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1502843831, "post_id": 45702348, "comment_id": 78365155, "body": "@DavidBowling: on 64-bit windows system, it is more likely <code>long long int</code> and <code>%td</code> might not be supported. Given the values in this lame example, <code>printf(&quot;\\n%d %d %d\\n&quot;,(int)(ptr-p),(int)(*ptr-a),**ptr);</code> is a simpler workable version."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1502844420, "post_id": 45702348, "comment_id": 78365265, "body": "@chqrlie-- I did not realize that <code>long long</code> was common in 64-bit Windows systems here. As for <code>%td</code>, I was of course referring to <i>compliant</i> compilers ;) Good advice I saw once for such values when, e.g., <code>%td</code> is not available: cast to the widest possible signed type and use the appropriate conversion specifier for that type; yet not really an issue with the posted code...."}], "tags": [], "owner": {"reputation": 529, "user_id": 6101580, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205983900385237/picture?type=large", "display_name": "Tom&#225;\u0161 Zahradn&#237;\u010dek", "link": "https://stackoverflow.com/users/6101580/tom%c3%a1%c5%a1-zahradn%c3%ad%c4%8dek"}, "is_accepted": true, "score": 4, "last_activity_date": 1502838863, "last_edit_date": 1502838863, "creation_date": 1502835157, "answer_id": 45702348, "question_id": 45701591, "link": "https://stackoverflow.com/questions/45701591/i-want-to-know-something-about-this-code/45702348#45702348", "title": "I want to know something about this code", "body": "<p>You can look up \"pointer arithmetic\" if you want to know more and/or my answer will not help.</p>\n\n<p><strong>Explanation:</strong> </p>\n\n<p><code>int *p[]={a,a+1,a+2,a+3,a+4};</code> fills the array <code>p</code> with pointers to each element in array <code>a</code>. It is equivalent to <code>int *p[]={&amp;a[0],&amp;a[1],&amp;a[2],&amp;a[3],&amp;a[4]}</code>. <code>p[0]</code> points to <code>a[0]</code>, <code>p[1]</code> points to <code>a[1]</code> and so on.</p>\n\n<p><code>int **ptr=p;</code> then creates pointer that points at beginning of array <code>p</code>. That is, it is equivalent to <code>int **ptr=&amp;p[0];</code>.</p>\n\n<p><code>ptr++</code> increments <code>ptr</code>, so that it points to next element. In this case, result is same as <code>ptr = &amp;p[1];</code>.</p>\n\n<p>Then, when printing numbers:</p>\n\n<p>subtracting pointers (pointer arithmetic) means that result is equal to number of elements that can fit between two operands. Because you incremented ptr line before, they are exactly 1 element apart (that is, <code>sizeof(int *)</code>). <code>ptr</code> points to <code>p[1]</code>, and <code>p</code> points to <code>p[0]</code>.</p>\n\n<p>Same goes for <code>*ptr - a</code>, they are 1 element apart (only in this case, it is <code>sizeof(int)</code>). <code>*ptr</code> (that is, <code>p[1]</code>) points to <code>a[1]</code>, <code>a</code> points to <code>a[0]</code>.</p>\n\n<p>And <code>ptr</code> points to <code>p[1]</code>, which points to <code>a[1]</code>, which is <code>3</code>, therefore <code>**ptr</code> is <code>3</code>.</p>\n\n<p><strong>Code warnings:</strong></p>\n\n<p>As pointed out by David Bowling, the <code>printf</code> statement uses the wrong format specifiers for the provided arguments. As result of pointer subtraction, for example <code>ptr-p</code>, is of type <code>ptrdiff_t</code>, correct format specifier is <code>%td</code>: <code>printf(\"\\n%td %td %d\\n\",ptr-p,*ptr-a,**ptr);</code></p>\n\n<p>Using <code>%d</code> specifier is used with <code>int</code> type and causes undefined behavior when used with incorrect types.</p>\n\n<p>You can see what specifiers to use with which types for example here: <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/cstdio/printf/</a></p>\n"}], "owner": {"reputation": 47, "user_id": 7737064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-84PV7s-i3pc/AAAAAAAAAAI/AAAAAAAAABA/foe0jIFyjTA/photo.jpg?sz=128", "display_name": "Zubair Noor", "link": "https://stackoverflow.com/users/7737064/zubair-noor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 1, "accepted_answer_id": 45702348, "answer_count": 1, "score": -4, "last_activity_date": 1502838863, "creation_date": 1502831373, "last_edit_date": 1502833238, "question_id": 45701591, "link": "https://stackoverflow.com/questions/45701591/i-want-to-know-something-about-this-code", "title": "I want to know something about this code", "body": "<p>can anyone help me to explain me this code why the result of this code is \"1 1 3\"</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main()\n{\n    static int a[]={1,3,2,3,4};\n    int *p[]={a,a+1,a+2,a+3,a+4};\n    int **ptr=p;\n    ptr++;\n    printf(\"\\n%d %d %d\\n\",ptr-p,*ptr-a,**ptr);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "function", "declaration", "function-declaration"], "answers": [{"comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1502831517, "post_id": 45701512, "comment_id": 78361536, "body": "Thanks, I tried cdecl.org, but couldn&#39;t get it to give me anything other than &quot;syntax error&quot;. I can see now that was because it did not recognise <code>sqlite3_vfs</code>. If I&#39;d just replaced <code>sqlite3_vfs</code> with <code>int</code> then I would have had my answer."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1502831725, "post_id": 45701512, "comment_id": 78361630, "body": "And the other thing that caught me out I suppose is that although <code>sqlite3OsDlSym</code> returns &quot;pointer to function (void) returning void&quot;, the actual function pointer returned has different prototype, hence the <code>(sqlite3_loadext_entry)</code> cast."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1502832109, "post_id": 45701512, "comment_id": 78361799, "body": "Depending on what <code>SQLITE_PRIVATE</code> actually is, it may apply to the function being declared rather than the return type  (e.g. if it were a macro for <code>static</code>)"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1502832201, "post_id": 45701512, "comment_id": 78361824, "body": "<code>SQLITE_PRIVATE</code> expands to <code>static</code> I believe"}], "tags": [], "owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "is_accepted": true, "score": 8, "last_activity_date": 1502934381, "last_edit_date": 1502934381, "creation_date": 1502831033, "answer_id": 45701512, "question_id": 45701496, "link": "https://stackoverflow.com/questions/45701496/how-do-i-interpret-this-declaration-that-appears-to-be-a-function-declaration-b/45701512#45701512", "title": "How do I interpret this declaration that appears to be a function declaration, but doesn&#39;t fit the usual mould?", "body": "<p>This is declaring a function that returns a function pointer. The return type is <code>void (*)(void)</code> (<code>SQLITE_PRIVATE</code> expands to <code>static</code> and is not part of the return type, per comments), but the function name (and parameters) have to appear inside the <code>(*)</code> part.</p>\n\n<p>Functions and arrays are the two C type categories that require to do gymnastics to parse. You can think of array types and function types as \"decorating\" the identifier that they describe. If you write <code>int foo</code>, you're saying that the symbol \"foo\" has an integer type. If you write <code>int foo(double)</code>, you're saying that the symbol <code>foo(double)</code> has an integer type. <code>foo</code> and <code>(double)</code> have to stick together, so any further decoration has to wrap the entire thing as if it was a single name.</p>\n\n<p>The point is best illustrated by mixing array types and function types, even though the end type might not be legal in C. (That says a lot about how ridiculous the syntax is.) For instance:</p>\n\n<pre><code>int foo[5](double)\n</code></pre>\n\n<p>would be an array (<code>foo[5]</code>) of functions (<code>int ... (double)</code>). On the other hand:</p>\n\n<pre><code>int foo(double)[5]\n</code></pre>\n\n<p>is a function (<code>foo(double)</code>) and returns an array (<code>int ... [5]</code>).</p>\n\n<p>The external resource <a href=\"https://cdecl.org/?q=void+%28*sqlite3OsDlSym%28void+*%2C+void+*%2C+const+char+*%29%29%28void%29%3B\" rel=\"nofollow noreferrer\">cdecl.org</a> can help you make sense of this kind of declaration. However, you need to replace the structure names with standard types (or write structure types as <code>struct sqlite_vfs</code> instead of just <code>sqlite_vfs</code>) for it to understand your declaration.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1502832770, "creation_date": 1502832770, "answer_id": 45701890, "question_id": 45701496, "link": "https://stackoverflow.com/questions/45701496/how-do-i-interpret-this-declaration-that-appears-to-be-a-function-declaration-b/45701890#45701890", "title": "How do I interpret this declaration that appears to be a function declaration, but doesn&#39;t fit the usual mould?", "body": "<p>This declaration</p>\n\n<pre><code>SQLITE_PRIVATE void (*sqlite3OsDlSym(sqlite3_vfs *, void *, const char *))(void);\n</code></pre>\n\n<p>is a declaration of a function that has the return type that is function pointer of the type</p>\n\n<pre><code>void ( * )( void )\n</code></pre>\n\n<p>The declaration can be simplified by introducing a typedef. For example</p>\n\n<pre><code>typedef void ( *FP )( void );\n\nSQLITE_PRIVATE  FP sqlite3OsDlSym(sqlite3_vfs *, void *, const char *);\n</code></pre>\n\n<p>Here is a demonstrative program that uses a similar function that returns a pointer to another function.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef void ( *FP )( void );\n\nvoid h( void )\n{\n    puts( \"Hello World\" );\n}\n\nFP f( void );\nvoid ( *f( void) )( void )\n{\n    return h;\n}\n\nint main(void) \n{\n    f()();\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>Hello World\n</code></pre>\n\n<p>At first the function <code>f</code> is declared using a typedef and then without the typedef</p>\n\n<pre><code>FP f( void );\nvoid ( *f( void) )( void )\n{\n    return h;\n}\n</code></pre>\n"}], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 45701512, "answer_count": 2, "score": 9, "last_activity_date": 1502934381, "creation_date": 1502830944, "last_edit_date": 1502833268, "question_id": 45701496, "link": "https://stackoverflow.com/questions/45701496/how-do-i-interpret-this-declaration-that-appears-to-be-a-function-declaration-b", "title": "How do I interpret this declaration that appears to be a function declaration, but doesn&#39;t fit the usual mould?", "body": "<p>I'm trying to decipher this declaration from sqlite3.c</p>\n\n<pre><code>SQLITE_PRIVATE void (*sqlite3OsDlSym(sqlite3_vfs *, void *, const char *))(void);\n</code></pre>\n\n<p>It seems like it is declaring a function because subsequently there is this</p>\n\n<pre><code>SQLITE_PRIVATE void (*sqlite3OsDlSym(sqlite3_vfs *pVfs, void *pHdle, const char *zSym))(void){\n  return pVfs-&gt;xDlSym(pVfs, pHdle, zSym);\n}\n</code></pre>\n\n<p>and then what appear to be calls to the function</p>\n\n<pre><code>xInit = (sqlite3_loadext_entry)sqlite3OsDlSym(pVfs, handle, zEntry);\n</code></pre>\n\n<p>and </p>\n\n<pre><code>xInit = (sqlite3_loadext_entry)sqlite3OsDlSym(pVfs, handle, zEntry);\n</code></pre>\n\n<p>But I cannot make sense of the declaration. I've highlighted what I cannot understand</p>\n\n<pre><code>SQLITE_PRIVATE void (*sqlite3OsDlSym(sqlite3_vfs *, void *, const char *))(void);\n                    ^                                                    ^^^^^^^\n</code></pre>\n\n<p>I'm wondering why the declaration is not like so</p>\n\n<pre><code>SQLITE_PRIVATE void *sqlite3OsDlSym(sqlite3_vfs *, void *, const char *);\n</code></pre>\n\n<p>I expect that there may well be a similar question already asked but searching for terms like <code>(</code>, <code>)</code> and <code>void</code> doesn't really get anywhere. So, if this is a dupe, I'd be very happy for it to be closed as such.</p>\n"}, {"tags": ["c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 5, "creation_date": 1502830680, "post_id": 45701404, "comment_id": 78361154, "body": "<code>TYPE u[] TYPE v[]</code> =&gt; <code>TYPE u[], TYPE v[]</code>, just missing a comma, not a macro issue"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 2, "creation_date": 1502830684, "post_id": 45701404, "comment_id": 78361158, "body": "You actually do need a comma: <code>VectorVectorDot(TYPE u[], TYPE v[])</code>"}, {"owner": {"reputation": 126, "user_id": 6463203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-98arjgYM7vk/AAAAAAAAAAI/AAAAAAAAAC0/IlxsEshjBuI/photo.jpg?sz=128", "display_name": "Nothing Nothing", "link": "https://stackoverflow.com/users/6463203/nothing-nothing"}, "edited": false, "score": 2, "creation_date": 1502830795, "post_id": 45701404, "comment_id": 78361213, "body": "You could also use a <code>typedef</code>, since using macros for this is generally discouraged."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1502830805, "post_id": 45701404, "comment_id": 78361219, "body": "Aside: what is <code>n</code>?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502830940, "post_id": 45701404, "comment_id": 78361287, "body": "preprocessor does not take anything into accunt. it does not know anything about C"}, {"owner": {"reputation": 440, "user_id": 7907717, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-0LU0FCk5puc/AAAAAAAAAAI/AAAAAAAAOaA/0yHHaz1nXq8/photo.jpg?sz=128", "display_name": "CircArgs", "link": "https://stackoverflow.com/users/7907717/circargs"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502830957, "post_id": 45701404, "comment_id": 78361293, "body": "@WeatherVane whoops. just a mistake as this is just example code. see my edit comment"}, {"owner": {"reputation": 440, "user_id": 7907717, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-0LU0FCk5puc/AAAAAAAAAAI/AAAAAAAAOaA/0yHHaz1nXq8/photo.jpg?sz=128", "display_name": "CircArgs", "link": "https://stackoverflow.com/users/7907717/circargs"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1502831541, "post_id": 45701404, "comment_id": 78361549, "body": "@Jean-Fran&#231;oisFabre Thanks. With the comma there is still some issue as if the preprocessor is still considering syntax"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1502831813, "post_id": 45701404, "comment_id": 78361672, "body": "As a rule, you do not want to use a preprocessor macro to abstract away a type name.  It works for simple types, but it won&#39;t work for pointer and array types (and combinations thereof).  It&#39;s better to use the <code>typedef</code> facility for that."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502831918, "post_id": 45701404, "comment_id": 78361727, "body": "@PeterJ well, the preprocessor shares C&#39;s definition of <i>integer constant expression</i>, e.g. <code>#if 42 == 6 * 9</code>"}, {"owner": {"reputation": 440, "user_id": 7907717, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-0LU0FCk5puc/AAAAAAAAAAI/AAAAAAAAOaA/0yHHaz1nXq8/photo.jpg?sz=128", "display_name": "CircArgs", "link": "https://stackoverflow.com/users/7907717/circargs"}, "reply_to_user": {"reputation": 126, "user_id": 6463203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-98arjgYM7vk/AAAAAAAAAAI/AAAAAAAAAC0/IlxsEshjBuI/photo.jpg?sz=128", "display_name": "Nothing Nothing", "link": "https://stackoverflow.com/users/6463203/nothing-nothing"}, "edited": false, "score": 0, "creation_date": 1502832171, "post_id": 45701404, "comment_id": 78361817, "body": "@NothingNothing I had actually done this, with other examples I practiced with, yet I wanted to see if this would work as I saw something in a tutorial elsewhere. I was also curious about convention, but others seems to say typedef is the cleanest and most conventional way"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1502832307, "post_id": 45701404, "comment_id": 78361880, "body": "@M.M  same syntax. Not shared.  using this logic Python shares it with the C as well"}, {"owner": {"reputation": 440, "user_id": 7907717, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-0LU0FCk5puc/AAAAAAAAAAI/AAAAAAAAOaA/0yHHaz1nXq8/photo.jpg?sz=128", "display_name": "CircArgs", "link": "https://stackoverflow.com/users/7907717/circargs"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1502832349, "post_id": 45701404, "comment_id": 78361902, "body": "@JohnBode Do you mean it won&#39;t work for say a function returning a point such as <code>int * example(void){ return malloc(4)}</code> ?"}, {"owner": {"reputation": 126, "user_id": 6463203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-98arjgYM7vk/AAAAAAAAAAI/AAAAAAAAAC0/IlxsEshjBuI/photo.jpg?sz=128", "display_name": "Nothing Nothing", "link": "https://stackoverflow.com/users/6463203/nothing-nothing"}, "edited": false, "score": 0, "creation_date": 1502832486, "post_id": 45701404, "comment_id": 78361964, "body": "@CircArgs <a href=\"https://stackoverflow.com/questions/1666353/are-typedef-and-define-the-same-in-c\">This SO question</a> might be of help."}, {"owner": {"reputation": 440, "user_id": 7907717, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-0LU0FCk5puc/AAAAAAAAAAI/AAAAAAAAOaA/0yHHaz1nXq8/photo.jpg?sz=128", "display_name": "CircArgs", "link": "https://stackoverflow.com/users/7907717/circargs"}, "reply_to_user": {"reputation": 126, "user_id": 6463203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-98arjgYM7vk/AAAAAAAAAAI/AAAAAAAAAC0/IlxsEshjBuI/photo.jpg?sz=128", "display_name": "Nothing Nothing", "link": "https://stackoverflow.com/users/6463203/nothing-nothing"}, "edited": false, "score": 0, "creation_date": 1502832843, "post_id": 45701404, "comment_id": 78362143, "body": "@NothingNothing Thanks for the link. I think I&#39;ll stick with <code>typedef</code> from now on. Still unsure of the final error there..."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1502833598, "post_id": 45701404, "comment_id": 78362434, "body": "@CircArgs <code>#define</code> is a plain text replacement. You would get the same error if you replace all usage of <code>TYPE</code> with <code>float</code>. If you are still having trouble please post a MCVE. The code you have posted so far compiles correctly for me (using gcc for windows, and MSVC)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1502833800, "post_id": 45701404, "comment_id": 78362519, "body": "Also it would be good to indicate which compiler and platform you are using, since <code>__declspec(dllexport)</code> is a non-standard extension"}, {"owner": {"reputation": 440, "user_id": 7907717, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-0LU0FCk5puc/AAAAAAAAAAI/AAAAAAAAOaA/0yHHaz1nXq8/photo.jpg?sz=128", "display_name": "CircArgs", "link": "https://stackoverflow.com/users/7907717/circargs"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1502840037, "post_id": 45701404, "comment_id": 78364297, "body": "@M.M But I&#39;ve shown that I&#39;m using gcc and dynamic link libraries are a windows exclusive thing are they not?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1502841486, "post_id": 45701404, "comment_id": 78364639, "body": "@CircArgs Perhaps the problem was that you used <code>__declspec(dllexport)</code> on a non-windows compiler where it was unrecognized.   Also there are multiple different ports of gcc to Windows, and different versions of each."}], "answers": [{"comments": [{"owner": {"reputation": 440, "user_id": 7907717, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-0LU0FCk5puc/AAAAAAAAAAI/AAAAAAAAOaA/0yHHaz1nXq8/photo.jpg?sz=128", "display_name": "CircArgs", "link": "https://stackoverflow.com/users/7907717/circargs"}, "edited": false, "score": 0, "creation_date": 1502831354, "post_id": 45701463, "comment_id": 78361457, "body": "Thanks for that. Seems to be another issue still though."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 4, "last_activity_date": 1502830792, "creation_date": 1502830792, "answer_id": 45701463, "question_id": 45701404, "link": "https://stackoverflow.com/questions/45701404/c-macro-type-variable/45701463#45701463", "title": "C Macro type variable", "body": "<p>The problem does not lie in the macro, but in your function prototype, where you miss a comma between the parameters.</p>\n\n<p>So change this:</p>\n\n<pre><code>TYPE VectorVectorDot(TYPE u[] TYPE v[])\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>TYPE VectorVectorDot(TYPE u[], TYPE v[])\n</code></pre>\n"}], "owner": {"reputation": 440, "user_id": 7907717, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-0LU0FCk5puc/AAAAAAAAAAI/AAAAAAAAOaA/0yHHaz1nXq8/photo.jpg?sz=128", "display_name": "CircArgs", "link": "https://stackoverflow.com/users/7907717/circargs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1684, "favorite_count": 0, "closed_date": 1502833572, "accepted_answer_id": 45701463, "answer_count": 1, "score": 1, "last_activity_date": 1502831979, "creation_date": 1502830546, "last_edit_date": 1502831979, "question_id": 45701404, "link": "https://stackoverflow.com/questions/45701404/c-macro-type-variable", "closed_reason": "Not suitable for this site", "title": "C Macro type variable", "body": "<p>I am relatively new to C and am trying out different things. </p>\n\n<p>I have a C <code>test.c</code> script which I think makes my expectations and goals clear:</p>\n\n<pre><code>#define TYPE float\n\n__declspec(dllexport)\nTYPE VectorVectorDot(TYPE u[], TYPE v[]){\n    TYPE result = 0.0;\n    for (int i = 0; i &lt; 10; i++){\n      result += v[i]*u[i];\n    }\n    return result;\n}\n</code></pre>\n\n<p>I know <code>float</code> is a keyword, yet I made the assumption that the C preprocessor was more or less a template processor whereby macro variables are effectively considered text and prior to compilation the preprocessor parses the script and simply replaces the a #define variable with it's string value and would not care about keywords and whatnot saving that for the compilation stage. This however doesn't seem to be the case I've learned.</p>\n\n<p>Attempting <code>gcc -c test.c</code> results in <code>warning: useless type name in empty declaration</code> followed by <code>error: unknown type name 'u'</code></p>\n\n<p>How is this commonly done (setting type in some manner before compilation)?</p>\n\n<p>EDIT: having placed a comma between the function arguments resolved the initial error. Now, with the code (updated above) I get <code>warning: useless type name in empty declaration</code> followed by <code>error: unknown type name 'u'</code>. So, it seems to me that the preprocessor is looking at something to do with syntax instead of just naively repplacing all instances of <code>TYPE</code> with <code>float</code>. Is this the case?</p>\n"}, {"tags": ["c", "gcc", "visual-studio-code"], "comments": [{"owner": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "edited": false, "score": 0, "creation_date": 1502833296, "post_id": 45701187, "comment_id": 78362318, "body": "Is this C or C++? Also, what version of Visual Studio are you using?"}, {"owner": {"reputation": 2159, "user_id": 973364, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FuK7N.jpg?s=128&g=1", "display_name": "Eliot", "link": "https://stackoverflow.com/users/973364/eliot"}, "reply_to_user": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "edited": false, "score": 0, "creation_date": 1502837268, "post_id": 45701187, "comment_id": 78363629, "body": "C. Visual Studio Code."}, {"owner": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "edited": false, "score": 0, "creation_date": 1502839766, "post_id": 45701187, "comment_id": 78364224, "body": "Could you be missing something after &quot;.../include&quot; in the path?"}, {"owner": {"reputation": 2159, "user_id": 973364, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FuK7N.jpg?s=128&g=1", "display_name": "Eliot", "link": "https://stackoverflow.com/users/973364/eliot"}, "reply_to_user": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "edited": false, "score": 0, "creation_date": 1502875033, "post_id": 45701187, "comment_id": 78377165, "body": "No, that&#39;s where stdint.h and stdint-gcc.h are."}, {"owner": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "edited": false, "score": 0, "creation_date": 1502898575, "post_id": 45701187, "comment_id": 78394096, "body": "Not sure whats going on, but you could work around the limitation using typedef instead"}, {"owner": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "edited": false, "score": 0, "creation_date": 1503007647, "post_id": 45701187, "comment_id": 78448785, "body": "I think the issue is that you&#39;re trying to use a Microsoft product on a non-Microsoft platform. There are tons of editors/IDEs that integrate so much better with the tools you&#39;re using than this abomination that is VS Code."}, {"owner": {"reputation": 2159, "user_id": 973364, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FuK7N.jpg?s=128&g=1", "display_name": "Eliot", "link": "https://stackoverflow.com/users/973364/eliot"}, "reply_to_user": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "edited": false, "score": 0, "creation_date": 1503096259, "post_id": 45701187, "comment_id": 78490364, "body": "@rubenvb Such as? And don&#39;t you dare say Eclipse."}, {"owner": {"reputation": 2458, "user_id": 244342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a48db9c075f6df7fb59d2a28f970d6b?s=128&d=identicon&r=PG", "display_name": "mbmcavoy", "link": "https://stackoverflow.com/users/244342/mbmcavoy"}, "edited": false, "score": 0, "creation_date": 1505196522, "post_id": 45701187, "comment_id": 79300004, "body": "I am having this exact same issue, except I am actually running Visual Studio Code on Windows. By running <code>arm-none-eabi-gcc -dM -E -</code>, I can see that GCC defines many of these by default: <code>#define __UINT32_TYPE__ long unsigned int</code>, etc. I&#39;m not sure how to pre-populate that define for VSCode. If I add it to the c_cpp_properties.json includes, it ends up as <code>long unsigned int 1</code>, and doesn&#39;t work right."}, {"owner": {"reputation": 2458, "user_id": 244342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a48db9c075f6df7fb59d2a28f970d6b?s=128&d=identicon&r=PG", "display_name": "mbmcavoy", "link": "https://stackoverflow.com/users/244342/mbmcavoy"}, "edited": false, "score": 0, "creation_date": 1505265218, "post_id": 45701187, "comment_id": 79337439, "body": "I have added <code>&quot;__UINT32_TYPE__=long unsigned int&quot;</code> to the <code>defines</code> section of c_cpp_properties.json. Now, in the stdint-gcc.h typedef line, if I hover over <code>__UINT32_TYPE__</code>,  the tooltip shows <code>#define __UINT32_TYPE__ long unsigned int</code>. This matches the define in the compiler. However, if I hover over <code>uint32_t</code>, the tooltip is <code>typedef unsigned long uint32_t</code> which does not seem correct. Also, it still shows the orignial error message that uint32_t is not a type name..."}, {"owner": {"reputation": 7087, "user_id": 1389898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00f2a3f2624a47edc48464d4929a7508?s=128&d=identicon&r=PG", "display_name": "dlmeetei", "link": "https://stackoverflow.com/users/1389898/dlmeetei"}, "edited": false, "score": 0, "creation_date": 1505730207, "post_id": 45701187, "comment_id": 79516541, "body": "Are you looking for file like this <a href=\"https://github.com/deleisha/libuv/blob/v1.x/include/stdint-msvc2008.h\" rel=\"nofollow noreferrer\">github.com/deleisha/libuv/blob/v1.x/include/stdint-msvc2008.&zwnj;&#8203;h</a> ."}, {"owner": {"reputation": 2159, "user_id": 973364, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FuK7N.jpg?s=128&g=1", "display_name": "Eliot", "link": "https://stackoverflow.com/users/973364/eliot"}, "reply_to_user": {"reputation": 7087, "user_id": 1389898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00f2a3f2624a47edc48464d4929a7508?s=128&d=identicon&r=PG", "display_name": "dlmeetei", "link": "https://stackoverflow.com/users/1389898/dlmeetei"}, "edited": false, "score": 0, "creation_date": 1505730368, "post_id": 45701187, "comment_id": 79516640, "body": "@dlmeetei Not really, sorry. I&#39;m not using a Microsoft compiler, as should be clear from the question."}, {"owner": {"reputation": 2458, "user_id": 244342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a48db9c075f6df7fb59d2a28f970d6b?s=128&d=identicon&r=PG", "display_name": "mbmcavoy", "link": "https://stackoverflow.com/users/244342/mbmcavoy"}, "edited": false, "score": 0, "creation_date": 1505759734, "post_id": 45701187, "comment_id": 79535165, "body": "The update c_cpp_properties.json file has all the <b>UINT* stuff, but there should be more. Does arm-none-eabi-gcc define __STDC_HOSTED</b>?"}, {"owner": {"reputation": 23243, "user_id": 23118, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fab0965d392f9190012e9f8368c203d0?s=128&d=identicon&r=PG", "display_name": "hlovdal", "link": "https://stackoverflow.com/users/23118/hlovdal"}, "edited": false, "score": 0, "creation_date": 1546250912, "post_id": 45701187, "comment_id": 94809419, "body": "<code>I still can&#39;t see where unint32_t is defined, either for gcc and make or for VSC</code> - Debug tip: let the compiler tell you by forcing a name collision error by declaring a variable with the same name, e.g. <code>int uint32_t;</code>. Then gcc will complain <code>\u2018uint32_t\u2019 redeclared as different kind of symbol</code> and most importantly inform that <code>&#47;usr&#47;include&#47;bits&#47;stdint-uintn.h:26:20: note: previous declaration of \u2018uint32_t\u2019 was here</code>."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1505629160, "post_id": 46210412, "comment_id": 79485881, "body": "It should be defined regardless. At least since VS10, the C/C++ compiler (<code>cl.exe</code>) knows what <code>stdint.h</code> is and what <code>uint32_t</code> is without more."}, {"owner": {"reputation": 2458, "user_id": 244342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a48db9c075f6df7fb59d2a28f970d6b?s=128&d=identicon&r=PG", "display_name": "mbmcavoy", "link": "https://stackoverflow.com/users/244342/mbmcavoy"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1505664086, "post_id": 46210412, "comment_id": 79494689, "body": "Visual Studio Code is no the same as Visual Studio, and does not include a compiler or headers. If Visual Studio is also installed, it can make use of them, but when developing for an embedded ARM processor, these are the wrong compiler and headers to use. The reference to <code>arm-none-eabi-gcc</code> is for the GNU ARM Toolchain. The parser in Visual Studio Code must to told where to find those headers, and also the built-in defines that are used by that compiler."}, {"owner": {"reputation": 2458, "user_id": 244342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a48db9c075f6df7fb59d2a28f970d6b?s=128&d=identicon&r=PG", "display_name": "mbmcavoy", "link": "https://stackoverflow.com/users/244342/mbmcavoy"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1505664453, "post_id": 46210412, "comment_id": 79494811, "body": "In the question, @eliot had changed the include path so that the VSCode parser was finding the correct ARM headers. However, without at least some of the defines, the headers were not processed correctly, leaving <code>uint32_t</code> incorrectly defined. Note that he is also on a Mac, which won&#39;t have the Microsoft compiler available, although by default it appears that the default points to where the equivalent system headers should be located."}, {"owner": {"reputation": 2159, "user_id": 973364, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FuK7N.jpg?s=128&g=1", "display_name": "Eliot", "link": "https://stackoverflow.com/users/973364/eliot"}, "edited": false, "score": 0, "creation_date": 1505729766, "post_id": 46210412, "comment_id": 79516271, "body": "@mbmcavoy Thanks for the awesome detail, but I&#39;ve followed this pretty closely and still see the errors on uint32_t. I&#39;m only using a subset of the defines, but I think I have all the UNIT stuff covered. Any ideas?"}, {"owner": {"reputation": 2458, "user_id": 244342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a48db9c075f6df7fb59d2a28f970d6b?s=128&d=identicon&r=PG", "display_name": "mbmcavoy", "link": "https://stackoverflow.com/users/244342/mbmcavoy"}, "reply_to_user": {"reputation": 2159, "user_id": 973364, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FuK7N.jpg?s=128&g=1", "display_name": "Eliot", "link": "https://stackoverflow.com/users/973364/eliot"}, "edited": false, "score": 0, "creation_date": 1505746385, "post_id": 46210412, "comment_id": 79527522, "body": "@eliot I thought when I first did it that I had manually just put in the ones I needed and it worked, but I was retracing my steps for a full writeup, and found that it did not. The intermediate headers (stdint.h x2 etc.) have many <code>#ifdef</code> directives, so I think it&#39;s not even getting to the stdint-gcc.h without them. Tracking down each one and entering it manually would be possible, but easy to load them all: Dump to file; remove the leading &quot;#define &quot;; if there are spaces, replace the first with an equals sign; paste into the settings."}, {"owner": {"reputation": 2159, "user_id": 973364, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FuK7N.jpg?s=128&g=1", "display_name": "Eliot", "link": "https://stackoverflow.com/users/973364/eliot"}, "edited": false, "score": 0, "creation_date": 1505757271, "post_id": 46210412, "comment_id": 79533907, "body": "@mbmcavoy Thanks again. I loaded the whole lot and still had the issue, so began to dig deeper - details above in an edit. Could be that what you did works for Windows and not for Mac, I don&#39;t know."}], "tags": [], "owner": {"reputation": 2458, "user_id": 244342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a48db9c075f6df7fb59d2a28f970d6b?s=128&d=identicon&r=PG", "display_name": "mbmcavoy", "link": "https://stackoverflow.com/users/244342/mbmcavoy"}, "is_accepted": false, "score": 0, "last_activity_date": 1505627316, "last_edit_date": 1505627316, "creation_date": 1505362439, "answer_id": 46210412, "question_id": 45701187, "link": "https://stackoverflow.com/questions/45701187/c-c-extension-for-visual-studio-code-gcc-mac-variable-uint32-t-is-not-a-ty/46210412#46210412", "title": "C/C++ extension for Visual Studio Code, gcc, Mac: &quot;variable uint32_t is not a type name&quot;", "body": "<p>I have been able to resolve this on my machine (Windows), with three steps:</p>\n\n<ol>\n<li>Applying Compiler Defines to the C/C++ Extension</li>\n</ol>\n\n<p>The question is correct when it states \"This suggests <code>__UINT32_TYPE__</code> is NOT defined when VSC is parsing my code, but it IS defined when I build with make and gcc.\" The ARM cross-compiler has many built-in defines that are not included in the clang-x64 parser.</p>\n\n<p>First, find out defines your gcc compiler defines, with the <code>-dM -E</code> options. On Windows I was able to dump the output to a file with <code>echo | arm-none-eabi-gcc -dM -E - &gt; gcc-defines.txt</code></p>\n\n<pre><code>#define __DBL_MIN_EXP__ (-1021)\n#define __HQ_FBIT__ 15\n#define __UINT_LEAST16_MAX__ 0xffff\n#define __ARM_SIZEOF_WCHAR_T 4\n#define __ATOMIC_ACQUIRE 2\n#define __SFRACT_IBIT__ 0\n#define __FLT_MIN__ 1.1754943508222875e-38F\n#define __GCC_IEC_559_COMPLEX 0\n(etc. - I have 344 defines)\n</code></pre>\n\n<p>Second, add the defines to your <code>c_cpp_properties.json</code> file. Note that where the #define sets a value, you need to use an <code>=</code> sign here. (You could probably just add individual defines as you need them, but I used Excel to format them as needed and sort. The first defines are for my project, matching the defines in my Makefile.)</p>\n\n<pre><code>\"defines\": [\n    \"STM32F415xx\",\n    \"USE_FULL_LL_DRIVER\",\n    \"__USES_INITFINI__\",\n    \"__ACCUM_EPSILON__=0x1P-15K\",\n    \"__ACCUM_FBIT__=15\",\n    (...)\n    \"__UINT32_TYPE__=long unsigned int\",\n    (etc.)\n</code></pre>\n\n<ol start=\"2\">\n<li>Setting the Symbol Database</li>\n</ol>\n\n<p>After doing a few experiments with individual defines, I could see the define as being processed in <code>stdint-gcc.h</code>, any uses of the types still produced errors. I realized in my <code>c_cpp_properties.json</code> file that I had <code>\"databaseFilename\": \"\"</code> This is used for the \"generated symbol database\", but was not configured properly. I set it to:</p>\n\n<pre><code>\"databaseFilename\": \"${workspaceRoot}/.vscode/browse.vc.db\"\n</code></pre>\n\n<ol start=\"3\">\n<li>Restart Visual Studio Code</li>\n</ol>\n\n<p>After quitting and restarting Visual Studio Code, declarations do not result in the error, and when hovering over a variable, it shows the appropriate type.</p>\n"}, {"tags": [], "owner": {"reputation": 58, "user_id": 3660501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45a3d3b92cfd7c5131e7c1053bfda014?s=128&d=identicon&r=PG&f=1", "display_name": "gekart", "link": "https://stackoverflow.com/users/3660501/gekart"}, "is_accepted": false, "score": 1, "last_activity_date": 1554103232, "last_edit_date": 1554103232, "creation_date": 1554102062, "answer_id": 55449590, "question_id": 45701187, "link": "https://stackoverflow.com/questions/45701187/c-c-extension-for-visual-studio-code-gcc-mac-variable-uint32-t-is-not-a-ty/55449590#55449590", "title": "C/C++ extension for Visual Studio Code, gcc, Mac: &quot;variable uint32_t is not a type name&quot;", "body": "<p>After trying all of the proposed solutions to no effect, I consider the uint32_t  issue to be a bug.</p>\n\n<p>To solve the annoying warnings in VSCode, just add the following line after your #include section:</p>\n\n<pre><code>typedef __uint32_t uint32_t;\n</code></pre>\n\n<p>By doing this once in a single file, it fixes my VSCode warnings and still compiles.</p>\n"}], "owner": {"reputation": 2159, "user_id": 973364, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FuK7N.jpg?s=128&g=1", "display_name": "Eliot", "link": "https://stackoverflow.com/users/973364/eliot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3524, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1563989747, "creation_date": 1502829579, "last_edit_date": 1535054675, "question_id": 45701187, "link": "https://stackoverflow.com/questions/45701187/c-c-extension-for-visual-studio-code-gcc-mac-variable-uint32-t-is-not-a-ty", "title": "C/C++ extension for Visual Studio Code, gcc, Mac: &quot;variable uint32_t is not a type name&quot;", "body": "<p>I've begun using VSC for my embedded C projects with gcc for ARM on a Mac. Having set up include paths in <code>c_cpp_properties.json</code>, most of my <code>#includes</code> are now working. However, a line such as this:</p>\n\n<pre><code>uint32_t m_ttff_seconds = 0;\n</code></pre>\n\n<p>produces a red squiggly underline and the error:</p>\n\n<pre><code>variable uint32_t is not a type name\n</code></pre>\n\n<p>The source file in question includes stdint:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n</code></pre>\n\n<p>and the <code>includePath</code> includes:</p>\n\n<pre><code>\"${HOME}/dev/gcc-arm-none-eabi-4_9-2015q3/lib/gcc/arm-none-eabi/4.9.3/include\"\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>\"intelliSenseMode\": \"clang-x64\"\n</code></pre>\n\n<p>(the only other option being <code>msvc-x64</code>).</p>\n\n<p>The codebase compiles just fine when I use make and gcc. How do I show the C/C++ extension where <code>uint32_t</code> is?</p>\n\n<p>Edit:</p>\n\n<p><code>stdint.h</code> looks like this:</p>\n\n<pre><code>#ifndef _GCC_WRAP_STDINT_H\n#if __STDC_HOSTED__\n# if defined __cplusplus &amp;&amp; __cplusplus &gt;= 201103L\n#  undef __STDC_LIMIT_MACROS\n#  define __STDC_LIMIT_MACROS\n#  undef __STDC_CONSTANT_MACROS\n#  define __STDC_CONSTANT_MACROS\n# endif\n# include_next &lt;stdint.h&gt;\n#else\n# include \"stdint-gcc.h\"\n#endif\n#define _GCC_WRAP_STDINT_H\n#endif\n</code></pre>\n\n<p>and <code>stdint-gcc.h</code> contains:</p>\n\n<pre><code>/* 7.8.1.1 Exact-width integer types */\n\n#ifdef __INT8_TYPE__\ntypedef __INT8_TYPE__ int8_t;\n#endif\n#ifdef __INT16_TYPE__\ntypedef __INT16_TYPE__ int16_t;\n#endif\n#ifdef __INT32_TYPE__\ntypedef __INT32_TYPE__ int32_t;\n#endif\n#ifdef __INT64_TYPE__\ntypedef __INT64_TYPE__ int64_t;\n#endif\n#ifdef __UINT8_TYPE__\ntypedef __UINT8_TYPE__ uint8_t;\n#endif\n#ifdef __UINT16_TYPE__\ntypedef __UINT16_TYPE__ uint16_t;\n#endif\n#ifdef __UINT32_TYPE__\ntypedef __UINT32_TYPE__ uint32_t;\n#endif\n#ifdef __UINT64_TYPE__\ntypedef __UINT64_TYPE__ uint64_t;\n#endif\n</code></pre>\n\n<p>This suggests <code>__UINT32_TYPE__</code> is NOT defined when VSC is parsing my code, but it IS defined when I build with make and gcc.</p>\n\n<p>Edit:</p>\n\n<p>Following @mbmcavoy's answer I'm including my <code>c_cpp_properties.json</code> file here:</p>\n\n<pre><code>{\n    \"configurations\": [\n        {\n            \"name\": \"Mac\",\n            \"includePath\": [\n                \"${HOME}/dev/gcc-arm-none-eabi-4_9-2015q3/lib/gcc/arm-none-eabi/4.9.3/include\",\n                \"${HOME}/dev/nRF5_SDK_14.0.0_3bcc1f7/components/libraries/util\",\n                \"${HOME}/dev/nRF5_SDK_14.0.0_3bcc1f7/config\",\n                [many more of these omitted]\n                \"${HOME}/dev/wisol_SDK_SFM20Rx_master/development/sigfox_cfg2/source\",\n                \"${workspaceRoot}\"\n            ],\n            \"browse\": {\n                \"path\": [\n                    \"${HOME}/dev/gcc-arm-none-eabi-4_9-2015q3/lib/gcc/arm-none-eabi/4.9.3/include\",\n                    \"${HOME}/dev/nRF5_SDK_14.0.0_3bcc1f7/components/libraries/util\",\n                    \"${HOME}/dev/nRF5_SDK_14.0.0_3bcc1f7/config\",\n                    [many more of these omitted]\n                    \"${workspaceRoot}\"\n                ],\n                \"databaseFilename\": \"${workspaceRoot}/.vscode/browse.vc.db\"\n            },\n            \"intelliSenseMode\": \"clang-x64\",\n            \"macFrameworkPath\": [\n                \"/System/Library/Frameworks\",\n                \"/Library/Frameworks\"\n            ],\n            \"defines\": [\n                \"__UINT_LEAST16_MAX__=65535\",\n                \"__UINT_LEAST8_TYPE__=unsigned char\",\n                \"__UINT8_MAX__=255\",\n                \"__UINT_FAST64_MAX__=18446744073709551615ULL\",\n                \"__UINT_FAST8_MAX__=4294967295U\",\n                \"__UINT_LEAST64_MAX__=18446744073709551615ULL\",\n                \"__UINT_LEAST8_MAX__=255\",\n                \"__UINTMAX_TYPE__=long long unsigned int\",\n                \"__UINT32_MAX__=4294967295UL\",\n                \"__UINT16_C(c)=c\",\n                \"__UINT16_MAX__=65535\",\n                \"__UINT8_TYPE__=unsigned char\",\n                \"__UINT64_C(c)=c ## ULL\",\n                \"__UINT_LEAST16_TYPE__=short unsigned int\",\n                \"__UINT64_MAX__=18446744073709551615ULL\",\n                \"__UINTMAX_C(c)=c ## ULL\",\n                \"__UINT_FAST32_MAX__=4294967295U\",\n                \"__UINT_LEAST64_TYPE__=long long unsigned int\",\n                \"__UINT_FAST16_TYPE__=unsigned int\",\n                \"__UINT_LEAST32_MAX__=4294967295UL\",\n                \"__UINT16_TYPE__=short unsigned int\",\n                \"__UINTPTR_MAX__=4294967295U\",\n                \"__UINT_FAST64_TYPE__=long long unsigned int\",\n                \"__UINT_LEAST32_TYPE__=long unsigned int\",\n                \"__UINT8_C(c)=c\",\n                \"__UINT64_TYPE__=long long unsigned int\",\n                \"__UINT32_C(c)=c ## UL\",\n                \"__UINT_FAST32_TYPE__=unsigned int\",\n                \"__UINTMAX_MAX__=18446744073709551615ULL\",\n                \"__UINT32_TYPE__=long unsigned int\",\n                \"__UINTPTR_TYPE__=unsigned int\",\n                \"__UINT_FAST16_MAX__=4294967295U\",\n                \"__UINT_FAST8_TYPE__=unsigned int\"\n            ]\n        }\n    ],\n    \"version\": 3\n}\n</code></pre>\n\n<p>Edit:</p>\n\n<p>On digging deeper, I found that <code>gcc-arm-none-eabi-4_9-2015q3/lib/gcc/arm-none-eabi/4.9.3/include/stdint.h</code> had <code>__STDC_HOSTED__</code> defined and therefore <code>stdint-gcc.h</code> was not actually being included. Instead, that header does an \"<code>include_next &lt;stdint.h&gt;</code>\", which finds <code>gcc-arm-none-eabi-4_9-2015q3/arm-none-eabi/include/stdint.h</code>. I still can't see where unint32_t is defined, either for gcc and make or for VSC.</p>\n"}, {"tags": ["c++", "c", "struct"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1502827244, "post_id": 45700576, "comment_id": 78359508, "body": "C and C++ are two different languages, for example, you don&#39;t need <code>typedef struct</code> in C++."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1502828965, "post_id": 45700576, "comment_id": 78360375, "body": "Please do not use all-caps for anything other than macro names and enum constants.  It&#39;s confusing and hard to read."}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 4, "last_activity_date": 1502832904, "last_edit_date": 1502832904, "creation_date": 1502827979, "answer_id": 45700803, "question_id": 45700576, "link": "https://stackoverflow.com/questions/45700576/circular-dependency-struct-error-redefinition-of-struct-when-using-forward-decl/45700803#45700803", "title": "Circular dependency struct, error redefinition of struct when using forward declaration", "body": "<p>With <code>MENU_T MENU_A;</code>, you do not \"forward declare\" a variable named <code>MENU_A</code>, you rather define it. Hence, when you later write <code>MENU_T MENU_A = { ... }</code>, you get an error indicating that you redefine a variable with the same name <code>MENU_A</code>.</p>\n\n<p>For just declaring a variable (without defining it), use keyword <code>extern</code>:</p>\n\n<pre><code>extern MENU_T MENU_A; // declaration of MENU_A, not a definition\nextern MENU_T MENU_B;\nextern MENU_T MENU_C;\n\nMENU_T MENU_A = \n{\n    .NextMenu = &amp;MENU_B,\n    .PrevMenu = &amp;MENU_C,\n    .InitFunction = 0,\n};\n\n...\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6131722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07304b2b7f56cf42ebb5d35db425c24?s=128&d=identicon&r=PG&f=1", "display_name": "Scott L", "link": "https://stackoverflow.com/users/6131722/scott-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502832904, "creation_date": 1502827102, "question_id": 45700576, "link": "https://stackoverflow.com/questions/45700576/circular-dependency-struct-error-redefinition-of-struct-when-using-forward-decl", "title": "Circular dependency struct, error redefinition of struct when using forward declaration", "body": "<p>The following code compiles in C, using ARMCC under Keil, However fails to compile in C++, using G++ under eclipse. The original code had some const keywords but that seems to be causing another, less important issue, so I removed them for now.</p>\n\n<pre><code>struct MENU\n{\n    struct MENU *   NextMenu;\n    struct MENU *   PrevMenu;\n    void            (* InitFunction)(void);\n};\n\ntypedef struct MENU MENU_T;\n\nMENU_T MENU_A; // &lt;- this forward declaration is needed for circular reference between structs\nMENU_T MENU_B;\nMENU_T MENU_C;\n\nMENU_T\nMENU_A = // &lt;- However redefinition error occurs here\n{\n    .NextMenu = &amp;MENU_B,\n    .PrevMenu = &amp;MENU_C,\n    .InitFunction = 0,\n};\n\nMENU_T\nMENU_B =\n{\n    .NextMenu = &amp;MENU_C,\n    .PrevMenu = &amp;MENU_A,\n    .InitFunction = 0,\n};\n\nMENU_T\nMENU_C =\n{\n    .NextMenu = &amp;MENU_A,\n    .PrevMenu = &amp;MENU_B,\n    .InitFunction = 0,\n};\n</code></pre>\n\n<p>As far as I can tell, the first line is a declaration and not a definition, so the \"error redefinition\" should not occur... </p>\n"}, {"tags": ["c", "string", "loops", "fgets"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 6, "creation_date": 1502826296, "post_id": 45700325, "comment_id": 78359002, "body": "<code>line[0] != &quot;\\n&quot;</code> --&gt; <code>line[0] != &#39;\\n&#39;</code>"}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 3, "creation_date": 1502826490, "post_id": 45700325, "comment_id": 78359092, "body": "You are comparing <code>char</code> with an string literal, you should turn on compiler warnings. <code>gcc</code> -pedantic -Werror"}, {"owner": {"reputation": 1975, "user_id": 2324271, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh4.googleusercontent.com/-pd1cvL1Tlg8/AAAAAAAAAAI/AAAAAAAAAAw/ur8Agb9d_aM/photo.jpg?sz=128", "display_name": "Harsh Wardhan", "link": "https://stackoverflow.com/users/2324271/harsh-wardhan"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1502827264, "post_id": 45700325, "comment_id": 78359521, "body": "@BLUEPIXY Thanks for pointing it out. Totally overlooked that typo."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502840166, "post_id": 45700325, "comment_id": 78364332, "body": "I closed it as a duplicate for &#39;string comparison&#39; but it can also be regarded as character comparison.  The condition <code>if (line[0] != &quot;\\n&quot;) {</code> compares a <code>char</code> with a <code>char *</code>.  It can be fixed by using <code>if (strcmp(line, &quot;\\n&quot;) != 0)</code> or by using <code>if (line[0] != &#39;\\n&#39;)</code> \u2014 both work in this context.  For general string comparison (longer strings), use <code>strcmp()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 5, "last_activity_date": 1502826512, "creation_date": 1502826512, "answer_id": 45700442, "question_id": 45700325, "link": "https://stackoverflow.com/questions/45700325/loop-exit-condition-on-fgets-doesnt-work/45700442#45700442", "title": "Loop exit condition on fgets doesn&#39;t work", "body": "<p>Newline is a character, not a string, so change this:</p>\n\n<pre><code>line[0] != \"\\n\"\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>line[0] != '\\n'\n</code></pre>\n\n<hr>\n\n<p>Enable compiler warnings (<code>-Wall</code> flag in GCC) and you should see something like this:</p>\n\n<pre><code>warning: comparison between pointer and integer\nwarning: comparison with string literal results in unspecified behavior [-Waddress]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1502826872, "post_id": 45700471, "comment_id": 78359302, "body": "Good answer, however check my answer for the flags (I got the warnings by using one flag only)."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1502826999, "post_id": 45700471, "comment_id": 78359378, "body": "Yes you do, ill leave it so OP will see that there are more opportunities for <code>gcc</code> :-)"}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1502827140, "post_id": 45700471, "comment_id": 78359457, "body": "You were faster &amp; have good answer tho so you deserve it."}], "tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 4, "last_activity_date": 1502827186, "last_edit_date": 1502827186, "creation_date": 1502826631, "answer_id": 45700471, "question_id": 45700325, "link": "https://stackoverflow.com/questions/45700325/loop-exit-condition-on-fgets-doesnt-work/45700471#45700471", "title": "Loop exit condition on fgets doesn&#39;t work", "body": "<p>You are trying to compare an string literal with <code>char</code>.</p>\n\n<p>With:</p>\n\n<pre><code>if(line[0] != '\\n')\n</code></pre>\n\n<p>It works well.</p>\n\n<p>If you're reading from a file that's been opened in text mode (including <code>stdin</code>), then whatever representation the underlying system uses to mark the end of a line will be translated to a single '\\n' character.</p>\n\n<p>You should turn on compiler warnings. For <code>gcc</code> it's <code>-pedantic</code> <code>-Werror</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 3815978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6837d46ede095810dc85c94fc96c91fb?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3815978/erik"}, "is_accepted": false, "score": 0, "last_activity_date": 1502826978, "creation_date": 1502826978, "answer_id": 45700553, "question_id": 45700325, "link": "https://stackoverflow.com/questions/45700325/loop-exit-condition-on-fgets-doesnt-work/45700553#45700553", "title": "Loop exit condition on fgets doesn&#39;t work", "body": "<p>On <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fgets.htm\" rel=\"nofollow noreferrer\">this site</a> we can see that fgets doesn't change the value of str (line in your case). Because the value does not change, your if test keeps getting evaluated to true. </p>\n\n<p>If you want to check whether fgets found the end of the file, you have to check if fgets returned NULL.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1502827658, "creation_date": 1502827658, "answer_id": 45700733, "question_id": 45700325, "link": "https://stackoverflow.com/questions/45700325/loop-exit-condition-on-fgets-doesnt-work/45700733#45700733", "title": "Loop exit condition on fgets doesn&#39;t work", "body": "<p>You are comparing a character to a string: <code>line[0] != \"\\n\"</code> should produce a warning.  To detect an empty line, use this instead:</p>\n\n<pre><code>line[0] != '\\n'\n</code></pre>\n\n<p>Note that you should also verify the return value of <code>sscanf()</code>:</p>\n\n<pre><code>char line[100];\n\nwhile (fgets(line, sizeof(line), filePtr) &amp;&amp; *line != '\\n') {\n    if (sscanf(line, \"%15s : %15s\", tmpstr1, tmpstr2) == 2) {\n        printf(\"%s\\n\",  tmpstr2);\n        printf(\"line = %s\", line);\n    } else {\n        printf(\"invalid format: %s\", line);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1975, "user_id": 2324271, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh4.googleusercontent.com/-pd1cvL1Tlg8/AAAAAAAAAAI/AAAAAAAAAAw/ur8Agb9d_aM/photo.jpg?sz=128", "display_name": "Harsh Wardhan", "link": "https://stackoverflow.com/users/2324271/harsh-wardhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "closed_date": 1502840031, "accepted_answer_id": 45700442, "answer_count": 4, "score": 2, "last_activity_date": 1502827686, "creation_date": 1502826124, "last_edit_date": 1502827686, "question_id": 45700325, "link": "https://stackoverflow.com/questions/45700325/loop-exit-condition-on-fgets-doesnt-work", "closed_reason": "Duplicate", "title": "Loop exit condition on fgets doesn&#39;t work", "body": "<p>I have a text file like this</p>\n\n<pre><code>\"input\"\nheight : 227\nwidth : 227\ndepth : 3\n\n\"conv\"\nnum_output : 96\npad : 0\nkernel_size : 11\nstride : 4\ngroup : 1\n\n\"relu\"\n\n\"pool\"\nkernel_size : 3\nstride : 2\n</code></pre>\n\n<p>I'm reading it in a loop (this is partial code)</p>\n\n<pre><code>char line[100];\n\nwhile ((fgets(line, sizeof(line), filePtr))) {\n    if (line[0] != \"\\n\") {\n        sscanf(line, \"%15s : %15s\", tmpstr1, tmpstr2);\n        printf(\"%s\\n\",  tmpstr2);\n        printf(\"line = %s\", line);\n    } else\n        break;\n}\n</code></pre>\n\n<p>But I observed that the <code>if</code> condition always holds true and the output is as below</p>\n\n<pre><code>\"input\"\n227\nline = height : 227\n227\nline = width : 227\n3\nline = depth : 3\n3\nline = \n3\nline = \"conv\"\n96\nline = num_output : 96\n0\nline = pad : 0\n11\nline = kernel_size : 11\n4\nline = stride : 4\n1\nline = group : 1\n1\nline = \n1\nline = \"relu\"\n1\nline = \n1\nline = \"pool\"\n3\nline = kernel_size : 3\n2\nline = stride : 2\n</code></pre>\n\n<p>I have tried comparison with <code>\\0</code> as well but the result doesn't change. Please point me where I'm going wrong.</p>\n\n<p>P.S. : I'm using Ubuntu 16.04 64-bit machine with gcc 5.2.1.</p>\n"}, {"tags": ["java", "c", "openssl", "java-native-interface", "netty"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1502828744, "post_id": 45700277, "comment_id": 78360277, "body": "If jnilib.c is overwritten by the build process, then you must modify the code that generates it, so as to emit correct declarations.  Presumably, the current code generator was built for a system where both the <code>JNIEXPORT</code> and <code>JNICALL</code> macros expand to nothing, whereas that is not the case on Windows."}, {"owner": {"reputation": 107, "user_id": 305631, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7b331caaf06093737da12fd1c33ae3e7?s=128&d=identicon&r=PG", "display_name": "ZuluForce", "link": "https://stackoverflow.com/users/305631/zuluforce"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1502829426, "post_id": 45700277, "comment_id": 78360572, "body": "@JohnBollinger That is certainly an option. This same environment (it&#39;s on a VM) was capable of building the 2.0.1.Final version of this library. Therefore I feel something changed in the library and either I&#39;m unaware of how I&#39;m supposed to change my build process or the library maintainers have a bug. I&#39;m not sure which it is and I&#39;m hoping one of the maintainers chimes in."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1502830099, "post_id": 45700277, "comment_id": 78360909, "body": "The problem is inconsistency of the multiple declarations of your two functions.  One pair of declarations comes from the external JNI header, the other from generated source code.  Since the external header defines the signature and convention that the corresponding JNI implementation will expect, the <i>only</i> reasonable solution is to make the generated code consistent with the JNI header.  Perhaps there&#39;s any easier way to achieve that than hacking the code generator (check the docs), but if you&#39;re only interested in comments from the maintainers then go to a project-specific forum."}, {"owner": {"reputation": 4055, "user_id": 2598037, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWCTo.jpg?s=128&g=1", "display_name": "Carl Mastrangelo", "link": "https://stackoverflow.com/users/2598037/carl-mastrangelo"}, "edited": false, "score": 0, "creation_date": 1503031755, "post_id": 45700277, "comment_id": 78454622, "body": "I sent out <a href=\"https://github.com/netty/netty-tcnative/pull/300\" rel=\"nofollow noreferrer\">github.com/netty/netty-tcnative/pull/300</a> to resolve this."}], "answers": [{"tags": [], "owner": {"reputation": 21435, "user_id": 1074097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e521627c18ed3feaf9db41e754a79483?s=128&d=identicon&r=PG", "display_name": "Norman Maurer", "link": "https://stackoverflow.com/users/1074097/norman-maurer"}, "is_accepted": true, "score": 1, "last_activity_date": 1503312831, "creation_date": 1503312831, "answer_id": 45795296, "question_id": 45700277, "link": "https://stackoverflow.com/questions/45700277/compiling-statically-linked-netty-tcnative-fails-with-mismatch-against-jni-h-fro/45795296#45795296", "title": "Compiling statically linked netty-tcnative fails with mismatch against jni.h from JDK", "body": "<p><a href=\"https://github.com/netty/netty-tcnative/pull/300\" rel=\"nofollow noreferrer\">https://github.com/netty/netty-tcnative/pull/300</a> was merged and fixes the problem. This will be part of netty-tcnative 2.0.7.Final</p>\n"}], "owner": {"reputation": 107, "user_id": 305631, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7b331caaf06093737da12fd1c33ae3e7?s=128&d=identicon&r=PG", "display_name": "ZuluForce", "link": "https://stackoverflow.com/users/305631/zuluforce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 45795296, "answer_count": 1, "score": 1, "last_activity_date": 1503312831, "creation_date": 1502825936, "question_id": 45700277, "link": "https://stackoverflow.com/questions/45700277/compiling-statically-linked-netty-tcnative-fails-with-mismatch-against-jni-h-fro", "title": "Compiling statically linked netty-tcnative fails with mismatch against jni.h from JDK", "body": "<p>The situation is that I'm attempting to compile <a href=\"https://github.com/netty/netty-tcnative\" rel=\"nofollow noreferrer\">netty-tcnative library</a> version 2.0.3.Final on a Windows 10 32-bit machine. I am getting the following error:</p>\n\n<pre><code>[INFO] .\\src\\jnilib.c(360): error C2373: 'JNI_OnLoad': redefinition; different type modifiers [C:&lt;redacted&gt;\\netty-tcnative\\openssl-static\\target\\native-build\\vs2010.vcxproj]\n[INFO]   C:\\Program Files\\Java\\jdk1.8.0_131\\include\\jni.h(1945): note: see declaration of 'JNI_OnLoad'\n[INFO] .\\src\\jnilib.c(423): error C2373: 'JNI_OnUnload': redefinition; different type modifiers [C:&lt;redacted&gt;\\netty-tcnative\\openssl-static\\target\\native-build\\vs2010.vcxproj]\n[INFO]   C:\\Program Files\\Java\\jdk1.8.0_131\\include\\jni.h(1948): note: see declaration of 'JNI_OnUnload'\n</code></pre>\n\n<p>I then compared the signature of <code>JNI_OnLoad</code> and <code>JNI_UnLoad</code> in <code>jnilib.c</code> from tcnative against the <code>jni.h</code> from the JDK.</p>\n\n<p>jnilib.c</p>\n\n<pre><code>jint JNI_OnLoad(JavaVM* vm, void* reserved)\n...\nvoid JNI_OnUnload(JavaVM* vm, void* reserved)\n</code></pre>\n\n<p>jni.h</p>\n\n<pre><code>/* Defined by native libraries. */\nJNIEXPORT jint JNICALL\nJNI_OnLoad(JavaVM *vm, void *reserved);\n\nJNIEXPORT void JNICALL\nJNI_OnUnload(JavaVM *vm, void *reserved);\n</code></pre>\n\n<p>I'm on Java 8 update 131 but I checked this header going back to Java 7 and it's defined the same way. It appears the tcnative project changed this file while implementing shading support in <a href=\"https://github.com/netty/netty-tcnative/pull/272/commits/a1cbec86bcdab1c6b8abb351ef7cffd25b0e9b78\" rel=\"nofollow noreferrer\">issue 272</a>.</p>\n\n<p>I have tried modifying the <code>jnilib.c</code> to include the <code>JNIEXPORT</code> and <code>JNICALL</code> macros but it is overwritten by the build process and regardless I would like to have a repeatable build that doesn't involve modifying source files. What am I doing wrong? The same build environment was able to build version 2.0.1.Final.</p>\n"}, {"tags": ["c", "json", "lua"], "answers": [{"comments": [{"owner": {"reputation": 515, "user_id": 3986849, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/65ebc216f00c3bf01673e077da59eadc?s=128&d=identicon&r=PG&f=1", "display_name": "Fulup", "link": "https://stackoverflow.com/users/3986849/fulup"}, "edited": false, "score": 0, "creation_date": 1502878065, "post_id": 45704619, "comment_id": 78379313, "body": "Not really simple, but very cool solution. Thank you for your solution."}], "tags": [], "owner": {"reputation": 3790, "user_id": 805875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbd9ac04d56f955c822cb28b5ab72fda?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/805875/nobody"}, "is_accepted": true, "score": 2, "last_activity_date": 1502853763, "creation_date": 1502853763, "answer_id": 45704619, "question_id": 45699950, "link": "https://stackoverflow.com/questions/45699950/lua-passing-handle-to-function-created-with-newlib/45704619#45704619", "title": "Lua passing handle to function created with newlib", "body": "<p>Use upvalues!</p>\n\n<p>If you don't use <a href=\"https://www.lua.org/manual/5.3/manual.html#luaL_newlib\" rel=\"nofollow noreferrer\"><code>luaL_newlib</code></a> (which is a macro defined as\u2026</p>\n\n<pre><code>#define luaL_newlib(L,l)  \\\n  (luaL_checkversion(L), luaL_newlibtable(L,l), luaL_setfuncs(L,l,0))\n</code></pre>\n\n<p>\u2026) but explicitly call <a href=\"https://www.lua.org/manual/5.3/manual.html#luaL_setfuncs\" rel=\"nofollow noreferrer\"><code>luaL_setfuncs</code></a>, you can make each function have some number of upvalues.  It's fine to initialize all of them with <code>nil</code>, you can later patch them up.  While you can't extend <code>luaL_Reg</code> with extra fields, you can define an extra <code>struct</code> and have a separate array for the other parameters.</p>\n\n<p>Minimal sample implementation (may need more error checking):</p>\n\n<p>(should be copy&amp;paste-able as-is, text blocks should become comments)</p>\n\n<hr>\n\n<pre><code>#include &lt;lua.h&gt;\n#include &lt;lauxlib.h&gt;\n/*\n</code></pre>\n\n<p>First, define a <code>struct</code> that has the function's name first and anything you need after that.  This example just uses a string, but you could use <code>int</code>, <code>void*</code>, ... and even have more than one value.</p>\n\n<pre><code>*/\ntypedef struct xlua_uvinfo {\n    const char *name;  /* this is how we identify the functions */\n    const char *uv;  /* this can change arbitrarily */\n} xlua_uvinfo;\n/*\n</code></pre>\n\n<p>Then we'll have a function that patches the libtable on the stack to put in the real upvalue data.  You'll need to adjust the types (<code>lua_pushX</code>), order, and/or names of the fields that you push.</p>\n\n<p>Note that as we're identifying functions by name, not all functions need to get upvalues.  (So you can include normal functions in the <code>luaL_Reg</code> that will simply end up with dummy upvalue slots that will not be filled in here.)</p>\n\n<pre><code>*/\nstatic void setupvalues( lua_State *L, const xlua_uvinfo *l ) {\n    for (; l-&gt;name != NULL; l++) {\n        /* get the function by name */\n        if (lua_getfield( L, -1, l-&gt;name ) == LUA_TFUNCTION) {\n            /* this needs to change according to what you have in the struct */\n            lua_pushstring( L, l-&gt;uv );\n            lua_setupvalue( L, -2, 1 );\n        }\n        /* pop the function */\n        lua_pop( L, 1 );\n    }\n}\n/*\n</code></pre>\n\n<p>Here's a dummy implementation of your function.  I use string prefixes \u2013 that's easy to debug / inspect.</p>\n\n<pre><code>*/\n#define MSG_NOTICE \"NOTE\"\n#define MSG_INFO \"INFO\"\n#define MSG_WARN \"WARN\"\n\nstatic int LuaPrintMsg( lua_State *L ) {\n   const char *prefix = lua_tostring( L, lua_upvalueindex(1) );\n   printf( \"%s: %s\\n\", prefix, lua_tostring( L, 1 ) );\n   return 0;\n}\n\n/* plain luaL_Reg array */\nstatic const luaL_Reg afbFunction[] = {\n    {\"notice\" , LuaPrintMsg},\n    {\"info\"   , LuaPrintMsg},\n    {\"warning\", LuaPrintMsg},\n    {NULL, NULL}\n};\n/*\n</code></pre>\n\n<p>And now the part that changes:  Add an extra array for the upvalues and then adjust the <code>luaopen_X</code> function.</p>\n\n<pre><code>*/\n/* extra upvalue array (must also be terminated by { NULL, NULL } !) */\nstatic const xlua_uvinfo afbUpvalues[] = {\n    {\"notice\" , MSG_NOTICE},\n    {\"info\"   , MSG_INFO},\n    {\"warning\", MSG_WARN},\n    {NULL, NULL}\n};\n\nint luaopen_foo( lua_State *L ) {\n    /* as mentioned above, we can't use `luaL_newlib`, expand manually */\n    luaL_checkversion( L );\n    /* create the empty table, pre-allocated to the right size */\n    luaL_newlibtable( L, afbFunction );\n    /* now push a dummy upvalue (more if you add extra upvalues!) */\n    lua_pushnil( L );\n    /* register the functions, giving 1 upvalue to each */\n    luaL_setfuncs( L, afbFunction, 1 );\n    /* now set the actual upvalues */\n    setupvalues( L, afbUpvalues );\n    return 1;\n}\n</code></pre>\n\n<hr>\n\n<p>If you save that as <code>foo.c</code>, compile as (on Linux) <code>gcc -shared -fPIC -o foo.so foo.c</code> and then run <code>lua -l foo</code>, you'll get the desired behavior:</p>\n\n<pre class=\"lang-lua prettyprint-override\"><code>foo.info \"foo\"\n--&gt; INFO: foo\nfoo.notice \"bar\"\n--&gt; NOTE: bar\nfoo.warning \"baz\"\n--&gt; WARN: baz\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 515, "user_id": 3986849, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/65ebc216f00c3bf01673e077da59eadc?s=128&d=identicon&r=PG&f=1", "display_name": "Fulup", "link": "https://stackoverflow.com/users/3986849/fulup"}, "is_accepted": false, "score": 0, "last_activity_date": 1503040763, "last_edit_date": 1503040763, "creation_date": 1502954586, "answer_id": 45728928, "question_id": 45699950, "link": "https://stackoverflow.com/questions/45699950/lua-passing-handle-to-function-created-with-newlib/45728928#45728928", "title": "Lua passing handle to function created with newlib", "body": "<p>While previous response provided by <strong>\"nobody\"</strong> works, I finally used a different solution to solve my problem. Here after my solution.</p>\n\n<p>My goal is to provide to developers something as simple as possible to extend Lua with their own set of commands. My program takes a JSON configuration file as input. The config contains a plugin section:</p>\n\n<pre><code>\"plugin\": {\n                \"label\" : \"MyPlug\",\n                \"sharelib\": \"ctl-audio-plugin-sample.ctlso\",\n                \"lua2c\": [\"Lua2cHelloWorld1\", \"Lua2cHelloWorld2\"]\n            }\n</code></pre>\n\n<p>Where:</p>\n\n<ol>\n<li>sharelib is my user plugin name containing Lua commands</li>\n<li>lu2c the list of commands expose by the plugin as Lua command.</li>\n<li>label a namespace for Lua commands. In my sample case \"MyPlug:Lua2cHelloWorld1+MyPlug:Lua2cHelloWorld2 commands.</li>\n</ol>\n\n<p>My plugin uses a C macro to make Lua interface transparent to developer.My project uses Json-C also my wrapper import/export Lua table to json_object and vice versa automatically. Here after and a simple example.</p>\n\n<pre><code> CTLP_LUA2C (Lua2cHelloWorld2, label, argsJ, context) {\n    MyPluginCtxT *pluginCtx= (MyPluginCtxT*)context;\n\n    if (!context || pluginCtx-&gt;magic != MY_PLUGIN_MAGIC) {\n        AFB_ERROR(\"CONTROLER-PLUGIN-SAMPLE:Lua2cHelloWorld2 (Hoops) Invalid Sample Plugin Context\");\n        return -1;\n    };\n    pluginCtx-&gt;count++;\n    AFB_NOTICE (\"CONTROLER-PLUGIN-SAMPLE:Lua2cHelloWorld2 SamplePolicyCount action=%s args=%s count=%d\"\n               ,label, jsonToString(argsJ), pluginCtx-&gt;count);\n    return 0;\n}\n</code></pre>\n\n<p>Where:</p>\n\n<ul>\n<li>CTLP_LUA2C is my macro</li>\n<li>Lua2cHelloWorld2 my C routine and Lua command</li>\n<li>label a string that contains \"Lua2cHelloWorld2\"</li>\n<li>argsJ the json-c object containing the import of Lua table provided as input paramters.</li>\n<li>context the handle created at Plugin init time with CTLP_ONLOAD routine.</li>\n</ul>\n\n<p>Technically CTLP_LUA2C create a static C function in my example (Lua2cHelloWorld2). Then it creates a public wrapping function name luac_Lua2cHelloWorld2, the wrapper is strait forward.</p>\n\n<pre><code>return((*Lua2cWrap)(luaState, MACRO_STR_VALUE(FuncName), FuncName))\n</code></pre>\n\n<p>Where: </p>\n\n<ul>\n<li>FuncName would be replaced by Lua2cHelloWorld2 in my example.</li>\n<li>Lua2cWrap is provided during plugin initialisation time from CTLP_REGISTER. Most people may have here directly luawrapper public function name . Nevertheless in my project (Automotive Grade Linux Audio Controller) for security motivations no public entry point are expose by the daemon and a specific import mechanism is required.</li>\n</ul>\n\n<p>My code is available <a href=\"https://github.com/iotbzh/audio-bindings/tree/fulup-dev/Controller-afb\" rel=\"nofollow noreferrer\">here.</a> </p>\n\n<ol>\n<li>Macro are define in ctl-binding.h</li>\n<li>Sample of plugin in ctl-plugin-sample.c</li>\n<li>The parsing of JSON config file in ctl-dispatch.c (search for pluginJ</li>\n<li>The Lua wrapper in ctl-lua.c (search for Lua2cWrapper)</li>\n</ol>\n\n<p><strong>General remarks on Lua/C integration model:</strong>\nIntegrating C into Lua is far to complex and Lua interface library clearly miss few utilities. </p>\n\n<p>An extended version of NewLib to create Lua commands should support something like.</p>\n\n<pre><code>{\"xxxx\"     , Callback, handle, \"free information on command\"},\n{\"yyyy\"     , Callbacl, handle, \"info....},\n</code></pre>\n\n<p>At minimum functions create with NewLib should receive as 1st parameter only the item concerning the targeted function and not the full table as in 5.3. Receiving the fuul table is perfectly useless and prevent using a generic callback.</p>\n\n<p>A generic model to move from Lua table to C table should be implemented. My project uses Json-C and obviously many C data representation could be propose. Nevertheless something is clearly missing and current Lua/API for importing/exporting data from Lua to C is simply a nightmare. My code provided simple import/export functions for Lua&lt;->json_object. </p>\n\n<pre><code>// Pop all arguments from Lua and move them in a JsonC object    \njson_object *argsJ= LuaPopArgs(luaState, LUA_FIST_ARG);\n\n// Pop a single arguments from Lua and make it a JsonC object\njson_object *contextJ = LuaPopOneArg(luaState, LUA_FIST_ARG + 2);\n\n// Push C arguments from C to Lua\ncount+= LuaPushArgument(responseJ);\ncount+= LuaPushArgument(contextCB-&gt;context);\nint err=lua_pcall(luaState, count, LUA_MULTRET, 0);\n</code></pre>\n\n<p>Note that I will probably never have succeeded in handle nest import table from Lua->C without the help of <a href=\"https://stackoverflow.com/users/5597039/nick-cano\">Nick</a> see <a href=\"https://stackoverflow.com/questions/45699144/lua-nested-table-from-lua-to-c\">here</a>.</p>\n\n<p>The last integration point I crucially miss is a system to Push/Pop opaque handle from C routine to Lua. I implemented three routines to handle that issue</p>\n\n<ol>\n<li>LuaCtxPush Create context handle</li>\n<li>LuaCtxCheck retrieve context handle and verify its valid</li>\n<li>LuaCtxFree release the handle</li>\n</ol>\n\n<p>This allows to implement very simply function that require a C context to be carried as an opaque handle by Lua. As in following example</p>\n\n<pre><code>STATIC int LuaAfbSuccess(lua_State* luaState) {\n    // retrieve C context carry as opaque handle by Lua\n    LuaAfbContextT *afbContext= LuaCtxCheck(luaState, LUA_FIST_ARG);\n    if (!afbContext) goto OnErrorExit;\n\n    // import remaining arguments into JsonC\n    json_object *responseJ= LuaPopArgs(luaState, LUA_FIST_ARG+1);\n    if (responseJ == JSON_ERROR) return 1;\n\n    // send success response to client    \n    afb_req_success(afbContext-&gt;request, responseJ, NULL);\n\n    // free C context\n    LuaCtxFree(afbContext);\n    return 0;\n\n OnErrorExit:  \n        lua_error(luaState);\n        return 1;\n}\n</code></pre>\n"}], "owner": {"reputation": 515, "user_id": 3986849, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/65ebc216f00c3bf01673e077da59eadc?s=128&d=identicon&r=PG&f=1", "display_name": "Fulup", "link": "https://stackoverflow.com/users/3986849/fulup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 45704619, "answer_count": 2, "score": 2, "last_activity_date": 1503040763, "creation_date": 1502824581, "last_edit_date": 1502877695, "question_id": 45699950, "link": "https://stackoverflow.com/questions/45699950/lua-passing-handle-to-function-created-with-newlib", "title": "Lua passing handle to function created with newlib", "body": "<p>I'm using <code>luaL_newlib(luaState, afbFunction)</code> where <code>afbFunction</code> is a static <code>luaL_Reg</code> array.  Unfortunately, <code>luaL_Reg</code> only support two fields: <code>name</code> and <code>func</code>. As a result, there is no way to pass a handle to a function and implement something like:</p>\n\n<pre><code>static const luaL_Reg afbFunction[] = {\n    {\"notice\" , LuaPrintMsg, MSG_NOTICE},\n    {\"info\"   , LuaPrintMsg, MSG_INFO},\n    {\"warning\", LuaPrintWar, MSG_WARN},\n    {NULL, NULL}  /* sentinel */\n};\n</code></pre>\n\n<p>I have two motivations for not having as many C entry points as there are Lua functions:</p>\n\n<ol>\n<li>I have a generic wrapper for all C functions to process input/output\nparameters value from Lua (table) to C (jsonc).</li>\n<li>The number of Lua functions to interface come from a config file and may change without having to rebuild the code. To make a long story short, the config file has a sharelib path followed by the list of function to expose.</li>\n</ol>\n\n<p>Does someone have a solution to have a unique C entry point for multiple Lua functions? When using <code>luaL_newlib()</code>, the C function receives as 2nd argument the lib table, but it seems to receive the full table and not the corresponding entry, also even testing the label is not possible.</p>\n"}, {"tags": ["c++", "c", "sockets", "cygwin"], "comments": [{"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1502823016, "post_id": 45699474, "comment_id": 78357401, "body": "You should probably better stick to <code>boost::asio</code>."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1502823268, "post_id": 45699474, "comment_id": 78357553, "body": "As a workaround you can create separate file which include <code>winsock.h</code>, but not <code>unistd.h</code> and perform winsock initialization there. Dunno how it should work intially, though."}, {"owner": {"reputation": 88, "user_id": 5188558, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jM3AN.jpg?s=128&g=1", "display_name": "mstranne", "link": "https://stackoverflow.com/users/5188558/mstranne"}, "edited": false, "score": 0, "creation_date": 1502823370, "post_id": 45699474, "comment_id": 78357607, "body": "I would prefer not to take  boost because I also want it to run on Android later on and I boost was not the best with Android ... Okey creating a seperate file could work but is not the most beautiful solution"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1502823989, "post_id": 45699474, "comment_id": 78357908, "body": "Time for a #define.."}, {"owner": {"reputation": 88, "user_id": 5188558, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jM3AN.jpg?s=128&g=1", "display_name": "mstranne", "link": "https://stackoverflow.com/users/5188558/mstranne"}, "edited": false, "score": 0, "creation_date": 1502824128, "post_id": 45699474, "comment_id": 78357972, "body": "how do you mean?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1502824783, "post_id": 45699474, "comment_id": 78358292, "body": "Does cygwin&#39;s POSIX compatibility layer need WSAStartup? Strikes me as kind of odd."}, {"owner": {"reputation": 88, "user_id": 5188558, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jM3AN.jpg?s=128&g=1", "display_name": "mstranne", "link": "https://stackoverflow.com/users/5188558/mstranne"}, "edited": false, "score": 0, "creation_date": 1502825035, "post_id": 45699474, "comment_id": 78358416, "body": "I thought not but creating a socket returns the error 10093 which is for not calling the wsastartup ..."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1502827141, "post_id": 45699474, "comment_id": 78359458, "body": "Try this: Back up all of your code. Replace all of the Windows and winsock includes with the posix sys/types.h, sys/socket.h, etc... Make sure you are calling the POSIX versions instead of the Windows stuff. If it works, awesome. If it doesn&#39;t, restore backup."}, {"owner": {"reputation": 88, "user_id": 5188558, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jM3AN.jpg?s=128&g=1", "display_name": "mstranne", "link": "https://stackoverflow.com/users/5188558/mstranne"}, "edited": false, "score": 0, "creation_date": 1502866811, "post_id": 45699474, "comment_id": 78371924, "body": "okey i&#39;lll try !"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8464271, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6f15318cf76fe3d94b8a542548bc544f?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/8464271/ryan"}, "reply_to_user": {"reputation": 88, "user_id": 5188558, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jM3AN.jpg?s=128&g=1", "display_name": "mstranne", "link": "https://stackoverflow.com/users/5188558/mstranne"}, "edited": false, "score": 0, "creation_date": 1502896883, "post_id": 45701416, "comment_id": 78392880, "body": "did you put the #define in the preprocessor defines? or just type it into your code?"}], "tags": [], "owner": {"reputation": 11, "user_id": 8464271, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6f15318cf76fe3d94b8a542548bc544f?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/8464271/ryan"}, "is_accepted": false, "score": -1, "last_activity_date": 1502830573, "creation_date": 1502830573, "answer_id": 45701416, "question_id": 45699474, "link": "https://stackoverflow.com/questions/45699474/sockets-in-windows-with-cygwin/45701416#45701416", "title": "Sockets in windows with cygwin", "body": "<p>put _winsock_deprecated_no_warnings in defines and #include &lt; winsock2.h ></p>\n"}, {"tags": [], "owner": {"reputation": 88, "user_id": 5188558, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jM3AN.jpg?s=128&g=1", "display_name": "mstranne", "link": "https://stackoverflow.com/users/5188558/mstranne"}, "is_accepted": true, "score": 0, "last_activity_date": 1502880769, "creation_date": 1502880769, "answer_id": 45711616, "question_id": 45699474, "link": "https://stackoverflow.com/questions/45699474/sockets-in-windows-with-cygwin/45711616#45711616", "title": "Sockets in windows with cygwin", "body": "<p>Don't mess up cygwin with windows libs an everything works fine! Since I am not including any windows lib, the UNIX sockets work fine. </p>\n\n<p>Thanks to user4581301.</p>\n"}], "owner": {"reputation": 88, "user_id": 5188558, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jM3AN.jpg?s=128&g=1", "display_name": "mstranne", "link": "https://stackoverflow.com/users/5188558/mstranne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 757, "favorite_count": 0, "accepted_answer_id": 45711616, "answer_count": 2, "score": 0, "last_activity_date": 1502880769, "creation_date": 1502822789, "last_edit_date": 1502822960, "question_id": 45699474, "link": "https://stackoverflow.com/questions/45699474/sockets-in-windows-with-cygwin", "title": "Sockets in windows with cygwin", "body": "<p>I am facing a problem working with cygwin and sockets under windows. \nThe code is working normaly in Ubuntu but when I am running it under windows, the socket will not open (error 10093) because no WSAStartup call was made. But when I include winsock.h for WSAStartup i cant even compile because of an conflicting declaration of <code>int select(int, _types_fd_set*, _types_fd_set*, _types_fd_set*, PTIMEVAL)</code> in winsock and unistd .</p>\n\n<p>however does anyone know a way to get sockets run with cygwin???</p>\n\n<p>thanks </p>\n"}, {"tags": ["c", "pipe", "fork"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1502823298, "post_id": 45699449, "comment_id": 78357567, "body": "You don&#39;t clear the buffer after reading data into it, so the data you read the first time are still there when you print the buffer again.  This would be clearer if you checked the return values of your function calls."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1502823420, "post_id": 45699449, "comment_id": 78357638, "body": "Note also that you fail to append a null terminator after reading the data; it is therefore incorrect to rely upon there being one.  You lucked out on that.  Or maybe not, for if you had used the return value of <code>read()</code> (correctly) to determine where the terminator should go, then you would not have been confused."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1502823574, "post_id": 45699449, "comment_id": 78357719, "body": "@JohnBollinger That depends; this isn\u2019t a MCVE so we don\u2019t know exactly where and how the declaration of <code>buf1</code> is happening. If it\u2019s static instead of happening in <code>main</code>, or if it has an initialization which wasn\u2019t included here, then the rest of the characters are 0 and it\u2019s safe. If all of this is in <code>main</code>, then yeah it could be a problem."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1502824405, "post_id": 45699449, "comment_id": 78358109, "body": "@DanielH, the declaration of <code>buf1</code> is in the code presented.  Second line."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1502826209, "post_id": 45699449, "comment_id": 78358960, "body": "@JohnBollinger But is it in <code>main</code>, or is it at file scope? Based on the indentation, probably <code>main</code>, but we don\u2019t know."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1502828274, "post_id": 45699449, "comment_id": 78360038, "body": "@DanielH, I see no reason to suppose that the source presented consists of concatenation of fragments drawn from separate scopes, as it would need to be for the declarations within to be at file scope.  But you&#39;re right that if they <i>were</i> at file scope then they would be subject to default initialization."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1502828846, "post_id": 45699449, "comment_id": 78360330, "body": "@JohnBollinger When people don\u2019t provide MCVEs, they often also don\u2019t specify scope change or other details clearly. I wouldn\u2019t be surprised either way."}], "answers": [{"comments": [{"owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1502823654, "post_id": 45699622, "comment_id": 78357765, "body": "So are you saying that in the first read call, read reads all 20 a&#39;s, and after that, since the pipe is empty, it does not read anymore, hence it does not change the buffer. so 20a&#39;s are printed 20 times"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1502823829, "post_id": 45699622, "comment_id": 78357851, "body": "Yes. Although that\u2019s just luck; you could get the first <code>read</code> call reading 3 <code>a</code>s, and printing that, the second <code>read</code> call reading the remaining 17 <code>a</code>s and printing 17 <code>a</code>s (since it overwrote the first three), and the remaining read calls all doing 17 <code>a</code>s."}, {"owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1502823973, "post_id": 45699622, "comment_id": 78357901, "body": "okay, thank you. but also i have one more question. I understand then when you write to a pipe, first we wrote an <code>a</code>, then we wrote another <code>a</code>, now we have <code>aa</code>, and when we read, hopefully, we read <code>aa</code> back. I experiemented and instead of <code>a</code>, I decided to write <code>hello</code>, and then <code>hello</code> again. So I assume on the pipe we have <code>hellohello</code>, but actually, when I read (just one read call), only <code>hello</code> is printed, not <code>hellohello</code>. Why could this be?"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1502824157, "post_id": 45699622, "comment_id": 78357989, "body": "For the same reason as in my previous example. If the <code>read</code> happened before the second <code>write</code>, then it\u2019ll just see <code>hello</code>. Fortunately if you\u2019re writing a small amount of data (<code>PIPE_BUF</code> bytes, probably 4096), the writes are atomic and you won\u2019t get <code>hellohe</code>, but if you had large writes you might."}, {"owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1502824383, "post_id": 45699622, "comment_id": 78358098, "body": "How would I check the return value. I could do: <code>if (read(fd[0], buf1, 30) != 11)</code> ... how do I &quot;reread&quot;, since the pipe will have lost its data"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1502829156, "post_id": 45699622, "comment_id": 78360455, "body": "@KSplitX The pipe only \u201closes\u201d the data that has been read. If you read 5 bytes from the pipe, then it will lose 5 bytes and the next time you <code>read</code> from it it will have all the rest. The way to do it is to make a variable, <code>ssize_t count</code>, and do <code>count = read(fd[0], buf1, 30); if (count == 0) { &#47;* Handle EOF *&#47; } else if (count == -1) { &#47;* Handle error *&#47; } else { &#47;* Handle having read count bytes of data *&#47; };</code>. If you do that in a loop, and instead of passing <code>buf1</code> you pass a pointer which you increase on successful read, you can read all the data without losing any."}], "tags": [], "owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1502823282, "creation_date": 1502823282, "answer_id": 45699622, "question_id": 45699449, "link": "https://stackoverflow.com/questions/45699449/reading-and-writing-to-a-pipe-c-issue/45699622#45699622", "title": "reading and writing to a pipe c issue", "body": "<p>You are correct that if the child calls <code>read</code> before the parent has written anything, the call will block; however, after the parent closes the file descriptor, this is no longer the case and <code>read</code> will return 0 for EOF.</p>\n\n<p>The <code>read</code> call doesn\u2019t clear the buffer. The OS successfully reads zero characters, and therefore changes the first zero characters of the buffer. That is, it doesn\u2019t change <code>buf1</code> at all. Thus, once all the data has been read into the buffer, the <code>printf</code> call will always do the same thing.</p>\n\n<p>Note that you aren\u2019t guaranteed to get this output. It is perfectly possible that the child will be run after some but not all of the <code>write</code> calls from the parent, in which case it will not read all 20 <code>a</code>s at once and print shorter strings. That\u2019s why above I said that the <code>printf</code> call will always do the same thing <em>once all the data has been read</em>. To handle the case where not all the data has been written, you should check the return value of <code>read</code>. If it is less than 20 you didn\u2019t read the full string into the buffer (and should call <code>read</code> again with the destination pointer advanced so you don\u2019t overwrite your data); if it is zero then you\u2019ve reached end-of-file (the write end is closed); if it is negative there was an error and you should check <code>errno</code> to handle it.</p>\n"}], "owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2059, "favorite_count": 0, "accepted_answer_id": 45699622, "answer_count": 1, "score": 0, "last_activity_date": 1502823282, "creation_date": 1502822702, "question_id": 45699449, "link": "https://stackoverflow.com/questions/45699449/reading-and-writing-to-a-pipe-c-issue", "title": "reading and writing to a pipe c issue", "body": "<p>Here is the program:</p>\n\n<pre><code>  int fd[2];\n  char buf1 [31];\n  int i;\n  char buf2;\n\n  pipe(fd);\n\n  if (fork() == 0) { // child\n    close(fd[1]); // close writing pipe\n    for(i = 0; i&lt; 20; i++) { \n        read(fd[0], buf1, 30);\n        printf(\"%s\\n\", buf1);\n\n    }\n    close(fd[0]);\n  }\n\n  else { // parent\n    close(fd[0]); // close reading end\n    buf2 = 'a';\n    for (i = 0; i &lt; 20; i++) {\n        write(fd[1], &amp;buf2, sizeof(buf2));\n    }\n    close(fd[1]);\n  }\n  wait(NULL);\n</code></pre>\n\n<p>Since read blocks if there is nothing in there, we will first write to the pipe.</p>\n\n<p>My question is regarding the <strong>write</strong> function. The for loop runs 20 times, and each time I am writing an <code>a</code> to the pipe. After 20 iterations, the pipe on write end will contains <code>aaaaaaaaaaaaaaaaaaaa</code></p>\n\n<p>In the child, I read all 20 <code>a's</code> into <code>buf1</code>, and I print the result.</p>\n\n<p><strong>Now is the pipe empty, since we have wrote, and read what we wrote?</strong></p>\n\n<p>Since there is also a for loop here, we read again, but this time, I think the pipe is empty, so theres nothing to read. So I think the final output after 20 iterations of reading is just \n<code>aaaaaaaaaaaaaaaaaaaa</code></p>\n\n<p>But actually it's this:</p>\n\n<pre><code>aaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\naaaaaaaaaaaaaaaaaaaa\n</code></pre>\n\n<p>Why? Is the pipe not empty after we read?</p>\n"}, {"tags": ["python", "c", "distutils"], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 5512693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7388b896683137791b6ed0e37f96fba5?s=128&d=identicon&r=PG&f=1", "display_name": "GaryK4", "link": "https://stackoverflow.com/users/5512693/garyk4"}, "edited": false, "score": 0, "creation_date": 1502910853, "post_id": 45700830, "comment_id": 78400810, "body": "I have been reading the docs, but I&#39;m not sure that I understand them. I still get an error using your setup. File &quot;dist_c_call.py&quot;, line 2, in &lt;module&gt; import dist_funct  ImportError: /usr/local/lib/python2.7/dist-packages/dist_funct.so: undefined symbol: digitalWrite"}, {"owner": {"reputation": 235, "user_id": 5512693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7388b896683137791b6ed0e37f96fba5?s=128&d=identicon&r=PG&f=1", "display_name": "GaryK4", "link": "https://stackoverflow.com/users/5512693/garyk4"}, "edited": false, "score": 0, "creation_date": 1502912861, "post_id": 45700830, "comment_id": 78401729, "body": "I don&#39;t know why, but running the install twice made it work! I think I am OK for the moment. Thanks."}], "tags": [], "owner": {"reputation": 55797, "user_id": 7976758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512cfbaf98d63ca4acd57b2df792aec6?s=128&d=identicon&r=PG", "display_name": "phd", "link": "https://stackoverflow.com/users/7976758/phd"}, "is_accepted": false, "score": 1, "last_activity_date": 1502828098, "creation_date": 1502828098, "answer_id": 45700830, "question_id": 45699225, "link": "https://stackoverflow.com/questions/45699225/how-to-specify-a-library-to-compile-with-python-distutils/45700830#45700830", "title": "How to specify a library to compile with python distutils", "body": "<p>Explicitly list <code>libraries</code>:</p>\n\n<pre><code>from distutils.core import setup, Extension\n\nsetup(\n    name='dist_funct',\n    version='1.0',\n    ext_modules=[\n        Extension(\n            'dist_funct',\n            ['dist_funct.c'],\n            libraries=[\"wiringPi\"],\n        ),\n    ]\n)\n</code></pre>\n\n<p><code>Extension</code> has a lot of parameters, see <a href=\"https://docs.python.org/3/distutils/apiref.html#distutils.core.Extension\" rel=\"nofollow noreferrer\">the docs</a>.</p>\n"}], "owner": {"reputation": 235, "user_id": 5512693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7388b896683137791b6ed0e37f96fba5?s=128&d=identicon&r=PG&f=1", "display_name": "GaryK4", "link": "https://stackoverflow.com/users/5512693/garyk4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502828098, "creation_date": 1502821882, "last_edit_date": 1502827793, "question_id": 45699225, "link": "https://stackoverflow.com/questions/45699225/how-to-specify-a-library-to-compile-with-python-distutils", "title": "How to specify a library to compile with python distutils", "body": "<p>I am trying to create a c extension for python on my Raspberry Pi.\nMy setup.py looks like the following.\nMy c program uses the wiringPi library.\nHow do I instruct the setup program to use this library?\nWithout it, I get the following error.</p>\n\n<blockquote>\n  <p>\"ImportError: /usr/local/lib/python2.7/dist-packages/dist_funct.so: undefined symbol: digitalWrite\"</p>\n</blockquote>\n\n<pre><code>from distutils.core import setup, Extension\n\nsetup(name='dist_funct', version='1.0',\next_modules=[Extension('dist_funct', ['dist_funct.c'])])\n</code></pre>\n"}]