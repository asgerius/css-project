[{"tags": ["c"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 4, "creation_date": 1475711739, "post_id": 39885417, "comment_id": 67057545, "body": "Those <code>&amp;</code>s should be <code>&amp;&amp;</code>s. Idk if that&#39;s your problem, but that will probably bite you at some point."}, {"owner": {"reputation": 5635, "user_id": 365340, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/MxRJQ.jpg?s=128&g=1", "display_name": "Karthik Balaguru", "link": "https://stackoverflow.com/users/365340/karthik-balaguru"}, "edited": false, "score": 1, "creation_date": 1475711938, "post_id": 39885417, "comment_id": 67057598, "body": "Initial observation is that logical operator like &amp;&amp; should be used instead of  bitwise operator &amp;"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 5, "creation_date": 1475711971, "post_id": 39885417, "comment_id": 67057612, "body": "<code>char tempToken[10] = &quot;&quot;; strcpy(tempToken, current);</code> The input string is much longer than 9 characters (plus terminating NUL) so that <code>strcpy</code> will cause memory corruption."}, {"owner": {"reputation": 5635, "user_id": 365340, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/MxRJQ.jpg?s=128&g=1", "display_name": "Karthik Balaguru", "link": "https://stackoverflow.com/users/365340/karthik-balaguru"}, "edited": false, "score": 1, "creation_date": 1475712036, "post_id": 39885417, "comment_id": 67057620, "body": "Also, there is corruption as current is greater than tempToken while performing strcpy."}, {"owner": {"reputation": 43, "user_id": 2836976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9850329ef08bf321b90d0f37290492d9?s=128&d=identicon&r=PG&f=1", "display_name": "user2836976", "link": "https://stackoverflow.com/users/2836976/user2836976"}, "edited": false, "score": 0, "creation_date": 1475712303, "post_id": 39885417, "comment_id": 67057667, "body": "Ok, I understand using the logical operator and trying to copy in a string too large for that array.  Could corruption due to the tempChar array being too small really cause the later parts of the code to error?"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1475712313, "post_id": 39885417, "comment_id": 67057670, "body": "As @kaylum points out, you are writing past the end of your buffer, resulting in undefined behaviour. In this case, you are copying parts of your string into the memory locations occupied by <code>uppercaseLetters</code> <i>*Note:</i> <code>1734829927</code> is <code>67676767</code> in hex (=&quot;gggg&quot;), and <code>1111638594</code> is <code>42424242</code> (=&quot;BBB&quot;)."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1475712742, "post_id": 39885417, "comment_id": 67057757, "body": "@user2836976 memory corruption can cause all sorts of unpredictable behaviour. In C there is even a term for that - Undefined Behaviour. So, absolutely yes."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 6772771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03a034d02b334ad7b2b0bd5644fbd8f8?s=128&d=identicon&r=PG&f=1", "display_name": "Saaur", "link": "https://stackoverflow.com/users/6772771/saaur"}, "is_accepted": false, "score": 1, "last_activity_date": 1475715554, "last_edit_date": 1475715554, "creation_date": 1475714804, "answer_id": 39885811, "question_id": 39885417, "link": "https://stackoverflow.com/questions/39885417/frequency-of-characters-in-c-weird-numbers/39885811#39885811", "title": "Frequency of characters in C - weird numbers", "body": "<p>your call to strcpy:</p>\n\n<p>strcpy(tempToken, current);</p>\n\n<p>Is writing past the end of the buffer. This is producing undefined behavior, and in this case, effectively destroying the data you've collected in your 2 arrays.\nconsider using <a href=\"http://en.cppreference.com/w/c/string/byte/strlen\" rel=\"nofollow\">strnlen_s</a> to find the length of the buffer of which you are trying to make a temporary copy. and <a href=\"http://en.cppreference.com/w/c/string/byte/strcpy\" rel=\"nofollow\">strcpy_s</a> to ensure you do not overwrite the buffer.</p>\n\n<p>Additionally, at first glance, the usage of '&amp;' made me tilt my head. If this was not intentional, be very careful. It works here because the >= and &lt;= operators produce a boolean value, but in general is not the best idea for trying to find if two values are \"true\".</p>\n"}, {"tags": [], "owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "is_accepted": true, "score": 3, "last_activity_date": 1475715868, "creation_date": 1475715868, "answer_id": 39885940, "question_id": 39885417, "link": "https://stackoverflow.com/questions/39885417/frequency-of-characters-in-c-weird-numbers/39885940#39885940", "title": "Frequency of characters in C - weird numbers", "body": "<p>You are causing <strong><a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behaviour</a></strong> by writing past the end of a buffer. The main problem is here:</p>\n\n<pre><code>char tempToken[10] = \"\";\nstrcpy(tempToken, current);\n</code></pre>\n\n<p>Since you don't check the length of the string at <code>current</code> before copying it to <code>tempToken</code>, you are liable to go past the 9-character limit (allowing one extra character for the terminating <code>'\\0'</code> byte) and corrupt the memory allocated to other data.</p>\n\n<p>In your case, this is what the stack looks like when the program calls <code>printStatistics()</code>: (but see note below)</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>+--------------------+--------------------------+--------------------------+--------------\n| char tempToken[10] | int uppercaseLetters[26] | int lowercaseLetters[26] | token, etc...\n+--------------------+--------------------------+--------------------------+--------------\n</code></pre>\n\n<p>When you copy the string <code>gggggggggggggggggggg BBBBBBBBBBBBBB...</code> to <code>tempToken</code>, the first ten characters fill this array completely, and the remainder are written into the array <code>uppercaseLetters</code> instead. So when you fetch your data from this array, you are actually reading back these ASCII characters (1734829927 == 0x67676767  == \"gggg\"; 1111638594 == 0x42424242 == \"BBBB\").</p>\n\n<p>If you copy a longer string, you will also overwrite <code>lowercaseLetters</code>, followed by the other variables (<code>token</code>, etc.).</p>\n\n<p>The <a href=\"http://man7.org/linux/man-pages/man3/strcpy.3.html\" rel=\"nofollow\"><code>strncpy()</code></a> function is designed to avoid this sort of problem. You should use it too.</p>\n\n<hr>\n\n<p>Also, as others have pointed out, you are using a bitwise \"and\" operator <code>&amp;</code> where a logical \"and\" <code>&amp;&amp;</code> is required.</p>\n\n<hr>\n\n<blockquote>\n  <ul>\n  <li><strong>Note:</strong> Other systems and other compilers will store things differently, and will misbehave in other ways. Your code simply crashed when compiled on my computer.</li>\n  </ul>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1514188183, "post_id": 39887212, "comment_id": 82902953, "body": "Well this is a weird questions to have that test case, but yes, we would need to sort further if there were going to be multiple occurrences of the same letter. Instead of just testing the first letter, I would have to write in a comparison until they are no longer the same. I&#39;ll update with another version to handle the same first char, but it will have to be in the morning."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 2, "last_activity_date": 1475725687, "creation_date": 1475725687, "answer_id": 39887212, "question_id": 39885417, "link": "https://stackoverflow.com/questions/39885417/frequency-of-characters-in-c-weird-numbers/39887212#39887212", "title": "Frequency of characters in C - weird numbers", "body": "<p>The big issues have already been properly covered, but there are a couple of extra observations, too long for comment. First, try to avoid using <em>magic numbers</em> in your code. If you need a constant for <code>26</code>, <code>#define</code> one or use an <code>enum</code>, e.g. </p>\n\n<pre><code>#define ABET 26\n</code></pre>\n\n<p>or</p>\n\n<pre><code>enum { ABET = 26 };\n</code></pre>\n\n<p>Then you can use the constant throughout your code (and you only have to change it in a single location if you need to adjust it later). Then you can do something similar to the following (note: I dislike typing, so your <code>lowercaseletters</code> has simply been replace with <code>lc</code> below, etc...</p>\n\n<pre><code>int count = 0, i = 0, len = (int)strlen (s),\n    lc[ABET] = { 0 },\n    uc[ABET] = { 0 };\n...\nfor (i = 0; i &lt; ABET; i++)\n</code></pre>\n\n<p>Next, there is no need for two separate loops to fill the upper/lower frequency arrays, e.g. (and replacing <code>current</code> with <code>s</code>)</p>\n\n<pre><code>/* no need for 2 separate loops */\nfor (i = 0; i &lt; len; i++) {\n    if ('a' &lt;= s[i] &amp;&amp; s[i] &lt;= 'z')\n        lc[s[i] - 'a']++;\n    if ('A' &lt;= s[i] &amp;&amp; s[i] &lt;= 'Z')\n        uc[s[i] - 'A']++;\n}\n</code></pre>\n\n<p>(<em>note:</em> writing your comparison as <code>if ('a' &lt;= s[i] &amp;&amp; s[i] &lt;= 'z')</code> may make the values within each set a bit more apparent, that's just a matter of taste, either way is correct)</p>\n\n<p>You may also find declaring a set of <code>delimiters</code> in a variable (say <code>delim</code>) provides a convenient way to prevent hardcoding the delimiters within each of your <code>strtok</code> calls adding to maintainability, e.g.</p>\n\n<pre><code>char *delim = \" \\t,;\\\"'\";\n</code></pre>\n\n<p>There is nothing wrong with your use of <code>while</code> with <code>strtok</code>, but since you are only interested in <code>token</code> within loop scope, using a <code>for</code> loop and <code>c99</code> loop declaration results in a slightly more compact expression, e.g.</p>\n\n<pre><code>for (char *tok = strtok (tmp, delim); tok; tok = strtok (NULL, delim))\n    count++;\n</code></pre>\n\n<p>In <code>printStatistics</code>, (<code>prnstats</code> below) what happens if your <code>current</code> (my <code>s</code>) is <code>NULL</code> or <em>empty</em>? Since you cannot classify the frequency of either, a simple check at the beginning of your function can prevent undefined behavior.</p>\n\n<pre><code>if (!s || !*s) return;\n</code></pre>\n\n<p>You can include an error message if you like, e.g.</p>\n\n<pre><code>if (!s || !*s) {\n    fprintf (stderr, \"prnstats() error: invalid parameter.\\n\");\n    return;\n}\n</code></pre>\n\n<p>Putting all of that together, along with the traditional elimination of the <code>MixedCase</code> or <code>camelCase</code> variables in C, and eliminated a bit more typing, you could do something similar to the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define ABET 26\n\nvoid prnstats (const char *s);\n\nint main (int argc, char **argv) {\n\n    char *s = argc &gt; 1 ? argv[1] :\n                \"a quick brown fox jumps over the lazy dog.\"\n                \"A QUICK BROWN FOX JUMPS OVER THE LAZY DOG.\";\n\n    prnstats (s);\n\n    return 0;\n}\n\nvoid prnstats (const char *s)\n{\n    if (!s || !*s) return;\n\n    int count = 0, i = 0, len = (int)strlen (s),\n        lc[ABET] = { 0 },\n        uc[ABET] = { 0 };\n    char *delim = \" \\t,;\\\"'\";\n\n    /* no need for 2 separate loops */\n    for (i = 0; i &lt; len; i++) {\n        if ('a' &lt;= s[i] &amp;&amp; s[i] &lt;= 'z')\n            lc[s[i] - 'a']++;\n        if ('A' &lt;= s[i] &amp;&amp; s[i] &lt;= 'Z')\n            uc[s[i] - 'A']++;\n    }\n\n    char tmp[len + 1];    /* a vla is fine here */\n    strcpy (tmp, s);\n    for (char *tok = strtok (tmp, delim); tok; tok = strtok (NULL, delim))\n        count++;\n\n    printf (\"Statistics:\\n\"\n            \"  length :  %3d\\n\" \n            \"  words  :  %3d\\n\\n\", len, count);\n\n    /* no need for 2 separate loops for dual-columns */\n    printf (\"Frequency:\\n  Uppercase    Lowercase\\n\\n\");\n    for (i = 0; i &lt; ABET; i++)\n        printf (\"    %c : %2d       %c : %2d\\n\",\n                'A' + i, uc[i], 'a' + i, lc[i]);\n\n}\n</code></pre>\n\n<p>Look things over, think about why words is <code>17</code> below, and let me know if you have any questions.</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/wordfreq\nStatistics:\n  length :   84\n  words  :   17\n\nFrequency:\n  Uppercase    Lowercase\n\n    A :  2       a :  2\n    B :  1       b :  1\n    C :  1       c :  1\n    D :  1       d :  1\n    E :  2       e :  2\n    F :  1       f :  1\n    G :  1       g :  1\n    H :  1       h :  1\n    I :  1       i :  1\n    J :  1       j :  1\n    K :  1       k :  1\n    L :  1       l :  1\n    M :  1       m :  1\n    N :  1       n :  1\n    O :  4       o :  4\n    P :  1       p :  1\n    Q :  1       q :  1\n    R :  2       r :  2\n    S :  1       s :  1\n    T :  1       t :  1\n    U :  2       u :  2\n    V :  1       v :  1\n    W :  1       w :  1\n    X :  1       x :  1\n    Y :  1       y :  1\n    Z :  1       z :  1\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 2836976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9850329ef08bf321b90d0f37290492d9?s=128&d=identicon&r=PG&f=1", "display_name": "user2836976", "link": "https://stackoverflow.com/users/2836976/user2836976"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 39885940, "answer_count": 3, "score": 0, "last_activity_date": 1475725687, "creation_date": 1475711634, "last_edit_date": 1475713399, "question_id": 39885417, "link": "https://stackoverflow.com/questions/39885417/frequency-of-characters-in-c-weird-numbers", "title": "Frequency of characters in C - weird numbers", "body": "<p>Here is my function:</p>\n\n<pre><code>void printStatistics(const char *current) {\n    int count = 0, i = 0, length = strlen(current);\n    int lowercaseLetters[26] = {0};\n    int uppercaseLetters[26] = {0};\n    char *token;\n\n    for (i = 0; i &lt; length; i++) {\n        if (current[i] &gt;= 'a' &amp; current[i] &lt;= 'z') {\n            lowercaseLetters[current[i] - 'a']++;\n        }\n    }\n\n    for (i = 0; i &lt; length; i++) {\n        if (current[i] &gt;= 'A' &amp; current[i] &lt;= 'Z') {\n            uppercaseLetters[current[i] - 'A']++;\n        }\n    }\n\n    char tempToken[10] = \"\";\n    strcpy(tempToken, current);\n    token = strtok(tempToken, \" \");\n    while (token != NULL) {\n        token = strtok(NULL, \" \");\n        count++;\n    }\n\n    printf(\"Statistics:\\n\"\n           \"\\tlength:\\t\\t%d\\n\"\n           \"\\tword:\\t\\t%d\\n\"\n           \"Frequency:\\n\", length, count);\n\n    printf(\"Printing Uppercase matrix...\\n\");\n    for (i = 0; i &lt; 26; i++) {\n        printf(\"\\tfrequency of %c:\\t%d\\n\", 'a' + i, uppercaseLetters[i]);\n    }\n\n    printf(\"Printing Lowercase matrix...\\n\");\n    for (i = 0; i &lt; 26; i++) {\n        printf(\"\\tfrequency of %c:\\t%d\\n\", 'a' + i, lowercaseLetters[i]);\n    }\n}\n</code></pre>\n\n<p>and here is what I get when I try to check string <code>gggggggggggggggggggg BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB</code></p>\n\n<pre><code>Statistics:\n    length:         74\n    word:           2\nFrequency:\nPrinting Uppercase matrix...\n    frequency of a: 1734829927\n    frequency of b: 1734829927\n    frequency of c: 1107322727\n    frequency of d: 1111638594\n    frequency of e: 1111638594\n    frequency of f: 1111638594\n    frequency of g: 1111638594\n    frequency of h: 1111638594\n    frequency of i: 1111638594\n    frequency of j: 1111638594\n    frequency of k: 1111638594\n    frequency of l: 1111638594\n    frequency of m: 1111638594\n    frequency of n: 1111638594\n    frequency of o: 1111638594\n    frequency of p: 1111638594\n    frequency of q: 0\n    frequency of r: 0\n    frequency of s: 0\n    frequency of t: 0\n    frequency of u: 0\n    frequency of v: 0\n    frequency of w: 0\n    frequency of x: 0\n    frequency of y: 0\n    frequency of z: 0\nPrinting Lowercase matrix...\n    frequency of a: 0\n    frequency of b: 0\n    frequency of c: 0\n    frequency of d: 0\n    frequency of e: 0\n    frequency of f: 0\n    frequency of g: 20\n    frequency of h: 0\n    frequency of i: 0\n    frequency of j: 0\n    frequency of k: 0\n    frequency of l: 0\n    frequency of m: 0\n    frequency of n: 0\n    frequency of o: 0\n    frequency of p: 0\n    frequency of q: 0\n    frequency of r: 0\n    frequency of s: 0\n    frequency of t: 0\n    frequency of u: 0\n    frequency of v: 0\n    frequency of w: 0\n    frequency of x: 0\n    frequency of y: 0\n    frequency of z: 0\n</code></pre>\n\n<p>Why am I getting these weird long numbers in the uppercase matrix?  It seems like I'm not indexing outside of the uppercase array - I'm handling it in the exact same way as the lowercase array.  </p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["c", "arrays", "cs50"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1475711605, "post_id": 39885384, "comment_id": 67057507, "body": "Read the code you posted more closely. Where do you put the input you get with <code>scanf()</code>? Where are you trying to read the initials from? (The way you&#39;re getting your input is incorrect, but that&#39;s a different issue entirely.) You should ask your instructor or teaching assistant for some extra help."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475712630, "post_id": 39885384, "comment_id": 67057744, "body": "<code>scanf(&quot;%s&quot;, &amp;leng[100]);</code> : <code>leng[100]</code> is next of last element. should be <code>&amp;leng[0]</code> or just <code>leng</code>. Also <code>%s</code> doesn&#39;t include white-spaces. So <code>%s</code> change to <code>%99[^\\n]</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475712778, "post_id": 39885384, "comment_id": 67057764, "body": "<code>char name[len];</code> --&gt; <code>char name[len+1];</code> then <code>strcpy(name, leng);</code> Also first character of  name isn&#39;t print."}], "answers": [{"tags": [], "owner": {"reputation": 13430, "user_id": 622571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41523c6db74e0f187eae731a6871a320?s=128&d=identicon&r=PG", "display_name": "Richard Schwartz", "link": "https://stackoverflow.com/users/622571/richard-schwartz"}, "is_accepted": false, "score": 2, "last_activity_date": 1475712516, "last_edit_date": 1475712516, "creation_date": 1475711946, "answer_id": 39885466, "question_id": 39885384, "link": "https://stackoverflow.com/questions/39885384/i-am-trying-to-create-a-program-that-takes-a-name-and-outputs-the-initials-but-k/39885466#39885466", "title": "I am trying to create a program that takes a name and outputs the initials but keep running into an array error", "body": "<p>These two lines are incorrect:</p>\n\n<pre><code>scanf(\"%s\", &amp;leng[100]);\nlen = strlen(&amp;leng[100]);\n</code></pre>\n\n<p>If you translate these into English, their meanings as written are:</p>\n\n<ul>\n<li>Scan a string to the memory at the address of 101st element of the\nleng array. </li>\n<li>Get the length of the string that starts at the address\nof the 101st element of the leng array.</li>\n</ul>\n\n<p>The array index is out of bounds because leng[100] is past the end of the array.  Remember that a 100 element array goes from 0 to 99, not from 1 to 100!</p>\n\n<p>You want to be scanning into the base address of the array, and passing the base address of the array into strlen(). I'll leave the syntax for you to figure out from your textbook.</p>\n\n<p>And by the way, you also have a problem in your code because you're reading your data into an array named leng, but your loop is working with an array named len. There are at least two additional problems in your code, but I'll leave them for you to debug. </p>\n"}, {"tags": [], "owner": {"reputation": 405, "user_id": 6870832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26263481771ee7b018c7b3ccdba56d30?s=128&d=identicon&r=PG&f=1", "display_name": "phreaknik", "link": "https://stackoverflow.com/users/6870832/phreaknik"}, "is_accepted": false, "score": 0, "last_activity_date": 1475715271, "last_edit_date": 1495535655, "creation_date": 1475715271, "answer_id": 39885865, "question_id": 39885384, "link": "https://stackoverflow.com/questions/39885384/i-am-trying-to-create-a-program-that-takes-a-name-and-outputs-the-initials-but-k/39885865#39885865", "title": "I am trying to create a program that takes a name and outputs the initials but keep running into an array error", "body": "<p>There are a few things to consider with your code. As @richardschwartz already mentioned, you are not referencing your char arrays correctly. you have:</p>\n\n<pre><code>scanf(\"%s\", &amp;leng[100]);\nlen = strlen(&amp;leng[100]);\n</code></pre>\n\n<p>You may want the following instead:</p>\n\n<pre><code>scanf(\"%s\", leng);\nlen = strlen(leng);\n</code></pre>\n\n<p>Also, keep in mind that scanf with the %s flag will stop reading input once white-space is detected. For example, if you input \"hello world\", </p>\n\n<pre><code>scanf(\"%s\", leng);\n</code></pre>\n\n<p>will only catch the characters \"hello\". To get around this, you could loop scanf to read multiple words and return the first character of each word as you desire.</p>\n\n<p>Lastly, scanf is not advised for beginners though. See paxdiablo's excellent reason regarding lack of overflow protection, here: <a href=\"https://stackoverflow.com/a/1248017/6870832\">https://stackoverflow.com/a/1248017/6870832</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6891104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14c6e54061a9965f5f90262aedbf87e3?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Dude", "link": "https://stackoverflow.com/users/6891104/mr-dude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1475715271, "creation_date": 1475711411, "last_edit_date": 1475711932, "question_id": 39885384, "link": "https://stackoverflow.com/questions/39885384/i-am-trying-to-create-a-program-that-takes-a-name-and-outputs-the-initials-but-k", "title": "I am trying to create a program that takes a name and outputs the initials but keep running into an array error", "body": "<p>I am trying to create a program that take the input from the user and prints the first character of each word but every time I try to  Here is my code.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;cs50.h&gt;\n #include &lt;string.h&gt;\n\nint main(void)\n{\n    char leng[100];\n    int len;\n    scanf(\"%s\", &amp;leng[100]);\n    len = strlen(&amp;leng[100]);\n    char name[len];\n    //checking if at end or not\n    while (name[len] != '\\0')\n    {\n        if (name[len] == ' ')\n            printf(\"%c\", name[len + 1]);\n        len++;\n    }\n}\n</code></pre>\n\n<p>Every time I give a name it shows an error something like: </p>\n\n<pre><code>index 3 out of bounds for type 'char [len]'\n</code></pre>\n"}, {"tags": ["c", "queue"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1475710429, "post_id": 39885213, "comment_id": 67057188, "body": "Use a debugger. At a minimum it will tell you exactly which line is triggering the seg fault. And much more."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1475710577, "post_id": 39885213, "comment_id": 67057239, "body": "<code>queue q;</code> that is an uninitialised variable. It contains junk values. All bets are off from that point on."}, {"owner": {"reputation": 5635, "user_id": 365340, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/MxRJQ.jpg?s=128&g=1", "display_name": "Karthik Balaguru", "link": "https://stackoverflow.com/users/365340/karthik-balaguru"}, "edited": false, "score": 0, "creation_date": 1475711058, "post_id": 39885213, "comment_id": 67057362, "body": "To begin with, you may need to have one more function like createqueue where you initialize the queue."}], "owner": {"reputation": 187, "user_id": 6428195, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/1363960020286658/picture?type=large", "display_name": "Pavel Vasiluk", "link": "https://stackoverflow.com/users/6428195/pavel-vasiluk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475710047, "creation_date": 1475710047, "question_id": 39885213, "link": "https://stackoverflow.com/questions/39885213/queue-array-implementation-dequeue-function", "title": "Queue array implementation: dequeue function", "body": "<p>Stuck on the problem with array queue dequeue function implementation.\nIt seems that the function itself is correct, but the problem is as far as I understand the pointer in parameters. Why do I exit with Segmentation fault here? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define CAPACITY 3\n\ntypedef struct {\n        int head;\n        int size;\n        int elements[CAPACITY];\n        } queue;\n\nbool isempty(queue* q);\nint size(queue* q);\nbool enqueue(queue* q, int element);\nbool dequeue(queue* q, int* element);\n\n\nint main(void) {\n\nqueue q;\n\nif(isempty(&amp;q)) {\n    printf(\"Queue is empty\\n\");\n}\n\nenqueue(&amp;q, 34);\nenqueue(&amp;q, 2);\nenqueue(&amp;q, 4);\ndequeue(&amp;q, &amp;q.head);\n\nif(!isempty(&amp;q)) {\n    printf(\"Queue is not empty\\n\");\n}\n\nprintf(\"%i\\n\", q.elements[1]);\n\n}\n\nbool isempty(queue* q) {\n    return q-&gt;size == 0;\n}\n\nint size(queue* q) {\n    return q-&gt;size;\n}\n\nbool enqueue(queue* q, int element) {\n\n    if(q-&gt;size &lt; CAPACITY) {\n        q-&gt;elements[(q-&gt;head + q-&gt;size) % CAPACITY] = element;\n        q-&gt;size++;\n        printf(\"Enqueue: %d\\n\", element);\n        return true;\n    }\n\n    return false;\n}\n\nbool dequeue(queue* q, int* element) {\n\n    if(q-&gt;size &gt; 0) {\n        *element = q-&gt;elements[q-&gt;head];\n        q-&gt;head = (q-&gt;head+1) % CAPACITY;\n        q-&gt;size--;\n\n        return true;\n    }\n\n    return false;\n}   \n</code></pre>\n"}, {"tags": ["c", "string", "malloc"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475710047, "post_id": 39885191, "comment_id": 67057113, "body": "<code>bigString = malloc(sizeof(char)* 4096);</code> --&gt;<code>bigString = malloc(sizeof(char)* 4096+1); bigString[4096] = 0;</code>"}, {"owner": {"reputation": 3, "user_id": 6929077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08575e3724530a15df8f01fdd9b96ff9?s=128&d=identicon&r=PG&f=1", "display_name": "ererere", "link": "https://stackoverflow.com/users/6929077/ererere"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475710187, "post_id": 39885191, "comment_id": 67057143, "body": "That returns an invalid write of size 1 :/"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475710985, "post_id": 39885191, "comment_id": 67057346, "body": "Did you change <code>i&lt;4096</code> ?"}, {"owner": {"reputation": 3, "user_id": 6929077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08575e3724530a15df8f01fdd9b96ff9?s=128&d=identicon&r=PG&f=1", "display_name": "ererere", "link": "https://stackoverflow.com/users/6929077/ererere"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475711110, "post_id": 39885191, "comment_id": 67057378, "body": "Yeah never mind it works now."}], "answers": [{"tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": true, "score": 2, "last_activity_date": 1475709989, "creation_date": 1475709989, "answer_id": 39885210, "question_id": 39885191, "link": "https://stackoverflow.com/questions/39885191/invalid-read-of-size-1-when-mallocing-large-string/39885210#39885210", "title": "Invalid read of Size 1 when mallocing large String", "body": "<p><code>bigString</code> itself is not null-terminated, so <code>strlen(bigString)</code> results in trying to read past the end of the space allocated for <code>bigString</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "is_accepted": false, "score": 1, "last_activity_date": 1475746165, "last_edit_date": 1475746165, "creation_date": 1475710048, "answer_id": 39885214, "question_id": 39885191, "link": "https://stackoverflow.com/questions/39885191/invalid-read-of-size-1-when-mallocing-large-string/39885214#39885214", "title": "Invalid read of Size 1 when mallocing large String", "body": "<p>You forgot to add a <code>\\0</code> at the end of <code>BigString</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 6929077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08575e3724530a15df8f01fdd9b96ff9?s=128&d=identicon&r=PG&f=1", "display_name": "ererere", "link": "https://stackoverflow.com/users/6929077/ererere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 39885210, "answer_count": 2, "score": 0, "last_activity_date": 1475746165, "creation_date": 1475709826, "question_id": 39885191, "link": "https://stackoverflow.com/questions/39885191/invalid-read-of-size-1-when-mallocing-large-string", "title": "Invalid read of Size 1 when mallocing large String", "body": "<p>I have a unique case where I'm trying to store a 4096 character string in a struct member. However, I'm mallocing the usually amount of memory for a shorter string, but am still getting a valgrind error:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nstruct List {\n    char * name;\n    int grade;\n    struct List * next;\n};\nint main(void) {\n    struct List * newList;\n    char * bigString;\n    int i;\n    bigString = malloc(sizeof(char)* 4096);\n\n    for (i=0; i&lt;4096; i++)\n      bigString[i] = 'a';\n\n\n    newList = malloc(sizeof(struct List));\n    newList-&gt;next = NULL;\n    newList-&gt;name = malloc(strlen(bigString)+1);\n    free(bigString);\n\n\n    free(newList-&gt;name);\n    free(newList);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>the line:</p>\n\n<pre><code>newList-&gt;name = malloc(strlen(bigString)+1);\n</code></pre>\n\n<p>Returns an error <code>Invalid read of size 1</code></p>\n\n<p>But wait a second, I'm mallocing the lenght of the string, plus 1 for the null terminator, what's going on here?</p>\n\n<p>In fact I even tried this:</p>\n\n<pre><code>newList-&gt;name = malloc(sizeof(char) * strlen(bigString) +1);\n</code></pre>\n\n<p>And heck I even tried to null terminate the string after the malloc call:</p>\n\n<pre><code>newList-&gt;name[strlen(bigString)] = '\\0';\n</code></pre>\n\n<p>To no avail..</p>\n\n<p>I'm actually beyond confused as to what I've done wrong here. Any ideas?</p>\n"}, {"tags": ["c", "visual-studio", "codeblocks"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4236847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c0qwd.png?s=128&g=1", "display_name": "SushiSlayer", "link": "https://stackoverflow.com/users/4236847/sushislayer"}, "edited": false, "score": 0, "creation_date": 1475710301, "post_id": 39885182, "comment_id": 67057163, "body": "Thanks! That was interesting. I still don&#39;t know why it is happening, but that fixed it. Any help with the issue of why M_PI is not displaying the expected value?"}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "reply_to_user": {"reputation": 85, "user_id": 4236847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c0qwd.png?s=128&g=1", "display_name": "SushiSlayer", "link": "https://stackoverflow.com/users/4236847/sushislayer"}, "edited": false, "score": 1, "creation_date": 1475711074, "post_id": 39885182, "comment_id": 67057365, "body": "<code>M_PI</code> is not in the C-standard, so MSVC is right here (for a change). But what is the expected value and what is the actual value? If you think <code>3.14159265358979311600</code> is wrong, that&#39;s...uhm...wrong. It is the correctly rounded result, a double cannot hold more."}], "tags": [], "owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "is_accepted": true, "score": 0, "last_activity_date": 1475709770, "creation_date": 1475709770, "answer_id": 39885182, "question_id": 39885105, "link": "https://stackoverflow.com/questions/39885105/errors-when-switching-back-and-forth-between-visualstudio-and-codeblocks-using-c/39885182#39885182", "title": "errors when switching back and forth between VisualStudio and CodeBlocks using C", "body": "<p>For some unknown reasons MSVS needs <code>#define _USE_MATH_DEFINES</code> before the inclusion of <code>math.h</code></p>\n"}], "owner": {"reputation": 85, "user_id": 4236847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c0qwd.png?s=128&g=1", "display_name": "SushiSlayer", "link": "https://stackoverflow.com/users/4236847/sushislayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 39885182, "answer_count": 1, "score": 1, "last_activity_date": 1475709770, "creation_date": 1475709296, "question_id": 39885105, "link": "https://stackoverflow.com/questions/39885105/errors-when-switching-back-and-forth-between-visualstudio-and-codeblocks-using-c", "title": "errors when switching back and forth between VisualStudio and CodeBlocks using C", "body": "<p>I am learning to program late in life (50+ yrs old). I am using Visual Studio 2015 and Code::Blocks ver 16.01.</p>\n\n<p>I have some questions.</p>\n\n<p>First, why do VS and CB require \u2018tweaks\u2019 to make them compile and run the code included below?\nWhat is up with M_PI? (I thought it was part of , but apparently VS doesn't recognize it) \nWhy do I have to do a #define in VS but not in CB?\nWhy doesn\u2019t M_PI display its defined value?</p>\n\n<p>Side note: I understand scanff has been deprecated, but if you must go down that path feel free. We are required to use it in class.</p>\n\n<p>This is my initial entry into Code Blocks.\nIt compiles and runs.\nthis uses stdio.h and math.h</p>\n\n<pre><code> // &gt;&gt;&gt;&gt; CODEBLOCKS VERSION &lt;&lt;&lt;&lt;\n    #include &lt;stdio.h&gt;\n    #include &lt;math.h&gt;\n\n    // M_PI is 3.14159265358979323849\n\n    int main ( void )\n    {\n        double myNumber = 0.0;\n\n        printf(\"Enter a number.\\n\");\n        scanf(\"%lf\", &amp;myNumber);\n\n        printf(\"You entered: %lf.\", myNumber);\n        printf(\"This is the value of pi: %.20lf.\", M_PI);\n\n        return 0;\n    }\n</code></pre>\n\n<p>When I paste this into Visual Studio and compile, I get an error. Specifically, \u2018identifier \u201cM_PI\u201d is undefined\u2019.\nIf I add #define M_PI 3.14159265358979323849, the error goes away, BUT I get\nCode C4996 -- 'scanf': This function or variable may be unsafe. Consider using scanf_s instead. To disable deprecation, use _CRT_SECURE_NO_WARNINGS. See online help for details.\nIf I change the scanf to scanf_s the error clears, code compiles and runs the same as the codeblocks version.\nThis uses stdio.h and math.h and </p>\n\n<pre><code> // &gt;&gt;&gt;&gt; VISUAL STUDIO VERSION &lt;&lt;&lt;&lt;\n    #include &lt;stdio.h&gt;\n    #include &lt;math.h&gt;\n\n    #define M_PI 3.14159265358979323849\n\n    int main(void)\n    {\n        double myNumber = 0.0;\n\n        printf(\"Enter a number.\\n\");\n        scanf_s(\"%lf\", &amp;myNumber);\n\n        printf(\"You entered: %lf.\", myNumber);\n        printf(\"This is the value of pi: %.20lf.\", M_PI);\n\n        return 0;\n    }\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2271770"}, "edited": false, "score": 0, "creation_date": 1475710398, "post_id": 39884972, "comment_id": 67057179, "body": "In the function <code>create</code> you link the <code>.next</code> field of <code>temp</code> to <code>temp</code> (because you do <code>p = temp; temp-&gt;next = p;</code>)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475712760, "post_id": 39884972, "comment_id": 67057759, "body": "Why do you use a circular list?  Why not a regular (non-circular) list?  There isn&#39;t an obvious benefit that I can see."}], "answers": [{"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": true, "score": 2, "last_activity_date": 1475713383, "last_edit_date": 1475713383, "creation_date": 1475710440, "answer_id": 39885274, "question_id": 39884972, "link": "https://stackoverflow.com/questions/39884972/polynomial-in-circular-linked-list/39885274#39885274", "title": "Polynomial in Circular Linked List", "body": "<p>You just need to change:</p>\n\n<pre><code> do{\n        printf(\"%dx^(%d)\",temp-&gt;coef,temp-&gt;exp);\n        temp = temp-&gt;next;\n        ...\n</code></pre>\n\n<p>Right now you are dereferencing the initial node every time you go through the display loop!</p>\n\n<p>I want to point out that, as the <code>display()</code> function is written right now, you will have a segfault if a NULL pointer is ever passed to it. Exactly that happens if you enter <code>0</code> at either of the prompts for <code>Number of terms:</code>.</p>\n"}], "owner": {"reputation": 129, "user_id": 5711732, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UIffb.jpg?s=128&g=1", "display_name": "Chanchal Roshan", "link": "https://stackoverflow.com/users/5711732/chanchal-roshan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1817, "favorite_count": 0, "accepted_answer_id": 39885274, "answer_count": 1, "score": 1, "last_activity_date": 1475713383, "creation_date": 1475708463, "last_edit_date": 1475708764, "question_id": 39884972, "link": "https://stackoverflow.com/questions/39884972/polynomial-in-circular-linked-list", "title": "Polynomial in Circular Linked List", "body": "<p>While printing the polynomial the first coefficient and exponent are getting printed repeatedly for n( no of terms ) times.</p>\n\n<pre><code>Input:\n     No of terms: 3\n     Enter coefficient and exponent: 3 3\n     Enter coefficient and exponent: 2 2\n     Enter coefficient and exponent: 1 1\n\nOutput:\n3x^(3) + 3x^(3) + 3x^(3)\n</code></pre>\n\n<p>This is the code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct Node{\n    int coef , exp;\n    struct Node* next;\n};\n\nstruct Node* create( struct Node* );\n\nint main(){\n\n    int val , choice , loc;\n    struct Node* A = NULL;\n    struct Node* B = NULL;\n\n    A = create( A );\n    B = create( B );\n    display( A );\n    display( B );\n\n    do{\n        printf(\"\\n\\n-----POLYNOMIAL OPERATIONS-----\\n1.Addition\\n2.Multiply\\n3.Evaluate\\n4.Exit\\n---&gt;\");\n        scanf(\"%d\",&amp;choice);\n\n        switch( choice ){\n            case 1://Adding\n                    break;\n            case 2://Multiplying\n                    break;\n            case 3://Evaluating\n                    break;\n        }\n\n    }while( choice != 4 );\n\n\n    return 0;\n}\n\nstruct Node* create( struct Node* p ){\n\n    int i , c , x , t;\n    printf(\"\\nNumber of terms: \");\n    scanf(\"%d\",&amp;t);\n    for( i = 0 ; i &lt; t ; i++ ){\n        struct Node* temp = (struct Node*)malloc(sizeof(struct Node));\n        printf(\"Enter Coefficient &amp; Exponent: \");\n        scanf(\"%d%d\",&amp;c,&amp;x);\n        temp-&gt;coef = c;\n        temp-&gt;exp = x;\n        if( p == NULL ){\n            p = temp;\n            temp-&gt;next = p;\n        }else{\n            struct Node* temp1 = p;\n            while( temp1-&gt;next != p ) temp1 = temp1-&gt;next;\n            temp1-&gt;next = temp;\n            temp-&gt;next = p;\n        }\n    }\n    return p;\n}\n\nvoid display( struct Node* p ){\n\n    struct Node* temp = p;\n    printf(\"\\nPOLYNOMIAL: \");\n\n    do{\n        printf(\"%dx^(%d)\",p-&gt;coef,p-&gt;exp);\n        temp = temp-&gt;next;\n        if( temp != p ){\n            printf(\" + \");\n        }\n    }while( temp != p );\n}\n</code></pre>\n"}, {"tags": ["c", "image-processing", "vectorization", "simd", "sse2"], "answers": [{"comments": [{"owner": {"reputation": 680, "user_id": 6599487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ddd2b21482646c3a8acade4555c324?s=128&d=identicon&r=PG&f=1", "display_name": "Holmz", "link": "https://stackoverflow.com/users/6599487/holmz"}, "edited": false, "score": 1, "creation_date": 1475757478, "post_id": 39885629, "comment_id": 67077996, "body": "You other option is see if the compiler will vectorise it first, and then if you need more that the compiler can do, then add in intrinsics later. ideally we all use vanilla code and the compiler does SSE, AXV or whatever the machine supports if it is something that the compiler writers have set it up to optimize."}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "edited": false, "score": 0, "creation_date": 1475813956, "post_id": 39885629, "comment_id": 67103554, "body": "@Peter Cordez - Unfortunately, now I can&#39;t even figure out a way to load my bytes into a 16-byte vector. The load/store commands all seem to use vectors for both results and arguments - including addresses! My intuition would have been that I provide (as a load argument) an address from my byte array, but that&#39;s not possible because the load intrinsics require vectors as arguments. And I can&#39;t find an intrinsic that returns an (address) vector from a normal, scalar 64-bit address!"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "edited": false, "score": 0, "creation_date": 1475856234, "post_id": 39885629, "comment_id": 67126619, "body": "@sacheie: right, for integer you have to use <code>_mm_loadu_si128( (const __m128i*) my_int_pointer )</code>.  You would have found this out if you&#39;d looked at any of the tutorials linked from the tag wikis."}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "edited": false, "score": 0, "creation_date": 1475884450, "post_id": 39885629, "comment_id": 67137989, "body": "Perhaps I would have; perhaps you give me too much credit ;)  In any case, I did observe that one can simply cast between vector types and arrays of scalars, which worked for me.  But sincerely, thank you for your patience Peter."}, {"owner": {"reputation": 27199, "user_id": 427158, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f706984800b6d136b9331a6ee20c676f?s=128&d=identicon&r=PG", "display_name": "maxschlepzig", "link": "https://stackoverflow.com/users/427158/maxschlepzig"}, "edited": false, "score": 0, "creation_date": 1536781521, "post_id": 39885629, "comment_id": 91552668, "body": "@PeterCordes - for integer you can also use <code>_mm_lddqu_si128()</code> - main difference: &#39;This intrinsic may perform better than _mm_loadu_si128 when the data crosses a cache line boundary.&#39; (from the Intel reference)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 27199, "user_id": 427158, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f706984800b6d136b9331a6ee20c676f?s=128&d=identicon&r=PG", "display_name": "maxschlepzig", "link": "https://stackoverflow.com/users/427158/maxschlepzig"}, "edited": false, "score": 1, "creation_date": 1536781734, "post_id": 39885629, "comment_id": 91552754, "body": "@maxschlepzig: only on Pentium 4.  <code>lddqu</code> and <code>movdqu</code> run identically on all other x86 microarchitectures.  I don&#39;t think anyone cares about P4 anymore.  Using <code>lddqu</code> doesn&#39;t actually <i>hurt</i> (AFAIK), hopefully with AVX enabled, compilers can still fold unaligned <code>lddqu</code> loads into memory operands for other instructions like <code>vpaddb xmm0, xmm1, [unaligned_mem]</code>"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 10, "last_activity_date": 1475856626, "last_edit_date": 1495542788, "creation_date": 1475713205, "answer_id": 39885629, "question_id": 39884960, "link": "https://stackoverflow.com/questions/39884960/how-to-extract-bytes-from-an-sse2-m128i-structure/39885629#39885629", "title": "How to extract bytes from an SSE2 __m128i structure?", "body": "<p>Least obvious question first:</p>\n\n<blockquote>\n  <p>once I've done all my vector processing, how the heck do I extract the modified bytes from the <code>__m128i</code></p>\n</blockquote>\n\n<p>Extract the low 64 bits to an integer with  <code>int64_t _mm_cvtsi128_si64x(__m128i)</code>, or <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#text=int%2520_mm_cvt&amp;techs=SSE2&amp;expand=1786,1784\" rel=\"noreferrer\">the low 32 bits with <code>int _mm_cvtsi128_si32 (__m128i a)</code></a>.  If you want other parts of the vector, your options are:</p>\n\n<ul>\n<li>shuffle the vector to create a new <code>__m128i</code> with the data you want in the low element, and use the cvt intrinsics (MOVD or MOVQ in asm).</li>\n<li>use SSE2 <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#text=pextrw&amp;techs=SSE2&amp;expand=1786,1784,2254\" rel=\"noreferrer\"><code>int _mm_extract_epi16 (__m128i a, int imm8)</code></a>, or the SSE4.1 similar instructions for other element sizes.  PEXTRB/W/D/Q are not the fastest instructions, but if you only need one high element, they're better than a separate shuffle and MOVD.</li>\n<li>Store to a temporary array, or use <code>union { __m128i v; int64_t i64[2]; }</code> or something.  Union-based type punning is legal in C99, but only as an extension in C++.  An alternative to the union that would also work in C++ would be <code>memcpy(&amp;my_int64_local,  8 + (char*)my_vector, 8);</code> to extract the high half.  Hopefully that won't compile to a store + an actual memcpy library function call.  Compilers are usually pretty good about optimizing away small fixed-size memcpy because of use-cases like this, but you will probably get a store/reload instead of a PEXTRQ, even if you compile with <code>-msse4.1</code> to let the compiler use it if it wants.  If the result can go directly into memory unmodified (instead of being needed in an integer register), a smart compiler might use MOVHPS to store the high half of a <a href=\"http://www.felixcloutier.com/x86/MOVHPS.html\" rel=\"noreferrer\"><code>__m128i</code></a></li>\n</ul>\n\n<hr>\n\n<blockquote>\n  <p>Does this turn into a linear, unbroken block in memory?</p>\n</blockquote>\n\n<p>No, it's an array of pointers to separate blocks of memory, introducing an extra level of indirection vs. a proper 2D array.  Don't do that.</p>\n\n<p>Make one large allocation, and do the index calculation yourself (using <code>array[x*yres + y]</code>).</p>\n\n<p>And yes, load data from it with <code>_mm_load_si128</code>, or loadu if you need to load from an offset.</p>\n\n<hr>\n\n<blockquote>\n  <p>assumed <code>_mm_load_si128</code> only loads signed bytes</p>\n</blockquote>\n\n<p>Signed or unsigned isn't an inherent property of a byte, it's only how you interpret the bits.  You use the same load intrinsic for loading two 64-bit elements, or a 128-bit bitmap.</p>\n\n<p>Use intrinsics that are appropriate for your data.  It's a little bit like assembly language: everything is just bytes, and the machine will do what you tell it with your bytes.  It's up to you to choose a sequence of instructions / intrinsics that produces meaningful results.</p>\n\n<p>The integer load intrinsics take <code>__m128i*</code> pointer args, so you have to use <code>_mm_load_si128( (const __m128i*) my_int_pointer )</code> or similar.  This looks like pointer aliasing (e.g. reading an array of <code>int</code> through a <code>short *</code>), which is Undefined Behaviour in C and C++.  However, this is how Intel says you're supposed to do it, so any compiler that implements Intel's intrinsics is required to make this work correctly.  gcc does so by defining <code>__m128i</code> with <code>__attribute__((may_alias))</code>.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/9318115/loading-data-for-gccs-vector-extensions/39608561#39608561\">Loading data for GCC&#39;s vector extensions</a> which points out that you can use Intel intrinsics for GNU C native vector extensions, and shows how to load/store.</p>\n\n<hr>\n\n<p>To learn more about SIMD with SSE, there are some links in the <a href=\"/questions/tagged/sse\" class=\"post-tag\" title=\"show questions tagged &#39;sse&#39;\" rel=\"tag\">sse</a> tag wiki, including some intro / tutorial links.</p>\n\n<p>The <a href=\"/questions/tagged/x86\" class=\"post-tag\" title=\"show questions tagged &#39;x86&#39;\" rel=\"tag\">x86</a> tag wiki has some good x86 asm / performance links.</p>\n"}], "owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4843, "favorite_count": 3, "accepted_answer_id": 39885629, "answer_count": 1, "score": 6, "last_activity_date": 1475856626, "creation_date": 1475708378, "last_edit_date": 1475767799, "question_id": 39884960, "link": "https://stackoverflow.com/questions/39884960/how-to-extract-bytes-from-an-sse2-m128i-structure", "title": "How to extract bytes from an SSE2 __m128i structure?", "body": "<p>I'm a beginner with SIMD intrinsics, so I'll thank everyone for their patience in advance. I have an application involving absolute difference comparison of unsigned bytes (I'm working with greyscale images).</p>\n\n<p>I tried AVX, more modern SSE versions etc, but eventually decided SSE2 seems sufficient and has the most support for individual bytes - please correct me if I'm wrong.</p>\n\n<p>I have two questions: first, what's the right way to load 128-bit registers? I think I'm supposed to pass the load intrinsics data aligned to multiples of 128, but will that work with 2D array code like this:</p>\n\n<pre><code>greys = aligned_alloc(16, xres * sizeof(int8_t*));\n\nfor (uint32_t x = 0; x &lt; xres; x++)\n{\n    greys[x] = aligned_alloc(16, yres * sizeof(int8_t*));\n}\n</code></pre>\n\n<p>(The code above assumes xres and yres are the same, and are powers of two). Does this turn into a linear, unbroken block in memory? Could I then, as I loop, just keep passing addresses (incrementing them by 128) to the SSE2 load intrinsics? Or does something different need to be done for 2D arrays like this one?</p>\n\n<p>My second question: once I've done all my vector processing, how the heck do I extract the modified bytes from the <code>__m128i</code> ? Looking through the Intel Intrinsics Guide, instructions that convert a vector type to a scalar one are rare. The closest I've found is int <code>_mm_movemask_epi8 (__m128i a)</code> but I don't quite understand how to use it.</p>\n\n<p>Oh, and one third question - I assumed <code>_mm_load_si128</code> only loads signed bytes? And I couldn't find any other byte loading function, so I guess you're just supposed to subtract 128 from each and account for it later?</p>\n\n<p>I know these are basic questions for SIMD experts, but I hope this one will be useful to beginners like me. And if you think my whole approach to the application is wrong, or I'd be better off with more modern SIMD extensions, I'd love to know. I'd just like to humbly warn I've never worked with assembly and all this bit-twiddling stuff requires a lot of explication if it's to help me.</p>\n\n<p>Nevertheless, I'm grateful for any clarification available.</p>\n\n<p>In case it makes a difference: I'm targeting a low-power i7 Skylake architecture. But it'd be nice to have the application run on much older machines too (hence SSE2).</p>\n"}, {"tags": ["c", "system-calls"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1475708119, "post_id": 39884894, "comment_id": 67056629, "body": "Check whether the <code>execl</code> call succeeded or not (if it returns then it failed). And &quot;The first argument, by convention, should point to the filename associated with the file being executed&quot;."}, {"owner": {"reputation": 33, "user_id": 5640743, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e59de06d57e8033ecd709b9977926b4d?s=128&d=identicon&r=PG&f=1", "display_name": "VCanas", "link": "https://stackoverflow.com/users/5640743/vcanas"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1475708370, "post_id": 39884894, "comment_id": 67056702, "body": "@kaylum It does not return -1, that means it succeeded right? I&#39;ve noticed it enters the program as it prints &quot;Welcome to the program&quot; but it does not run arg0 and arg1..."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1475708497, "post_id": 39884894, "comment_id": 67056738, "body": "Well, that&#39;s a different problem then. You said &quot;nothing happens&quot;! That&#39;s very misleading as you are now saying the executable was actually run. We can&#39;t see the code for the program being called . But as I said, most programs expect arg0 to be the program name and if that is the case then all your args are out of place."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475708708, "post_id": 39884894, "comment_id": 67056794, "body": "Note that if you&#39;d run <code>executable arg0 arg1</code> at the command line, you need to use <code>execl(&quot;path&#47;to&#47;executable&quot;, &quot;executable&quot;, &quot;arg0&quot;, &quot;arg1&quot;, (char *)NULL);</code>.  You should also do something sane (meaning, &#39;report an error and exit with an error status&#39;) if <code>execl()</code> returns, which it will if it fails to execute the command.  On success, it does not return.  There&#39;s no need, therefore, to test the return value from <code>execl()</code>."}, {"owner": {"reputation": 33, "user_id": 5640743, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e59de06d57e8033ecd709b9977926b4d?s=128&d=identicon&r=PG&f=1", "display_name": "VCanas", "link": "https://stackoverflow.com/users/5640743/vcanas"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1475708899, "post_id": 39884894, "comment_id": 67056851, "body": "@kaylum Okay so I&#39;ve used that &quot;path-to-file&quot;, &quot;file&quot; convention and now it returns so it is returning an error"}, {"owner": {"reputation": 33, "user_id": 5640743, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e59de06d57e8033ecd709b9977926b4d?s=128&d=identicon&r=PG&f=1", "display_name": "VCanas", "link": "https://stackoverflow.com/users/5640743/vcanas"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475708911, "post_id": 39884894, "comment_id": 67056854, "body": "@JonathanLeffler this is my code: execl(&quot;path/to/executable&quot;, &quot;executable&quot;, &quot;function&quot;, &quot;function_parameter&quot;, (const char*)NULL);"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1475709010, "post_id": 39884894, "comment_id": 67056875, "body": "Please click the &quot;edit&quot; link under the question to fix up the obvious misleading statements and also to add any updated code that you try. We cannot debug descriptions of code. The <i>exact</i> code must be shown (in the question not in comments)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475709080, "post_id": 39884894, "comment_id": 67056895, "body": "OK; are you typing two values on the standard input, or are you passing two arguments on the command line?  Do you run <code>executable arg0 arg1</code> or do you run <code>executable</code> and then specify <code>arg0</code> and <code>arg1</code> as commands typed on standard input?  If the latter, you have some work to do \u2014 you have to create a file or pipe for the program to read from, and write the two values to that file or pipe, and redirect input so the child process reads from the file or pipe."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1475709091, "post_id": 39884894, "comment_id": 67056897, "body": "Call <code>perror</code> after the <code>execl</code> returns to get a more precise error description."}, {"owner": {"reputation": 33, "user_id": 5640743, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e59de06d57e8033ecd709b9977926b4d?s=128&d=identicon&r=PG&f=1", "display_name": "VCanas", "link": "https://stackoverflow.com/users/5640743/vcanas"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475709343, "post_id": 39884894, "comment_id": 67056943, "body": "@JonathanLeffler Thats exactly what I want. should i use an echo to write on a .txt file? How can i make the program read that file afterwards using execl? execl(&quot;path/to/executable&quot;, &quot;executable &lt; inputFile&quot;,  (const char*)NULL); will this work?"}, {"owner": {"reputation": 33, "user_id": 5640743, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e59de06d57e8033ecd709b9977926b4d?s=128&d=identicon&r=PG&f=1", "display_name": "VCanas", "link": "https://stackoverflow.com/users/5640743/vcanas"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1475709404, "post_id": 39884894, "comment_id": 67056955, "body": "@kaylum sorry, not only english is not my first language but also the code variables and files are not in english... doing my best to be clear"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475709601, "post_id": 39884894, "comment_id": 67057000, "body": "The easiest fix would be to make <code>executable</code> look at whether it is given command line arguments and to use them if it is and to prompt for the data only if there were no command line arguments. Assuming that this change is not admissible, you need to look up <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup2.html\" rel=\"nofollow noreferrer\"><code>dup2()</code></a> in particular, and maybe <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pipe.html\" rel=\"nofollow noreferrer\"><code>pipe()</code></a>, etc. You can&#39;t do the I/O redirection as you commented; that requires the shell to interpret the <code>&lt;</code>, using <code>system(&quot;path&#47;to&#47;executable &lt; inputFile&quot;)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1475711579, "creation_date": 1475711579, "answer_id": 39885409, "question_id": 39884894, "link": "https://stackoverflow.com/questions/39884894/c-execl-system-call/39885409#39885409", "title": "C - Execl system call", "body": "<p>You need to write the input to the standard input of the executable, so you should probably use a pipe:</p>\n\n<pre><code>int p[2];\npipe(p);      // Error check?\n\npid_t Process = fork();\nif (Process &lt; 0)\n{\n    perror(\"fork()\");\n    close(p[0]);\n    close(p[1]);\n}\nelse if (Process == 0)\n{\n    dup2(p[0], 0);\n    close(p[0]);\n    close(p[1]);\n    execl(\"path/to/executable/executable\", \"executable\", (char *)NULL);\n    perror(\"executable\");\n    exit(1);\n}\nelse\n{\n    close(p[0]);\n    write(p[1], \"functionN 2\\n\", sizeof(\"functionN 2\\n\")-1);\n    close(p[1]);\n    int status;\n    pid_t corpse = wait(&amp;status);\n}\n</code></pre>\n\n<p>For the code shown, you need headers <code>&lt;unistd.h&gt;</code> and <code>&lt;sys/wait.h&gt;</code> (in addition to <code>&lt;stdio.h&gt;</code> and <code>&lt;stdlib.h&gt;</code>).  There are a myriad other ways to get the line <code>functionN 2</code> specified; it would be more orthodox, perhaps, to use:</p>\n\n<pre><code>char line[] = \"functionN 2\\n\";\n\u2026\nwrite(p[1], line, sizeof(line) - 1);\n</code></pre>\n\n<p>(Remember that <code>sizeof()</code> includes the terminal null in a string literal, or when sizing a string array like <code>line</code>; that should not be written to the child.)</p>\n\n<p>You should, arguably, check that the <code>corpse</code> value matches the <code>Process</code> value.  You would loop until you either get the correct corpse or you get an error indicating no more children.  This protects you if you have other processes also started by the parent that have not yet been waited for.  You should also consider reporting the corpse and its exit status, at least for debugging purposes:</p>\n\n<pre><code>int status = 0;\npid_t corpse;\n\nwhile ((corpse = wait(&amp;status)) != Process &amp;&amp; corpse != -1)\n    printf(\"Other child %d exited with status 0x%.4X\\n\", (int)corpse, status);\nif (corpse == -1)\n    printf(\"Oops! Executable died and we did not get told!\\n\");\nelse\n    printf(\"Executable %d exited with status 0x%.4X\\n\", (int)corpse, status);\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5640743, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e59de06d57e8033ecd709b9977926b4d?s=128&d=identicon&r=PG&f=1", "display_name": "VCanas", "link": "https://stackoverflow.com/users/5640743/vcanas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1475711579, "creation_date": 1475707980, "last_edit_date": 1475710707, "question_id": 39884894, "link": "https://stackoverflow.com/questions/39884894/c-execl-system-call", "title": "C - Execl system call", "body": "<p>I'm trying to execute a function using execl on a child process and it is returning an error.\nHere is my code for it:</p>\n\n<pre><code>pid_t Process = fork();\nif(Process == 0){\n    execl(\"path/to/executable/executable\", \"executable\", \"function\", \"function_parameter\", (const char*)NULL);\n}\nelse if(Process &lt; 0){ //do something\n}\nelse\n{\n   //parent \n}\n</code></pre>\n\n<p>The program reads commands from the stdin (each command is a function) and 'function name' and 'function parameter' are inputs.  For\nexample:</p>\n\n<pre><code>$ ./executable\n\nWelcome to the program\n\nfunctionN 2\n\n(function N gets executed with 2 as a parameter)\n$\n</code></pre>\n\n<p>Can someone help me with this please?</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1475708317, "post_id": 39884823, "comment_id": 67056685, "body": "Can you print the value of <code>firstbuffer</code> and <code>secondbuffer</code>? E.g., <code>printf(&quot;1:%p\\n2:%p\\n&quot;, firstbuffer, secondbuffer);</code>"}, {"owner": {"reputation": 565, "user_id": 2272156, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5d551835c9838f5ea6a7c88a22225ec4?s=128&d=identicon&r=PG", "display_name": "Piyush", "link": "https://stackoverflow.com/users/2272156/piyush"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1475708673, "post_id": 39884823, "comment_id": 67056779, "body": "@jxh: Yes I am able to print their values. Using printk(&quot;%s\\n,firstbuffer) and printk(&quot;%s\\n,secondbuffer) to do so"}, {"owner": {"reputation": 565, "user_id": 2272156, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5d551835c9838f5ea6a7c88a22225ec4?s=128&d=identicon&r=PG", "display_name": "Piyush", "link": "https://stackoverflow.com/users/2272156/piyush"}, "reply_to_user": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 0, "creation_date": 1475709906, "post_id": 39884823, "comment_id": 67057079, "body": "@JohnKugelman: Done. added mcv example."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1475710583, "post_id": 39884823, "comment_id": 67057242, "body": "@Piyush What are the values?"}, {"owner": {"reputation": 565, "user_id": 2272156, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5d551835c9838f5ea6a7c88a22225ec4?s=128&d=identicon&r=PG", "display_name": "Piyush", "link": "https://stackoverflow.com/users/2272156/piyush"}, "edited": false, "score": 0, "creation_date": 1475710729, "post_id": 39884823, "comment_id": 67057287, "body": "ABC (before second call to read) and AXYZ (after second call to read) as mentioned in the answer. Secondbuffer&#39;s output is XYZ as expected. However, if I were to call read function again with first input file and first buffer, then  value of second buffer also gets merged with the 1st one while the output of 1st becomes ABC."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1475712345, "post_id": 39884823, "comment_id": 67057681, "body": "<code>%p</code> means I am interested in the value of the pointer itself, not the contents which you had already described in your post."}, {"owner": {"reputation": 565, "user_id": 2272156, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5d551835c9838f5ea6a7c88a22225ec4?s=128&d=identicon&r=PG", "display_name": "Piyush", "link": "https://stackoverflow.com/users/2272156/piyush"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1475713188, "post_id": 39884823, "comment_id": 67057864, "body": "@jxh: Ahh sorry about that. first buffer = ffff88007a5b57e8 and secondbuffer = ffff88007a5b57f0. The value of first buffer&#39;s pointer doesn&#39;t change after second read call."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1475714411, "post_id": 39884823, "comment_id": 67058174, "body": "What are the values of <code>PAGE_SIZE</code> and <code>len</code>?"}, {"owner": {"reputation": 565, "user_id": 2272156, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5d551835c9838f5ea6a7c88a22225ec4?s=128&d=identicon&r=PG", "display_name": "Piyush", "link": "https://stackoverflow.com/users/2272156/piyush"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1475714914, "post_id": 39884823, "comment_id": 67058254, "body": "@immibis: I had declared len = Page_size and page_size should be 4096 as defined in the limits.h file. The issue was with memory allocation as you correctly pointed out."}], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 2272156, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5d551835c9838f5ea6a7c88a22225ec4?s=128&d=identicon&r=PG", "display_name": "Piyush", "link": "https://stackoverflow.com/users/2272156/piyush"}, "edited": false, "score": 0, "creation_date": 1475714802, "post_id": 39885766, "comment_id": 67058234, "body": "Ahh thank you so much. This solved the issue. What a stupid mistake. Now, I am not even sure how the program was working at all. I am sure I was writing more than 4 bytes to it all the time. Anyways, thank you again @immibis"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 565, "user_id": 2272156, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5d551835c9838f5ea6a7c88a22225ec4?s=128&d=identicon&r=PG", "display_name": "Piyush", "link": "https://stackoverflow.com/users/2272156/piyush"}, "edited": false, "score": 1, "creation_date": 1475720486, "post_id": 39885766, "comment_id": 67059515, "body": "@Piyush Allocating 4 bytes means the 4 bytes are reserved for you, but it doesn&#39;t mean only 4 bytes exist. You can write after the 4 bytes reserved to you and then you&#39;re writing over someone else&#39;s memory, or unused memory."}], "tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": true, "score": 1, "last_activity_date": 1475714398, "creation_date": 1475714398, "answer_id": 39885766, "question_id": 39884823, "link": "https://stackoverflow.com/questions/39884823/reading-in-kernel-second-time-overrides-first-instance/39885766#39885766", "title": "Reading in kernel second time overrides first instance", "body": "<pre><code>kmalloc(sizeof(PAGE_SIZE), GFP_KERNEL)\n</code></pre>\n\n<p>This allocates <code>sizeof(PAGE_SIZE)</code> bytes. Now, <code>PAGE_SIZE</code> is an integer, so it's probably 4 bytes long, so you allocate 4 bytes.</p>\n\n<p>If you wanted to allocate <code>PAGE_SIZE</code> bytes, use:</p>\n\n<pre><code>kmalloc(PAGE_SIZE, GFP_KERNEL)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "is_accepted": false, "score": -1, "last_activity_date": 1475727047, "creation_date": 1475727047, "answer_id": 39887370, "question_id": 39884823, "link": "https://stackoverflow.com/questions/39884823/reading-in-kernel-second-time-overrides-first-instance/39887370#39887370", "title": "Reading in kernel second time overrides first instance", "body": "<pre><code>int readfile(const char *filename, void *buf, int len, int offset) \n{\n    struct file *filp;\n    mm_segment_t oldfs;\n    int bytes;\n    filp = NULL;\n</code></pre>\n\n<p>Why? This is immediately overwritten line below.</p>\n\n<pre><code>    filp = filp_open(filename, O_RDONLY, 0);\n    if(!filp || IS_ERR(filp)) {\n</code></pre>\n\n<p>filp_open will not return NULL.</p>\n\n<pre><code>        printk(\" Error in reading file %s. Error = %d\\n\", filename, \\\n               (int) PTR_ERR(filp));\n</code></pre>\n\n<p>Lack of log level (e.g. KERN_WARNING). Bad message, it suggests the actual read failed. PTR_ERR already returns an int.</p>\n\n<pre><code>        return -1;\n</code></pre>\n\n<p>Why does this return -1 as opposed to PTR_ERR(filp)?</p>\n\n<pre><code>    }\n    filp-&gt;f_pos = offset;\n</code></pre>\n\n<p>Now that's a weird abuse. Why are you setting <strong>f_pos</strong> in the file object? If you check consumers like pread you will see you are supposed to have a dedicated var for the offset and leave the field alone.</p>\n\n<pre><code>    oldfs = get_fs();\n    set_fs(get_ds());\n    bytes = vfs_read(filp, buf, len, &amp;filp-&gt;f_pos);\n    set_fs(oldfs);\n    filp_close(filp, NULL);\n    return bytes;\n}\n</code></pre>\n\n<p>Now the other part:</p>\n\n<pre><code>char *firstbuffer;\nfirstbuffer = kmalloc(sizeof(PAGE_SIZE), GFP_KERNEL);\n</code></pre>\n\n<p>The sizeof bug was already mentioned. Missing error checking, but let's assume it was cut for brevity.</p>\n\n<pre><code>bytesread = readfile(firstfile, firstbuffer, len, 0);\n</code></pre>\n\n<p>Why do you allocate <strong>PAGE_SIZE</strong>, but read <strong>len</strong>?</p>\n\n<pre><code>// Null terminate read string\n</code></pre>\n\n<p>Useless comment.</p>\n\n<pre><code>firstbuffer[bytesread] = '\\0';\n</code></pre>\n\n<p>This is a off-by-one if bytesread == PAGE_SIZE.</p>\n\n<pre><code>printk(\"first buffer = %s\\n\",firstbuffer);\n[snip]\nprintk(\"second buffer %s\", secondbuffer);\n</code></pre>\n\n<p>Bad debugging printfs. If you need to dump the stuff, you should enclose it somehow, e.g. \"[%s]\". Missing space before <strong>firstbuffer</strong>. Messages are inconsistent - one has a \"=\" while the other one does not.</p>\n"}], "owner": {"reputation": 565, "user_id": 2272156, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5d551835c9838f5ea6a7c88a22225ec4?s=128&d=identicon&r=PG", "display_name": "Piyush", "link": "https://stackoverflow.com/users/2272156/piyush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 39885766, "answer_count": 2, "score": 1, "last_activity_date": 1475727047, "creation_date": 1475707515, "last_edit_date": 1475709885, "question_id": 39884823, "link": "https://stackoverflow.com/questions/39884823/reading-in-kernel-second-time-overrides-first-instance", "title": "Reading in kernel second time overrides first instance", "body": "<p>I have written a read function to read a file into buffer in Kernel space.</p>\n\n<pre><code>int readfile(const char *filename, void *buf, int len, int offset) \n{\n    struct file *filp;\n    mm_segment_t oldfs;\n    int bytes;\n    filp = NULL;\n    filp = filp_open(filename, O_RDONLY, 0);\n    if(!filp || IS_ERR(filp)) {\n        printk(\" Error in reading file %s. Error = %d\\n\", filename, \\\n               (int) PTR_ERR(filp));\n        return -1;\n    }\n    filp-&gt;f_pos = offset;\n    oldfs = get_fs();\n    set_fs(get_ds());\n    bytes = vfs_read(filp, buf, len, &amp;filp-&gt;f_pos);\n    set_fs(oldfs);\n    filp_close(filp, NULL);\n    return bytes;\n}\n</code></pre>\n\n<p>Now, this function works really well and I am able to read contents of filename into buf by calling this function from my system call</p>\n\n<pre><code>char *firstbuffer;\nfirstbuffer = kmalloc(sizeof(PAGE_SIZE), GFP_KERNEL);\n\nbytesread = readfile(firstfile, firstbuffer, len, 0);\n\n// Null terminate read string\nfirstbuffer[bytesread] = '\\0';\nprintk(\"first buffer = %s\\n\",firstbuffer);\n</code></pre>\n\n<p>Then, I am calling this function again to read contents of secondfile into secondbuffer.</p>\n\n<pre><code>char *secondbuffer;\nsecondbuffer = kmalloc(sizeof(PAGE_SIZE), GFP_KERNEL);\nbytesread2 = readfile(secondfile, secondbuffer, len, 0);\n// Null terminate read string\nsecondbuffer[bytesread2] = '\\0';\nprintk(\"second buffer %s\", secondbuffer);\n</code></pre>\n\n<p>The problem is that after calling the read function on secondfile, the contents of my firstbuffer are getting overridden with contents of secondbuffer.</p>\n\n<p>For example: if the contents of firstfile are </p>\n\n<pre><code>A\nB\nC\n</code></pre>\n\n<p>and contents of secondfile are </p>\n\n<pre><code>X\nY\nZ\n</code></pre>\n\n<p>then after first read file call, the content of firstbuffer is:</p>\n\n<pre><code>A\nB\nC\n</code></pre>\n\n<p>and then after second read file call, the content of firstbuffer is:</p>\n\n<pre><code>A\nX\nY\nZ\n</code></pre>\n\n<p>Now, I am not sure what is going wrong here, but after second read function call, contents of firstbuffer is getting merged with contents of secondbuffer.  How do I fix this?</p>\n\n<p>Disclaimer:</p>\n\n<p>I know we shouldn't do file I/O in Kernel space. This is purely to learn how read functions work in Kernel space. </p>\n"}, {"tags": ["c", "algorithm", "sorting", "merge"], "comments": [{"owner": {"reputation": 397, "user_id": 6928928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/acb849fe7bb1857c23ad9ec6c6590ab9?s=128&d=identicon&r=PG&f=1", "display_name": "Welez", "link": "https://stackoverflow.com/users/6928928/welez"}, "edited": false, "score": 1, "creation_date": 1475705928, "post_id": 39884523, "comment_id": 67056010, "body": "@RawN Already removed. By the way, i like stars."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1475706008, "post_id": 39884523, "comment_id": 67056042, "body": "When you say &quot;it doesn&#39;t work&quot;, what do you mean exactly? Give a short example of input and actual output."}, {"owner": {"reputation": 397, "user_id": 6928928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/acb849fe7bb1857c23ad9ec6c6590ab9?s=128&d=identicon&r=PG&f=1", "display_name": "Welez", "link": "https://stackoverflow.com/users/6928928/welez"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1475706119, "post_id": 39884523, "comment_id": 67056061, "body": "@MarkRansom Input : 2 2 3 7 1 2 1 Output : 2 2 3 7 0 1 1"}], "answers": [{"comments": [{"owner": {"reputation": 397, "user_id": 6928928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/acb849fe7bb1857c23ad9ec6c6590ab9?s=128&d=identicon&r=PG&f=1", "display_name": "Welez", "link": "https://stackoverflow.com/users/6928928/welez"}, "edited": false, "score": 0, "creation_date": 1475708789, "post_id": 39884975, "comment_id": 67056818, "body": "Thanks! That solved my problem. Actually, I wasn&#39;t sure i should have gone with <code>num - s</code>, instead of just <code>s</code>."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1475708987, "post_id": 39884975, "comment_id": 67056870, "body": "I looked right at that line and missed it, well done."}, {"owner": {"reputation": 397, "user_id": 6928928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/acb849fe7bb1857c23ad9ec6c6590ab9?s=128&d=identicon&r=PG&f=1", "display_name": "Welez", "link": "https://stackoverflow.com/users/6928928/welez"}, "edited": false, "score": 0, "creation_date": 1475710556, "post_id": 39884975, "comment_id": 67057234, "body": "@chqrlie Thanks for the detailed answer. One more thing i was concerned about is the temination of arrays. Should i do <code>*base_char = 0</code> in the end of merge subroutine for int arrays, strings and char?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 397, "user_id": 6928928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/acb849fe7bb1857c23ad9ec6c6590ab9?s=128&d=identicon&r=PG&f=1", "display_name": "Welez", "link": "https://stackoverflow.com/users/6928928/welez"}, "edited": false, "score": 0, "creation_date": 1475711542, "post_id": 39884975, "comment_id": 67057486, "body": "@KirillVishnyakov: not at all. The array is sorted in place, <code>int</code> and string arrays need no terminator, a <code>char</code> array should have a terminator if it is used as a string, but you should not include this terminator in the length you pass to <code>merge_sort()</code>."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1475711666, "last_edit_date": 1475711666, "creation_date": 1475708483, "answer_id": 39884975, "question_id": 39884523, "link": "https://stackoverflow.com/questions/39884523/merge-sort-for-multiple-types/39884975#39884975", "title": "Merge Sort for multiple types", "body": "<p>The bug is in function <code>merge_sort()</code>: the second recursive call is done on the wrong base address:</p>\n\n<pre><code>merge_sort(char_base + (num - s) * el_size, num - s, el_size, compar);\n</code></pre>\n\n<p>fix is with </p>\n\n<pre><code>merge_sort(char_base + s * el_size, num - s, el_size, compar);\n</code></pre>\n\n<p>Note that there are other issues in your code:</p>\n\n<ul>\n<li><p>the comparison functions have incorrect signatures, they should take <code>const void *</code> arguments.</p></li>\n<li><p>both <code>merge()</code> and <code>merge_sort()</code> should be defined as <code>void</code> since they return no value.</p></li>\n<li><p><code>CompareInt</code> cannot handle large integer values whose difference exceeds <code>INT_MAX</code>, such as <code>INT_MAX</code> and <code>INT_MIN</code>.  It should be written:</p>\n\n<pre><code>int CompareInt(const void *a, const void *b) {\n    int na = *(const int *)a;\n    int nb = *(const int *)b;\n    return (nb &lt; na) - (na &lt; nb);\n}\n</code></pre></li>\n<li><p>you should print a <code>'\\n'</code> after the numbers.</p></li>\n</ul>\n\n<p>You could also improve the implementation in various ways:</p>\n\n<ul>\n<li><p>if you computed <code>s</code> as <code>(n + 1) / 2</code>, you could use less memory and have a simpler and faster implementation as you would not need the <code>second</code> array in the <code>merge</code> function.</p></li>\n<li><p>using pointers, you would drastically reduce the number of multiplications.</p></li>\n</ul>\n\n<p>Here is a simpler implementation with the same semantics:</p>\n\n<pre><code>void merge(void *base, size_t num, size_t el_size, size_t size,\n           int (*compar)(const void*, const void*)) {\n    size_t split = size * el_size;\n    char *first = malloc(split);\n    char *p1 = memcpy(first, base, split);\n    char *dest = base, *p2 = dest + split;\n    size_t i = 0, j = size;\n    while (i &lt; size) {\n        if (j == num || compar(p1, p2) &lt;= 0) {\n            for (size_t k = 0; k &lt; el_size; k++)\n                *dest++ = *p1++;\n            i++;\n        } else {\n            for (size_t k = 0; k &lt; el_size; k++)\n                *dest++ = *p2++;\n            j++;\n        }\n    }\n    free(first);\n}\n\nvoid merge_sort(void *base, size_t num, size_t el_size,\n                int (*compar)(const void*, const void*)) {\n    if (num &gt; 1) {\n        size_t s = (num + 1) / 2;\n        char *char_base = base;\n        merge_sort(char_base, s, el_size, compar);\n        merge_sort(char_base + s * el_size, num - s, el_size, compar);\n        merge(char_base, num, el_size, s, compar);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 6928928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/acb849fe7bb1857c23ad9ec6c6590ab9?s=128&d=identicon&r=PG&f=1", "display_name": "Welez", "link": "https://stackoverflow.com/users/6928928/welez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "accepted_answer_id": 39884975, "answer_count": 1, "score": 0, "last_activity_date": 1475711666, "creation_date": 1475705559, "last_edit_date": 1475707905, "question_id": 39884523, "link": "https://stackoverflow.com/questions/39884523/merge-sort-for-multiple-types", "title": "Merge Sort for multiple types", "body": "<p>I'm trying to implement a Merge Sort algorithm that can work with integers, strings and char. Unfortunately, I found that it doesn't work properly with integers when the array length is odd. </p>\n\n<p>For example: Input: <code>2 2 3 7 1 2 1</code>. Output: <code>2 2 3 7 0 1 1</code>.</p>\n\n<p>Now I'm trying to find the mistake in my code. Here it is:</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"MergeSort.h\"\n\nint StrCmp(char *st1, char *st2) {\n    char *str1 = st1, *str2 = st2;\n    while (*str1 == *str2 &amp;&amp; *str1 != 0)\n        str1++, str2++;\n    return *str1 - *str2;\n}\n\nint CompareInt(void *a, void *b) {\n    return *(int *)a - *(int *)b;\n}\n\nint CompareChar(void *a, void *b) {\n    return *(char *)a - *(char *)b;\n}\n\nint CompareStr(const void *a, const void *b) {\n    return strcmp(*(char **)a, *(char **)b);\n}\n\nint merge(void *base, size_t num, size_t el_size, int (*compar)(const void*, const void*)) {\n    size_t size = (size_t)num / 2;\n    char *char_base = (char *)base;\n    char *first = malloc(size * el_size);\n    char *second = malloc((num - size) * el_size);\n\n    for (int i = 0; i &lt; size; i++)\n        for (int j = 0; j &lt; el_size; j++)\n            first[i * el_size + j] = char_base[i * el_size + j];\n\n    for (int i = 0; i &lt; num - size; i++)\n        for (int j = 0; j &lt; el_size; j++)\n            second[i * el_size + j] = char_base[size * el_size + i * el_size + j];\n\n    size_t i = 0, j = 0, c = 0;\n    while (i &lt; size &amp;&amp; j &lt; num - size) {\n        if (compar(&amp;first[i * el_size], &amp;second[j * el_size]) &lt;= 0) {\n            for (int k = 0; k &lt; el_size; k++) \n                char_base[el_size * c + k] = first[i * el_size + k];\n            i++;\n        } else { \n            for (int k = 0; k &lt; el_size; k++) \n                char_base[el_size * c + k] = second[j * el_size + k];\n            j++;\n        }\n        c++;\n    }\n\n    if (i == size) { \n        while (j &lt; num - size) {\n            for (int k = 0; k &lt; el_size; k++) \n                char_base[el_size * c + k] = second[j * el_size + k];\n            j++;\n            c++;\n        }\n    } else { \n        while (i &lt; size) {\n            for (int k = 0; k &lt; el_size; k++) \n                char_base[el_size * c + k] = first[i * el_size + k];\n            i++;\n            c++;\n        }\n    }\n    free(first);\n    free(second);\n}\n\nint merge_sort(void *base, size_t num, size_t el_size, int (*compar)(const void*, const void*)) {\n    if (num &gt; 1) {\n        size_t s = num / 2;\n        char *char_base = base;\n        merge_sort(char_base, s, el_size, compar);\n        merge_sort(char_base + (num - s) * el_size, num - s, el_size, compar);\n        merge(char_base, num, el_size, compar);\n    }\n}\n\nint main() {\n    int nums[] = { 2, 2, 3, 7, 1, 2, 1 };\n    cmp_t cmp = CompareInt;\n    merge_sort(nums, 7, sizeof(int), cmp);\n    for (int i = 0; i &lt; 7; i++)\n        printf(\"%i \", nums[i]);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "input", "scanf"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475705508, "post_id": 39884463, "comment_id": 67055865, "body": "Exit the store at the time the characters that are not allowed to have emerged. So It is probably impossible in the <code>sscanf</code>(and <code>scanf</code>) alone."}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1475706276, "post_id": 39884519, "comment_id": 67056101, "body": "Note that this <code>sscanf()</code> can return 3 different return values and the <i>before</i> and <i>after</i> strings cannot be empty.  All these special cases make the <code>sscanf()</code> approach error prone."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1475705535, "creation_date": 1475705535, "answer_id": 39884519, "question_id": 39884463, "link": "https://stackoverflow.com/questions/39884463/removing-a-target-character-from-a-string-using-sscanf/39884519#39884519", "title": "Removing a target character from a string using sscanf", "body": "<p>The scanset matches a sequence of (one or more) characters that either do or don't match the contents of the scanset brackets.  It stops when it comes across the first character that isn't in the scanset.  To get the two parts of your string, you'd need to use something like:</p>\n\n<pre><code>sscanf(str_1, \"%[^#]#%[^#]\", str_2, str_3);\n</code></pre>\n\n<p>We can negotiate on the second conversion specification; it might be that <code>%s</code> is sufficient, or some other scanset is appropriate.  But this would give you the 'before <code>#</code>' and 'after <code>#</code>' strings that could then be concatenated to give the desired result string.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 5936312, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/UzKa3.jpg?s=128&g=1", "display_name": "Gabriel Saul", "link": "https://stackoverflow.com/users/5936312/gabriel-saul"}, "edited": false, "score": 0, "creation_date": 1475706555, "post_id": 39884549, "comment_id": 67056184, "body": "Thank you. Both of these methods are insightful. I previously hadn&#39;t fully understood how the bracket specifier handled the (anti-)scanset in question, but now Jonathan Leffler&#39;s solution makes perfect sense. The character has to be consumed one way or another, before continuing with reading. Also, seeing as there could be characters before and after the target character, I overlooked the fact that I needed to use two strings. The exercise seems to suggest that this is possible with one call of sscanf, but I can&#39;t see that being the case now. Thanks again."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475723659, "post_id": 39884549, "comment_id": 67060328, "body": "Note: <code>sscanf(&quot;&quot;, &quot;%[^#]#%[\\001-\\377]&quot;, str_2, str_3)</code> returns <code>EOF</code> a 4th possible return value."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1475707345, "last_edit_date": 1475707345, "creation_date": 1475705725, "answer_id": 39884549, "question_id": 39884463, "link": "https://stackoverflow.com/questions/39884463/removing-a-target-character-from-a-string-using-sscanf/39884549#39884549", "title": "Removing a target character from a string using sscanf", "body": "<p>I guess, if you <em>really</em> want to use <code>sscanf</code> for the purpose of removing a single target character, you could do this:</p>\n\n<pre><code>char str_2[strlen(str_1) + 1];\nif (sscanf(str_1, \"%[^#]\", str_2) == 1) {\n    size_t len = strlen(str_2);\n    /* must verify if a '#' was found at all */\n    if (str_1[len] != '\\0') {\n        strcpy(str_2 + len, str_1 + len + 1);\n    }\n} else {\n    /* '#' is the first character */\n    strcpy(str_2, str_1 + 1);\n}\n</code></pre>\n\n<p>As you can see, <code>sscanf</code> is not the right tool for the job, because it has many quirks and shortcomings. A simple loop is more efficient and less error prone.  You could also parse <code>str_1</code> into 2 separate strings with <code>sscanf(str_1, \"%[^#]#%[\\001-\\377]\", str_2, str_3);</code> and deal with the 3 possible return values:</p>\n\n<pre><code>char str_2[strlen(str_1) + 1];\nchar str_3[strlen(str_1) + 1];\nswitch (sscanf(str_1, \"%[^#]#%[\\001-\\377]\", str_2, str_3)) {\n  case 0:  /* empty string or initial '#' */\n    strcpy(str_2, str_1 + (str_1[0] == '#'));\n    break;\n  case 1:  /* no '#' or no trailing part */\n    break;\n  case 2:  /* general case */\n    strcat(str_2, str_3);\n    break;\n}\n/* str_2 hold the result */\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1475723737, "last_edit_date": 1475723737, "creation_date": 1475707813, "answer_id": 39884868, "question_id": 39884463, "link": "https://stackoverflow.com/questions/39884463/removing-a-target-character-from-a-string-using-sscanf/39884868#39884868", "title": "Removing a target character from a string using sscanf", "body": "<blockquote>\n  <p>Removing a target character from a string using sscanf</p>\n</blockquote>\n\n<p><code>sscanf()</code> is not the best tool for this task, see far below.</p>\n\n<pre><code>// Not elegant code\n// Width limits omitted for brevity.\nstr_2[0] = '\\0';\nchar *p = str_2;\n\n// Test for the end of the string\nwhile (*str_1) {\n  int n;  // record stopping offset\n  int cnt = sscanf(str_1, \"%[^#]%n\", p, &amp;n);\n  if (cnt == 0) {  // first character is a #\n    str_1++;  // advance to next\n  } else {\n    str_1 += n;  // advance n characters\n    p += n; \n  }\n}        \n</code></pre>\n\n<p>Simple loop:</p>\n\n<p>Remove the needles from a haystack and save the hay in a bail.</p>\n\n<pre><code>char needle = '#';\nassert(needle);\ndo {\n  while (*haystack == needle) haystack++;\n} while (*bail++ = *haystack++);\n</code></pre>\n\n<p>With the 2nd method, code could use <code>haystack = bail = str_1</code></p>\n"}], "owner": {"reputation": 43, "user_id": 5936312, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/UzKa3.jpg?s=128&g=1", "display_name": "Gabriel Saul", "link": "https://stackoverflow.com/users/5936312/gabriel-saul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 752, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1475723737, "creation_date": 1475705261, "last_edit_date": 1475706089, "question_id": 39884463, "link": "https://stackoverflow.com/questions/39884463/removing-a-target-character-from-a-string-using-sscanf", "title": "Removing a target character from a string using sscanf", "body": "<p>I've recently been learning about different conversion specifiers, but I am struggling to use one of the more complex conversion specifiers. The one in question being the bracket specifier (%[<em>set</em>]).</p>\n\n<p>To my understanding, from what I've read, using %[<em>set</em>] where any string matching the sequence of characters in set (the scanset) is consumed and assigned, and using %[^<em>set</em>] has the opposite effect; in essence consuming and assigning any string that does not contain the sequence of characters in the scanset.</p>\n\n<p>That's my understanding, albeit roughly explained. I was trying to use this specifier with sscanf to remove a specified character from a string using sscanf:</p>\n\n<pre><code> sscanf(str_1, \"%[^#]\", str_2);\n</code></pre>\n\n<p>Suppose that str_1 contains \"OH#989\". My intention is to store this string in str_2, but removing the hash character in the process. However, <code>sscanf</code> stops reading at the hash character, storing only \"OH\" when I am intending to store \"OH989\".</p>\n\n<p>Am I using the correct method in the wrong way, or am I using the wrong method altogether? How can I correctly remove/extract a specified character from a string using <code>sscanf</code>? I know this is possible to achieve with other functions and operators, but ideally I am hoping to use <code>sscanf</code>.</p>\n"}, {"tags": ["c++", "c", "floating-point", "floating-point-comparison"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1475705653, "post_id": 39884432, "comment_id": 67055914, "body": "How do you know whether the cached value is correct without doing the computation anyway to figure out what it <i>should</i> be?"}, {"owner": {"reputation": 18645, "user_id": 50385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2faf0c72f6a7f65431e7df489878be24?s=128&d=identicon&r=PG", "display_name": "Joseph Garvin", "link": "https://stackoverflow.com/users/50385/joseph-garvin"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1475705794, "post_id": 39884432, "comment_id": 67055961, "body": "Sorry, cached float should be called last float, edited to be more clear. We&#39;re seeing if the input is changing. We assume the same input produces the same output."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1475706132, "post_id": 39884432, "comment_id": 67056064, "body": "Okay... if you&#39;re saving an input/output pair, and using the saved output value when the new input matches the saved one, then it should be fine as long as only one output value is valid for a given input... that seems obvious, though, so I&#39;m surprised you&#39;d ask."}], "answers": [{"comments": [{"owner": {"reputation": 18645, "user_id": 50385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2faf0c72f6a7f65431e7df489878be24?s=128&d=identicon&r=PG", "display_name": "Joseph Garvin", "link": "https://stackoverflow.com/users/50385/joseph-garvin"}, "edited": false, "score": 0, "creation_date": 1475706282, "post_id": 39884631, "comment_id": 67056104, "body": "Interesting, hadn&#39;t thought about small value optimization. In my application actually the cost seems to be in dispatching to memcmp. I&#39;ll have to compare the generated code for the reinterpret cast."}], "tags": [], "owner": {"reputation": 86, "user_id": 6923114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0b7dfa9680c420cf9dd7b2529357b3d?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Azarchs", "link": "https://stackoverflow.com/users/6923114/adam-azarchs"}, "is_accepted": false, "score": 2, "last_activity_date": 1475706195, "creation_date": 1475706195, "answer_id": 39884631, "question_id": 39884432, "link": "https://stackoverflow.com/questions/39884432/floating-point-equality-for-caching-expensive-computations/39884631#39884631", "title": "Floating point equality for caching expensive computations", "body": "<p>Most <code>memcmp</code> implementations have small-value optimizations for registers, so it should be fine to use that.  However, if you don't want to rely on that you could also do something like <code>reinterpret_cast&lt;int&gt;()</code>.  Add a <code>compile_assert(sizeof(int) == sizeof(float))</code> if you want to be extra safe and are using a library set that includes such a command.</p>\n\n<p>Do watch out about NaN.  NaN is not equal to anything, even another NaN.  If you compare memory like this they will show up as equal, which is what it sounds like you want, however you may want to add additional code to make sure all NaNs are treated the same.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1475721245, "creation_date": 1475721245, "answer_id": 39886606, "question_id": 39884432, "link": "https://stackoverflow.com/questions/39884432/floating-point-equality-for-caching-expensive-computations/39886606#39886606", "title": "Floating point equality for caching expensive computations", "body": "<p>(C99) To avoid some higher precision FP math from providing a not <em>exact</em> compare, use <code>volatile</code> to force the computation to use the most recent <strong>float</strong> values.</p>\n\n<pre><code>if ((volatile float) myfloat != (volatile float) _last_float) {\n  refresh_expensive_computation(myfloat);\n  _last_float = myfloat;\n}\n</code></pre>\n\n<p>Note: using<code>_</code> as a leading character and then a letter as a variable name is reserved.  Better to rename <code>_last_float</code>.</p>\n\n<p>Note: -0.0f equal +0.0f.  If these different <code>float</code>s that have the same value, are important, other code is needed than <code>!=</code>.</p>\n"}], "owner": {"reputation": 18645, "user_id": 50385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2faf0c72f6a7f65431e7df489878be24?s=128&d=identicon&r=PG", "display_name": "Joseph Garvin", "link": "https://stackoverflow.com/users/50385/joseph-garvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1475721245, "creation_date": 1475705088, "last_edit_date": 1475705742, "question_id": 39884432, "link": "https://stackoverflow.com/questions/39884432/floating-point-equality-for-caching-expensive-computations", "title": "Floating point equality for caching expensive computations", "body": "<p>There are already a lot of questions and answers about the dangers of expecting two floats produced by separate computations to be exactly equal, because floating point numbers are not real numbers. This question is <strong>not</strong> about correctness contingent on equality checking, it's about caching based on it.</p>\n\n<p>Imagine you have this code:</p>\n\n<pre><code>if(myfloat != _last_float) {\n    refresh_expensive_computation(myfloat);\n    _last_float = myfloat;\n}\n</code></pre>\n\n<p>In this instance the equality comparison purely exists to prevent doing redundant work. We are avoiding doing the expensive computation again if its input is unchanged (we assume the expensive function is deterministic and no other inputs to it have changed).</p>\n\n<p>In the event the two are really equal (meaning they would be if we could compute with reals instead of floating point) but are mistakenly detected not to be, in the worst case we do the expensive computation redundantly but our program's answer is still correct. AFAIK they can only mistakenly compare equal if the computation was done in a register that is wider than the memory representation of float (e.g. on 32 bit x86 when the 80 bit fp registers are enabled), and after getting converted to the memory representation they happen to both be bitwise equal. In that case the difference must be beyond the memory representation's precision, which must be below the epsilon for comparisons that matter to me, because otherwise I'd be using a wider type like double.</p>\n\n<p>So I'm going to assert this use of floating point equality is safe. So the first question is, am I wrong?</p>\n\n<p>Secondly, if we assume it's safe, I'd like to avoid mistakenly returning true because it causes a costly computation. One way to avoid that on machines with wider registers than memory representations would be to use memcmp to force it to compare memory representations (the semantics won't be exactly the same for NaN, which will now compare true against the exactly identical bitwise instance of itself, but for caching that's an improvement, or for +0 and -0 but that could be special cased). However that memcmp will be slower than a floating point comparison in registers. Is there a way to detect when a platform has wider registers, so I can #ifdef or similar to get the optimized implementation on platforms where that is safe?</p>\n"}, {"tags": ["c", "message-queue", "vxworks"], "comments": [{"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1475704381, "post_id": 39884291, "comment_id": 67055496, "body": "Did you include &lt;errno.h&gt; ?"}, {"owner": {"reputation": 9553, "user_id": 1198201, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Y3RU6.png?s=128&g=1", "display_name": "stdcerr", "link": "https://stackoverflow.com/users/1198201/stdcerr"}, "reply_to_user": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1475708767, "post_id": 39884291, "comment_id": 67056812, "body": "@TonyTannous yes, <code>#include &quot;errno.h&quot;</code>"}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1475736420, "post_id": 39884291, "comment_id": 67064635, "body": "Sorry then, no idea."}], "answers": [{"comments": [{"owner": {"reputation": 9553, "user_id": 1198201, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Y3RU6.png?s=128&g=1", "display_name": "stdcerr", "link": "https://stackoverflow.com/users/1198201/stdcerr"}, "edited": false, "score": 0, "creation_date": 1475778766, "post_id": 39896583, "comment_id": 67091941, "body": "Okay, got it, It was a problem in my application and <i>S_objLib_OBJ_UNAVAILABLE No free buffer space was available and the NO_WAIT timeout was specified.</i> definitely helped me to find the culprit! Thanks!"}], "tags": [], "owner": {"reputation": 2532, "user_id": 2139094, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7b7f096622f36595ba50f9d65a39508a?s=128&d=identicon&r=PG", "display_name": "mjs", "link": "https://stackoverflow.com/users/2139094/mjs"}, "is_accepted": true, "score": 1, "last_activity_date": 1475758440, "creation_date": 1475758440, "answer_id": 39896583, "question_id": 39884291, "link": "https://stackoverflow.com/questions/39884291/why-is-there-a-errno-s-objlib-obj-unavailable/39896583#39896583", "title": "why is there a errno S_objLib_OBJ_UNAVAILABLE?", "body": "<p>From the manual (specifically the Kernel API reference guide), we can see that errno will be set to <code>S_objLib_OBJ_UNAVAILABLE</code> when there was no room in the queue, and you have specified NO_WAIT as the timeout value.</p>\n\n<blockquote>\n  <p>S_objLib_OBJ_UNAVAILABLE No free buffer space was available and the\n  NO_WAIT timeout was specified.</p>\n</blockquote>\n\n<p>We can see in your code that you have specified NO_WAIT. There is nothing to indicate that the msgQ should be full - but perhaps you haven't shown all the code.</p>\n\n<p>Things to check:</p>\n\n<ol>\n<li>Definition of <code>MAX_BFD_MSGS</code> - make sure it is large enough</li>\n<li>Ensure that something is reading from the queue.</li>\n<li>Consider using <code>WAIT_FOREVER</code>. This will cause the <code>msgQSend</code> operation to block until there is space in the queue.</li>\n</ol>\n"}], "owner": {"reputation": 9553, "user_id": 1198201, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Y3RU6.png?s=128&g=1", "display_name": "stdcerr", "link": "https://stackoverflow.com/users/1198201/stdcerr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1129, "favorite_count": 0, "accepted_answer_id": 39896583, "answer_count": 1, "score": 1, "last_activity_date": 1475758440, "creation_date": 1475704326, "last_edit_date": 1475706300, "question_id": 39884291, "link": "https://stackoverflow.com/questions/39884291/why-is-there-a-errno-s-objlib-obj-unavailable", "title": "why is there a errno S_objLib_OBJ_UNAVAILABLE?", "body": "<p>I want to send some data to a queue but get errno S_objLib_OBJ_UNAVAILABLE (3997698) for some reason and I don't know why. Here's what I have:</p>\n\n<pre><code>static MSG_Q_ID bfd_to_alm_data = NULL;\n// in bfd_queues_create(void)\nif (!bfd_to_alm_data) {\n        bfd_to_alm_data = msgQCreate\n            (\n            MAX_BFD_MSGS,              /* max messages that can be queued */\n            sizeof(bfd_report_t),         /* max bytes in a message */\n            MSG_Q_FIFO               /* message queue options */\n            );\n        if (!bfd_to_alm_data) {\n            printErrno(errno);\n            jpax_logMsg(LOG_ERROR, LOGSTREAM_SWITCH, \"ERROR: Failed to create queue for bfd messages to alarm engine. errno %d\\n\",errno,0,0,0,0);\n            return ERROR;\n        }\n// and this is where I get the error:\nif (!bfd_to_alm_data)\n            rv = bfd_queues_create();\n        if (rv &lt; 0) {\n            jpax_logMsg(LOG_ERROR, LOGSTREAM_SWITCH, \"ERROR: Could not initialize bfd_to_alm_data! errcode %d \\n\",rv,0,0,0,0);\n            return;\n        }\n\n        rv = msgQSend(bfd_to_alm_data, \n                &amp;bfd_info,\n                sizeof(bfd_report_t),\n                NO_WAIT,\n                MSG_PRI_NORMAL);        \n        if (rv &lt; 0) {\n            jpax_logMsg(LOG_ERROR, LOGSTREAM_SWITCH, \"ERROR: Could not push Bfd alarm data onto queue! errno %d\\n\",errno,0,0,0,0);\n        }\n</code></pre>\n\n<p>What might be going on here?</p>\n\n<p>I can confirm, the Qeue handle stays the same between the calls to <code>msgQCreate()</code> and <code>msgQSend()</code></p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 1, "creation_date": 1475703639, "post_id": 39884095, "comment_id": 67055185, "body": "It&#39;s asked and answered in the comments on <a href=\"http://stackoverflow.com/a/765780\">this answer</a>."}, {"owner": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 6, "creation_date": 1475703658, "post_id": 39884095, "comment_id": 67055196, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 Are you serious?"}, {"owner": {"reputation": 1118, "user_id": 2450694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a101093933ec102d4d27f5018774df48?s=128&d=identicon&r=PG&f=1", "display_name": "Creris", "link": "https://stackoverflow.com/users/2450694/creris"}, "edited": false, "score": 1, "creation_date": 1475703667, "post_id": 39884095, "comment_id": 67055205, "body": "<a href=\"http://en.cppreference.com/w/c/chrono/tm#cite_note-leapsecond-1\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/chrono/tm#cite_note-leapsecond-1</a> as possible explanation"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1475703750, "post_id": 39884095, "comment_id": 67055246, "body": "@FrozenHeart Are you actually?"}, {"owner": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "reply_to_user": {"reputation": 1118, "user_id": 2450694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a101093933ec102d4d27f5018774df48?s=128&d=identicon&r=PG&f=1", "display_name": "Creris", "link": "https://stackoverflow.com/users/2450694/creris"}, "edited": false, "score": 0, "creation_date": 1475703832, "post_id": 39884095, "comment_id": 67055274, "body": "@Creris So it was a defect? Really?"}, {"owner": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1475703858, "post_id": 39884095, "comment_id": 67055288, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 Did you even read the question?"}, {"owner": {"reputation": 1118, "user_id": 2450694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a101093933ec102d4d27f5018774df48?s=128&d=identicon&r=PG&f=1", "display_name": "Creris", "link": "https://stackoverflow.com/users/2450694/creris"}, "edited": false, "score": 0, "creation_date": 1475703877, "post_id": 39884095, "comment_id": 67055295, "body": "I dont know, its just what I found on cppref, but it could very well be"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1475703919, "post_id": 39884095, "comment_id": 67055312, "body": "@FrozenHeart Of course I did. Did you seriously research about the topic?"}, {"owner": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1475704037, "post_id": 39884095, "comment_id": 67055368, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 Does it affect the answer somehow? It&#39;s for academic purposes only but does it matter?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1475704065, "post_id": 39884095, "comment_id": 67055378, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 This question is so obviously not a duplicate of what you suggested that it&#39;s hard for me to believe that you read and understood the question. Giving you the benefit of the doubt: maybe you accidentally pasted the wrong link, and meant to suggest another dupe target? Can you check if you still stand by that comment?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1475704250, "post_id": 39884095, "comment_id": 67055448, "body": "@hvd OK I posted that for exemplary low research about the topic. There never was a flag (or dupe hammer) with it."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1475704404, "post_id": 39884095, "comment_id": 67055503, "body": "@RobertHarvey: what do you mean by one-based second count?"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1475704517, "post_id": 39884095, "comment_id": 67055531, "body": "@chqrlie: 1 thru 60 instead of 0 thru 59.  <a href=\"http://stackoverflow.com/questions/765778/why-does-tm-sec-range-from-0-60-instead-of-0-59-in-time-h/765780#comment3625260_765780\">This</a> is actually more plausible."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1475704998, "post_id": 39884095, "comment_id": 67055694, "body": "<a href=\"http://www.cplusplus.com/reference/ctime/tm/\" rel=\"nofollow noreferrer\">cplusplus.com</a> is wrong, or at least out of date. C90 incorrectly specified the range as [0, 61], because (IIRC) someone mistakenly thought it was possible to have two consecutive leap seconds. C99 corrected it to [0, 60]."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1475705501, "post_id": 39884095, "comment_id": 67055861, "body": "A correction to my previous comment: <a href=\"http://www.cplusplus.com/reference/ctime/tm/\" rel=\"nofollow noreferrer\">that web page</a> has separate tabs for C90 and C99. The C99 tab shows the correct range [0,60] (but without a comment to explain it). (The emphasis on on C++, but the C++ includes most of the C standard library by reference.)"}], "answers": [{"comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1475704592, "post_id": 39884327, "comment_id": 67055561, "body": "Which, y&#39;know, makes sense, since the formal definition of UTC does not permit double leap seconds.  See the comments <a href=\"http://stackoverflow.com/a/765780/102937\">here</a>."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1475705053, "post_id": 39884327, "comment_id": 67055715, "body": "@RobertHarvey: I agree, and the reference is quite pertinent, although it is not a duplicate."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 13, "last_activity_date": 1477556394, "last_edit_date": 1477556394, "creation_date": 1475704516, "answer_id": 39884327, "question_id": 39884095, "link": "https://stackoverflow.com/questions/39884095/what-is-the-purpose-of-61-in-tm-sec-field-from-the-tm-structure/39884327#39884327", "title": "What is the purpose of 61 in tm_sec field from the tm structure", "body": "<p>A range of <code>0</code> to <code>61</code> allows for up to 2 consecutive leap seconds on December 31st of a given year, probably mistakenly because in years that require 2 leap seconds, these are not added on the same day.</p>\n\n<p>Newer versions of the C Standard correctly assume that at most one leap second will be inserted at a time on any given day.</p>\n\n<p>As explained in detail in <a href=\"https://en.wikipedia.org/wiki/Leap_second\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Leap_second</a> leap seconds are inserted in December and/or June in order to avoid a drift longer than 0.9 second, hence the maximum value for <code>tm_sec</code> should be <code>60</code> instead of <code>61</code>.</p>\n"}], "owner": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 1, "accepted_answer_id": 39884327, "answer_count": 1, "score": 10, "last_activity_date": 1477556394, "creation_date": 1475703312, "question_id": 39884095, "link": "https://stackoverflow.com/questions/39884095/what-is-the-purpose-of-61-in-tm-sec-field-from-the-tm-structure", "title": "What is the purpose of 61 in tm_sec field from the tm structure", "body": "<p>According to the <a href=\"http://www.cplusplus.com/reference/ctime/tm/\">cplusplus.com</a>, <code>tm_sec</code> field from the <code>tm</code> structure accept values from 0 to 61 in C90 and values from 0 to 60 in C99 and later.</p>\n\n<p>I know that 60 can be used to express leap second but what about the other one (I mean 61)? And why did they choose to remove it?</p>\n\n<p>Yeah, I tagged it both C and C++ because it is related to both languages in this case.</p>\n"}, {"tags": ["c", "assembly", "kernel", "acpi"], "comments": [{"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 4, "creation_date": 1475705543, "post_id": 39884089, "comment_id": 67055882, "body": "You&#39;re sure you&#39;re not tripping over A20? That is initially different from the real thing in Bochs AFAIK"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 3, "creation_date": 1475707687, "post_id": 39884089, "comment_id": 67056513, "body": "Yep i agree with tofro. If A20 is not enabled when the BIOS calls your boot sector (which is the case for most real hardware I know of) you&#39;ll actually be reading data one megabyte lower in memory when the memory address you access is in an odd numbered megabyte region. 0x3FFF3000 is in an odd numbered megabyte range so would read from 0x3FEF3000.I think BOCHS does enable A20 in most builds, but it is possible to turn that off if you recompile BOCHS from source. Technically speaking most 386s will boot with A20 enabled but then the BIOS disables it before transferring control to a boot loader."}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1475707916, "post_id": 39884089, "comment_id": 67056575, "body": "There is a program named <code>acpidump</code> available for most Linux distributions. Either look into the source (GPL, so you might not want to do that out of legal reasons) or at least check what&#39;s actually in the table. I don&#39;t have hardware of that age at hand (either much more modern or much more ancient) to check myself but the output does not look very off."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1475707942, "post_id": 39884089, "comment_id": 67056584, "body": "The other possibility is if you are in protected mode with paging enabled and you didn&#39;t properly identity map the ACPI region and pointed it to the wrong physical address. I think this is a lot less likely to be your problem compared with A20 being off because I&#39;d expect your code would fail on real and emulated hardware."}, {"owner": {"reputation": 802, "user_id": 5158590, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dcea160384d274a012fa104bbcd36c36?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim Blinov", "link": "https://stackoverflow.com/users/5158590/maxim-blinov"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1475709130, "post_id": 39884089, "comment_id": 67056904, "body": "@tofro It worked! Using the fast A20 Gate enable in my bootsector code solved the problem. If you could post it as an answer, ill accept it. I never considered that the A20 line would be relevant in 32 bit protected mode, but then again, why wouldnt it. Thanks Michael for the detailed explanation."}], "answers": [{"tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": true, "score": 2, "last_activity_date": 1475733034, "creation_date": 1475733034, "answer_id": 39888431, "question_id": 39884089, "link": "https://stackoverflow.com/questions/39884089/kernel-environment-rsdp-points-to-invalid-rsdt/39888431#39888431", "title": "Kernel environment: RSDP points to invalid RSDT", "body": "<p>Your problem might be (obviously is) A20 not enabled. Most <em>real</em> hardware starts up that way, as opposed to a standard Bochs start-up.</p>\n\n<p>With A20 not enabled, you'll be reading from other addresses than you think you do (See comment from Michael).</p>\n"}], "owner": {"reputation": 802, "user_id": 5158590, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dcea160384d274a012fa104bbcd36c36?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim Blinov", "link": "https://stackoverflow.com/users/5158590/maxim-blinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 39888431, "answer_count": 1, "score": 0, "last_activity_date": 1475733034, "creation_date": 1475703287, "last_edit_date": 1475703664, "question_id": 39884089, "link": "https://stackoverflow.com/questions/39884089/kernel-environment-rsdp-points-to-invalid-rsdt", "title": "Kernel environment: RSDP points to invalid RSDT", "body": "<p>I am currently developing a simple kernel that I would like to interface with the ACPI tables.</p>\n\n<p>However, my code only seems to work in a virtual machine, namely Bochs, whereas on all real hardware that I have tried so far (hardware ranging from 2003 to 2011), the RSDP points to apparently invalid Root system descriptor tables.</p>\n\n<p>Here is the screen from Bochs: notice all the descriptor tables are found.</p>\n\n<p><a href=\"https://i.stack.imgur.com/T2Mrx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T2Mrx.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The following in particular is an admittedly rather old AMD Athlon64 platform, however the BIOS is dated from 2003, so as far as I'm concerned it should have full support of the v1 ACPI revision.</p>\n\n<p><a href=\"https://i.stack.imgur.com/GQC96.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GQC96.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I also tried running my detection program on a laptop from 2010 and 2011, both of which also gave me a valid Root system descriptor pointer, but the pointer pointed to either null memory, memory filled with <code>0xFF</code> or simply junk.</p>\n\n<hr>\n\n<p>The first and obvious possibility is that of an uninitialized register, as Bochs on powerup initializes all registers to zero, whereas the same cannot always be said for real hardware. However, I have checked for this possibility enough times to warrant posting a question on these forums.</p>\n\n<p>I also found some old Linux kernel mailing list messages from circa 2002, in which the poster had a similar northbridge to the PC running in the image. They had the same RSDT address as the PC above, which further assures me that the RSDP is not wrong.</p>\n\n<p>The checksum is also valid (sums to zero in low eax (AX) register), which the reader can additionally check.</p>\n\n<p>I also suspected that perhaps my routine for printing the memory region works with an uninitialized value, and by Bochs' tendency to initialize registers worked there, and not on hardware - however, that would imply that erratic, irreproducible behavior could be observed, but on each machine I tested the memory region pointed to by the RSDP was consistently the same junk.</p>\n\n<hr>\n\n<p>As I am unsure where to even look for the problem, I will fill in additional details or source code at the request of the reader - simply dumping all of it here would be inconvenient and make this uncomfortable to read.</p>\n\n<p>kernel entry point:</p>\n\n<pre><code>void __kernel_entry() {\n\n    clear_scr(0x0000);\n\n    set_cur(0, 0);\n    print_str(\"Scanning RSDP header: 0xe0000 - 0xfffff\", 39);\n\n    struct RSDP_descriptor* rd = __RSDP_find_address();\n\n    if(rd) {\n        set_cur(0, 1); // Set cursor position\n        __RSDP_print(rd); // Prints the RSDP location, OEM string and the contained RSDT pointer\n\n    }\n\n    struct ACPI_SDT_header* rsdt = (struct ACPI_SDT_header*)rd-&gt;RSDT_address;\n    memdump((void*)rd, 5, 15);\n    memdump((void*)rsdt, VH-8, VH); //VH: Console height\n\n    loop:;\n    goto loop;\n}\n</code></pre>\n"}, {"tags": ["c", "arm", "x86-64", "libcurl"], "comments": [{"owner": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "edited": false, "score": 0, "creation_date": 1475735353, "post_id": 39884038, "comment_id": 67064109, "body": "Given your description, it sounds like perhaps your function <code>curl_routine_create_curl_opts</code> isn&#39;t done right?"}, {"owner": {"reputation": 220, "user_id": 2082461, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5d3364a9b552891d7d2528d5e0151056?s=128&d=identicon&r=PG", "display_name": "ArhiChief", "link": "https://stackoverflow.com/users/2082461/arhichief"}, "reply_to_user": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "edited": false, "score": 0, "creation_date": 1475739353, "post_id": 39884038, "comment_id": 67066270, "body": "No, <code>curl_routine_create_curl_opts</code> works well. I can&#39;t understand why <code>curl_routine_curl_read_callback</code> function passed throught <code>callback_ptr</code> pointer to curl_easy_setopt doesn&#39;t executes."}], "owner": {"reputation": 220, "user_id": 2082461, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5d3364a9b552891d7d2528d5e0151056?s=128&d=identicon&r=PG", "display_name": "ArhiChief", "link": "https://stackoverflow.com/users/2082461/arhichief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1475703096, "creation_date": 1475703096, "question_id": 39884038, "link": "https://stackoverflow.com/questions/39884038/strange-behavior-with-curl-wrapper", "title": "Strange behavior with curl wrapper", "body": "<p>I use <code>libcurl</code> in my project written in C. This application makes different requests to server, so I decide to make several helper functions what will configure CURL object, makes request and parse response. Here is the code of curl wrapper:</p>\n\n<pre><code>typedef struct  {\n    char *ptr;\n    size_t len;\n} curl_str_t;\n\ntypedef size_t (*callback_ptr)(void *, size_t, size_t, void *);\n\ntypedef struct {\n    CURLoption curl_opt;\n    union {\n        callback_ptr calback;\n        void *obj_ptr;\n        long opt;\n        curl_off_t offset;\n    } opt_param;\n} curl_opt_t;\n\nint curl_routine_init_curl_str(curl_str_t *cs) {\n    cs-&gt;len = 0;\n    cs-&gt;ptr = malloc(cs-&gt;len + 1);\n    if (cs-&gt;ptr == NULL)\n        return -ENOMEM;\n\n    cs-&gt;ptr[0] = '\\0';\n    return 0;\n}\n\nsize_t curl_routine_curl_write_callback(void *ptr, size_t size, size_t nmeb, \n        curl_str_t *s) {\n    size_t new_len = s-&gt;len + size * nmeb;\n    s-&gt;ptr = realloc(s-&gt;ptr, new_len + 1);\n    if (s-&gt;ptr == NULL)\n        return -ENOMEM;\n\n    memcpy(s-&gt;ptr + s-&gt;len, ptr, size * nmeb);\n    s-&gt;ptr[new_len] = '\\0';\n    s-&gt;len = new_len;\n\n    return size * nmeb;\n}\n\nsize_t curl_routine_curl_read_callback(void *ptr, size_t size, size_t nmemb, \n        void *stream)  {\n    curl_off_t nread;\n    size_t retcode = fread(ptr, size, nmemb, stream);\n    nread = (curl_off_t)retcode;\n\n    return nread;\n}\n\n\nstatic int curl_routine_curl_process_set_opt(CURL *curl, const curl_opt_t *opt) {\n\n    long option = (long)opt-&gt;curl_opt;\n\n    if (option - CURLOPTTYPE_OFF_T &gt; 0)\n        return curl_easy_setopt(curl, opt-&gt;curl_opt, opt-&gt;opt_param.offset);\n    else if (option - CURLOPTTYPE_FUNCTIONPOINT &gt; 0)\n        return curl_easy_setopt(curl, opt-&gt;curl_opt, opt-&gt;opt_param.calback);\n#ifdef CURLOPTTYPE_STRINGPOINT\n    else if (option - CURLOPTTYPE_STRINGPOINT &gt; 0)\n        return curl_easy_setopt(curl, opt-&gt;curl_opt, opt-&gt;opt_param.obj_ptr);\n#endif    \n    else if (option - CURLOPTTYPE_OBJECTPOINT &gt; 0)\n        return curl_easy_setopt(curl, opt-&gt;curl_opt, opt-&gt;opt_param.obj_ptr);\n    else\n        return curl_easy_setopt(curl, opt-&gt;curl_opt, opt-&gt;opt_param.opt);\n}\n\nint curl_routine_curl_process(const char *url, int try_num, char **headers,\n        int headers_cnt, const curl_opt_t *opts, int opts_cnt, double *load_speed, \n        double *load_time) {\n    CURL *curl = NULL;\n    CURLcode curl_res = CURLE_OK;\n    char errbuf[CURL_ERROR_SIZE] = { '\\0' };\n    struct curl_slist *http_headers = NULL;\n    int rc = EXIT_SUCCESS, delay = 2, i;\n    long http_code = 200;\n\n#ifdef CURL_VERBOSE\n    curl_opt_t local_opts[8];\n#else\n    curl_opt_t local_opts[7];\n#endif\n\n    curl_routine_create_curl_opts(local_opts, \n            (sizeof(local_opts) / sizeof(curl_opt_t)) * 2\n            ,CURLOPT_FAILONERROR, 1L\n            ,CURLOPT_FOLLOWLOCATION, 1L\n            ,CURLOPT_ERRORBUFFER, errbuf\n            ,CURLOPT_SSL_VERIFYPEER, 0L\n            ,CURLOPT_SSL_VERIFYHOST, 0L\n            ,CURLOPT_TCP_KEEPALIVE, 1L\n            ,CURLOPT_URL, url\n#ifdef CURL_VERBOSE\n            ,CURLOPT_VERBOSE, 1L\n#endif       \n            );\n\n    curl = curl_easy_init();\n    if (curl) {\n        if (headers) {\n            for (i = 0; i &lt; headers_cnt; i++)\n                http_headers = curl_slist_append(http_headers, headers[i]);\n            curl_res = curl_easy_setopt(curl, CURLOPT_HTTPHEADER, http_headers);\n            if (curl_res != CURLE_OK) {\n                log_error(\"cURL return error: %s\\n\", curl_easy_strerror(curl_res));\n                rc = EXIT_FAILURE;\n                goto end;\n            }\n        }\n\n        if (opts)\n            for (i = 0; i &lt; opts_cnt; i++) {\n                curl_res = curl_routine_curl_process_set_opt(curl, &amp;opts[i]);\n                if (curl_res != CURLE_OK) {\n                    log_error(\"cURL return error: %s\\n\", curl_easy_strerror(curl_res));\n                    rc = EXIT_FAILURE;\n                    goto end;\n                }\n            }\n\n        for (i = 0; i &lt; (sizeof (local_opts) / sizeof (curl_opt_t)); i++) {\n            curl_res = curl_routine_curl_process_set_opt(curl, &amp;local_opts[i]);\n            if (curl_res != CURLE_OK) {\n                log_error(\"cURL return error: %s\\n\", curl_easy_strerror(curl_res));\n                rc = EXIT_FAILURE;\n                goto end;\n            }\n        }\n\n        while (try_num--) {\n            memset(errbuf, '\\0', CURL_ERROR_SIZE);\n            curl_res = curl_easy_perform(curl);\n\n            if (curl_res == CURLE_OK) {\n                curl_easy_getinfo(curl, CURLINFO_RESPONSE_CODE, &amp;http_code);\n                if (load_speed)\n                    curl_easy_getinfo(curl, CURLINFO_SPEED_UPLOAD, &amp;load_speed);\n                if (load_time)\n                    curl_easy_getinfo(curl, CURLINFO_TOTAL_TIME, &amp;load_time);\n                log_debug(\"Request to '%s' returned with %lu code:%s\\n\", \n                        url, http_code, errbuf);\n                if (http_code &gt;= 200 &amp;&amp; http_code &lt; 300) {\n                    rc = EXIT_SUCCESS;\n                    break;\n                } else {\n                    rc = http_code;\n                }\n            } else {\n                rc = curl_res;\n                log_error(\"Request to '%s' can't be executed: %s (%s)\\n\", \n                        url, curl_easy_strerror(rc), errbuf);\n                break;\n            }\n\n            sleep(delay);\n            delay += 3;\n        }\n    } else {\n        log_error(\"Can't initialize curl\\n\");\n        rc = EXIT_FAILURE;\n    }\n\nend:\n    curl_easy_cleanup(curl);\n    curl_slist_free_all(http_headers);\n\n    return rc;\n}\n\nint curl_routine_create_curl_opts(curl_opt_t *opts, int size, ...) {\n    va_list ap;\n    int i;\n    long option;\n\n    if (!opts) \n        return 0;\n\n    va_start(ap, size);\n    for (i = 0; i &lt; size / 2; i++) {\n\n        opts[i].curl_opt = va_arg(ap, CURLoption);\n        option = (long)opts[i].curl_opt;\n\n\n        if (option - CURLOPTTYPE_OFF_T &gt; 0)\n            opts[i].opt_param.offset = va_arg(ap, curl_off_t);\n        else if (option - CURLOPTTYPE_FUNCTIONPOINT &gt; 0)\n            opts[i].opt_param.calback = va_arg(ap, callback_ptr);\n#ifdef CURLOPTTYPE_STRINGPOINT       \n        else if (option - CURLOPTTYPE_STRINGPOINT &gt; 0)\n            opts[i].opt_param.obj_ptr = va_arg(ap, char *);\n#endif        \n        else if (option - CURLOPTTYPE_OBJECTPOINT &gt; 0)\n            opts[i].opt_param.obj_ptr = va_arg(ap, void *);\n        else\n            opts[i].opt_param.opt = va_arg(ap, long);\n    }\n    va_end(ap);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>And here is how I use it:</p>\n\n<pre><code>int communicate_with_server_tell_about_file(const processing_stack_item_t *item,\n        const config_t *config) {\n    int rc = EXIT_SUCCESS;\n    char *url = NULL;\n    char postfields[2048] = { '\\0' };\n    curl_opt_t opts[1];\n\n    /* Some code */\n\n    if ((rc = curl_routine_create_curl_opts(opts, 2,\n            CURLOPT_POSTFIELDS, postfields))) \n        goto end;\n\n    rc = curl_routine_curl_process(url, 2, NULL, 0, opts, 1, NULL, NULL);\n\nend:    \n    free(url);\n    return rc;\n}\n</code></pre>\n\n<p>And one more</p>\n\n<pre><code>static int func2(const send_item_t *item) {\n    int rc = EXIT_SUCCESS;\n    char url[256] = { '\\0' };\n    char *headers[5];\n    FILE *fp = NULL;\n    curl_opt_t opts[5];\n    long http_code;\n    double load_speed, load_time;\n\n    /* Some code */\n\n    fp = fopen(item-&gt;fpath, \"rb\");\n    if (!fp) {\n        rc = errno;\n        print_error(\"Can't open file '%s': %s\", item-&gt;fpath, strerror(rc));\n        goto end;\n    }\n\n    if ((rc = curl_routine_create_curl_opts(opts, 10,\n            CURLOPT_PUT, 1L\n            ,CURLOPT_UPLOAD, 1L\n            ,CURLOPT_READDATA, fp\n            ,CURLOPT_READFUNCTION, curl_routine_curl_read_callback\n            ,CURLOPT_INFILESIZE, (curl_off_t)item-&gt;size\n            ))) {\n        goto end;\n    }\n\n    headers[0] = CONT_TYPE_HEADER;\n    headers[1] = x_ms_date_h;\n    headers[2] = META_M1_HEADER;\n    headers[3] = META_M2_HEADER;\n    headers[4] = authorization_header;\n\n#define MBs 1024 / 1024    \n    rc = curl_routine_curl_process(url, 2, headers, 5, opts, 5, \n            &amp;load_speed, &amp;load_time);\n\n    if (!rc)\n        log_info(\"File '%s' sent. Speed: %.3f MB/s, Time: %.3f s\\n\",\n                item-&gt;name, load_speed / MBs, load_time);\n    else\n        log_error(\"Can't send file\\n\");\n\nend:\n    free(authorization_header);\n    fclose(fp);\n    return rc;\n}\n</code></pre>\n\n<p>So, everything works excellent when I run build program on my x86_64 computer, but when I build it for my ARMV5e board <code>func2</code> works very strange: all uploaded files are 0 byte size, and it looks like, that curl doesn't call <code>curl_routine_curl_read_callback</code> that I passed to it using <code>callback_ptr</code>. I try to attach debugger for it and look at the address of  <code>curl_routine_curl_read_callback</code> and the value of <code>callback_ptr</code> - they are same.</p>\n\n<p>One more. If I rewrite code in <code>func2</code> just like in examples for <code>libcurl</code> (inline calls for <code>curl_easy_setopt</code>) everything works as I planned.</p>\n\n<p>Could anyone tell me what I'm doing wrong? Or maybe I missed something?</p>\n\n<p>Thanks in advance.</p>\n\n<p>P.S. By the way, my compiler is gcc v 4.9.2, <code>libcurl</code> for ARM board is 4.3.0, and standard C library for ARM board is <code>uClib</code> v.0.9.33.2</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 2, "creation_date": 1475702896, "post_id": 39883921, "comment_id": 67054857, "body": "Out of curiosity, why are you using global variables in the first place? There are alternative approaches, such as using a context object which is passed as a parameter."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 1, "creation_date": 1475703177, "post_id": 39883921, "comment_id": 67054987, "body": "C has no concept for read and write access rights - It has a concept of <i>visibility</i>, that is, you can <b>hide</b> a variable from access."}], "answers": [{"tags": [], "owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "is_accepted": false, "score": -1, "last_activity_date": 1475702906, "creation_date": 1475702906, "answer_id": 39883985, "question_id": 39883921, "link": "https://stackoverflow.com/questions/39883921/how-to-make-multiple-global-variables-read-only-for-other-modules-in-c/39883985#39883985", "title": "How to make multiple global variables read-only for other modules in C?", "body": "<p>There are many schemes you could use.  However, the simplest is allow read/write access from everywhere.</p>\n\n<p>To enforce that only writes can occur in moduleA, look at all the code: make sure that only moduleA is writing and all other modules either don't access it, or only read from the variable.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475703428, "post_id": 39884074, "comment_id": 67055105, "body": "Might want to add about &quot;I certainly have many of those variables.&quot; - maybe a <code>struct</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475703610, "post_id": 39884074, "comment_id": 67055174, "body": "Detail: Other functions can attempt modification with <code>*c = 42;</code>, but that is UB - which <i>may</i> allow the values to be modified.  Still this is a very reasonable approach for co-operative code."}, {"owner": {"reputation": 71, "user_id": 5575776, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1b65e8b5093e36a010bdbf56de1cd1f0?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge S", "link": "https://stackoverflow.com/users/5575776/jorge-s"}, "edited": false, "score": 0, "creation_date": 1475703723, "post_id": 39884074, "comment_id": 67055229, "body": "Thats interesting. So I could do this with a pointer to the struct and then being able to read all variables at once but without being able to modify them?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475703914, "post_id": 39884074, "comment_id": 67055309, "body": "@chux The pointer is a pointer to const, modification you showed is impossible. The compiler <i>must</i> issue a compile error."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 71, "user_id": 5575776, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1b65e8b5093e36a010bdbf56de1cd1f0?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge S", "link": "https://stackoverflow.com/users/5575776/jorge-s"}, "edited": false, "score": 0, "creation_date": 1475703943, "post_id": 39884074, "comment_id": 67055322, "body": "@JorgeS You can use any type you want as long as the exported pointer is a pointer to a const type."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475704235, "post_id": 39884074, "comment_id": 67055440, "body": "&quot;modification is impossible&quot; is not backup by the C spec.  Instead  &quot;If an attempt is made to modify an object defined with a const-qualified type through use of an lvalue with non-const-qualified type, the behavior is undefined.&quot; C11 &#167;6.7.3 6.  It <i>might</i> modify the value, it might not, it is UB.  C does not require an implementation to provide read-only memory for objects.  If OP needs a stronger guarantee than a compile time warning/error, than another approach is needed."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475704472, "post_id": 39884074, "comment_id": 67055521, "body": "Agree that a warning is expected, but that is not an error and code can still compile and run and attempt to modify <code>*c</code> with success or failure.  It is UB, not defined behavior for the object to be read-only."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475704612, "post_id": 39884074, "comment_id": 67055568, "body": "<i>&quot;modification is impossible&quot; is not backup by the C spec.</i> Yes it is, a compiler must issue a diagnostic message 5.1.1.3 &#167;1 for this code: <code>*c = 42;</code>."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475704763, "post_id": 39884074, "comment_id": 67055610, "body": "The qualifier const was literally created to help programer help with writing. It even has its own name: const-correctness. Sugesting that we cannot rely on const is simply ridiculous. The rest of your comment is a strawman. The object t is not defined with const, so it can be modified."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475706608, "post_id": 39884074, "comment_id": 67056201, "body": "Back up your assertion with C specification.  My comments are backed by C spec and are neither ridiculous nor straw-men. Try <code>const int t = 0;   const int * const c = &amp;t;   *(int *)c = 42;   printf(&quot;%d\\n&quot;, t);</code>  (no compiler errors)  Even though <code>c</code> is a <code>const char * const</code>, code successfully changes the value of <code>t</code> on many machines, because the code invoked UB with <code>*(int *)c = 42;</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475712239, "post_id": 39884074, "comment_id": 67057658, "body": "@2501: Sadly, &#167;6.7.3 &#182;6 is not in a &#39;constraints&#39; section. A compiler is required to generate a diagnostic when you violate a constraint; it is not formally required to issue a diagnostic if you break a semantic requirement \u2014 &#167;5.1.1.3 <b>Diagnostics</b> <i>A conforming implementation shall produce at least one diagnostic message (\u2026) if a preprocessing translation unit or translation unit contains a violation of any syntax rule or constraint, even if the behavior is also explicitly specified as undefined or implementation-defined. Diagnostic messages need not be produced in other circumstances.</i>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475712305, "post_id": 39884074, "comment_id": 67057669, "body": "@2501: That said, as a &#39;quality of implementation&#39; issue, you would reasonably expect a compiler to warn of attempts to modify an object via a pointer to const."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475732772, "post_id": 39884074, "comment_id": 67063001, "body": "@chux You&#39;re entire argument is a strawman because t isn&#39;t defined with const. Arguing that const-correctness is a weak guarantee is absurd. This debate is over."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475733237, "post_id": 39884074, "comment_id": 67063206, "body": "@JonathanLeffler The definition of constraint: <i>constraint restriction, either syntactic or <code>semantic</code>, by which the exposition of language elements is to be interpreted</i>"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475947583, "post_id": 39884074, "comment_id": 67152329, "body": "@JonathanLeffler In addition to my previous comment: <i>6.5.16.1 Simple assignment <b>Constraints</b> &#167;1 One of the following shall hold:  the left operand has atomic, qualified, or unqualified pointer type, and (considering the type the left operand would have after lvalue conversion) both operands are pointers to qualified or unqualified versions of compatible types, <b>and the type pointed to by the left has all the qualifiers of the type pointed to by the right;</i></b> Thus the diagnostics must be issued."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475947679, "post_id": 39884074, "comment_id": 67152375, "body": "@JonathanLeffler Furthermore, even the standard itself points this out: <i>6.5.16.1 Simple assignment &#167;6 EXAMPLE 3 cpp = &amp;p; // constraint violation</i>"}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 6, "last_activity_date": 1475703225, "creation_date": 1475703225, "answer_id": 39884074, "question_id": 39883921, "link": "https://stackoverflow.com/questions/39883921/how-to-make-multiple-global-variables-read-only-for-other-modules-in-c/39884074#39884074", "title": "How to make multiple global variables read-only for other modules in C?", "body": "<p>Export pointers to those variables and make them const.</p>\n\n<pre><code>//moduleA.h\nextern const type* const c;\n</code></pre>\n\n<p></p>\n\n<pre><code>//moduleA.c\ntype t;\nconst type* const c = &amp;t;\ntype* p = &amp;t;\n</code></pre>\n\n<p>Module A can read the object either through <code>t</code>, <code>c</code>, or <code>p</code>, and can modify it through <code>t</code> and <code>p</code>, while other modules can only read it through <code>c</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 5575776, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1b65e8b5093e36a010bdbf56de1cd1f0?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge S", "link": "https://stackoverflow.com/users/5575776/jorge-s"}, "edited": false, "score": 0, "creation_date": 1475703924, "post_id": 39884083, "comment_id": 67055316, "body": "Very interesting approach. I didnt think about using Macros for this functions. Thanks a lot!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475709810, "post_id": 39884083, "comment_id": 67057053, "body": "Don&#39;t forget to use <code>static</code> before <code>T name;</code> in <code>DECL_PRIVATE</code> so that the name is not visible outside the source file where it is defined.  You&#39;d also face an issue with &#39;how does another module (where the variable isn&#39;t defined) get to see the getter function declarations \u2014 as opposed to the definitions shown?&#39;"}, {"owner": {"reputation": 6281, "user_id": 472695, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1390f4bf73610ec1c7a4850b7c69a123?s=128&d=identicon&r=PG", "display_name": "toriningen", "link": "https://stackoverflow.com/users/472695/toriningen"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475713544, "post_id": 39884083, "comment_id": 67057967, "body": "@JonathanLeffler, please see updated answer that addresses these concerns"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475713927, "post_id": 39884083, "comment_id": 67058055, "body": "Interesting \u2014 definitely an improvement.  I don&#39;t know that <code>module_a.h</code> should have the <code>DEF_PROPS</code> macro; only <code>module_c.h</code> should use those macros.  I&#39;m sure the thinking is to keep related bits of code together, but the requirement is really to keep them apart \u2014 no client of the module should care in the slightest about the DEF_PROPS, so they shouldn&#39;t be troubled by having to process the code.  You might want to mention that you&#39;re using X-Macros (see the C documentation)."}, {"owner": {"reputation": 6281, "user_id": 472695, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1390f4bf73610ec1c7a4850b7c69a123?s=128&d=identicon&r=PG", "display_name": "toriningen", "link": "https://stackoverflow.com/users/472695/toriningen"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475714371, "post_id": 39884083, "comment_id": 67058165, "body": "@JonathanLeffler, making DEF_PROPS local to <code>module_a.c</code> would require to duplicate this macro everywhere props would be declared alongside with proplist, which seems to be the opposite of our deduplication effort. Just think of two different private property lists. Also, these are not X-Macros actually, but rather &quot;parametric X macros&quot;, as I am passing the X in instead of littering global preprocessor scope."}], "tags": [], "owner": {"reputation": 6281, "user_id": 472695, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1390f4bf73610ec1c7a4850b7c69a123?s=128&d=identicon&r=PG", "display_name": "toriningen", "link": "https://stackoverflow.com/users/472695/toriningen"}, "is_accepted": false, "score": 3, "last_activity_date": 1475713501, "last_edit_date": 1475713501, "creation_date": 1475703254, "answer_id": 39884083, "question_id": 39883921, "link": "https://stackoverflow.com/questions/39883921/how-to-make-multiple-global-variables-read-only-for-other-modules-in-c/39884083#39884083", "title": "How to make multiple global variables read-only for other modules in C?", "body": "<p>You can do this with implementing properties with C preprocessor macros.</p>\n\n<p>I will start with something you presumably have now \u2014 variable access without any restrictions. <code>peek</code> and <code>poke</code> functions are provided as an example to reflect how are we reading and writing these properties.</p>\n\n<pre><code>// module_a.h\n//\n#ifndef __MODULE_A__H__\n#define __MODULE_A__H__\n\nvoid poke(void);\n\nvoid *foo;\nint bar;\nfloat buzz;\n\n#endif\n</code></pre>\n\n\n\n<pre><code>// module_a.c\n//\n#include \"module_a.h\"\n\nvoid poke(void) {\n    foo = (void*) 0xDEADBABE;\n    bar = 314;\n    buzz = 2.71828f;\n}\n</code></pre>\n\n\n\n<pre><code>// module_b.h\n//\n#ifndef __MODULE_B__H__\n#define __MODULE_B__H__\n\nvoid peek(void);\n\n#endif\n</code></pre>\n\n\n\n<pre><code>// module_b.c\n//\n#include &lt;stdio.h&gt;\n#include \"module_b.h\"\n#include \"module_a.h\"\n\nvoid peek(void) {\n    printf(\"%p, %d, %f\\n\", foo, bar, buzz);\n}\n</code></pre>\n\n<p>Now we are going to hide these variables from other modules by moving variable declarations inside <code>module_a.c</code>, and declaring them as <code>static</code> to change their linkage to internal. Static declarations are only visible within the translation unit they were declared in (e.g. <code>module_a.c</code> and everything it includes).</p>\n\n<p>To allow other modules to access these variables, we would create few macros to define and declare getters for each property.</p>\n\n<pre><code>// module_a.h\n//\n#ifndef __MODULE_A__H__\n#define __MODULE_A__H__\n\nvoid poke(void);\n\n#define DECL_PROP(T, name)  \\\n    T get_##name(void);\n\n#define DEF_PROP(T, name)   \\\n    T get_##name(void) {    \\\n        return name;        \\\n    }\n\nDECL_PROP(void*, foo);\nDECL_PROP(int, bar);\nDECL_PROP(float, buzz);\n\n#endif\n</code></pre>\n\n\n\n<pre><code>// module_a.c\n//\n#include \"module_a.h\"\n\nstatic void *foo;\nstatic int bar;\nstatic float buzz;\n\nDEF_PROP(void*, foo);\nDEF_PROP(int, bar);\nDEF_PROP(float, buzz);\n\nvoid poke(void) {\n    foo = (void*) 0xDEADBABE;\n    bar = 314;\n    buzz = 2.71828f;\n}\n</code></pre>\n\n\n\n<pre><code>// module_b.c\n//\n#include &lt;stdio.h&gt;\n#include \"module_b.h\"\n#include \"module_a.h\"\n\nvoid peek(void) {\n    printf(\"%p, %d, %f\\n\", get_foo(), get_bar(), get_buzz());\n}\n</code></pre>\n\n<p>However, these macros seem to be self-repeating a lot \u2014 we have mentioned each of properties three times \u2014 twice in the implementation and once in the interface part. Maintaining such construct is very error prone, so let's try to reduce this number by combining getter definition and variable declaration.</p>\n\n<pre><code>// module_a.h\n//\n#ifndef __MODULE_A__H__\n#define __MODULE_A__H__\n\nvoid poke(void);\n\n#define DECL_PROP(T, name)  \\\n    T get_##name(void);\n\n#define DEF_PROP(T, name)   \\\n    static T name;          \\\n                            \\\n    T get_##name(void) {    \\\n        return name;        \\\n    }\n\nDECL_PROP(void*, foo);\nDECL_PROP(int, bar);\nDECL_PROP(float, buzz);\n\n#endif\n</code></pre>\n\n\n\n<pre><code>// module_a.c\n//\n#include \"module_a.h\"\n\nDEF_PROP(void*, foo);\nDEF_PROP(int, bar);\nDEF_PROP(float, buzz);\n\nvoid poke(void) {\n    foo = (void*) 0xDEADBABE;\n    bar = 314;\n    buzz = 2.71828f;\n}\n</code></pre>\n\n<p>Now let's reduce this further by combining property definition and declaration together and moving our property macros to separate file to keep module files clean and beautiful.</p>\n\n<pre><code>// props.h\n//\n#ifndef __PROPS__H__\n#define __PROPS__H__\n\n#define _DECL_PROP(T, name) \\\n    T get_##name(void);\n\n#define _DEF_PROP(T, name)  \\\n    static T name;          \\\n                            \\\n    T get_##name(void) {    \\\n        return name;        \\\n    }\n\n#define DECL_PROPS(PROPSET) \\\n    PROPSET(_DECL_PROP)\n\n#define DEF_PROPS(PROPSET)  \\\n    PROPSET(_DEF_PROP)\n\n#endif\n</code></pre>\n\n\n\n<pre><code>// module_a.h\n//\n#ifndef __MODULE_A__H__\n#define __MODULE_A__H__\n\n#include \"props.h\"\n\nvoid poke(void);\n\n\n#define I_WANT_MY_PROPS(_)  \\\n    _(void*, foo);          \\\n    _(int, bar);            \\\n    _(float, buzz);\n\nDECL_PROPS(I_WANT_MY_PROPS)\n\n#endif\n</code></pre>\n\n\n\n<pre><code>// module_a.c\n//\n#include \"module_a.h\"\n\nDEF_PROPS(I_WANT_MY_PROPS)\n\nvoid poke(void) {\n    foo = (void*) 0xDEADBABE;\n    bar = 314;\n    buzz = 2.71828f;\n}\n</code></pre>\n\n<p>Now, as a final touch, let's add private setters for these properties and obfuscate names of underlying variables so they would not be accessible directly.</p>\n\n<pre><code>// props.h\n//\n#ifndef __PROPS__H__\n#define __PROPS__H__\n\n#define _PROP_VAR_NAME(name)    \\\n    _private_property_prefix_##name\n\n#define _DECL_PROP(T, name) \\\n    T get_##name(void);\n\n#define _DEF_PROP(T, name)                  \\\n    static T _PROP_VAR_NAME(name);          \\\n                                            \\\n    T get_##name(void) {                    \\\n        return _PROP_VAR_NAME(name);        \\\n    }                                       \\\n                                            \\\n    static inline T set_##name(T value) {   \\\n        _PROP_VAR_NAME(name) = value;       \\\n                                            \\\n        return value;                       \\\n    }\n\n#define DECL_PROPS(PROPSET) \\\n    PROPSET(_DECL_PROP)\n\n#define DEF_PROPS(PROPSET)  \\\n    PROPSET(_DEF_PROP)\n\n#endif\n</code></pre>\n\n\n\n<pre><code>// module_a.c\n//\n#include \"module_a.h\"\n\nDEF_PROPS(I_WANT_MY_PROPS)\n\nvoid poke(void) {\n    set_foo((void*) 0xDEADBABE);\n    set_bar(314);\n    set_buzz(2.71828f);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": false, "score": -1, "last_activity_date": 1475703616, "creation_date": 1475703616, "answer_id": 39884156, "question_id": 39883921, "link": "https://stackoverflow.com/questions/39883921/how-to-make-multiple-global-variables-read-only-for-other-modules-in-c/39884156#39884156", "title": "How to make multiple global variables read-only for other modules in C?", "body": "<p>If you have code like</p>\n\n<pre><code>int var1;\nchar * var2;\n// ...\ndouble var20;\n</code></pre>\n\n<p>where all these <code>varX</code> are global variables, then you really should start refactoring them away.</p>\n\n<p>One possible (although almost equally \"dirty\") approach is to combine them in some configuration structure and to only provide a \"get\" function for this structure.</p>\n\n<p>Of course, if you're only concerned about the time / code it takes to create a get function, well, then I welcome you to the evil magic of the preprocessor:</p>\n\n<pre><code>#define DECLARE_GLOBAL(type, name) \\\n  extern type name;                \\\n  type get_ ## name(void);\n\n#define DEFINE_GLOBAL(type, name, initial) \\\n  type name = initial;                     \\\n  type get_ ## name(void) { return name; }\n</code></pre>\n\n<p>In your header:</p>\n\n<pre><code>DECLARE_GLOBAL(int, var1);\n</code></pre>\n\n<p>In your implementation file:</p>\n\n<pre><code>DEFINE_GLOBAL(int, var1, 42);\n</code></pre>\n\n<p>Try this at home, but <strong>don't consider it as good practice</strong>.</p>\n"}], "owner": {"reputation": 71, "user_id": 5575776, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1b65e8b5093e36a010bdbf56de1cd1f0?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge S", "link": "https://stackoverflow.com/users/5575776/jorge-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1475713501, "creation_date": 1475702638, "question_id": 39883921, "link": "https://stackoverflow.com/questions/39883921/how-to-make-multiple-global-variables-read-only-for-other-modules-in-c", "title": "How to make multiple global variables read-only for other modules in C?", "body": "<p>Let's say I have moduleA.c moduleB.c and moduleC.c, and modules B and C need to read variables from moduleA.h, but I want to prevent them from write these variables, only A can.</p>\n\n<p>After looking for a while, the only solution I found would be to use \"get\" functions, but I certainly have many of those variables. Is there any faster way than creating a \"get\" function for each variable?</p>\n"}, {"tags": ["c", "callstack"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 4, "creation_date": 1475702653, "post_id": 39883866, "comment_id": 67054757, "body": "Is the output from <code>printf</code> correct, though?"}, {"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "edited": false, "score": 1, "creation_date": 1475702745, "post_id": 39883866, "comment_id": 67054801, "body": "A <i>dead variable</i> is one that is not used in its context.  So a reasonably good compiler will not do anything to make its value accessible (like moving it to a register).  It might even optimize away all of its handling."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "edited": false, "score": 0, "creation_date": 1475703038, "post_id": 39883866, "comment_id": 67054934, "body": "@wallyk Any idea how that applies in this case? <code>func1()</code> does use <code>n</code> in both the <code>printf()</code> and when calling <code>doSomething()</code>. I have a feeling it&#39;s due to tail-call optimization, so it&#39;s reusing its parameter block when it makes this call."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475703932, "post_id": 39883866, "comment_id": 67055319, "body": "Did you disable optimization when you compiled?  There are all kinds of interesting optimizations that could be performed on this whole-program-in-one-translation-unit code, and it is conceivable that one of them is responsible for <code>func1()</code>&#39;s <code>n</code> parameter being dead.  What output does the program produce for you?"}, {"owner": {"reputation": 1482, "user_id": 2361174, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8e0e64bdc8698e29a7cb9d50d5bf0f0c?s=128&d=identicon&r=PG", "display_name": "user2361174", "link": "https://stackoverflow.com/users/2361174/user2361174"}, "edited": false, "score": 0, "creation_date": 1475704110, "post_id": 39883866, "comment_id": 67055398, "body": "The call stack is from a debugger that I&#39;m using. I do not know if optimization is being disabled because I don&#39;t have access to it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1475704379, "post_id": 39883866, "comment_id": 67055493, "body": "What do you mean you &quot;don&#39;t have access to it&quot;?  Are you talking about the code you&#39;ve presented in the question?  Surely you have control over how that&#39;s compiled.  We can only speak to what you actually present to us, and if that&#39;s not representative of the real problem, then your chances of getting useful help are slim."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475704860, "post_id": 39883866, "comment_id": 67055638, "body": "FWIW, the code you presented compiles fine for me with gcc 4, produces plausible output when run, and gdb 7.2 backtraces of it do not exhibit any discernable weirdness analogous to that in the backtrace you presented, whether compiled with or without optimization."}, {"owner": {"reputation": 1482, "user_id": 2361174, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8e0e64bdc8698e29a7cb9d50d5bf0f0c?s=128&d=identicon&r=PG", "display_name": "user2361174", "link": "https://stackoverflow.com/users/2361174/user2361174"}, "edited": false, "score": 0, "creation_date": 1475704863, "post_id": 39883866, "comment_id": 67055640, "body": "I did not disable optimization in the sample code. But the call stack is representation of the actual code&#39;s call stack, I just changed the variables so it matches. As for the actual code I am unaware if optimization is disabled or not. The sample code and actual use different compilers, I&#39;m trying to run the sample code through the same compiler as the actual code but for now this is all I can provide."}, {"owner": {"reputation": 1482, "user_id": 2361174, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8e0e64bdc8698e29a7cb9d50d5bf0f0c?s=128&d=identicon&r=PG", "display_name": "user2361174", "link": "https://stackoverflow.com/users/2361174/user2361174"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475704948, "post_id": 39883866, "comment_id": 67055673, "body": "@John Bollinger So I can assume this is an issue of the compiler and not the code?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475704966, "post_id": 39883866, "comment_id": 67055681, "body": "I&#39;m sorry then.  If you cannot present anything with which we can reproduce the problem then your question is off-topic here."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475705043, "post_id": 39883866, "comment_id": 67055713, "body": "I cannot say whether the actual problem is with compiler or code without examining code that at least adequately <i>models</i> the actual problem.  I doubt anyone else around here can do, either.  It seems likely, however, that both contribute."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1475708229, "post_id": 39883866, "comment_id": 67056659, "body": "Minor notes: although this is very unlikely to have anything to do with your bug, it\u2019s a bad idea to assume that <code>int</code> is the same as <code>uint32_t</code> or that a function pointer is the same size as an object pointer (except on POSIX).  The portable way to print an int32_t is with <code>PRId32</code> from <code>&lt;inttypes.h&gt;</code> or <code>%ld</code> matching <code>(long)n</code>.  Function pointers might not be the same size as object pointers.  The only truly portable way to print a function pointer would be to convert the object representation to an array of <code>unsigned char</code>."}], "answers": [{"comments": [{"owner": {"reputation": 638, "user_id": 4262207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iHUQgHLj_t0/AAAAAAAAAAI/AAAAAAAAACM/nE_ak8mRoJE/photo.jpg?sz=128", "display_name": "lolololol ol", "link": "https://stackoverflow.com/users/4262207/lolololol-ol"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1475704669, "post_id": 39884108, "comment_id": 67055585, "body": "@KeithThompson Rephrased."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1475705089, "post_id": 39884108, "comment_id": 67055724, "body": "Suggested tweak: the compiler <i>may</i> optimize by removing the code. (Deleting my previous comment.)"}, {"owner": {"reputation": 638, "user_id": 4262207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iHUQgHLj_t0/AAAAAAAAAAI/AAAAAAAAACM/nE_ak8mRoJE/photo.jpg?sz=128", "display_name": "lolololol ol", "link": "https://stackoverflow.com/users/4262207/lolololol-ol"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1475705199, "post_id": 39884108, "comment_id": 67055758, "body": "@KeithThompson Rephrased again.  Btw, OP should turn off optimization flags.    That or declare <code>n</code> as <code>volatile</code>...so there&#39;s barely any chance of any optimization going on.  Then OP should probably not see <code>&lt;&lt; dead &gt;&gt; </code>."}], "tags": [], "owner": {"reputation": 638, "user_id": 4262207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iHUQgHLj_t0/AAAAAAAAAAI/AAAAAAAAACM/nE_ak8mRoJE/photo.jpg?sz=128", "display_name": "lolololol ol", "link": "https://stackoverflow.com/users/4262207/lolololol-ol"}, "is_accepted": false, "score": 3, "last_activity_date": 1475705125, "last_edit_date": 1475705125, "creation_date": 1475703380, "answer_id": 39884108, "question_id": 39883866, "link": "https://stackoverflow.com/questions/39883866/dead-c-variables/39884108#39884108", "title": "Dead C variables", "body": "<p>Dead variables are variables that are written to, but never read again.  The compiler may optimize by removing this code since it won't affect the result, anyways.</p>\n"}], "owner": {"reputation": 1482, "user_id": 2361174, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8e0e64bdc8698e29a7cb9d50d5bf0f0c?s=128&d=identicon&r=PG", "display_name": "user2361174", "link": "https://stackoverflow.com/users/2361174/user2361174"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1475705125, "creation_date": 1475702395, "question_id": 39883866, "link": "https://stackoverflow.com/questions/39883866/dead-c-variables", "title": "Dead C variables", "body": "<p>I'm working on some private code that I can't show, but I've made some sample code to describe my issue: </p>\n\n<p>main.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n\ntypedef uint32_t (*FuncPtr)(char *s, uint32_t n);\n\nuint32_t doSomething(char *s, uint32_t n){ \n    printf(\"n is %d in doSomething\\n\", n);\n    printf(\"s is '%s' in doSomething\\n\\n\", s);\n    return 0;\n\n}\n\nuint32_t func1(char *s, uint32_t n){\n    printf(\"n is %d in func1\\n\", n);\n    printf(\"s is '%s' in func1\\n\\n\", s);\n    return doSomething(s, n);\n}\n\nuint32_t func2(char *s, uint32_t n){\n    printf(\"n is %d in func2\\n\", n);\n    printf(\"s is '%s' in func2\\n\\n\", s);\n    return doSomething(s, n);\n}\n\nuint32_t func3(char *s, uint32_t n){\n    printf(\"n is %d in func3\\n\", n);\n    printf(\"s is '%s' in func3\\n\\n\", s);\n    return doSomething(s, n);\n}\n\nvoid perform(FuncPtr fp, char *s, uint32_t n){\n    printf(\"fp is location in %p\\n\", fp);\n    printf(\"n is %d in perform\\n\", n);\n    printf(\"s is '%s' in perform\\n\\n\", s);\n    fp(s, n);\n}\n\nint main(void) {\n\n    srand(time(NULL));\n    uint32_t r = (uint32_t)(rand() % 3 + 1);\n    uint32_t n = (uint32_t)(rand() %100);\n    char *s = \"some string here\";\n\n    printf(\"r is %d\\n\", r);\n    printf(\"n is %d in main\\n\", n);\n    printf(\"s is '%s' in main\\n\\n\", s);\n\n    switch(r)\n    {\n        case 1:\n            perform(func1, s, n);\n            break;\n        case 2:\n            perform(func2, s, n);\n            break;\n        case 3:\n            perform(func3, s, n);\n            break;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Here's the call stack:</p>\n\n<pre><code> 0  func1(s=0x9abcdef0, n=0 &lt;&lt; Dead &gt;&gt;) [..\\main.c:9,1]\n 1  perform(fp=0x12345678, s=0x9abcdef0, n=42)  [..\\main.c:21,1]\n 2  main()  [..\\main.c:25,10]\n</code></pre>\n\n<p>As you can see on the top, the <code>n</code> that is passed into <code>func1</code> is <code>&lt;&lt; dead &gt;&gt;</code> and does not match the value in <code>perform</code> even though the <code>s</code> pointer always holds on to the same address. Why is this happening? I haven't found a helpful description of what a dead variable is anywhere. Is there any fix I can make to this code or does this involve more compiler/memory issues that I can't implement here? </p>\n"}, {"tags": ["c", "macos", "debugging", "homebrew", "valgrind"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1475708393, "post_id": 39883553, "comment_id": 67056710, "body": "I&#39;ve had no major problems (beyond needing to add custom suppressions) with downloading and building Valgrind from the SVN repository using the XCode (<code>clang</code> and <code>clang++</code>) compilers."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6806239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2f3d01eba90f1896c328e325c92829b2?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Kali", "link": "https://stackoverflow.com/users/6806239/pedro-kali"}, "edited": false, "score": 2, "creation_date": 1475713124, "post_id": 39884490, "comment_id": 67057845, "body": "Thank you for responding .. I got this error message: <code>valgrind: This formula either does not compile or function as expected on macOS versions newer than El Capitan due to an upstream incompatibility. Error: An unsatisfied requirement failed this build.</code>"}, {"owner": {"reputation": 1, "user_id": 5837433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1a7e652b8f4c99e4efbcae7c04fd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "Zaid Albirawi", "link": "https://stackoverflow.com/users/5837433/zaid-albirawi"}, "edited": false, "score": 0, "creation_date": 1479791462, "post_id": 39884490, "comment_id": 68694840, "body": "Valgrind released a new version on the 24th of October I believe, that does support Sierra. Which I am assuming is what you have. Try it now?"}], "tags": [], "owner": {"reputation": 178, "user_id": 6768337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BKs9b.jpg?s=128&g=1", "display_name": "Pol Conin", "link": "https://stackoverflow.com/users/6768337/pol-conin"}, "is_accepted": true, "score": 2, "last_activity_date": 1475705394, "creation_date": 1475705394, "answer_id": 39884490, "question_id": 39883553, "link": "https://stackoverflow.com/questions/39883553/install-valgrind-in-macos-x/39884490#39884490", "title": "Install valgrind in MacOS X", "body": "<p>you can use \"brew install valgrind\" to install valgrind.</p>\n"}], "owner": {"reputation": 55, "user_id": 6806239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2f3d01eba90f1896c328e325c92829b2?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Kali", "link": "https://stackoverflow.com/users/6806239/pedro-kali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 1, "closed_date": 1475708061, "accepted_answer_id": 39884490, "answer_count": 1, "score": 1, "last_activity_date": 1477413562, "creation_date": 1475701152, "last_edit_date": 1477413562, "question_id": 39883553, "link": "https://stackoverflow.com/questions/39883553/install-valgrind-in-macos-x", "closed_reason": "Duplicate", "title": "Install valgrind in MacOS X", "body": "<p>I am not sure if I can install <code>valgrind</code> debugger in my Macbook Pro. I searched online but most posts are related to Ubuntu. Can someone tell if this is possible? If so, can it be by brew for example?</p>\n"}, {"tags": ["c", "arrays", "file", "csv", "eof"], "comments": [{"owner": {"reputation": 4039, "user_id": 1397919, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/90c6f9c74ae14b8d63092782bd285ae7?s=128&d=identicon&r=PG", "display_name": "Dinesh", "link": "https://stackoverflow.com/users/1397919/dinesh"}, "edited": false, "score": 1, "creation_date": 1475701122, "post_id": 39883500, "comment_id": 67054120, "body": "<code>fscanf</code> returns number of successful matches. You could check and be sure it is returning 2"}, {"owner": {"reputation": 2476, "user_id": 677202, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5544d46b2d8a81515a4704b3e2048e38?s=128&d=identicon&r=PG", "display_name": "nosbor", "link": "https://stackoverflow.com/users/677202/nosbor"}, "edited": false, "score": 0, "creation_date": 1475701409, "post_id": 39883500, "comment_id": 67054243, "body": "You shouldn&#39;t store useername and password as a plain text"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1475701811, "post_id": 39883500, "comment_id": 67054410, "body": "<code>while(!feof(file3)){</code> is always wrong"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1475701922, "post_id": 39883500, "comment_id": 67054454, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2737, "user_id": 1788229, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8jpAD.png?s=128&g=1", "display_name": "Stavros Zavrakas", "link": "https://stackoverflow.com/users/1788229/stavros-zavrakas"}, "is_accepted": false, "score": 0, "last_activity_date": 1475701987, "creation_date": 1475701987, "answer_id": 39883756, "question_id": 39883500, "link": "https://stackoverflow.com/questions/39883500/c-reading-csv-file-in-char-array/39883756#39883756", "title": "C - Reading CSV file in char array", "body": "<p>In my case I have the expected results, but I don't know if there is a difference with the compiler or if my csv file is different (I've tried to recreate it). Here is another way to parse the file, check if you have the expected results:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define LINE_LENGTH 1000\n\nint main(void) {\n  char userLogin[100];\n  char userPassword[100];\n\n  char line[LINE_LENGTH];\n  char *delimiter = \",\";\n  char *token;\n\n  FILE *file3 = fopen(\"signup_db.csv\", \"r\");\n\n  while(fgets(line, LINE_LENGTH, file3) != NULL) {\n    token = strtok(line, delimiter);\n    printf(\"%s\\n\", token);\n    token = strtok(NULL, delimiter);\n    printf(\"%s\\n\", token);\n  }\n\n  fclose(file3);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 6928473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54PG1.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/6928473/mat"}, "is_accepted": true, "score": 0, "last_activity_date": 1475702626, "creation_date": 1475702626, "answer_id": 39883916, "question_id": 39883500, "link": "https://stackoverflow.com/questions/39883500/c-reading-csv-file-in-char-array/39883916#39883916", "title": "C - Reading CSV file in char array", "body": "<p>The 'fscanf()' function returns the number of items of the argument list successfully filled. So instead try this:</p>\n\n<pre><code>while(fscanf(file3,\"%[^,],%s\",userLogin,userPassword) == 2)\n{\n  puts(userLogin);\n  puts(userPassword);\n}\n</code></pre>\n\n<p>The problem you mentioned is probably because of a new line character at the end of your file. When you read the last line, you have not yet reached the end of file. The above code solves this issue.</p>\n"}], "owner": {"reputation": 2073, "user_id": 4542815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6e90c3f71f084d5f6b0bf00a31b9db88?s=128&d=identicon&r=PG&f=1", "display_name": "Kshitiz ", "link": "https://stackoverflow.com/users/4542815/kshitiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 0, "accepted_answer_id": 39883916, "answer_count": 2, "score": -2, "last_activity_date": 1475702626, "creation_date": 1475700949, "question_id": 39883500, "link": "https://stackoverflow.com/questions/39883500/c-reading-csv-file-in-char-array", "title": "C - Reading CSV file in char array", "body": "<p>I have a very little experience in C programming, particularly File Handling. I am developing a project in which I'm supposed to create a Sign Up/Log In system. I have a .csv file in which the data are separated by , \nWhat I am trying to do is reading the first and second column into two char arrays respectively.</p>\n\n<pre><code>char userLogin[100]; \nchar userPassword[100];\nFILE *file3 = fopen(\"C:\\\\Users\\\\Kshitiz\\\\Desktop\\\\BAAS\\\\signup_db.csv\",\"r\");\nif(file3 != NULL){\n        while(!feof(file3)){\n        fscanf(file3,\"%[^,],%s\",userLogin,userPassword);\n        puts(userLogin);\n        puts(userPassword);\n        }\n\n    }\n\n\n fclose(file3);\n</code></pre>\n\n<p>Content of signup_db.csv:</p>\n\n<pre><code>Username,Password\nSBI063DDN,Qazwsx1234\nICICIDDN456,WSXEDC1234r\n</code></pre>\n\n<p>Expected Output:</p>\n\n<pre><code>Username\nPassword\n\nSBI063DDN\nQazwsx1234\n\nICICIDDN456\nWSXEDC1234r\n</code></pre>\n\n<p>Output which I'm getting:</p>\n\n<pre><code>Username\nPassword\n\nSBI063DDN\nQazwsx1234\n\nICICIDDN456\nWSXEDC1234r\n\n\nWSXEDC1234r\n</code></pre>\n\n<p>Can anyone please help me how can I resolve this issue? Thank you!</p>\n"}, {"tags": ["c", "memory-management"], "comments": [{"owner": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "edited": false, "score": 2, "creation_date": 1475704959, "post_id": 39883455, "comment_id": 67055680, "body": "(1) Please try running a debugger and collect the backtrace. (2) Please check the return values of <code>malloc()</code> and <code>realloc()</code>.  (3) Please show the call(s) to <code>inSort()</code>."}, {"owner": {"reputation": 51, "user_id": 6775754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ed97743b8a3a2f4c211014f2056044?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6775754/james"}, "reply_to_user": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "edited": false, "score": 0, "creation_date": 1475736503, "post_id": 39883455, "comment_id": 67064681, "body": "@Arun Here&#39;s the whole thing. I don&#39;t know how to use a debugger yet."}, {"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 1, "creation_date": 1475745739, "post_id": 39883455, "comment_id": 67070340, "body": "The way you&#39;re using <code>strcat</code> with <code>filename</code> leads to a buffer overflow."}, {"owner": {"reputation": 51, "user_id": 6775754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ed97743b8a3a2f4c211014f2056044?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6775754/james"}, "reply_to_user": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1475754766, "post_id": 39883455, "comment_id": 67076130, "body": "@MichaelFoukarakis How so? Is it because the function calls are nested?         <code>fopen(strcat(filename, &quot;.sorted&quot;), &quot;w&quot;);</code> This does look like a &#39;poor style&#39; of code. Though the program runs OK with a smaller number of integers to merge-sort."}, {"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 1, "creation_date": 1475756919, "post_id": 39883455, "comment_id": 67077560, "body": "@James, simply put, <code>filename</code> does not have enough space for the result of <code>strcat</code> when you input a filename of more than 7 characters."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475782312, "post_id": 39883455, "comment_id": 67093865, "body": "when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter value(s)) to assure the operation was successful.    When using the <code>%s</code> format specifier with any of the <code>scanf()</code> family of functions, ALWAYS use a <code>max characters</code> modifier that is one less than the length of the input buffer, to avoid any buffer overflow, which would be undefined behavior and can lead to a seg fault event."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475782463, "post_id": 39883455, "comment_id": 67093954, "body": "<i>I don&#39;t know how to use a debugger yet.</i>   This will/is a major hindrance to your becoming a good programmer, or even to debug your own code.  Strongly suggest learning your IDE debugger and/or the <code>gdb</code>/<code>ddd</code> debugger"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475782585, "post_id": 39883455, "comment_id": 67093998, "body": "when working with large amounts of data, do NOT put the data on the stack,  use <code>mmap()</code> or <code>malloc()</code> to obtain the needed room for the data."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475783029, "post_id": 39883455, "comment_id": 67094207, "body": "<i>How does dynamic allocation exactly work?</i>   The details (normally) do not matter.  The key factor is that when the program is loaded, a huge amount of memory is allocated the &#39;heap&#39;.  Which is usually implemented as linked lists.  Each time any of the heap memory allocation functions (malloc, calloc, realloc) is called, a section of that heap becomes a separate entry in the linked list.  Then a pointer to the data part  is returned to the program.  1) do not change that pointer, 2) do not write beyond that end of that data area 3) , call free() with that pointer to cleanup."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475783427, "post_id": 39883455, "comment_id": 67094404, "body": "do not use <code>feof()</code> to control a loop.  It does not do what you are expecting. use the call to <code>fscanf()</code> to control the loop."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475783512, "post_id": 39883455, "comment_id": 67094440, "body": "you haven&#39;t shown any example of the contents of the input file, so we are not sure that the call to <code>fscanf()</code> is the correct function to use."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475783757, "post_id": 39883455, "comment_id": 67094571, "body": "when calling the function: <code>fopen()</code>, always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475783924, "post_id": 39883455, "comment_id": 67094648, "body": "for ease of readability and understanding, follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475784102, "post_id": 39883455, "comment_id": 67094748, "body": "in C, the returned type from the memory allocation functions is <code>void *</code> so can be assigned to any other pointer.  Casting the returned type just clutters the code, making it more difficult to understand, debug, maintain."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475784647, "post_id": 39883455, "comment_id": 67095060, "body": "when calling <code>realloc()</code>, always set a temporary variable, then check (!=NULL) that temporary variable, before setting the &#39;target&#39; variable Otherwise, when <code>realloc()</code> fails, the &#39;target&#39; variable will contain NULL, so the pointer to the previously allocated memory is lost, resulting in a memory leak.  And accessing where the modified target variable points will result in a seg fault event."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475785195, "post_id": 39883455, "comment_id": 67095357, "body": "the function: <code>mergeSort()</code> is using recursion.  The depth of that recursion will be about log2(n) where n is the size of the incoming data array.  Such a recursion depth may exceed the limits of the <code>stack</code> size, resulting in a seg fault event."}], "answers": [{"comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1475701771, "post_id": 39883636, "comment_id": 67054390, "body": "Actually, the [max] number of stack frames is only <code>log2(1000000)</code>, which is ~20."}, {"owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1475702038, "post_id": 39883636, "comment_id": 67054506, "body": "Good point, although the merge at the &#39;leaf&#39; level could have also been implemented recursively. I wonder if there&#39;s a memory leak in the mergesort itself, or if the algorithm is using up a large amount of stack memory. I guess we&#39;d need the source to know for sure."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1475702356, "post_id": 39883636, "comment_id": 67054622, "body": "Yes. Except for the missing checks for <code>NULL</code> return from <code>malloc&#47;realloc</code> [unlikely based on the stated 1000000 and 16GB], the error would seem to be in the code that has not [yet] been posted."}, {"owner": {"reputation": 51, "user_id": 6775754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ed97743b8a3a2f4c211014f2056044?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6775754/james"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1475736590, "post_id": 39883636, "comment_id": 67064728, "body": "@CraigEstey Edited the post and included the whole code."}], "tags": [], "owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "is_accepted": false, "score": 0, "last_activity_date": 1475702078, "last_edit_date": 1475702078, "creation_date": 1475701409, "answer_id": 39883636, "question_id": 39883455, "link": "https://stackoverflow.com/questions/39883455/merge-sorting-a-large-number-of-integers-recursively-with-a-dynamically-allocate/39883636#39883636", "title": "Merge-sorting a large number of integers recursively with a dynamically allocated array throws fault", "body": "<p>You are looking in the wrong place. Your heap memory is fine, the issue is your stack. Every time you call a function in C (unless it is compiled away or inlined) the compiler 'saves' all the local variables of the current function (including arguments) then calls the next function so that the previous function's information is ready when it ends. This is the stack. </p>\n\n<p>By recursively calling mergesort on a million values, you not only allocate about 4MB on the heap, you also allocate <code>sizeof(ALL_THE_STUFF_MERGE_SORT_NEEDS) * 1000000</code> bytes on the stack. This will almost certainly produce a stack overflow. </p>\n\n<p>Try unraveling the recursion in mergesort to use a loop instead. That way you don't have to 'save' the function's state each recursive call and can just re-use the same variables over again. (You can google search for unrolled mergesort online to see how it works)</p>\n\n<p>EDIT: I forgot that mergesort will only call itself 20 times if properly implemented on a million integers, nonetheless this may still be the problem, or at least related to it, so I'll keep my answer here.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6775754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ed97743b8a3a2f4c211014f2056044?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6775754/james"}, "edited": false, "score": 0, "creation_date": 1475736893, "post_id": 39884167, "comment_id": 67064883, "body": "Added the code on the post. Thanks for mentioning about the stack. I have no clue, but I&#39;ll be researching on this."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 51, "user_id": 6775754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ed97743b8a3a2f4c211014f2056044?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6775754/james"}, "edited": false, "score": 0, "creation_date": 1475758630, "post_id": 39884167, "comment_id": 67078895, "body": "Why the downvote? the problem was properly diagnosed, extra information was needed to pin it down to a specific part of the source code."}, {"owner": {"reputation": 51, "user_id": 6775754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ed97743b8a3a2f4c211014f2056044?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6775754/james"}, "edited": false, "score": 0, "creation_date": 1475759145, "post_id": 39884167, "comment_id": 67079295, "body": "I didn&#39;t realize doing that. Vote button&#39;s acting out. Why is <code>while (!feof(tosort))</code> wrong?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 51, "user_id": 6775754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ed97743b8a3a2f4c211014f2056044?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6775754/james"}, "edited": false, "score": 0, "creation_date": 1475759459, "post_id": 39884167, "comment_id": 67079517, "body": "@James: check this out: <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1475759492, "last_edit_date": 1495540856, "creation_date": 1475703668, "answer_id": 39884167, "question_id": 39883455, "link": "https://stackoverflow.com/questions/39883455/merge-sorting-a-large-number-of-integers-recursively-with-a-dynamically-allocate/39884167#39884167", "title": "Merge-sorting a large number of integers recursively with a dynamically allocated array throws fault", "body": "<p>Your array allocator seems OK.  The problem is elsewhere:</p>\n\n<ul>\n<li>which implementation of <code>mergesort</code> do you use?</li>\n<li>can you post the code?</li>\n<li>does it allocate memory for the temporary working array on the stack or from the heap?</li>\n<li>if this temporary array is allocated <em>on the stack</em> (automatic storage), it is very likely the cause for your problem as the stack space is usually limited by default to a few megabytes on current systems.</li>\n</ul>\n\n<p><strong>EDIT:</strong> the temporary array is indeed allocated in automatic storage (<em>on the stack</em>) in the <code>main()</code> function: <code>int sortedArray[n];</code>.  Allocating this with <code>malloc()</code> should solve the issue, but you have other issues such as <code>while (!feof(tosort))</code> which is always wrong, as explained here: <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a></p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6775754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ed97743b8a3a2f4c211014f2056044?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6775754/james"}, "edited": false, "score": 0, "creation_date": 1475758172, "post_id": 39891053, "comment_id": 67078545, "body": "Thanks! I can now sort a multiple million integers and understand stack better than before."}, {"owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "edited": false, "score": 0, "creation_date": 1475765285, "post_id": 39891053, "comment_id": 67083793, "body": "Nice catch. Just a quick tidbit: I believe that the UNIX command in question is <code>ulimit</code> not <code>limit</code> iirc?"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "edited": false, "score": 0, "creation_date": 1475782624, "post_id": 39891053, "comment_id": 67094014, "body": "@LambdaBeta Yes. To be effective, the command has to be a shell builtin. I use <code>tcsh</code> for my shell and the command is <code>limit</code>. For <code>bash</code> et. al. the command is <code>ulimit</code>. I had remembered this, later, but was too tired to add it. Besides, I don&#39;t condone use of <code>bash</code> :-) Seriously, the programmatic way would be to use <code>getrlimit&#47;setrlimit</code> within the target program"}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 3, "last_activity_date": 1475743867, "last_edit_date": 1475743867, "creation_date": 1475742171, "answer_id": 39891053, "question_id": 39883455, "link": "https://stackoverflow.com/questions/39883455/merge-sorting-a-large-number-of-integers-recursively-with-a-dynamically-allocate/39891053#39891053", "title": "Merge-sorting a large number of integers recursively with a dynamically allocated array throws fault", "body": "<p>Your bug is that you are using a <em>large</em> stack based VLA <code>sortedArray</code>. With 1,000,000 values, your array is 4MB and you get a segfault due to stack overflow because the array exceeds the preset stack size limit.</p>\n\n<p>For example, under linux, the stack limit is around 8MB [on my system, I had to increase the array count to 3,000,000 to reproduce the segfault]</p>\n\n<hr>\n\n<p>Change:</p>\n\n<pre><code>    //temporary array for use with the merge sort\n    int sortedArray [n];\n</code></pre>\n\n<p>Into:</p>\n\n<pre><code>    //temporary array for use with the merge sort\n    int *sortedArray = malloc(sizeof(int) * n);\n</code></pre>\n\n<p>Optionally, at the bottom of <code>main</code> you can add a <code>free(sortedArray)</code> for tidiness if you wish.</p>\n\n<hr>\n\n<p>Also, you can use the <code>limit</code> shell command to see what the <code>stacksize</code> parameter is set to. So, an alternate way to fix the problem would be to use the command to increase the limit. But, I do <em>not</em> recommend that as it's a less general and more fragile solution than simply using <code>malloc</code>.</p>\n\n<hr>\n\n<p>On debugging tips ...</p>\n\n<p>To find your problem, I did the following:</p>\n\n<p>Compiled the program with debug info: <code>gcc -o blah -g blah.c</code></p>\n\n<p>Invoked the debugger with <code>gdb ./blah</code></p>\n\n<p>Ran the program [inside the debugger] with <code>run</code></p>\n\n<p>I got the segfault information below:</p>\n\n<pre><code>Starting program: ...\nEnter the name of file with a list of integers to sort: input2\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00000000004009d1 in main () at blah.c:64\n64      clock_gettime(CLOCK_REALTIME, &amp;start);  //start\n</code></pre>\n\n<p>It didn't make much sense that <code>clock_gettime</code> was faulting, so I looked at the line above it:</p>\n\n<pre><code>    int sortedArray [n];\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6775754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ed97743b8a3a2f4c211014f2056044?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6775754/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "accepted_answer_id": 39891053, "answer_count": 3, "score": 3, "last_activity_date": 1475759492, "creation_date": 1475700797, "last_edit_date": 1475708466, "question_id": 39883455, "link": "https://stackoverflow.com/questions/39883455/merge-sorting-a-large-number-of-integers-recursively-with-a-dynamically-allocate", "title": "Merge-sorting a large number of integers recursively with a dynamically allocated array throws fault", "body": "<p>I wrote a C program to merge-sort (recursive) integers, using a dynamically allocated array. It works fine with up to 100k integers, but when I feed 1 million integers, it throws the <code>Segmentation fault (core dumped)</code> error.</p>\n\n<p>Why does it do this? Is my 16GB RAM not good enough? Would it be able to sort bigger number of integers if I didn't use a dynamically allocated array?</p>\n\n<p>How does dynamic allocation exactly work? From my understanding, when a dynamic variable or an element in an dynamic array is declared, a portion of memory (RAM?) is put aside and set to strictly store the declared variable until the memory is freed.</p>\n\n<p>When my program tries to set aside memory to hold a million integers, does it fail because there isn't enough memory available?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\n#define BIL 1E9\n\n//struct Sort allows dynamic allocation of the array used in insertion sort.\ntypedef struct {\n    int *arr; //pointer to the dynamic array\n    size_t used; //stores number of 'used' elements in the array\n    size_t size; //stores number of total elements\n} Sort;\n\n//function prototypes to interact with the dynamic array\nvoid freeSort(Sort *);\nvoid initSort(Sort *, size_t);\nvoid inSort(Sort *, int);\n\n//prototypes for the Merge Sort\nvoid mergeSort(Sort *, int, int, int []);\nvoid merge(Sort *, int, int, int, int []);\nvoid copyArray(int [], int, int, Sort *);\n\n\n\nint main(){\n\n    //declare Sort variable 'magic' to perform the magical insertion sort on the dynamic array.\n    Sort magic;\n    initSort(&amp;magic, 10); //initialize magic with 10 elements\n\n    //variables to allow the program to function\n    int intin;\n    char filename[15];\n\n    //tosort is the file to sort.\n    //sorted is the output file after sort.\n    FILE *tosort, *sorted;\n\n    //necessary variables to measure time\n    struct timespec start, finish;\n\n    //prompt user for file name.\n    printf(\"Enter the name of file with a list of integers to sort: \");\n    scanf(\"%s\", filename);\n    tosort = fopen(filename, \"r\"); //read 'tosort' file\n\n    //write the 'sorted' file to 'filename.sorted'\n    sorted = fopen(strcat(filename, \".sorted\"), \"w\");\n\n    //while loop stores every integer in the dynamically allocated magic array from tosort file.\n    while (!feof(tosort)) {\n        fscanf(tosort, \"%d\", &amp;intin);\n        inSort(&amp;magic, intin);\n    }\n\n    //n stores number of integers to sort\n    int n = magic.used;\n    //temporary array for use with the merge sort\n    int sortedArray [n];\n\n    //measure time\n    clock_gettime(CLOCK_REALTIME, &amp;start);  //start\n\n    //Merge Sort\n    mergeSort(&amp;magic, 0, n, sortedArray);\n\n    clock_gettime(CLOCK_REALTIME, &amp;finish); //finish\n\n    //calculate the elapsed time in nanoseconds.\n    double elapsed = (finish.tv_sec-start.tv_sec)+(finish.tv_nsec-start.tv_nsec)/BIL;\n\n    printf(\"Merge Sort took %lf seconds\\n\", elapsed);\n\n    //write the sorted array to 'sorted' ('filename'.sorted)\n    for (int i = 0; i &lt; n; i++) {\n        fprintf(sorted, \"%d\\n\", magic.arr[i]);\n    }\n\n    //free up the allocated memory for the Sort array and close the files.\n    freeSort(&amp;magic);\n    fclose(tosort);\n    fclose(sorted);\n\n    return 0;\n}\n\n//initialize the dynamic array\nvoid initSort(Sort *dynA, size_t initSize) {\n    dynA-&gt;arr = (int *)malloc(initSize * sizeof(int));\n    dynA-&gt;used = 0;\n    dynA-&gt;size = initSize;\n}\n\n//add values to the elements of the dynamic array\nvoid inSort(Sort *dynA, int val) {\n    //if the array size is not big enough to fit new values, allocate 100 more elements.\n    if (dynA-&gt;used == dynA-&gt;size) {\n        dynA-&gt;size += 100;\n        dynA-&gt;arr = (int *)realloc(dynA-&gt;arr, dynA-&gt;size * sizeof(int));\n    }\n    //'used' holds the number of used elements with values in the array.\n    dynA-&gt;arr[dynA-&gt;used++] = val;\n}\n\n//free allocated memory for the dynamic array\nvoid freeSort(Sort *dynA) {\n  free(dynA-&gt;arr);\n  dynA-&gt;arr = NULL;\n  dynA-&gt;used = dynA-&gt;size = 0;\n}\n\n\n//split the array until size is 1\nvoid mergeSort(Sort *dynA, int begin, int end, int tempA [])\n{\n    //if size is 1, done splitting.\n    if(end-begin &lt; 2)\n        return;\n\n    // recursively split the array\n    int mid = (end+begin)/2; // mid = middle point\n    mergeSort(dynA, begin, mid, tempA); // mergeSort left half\n    mergeSort(dynA, mid, end, tempA); // mergeSort right half\n    merge(dynA, begin, mid, end, tempA); // merge the two halves\n    copyArray(tempA, begin, end, dynA); // copy the merged array to dynA\n}\n\n//merge the two arrays\nvoid merge (Sort *dynA, int begin, int mid, int end, int tempA [])\n{\n    int i = begin; int j = mid;\n\n    //from begin to end, compare the values of the two arrays\n    for (int k = begin; k &lt; end; k++)\n\n        // store the smaller value into tempA[k]\n        if (j &gt;= end || (i &lt; mid &amp;&amp; dynA-&gt;arr[i] &lt;= dynA-&gt;arr[j]))\n            tempA[k] = dynA-&gt;arr[i++];\n        else tempA[k] = dynA-&gt;arr[j++];\n}\n\n//copy the contents of the temporary array to the dynamic array\nvoid copyArray(int tempA[], int begin, int end, Sort *dynA){\n    for(int k = begin; k &lt; end; k++)\n        dynA-&gt;arr[k] = tempA[k];\n}\n</code></pre>\n\n<p>Cygwin64 and CommandPrompt give same faults when I feed a million integers to sort.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 5, "creation_date": 1475699723, "post_id": 39883161, "comment_id": 67053448, "body": "Can you post an example of what you&#39;re trying to do?"}, {"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 0, "creation_date": 1475699776, "post_id": 39883161, "comment_id": 67053485, "body": "You&#39;re probably looking for pointer arguments to function."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475699808, "post_id": 39883161, "comment_id": 67053502, "body": "An <code>inline</code> function?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475700266, "post_id": 39883161, "comment_id": 67053724, "body": "@WeatherVane Variable scope in inline functions is the same as normal functions, they can&#39;t access the caller&#39;s scope."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1475700364, "post_id": 39883161, "comment_id": 67053769, "body": "@Barmar Perhaps <code>int x[1]; foo(x);</code> to affect the variable in <code>main()</code>."}, {"owner": {"reputation": 698, "user_id": 1008775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee85c42c4e55d88580fac846d2068280?s=128&d=identicon&r=PG", "display_name": "orangething", "link": "https://stackoverflow.com/users/1008775/orangething"}, "edited": false, "score": 1, "creation_date": 1475704414, "post_id": 39883161, "comment_id": 67055508, "body": "It really sounds like they&#39;re wanting to use a C macro. This is what they mean by virtually inserting itself into the main function code, and also by directly affecting the variables defined in the scope of main."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6210245, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RgBVKSKrA8A/AAAAAAAAAAI/AAAAAAAAAEg/d3yNSiLQQc4/photo.jpg?sz=128", "display_name": "aBlaze", "link": "https://stackoverflow.com/users/6210245/ablaze"}, "edited": false, "score": 1, "creation_date": 1475700044, "post_id": 39883235, "comment_id": 67053618, "body": "I&#39;m not a super competent programmer which might explain why I&#39;m asking this in the first place, I didn&#39;t know the #define directive had this utility but now I think about it that makes sense."}], "tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": true, "score": 3, "last_activity_date": 1505361859, "last_edit_date": 1505361859, "creation_date": 1475699865, "answer_id": 39883235, "question_id": 39883161, "link": "https://stackoverflow.com/questions/39883161/c-function-which-impersonates-a-block-of-code-in-main/39883235#39883235", "title": "(C) Function which impersonates a block of code in main", "body": "<p>Sounds like you need a preprocessor macro. These aren't real functions, but blocks of code the the preprocessor replaces before compiling the code. E.g., consider a simple macro to increment a number:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define INC(x) (x)++\n\nint main() {\n    int a = 1;\n    INC(a);\n    INC(a);\n    printf(\"%d\\n\", a);\n    return 0;\n}\n</code></pre>\n\n<p>The text <code>INC(a)</code> will be replaced with <code>a++</code>, so running this program will print out 3 (1 after two increments).</p>\n"}], "owner": {"reputation": 35, "user_id": 6210245, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RgBVKSKrA8A/AAAAAAAAAAI/AAAAAAAAAEg/d3yNSiLQQc4/photo.jpg?sz=128", "display_name": "aBlaze", "link": "https://stackoverflow.com/users/6210245/ablaze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 39883235, "answer_count": 1, "score": -3, "last_activity_date": 1505361859, "creation_date": 1475699571, "last_edit_date": 1475727659, "question_id": 39883161, "link": "https://stackoverflow.com/questions/39883161/c-function-which-impersonates-a-block-of-code-in-main", "title": "(C) Function which impersonates a block of code in main", "body": "<p>I'm trying to explain this satisfactorily, but when I call a function I want it to virtually insert itself into the main function's code in the place where I call it, so I can save typing it out multiple times, however it directly affects variables defined in the scope of the main function. What's the best way to achieve this?</p>\n\n<p><strong>EDIT</strong>: I should probably make it clear I also want it to take a single argument.</p>\n"}, {"tags": ["c", "kernel", "xv6"], "comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 2, "creation_date": 1475700618, "post_id": 39883148, "comment_id": 67053892, "body": "Your <code>printf</code> is really strange."}, {"owner": {"reputation": 1251, "user_id": 4324721, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/w57jr.jpg?s=128&g=1", "display_name": "Turtle", "link": "https://stackoverflow.com/users/4324721/turtle"}, "edited": false, "score": 0, "creation_date": 1476119824, "post_id": 39883148, "comment_id": 67206696, "body": "if you are using xv6, you should be using cprintf. I don&#39;t have access to xv6 docs offhand, but lookup the trap 14 and see what is causing the kill command"}, {"owner": {"reputation": 8010, "user_id": 11780, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/def9f21fe6dc3f2ec0368991dd3d23ed?s=128&d=identicon&r=PG", "display_name": "Jeremiah Peschka", "link": "https://stackoverflow.com/users/11780/jeremiah-peschka"}, "edited": false, "score": 0, "creation_date": 1530848922, "post_id": 39883148, "comment_id": 89386664, "body": "I&#39;m voting to close this question as off-topic because this is clearly a homework question and the person asking has done next to no work to solve the problem."}], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 2367447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed711566d4c62baef4bd6cc9887a1211?s=128&d=identicon&r=PG", "display_name": "user2367447", "link": "https://stackoverflow.com/users/2367447/user2367447"}, "is_accepted": false, "score": -2, "last_activity_date": 1476654828, "creation_date": 1476654828, "answer_id": 40075880, "question_id": 39883148, "link": "https://stackoverflow.com/questions/39883148/implementing-a-syscall-in-xv6/40075880#40075880", "title": "Implementing a syscall in xv6", "body": "<p>You should use exit() instead of return 0. It should work.</p>\n"}, {"tags": [], "owner": {"reputation": 84, "user_id": 4717821, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nPm-a9KJg8A/AAAAAAAAAAI/AAAAAAAAAKk/SS3TOdI5gkw/photo.jpg?sz=128", "display_name": "Calum", "link": "https://stackoverflow.com/users/4717821/calum"}, "is_accepted": true, "score": 1, "last_activity_date": 1549265423, "last_edit_date": 1549265423, "creation_date": 1549254507, "answer_id": 54510149, "question_id": 39883148, "link": "https://stackoverflow.com/questions/39883148/implementing-a-syscall-in-xv6/54510149#54510149", "title": "Implementing a syscall in xv6", "body": "<ol>\n<li><p>For <code>sys_getprocs</code>, change this...</p>\n\n<pre><code>if(!(ptr-&gt;state == UNUSED)) {\n    continue;\n}\n</code></pre>\n\n<p>to...</p>\n\n<pre><code>if((ptr-&gt;state == UNUSED)) {\n    continue;\n}\n</code></pre>\n\n<p>Because you want to get all the running processes.</p></li>\n<li><p>In <code>main</code>, change...</p>\n\n<p><code>int N = getprocs(maxElements, &amp;processes);</code></p>\n\n<p>to... </p>\n\n<p><code>int N = getprocs(maxElements, processes);</code></p>\n\n<p>since processes already defined as a pointer</p></li>\n</ol>\n\n<p>Changing these two parts of your code should make the program work.</p>\n"}], "owner": {"reputation": 177, "user_id": 3735271, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bd42bc50fe01f448b4ed16b96e9df1f2?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/3735271/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2828, "favorite_count": 1, "accepted_answer_id": 54510149, "answer_count": 2, "score": 0, "last_activity_date": 1549265423, "creation_date": 1475699503, "question_id": 39883148, "link": "https://stackoverflow.com/questions/39883148/implementing-a-syscall-in-xv6", "title": "Implementing a syscall in xv6", "body": "<p>I am trying to implement a syscall, called getprocs() which returns the number of actual processes. I have already implemented all the necessities to add  a new syscall. What this syscall does is get the processes in the table and copies them to an array of structs. The struct is called uproc, where its members  are int pid, int ppid, and char name. I then have created a program in a.c file that tries to print the processes in tree format but I am having trouble just printing the process name.I do not know  where to go from here. Below I have attached my code where i define getprocs(), the struct uproc, and my program that tries to print the processes. I also included the error it throws at me.</p>\n\n<p>getprocs() definition in proc.c:</p>\n\n<pre><code>int \nsys_getprocs(void)\n{\nint max;\nstruct uproc *p;\nint i = 0;\nargint(0, &amp;max);\nargptr(1, (char **)&amp;p, max*sizeof(struct uproc));\nstruct proc *ptr = ptable.proc;\nfor(; ptr &lt; &amp;ptable.proc[NPROC]; ptr++) {\n  if(!(ptr-&gt;state == UNUSED)) {\n    continue;\n  }\n  p[i].pid = ptr-&gt;pid;\n  p[i].ppid = ptr-&gt;parent-&gt;pid;\n  strncpy(p[i].name, ptr-&gt;name, 16);\n  i++;\n}\nreturn i;\n}\n</code></pre>\n\n<p>struct uproc in uproc.h:</p>\n\n<pre><code>struct uproc {\n    int pid;\n    int ppid;\n    char name[16];\n };\n</code></pre>\n\n<p>program that tries to print processes in pstree.c:</p>\n\n<pre><code>#include \"types.h\"\n#include \"stat.h\"\n#include \"user.h\"\n#include \"uproc.h\"\n\nint main() {\n  printf(20, \"Made it into main\\n\");\n  int maxElements = 64;\n  struct uproc *processes = malloc(maxElements*sizeof(struct uproc));\n  int N = getprocs(maxElements, &amp;processes);\n  int i = 0;\n\n  printf(10, \"Starting\\n\");\n  for(; i &lt; N; i++) {\n    printf(16, processes[i].name);     \n  }\n\n  return 0;\n }\n</code></pre>\n\n<p>Nothing is ever printed to the screen and I get the following error after trying to run pstree:</p>\n\n<p>pid 3 pstree: trap 14 err 4 on cpu 1 eip 0x6da addr 0x42444cb--kill proc</p>\n"}, {"tags": ["c", "assembly"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475699652, "post_id": 39882787, "comment_id": 67053411, "body": "there is no requirement for C to even have a &quot;stack&quot; so if it does, the detail is implementation specific. If there is a user stack which is also the same stack as the hardware stack, so long as the local variables are not in damage from function calls or interrupts, they are safe. Whether they are indexed by a negative offset from <code>ebp</code> or a positive offest from <code>esp</code> is just the implementation&#39;s convention."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1475746078, "post_id": 39882787, "comment_id": 67070578, "body": "In extreme case the variable can be removed completely (if it&#39;s usage doesn&#39;t have any effect on other things, like <code>for (size_t i = 0; i &lt; 1e6; ++i) {}</code> will be removed completely by optimizer, thus <code>i</code> doesn&#39;t exist anywhere except source. Still the binary is valid (by C++ language definition)."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 4178517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003101255168/picture?type=large", "display_name": "Otniel Mercea", "link": "https://stackoverflow.com/users/4178517/otniel-mercea"}, "edited": false, "score": 0, "creation_date": 1475698358, "post_id": 39882849, "comment_id": 67052731, "body": "but in theory it is like i said,no?"}, {"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "reply_to_user": {"reputation": 173, "user_id": 4178517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003101255168/picture?type=large", "display_name": "Otniel Mercea", "link": "https://stackoverflow.com/users/4178517/otniel-mercea"}, "edited": false, "score": 2, "creation_date": 1475698580, "post_id": 39882849, "comment_id": 67052845, "body": "@user6575913 - I&#39;m not certain but I believe there&#39;s no definition of how code should be compiled, only how it should &quot;behave&quot;. Obviously different platforms have different compilations."}], "tags": [], "owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "is_accepted": false, "score": 1, "last_activity_date": 1475698239, "creation_date": 1475698239, "answer_id": 39882849, "question_id": 39882787, "link": "https://stackoverflow.com/questions/39882787/assembly-local-variable-and-parameters/39882849#39882849", "title": "Assembly local variable and parameters", "body": "<p>That's probably a compiler optimization. The variables aren't used within <code>main</code> scope so are placed directly on the stack, ready for the function call.</p>\n"}, {"comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 173, "user_id": 4178517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003101255168/picture?type=large", "display_name": "Otniel Mercea", "link": "https://stackoverflow.com/users/4178517/otniel-mercea"}, "edited": false, "score": 0, "creation_date": 1475699218, "post_id": 39882998, "comment_id": 67053195, "body": "@user6575913 sure, if that&#39;s what you want to call it"}, {"owner": {"reputation": 173, "user_id": 4178517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003101255168/picture?type=large", "display_name": "Otniel Mercea", "link": "https://stackoverflow.com/users/4178517/otniel-mercea"}, "edited": false, "score": 0, "creation_date": 1475699397, "post_id": 39882998, "comment_id": 67053276, "body": "ok.thx for clarification. i just started study this (a security course) and i am willing to learn more."}], "tags": [], "owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "is_accepted": true, "score": 9, "last_activity_date": 1475700064, "last_edit_date": 1475700064, "creation_date": 1475698875, "answer_id": 39882998, "question_id": 39882787, "link": "https://stackoverflow.com/questions/39882787/assembly-local-variable-and-parameters/39882998#39882998", "title": "Assembly local variable and parameters", "body": "<blockquote>\n  <p>I know that local variables are always [ebp-....]</p>\n</blockquote>\n\n<p>They're not (as evidenced by your question too, I suppose).</p>\n\n<p>It's legal for a compiler to compile really naively, always using a frame pointers (even in functions that don't do variable-size stack allocations) and always putting locals on the stack in the first place (which is definitely not a rule). In a first year course in university, it is sometimes pretended that that's normal, to keep things simple.</p>\n\n<p>Not using a frame pointer is usually possible, it works mostly the same as if you had used one except that offsets are calculated relative to the stack pointer, which you are now only allowed to move in predictable ways. Because it has to be predictable (that is, every instructions that references a stack slot can use a constant offset to do so), this optimization cannot be used in functions that use <code>alloca</code> or VLAs. In your example function neither are used, so no frame pointer is necessary.</p>\n\n<p>Also in general you should <em>not</em> expect local variables to correspond to specific stack slots in the first place, regardless of how they are addressed. It is allowed, common, and often a good thing, to keep a variable in a register over the entire lifetime of the variable. Especially if that life time is short or if the usage-density is very high. On top of that, variables with non-overlapping life times can (and should, because it reduces the stack size) share stack slots, since it would be the case that at most one of them needs storage at any one moment (thanks to the assumption of non-overlapping life times).</p>\n\n<p>It's also allowed to have a variable hop from one stack slot to an other, this might happen when you swap two variables in a way that allows the swap to be resolved \"virtually\", by just changing which stack slot the variables live in and not actually exchanging the data.</p>\n"}], "owner": {"reputation": 173, "user_id": 4178517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003101255168/picture?type=large", "display_name": "Otniel Mercea", "link": "https://stackoverflow.com/users/4178517/otniel-mercea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1094, "favorite_count": 0, "accepted_answer_id": 39882998, "answer_count": 2, "score": 2, "last_activity_date": 1475700064, "creation_date": 1475697982, "last_edit_date": 1475698862, "question_id": 39882787, "link": "https://stackoverflow.com/questions/39882787/assembly-local-variable-and-parameters", "title": "Assembly local variable and parameters", "body": "<p>I have the following code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint adunare(int a,int b)\n{\n  int c=3;\n  int d=6;\n\n  while(c&gt;10) c++;\n  if(c&gt;15) return a+b+c+d;\n  else return a+b+c-d;\n}\n\nint main()\n{\n  int w=5;\n  int y=6;\n  printf(\"%d\",adunare(w,y));\n}\n</code></pre>\n\n<p>My question is in assembly it puts the variable w,y at the [esp+24] ,[esp+28]. </p>\n\n<p>Why it puts my variables there? </p>\n\n<p>I know that local variables are always [ebp-....].</p>\n\n<p>Why here it is not [ebp-..]? </p>\n"}, {"tags": ["c", "linux", "multiprocessing", "fork"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 5, "creation_date": 1475697300, "post_id": 39882573, "comment_id": 67052191, "body": "precedence: <code>(pid = fork() &gt; 0)</code> --&gt;&gt; <code>((pid = fork()) &gt; 0)</code>"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1475697440, "post_id": 39882573, "comment_id": 67052256, "body": "Incidentally, this kind of mistake is part of why Python chooses not to have assignments return a value -- forcing the assignment and the comparison into two separate lines prevents the misunderstanding at hand."}, {"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 0, "creation_date": 1475697479, "post_id": 39882573, "comment_id": 67052274, "body": "side note: you&#39;re creating more than 3 process overall this way, each child is also forking off too."}, {"owner": {"reputation": 99, "user_id": 3869669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be1636cfb4185ef4c4168185bd3a23a?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Whaley", "link": "https://stackoverflow.com/users/3869669/steven-whaley"}, "edited": false, "score": 0, "creation_date": 1475697606, "post_id": 39882573, "comment_id": 67052335, "body": "in the full code I had it break out of the loop on (pid == 0)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1475702808, "post_id": 39882573, "comment_id": 67054822, "body": "And some people wonder why doing assignments in conditional clauses is a bad idea..."}], "answers": [{"tags": [], "owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "is_accepted": false, "score": 3, "last_activity_date": 1475697356, "creation_date": 1475697356, "answer_id": 39882615, "question_id": 39882573, "link": "https://stackoverflow.com/questions/39882573/if-pid-fork-0-why-is-fork-returning-pid-1-systemd/39882615#39882615", "title": "&quot;if (pid = fork() &gt; 0)&quot; - Why is fork() returning pid 1 (systemd)?", "body": "<pre><code>pid = fork() &gt; 0\n</code></pre>\n\n<p>fork return value is greater than 0, hence, fork() return value is indeed greater than 0, unless fork sys_call fail, pid gets assign 1.</p>\n"}, {"comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 3, "creation_date": 1475697747, "post_id": 39882620, "comment_id": 67052398, "body": "...or <code>pid = fork(); if (pid &gt; 0)</code>, to make it clear enough that a reader doesn&#39;t even need to think about precedence."}], "tags": [], "owner": {"reputation": 435637, "user_id": 367273, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/f1ed2b0c87f602ef30229f5c4b04eff6?s=128&d=identicon&r=PG", "display_name": "NPE", "link": "https://stackoverflow.com/users/367273/npe"}, "is_accepted": false, "score": 3, "last_activity_date": 1475697360, "creation_date": 1475697360, "answer_id": 39882620, "question_id": 39882573, "link": "https://stackoverflow.com/questions/39882573/if-pid-fork-0-why-is-fork-returning-pid-1-systemd/39882620#39882620", "title": "&quot;if (pid = fork() &gt; 0)&quot; - Why is fork() returning pid 1 (systemd)?", "body": "<p><code>&gt;</code> has higher <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow\">precedence</a> than <code>=</code>.</p>\n\n<p>Therefore <code>pid = fork() &gt; 0</code> is equivalent to <code>pid = (fork() &gt; 0)</code>. This tests whether the result of <code>fork()</code> is greater than zero, and assigns the result of the test to <code>pid</code>. Thus <code>pid</code> will always be zero or one.</p>\n\n<p>What you want is <code>(pid = fork()) &gt; 0</code>.</p>\n"}], "owner": {"reputation": 99, "user_id": 3869669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be1636cfb4185ef4c4168185bd3a23a?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Whaley", "link": "https://stackoverflow.com/users/3869669/steven-whaley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 979, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1475697604, "creation_date": 1475697193, "last_edit_date": 1475697604, "question_id": 39882573, "link": "https://stackoverflow.com/questions/39882573/if-pid-fork-0-why-is-fork-returning-pid-1-systemd", "title": "&quot;if (pid = fork() &gt; 0)&quot; - Why is fork() returning pid 1 (systemd)?", "body": "<p>In my main() function I have a call to fork() in a loop that is successfully creating three child processes. </p>\n\n<p>code is similar to this:</p>\n\n<pre><code>    int pid = -1;\n    int num_processes = 3;\n    int pid_array[num_processes];\n    for (i = 0; i &lt; num_processes; i++)\n    {\n        if (pid = fork() &gt; 0)\n        {\n            pid_array[i] = pid;\n            //do parent stuff\n        }\n    }\n</code></pre>\n\n<p>I can see with 'ps -ef' that the child processes are getting created and have the correct pid for the parent process listed, also these processes are running and functioning properly.</p>\n\n<p>The problem is that I need to store the child pids in the parent's pid_array, but they are all being stored as 1. In gdb I see the fork() is returning a 1 each time instead of the child pid as I would expect. </p>\n\n<p>So it's returning a 1 which is the pid for systemd. Why is it returning pid 1 (systemd) rather than the pids of the child processes which were sucessfully created?</p>\n\n<p>For good measure, the man page for fork on my system:</p>\n\n<pre><code>   RETURN VALUE\n           On success, the PID of the child process is returned  in  the  parent,  and  0  is\n           returned in the child.  On failure, -1 is returned in the parent, no child process\n           is created, and errno is set appropriately.\n</code></pre>\n"}, {"tags": ["c", "multithreading", "thread-safety", "pthreads"], "comments": [{"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 1, "creation_date": 1475696780, "post_id": 39882338, "comment_id": 67051903, "body": "You should also take into consideration how often you plan to do this. This is total overhead."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 2, "creation_date": 1475697082, "post_id": 39882338, "comment_id": 67052084, "body": "Determining how much resources you are going to use on the base of how much is available is maybe not the best strategy. You should rather base that decision on <i>how much you are going to need</i>"}, {"owner": {"reputation": 1, "user_id": 6590721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qk8qR-X3Tes/AAAAAAAAAAI/AAAAAAAAADU/b_r9zNHejsA/photo.jpg?sz=128", "display_name": "KoushikK", "link": "https://stackoverflow.com/users/6590721/koushikk"}, "reply_to_user": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1475781733, "post_id": 39882338, "comment_id": 67093553, "body": "@TonyTannous: Though I&#39;m planning to do this in a schedule, it might be running almost all the time."}, {"owner": {"reputation": 1, "user_id": 6590721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qk8qR-X3Tes/AAAAAAAAAAI/AAAAAAAAADU/b_r9zNHejsA/photo.jpg?sz=128", "display_name": "KoushikK", "link": "https://stackoverflow.com/users/6590721/koushikk"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1475782378, "post_id": 39882338, "comment_id": 67093907, "body": "@tofro: How much resource I would be needing depends on the data being obtain from the devices using WMI query.Planning on monitoring CPU and memory once every 2 minutes and increase the number of threads if total CPU/memory used is not greater than 2/3 of the total available CPU/memory. Would also check CPU/memory every time a thread is allocated for a host for collection. If the 2/3 criteria is not met then that thread is freed. Think its sufficient to perform the check only when event collection from a new host needs to be done. comments please"}], "owner": {"reputation": 1, "user_id": 6590721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qk8qR-X3Tes/AAAAAAAAAAI/AAAAAAAAADU/b_r9zNHejsA/photo.jpg?sz=128", "display_name": "KoushikK", "link": "https://stackoverflow.com/users/6590721/koushikk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1475696529, "creation_date": 1475696447, "last_edit_date": 1475696529, "question_id": 39882338, "link": "https://stackoverflow.com/questions/39882338/increase-number-of-threads-based-on-resourcecpu-or-memory-on-the-computer-in-c", "title": "Increase number of threads based on resource(CPU or Memory) on the computer.In c programming", "body": "<p>Have a thread queue with a maximum size of N threads(Using p_threads in C). I want to increase or decrease the maximum size of the queue based on the available CPU or RAM.Each threads performs a WMI query(Network call) and processes the result. But we can ignore the network utilization for now.</p>\n\n<p>How do I go about with this safely?</p>\n"}, {"tags": ["c", "binary", "floating-point", "printf"], "comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475696363, "post_id": 39882269, "comment_id": 67051640, "body": "<code>0b</code> must be a gcc extension. It would be nice if you could find the documentation on how it works with floating point initialization."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2271770"}, "edited": false, "score": 0, "creation_date": 1475696554, "post_id": 39882269, "comment_id": 67051758, "body": "<code>printf</code> doesn&#39;t change <code>float</code>s to <code>double</code>s automatically. In many implementations, it just interprets the mem area where the actual argument is as a double. So, please convert your <code>float</code>s explicitely to <code>double</code> before passing them to <code>printf</code>."}, {"owner": {"reputation": 353, "user_id": 6145555, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nhUgN.jpg?s=128&g=1", "display_name": "Zac Taylor", "link": "https://stackoverflow.com/users/6145555/zac-taylor"}, "edited": false, "score": 2, "creation_date": 1475696676, "post_id": 39882269, "comment_id": 67051837, "body": "@CST-Link It shouldn&#39;t matter for printing <code>floaty</code>"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 3, "creation_date": 1475696914, "post_id": 39882269, "comment_id": 67051986, "body": "@CST-Link In C, trailing arguments are subject to default argument promotions, which promotes float to double. Specifiers f and lf are valid for double or float. OP is using the best possible option."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1475697012, "post_id": 39882269, "comment_id": 67052040, "body": "@CST-Link the <code>printf</code> format <code>%f</code> is for <code>double</code> and any <code>float</code> argument is promoted to <code>double</code> in the same way that for <code>%d</code> a <code>char</code> argument is promoted to <code>int</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2271770"}, "edited": false, "score": 0, "creation_date": 1475697060, "post_id": 39882269, "comment_id": 67052068, "body": "Well... I believe that it <i>should</i> matter that <code>printf</code> goes 4 more bytes out of a <code>float</code>s mem representation, bundles that up with the legitimate value and presents that as a <code>double</code>. But, of course, is up to you to decide what <i>you</i> believe. :-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2271770"}, "edited": false, "score": 4, "creation_date": 1475697412, "post_id": 39882269, "comment_id": 67052242, "body": "Haha... apparently I <i>am</i> wrong... thanks everybody to opening up my eyes."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475700515, "post_id": 39882269, "comment_id": 67053850, "body": "@2501: <code>0b</code> is simply GCC&#39;s notation for base-2 integers (many other languages have this exact same notation, and IMO, C99 or at least C11 should&#39;ve added it ... but sadly, they didn&#39;t). W.r.t. floating point initialization, it works <i>exactly</i> the same as any other integer."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1475700876, "post_id": 39882269, "comment_id": 67054008, "body": "@Tim\u010cas Well, obviously. I was hinting to OP that he&#39;s using something that isn&#39;t in plain C."}], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 6145555, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nhUgN.jpg?s=128&g=1", "display_name": "Zac Taylor", "link": "https://stackoverflow.com/users/6145555/zac-taylor"}, "edited": false, "score": 0, "creation_date": 1475697414, "post_id": 39882462, "comment_id": 67052245, "body": "Thanks @LambdaBeta, is there any way to express them using the binary values I originally posted?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1475697830, "post_id": 39882462, "comment_id": 67052441, "body": "Pointer conversion (<code>float*</code> to <code>uint32_t*</code>) is where the UB originates.  Typically a <code>union</code>, when coded well, solves many issues."}, {"owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "edited": false, "score": 1, "creation_date": 1475698051, "post_id": 39882462, "comment_id": 67052554, "body": "Right you are, I got union and aliasing mixed up, that&#39;s pretty embarassing. Its funny because my original test executable actually used a union to prove that the code would work, then I rewrote it using aliasing to be more consice. Its the union that is IB, the aliasing that is UB. I will edit my answer accordingly."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1475702292, "post_id": 39882462, "comment_id": 67054596, "body": "Alternatively (modulo caveat about use of <i>non-standard</i> binary literal): <code>floaty = (floatint){.i = 0b11000011101010110010001000000000};</code> In practical terms, use of hexadecimal floating-point constants is typically preferred: <code>floaty.f = -0x1.564400p+8f;</code>"}], "tags": [], "owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "is_accepted": false, "score": 3, "last_activity_date": 1475698394, "last_edit_date": 1475698394, "creation_date": 1475696855, "answer_id": 39882462, "question_id": 39882269, "link": "https://stackoverflow.com/questions/39882269/using-0b-representation-to-print-printf-float/39882462#39882462", "title": "Using 0b representation to print (printf) float", "body": "<p>The problem is that the compiler is trying to help you out. Your literals (0b1...), which by the way is a non-standard extension and should be written as (0x...), are treaded as literals. The compiler then tries its very best to fit those values into the variables you cast them to. As such it produces very big values that are equal to the integer value of your literals. </p>\n\n<p>To directly assign the value of a variable, you have to use unions (or pointers if you don't mind losing a bit of portability). This code works:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nunion floatint {\n    float f;\n    uint32_t i;\n};\n\nunion doubleint {\n    double d;\n    uint64_t i;\n};    \n\nint main()\n{\n  floatint floaty;\n  doubleint doubley;\n  floaty.i = 0xC3AB2200;\n  doubley.i = 0xC075644000000000; \n  printf(\"Float: %f\\n\", floaty.f); // implementation-defined, in your case IEEE 754\n  printf(\"Double: %lf\\n\", doubley.d); // ditto\n\n}\n</code></pre>\n\n<p>Note that this is the very definition of a union, two (or more) types that share the same representation, but are treated differently. </p>\n"}, {"comments": [{"owner": {"reputation": 353, "user_id": 6145555, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nhUgN.jpg?s=128&g=1", "display_name": "Zac Taylor", "link": "https://stackoverflow.com/users/6145555/zac-taylor"}, "edited": false, "score": 0, "creation_date": 1475697498, "post_id": 39882528, "comment_id": 67052286, "body": "Is there a way to express them using those binary values?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 353, "user_id": 6145555, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nhUgN.jpg?s=128&g=1", "display_name": "Zac Taylor", "link": "https://stackoverflow.com/users/6145555/zac-taylor"}, "edited": false, "score": 0, "creation_date": 1475743590, "post_id": 39882528, "comment_id": 67068825, "body": "@ZacTaylor C doesn&#39;t provide direct  provisions to operate at bit levels; the lowest addressable unit is a <i>byte</i> in C. You can do as 2501 suggested which will work on most modern systems."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 4, "last_activity_date": 1475697037, "creation_date": 1475697037, "answer_id": 39882528, "question_id": 39882269, "link": "https://stackoverflow.com/questions/39882269/using-0b-representation-to-print-printf-float/39882528#39882528", "title": "Using 0b representation to print (printf) float", "body": "<p>From gcc's <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.8.0/gcc/Binary-constants.html#Binary-constants\" rel=\"nofollow\">documentation</a>:</p>\n\n<blockquote>\n  <p>The type of these constants follows the same rules as for octal or\n  hexadecimal integer constants, so suffixes like \u2018L\u2019 or \u2018UL\u2019 can be\n  applied.</p>\n</blockquote>\n\n<p>So, the binary numbers you assign to float and double are actually  of <em>integer types</em> and don't directly map to the bit pattern of the underlying types you assign to.</p>\n\n<p>In other words, this:</p>\n\n<pre><code> float floaty = 0b11000011101010110010001000000000;\n double doubley = 0b1100000001110101011001000100000000000000000000000000000000000000;\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code> float floaty = 3282772480;\n double doubley = 13868100853597995008;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 353, "user_id": 6145555, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nhUgN.jpg?s=128&g=1", "display_name": "Zac Taylor", "link": "https://stackoverflow.com/users/6145555/zac-taylor"}, "edited": false, "score": 0, "creation_date": 1475698295, "post_id": 39882830, "comment_id": 67052693, "body": "THANK YOU @2501, I wanted this to work and I am now a very happy man!"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 353, "user_id": 6145555, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nhUgN.jpg?s=128&g=1", "display_name": "Zac Taylor", "link": "https://stackoverflow.com/users/6145555/zac-taylor"}, "edited": false, "score": 0, "creation_date": 1475698487, "post_id": 39882830, "comment_id": 67052802, "body": "@ZacTaylor Just make sure you document and assert the assumptions."}, {"owner": {"reputation": 353, "user_id": 6145555, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nhUgN.jpg?s=128&g=1", "display_name": "Zac Taylor", "link": "https://stackoverflow.com/users/6145555/zac-taylor"}, "edited": false, "score": 0, "creation_date": 1475698705, "post_id": 39882830, "comment_id": 67052915, "body": "I&#39;m not sure what you mean?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 353, "user_id": 6145555, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nhUgN.jpg?s=128&g=1", "display_name": "Zac Taylor", "link": "https://stackoverflow.com/users/6145555/zac-taylor"}, "edited": false, "score": 1, "creation_date": 1475698809, "post_id": 39882830, "comment_id": 67052970, "body": "@ZacTaylor The code can cause undefined behavior on certain systems."}, {"owner": {"reputation": 353, "user_id": 6145555, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nhUgN.jpg?s=128&g=1", "display_name": "Zac Taylor", "link": "https://stackoverflow.com/users/6145555/zac-taylor"}, "edited": false, "score": 0, "creation_date": 1475698888, "post_id": 39882830, "comment_id": 67053006, "body": "OK I got you! Thanks again!"}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 2, "last_activity_date": 1475698143, "creation_date": 1475698143, "answer_id": 39882830, "question_id": 39882269, "link": "https://stackoverflow.com/questions/39882269/using-0b-representation-to-print-printf-float/39882830#39882830", "title": "Using 0b representation to print (printf) float", "body": "<p>You can use the binary constants with some more work. </p>\n\n<p>We will have to assume the floating point represented using IEEE 754, and the system is in little endian:</p>\n\n<pre><code>uint32_t value = 0b11000011101010110010001000000000;\nfloat f;\nmemcpy( &amp;f , &amp;value , sizeof( f ) );\nprintf( \"%f\\n\" , f );\n</code></pre>\n"}], "owner": {"reputation": 353, "user_id": 6145555, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nhUgN.jpg?s=128&g=1", "display_name": "Zac Taylor", "link": "https://stackoverflow.com/users/6145555/zac-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 39882830, "answer_count": 3, "score": 1, "last_activity_date": 1475698394, "creation_date": 1475696151, "question_id": 39882269, "link": "https://stackoverflow.com/questions/39882269/using-0b-representation-to-print-printf-float", "title": "Using 0b representation to print (printf) float", "body": "<p>I'm trying to express a fractional number in binary and then have it print out as a float. I've done the fixed point to floating point conversion.</p>\n\n<p>The number in decimal: -342.265625</p>\n\n<p>fixed point: -101010110.010001</p>\n\n<p>32-bit float: 11000011101010110010001000000000  </p>\n\n<p>64-bit float (double): 1100000001110101011001000100000000000000000000000000000000000000</p>\n\n<p>*I've double checked with an IEEE 754 Converter</p>\n\n<p>*I'm also aware that printf changes floats into doubles to print them, but declaring it as a double should work? I thought...?</p>\n\n<p>Code:</p>\n\n<pre><code>int main()\n{\n\n  float floaty = 0b11000011101010110010001000000000;\n  double doubley = 0b1100000001110101011001000100000000000000000000000000000000000000;\n  printf(\"Float: %f\\n\", floaty);\n  printf(\"Double: %lf\\n\", doubley);\n\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Float: 3282772480.000000\nDouble: 13868100853597995008.000000\n</code></pre>\n\n<p>The compiler is gcc and the standard is c99</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1475697932, "post_id": 39882220, "comment_id": 67052494, "body": "<code>isActive</code> returns a pointer to either the string constant &quot;yes&quot; or the string constant &quot;no&quot;, which are not mallocated objects because they&#39;re something else (string constants). It also mallocates an object and doesn&#39;t return a pointer to that object. (Also, &quot;mallocate&quot; is not a common term, but it works)"}], "answers": [{"comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1475696321, "post_id": 39882253, "comment_id": 67051606, "body": "Or don&#39;t use <code>malloc</code> or <code>free</code> at all, since you don&#39;t need to."}, {"owner": {"reputation": 120, "user_id": 4055410, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/606d903359093452f0d33fb41c224794?s=128&d=identicon&r=PG&f=1", "display_name": "Koen ", "link": "https://stackoverflow.com/users/4055410/koen"}, "edited": false, "score": 0, "creation_date": 1475696649, "post_id": 39882253, "comment_id": 67051819, "body": "Wow. I thought I knew everything I needed when it comes to pointers and memory in c. Apparently, that is not the case. Thanx."}], "tags": [], "owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "is_accepted": true, "score": 3, "last_activity_date": 1475696513, "last_edit_date": 1475696513, "creation_date": 1475696104, "answer_id": 39882253, "question_id": 39882220, "link": "https://stackoverflow.com/questions/39882220/c-freeing-an-mallocated-object-error/39882253#39882253", "title": "c: freeing an mallocated object error", "body": "<pre><code>ret = \"no\";\n</code></pre>\n\n<p>That overwrites the pointer. Change to:</p>\n\n<pre><code>strcpy(ret, \"no\");\n</code></pre>\n\n<p>Same applies for the <code>\"yes\"</code> case.</p>\n\n<p>Also, as pointed out by @DavidSchwartz, for your purposes it is probably not necessary to use dynamically allocated memory. Could just return the string literals directly:</p>\n\n<pre><code>char * isActive(unsigned char a_flag)\n{\n    if((a_flag &amp; 1) == 1)\n    {\n        //is active\n        return \"yes\";\n    }\n    return \"no\";  \n}\n</code></pre>\n\n<p>And of course in that case the caller should not <code>free</code> the returned value.</p>\n"}, {"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 2, "last_activity_date": 1475696472, "creation_date": 1475696472, "answer_id": 39882344, "question_id": 39882220, "link": "https://stackoverflow.com/questions/39882220/c-freeing-an-mallocated-object-error/39882344#39882344", "title": "c: freeing an mallocated object error", "body": "<p>You allocate some memory and assign the first address of that memory to the pointer <code>ret</code>, but <code>\"no\"</code> and <code>\"yes\"</code> are string literals that are stored statically in memory at compile-time. When you do <code>ret = \"no\"</code>, you change the pointer so that it now points to the first character of the string literal <code>\"no\"</code>. So, now you have lost access to the memory that you allocated, and you have a memory leak. But the crash is because you are trying to free memory that was not allocated by <code>malloc()</code> or one of its friends.</p>\n"}, {"tags": [], "owner": {"reputation": 3056, "user_id": 6843321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fy3J.png?s=128&g=1", "display_name": "Marian Dolinsk&#253;", "link": "https://stackoverflow.com/users/6843321/marian-dolinsk%c3%bd"}, "is_accepted": false, "score": 1, "last_activity_date": 1475696875, "last_edit_date": 1495541211, "creation_date": 1475696875, "answer_id": 39882467, "question_id": 39882220, "link": "https://stackoverflow.com/questions/39882220/c-freeing-an-mallocated-object-error/39882467#39882467", "title": "c: freeing an mallocated object error", "body": "<p>You can even use <code>strdup</code>:</p>\n\n<pre><code>char * isActive(unsigned char a_flag)\n{\n    return strdup((a_flag &amp; 1) == 1 ? \"yes\" : \"no\");\n}\n</code></pre>\n\n<p>As written <a href=\"https://stackoverflow.com/a/14021039/6843321\">here</a> the pointer is still allocated through <code>malloc</code> so it can also be freed.</p>\n"}], "owner": {"reputation": 120, "user_id": 4055410, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/606d903359093452f0d33fb41c224794?s=128&d=identicon&r=PG&f=1", "display_name": "Koen ", "link": "https://stackoverflow.com/users/4055410/koen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 39882253, "answer_count": 3, "score": 1, "last_activity_date": 1475698994, "creation_date": 1475695991, "last_edit_date": 1475698994, "question_id": 39882220, "link": "https://stackoverflow.com/questions/39882220/c-freeing-an-mallocated-object-error", "title": "c: freeing an mallocated object error", "body": "<p>Okay, so I have a method which I call. The called method returns a <code>char*</code>, which is allocated inside the called method. After having assigned the returned <code>char*</code> to a new <code>char*</code>, I want to free this, after using it. But Xcode complains and throws an error. It says that the object I try to free is not allocated, which I do not get, since I am sure I allocate it.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>void print_r()\n{\n\n    char *stateA = isActive(ruter_array[id]-&gt;flagg);\n\n    //print out the results etc\n\n    free(stateA);     &lt;-----The program crashes here.\n\n\n}\n\nchar * isActive(unsigned char a_flag)\n{\n    char *ret = malloc(5);\n\n    if((a_flag &amp; 1) == 1)\n    {\n        //is active\n        ret = \"yes\";\n        return ret;\n    }\n    ret = \"no\";\n    return ret;\n\n}\n</code></pre>\n\n<p>Its not important to understand what this does, but why is this freeing crashing?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475696057, "post_id": 39882146, "comment_id": 67051466, "body": "Please ask a sensible question in the title."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1475696169, "post_id": 39882146, "comment_id": 67051535, "body": "<code>strcpy()</code>&#39;s source and destination shouldn&#39;t overlap, and <code>strcpy()</code> copies a null-terminated string not a single <code>char</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475696421, "post_id": 39882146, "comment_id": 67051672, "body": "As far as I can see, you are attempting not to just remove an unspecified <code>i</code>th character, but <i>every</i> character."}], "answers": [{"tags": [], "owner": {"reputation": 28, "user_id": 3826685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91193b919af039811f804ecad957d7cc?s=128&d=identicon&r=PG&f=1", "display_name": "MrLys", "link": "https://stackoverflow.com/users/3826685/mrlys"}, "is_accepted": false, "score": 0, "last_activity_date": 1475701275, "creation_date": 1475701275, "answer_id": 39883592, "question_id": 39882146, "link": "https://stackoverflow.com/questions/39882146/iterating-through-an-array-and-deleting-the-ith-character-the-printing-the-array/39883592#39883592", "title": "Iterating through an array and deleting the ith character the printing the array", "body": "<p>You have done some mistakes. You're question is somewhat ambiguous. One of these do will do what you want. The first deletes the element and updates the array, the second only deletes the element.</p>\n\n<pre><code>void removeElemAndUpdate(char** word, int i ){\n   char* arr = *word;\n   printf(\"Length of word %d \\n\",strlen(arr));\n   if(i==0){\n      char* newarr =calloc(strlen(arr),1);\n      strcpy(newarr,&amp;arr[1]);\n      printf(\"%s\\n\",newarr); \n      free(arr);\n      *word=newarr;\n   }else if(i&gt;=strlen(arr)){\n      printf(\"%d is outside the array bounds\\n\",i);\n   }else{\n      char* start = calloc(strlen(arr),1);\n      char* end   = calloc(strlen(arr)-i + 1,1); \n      strncpy(start,arr,i);\n      strcpy(end, &amp;arr[i+1]);\n      strcat(start,end);\n      free(arr);\n      printf(\"%s\\n\",start);\n      free(end);\n      *word=start;\n   }\n\n}\n\nvoid removeElem(char* arr,int i){\n   if(i==0){\n      char* newarr =calloc(strlen(arr),1);\n      strcpy(newarr,&amp;arr[1]);\n      printf(\"%s\\n\",newarr); \n      free(newarr);\n   }else if(i&gt;=strlen(arr)){\n      printf(\"%d is outside the array bounds\\n\",i);\n   }else{\n      char* start = calloc(strlen(arr),1);\n      char* end   = calloc(strlen(arr)-i + 1,1); \n      strncpy(start,arr,i);\n      strcpy(end, &amp;arr[i+1]);\n      strcat(start,end);\n      printf(\"%s\\n\",start);\n      free(end);\n      free(start);\n   }\n}\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 1, "user_id": 6910062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c94093fea219347eb1598e8404d0f8?s=128&d=identicon&r=PG", "display_name": "user6910062", "link": "https://stackoverflow.com/users/6910062/user6910062"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1475770101, "creation_date": 1475695652, "last_edit_date": 1475695874, "question_id": 39882146, "link": "https://stackoverflow.com/questions/39882146/iterating-through-an-array-and-deleting-the-ith-character-the-printing-the-array", "title": "Iterating through an array and deleting the ith character the printing the array", "body": "<p>I am trying to loop through a word and delete the ith character of the word and then print out the word, but I end up getting Abort Trap 6. Here is my code....</p>\n\n<pre><code> int main(){\n\n    int i;\n    char arr[] = \"Tenesssee\";\n    char temp[21];\n\n    strcpy(temp, arr);\n\n    for (i = 0; i &lt;strlen(temp); i++){\n        strcpy(&amp;temp[i], &amp;temp[i + 1]);\n        printf(\"%s\", temp);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "semaphore"], "answers": [{"comments": [{"owner": {"reputation": 817, "user_id": 4526336, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh5.googleusercontent.com/-BO8B82i2_3s/AAAAAAAAAAI/AAAAAAAAADE/rFZk81Re8II/photo.jpg?sz=128", "display_name": "Brydon Gibson", "link": "https://stackoverflow.com/users/4526336/brydon-gibson"}, "edited": false, "score": 0, "creation_date": 1475695860, "post_id": 39882157, "comment_id": 67051356, "body": "Okay - so I think the issue is that I&#39;m confusing SysVIPC semaphores with another type of semaphore - whatever was used before SysVIPC. would that explain my problem?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 817, "user_id": 4526336, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh5.googleusercontent.com/-BO8B82i2_3s/AAAAAAAAAAI/AAAAAAAAADE/rFZk81Re8II/photo.jpg?sz=128", "display_name": "Brydon Gibson", "link": "https://stackoverflow.com/users/4526336/brydon-gibson"}, "edited": false, "score": 0, "creation_date": 1475696106, "post_id": 39882157, "comment_id": 67051499, "body": "SysVIPC semaphores (manipulated with  sem* functions) are older. POSIX semaphores (manipulated with sem_* functions) are newer, simpler, more performant, but also less powerful (no automatic undo operations, no atomic operations on groups of semaphores).  However, unnamed POSIX semaphores (see the sem_init manpage) ARE shareable across multiple processes too -- you just have to use shared memory and marke it as a shared semaphore). It&#39;s all in the manpages."}, {"owner": {"reputation": 817, "user_id": 4526336, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh5.googleusercontent.com/-BO8B82i2_3s/AAAAAAAAAAI/AAAAAAAAADE/rFZk81Re8II/photo.jpg?sz=128", "display_name": "Brydon Gibson", "link": "https://stackoverflow.com/users/4526336/brydon-gibson"}, "edited": false, "score": 0, "creation_date": 1475698931, "post_id": 39882157, "comment_id": 67053030, "body": "That paragraph brought a cloud of understandings together into actual useful information - thank you!"}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 2, "last_activity_date": 1475695715, "creation_date": 1475695715, "answer_id": 39882157, "question_id": 39882069, "link": "https://stackoverflow.com/questions/39882069/semaphores-make-less-sense-than-before-i-knew-how-they-worked/39882157#39882157", "title": "Semaphores make less sense than before I knew how they worked", "body": "<p>The keys are used across the whole SysVIPC subsystem, and they're numerical identifiers meant to be derived from pathnames by means of the <a href=\"https://linux.die.net/man/3/ftok\" rel=\"nofollow\">ftok(3)</a> function.</p>\n\n<p>You can find more details about SysV semaphores in the manpages or at <a href=\"http://beej.us/guide/bgipc/output/html/singlepage/bgipc.html\" rel=\"nofollow\">http://beej.us/guide/bgipc/output/html/singlepage/bgipc.html</a> or in the <a href=\"http://www.apuebook.com/\" rel=\"nofollow\">APUE book</a>.</p>\n"}], "owner": {"reputation": 817, "user_id": 4526336, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh5.googleusercontent.com/-BO8B82i2_3s/AAAAAAAAAAI/AAAAAAAAADE/rFZk81Re8II/photo.jpg?sz=128", "display_name": "Brydon Gibson", "link": "https://stackoverflow.com/users/4526336/brydon-gibson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 39882157, "answer_count": 1, "score": 2, "last_activity_date": 1475695715, "creation_date": 1475695316, "question_id": 39882069, "link": "https://stackoverflow.com/questions/39882069/semaphores-make-less-sense-than-before-i-knew-how-they-worked", "title": "Semaphores make less sense than before I knew how they worked", "body": "<p>Okay so I went about learning about semaphores on my own, because the class we had did not teach us much at all (it was a non-english speaking teacher's assistant, great use of my 11,500$).</p>\n\n<p>Anyways, I figured out how to use semaphores, and started my work on the sleeping-barber problem.</p>\n\n<p>The barber waits on his pillow for someone to <code>sem_post</code> it. The customer waits for the barber to post the \"seatbelt\" to say that the customer can leave.</p>\n\n<p>Anyways, I went back to the assignment after realising that the semaphores won't be shared between the processes, since they aren't threads. Supplied with the assignment is the description of the functions <code>semget</code>, <code>semop</code> and <code>semctl</code> which have <code>structs</code> as arguments and the explanation is very sparse if at all.</p>\n\n<p>These descriptions directly oppose my findings on the rest of the web which use <code>sem_open</code> to open a 'file' which is the semaphore.</p>\n\n<p>Anyways - I guess my question is: </p>\n\n<p>What are the 'keys' sent to the <code>sem*</code> functions? sometimes it's set to IPC_PRIVATE and sometimes it is used as a descriptor for the semaphore?</p>\n\n<p>I think these resources are making me more confused than they are helping</p>\n"}, {"tags": ["c", "stdin"], "comments": [{"owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "edited": false, "score": 1, "creation_date": 1475695239, "post_id": 39882010, "comment_id": 67051019, "body": "Look at argv and argc. You get arguments from the command line. Minimal solution: <code>int main(int argc, char *argv[]) { int cmdval = atoi(argv[1]); if (cmdval &lt; 0) return 1; printf(&quot;%d\\n&quot;,cmdval); return 0; }</code>"}, {"owner": {"reputation": 1781, "user_id": 6706176, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ee68c5e149f63ec9e31ad0c152a48656?s=128&d=identicon&r=PG&f=1", "display_name": "wad", "link": "https://stackoverflow.com/users/6706176/wad"}, "reply_to_user": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "edited": false, "score": 0, "creation_date": 1475695353, "post_id": 39882010, "comment_id": 67051092, "body": "Thanks. Please help and do not downvote or I &#39;ll be kicked out from the forum."}, {"owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "edited": false, "score": 2, "creation_date": 1475695473, "post_id": 39882010, "comment_id": 67051162, "body": "I didn&#39;t downvote, but I can guess why someone did. People don&#39;t like wasting their time. On the surface your question looks like a copy-pasted homework assignment. Only your description of your research into scanf identified that your problem was with terminology (input vs arguments). Next time try posting a short program that doesn&#39;t work, but is close, and you&#39;ll probably have more success. Good Luck."}, {"owner": {"reputation": 1781, "user_id": 6706176, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ee68c5e149f63ec9e31ad0c152a48656?s=128&d=identicon&r=PG&f=1", "display_name": "wad", "link": "https://stackoverflow.com/users/6706176/wad"}, "reply_to_user": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "edited": false, "score": 0, "creation_date": 1475695920, "post_id": 39882010, "comment_id": 67051390, "body": "Nice explanation. I see.  And your code actually works."}, {"owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "edited": false, "score": 1, "creation_date": 1475696165, "post_id": 39882010, "comment_id": 67051534, "body": "It works, but is terrible. Easy to break, no checks, no formatting, abuses return value, etc. But good enough for an example. :)"}], "answers": [{"tags": [], "owner": {"reputation": 638, "user_id": 4262207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iHUQgHLj_t0/AAAAAAAAAAI/AAAAAAAAACM/nE_ak8mRoJE/photo.jpg?sz=128", "display_name": "lolololol ol", "link": "https://stackoverflow.com/users/4262207/lolololol-ol"}, "is_accepted": true, "score": 1, "last_activity_date": 1475701259, "creation_date": 1475701259, "answer_id": 39883586, "question_id": 39882010, "link": "https://stackoverflow.com/questions/39882010/how-could-i-write-a-c-program-that-takes-an-integer-from-command-line/39883586#39883586", "title": "How could I write a C program that takes an integer from command line?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char * argv[])\n{\n     int n = atoi(argv[1]); // n from command line\n     n = n + 1; // return n + 1\n     printf(\"%d\", n);\n\n     return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1781, "user_id": 6706176, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ee68c5e149f63ec9e31ad0c152a48656?s=128&d=identicon&r=PG&f=1", "display_name": "wad", "link": "https://stackoverflow.com/users/6706176/wad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 39883586, "answer_count": 1, "score": 0, "last_activity_date": 1475701259, "creation_date": 1475695104, "last_edit_date": 1475695393, "question_id": 39882010, "link": "https://stackoverflow.com/questions/39882010/how-could-i-write-a-c-program-that-takes-an-integer-from-command-line", "title": "How could I write a C program that takes an integer from command line?", "body": "<p>I want to write a C program that takes positive integer n from standard input, and outputs n+1. It is supposed to work like this</p>\n\n<pre><code>./myprog 3   \n--&gt; returns 4\n\n./myprog -2\n--&gt; crashes\n</code></pre>\n\n<p>I tried using scanf. But it does not take standard input from the command line. Any code template to help me out? Thanks.</p>\n\n<p>Earlier, I also tried </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main( ) {\n\n   int c;\n\n   printf( \"Enter a value :\");\n   c = getchar( );\n\n   printf( \"\\nYou entered: \");\n   putchar( c );\n\n   return 0;\n}\n</code></pre>\n\n<p>It does not give a command-line solution neither. </p>\n"}, {"tags": ["c", "byte"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475695191, "post_id": 39881995, "comment_id": 67050994, "body": "What did you do to understand this? Did you read the chapter about number representation  in your C book? Did you look at Wikipedia at least? Your code invokes undefined behaviour, there could be daemons flying out of your nose or your optical drive serving pizza."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1475695447, "post_id": 39881995, "comment_id": 67051149, "body": "Recently <a href=\"http://stackoverflow.com/questions/39880560/cant-i-store-4294967295-in-unsigned-int-int-is-4-bytes-on-my-machine/39880761#39880761\">answered question</a>. Asked by the very same."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475695854, "post_id": 39881995, "comment_id": 67051353, "body": "As was said before, <code>2**31</code> <b><i>cannot be represented by a 32-bit signed integer.</i></b>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475697481, "post_id": 39881995, "comment_id": 67052277, "body": "@WeatherVane: CV as dup. Thanks for pointing out, I really should have noticed as I commented on both. Still, I like one answer here."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475698169, "post_id": 39881995, "comment_id": 67052621, "body": "@Olaf yes the question has evolved into a better discussion."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475754196, "post_id": 39881995, "comment_id": 67075785, "body": "@WeatherVane I wanted to ask how can i print <b>unsigned int</b> and store 2**31 in unsigned int ?"}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475754255, "post_id": 39881995, "comment_id": 67075820, "body": "@Olaf You dont like me using stackoverflow or what ?? Becuase you argue on all of my questions with me... Please be polite."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475755144, "post_id": 39881995, "comment_id": 67076352, "body": "@MuhamedCicak: Of course, it is the others&#39; fault, not your&#39;s. One aspect of a good programmer is that he first verifies it is not his fault. Oh, and paranoia is never a good advisor."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475755443, "post_id": 39881995, "comment_id": 67076534, "body": "@Olaf Firstly i am not a good programmer.That&#39;s why i am here.To get help and learn.Not to argue with someone..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475756327, "post_id": 39881995, "comment_id": 67077123, "body": "@MuhamedCicak: You missed the point of my comment. You will never become a good programmer if you don&#39;t try. Which means first think about advice applying common sense and doing reserach on your own. <b>And</b> listen to arguments. Non knowing is ok, but <i>willful ignorance</i> Is a very bad attitude. So, and as you don&#39;t want to argue, the solution is simple: don&#39;t argue! You are not obliged to reply to a comment. Anyway, I don&#39;t really care if you believe it or not, but I tried to help you advance. But I don&#39;t force you into, you just have to live with the results (i.e. close-votes - not just mine)"}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475765681, "post_id": 39881995, "comment_id": 67084093, "body": "@Olaf That&#39;s true, i agree.If i don&#39;t try i cant make it. But what makes you think i didn&#39;t ? And i didn&#39;t understand your answer,i saw you tried to answer. But i did not understand your answer. And yeah :) Still i could not understand the answer.I wish someone can explain in details. Nevermind. We shouldn&#39;t argue, as you said :)"}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "edited": false, "score": 0, "creation_date": 1475769809, "post_id": 39881995, "comment_id": 67086975, "body": "And how can i close the question ? I am not sure.And sorry for all the argue.And thanks on your advices."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475773275, "post_id": 39881995, "comment_id": 67088941, "body": "@Muhamed Cicak to put the value <code>2**31</code> into <code>unsigned int</code> you can do it like this: <code>unsigned i = 2147483648u;</code> and print it like this <code>printf(&quot;%u\\n&quot;, i);</code>"}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475774001, "post_id": 39881995, "comment_id": 67089304, "body": "@WeatherVane Thank you.I recently changed the question.I googled and find out just what you said.I dont know if it is allowed to change question entirely.But i changed it because it was duplicate.Do you know the answer of current version of question ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475774071, "post_id": 39881995, "comment_id": 67089334, "body": "Just like my last comment, but with <code>4294967295u</code> or print directly with <code>printf(&quot;%u\\n&quot;, 4294967295u);</code>"}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "edited": false, "score": 0, "creation_date": 1475774252, "post_id": 39881995, "comment_id": 67089443, "body": "Yap ! :) If you want write it as answer.I will make it <b>the</b> answer."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475774712, "post_id": 39881995, "comment_id": 67089698, "body": "I cannot, the question has been closed."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "edited": false, "score": 0, "creation_date": 1475774862, "post_id": 39881995, "comment_id": 67089766, "body": "Cant i open it ? :) I am new to stackoverflow,so i dont really know that.Am i able to renew it in some way ??"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475775996, "post_id": 39881995, "comment_id": 67090399, "body": "I do have the rep to re-open the question but that would be bad form if my purpose is to gain more rep myself. Just be happy with the comments."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "edited": false, "score": 0, "creation_date": 1475776099, "post_id": 39881995, "comment_id": 67090454, "body": "Ok.I appreciate your help :)"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1475695203, "post_id": 39882027, "comment_id": 67051002, "body": "No, it does not! Please provide a link to the standard where it defines that signed integer overflow wraps."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475695333, "post_id": 39882027, "comment_id": 67051082, "body": "The link is my 30 years of programming in C, my BS in Engineering, and my MS in Computer Science."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475695770, "post_id": 39882027, "comment_id": 67051305, "body": "Argumentum ad verecundiam. Sorry, but that is no reference and I will not conter with the same. The code simply invokes undefined behaviour. Signed integer overflow is one of the <b>explicitly</b> mentioned examples in the standard. Oh, I even have a reference: see 3.4.3p3 in the standard."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475695843, "post_id": 39882027, "comment_id": 67051349, "body": "Say all the Latin you want. Man does not live by standards alone. Have a nice day."}, {"owner": {"reputation": 22905, "user_id": 2153758, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/oEgTs.png?s=128&g=1", "display_name": "bwoebi", "link": "https://stackoverflow.com/users/2153758/bwoebi"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475696056, "post_id": 39882027, "comment_id": 67051463, "body": "@Olaf Standards are nice and fine \u2026 are there any commonly used compilers on commonly used platforms which do not assume this overflowing behavior?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 22905, "user_id": 2153758, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/oEgTs.png?s=128&g=1", "display_name": "bwoebi", "link": "https://stackoverflow.com/users/2153758/bwoebi"}, "edited": false, "score": 2, "creation_date": 1475696426, "post_id": 39882027, "comment_id": 67051675, "body": "The section on <a href=\"http://www.informit.com/articles/article.aspx?p=2086870\" rel=\"nofollow noreferrer\">Vulnerabilities Resulting from Undefined Behaviors</a> goes into why compilers have evolved to take advantage of <code>int</code> overflow.  So @bwoebi , compliers today take advantage of such code to the chagrin of season coders."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 22905, "user_id": 2153758, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/oEgTs.png?s=128&g=1", "display_name": "bwoebi", "link": "https://stackoverflow.com/users/2153758/bwoebi"}, "edited": false, "score": 1, "creation_date": 1475696549, "post_id": 39882027, "comment_id": 67051754, "body": "@bwoebi: You&#39;d be surprised how agressive modern compilers optimise such code."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 22905, "user_id": 2153758, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/oEgTs.png?s=128&g=1", "display_name": "bwoebi", "link": "https://stackoverflow.com/users/2153758/bwoebi"}, "edited": false, "score": 0, "creation_date": 1475698053, "post_id": 39882027, "comment_id": 67052555, "body": "@bwoebi a good compiler will emit code that does <i>something</i> reasonable when given non-standard behaviour at runtime, not just throw tomatoes.."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475710966, "post_id": 39882027, "comment_id": 67057339, "body": "@WeatherVane: You mean I buying that daemon-defense tower was nonsense? How do I get this out of my nose?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 22905, "user_id": 2153758, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/oEgTs.png?s=128&g=1", "display_name": "bwoebi", "link": "https://stackoverflow.com/users/2153758/bwoebi"}, "edited": false, "score": 0, "creation_date": 1475711342, "post_id": 39882027, "comment_id": 67057434, "body": "@bwoebi: Re. compilers: Have a look at custom CPUs an DSPs. One (intended) behaviour is saturation. Also there are non 2s complement platforms."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1475761450, "post_id": 39882027, "comment_id": 67080950, "body": "This is really fun but let us agree that the OP did not ask about standards or vulnerabilities or optimization. He simply asked why he got a specific set of output for a specific set of input. Thanks for the downvotes anyway."}], "tags": [], "owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "is_accepted": false, "score": -2, "last_activity_date": 1475695148, "creation_date": 1475695148, "answer_id": 39882027, "question_id": 39881995, "link": "https://stackoverflow.com/questions/39881995/u-expects-argument-of-unsigned-int-but-argument-has-type-long-int-4294967295/39882027#39882027", "title": "%u expects argument of unsigned int but argument has type long int (4294967295)", "body": "<p>2^31 overflows a 4-byte signed integer. It 'wraps around' to -(2^31). </p>\n"}, {"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1475696660, "post_id": 39882251, "comment_id": 67051828, "body": "I&#39;m surprised that you suggest PRI to print a unsigned long long, which should use ull. Or use a cast to uint64_t."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475696942, "post_id": 39882251, "comment_id": 67052004, "body": "+1 Just that: It is actually not the compiler dion that behaviour, but the hardware/CPU, the compiler just does not emit extra code, as that would be nonsense. FYI: such undefined behaviour can (and will where it comes in handy) be exploited by modern compilers. Especially gcc is well known to be very agressive and therefore e.g. has some bad reputation with programmers who are used to more forgiving compilers who don&#39;t strictly follow the standard. The embedded field is such an example. The obvious problem is that they generate less optimised code."}, {"owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475697059, "post_id": 39882251, "comment_id": 67052067, "body": "That was a demonstration of how to print an int64_t, even though the ull is not such a value and PRIu64 is better, the code is not meant run, it is meant as a demonstration. @Olaf exactly why I pointed it out, I&#39;ve run into weird non-standard behaviour before (my favourite was a school project from a friend that crashed every other input, but would actually dump relevant lines of the standard to stdout whenever undefined behaviour was compiled)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475697084, "post_id": 39882251, "comment_id": 67052085, "body": "@2501: Actually it is <code>llu</code>. But yes, <code>PRId64</code> is for the <b>signed</b> <code>int64_t</code>. To get such a constant, the macro <code>INT64_C(4294967295)</code> shall be used (no size-tag on the value!)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475697120, "post_id": 39882251, "comment_id": 67052109, "body": "@LambdaBeta: see my comment above. And good attitude to strictly follow the standard. (Although there are areas like OS or bare-metal embedded where one has to &quot;bend&quot; the rules  sometimes. But that requires good knowledge about the implementation details)."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475697389, "post_id": 39882251, "comment_id": 67052235, "body": "@Olaf Yes I switched them around, the printf format specifier must be in order: llu. C is slightly inconsistent since integer constants may be defined as 123ull or 123llu. You probably meant UINT64_C(). A cast should also be fine. It depends on personal preference."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475697737, "post_id": 39882251, "comment_id": 67052392, "body": "@2501: No, I meant <code>INT64_C</code> A cast can be problematic (not likely here, but in general). Also the macro is a clear statement you want a 64 bit (or larger) constant, while <code>long long</code> can be 128 bits. This becomes more problematic for e.g. <code>long</code>/<code>int</code> vs. <code>int32_t</code>. On 2nd thought the cast might actually be worth a try (just omit the suffix), because a variadic function cannot  check type compatibility. Yes, that&#39;s a minefield."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475698309, "post_id": 39882251, "comment_id": 67052698, "body": "@Olaf Yeah I agree to use the macro. I would probably prefer a const variable as the macro looks ugly."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475698626, "post_id": 39882251, "comment_id": 67052869, "body": "@Olaf Detail: <code>INT64_C(4294967295)</code> returns a type of <code>int_least64_t</code> which may differ from the optional <code>int_64_t</code>, the matching type for <code>PRId64</code>.  Best if OP simply used <code>printf(&quot;%llu\\n&quot;, 4294967295ULL)</code> or <code>printf(&quot;%&quot; PRId64 &quot;\\n&quot;, (int64_t) 4294967295)</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475711820, "post_id": 39882251, "comment_id": 67057561, "body": "@chux: from my 2nd post about that subject: &quot;... Also the macro is a clear statement you want a 64 bit (or larger) constant ...&quot; and the rest. As far as I understand the standard, it will eventually yield a type of the exact size if such a type exists. As we already presume <code>int64_t</code> exists, it should yield that type, resp. the corresponding standard type. It just will yield a wider type if there is no 64 bit type, but a wider one."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "edited": false, "score": 0, "creation_date": 1475754014, "post_id": 39882251, "comment_id": 67075652, "body": "No one seems to answer asked question here... I am asking first of all Can i store 4294967295 in 32 bits (<b>UNSIGNED INT</b>) ??  Second of all how to print unsigned int ??"}], "tags": [], "owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "is_accepted": false, "score": 2, "last_activity_date": 1475696100, "creation_date": 1475696100, "answer_id": 39882251, "question_id": 39881995, "link": "https://stackoverflow.com/questions/39881995/u-expects-argument-of-unsigned-int-but-argument-has-type-long-int-4294967295/39882251#39882251", "title": "%u expects argument of unsigned int but argument has type long int (4294967295)", "body": "<p>Since the correct answer is <em>still</em> missing here, I'll chime in.</p>\n\n<p>Your code when running with 32-bit integers, will produce undefined behaviour. That means that literally anything could happen. The C standard (the \"rules\" for what the C language <strong>is</strong>) specifically says that putting a number that is too big into a signed integer value results in undefined behaviour. As such your compile could do anything.</p>\n\n<p>Most compilers on most architectures will store signed integers using 2's compliment. In that case the sensible thing to do is to 'overflow' back down to the negative value (look up 2's compliment addition and test it on the largest positive value). </p>\n\n<p>However, this <strong>does not</strong> have to be the case. Another valid output would be:</p>\n\n<p>2</p>\n\n<p>4</p>\n\n<p>...</p>\n\n<p>1073741824</p>\n\n<p>No thanks, number too big. Executing <code>rm -rf /</code>. Have a good day.</p>\n\n<p>While that would be a lot of work for a compiler to implement, it would <strong>still</strong> be a valid C compiler. </p>\n\n<p>To print bigger values, use bigger types. In C99 and later you can use <code>stdint.h</code> to get access to <code>int64_t</code> which is 64-bits wide and can happily store 4 billion. Printing such a number is done with <code>printf(\"%\" PRId64, X)</code> instead of <code>printf(\"%d\", X)</code>. To declare such a literal you would need to use the L or LL endings. As such <code>printf(\"%\" PRId64 \"\\n\", 4294967295ULL)</code> <strong>should</strong> print the value you'd expect.</p>\n"}], "owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "closed_date": 1475698111, "answer_count": 2, "score": -4, "last_activity_date": 1475772958, "creation_date": 1475695034, "last_edit_date": 1475772958, "question_id": 39881995, "link": "https://stackoverflow.com/questions/39881995/u-expects-argument-of-unsigned-int-but-argument-has-type-long-int-4294967295", "closed_reason": "Duplicate", "title": "%u expects argument of unsigned int but argument has type long int (4294967295)", "body": "<p>I am updating the question.Same case just another code.This could help you understand what i want.I am bad for explaining (mostly in English) so here is the code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nunsigned int power(unsigned int base, unsigned int on);\n\nint main(void) {\n    printf(\"\\n%d\\n\",sizeof(int));\n    printf(\"\\n%u\\n\",4294967295);\n    return 0;\n}\n</code></pre>\n\n<h1>Compiler Warning:</h1>\n\n<blockquote>\n  <p>csilssRanges.c: In function \u2018main\u2019:\n  csilssRanges.c:16:5: warning: format \u2018%u\u2019 expects argument of type \u2018unsigned int\u2019, but argument 2 has type \u2018long int\u2019 [-Wformat=]\n       printf(\"%u\",4294967295);</p>\n</blockquote>\n\n<h1>Output:</h1>\n\n<blockquote>\n  <p>4</p>\n  \n  <p>4294967295</p>\n</blockquote>\n\n<p>I am trying to understand why am i getting the compiler warning.I hope i am explaining well what i want.And i think the question is more reasonable now.And not duplicate to my recent question.</p>\n"}, {"tags": ["c", "apache", "cgi"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1475695146, "post_id": 39881692, "comment_id": 67050967, "body": "You can&#39;t <code>fopen()</code> a URL in C (maybe you&#39;re used to PHP?).  You need to give it a normal file system path."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1475695190, "post_id": 39881692, "comment_id": 67050993, "body": "&quot;<code>fopen</code> accepts paths that are valid on the file system at the point of execution&quot;. <a href=\"https://msdn.microsoft.com/en-us/library/yeby3zcb.aspx\" rel=\"nofollow noreferrer\">Please see <code>fopen</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 6366754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a13171d081a034dd358db401d519143?s=128&d=identicon&r=PG&f=1", "display_name": "Zipf", "link": "https://stackoverflow.com/users/6366754/zipf"}, "is_accepted": true, "score": 1, "last_activity_date": 1475695753, "creation_date": 1475695753, "answer_id": 39882165, "question_id": 39881692, "link": "https://stackoverflow.com/questions/39881692/end-of-script-output-before-headers-when-trying-to-open-file-on-apache-cloud9id/39882165#39882165", "title": "End of script output before headers when trying to open file on Apache [Cloud9IDE]", "body": "<p>As it turns out, fopen cannot accept URLs. I tried editing the code to:</p>\n\n<pre><code>pfile = fopen(\"../../../home/ubuntu/workspace/files/html/output.html\", \"w\");\n</code></pre>\n\n<p>and it worked.</p>\n"}], "owner": {"reputation": 45, "user_id": 6366754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a13171d081a034dd358db401d519143?s=128&d=identicon&r=PG&f=1", "display_name": "Zipf", "link": "https://stackoverflow.com/users/6366754/zipf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 39882165, "answer_count": 1, "score": 1, "last_activity_date": 1475695753, "creation_date": 1475693836, "last_edit_date": 1475694179, "question_id": 39881692, "link": "https://stackoverflow.com/questions/39881692/end-of-script-output-before-headers-when-trying-to-open-file-on-apache-cloud9id", "title": "End of script output before headers when trying to open file on Apache [Cloud9IDE]", "body": "<p>I am trying to edit a file using CGI C outside of cgi-bin (~/workspace/files/html) and I tried opening the using this code (edited workspacename and user):</p>\n\n<pre><code>pfile = fopen(\"https://workspacename-user.c9users.io/files/html/output.html\", \"w\");\n</code></pre>\n\n<p>I get an internal server error and when I checked the error logs it showed:</p>\n\n<pre><code>[Wed Oct 05 18:40:12.350766 2016] [cgi:error] [pid 28008] [client 10.240.0.213:54468] End of script output before headers: test.cgi, referer: https://workspacename-user.c9users.io/files/html/main.html\n</code></pre>\n\n<p>I tried changing the location of the file that I am trying to open to the cgi-bin directly:</p>\n\n<pre><code>pfile = fopen(\"output.html\", \"w\");\n</code></pre>\n\n<p>and it seemed to work. Is there a way to solve this?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "edited": false, "score": 0, "creation_date": 1475693155, "post_id": 39881490, "comment_id": 67049836, "body": "The same way it initializes anything."}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1475693171, "post_id": 39881490, "comment_id": 67049845, "body": "What&#39;s the problem here? Can&#39;t you modify there memory allocated on the stack? (yes, you can)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475694753, "post_id": 39881490, "comment_id": 67050725, "body": "&quot;By default, the local arrays are stored in stack&quot; - Not all variables with local (i.e. block) scope are stored on the stack. And not all implementations actually use a stack at all. The standard does not require a stack."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1475694938, "post_id": 39881490, "comment_id": 67050835, "body": "I can see no reason why a reasonable person would down vote here.   It is an honest question about a common mis-understanding in C."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475695152, "post_id": 39881490, "comment_id": 67050971, "body": "@Olaf: The OP did say &quot;by default&quot;. In the absence of a <code>static</code> keyword, local array are stored on the &quot;stack&quot;. Your point that not all implementations use a stack is valid. Objects with automatic storage duration must be created and destroyed in a stack-like last-in first-out manner, but they needn&#39;t be stored in &quot;stack&quot; allocated in contiguous memory (though that&#39;s by far the most common implementation)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1475695550, "post_id": 39881490, "comment_id": 67051201, "body": "@KeithThompson: &quot;local variable&quot; means block scope. It does not imply trhe storage duration. And no, there are indeed implementations which don&#39;t use some LIFO mechanism, but use global storage (they resolve the call-chain at compile/link-time). This of course only works for a deterministic and non-recursive code structure. Without a specific architecture the question cannot be answered."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475695652, "post_id": 39881490, "comment_id": 67051249, "body": "@Olaf: Block scope with no <code>static</code> keyword does imply automatic storage duration. Implementations that don&#39;t support recursion are not conforming."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1475696047, "post_id": 39881490, "comment_id": 67051459, "body": "@KeithThompson: I did not say they disallow recursion. They just can store automatic variables where they want, even use more than a single allocation scheme. If they cannot resolve the call-chain, they still can fall back to a stack. But as the majority of code in that are is non-recursive, they effectively don&#39;t use a stack for typical code. There is more to optimisation than shuffle instructions and register allocation. My point is simply it is nonsense to assume all implementations behave the same. OP should know this is specific to the implementation, not a C requirement."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475699028, "post_id": 39881490, "comment_id": 67053086, "body": "@Olaf: Do you expect &quot;The standard does not require a stack&quot; to make that point to the OP in a useful manner?"}], "answers": [{"comments": [{"owner": {"reputation": 2053, "user_id": 2365416, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5141e2a5920eac9a9d646584490b9b52?s=128&d=identicon&r=PG", "display_name": "Amrit", "link": "https://stackoverflow.com/users/2365416/amrit"}, "edited": false, "score": 0, "creation_date": 1475693853, "post_id": 39881532, "comment_id": 67050231, "body": "So, the array is still being stored in stack but compiler is taking an extra step to initialize it to zero(as specified in standards)."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 2053, "user_id": 2365416, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5141e2a5920eac9a9d646584490b9b52?s=128&d=identicon&r=PG", "display_name": "Amrit", "link": "https://stackoverflow.com/users/2365416/amrit"}, "edited": false, "score": 0, "creation_date": 1475693936, "post_id": 39881532, "comment_id": 67050289, "body": "@Raj Correct.  Initialization does not affect how the memory is laid out, just whether or not the contents are known."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1475694548, "post_id": 39881532, "comment_id": 67050641, "body": "The standard requires the remainder of the object to be initialized to zero; it says nothing about how that&#39;s implemented. The compiler will generate whatever code is necessary to meet the requirements given in the standard.  There&#39;s almost certainly no reason for you to care how it&#39;s done, but you can always examine the generated code. (@dbush: I presume you know this; this comment is mainly addressed to the OP.)"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1475693515, "last_edit_date": 1592644375, "creation_date": 1475693183, "answer_id": 39881532, "question_id": 39881490, "link": "https://stackoverflow.com/questions/39881490/where-is-the-array-stored-when-i-used-initialisation-as-int-array10-0/39881532#39881532", "title": "Where is the array stored when I used initialisation as int array[10] = {0};", "body": "<p>Whether or not a local array is initialized has no bearing on whether or not it is stored on stack.</p>\n<p>If the implementation uses a stack, then the array will be on the stack, initialized or not.</p>\n<p>From section 6.7.9 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>:</p>\n<blockquote>\n<p><strong>10</strong> If  an  object  that  has  automatic  storage  duration  is  not  initialized  explicitly,  its  value  is indeterminate.   If  an\nobject  that  has  static  or  thread  storage  duration  is  not\ninitialized explicitly, then:</p>\n<p>\u2014  if it has pointer type, it is\ninitialized to a null pointer;</p>\n<p>\u2014  if it has arithmetic type, it is\ninitialized to (positive or unsigned) zero;</p>\n<p>\u2014  if it is an aggregate,\nevery member is initialized (recursively) according to these rules,\nand any padding is initialized to zero bits;</p>\n<p>\u2014  if it is a union, the\nfirst named member is initialized (recursively) according to these\nrules, and any padding is initialized to zero bits;</p>\n<p>...</p>\n<p><strong>21</strong> If there are fewer initializers in a brace-enclosed list than there\nare elements or members of an aggregate, or fewer characters in a\nstring literal used to initialize an array of known size  than  there\nare  elements  in  the  array,  <strong>the  remainder  of  the  aggregate\nshall  be initialized implicitly the same as objects that have static\nstorage duration</strong>.</p>\n</blockquote>\n<p>So if an initializer list has fewer elements than the array, the remaining elements are initialized the same as non local variables, i.e. set to 0.</p>\n"}], "owner": {"reputation": 2053, "user_id": 2365416, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5141e2a5920eac9a9d646584490b9b52?s=128&d=identicon&r=PG", "display_name": "Amrit", "link": "https://stackoverflow.com/users/2365416/amrit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 39881532, "answer_count": 1, "score": -1, "last_activity_date": 1475693515, "creation_date": 1475693012, "question_id": 39881490, "link": "https://stackoverflow.com/questions/39881490/where-is-the-array-stored-when-i-used-initialisation-as-int-array10-0", "title": "Where is the array stored when I used initialisation as int array[10] = {0};", "body": "<p>By default, the local arrays are stored in <strong>stack</strong>. Uninitialised local arrays would be allocated garbage values.\nBut why does this syntax <code>int array[10] = {0};</code> initialises all array elements to zero by default? Even if I give <code>int array[10] = {10, 20}; //It initialises all rest of the elements to zero.</code></p>\n\n<p>Isn't it being stored on stack in this case? How does it initialise them all to zero?</p>\n"}, {"tags": ["c", "function", "bubble-sort", "cs50"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6748820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf74c675db9dc36d975cd5cde8f02a69?s=128&d=identicon&r=PG&f=1", "display_name": "olafironfoot", "link": "https://stackoverflow.com/users/6748820/olafironfoot"}, "edited": false, "score": 0, "creation_date": 1475779251, "post_id": 39881744, "comment_id": 67092203, "body": "hmm.. Can you help me understand why we need two for loops instead of one, under the sort function please?"}, {"owner": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "reply_to_user": {"reputation": 35, "user_id": 6748820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf74c675db9dc36d975cd5cde8f02a69?s=128&d=identicon&r=PG&f=1", "display_name": "olafironfoot", "link": "https://stackoverflow.com/users/6748820/olafironfoot"}, "edited": false, "score": 1, "creation_date": 1475781262, "post_id": 39881744, "comment_id": 67093285, "body": "This is all about bubblesort implementation, bubblesort needs two loops and (that&#39;s why it has complexity O(n^2) ) , the basic idea behind the 2 loops it that we need to compare the with all the other elements, so element1 will be compared with all n-1 elements, element 2 will all n-2 elements (already compared with element 1 from previous step) element n will be compared with 0 elements (it is what has left) so total compare steps: n-1 + n-2 + ...+1+0 =O(n^2) (2 loops)."}, {"owner": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "reply_to_user": {"reputation": 35, "user_id": 6748820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf74c675db9dc36d975cd5cde8f02a69?s=128&d=identicon&r=PG&f=1", "display_name": "olafironfoot", "link": "https://stackoverflow.com/users/6748820/olafironfoot"}, "edited": false, "score": 0, "creation_date": 1475879090, "post_id": 39881744, "comment_id": 67136758, "body": "You could check the bubble sort algorithm here: <a href=\"http://quiz.geeksforgeeks.org/bubble-sort/\" rel=\"nofollow noreferrer\">quiz.geeksforgeeks.org/bubble-sort</a>"}], "tags": [], "owner": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "is_accepted": true, "score": 1, "last_activity_date": 1475694660, "last_edit_date": 1475694660, "creation_date": 1475694055, "answer_id": 39881744, "question_id": 39881488, "link": "https://stackoverflow.com/questions/39881488/trying-to-implement-a-simple-bubble-sort-function-on-a-list-of-self-declared-arr/39881744#39881744", "title": "Trying to implement a simple bubble sort function on a list of self declared arrays", "body": "<p>You pass a pointer to element <code>&amp;arrayRack[i]</code> but in the parameters of sort you have declared the first parameter to be an array so this doesn't match. You could simply write:</p>\n\n<p>In main:</p>\n\n<pre><code>sort(arrayRack, NumberOfArrayElements);\nfor(int i = 0; i &lt; NumberOfArrayElements; i++)\n    {\n        printf(\"{%i}&lt;-- number in %i-th array (sorted)\\n\", arrayRack[i], i + 1);\n\n    }\n</code></pre>\n\n<p>And in sort function:</p>\n\n<pre><code>void sort(int arrayRack[], int NumberOfArrayElements)\n{\n//declare variable\nint swap = 0;\n        for(int k = 0; k &lt; NumberOfArrayElements-1; k++)\n        {\n\n           for(int j=0; j&lt;NumberOfArrayElements-1-k;j++)\n\n            if(arrayRack[j] &gt; arrayRack[j + 1])\n            {\n                swap = arrayRack[j];\n                arrayRack[j] = arrayRack[j + 1];\n                arrayRack[j + 1] = swap;\n            }\n        }\n\n}\n</code></pre>\n\n<p>Also I would suggest <code>scanf(\"%d\",&amp;NumberOfArrayElements);</code> instead of <code>NumberOfArrayElements = GetInt();</code> and <code>scanf(\"%d\",&amp;arrayRack[i]);</code> instead of <code>arrayRack[i] = GetInt();</code></p>\n\n<p>Example:</p>\n\n<pre><code> number of arrays you'd like?\n    5\n    give me an int for the 1 th array\n    5 \n    give me an int for the 2 th array\n    7\n    give me an int for the 3 th array\n    1\n    give me an int for the 4 th array\n    8\n    give me an int for the 5 th array\n    3\n    {5}&lt;-- number in 1-th array (unsorted)\n    {7}&lt;-- number in 2-th array (unsorted)\n    {1}&lt;-- number in 3-th array (unsorted)\n    {8}&lt;-- number in 4-th array (unsorted)\n    {3}&lt;-- number in 5-th array (unsorted)\n    {1}&lt;-- number in 1-th array (sorted)\n    {3}&lt;-- number in 2-th array (sorted)\n    {5}&lt;-- number in 3-th array (sorted)\n    {7}&lt;-- number in 4-th array (sorted)\n    {8}&lt;-- number in 5-th array (sorted)\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6748820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf74c675db9dc36d975cd5cde8f02a69?s=128&d=identicon&r=PG&f=1", "display_name": "olafironfoot", "link": "https://stackoverflow.com/users/6748820/olafironfoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 39881744, "answer_count": 1, "score": 0, "last_activity_date": 1475694660, "creation_date": 1475693006, "question_id": 39881488, "link": "https://stackoverflow.com/questions/39881488/trying-to-implement-a-simple-bubble-sort-function-on-a-list-of-self-declared-arr", "title": "Trying to implement a simple bubble sort function on a list of self declared arrays", "body": "<p>Newbie trying to make an arrays then sort them using a function called \"sort\" that i created at the bottom of the code, using bubble sort..</p>\n\n<p>I'm pretty sure the printing part is ok, just the functions that I'm having trouble with, can someone help a newbie out please?..</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n\nvoid sort(int arrayRack[], int NumberOfArrayElements);\n\nint main(void)\n\n{\n//variable declarations\nint NumberOfArrayElements = 0;\n\n\n//Get number of arrays\nprintf(\"number of arrays you'd like?\\n\");\nNumberOfArrayElements = GetInt();\n\n//variable array declaration\nint arrayRack[NumberOfArrayElements];\n\n\n//Get number for each int\nfor(int i = 0; i &lt; NumberOfArrayElements; i++)\n    {\n        printf(\"give me an int for the %i th array\\n\", i + 1);\n        arrayRack[i] = GetInt();\n    }\n\n//print what is currently in the arrayRack\nfor(int j = 0; j &lt; NumberOfArrayElements; j++)\n    printf(\"{%i}&lt;-- number in %i-th array (unsorted)\\n\", arrayRack[j], j + 1);\n\n\n\nfor(int i = 0; i &lt; NumberOfArrayElements; i++)\n    {\n        sort(&amp;arrayRack[i], NumberOfArrayElements);\n        printf(\"{%i}&lt;-- number in %i-th array (sorted)\\n\", arrayRack[i], i + 1);\n\n    }\n    return 0;\n}\n\n\n//this is the funciton, like sort(haystack, size);\nvoid sort(int arrayRack[], int NumberOfArrayElements)\n{\n//declare variable\nint swap = 0;\n        for(int k = 0; k &lt; NumberOfArrayElements; k++)\n        {\n            //if [1] is higher, swap with [2]\n            if(arrayRack[k] &gt; arrayRack[k + 1])\n            {\n                swap = arrayRack[k];\n                arrayRack[k] = arrayRack[k + 1];\n                arrayRack[k + 1] = swap;\n            }\n        }\n\n}\n</code></pre>\n"}, {"tags": ["c", "testing", "tree", "dijkstra"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475692336, "post_id": 39881212, "comment_id": 67049349, "body": "Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. You have provided a link to more than 500 lines of code. Perhaps the question belongs on Codereview, for an analysis of code, written by somebody else."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475693950, "post_id": 39881212, "comment_id": 67050303, "body": "We are no consulting site."}], "owner": {"reputation": 1, "user_id": 6911400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574c4bd2a58f1616a87813b513e8c8f9?s=128&d=identicon&r=PG&f=1", "display_name": "emi777", "link": "https://stackoverflow.com/users/6911400/emi777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475691937, "creation_date": 1475691937, "question_id": 39881212, "link": "https://stackoverflow.com/questions/39881212/dijkstra-openmp-code-in-c", "title": "Dijkstra openmp code in c", "body": "<p>Hi i work on openmp and want to test a code of dijkstra algorithm.The code is here<a href=\"http://people.sc.fsu.edu/~jburkardt/c_src/dijkstra_openmp/dijkstra_openmp.c\" rel=\"nofollow\">dijkstra_openmp</a>\n.This code is written by John Burkardt and i try to run it.But run time for 1 thread is same by four thread.I have a intel core i3 system that can support 4 threads.I need a test case for it to estimate speed up of code. Available test case is too small.</p>\n"}, {"tags": ["c", "int"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1475689816, "post_id": 39880560, "comment_id": 67047947, "body": "Learn about <code>limits.h</code>. Don&#39;t rely on assumptions (btw. you are wrong)."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1475689900, "post_id": 39880560, "comment_id": 67047999, "body": "You forgot the other part of the iceberg: negative numbers"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1475689965, "post_id": 39880560, "comment_id": 67048034, "body": "@Jean-Fran&#231;oisFabre: An iceberg has 90% under water. signed integers have a(n almost) symmetrical range."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "edited": false, "score": 0, "creation_date": 1475690002, "post_id": 39880560, "comment_id": 67048052, "body": "Sorry i mixed up signed and unsigned"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1475690057, "post_id": 39880560, "comment_id": 67048073, "body": "See <code>INT_MAX</code> and <code>UINT_MAX</code>  from <code>limits.h</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475690078, "post_id": 39880560, "comment_id": 67048087, "body": "Your question is confused. Please correct it!"}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "edited": false, "score": 0, "creation_date": 1475691087, "post_id": 39880560, "comment_id": 67048664, "body": "I am confused.I tried to store 2**32-1 in unsigned int and again its 0.Help ??"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475691264, "post_id": 39880560, "comment_id": 67048746, "body": "That is because <code>2**32</code> is out of range of the type, even before you subtract <code>1</code>."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475691365, "post_id": 39880560, "comment_id": 67048795, "body": "@WeatherVane Indeed... So how can i deal with this.I want the power to return 4294967295."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475691592, "post_id": 39880560, "comment_id": 67048919, "body": "<code>unsigned i = (unsigned)(4294967296ull - 1); printf(&quot;%u\\n&quot;, i);</code> Result <code>4294967295</code>. Or work with 64-bit type anyway."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475692235, "post_id": 39880560, "comment_id": 67049281, "body": "Besides which <code>4294967295</code> is not any power of one integer and another."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475711121, "post_id": 39880560, "comment_id": 67057381, "body": "You don&#39;t print an <b>unsigned</b> <code>int</code>!"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475689868, "post_id": 39880642, "comment_id": 67047983, "body": "That is not necessarily true. What if y byte has 9 bits? Or 16? Or there are padding bits? Or it uses a different encoding?"}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "edited": false, "score": 0, "creation_date": 1475689905, "post_id": 39880642, "comment_id": 67048003, "body": "But how is it possible signed to be negative ??"}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "edited": false, "score": 0, "creation_date": 1475689950, "post_id": 39880642, "comment_id": 67048031, "body": "Sorry,unsigned :("}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "edited": false, "score": 0, "creation_date": 1475689964, "post_id": 39880642, "comment_id": 67048033, "body": "I am just new to C"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475690576, "post_id": 39880642, "comment_id": 67048350, "body": "Nit-pick: here is no requirement to use all 32 bits ... There is also no need to make any assumptions about the range, as the implementation has to provide this information ready-to-use."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1475690071, "last_edit_date": 1475690071, "creation_date": 1475689850, "answer_id": 39880642, "question_id": 39880560, "link": "https://stackoverflow.com/questions/39880560/cant-i-store-4294967295-in-unsigned-int-int-is-4-bytes-on-my-machine/39880642#39880642", "title": "Cant i store 4294967295 in unsigned int ? Int is 4 bytes on my machine", "body": "<p>Assuming an <code>int</code> is 4 bytes and you have 8 bit bytes, then <code>int</code> is 32 bits wide.  Subsequently a <code>signed int</code> (if negatives are represented in 2's complement) has a range of -2147483648 to 2147483647 while <code>unsigned int</code> has a range of 0 to 4294967295.</p>\n\n<p>The value 4294967296 in binary is <code>1 00000000 00000000 00000000 00000000</code>.  This is 33 bits.  So 4294967296 is too big for this type.</p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 3, "last_activity_date": 1475690978, "last_edit_date": 1475690978, "creation_date": 1475690277, "answer_id": 39880761, "question_id": 39880560, "link": "https://stackoverflow.com/questions/39880560/cant-i-store-4294967295-in-unsigned-int-int-is-4-bytes-on-my-machine/39880761#39880761", "title": "Cant i store 4294967295 in unsigned int ? Int is 4 bytes on my machine", "body": "<p>If your <code>int</code> or <code>unsigned int</code> is 32-bits, neither can store the value <code>4294967296</code> since this is <code>2**32</code> which would require a 64-bit type.</p>\n\n<p>Even <code>uint32_t</code> can only store the max value <code>2**32 - 1</code> so your value is just <code>1</code> out of range.</p>\n\n<p>But <code>int32_t</code> can store the max positive value <code>2**31 - 1</code> so the signed type is even further off.</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508389820, "post_id": 46809112, "comment_id": 80593644, "body": "&quot;Maybe OP changed the question later...&quot; But is was <i>your</i> question, which you changed after the answers were received. Why would anyone &quot;bother&quot; to revisit to see if you asked the wrong question? It is bit much accepting your own answer."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508421631, "post_id": 46809112, "comment_id": 80610896, "body": "@WeatherVane I am sorry, then stackoverflow is broken, as stackoverflow says &quot;try to improve your questions&quot;, and, I did. Actually, question is not wrong, not at all, if it was wrong, it couldn&#39;t have an answer. And, as you can see, here, I answered it. So, if anyone encounters a problem like this, and saw this question with answer of any other guys that answered, he would be completely confused. This answer actually answers the &quot;new&quot; question. So, yeah. Thanks for that -1, give a -1 to right answer."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508421748, "post_id": 46809112, "comment_id": 80610966, "body": "@WeatherVane And, as question changed, your and all other answers are &quot;wrong&quot;. So, I get -1 because I 1. improve my question 2. answer the new question right."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508432147, "post_id": 46809112, "comment_id": 80617764, "body": "With respect, I think it is your usage of SO that is broken. The idea of improving a question, is in reponse to queries and comments, so that it can be answered. But having received answers to the original question, changing it to a different question is not an improvement because it invalidated all the answers you had received. Expecting commenters to track your now different question and revise their answers is unreasonable. What you should have done, is to ask a new question: the one you intended to ask in the first place, perhaps making reference to this question, or delete this one first."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508441344, "post_id": 46809112, "comment_id": 80622473, "body": "@WeatherVane Im sorry for going too offensive. But, I am frustrated that my account is banned from asking the stupid questions I asked earlier (like this one), and I want to improve them, in order for ban to be removed. And, I can&#39;t do that by asking another question because I am banned, I can edit, only. Any other solution?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508441863, "post_id": 46809112, "comment_id": 80622752, "body": "I have never needed to do this, but you could try opening another account. Some people do this when they keep getting banned for asking troll questions, but I don&#39;t believe you are a troll. Your question was not stupid, but changing it to a different question, was."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508442292, "post_id": 46809112, "comment_id": 80623006, "body": "Yeah, I guess I will make a new account. By the way, I wanted to ask you about your comment earlier, this one: <code>That is because 2**32 is out of range of the type, even before you subtract 1</code>. If that is true, why does my answer (the one that we are commenting on currently) works? Does it firstly take <code>2**32</code> as long int and then when I subtract 1 and put it in unsigned int it just converts it back to unsigned int? I mean, is that what happens? If so, why did you say the comment I just said above. Sorry for my awful English, I am tired and lazy to write correct/shiny words."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508442553, "post_id": 46809112, "comment_id": 80623163, "body": "Please ask a new question."}], "tags": [], "owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "is_accepted": true, "score": 2, "last_activity_date": 1508326613, "last_edit_date": 1508326613, "creation_date": 1508326090, "answer_id": 46809112, "question_id": 39880560, "link": "https://stackoverflow.com/questions/39880560/cant-i-store-4294967295-in-unsigned-int-int-is-4-bytes-on-my-machine/46809112#46809112", "title": "Cant i store 4294967295 in unsigned int ? Int is 4 bytes on my machine", "body": "<p>I am back after long time (obviously) to this question, and I am not sure why everyone thinks OP meant to store <code>4294967296</code> when he wanted to store <code>4294967295</code> as asked in the question, maybe OP changed the question later, and no one bothered to re-answer. Now, back to question.</p>\n\n<p>You can store <code>4294967295</code> in <code>unsigned int</code>, but the problem is in your printing, you are doing <code>printf(\"%d\", 4294967295)</code> which means print <code>4294967295</code> as a <code>signed int</code>, but the number <code>4294967295</code> cannot be stored in <code>signed int</code>, so, narrowing conversion happens.</p>\n\n<p>You need to print the <code>unsigned int</code> that you've got with <code>%u</code> rather than <code>%d</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint power(int base, int pow);\n\nint main(){\n  printf(\"Size of unsigned int: %d\\n\", sizeof(unsigned int));\n  unsigned int the_number = power(2, sizeof(int)*8)-1;\n  printf(\"Wrongly printed: %d\\n\", the_number);\n  printf(\"Correctly printed: %u\\n\", the_number);\n  return 0;\n}\n\nint power(int base, int on) {\n    int pf = 1;\n    for (int i = 0; i &lt; on; i++) {\n        pf *= base;\n    }\n    return pf;\n}\n</code></pre>\n"}], "owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1878, "favorite_count": 0, "accepted_answer_id": 46809112, "answer_count": 3, "score": -1, "last_activity_date": 1508326613, "creation_date": 1475689562, "last_edit_date": 1475691164, "question_id": 39880560, "link": "https://stackoverflow.com/questions/39880560/cant-i-store-4294967295-in-unsigned-int-int-is-4-bytes-on-my-machine", "title": "Cant i store 4294967295 in unsigned int ? Int is 4 bytes on my machine", "body": "<p>Why am i getting 0 ?? And compiler warning:</p>\n\n<blockquote>\n  <p>format \u2018%d\u2019 expects argument of type \u2018int\u2019, but argument 3 has type \u2018long unsigned int\u2019</p>\n</blockquote>\n\n<p>Here is the code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n//function declerations...\nint power(int base, int on);\n\nint main(void) {\n    printf(\"%d\",power(2, sizeof(int)*8)-1);\n    return 0;\n}\n\nint power(int base, int on) {\n    int pf = 1;\n    for (int i = 0; i &lt; on; i++) {\n        pf *= base;\n    }\n    return pf;\n}\n</code></pre>\n\n<p>If int is 4 bytes on my system,i <strong>guess</strong> i should be able to store 4294967295 in <strong>unsigned</strong> int.</p>\n"}, {"tags": ["c", "pointers", "segmentation-fault"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1475689522, "post_id": 39880510, "comment_id": 67047795, "body": "run it under a debugger, it will show you which line is failing"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1475689688, "post_id": 39880510, "comment_id": 67047869, "body": "folderpath only allocates a single character of space, and you&#39;re trying to read the whole string into it.  Change the definition to <code>char folderpath[100];</code> or something with enough space.  Then get rid of the <code>&amp;</code> in the scanf."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1475689613, "creation_date": 1475689613, "answer_id": 39880573, "question_id": 39880510, "link": "https://stackoverflow.com/questions/39880510/segmentation-fault-of-pointerchar/39880573#39880573", "title": "Segmentation fault of pointer&amp;char", "body": "<p>When you call <code>scanf</code> with the <code>%s</code> format specifier, it expects a pointer to an array of characters.  What you're passing is the address of a single character.  So it writes past the memory location of that variable into whatever happens to be next to it.  This invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>You need pass a character array to <code>scanf</code>:</p>\n\n<pre><code>char folderpath[256];\nprintf(\"enter the path : \\n\");\nscanf(\"%s\",folderpath);\n\n...\n\nd = opendir(folderpath);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1475689621, "creation_date": 1475689621, "answer_id": 39880577, "question_id": 39880510, "link": "https://stackoverflow.com/questions/39880510/segmentation-fault-of-pointerchar/39880577#39880577", "title": "Segmentation fault of pointer&amp;char", "body": "<p>you cannot do this</p>\n\n<pre><code>char folderpath;\nprintf(\"enter the path : \\n\");\nscanf(\"%s\",&amp;folderpath);\n</code></pre>\n\n<p>You have reserved space for one character. YOu need</p>\n\n<pre><code>char folderpath[MAX_PATH];\nprintf(\"enter the path : \\n\");\nscanf(\"%s\",&amp;folderpath);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87, "user_id": 6547748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c70855c496be4379b049570584583533?s=128&d=identicon&r=PG&f=1", "display_name": "Shridhar410", "link": "https://stackoverflow.com/users/6547748/shridhar410"}, "is_accepted": false, "score": 0, "last_activity_date": 1475692373, "creation_date": 1475692373, "answer_id": 39881331, "question_id": 39880510, "link": "https://stackoverflow.com/questions/39880510/segmentation-fault-of-pointerchar/39881331#39881331", "title": "Segmentation fault of pointer&amp;char", "body": "<p>When you declare char foldrpath only one byte of memory is allocated that is you can store only one character. When you try to store more than one byte it results in to segmentation fault (access of the memory location out side your process space in this case). So try to use an array like char folderpath[MAXFOLDERLENGTH]  else you can get the contiguous block of bytes by calling malloc like\nchar <em>foldrpath = (char</em>) malloc(MAXFOLDERLENGTH),  this malloc assigns the memory in Heap area where as the former declaration will give you memory allocated in stack area.  Hope this helps </p>\n"}], "owner": {"reputation": 57, "user_id": 5260068, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/038eabaf07364266dcddaa674562af0c?s=128&d=identicon&r=PG&f=1", "display_name": "qfqwerqgfzsdfew", "link": "https://stackoverflow.com/users/5260068/qfqwerqgfzsdfew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 39880573, "answer_count": 3, "score": 1, "last_activity_date": 1475692373, "creation_date": 1475689381, "question_id": 39880510, "link": "https://stackoverflow.com/questions/39880510/segmentation-fault-of-pointerchar", "title": "Segmentation fault of pointer&amp;char", "body": "<p>Im trying to make the program that extract filenames by inputing some folderpath. </p>\n\n<p>The outcome is fine, but the problem is at the end of outcome, there's some segmentation fault that i cant figure out. </p>\n\n<p>Here's what I wrote in.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;dirent.h&gt;\n\nint main() {\n\nchar folderpath;\nprintf(\"enter the path : \\n\");\nscanf(\"%s\",&amp;folderpath);\n\n\n\nDIR   *d;\nstruct dirent *dir;\nd = opendir(&amp;folderpath);\nif (d)\n{\n    while((dir= readdir(d)) != NULL)\n    {\n        printf(\"%s\\n\", dir-&gt;d_name);\n    }\n    closedir(d);\n\n};\n\nreturn 0;\n}\n</code></pre>\n\n<p>And, result is like</p>\n\n<pre><code>enter the path : /Users/gui/Desktop/extract/extract\n.\n..\nmain\nmain.c\nSegmentation fault: 11\n</code></pre>\n\n<p>Sorry for asking really simple question like this, which I tried hard to figure out but I cant.</p>\n\n<p>Thanks for reading this question.\nBest Regard. </p>\n"}, {"tags": ["c", "double", "long-double"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1475688601, "post_id": 39880275, "comment_id": 67047278, "body": "Post the code/output rather than just <i>describe</i> the code/output.  Why do you think the values of <code>LDBL_MAX&#47;DBL_MAX</code> must differ or is a problem?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475688776, "post_id": 39880275, "comment_id": 67047388, "body": "MSVC has <code>#define LDBL_MAX DBL_MAX</code> and similar for MIN. It does implement <code>long double</code> but it is the same as <code>double</code>."}, {"owner": {"reputation": 53, "user_id": 6927849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a347bf69ae3d3976df88f442f3da20c?s=128&d=identicon&r=PG&f=1", "display_name": "Tsurupeta", "link": "https://stackoverflow.com/users/6927849/tsurupeta"}, "edited": false, "score": 0, "creation_date": 1475688793, "post_id": 39880275, "comment_id": 67047397, "body": "The code is: printf(&quot;Type: Long Double  Value: %lf Min: %e Max: %e Memory:%lu\\n&quot;, val10, LDBL_MIN, LDBL_MAX, longd_size); It is a problem because my assignment requires two different values for LDBL and DBL"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475688869, "post_id": 39880275, "comment_id": 67047432, "body": "This question was caused by a problem that <b>can no longer be reproduced</b> or a simple typographical error. While similar questions may be on-topic here, this one was resolved in a manner unlikely to help future readers. This can often be avoided by identifying and closely inspecting the shortest program necessary to reproduce the problem before posting."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1476223794, "post_id": 39880275, "comment_id": 67254046, "body": "@Tsurupeta: Why are you trying to <code>printf</code> a supposedly <code>long double</code> value with <code>%e</code>? <code>%e</code> is for <code>float</code> (and <code>double</code>). For <code>long double</code> you need <code>%Le</code>."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1475688768, "creation_date": 1475688768, "answer_id": 39880360, "question_id": 39880275, "link": "https://stackoverflow.com/questions/39880275/define-ldbl-max-min-on-c/39880360#39880360", "title": "Define LDBL_MAX/MIN on C", "body": "<p>From <a href=\"http://en.cppreference.com/w/c/language/arithmetic_types#Real_floating_types\" rel=\"nofollow\">this reference on the lfoating point types</a>:</p>\n\n<blockquote>\n  <p><code>long double</code> - extended precision floating point type. Matches IEEE-754 extended floating-point type if supported, otherwise matches some non-standard extended floating-point type as long as its precision is better than <code>double</code> and range is at least as good as <code>double</code>, <strong>otherwise matches the type <code>double</code></strong>. Some x86 and x86_64 implementations use the 80-bit x87 floating point type.</p>\n</blockquote>\n\n<p>Added emphasis is mine.</p>\n\n<p>What the above quote says is that while a compliant C compiler must have the <code>long double</code> type, it doesn't really have to support it differently than <code>double</code>. Something which is probably the case with the Visual Studio C compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1573665942, "last_edit_date": 1573665942, "creation_date": 1475688788, "answer_id": 39880370, "question_id": 39880275, "link": "https://stackoverflow.com/questions/39880275/define-ldbl-max-min-on-c/39880370#39880370", "title": "Define LDBL_MAX/MIN on C", "body": "<p>C does not specify that <code>long double</code> must have a greater precision/range than <code>double</code>.</p>\n\n<p>Even if the implementation treats them as different types, they may have the same implementation, range, precision, min value, max value, etc.</p>\n\n<p>Concerning Visual Studio, <a href=\"https://msdn.microsoft.com/en-us/library/9cx8xs15.aspx\" rel=\"nofollow noreferrer\">MS Long Double</a> helps.</p>\n\n<p>To <em>fix</em> the problem, use another compiler that supports <code>long double</code> with a greater precision/range than <code>double</code>.  Perhaps <a href=\"https://gcc.gnu.org\" rel=\"nofollow noreferrer\">GCC</a>?</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475689324, "post_id": 39880477, "comment_id": 67047689, "body": "Just as <code>long int</code> does not have to be &quot;better&quot; than <code>int</code>, the same is true with <code>long double</code>. That does not make the implementation &quot;broken&quot;."}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475729067, "post_id": 39880477, "comment_id": 67061734, "body": "That&#39;s what I said. Either long double is just an alias for double OR the macros are broken."}], "tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 0, "last_activity_date": 1475689260, "creation_date": 1475689260, "answer_id": 39880477, "question_id": 39880275, "link": "https://stackoverflow.com/questions/39880275/define-ldbl-max-min-on-c/39880477#39880477", "title": "Define LDBL_MAX/MIN on C", "body": "<p>Those macros are either broken, or long double is just an alias for double on your system. To test, set a long double to DBL_MAX, multiply by two, then subtract DBL_MAX from it. If the result is finite, then you have extra exponent space in the long double. If not, and long double is bigger than double, the extra bytes could just be padding, or you could have the same exponent space and more precision. So LDBL_MAX's genuine value will be just a smidgen over DBL_MAX.</p>\n\n<p>The easiest way to generate the max is simply to look up the binary representation. However if you want to do it in portable C, you can probe it by repeated multiplications to get the magnitude, then fill out the mantissa by repeatedly adding descending powers of two until you run out of precision. </p>\n"}], "owner": {"reputation": 53, "user_id": 6927849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a347bf69ae3d3976df88f442f3da20c?s=128&d=identicon&r=PG&f=1", "display_name": "Tsurupeta", "link": "https://stackoverflow.com/users/6927849/tsurupeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2188, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1573665942, "creation_date": 1475688447, "last_edit_date": 1476222650, "question_id": 39880275, "link": "https://stackoverflow.com/questions/39880275/define-ldbl-max-min-on-c", "title": "Define LDBL_MAX/MIN on C", "body": "<p>I'm working with C, I have to do an exercise in which I have to print the value of <code>long double min</code> and <code>long double max</code>.</p>\n\n<p>I used <code>float.h</code> as header, but these two macros (<code>LDBL_MIN/MAX</code>) give me the same value as if it was just a double.</p>\n\n<p>I'm using Visual Studio 2015 and if I hover the mouse on <code>LDBL MIN</code> it says <code>#define LDBL_MIN DBL_MIN</code>. Is that why it prints <code>dbl_min</code> instead of <code>ldbl_min</code>? </p>\n\n<p>How can I fix this problem?</p>\n\n<pre><code>printf(\"Type: Long Double Value: %lf Min: %e Max: %e Memory:%lu\\n\", \n    val10, LDBL_MIN, LDBL_MAX, longd_size);\n</code></pre>\n\n<p>It is a problem because my assignment requires two different values for <code>LDBL</code> and <code>DBL</code>.</p>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475687845, "post_id": 39880046, "comment_id": 67046856, "body": "Describe how it does not work on non text file with more details.  How did you review the resulting <code>&quot;output.txt&quot;</code> in those cases - perhaps that viewer is the issue.  I suspect the unpack function is your culprit - which is not shown and makes this post unclear."}, {"owner": {"reputation": 23, "user_id": 6927772, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/75e2a034924b993432f11a9da2da1fc2?s=128&d=identicon&r=PG&f=1", "display_name": "Better Fly", "link": "https://stackoverflow.com/users/6927772/better-fly"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475688031, "post_id": 39880046, "comment_id": 67046939, "body": "When i combine multiple different extentions files, iget error since all the files combined in the same one without delimiter or separator ... and have no idea on how to register too the name of files and unpack them back."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475688114, "post_id": 39880046, "comment_id": 67046990, "body": "Then write the name length, name and file length into the merged file also.  Perhaps as simple as [64-length] [filename] [64-bit length file size] [file data]."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475688226, "post_id": 39880046, "comment_id": 67047058, "body": "Minor: <code>if (!k) return 1;</code> should be <code>if (k &lt; n) { fclose (fp); fclose(fp_read); return 1; }</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475688360, "post_id": 39880046, "comment_id": 67047128, "body": "Did you write the posted code?"}, {"owner": {"reputation": 23, "user_id": 6927772, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/75e2a034924b993432f11a9da2da1fc2?s=128&d=identicon&r=PG&f=1", "display_name": "Better Fly", "link": "https://stackoverflow.com/users/6927772/better-fly"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475688756, "post_id": 39880046, "comment_id": 67047373, "body": "@chux no i didn&#39;t, please can you show me how to do that: [64-length] [filename] [64-bit length file size] [file data] ?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475689685, "post_id": 39880046, "comment_id": 67047868, "body": "Yes I can, but it would be better for you to post first what you have tried - even if it has a few flaws - else this post is too broad - too many good answers.  The code above all ready shows how to do some of the goal."}, {"owner": {"reputation": 23, "user_id": 6927772, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/75e2a034924b993432f11a9da2da1fc2?s=128&d=identicon&r=PG&f=1", "display_name": "Better Fly", "link": "https://stackoverflow.com/users/6927772/better-fly"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475943922, "post_id": 39880046, "comment_id": 67151171, "body": "My goal is to merge many files with different extension and is there where i am blocked. I can&#39;t do more on what i have posted ... if anyone have an approche thank&#39;s to suggest."}], "owner": {"reputation": 23, "user_id": 6927772, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/75e2a034924b993432f11a9da2da1fc2?s=128&d=identicon&r=PG&f=1", "display_name": "Better Fly", "link": "https://stackoverflow.com/users/6927772/better-fly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1475687614, "creation_date": 1475687614, "question_id": 39880046, "link": "https://stackoverflow.com/questions/39880046/merging-multiple-file-with-different-extensions-in-single-file", "title": "merging multiple file with different extensions in single file", "body": "<p>I want make a function in order to pack multiples files into a single one using <code>C</code> language, and reverse the operation with another function.</p>\n\n<pre><code>int cbd_merge_files(const char** filenames, int n, const char* final_filename) {\n\n  FILE* fp = fopen(final_filename, \"wb\");\n\n  if (fp == NULL) return 1;\n\n  char buffer[4097];\n\n  for (int i = 0; i &lt; n; ++i) {\n\n    const char* fname = filenames[i];\n\n    FILE* fp_read = fopen(fname, \"rb\");\n\n    if (fp_read == NULL) return 1;\n\n    int n;\n\n    while ((n = fread(buffer, sizeof(char), 4096, fp_read))) {\n\n        int k = fwrite(buffer, sizeof(char), n, fp);\n\n        if (!k) return 1;\n    }\n    fclose(fp_read);\n\n }\n\n fclose(fp);\n\n return 0;\n}\n\nint main(int argc, const char** argv)\n{\n  cbd_merge_files(argv+1, argc-1, \"output.txt\");\n  return 0;\n}\n</code></pre>\n\n<p>I am using this code in order to make it work, but work only with TXT files, and not with different files like: exe, jpg, zip, rar etc ...</p>\n\n<p>Is there a fix or another function to do the same job ? another approch/method ?</p>\n\n<p><strong>Note:</strong> I am using <code>Visual Studio 2010</code></p>\n\n<p>Thank's.</p>\n"}, {"tags": ["c", "infinite-loop", "quicksort"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1475687636, "post_id": 39880006, "comment_id": 67046753, "body": "You might want to start by creating function prototypes of the functions you call, before you call them. Turn on more warnings by the compiler. And use a debugger to step through the code.&#39;"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475688049, "post_id": 39880006, "comment_id": 67046953, "body": "Your <code>partition</code> function appears broken: it acts as if the subarray being partitioned always starts at index <code>0</code>, regardless of the value of its <code>low</code> parameter."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475688187, "post_id": 39880006, "comment_id": 67047036, "body": "Also, <code>for(j = j;</code> probably does not do what you intend."}, {"owner": {"reputation": 1857, "user_id": 5679064, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l2ibgQ05wGY/AAAAAAAAAAI/AAAAAAAAAAA/IJpQJnP_zVo/photo.jpg?sz=128", "display_name": "Gasper", "link": "https://stackoverflow.com/users/5679064/gasper"}, "edited": false, "score": 0, "creation_date": 1475688370, "post_id": 39880006, "comment_id": 67047133, "body": "I guess, something&#39;s not right in lines 54 and 61."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475688625, "post_id": 39880006, "comment_id": 67047293, "body": "That&#39;s not standard C and your compiler should warn. Don&#39;t even think about learning K&amp;R-C!"}, {"owner": {"reputation": 1895, "user_id": 4358977, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43df6e8842a5115d74370e5128770bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Dark Cyber", "link": "https://stackoverflow.com/users/4358977/dark-cyber"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475688666, "post_id": 39880006, "comment_id": 67047313, "body": "@JohnBollinger yes always choose the most right element is bad practice, but I doesn&#39;t matter so far for me as I am learning how QuickSort works and understand it."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1475690451, "creation_date": 1475690451, "answer_id": 39880801, "question_id": 39880006, "link": "https://stackoverflow.com/questions/39880006/quicksort-infinite-loop-in-c/39880801#39880801", "title": "QuickSort Infinite Loop in C?", "body": "<p>You have several problems with your code, mostly affecting its efficiency rather than its correctness.  Several of those were called out in comments.  The biggest problem, however, is the termination condition for your recursion, as you might expect given the nature of the incorrect behavior.</p>\n\n<p>Specifically, your recursion bottoms out when <code>partition()</code> returns a value less than or equal to zero, but that function <em>always</em> returns the final position chosen for the pivot.  If you recurse down the left side of your partitions only, then you are certain of getting that zero eventually, but when you recurse down any partition that doesn't include element <code>0</code>, <code>partition()</code> will never return <code>0</code>.</p>\n\n<p>You should instead break from the recursion based on the size of the segment to be sorted (i.e. <code>high - low</code>).  If it is less than 1 then you can stop, because a segment with fewer than two elements is certain to be already in sorted order.</p>\n"}], "owner": {"reputation": 1895, "user_id": 4358977, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43df6e8842a5115d74370e5128770bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Dark Cyber", "link": "https://stackoverflow.com/users/4358977/dark-cyber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1475690451, "creation_date": 1475687452, "last_edit_date": 1475688241, "question_id": 39880006, "link": "https://stackoverflow.com/questions/39880006/quicksort-infinite-loop-in-c", "title": "QuickSort Infinite Loop in C?", "body": "<p>I face infinite loop issue in my quick sort algorithm, this thing happen in right sub array partition, so if I only partition the left sub array it works great like this code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint list[] = {8, 1, 3, 4, 2, 10, 4, 6};\n//int list[] = {2, 1, 10, 4, 5, 11, 12, 6};\n//int list[] = {1, 2, 4,  5, 6, 11, 12, 10};\nint main(int argc, char **argv)\n{\n\n    printf(\"Unsorted list is: \");\n    printArray(list);\n    quickSort(list, 0, 7);\n    //partition(list, 5, 7);\n    printf(\"Sorted list is: \");\n    printArray(list);\n\n    return 0;\n}\n\nvoid printArray(int list[]){\n    int i;\n    for(i = 0; i &lt; 8; i++){\n        printf(\" %d \", list[i]);\n    }   \n    printf(\"\\n\\n\");\n}\n\nvoid quickSort(int list[], int low, int high){\n\n    int pIndex = partition(list, low, high);\n\n    if(pIndex &lt;= 0){\n        return;\n    }\n\n    //quick sort left sub array\n    quickSort(list, low, pIndex-1);\n\n    //quick sort right sub array\n//  quickSort(list, pIndex+1, high);\n\n    printf(\"pIndex is %d\\n\", pIndex);\n}\n\nint partition(int list[], int low, int high){\n    int pivot = list[high];\n\n\n    int i;\n    int j = high - 1;\n//  int j = high;\n\n\n    while( 1 ){\n        //less than pivot\n        for(i = 0; list[i] &lt; pivot; i++){\n            printf(\"for %d (index %dth) &lt; %d\\n\", list[i], i, pivot);\n            //do nothing\n        }\n        printf(\"less than stop at index %d which is %d\\n\", i, list[i]);\n\n        //more than pivot\n        for(j = j; j &gt; 0 &amp;&amp; pivot &lt; list[j]; j--){\n            printf(\"for %d &lt; %d (index %dth)\\n\", pivot, list[j], j);\n        }\n        printf(\"greater than stop at index %d which is %d\\n\", j, list[j]);\n\n        if(i &gt;= j){\n        printf(\"low index %d &gt;= %d then swap pivot\\n\", i, j);\n        printf(\"swap index %dth which is %d, with index pivot %d which is %d\\n\", i, list[i], high, list[high]);\n        swap(list, i, high);\n\n        printf(\"Temporary list is: \");\n        printArray(list);\n\n        printf(\"then return last position index pivot %d which is %d\\n\", i, list[i]);\n        return i;\n        break;\n        }\n\n        //tukarPosisi, sehingga yang kecil di sebelah kiri, yang besar di sebelah kanan.\n        printf(\"swap index %dth which is %d, with index %dth, which is %d\\n\", i, list[i], j, list[j]);\n        swap(list, i, j);\n\n        printf(\"Temporary list is: \");\n        printArray(list);\n\n\n    }\n}\n\nvoid swap(int list[], int i, int j){\n    //variabel sementara untuk menampung i\n    int temporary = list[i];\n\n    //tukar posisi, sehingga yg kecil di kiri, yg besar di kanan.\n    list[i] = list[j];\n    list[j] = temporary;\n}\n</code></pre>\n\n<p>I have already print much debug but still can't figure out why this thing happen.\nSo where is the logic wrong and how to fix it?</p>\n\n<p>Any help will be appreciated</p>\n"}, {"tags": ["c", "bit-fields"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1475687092, "post_id": 39879866, "comment_id": 67046435, "body": "With a <code>union</code>?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475687162, "post_id": 39879866, "comment_id": 67046475, "body": "Any reason you are aware of <code>uint64_t</code> and use it partially, but then use <code>unsigned long</code> whihc is not guaranteed to have 64 bits? And why not directly print the <code>uint64_t</code> types? Are you aware of <code>inttypes.h</code>?"}, {"owner": {"reputation": 918, "user_id": 2133905, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y4wcC.jpg?s=128&g=1", "display_name": "SGM1", "link": "https://stackoverflow.com/users/2133905/sgm1"}, "edited": false, "score": 0, "creation_date": 1475687436, "post_id": 39879866, "comment_id": 67046633, "body": "&quot;What if I want to get the 64 bits and use it?&quot; What do you wish to accomplish?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1475687455, "post_id": 39879866, "comment_id": 67046646, "body": "Bit fields wider than <code>int&#47;unsigned</code> are not necessarily supported.  Portable code would not generally attempt <code>uint64_t lower: 32;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 809, "user_id": 1143601, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/ff0d945e0537fbc4adf09797679801ec?s=128&d=identicon&r=PG", "display_name": "carveone", "link": "https://stackoverflow.com/users/1143601/carveone"}, "is_accepted": true, "score": 1, "last_activity_date": 1475687329, "creation_date": 1475687329, "answer_id": 39879965, "question_id": 39879866, "link": "https://stackoverflow.com/questions/39879866/how-to-use-bit-field-to-get-whole-row-bits/39879965#39879965", "title": "How to use bit field to get whole row bits?", "body": "<p>Weather Vane just fractionally ahead of me...!</p>\n\n<p>You use a union. There's one in the Win32 headers (not sure I like it) called ULARGE_INTEGER but here's a quick union example which paraphases that union:</p>\n\n<pre><code>typedef union {\n  struct {\n    int32_t LowPart;\n    int32_t HighPart;\n  } u;\n  uint64_t QuadPart;\n} ULARGE_INTEGER;\n</code></pre>\n\n<p>Thus if you had ULARGE_INTEGER a, a.QuadPart would give you the 64 bit part and a.u.LowPart would give you the low 32 bits. Or high 32 bits if your machine was big-endian!</p>\n"}], "owner": {"reputation": 115, "user_id": 6183156, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a2b11ab0ffc9438c909565f9c735280e?s=128&d=identicon&r=PG&f=1", "display_name": "Jam", "link": "https://stackoverflow.com/users/6183156/jam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 39879965, "answer_count": 1, "score": -1, "last_activity_date": 1475687329, "creation_date": 1475686948, "question_id": 39879866, "link": "https://stackoverflow.com/questions/39879866/how-to-use-bit-field-to-get-whole-row-bits", "title": "How to use bit field to get whole row bits?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nstruct __attribute__((__packed__)) sf_header\n{\n    uint64_t lower: 32;\n    uint64_t higher: 32;\n};\nint main()\n{\n    struct sf_header h;\n\n    // part 1;\n    h.lower = 15;\n    h.higher = 1;\n\n    printf(\"lower part: %d\\n\", h.lower);\n    printf(\"higher part: %d\\n\", h.higher);\n\n    //part 2: how to printf the whole 64-bits (a row)\n    unsigned long int lower = h.lower;\n    unsigned long int higher = h.higher;\n    higher = higher &lt;&lt; 32;\n\n    printf(\"lower: %ld\\n\", lower);\n    printf(\"higher: %ld\\n\", higher);\n\n    unsigned long int final = lower | higher;\n    printf(\"Final: %ld\\n\", final);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>It runs on 64-bits and the long int is 8 bytes which is a row sized.</p>\n\n<p>First, I assign two values into the lower 32 bits and higher 32 bits.</p>\n\n<p>What if I want to get the 64 bits and use it? </p>\n\n<p>Do I need to do the part 2 or there is a easy way of bit field to do it? </p>\n"}, {"tags": ["c", "enums"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 5, "creation_date": 1475685006, "post_id": 39879074, "comment_id": 67045237, "body": "To understand why you would use hexadecimal in an enum, you need to understand why you would use hexadecimal for anything. There&#39;s really nothing special about a typedef enum."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1475685459, "post_id": 39879074, "comment_id": 67045538, "body": "Hexadecimal might be used because it can be more readable to programmers, in the right context, than decimal, though to beginners it might seem <i>less</i> readable until they become familiar with hex. You mention bit masks, which are more easily converted from hex to binary in the mind, than from decimal, and somehow it makes their intended use more obvious: as masks rather than values. For example, the mask might isolate specific bits in a processor register, rather than being a value used for computation."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475685874, "post_id": 39879074, "comment_id": 67045781, "body": "A <i>downside</i> to using hexadecimal notation occurs when using a hex value outside the <code>int</code> range.  With 4-byte <code>int&#47;unsigned</code>: <code>0x80000000</code> is UB as it violates an &quot;enumeration constant shall be an integer constant expression that has a value representable as an <code>int</code>.&quot; even though it looks OK.  Yet most compilers handle this in the usual hoped-for manner."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475686214, "post_id": 39879074, "comment_id": 67045971, "body": "@chux yes, in MSVC&#39;s <code>limits.h</code> they have <code>#define INT_MIN (-2147483647 - 1)</code>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1475686235, "post_id": 39879074, "comment_id": 67045977, "body": "@chux: It&#39;s not just undefined behavior, it&#39;s a constraint violation; any conforming compiler must at least warn about it. (gcc apparently doesn&#39;t warn about this by default. gcc is not a conforming C compiler by default.)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475686339, "post_id": 39879074, "comment_id": 67046033, "body": "@WeatherVane: The value of <code>INT_MIN</code> is not the point. <code>0x80000000</code> is a positive value. If <code>int</code> is 32 bits, then it&#39;s of type <code>unsigned int</code> (because it exceeds <code>INT_MAX</code>)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1475686574, "post_id": 39879074, "comment_id": 67046175, "body": "@KeithThompson perhaps my point was poorly stated. MSVC does not use <code>#define INT_MIN (-2147483648)</code> because the negated value starts from a positive value that cannot be represented by 32-bit <code>int</code>, which is what I thought chux wrote."}], "answers": [{"tags": [], "owner": {"reputation": 297030, "user_id": 1226963, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/yjY1E.png?s=128&g=1", "display_name": "rmaddy", "link": "https://stackoverflow.com/users/1226963/rmaddy"}, "is_accepted": true, "score": 3, "last_activity_date": 1475685139, "creation_date": 1475685139, "answer_id": 39879371, "question_id": 39879074, "link": "https://stackoverflow.com/questions/39879074/hexadecimal-in-typedef-enum-in-c/39879371#39879371", "title": "hexadecimal in typedef enum in C", "body": "<p>For a bit mask it helps to look at values in binary since that is the level needed for a bit mask. And each enum value typically only sets a single bit.</p>\n\n<p>So the enum values would be set (in binary) to <code>00001</code>, <code>00010</code>, <code>00100</code>, <code>01000</code>, <code>10000</code>, etc.</p>\n\n<p>Those same values in decimal would be: <code>1</code>, <code>2</code>, <code>4</code>, <code>8</code>, <code>16</code>, etc.</p>\n\n<p>And in hex they would be <code>0x01</code>, <code>0x02</code>, <code>0x04</code>, <code>0x08</code>, <code>0x10</code>, etc.</p>\n\n<p>It's really just a matter of preference but since hexadecimal is a power of 2, it better relates to binary than decimal does. This makes it slightly clearer that the values represent bit mask values.</p>\n"}, {"tags": [], "owner": {"reputation": 13260, "user_id": 6612932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3mwe.jpg?s=128&g=1", "display_name": "rgmt", "link": "https://stackoverflow.com/users/6612932/rgmt"}, "is_accepted": false, "score": 0, "last_activity_date": 1475687337, "creation_date": 1475687337, "answer_id": 39879969, "question_id": 39879074, "link": "https://stackoverflow.com/questions/39879074/hexadecimal-in-typedef-enum-in-c/39879969#39879969", "title": "hexadecimal in typedef enum in C", "body": "<p>Just to complete rmaddy's answer, an alternative writing to make bitmask values more visible without hexadecimal numbers can be:</p>\n\n<pre><code>typedef enum\n{\n    // empty bitmask\n\n    empty_mask = 0,\n\n    // bitmask values\n\n    first_bit   = 1 &lt;&lt; 0,\n    second_bit  = 1 &lt;&lt; 1,\n    third_bit   = 1 &lt;&lt; 2,\n\n    // bitwise combinations\n\n    both_first_and_second = first_bit | second_bit\n} My_enum;\n</code></pre>\n\n<p>The shift operator <code>&lt;&lt;</code> removes the need to interpret hexadecimal values.\nCombinations can be declared after the \"core\" values.</p>\n"}, {"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 1, "last_activity_date": 1475692026, "creation_date": 1475692026, "answer_id": 39881233, "question_id": 39879074, "link": "https://stackoverflow.com/questions/39879074/hexadecimal-in-typedef-enum-in-c/39881233#39881233", "title": "hexadecimal in typedef enum in C", "body": "<p>The example in the linked question (not quoted in this question) is:</p>\n\n<pre><code>enum {\n    easySprite      = 0x0000000a,\n    mediumSprite    = 0x0000000b,\n    hardSprite      = 0x0000000c,\n    backButton      = 0x0000000d,\n    magneticSprite  = 0x0000000e,\n    magneticSprite2 = 0x0000000f\n};\n</code></pre>\n\n<p>This creates an <em>anonymous</em> enumerated type; you can't define objects of the type. So in effect, the only thing the declaration does is define a set of <code>int</code> constants (enumeration constants are always of type <code>int</code>), and specify their values in hexadecimal.</p>\n\n<p>This is arguably an abuse of the <code>enum</code> construct, which is mainly intended to create types, but it's the only real way to define integer constants without using macros. (<code>const int easySprite = 0x0000000a;</code> doesn't make <code>easySprite</code> a constant expression.)</p>\n\n<p>The first value is <code>0xa</code> (decimal 10), and the other values are in sequential order.</p>\n\n<p>This:</p>\n\n<pre><code>enum {\n    easySprite      = 10,\n    mediumSprite    = 11,\n    hardSprite      = 12,\n    backButton      = 13,\n    magneticSprite  = 14,\n    magneticSprite2 = 15\n};\n</code></pre>\n\n<p>would mean exactly the same thing. For that matter, so would this, though it's less explicit:</p>\n\n<pre><code>enum {\n    easySprite = 10,\n    mediumSprite,   \n    hardSprite,     \n    backButton,     \n    magneticSprite, \n    magneticSprite2\n};\n</code></pre>\n\n<p>So why use hexadecimal? My guess is that the values of <code>easySprite</code>, <code>mediumSprite</code> et al are defined in some interface (the linked question mentions OpenGL), and for whatever reason it's convenient to define the values in hexadecimal. Perhaps these values are bitwise-anded with some other values, forming a bit pattern whose low-order 4 bits specify the kind of sprite and the other bits specify other information. Writing <code>0x0000000a</code> rather than the equivalent <code>0xa</code> is probably intended to make it clear that it's meant to be (part of) a full 32-bit value. It's impossible to be sure without seeing the context.</p>\n\n<p>In any case, there's certainly nothing wrong with using hexadecimal here, and given the context it may well be clearer than the equivalent decimal.</p>\n\n<p>(A Google search for \"OpenGL magneticSprite\" only gets three or so hits, so I doubt that this is part of the OpenGL specification. A Google search for <code>mediumSprite</code> turns up a lot of information about soft drinks.)</p>\n"}], "owner": {"reputation": 555, "user_id": 4146319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DruEX.png?s=128&g=1", "display_name": "Sujananth", "link": "https://stackoverflow.com/users/4146319/sujananth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5724, "favorite_count": 0, "accepted_answer_id": 39879371, "answer_count": 3, "score": -2, "last_activity_date": 1475692026, "creation_date": 1475684167, "last_edit_date": 1495541206, "question_id": 39879074, "link": "https://stackoverflow.com/questions/39879074/hexadecimal-in-typedef-enum-in-c", "title": "hexadecimal in typedef enum in C", "body": "<p>I was searching for the reason behind using hexadecimal in <code>typedef enum</code> in C.</p>\n\n<p>I followed the following link, but there are two answers:\n<a href=\"https://stackoverflow.com/questions/8414188/c-obj-c-enum-without-tag-or-identifier\">c, obj c enum without tag or identifier</a></p>\n\n<p>LearnCocos2D says that, <em>\"there's no gain to use hex numbers and in particular there's no point in starting the hex numbers with a through f (10 to 15). \"</em></p>\n\n<p>Sulthan says that, <em>\"Hexadecimal numbers are commonly used when the integer is a binary mask\"</em>. I searched for binary mask and came to understand that, its a technique used in bitmap gaming from following link <a href=\"https://en.wikipedia.org/wiki/Mask_(computing)\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Mask_(computing)</a></p>\n\n<p>If sulthan is right, kindly help me understand it.</p>\n\n<p>I don't have enough reputation to comment, so I created this as new question.</p>\n"}, {"tags": ["c++", "c", "windows", "multithreading", "winapi"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1475683890, "post_id": 39878970, "comment_id": 67044498, "body": "What happens if you only use a number of threads equal to the number of cores or the number of cores minus 1?"}, {"owner": {"reputation": 2725, "user_id": 1317981, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1a8c0089b6bad61301334936fdc62b2?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1317981/daniel"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1475683985, "post_id": 39878970, "comment_id": 67044553, "body": "I have 2 physical and 4 logical processors - I get the same results with 2, 3, and 4 threads."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1475684185, "post_id": 39878970, "comment_id": 67044679, "body": "Somewhat related, there are <i>much</i> faster ways of computing a sequential sum. Think about this: 1-through-10. That would be the same as (1+10) + (9+2) + (8+3) + (7+4) + (6+5). In other words, it is 11 * 5 = 55. One multiplication rather than 9 additions, and most importantly, <i>no loop</i>. Consider how you would apply that to your overall task."}, {"owner": {"reputation": 2725, "user_id": 1317981, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1a8c0089b6bad61301334936fdc62b2?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1317981/daniel"}, "edited": false, "score": 1, "creation_date": 1475684244, "post_id": 39878970, "comment_id": 67044713, "body": "Yes, as I said, I&#39;m familiar with the formula, but I&#39;m doing this as an exercise."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1475684280, "post_id": 39878970, "comment_id": 67044736, "body": "Ah ok. So long as this isn&#39;t for something critical. gotcha."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1475684474, "post_id": 39878970, "comment_id": 67044866, "body": "Is the sum-result correct regardless of the number of thread?"}, {"owner": {"reputation": 2725, "user_id": 1317981, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1a8c0089b6bad61301334936fdc62b2?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1317981/daniel"}, "edited": false, "score": 0, "creation_date": 1475684504, "post_id": 39878970, "comment_id": 67044891, "body": "Yes, both methods arrive at the same result, regardless of the number of threads."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475684719, "post_id": 39878970, "comment_id": 67045038, "body": "&quot;When I multiply UPPER by 10 and ...  doesn&#39;t even stop&quot;  How did you multiply by 10? <code>1000000000*10</code> or append a zero?  The first overflows."}, {"owner": {"reputation": 2725, "user_id": 1317981, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1a8c0089b6bad61301334936fdc62b2?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1317981/daniel"}, "edited": false, "score": 0, "creation_date": 1475684741, "post_id": 39878970, "comment_id": 67045055, "body": "Appended a zero. At any rate, issues like that would be caught fairly quickly, because I run the serial version before I run the multithreaded version."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1475684787, "post_id": 39878970, "comment_id": 67045092, "body": "<code>1000000000</code> needs to be <code>1000000000LL</code> then"}, {"owner": {"reputation": 2725, "user_id": 1317981, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1a8c0089b6bad61301334936fdc62b2?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1317981/daniel"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1475684884, "post_id": 39878970, "comment_id": 67045159, "body": "@NathanOliver I changed it but I&#39;m getting the same results (both in terms of the calculation itself and the elapsed time)."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1475685041, "post_id": 39878970, "comment_id": 67045259, "body": "How much time does this take anyways in the serial version?  Spinning up threads takes times.  I would not suspect it to be to much time but if the serial version is really fast it might matter."}, {"owner": {"reputation": 2725, "user_id": 1317981, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1a8c0089b6bad61301334936fdc62b2?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1317981/daniel"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1475685091, "post_id": 39878970, "comment_id": 67045293, "body": "@4386427 - It turns out that the sum is incorrect when the thread count is 3, but not by much. It&#39;s probably an error with the way I calculate the sum, I don&#39;t think it&#39;s related to the core issue of speed."}, {"owner": {"reputation": 2725, "user_id": 1317981, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1a8c0089b6bad61301334936fdc62b2?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1317981/daniel"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1475685113, "post_id": 39878970, "comment_id": 67045309, "body": "@NathanOliver Approximately 3 seconds serial version, 6 seconds multithreaded."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1475685612, "post_id": 39878970, "comment_id": 67045640, "body": "@Daniel yeah, your loop doesn&#39;t account for the remainder of an uneven division, but the overall the time crunch shouldn&#39;t matter. A ported version of your code for C++11 <a href=\"http://coliru.stacked-crooked.com/a/947e626954c4adee\" rel=\"nofollow noreferrer\">can be found here</a>. Coliru has a limit on hardware concurrency of 2, so test it on your box. Interesting question; have an uptick."}, {"owner": {"reputation": 2725, "user_id": 1317981, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1a8c0089b6bad61301334936fdc62b2?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1317981/daniel"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1475685941, "post_id": 39878970, "comment_id": 67045818, "body": "@WhozCraig When I run the code you linked I get a speed of 350ms for 1 thread and 196ms for 8 threads."}, {"owner": {"reputation": 1499, "user_id": 1372577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4819b4e5fd753e26319b41b632182e0?s=128&d=identicon&r=PG", "display_name": "Constantine Georgiou", "link": "https://stackoverflow.com/users/1372577/constantine-georgiou"}, "edited": false, "score": 0, "creation_date": 1475696952, "post_id": 39878970, "comment_id": 67052011, "body": "Maybe the loop in the worker threads could be optimized (the calculation <code>i &lt;= x + UPPER &#47; NUM</code> in each step compares to the summing calculation itself). So, the first and last value could be calculated before the loop, and the condition in the for loop would then only be check against the last value, ie avoid the addition (and the division?). And as a sidenote, it would be best that the splitting of the workload be done by the main thread, just for the case that UPPER isn&#39;t exactly divisible by NUM (the worker threads should then take a from-to range as a parameter, not the thread ordinal)."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1475696984, "post_id": 39878970, "comment_id": 67052028, "body": "Of topic: I&#39;m not a windows guy so this might be all wrong. I just want to ask: Is CriticalSection really the way to do this on windows? From embedded systems I know that CriticalSection means more or less a complete stop of everything else. Don&#39;t windows have simple mutexes?"}, {"owner": {"reputation": 1499, "user_id": 1372577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4819b4e5fd753e26319b41b632182e0?s=128&d=identicon&r=PG", "display_name": "Constantine Georgiou", "link": "https://stackoverflow.com/users/1372577/constantine-georgiou"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1475697161, "post_id": 39878970, "comment_id": 67052135, "body": "@4386427, yes, a critical section is essentially a &quot;mutex&quot;, but its a lot faster than a WinAPI mutex object, and only works for threads of the same process. There are other ways to do this, eg the std::mutex."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1475706225, "post_id": 39878970, "comment_id": 67056091, "body": "In this case, what you&#39;re doing inside the critical section is so simple that it can be done without one: see the InterlockedAdd function.  It might be worth making that change just to see how it affects the timing."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1475733832, "post_id": 39878970, "comment_id": 67063461, "body": "Exactly. Full on lock is way over the top. Atomic arithmetic is the way."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1475685352, "post_id": 39879374, "comment_id": 67045469, "body": "I had the same thought and asked the OP how much time it actually took.  He states the serial version takes 3 seconds and the parallel takes 6.  I&#39;m doubtful it takes 3 seconds to spin up 10 threads."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1475691846, "post_id": 39879374, "comment_id": 67049068, "body": "Branch prediction will be almost identical in either version. You will have <i>&lt;number of threads&gt;</i> branch misses. Compare that to the number of iterations, and you&#39;ll see, that this is hardly even measurable."}, {"owner": {"reputation": 327, "user_id": 2153848, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e1819a51339a47b0a4f84c295895840?s=128&d=identicon&r=PG", "display_name": "jhbh", "link": "https://stackoverflow.com/users/2153848/jhbh"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1475695840, "post_id": 39879374, "comment_id": 67051346, "body": "@NathanOliver certainly, the initial spin up wont take that long, but for a trivial task such as this, it is still worth considering the overhead of a threaded approach."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1475697215, "post_id": 39879374, "comment_id": 67052156, "body": "@jhbh - If total time is 3 sec for the serial, a threaded solution should perform better."}], "tags": [], "owner": {"reputation": 327, "user_id": 2153848, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e1819a51339a47b0a4f84c295895840?s=128&d=identicon&r=PG", "display_name": "jhbh", "link": "https://stackoverflow.com/users/2153848/jhbh"}, "is_accepted": false, "score": 0, "last_activity_date": 1475685151, "creation_date": 1475685151, "answer_id": 39879374, "question_id": 39878970, "link": "https://stackoverflow.com/questions/39878970/summing-numbers-in-parallel-takes-twice-as-long-as-the-serial-version/39879374#39879374", "title": "Summing numbers in parallel takes twice as long as the serial version", "body": "<p>Spooling up threads is costly.</p>\n\n<p>I would wager though that the biggest influence on run time in this case is compiler optimization and branch prediction. both of which will be significantly better in the serial version in this use case.</p>\n"}, {"tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": false, "score": 2, "last_activity_date": 1475685172, "creation_date": 1475685172, "answer_id": 39879381, "question_id": 39878970, "link": "https://stackoverflow.com/questions/39878970/summing-numbers-in-parallel-takes-twice-as-long-as-the-serial-version/39879381#39879381", "title": "Summing numbers in parallel takes twice as long as the serial version", "body": "<p>There are a few things that represent potential culprits. </p>\n\n<p>First of all (and this is usually the big one), check which Compiler Optimizations you have enabled. Two things are often extremely true when it comes to Compiler Optimizations:</p>\n\n<ul>\n<li>They are very good at optimizing \"Accumulation loops\", which is what you're doing in this code. In fact, depending on the compiler, they may unroll the loop, or use SIMD operations to speed the whole thing up.</li>\n<li>They are not [as-] good at optimizing any kind of multithreaded code, regardless of how simple the code is.</li>\n</ul>\n\n<p>I've found similar results when dealing with single vs multithreaded accumulators, and the results usually reverse (to the multithreaded code becoming faster) when the optimizations are turned off.</p>\n\n<p>As a case study, consider writing code that's slightly less trivial than \"add all numbers together between <code>x</code> and <code>y</code>\" and see if the multithreaded code suddenly becomes more efficient. My prediction is that it will, because the compiler will lose ways to optimize the Serial code.</p>\n\n<p>Secondly, while this usually doesn't represent a huge problem for most use-cases (probably not yours), it's worth noting that starting up new threads usually involves a certain amount of overhead. That's worth bearing in mind.</p>\n\n<p>The last suggestion is to evaluate exactly <em>how</em> you're performing the calculations. If you had written code like this:</p>\n\n<pre><code>size_t sum = 0;\nstd::mutex mutex;\nstd::thread t1([&amp;]{for(size_t i = 0; i &lt; 1'000'000; i++) {mutex.lock(); sum+=i; mutex.unlock();}});\nstd::thread t2([&amp;]{for(size_t i = 1'000'000; i &lt; 2'000'000; i++) {mutex.lock(); sum+=i; mutex.unlock();}});\nt1.join();\nt2.join();\nstd::cout &lt;&lt; \"Sum of integers between 0 and 1999999: \" &lt;&lt; sum &lt;&lt; std::endl;\n</code></pre>\n\n<p>It would almost certainly be slower than the code you <em>did</em> write, which is functionally identical to:</p>\n\n<pre><code>size_t sum = 0;\nsize_t s1 = 0, s2 = 0;\nstd::mutex mutex;\nstd::thread t1([&amp;]{for(size_t i = 0; i &lt; 1'000'000; i++) {s1 += i;} mutex.lock(); sum += s1; mutex.unlock();});\nstd::thread t2([&amp;]{for(size_t i = 1'000'000; i &lt; 2'000'000; i++) {s2 += i;}mutex.lock(); sum += s2; mutex.unlock();});\nt1.join();\nt2.join();\nstd::cout &lt;&lt; \"Sum of integers between 0 and 1999999: \" &lt;&lt; sum &lt;&lt; std::endl;\n</code></pre>\n\n<p>You <em>might</em> (emphasis on the word \"might\") be able to get a minor speed up if you write it like this instead (since Mutexes/Critical Sections are usually major performance bottlenecks):</p>\n\n<pre><code>size_t sum = 0;\nsize_t s1 = 0, s2 = 0;\nstd::thread t1([&amp;]{for(size_t i = 0; i &lt; 1'000'000; i++) {s1 += i;}});\nstd::thread t2([&amp;]{for(size_t i = 1'000'000; i &lt; 2'000'000; i++) {s2 += i;}});\nt1.join();\nt2.join();\nsum = s1 + s2;\nstd::cout &lt;&lt; \"Sum of integers between 0 and 1999999: \" &lt;&lt; sum &lt;&lt; std::endl;\n</code></pre>\n\n<p>Of course, that's not a huge problem in this situation, but it's always worth considering and bearing in mind.</p>\n"}, {"comments": [{"owner": {"reputation": 1499, "user_id": 1372577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4819b4e5fd753e26319b41b632182e0?s=128&d=identicon&r=PG", "display_name": "Constantine Georgiou", "link": "https://stackoverflow.com/users/1372577/constantine-georgiou"}, "edited": false, "score": 1, "creation_date": 1475744536, "post_id": 39887663, "comment_id": 67069527, "body": "So your suggestion is just eliminate the Critical Section locking? Don&#39;t think this will do anything, as entering the critical section only 10 times plus one (yes, even that <code>g_sum = 0;</code> command the OP put in his main thread should have been put in a critical section as well) isn&#39;t really a big overhead, it&#39;s not even measurable actually."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1475728911, "creation_date": 1475728911, "answer_id": 39887663, "question_id": 39878970, "link": "https://stackoverflow.com/questions/39878970/summing-numbers-in-parallel-takes-twice-as-long-as-the-serial-version/39887663#39887663", "title": "Summing numbers in parallel takes twice as long as the serial version", "body": "<p>You have multiple threads accessing a single shared piece of memory with a lock around it.  All that locking, unlocking, context switching, cache hitting, etc adds up in time.  A serial loop in a single thread doesn't have to worry about that.</p>\n\n<p>I just recently watched a video (I'll try to find it and post it here) that explains a similar setup to yours and shows how giving each thread its own dedicated memory to operate on, and then accumulating the calculated values after the threads have finished running, can offer some significant improvements in performance.</p>\n\n<p>Try something more like this:</p>\n\n<pre><code>const LONGLONG UPPER = 1000000000;\nconst int NUM = 10; // number of threads\n\nstruct threadInfo\n{\n    LONGLONG start;\n    LONGLONG sum;\n};\n\nDWORD WINAPI SumThread(PVOID pvParam) {\n    struct threadInfo* pInfo = (struct threadInfo*) pvParam;\n    LONGLONG i, sum = 0, x = pInfo-&gt;start;\n\n    x *= (UPPER / NUM);\n\n    for (i = x + 1; i &lt;= x + UPPER / NUM; ++i) {\n        sum += i;\n    }\n\n    pInfo-&gt;sum = sum;\n    return 0;\n}\n\nstruct threadInfo* pInfo = (struct threadInfo*) malloc (sizeof(struct threadInfo) * NUM);\n\nHANDLE* hThreads = (HANDLE*) malloc(sizeof(HANDLE) * NUM);\n\nfor (int i = 0; i &lt; NUM; ++i) {\n    pInfo[i].start = i;\n    hThreads[i] = CreateThread(NULL, 0, SumThread, &amp;pInfo[i], 0, NULL);\n}\n\nWaitForMultipleObjects(NUM, hThreads, TRUE, INFINITE);\n\nLONGLONG sum = 0;\nfor (int i = 0; i &lt; NUM; ++i) {\n    sum += pInfo[i].sum;\n    CloseHandle(hThreads[i]);\n}\n\nfree(pInfo);\nfree(hThreads);\n</code></pre>\n"}], "owner": {"reputation": 2725, "user_id": 1317981, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1a8c0089b6bad61301334936fdc62b2?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1317981/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 2, "answer_count": 3, "score": 2, "last_activity_date": 1475728911, "creation_date": 1475683791, "question_id": 39878970, "link": "https://stackoverflow.com/questions/39878970/summing-numbers-in-parallel-takes-twice-as-long-as-the-serial-version", "title": "Summing numbers in parallel takes twice as long as the serial version", "body": "<p>I have a <code>const LONGLONG UPPER = 1000000000;</code> in my code, and I'm trying to calculate the sum of all the numbers from 1 to <code>UPPER</code> (yes, I know there's a formula for this).</p>\n\n<p>These are my globals:</p>\n\n<pre><code>const LONGLONG UPPER = 1000000000;\nconst int NUM = 10; // number of threads\nLONGLONG g_sum;\nCRITICAL_SECTION cs_sum;\n</code></pre>\n\n<p>This is my thread function:</p>\n\n<pre><code>DWORD WINAPI SumThread(PVOID pvParam) {\n    LONGLONG i;\n    LONGLONG sum = 0;\n    LONGLONG x = (LONGLONG)pvParam;\n\n    x = x * (UPPER / NUM);\n\n    for (i = x + 1; i &lt;= x + UPPER / NUM; i++) {\n        sum += i;\n    }\n\n    EnterCriticalSection(&amp;cs_sum);\n    g_sum += sum;\n    LeaveCriticalSection(&amp;cs_sum);\n\n    return 0;\n}\n</code></pre>\n\n<p>And this is the code I use to do the calculations:</p>\n\n<pre><code>HANDLE* hThreads = (HANDLE*)(malloc(sizeof(HANDLE) * NUM));\ng_sum = 0;\n\nInitializeCriticalSection(&amp;cs_sum);\nfor (i = 0; i &lt; NUM; i++) {\n    hThreads[i] = CreateThread(NULL, 0, SumThread, (PVOID)i, 0, NULL);\n}\n\nWaitForMultipleObjects(NUM, hThreads, TRUE, INFINITE);\nDeleteCriticalSection(&amp;cs_sum);\n</code></pre>\n\n<p>But I'm getting weird results: when I sum the numbers in a simple (serial) <code>for</code> loop, it's twice as fast as the multithreaded version. When I multiply <code>UPPER</code> by 10 and increase the number of threads to 40, the multithreaded version doesn't even stop (after 20 or so minutes). What's the reason for this?</p>\n"}, {"tags": ["c", "base64", "decode", "glib"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1475683385, "post_id": 39878788, "comment_id": 67044166, "body": "Have you allocated memory for <code>out_len</code>?"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1475683437, "post_id": 39878788, "comment_id": 67044194, "body": "<code>out_len</code> points nowhere. Replace <code>gsize *out_len;</code> with <code>gsize out_len;</code> and <code>g_base_64_decode(myString, out_len);</code> with <code>g_base_64_decode(myString, &amp;out_len);</code>"}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1475683503, "post_id": 39878788, "comment_id": 67044243, "body": "@squeamishossifrage: Post it an an answer!"}, {"owner": {"reputation": 673, "user_id": 5562199, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2619c0e7e0e48c2004991946d9c074e2?s=128&d=identicon&r=PG&f=1", "display_name": "unconditionalcoder", "link": "https://stackoverflow.com/users/5562199/unconditionalcoder"}, "edited": false, "score": 0, "creation_date": 1475683571, "post_id": 39878788, "comment_id": 67044288, "body": "This works thanks so much. post it and I will accept answer. stupid mistake on my part..haven&#39;t used C in a while :)"}], "answers": [{"tags": [], "owner": {"reputation": 37828, "user_id": 1629821, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/861cfc0de6bf99a544b500eac16229eb?s=128&d=identicon&r=PG", "display_name": "Mr.C64", "link": "https://stackoverflow.com/users/1629821/mr-c64"}, "is_accepted": true, "score": 2, "last_activity_date": 1475683611, "creation_date": 1475683611, "answer_id": 39878898, "question_id": 39878788, "link": "https://stackoverflow.com/questions/39878788/base-64-decode-returning-null-in-c/39878898#39878898", "title": "Base 64 decode returning NULL in C", "body": "<p>The <code>out_len</code> parameter is an <em>output</em> parameter. This means that you typically create an <code>out_len</code> variable of type <code>gsize</code> on the stack like this:</p>\n\n<pre><code>gsize out_len;\n</code></pre>\n\n<p>and then you call the function passing a <em>pointer</em> to the aforementioned variable (i.e. you pass the <em>address of</em> it: <code>&amp;out_len</code>), e.g.:</p>\n\n<pre><code>decoded = g_base_64_decode(myString, &amp;out_len);\n</code></pre>\n"}], "owner": {"reputation": 673, "user_id": 5562199, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2619c0e7e0e48c2004991946d9c074e2?s=128&d=identicon&r=PG&f=1", "display_name": "unconditionalcoder", "link": "https://stackoverflow.com/users/5562199/unconditionalcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "accepted_answer_id": 39878898, "answer_count": 1, "score": 0, "last_activity_date": 1475683611, "creation_date": 1475683261, "question_id": 39878788, "link": "https://stackoverflow.com/questions/39878788/base-64-decode-returning-null-in-c", "title": "Base 64 decode returning NULL in C", "body": "<p>I have a base 64 encoded string that I want to decode. \nIt looks like this:</p>\n\n<pre><code>VGhpcyBpcyBhIGZpbGUgdGhhdCBJIHdhbnQgdG8gZGVjb2Rl\n</code></pre>\n\n<p>when I do..</p>\n\n<pre><code>gsize *out_len;\nunsigned const char *decoded;\ndecoded = g_base_64_decode(myString, out_len);\n</code></pre>\n\n<p>and print out my decoded string, I get NULL also,  i get the assertion:\n'out_len != NULL' failed from Glib</p>\n\n<p>Why is this happening? How can I decode my string properly with this function? <a href=\"https://developer.gnome.org/glib/stable/glib-Base64-Encoding.html#g-base64-decode-step\" rel=\"nofollow\">https://developer.gnome.org/glib/stable/glib-Base64-Encoding.html#g-base64-decode-step</a></p>\n"}, {"tags": ["c", "pointers", "free"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475682120, "post_id": 39878298, "comment_id": 67043331, "body": "The problem here is that you are treating the data as an array of arrays (more precisely an array of pointers to other arrays, all dynamically allocated), and this is what makes it impossible to write a generic function. The only solution I can see is to use preprocessor macros instead (which I really don&#39;t like recommending)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475682173, "post_id": 39878298, "comment_id": 67043376, "body": "&quot;Free a pointer&quot; - You likely don&#39;t want to <code>free</code> the pointer, but the object <b>it points to</b>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1475682240, "post_id": 39878298, "comment_id": 67043420, "body": "@Olaf: Presumably &quot;freeing a pointer&quot; means passing a pointer value to <code>free()</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1475682338, "post_id": 39878298, "comment_id": 67043491, "body": "@KeithThompson: Using the correct terms - and being aware of them often can self-answer such questions."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475682417, "post_id": 39878298, "comment_id": 67043547, "body": "What for do you use those double-pointers? If that is for some 2D indexing, use a 2D array and simply <code>free(array);</code> it."}, {"owner": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475682482, "post_id": 39878298, "comment_id": 67043602, "body": "@Olaf it might be a jagged array rather than a straight-forward 2-d array."}, {"owner": {"reputation": 372, "user_id": 1751578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bbb7862a2b58e758448b737c243b57ba?s=128&d=identicon&r=PG", "display_name": "Pavithran Iyer", "link": "https://stackoverflow.com/users/1751578/pavithran-iyer"}, "reply_to_user": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1475682602, "post_id": 39878298, "comment_id": 67043673, "body": "@JohnColeman It&#39;s precisely that. The object A is not exactly a matrix since every A[i] is a pointer of different size."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1475682620, "post_id": 39878298, "comment_id": 67043688, "body": "@Olaf: 2D arrays are much less flexible. (BTW, I suggest avoiding the phrase &quot;double pointer&quot;; that would be a <code>double*</code>. &quot;Pointer to pointer&quot; is more accurate.)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1475682758, "post_id": 39878298, "comment_id": 67043783, "body": "@JohnColeman: That&#39;s why I had this part: &quot;If that is for some 2D indexing&quot; in my comment!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1475682879, "post_id": 39878298, "comment_id": 67043848, "body": "@KeithThompson: Read my comment above. Of course there applications for both. But as a long-term user here you well know how many posters use <code>**</code> pointers just because they don&#39;t know what a 2D array is, resp. how to declare them (and their teachers often also have no idea). A 2D array is fine unless you really need different lengths per entry (there might be advantages if the inner dimension can change, but that depends how clever memory allocation is)."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475683939, "post_id": 39878298, "comment_id": 67044527, "body": "@Olaf: How often, in real-world programs, do you need a 2D array with dimensions that have known fixed values when you write the program? How useful is an image manipulation program that can only handle a single fixed image size? Sure, it can happen, but that&#39;s not what the question is about. If someone asked about dealing with an integer variable, I wouldn&#39;t ask why they need a variable and suggest using a constant instead."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1475684079, "post_id": 39878298, "comment_id": 67044610, "body": "@KeithThompson: Are you aware the dimensions can be variables? Are you aware of VLAs? There is absolutely no problem with e.g. <code>int i = 5, j = 6, (*a)[i] = malloc(sizeof(*a) * j);</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1475684100, "post_id": 39878298, "comment_id": 67044620, "body": "I wrote up a solution that wouldn&#39;t depend on pointer representation or size -- and then I realized I was making assumptions about pointer representation and size. You have an array of <code>some_type*</code> in memory, and you need to convert each element (explicitly or implicitly) to <code>void*</code> so you can pass it to <code>free()</code>. There is no way to do that without knowing <i>at compile time</i> exactly what <code>some_type</code> is. The best you could do is pass a pointer to a wrapper function for <code>free()</code>, but that doesn&#39;t help much; you&#39;d still have to define a wrapper for each type."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475684181, "post_id": 39878298, "comment_id": 67044675, "body": "@Olaf: Are you aware that VLAs are an optional feature in C11?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1475684747, "post_id": 39878298, "comment_id": 67045061, "body": "@KeithThompson: They were mandatory in C99. It was a very bad decission and completely off the commitees&#39;s normal practice of maintaining compatibility. But then: which modern C11 compiler do you know which does not support VLAs, too?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475685951, "post_id": 39878298, "comment_id": 67045827, "body": "@Olaf: No, but this is off-topic for this question anyway."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475691502, "post_id": 39878298, "comment_id": 67048864, "body": "Not without passing a custom free function to the function."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475683428, "post_id": 39878642, "comment_id": 67044191, "body": "Minor: suggest <code>int iNdEx;</code> --&gt; <code>size_t iNdEx;</code>"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475689448, "post_id": 39878642, "comment_id": 67047763, "body": "After this line: <code>void **a = (void **) aptr;</code> if pointer aptr doesn&#39;t alias a pointer to a pointer to void, the behavior is undefined."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475697588, "post_id": 39878642, "comment_id": 67052325, "body": "@2501 This is why the answer refers to this as not maximally portable; that is what the text <i>&quot;additional assumption that we won&#39;t be bitten by strict aliasing assumptions in the optimizing compiler&quot;</i> refers to."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475697682, "post_id": 39878642, "comment_id": 67052365, "body": "How do you determine whether you &#39;were bitten&#39;? It is impossible. You cannot reason like that with undefined behavior. Your answer hints as if the program is just less portable or something like that, when in reality it is completely broken."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475699182, "post_id": 39878642, "comment_id": 67053173, "body": "@2501 Without a demonstrated failing test case (supported platform, compiler and its invocation, on a surrounding complete driver program with a <code>main</code>) that is only a uselessly austere academic opinion which doesn&#39;t add anything to the existing acknowledgement of the code&#39;s ISO C status. (&quot;Supported platform&quot; means: anything which has same-sized pointers of all types with the same bitwise representation.)"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475699895, "post_id": 39878642, "comment_id": 67053550, "body": "@2501 How you we determine that we weren&#39;t bitten? For example, we can conduct a code review of the generated machine code. Firstly, to be on the safe side, I&#39;d put that function into its own translation unit, and ensure there are no whole program optimizations used. I&#39;d check that, by golly, the compiled function really is marching through the array, and passing each pointer word to an external call to the <code>free</code> function. Then I&#39;d look at the calls to the function, to see that they are passing in the arrays properly, and that all pointers have been committed to the arrays prior to the call."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475700004, "post_id": 39878642, "comment_id": 67053598, "body": "@2501 A complementary approach would be to research the documentation for the supported compilers regarding how they deal with such aliasing cases: which formally undefined aliasing cases are actual threats to correctness and which are benign, and what code generation options influence this and how."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475700144, "post_id": 39878642, "comment_id": 67053662, "body": "@2501 Then of course there is testing, including testing with tools. If a malloc debugging tool reports no leaks at the end of the program, it gives us confidence that the free loop marched through the right pointers. A tool like Valgrind can give us confidence that no memory is being misused. Then we of course have functional tests for the program&#39;s specified behaviors."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475700596, "post_id": 39878642, "comment_id": 67053883, "body": "UB is real and it happens. Cases where such code (&#39;generic&#39; void**) failed after years of working just fine, exist. The correct way of fixing undefined behavior is at it source (no pun intended), which is the source code. Any other approach doomed at the start, and worse, retains undefined behavior. Ok let&#39;s say you did all of the things you mention (including checking the (entire?) generated binary, which is ridiculous, but fine). The undefined behavior is still there. At any new release of the compiler may break the code. Any new hardware may break the code."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475703257, "post_id": 39878642, "comment_id": 67055027, "body": "@2501 &gt; <i>UB is real and it happens</i>.  I completely agree; for instance, UB happens every time the program relies on a documented language extension. (This isn&#39;t necessarily one, but <i>can</i> be with features like GCC&#39;s <code>-fno-strict-aliasing</code>)"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475703858, "post_id": 39878642, "comment_id": 67055289, "body": "No. UB does not happen everytime an extension is used. Read the third paragraph: <a href=\"http://programmers.stackexchange.com/a/99741\">programmers.stackexchange.com/a/99741</a>"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475705198, "post_id": 39878642, "comment_id": 67055756, "body": "@2501 You&#39;re confusing the normative term <i>undefined behavior</i> from ISO C (as I am using it) which refers to the absence of a requirement in that document, with &quot;behavior not defined by anyone at all&quot;. (Thus if the compiler produces a predictable, documented dialog box where you can click OK to accept a value of zero when a division by zero occurs, it is no longer undefined because someone somewhere defined it. However, <b>ISO C</b> still doesn&#39;t define it; it makes no mention of such a dialog box.)"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1475705763, "post_id": 39878642, "comment_id": 67055949, "body": "@2501 You can&#39;t be a proper ISO C pedant, if your definition of <i>undefined behavior</i> is that loose! If <i>defined</i> means &quot;by anyone at all&quot;, then if I get the correct machine language that I wanted, it&#39;s defined! The compiler writer defined it, through their choice of code generating strategy. There is no leg to stand on to call it &quot;completely broken&quot;.  It can only be &quot;completely broken&quot; if we regard <i>ISO C defined</i> behavior as the be-all and end-all of program correctness (not any other defined behavior)."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1552681915, "post_id": 39878642, "comment_id": 97118875, "body": "@Kaz: A fundamental problem with the Standard and UB is that the Standard offers no guidance about what should be expected in cases where an implementation describes the behavior of some actions in more detail than required by the Standard, but the Standard categorizes an overlapping category of actions as invoking UB.  Compiler writers used to view if as so blindingly obvious that implementation that describe a behavior should generally behave as described even if the Standard says they aren&#39;t required to define the behavior, that they seldom bothered to explicitly say that."}], "tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": false, "score": 7, "last_activity_date": 1475684985, "last_edit_date": 1475684985, "creation_date": 1475682848, "answer_id": 39878642, "question_id": 39878298, "link": "https://stackoverflow.com/questions/39878298/free-all-the-space-allocated-for-a-pointer-to-pointer-without-knowing-its-type/39878642#39878642", "title": "Free all the space allocated for a pointer-to-pointer, without knowing its type", "body": "<p>If you want to punctiliously adhere to the ISO C standard's definition of what is maximally portable, there is no way to do this without repetitive coding. We can roll the logic into a single function, but that function will need some sort of switch on an integer variable indicating the type, so it can access the <code>type **</code> pointer correctly as the correct type.</p>\n\n<p>We can drop maximal portability and just assume that all pointers have the same representation. (Plus the additional assumption that we won't be bitten by strict aliasing assumptions in the optimizing compiler.) Then we can write it like this:</p>\n\n<pre><code>void free_array(void *aptr, size_t nelem) {\n    void **a = (void **) aptr;\n    while (nelem--)\n      free(*a++);\n    free(aptr);\n}\n</code></pre>\n\n<p>Another alternative is to use a macro:</p>\n\n<pre><code>#define GEN_AFREE(name, type)                   \\\n   void afree_ ## name (type **a, size_t nelem) \\\n   {                                            \\\n     [...]                                      \\\n   }\n\nGEN_FREE_ARRAY_FUN(int, int)\nGEN_FREE_ARRAY_FUN(double, double)\nGEN_FREE_ARRAY_FUN(string, char)\n</code></pre>\n\n<p>Or instead of a defining macro, we could just make a macro that encapsulates looping over an array and calling free:</p>\n\n<pre><code>#define FREE_ARRAY(array, size) do {         \\\n  size_t iNdEx;                              \\\n  for (iNdEx = 0; iNdEx &lt; (size); iNdEx++)   \\\n    free((array)[iNdEx]);                    \\\n  free(array);                               \\\n} while (0)\n</code></pre>\n"}], "owner": {"reputation": 372, "user_id": 1751578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bbb7862a2b58e758448b737c243b57ba?s=128&d=identicon&r=PG", "display_name": "Pavithran Iyer", "link": "https://stackoverflow.com/users/1751578/pavithran-iyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1475684985, "creation_date": 1475681838, "last_edit_date": 1475682764, "question_id": 39878298, "link": "https://stackoverflow.com/questions/39878298/free-all-the-space-allocated-for-a-pointer-to-pointer-without-knowing-its-type", "title": "Free all the space allocated for a pointer-to-pointer, without knowing its type", "body": "<p>I have a C program which uses a few pointers such as <code>int **</code>, <code>float **</code>, <code>double **</code>, <code>long **</code>, etc.  At the end, I want to free the space that was allocated for them.</p>\n\n<p>To modularize things, I have a function that can take an object of the form <em>pointer-to-pointer</em> and free the memory space allocated for it. For instance, the following, for a variable of type <code>int **</code>.</p>\n\n<pre><code>void FreeIntArray(int **A, int length){\n    int i;\n    for (i = 0; i &lt; length; i ++)\n       free(A[i]);\n    free(A);\n}\n</code></pre>\n\n<p>However, to free a variable of the form <code>float **</code> or <code>double **</code>, I need to write another function that is almost a carbon copy of the one above, except changing <code>int **</code> to <code>float **</code> in the function definition.</p>\n\n<p>Is a way to design a single function that can free space allocated to any of the following datatypes: <code>int **</code>, <code>float **</code>, <code>double **</code>, <code>long **</code> ?</p>\n"}, {"tags": ["c", "arrays", "printing"], "comments": [{"owner": {"reputation": 4168, "user_id": 6273251, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fCGXep-7snc/AAAAAAAAAAI/AAAAAAAAADk/nk_YDFGfkc0/photo.jpg?sz=128", "display_name": "Random Davis", "link": "https://stackoverflow.com/users/6273251/random-davis"}, "edited": false, "score": 1, "creation_date": 1475681087, "post_id": 39877979, "comment_id": 67042684, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1690428/finding-max-number-in-an-array-c-programming\">Finding Max Number in an Array C Programming</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1475681494, "post_id": 39877979, "comment_id": 67042941, "body": "Indexes start from 0 in C. Not accepting this is not just waste of memory, but also confusing and error-prone."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1475681621, "post_id": 39877979, "comment_id": 67043021, "body": "Apart from not starting your array at index 0 (which BTW doesen&#39;t have any impact here) your program works fine on my computer."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1475681673, "post_id": 39877979, "comment_id": 67043053, "body": "What output do you get for what input ?"}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1475697015, "post_id": 39877979, "comment_id": 67052043, "body": "Please accept the answer that has helped the most. Doing so encourages users to keep helping others by being rewarded with reputation points."}], "answers": [{"comments": [{"owner": {"reputation": 5718, "user_id": 15068, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7f2aa13cefa67afd0c908bf3b58a5aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Friedrich", "link": "https://stackoverflow.com/users/15068/friedrich"}, "reply_to_user": {"reputation": 33, "user_id": 6927253, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh3.googleusercontent.com/-oMhqCmwdnkw/AAAAAAAAAAI/AAAAAAAAAIg/eITFxLXmwK0/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/6927253/john"}, "edited": false, "score": 0, "creation_date": 1475698326, "post_id": 39878692, "comment_id": 67052705, "body": "Sorry I don&#39;t think so. What is the output? What&#39;s the content of smallestInput? What is the code you really do have?"}, {"owner": {"reputation": 5718, "user_id": 15068, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7f2aa13cefa67afd0c908bf3b58a5aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Friedrich", "link": "https://stackoverflow.com/users/15068/friedrich"}, "reply_to_user": {"reputation": 33, "user_id": 6927253, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh3.googleusercontent.com/-oMhqCmwdnkw/AAAAAAAAAAI/AAAAAAAAAIg/eITFxLXmwK0/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/6927253/john"}, "edited": false, "score": 0, "creation_date": 1475824506, "post_id": 39878692, "comment_id": 67107509, "body": "Prosen Ghosh has used nearly exactly that code and that  just works as it should So the code is quite ok"}], "tags": [], "owner": {"reputation": 5718, "user_id": 15068, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7f2aa13cefa67afd0c908bf3b58a5aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Friedrich", "link": "https://stackoverflow.com/users/15068/friedrich"}, "is_accepted": false, "score": 0, "last_activity_date": 1475683001, "creation_date": 1475683001, "answer_id": 39878692, "question_id": 39877979, "link": "https://stackoverflow.com/questions/39877979/c-language-how-to-print-out-the-largest-number-inputted-into-an-array/39878692#39878692", "title": "C language- How to print out the largest number inputted into an array?", "body": "<p>Pseudo-code. Keep two extra variables. \nlong largestInput, smalltestInput.</p>\n\n<p>set \nlargestInput = smalltestInput  = age[0];</p>\n\n<pre><code>for (i = 0; i &lt; 10; i++) {\n  if age[i]&gt; largestInput{\n     largestInput = age[i];\n  }\n  if age[i] &lt; smallestInput {\n      smalltestInput = age[i];\n  }\n}\n</code></pre>\n\n<p>Print it as you like</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 6927253, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh3.googleusercontent.com/-oMhqCmwdnkw/AAAAAAAAAAI/AAAAAAAAAIg/eITFxLXmwK0/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/6927253/john"}, "edited": false, "score": 0, "creation_date": 1475689441, "post_id": 39878716, "comment_id": 67047758, "body": "I&#39;m just curious as to what  #include &lt;limits.h&gt; means. We have notgone on to using that yet, is there another work around way of doing it? Thanks so much!"}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "reply_to_user": {"reputation": 33, "user_id": 6927253, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh3.googleusercontent.com/-oMhqCmwdnkw/AAAAAAAAAAI/AAAAAAAAAIg/eITFxLXmwK0/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/6927253/john"}, "edited": false, "score": 0, "creation_date": 1475689495, "post_id": 39878716, "comment_id": 67047777, "body": "@davidbrogan It provides the INT_MIN and INT_MAX macros/defines."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "reply_to_user": {"reputation": 33, "user_id": 6927253, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh3.googleusercontent.com/-oMhqCmwdnkw/AAAAAAAAAAI/AAAAAAAAAIg/eITFxLXmwK0/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/6927253/john"}, "edited": false, "score": 0, "creation_date": 1475692959, "post_id": 39878716, "comment_id": 67049710, "body": "@davidbrogan You could set large = -1 and small = 9999999 and not use INT_MIN or INT_MAX and not include limits.h"}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "reply_to_user": {"reputation": 33, "user_id": 6927253, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh3.googleusercontent.com/-oMhqCmwdnkw/AAAAAAAAAAI/AAAAAAAAAIg/eITFxLXmwK0/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/6927253/john"}, "edited": false, "score": 0, "creation_date": 1475693435, "post_id": 39878716, "comment_id": 67050004, "body": "@davidbrogan I modified the code to not use limits.h."}], "tags": [], "owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "is_accepted": false, "score": 0, "last_activity_date": 1475693345, "last_edit_date": 1475693345, "creation_date": 1475683079, "answer_id": 39878716, "question_id": 39877979, "link": "https://stackoverflow.com/questions/39877979/c-language-how-to-print-out-the-largest-number-inputted-into-an-array/39878716#39878716", "title": "C language- How to print out the largest number inputted into an array?", "body": "<p>Your code works fine on my system. I've modified your code to not be Windows specific and shown you how to calculate the smallest and largest of the numbers entered. The idea is to constantly compare the current entry to the current smallest and largest number and change smallest and largest as needed. The code below also shows how to start at array index 0.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\nint main()\n{\n    int age[10];\n    float total = 0;\n    int i = 0;\n    float average;\n    int large = -9999;\n    int small = 9999;\n\n    do\n    {\n        printf(\"# %d: \", i+1);\n        scanf(\"%d\", &amp;age[i]);       \n        total = (total + age[i]);\n\n        if( age[i] &lt; small )\n        {\n            small = age[i];\n        }\n\n        if( age[i] &gt; large )\n        {\n            large = age[i];\n        }\n\n        i++;\n\n    } while (i &lt; 10);\n\n    average = (total / 10.00);\n    printf(\"Smallest = %d Largest = %d \\n\", small, large);\n    printf(\"Average = %.2f\\n\", average);\n}\n\n\n# 1: 30\n# 2: 40\n# 3: 50\n# 4: 2\n# 5: 3\n# 6: 4\n# 7: 6\n# 8: -1\n# 9: 4\n# 10: 5\nSmallest = -1 Largest = 50 \nAverage = 14.30\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 615, "user_id": 3290456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K2UY4.jpg?s=128&g=1", "display_name": "Prosen Ghosh", "link": "https://stackoverflow.com/users/3290456/prosen-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1475692390, "last_edit_date": 1475692390, "creation_date": 1475691533, "answer_id": 39881111, "question_id": 39877979, "link": "https://stackoverflow.com/questions/39877979/c-language-how-to-print-out-the-largest-number-inputted-into-an-array/39881111#39881111", "title": "C language- How to print out the largest number inputted into an array?", "body": "<p><strong>I think it will be helpful.</strong>\nFor decimal point you have to declare your <strong>array</strong> as <code>float</code>.\n<strong>FLT_MAX</strong> These macros define maximum value of a <code>float</code>. Before useing <strong>FLT_MAX</strong> you should <code>inclue</code> <strong>float.h</strong> header file.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;float.h&gt;\n\nint main(void)\n{\nfloat age[11];\nfloat total = 0;\nint i = 1;\nfloat average;\nfloat largestInput = 0.0;\nfloat smallestInput = FLT_MAX;\n\ndo\n{\n    printf(\"# %d: \", i);\n    scanf(\"%f\", &amp;age[i]);\n    total = total + age[i];\n    //here i am checking the largest input\n    if (age[i]&gt; largestInput){\n     largestInput = age[i];\n    }\n    //here i am checking the smallest input\n    if (age[i] &lt; smallestInput) {\n      smallestInput = age[i];\n    }\n    i = i + 1;\n} while (i &lt;= 10);\n\naverage = (total / 10);\nprintf(\"Average = %.2f\\n\", average);\nprintf(\"Largest Input Is = %.2f\\n\", largestInput);\nprintf(\"Smallest Input IS = %.2f\", smallestInput);\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6927253, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh3.googleusercontent.com/-oMhqCmwdnkw/AAAAAAAAAAI/AAAAAAAAAIg/eITFxLXmwK0/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/6927253/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1475693345, "creation_date": 1475680936, "last_edit_date": 1475686449, "question_id": 39877979, "link": "https://stackoverflow.com/questions/39877979/c-language-how-to-print-out-the-largest-number-inputted-into-an-array", "title": "C language- How to print out the largest number inputted into an array?", "body": "<p>I want to be able to print out the largest age inputted by the user as well as the smallest age. </p>\n\n<p>Also, I noticed my program doesn't include the numbers after the decimal point. It would just say 25.00 for example, rather than 25.25.</p>\n\n<p>Any help is greatly appreciated!</p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"stdio.h\"\n\nvoid main()\n{\nint age[11];\nfloat total = 0;\nint i = 1;\nfloat average;\n\ndo\n{\n    printf(\"# %d: \", i);\n    scanf_s(\"%d\", &amp;age[i]);\n    total = (total + age[i]);\n    i = i + 1;\n\n} while (i &lt;= 10);\n\naverage = (total / 10);\nprintf(\"Average = %.2f\", average);\n}\n</code></pre>\n"}, {"tags": ["c", "cs50", "vigenere", "edx"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475681846, "post_id": 39877973, "comment_id": 67043161, "body": "I cannot reproduce this for your input <code>aaaa</code> and <code>bbbbbbb</code>, although I am not using any <code>string</code> type, just assigning <code>char *k = argv[1];</code> and <code>char *code = argv[2];</code> the rest is as you posted. I suggest you print out the value of <code>int klen = strlen(k);</code>"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1475682208, "post_id": 39877973, "comment_id": 67043393, "body": "I think that your third printf should be <code>printf(&quot;%c&quot;, (((code[a] - &#39;a&#39;) + (k[b%klen] - &#39;A&#39;))%26) + &#39;a&#39;);</code>."}, {"owner": {"reputation": 26, "user_id": 6916836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2427a26f1a6a7d6f07c11c03067eec38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGuire", "link": "https://stackoverflow.com/users/6916836/michael-mcguire"}, "edited": false, "score": 0, "creation_date": 1475682520, "post_id": 39877973, "comment_id": 67043626, "body": "Bob, thanks for that. That was definitely part of the issue. I have updated my code, but now instead of <code>bbbbbNN</code> I&#39;m getting <code>bbbbbhh</code> I still seem to be having trouble with wrapping the key around the code"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475682753, "post_id": 39877973, "comment_id": 67043780, "body": "The example does not have any uppercase letters for the key, so I did not get a wrong output. But I still ask: what is the value of <code>klen</code> for the key <code>aaaa</code>?"}, {"owner": {"reputation": 26, "user_id": 6916836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2427a26f1a6a7d6f07c11c03067eec38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGuire", "link": "https://stackoverflow.com/users/6916836/michael-mcguire"}, "edited": false, "score": 0, "creation_date": 1475684006, "post_id": 39877973, "comment_id": 67044564, "body": "The value of <code>klen</code> is <code>4</code> with that input"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1475684283, "post_id": 39877973, "comment_id": 67044742, "body": "I can&#39;t reproduce your issue. <a href=\"https://ideone.com/r8DYrg\" rel=\"nofollow noreferrer\">Here</a>, with the same logic but different input method."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1475684314, "post_id": 39877973, "comment_id": 67044762, "body": "Over here the key index does wrap. With inputs <code>abcd</code> and <code>bbbbbbbbb</code> I get the output <code>bcdebcdeb</code> and as I said too, different input method."}, {"owner": {"reputation": 26, "user_id": 6916836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2427a26f1a6a7d6f07c11c03067eec38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGuire", "link": "https://stackoverflow.com/users/6916836/michael-mcguire"}, "edited": false, "score": 0, "creation_date": 1475684748, "post_id": 39877973, "comment_id": 67045062, "body": "From both of your responses it seems that my <code>for loop</code> is fine, and the problem lies somewhere with my string, seeing as how you&#39;ve both used <code>char</code> instead"}], "answers": [{"comments": [{"owner": {"reputation": 26, "user_id": 6916836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2427a26f1a6a7d6f07c11c03067eec38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGuire", "link": "https://stackoverflow.com/users/6916836/michael-mcguire"}, "edited": false, "score": 0, "creation_date": 1475687821, "post_id": 39879571, "comment_id": 67046845, "body": "Thanks for the response. I&#39;m still very new to this and don&#39;t understand some of what you wrote, but I&#39;ll try to get the key set before the code and see what happens."}, {"owner": {"reputation": 26, "user_id": 6916836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2427a26f1a6a7d6f07c11c03067eec38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGuire", "link": "https://stackoverflow.com/users/6916836/michael-mcguire"}, "edited": false, "score": 0, "creation_date": 1475696810, "post_id": 39879571, "comment_id": 67051922, "body": "I&#39;ve taken your advice and processed they key outside of the code loop and it works! It&#39;s still a little messy and can be simplified but at least it works now, and I can work on improving the efficiency of it. Thanks again."}], "tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": true, "score": 0, "last_activity_date": 1475685906, "creation_date": 1475685906, "answer_id": 39879571, "question_id": 39877973, "link": "https://stackoverflow.com/questions/39877973/vigenere-cipher-code-output/39879571#39879571", "title": "Vigenere Cipher. Code output", "body": "<p>Your biggest risk with code like this is all the similar, repetitive clauses.  A bug in just one is hard to track done.  And doing any processing on the key, while processing the code, is just inefficient.</p>\n\n<p>Here's a rework that completely processes the key before processing the code and tries to get the processing down to just one case.  See if it works any better for you:</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, string argv[])\n{\n\n    if (argc != 2)\n    {\n        fprintf(stderr, \"Try again\\n\");\n        return EXIT_FAILURE;\n    }\n\n    string key = strdup(argv[1]);\n\n    size_t key_length = strlen(key);\n\n    for (int x = 0; x &lt; key_length; x++)\n    {\n        if (isalpha(key[x]))\n        {\n            if (isupper(key[x]))\n            {\n                key[x] = tolower(key[x]);\n            }\n\n            key[x] -= 'a';\n        }\n        else\n        {\n            fprintf(stderr, \"Try again\\n\");\n            return EXIT_FAILURE;\n        }\n    }\n\n    string code = GetString();\n    int code_length = strlen(code);\n\n    for (int a = 0, b = 0; a &lt; code_length; a++)\n    {\n        if (isalpha(code[a]))\n        {\n            int start = isupper(code[a]) ? 'A' : 'a';\n\n            printf(\"%c\", (((code[a] - start) + key[b++ % key_length]) % 26) + start);\n        }\n        else\n        {\n            printf(\"%c\", code[a]);\n        }\n    }\n\n    printf(\"\\n\");\n\n    free(key);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 26, "user_id": 6916836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2427a26f1a6a7d6f07c11c03067eec38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGuire", "link": "https://stackoverflow.com/users/6916836/michael-mcguire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 39879571, "answer_count": 1, "score": -1, "last_activity_date": 1520346956, "creation_date": 1475680910, "last_edit_date": 1520346956, "question_id": 39877973, "link": "https://stackoverflow.com/questions/39877973/vigenere-cipher-code-output", "title": "Vigenere Cipher. Code output", "body": "<p>I've been working on cs50 pset2, and I thought I had the vigenere cipher down after working on it for a few days. This code is meant to take an alphabetical argument(argv[]) given by the user, and use that as a key to crypt a phrase given by the user(string) by its number in the alphabetical index. For example, if you give the argument 'abc' and the string 'cat' then the output should be 'cbv'(a moving 0, b moving 1, c moving 2) The argument should also wrap around so that if the string is longer, the argument will wrap to its first character and continue until the string has ended.</p>\n\n<p>This is what I have for code:</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n\nint main(int argc, string argv[])\n{\n\n\n    if(argc != 2)\n        {\n            printf(\"Try again\\n\");\n            return 1;\n        }\n    string k = (argv[1]);\n\n    int klen = strlen(k);\n\n\n    for(int x = 0; x &lt; klen; x++)\n        {\n            if(isalpha(k[x]))\n                {\n                    if(isupper(k[x]))\n                        {\n                            k[x] = tolower(k[x]);\n                        }\n\n                        k[x] -= 'a';\n                }\n            else\n                {\n                    printf(\"Try again\\n\");\n                    return 1;\n                }\n        }\n\n    string code = GetString();\n\n    int clen = strlen(code);\n\n    for(int a = 0, b = 0; a &lt; clen; a++)\n        {\n            if(isalpha(code[a]))\n                {\n                    int key = k[b%klen];\n                    if(isupper(code[a]))\n                        {\n                            printf(\"%c\", (((code[a] - 'A') + key)%26) + 'A');\n                            b++;\n                        }\n                    else\n                        {\n                            printf(\"%c\", (((code[a] - 'a') + key)%26) + 'a');\n                            b++;\n                        }\n                }\n            else\n                {\n                    printf(\"%c\", code[a]);\n                }\n        }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>The code seems to work for the length of the key +1.\nFor example,\nI input an argument of 'aaaa'</p>\n\n<p>Then input a string of 'bbbbb'\nand receive 'bbbbb' correctly.</p>\n\n<p>However, if I input the same 'aaaa' </p>\n\n<p>Then input a string longer than the key +1 'bbbbbbb'\nI receive 'bbbbbNN'</p>\n\n<p>I believe I have an issue with my order of operations but have tried moving parenthesis around to no avail. I was hoping someone could point me in the right direction as to why my key isn't wrapping properly.</p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1475681130, "post_id": 39877882, "comment_id": 67042708, "body": "you will have more control over what happens if you catch the Ctrl+C signal in a custom handler."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1475681578, "post_id": 39877882, "comment_id": 67043001, "body": "<code>request.record[strlen(request.record)] =&#39;\\0&#39;;</code> doesn&#39;t make sense... it places a null character at the location of the first existing null character."}, {"owner": {"reputation": 2573, "user_id": 1101537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1087a838de98ff53402c4a0e9ab9b990?s=128&d=identicon&r=PG", "display_name": "alexander", "link": "https://stackoverflow.com/users/1101537/alexander"}, "edited": false, "score": 0, "creation_date": 1475681591, "post_id": 39877882, "comment_id": 67043005, "body": "Can you post server log, so we can see messages produced by your code. Error can be either in client code (it send packet on termination) or in server code (it incorrectly detect client termination and print previous packet)."}, {"owner": {"reputation": 2573, "user_id": 1101537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1087a838de98ff53402c4a0e9ab9b990?s=128&d=identicon&r=PG", "display_name": "alexander", "link": "https://stackoverflow.com/users/1101537/alexander"}, "edited": false, "score": 0, "creation_date": 1475681660, "post_id": 39877882, "comment_id": 67043045, "body": "<code>request.record[strlen(request.record)] =&#39;\\0&#39;;</code> more over it is possible to send request without &#39;\\0&#39; and get server segfault."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1475691145, "post_id": 39877882, "comment_id": 67048693, "body": "&quot;<i>Connection closed</i>&quot; should read &quot;<i>recv() failed</i>&quot;. &quot;<i>Connection closed [by peer]</i>&quot; should be logged if <code>0</code> bytes had been &quot;received&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1599763657, "last_edit_date": 1599763657, "creation_date": 1475681684, "answer_id": 39878236, "question_id": 39877882, "link": "https://stackoverflow.com/questions/39877882/when-client-shutdown-by-pressing-ctrlc-the-server-continuously-process-previous/39878236#39878236", "title": "When client shutdown by pressing Ctrl+c the server continuously process previous input. Why?", "body": "<ul>\n<li>Function <code>ReceiveRequestMessage()</code> returns the value of its variable <code>disconnect</code>.</li>\n<li>That variable is set nonzero only if <code>recv()</code> returns <code>0</code>.</li>\n<li>The documentation for <code>recv()</code> promises a return value of <code>0</code> only for the case that the remote end performs an orderly shutdown (and no more data are available to receive).  It will definitely return <code>-1</code>, not <code>0</code>, if an error occurs.</li>\n<li>It is not safe to assume that the client will perform an orderly shutdown every time it effectively disconnects, and in particular, it is not safe to assume that it will perform one when it is killed by a signal, as happens when you send it a Ctrl+c.</li>\n<li>If <code>ReceiveRequestMessage()</code> returns <code>0</code> without modifying the object pointed to by its <code>pRequest</code> parameter, then it will appear to the caller that the previously-sent request was repeated.  This is what you are observing.</li>\n</ul>\n"}], "owner": {"reputation": 201, "user_id": 3787962, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/292b1c795a77fb9929fe71de1adcd375?s=128&d=identicon&r=PG&f=1", "display_name": "mr.Cracker", "link": "https://stackoverflow.com/users/3787962/mr-cracker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1599763657, "creation_date": 1475680643, "last_edit_date": 1475683165, "question_id": 39877882, "link": "https://stackoverflow.com/questions/39877882/when-client-shutdown-by-pressing-ctrlc-the-server-continuously-process-previous", "title": "When client shutdown by pressing Ctrl+c the server continuously process previous input. Why?", "body": "<p>I have a client server program in C. Client send the command while server receives it. </p>\n\n<p>But if client shutdown by pressing <kbd>Ctrl</kbd>+<kbd>C</kbd>  the server application process the previous input.</p>\n\n<h2>Example.</h2>\n\n<pre><code>CLient.c                                Server.c\n-------------------------------------------------\nEnter COmmand: adf                     Command from client: adf\n\nEnter COmmand: bbb                     Command from client: bbb\n\nEnter Command: Ctrl+c                  Command from client: bb\n</code></pre>\n\n<hr>\n\n<p>I don't understand why it process the previous input.</p>\n\n<p>Given below is my main logic.</p>\n\n<pre><code>main(){\n\n    // bind, listen, accept is done.\n\n            while(!done &amp;&amp; !shutFlag){      //  Main server command Loop\n        done = ReceiveRequestMessage(&amp;request, connectedSock );\n        if(done)\n        {\n            printf(\"Client closed the connection while recv() \\n\");\n            printf(\"Listening for new client connection to establish... \\n\");\n            connectedSock = accept(srvSock, (struct sockaddr *)&amp;connectSAddr, &amp;addrLen );\n            printf(\"GetLastError: %d\\n\", GetLastError());\n            done = FALSE;\n            continue;\n\n        }\n\n        request.record[strlen(request.record)] ='\\0';\n        commandLen = strcspn(request.record, \"\\n\\t\");\n        memcpy(sysCommand, request.record, commandLen);\n        sysCommand[commandLen] = '\\0';\n\n        printf(\"Request recieved from client: %s -&gt; Hex: %X\\n\\n\", request.record, *(request.record));\n    }\n\n}\n</code></pre>\n\n<p><code>ReceiveRequestMessage</code> Function: </p>\n\n<pre><code>static BOOL ReceiveRequestMessage(REQUEST *pRequest, SOCKET sd){\n    LONG32 nRemainRecv = 0, nRecv;\n    LPBYTE pBuffer;\n    BOOL disconnect = FALSE;\n\n    nRemainRecv = RQ_HEADER_LEN;\n    pBuffer = (LPBYTE) pRequest;\n    while(nRemainRecv &gt; 0 &amp;&amp;  !disconnect )\n    {\n        nRecv = recv (sd, pBuffer, nRemainRecv, 0); // Reading the 1st 4 bytes(length of record)to pRequest.\n        if ( nRecv &gt; 0 )\n            printf(\"Bytes received in request.rqLen: %d\\n\", nRecv);\n        else if ( nRecv == SOCKET_ERROR ){\n            printf(\"Connection closed\\n\");\n            return TRUE;\n        }\n\n        disconnect = (nRecv == 0);      // check connection is closed \n        nRemainRecv -= nRecv;\n        pBuffer += nRecv;       \n    }\n\n    /*  Read the request record */\n    nRemainRecv = pRequest-&gt;rqLen;\n    /* Exclude buffer overflow */\n    nRemainRecv = min(nRemainRecv, MAX_RQRS_LEN);\n\n    pBuffer = (LPSTR)pRequest-&gt;record;  \n    while(nRemainRecv &gt; 0 &amp;&amp; !disconnect)\n    {\n        nRecv = recv(sd, pBuffer, nRemainRecv, 0);\n        if(nRecv &gt; 0)\n            printf(\"Bytes Received in request.record: %d\\n\", nRecv);\n        else if(nRecv == SOCKET_ERROR){\n            printf(\"Connection closed\");\n            return TRUE;\n        }\n\n        disconnect = (nRecv == 0);          // check connection is closed \n        nRemainRecv -= nRecv;\n        pBuffer += nRecv;       \n    }\n\n    return disconnect;\n}\n</code></pre>\n\n<p>How can I eliminate the last print statement after clicking <kbd>Ctrl</kbd>+<kbd>C</kbd> in client?</p>\n\n<p>Means:</p>\n\n<p>Whenever Client disconnects by clicking <kbd>Ctrl</kbd>+<kbd>C</kbd> or in any way. How can I notify Server?</p>\n"}, {"tags": ["c", "glibc", "backtrace"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1475680681, "post_id": 39877836, "comment_id": 67042413, "body": "It seems that <code>backtrace</code> also calls <code>malloc</code> and so you have an infinite recursion. Also is the output of <code>printf(&quot;to malloc a!\\n&quot;);</code> there?"}, {"owner": {"reputation": 4168, "user_id": 6273251, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fCGXep-7snc/AAAAAAAAAAI/AAAAAAAAADk/nk_YDFGfkc0/photo.jpg?sz=128", "display_name": "Random Davis", "link": "https://stackoverflow.com/users/6273251/random-davis"}, "edited": false, "score": 0, "creation_date": 1475680775, "post_id": 39877836, "comment_id": 67042474, "body": "Have you tried using a debugger to step through the code?"}, {"owner": {"reputation": 555, "user_id": 6785719, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/81e5943f52540ee336f631da4ffd6f53?s=128&d=identicon&r=PG&f=1", "display_name": "Weiheng Li", "link": "https://stackoverflow.com/users/6785719/weiheng-li"}, "edited": false, "score": 0, "creation_date": 1475680780, "post_id": 39877836, "comment_id": 67042477, "body": "Could you tell me the reason?:&lt;"}, {"owner": {"reputation": 555, "user_id": 6785719, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/81e5943f52540ee336f631da4ffd6f53?s=128&d=identicon&r=PG&f=1", "display_name": "Weiheng Li", "link": "https://stackoverflow.com/users/6785719/weiheng-li"}, "edited": false, "score": 0, "creation_date": 1475680920, "post_id": 39877836, "comment_id": 67042572, "body": "How to use debugger. seems I didn&#39;t use that before. I use terminal to run it directly"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475681316, "post_id": 39877836, "comment_id": 67042820, "body": "The names in the standard library are reserved for a hosted environment. You must not use them in user code."}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 2, "last_activity_date": 1475681842, "creation_date": 1475681842, "answer_id": 39878302, "question_id": 39877836, "link": "https://stackoverflow.com/questions/39877836/backtrace-falls-into-endless-recursion/39878302#39878302", "title": "backtrace() falls into endless recursion?", "body": "<p><code>backtrace()</code> calls <code>malloc()</code>. There's a recursive call to your hook malloc funcion. This is a known issue. In order to use backtrace() from with malloc(), you can setup a flag that indicates it was called from within your hooked function and if so, allocate and return the memory requested by using a different mechanism other than malloc() such as using <code>mmap()</code>, <code>brk()</code> etc.</p>\n\n<p>Also see: <a href=\"https://sourceware.org/ml/libc-alpha/2015-02/msg00653.html\" rel=\"nofollow\">https://sourceware.org/ml/libc-alpha/2015-02/msg00653.html</a></p>\n"}], "owner": {"reputation": 555, "user_id": 6785719, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/81e5943f52540ee336f631da4ffd6f53?s=128&d=identicon&r=PG&f=1", "display_name": "Weiheng Li", "link": "https://stackoverflow.com/users/6785719/weiheng-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 1, "accepted_answer_id": 39878302, "answer_count": 1, "score": 0, "last_activity_date": 1475682672, "creation_date": 1475680524, "last_edit_date": 1475682672, "question_id": 39877836, "link": "https://stackoverflow.com/questions/39877836/backtrace-falls-into-endless-recursion", "title": "backtrace() falls into endless recursion?", "body": "<p>I use backtrace() function in one self-defined malloc(), like this:</p>\n\n<pre><code>    void *malloc(size_t size)\n    {printf(\"my malloc!\\n\");\n            //map_insert\n\n        static void *(*mallocp)(size_t size);\n        char *error;\n        void *ptr;\n        void *buffer[100];\n        int nptrs;\n        char ptrs_num[10];\n        memset(ptrs_num, '\\0', 10);\n        char **strings;\n        printf(\"1\\n\");\n        nptrs = backtrace(buffer, 100);\n/* those code below seems useless because problem happens here*/\n        printf(\"2\\n\");\n        printf(\"backtrace() returned %d addresses\\n\", nptrs);\n        printf(\"3\\n\");\n        strings = backtrace_symbols(buffer, nptrs);\n        printf(\"4\\n\");\n        if (strings == NULL) {\n           perror(\"backtrace_symbols\");\n           exit(1);\n        }\n        /*code neglected*/\n        return ptr;\n    }\n</code></pre>\n\n<p>This is part of code in my .so file, and some bug may exist because I haven't run this and modify. I use this test code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;malloc.h&gt;\n#include &lt;stdio.h&gt;\nint main(int argc, char **argv){\n\n    printf(\"to malloc a!\\n\");\n    char *a=(char *)malloc(sizeof(int)*1024);\n    return 0;\n}\n</code></pre>\n\n<p>my result is as below:</p>\n\n<pre><code>my malloc!\n1\nmy malloc!\n1\nmy malloc!\n1\nmy malloc!\n1\nmy malloc!\n1\nmy malloc!\n1\nmy malloc!\n1\nmy malloc!\n1\nmy malloc!\n1\nmy malloc!\n1\nmy malloc!\n1\nSegmentation fault\n</code></pre>\n\n<p>I really don't know why is this.</p>\n\n<p>I think backtrace would just get some information, why it would trigger my malloc?</p>\n"}, {"tags": ["python", "c", "gcc", "hyperlink"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475680329, "post_id": 39877735, "comment_id": 67042202, "body": "1) Python is a programing language, not a scripting language. 2) I strongly doubt this makes any sense."}], "owner": {"reputation": 351, "user_id": 6926991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fba29a1efee35984a7395938b3cf88?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Bammer", "link": "https://stackoverflow.com/users/6926991/martin-bammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 482, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1475821111, "creation_date": 1475680219, "last_edit_date": 1475821111, "question_id": 39877735, "link": "https://stackoverflow.com/questions/39877735/link-library-against-python-2-and-python-3-library", "title": "Link library against Python 2 and Python 3 library", "body": "<p>I want to create a library which is linked against <code>libpython2.so</code> and <code>libpython3.so</code> to be able to execute Python2 and Python 3 scripts. The problem is that both libraries contain function with the same name. I tried to solve the problem the following way:</p>\n\n<ul>\n<li>support module <code>foo-python2.c</code> for Python 2 support, which is linked against <code>libpython2.so</code></li>\n<li>support module <code>foo-python3.c</code> for Python 3 support, which is linked against <code>libpython3.so</code></li>\n<li>main file <code>foo-main.c</code> which calls init functions in the Python 2 and Python 3 support modules and is linked with <code>foo-python2.o</code> and <code>foo-python3.o</code>.</li>\n</ul>\n\n<p>When libfoo.so is loaded Python 2 initialization is working as expected, but when I try to access Python 3 function it does not work as expected.\nIn the Python 3 support library when I call <code>Py_IsInitialized()</code> is returns true, although the <code>libpython3.so</code> was not loaded with <code>g_module_open</code>. So my assumption is that <code>Py_IsInitialized</code> points to the Python 2 version. When I ignore this and call <code>g_module_open(\"/usr/lib/libpython3.so\", 0)</code> and call some <code>Py_*</code> functions the module crashes.</p>\n\n<p>How do I correctly link the 3 objects to solve my problem?</p>\n"}, {"tags": ["c", "linux", "arm", "mmap", "gpio"], "comments": [{"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 1, "creation_date": 1475679953, "post_id": 39877120, "comment_id": 67041906, "body": "Unsurprisingly, the data output registers are for <i>output</i>. If you want to read input values, use the data input registers. There&#39;s a clue in the name..."}, {"owner": {"reputation": 109, "user_id": 6208586, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74a05253e37f604729f67fdcc06cd685?s=128&d=identicon&r=PG&f=1", "display_name": "etugcey", "link": "https://stackoverflow.com/users/6208586/etugcey"}, "reply_to_user": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1475680824, "post_id": 39877120, "comment_id": 67042505, "body": "Thanks for pointing out, I knew it had to be something rather silly, but I was lost."}], "answers": [{"tags": [], "owner": {"reputation": 2573, "user_id": 1101537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1087a838de98ff53402c4a0e9ab9b990?s=128&d=identicon&r=PG", "display_name": "alexander", "link": "https://stackoverflow.com/users/1101537/alexander"}, "is_accepted": true, "score": 3, "last_activity_date": 1475680005, "creation_date": 1475680005, "answer_id": 39877657, "question_id": 39877120, "link": "https://stackoverflow.com/questions/39877120/arm-linux-userspace-gpio-operations-using-mmap-dev-mem-approach-able-to-write/39877657#39877657", "title": "ARM linux userspace gpio operations using mmap /dev/mem approach (able to write to GPIO registers, but fail to read from them)", "body": "<p>You should use GPIO_DATAIN Register (offset = 138h) to read from GPIO pin, not GPIO_DATAOUT.</p>\n"}], "owner": {"reputation": 109, "user_id": 6208586, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74a05253e37f604729f67fdcc06cd685?s=128&d=identicon&r=PG&f=1", "display_name": "etugcey", "link": "https://stackoverflow.com/users/6208586/etugcey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1330, "favorite_count": 0, "accepted_answer_id": 39877657, "answer_count": 1, "score": 1, "last_activity_date": 1475680005, "creation_date": 1475678680, "last_edit_date": 1475679127, "question_id": 39877120, "link": "https://stackoverflow.com/questions/39877120/arm-linux-userspace-gpio-operations-using-mmap-dev-mem-approach-able-to-write", "title": "ARM linux userspace gpio operations using mmap /dev/mem approach (able to write to GPIO registers, but fail to read from them)", "body": "<p>Kernel version 3.12.30-AM335x-PD15.1.1 by PHYTEC.</p>\n\n<p>If I use the /sys/class/gpio way, I can see that the button input pin (gpio103 of AM3359) value changes from 0 to 1.</p>\n\n<p>Following the this exercise <a href=\"http://elinux.org/EBC_Exercise_11b_gpio_via_mmap\" rel=\"nofollow\">http://elinux.org/EBC_Exercise_11b_gpio_via_mmap</a>\nand executing the below command for reading gpio pins usig /dev/mem approach:</p>\n\n<pre><code>`devmem2 0x481ae13c` \n</code></pre>\n\n<p>(base of gpio bank 3 which is 0x481ae000 + 0x13c dataout offset)</p>\n\n<p>I get the below output regardless of button position.</p>\n\n<pre><code>/dev/mem opened\nMemory mapped at address 0xb6fd1000.\nRead at address  0x481AE13C (0xb6fd113c): 0x00000000\n</code></pre>\n\n<p>Also with the c program given below I managed to toggle gpios using /dev/mem; however I could not read them succesfuly.</p>\n\n<p>in the header file:</p>\n\n<pre><code>#define GPIO0_START_ADDRESS (0x44E07000)\n#define GPIO1_START_ADDRESS (0x4804C000)\n#define GPIO2_START_ADDRESS (0x481AC000)\n#define GPIO3_START_ADDRESS (0x481AE000)\n\n#define GPIO0_END_ADDRESS   (0x44e09000)\n#define GPIO1_END_ADDRESS   (0x4804E000)\n#define GPIO2_END_ADDRESS   (0x481AE000)\n#define GPIO3_END_ADDRESS   (0x481B0000)\n\n#define GPIO0_SIZE (GPIO0_END_ADDRESS - GPIO0_START_ADDRESS)\n#define GPIO1_SIZE (GPIO1_END_ADDRESS - GPIO1_START_ADDRESS)\n#define GPIO2_SIZE (GPIO2_END_ADDRESS - GPIO2_START_ADDRESS)\n#define GPIO3_SIZE (GPIO3_END_ADDRESS - GPIO3_START_ADDRESS)\n\n#define GPIO_SETDATAOUT (0x194)\n#define GPIO_CLEARDATAOUT (0x190)\n#define GPIO_DATAOUT (0x13c)\n</code></pre>\n\n<p>somewhere in the program:</p>\n\n<pre><code>    int fd = open(\"/dev/mem\", O_RDWR);\n    //int fd = open(\"/dev/mem\", O_RDWR|O_SYNC);\n\n    gpio0_address = mmap(0, GPIO0_SIZE, PROT_READ | PROT_WRITE, MAP_SHARED, fd, GPIO0_START_ADDRESS);\n    gpio1_address = mmap(0, GPIO1_SIZE, PROT_READ | PROT_WRITE, MAP_SHARED, fd, GPIO1_START_ADDRESS);\n    gpio2_address = mmap(0, GPIO2_SIZE, PROT_READ | PROT_WRITE, MAP_SHARED, fd, GPIO2_START_ADDRESS);\n    gpio3_address = mmap(0, GPIO3_SIZE, PROT_READ | PROT_WRITE, MAP_SHARED, fd, GPIO3_START_ADDRESS);\n\n    if(gpio0_address == MAP_FAILED){ printf(\"unable to map GPIO0 bank.\\n\"); }\n    if(gpio1_address == MAP_FAILED){ printf(\"unable to map GPIO1 bank.\\n\"); }\n    if(gpio2_address == MAP_FAILED){ printf(\"unable to map GPIO2 bank.\\n\"); }\n    if(gpio3_address == MAP_FAILED){ printf(\"unable to map GPIO3 bank.\\n\"); }\n\n\n    gpio0_dataout_address = gpio0_address + GPIO_DATAOUT;\n\n    gpio0_setdataout_address = gpio0_address + GPIO_SETDATAOUT;\n\n    gpio0_cleardataout_address = gpio0_address + GPIO_CLEARDATAOUT;\n\n    gpio1_dataout_address = gpio1_address + GPIO_DATAOUT;\n\n    gpio1_setdataout_address = gpio1_address + GPIO_SETDATAOUT;\n\n    gpio1_cleardataout_address = gpio1_address + GPIO_CLEARDATAOUT;\n\n    gpio2_dataout_address = gpio2_address + GPIO_DATAOUT;\n\n    gpio2_setdataout_address = gpio2_address + GPIO_SETDATAOUT;\n\n    gpio2_cleardataout_address = gpio2_address + GPIO_CLEARDATAOUT;\n\n    gpio3_dataout_address = gpio3_address + GPIO_DATAOUT;\n\n    gpio3_setdataout_address = gpio3_address + GPIO_SETDATAOUT;\n\n    gpio3_cleardataout_address = gpio3_address + GPIO_CLEARDATAOUT;\n    read_GPIO_bank_memory(3, &amp;GPIO3_bank_memory);\n</code></pre>\n\n<p>read function:</p>\n\n<pre><code>   void read_GPIO_bank_memory(int bank, four_bytes* gpio_bank_dataout)\n    {\n        switch(bank)\n        {\n            case 0:\n\n                gpio_bank_dataout-&gt;ALL = *gpio0_dataout_address;\n                break;\n            case 1:\n\n                gpio_bank_dataout-&gt;ALL = *gpio1_dataout_address;\n\n                break;\n            case 2:\n\n                gpio_bank_dataout-&gt;ALL = *gpio2_dataout_address;\n\n                break;\n            case 3:\n\n                gpio_bank_dataout-&gt;ALL = *gpio3_dataout_address;\n\n                break;\n        }\n    }\n</code></pre>\n"}, {"tags": ["c", "multiprocessing", "fork"], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 3243080, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/444aed7d2fb823ac86b8c325e62359c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Leitersdorf", "link": "https://stackoverflow.com/users/3243080/dean-leitersdorf"}, "edited": false, "score": 2, "creation_date": 1475678612, "post_id": 39877030, "comment_id": 67040775, "body": "I kill the child processes immediately - they do not fork."}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "reply_to_user": {"reputation": 1263, "user_id": 3243080, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/444aed7d2fb823ac86b8c325e62359c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Leitersdorf", "link": "https://stackoverflow.com/users/3243080/dean-leitersdorf"}, "edited": false, "score": 0, "creation_date": 1475678793, "post_id": 39877030, "comment_id": 67040941, "body": "Hmm, this is an interesting thing now you mention..."}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "reply_to_user": {"reputation": 1263, "user_id": 3243080, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/444aed7d2fb823ac86b8c325e62359c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Leitersdorf", "link": "https://stackoverflow.com/users/3243080/dean-leitersdorf"}, "edited": false, "score": 0, "creation_date": 1475678887, "post_id": 39877030, "comment_id": 67041032, "body": "And I see that one of the children spawned a subchild."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1475679286, "post_id": 39877030, "comment_id": 67041380, "body": "That&#39;s a misleading description.  When it succeeds, <code>fork()</code> produces <i>one</i> child process, not two, and the parent continues to run.  The several distinctions between that and two child processes are all rather important."}], "tags": [], "owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "is_accepted": false, "score": 0, "last_activity_date": 1475678476, "creation_date": 1475678476, "answer_id": 39877030, "question_id": 39876972, "link": "https://stackoverflow.com/questions/39876972/extra-data-printed-out-after-call-to-fork/39877030#39877030", "title": "Extra data printed out after call to fork()", "body": "<p>Fork splits the process in two. In each of the child processes. You end up with 8 processes after 3 forks (unless you do something conditional)</p>\n"}, {"comments": [{"owner": {"reputation": 1263, "user_id": 3243080, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/444aed7d2fb823ac86b8c325e62359c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Leitersdorf", "link": "https://stackoverflow.com/users/3243080/dean-leitersdorf"}, "edited": false, "score": 0, "creation_date": 1475679028, "post_id": 39877181, "comment_id": 67041148, "body": "Perfect! Thank you! What is the flush doing?"}, {"owner": {"reputation": 1263, "user_id": 3243080, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/444aed7d2fb823ac86b8c325e62359c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Leitersdorf", "link": "https://stackoverflow.com/users/3243080/dean-leitersdorf"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475679677, "post_id": 39877181, "comment_id": 67041705, "body": "@JohnBollinger at the same time, using the flush does solve it which is weird"}, {"owner": {"reputation": 97034, "user_id": 427332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11b58e11decc7b4c352d3ac3b2d0b90?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/427332/tommy"}, "reply_to_user": {"reputation": 1263, "user_id": 3243080, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/444aed7d2fb823ac86b8c325e62359c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Leitersdorf", "link": "https://stackoverflow.com/users/3243080/dean-leitersdorf"}, "edited": false, "score": 0, "creation_date": 1475680164, "post_id": 39877181, "comment_id": 67042083, "body": "Just making sure that the process is writing everything it has to stdout then, rather than possibly keeping it in an internal cache. I&#39;ll wager the cache is being copied when you <code>fork</code>, so many of the <code>hello(1)7998</code>s aren&#39;t actually from process 7998, they were merely enqueued by process 7998 and then the enqueued text was copied over. Since <code>fflush</code> clears the buffers, there&#39;s nothing to copy. (EDIT: and answer modified, given that&#39;s a fairly compelling reason)"}], "tags": [], "owner": {"reputation": 97034, "user_id": 427332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11b58e11decc7b4c352d3ac3b2d0b90?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/427332/tommy"}, "is_accepted": false, "score": 3, "last_activity_date": 1475680276, "last_edit_date": 1475680276, "creation_date": 1475678808, "answer_id": 39877181, "question_id": 39876972, "link": "https://stackoverflow.com/questions/39876972/extra-data-printed-out-after-call-to-fork/39877181#39877181", "title": "Extra data printed out after call to fork()", "body": "<p>I think what you're seeing is merely that the process-local content-that-I-will-eventually-write-to-<code>stdout</code> buffer is being copied on <code>fork</code>, so contents queued prior to the fork are then output independently by several processes.</p>\n\n<p>The forking is doing what you think, the instrument of measure is flawed.</p>\n\n<p>I modified your code to add a flush:</p>\n\n<pre><code>    int ret = fork();\n    printf(\"hello(%d)%d, %d \", i, getpid(), ret);\n    fflush(stdout);\n</code></pre>\n\n<p>That ensures the result of the <code>printf</code> doesn't sit in a process-local buffer. It's written direct to <code>stdout</code> then and the local buffer is emptied. Output then became:</p>\n\n<pre><code>Starting pid:41731\nhello(1)41731, 41732 hello(2)41731, 41733 hello(1)41732, 0 \nhello(3)41731, 41734 hello(2)41733, 0 \nhello(3)41734, 0 \n</code></pre>\n\n<p>i.e. the expected six calls.</p>\n\n<p>(I used CodeRunner on a Mac to test this; it also shows the ostensibly nine results without the <code>flush</code> so I'm confident I duplicated the initial conditions).</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475679742, "post_id": 39877513, "comment_id": 67041745, "body": "Excellent.  Duplication of the buffer contents is the key."}, {"owner": {"reputation": 1263, "user_id": 3243080, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/444aed7d2fb823ac86b8c325e62359c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Leitersdorf", "link": "https://stackoverflow.com/users/3243080/dean-leitersdorf"}, "edited": false, "score": 0, "creation_date": 1475679770, "post_id": 39877513, "comment_id": 67041775, "body": "Wow.. Simply wow."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1475680973, "post_id": 39877513, "comment_id": 67042607, "body": "<code>fflush(NULL)</code> flushes all open output files."}, {"owner": {"reputation": 1263, "user_id": 3243080, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/444aed7d2fb823ac86b8c325e62359c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Leitersdorf", "link": "https://stackoverflow.com/users/3243080/dean-leitersdorf"}, "edited": false, "score": 0, "creation_date": 1475684666, "post_id": 39877513, "comment_id": 67044999, "body": "Hold on: Had I removed the fork, the parent would have just printed three times correct? Basically, the parent would have ignored what was in the buffer already. Then, since the child is an exact copy of the parent, how come the child doesn&#39;t &quot;ignore&quot; the buffer like the parent would? (this makes me think that &quot;ignoring&quot; the buffer is done outside the process - is that correct?)"}, {"owner": {"reputation": 31124, "user_id": 1427124, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/900fad0b78afca7d8fafdd3d2e414182?s=128&d=identicon&r=PG", "display_name": "DaoWen", "link": "https://stackoverflow.com/users/1427124/daowen"}, "edited": false, "score": 0, "creation_date": 1475685235, "post_id": 39877513, "comment_id": 67045394, "body": "FYI, on most *nix systems <code>stderr</code> is unbuffered by default. Whenever I have possibly concurrent prints, I usually prefer using <code>fprintf(stderr, ...)</code> to make the output a bit less messy."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1263, "user_id": 3243080, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/444aed7d2fb823ac86b8c325e62359c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Leitersdorf", "link": "https://stackoverflow.com/users/3243080/dean-leitersdorf"}, "edited": false, "score": 0, "creation_date": 1475687299, "post_id": 39877513, "comment_id": 67046551, "body": "@DeanLeitersdorf The child isn&#39;t &quot;ignoring&quot; anything.  It receives a copy of the parent&#39;s <code>stdout</code> buffer, then when the child&#39;s buffer is flushed (by printing a newline) it outputs whatever is in the buffer."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 7, "last_activity_date": 1475681146, "last_edit_date": 1475681146, "creation_date": 1475679659, "answer_id": 39877513, "question_id": 39876972, "link": "https://stackoverflow.com/questions/39876972/extra-data-printed-out-after-call-to-fork/39877513#39877513", "title": "Extra data printed out after call to fork()", "body": "<p>When you <code>fork</code> a process, the memory in parent is duplicated in the child.  This includes the <code>stdout</code> buffer.</p>\n\n<p>Starting on the second iteration of the loop in the parent, you have <code>hello(1)7998, 8009</code> in the buffer.  When the second child forks, this text is still in that child's buffer.  The second child then prints <code>hello(2)8010, 0</code>, then a newline.  The newline flushes the child's buffer, so the second child prints this:</p>\n\n<pre><code>hello(1)7998, 8009 hello(2)8010, 0 \n</code></pre>\n\n<p>After the fork, the parent prints <code>hello(2)7998, 8010</code> which is added to the output buffer.  Then on the third iteration, the third child inherits this and prints:</p>\n\n<pre><code>hello(1)7998, 8009 hello(2)7998, 8010 hello(3)8011, 0\n</code></pre>\n\n<p>The parent then prints <code>hello(3)7998, 8011</code> which is again added to the buffer.  Then parent then exits the loop and exits, after which the buffer is flushed and the parent outputs:</p>\n\n<pre><code>hello(1)7998, 8009 hello(2)7998, 8010 hello(3)7998, 8011\n</code></pre>\n\n<p>To correct this, then parent process needs to clear the output buffer before forking.</p>\n\n<p>This can be done either by calling <code>fflush(stdout)</code> after calling <code>printf</code>, or by adding a newline (<code>\\n</code>) to the end of the <code>printf</code>.</p>\n\n<p>EDIT:</p>\n\n<p>As a more general solution, calling <code>fflush(NULL)</code> will flush all open output streams.</p>\n"}], "owner": {"reputation": 1263, "user_id": 3243080, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/444aed7d2fb823ac86b8c325e62359c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Leitersdorf", "link": "https://stackoverflow.com/users/3243080/dean-leitersdorf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 1, "closed_date": 1475724458, "accepted_answer_id": 39877513, "answer_count": 3, "score": 2, "last_activity_date": 1475681146, "creation_date": 1475678336, "last_edit_date": 1475681084, "question_id": 39876972, "link": "https://stackoverflow.com/questions/39876972/extra-data-printed-out-after-call-to-fork", "closed_reason": "Duplicate", "title": "Extra data printed out after call to fork()", "body": "<p>I am running the following code which I wrote in c on my Mac.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;  \n\nint main(int argc, const char * argv[]) {\n\n    int i = 0;\n    printf(\"Starting pid:%d\\n\", getpid());\n    while(i++&lt;3){\n        int ret = fork();\n        printf(\"hello(%d)%d, %d \", i, getpid(), ret);\n        if(!ret){\n            printf(\"\\n\");\n            return 0;}\n    }\n}\n</code></pre>\n\n<p>The goal I had in mind was for there to be 6 prints in total - 3 from the original parent (the pid printed in \"Starting pid\"), and 1 more from each of the 3 spawned children. Instead what I received was:</p>\n\n<pre><code>Starting pid:7998\nhello(1)8009, 0 \nhello(1)7998, 8009 hello(2)8010, 0 \nhello(1)7998, 8009 hello(2)7998, 8010 hello(3)7998, 8011 hello(1)7998, 8009 hello(2)7998, 8010 hello(3)8011, 0 \n</code></pre>\n\n<p>Note that the original parent (7998) prints 6 times (three times when i==1, twice with i==2, and once with i==3).</p>\n\n<p>Why would this be happening? Why I am not receiving 3 prints from the parent (once when i==1, i==2, i==3). If we look at it from the parent's perspective - there is a while loop and we are supposed to hit the print statement inside only 3 times.</p>\n\n<p>Is it perhaps that fork is async or something? What am I missing?</p>\n"}, {"tags": ["c++", "c", "malloc", "new-operator"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1475677922, "post_id": 39876750, "comment_id": 67040220, "body": "First of all in C++ you should avoid pointers. You can live very happily and make very nice programs without pointers. Secondly, if you want to create an array at runtime then you should be using <code>std::vector</code> instead."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1475677924, "post_id": 39876750, "comment_id": 67040222, "body": "@LPs He&#39;s converting C to C++, this is a rare case where both tags are valid."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1475677963, "post_id": 39876750, "comment_id": 67040256, "body": "@Borgleader Meanwhile deleted ;)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475677973, "post_id": 39876750, "comment_id": 67040261, "body": "If you still insists on using pointers, please show us what you have tried, and tell us how it worked or not worked."}, {"owner": {"reputation": 9, "user_id": 5019133, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UywtLs5KgLI/AAAAAAAAAAI/AAAAAAAAABk/N0enogWYHzk/photo.jpg?sz=128", "display_name": "Varun Thakur", "link": "https://stackoverflow.com/users/5019133/varun-thakur"}, "edited": false, "score": 0, "creation_date": 1475678491, "post_id": 39876750, "comment_id": 67040663, "body": "i tried this <code>h-&gt;Table=new HashTableNode*[h-&gt;tsize];</code> but it doesnot work and program crashes."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475679018, "post_id": 39876750, "comment_id": 67041140, "body": "That is the correct way to allocate an array of pointers using <code>new[]</code>. The problem is something else you do. You need to run in a debugger to find out more about the crash, like when and where it happens, what the values of involved variables are, etc. Please read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1475679070, "post_id": 39876750, "comment_id": 67041189, "body": "Where does it crash?  Can you produce a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 30181, "user_id": 209629, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3784fe19d5c3d40d66ba91788f9bf007?s=128&d=identicon&r=PG", "display_name": "vz0", "link": "https://stackoverflow.com/users/209629/vz0"}, "edited": false, "score": 0, "creation_date": 1475679333, "post_id": 39876750, "comment_id": 67041423, "body": "Writing your own hash table using pointers is a very interesting learning exercise. Just ignore the comments regarding pointers being evil."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475680542, "post_id": 39876750, "comment_id": 67042327, "body": "This is an awful idea. If you are in Rome behave like a Roman! If you write C++ code, use C++ features. I.e. use a class and the standard library."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1475681616, "post_id": 39876750, "comment_id": 67043020, "body": "@Olaf thats a horrible Philosophy. C++ does not force you to use any or all of its&#39; features. It&#39;s a plague in the C++ community where &quot;Oh you&#39;re using C++, just use C++ features&quot;. C++ is largely capable of doing anything C can using C code, and it is still going to be C++(It&#39;s not going to be &quot;idiomatic&quot; C++, but It is C++). It&#39;s okay to use pointers, it&#39;s okay to use memcpy, it&#39;s okay to realloc and malloc and free. You better know what you are doing and be able to answer to others, but it&#39;s okay to use these tools."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1475681700, "post_id": 39876750, "comment_id": 67043077, "body": "C++ is plagued with the problem of familiarity = simplicity, and a large amount of this community is terrified of sharp tools, even if they are warranted. Hence we must try our best to promote better alternatives that do the same thing with zero overhead with predictable behavior that can be checked to be universal across platforms. However telling people to &quot;never do this&quot; is downright evil. At an extreme we just become Idiomatic Java programmers using C++, which begs the question why do we even have pointers in the language?"}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1475682049, "post_id": 39876750, "comment_id": 67043283, "body": "That said, please indent your code."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1475682702, "post_id": 39876750, "comment_id": 67043744, "body": "@Dmitry: Your comment amuses me as a dedicated <b>C</b> programmer! But the approach is well correct. If you want to write C-style, <b>use C</b>! Your approach rfeminds me of &quot;If you only know how to use a hammer, ever problem looks like a nail.&quot;"}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475682803, "post_id": 39876750, "comment_id": 67043813, "body": "@Olaf that&#39;s my point; we must teach people what kinds of hammers exist; but we can&#39;t tell people to never use a hammer, or else they will just find it easier to hit us with that hammer or hit it with a hammer harder. It&#39;s very hard to stop using a hammer, and worse, often a hammer is indeed better than any tool we can provide but we are blinded by our familiarity. You can write C++ in C, it takes disceplined use of structs and proper care of your code, and care to make sure you carefully document it, but it can be done. C with PHP preprocessor could be nicer than C++ id argue but i degress."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475683076, "post_id": 39876750, "comment_id": 67043971, "body": "@Olaf the biggest things C++ offers over C is (1) ability to automatically match constructors with destructors(In C you need a preprocessor to do this for you and the current preprocessor cannot be programmed to do this for you). (2) ability to do templating(which can be done via setting flags before including a header, do work, then set &quot;cleanup macro&quot; and include the header again which after it is done &quot;unsets cleanup macro&quot;, but nobody ever does this, a better preprocessor would make this process less disgusting, but C++ preprocessor is no better, but they put the stuff into the language."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475683825, "post_id": 39876750, "comment_id": 67044449, "body": "There are other tools than hammers ... (this is neither the place nor the time for a duscussion. Feel free to stick with your collection of hammers, I&#39;ll stick with my whole toolbox)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1475736935, "post_id": 39876750, "comment_id": 67064909, "body": "Regarding how you solved your problem... When you allocate memory, that memory will not be initialized unless there&#39;s a constructor doing it. When you allocate an &quot;array&quot; of pointers (like in <code>h-&gt;Table=new HashTableNode*[h-&gt;tsize]</code>) then those pointers will not be initialized. The contents of the array will be <i>indeterminate</i> and using them without initialization will lead to <i>undefined behavior</i> and likely crashes. What the loop does is to initialize the pointers, and make them point to valid objects."}], "answers": [{"comments": [{"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 1, "creation_date": 1475682383, "post_id": 39877304, "comment_id": 67043522, "body": "<i>Never ever</i> tell C++ programmers to <i>Never ever</i> do something, as they will do it just to spite you. See how you suddenly have an urge to tell me to <i>Never ever</i> tell C++ programmers to <i>Never ever</i> tell other C++ programmers to tell other C++ programmers to <i>Never ever</i> do something? That&#39;s how confusion breeds."}, {"owner": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475703263, "post_id": 39877304, "comment_id": 67055028, "body": "@Olaf : Why is that bad typedefing a pointer type ? Have a link to a documentation giving detail about why this should not be done ?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "edited": false, "score": 0, "creation_date": 1475712087, "post_id": 39877304, "comment_id": 67057629, "body": "@shrike: Did you search for that topic? This has been explained here dozens of times already. Some reasons: it results in confusion for usage, as it hides the specific semantics of a pointer. And you cannot apply qualifiers to the object it points to (what do you think <code>const PHashTableNode p</code> is actually? Hint: it is very different from <code>const HashTableNode *p</code>), defying const-correctness."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "edited": false, "score": 0, "creation_date": 1475712320, "post_id": 39877304, "comment_id": 67057672, "body": "@shrike: ... It also clutters global namespace. What good odes it? Nothing: you have to remember two names, more if you want to be const-correct or have <code>volatile</code> or atomic objects. You don&#39;t even safe typing. <code>*MyStruct</code> vs. <code>pMyStruct</code>. Things become even more complicated if you need pointer to pointer. If you ever have to maintain such code (be it your own after 1-2years), you bang your hand against the wall."}, {"owner": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475741181, "post_id": 39877304, "comment_id": 67067301, "body": "@Olaf : <i>&quot;Did you search for that topic?&quot;</i> Actually I did (quickly though) and found <a href=\"http://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">this</a> where the accepted answer seams to legitimate such practice, or <a href=\"http://stackoverflow.com/questions/3781932/is-typedefing-a-pointer-type-considered-bad-practice\">this</a> which links as duplicate to the previous one. (One more example where a duplicate flag tends to strengthen a wrong answer.) Anyway your arguments against this practice make sense. I will think about it twice in the future before doing so. Thanks."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "edited": false, "score": 0, "creation_date": 1475755471, "post_id": 39877304, "comment_id": 67076547, "body": "@shrike: Not all highly voted answers are good answers. Some ppl think you need to <code>typedef</code> a pointer to a <code>struct</code> to make that <code>struct</code> opaque. But that is not necessary as you can very well have a forward declaration of that <code>struct</code> (but no <code>typedef</code>) and use it for pointers. Note that there are quite some coding styles which disallow <code>typedef</code>ing a pointer (and only few of them have been written by me ;-)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "edited": false, "score": 0, "creation_date": 1475755914, "post_id": 39877304, "comment_id": 67076848, "body": "@shrike: Also have a look at this answer to your first linked question <a href=\"http://stackoverflow.com/a/750183/4774918\">stackoverflow.com/a/750183/4774918</a> . Although it does not even try to justify the position, it has also a lot of upvotes. My assumption is that it got these upvotes from ppl who understand the reasons already, The first answer only lists a very special case and does not mention the alternative I gave, I think is it reasonable to assume it got UVs from less experienced coders who only noticed the given aspects. Additionally considering an accepted answer typically gets more upvotes this is a clear statement."}], "tags": [], "owner": {"reputation": 2476, "user_id": 677202, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5544d46b2d8a81515a4704b3e2048e38?s=128&d=identicon&r=PG", "display_name": "nosbor", "link": "https://stackoverflow.com/users/677202/nosbor"}, "is_accepted": false, "score": 0, "last_activity_date": 1475679111, "creation_date": 1475679111, "answer_id": 39877304, "question_id": 39876750, "link": "https://stackoverflow.com/questions/39876750/how-to-convert-this-c-line-into-its-equivalent-c/39877304#39877304", "title": "How to convert this C line into its equivalent C++?", "body": "<p>Obviously I agree most of the comments under your question, but if you REALLY need pointers in your code the solution for your problem may look like below.</p>\n\n<p>Use typedef specifier to define a type:</p>\n\n<pre><code>typedef HashTableNode* PHashTableNode;\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>h-&gt;Table=new PHashTableNode[h-&gt;tsize];\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5019133, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UywtLs5KgLI/AAAAAAAAAAI/AAAAAAAAABk/N0enogWYHzk/photo.jpg?sz=128", "display_name": "Varun Thakur", "link": "https://stackoverflow.com/users/5019133/varun-thakur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1475682278, "creation_date": 1475677780, "last_edit_date": 1475682278, "question_id": 39876750, "link": "https://stackoverflow.com/questions/39876750/how-to-convert-this-c-line-into-its-equivalent-c", "title": "How to convert this C line into its equivalent C++?", "body": "<p>This is my structure :</p>\n\n<pre><code>struct HashTable{\n      int tsize;\n      int count;    //No. of elements in table\n      struct HashTableNode **Table;\n};\n</code></pre>\n\n<p>And this is what I am trying to do : </p>\n\n<pre><code>struct HashTable *h=(struct HashTable *)malloc(sizeof(struct HashTable));\nif(!h) return NULL;\nh-&gt;tsize=size/LOAD_FACTOR;\nh-&gt;count=0;\nh-&gt;Table=(struct HashTableNode**)malloc(sizeof(HashTableNode *)*h-&gt;tsize);//this line\n</code></pre>\n\n<p>I am unable to convert the last line into its equivalent C++ version using new operator</p>\n\n<p><strong>Solved it</strong></p>\n\n<p>i changed the code to this :</p>\n\n<pre><code>h-&gt;Table=new HashTableNode*[h-&gt;tsize];\nfor(int i=0;i&lt;h-&gt;tsize;i++)\n    h-&gt;Table[i]=new HashTableNode;\n</code></pre>\n\n<p>and did a little debugging on my own and voila. It is solved. </p>\n\n<p>Thanks, everyone.</p>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "edited": false, "score": 2, "creation_date": 1475676984, "post_id": 39876351, "comment_id": 67039441, "body": "What is <code>calloc ( 2 , 1 );</code> supposed to do? Especially, why <code>2</code> and <code>1</code>?"}, {"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 1, "creation_date": 1475677045, "post_id": 39876351, "comment_id": 67039506, "body": "What&#39;s the difference between the first and second code sample besides the different strings?"}, {"owner": {"reputation": 116, "user_id": 6914054, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-qLrIXFkKvpM/AAAAAAAAAAI/AAAAAAAAASs/YZ1Pl3ZyFh0/photo.jpg?sz=128", "display_name": "mohanen b", "link": "https://stackoverflow.com/users/6914054/mohanen-b"}, "edited": false, "score": 0, "creation_date": 1475677221, "post_id": 39876351, "comment_id": 67039651, "body": "oops my bad , fixed now"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1475677427, "post_id": 39876351, "comment_id": 67039816, "body": "C++ is a different language from C, and considerations for this sort of thing are different in C++ than in C.  Choose <i>one</i>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475677586, "post_id": 39876351, "comment_id": 67039966, "body": "Your second and third examples <i>do not</i> &quot;Pass[ a] double pointer to a function as single pointer argument&quot;.  They pass a <i>single</i> pointer (a <code>char *</code>) to the function, which in turn expects an argument of exactly that type."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1475677842, "post_id": 39876351, "comment_id": 67040154, "body": "Consider <code>int *ip; double *dp; int **ipp</code>.  <code>ip</code> is an &quot;int pointer&quot;. <code>dp</code> is a &quot;double pointer&quot;.  <code>ipp</code> is a &quot;pointer to an int pointer&quot;"}, {"owner": {"reputation": 116, "user_id": 6914054, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-qLrIXFkKvpM/AAAAAAAAAAI/AAAAAAAAASs/YZ1Pl3ZyFh0/photo.jpg?sz=128", "display_name": "mohanen b", "link": "https://stackoverflow.com/users/6914054/mohanen-b"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475677859, "post_id": 39876351, "comment_id": 67040167, "body": "@JohnBollinger thats what am asking  it send  as single pointer  and expects and receives as one  and allocate memory then retain the address . which i can use it in the main"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1475677873, "post_id": 39876351, "comment_id": 67040176, "body": "First, replace <code>calloc(2, 1)</code> with <code>calloc(2, sizeof(char *))</code> throughout, because <code>calloc(2, 1)</code> only allocates 2 bytes."}, {"owner": {"reputation": 116, "user_id": 6914054, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-qLrIXFkKvpM/AAAAAAAAAAI/AAAAAAAAASs/YZ1Pl3ZyFh0/photo.jpg?sz=128", "display_name": "mohanen b", "link": "https://stackoverflow.com/users/6914054/mohanen-b"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1475678146, "post_id": 39876351, "comment_id": 67040388, "body": "@IanAbbott thanks , Ian  I missed that one fixed  now"}, {"owner": {"reputation": 116, "user_id": 6914054, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-qLrIXFkKvpM/AAAAAAAAAAI/AAAAAAAAASs/YZ1Pl3ZyFh0/photo.jpg?sz=128", "display_name": "mohanen b", "link": "https://stackoverflow.com/users/6914054/mohanen-b"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1475678237, "post_id": 39876351, "comment_id": 67040448, "body": "@WilliamPursell I know that already , By Double pointer i meant pointer to a pointer only"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475678352, "post_id": 39876351, "comment_id": 67040547, "body": "@mohanenb, <i>all</i> of your examples allocate memory in <code>main</code>.  If you did want to allocate in <code>to_fun</code> then that would be an appropriate use of double pointers, but if that&#39;s indeed what you want to ask about then perhaps the question text should actually mention it."}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1563207749, "post_id": 39876351, "comment_id": 100615140, "body": "A &quot;double pointer&quot; is not a thing in C or C++. What you&#39;re playing with here is a &quot;pointer to pointer&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1475677815, "creation_date": 1475677815, "answer_id": 39876764, "question_id": 39876351, "link": "https://stackoverflow.com/questions/39876351/passing-double-pointer-in-methods-c/39876764#39876764", "title": "passing Double pointer in methods c", "body": "<p>The first block of code works because you pass a pointer and then dereference that pointer to modify what the pointer points to (i.e. a block of memory allocated in <code>main</code>).</p>\n\n<p>In the case of the second block of code, you're modifying the function parameter <code>dbl_ptr</code>.  Changes to function parameters are not reflected in the calling function since all parameters are passed by value.</p>\n\n<p>The third block of code works because you're reading a function parameter and dereferencing the pointer value which points to valid memory.</p>\n\n<p>Also, you're not passing a <code>char **</code> to the second and third functions but a <code>char *</code>.</p>\n\n<p>You're also not allocating enough memory in <code>main</code>.  You allocate 2 bytes, but what you want is space for 2 <code>char *</code>:</p>\n\n<pre><code>char **dbl_ptr = calloc ( 2 , sizeof(char *) );\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1475678523, "post_id": 39877037, "comment_id": 67040694, "body": "Yes.  As easy as that."}], "tags": [], "owner": {"reputation": 30181, "user_id": 209629, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3784fe19d5c3d40d66ba91788f9bf007?s=128&d=identicon&r=PG", "display_name": "vz0", "link": "https://stackoverflow.com/users/209629/vz0"}, "is_accepted": false, "score": 2, "last_activity_date": 1475678486, "creation_date": 1475678486, "answer_id": 39877037, "question_id": 39876351, "link": "https://stackoverflow.com/questions/39876351/passing-double-pointer-in-methods-c/39877037#39877037", "title": "passing Double pointer in methods c", "body": "<p>When you want to modify a variable from inside a function, and the variable is outside the scope of the function, you pass a pointer to the variable:</p>\n\n<pre><code>void f(double *x) {\n  *x = 12;\n}\n\nvoid main() {\n  double z;\n  f(&amp;z);\n  printf(\"%f\", z);\n}\n</code></pre>\n\n<p>When your variable is a pointer, you need a pointer to a pointer:</p>\n\n<pre><code>void f(double **x) {\n  *x = malloc(...);\n}\n\nvoid main() {\n  double *z;\n  f(&amp;z);\n  printf(\"%f\", z[1]);\n}\n</code></pre>\n"}], "owner": {"reputation": 116, "user_id": 6914054, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-qLrIXFkKvpM/AAAAAAAAAAI/AAAAAAAAASs/YZ1Pl3ZyFh0/photo.jpg?sz=128", "display_name": "mohanen b", "link": "https://stackoverflow.com/users/6914054/mohanen-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1475678486, "creation_date": 1475676812, "last_edit_date": 1475677997, "question_id": 39876351, "link": "https://stackoverflow.com/questions/39876351/passing-double-pointer-in-methods-c", "title": "passing Double pointer in methods c", "body": "<p>Why when a double pointer is sent to a function as a single pointer and accessed gives no errors while trying to allocate memory there leads to segmentation fault even though allocate memory on heap.</p>\n\n<hr>\n\n<p><strong>Passing double pointer to a function as double pointer argument</strong> - works well</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;string.h&gt;\n\n    void to_fun(char **dbl_ptr)\n    {\n      *dbl_ptr = malloc(20);\n      strcpy(*dbl_ptr,\"cool\");\n    }\n    void main( )\n    {\n\n        char **dbl_ptr = calloc ( 2 , sizeof(char *) );\n        to_fun ( (dbl_ptr + 1) );\n        printf(\"%s\\n\",*(dbl_ptr + 1) );\n    }\n</code></pre>\n\n<hr>\n\n<p><strong>Passing double pointer to a function as single pointer argument</strong> - seg fault</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid to_fun(char *dbl_ptr)\n{\n  dbl_ptr = malloc(20);\n  strcpy(dbl_ptr,\"defnitely not cool\");\n}\nvoid main( )\n{\n\n    char **dbl_ptr = calloc ( 2 , sizeof(char *) );\n    to_fun ( *(dbl_ptr + 1) );\n    printf(\"%s\\n\",*(dbl_ptr + 1) );\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Passing double pointer to a function as single pointer argument</strong> - works well</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid to_fun(char *dbl_ptr)\n{\n  printf(\"%s\\n\",dbl_ptr );\n}\nvoid main( )\n{\n\n    char **dbl_ptr = calloc ( 2 , sizeof(char *) );\n    *(dbl_ptr + 1) = \"cool\";\n    to_fun ( *(dbl_ptr + 1) );\n}\n</code></pre>\n\n<hr>\n\n<p>this is just a sample code to let you get the question ..its not meant to be like improvised one blah blah blah...</p>\n\n<p>I know how pointers and dereference works in depth but still this above stuff is annoying . Any one Explain why . </p>\n"}, {"tags": ["c", "crash"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1475676729, "post_id": 39876302, "comment_id": 67039242, "body": "Welcome to Stack Overflow! It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6926718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L4Xco.jpg?s=128&g=1", "display_name": "th0k1a1", "link": "https://stackoverflow.com/users/6926718/th0k1a1"}, "edited": false, "score": 0, "creation_date": 1475677770, "post_id": 39876634, "comment_id": 67040105, "body": "Thanks for your help, i have detected a problem."}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "reply_to_user": {"reputation": 3, "user_id": 6926718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L4Xco.jpg?s=128&g=1", "display_name": "th0k1a1", "link": "https://stackoverflow.com/users/6926718/th0k1a1"}, "edited": false, "score": 0, "creation_date": 1475677931, "post_id": 39876634, "comment_id": 67040226, "body": "What problem ? ask if you don&#39;t understand and I will explain the minor changes. I thought they were obvious."}, {"owner": {"reputation": 3, "user_id": 6926718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L4Xco.jpg?s=128&g=1", "display_name": "th0k1a1", "link": "https://stackoverflow.com/users/6926718/th0k1a1"}, "edited": false, "score": 0, "creation_date": 1475678095, "post_id": 39876634, "comment_id": 67040351, "body": "This is my fault. In addStudent function. I call addName(name, listName, *pn); This *pn parameter is cause."}], "tags": [], "owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "is_accepted": true, "score": 0, "last_activity_date": 1475677487, "creation_date": 1475677487, "answer_id": 39876634, "question_id": 39876302, "link": "https://stackoverflow.com/questions/39876302/c-program-using-array-char-crash/39876634#39876634", "title": "C program using array char* crash", "body": "<p>It is not crashing.\nNow its up to you to make it work as you wish.</p>\n\n<pre><code>void addStudent(char* name, char listName[][31], int* n) {\n    int id;\n   // printf(\"%s\", name);\n    id = findName(name, listName, n);\n    if(id &lt; 0) {\n        addName(name, listName, n);\n        printf(\"%s has been added\\n\", name);\n    } else\n        printf(\"The student already exists\\n\");\n}\n\n\nint findName(char* name, char listName[][31], int n) {\n    int found = 0;\n    int i, id;\n    id = -1;\n    for(i = 0; i&lt;100 &amp;&amp; &amp;(n) &lt; 100 &amp;&amp;(!found); i++)\n        if(strcmp(listName[i], name) == 0) {\n            found = 1;\n            id = i;\n        }\n    return id;\n}\n\nvoid addName(char str[31], char listName[][31], int* pn) {\n    if(pn &gt; 100)\n        printf(\"List is full !!\\n\");\n    else\n        strcpy(listName[(*pn)++],str);\n}\n\n\nvoid main(int argc, char *argv[]) {\n    int n = 0;\n    char listStudent[100][31];\n    int id;\n    addStudent(\"John ABC\", listStudent, &amp;(n));\n    addStudent(\"David Davinci\", listStudent, &amp;(n));\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6926718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L4Xco.jpg?s=128&g=1", "display_name": "th0k1a1", "link": "https://stackoverflow.com/users/6926718/th0k1a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 39876634, "answer_count": 1, "score": 0, "last_activity_date": 1475677487, "creation_date": 1475676692, "question_id": 39876302, "link": "https://stackoverflow.com/questions/39876302/c-program-using-array-char-crash", "title": "C program using array char* crash", "body": "<p>I want to build a program that allow to insert name and print out. But the program crash whenever it begin.</p>\n\n<p>This is my main class:</p>\n\n<pre><code>void main(int argc, char *argv[]) {\n    int* n = (int*) malloc(sizeof(int));\n    char listStudent[100][31];\n    char* name = (char*) malloc(31);\n    int id;\n    *n = 0;\n    addStudent(\"John ABC\", listStudent, n);\n    addStudent(\"David Davinci\", listStudent, n);\n}\n</code></pre>\n\n<p>And some function to call</p>\n\n<pre><code>void addStudent(char name[31], char listName[][31], int *pn) {\n    int id;\n    id = findName(name, listName, *pn);\n    if(id &lt; 0) {\n        addName(name, listName, *pn);\n        printf(\"%s has been added\", name);\n    } else\n        printf(\"The student was exist\\n\");\n}\n\n\nint findName(char name[31], char listName[][31], int n) {\n    int found = FALSE;\n    int i, id;\n    id = -1;\n    for(i = 0; i &lt; n &amp;&amp; (!found); i++)\n        if(stricmp(listName[i], name) == 0) {\n            found = TRUE;\n            id = i;\n        }\n\n    return id;\n}\n\nvoid addName(char str[31], char listName[][31], int* pn) {\n    if(*pn &gt; 100)\n        printf(\"List is full !!\");\n    else\n        strcpy(listName[(*pn)++],str);  \n}\n</code></pre>\n\n<p>Thanks advance for your help!!</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 1983, "user_id": 2830652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/99L9k.png?s=128&g=1", "display_name": "sokkyoku", "link": "https://stackoverflow.com/users/2830652/sokkyoku"}, "is_accepted": false, "score": 3, "last_activity_date": 1475676479, "last_edit_date": 1475676479, "creation_date": 1475676110, "answer_id": 39876085, "question_id": 39876038, "link": "https://stackoverflow.com/questions/39876038/print-only-once-in-c/39876085#39876085", "title": "Print only once in C", "body": "<p>Your <code>scanf</code> is currently looking for a single character (<code>%c</code>) so when you input \"kkk\" and press enter it receives input four times: 'k', 'k', 'k', and '\\n'</p>\n\n<p>Change it to use <code>%s</code> instead and then only check the first character of the string you get.</p>\n\n<p>Or as said in the comments, use <code>fgets</code> to get a string and deal with it as mentioned above.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1475677949, "post_id": 39876392, "comment_id": 67040245, "body": "<code>toupper(choice[i]);</code> is UB should <code>choice[i]</code> have a negative value and not <code>EOF</code>.  Could use  <code>toupper((unsigned char) choice[i]);</code> to insure that does not happen."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 1, "last_activity_date": 1475678727, "last_edit_date": 1475678727, "creation_date": 1475676916, "answer_id": 39876392, "question_id": 39876038, "link": "https://stackoverflow.com/questions/39876038/print-only-once-in-c/39876392#39876392", "title": "Print only once in C", "body": "<p>Your code is checking 1 char per time due to <code>scanf</code> format specifier \"%c\". That means your <code>scanf</code> exits, the first time, after the enter key and then, on next calls, returns immediately for all chars entered by user.</p>\n\n<p>To avoid this behavior you can take the whole input in a time.</p>\n\n<p>You can do something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main (void)\n{\n    int valid=0;\n    char choice[32];\n    size_t i=0;\n    int data;\n\n    while (valid==0)\n    {\n        printf(\"\\nDo you wish to try again (Type Y to continue Q to quit):\"); // print statement request for input\n\n        fgets(choice, sizeof(choice), stdin);\n\n        i=0;\n\n        while ((choice[i] != '\\0') &amp;&amp; (valid == 0))\n        {\n            data = toupper((unsigned char)(choice[i]));\n\n            if((data == 'Y') || (data == 'Q'))\n            {\n                valid= 1;\n            }\n\n            i++;\n        }\n\n        if (valid == 0)\n            printf(\"Error: Invalid choice\\n\"); // statement\n    }\n}\n</code></pre>\n\n<p>As you can see I used fgets to get input from user into a buffer, to store the whole input (multi chars) in one shot.</p>\n\n<p>After that you can loop throung input chars and check if one of those chars is a correct selection</p>\n"}, {"tags": [], "owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "is_accepted": false, "score": 1, "last_activity_date": 1475678726, "last_edit_date": 1475678726, "creation_date": 1475677126, "answer_id": 39876481, "question_id": 39876038, "link": "https://stackoverflow.com/questions/39876038/print-only-once-in-c/39876481#39876481", "title": "Print only once in C", "body": "<blockquote>\n  <p>How to print only one time the statement if a few wrong input</p>\n</blockquote>\n\n<ul>\n<li><p>One way of doing it is to scan the input into string and compare the first element against 'Y' and 'Q' as other answers have shown you how to do.</p></li>\n<li><p>However, If you don't want to use strings then, second way without using strings is to consume the additional characters after scanning the input using a loop this way:</p>\n\n<pre><code>int valid=0;\nchar choice;\n\nwhile (valid==0)\n{\n    printf(\"\\nDo you wish to try again (Type Y to continue Q to quit:\"); \n\n    scanf(\"%c\", &amp;choice); \n    // remove space before format specifier as you are consuming white spaces in the below loop\n\n\n    //consuming additional characters mechanism:\n\n    int consume_char; //to store consumed character (getchar() returns int)\n\n    //the below loop consumes all additional characters\n    while( ( (consume_char = getchar()) != '\\n' ) &amp;&amp; (consume_char != EOF)); \n\n\n    choice = (char) toupper(choice);\n\n    if((choice == 'Y') || (choice == 'Q')) valid= 1;\n    else printf(\"Error: Invalid choice\\n\"); // statement\n}\nreturn 0;\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 27, "user_id": 6112207, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1256450687715944/picture?type=large", "display_name": "JiaWei Lee", "link": "https://stackoverflow.com/users/6112207/jiawei-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1995, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1475678727, "creation_date": 1475675957, "last_edit_date": 1475677681, "question_id": 39876038, "link": "https://stackoverflow.com/questions/39876038/print-only-once-in-c", "title": "Print only once in C", "body": "<p>How to print only one time the statement if a few wrong input is key in:\nEg:\nif key in kkk, only will print one statement instead of the example below.\nsample output:</p>\n\n<p>Do you wish to try again (Type Y to continue Q to quit:kkk</p>\n\n<p>Error: Invalid choice</p>\n\n<p>Do you wish to try again (Type Y to continue Q to quit:Error: Invalid choice</p>\n\n<p>Do you wish to try again (Type Y to continue Q to quit:Error: Invalid choice</p>\n\n<p>Do you wish to try again (Type Y to continue Q to quit:</p>\n\n<pre><code>valid=0;\nwhile (valid==0)\n{\n    printf(\"\\nDo you wish to try again (Type Y to continue Q to quit:\"); \n    // print statement request for input\n    scanf(\" %c\", &amp;choice); // get user input\n    choice = toupper(choice);\n    if((choice == 'Y') || (choice == 'Q')) \n        valid= 1;\n    else \n        printf(\"Error: Invalid choice\\n\"); // statement\n}\n</code></pre>\n"}, {"tags": ["c", "static", "microcontroller", "stm32"], "comments": [{"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1475676777, "post_id": 39876027, "comment_id": 67039280, "body": "You most probably have a weakly defined symbol of the same name in some linked library."}, {"owner": {"reputation": 95, "user_id": 5483006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e40673ae5a53b21924f540cc5470b84d?s=128&d=identicon&r=PG&f=1", "display_name": "Delay", "link": "https://stackoverflow.com/users/5483006/delay"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1475679137, "post_id": 39876027, "comment_id": 67041240, "body": "i changed function name to &quot;TIMERrrrrr_Config&quot; but problem not solved"}, {"owner": {"reputation": 1473, "user_id": 6517894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0511b1daef16fed51233f70c4370dafc?s=128&d=identicon&r=PG&f=1", "display_name": "Realtime Rik", "link": "https://stackoverflow.com/users/6517894/realtime-rik"}, "edited": false, "score": 0, "creation_date": 1476276190, "post_id": 39876027, "comment_id": 67275460, "body": "Do you step into the right function with the right parameters and see everything set the same with the debugger in both cases?"}], "owner": {"reputation": 95, "user_id": 5483006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e40673ae5a53b21924f540cc5470b84d?s=128&d=identicon&r=PG&f=1", "display_name": "Delay", "link": "https://stackoverflow.com/users/5483006/delay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475856969, "creation_date": 1475675936, "last_edit_date": 1475856969, "question_id": 39876027, "link": "https://stackoverflow.com/questions/39876027/a-strange-occurrence-in-the-config-timer-on-stm32f103x", "title": "A strange occurrence in the config timer on STM32F103x", "body": "<p>I use this function for config timer on STM32F103RBT6</p>\n\n<pre><code>static void TIMER_Config(TIM_TypeDef* timer, uint16_t Period, uint16_t Prescaler, uint16_t ClockDivision, uint16_t CounterMode ,FunctionalState status)\n{\n    TIM_TimeBaseInitTypeDef TIM_TimeBaseStructure;\n\n    TIM_TimeBaseStructure.TIM_Period = Period;\n    TIM_TimeBaseStructure.TIM_Prescaler = Prescaler;\n    TIM_TimeBaseStructure.TIM_ClockDivision = ClockDivision;\n    TIM_TimeBaseStructure.TIM_CounterMode = CounterMode;\n    TIM_TimeBaseInit(timer, &amp;TIM_TimeBaseStructure);\n    TIM_ARRPreloadConfig(timer, status);\n\n    TIM_ClearITPendingBit(timer, TIM_IT_Update);\n    TIM_ITConfig(timer, TIM_IT_Update, status);\n    TIM_SetCounter(timer, 0);\n    TIM_Cmd(timer, status);\n}\n</code></pre>\n\n<p>I use this function as follows:</p>\n\n<pre><code>TIMER_Config(TIM1, 359, 1, 0, TIM_CounterMode_Up, ENABLE);\n</code></pre>\n\n<p>When I measured the output frequency everything is correct\nBut when I remove the \"static\" from the function The output frequency is changed!</p>\n\n<p>I use this code for measured the output frequency</p>\n\n<pre><code>void TIM1_UP_IRQHandler(void)\n{\n    static uint16_t us = 0;\n\n    if (TIM_GetITStatus(TIM1, TIM_IT_Update) != RESET)\n    {\n        TIM_ClearITPendingBit(TIM1,TIM_IT_Update);\n        GPIO_WriteBit(LED0_Port ,LED0_PIN,!GPIO_ReadOutputDataBit(LED0_Port,LED0_PIN));\n    }\n}\n</code></pre>\n\n<p>The measured frequency when \"static\" not removed is 50 kHz\nwhen I remove \"static\" ,frequency changed to 320 Hz!</p>\n\n<p>&lt;==<strong>UPDATE</strong>==></p>\n\n<p>This problem exists only on TIM1(Advance Timer) and this problem was not seen on the TIM2(General purpose Timer).</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1475676490, "post_id": 39875975, "comment_id": 67039076, "body": "Whilst this may be a worthwhile question, it&#39;s only tangentially a programming question.  It&#39;s likely to be more appropriate on <a href=\"https://unix.stackexchange.com\">Unix & Linux</a>, but first check whether it&#39;s a duplicate of <a href=\"//unix.stackexchange.com/q/179604\">How do fork and exec work?</a> or <a href=\"//unix.stackexchange.com/q/4377\">After fork(), where does the child begin its execution?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1475680204, "post_id": 39875987, "comment_id": 67042114, "body": "Nice way to phrase it!"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1475707766, "post_id": 39875987, "comment_id": 67056539, "body": "@Dmitry: Thanks, though I think I just pasted that from the manual :-)"}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 14, "last_activity_date": 1475675827, "creation_date": 1475675827, "answer_id": 39875987, "question_id": 39875975, "link": "https://stackoverflow.com/questions/39875975/working-of-fork/39875987#39875987", "title": "Working of fork", "body": "<p>It's not one function returning two values. It's one function <em>call</em> returning <em>twice</em>, once in each process, and in each of the two returns, one value is returned. In the parent process, the PID of the child is returned, and in the child process, zero is returned.</p>\n\n<p>Returning twice is the fundamental mechanism by which new processes are created.</p>\n"}, {"tags": [], "owner": {"reputation": 5635, "user_id": 365340, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/MxRJQ.jpg?s=128&g=1", "display_name": "Karthik Balaguru", "link": "https://stackoverflow.com/users/365340/karthik-balaguru"}, "is_accepted": false, "score": 0, "last_activity_date": 1475681630, "last_edit_date": 1475681630, "creation_date": 1475679508, "answer_id": 39877441, "question_id": 39875975, "link": "https://stackoverflow.com/questions/39875975/working-of-fork/39877441#39877441", "title": "Working of fork", "body": "<p>fork() does not return two values. fork() returns only one value but, it returns twice. It returns once within the parent process and once within the child process.</p>\n\n<p>For the parent process, the process id of child is returned on success. For the child process, the fork returns 0 and if the child wants to know its own process id, it can be done by using getpid() and if it wants to know its parent, it can be via getppid().</p>\n\n<p>After a fork() system call, there are two independent processes executing the same program text, but with separate copy of segments like stack, data and heap. The pid that is returned by fork() helps in distinguishing whether we are in parent process or child process. </p>\n\n<pre><code>pid_t processId;\n\nswitch(processId = fork())\n{\ncase -1:\n    // Error. Handle error as fork() failed.\ncase 0:\n    // Do actions specific to child.\ndefault :\n    // Do actions specific to parent.\n}\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5308987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3c6c61084986e598122eda626ccacc1?s=128&d=identicon&r=PG&f=1", "display_name": "Patt", "link": "https://stackoverflow.com/users/5308987/patt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1475681630, "creation_date": 1475675783, "question_id": 39875975, "link": "https://stackoverflow.com/questions/39875975/working-of-fork", "title": "Working of fork", "body": "<p>when we use fork, a function is called which creates a process and return two pid (one is parent id and other is child id). How is possible that a function is returning two value? I am not getting it, how fork actually works? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 71156, "user_id": 1190388, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5391819cc4abe0cb43587c9ef1808dbd?s=128&d=identicon&r=PG", "display_name": "hjpotter92", "link": "https://stackoverflow.com/users/1190388/hjpotter92"}, "edited": false, "score": 3, "creation_date": 1475675432, "post_id": 39875762, "comment_id": 67038230, "body": "But anyways, you are hoping for the wrong thing here."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475675590, "post_id": 39875762, "comment_id": 67038352, "body": "I&#39;m afraid you&#39;ll be disappointed of the result. BTW: what about test it yourself? And get function should <code>return data.value</code>"}, {"owner": {"reputation": 75, "user_id": 5431541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abd85bf5c4f5ee2b67e1db00fc6d542b?s=128&d=identicon&r=PG&f=1", "display_name": "Koi", "link": "https://stackoverflow.com/users/5431541/koi"}, "edited": false, "score": 0, "creation_date": 1475675784, "post_id": 39875762, "comment_id": 67038517, "body": "I don&#39;t have a computer handy it was just a thought while on the bus"}, {"owner": {"reputation": 8020, "user_id": 1237747, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5674cd4a4abd08d63c5c3de20afbc97d?s=128&d=identicon&r=PG", "display_name": "ST3", "link": "https://stackoverflow.com/users/1237747/st3"}, "edited": false, "score": 0, "creation_date": 1475677506, "post_id": 39875762, "comment_id": 67039884, "body": "I&#39;m voting to close this question as off-topic because it asks: &quot;what does this code do&quot;. Answer: test yourself."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5431541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abd85bf5c4f5ee2b67e1db00fc6d542b?s=128&d=identicon&r=PG&f=1", "display_name": "Koi", "link": "https://stackoverflow.com/users/5431541/koi"}, "edited": false, "score": 0, "creation_date": 1475675885, "post_id": 39875903, "comment_id": 67038601, "body": "If File1.c and file2.c will be linked into separate executables then it would be ok?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 75, "user_id": 5431541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abd85bf5c4f5ee2b67e1db00fc6d542b?s=128&d=identicon&r=PG&f=1", "display_name": "Koi", "link": "https://stackoverflow.com/users/5431541/koi"}, "edited": false, "score": 0, "creation_date": 1475677365, "post_id": 39875903, "comment_id": 67039762, "body": "@Koi If they&#39;re in separate executables then yes they will be separate."}, {"owner": {"reputation": 75, "user_id": 5431541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abd85bf5c4f5ee2b67e1db00fc6d542b?s=128&d=identicon&r=PG&f=1", "display_name": "Koi", "link": "https://stackoverflow.com/users/5431541/koi"}, "edited": false, "score": 0, "creation_date": 1475714140, "post_id": 39875903, "comment_id": 67058112, "body": "Actually what if the header.h and header.c files are used to generate a library.... And other applications use that library.......will the executables have their own copy of data?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 75, "user_id": 5431541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abd85bf5c4f5ee2b67e1db00fc6d542b?s=128&d=identicon&r=PG&f=1", "display_name": "Koi", "link": "https://stackoverflow.com/users/5431541/koi"}, "edited": false, "score": 0, "creation_date": 1475715509, "post_id": 39875903, "comment_id": 67058366, "body": "@Koi Yes, each executable will have its own copy."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1475677333, "last_edit_date": 1475677333, "creation_date": 1475675612, "answer_id": 39875903, "question_id": 39875762, "link": "https://stackoverflow.com/questions/39875762/including-header-files-in-multiple-source-files-in-c/39875903#39875903", "title": "Including header files in multiple source files in C", "body": "<p>Assuming file1.c and file2.c are linked into a single executable along with header.c, they will be referencing the same variable.  So if you call <code>edit</code> with a value of 99 from a function in file1.c, a subsequent call to <code>get</code> from a function in file2.c will return 99.</p>\n\n<p>The only way you could get different results is if you were to pass an instance of <code>My_Struct</code> to these functions, so each calling function could use a different instance.</p>\n\n<p>If on the other hand file1.c and file2.c are each linked into separate executables, then each one (each running instance, actually) will have its own copy of <code>data</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1548, "user_id": 3082873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wT9Nk.jpg?s=128&g=1", "display_name": "cagdas", "link": "https://stackoverflow.com/users/3082873/cagdas"}, "is_accepted": false, "score": 0, "last_activity_date": 1475675652, "creation_date": 1475675652, "answer_id": 39875917, "question_id": 39875762, "link": "https://stackoverflow.com/questions/39875762/including-header-files-in-multiple-source-files-in-c/39875917#39875917", "title": "Including header files in multiple source files in C", "body": "<p>You cannot keep different values for each from same reference. To do that you can define an array of the struct like :</p>\n\n<pre><code>int n = 2;\nMy_Struct structsOfMine[n];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 875, "user_id": 6918481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/949bc6de647c79a6a432bc8ed1a51b5b?s=128&d=identicon&r=PG&f=1", "display_name": "Shiping", "link": "https://stackoverflow.com/users/6918481/shiping"}, "is_accepted": false, "score": 0, "last_activity_date": 1475675944, "creation_date": 1475675944, "answer_id": 39876033, "question_id": 39875762, "link": "https://stackoverflow.com/questions/39875762/including-header-files-in-multiple-source-files-in-c/39876033#39876033", "title": "Including header files in multiple source files in C", "body": "<p>Assume you have the following two lines in both file1.c and file2.c, you'll get 99.</p>\n\n<p>&sharp;include \"Header.h\"</p>\n\n<p>extern My_Struct data;</p>\n"}, {"tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1475676835, "last_edit_date": 1475676835, "creation_date": 1475676526, "answer_id": 39876236, "question_id": 39875762, "link": "https://stackoverflow.com/questions/39875762/including-header-files-in-multiple-source-files-in-c/39876236#39876236", "title": "Including header files in multiple source files in C", "body": "<p>If <code>file1.c</code> and <code>file2.c</code> only include the header, then when you compile them to object files and link them to make a program, it will fail due to the unresolved symbols <code>get</code> and <code>edit</code>.</p>\n\n<p>If you link both object object files together with the translation of <code>Header.c</code> into one program, then they share one single instance of the object called <code>data</code> which is provided by a single external definition in the entire program: the definition <code>My_Struct data={0};</code>.  The <code>Header.h</code> file only declares the type <code>My_Struct</code>.</p>\n\n<p>You can link <code>file1.c</code> with <code>Header.c</code> into one program, and then link <code>file1.c</code> and <code>Header.c</code> into another program. Then those two units are in separate programs and do not share the same <code>data</code>.</p>\n\n<p>If you want the effect in one program, you can change <code>Header.h</code> like this:</p>\n\n<pre><code>typedef struct\n{\n    int value;\n}My_Struct;\n\nstatic My_Struct data={0};\n\nstatic void edit(int num)\n{\n      data.value = num;\n}\n\nstatic int get()\n{\n     Return data.value;\n}\n</code></pre>\n\n<p>Now every translation unit which includes this header gets its own external definition of <code>data</code> and the two functions, which refer to that same <code>data</code>. These definitions of <code>data</code>, <code>edit</code> and <code>get</code> have <em>internal linkage</em> thanks to the <code>static</code> storage class specifier, making them invisible from other translation units.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1475679386, "creation_date": 1475679386, "answer_id": 39877406, "question_id": 39875762, "link": "https://stackoverflow.com/questions/39875762/including-header-files-in-multiple-source-files-in-c/39877406#39877406", "title": "Including header files in multiple source files in C", "body": "<p>The issue isn't the <code>Header.h</code> file; the issue is in the <code>Header.c</code> file:</p>\n\n<pre><code>My_Struct data={0};\n\nvoid edit(int num)\n{\n      data.value = num;\n}\nint get()\n{\n     Return data.value;\n}\n</code></pre>\n\n<p>You've created a <em>single</em> instance of the <code>data</code> variable and made it global (meaning it can be accessed by name from another translation unit).  Assuming you build <code>Header.c</code>, <code>file1.c</code> and <code>file2.c</code> into a single executable:</p>\n\n<pre><code>gcc -o test0 file1.c file2.c Header.c\n</code></pre>\n\n<p>then only a single instance of <code>data</code> exists over the entire program, so any changes made to it by the code in <code>file1.c</code> will be picked up by the code in <code>file2.c</code> and vice-versa.    </p>\n\n<p>If you want to <em>guarantee</em> that <code>file1.c</code> and <code>file2.c</code> are dealing with separate instances of <code>data</code> <em>regardless</em> of whether they're linked into the same executable or not, then the right way to go about this is to change the <code>get</code> and <code>edit</code> functions so that they take a <code>MyStruct</code> as a parameter:</p>\n\n<pre><code>// Header.h\ntypedef struct { int value; } MyStruct;\n\nvoid edit( int num, MyStruct *data);  \nint get( MyStruct data);  \n\n// Header.c\nvoid edit( int num, MyStruct *data)\n{\n  data-&gt;value = num;\n}\n\nint get( MyStruct data)\n{\n  return data.value;\n}\n</code></pre>\n\n<p>And then create separate instances of <code>data</code> within <code>file1.c</code> and <code>file2.c</code>:</p>\n\n<pre><code>// file1.c\n#include \"Header.h\"\n\nstatic MyStruct data = {0}; // static instance, not visible outside of file1.c,\n                            // exists over lifetime of program\n\nvoid foo( void )\n{\n  ...\n  edit( 99, &amp;data );\n  ...\n}\n\nvoid bar( void )\n{\n  ...\n  printf( \"data contains %d\\n\", get( data ) );\n  ...\n}\n\n// file2.c\n#include \"Header.h\"\n\nstatic MyStruct data = {0}; // Another static instance, not visible outside of file2.c\n                            // exists over lifetime of program\n\nvoid bletch( void )\n{\n  ...\n  edit( 42, &amp;data );\n  ...\n}\n\nvoid blurga( void )\n{\n  ...\n  printf( \"data contains %d\\n\", get( data ) );\n  ...\n}\n</code></pre>\n\n<p>If the linker sees the same file-scope object name declaration in multiple translation units (files), it will try to map those multiple declarations to a single object instance.  If we declared <code>data</code> <em>without</em> the <code>static</code> keyword in <code>file1.c</code> and <code>file2.c</code>, then the linker would have created only a single instance of <code>data</code>, and we'd be back where we started<sup>1</sup>.</p>\n\n<p>The <code>static</code> keyword tells the compiler to not export the object name to the linker; it effectively makes that instance of <code>data</code> \"private\" to the source file.  So, when <code>file1.c</code> and <code>file2.c</code> are linked into the same executable, they'll each have their own \"private\" instance of <code>data</code>, so changes made to <code>data</code> by code in <code>file1.c</code> won't be visible to the code in <code>file2.c</code>, and vice versa.</p>\n\n<p>Note that wherever possible, you <em>don't</em> want to create objects at file scope.  As a rule, functions should communicate using parameters and return values; they should not share state through global values unless it's <em>absolutely</em> necessary.  </p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>Actually, I'm not sure what happens when we have multiple <em>defining</em> declarations like we do in this case (the presence of the initializer makes it a defining declaration).  I want to say the linker will complain, but I'm not 100% sure.  \n</ol>\n\n<p></sup></p>\n"}], "owner": {"reputation": 75, "user_id": 5431541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abd85bf5c4f5ee2b67e1db00fc6d542b?s=128&d=identicon&r=PG&f=1", "display_name": "Koi", "link": "https://stackoverflow.com/users/5431541/koi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 39875903, "answer_count": 5, "score": 0, "last_activity_date": 1475679386, "creation_date": 1475675256, "last_edit_date": 1475676090, "question_id": 39875762, "link": "https://stackoverflow.com/questions/39875762/including-header-files-in-multiple-source-files-in-c", "title": "Including header files in multiple source files in C", "body": "<p>Consider the following example:\nHeader.h:</p>\n\n<pre><code>typedef struct\n{\n    int value;\n}My_Struct;\n\nvoid edit(int num);\nint get();\n</code></pre>\n\n<p>Header.c</p>\n\n<pre><code>My_Struct data={0};\n\nvoid edit(int num)\n{\n      data.value = num;\n}\nint get()\n{\n     Return data.value;\n}\n</code></pre>\n\n<p>If two files file1.c and file2.c both include header.h and file1.c calls the edit function to change value to 99, will a get function called from file2.c return 99 or the initialised 0?</p>\n\n<p>Im hoping it will return 0 and each file has its own copy of My_Struct.</p>\n"}, {"tags": ["c", "linux", "ptrace"], "answers": [{"comments": [{"owner": {"reputation": 819, "user_id": 2353008, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/pb5nr.jpg?s=128&g=1", "display_name": "Valarauca", "link": "https://stackoverflow.com/users/2353008/valarauca"}, "edited": false, "score": 0, "creation_date": 1475685997, "post_id": 39879516, "comment_id": 67045855, "body": "Thank you. I swear in my testing I attempted &lt;linux/ptrace.h&gt; I must have misspelled a variable and ran off painting yak sheds."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 2, "last_activity_date": 1475685964, "last_edit_date": 1475685964, "creation_date": 1475685652, "answer_id": 39879516, "question_id": 39875461, "link": "https://stackoverflow.com/questions/39875461/ptrace-sysemu-and-ptrace-sysemu-singlestep-not-defined-on-x64-or-x86/39879516#39879516", "title": "PTRACE_SYSEMU, and PTRACE_SYSEMU_SINGLESTEP not defined on x64 or x86?", "body": "<p>On Ubuntu 16.04 (and also 14.04), these are defined in <code>&lt;asm/ptrace-abi.h&gt;</code>, which is included by <code>&lt;asm/ptrace.h&gt;</code>, which in turn is included by <code>&lt;linux/ptrace.h&gt;</code>, but not by <code>&lt;sys/ptrace.h&gt;</code></p>\n\n<p>Since these request codes are linux specific (not part of any standard), if you want them, you need to <code>#include &lt;linux/ptrace.h&gt;</code></p>\n"}, {"comments": [{"owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1489224639, "post_id": 42733553, "comment_id": 72585509, "body": "And patch to implement this for ARM is very simple at 2015: <a href=\"https://patchwork.kernel.org/patch/6834311/\" rel=\"nofollow noreferrer\">patchwork.kernel.org/patch/6834311</a>"}], "tags": [], "owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "is_accepted": false, "score": 0, "last_activity_date": 1489224487, "creation_date": 1489224487, "answer_id": 42733553, "question_id": 39875461, "link": "https://stackoverflow.com/questions/39875461/ptrace-sysemu-and-ptrace-sysemu-singlestep-not-defined-on-x64-or-x86/42733553#42733553", "title": "PTRACE_SYSEMU, and PTRACE_SYSEMU_SINGLESTEP not defined on x64 or x86?", "body": "<p>Sysemu is used in user-mode linux as optimization and described at <a href=\"http://sysemu.sourceforge.net/\" rel=\"nofollow noreferrer\">http://sysemu.sourceforge.net/</a> site. It is feature for UML (when special kernel runs as ordinary process) and not for typical users of <code>ptrace</code>.</p>\n\n<p>Its implementation in x86 linux can be checked by <code>TIF_SYSCALL_EMU</code> flag in lxr of linux kernel (<code>ptrace_resume</code>)</p>\n\n<p><a href=\"http://lxr.free-electrons.com/source/kernel/ptrace.c?v=4.10#L767\" rel=\"nofollow noreferrer\">http://lxr.free-electrons.com/source/kernel/ptrace.c?v=4.10#L767</a></p>\n\n<pre><code>767 static int ptrace_resume(struct task_struct *child, long request,\n768                          unsigned long data)\n   ...\n780 #ifdef TIF_SYSCALL_EMU\n781         if (request == PTRACE_SYSEMU || request == PTRACE_SYSEMU_SINGLESTEP)\n782                 set_tsk_thread_flag(child, TIF_SYSCALL_EMU);\n783         else\n784                 clear_tsk_thread_flag(child, TIF_SYSCALL_EMU);\n785 #endif\n</code></pre>\n\n<p><a href=\"http://lxr.free-electrons.com/ident?i=TIF_SYSCALL_EMU\" rel=\"nofollow noreferrer\">http://lxr.free-electrons.com/ident?i=TIF_SYSCALL_EMU</a> </p>\n\n<p>The only definition is for x86:</p>\n\n<p><a href=\"http://lxr.free-electrons.com/source/arch/x86/include/asm/thread_info.h?v=4.10#L85\" rel=\"nofollow noreferrer\">http://lxr.free-electrons.com/source/arch/x86/include/asm/thread_info.h?v=4.10#L85</a></p>\n\n<pre><code> 85 #define TIF_SYSCALL_EMU         6       /* syscall emulation active */\n</code></pre>\n"}], "owner": {"reputation": 819, "user_id": 2353008, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/pb5nr.jpg?s=128&g=1", "display_name": "Valarauca", "link": "https://stackoverflow.com/users/2353008/valarauca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 39879516, "answer_count": 2, "score": 1, "last_activity_date": 1489224487, "creation_date": 1475674474, "last_edit_date": 1475678754, "question_id": 39875461, "link": "https://stackoverflow.com/questions/39875461/ptrace-sysemu-and-ptrace-sysemu-singlestep-not-defined-on-x64-or-x86", "title": "PTRACE_SYSEMU, and PTRACE_SYSEMU_SINGLESTEP not defined on x64 or x86?", "body": "<p>My code is as follows:</p>\n\n<pre><code>#include &lt;sys/ptrace.h&gt;\n#include &lt;stdio.h&gt;\n\nint\nmain()\n{\n    printf(\"PTRACE_CONT: %d\\n\", PTRACE_CONT);\n    printf(\"PTRACE_SYSCALL: %d\\n\", PTRACE_SYSCALL);\n    printf(\"PTRACE_SINGLESTEP: %d\\n\", PTRACE_SINGLESTEP);\n    printf(\"PTRACE_SYSEMU: %d\\n\", PTRACE_SYSEMU);\n    printf(\"PTRACE_SYSEMU_SINGLESTEP: %d\\n\", PTRACE_SYSEMU_SINGLESTEP);\n    printf(\"PTRACE_LISTEN: %d\\n\", PTRACE_LISTEN);\n    return 0;\n}\n</code></pre>\n\n<p>I'm compiling with the default flags on Ubuntu16.04 (Linux x86_64 4.40-38), with gcc v5.4.0.</p>\n\n<p>This throws an error that <code>PTRACE_SYSEMU</code> is undeclared. While the <code>man ptrace</code> page <a href=\"http://man7.org/linux/man-pages/man2/ptrace.2.html\" rel=\"nofollow\">states it exists</a>. This is repeated for <code>PTRACE_SYSEMU_SINGLESTEP</code> if the line containing <code>PTRACE_SYSEMU</code> is commented out. Which the man page states <code>PTRACE_SYSEMU_SINGLESTEP</code> is only available for x86, <a href=\"https://lkml.org/lkml/2008/7/16/429\" rel=\"nofollow\">except a patch was merged to unify the x86 and x64</a> handling of <code>PTRACE_SYSEMU_SINGLESTEP</code> in 2008.</p>\n\n<p>This produces the same error on 32bit (well i686), or 64bit (AMD64). Is this distro specific? What is going on? </p>\n\n<p>I can confirm neither of these values are defined are in my <code>/usr/include/x86_64/linux/sys/ptrace.h</code>. But they are defined in kernel sources?!?</p>\n"}, {"tags": ["c", "bitmap", "rgba"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1475674751, "post_id": 39875456, "comment_id": 67037672, "body": "Google for &quot;image resize algorithm&quot;. Lots available on the net."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1475674828, "post_id": 39875456, "comment_id": 67037734, "body": "What is your question ?"}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1475676134, "post_id": 39875456, "comment_id": 67038818, "body": "rgbaResize() function how to implement, or algorithm of rasizing rgba up/down"}, {"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1475676448, "post_id": 39875456, "comment_id": 67039047, "body": "Bilinear Interpolation is what you may want. Be aware, there are a plethora of different ways to resize an image. Some are plainly intuitive and quite small/simple to code, others use cubic-splines to blend between the values of multiple pixels in order to provide smooth up-sized images."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1475691321, "post_id": 39875456, "comment_id": 67048777, "body": "if you can find a fft library then it&#39;s also a good way to go"}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1475761647, "post_id": 39875456, "comment_id": 67081083, "body": "how this problem is typically solved by most libraries like .NET, Cocoa, Java? where there are functions to set size of bitmap?"}], "owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475762001, "creation_date": 1475674452, "last_edit_date": 1475762001, "question_id": 39875456, "link": "https://stackoverflow.com/questions/39875456/resizing-rgba-bitmap-images-stored-in-c-as-bytes-array", "title": "Resizing RGBA bitmap images stored in C as bytes array", "body": "<p>I have images stored as raw RGBA bitmaps in C. I am using: </p>\n\n<pre><code>unsigned char *rgbaData \nsize_t rgbaDataLength; \nsize_t width; \nsize_t height; \n</code></pre>\n\n<p>And now I consider how should I rescale it (resize it) to obtain from current <strong>width/height -> new_width/new_height</strong>. </p>\n\n<p>I need to write function like this prototype: </p>\n\n<pre><code>int rgbaResize(const unsigned char *rgbaData, const size_t rgbaDataLength, \nconst size_t width, const_size_t height, const size_t newWidth, \nconst size_t newHeight, unsigned char **newRgbaData, size_t *newRgbaDataLength);\n</code></pre>\n\n<p>I mean about something like this, but cross-platform solution or user implementation: </p>\n\n<pre><code>let context = CGBitmapContextCreate(nil, width, height, bitsPerComponent, bytesPerRow, colorSpace, bitmapInfo.rawValue)\n\nCGContextSetInterpolationQuality(context, kCGInterpolationHigh)\n\nCGContextDrawImage(context, CGRect(origin: CGPointZero, size: CGSize(width: CGFloat(width), height: CGFloat(height))), cgImage)\n\nlet scaledImage = CGBitmapContextCreateImage(context).flatMap { UIImage(CGImage: $0) }\n</code></pre>\n\n<p>It can be done by some free, open source and light cross-platform library? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475672891, "post_id": 39874751, "comment_id": 67036168, "body": "What is <code>&#39;C&#39;</code> language? I only know C language (It&#39;s a name, not a <code>&#39;name&#39;</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 1048, "user_id": 2932847, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a7c3ce39476765c29d28e0b1749e143?s=128&d=identicon&r=PG", "display_name": "poe123", "link": "https://stackoverflow.com/users/2932847/poe123"}, "is_accepted": false, "score": 1, "last_activity_date": 1475673102, "creation_date": 1475673102, "answer_id": 39874942, "question_id": 39874751, "link": "https://stackoverflow.com/questions/39874751/can-we-convert-x509-structure-format-to-x509-cerificate-in-pem-format/39874942#39874942", "title": "Can we convert x509 structure format to x509 cerificate in .PEM format?", "body": "<p>The function you're looking for is</p>\n\n<pre><code>int PEM_write_X509(FILE *fp, X509 *x);\n</code></pre>\n\n<p>function in </p>\n\n<blockquote>\n  <p>openssl/pem.h</p>\n</blockquote>\n\n<p>It saves the certificate to open file.</p>\n"}], "owner": {"reputation": 51, "user_id": 1733882, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cabf6136c16985ee986734cc3fa4324b?s=128&d=identicon&r=PG", "display_name": "Shwetha Mahadik", "link": "https://stackoverflow.com/users/1733882/shwetha-mahadik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1475673364, "creation_date": 1475672596, "last_edit_date": 1475673364, "question_id": 39874751, "link": "https://stackoverflow.com/questions/39874751/can-we-convert-x509-structure-format-to-x509-cerificate-in-pem-format", "title": "Can we convert x509 structure format to x509 cerificate in .PEM format?", "body": "<p>I am trying to get the peer certificate and updating the received certificate into <code>X509</code> structure as follows:</p>\n\n<pre><code>X509 * cert = NULL;\ncert = SSL_get_peer_certificate(ssl);\n</code></pre>\n\n<p>Is it possible to convert the <code>X509</code> structure format to x509 certificate .PEM format?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 4, "creation_date": 1475672200, "post_id": 39874577, "comment_id": 67035636, "body": "what do you think &amp;rightGuess means in your printf?"}, {"owner": {"reputation": 779, "user_id": 1581287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O6sfa.jpg?s=128&g=1", "display_name": "Aleksandar Matic", "link": "https://stackoverflow.com/users/1581287/aleksandar-matic"}, "edited": false, "score": 2, "creation_date": 1475672263, "post_id": 39874577, "comment_id": 67035684, "body": "Nice one UKMonkey."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1475672503, "post_id": 39874577, "comment_id": 67035870, "body": "Upvoted, this approaches perfection 1) example code, 2) expected output, 3) actual output 4) well-written."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 5, "last_activity_date": 1475672255, "creation_date": 1475672255, "answer_id": 39874616, "question_id": 39874577, "link": "https://stackoverflow.com/questions/39874577/cant-get-a-number-guessing-game-to-work-in-c/39874616#39874616", "title": "Can&#39;t get a number guessing game to work in C", "body": "<p>Your call to <code>printf</code> ought to be</p>\n\n<p><code>printf(\"You guessed the number %d times\", rightGuess);</code></p>\n\n<p>i.e. <em>don't</em> pass a <em>pointer</em> to <code>rightGuess</code> in correspondence to the <code>%d</code> format specifier. Currently the program behaviour is undefined! (It could well be outputting the address of <code>rightGuess</code> which accounts for the large number - but don't ever rely on that; you need to use <code>%p</code> to output pointer addresses.)</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1475673226, "post_id": 39874710, "comment_id": 67036425, "body": "&quot;So the number 6356736 you saw in your program is the memory address&quot;. It <i>probably</i> is but might not be. I wouldn&#39;t assert that if I were you: the program behaviour is actually undefined."}], "tags": [], "owner": {"reputation": 654, "user_id": 5769640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6cc64214a6828f6e0f11e1e902982f?s=128&d=identicon&r=PG", "display_name": "sohnryang", "link": "https://stackoverflow.com/users/5769640/sohnryang"}, "is_accepted": false, "score": 7, "last_activity_date": 1475847829, "last_edit_date": 1475847829, "creation_date": 1475672484, "answer_id": 39874710, "question_id": 39874577, "link": "https://stackoverflow.com/questions/39874577/cant-get-a-number-guessing-game-to-work-in-c/39874710#39874710", "title": "Can&#39;t get a number guessing game to work in C", "body": "<p>Maybe you made a mistake in <code>printf()</code>.</p>\n\n<p>If there is a variable named <code>var</code>, <code>&amp;var</code> means the memory address where variable <code>var</code> is. Maybe the number <code>6356736</code> you saw in your program is the memory address, not the value in variable var.</p>\n\n<p>You will have to change this line in order to print the value of variable <code>rightGuess</code></p>\n\n<pre><code>printf(\"You guessed the number %d times\", &amp;rightGuess);\n</code></pre>\n\n<p>To this line.</p>\n\n<pre><code>printf(\"You guessed the number %d times\", rightGuess);\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 6926465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/538e8e1447a07e86bc8c52ce845fb764?s=128&d=identicon&r=PG&f=1", "display_name": "KYC", "link": "https://stackoverflow.com/users/6926465/kyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "closed_date": 1476522609, "accepted_answer_id": 39874616, "answer_count": 2, "score": 5, "last_activity_date": 1475847829, "creation_date": 1475672132, "last_edit_date": 1475674821, "question_id": 39874577, "link": "https://stackoverflow.com/questions/39874577/cant-get-a-number-guessing-game-to-work-in-c", "closed_reason": "Not suitable for this site", "title": "Can&#39;t get a number guessing game to work in C", "body": "<p>Tried to write a program in C to say the amount of times you guessed the right number.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int i, searchNumber, Number, rightGuess;\n    rightGuess = 0;\n    printf(\"Give your number: \");\n    scanf(\"%d\",&amp;searchNumber);\n    printf(\"\\n\\n Give 10 numbers: \");\n    for(i=1;i&lt;=9;i++){\n        scanf(\"%d \\n\",&amp;Number);\n        if(Number == searchNumber){\n            rightGuess++;\n        }\n    }\n\n    printf(\"You guessed the number %d times\",&amp;rightGuess);\n    return 0;\n}\n</code></pre>\n\n<p>However every time I run it, it says I guessed the number 6356736 times. Even though I only entered a number 0 times. Any help?</p>\n"}, {"tags": ["c", "image-processing", "computer-vision", "image-resizing", "intel-ipp"], "comments": [{"owner": {"reputation": 12209, "user_id": 4926757, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-jsLBa8e0dT0/AAAAAAAAAAI/AAAAAAAAAEc/YqNqYlsSjrU/photo.jpg?sz=128", "display_name": "Rotem", "link": "https://stackoverflow.com/users/4926757/rotem"}, "edited": false, "score": 0, "creation_date": 1476480521, "post_id": 39874560, "comment_id": 67380609, "body": "According to the following example: <a href=\"https://software.intel.com/en-us/node/504353\" rel=\"nofollow noreferrer\">https://software.intel.com/en-us/node/504353</a>, The syntax is: <code>status = ippiResizeLanczos_8u_C3R(pSrc, srcStep, pDst, dstStep, dstOffset, dstSize, border, 0, pSpec, pBuffer);</code>. The resized image is returned in <code>pDst</code> (<code>pDst</code> is a pointer to a buffer of the output image)."}, {"owner": {"reputation": 12209, "user_id": 4926757, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-jsLBa8e0dT0/AAAAAAAAAAI/AAAAAAAAAEc/YqNqYlsSjrU/photo.jpg?sz=128", "display_name": "Rotem", "link": "https://stackoverflow.com/users/4926757/rotem"}, "edited": false, "score": 0, "creation_date": 1476481556, "post_id": 39874560, "comment_id": 67380958, "body": "Viewing the image:  See: <a href=\"https://visualstudiogallery.msdn.microsoft.com/e682d542-7ef3-402c-b857-bbfba714f78d\" rel=\"nofollow noreferrer\">Image Watch</a>, and <a href=\"http://opencv-srf.blogspot.co.il/2013/06/load-display-image.html\" rel=\"nofollow noreferrer\">OpenCV Tutorial</a>. You can also save the image as BMP (for example), and watch it outside VS2015. You can also display it in a window. Personally, I prefer saving image data, using <code>fwrite</code>, and display the image using Matlab."}, {"owner": {"reputation": 12209, "user_id": 4926757, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-jsLBa8e0dT0/AAAAAAAAAAI/AAAAAAAAAEc/YqNqYlsSjrU/photo.jpg?sz=128", "display_name": "Rotem", "link": "https://stackoverflow.com/users/4926757/rotem"}, "edited": false, "score": 0, "creation_date": 1476518861, "post_id": 39874560, "comment_id": 67388149, "body": "You can also view a raw image using <a href=\"http://www.irfanview.com/\" rel=\"nofollow noreferrer\">IrfanView</a>. Save image data to raw file: <code>FILE *f = NULL;fopen_s(&amp;f, &quot;RGB.raw&quot;, &quot;wb&quot;);fwrite(pDst, width*height*3, 1, f);fclose(f);</code>. Open <code>RGB.raw</code> with IrfanView. Fill <i>Image width</i> and <i>Image height</i> parameters. Select parameters: <i>24 bpp (3 bytes per pixel)</i>, and <i>Interleaved (RGB RGB ...)</i>."}, {"owner": {"reputation": 21, "user_id": 6926396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1446e5743ac17c5368ea9218ad3efdc5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/6926396/ali"}, "reply_to_user": {"reputation": 12209, "user_id": 4926757, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-jsLBa8e0dT0/AAAAAAAAAAI/AAAAAAAAAEc/YqNqYlsSjrU/photo.jpg?sz=128", "display_name": "Rotem", "link": "https://stackoverflow.com/users/4926757/rotem"}, "edited": false, "score": 0, "creation_date": 1476791144, "post_id": 39874560, "comment_id": 67485978, "body": "@ Rotem: Thank you for your answer. It worked for me..."}], "owner": {"reputation": 21, "user_id": 6926396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1446e5743ac17c5368ea9218ad3efdc5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/6926396/ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1185, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1476502796, "creation_date": 1475672085, "last_edit_date": 1476502796, "question_id": 39874560, "link": "https://stackoverflow.com/questions/39874560/resizing-an-image-using-intels-integrated-performance-primitives", "title": "Resizing an image using Intel&#39;s Integrated Performance Primitives", "body": "<p>I am new to C. I am using Intel's IPP for resizing an image in VS2015. I am trying to use <a href=\"https://software.intel.com/en-us/node/504353\" rel=\"nofollow\">ippiResizeLanczos_8u_C3R</a> function to resize the image. </p>\n\n<p>I do not know how to see/view the resized image or get the pixel values of the resized image (image after applying the above mentioned function), as I intend to use the resized image for further processing. The function perhaps returns only the \"IppStatus\". But I want to get the resized image or the data information (pixel values) of the resized image as return value.  </p>\n\n<p>Any help in this regard would be highly appreciated?</p>\n"}, {"tags": ["c", "matlab", "machine-learning", "svm", "libsvm"], "comments": [{"owner": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1475671969, "post_id": 39874327, "comment_id": 67035490, "body": "&quot; Although C -in general- is much faster than matlab&quot; Not necesarily"}, {"owner": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1475672014, "post_id": 39874327, "comment_id": 67035514, "body": "<a href=\"https://stackoverflow.com/questions/20513071/performance-tradeoff-when-is-matlab-better-slower-than-c-c\" title=\"performance tradeoff when is matlab better slower than c c\">stackoverflow.com/questions/20513071/&hellip;</a>"}, {"owner": {"reputation": 27269, "user_id": 2320035, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83d5a6d76755c6a987dd59495698dcfe?s=128&d=identicon&r=PG", "display_name": "sascha", "link": "https://stackoverflow.com/users/2320035/sascha"}, "edited": false, "score": 0, "creation_date": 1475673140, "post_id": 39874327, "comment_id": 67036349, "body": "Do more runs/benchmarks."}], "answers": [{"tags": [], "owner": {"reputation": 27269, "user_id": 2320035, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83d5a6d76755c6a987dd59495698dcfe?s=128&d=identicon&r=PG", "display_name": "sascha", "link": "https://stackoverflow.com/users/2320035/sascha"}, "is_accepted": false, "score": 1, "last_activity_date": 1475674525, "last_edit_date": 1495540110, "creation_date": 1475674154, "answer_id": 39875328, "question_id": 39874327, "link": "https://stackoverflow.com/questions/39874327/svmtrain-function-execution-time-in-matlab-vs-c-version/39875328#39875328", "title": "svmtrain function execution time in matlab vs C version", "body": "<p>As you are using the option <code>-b 1</code> to obtain probabilities:</p>\n\n<ul>\n<li>libsvm will use <a href=\"https://en.wikipedia.org/wiki/Platt_scaling\" rel=\"nofollow noreferrer\">Platt scaling</a> to obtain these probabilities with the usage of <a href=\"https://en.wikipedia.org/wiki/Cross-validation_(statistics)\" rel=\"nofollow noreferrer\">cross-validation</a></li>\n<li>cross-validation always splits the data <strong>randomly</strong></li>\n<li>Within C, <a href=\"https://tools.ietf.org/doc/libsvm-tools/FAQ.html#f421\" rel=\"nofollow noreferrer\">the default seed of 1 will be used</a></li>\n<li><strong>Maybe</strong> the Matlab interface will use a seed based on time (or any other)\n\n<ul>\n<li>As a first step, i would set Matlabs global seed to 1 and do the same for C; then measure again</li>\n</ul></li>\n</ul>\n\n<p>As indicated in my comment, it would be wise to do much more tests. Even if the seeds are different (a possibility), the average of many many runs should be the same <strong>as the same code is used</strong>!</p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/18880652/libsvm-c-vs-matlab-whats-with-the-different-accuracies\">this question</a> where some other possibilites for different behaviour are listed (you said you obtained the same number of SVs; but maybe the behaviour is different internally)</p>\n"}], "owner": {"reputation": 11, "user_id": 6926351, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210643450785876/picture?type=large", "display_name": "Norhan Shaker", "link": "https://stackoverflow.com/users/6926351/norhan-shaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1475674525, "creation_date": 1475671468, "question_id": 39874327, "link": "https://stackoverflow.com/questions/39874327/svmtrain-function-execution-time-in-matlab-vs-c-version", "title": "svmtrain function execution time in matlab vs C version", "body": "<p>I'm using libSVM, svmtrain function in matlab takes less time than C. Although C -in general- is much faster than matlab. Both classifiers take the same parameters and return the same number of SVMs with the same number of iterations.</p>\n\n<p>Here is the code in both:\nMatlab: </p>\n\n<p><code>t1=cputime;\nmodel = svmtrain(Labels,data, '-h 0 -s 0 -c 0.025 -n 0.01 -b 1 -t 0 -d 1 -p 0.001');\nt2=cputime;\nfprintf('Elapsed time=%.3f\\n',t2-t1)</code></p>\n\n<p>AND C code:</p>\n\n<pre><code>    clock_t begin = clock();\n    model = svm_train(&amp;prob,&amp;param);    \n    clock_t end = clock();;\n    double time_spent = (double)(end - begin) / double(CLOCKS_PER_SEC);\n</code></pre>\n"}, {"tags": ["c", "external", "public", "extern"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475671614, "post_id": 39874284, "comment_id": 67035234, "body": "First one mean that somewhere  ` c ` is defined as an  <code>int </code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475671685, "post_id": 39874284, "comment_id": 67035290, "body": "Both are declarations. depending on where it is placed, the second is <b>also</b> a definition, or a <i>tentative definition</i>."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475671633, "post_id": 39874369, "comment_id": 67035252, "body": "That does not answer the question."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475672492, "post_id": 39874369, "comment_id": 67035856, "body": "It still is missing something. And there is more to a declaration than telling an object exists. Hint: for this something like <code>extern my_variable;</code> would be sufficient (this is typical for assembler language)."}], "tags": [], "owner": {"reputation": 754, "user_id": 6811846, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/65f7cb0fdcba96a231d6a2ebd6e68956?s=128&d=identicon&r=PG&f=1", "display_name": "iWillGetBetter", "link": "https://stackoverflow.com/users/6811846/iwillgetbetter"}, "is_accepted": false, "score": 0, "last_activity_date": 1475688195, "last_edit_date": 1475688195, "creation_date": 1475671596, "answer_id": 39874369, "question_id": 39874284, "link": "https://stackoverflow.com/questions/39874284/declaration-and-definition-confusion-in-c/39874369#39874369", "title": "Declaration and definition confusion in C", "body": "<p>Long story short, <strong>defining</strong> something means <strong>providing all of the necessary information</strong> to create that thing in its entirety. However, <strong>declaring</strong> something means providing only enough information for the computer to <strong>know it exists</strong>.</p>\n\n<p><strong>Edit:</strong> To be clearer: A definition both defines and declares, a declaration <strong>ONLY</strong> declares. When you are using the <code>extern</code> keyword by definition you are not defining anything. Your confusion stems from <a href=\"http://www.geeksforgeeks.org/understanding-extern-keyword-in-c/\" rel=\"nofollow\">the understanding</a> of <code>extern</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1475671883, "creation_date": 1475671883, "answer_id": 39874473, "question_id": 39874284, "link": "https://stackoverflow.com/questions/39874284/declaration-and-definition-confusion-in-c/39874473#39874473", "title": "Declaration and definition confusion in C", "body": "<p>The <code>extern</code> keyword is what makes the first line a declaration.  It say \"this variable exists somewhere\".  A line like that can appear in a header file.</p>\n\n<p>The second line is a definition because the <code>extern</code> keyword is not present.  If you were to have this line in a header file, two source files that include that header will both define that variable and linking those two files will result in a variable redefinition error.</p>\n"}, {"tags": [], "owner": {"reputation": 30181, "user_id": 209629, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3784fe19d5c3d40d66ba91788f9bf007?s=128&d=identicon&r=PG", "display_name": "vz0", "link": "https://stackoverflow.com/users/209629/vz0"}, "is_accepted": false, "score": 1, "last_activity_date": 1475671957, "creation_date": 1475671957, "answer_id": 39874515, "question_id": 39874284, "link": "https://stackoverflow.com/questions/39874284/declaration-and-definition-confusion-in-c/39874515#39874515", "title": "Declaration and definition confusion in C", "body": "<p>A <strong>definition</strong> creates space for a variable:</p>\n\n<pre><code>int c;\n</code></pre>\n\n<p>Wherever you put this line, either local, global, this says that a new variable <code>c</code> of type <code>int</code> shall come to life.</p>\n\n<pre><code>extern int c;\n</code></pre>\n\n<p>A <strong>declaration</strong> says that there is somewhere else some variable <code>c</code> of type <code>int</code>. By using <code>extern</code>, you say that <code>c</code> is defined somewhere else. If you put only an <code>extern</code> declaration without a definition somewhere else, you will have a link error. Using extern is the equivalent of a forward declaration of a function:</p>\n\n<pre><code>/* declaration */\nint f(int x);\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>/* definition */\nint f(int x) {\n  return x*x;\n}\n</code></pre>\n\n<p>The first means that there is somewhere a function <code>f</code> returning an <code>int</code> and accepting an <code>int</code> as parameter. The latter is the actual function, its code, which also works both as a declaration and a definition.</p>\n\n<p>IMO, this declaration-vs-definition naming is confusing. I hardly remember which one is what, and I usually need to think about it. You should, however, understand the what <code>extern</code> means and what a forward declaration is.</p>\n"}, {"tags": [], "owner": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "is_accepted": false, "score": 1, "last_activity_date": 1475672073, "creation_date": 1475672073, "answer_id": 39874555, "question_id": 39874284, "link": "https://stackoverflow.com/questions/39874284/declaration-and-definition-confusion-in-c/39874555#39874555", "title": "Declaration and definition confusion in C", "body": "<p>When the program you're writing consists of multiple source files linked together, where some of the variables defined, for example, in source file file1.c need to be referenced in other source files, so this is the reason why using extern.</p>\n\n<p>About your question how these lines differ:</p>\n\n<pre><code>extern int c;\nint c;\n</code></pre>\n\n<ul>\n<li><p>A variable is defined when the compiler allocates the storage for the\nvariable while</p></li>\n<li><p>A variable is declared when the compiler is informed that a variable\nexists (and this is its type); it does not allocate the storage for\nthe variable at that point.</p></li>\n</ul>\n\n<p>so only <code>int c;</code> is defined while <code>extern int c;</code> is declared .</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6385115"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 1, "accepted_answer_id": 39874473, "answer_count": 4, "score": 6, "last_activity_date": 1475688195, "creation_date": 1475671349, "last_edit_date": 1495540423, "question_id": 39874284, "link": "https://stackoverflow.com/questions/39874284/declaration-and-definition-confusion-in-c", "title": "Declaration and definition confusion in C", "body": "<p>This <a href=\"https://stackoverflow.com/a/1164190/6385115\">answer</a> confused me.</p>\n\n<p>If we have two lines in same .c file:</p>\n\n<pre><code>extern int c;\nint c;\n</code></pre>\n\n<ul>\n<li>How is the first line of code a declaration and second a definition?</li>\n<li>Aren't both declarations?</li>\n<li>How these two lines differ?</li>\n</ul>\n"}, {"tags": ["c", "clang", "llvm", "abstract-syntax-tree", "control-flow-graph"], "comments": [{"owner": {"reputation": 548, "user_id": 1305700, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/cd05d6702e9f8998cfe6a6d503ed36e1?s=128&d=identicon&r=PG", "display_name": "JammingThebBits", "link": "https://stackoverflow.com/users/1305700/jammingthebbits"}, "edited": false, "score": 0, "creation_date": 1475961703, "post_id": 39874058, "comment_id": 67156845, "body": "It would greatly appreciated if someone could kindly give me some assistance/tips,  thank you all"}, {"owner": {"reputation": 792, "user_id": 1965985, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/5f8o2.jpg?s=128&g=1", "display_name": "Gizmo", "link": "https://stackoverflow.com/users/1965985/gizmo"}, "edited": false, "score": 0, "creation_date": 1569938927, "post_id": 39874058, "comment_id": 102752847, "body": "Did you manage to do this? I would like to do it as well."}, {"owner": {"reputation": 548, "user_id": 1305700, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/cd05d6702e9f8998cfe6a6d503ed36e1?s=128&d=identicon&r=PG", "display_name": "JammingThebBits", "link": "https://stackoverflow.com/users/1305700/jammingthebbits"}, "reply_to_user": {"reputation": 792, "user_id": 1965985, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/5f8o2.jpg?s=128&g=1", "display_name": "Gizmo", "link": "https://stackoverflow.com/users/1965985/gizmo"}, "edited": false, "score": 1, "creation_date": 1569999851, "post_id": 39874058, "comment_id": 102771611, "body": "@Gizmo I eventually left this DIY project, but it seams cmoses elaborated below. Good luck!"}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 6637328, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8dae8f92223623919f7ad21a796642?s=128&d=identicon&r=PG&f=1", "display_name": "cmoses", "link": "https://stackoverflow.com/users/6637328/cmoses"}, "is_accepted": false, "score": 3, "last_activity_date": 1499759889, "last_edit_date": 1499759889, "creation_date": 1499758662, "answer_id": 45028249, "question_id": 39874058, "link": "https://stackoverflow.com/questions/39874058/how-to-extract-from-source-code-a-control-flow-graph-by-using-clang/45028249#45028249", "title": "How to extract from source code a Control Flow Graph by using Clang?", "body": "<p>I was able to generate the CFGs using a different method than you mentioned above. It may do what you need. Comment out the following line (TEMPORARILY):</p>\n\n<p><code>sys::fs::remove(Filename);</code></p>\n\n<p>from the <code>ExecGraphViewer()</code> function in Support/GraphWriter.cpp and rebuild clang.</p>\n\n<p>Then, run the clang static analysis tool:</p>\n\n<pre><code>clang -cc1 -analyze -analyze-checker=debug.ViewCFG src_code.cpp\n</code></pre>\n\n<p>Typically this command will open a graphical viewer to view your CFG in, then when you are done it will delete all of the .dot files it created for viewing. But if you comment this line out you can copy these files elsewhere even after you close the viewer.</p>\n\n<p>Be sure to add it back in or else it will probably get really big...</p>\n\n<p>Also want to add that I was helped by <a href=\"http://adamrehn.com/\" rel=\"nofollow noreferrer\">Adam</a></p>\n"}, {"tags": [], "owner": {"reputation": 792, "user_id": 1965985, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/5f8o2.jpg?s=128&g=1", "display_name": "Gizmo", "link": "https://stackoverflow.com/users/1965985/gizmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1571232950, "creation_date": 1571232950, "answer_id": 58414683, "question_id": 39874058, "link": "https://stackoverflow.com/questions/39874058/how-to-extract-from-source-code-a-control-flow-graph-by-using-clang/58414683#58414683", "title": "How to extract from source code a Control Flow Graph by using Clang?", "body": "<p>This source code snippet is going to print the CFG for a given function (in this case, the main function) to the terminal. </p>\n\n<pre><code>#include \"clang/ASTMatchers/ASTMatchFinder.h\"\n#include \"clang/ASTMatchers/ASTMatchers.h\"\n#include \"clang/Analysis/CFG.h\"\n#include \"clang/Basic/LangOptions.h\"\n#include \"clang/Frontend/FrontendActions.h\"\n#include \"clang/Tooling/CommonOptionsParser.h\"\n#include \"clang/Tooling/Tooling.h\"\n#include \"llvm/Support/CommandLine.h\"\n\nusing namespace clang;\nusing namespace clang::ast_matchers;\nusing namespace clang::tooling;\n\nusing namespace llvm;\n\nDeclarationMatcher FunctionMatcher =\n    functionDecl(isMain()).bind(\"mainFunction\");\n\nclass CFGPrinter : public MatchFinder::MatchCallback {\npublic:\n  virtual void run(const MatchFinder::MatchResult &amp;Result) {\n    if (const FunctionDecl *funcDecl =\n            Result.Nodes.getNodeAs&lt;clang::FunctionDecl&gt;(\"mainFunction\")) {\n      ASTContext *context = Result.Context;\n      Stmt *funcBody = funcDecl-&gt;getBody();\n      static std::unique_ptr&lt;CFG&gt; sourceCFG = CFG::buildCFG(\n          funcDecl, funcBody, context, clang::CFG::BuildOptions());\n      auto langOpt = context-&gt;getLangOpts();\n      sourceCFG-&gt;dump(langOpt, true);\n    }\n  }\n};\n\n// Apply a custom category to all command-line options so that they are the\n// only ones displayed.\nstatic llvm::cl::OptionCategory MyToolCategory(\"my-tool options\");\n\n// CommonOptionsParser declares HelpMessage with a description of the common\n// command-line options related to the compilation database and input files.\n// It's nice to have this help message in all tools.\nstatic cl::extrahelp CommonHelp(CommonOptionsParser::HelpMessage);\n\n// A help message for this specific tool can be added afterwards.\nstatic cl::extrahelp MoreHelp(\"\\nMore help text...\\n\");\n\nint main(int argc, const char **argv) {\n  CommonOptionsParser OptionsParser(argc, argv, MyToolCategory);\n  ClangTool Tool(OptionsParser.getCompilations(),\n                 OptionsParser.getSourcePathList());\n\n  CFGPrinter Printer;\n  MatchFinder Finder;\n  Finder.addMatcher(FunctionMatcher, &amp;Printer);\n\n  return Tool.run(newFrontendActionFactory(&amp;Finder).get());\n}\n</code></pre>\n"}], "owner": {"reputation": 548, "user_id": 1305700, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/cd05d6702e9f8998cfe6a6d503ed36e1?s=128&d=identicon&r=PG", "display_name": "JammingThebBits", "link": "https://stackoverflow.com/users/1305700/jammingthebbits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3644, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1571232950, "creation_date": 1475670708, "last_edit_date": 1476081244, "question_id": 39874058, "link": "https://stackoverflow.com/questions/39874058/how-to-extract-from-source-code-a-control-flow-graph-by-using-clang", "title": "How to extract from source code a Control Flow Graph by using Clang?", "body": "<p>For the past 5 years I have been using Gnu Compiler Collection (gcc/g++),so I'm a newbie for clang and I would like to generate\na control flow graph for C/Objective C/C++ source code.\nThankfully I have read <a href=\"http://clang.llvm.org/docs/InternalsManual.html#conditional-control-flow\" rel=\"nofollow\">here</a> and <a href=\"http://adamrehn.com/articles/matching-cfg-blocks-to-basic-blocks/#generating-clang-source-level-cfgs\" rel=\"nofollow\">here</a> and found out I can get basic blocks representation of source-level statements by using the CFG class functions:\nCFG::buildCFG()\nCFG::dump()</p>\n\n<p>which is great :) , but it's <strong>still unclear</strong> for me how do I get the function's body in AST form and ASTContext before passing it to buildCFG??</p>\n\n<p>Can someone please <strong>give here a short snippet</strong> which demonstrates how do I export with clang a CFG for a given source code ?</p>\n\n<p>Thank you all</p>\n"}, {"tags": ["c", "azure", "asp.net-web-api", "forms-authentication", "basic-authentication"], "comments": [{"owner": {"reputation": 6106, "user_id": 932833, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81ec9cc5b9c8ffe419a80ce5a25ffdb8?s=128&d=identicon&r=PG", "display_name": "Neil Thompson", "link": "https://stackoverflow.com/users/932833/neil-thompson"}, "edited": false, "score": 0, "creation_date": 1475678763, "post_id": 39873607, "comment_id": 67040918, "body": "locally both apps probably use localhost, so share the cookie - but once deployed they are separate apps so don&#39;t share the authentication cookie"}, {"owner": {"reputation": 1024, "user_id": 5244641, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/0C6Rf.jpg?s=128&g=1", "display_name": "Skull", "link": "https://stackoverflow.com/users/5244641/skull"}, "reply_to_user": {"reputation": 6106, "user_id": 932833, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81ec9cc5b9c8ffe419a80ce5a25ffdb8?s=128&d=identicon&r=PG", "display_name": "Neil Thompson", "link": "https://stackoverflow.com/users/932833/neil-thompson"}, "edited": false, "score": 0, "creation_date": 1475728388, "post_id": 39873607, "comment_id": 67061534, "body": "@NeilThompson Is there a way to add cookies into request??"}, {"owner": {"reputation": 13794, "user_id": 4870358, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Os0to.jpg?s=128&g=1", "display_name": "Marcus H&#246;glund", "link": "https://stackoverflow.com/users/4870358/marcus-h%c3%b6glund"}, "edited": false, "score": 0, "creation_date": 1476684708, "post_id": 39873607, "comment_id": 67431902, "body": "Is this solved?"}], "answers": [{"tags": [], "owner": {"reputation": 1024, "user_id": 5244641, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/0C6Rf.jpg?s=128&g=1", "display_name": "Skull", "link": "https://stackoverflow.com/users/5244641/skull"}, "is_accepted": false, "score": 2, "last_activity_date": 1476162093, "creation_date": 1476162093, "answer_id": 39970769, "question_id": 39873607, "link": "https://stackoverflow.com/questions/39873607/owin-webapi-call-returning-401-unauthoried-error-in-azure/39970769#39970769", "title": "OWIN: webapi call returning 401 unauthoried Error in Azure", "body": "<p>This issue is due to cors\n you can solve this by adding in your request,</p>\n\n<pre><code> $http({\n  ....\n  headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n  withCredentials: true,\n  })\n</code></pre>\n\n<p><strong>WEB.Config</strong> of web API</p>\n\n<pre><code> &lt;system.webServer&gt;\n        &lt;validation validateIntegratedModeConfiguration=\"false\" /&gt;\n            &lt;handlers&gt;\n                &lt;remove name=\"ExtensionlessUrlHandler-ISAPI-4.0_32bit\" /&gt;\n                &lt;remove name=\"ExtensionlessUrlHandler-ISAPI-4.0_64bit\" /&gt;\n                &lt;remove name=\"ExtensionlessUrlHandler-Integrated-4.0\" /&gt;\n                &lt;remove name=\"OPTIONSVerbHandler\" /&gt;\n                &lt;remove name=\"TRACEVerbHandler\" /&gt;\n\n                &lt;add name=\"ExtensionlessUrlHandler-ISAPI-4.0_32bit\" path=\"*.\" verb=\"GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS\" modules=\"IsapiModule\" scriptProcessor=\"%windir%\\Microsoft.NET\\Framework\\v4.0.30319\\aspnet_isapi.dll\" preCondition=\"classicMode,runtimeVersionv4.0,bitness32\" responseBufferLimit=\"0\" /&gt;\n                &lt;add name=\"ExtensionlessUrlHandler-ISAPI-4.0_64bit\" path=\"*.\" verb=\"GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS\" modules=\"IsapiModule\" scriptProcessor=\"%windir%\\Microsoft.NET\\Framework64\\v4.0.30319\\aspnet_isapi.dll\" preCondition=\"classicMode,runtimeVersionv4.0,bitness64\" responseBufferLimit=\"0\" /&gt;\n                &lt;add name=\"ExtensionlessUrlHandler-Integrated-4.0\" path=\"*.\" verb=\"*\" type=\"System.Web.Handlers.TransferRequestHandler\" preCondition=\"integratedMode,runtimeVersionv4.0\" /&gt;\n            &lt;/handlers&gt;\n\n\n            &lt;httpProtocol&gt;\n                &lt;customHeaders&gt;\n                    &lt;add name=\"Access-Control-Allow-Origin\" value=\"**FrontEnd URL**\" /&gt;\n                    &lt;add name=\"Access-Control-Allow-Headers\" value=\"Origin, X-Requested-With, Content-Type, Accept, Cache-Control\" /&gt;\n                    &lt;add name=\"Access-Control-Allow-Credentials\" value=\"true\" /&gt;\n                    &lt;add name=\"Access-Control-Allow-Methods\" value=\"GET, POST, PUT, DELETE, OPTIONS\" /&gt;\n                &lt;/customHeaders&gt;\n            &lt;/httpProtocol&gt;\n      &lt;/system.webServer&gt;\n</code></pre>\n\n<p>you also refer this URl as well:\n<a href=\"https://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api\" rel=\"nofollow\">https://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api</a></p>\n"}, {"tags": [], "owner": {"reputation": 991, "user_id": 6870582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9196bb9854ffa689f46798c68e640364?s=128&d=identicon&r=PG", "display_name": "Ben Hall", "link": "https://stackoverflow.com/users/6870582/ben-hall"}, "is_accepted": false, "score": 2, "last_activity_date": 1476775614, "last_edit_date": 1495542183, "creation_date": 1476565700, "answer_id": 40064227, "question_id": 39873607, "link": "https://stackoverflow.com/questions/39873607/owin-webapi-call-returning-401-unauthoried-error-in-azure/40064227#40064227", "title": "OWIN: webapi call returning 401 unauthoried Error in Azure", "body": "<p>This is probably because they are no longer hosted on the same machine (depending on your Azure setup). I've had a similar problem with <code>machineKey</code> myself.</p>\n\n<p>Follow the instructions in the following URL to match up the settings between the applications and you should be fine:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/eb0zx8fc.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/eb0zx8fc.aspx</a></p>\n\n<p>EDIT: With <code>Access-Control-Allow-Origin:*</code> in the response header it is probably not a normal CORS problem, although <code>machineKey</code> and CORS problems often come together. If the <code>machineKey</code> fix does not work, check how you are handling CORS pre-flight checks. See <a href=\"https://stackoverflow.com/questions/40093735/authorization-has-been-denied-when-creating-asp-net-web-api-with-api-key-validat/40094458#40094458\">my answer here</a>.</p>\n"}], "owner": {"reputation": 1024, "user_id": 5244641, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/0C6Rf.jpg?s=128&g=1", "display_name": "Skull", "link": "https://stackoverflow.com/users/5244641/skull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 865, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1476775614, "creation_date": 1475669440, "last_edit_date": 1475676953, "question_id": 39873607, "link": "https://stackoverflow.com/questions/39873607/owin-webapi-call-returning-401-unauthoried-error-in-azure", "title": "OWIN: webapi call returning 401 unauthoried Error in Azure", "body": "<p>I have created two applications one for front end(created using AngularJs and Asp.Net MVC) and for backend I used web Api application.</p>\n\n<p>I am trying to secure my application with forms authentication in front End and implemented basic forms authentication in back End.</p>\n\n<p>When I tested locally in IIS it works fine.But when I hosted my application in Azure, API call with authentication attribute returns with 401 unauthorized error.</p>\n\n<p>response Header:</p>\n\n<pre><code> Access-Control-Allow-Origin:*\n    Cache-Control:no-cache\n    Content-Length:0\n    Date:Wed, 05 Oct 2016 11:08:30 GMT\n    Expires:-1\n    Pragma:no-cache\n    Server:Microsoft-IIS/8.0\n    Set-Cookie:ARRAffinity=925cd503f9e5771e9ad651c59baa4a1f678d93cac8b9da4dc9bcb64892ac8710;Path=/;Domain=FrontEnd.azurewebsites.net\n    WWW-Authenticate:Basic realm=\"Backend.azurewebsites.net\"\n    X-AspNet-Version:4.0.30319\n    X-Powered-By:ASP.NET\n</code></pre>\n\n<p>Request Header;</p>\n\n<pre><code>Accept:application/json, text/plain, */*\nAccept-Encoding:gzip, deflate, sdch, br\nAccept-Language:en-US,en;q=0.8\nCache-Control:no-cache\nConnection:keep-alive\nHost:backend.azurewebsites.net\nOrigin:http://FrontEnd.azurewebsites.net\nPragma:no-cache\nReferer:http://FrontEnd.azurewebsites.net/\nToken:null\nUser-Agent:Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\n</code></pre>\n\n<p>But in local along with request header </p>\n\n<pre><code>    Authorization: Basic dmlzaG53guFua2FyLnNha3Roadh4bEBnbWFpbC5jb206MTIzMTIz\n   Cookie: __RequestVerificationToken_L3Nfg4dwc3Bh0=YGwlXkckjhg6xTESkI-lN9sNtDVsfefshsrvGWPKekmv_GLZ0Rq8eA5P8Z7sdf4trwbPX4WymcGJJrLamQLMe2Vf2D2fVUg4qJptOvcsCWg1; ASP.NET_SessionId=gk4s1rlsfg5gfeafo3455dkr; .ASPXAUTH=C8113FD23FC4902dsfrsdf5FB3399BA121703F41F9A57AEA50667F2AD4FC02F3D3955215A91F6A3A2EA4287202522380435A93D8BE78D45E6D24FB7E05F64653AE06E0026DEB2911343591563F70EE8EE76338F07CBABE6EA4B95359F3C31sdf9C999sdf2864849gfdB916A06gfds29E3C8D01D2371807E98335000D4D14B391CCE3zxcd49DB77696F4BB77E4434\n</code></pre>\n\n<p>is passed</p>\n\n<p>Authorization and Cookie parameter is not get added in request from azure frontEND app with forms authentication.</p>\n\n<p>I Looked into authentication/authorization configuration of my backend app in azure it sets off.can any body know what is the issue or what I need to configure in azure portal.Thanks in advance.</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "kernel-module", "i2c"], "comments": [{"owner": {"reputation": 1812, "user_id": 2689839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1pQkd.jpg?s=128&g=1", "display_name": "Parthiban", "link": "https://stackoverflow.com/users/2689839/parthiban"}, "edited": false, "score": 1, "creation_date": 1475670429, "post_id": 39872669, "comment_id": 67034405, "body": "It&#39;s hard for me fine tune to post in answer section. Before that, will it be possible for you to share the device name/number which you are going to use? To answer your question, yes you need to write the driver for the device itself in according layer. Example, write the led driver in linux/driver/leds/. As led itself exports the class /sys/class/leds, you may need to understand led core layers and write on top of it. I will be able to answer specific if I know the device itself."}], "answers": [{"comments": [{"owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "edited": false, "score": 0, "creation_date": 1476370583, "post_id": 39874324, "comment_id": 67326079, "body": "In <a href=\"http://lxr.free-electrons.com/source/drivers/mfd/wm8350-core.c?v=4.4#L276\" rel=\"nofollow noreferrer\">lxr.free-electrons.com/source/drivers/mfd/&hellip;</a> where does the <code>struct wm8350</code> get created?  How does the kernel know to call <code>wm8350_device_init</code> with a pointer to it?  (I&#39;ve previously used the  <code>module_init</code> macro in other modules and had not encountered <code>xxx_device_init</code> with arguments.)"}, {"owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "edited": false, "score": 0, "creation_date": 1476373376, "post_id": 39874324, "comment_id": 67328149, "body": "Don&#39;t worry about the comment above.  I was under the false impression that wm8350_core was the one which would be &quot;init&#39;ed&quot; and start the others.  <a href=\"http://lxr.free-electrons.com/source/drivers/mfd/wm8350-i2c.c?v=4.4#L48\" rel=\"nofollow noreferrer\">lxr.free-electrons.com/source/drivers/mfd/&hellip;</a> shows that its the wm8350-i2c module that is responsible for &quot;init&#39;ing&quot; the wm8350-core module."}], "tags": [], "owner": {"reputation": 2573, "user_id": 1101537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1087a838de98ff53402c4a0e9ab9b990?s=128&d=identicon&r=PG", "display_name": "alexander", "link": "https://stackoverflow.com/users/1101537/alexander"}, "is_accepted": true, "score": 2, "last_activity_date": 1475671466, "creation_date": 1475671466, "answer_id": 39874324, "question_id": 39872669, "link": "https://stackoverflow.com/questions/39872669/writing-kernel-modules-for-a-multi-function-i2c-device-one-or-many/39874324#39874324", "title": "Writing kernel module(s) for a multi-function i2c device - one or many?", "body": "<p>In linux sources take a look at wm8350 module. It consist of one core module bound to i2c bus and many child platform modules that uses core module API to access chip registers.</p>\n\n<p>Core module consist of:</p>\n\n<ul>\n<li><a href=\"http://lxr.free-electrons.com/source/drivers/mfd/wm8350-i2c.c\" rel=\"nofollow\" title=\"drivers/mfd/wm8350-i2c.c\">drivers/mfd/wm8350-i2c.c</a> - bind wm8350 to i2c bus</li>\n<li><a href=\"http://lxr.free-electrons.com/source/drivers/mfd/wm8350-core.c\" rel=\"nofollow\">drivers/mfd/wm8350-core.c</a> - create child platform devices and provide API for child devices</li>\n</ul>\n\n<p>GPIO module consist of:</p>\n\n<ul>\n<li><a href=\"http://lxr.free-electrons.com/source/drivers/gpio/gpio-wm8350.c\" rel=\"nofollow\">drivers/gpio/gpio-wm8350.c</a></li>\n</ul>\n\n<p>During core module initialization <a href=\"http://lxr.free-electrons.com/source/drivers/mfd/wm8350-i2c.c#L26\" rel=\"nofollow\">wm8350_i2c_probe()</a> get called. It calls <a href=\"http://lxr.free-electrons.com/source/drivers/mfd/wm8350-core.c#L276\" rel=\"nofollow\">wm8350_device_init()</a>. It create child platform devices using <a href=\"http://lxr.free-electrons.com/source/drivers/mfd/wm8350-core.c#L254\" rel=\"nofollow\">wm8350_client_dev_register()</a>.</p>\n\n<p>Child module <a href=\"http://lxr.free-electrons.com/source/drivers/gpio/gpio-wm8350.c\" rel=\"nofollow\">drivers/gpio/gpio-wm8350.c</a> registers as module for \"platform:wm8350-gpio\" and it's entry point is <a href=\"http://lxr.free-electrons.com/source/drivers/gpio/gpio-wm8350.c#L107\" rel=\"nofollow\">wm8350_gpio_probe()</a>. </p>\n\n<p>In order to get access to core module, GPIO module do:</p>\n\n<pre><code>107 static int wm8350_gpio_probe(struct platform_device *pdev)\n108 {\n109         struct wm8350 *wm8350 = dev_get_drvdata(pdev-&gt;dev.parent);\n</code></pre>\n\n<p>And then it calls something like</p>\n\n<pre><code>36         return wm8350_set_bits(wm8350, WM8350_GPIO_CONFIGURATION_I_O,\n37                                1 &lt;&lt; offset);\n</code></pre>\n"}], "owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 1, "accepted_answer_id": 39874324, "answer_count": 1, "score": 4, "last_activity_date": 1475674925, "creation_date": 1475666649, "last_edit_date": 1475674925, "question_id": 39872669, "link": "https://stackoverflow.com/questions/39872669/writing-kernel-modules-for-a-multi-function-i2c-device-one-or-many", "title": "Writing kernel module(s) for a multi-function i2c device - one or many?", "body": "<p>I have an i2c device, built into the board I am developing for.  It responds to a single address, but the first byte (sometimes called \"command\" or \"register\") dictates the function addressed.</p>\n\n<p>I can use the device from userspace with <code>i2cset/get/detect</code>, so I know that everything is working.</p>\n\n<p>The device controls LEDs (and so should appear in <code>/sys/class/leds</code>).</p>\n\n<p>It also has GPIO (and so should appear in <code>/sys/class/gpio</code>).</p>\n\n<p>There are a further half-dozen different places where parts of the device's functionality should appear.</p>\n\n<p>Should I code this as:</p>\n\n<ol>\n<li>One i2c client module, and find a way to get things listed in the right places in <code>/sys</code>.</li>\n<li>One platform module and many driver modules, all sharing the single i2c device (somehow) with their module code in function-specific places.   </li>\n</ol>\n\n<p>(This is my first kernel module since late-2.4 or early-2.6, it was a long time ago.)</p>\n"}, {"tags": ["c", "standard-deviation"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1475666647, "post_id": 39872647, "comment_id": 67031904, "body": "Did you try to debug it first?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1475667028, "post_id": 39872647, "comment_id": 67032158, "body": "try change type <code>sum</code> and <code>average</code> to <code>double</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1475667786, "post_id": 39872647, "comment_id": 67032639, "body": "<code>s=sqrt(variance);</code> --&gt; <code>s=sqrt(variance&#47;n);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1475678443, "post_id": 39873128, "comment_id": 67040617, "body": "Casting <code>(double)</code> does fix OP&#39;s immediate problem.   Yet casting should be avoided as it requires maintenance of the cast with the types of <code>average, sum, n</code>, which may change.  Alternatives include <code>average = sum; average &#47;= n;</code> or <code>double sum = 0.0;</code>"}, {"owner": {"reputation": 438, "user_id": 3208823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/j3UF9.jpg?s=128&g=1", "display_name": "Kasun Dissanayake", "link": "https://stackoverflow.com/users/3208823/kasun-dissanayake"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475682434, "post_id": 39873128, "comment_id": 67043568, "body": "@chux, thank you very much for your input. I never thought about that."}], "tags": [], "owner": {"reputation": 438, "user_id": 3208823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/j3UF9.jpg?s=128&g=1", "display_name": "Kasun Dissanayake", "link": "https://stackoverflow.com/users/3208823/kasun-dissanayake"}, "is_accepted": true, "score": 1, "last_activity_date": 1475682208, "last_edit_date": 1475682208, "creation_date": 1475668009, "answer_id": 39873128, "question_id": 39872647, "link": "https://stackoverflow.com/questions/39872647/i-try-to-calculate-a-standard-deviation-of-less-than-100-numbers-in-c/39873128#39873128", "title": "I try to calculate a Standard deviation of less than 100 numbers in C", "body": "<p>There were two things to correct:<br>\n1. type of <code>average</code> should be <code>double</code><br>\n2. you have taken the variance incorrectly. after taking the sum of (x- average) you should divide it by <code>n</code></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\nint main()\n{\n    int n;\n    scanf(\"%d\", &amp;n);\n    int i = 0, sum = 0;\n    double average = 0;\n    int num[100] = { 0 };\n    double dvalue[100] = { 0.0 };\n    double variance = 0.0, s = 0.0;\n    for (i = 0; i &lt; n; i++) { //I just know this method to get the number array;\n        scanf(\"%d\", &amp;num[i]);\n        sum += num[i];\n    }\n    printf(\"sum %d\\n\", sum);\n    average = sum;   \n    average = average / n;\n    printf(\"average %lf\\n\", average);\n    for (i = 0; i &lt; n; i++) {\n        dvalue[i] = num[i] - average;\n        dvalue[i] = pow(dvalue[i], 2.0); //to get the (x-average)\u2026\u20262\n        variance += dvalue[i];\n    }\n    variance = variance / n; // population variance\n    s = sqrt(variance);\n    printf(\"varience %lf\\n\", variance);\n    printf(\"Population Standard deviation %lf\", s);\n\n    return 0;\n}\n</code></pre>\n\n<p>edited the answer according to @chux advice</p>\n"}], "owner": {"reputation": 49, "user_id": 6922025, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6eb103b47bacda7d60bd70b26a68ed1b?s=128&d=identicon&r=PG&f=1", "display_name": "Yyh", "link": "https://stackoverflow.com/users/6922025/yyh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "accepted_answer_id": 39873128, "answer_count": 1, "score": 0, "last_activity_date": 1475682208, "creation_date": 1475666591, "last_edit_date": 1475669573, "question_id": 39872647, "link": "https://stackoverflow.com/questions/39872647/i-try-to-calculate-a-standard-deviation-of-less-than-100-numbers-in-c", "title": "I try to calculate a Standard deviation of less than 100 numbers in C", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\nint main()\n{        \n    int n;\n    scanf(\"%d\",&amp;n);\n    int i=0,sum=0,average=0;\n    int num[100]={0};\n    double dvalue[100]={0.0};\n    double variance=0.0,s=0.0;\n    for(i=0;i&lt;n;i++){//I just know this method to get the number array;\n        scanf(\"%d\",&amp;num[i]);\n        sum+=num[i];\n    }\n    average=sum/n;\n    for(i=0;i&lt;n;i++){\n        dvalue[i]=num[i]-average;\n        dvalue[i]=pow(dvalue[i],2.0);//to get the (x-average\uff09\u2026\u20262\n        variance+=dvalue[i];\n    }\n    s=sqrt(variance);\n    return 0;\n}\n</code></pre>\n\n<p>this is my code,but it can't get the right answer.I am a new learner and this is the first time I seek help via stackoverflow I can't  get the output why?\nThanks for every one .I actually debug at first ,but I can't know how to modify it ,sincerely thanks again</p>\n"}, {"tags": ["c", "pointers", "language-lawyer"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1475666257, "post_id": 39872474, "comment_id": 67031592, "body": "A <code>void*</code> is always implicitly convertible to any other (data) pointer type, that&#39;s a given by the <code>C</code> standard."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1475666378, "post_id": 39872474, "comment_id": 67031697, "body": "@StoryTeller: Yes, but that only matters <i>if</i> there is a conversion being done."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1475666386, "post_id": 39872474, "comment_id": 67031706, "body": "Did you check how the <code>NULL</code> macro is defined in your implementation? It typically <b>is</b> <code>((void *)0)</code>. But if you pass <code>0</code> to a variadic function, it will be passed as <code>int</code>, which is not what you want. So you have to cast it anyway."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1475666419, "post_id": 39872474, "comment_id": 67031720, "body": "Also, the part &#39;a null pointer, is guaranteed to compare unequal to a pointer to any object or function.&#39; means that whatever address you take, of a valid object or function, is never 0."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1475666435, "post_id": 39872474, "comment_id": 67031727, "body": "@StoryTeller: Variadic functions are a bit different, as the caller does not know if (and which) pointer types are expected."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1475666507, "post_id": 39872474, "comment_id": 67031793, "body": "@StoryTeller: With respect to the standard a <i>null pointer</i> is not identical with address <code>0x0</code>! That is one of the inconsistencies in C. And one reason C++11 finally introduced the <code>nullptr</code> keyword and e.g. Pascal, Modula, etc. have <code>NIL</code>."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475666736, "post_id": 39872474, "comment_id": 67031959, "body": "@Olaf I have, and it&#39;s ((void*)0) in all the implementations I&#39;ve seen. But what an implementation does should be irrelevant to a language-lawyer-tagged question."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1475666787, "post_id": 39872474, "comment_id": 67031993, "body": "@PSkocik: See the last sentence. (Maybe I should have added &quot;... to be on the safe side&quot;). That whole <code>NULL</code>/<code>0</code> stuff is broken by design since early versions of C. I always wonder why then did not follow the Pascal (Algol?)-Trail and provided that as special keyword."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475666955, "post_id": 39872474, "comment_id": 67032105, "body": "@Olaf, yes variadic functions are different, but unless my memory fails me, pointer types should fall under a set of argument conversions. So it is a matter of how <code>NULL</code> is defined here (as you said). You are right that the standard doesn&#39;t guarantee two null pointers of different types will share a value, but I do believe a the quote in the OP makes an exception for <code>(void*)0</code>"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475667030, "post_id": 39872474, "comment_id": 67032160, "body": "@Olaf Looks like simply mandating <code>#define NULL ((void*)0)</code> and disallowing a plain <code>0</code> would fix the problem."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1475668695, "post_id": 39872474, "comment_id": 67033213, "body": "@PSkocik: It does not! You still can do <code>int *p = 0x0;</code> or any other integer expression evaluating to <code>0</code>. And - strictly speaking - you cannot dereference address <code>0x0</code>, just because of the above. Not to forget the compiler cannot even warn about such assignments. Remember there is no requirement for a <i>null pointer</i> to have a bit-representation of all bits zero."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1475668748, "post_id": 39872474, "comment_id": 67033246, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10555320/is-it-safe-to-cast-void-pointer-to-char-pointer-pointer\">Is it safe to cast void pointer to char pointer pointer</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 2, "creation_date": 1475669192, "post_id": 39872474, "comment_id": 67033559, "body": "@L\u01b0uV\u0129nhPh&#250;c: It is not the same, because null pointers are special as are variadic function parameters."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1475672393, "post_id": 39872474, "comment_id": 67035791, "body": "@L\u01b0uV\u0129nhPh&#250;c It&#39;s a distinct question. Casts force conversions. No conversions other than a couple of implicit promotions will be performed on the parameters of a variadic function. The promoted passed types must match what the function takes with <code>va_arg</code> or undefined behavior ensues. Whether a cast would be legal is irrelevant to that unless that cast is the same as the implicit promotion."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1507769728, "post_id": 39872474, "comment_id": 80346820, "body": "This question in the title is necessary, but not sufficient, to determine whether <code>va_arg(char *)</code> will successfully read a <code>void *</code> argument. For example, perhaps they have the same alignment and representation, but an implementation passes them in different registers.  I&#39;d suggest editing the title and first paragraph to be closer to the &quot;real&quot; question."}], "answers": [{"comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1475693832, "post_id": 39872596, "comment_id": 67050222, "body": "This was added in C99.  In C90, you are <i>not</i> allowed to do this."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1475734814, "post_id": 39872596, "comment_id": 67063869, "body": "@zwol: To be honest, that&#39;s a quarter century old."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1475765968, "post_id": 39872596, "comment_id": 67084340, "body": "@MSalters And yet, C89 is still the default for what I&#39;d guess is an absolute majority of C compilers."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1507770145, "post_id": 39872596, "comment_id": 80346916, "body": "@zwol I&#39;d say that in C90 it was intended that this be allowed, but not specified clearly enough. It&#39;s hard to come up with a reason why the C90 standard would have the line &quot;A pointer to void shall have the same representation and alignment requirements as a pointer to a character type. &quot; if not for this purpose.  Prior to standardization, the language didn&#39;t have <code>void *</code>; it seems clear to me that the intent is that for un-prototyped function arguments (including K&amp;R style ones, as well as the variadic part of a prototyped variadic function), <code>char *</code> and <code>void *</code> are interchangeable"}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 11, "last_activity_date": 1475666437, "creation_date": 1475666437, "answer_id": 39872596, "question_id": 39872474, "link": "https://stackoverflow.com/questions/39872474/will-a-void-always-have-the-same-representation-as-a-char/39872596#39872596", "title": "Will a void* always have the same representation as a char*?", "body": "<p>It's specifically allowed to access a <code>void*</code> argument using <code>va_arg(args, char*)</code> and vice versa, not just for the null pointer.</p>\n\n<p>See also <a href=\"http://en.cppreference.com/w/cpp/utility/variadic/va_arg\" rel=\"noreferrer\">http://en.cppreference.com/w/cpp/utility/variadic/va_arg</a></p>\n"}, {"comments": [{"owner": {"reputation": 1248, "user_id": 1555496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5571ef325e3fd4c0704d3492f4ad7526?s=128&d=identicon&r=PG", "display_name": "poizan42", "link": "https://stackoverflow.com/users/1555496/poizan42"}, "edited": false, "score": 2, "creation_date": 1475688988, "post_id": 39872598, "comment_id": 67047493, "body": "That&#39;s actually an interesting requirement. So on an architecture where code pointers are larger than data pointer pointers this requirement forces char pointers to be padded. Intel 80C51 is such an example since it has 128 bytes of ram but 4 KB of program rom. (Though this is a modified Harvard architecture which allows reading program rom as data so a unified data pointer still needs more room)"}, {"owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "reply_to_user": {"reputation": 1248, "user_id": 1555496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5571ef325e3fd4c0704d3492f4ad7526?s=128&d=identicon&r=PG", "display_name": "poizan42", "link": "https://stackoverflow.com/users/1555496/poizan42"}, "edited": false, "score": 3, "creation_date": 1475690118, "post_id": 39872598, "comment_id": 67048104, "body": "@poizan42 I thought function pointers and data pointers were treated differently in C, explicitly to handle the case you mention, where code pointers are larger."}, {"owner": {"reputation": 76876, "user_id": 287586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tB5AG.png?s=128&g=1", "display_name": "dan04", "link": "https://stackoverflow.com/users/287586/dan04"}, "edited": false, "score": 1, "creation_date": 1475690464, "post_id": 39872598, "comment_id": 67048298, "body": "POSIX (but <i>not</i> the C language standard) requires code pointers to be losslessly convertible to <code>void*</code> in order for the <code>dlsym</code> function to work."}, {"owner": {"reputation": 1248, "user_id": 1555496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5571ef325e3fd4c0704d3492f4ad7526?s=128&d=identicon&r=PG", "display_name": "poizan42", "link": "https://stackoverflow.com/users/1555496/poizan42"}, "reply_to_user": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 1, "creation_date": 1475692548, "post_id": 39872598, "comment_id": 67049477, "body": "@CortAmmon I think you are right, code pointers does not need to be convertible to void*. What might be the interesting part here is then that the C standard does not specify a universal pointer type (though I guess such a thing could be inefficient or pointless on certain platform, e.g. straight Hardvard architectures where you can&#39;t read from any code pointers anyways)"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1475693982, "post_id": 39872598, "comment_id": 67050319, "body": "Note that this is insufficient to permit <code>void *</code> to be passed <i>as an untyped argument</i> where the callee is expecting <code>char *</code>, or vice versa.  (Per MSalters&#39; answer, there&#39;s additional rules in the definition of <code>va_arg</code> that close the gap.)  And this was <i>not</i> a requirement in C90."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1248, "user_id": 1555496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5571ef325e3fd4c0704d3492f4ad7526?s=128&d=identicon&r=PG", "display_name": "poizan42", "link": "https://stackoverflow.com/users/1555496/poizan42"}, "edited": false, "score": 0, "creation_date": 1507761884, "post_id": 39872598, "comment_id": 80344918, "body": "@poizan42 To be clear:  &quot;where code pointers are larger than data pointer pointers this requirement forces char pointers to be padded&quot; is not specified by C.  Pointers to a function can be wider than <code>void*</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 76876, "user_id": 287586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tB5AG.png?s=128&g=1", "display_name": "dan04", "link": "https://stackoverflow.com/users/287586/dan04"}, "edited": false, "score": 1, "creation_date": 1507761977, "post_id": 39872598, "comment_id": 80344943, "body": "@dan04: That only applies to function pointers obtainable via <code>dlsym()</code>. In principle, other function pointer values might not be losslessly convertible to <code>void*</code>."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 35, "last_activity_date": 1507762114, "last_edit_date": 1507762114, "creation_date": 1475666454, "answer_id": 39872598, "question_id": 39872474, "link": "https://stackoverflow.com/questions/39872474/will-a-void-always-have-the-same-representation-as-a-char/39872598#39872598", "title": "Will a void* always have the same representation as a char*?", "body": "<p>C11, \u00a76.2.5, \u00b628 (draft <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a>) says:</p>\n\n<blockquote>\n  <p><strong>A pointer to void shall have the same representation and alignment\n  requirements as a pointer to a character type.</strong> 48) Similarly, pointers\n  to quali\ufb01ed or unquali\ufb01ed versions of compatible types shall have the\n  same representation and alignment requirements.</p>\n</blockquote>\n\n<p>(emphasis mine).</p>\n"}], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1479, "favorite_count": 0, "accepted_answer_id": 39872598, "answer_count": 2, "score": 24, "last_activity_date": 1507762114, "creation_date": 1475666116, "last_edit_date": 1475672494, "question_id": 39872474, "link": "https://stackoverflow.com/questions/39872474/will-a-void-always-have-the-same-representation-as-a-char", "title": "Will a void* always have the same representation as a char*?", "body": "<p>Will a <code>void*</code> always have the same representation as a <code>char*</code> ?</p>\n\n<p><strong>Details:</strong></p>\n\n<p>I want to work with a variadic function that takes char*'s terminated by a <code>(char*)0</code> like so:</p>\n\n<pre><code>int variadic(char*, ...); //&lt;-prototype\nvariadic(\"foo\", \"bar\", (char*)0); //&lt;- usage\n</code></pre>\n\n<p>I wanted to replace <code>(char*)0</code> with <code>NULL</code>, but judging from \n<a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\">http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf</a>'s:</p>\n\n<blockquote>\n  <p>66) The macro NULL is defined in  (and other headers) as a\n  null pointer constant; see 7.19.</p>\n  \n  <p>3 An integer constant expression with the value 0, or such an\n  expression cast to type void *, is called a null pointer constant. 66)\n  If a null pointer constant is converted to a pointer type, the\n  resulting pointer, called a null pointer, is guaranteed to compare\n  unequal to a pointer to any object or function.</p>\n</blockquote>\n\n<p>I can't, because in the <code>variadic</code> context, I absolutely need a <code>char*</code> and a plain <code>0</code> is unacceptable.</p>\n\n<p>If I defined:</p>\n\n<pre><code>#define NIL (void*)0 /*&lt;= never a plain 0*/\n</code></pre>\n\n<p>would it be legal for me to use it to terminate my <code>variadic(char*,...)</code>?</p>\n"}, {"tags": ["ios", "c", "macos", "swift3", "xcode8"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 4212036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9PGHk.jpg?s=128&g=1", "display_name": "WeyHan Ng", "link": "https://stackoverflow.com/users/4212036/weyhan-ng"}, "edited": false, "score": 0, "creation_date": 1475760171, "post_id": 39887277, "comment_id": 67080034, "body": "The Swift 3 migrator seems to convert those <code>.memory</code> to <code>.pointee</code> right. You are right that the migrator got confused in a few places but generally it works in most of the conversion.  I&#39;ve managed to fix it by changing the offending line to: <code>UnsafeMutablePointer&lt;T&gt;(ud.userdataPointer()).deinitialize()</code> I think this is correct but if you know it&#39;s wrong I&#39;d appreciate if you let me know. Thanks for the long analysis!"}, {"owner": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "reply_to_user": {"reputation": 73, "user_id": 4212036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9PGHk.jpg?s=128&g=1", "display_name": "WeyHan Ng", "link": "https://stackoverflow.com/users/4212036/weyhan-ng"}, "edited": false, "score": 0, "creation_date": 1475804739, "post_id": 39887277, "comment_id": 67101400, "body": "What you did works the same as what I suggested.  Either way we need a cast or initialization just to tell the compiler what the generic parameter is when calling <code>userdataPointer()</code>.  Be careful, however: the problematic line in the old code didn&#39;t de-initialize user data.  The new code will.  If the subsequent <code>toCustomType()</code> call tries to return the same userdata object, it will be already de-initialized.  Of course, I don&#39;t know the code, just sharing general observations."}, {"owner": {"reputation": 73, "user_id": 4212036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9PGHk.jpg?s=128&g=1", "display_name": "WeyHan Ng", "link": "https://stackoverflow.com/users/4212036/weyhan-ng"}, "edited": false, "score": 0, "creation_date": 1475811080, "post_id": 39887277, "comment_id": 67102874, "body": "The old code meaning this line? <code>(ud.userdataPointer() as UnsafeMutablePointer&lt;Void&gt;).destroy()</code>. Thanks for the heads up. I&#39;ll be looking into it."}, {"owner": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "reply_to_user": {"reputation": 73, "user_id": 4212036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9PGHk.jpg?s=128&g=1", "display_name": "WeyHan Ng", "link": "https://stackoverflow.com/users/4212036/weyhan-ng"}, "edited": false, "score": 0, "creation_date": 1475811325, "post_id": 39887277, "comment_id": 67102923, "body": "Yes, as far as I can tell, that code wasn&#39;t doing anything.  Its replacement will actually de-initialize userdata..."}, {"owner": {"reputation": 73, "user_id": 4212036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9PGHk.jpg?s=128&g=1", "display_name": "WeyHan Ng", "link": "https://stackoverflow.com/users/4212036/weyhan-ng"}, "edited": false, "score": 0, "creation_date": 1475850640, "post_id": 39887277, "comment_id": 67123087, "body": "Thanks! I&#39;ll definitely be looking out for any side effects."}], "tags": [], "owner": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "is_accepted": true, "score": 3, "last_activity_date": 1475729486, "last_edit_date": 1475729486, "creation_date": 1475726304, "answer_id": 39887277, "question_id": 39872452, "link": "https://stackoverflow.com/questions/39872452/how-to-convert-void-return-from-a-c-function-to-unsafemutablerawpointer-in/39887277#39887277", "title": "How to convert &#39;void *&#39; return from a C function to &#39;UnsafeMutableRawPointer&#39; in Swift 3?", "body": "<p>As you may have already found out, Swift 3 attempts to provide better type safety when it comes to pointers.  <code>UnsafeMutablePointer</code> can now only represent a pointer to an instance of a known type.  In Swift 2, a C <code>void *</code> was represented by <code>UnsafeMutablePointer&lt;Void&gt;</code>, allowing void and non-void pointers to be treated in the same way, including trying to call a de-initializer of the pointed-to type, which is what the <code>destroy()</code> method in the problematic line of code does:</p>\n\n<pre><code>  (ud.userdataPointer() as UnsafeMutablePointer&lt;Void&gt;).destroy()\n</code></pre>\n\n<p>In Swift 3 the de-initializer on the pointee is called using the <code>deinitialize()</code> method of the <code>UnsafeMutablePointer</code> structure.  It appears that the migration assistant got confused.  The line</p>\n\n<pre><code>(ud.userdataPointer() as UnsafeMutableRawPointer).deinitialize()\n</code></pre>\n\n<p>makes little sense because (1) <code>UnsafeMutablePointer</code> cannot be converted using <code>as</code> to <code>UnsafeMutableRawPointer</code>;\n (2) <code>UnsafeMutableRawPointer</code> has not <code>deinitialize()</code> method.  In Swift 3, <code>UnsafeMutableRawPointer</code> is a special type to represent <code>void*</code>.  It is actually quite understandable why the migration tool made this mistake: it blindly replaced <code>destroy()</code> with <code>deinitialize()</code> and <code>UnsafeMutablePointer&lt;Void&gt;</code> with the corresponding Swift 3 type <code>UnsafeMutableRawPointer</code>, without realizing that the conversion would not work.</p>\n\n<p>I don't quite understand why calling <code>destroy()</code> on a void pointer would work in Swift 2.  Maybe this was a bug in the program or some compiler trick allowed the correct de-initializer to be called.  Without knowing enough about the code, I can't be more specific than to suggest analyzing it to figure out what is the type pointed to by that pointer on which <code>destroy()</code> was called.  For example, if we know for sure that it is always the placeholder type <code>T</code> used on the following line:</p>\n\n<pre><code>   let o: T = ud.toCustomType()\n</code></pre>\n\n<p>then the offending line simply becomes</p>\n\n<pre><code>  (ud.userdataPointer() as UnsafeMutablePointer&lt;T&gt;).deinitialize()\n</code></pre>\n\n<p>We need the conversion in the parentheses to allow the compiler to infer the generic parameter.</p>\n\n<p>Thank you for bringing up an interesting problem.  BTW, once you get over this obstacle, you are likely to run into other problems.  One thing that jumps out is that <code>UnsafeMutablePointer</code> has no <code>.memory</code> in Swift 3; you'll have to use <code>.pointee</code> instead.</p>\n\n<p>Here's an update.  After playing with Swift 2.2 on Linux, I realize that calling <code>destroy()</code> on an <code>UnsafeMutablePointer&lt;A&gt;</code> cast as <code>UnsafeMutablePointer&lt;Void&gt;</code> won't call A's deinitializer, even if it has one.  So, you have to be careful with that line...  </p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 4212036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9PGHk.jpg?s=128&g=1", "display_name": "WeyHan Ng", "link": "https://stackoverflow.com/users/4212036/weyhan-ng"}, "edited": false, "score": 0, "creation_date": 1475759770, "post_id": 39893854, "comment_id": 67079761, "body": "Although the form I use was this: <code>UnsafeMutablePointer&lt;T&gt;(ud.userdataPointer()).deinitialize()</code> Thanks."}], "tags": [], "owner": {"reputation": 12648, "user_id": 368085, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0b566b25f8dd25383536bc925c84aebb?s=128&d=identicon&r=PG", "display_name": "mluisbrown", "link": "https://stackoverflow.com/users/368085/mluisbrown"}, "is_accepted": false, "score": 1, "last_activity_date": 1475750479, "creation_date": 1475750479, "answer_id": 39893854, "question_id": 39872452, "link": "https://stackoverflow.com/questions/39872452/how-to-convert-void-return-from-a-c-function-to-unsafemutablerawpointer-in/39893854#39893854", "title": "How to convert &#39;void *&#39; return from a C function to &#39;UnsafeMutableRawPointer&#39; in Swift 3?", "body": "<p>Try creating an instance of <code>UnsafeMutableRawPointer</code> instead of trying to cast it:</p>\n\n<p><code>UnsafeMutableRawPointer&lt;T&gt;(ud.userdataPointer()).destroy()</code> </p>\n"}], "owner": {"reputation": 73, "user_id": 4212036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9PGHk.jpg?s=128&g=1", "display_name": "WeyHan Ng", "link": "https://stackoverflow.com/users/4212036/weyhan-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 39887277, "answer_count": 2, "score": 6, "last_activity_date": 1475750479, "creation_date": 1475666058, "question_id": 39872452, "link": "https://stackoverflow.com/questions/39872452/how-to-convert-void-return-from-a-c-function-to-unsafemutablerawpointer-in", "title": "How to convert &#39;void *&#39; return from a C function to &#39;UnsafeMutableRawPointer&#39; in Swift 3?", "body": "<p>\nI'm trying to convert a lua bridge from Swift 2 to Swift 3. I am not the original author so there are aspects of the library I don't know very well and the original author seems not interested to continue working on the project. I have most of the conversion done but there remain one place I'm stuck and could not figure out. I've tried searching on SO and on the Internet but could not find anything that could help me solve the problem.</p>\n\n<p>If anyone is interested in looking at the full source code, here is my fork of the project on github: <a href=\"https://github.com/weyhan/lua4swift\">https://github.com/weyhan/lua4swift</a> (My changes is in the Swift3 branch)</p>\n\n<p>Allow me setup the context to the error I'm stuck on. There is a Userdata class, specifically in the method <code>userdataPointer&lt;T&gt;() -&gt; UnsafeMutablePointer&lt;T&gt;</code> the c function <code>lua_touserdata</code> returns the block address of userdata as a <code>void *</code> pointer type.</p>\n\n<p>Original code written in Swift 2:</p>\n\n<pre><code>public class Userdata: StoredValue {\n\n    public func userdataPointer&lt;T&gt;() -&gt; UnsafeMutablePointer&lt;T&gt; {\n        push(vm)\n        let ptr = lua_touserdata(vm.vm, -1)\n        vm.pop()\n        return UnsafeMutablePointer&lt;T&gt;(ptr)\n    }\n\n    public func toCustomType&lt;T: CustomTypeInstance&gt;() -&gt; T {\n        return userdataPointer().memory\n    }\n\n    public func toAny() -&gt; Any {\n        return userdataPointer().memory\n    }\n\n    override public func kind() -&gt; Kind { return .Userdata }\n\n}\n</code></pre>\n\n<p>After the conversion with Xcode 8 migration tool, Xcode is complaining about the return line with error <code>Cannot invoke initializer for type 'UnsafeMutablePointer&lt;T&gt;' with an argument list of type '(UnsafeMutableRawPointer?)'</code>:</p>\n\n<pre><code>return UnsafeMutablePointer&lt;T&gt;(ptr)\n</code></pre>\n\n<p>I've fixed it with:</p>\n\n<pre><code>return (ptr?.assumingMemoryBound(to: T.self))!\n</code></pre>\n\n<p>Following that above change, now Xcode 8 is now complaining about the calling statement in <code>createCustomType</code>:</p>\n\n<pre><code>public func createCustomType&lt;T: CustomTypeInstance&gt;(setup: (CustomType&lt;T&gt;) -&gt; Void) -&gt; CustomType&lt;T&gt; {\n    lua_createtable(vm, 0, 0)\n    let lib = CustomType&lt;T&gt;(self)\n    pop()\n\n    setup(lib)\n\n    registry[T.luaTypeName()] = lib\n    lib.becomeMetatableFor(lib)\n    lib[\"__index\"] = lib\n    lib[\"__name\"] = T.luaTypeName()\n\n    let gc = lib.gc\n    lib[\"__gc\"] = createFunction([CustomType&lt;T&gt;.arg]) { args in\n        let ud = args.userdata\n\n        // ******* Here's the line that is causing problem in Swift 3\n        (ud.userdataPointer() as UnsafeMutablePointer&lt;Void&gt;).destroy()\n        // *******\n\n        let o: T = ud.toCustomType()\n        gc?(o)\n        return .Nothing\n    }\n\n    if let eq = lib.eq {\n        lib[\"__eq\"] = createFunction([CustomType&lt;T&gt;.arg, CustomType&lt;T&gt;.arg]) { args in\n            let a: T = args.customType()\n            let b: T = args.customType()\n            return .Value(eq(a, b))\n        }\n    }\n    return lib\n}\n</code></pre>\n\n<p>Where I'm getting stuck is the line :</p>\n\n<pre><code>(ud.userdataPointer() as UnsafeMutablePointer&lt;Void&gt;).destroy()\n</code></pre>\n\n<p>I believe the original author is attempting to clear the memory block where the pointer returned by <code>userdataPointer()</code> call is pointing to.</p>\n\n<p>With the Xcode 8 auto migration tool the above line is converted as below:</p>\n\n<pre><code>(ud.userdataPointer() as UnsafeMutableRawPointer).deinitialize()\n</code></pre>\n\n<p>However Xcode now is then complains that <code>Cannot convert call result type 'UnsafeMutablePointer&lt;_&gt;' to expected type 'UnsafeMutableRawPointer'</code>.</p>\n\n<p>From my research, the change to the return line in <code>userdataPointer</code> seems correct, so I think the issue is with the cast to UnsafeMutableRawPointer. I've tried dropping the cast to <code>UnsafeMutableRawPointer</code> and invoke <code>ud.userdataPointer().deinitialize()</code> directly but I get this error <code>Generic parameter 'T' could not be inferred</code>.</p>\n\n<p>Other things I've tried is to convert the UnsafeMutablePointer to UnsafeMutableRawPointer but It always result in Xcode 8 complaining one thing or another. Any suggestion on how to get this to work?</p>\n"}, {"tags": ["c", "segmentation-fault", "malloc"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 5, "creation_date": 1475666114, "post_id": 39872405, "comment_id": 67031480, "body": "<code>index_data_t *index_data=NULL; index_data-&gt;index_data_array = ...</code> so <code>NULL-&gt;index_data_array</code>"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1475666115, "post_id": 39872405, "comment_id": 67031483, "body": "<code>malloc()</code> is highly unlikely to cause a segfault. The problem here is that you&#39;re dereferencing <code>index_data</code>, which is a null pointer"}, {"owner": {"reputation": 336, "user_id": 3387000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5db3f0461f94245f067c647bc224e7ec?s=128&d=identicon&r=PG&f=1", "display_name": "hashdefine", "link": "https://stackoverflow.com/users/3387000/hashdefine"}, "edited": false, "score": 0, "creation_date": 1475666158, "post_id": 39872405, "comment_id": 67031511, "body": "Inside your sizeof() you are trying to access index_data, which is marked as NULL in there previous statement."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 336, "user_id": 3387000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5db3f0461f94245f067c647bc224e7ec?s=128&d=identicon&r=PG&f=1", "display_name": "hashdefine", "link": "https://stackoverflow.com/users/3387000/hashdefine"}, "edited": false, "score": 2, "creation_date": 1475669692, "post_id": 39872405, "comment_id": 67033918, "body": "@hashdefine the argument of <code>sizeof</code> is unevaluated, so it is permitted to dereference null inside it"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6243669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60b9f8ec0a1b4adf6e8b6bff508f910?s=128&d=identicon&r=PG&f=1", "display_name": "Tehmo3", "link": "https://stackoverflow.com/users/6243669/tehmo3"}, "edited": false, "score": 0, "creation_date": 1475667196, "post_id": 39872591, "comment_id": 67032273, "body": "right, makes sense, but I&#39;m a little confused now  I understand that I&#39;ve made it a null pointer, does that mean after this malloc statement I now cant use the array I have malloc&#39;d? Should I just not cast this to a null pointer? Or if not, how do I now go add something to say index_data-&gt;index_data_array.word?"}, {"owner": {"reputation": 685, "user_id": 1335735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a760b5250f20eb8848e612739b6e8d?s=128&d=identicon&r=PG", "display_name": "sharcashmo", "link": "https://stackoverflow.com/users/1335735/sharcashmo"}, "edited": false, "score": 0, "creation_date": 1475667536, "post_id": 39872591, "comment_id": 67032475, "body": "it could be sizeof(index_data_t) or sizeof(struct index_data), isn&#39;t it?  Edit: Oh, I&#39;m wrong. I had missed that you declared an index_data variable of type index_data_t. Then it&#39;s Ok although naming both the struct and the variable the same is a bit confusing"}, {"owner": {"reputation": 1548, "user_id": 3082873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wT9Nk.jpg?s=128&g=1", "display_name": "cagdas", "link": "https://stackoverflow.com/users/3082873/cagdas"}, "reply_to_user": {"reputation": 685, "user_id": 1335735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a760b5250f20eb8848e612739b6e8d?s=128&d=identicon&r=PG", "display_name": "sharcashmo", "link": "https://stackoverflow.com/users/1335735/sharcashmo"}, "edited": false, "score": 1, "creation_date": 1475667687, "post_id": 39872591, "comment_id": 67032573, "body": "@sharcashmo you do not have to mention the type."}, {"owner": {"reputation": 685, "user_id": 1335735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a760b5250f20eb8848e612739b6e8d?s=128&d=identicon&r=PG", "display_name": "sharcashmo", "link": "https://stackoverflow.com/users/1335735/sharcashmo"}, "edited": false, "score": 0, "creation_date": 1475667750, "post_id": 39872591, "comment_id": 67032615, "body": "I know, I edited my comment a minute ago. I missed that index_data was the name of the variable :D"}, {"owner": {"reputation": 1548, "user_id": 3082873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wT9Nk.jpg?s=128&g=1", "display_name": "cagdas", "link": "https://stackoverflow.com/users/3082873/cagdas"}, "reply_to_user": {"reputation": 51, "user_id": 6243669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60b9f8ec0a1b4adf6e8b6bff508f910?s=128&d=identicon&r=PG&f=1", "display_name": "Tehmo3", "link": "https://stackoverflow.com/users/6243669/tehmo3"}, "edited": false, "score": 0, "creation_date": 1475667874, "post_id": 39872591, "comment_id": 67032685, "body": "I know the answer get a lil bit confusing but I do not like to modify too much to do it in @Tehmo3&#39;s fashion."}, {"owner": {"reputation": 51, "user_id": 6243669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60b9f8ec0a1b4adf6e8b6bff508f910?s=128&d=identicon&r=PG&f=1", "display_name": "Tehmo3", "link": "https://stackoverflow.com/users/6243669/tehmo3"}, "edited": false, "score": 0, "creation_date": 1475668180, "post_id": 39872591, "comment_id": 67032894, "body": "@cadgas  Thanks for your help cagdas, I really am confused here, how would I access these sub-struct elements to give them data? doing it as I normally would (index_data-&gt;index_data_array-&gt;etc) doesn&#39;t work since its a null pointer?"}, {"owner": {"reputation": 1548, "user_id": 3082873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wT9Nk.jpg?s=128&g=1", "display_name": "cagdas", "link": "https://stackoverflow.com/users/3082873/cagdas"}, "edited": false, "score": 0, "creation_date": 1475669041, "post_id": 39872591, "comment_id": 67033454, "body": "For sub-struct elements you&#39;ll also need them to be filled via malloc.  Check this post : <a href=\"http://stackoverflow.com/questions/14768230/malloc-for-struct-and-pointer-in-c\" title=\"malloc for struct and pointer in c\">stackoverflow.com/questions/14768230/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 6243669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60b9f8ec0a1b4adf6e8b6bff508f910?s=128&d=identicon&r=PG&f=1", "display_name": "Tehmo3", "link": "https://stackoverflow.com/users/6243669/tehmo3"}, "edited": false, "score": 0, "creation_date": 1475711217, "post_id": 39872591, "comment_id": 67057402, "body": "@cagdas thanks! I think I understand that part but I seem to still be getting an error... I&#39;ve updated my post with some new info if you could take a look I would be very thankful!"}], "tags": [], "owner": {"reputation": 1548, "user_id": 3082873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wT9Nk.jpg?s=128&g=1", "display_name": "cagdas", "link": "https://stackoverflow.com/users/3082873/cagdas"}, "is_accepted": false, "score": 0, "last_activity_date": 1475725781, "last_edit_date": 1475725781, "creation_date": 1475666416, "answer_id": 39872591, "question_id": 39872405, "link": "https://stackoverflow.com/questions/39872405/malloc-statement-giving-segmentation-fault-11/39872591#39872591", "title": "Malloc statement giving segmentation fault 11", "body": "<p>Trying to access an element which is from NULL address space. \nTry this : </p>\n\n<pre><code>index_data = (index_data_t*)malloc(sizeof(*(index_data)));\n</code></pre>\n\n<p>So on, you can fill your array like : </p>\n\n<pre><code>index_data-&gt;index_data_array = (data_t*)malloc(sizeof(*(index_data-&gt;index_data_array))*INITIAL_ALLOCATION);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 2, "last_activity_date": 1475669452, "last_edit_date": 1475669452, "creation_date": 1475667491, "answer_id": 39872950, "question_id": 39872405, "link": "https://stackoverflow.com/questions/39872405/malloc-statement-giving-segmentation-fault-11/39872950#39872950", "title": "Malloc statement giving segmentation fault 11", "body": "<ul>\n<li>you don't need all these typedefs</li>\n<li>you don't need to cast</li>\n<li><code>sizeof *ptr</code> gives the size of the <em>object</em> that <code>ptr</code> <em>points to</em></li>\n<li>IMHO the code without casts&amp;typedefs is much clearer:</li>\n</ul>\n\n<hr>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nstruct thing {\n        int type;\n        char name[13];\n        };\n\nstruct box {\n        unsigned nthing;\n        struct thing *things;\n        };\n\nstruct box *make_box(unsigned thingcount)\n{\nstruct box *thebox;\n\nthebox = malloc (sizeof *thebox);    \nif (!thebox) return NULL;\n\nthebox-&gt;things = malloc (thingcount * sizeof *thebox-&gt;things);    \nif (!thebox-&gt;things) { free(thebox); return NULL; }\n\nthebox-&gt;nthing = thingcount;\nreturn thebox;\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6243669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60b9f8ec0a1b4adf6e8b6bff508f910?s=128&d=identicon&r=PG&f=1", "display_name": "Tehmo3", "link": "https://stackoverflow.com/users/6243669/tehmo3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1475725781, "creation_date": 1475665936, "last_edit_date": 1475711181, "question_id": 39872405, "link": "https://stackoverflow.com/questions/39872405/malloc-statement-giving-segmentation-fault-11", "title": "Malloc statement giving segmentation fault 11", "body": "<p>For a project I am learning to use malloc/realloc in c, but I cannot figure out why this code gives me a seg fault!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;assert.h&gt;\n\ntypedef struct word_data word_data_t;\ntypedef struct data data_t;\ntypedef struct index_data index_data_t; \n\nstruct word_data {\n  int docunumber;\n  int freq;\n};\n\nstruct data {\n  char *word;\n  int total_docs;\nword_data_t *data;\n};\n\nstruct index_data {\n  data_t *index_data_array;\n};\n/* Inside a function called from main */\nindex_data_t *index_data=NULL;\nindex_data-&gt;index_data_array = (data_t*)malloc(sizeof(*(index_data- &gt;index_data_array))*INITIAL_ALLOCATION);\n</code></pre>\n\n<p>Im seriously stuck for ideas after trying a bunch of stuff and searching stackoverflow! any info helps!</p>\n\n<p>Thanks </p>\n\n<p>EDIT:</p>\n\n<p>Thanks for your help guys! but im still running into a seg fault later in the program, probably because of a similar mistake, but I've tried a bunch of stuff and cant get it to work, here are all my malloc/realloc calls:</p>\n\n<pre><code>index_data = (index_data_t*)malloc(sizeof(*index_data)*INITIAL_ALLOCATION);\nindex_data-&gt;index_data_array = (data_t*)malloc(sizeof(*index_data- &gt;index_data_array)*INITIAL_ALLOCATION);\nindex_data-&gt;index_data_array = realloc(index_data-&gt;index_data_array, current_size_outer_array*sizeof(*(index_data-&gt;index_data_array)))\nindex_data-&gt;index_data_array[index].word=malloc(strlen(word)+1);\nindex_data-&gt;index_data_array[index].word=entered_word;\nindex_data-&gt;index_data_array[index].data = (word_data_t *)malloc(sizeof(word_data_t)*INITIAL_ALLOCATION);\nindex_data-&gt;index_data_array[index].total_docs=atoi(word);\nindex_data-&gt;index_data_array[index].data = realloc(index_data-  &gt;index_data_array[index].data, current_size_inner_array*(sizeof(*(index_data-   &gt;index_data_array[index].data))))\nindex_data-&gt;index_data_array[index].data-&gt;docunumber = docunum;\nindex_data-&gt;index_data_array[index].data-&gt;freq = freq;\n</code></pre>\n\n<p>then when I go to print out something later:</p>\n\n<pre><code>printf(\"%d\\n\", index_data-&gt;index_data_array[0].total_docs);\n</code></pre>\n\n<p>I get a segfault, have I missed a malloc again or similar?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "unit-testing"], "answers": [{"tags": [], "owner": {"reputation": 2566, "user_id": 2940881, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/lz0ZZ.png?s=128&g=1", "display_name": "Frank-Rene Sch&#228;fer", "link": "https://stackoverflow.com/users/2940881/frank-rene-sch%c3%a4fer"}, "is_accepted": true, "score": 1, "last_activity_date": 1475665832, "creation_date": 1475665832, "answer_id": 39872380, "question_id": 39872073, "link": "https://stackoverflow.com/questions/39872073/hwut-how-to-enlarge-the-maximal-size-of-a-test-result-file/39872380#39872380", "title": "HWUT: how to enlarge the maximal size of a test result file?", "body": "<p><strong>The default limit is 1MB which is reasonable</strong>. You can adapt the maximum \noutput file size by means of the environment variable </p>\n\n<pre><code>            HWUT_OUTPUT_FILE_MAX_SIZE\n</code></pre>\n\n<p><strong>But be careful!</strong> The size limit exists to prevent the test application \nfrom spamming you hard drive with nonsense data. <strong><em>A loopy freaked-out test \napplication may very well stall your computer if it flushes so badly that no more space for others remains.</em></strong> </p>\n\n<p>Also, while HWUT can be very flexible during output comparison, I doubt\nthat more than 1MB of content can be judged appropriately. Maybe, filtering\nthe output would make sense.</p>\n"}], "owner": {"reputation": 65, "user_id": 5337012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b054efdd10b217d456bb8501ad69f1ff?s=128&d=identicon&r=PG&f=1", "display_name": "mhammer3", "link": "https://stackoverflow.com/users/5337012/mhammer3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 1, "accepted_answer_id": 39872380, "answer_count": 1, "score": 1, "last_activity_date": 1475665832, "creation_date": 1475664915, "question_id": 39872073, "link": "https://stackoverflow.com/questions/39872073/hwut-how-to-enlarge-the-maximal-size-of-a-test-result-file", "title": "HWUT: how to enlarge the maximal size of a test result file?", "body": "<p>in HWUT (hello world unit test), how can I change the maximal size of a test output file. Currently it seems to be limited to 1kB.\nMany thanks.</p>\n"}, {"tags": ["c", "linux-kernel"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 5, "creation_date": 1475663649, "post_id": 39871546, "comment_id": 67029864, "body": "Your process will be <i>blocked</i>, which means: waiting for I/O. The kernel remembers the process&#39;s status (inside a read() system call) and will allow it to run once the I/O is available."}, {"owner": {"reputation": 99, "user_id": 6860767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985aa6798591be0c0519461ef769637b?s=128&d=identicon&r=PG&f=1", "display_name": "techiek7", "link": "https://stackoverflow.com/users/6860767/techiek7"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1475664000, "post_id": 39871546, "comment_id": 67030080, "body": "so does this mean TTY driver will somehow notify scheduler that data is available and scheduler will move process  to ready queue?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1475664154, "post_id": 39871546, "comment_id": 67030168, "body": "TTY driver is not relevant here. The program could get its input from a pipe or socket, or whatever the filedescriptor is referring to. IIRC linux uses separate lists (queues) for runnable processes and waiting processes. Once data is/isnot availabe, the proces&#39;s record will be moved between these queues. The scheduler is only concerned with the <i>runnable</i> queue."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 2, "creation_date": 1475664183, "post_id": 39871546, "comment_id": 67030185, "body": "@techiek7 Pretty much. If you know what condition variables are, that&#39;s pretty much what the kernel uses internally to notify anyone interested that something interesting happened on the tty (or whatever other file descriptor you&#39;re reading from)."}], "answers": [{"tags": [], "owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "is_accepted": false, "score": 4, "last_activity_date": 1475664771, "creation_date": 1475664771, "answer_id": 39872023, "question_id": 39871546, "link": "https://stackoverflow.com/questions/39871546/what-actually-happens-to-a-process-waiting-for-user-input/39872023#39872023", "title": "What actually happens to a process waiting for user input?", "body": "<p>Yes, it's sleeping (in OS X, at least).</p>\n\n<p>Try compiling and running the following C program:</p>\n\n<pre class=\"lang-C prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int x;\n    puts(\"Enter a number:\");\n    if (scanf(\"%d\",&amp;x)) {\n        printf(\"You entered %d\\n\",x);\n    }\n    else {\n        puts(\"That isn't a number\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Start the program running in the console, then open another console and enter <code>ps -v</code> at the command line. You should see something like this:</p>\n\n<pre><code>  PID STAT      TIME  SL  RE PAGEIN      VSZ    RSS   LIM     TSIZ  %CPU %MEM COMMAND\n19544 S      0:00.01   0   0      0  2463084   1596     -        0   0.0  0.0 -bash\n19574 S      0:00.01   0   0      0  2454892   1568     -        0   0.0  0.0 -bash\n19582 S+     0:00.00   0   0      0  2434816    676     -        0   0.0  0.0 ./a\n</code></pre>\n\n<p>Here, <code>./a</code> is the name of the program. The entry for this process in the <code>STAT</code> column is <code>S+</code>, which means the process is sleeping (<code>S</code>) and is in the foreground (<code>+</code>). </p>\n"}], "owner": {"reputation": 99, "user_id": 6860767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985aa6798591be0c0519461ef769637b?s=128&d=identicon&r=PG&f=1", "display_name": "techiek7", "link": "https://stackoverflow.com/users/6860767/techiek7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1475664771, "creation_date": 1475663394, "question_id": 39871546, "link": "https://stackoverflow.com/questions/39871546/what-actually-happens-to-a-process-waiting-for-user-input", "title": "What actually happens to a process waiting for user input?", "body": "<p>I want to know what actually happens to a process waiting for user input. Lets say, in my code I gave call to scanf() to read user input from console. It will internally call read() system call. But in this case there is no data to read until user gives any input. So is our process sleeping till then?</p>\n"}, {"tags": ["c", "file"], "answers": [{"comments": [{"owner": {"reputation": 900, "user_id": 1952975, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/865fb3b93425441ac256161229c43cc9?s=128&d=identicon&r=PG&f=1", "display_name": "GoodPie", "link": "https://stackoverflow.com/users/1952975/goodpie"}, "edited": false, "score": 0, "creation_date": 1475660405, "post_id": 39870484, "comment_id": 67027778, "body": "Can&#39;t believe I didn&#39;t see that. I&#39;ll mark as correct after time limit."}], "tags": [], "owner": {"reputation": 41428, "user_id": 440564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e3dbcb5159c02d59f52159faa8437c97?s=128&d=identicon&r=PG", "display_name": "blue112", "link": "https://stackoverflow.com/users/440564/blue112"}, "is_accepted": true, "score": 5, "last_activity_date": 1475660408, "last_edit_date": 1475660408, "creation_date": 1475660360, "answer_id": 39870484, "question_id": 39870413, "link": "https://stackoverflow.com/questions/39870413/having-trouble-checking-for-newline-when-reading-file/39870484#39870484", "title": "Having trouble checking for newline when reading file", "body": "<pre><code>(ch != EOF) || (ch != '\\n')\n</code></pre>\n\n<p>This is always true.</p>\n\n<p>You want an <code>&amp;&amp;</code> (AND) here, both in your <code>if</code> and <code>while</code>, otherwise it will never stop.</p>\n"}, {"tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 0, "last_activity_date": 1475660858, "creation_date": 1475660858, "answer_id": 39870689, "question_id": 39870413, "link": "https://stackoverflow.com/questions/39870413/having-trouble-checking-for-newline-when-reading-file/39870689#39870689", "title": "Having trouble checking for newline when reading file", "body": "<p>Just use this boilerplate standard construct</p>\n\n<pre><code>int ch;  /* important, EOF is -1, not in the range 0-255 */\nFILE *fp;\n\n/* double brackets prevent warnings about assignment in if */\nwhile ( (ch = fgetc(fp)) != EOF)\n{\n  /* we now have a valid character */\n\n  /* usually */\n  if(ch == endofinputIlike)\n    break; \n}\n/* here you have either read all the input up to what you like\n  or skip because of EOF. usually you will set N or something, \n  or if N == 0 it was EOF, or we can test ch for EOF */\n</code></pre>\n\n<p>Generally assignment in if is a bad idea, but this particular snippet is so idiomatic that every experienced C programmer will instantly recognise it.</p>\n"}], "owner": {"reputation": 900, "user_id": 1952975, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/865fb3b93425441ac256161229c43cc9?s=128&d=identicon&r=PG&f=1", "display_name": "GoodPie", "link": "https://stackoverflow.com/users/1952975/goodpie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 39870484, "answer_count": 2, "score": 1, "last_activity_date": 1475660858, "creation_date": 1475660140, "question_id": 39870413, "link": "https://stackoverflow.com/questions/39870413/having-trouble-checking-for-newline-when-reading-file", "title": "Having trouble checking for newline when reading file", "body": "<p>I'm trying to write a program to read a file of an unknown size / line size but I'm having some issues detecting the new line character.</p>\n\n<p>When I run the program, it never reaches the end of the line point within the while loop in <code>readFile</code> and will just run constantly. If I run print each character, it prints out some unknown char. </p>\n\n<p>I've tried setting <code>ch</code> to be an int value and typecasting to char for <code>\\n</code> comparison. It's not reaching the <code>EOF</code> condition either so I'm not sure what is going on.</p>\n\n<p>code:</p>\n\n<pre><code>void readFile(FILE* file)\n{\n    int endOfFile = 0;\n    while (endOfFile != 1)\n    {\n        endOfFile = readLine(file);\n        printf(\"%d\\n\", endOfFile);\n    }\n}\n\nint readLine(FILE* file)\n{\n    static int maxSize = LINE_SIZE;\n    int currentIndex = 0;\n    int endOfFile = 0;\n    char* buffer = (char*) malloc(sizeof(char) * maxSize);\n    char ch;\n\n    do\n    {\n        ch = fgetc(file);\n        if ((ch != EOF) || (ch != '\\n'))\n        {\n            buffer[currentIndex] = (char) ch;\n            currentIndex += 1;\n        }\n\n        if (currentIndex == maxSize)\n        {\n            printf(\"Reallocating string buffer\");\n            maxSize *= 2;\n            buffer = (char*) realloc(buffer, maxSize);\n        }\n    } while ((ch != EOF) || (ch != '\\n'));\n\n    if (ch == EOF)\n    {\n        endOfFile = 1;\n    }\n\n    parseLine(buffer);\n    free(buffer);\n\n    return endOfFile;\n}\n</code></pre>\n\n<p>If someone could help me that would be greatly appreciated because I have been stuck on this issue for quite some time. Thanks in advance.</p>\n"}, {"tags": ["c", "typedef", "type-definition"], "comments": [{"owner": {"reputation": 1146, "user_id": 1248449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9d8cdc612a969f3cc7bb32757dce1d4f?s=128&d=identicon&r=PG", "display_name": "Diti", "link": "https://stackoverflow.com/users/1248449/diti"}, "edited": false, "score": 3, "creation_date": 1475659850, "post_id": 39870187, "comment_id": 67027387, "body": "Is it for a computer science classe assignment?"}, {"owner": {"reputation": 93, "user_id": 6624110, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ca61c960c58c38eb9d3db18c3e481589?s=128&d=identicon&r=PG&f=1", "display_name": "ufo", "link": "https://stackoverflow.com/users/6624110/ufo"}, "reply_to_user": {"reputation": 1146, "user_id": 1248449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9d8cdc612a969f3cc7bb32757dce1d4f?s=128&d=identicon&r=PG", "display_name": "Diti", "link": "https://stackoverflow.com/users/1248449/diti"}, "edited": false, "score": 0, "creation_date": 1475659904, "post_id": 39870187, "comment_id": 67027441, "body": "@Diti , No, it isn&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1475661110, "post_id": 39870274, "comment_id": 67028281, "body": "Style nit-pick: the OP&#39;s style is actually quite useful for people who prefer a consistent style when they work with any kind of pointers. If you use the typedef from the OP, you can declare a function pointer variable as <code>f* ptr;</code>. Rather than hiding the pointer behind typedef as in your case, and ending up with the more mysterious declaration <code>f ptr;</code>."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1475659796, "creation_date": 1475659796, "answer_id": 39870274, "question_id": 39870187, "link": "https://stackoverflow.com/questions/39870187/c-what-is-the-type-definition-of-a-variable-in-the-following-code/39870274#39870274", "title": "C - What is the type definition of a variable in the following code?", "body": "<p><code>f</code> is an alias for a function type that takes <code>int</code> as an argument and returns an <code>int*</code>.</p>\n\n<p>As such it isn't particularly useful.</p>\n\n<p>(If you wanted <code>f</code> to be a <em>pointer</em> to a function that takes an <code>int</code> and returns an <code>int</code>,  you'd have to write <code>typedef int (*f)(int);</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 1, "last_activity_date": 1475659888, "last_edit_date": 1495535648, "creation_date": 1475659888, "answer_id": 39870315, "question_id": 39870187, "link": "https://stackoverflow.com/questions/39870187/c-what-is-the-type-definition-of-a-variable-in-the-following-code/39870315#39870315", "title": "C - What is the type definition of a variable in the following code?", "body": "<pre><code>typedef int* f(int);\n</code></pre>\n\n<p>type <code>f</code> is function with <code>int</code> parameters and returning pointer to <code>int</code>.</p>\n\n<p>You cannot define a function using a <code>typedef</code> for a function type. please see the <a href=\"https://stackoverflow.com/questions/4574985/typedef-a-functions-prototype\">stack overflow</a> answer.</p>\n"}], "owner": {"reputation": 93, "user_id": 6624110, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ca61c960c58c38eb9d3db18c3e481589?s=128&d=identicon&r=PG&f=1", "display_name": "ufo", "link": "https://stackoverflow.com/users/6624110/ufo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1475660708, "creation_date": 1475659567, "last_edit_date": 1475660708, "question_id": 39870187, "link": "https://stackoverflow.com/questions/39870187/c-what-is-the-type-definition-of-a-variable-in-the-following-code", "title": "C - What is the type definition of a variable in the following code?", "body": "<p>What is the type definition of a variable <code>x</code> in this code?</p>\n\n<pre><code>typedef int *f(int);\nf *x;\n</code></pre>\n"}, {"tags": ["java", "c", "parsing", "antlr", "antlr3"], "comments": [{"owner": {"reputation": 153096, "user_id": 50476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6326af218d1a113fd9a8fd9668b2d7c8?s=128&d=identicon&r=PG", "display_name": "Bart Kiers", "link": "https://stackoverflow.com/users/50476/bart-kiers"}, "edited": false, "score": 0, "creation_date": 1475659861, "post_id": 39870126, "comment_id": 67027402, "body": "I see in the <code>statement</code> that you&#39;re using a rewrite rule and inline AST operators. What happens if you try both with rewrite rules? I.e. <code>statement     :   expression MB_SEMICOLON -&gt; expression     |   string MB_IN IDENTIFIER MB_SEMICOLON -&gt; ^(MB_IN string IDENTIFIER)     ;</code>"}, {"owner": {"reputation": 43, "user_id": 1495569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad4c866c817db380c88f810728e48e0c?s=128&d=identicon&r=PG", "display_name": "Patxi", "link": "https://stackoverflow.com/users/1495569/patxi"}, "reply_to_user": {"reputation": 153096, "user_id": 50476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6326af218d1a113fd9a8fd9668b2d7c8?s=128&d=identicon&r=PG", "display_name": "Bart Kiers", "link": "https://stackoverflow.com/users/50476/bart-kiers"}, "edited": false, "score": 0, "creation_date": 1475661368, "post_id": 39870126, "comment_id": 67028454, "body": "You are right @bart-kiers! I changed it <code>statement:\texpression MB_SEMICOLON -&gt; expression  | string MB_IN IDENTIFIER MB_SEMICOLON -&gt; ^(MB_IN string IDENTIFIER);</code>, but still the same. Thanks."}, {"owner": {"reputation": 153096, "user_id": 50476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6326af218d1a113fd9a8fd9668b2d7c8?s=128&d=identicon&r=PG", "display_name": "Bart Kiers", "link": "https://stackoverflow.com/users/50476/bart-kiers"}, "edited": false, "score": 0, "creation_date": 1475675635, "post_id": 39870126, "comment_id": 67038389, "body": "Wasn&#39;t sure that it would help, that&#39;s why I posted it as a comment. But I see you solved it already. Cool!"}, {"owner": {"reputation": 43, "user_id": 1495569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad4c866c817db380c88f810728e48e0c?s=128&d=identicon&r=PG", "display_name": "Patxi", "link": "https://stackoverflow.com/users/1495569/patxi"}, "reply_to_user": {"reputation": 153096, "user_id": 50476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6326af218d1a113fd9a8fd9668b2d7c8?s=128&d=identicon&r=PG", "display_name": "Bart Kiers", "link": "https://stackoverflow.com/users/50476/bart-kiers"}, "edited": false, "score": 0, "creation_date": 1476108934, "post_id": 39870126, "comment_id": 67200279, "body": "Sure, that helps me! That wasn&#39;t about the main problem, but it was another mistake after all.Thanks @BartKiers."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 1495569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad4c866c817db380c88f810728e48e0c?s=128&d=identicon&r=PG", "display_name": "Patxi", "link": "https://stackoverflow.com/users/1495569/patxi"}, "is_accepted": true, "score": 1, "last_activity_date": 1475665047, "creation_date": 1475665047, "answer_id": 39872125, "question_id": 39870126, "link": "https://stackoverflow.com/questions/39870126/antlr3-c-target-error-generating-treeparser-asttreeparser-stg-32125-anonymo/39872125#39872125", "title": "ANTLR3 C Target error generating TreeParser: ( ASTTreeParser.stg 321:25: anonymous template has 0 arg(s) but mapped across 1 value(s))", "body": "<p>I finally found the problem.\nThe <code>output = AST</code> option in the RuleParserTree.g file is left over. I removed it and finally the code is generated correctly.</p>\n"}], "owner": {"reputation": 43, "user_id": 1495569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad4c866c817db380c88f810728e48e0c?s=128&d=identicon&r=PG", "display_name": "Patxi", "link": "https://stackoverflow.com/users/1495569/patxi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 39872125, "answer_count": 1, "score": 1, "last_activity_date": 1475665047, "creation_date": 1475659403, "last_edit_date": 1475661675, "question_id": 39870126, "link": "https://stackoverflow.com/questions/39870126/antlr3-c-target-error-generating-treeparser-asttreeparser-stg-32125-anonymo", "title": "ANTLR3 C Target error generating TreeParser: ( ASTTreeParser.stg 321:25: anonymous template has 0 arg(s) but mapped across 1 value(s))", "body": "<p>I'm newbie in ANTLR and I'm trying to make a rule evaluator in ANTLR3 using C target. I'm using the latest version of ANTLR3 (3.5.2) and Java 1.7.0.80 to generate the code.</p>\n\n<p>I can generate the Lexer and Parser without any problem, but when trying to generate the TreeParser get the following errors:</p>\n\n<pre><code> : error 24 : template error: ASTTreeParser.stg 321:25: anonymous template has 0 arg(s) but mapped across 1 value(s)\n : error 24 : template error: ASTTreeParser.stg 323:25: anonymous template has 0 arg(s) but mapped across 1 value(s)\n</code></pre>\n\n<p>However, when I change the target language to Java no errors occurs and code(Java) is correctly generated.</p>\n\n<p><strong>My Lexer/Parser gramar is:</strong></p>\n\n<pre><code>grammar RuleParser;\n\noptions \n{ \n    language = C; \n    output = AST;\n}\n\n\ntokens \n{\n    MB_TRUE = 'true';\n    MB_FALSE = 'false';\n    MB_AND = 'AND';\n    MB_OR = 'OR';\n    MB_LT = '&lt;';\n    MB_GT = '&gt;';\n    MB_LTEQ = '&lt;=';\n    MB_GTEQ = '&gt;=';\n    MB_EQ = '==';\n    MB_NEQ = '!=';\n    MB_LBRACK = '[';\n    MB_RBRACK = ']';\n    MB_LPAREN = '(';\n    MB_RPAREN = ')';\n    MB_LCURLY = '{';\n    MB_RCURLY = '}';\n    MB_COLON = ':';\n    MB_SEMICOLON = ';';\n    MB_COMA = ',';\n    MB_OPTION = '|';\n    MB_DOT = '.';\n    MB_IN = 'IN';\n    MB_STRING_SUFIX = '@';\n    MB_CASE_SENSITIVE = 'CS';\n    MB_CASE_INSENSITIVE = 'CI';\n    MB_ENCODE_UNICODE = 'EU';       \n    MB_ENCODE_ANSI = 'EA';\n    MB_RULEDI = 'rule_di';\n    MB_HEADER = 'header';\n    MB_CONDITIONS = 'conditions';\n    CONDITION = 'condition';\n    RULE = 'rule';\n    RULES = 'rules';\n    MB_METADATA = 'metadata';\n}\n\nversion \n    : INT MB_DOT! INT MB_DOT! INT\n    ;\n\nstring\n    : STRING^\n    | STRING^ MB_STRING_SUFIX! MB_LBRACK! ((a=MB_CASE_INSENSITIVE | b=MB_CASE_SENSITIVE)? MB_OPTION!? (c=MB_ENCODE_UNICODE | d=MB_ENCODE_ANSI)?) MB_RBRACK!\n    ;\n\n\n// Rules definitions\nrules \n    : rule+ -&gt; ^(RULES rule+)\n    ;\n\nrule\n    : MB_RULEDI MB_LCURLY header conditions MB_RCURLY -&gt; ^(RULE header conditions)\n;\n\n\nheader  \n    : MB_HEADER MB_LCURLY header_block+ MB_RCURLY -&gt; ^(MB_HEADER header_block+)\n    ;\n\n\nheader_block\n    : 'Id' MB_COLON INT MB_SEMICOLON -&gt; ^(MB_METADATA 'Id' INT)\n    | 'Version' MB_COLON version MB_SEMICOLON-&gt; ^(MB_METADATA 'Version' version)\n    | 'Author' MB_COLON STRING MB_SEMICOLON-&gt; ^(MB_METADATA 'Author' STRING)\n    | 'Date' MB_COLON DATE MB_SEMICOLON-&gt; ^(MB_METADATA 'Date' DATE)\n    | 'Brief' MB_COLON STRING MB_SEMICOLON-&gt; ^(MB_METADATA 'Brief' STRING)\n    ;\n\nconditions\n    : MB_CONDITIONS '{' conditions_block '}' -&gt; ^(MB_CONDITIONS conditions_block)\n    ;\n\nconditions_block\n    :   statement+ -&gt; ^(CONDITION statement)+\n    ;\n\nstatement\n    :   expression MB_SEMICOLON -&gt; expression \n    |   string MB_IN IDENTIFIER MB_SEMICOLON -&gt; ^(MB_IN string IDENTIFIER)\n    ;\n\nexpression\n    :   andexpression;\n\nandexpression : orexpression (MB_AND^ orexpression)*;\n\norexpression : term (MB_OR^ term)*;\n\nterm:   atom (( MB_LT | MB_GT | MB_LTEQ | MB_GTEQ | MB_EQ | MB_NEQ)^ atom)? | MB_LPAREN! expression MB_RPAREN!;\n\natom : IDENTIFIER | INT | string | MB_TRUE | MB_FALSE;\n\n\n// Lexer rules\n//-------------------------------------------------\n\nDATE \n    : DATEDAY SEPARATOR (MONTH | DATEMONTH) SEPARATOR DATEYEAR\n    ;\n\nMONTH \n    : JAN | FEB | MAR | APR | MAY | JUN | JUL | AUG | SEP | OCT | NOV | DEC \n    ;\n\nfragment JAN : ('J'|'j')('A'|'a')('N'|'n') ;\nfragment FEB : ('F'|'f')('E'|'e')('B'|'b') ;\nfragment MAR : ('M'|'m')('A'|'a')('R'|'r') ;\nfragment APR : ('A'|'a')('P'|'p')('R'|'r') ;\nfragment MAY : ('M'|'m')('A'|'a')('Y'|'y') ; \nfragment JUN : ('J'|'j')('U'|'u')('N'|'n') ;\nfragment JUL : ('J'|'j')('U'|'u')('L'|'l') ;\nfragment AUG : ('A'|'a')('U'|'u')('G'|'g') ;\nfragment SEP : ('S'|'s')('E'|'e')('P'|'p') ; \nfragment OCT : ('O'|'o')('C'|'c')('T'|'t') ; \nfragment NOV : ('N'|'n')('O'|'o')('V'|'v') ;\nfragment DEC : ('D'|'d')('E'|'e')('C'|'c') ;\n\nSEPARATOR \n    : ('/'|'\\\\'|'-') \n    ;\n\nfragment     \nDATEMONTH\n   :    ('0'..'1')?DIGIT\n   ;\n\nfragment\nDATEDAY\n    :   ('0'..'3')?DIGIT\n    ;\n\nfragment\nDATEYEAR\n     :  '2' DIGIT DIGIT DIGIT\n     ;\n\nfragment \n    ID  :   ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*\n    ;\n\nIDENTIFIER: ID (MB_DOT ID)?;\n\nCOMMENT\n    :   '//' ~('\\n'|'\\r')* '\\r'? '\\n' {$channel=HIDDEN;}\n    |   '/*' ( options {greedy=false;} : . )* '*/' {$channel=HIDDEN;}\n    ;\n\n WS  :   ( ' '\n     | '\\t'\n     | '\\r'\n     | '\\n'\n     ) {$channel=HIDDEN;}\n     ;\n\nSTRING\n    :  '\"' ( ESC_SEQ | ~('\\\\'|'\"') )* '\"'\n    ;\n\nCHAR:  '\\'' ( ESC_SEQ | ~('\\''|'\\\\') ) '\\''\n    ;\n\nfragment\nHEX_DIGIT \n    : ('0'..'9'|'a'..'f'|'A'..'F')  \n    | '\\t'\n    | '\\r'\n    | '\\n'\n    ;\n\nfragment\nESC_SEQ\n    :   '\\\\' ('b'|'t'|'n'|'f'|'r'|'\\\"'|'\\''|'\\\\')\n    |   UNICODE_ESC\n    |   OCTAL_ESC\n    ;\n\nfragment\nOCTAL_ESC\n    :   '\\\\' ('0'..'3') ('0'..'7') ('0'..'7')\n    |   '\\\\' ('0'..'7') ('0'..'7')\n    |   '\\\\' ('0'..'7')\n    ;\n\nfragment\nUNICODE_ESC\n    :   '\\\\' 'u' HEX_DIGIT HEX_DIGIT HEX_DIGIT HEX_DIGIT\n    ;\n\nINT : DIGIT+;\n\nfragment DIGIT : ('0'..'9'); \n</code></pre>\n\n<p><strong>My Tree Parser grammar:</strong></p>\n\n<pre><code>tree grammar RuleParserTree;\n\noptions\n{\n    language = C;\n    tokenVocab = RuleParser;\n    output = AST;\n    ASTLabelType = pANTLR3_BASE_TREE;\n\n    //rewrite=true;\n}\n\n\nversion \n    : INT INT INT\n    ;\n\nstring\n    : STRING\n    | ^(STRING (a=MB_CASE_INSENSITIVE | b=MB_CASE_SENSITIVE)?  (c=MB_ENCODE_UNICODE | d=MB_ENCODE_ANSI)?)\n    ;\n\n// Rules definitions\n\nrules \n    : ^(RULES rule+)\n    ;\n\nrule\n    : ^(RULE header conditions)\n    ;\n\n header \n    : ^(MB_HEADER header_block+)\n    ;\n\nheader_block\n    : ^(MB_METADATA 'Id' INT)\n    | ^(MB_METADATA 'Version' version)\n    | ^(MB_METADATA 'Author' STRING)\n    | ^(MB_METADATA 'Date' DATE)\n    | ^(MB_METADATA 'Brief' STRING)\n    ;\n\nconditions\n    : ^(MB_CONDITIONS conditions_block)\n    ;\n\nconditions_block\n    :   CONDITION statement+\n    ;\n\nstatement\n    :   expression  \n    |   ^(MB_IN string IDENTIFIER)\n    ;\n\nexpression\n    :   ^(MB_AND expression expression)\n    |   ^(MB_OR expression expression)\n    |   ^(MB_LT expression expression)\n    |   ^(MB_GT expression expression)\n    |   ^(MB_LTEQ expression expression)\n    |   ^(MB_GTEQ expression expression)\n    |   ^(MB_EQ expression expression)\n    |   ^(MB_NEQ expression expression)\n    |   IDENTIFIER\n    |   INT\n    |   STRING\n    |   MB_TRUE\n    |   MB_FALSE\n    ;\n</code></pre>\n\n<p><strong>Complete log dump:</strong></p>\n\n<pre><code>ANTLR Parser Generator  Version 3.5.2\n--------------------\n attempting LL(1) DFA (d=1) for 22:13: (a= MB_CASE_INSENSITIVE |b= MB_CASE_SENSITIVE )?\n&gt; LOOK(33)\n&lt; LOOK(33)=MB_CASE_INSENSITIVE\n&gt; LOOK(35)\n&lt; LOOK(35)=MB_CASE_SENSITIVE\n&gt; LOOK(37)\n&lt; LOOK(37)={UP, MB_ENCODE_ANSI..MB_ENCODE_UNICODE}\ndecision 1 is simple LL(1)\n--------------------\nattempting LL(1) DFA (d=2) for 22:60: (c= MB_ENCODE_UNICODE |d= MB_ENCODE_ANSI )?\n&gt; LOOK(41)\n&lt; LOOK(41)=MB_ENCODE_UNICODE\n&gt; LOOK(43)\n&lt; LOOK(43)=MB_ENCODE_ANSI\n&gt; LOOK(45)\n&lt; LOOK(45)=UP\ndecision 2 is simple LL(1)\n--------------------\nattempting LL(1) DFA (d=3) for 20:1: string : ( STRING | ^( STRING (a= MB_CASE_INSENSITIVE |b= MB_CASE_SENSITIVE )? (c= MB_ENCODE_UNICODE |d= MB_ENCODE_ANSI )? ) );\n&gt; LOOK(27)\n&lt; LOOK(27)=STRING\n&gt; LOOK(29)\n&lt; LOOK(29)=STRING\ndecision 3 not suitable for LL(1)-optimized DFA analysis\n--------------------\nbuilding lookahead DFA (d=3) for 20:1: string : ( STRING | ^( STRING (a= MB_CASE_INSENSITIVE |b= MB_CASE_SENSITIVE )? (c= MB_ENCODE_UNICODE |d= MB_ENCODE_ANSI )? ) );\nclosure at string state 27|1 filling DFA state 0 with context [$]\nclosure at string state 29|2 filling DFA state 0 with context [$]\nconvert DFA state 0 (2 nfa states)\nDFA state after reach 65 0:{27|1, 29|2}-STRING-&gt;1:{28|1, 30|2}\nclosure(1:{28|1, 30|2})\nclosure at string state 28|1 filling DFA state 1 with context [$]\nclosure at string state 51|1 filling DFA state 1 with context [$]\nclosure at string state 3|1 filling DFA state 1 with context [$]\nclosure at statement state 169|1 filling DFA state 1 with context [$]\nresolveNonDeterminisms 1:{28|1, 30|2, 51|1, 3|1, 169|1}\nconvert DFA state 1 (5 nfa states)\nDFA state after reach 2 1:{28|1, 30|2, 51|1, 3|1, 169|1}-DOWN-&gt;2:{32|2}\nresolveNonDeterminisms 2:{32|2}\nDFA state after reach 19 1:{28|1, 30|2, 51|1, 3|1, 169|1}-IDENTIFIER-&gt;3:{171|1}\nresolveNonDeterminisms 3:{171|1}\ncost: 4 states, 19 ms\n--------------------\nattempting LL(1) DFA (d=4) for ()+ loopback of 29:12: ( rule )+\n&gt; LOOK(58)\n&lt; LOOK(58)=RULE\n&gt; LOOK(62)\n&lt; LOOK(62)=UP\ndecision 4 is simple LL(1)\n--------------------\nattempting LL(1) DFA (d=5) for ()+ loopback of 40:16: ( header_block )+\n&gt; LOOK(81)\n&lt; LOOK(81)=MB_METADATA\n&gt; LOOK(85)\n&lt; LOOK(85)=UP\ndecision 5 is simple LL(1)\n--------------------\nattempting LL(1) DFA (d=6) for 44:1: header_block : ( ^( MB_METADATA 'Id' INT ) | ^( MB_METADATA 'Version' version ) | ^( MB_METADATA 'Author' STRING ) | ^( MB_METADATA 'Date' DATE ) | ^( MB_METADATA 'Brief' STRING ) );\n&gt; LOOK(89)\n&lt; LOOK(89)=MB_METADATA\n&gt; LOOK(99)\n&lt; LOOK(99)=MB_METADATA\n&gt; LOOK(109)\n&lt; LOOK(109)=MB_METADATA\n&gt; LOOK(119)\n&lt; LOOK(119)=MB_METADATA\n&gt; LOOK(129)\n&lt; LOOK(129)=MB_METADATA\ndecision 6 not suitable for LL(1)-optimized DFA analysis\n--------------------\nbuilding lookahead DFA (d=6) for 44:1: header_block : ( ^( MB_METADATA 'Id' INT ) | ^( MB_METADATA 'Version' version ) | ^( MB_METADATA 'Author' STRING ) | ^( MB_METADATA 'Date' DATE ) | ^( MB_METADATA 'Brief' STRING ) );\nclosure at header_block state 89|1 filling DFA state 0 with context [$]\nclosure at header_block state 99|2 filling DFA state 0 with context [$]\nclosure at header_block state 109|3 filling DFA state 0 with context [$]\nclosure at header_block state 119|4 filling DFA state 0 with context [$]\nclosure at header_block state 129|5 filling DFA state 0 with context [$]\nconvert DFA state 0 (5 nfa states)\nDFA state after reach 46 0:{89|1, 99|2, 109|3, 119|4, 129|5}-MB_METADATA-&gt;1:{90|1, 100|2, 110|3, 120|4, 130|5}\nclosure(1:{90|1, 100|2, 110|3, 120|4, 130|5})\nresolveNonDeterminisms 1:{90|1, 100|2, 110|3, 120|4, 130|5}\nconvert DFA state 1 (5 nfa states)\nDFA state after reach 2 1:{90|1, 100|2, 110|3, 120|4, 130|5}-DOWN-&gt;2:{92|1, 102|2, 112|3, 122|4, 132|5}\nclosure(2:{92|1, 102|2, 112|3, 122|4, 132|5})\nresolveNonDeterminisms 2:{92|1, 102|2, 112|3, 122|4, 132|5}\nconvert DFA state 2 (5 nfa states)\nDFA state after reach 71 2:{92|1, 102|2, 112|3, 122|4, 132|5}-'Id'-&gt;3:{94|1}\nresolveNonDeterminisms 3:{94|1}\nDFA state after reach 72 2:{92|1, 102|2, 112|3, 122|4, 132|5}-'Version'-&gt;4:{104|2}\nresolveNonDeterminisms 4:{104|2}\nDFA state after reach 68 2:{92|1, 102|2, 112|3, 122|4, 132|5}-'Author'-&gt;5:{114|3}\nresolveNonDeterminisms 5:{114|3}\nDFA state after reach 70 2:{92|1, 102|2, 112|3, 122|4, 132|5}-'Date'-&gt;6:{124|4}\nresolveNonDeterminisms 6:{124|4}\nDFA state after reach 69 2:{92|1, 102|2, 112|3, 122|4, 132|5}-'Brief'-&gt;7:{134|5}\nresolveNonDeterminisms 7:{134|5}\ncost: 8 states, 27 ms\n--------------------\nattempting LL(1) DFA (d=7) for ()+ loopback of 60:14: ( statement )+\n&gt; LOOK(156)\n&lt; LOOK(156)={IDENTIFIER..INT, MB_AND, MB_EQ..MB_GTEQ, MB_IN, MB_LT..MB_LTEQ, MB_NEQ, MB_OR, MB_TRUE, STRING}\n&gt; LOOK(160)\n&lt; LOOK(160)=UP\ndecision 7 is simple LL(1)\n--------------------\nattempting LL(1) DFA (d=8) for 64:1: statement : ( expression | ^( MB_IN string IDENTIFIER ) );\n&gt; LOOK(162)\n&lt; LOOK(162)={IDENTIFIER..INT, MB_AND, MB_EQ..MB_GTEQ, MB_LT..MB_LTEQ, MB_NEQ, MB_OR, MB_TRUE, STRING}\n&gt; LOOK(164)\n&lt; LOOK(164)=MB_IN\ndecision 8 is simple LL(1)\n--------------------\nattempting LL(1) DFA (d=9) for 70:1: expression : ( ^( MB_AND a= expression b= expression ) | ^( MB_OR a= expression b= expression ) | ^( MB_LT a= expression b= expression ) | ^( MB_GT a= expression b= expression ) | ^( MB_LTEQ a= expression b= expression ) | ^( MB_GTEQ a= expression b= expression ) | ^( MB_EQ a= expression b= expression ) | ^( MB_NEQ a= expression b= expression ) | IDENTIFIER | INT | STRING | MB_TRUE | MB_FALSE );\n&gt; LOOK(177)\n&lt; LOOK(177)=MB_AND\n&gt; LOOK(189)\n&lt; LOOK(189)=MB_OR\n&gt; LOOK(201)\n&lt; LOOK(201)=MB_LT\n&gt; LOOK(213)\n&lt; LOOK(213)=MB_GT\n&gt; LOOK(225)\n&lt; LOOK(225)=MB_LTEQ\n&gt; LOOK(237)\n&lt; LOOK(237)=MB_GTEQ\n&gt; LOOK(249)\n&lt; LOOK(249)=MB_EQ\n&gt; LOOK(261)\n&lt; LOOK(261)=MB_NEQ\n&gt; LOOK(273)\n&lt; LOOK(273)=IDENTIFIER\n&gt; LOOK(275)\n&lt; LOOK(275)=INT\n&gt; LOOK(277)\n&lt; LOOK(277)=STRING\n&gt; LOOK(279)\n&lt; LOOK(279)=MB_TRUE\n&gt; LOOK(281)\n&lt; LOOK(281)=MB_FALSE\ndecision 9 is simple LL(1)\n: error 24 : template error: ASTTreeParser.stg 321:25: anonymous template has 0 arg(s) but mapped across 1 value(s)\n: error 24 : template error: ASTTreeParser.stg 323:25: anonymous template has 0 arg(s) but mapped across 1 value(s)\n&gt; LOOK(32)\n&lt; LOOK(32)={UP, MB_CASE_INSENSITIVE..MB_CASE_SENSITIVE, MB_ENCODE_ANSI..MB_ENCODE_UNICODE}\n&gt; LOOK(57)\n&lt; LOOK(57)=RULE\n&gt; LOOK(69)\n&lt; LOOK(69)=MB_HEADER\n&gt; LOOK(80)\n&lt; LOOK(80)=MB_METADATA\n&gt; LOOK(92)\n&lt; LOOK(92)='Id'\n&gt; LOOK(102)\n&lt; LOOK(102)='Version'\n&gt; LOOK(112)\n&lt; LOOK(112)='Author'\n&gt; LOOK(122)\n&lt; LOOK(122)='Date'\n&gt; LOOK(132)\n&lt; LOOK(132)='Brief'\n&gt; LOOK(148)\n&lt; LOOK(148)=CONDITION\n&gt; LOOK(167)\n&lt; LOOK(167)=STRING\n&gt; LOOK(180)\n&lt; LOOK(180)={IDENTIFIER..INT, MB_AND, MB_EQ..MB_GTEQ, MB_LT..MB_LTEQ, MB_NEQ, MB_OR, MB_TRUE, STRING}\n&gt; LOOK(192)\n&lt; LOOK(192)={IDENTIFIER..INT, MB_AND, MB_EQ..MB_GTEQ, MB_LT..MB_LTEQ, MB_NEQ, MB_OR, MB_TRUE, STRING}\n&gt; LOOK(204)\n&lt; LOOK(204)={IDENTIFIER..INT, MB_AND, MB_EQ..MB_GTEQ, MB_LT..MB_LTEQ, MB_NEQ, MB_OR, MB_TRUE, STRING}\n&gt; LOOK(216)\n&lt; LOOK(216)={IDENTIFIER..INT, MB_AND, MB_EQ..MB_GTEQ, MB_LT..MB_LTEQ, MB_NEQ, MB_OR, MB_TRUE, STRING}\n&gt; LOOK(228)\n&lt; LOOK(228)={IDENTIFIER..INT, MB_AND, MB_EQ..MB_GTEQ, MB_LT..MB_LTEQ, MB_NEQ, MB_OR, MB_TRUE, STRING}\n&gt; LOOK(240)\n&lt; LOOK(240)={IDENTIFIER..INT, MB_AND, MB_EQ..MB_GTEQ, MB_LT..MB_LTEQ, MB_NEQ, MB_OR, MB_TRUE, STRING}\n&gt; LOOK(252)\n&lt; LOOK(252)={IDENTIFIER..INT, MB_AND, MB_EQ..MB_GTEQ, MB_LT..MB_LTEQ, MB_NEQ, MB_OR, MB_TRUE, STRING}\n&gt; LOOK(264)\n&lt; LOOK(264)={IDENTIFIER..INT, MB_AND, MB_EQ..MB_GTEQ, MB_LT..MB_LTEQ, MB_NEQ, MB_OR, MB_TRUE, STRING}\n</code></pre>\n\n<p>It's a problem in my grammar or an error in C Generator Template?\nI've seen some reports of similar errors, such as <a href=\"https://groups.google.com/forum/#!msg/antlr-discussion/j73LgIn-dzg/c8ZTh7GbdzUJ\" rel=\"nofollow\">this one</a>, but always with older versions of ANTLR.</p>\n\n<p>I would appreciate any help.\nThanks in advance.</p>\n\n<p><strong>Update 1:</strong> Updated RuleParser.g grammar with bart-kiers suggestion.</p>\n"}, {"tags": ["c++", "c", "video", "ffmpeg"], "comments": [{"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 1, "creation_date": 1475659857, "post_id": 39869969, "comment_id": 67027396, "body": "ffprobe can help you."}, {"owner": {"reputation": 1719, "user_id": 5306861, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ZbylG.png?s=128&g=1", "display_name": "codeDom", "link": "https://stackoverflow.com/users/5306861/codedom"}, "reply_to_user": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1475660742, "post_id": 39869969, "comment_id": 67028010, "body": "@Shark How can I use FFMPEG what function should I use? You can direct me more detail?"}], "answers": [{"tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": false, "score": 1, "last_activity_date": 1475660647, "creation_date": 1475660647, "answer_id": 39870605, "question_id": 39869969, "link": "https://stackoverflow.com/questions/39869969/how-can-i-analyze-file-and-detect-if-the-file-is-in-h-264-video-format/39870605#39870605", "title": "How can I analyze file and detect if the file is in H.264 video format?", "body": "<p>If you want to use FFmpeg - <a href=\"https://www.ffmpeg.org/doxygen/3.1/group__lavf__decoding.html#gad42172e27cddafb81096939783b157bb\" rel=\"nofollow\"><code>avformat_find_stream_info()</code></a> should help you. An <a href=\"https://www.ffmpeg.org/doxygen/3.1/transcoding_8c_source.html#l00048\" rel=\"nofollow\">there</a> is an example.</p>\n"}, {"comments": [{"owner": {"reputation": 1719, "user_id": 5306861, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ZbylG.png?s=128&g=1", "display_name": "codeDom", "link": "https://stackoverflow.com/users/5306861/codedom"}, "edited": false, "score": 0, "creation_date": 1475668281, "post_id": 39870746, "comment_id": 67032961, "body": "I work with Visual Studio and can not compile <code>libavformat</code>, do you know a solution?"}, {"owner": {"reputation": 125, "user_id": 3078000, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4b04949997729d7c3e76df647e7f5820?s=128&d=identicon&r=PG&f=1", "display_name": "blue", "link": "https://stackoverflow.com/users/3078000/blue"}, "reply_to_user": {"reputation": 1719, "user_id": 5306861, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ZbylG.png?s=128&g=1", "display_name": "codeDom", "link": "https://stackoverflow.com/users/5306861/codedom"}, "edited": false, "score": 0, "creation_date": 1475674068, "post_id": 39870746, "comment_id": 67037117, "body": "Unfortunately I could not find binaries to use with Visual Studio, but the guys from FFmpeg made a <a href=\"https://trac.ffmpeg.org/wiki/CompilationGuide/MSVC\" rel=\"nofollow noreferrer\">wiki article</a> about compiling the sources with the Visual Compiler. If that doesn&#39;t do the trick, I guess you could also use another library, but I don&#39;t know any other, unfortunately. I think <a href=\"http://www.videolan.org/vlc/libvlc.html\" rel=\"nofollow noreferrer\">libVLC</a> could eventually do what you want, but don&#39;t quote me on that."}], "tags": [], "owner": {"reputation": 125, "user_id": 3078000, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4b04949997729d7c3e76df647e7f5820?s=128&d=identicon&r=PG&f=1", "display_name": "blue", "link": "https://stackoverflow.com/users/3078000/blue"}, "is_accepted": true, "score": 3, "last_activity_date": 1475661028, "creation_date": 1475661028, "answer_id": 39870746, "question_id": 39869969, "link": "https://stackoverflow.com/questions/39869969/how-can-i-analyze-file-and-detect-if-the-file-is-in-h-264-video-format/39870746#39870746", "title": "How can I analyze file and detect if the file is in H.264 video format?", "body": "<p>The problem is that H.264 is not a file format, it is a video compression standard, and as such it can be found in multiple file formats. You can have a .f4v encoded with H.264 as much as you can have .mp4 with H.264.</p>\n\n<p>So, how do you solve your issue? Well, I strongly advise you to use a library that does that for you. <a href=\"https://www.ffmpeg.org/doxygen/3.1/avformat_8h.html\" rel=\"nofollow\">libavformat</a>, for example, should do the trick (check the <code>AVStream</code> and <code>AVFormatContext</code> structures, and the <code>avformat_open_input</code> function).</p>\n\n<p>Now, if you absolutely want to do it without libraries, you can check out the documentation for <a href=\"https://en.wikipedia.org/wiki/Comparison_of_video_container_formats\" rel=\"nofollow\">each video container format</a> that supports H.264 to see how to retrieve the encoding information of the video stream, but expect this to take you at least a month or two.</p>\n"}, {"tags": [], "owner": {"reputation": 85949, "user_id": 1109017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PX561.png?s=128&g=1", "display_name": "llogan", "link": "https://stackoverflow.com/users/1109017/llogan"}, "is_accepted": false, "score": 3, "last_activity_date": 1475690155, "creation_date": 1475690155, "answer_id": 39880727, "question_id": 39869969, "link": "https://stackoverflow.com/questions/39869969/how-can-i-analyze-file-and-detect-if-the-file-is-in-h-264-video-format/39880727#39880727", "title": "How can I analyze file and detect if the file is in H.264 video format?", "body": "<p>For those who encounter this question but are looking for a cli solution you can use <code>ffprobe</code>:</p>\n\n<pre><code>ffprobe -loglevel error -select_streams v -show_entries stream=codec_name -of default=nw=1:nk=1 input.mkv\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>h264\n</code></pre>\n"}], "owner": {"reputation": 1719, "user_id": 5306861, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ZbylG.png?s=128&g=1", "display_name": "codeDom", "link": "https://stackoverflow.com/users/5306861/codedom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1671, "favorite_count": 0, "closed_date": 1475837201, "accepted_answer_id": 39870746, "answer_count": 3, "score": 2, "last_activity_date": 1475690155, "creation_date": 1475658970, "last_edit_date": 1475660629, "question_id": 39869969, "link": "https://stackoverflow.com/questions/39869969/how-can-i-analyze-file-and-detect-if-the-file-is-in-h-264-video-format", "closed_reason": "Needs more focus", "title": "How can I analyze file and detect if the file is in H.264 video format?", "body": "<p>I write software C/C++ to recover deleted files, and I need to identify files according to their binary content, so my question is there a simple way to know if a particular file is H.264 format video? is H.264 has an signature?</p>\n\n<p>I saw the code of FFMPEG <a href=\"https://github.com/FFmpeg/FFmpeg/blob/master/libavformat/avc.c#L27\" rel=\"nofollow\">here</a>, but can it help me, how?</p>\n"}, {"tags": ["c", "embedded", "avr", "touchscreen", "lcd"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475660180, "post_id": 39869871, "comment_id": 67027617, "body": "looking at <a href=\"http://www.hpinfotech.ro/ILI9325.pdf\" rel=\"nofollow noreferrer\">the datasheet</a> you have to configure <code>register 01h</code> (<code>Driver Output Control 1</code>) and <code>register 03h</code> (<code>Entry Mode</code>) and <code>register 60h</code> (<code>Driver Output Control 2</code>) with correct values."}, {"owner": {"reputation": 49, "user_id": 6852697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/933bcc2c92528071e44e7d9fd028662f?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Kumar", "link": "https://stackoverflow.com/users/6852697/ravi-kumar"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475661108, "post_id": 39869871, "comment_id": 67028278, "body": "@LPs would you please help me to get those correct values."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475661848, "post_id": 39869871, "comment_id": 67028803, "body": "Take a look at <a href=\"http://www.avrfreaks.net/comment/1637336#comment-1637336\" rel=\"nofollow noreferrer\">this code</a>"}, {"owner": {"reputation": 49, "user_id": 6852697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/933bcc2c92528071e44e7d9fd028662f?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Kumar", "link": "https://stackoverflow.com/users/6852697/ravi-kumar"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475665011, "post_id": 39869871, "comment_id": 67030750, "body": "@LPs Thanks for your help. By this code I am able to rotate the display in portrait mode only,when I try to turn the orientation in landscape mode the screen goes blank. It is not accepting the values as instructed in the link. In normal portrait mode values are   <code>LCD_WriteReg(0x0001,0x0000);</code> <code>LCD_WriteReg(0x0003,0x1028);</code> <code>LCD_WriteReg(0x0060,0x2700);</code>  portrait reverse  <code>LCD_WriteReg(0x0001,0x0100);</code> <code>LCD_WriteReg(0x0003,0x1030);</code> <code>LCD_WriteReg(0x0060,0xA700);</code>  It is not accepting values for landscape mode."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475675214, "post_id": 39869871, "comment_id": 67038050, "body": "Try changing landscape register 3 to <code>LCD_WriteReg(0x0003,0x1038)</code>"}, {"owner": {"reputation": 49, "user_id": 6852697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/933bcc2c92528071e44e7d9fd028662f?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Kumar", "link": "https://stackoverflow.com/users/6852697/ravi-kumar"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1475731979, "post_id": 39869871, "comment_id": 67062712, "body": "@LPs I tried to change the values but it didn&#39;t work. I would really appreciate if you tell me the values to put in these registers to rotate display in all four directions. Thanks"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1475734142, "post_id": 39869871, "comment_id": 67063592, "body": "It is always an hard matter to make those kind of devices works correctly. Many times the workflow has to be in a specific order. I haven&#39;t got the device. Try to study the datasheet and test values on the device directly."}], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 9418360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04a81b9f59dbc813b189effd019029e?s=128&d=identicon&r=PG&f=1", "display_name": "q74", "link": "https://stackoverflow.com/users/9418360/q74"}, "is_accepted": false, "score": 0, "last_activity_date": 1522870671, "creation_date": 1522870671, "answer_id": 49659083, "question_id": 39869871, "link": "https://stackoverflow.com/questions/39869871/set-orientation-of-ili-9325-tft-diaplay/49659083#49659083", "title": "Set Orientation of ILI 9325 TFT diaplay", "body": "<p>Without understanding how this LCD works you will not be able to solve your problem.\nFirst of all I recommend reading any hardware documentation carefully.\nThere are always some interesting information in it. I know it sounds like a waste of time, but it never is.</p>\n\n<pre><code>o o o o o o o \no o o o o o o\no o o o o o o\no o o o o o o\n      ^\n      |\n  LCD DRIVER  &lt; - &gt; LCD RAM\n      ^\n      |\n    input\n</code></pre>\n\n<p>The LCD driver controls two things:</p>\n\n<p>1) how your input data is stored in LCD RAM</p>\n\n<p>2) how your input data stored in LCD RAM is transfered to individual pixels</p>\n\n<p>Let's start from this section of the ILI9325 LCD documentation:</p>\n\n<p>7.2.3. Driver Output Control (R01h) on page 52</p>\n\n<p>It clearly says, that this register controls the ILI9325 internal driver. However it does not affect the way your input data is stored in LCD RAM by the driver.</p>\n\n<p>When SS = 0, the shift direction of outputs is from S1 to S720</p>\n\n<p>When SS = 1, the shift direction of outputs is from S720 to S1</p>\n\n<p>(page 11):</p>\n\n<p>S720~S1 O(utput) LCD</p>\n\n<p>Source output voltage signals applied to liquid crystal.\nTo change the shift direction of signal outputs, use the SS bit.\nSS = \u201c0\u201d, the data in the RAM address \u201ch00000\u201d is output from S1.\nSS = \u201c1\u201d, the data in the RAM address \u201ch00000\u201d is output from S720.\nS1, S4, S7, \u2026 display red (R), S2, S5, S8, ... display green (G), and\nS3, S6, S9, ... display blue (B) (SS = 0).</p>\n\n<p>This register only controls how contents of the LCD RAM are connected to the LCD pixels. It clearly says that DIRECTION OF OUTPUTS FROM THE DRIVER changes. The driver is capable of reversing your image by just changing SS setting in this register from 0 to 1. Please read more about it in the documentation, because you also need to adjust RGB settings.</p>\n\n<p>If you want to change the way your input data is stored in LCD RAM take a look at the following section:</p>\n\n<p>7.2.5. Entry Mode (R03h) on page 54</p>\n\n<p>This register allows you to control HOW YOUR INPUT IS STORED IN LCD RAM.\nOn page 55 you have details of how to adjust the driver for horizontal and vertical modes:</p>\n\n<p>Horizontal: AM = 0, I/D[1:0] = 11</p>\n\n<p>Vertical:   AM = 1, I/D[1:0] = 10</p>\n\n<p>I would say, that if you want to solve your problem do not change settings of\nR01h and R03h at the same time. As soon as you have your data displayed, change\nsettings of R01h and see what the driver does. But do not change your input data,\nbecause once you start messing with R03h your data in LCD RAM will be\nin other RAM locations. Do not mix these two things together.</p>\n\n<p>In addition bear in mind, that if you change the direction of storing your data in LCD RAM,\nlines become columns and vice versa. Take a closer look - page 55 describes it well.\nI think your software needs to be aware, that resolution is changed from 320x240 to 240x320 (rows become columns and vice versa).</p>\n"}], "owner": {"reputation": 49, "user_id": 6852697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/933bcc2c92528071e44e7d9fd028662f?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Kumar", "link": "https://stackoverflow.com/users/6852697/ravi-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 777, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1522870671, "creation_date": 1475658718, "last_edit_date": 1475658998, "question_id": 39869871, "link": "https://stackoverflow.com/questions/39869871/set-orientation-of-ili-9325-tft-diaplay", "title": "Set Orientation of ILI 9325 TFT diaplay", "body": "<p>I am working on a project which requires to interface TFT display with ILI9325 driver.\nI have successfully initialized the display but I am not able to rotate the display.\nPlease suggest me the register and value to inserted in that to set the display in portrait or landscape mode.</p>\n\n<p>Here is my LCD initialization code.</p>\n\n<pre><code>void LCD_ILI9325_Init(void)\n{\nunsigned char i;\n    unsigned int f;\n\n    LCD_Port_Init();\n\n    LCD_REST_L;  //??\n    _delay_ms(50);\n    LCD_REST_H;\n    _delay_ms(50);\n\n\n    LCD_WriteReg(0x0001,0x0000);//\u0437\u0435\u0440\u043a\u0430\u043b\u044c\u043d\u043e \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c (0x0100) \n    LCD_WriteReg(0x0002,0x0700); \n    LCD_WriteReg(0x0003,0x1030);//\u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u044f RGB \u0432 GBR, \u0441\u0442\u0440\u043e\u0447\u043d\u043e\u0439 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u043a\u0438 \n\n\n    LCD_WriteReg(0x0004,0x0000);//\u0437\u0435\u0440\u043a\u0430\u043b\u044c\u043d\u043e \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c (0x0000) \n    LCD_WriteReg(0x0008,0x0207);  \n    LCD_WriteReg(0x0009,0x0000);\n    LCD_WriteReg(0x000A,0x0000); \n    LCD_WriteReg(0x000C,0x0000); \n    LCD_WriteReg(0x000D,0x0000);\n    LCD_WriteReg(0x000F,0x0000);\n\n    //power on sequence VGHVGL\n    //\u041f\u0438\u0442\u0430\u043d\u0438\u044f \u043d\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 VGHVGL\n    LCD_WriteReg(0x0010,0x0000);   \n    LCD_WriteReg(0x0011,0x0007);  \n    LCD_WriteReg(0x0012,0x0000);  \n    LCD_WriteReg(0x0013,0x0000);\n\n    //vgh \n    LCD_WriteReg(0x0010,0x1290);   \n    LCD_WriteReg(0x0011,0x0227);\n\n    //vregiout \n    LCD_WriteReg(0x0012,0x001d);//0x001b\n\n    //vom amplitude\n    // \u041f\u043e \u0430\u043c\u043f\u043b\u0438\u0442\u0443\u0434\u0435 \n    LCD_WriteReg(0x0013,0x1500);\n\n    //vom H\n    LCD_WriteReg(0x0029,0x0018); \n    LCD_WriteReg(0x002B,0x000D); \n\n    //gamma\n    // \u0414\u0438\u0430\u043f\u0430\u0437\u043e\u043d \n    LCD_WriteReg(0x0030,0x0004);\n    LCD_WriteReg(0x0031,0x0307);\n    LCD_WriteReg(0x0032,0x0002);//0006\n    LCD_WriteReg(0x0035,0x0206);\n    LCD_WriteReg(0x0036,0x0408);\n    LCD_WriteReg(0x0037,0x0507); \n    LCD_WriteReg(0x0038,0x0204);//0200\n    LCD_WriteReg(0x0039,0x0707); \n    LCD_WriteReg(0x003C,0x0405);//0504\n    LCD_WriteReg(0x003D,0x0F02); \n\n    //ram\n    LCD_WriteReg(0x0050,0x0000); \n    LCD_WriteReg(0x0051,0x00EF);\n    LCD_WriteReg(0x0052,0x0000); \n    LCD_WriteReg(0x0053,0x013F);  \n    LCD_WriteReg(0x0060,0x2700);//\u0437\u0435\u0440\u043a\u0430\u043b\u044c\u043d\u043e \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c (0xA700) \n    LCD_WriteReg(0x0061,0x0001); \n    LCD_WriteReg(0x006A,0x0000); \n\n    //\n    LCD_WriteReg(0x0080,0x0000); \n    LCD_WriteReg(0x0081,0x0000); \n    LCD_WriteReg(0x0082,0x0000); \n    LCD_WriteReg(0x0083,0x0000); \n    LCD_WriteReg(0x0084,0x0000); \n    LCD_WriteReg(0x0085,0x0000); \n\n    //\n    LCD_WriteReg(0x0090,0x0010); \n    LCD_WriteReg(0x0092,0x0600); \n    LCD_WriteReg(0x0093,0x0003); \n    LCD_WriteReg(0x0095,0x0110); \n    LCD_WriteReg(0x0097,0x0000); \n    LCD_WriteReg(0x0098,0x0000);\n    LCD_WriteReg(0x0007,0x0133);\n\n\n    LCD_WriteComand(0x0022);//Start to write to display RAM\n\n    //paint screen black\n    for(i=0;i&lt;2;i++)\n    {\n        for(f=0;f&lt;38400;f++)\n        {\n            LCD_WriteData(WHITE);\n        }\n    }\n}\n</code></pre>\n\n<p>Please suggest me what to update in this code to rotate the display.</p>\n\n<p>Thank You</p>\n"}, {"tags": ["c#", "c++", "c", "wpf", "dll"], "comments": [{"owner": {"reputation": 93, "user_id": 3629375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a32a2791ae854cf9d440a139d6b33c?s=128&d=identicon&r=PG&f=1", "display_name": "Radon", "link": "https://stackoverflow.com/users/3629375/radon"}, "edited": false, "score": 1, "creation_date": 1475657858, "post_id": 39869239, "comment_id": 67026029, "body": "Try wrapping c function declarations with: extern &quot;C&quot; { }"}, {"owner": {"reputation": 11, "user_id": 4367122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a47e01feeb2724ef7256f313ac2f6e02?s=128&d=identicon&r=PG&f=1", "display_name": "Dilan Sarith", "link": "https://stackoverflow.com/users/4367122/dilan-sarith"}, "reply_to_user": {"reputation": 93, "user_id": 3629375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a32a2791ae854cf9d440a139d6b33c?s=128&d=identicon&r=PG&f=1", "display_name": "Radon", "link": "https://stackoverflow.com/users/3629375/radon"}, "edited": false, "score": 0, "creation_date": 1475658078, "post_id": 39869239, "comment_id": 67026164, "body": "can you please explain more??"}, {"owner": {"reputation": 93, "user_id": 3629375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a32a2791ae854cf9d440a139d6b33c?s=128&d=identicon&r=PG&f=1", "display_name": "Radon", "link": "https://stackoverflow.com/users/3629375/radon"}, "edited": false, "score": 1, "creation_date": 1475658489, "post_id": 39869239, "comment_id": 67026435, "body": "Declare c functions like this: extern &quot;C&quot; { long ReadCard(char * cID); long WriteCard(char * cID); } . This should be done only if __cplusplus is defined. Because cpp function names are exported differently so your c# app cant find the enrty point."}, {"owner": {"reputation": 11, "user_id": 4367122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a47e01feeb2724ef7256f313ac2f6e02?s=128&d=identicon&r=PG&f=1", "display_name": "Dilan Sarith", "link": "https://stackoverflow.com/users/4367122/dilan-sarith"}, "reply_to_user": {"reputation": 93, "user_id": 3629375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a32a2791ae854cf9d440a139d6b33c?s=128&d=identicon&r=PG&f=1", "display_name": "Radon", "link": "https://stackoverflow.com/users/3629375/radon"}, "edited": false, "score": 0, "creation_date": 1475659434, "post_id": 39869239, "comment_id": 67027091, "body": "but..this is completely c library...there is no cpp file in here"}, {"owner": {"reputation": 93, "user_id": 3629375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a32a2791ae854cf9d440a139d6b33c?s=128&d=identicon&r=PG&f=1", "display_name": "Radon", "link": "https://stackoverflow.com/users/3629375/radon"}, "edited": false, "score": 0, "creation_date": 1475660154, "post_id": 39869239, "comment_id": 67027601, "body": "Try using dependency walker on your library to check how your function names are exported. <a href=\"http://www.dependencywalker.com\" rel=\"nofollow noreferrer\">dependencywalker.com</a> .  Just Drag and drop your dll into it."}, {"owner": {"reputation": 912, "user_id": 2359895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9X5ZI.jpg?s=128&g=1", "display_name": "Paul Baxter", "link": "https://stackoverflow.com/users/2359895/paul-baxter"}, "edited": false, "score": 0, "creation_date": 1489005280, "post_id": 39869239, "comment_id": 72486905, "body": "<a href=\"http://stackoverflow.com/questions/10799685/how-to-pass-strings-from-c-sharp-to-c-and-from-c-to-c-using-dllimport\" title=\"how to pass strings from c sharp to c and from c to c using dllimport\">stackoverflow.com/questions/10799685/&hellip;</a>  may help"}, {"owner": {"reputation": 912, "user_id": 2359895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9X5ZI.jpg?s=128&g=1", "display_name": "Paul Baxter", "link": "https://stackoverflow.com/users/2359895/paul-baxter"}, "edited": false, "score": 0, "creation_date": 1491238991, "post_id": 39869239, "comment_id": 73453682, "body": "@Dilan even if this is straight C it needs to be declared extern or in a .def file"}], "owner": {"reputation": 11, "user_id": 4367122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a47e01feeb2724ef7256f313ac2f6e02?s=128&d=identicon&r=PG&f=1", "display_name": "Dilan Sarith", "link": "https://stackoverflow.com/users/4367122/dilan-sarith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 473, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475656965, "creation_date": 1475656965, "question_id": 39869239, "link": "https://stackoverflow.com/questions/39869239/call-native-dll-function-from-c-wpf-program", "title": "Call native dll function from c# wpf program", "body": "<p>Here is my question..</p>\n\n<p>I created a c language console application to read and write NFC card. In there, there are 2 functions for read and write.</p>\n\n<pre><code>long ReadCard(char * cID)\n{\n// code here \n}\n\nlong WriteCard(char * cID)\n{\n// code here\n}\n</code></pre>\n\n<p>to call this function , i used this code..</p>\n\n<p>for read card..</p>\n\n<pre><code>char * cID = malloc(17 * sizeof(char));\nlong _ret = ReadCard(cID);\n</code></pre>\n\n<p>for write card..</p>\n\n<pre><code>char CID[17];\nprintf(\"Enter Card ID \\n\");\nscanf(\"%s\", CID);\nlong _ret = WriteCard(CID);\n</code></pre>\n\n<p>this is perfectly working...</p>\n\n<p>then i created a dll using above console application and tried to use it in a c# application..</p>\n\n<p>In c# code first i import dll and function declared like this..</p>\n\n<pre><code>[DllImport(\"NFC_Driver_DLL.dll\", CallingConvention =   CallingConvention.Cdecl)]\npublic static extern int ReadCard([Out] char[] cID);\n\n[DllImport(\"NFC_Driver_DLL.dll\", CallingConvention = CallingConvention.Cdecl)]\npublic static extern int WriteCard([In] char[] cID);\n</code></pre>\n\n<p>after that , in order to read card, I used this code..</p>\n\n<pre><code>char[] CardID = new char[17];\nint a = ReadCard(CardID);\nstring s = new string(CardID);\nMessageBox.Show(s);\n</code></pre>\n\n<p>this is fully tested and 100% working..</p>\n\n<p>but i don't know, how to call write card function from c# side..</p>\n\n<p>i tried this code...</p>\n\n<pre><code>char[] CardID = new char[17] ;\nint a = WriteCard(CardID);\n</code></pre>\n\n<p>when executing this code, it occurs a exception which tell this message..</p>\n\n<p>An unhandled exception of type 'System.EntryPointNotFoundException' occurred in WpfNFCTest.exe</p>\n\n<p>Additional information: Unable to find an entry point named 'WriteCard' in DLL 'NFC_Driver_DLL.dll'.</p>\n\n<p>please help me to call this write function please...</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1475655306, "post_id": 39868686, "comment_id": 67024571, "body": "Take a look at the error message again. It really tells you all you need to know. And if you still don&#39;t know, then go back to a book and read more about the address-of operator (<code>&amp;</code>) and what it does. You need to do it anyway, because you really misuse it in more than one place (for example I suggest you take a closer look at that <code>scanf</code> call too)."}, {"owner": {"reputation": 900, "user_id": 2074379, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ZWMGe.jpg?s=128&g=1", "display_name": "The Apache", "link": "https://stackoverflow.com/users/2074379/the-apache"}, "edited": false, "score": 0, "creation_date": 1475655437, "post_id": 39868686, "comment_id": 67024627, "body": "You need to know that <code>Pi</code> is already a pointer and <code>&amp;Pi</code> is a pointer to the pointer, a double poiner. So the call should be <code>CalcPi(Pi, iterations);</code>"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1475656075, "post_id": 39868686, "comment_id": 67024954, "body": "<b>Choose a language.</b> In C++ the answer is simply, &quot;use std::vector&quot;."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1475656136, "post_id": 39868686, "comment_id": 67024986, "body": "Okay, I chose a language for you by removing the C++ tag."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1475656256, "post_id": 39868686, "comment_id": 67025041, "body": "If you use malloc, you should look into free() too."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6924877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6fd59b2ac8ea664e2cfc5cf4d8a87e3?s=128&d=identicon&r=PG&f=1", "display_name": "Corey", "link": "https://stackoverflow.com/users/6924877/corey"}, "edited": false, "score": 0, "creation_date": 1475655989, "post_id": 39868809, "comment_id": 67024903, "body": "Yes this worked. Thank you! Is it because E was already a pointer so I did not need to pass the address of the pointer?"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 35, "user_id": 6924877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6fd59b2ac8ea664e2cfc5cf4d8a87e3?s=128&d=identicon&r=PG&f=1", "display_name": "Corey", "link": "https://stackoverflow.com/users/6924877/corey"}, "edited": false, "score": 0, "creation_date": 1475656345, "post_id": 39868809, "comment_id": 67025095, "body": "@Corey Yes, in passing the address, you&#39;re trying to pass a double pointer where a pointer is expected, hence the error, <code>error: cannot convert \u2018long double**\u2019 to \u2018long double*\u2019 </code> and also your program leaks memory because you never free the memory that <code>E</code> is pointing to."}], "tags": [], "owner": {"reputation": 405, "user_id": 3857670, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/542831519/picture?type=large", "display_name": "Shay Gold", "link": "https://stackoverflow.com/users/3857670/shay-gold"}, "is_accepted": false, "score": 3, "last_activity_date": 1475656634, "last_edit_date": 1475656634, "creation_date": 1475655608, "answer_id": 39868809, "question_id": 39868686, "link": "https://stackoverflow.com/questions/39868686/passing-a-dynamically-allocated-array-from-main-to-another-function/39868809#39868809", "title": "Passing a dynamically allocated array from main to another function", "body": "<pre><code>CalcE(&amp;E, iterations);\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>CalcE(E, iterations);\n</code></pre>\n\n<p>Hope I helped</p>\n"}, {"tags": [], "owner": {"reputation": 44381, "user_id": 471160, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/9Z23A.jpg?s=128&g=1", "display_name": "marcinj", "link": "https://stackoverflow.com/users/471160/marcinj"}, "is_accepted": true, "score": 3, "last_activity_date": 1475656037, "last_edit_date": 1475656037, "creation_date": 1475655907, "answer_id": 39868892, "question_id": 39868686, "link": "https://stackoverflow.com/questions/39868686/passing-a-dynamically-allocated-array-from-main-to-another-function/39868892#39868892", "title": "Passing a dynamically allocated array from main to another function", "body": "<p>Here:</p>\n\n<pre><code>CalcE(&amp;E, iterations);\n</code></pre>\n\n<p>you take address of E (of type <code>long double *</code>) and pass it as an argument to <code>CalcE</code>. <code>CalcE</code> accepts as first parameter a pointer to <code>long double</code>. But when you take an address of <code>E</code> you are given actually a pointer to pointer to <code>long double</code> (<code>long double**</code>), and that is not a pointer to <code>long double</code>. And this is what your error tells you:</p>\n\n<blockquote>\n  <p>error: cannot convert \u2018long double**\u2019 to \u2018long double*\u2019 for argument\n     \u20181\u2019 to \u2018void CalcE(long double*, int)\u2019 CalcE( &amp;E, iterations );</p>\n</blockquote>\n\n<p>So you should have:</p>\n\n<pre><code>CalcE(E, iterations);\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6924877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6fd59b2ac8ea664e2cfc5cf4d8a87e3?s=128&d=identicon&r=PG&f=1", "display_name": "Corey", "link": "https://stackoverflow.com/users/6924877/corey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 39868892, "answer_count": 2, "score": 2, "last_activity_date": 1475658978, "creation_date": 1475655218, "last_edit_date": 1495540853, "question_id": 39868686, "link": "https://stackoverflow.com/questions/39868686/passing-a-dynamically-allocated-array-from-main-to-another-function", "title": "Passing a dynamically allocated array from main to another function", "body": "<p>First off, I have already looked at the example presented here: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/18522396/passing-dynamically-allocated-array-as-a-parameter-in-c\">Passing dynamically allocated array as a parameter in C</a></p>\n\n<p>I am trying to pass a dynamically allocated array as a parameter to another function.</p>\n\n<pre><code>void InputIterations(int *iterations);\nvoid CalcE(long double *E, int iterations);\n\nint main()\n{\n     int iterations;  \n     long double *E;\n\n     InputIterations(&amp;iterations);\n\n     E = (long double *) malloc(iterations * sizeof(long double));\n\n     CalcE(&amp;E, iterations);\n}\n\nvoid InputIterations(int *iterations)\n{\n     printf(\"Enter a number of iterations: \");\n     scanf(\"%d\", iterations);\n}\n\nvoid CalcE(long double *E, int iterations)\n{\n     long double sum = 0;\n     int i;\n     for(i=0; i&lt;iterations; i++)\n     {\n          sum = sum + /*formula for calculating irrational constant e*/\n          *E = sum;\n          E++;\n     }\n }\n</code></pre>\n\n<p>However, when I compile my code I get the following error: </p>\n\n<blockquote>\n  <p><code>error: cannot convert \u2018long double**\u2019 to \u2018long double*\u2019 for argument\n   \u20181\u2019 to \u2018void CalcE(long double*, int)\u2019 CalcE( &amp;E, iterations );</code></p>\n</blockquote>\n\n<p>Does anyone knows why I am getting this error ? </p>\n\n<p>If you could please explain my mistake or point me to a source that explains it I would greatly appreciate the help.</p>\n"}, {"tags": ["c", "unix", "emacs"], "comments": [{"owner": {"reputation": 36713, "user_id": 155299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QbAFa.png?s=128&g=1", "display_name": "Randy Morris", "link": "https://stackoverflow.com/users/155299/randy-morris"}, "edited": false, "score": 0, "creation_date": 1475696492, "post_id": 39868554, "comment_id": 67051722, "body": "<code>M-i</code> runs the command <code>tab-to-tab-stop</code>.  Are you saying you just want <code>Tab</code> to do the same?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6925093"}, "reply_to_user": {"reputation": 36713, "user_id": 155299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QbAFa.png?s=128&g=1", "display_name": "Randy Morris", "link": "https://stackoverflow.com/users/155299/randy-morris"}, "edited": false, "score": 0, "creation_date": 1475738020, "post_id": 39868554, "comment_id": 67065531, "body": "Maybe not use the tab key, but being able to add another keyboard shortcut equivalent to [M-i] would be great"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6925093"}, "edited": false, "score": 0, "creation_date": 1475657390, "post_id": 39868965, "comment_id": 67025722, "body": "Hey, by adding your line, emacs does indent code but only at the beginning of a new line, if I write something, it does not work anymore."}, {"owner": {"reputation": 1548, "user_id": 3082873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wT9Nk.jpg?s=128&g=1", "display_name": "cagdas", "link": "https://stackoverflow.com/users/3082873/cagdas"}, "edited": false, "score": 0, "creation_date": 1475657714, "post_id": 39868965, "comment_id": 67025939, "body": "Ok, so try with tab-stop then. (setq tab-stop-list (number-sequence 4 200 4))"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6925093"}, "edited": false, "score": 0, "creation_date": 1475658605, "post_id": 39868965, "comment_id": 67026525, "body": "Working perfectly fine except in source files, if I try in a .c file it isn&#39;t working but this is exactly what I want when the file has no extension"}, {"owner": {"reputation": 1548, "user_id": 3082873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wT9Nk.jpg?s=128&g=1", "display_name": "cagdas", "link": "https://stackoverflow.com/users/3082873/cagdas"}, "edited": false, "score": 0, "creation_date": 1475658935, "post_id": 39868965, "comment_id": 67026748, "body": "There is a C hook that I found on a post : (set c-basic-offset 4) . Here is the post : <a href=\"http://stackoverflow.com/questions/21402822/emacs-indent-use-tab-for-shell-and-spaces-for-c\" title=\"emacs indent use tab for shell and spaces for c\">stackoverflow.com/questions/21402822/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6925093"}, "edited": false, "score": 0, "creation_date": 1475659724, "post_id": 39868965, "comment_id": 67027279, "body": "Not working either, I guess I&#39;ll have to keep on using M + I"}], "tags": [], "owner": {"reputation": 1548, "user_id": 3082873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wT9Nk.jpg?s=128&g=1", "display_name": "cagdas", "link": "https://stackoverflow.com/users/3082873/cagdas"}, "is_accepted": false, "score": 0, "last_activity_date": 1475656147, "creation_date": 1475656147, "answer_id": 39868965, "question_id": 39868554, "link": "https://stackoverflow.com/questions/39868554/make-emacs-use-tab-to-indent-just-like-alt-i/39868965#39868965", "title": "Make Emacs use tab to indent just like ALT I", "body": "<p>Possibly you also need to add this config under yours:</p>\n\n<pre><code>(setq indent-line-function 'insert-tab)\n</code></pre>\n\n<p>Good luck with emacs!</p>\n"}, {"tags": [], "owner": {"reputation": 36713, "user_id": 155299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QbAFa.png?s=128&g=1", "display_name": "Randy Morris", "link": "https://stackoverflow.com/users/155299/randy-morris"}, "is_accepted": true, "score": 0, "last_activity_date": 1475773533, "creation_date": 1475773533, "answer_id": 39901863, "question_id": 39868554, "link": "https://stackoverflow.com/questions/39868554/make-emacs-use-tab-to-indent-just-like-alt-i/39901863#39901863", "title": "Make Emacs use tab to indent just like ALT I", "body": "<p>In response to the comments on the question, it sounds like what you want to do is bind another key to do what <kbd>M-i</kbd> does. In order to do that, first we must find what function <kbd>M-i</kbd> is running.  You can do that by hitting <kbd>C-h</kbd><kbd>k</kbd><kbd>M-i</kbd>.  This uses the function <code>describe-key</code> to describe what function the key is bound to.</p>\n\n<p>For me, <kbd>M-i</kbd> maps to the function <code>tab-to-tab-stop</code>.  Since you may be in a different mode you may have a different function.</p>\n\n<p>Once you have the function you can easily map that to any key.  In the example below I've mapped it to <kbd>F2</kbd> on the global keymap:</p>\n\n<pre><code>(global-set-key (kbd \"&lt;f2&gt;\") 'tab-to-tab-stop)\n</code></pre>\n\n<p>Different modes also have their own keymaps.  If you wanted to map this key only while in certain modes then you'd first have to determine which keymap was active while in the specific mode.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6925093"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 39901863, "answer_count": 2, "score": 1, "last_activity_date": 1475773533, "creation_date": 1475654806, "question_id": 39868554, "link": "https://stackoverflow.com/questions/39868554/make-emacs-use-tab-to-indent-just-like-alt-i", "title": "Make Emacs use tab to indent just like ALT I", "body": "<p>I've tried without success to use the tab key to indent my code just like alt + I.</p>\n\n<p>I've modified my .emacs file with the following code but this isn't working :</p>\n\n<pre><code>(setq-default indent-tabs-mode nil)\n(setq-default tab-width 4)\n</code></pre>\n\n<p>Is it possible to use tab to indent code ?</p>\n"}, {"tags": ["c", "loops", "for-loop", "indexing"], "comments": [{"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 1, "creation_date": 1475654848, "post_id": 39868538, "comment_id": 67024317, "body": "So... what do you know about the <code>for</code> statement?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1475655220, "post_id": 39868538, "comment_id": 67024519, "body": "I agree - there <i>is</i> nothing wrong with this question. It&#39;s well-written, has a code snippet, and expected and actual output. What could be better? Please do not downvote on grounds of obviousness."}, {"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1475656032, "post_id": 39868538, "comment_id": 67024928, "body": "@Bathsheba, Ashish, sepisoad - In a community based system, the community controls the content, and in the SO community that means voting. The voting system is to be used at the discretion of us all, and we all have the right (obligation if you ask me) to use it how we see fit. As for the closing reason - I think minimal effort is a prerequisite for posting a question. This was clearly not demonstrated in this question. and is what I expressed in my close reason. I don&#39;t see any of that as being &quot;not nice&quot;, and the one comment that does use foul language (sepisoad&#39;s) is the one to criticize."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1475658005, "post_id": 39868538, "comment_id": 67026122, "body": "Simply uncrappify the loop so that the 3 loop conditions are only related to the loop iterator, without non-related side-effects: <code>for(int IDX = 0; IDX &lt; sizeof(arr)&#47;sizeof(*arr); IDX++){         ITM = arr[IDX];         printf(&quot;%d, &quot;, ITM);      }</code>"}, {"owner": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "reply_to_user": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 1, "creation_date": 1475661621, "post_id": 39868538, "comment_id": 67028651, "body": "@Amit: we do ask you to come up with a valid off-topic reason; not enough research is not one of those, that&#39;s what the downvote option is for."}, {"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "reply_to_user": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "edited": false, "score": 0, "creation_date": 1475662695, "post_id": 39868538, "comment_id": 67029299, "body": "@MartijnPieters - would you be so kind to explain <a href=\"http://stackoverflow.com/help/quality-standards-error\">&quot;<i>Any background research you&#39;ve tried but wasn&#39;t enough to solve your problem</i>&quot;</a> than (and the information in <a href=\"http://meta.stackexchange.com/questions/92074/what-can-i-do-when-getting-it-does-not-meet-our-quality-standards\">here</a>)? Unfortunately, &quot;low quality&quot; is not a predefined close reason, so I tried to make the most of what is available..."}, {"owner": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "reply_to_user": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 1, "creation_date": 1475662956, "post_id": 39868538, "comment_id": 67029446, "body": "@Amit: again, quality is <b>not</b> an off-topic reason. Low quality can be improved on by editing. The information you are linking to prevents posts that don&#39;t meet a minimum bar from being posted, but that doesn&#39;t mean that those posts would otherwise be off-topic."}, {"owner": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "reply_to_user": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 1, "creation_date": 1475663017, "post_id": 39868538, "comment_id": 67029485, "body": "@Amit: if you have further questions about this, you can come to <a href=\"https://chat.stackoverflow.com/\">Stack Overflow Chat</a> or take it to <a href=\"https://meta.stackoverflow.com\">Meta Stack Overflow</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1947, "user_id": 298851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/G7fYt.png?s=128&g=1", "display_name": "sepisoad", "link": "https://stackoverflow.com/users/298851/sepisoad"}, "edited": false, "score": 0, "creation_date": 1475654945, "post_id": 39868584, "comment_id": 67024377, "body": "actually I wanted to write a foreach macro using this loop, is there a workaround?"}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 2, "creation_date": 1475656664, "post_id": 39868584, "comment_id": 67025265, "body": "strictly speaking, <code>i=a[++IDX]</code> is UB for the last iteration with IDX == number of elements - 1"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1475658153, "post_id": 39868584, "comment_id": 67026224, "body": "Please don&#39;t recommend to use such ugly, unsafe macros. This is very bad programming practice. Overall, re-inventing the C language and replacing it with your private, secret macro language is a genuinely bad idea."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1475658615, "post_id": 39868584, "comment_id": 67026539, "body": "<code>FOREACH(my_incorrect_type, arr)</code> Halt and catch fire. <code>FOREACH(ITM, incorrect_array_type)</code> Halt and catch fire. <code>FOREACH(IDX, arr)</code> Halt and catch fire. <code>FOREACH(ITM, pointer)</code> Halt and catch fire. I&#39;m starting to notice a use-case pattern here..."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1475658993, "post_id": 39868584, "comment_id": 67026789, "body": "you&#39;re both right. It was fun but I&#39;ll edit it out because of UB."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 3, "last_activity_date": 1475659049, "last_edit_date": 1475659049, "creation_date": 1475654886, "answer_id": 39868584, "question_id": 39868538, "link": "https://stackoverflow.com/questions/39868538/c-why-putting-statement-in-for-loop-increment-part-does-not-work-the-first-i/39868584#39868584", "title": "C - why putting statement in for loop &#39;increment&#39; part does not work the first iteration?", "body": "<p>The last statement of the <code>for</code> loop is executed <em>after</em> the first iteration (or <code>IDX</code> would be 1 at once)</p>\n\n<p>So at first <code>ITM</code> is just undefined.</p>\n\n<p>EDIT: after providing a potentially unsafe macro, I removed it from my post. I suppose that if you want to use foreach stuff, switch to C++ 11.</p>\n"}, {"comments": [{"owner": {"reputation": 1947, "user_id": 298851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/G7fYt.png?s=128&g=1", "display_name": "sepisoad", "link": "https://stackoverflow.com/users/298851/sepisoad"}, "edited": false, "score": 0, "creation_date": 1475655237, "post_id": 39868601, "comment_id": 67024527, "body": "yup, thanks, BTW I wanted to write a foreach macro using this loop, is there a workaround?"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 3, "last_activity_date": 1475654946, "creation_date": 1475654946, "answer_id": 39868601, "question_id": 39868538, "link": "https://stackoverflow.com/questions/39868538/c-why-putting-statement-in-for-loop-increment-part-does-not-work-the-first-i/39868601#39868601", "title": "C - why putting statement in for loop &#39;increment&#39; part does not work the first iteration?", "body": "<p>The behaviour of your program is <em>undefined</em> due to your reading the <em>unitialised</em> variable <code>ITM</code> on the first iteration of the <code>for</code> loop.</p>\n\n<p><code>ITM</code> is not set to anything until <code>ITM = arr[IDX++]</code> is evaluated, and that doesn't happen until program control gets to the closing <code>}</code> of the <code>for</code> loop.</p>\n\n<p>Writing flashy code like this is occasionally useful, but you need to be aware of the pitfalls.</p>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 6649601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eeed67e11f506fa5864d5e5b371af637?s=128&d=identicon&r=PG&f=1", "display_name": "Michael1248", "link": "https://stackoverflow.com/users/6649601/michael1248"}, "is_accepted": false, "score": 0, "last_activity_date": 1475655601, "last_edit_date": 1495540109, "creation_date": 1475655601, "answer_id": 39868803, "question_id": 39868538, "link": "https://stackoverflow.com/questions/39868538/c-why-putting-statement-in-for-loop-increment-part-does-not-work-the-first-i/39868803#39868803", "title": "C - why putting statement in for loop &#39;increment&#39; part does not work the first iteration?", "body": "<pre><code>#define LEN 5\n\nint main(int argc, char const *argv[])\n{\n    int arr[LEN];\n    int index;\n    arr[0] = 7;\n    arr[1] = 3;\n    arr[2] = 5;\n    arr[3] = 1;\n    arr[4] = 9;\n\n    for(int i = 0; i &lt; sizeof(arr) / sizeof(int); i++){\n        printf(\"%d, \", arr[i]);\n    }\n    printf(\"\\n\");\n\n\n    return 0;\n}\n</code></pre>\n\n<p>if you want to use foreach in c <a href=\"https://stackoverflow.com/questions/400951/does-c-have-a-foreach-loop-construct\">read that</a></p>\n"}], "owner": {"reputation": 1947, "user_id": 298851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/G7fYt.png?s=128&g=1", "display_name": "sepisoad", "link": "https://stackoverflow.com/users/298851/sepisoad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 2, "accepted_answer_id": 39868601, "answer_count": 3, "score": 3, "last_activity_date": 1475659049, "creation_date": 1475654738, "last_edit_date": 1475655585, "question_id": 39868538, "link": "https://stackoverflow.com/questions/39868538/c-why-putting-statement-in-for-loop-increment-part-does-not-work-the-first-i", "title": "C - why putting statement in for loop &#39;increment&#39; part does not work the first iteration?", "body": "<p>this is my code which I expect to see </p>\n\n<p>7, 3, 5, 1, 9 </p>\n\n<p>as output but it prints </p>\n\n<p>0, 7, 3, 5, 1</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define LEN 5\n\nint main(int argc, char const *argv[])\n{\n    int arr[LEN];\n    int index;\n    arr[0] = 7;\n    arr[1] = 3;\n    arr[2] = 5;\n    arr[3] = 1;\n    arr[4] = 9;\n\n    int ITM;\n    for(int IDX = 0; IDX &lt; sizeof(arr) / sizeof(int); ITM = arr[IDX++]){\n        printf(\"%d, \", ITM);    \n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>what is wrong with this code?</p>\n\n<p>BTW, I know that I can move \"ITM = arr[IDX++]\" into loop body!</p>\n"}, {"tags": ["c", "algorithm", "mpi", "openmp"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1475654607, "post_id": 39868415, "comment_id": 67024190, "body": "The obvious improvement would be to get rid of the recursion. Doing so will give a huge boost in performance."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1475656640, "post_id": 39868415, "comment_id": 67025253, "body": "@Lundin I&#39;m not a C programmer, but in most cases won&#39;t the C compiler optimize recursion to iteration anyway?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1475657573, "post_id": 39868415, "comment_id": 67025847, "body": "It used to be that compilers can only do that effectively when you have &quot;tail recursion&quot;. Maybe compilers are smarter nowadays, but I wouldn&#39;t count on it. Disassemble the optimized code and see for yourself."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1475659829, "post_id": 39868415, "comment_id": 67027366, "body": "Btw this program crashes upon execution (stack overflow?). I&#39;d start with weeding out the bugs before considering optimization."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475773625, "post_id": 39868415, "comment_id": 67089121, "body": "on my computer under linux 16.04, the posted code seg faults after 4 combinations are printed.   So the code is not ready for optimization.  It is ready for some serious debugging.  I would advise against introducing &#39;openmp&#39; until after the code works properly.   Right now, it seems to have some serious undefined behavior problems."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475774182, "post_id": 39868415, "comment_id": 67089403, "body": "in general, variable names should indicate content or usage or both/  The posted variable names do not display any such information.  It is a very bad idea to have multiple entities those only difference is capitalization."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475775808, "post_id": 39868415, "comment_id": 67090288, "body": "regarding optimizations.  the array <code>array[]</code> never changes. so would be better defined as &#39;const&#39;,  However, that is no actual need for that array as the statement: <code>queue[top++] = input[s];</code> will always place <code>s</code> into the <code>queue[]</code> array.   so the array <code>array[]</code> can be eliminated,.  This leads to the first parameter to <code>comb()</code> can be eliminated. and the statement: <code>queue[top++] = input[s];</code> replaced with: <code>queue[top++] = s;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475776557, "post_id": 39868415, "comment_id": 67090700, "body": "the biggest slow down in the code (not including the recursion) is the many callsl to <code>printf()</code>.   &#39;N&#39;+1 calls for each output line.   This could be easily reduced to a single call per output line by creating a format string once, then calling <code>sprintf()  to format all the values, once per line, then calling </code>puts()` to actually output the line."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475777597, "post_id": 39868415, "comment_id": 67091278, "body": "regarding optimizations, the function: <code>comb()</code> has the parameter <code>n</code>, but that parameter is never changed.  so could eliminate that parameter and use the <code>#define</code> <code>N</code> within the function."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475777727, "post_id": 39868415, "comment_id": 67091356, "body": "regarding optimizations, in the function: <code>comb()</code>, these two lines can be eliminated: <code>top--;      comb(input,s+1, n, M);</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475777968, "post_id": 39868415, "comment_id": 67091498, "body": "regarding optimizations: regarding these two lines: <code>result[i] = queue[i];             printf(&quot;%d\\n&quot;, queue[i]);</code>, the array <code>result[]</code> is only set, never read, so this line: <code>result[i] = queue[i];</code> can be removed."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1475778239, "post_id": 39868415, "comment_id": 67091636, "body": "regarding this line: <code>printf(&quot;%d\\n&quot;, queue[i]);</code>  This will print one number per line. so will take 4 lines to print one output.  Suggest remove the &#39;\\n&#39; and only output a newline after all the numbers in a single combination are printed,  Suggest: <code>printf( &quot;%d &quot;, queue[i] );</code>  then follow the loop with: <code>puts(&quot;&quot;);</code> Note: <code>puts()</code> always prints a final &#39;\\n&#39;."}], "answers": [{"tags": [], "owner": {"reputation": 2513, "user_id": 3169556, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lIlqX.jpg?s=128&g=1", "display_name": "v78", "link": "https://stackoverflow.com/users/3169556/v78"}, "is_accepted": false, "score": 0, "last_activity_date": 1475660203, "last_edit_date": 1475660203, "creation_date": 1475659538, "answer_id": 39870176, "question_id": 39868415, "link": "https://stackoverflow.com/questions/39868415/parallelization-of-combination/39870176#39870176", "title": "Parallelization of Combination", "body": "<p>To me your code was even giving the desired output. <a href=\"https://ideone.com/2mA8oe\" rel=\"nofollow\">see</a></p>\n\n<p>I have changed</p>\n\n<ol>\n<li>printing format each combination was not good enough.</li>\n<li>repeated combinations. (note: else part of if statement added).</li>\n<li>reduced 2 recursive call with a loop and a recursive call. (Less space.)</li>\n</ol>\n\n<p>The required code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define N  20\n#define M  6\n\nint result[M]= {0}; // THE ARRAY THAT SAVE THE RESULT OF ONE COMBINATION\nint queue[N] = {0};\nint top = 0;\n\nvoid comb(int* input,int s, int n, int m)\n{\n    if (s &gt; n)\n        return ; \n\n    if (top == m)\n    {\n        printf(\"\\n\");\n        for (int i = 0; i &lt; m; i++)\n        {\n            result[i] = queue[i];\n            printf(\"%d \", queue[i]);\n        }\n     }else{\n         for(int ss=s;ss&lt;n;ss++){\n            queue[top++] = input[ss];\n            comb(input,ss+1, n, m);\n            top--;\n         }\n         //comb(input,s+1, n, m);   \n     }\n}\n\nint main()\n{  \n   int array[] = {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,\n                  27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,\n                  50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,\n                  73,74,75,76,77,78,79,80};\n\n    printf(\"\\ncombinations():\\n\");\n    comb(array,0, N, M);\n    printf(\"\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 4753664, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/831060370294066/picture?type=large", "display_name": "bslqy", "link": "https://stackoverflow.com/users/4753664/bslqy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475660203, "creation_date": 1475654303, "last_edit_date": 1475657980, "question_id": 39868415, "link": "https://stackoverflow.com/questions/39868415/parallelization-of-combination", "title": "Parallelization of Combination", "body": "<p>I have got a piece of code that prints the combination of M number From N (nCm);</p>\n\n<p>As it is a recursion, it works very slow when N is large.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define N  80\n#define M  4\n\nint result[M]= {0}; // THE ARRAY THAT SAVE THE RESULT OF ONE COMBINATION\nint queue[N] = {0};\nint top = 0;\n\nvoid comb(int* input,int s, int n, int m)\n{\n    if (s &gt; n)\n        return ; \n\n    if (top == m)\n    {\n        for (int i = 0; i &lt; m; i++)\n        {\n            result[i] = queue[i];\n            printf(\"%d\\n\", queue[i]);\n        }\n     }\n\n     queue[top++] = input[s];\n     comb(input,s+1, n, M);\n     top--;\n     comb(input,s+1, n, M);\n}\n\nint main()\n{  \n   int array[] = {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,\n                  27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,\n                  50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,\n                  73,74,75,76,77,78,79,80};\n\n    printf(\"\\ncombination():\\n\");\n    comb(array,0, N, M);\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>I would like to know if there is any space for improvement in the algorithm above? \nif possible, can I use openMP ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "winapi", "transparency", "chromium-embedded", "alphablending"], "comments": [{"owner": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 0, "creation_date": 1475668020, "post_id": 39868302, "comment_id": 67032787, "body": "in OnPaint you should use the hdc taken from BeginPaint function instead of using GetDC. This might solve the problem with the background contents. As for the wrong alpha values, you might need to premultiply the alpha values in the bitmap as shown here: <a href=\"http://www.fengyuan.com/article/alphablend.html\" rel=\"nofollow noreferrer\">fengyuan.com/article/alphablend.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 6900222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a278ede3d6db1a6e1bd268dda004d8?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel Sikorski", "link": "https://stackoverflow.com/users/6900222/pawel-sikorski"}, "edited": false, "score": 0, "creation_date": 1475670243, "post_id": 39869368, "comment_id": 67034267, "body": "Yes, it works. The only thing, that is kind of not working is semi-transparent pixels (that are within the hbitmap). But I can leave with that now. I have used TransparentBlt. I do not use LWA_ALPHA, as it does transparency to all the pixels (I do not want that). I am painting that outside of WM_PAINT, so I need to use GetDC/ReleaseDC"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 48, "user_id": 6900222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a278ede3d6db1a6e1bd268dda004d8?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel Sikorski", "link": "https://stackoverflow.com/users/6900222/pawel-sikorski"}, "edited": false, "score": 0, "creation_date": 1475673463, "post_id": 39869368, "comment_id": 67036632, "body": "Is this from a *.png file? Give more information in the question about the image, if possible upload a sample (the default upload would convert the *.bmp to *.png)"}, {"owner": {"reputation": 48, "user_id": 6900222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a278ede3d6db1a6e1bd268dda004d8?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel Sikorski", "link": "https://stackoverflow.com/users/6900222/pawel-sikorski"}, "edited": false, "score": 0, "creation_date": 1475677014, "post_id": 39869368, "comment_id": 67039478, "body": "No, it is not a static image, I have mentioned, that buffer comes from Chromium-Embedded-Framework. So in other words, it is a buffer generated by chromium from html."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 48, "user_id": 6900222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a278ede3d6db1a6e1bd268dda004d8?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel Sikorski", "link": "https://stackoverflow.com/users/6900222/pawel-sikorski"}, "edited": false, "score": 0, "creation_date": 1475688639, "post_id": 39869368, "comment_id": 67047296, "body": "If bitmap image has premultiplied alpha then your method should work fine. Try doing the same thing but not in a layered window. I don&#39;t think it does have premultiplied alpha. You can post some images of what it looks like and what you think it should look like, or leave it as is... If you own the window then you can paint in <code>WM_PAINT</code>, and send <code>InvalidateRect</code> message to force repaint."}, {"owner": {"reputation": 48, "user_id": 6900222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a278ede3d6db1a6e1bd268dda004d8?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel Sikorski", "link": "https://stackoverflow.com/users/6900222/pawel-sikorski"}, "edited": false, "score": 0, "creation_date": 1475764490, "post_id": 39869368, "comment_id": 67083193, "body": "Not using layered window breaks it - the transparency does not work. But, maybe it is a problem of CEF/chromium - that generates bitmap with such background.  Note: I do not use WM_PAINT nor WM_ERASEBKGND. Anyway, Thanks for all the help"}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 1, "last_activity_date": 1475657321, "creation_date": 1475657321, "answer_id": 39869368, "question_id": 39868302, "link": "https://stackoverflow.com/questions/39868302/windows-alphablend-with-buffer-usage/39869368#39869368", "title": "Windows AlphaBlend with buffer usage", "body": "<p>It's not necessary to use both <code>AlphaBlend</code> and layered windows. Use layered windows only:</p>\n\n<pre><code>void OnPaint(HDC hdc, int width, int height, HBITMAP hbitmap)\n{\n    HDC memdc = CreateCompatibleDC(hdc);\n    auto oldbmp = SelectObject(memdc, hbitmap);\n\n    BITMAP bm;\n    GetObject(hbitmap, sizeof(bm), &amp;bm);\n    BitBlt(hdc, 0, 0, bm.bmWidth, bm.bmHeight, memdc, 0, 0, SRCCOPY);\n\n    SelectObject(memdc, oldbmp);\n    DeleteDC(memdc);\n}\n</code></pre>\n\n<p>Where <code>hbitmap</code> is a handle to the bitmap created earlier. The white areas of the bitmap should appear as transparent when using <code>SetLayeredWindowAttributes(hwnd, RGB(255,255,255), 255, LWA_COLORKEY);</code> </p>\n\n<p>Or use <code>LWA_COLORKEY | LWA_ALPHA</code> to adjust both transparency and alpha level.</p>\n\n<p>Assuming <code>OnPaint</code> is a response to <code>WM_PAINT</code>, use <code>BeginPaint/EndPaint</code> instead of <code>GetDC/ReleaseDC</code></p>\n\n<p>Note that <code>WHITE_BRUSH</code> is zero, so <code>wcex.hbrBackground = WHITE_BRUSH;</code> sets the background brush to zero. Assign a brush handle instead.</p>\n\n<p>Alternatively you can use <code>TransparentBlt</code> in the same window:</p>\n\n<pre><code>HDC memdc = CreateCompatibleDC(hdc);\nauto oldbmp = SelectObject(memdc, hbitmap);\n\nBITMAP bm;\nGetObject(hbitmap, sizeof(bm), &amp;bm);\nTransparentBlt(hdc, 0, 0, width, height, \n    memdc, 0, 0, bm.bmWidth, bm.bmHeight, RGB(255, 255, 255));\n\nSelectObject(memdc, oldbmp);\nDeleteDC(memdc);\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 6900222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a278ede3d6db1a6e1bd268dda004d8?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel Sikorski", "link": "https://stackoverflow.com/users/6900222/pawel-sikorski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 39869368, "answer_count": 1, "score": 1, "last_activity_date": 1475657321, "creation_date": 1475653970, "question_id": 39868302, "link": "https://stackoverflow.com/questions/39868302/windows-alphablend-with-buffer-usage", "title": "Windows AlphaBlend with buffer usage", "body": "<p>I would like to draw a buffer (with alpha information!) within a given window. The drawing is done outside of WM_PAINT (it is done in CefRenderHandler::OnPaint method called from Chromium-Embedded-Framework).</p>\n\n<p>The problem, that I have are:</p>\n\n<ul>\n<li>old content of the window is not cleared (if buffer is changed, I get old content drawn and new content drawn).</li>\n<li>the alpha channel is wrongly interpreted - I think, that even though the pixel has the alpha information, it is painted as it would not have the alpha information</li>\n</ul>\n\n<p>This is what I have so far:</p>\n\n<p>OnPaint(...): </p>\n\n<pre><code>HDC screen_dc = GetDC(windowHandle);\nRECT rcWin;\nGetClientRect(windowHandle, &amp;rcWin);\n\nBITMAPINFO info;\nZeroMemory(&amp;info, sizeof(BITMAPINFO));\ninfo.bmiHeader.biBitCount = 32;\ninfo.bmiHeader.biWidth = width;\ninfo.bmiHeader.biHeight = -height;\ninfo.bmiHeader.biPlanes = 1;\ninfo.bmiHeader.biSize = sizeof(BITMAPINFOHEADER);\ninfo.bmiHeader.biSizeImage = width*height * 4;\ninfo.bmiHeader.biCompression = BI_RGB;\n\nvoid *buf;\nHBITMAP hDib = CreateDIBSection(screen_dc, &amp;info, DIB_RGB_COLORS, (void **)&amp;buf, 0, 0);\nmemcpy(buf, buffer, width * height * 4); //buffer contains bitmap to draw\nHDC hDibDC = CreateCompatibleDC(screen_dc);\nHGDIOBJ hOldObj = SelectObject(hDibDC, hDib);\nBLENDFUNCTION blendFunction_;\nblendFunction.BlendOp = AC_SRC_OVER;\nblendFunction.BlendFlags = 0;\nblendFunction.SourceConstantAlpha = 255;\nblendFunction.AlphaFormat = AC_SRC_ALPHA;\nAlphaBlend(screen_dc, 0, 0, width, height, hDibDC, 0, 0, width, height, blendFunction);\n\nSelectObject(hDibDC, hOldObj);\nReleaseDC(windowHandle, screen_dc);\nDeleteObject(hDib);\nDeleteDC(hDibDC);\n</code></pre>\n\n<p>Window creation:</p>\n\n<pre><code>WNDCLASSEX wcex = {0};\nwcex.cbSize = sizeof(wcex);\nwcex.style = CS_HREDRAW | CS_VREDRAW;\nwcex.lpfnWndProc = BrowserWindowWndProc;\nwcex.hInstance = hinstance;\nwcex.hCursor = LoadCursor(NULL, IDC_ARROW);\nwcex.hbrBackground = WHITE_BRUSH;\nwcex.lpszClassName = BROWSER_WINDOW_CLASS;\nwcex.cbClsExtra = 0;\nwcex.cbWndExtra = 0;\nRegisterClassEx(&amp;wcex);\n\nDWORD exStyle{0};\nexStyle |= WS_EX_TOOLWINDOW;\nexStyle |= WS_EX_LAYERED;\n\nDWORD style {0};\nstyle |= WS_SYSMENU;\nstyle |= WS_VISIBLE;\n\nHWND hWnd = CreateWindowEx(\n    exStyle,\n    BROWSER_WINDOW_CLASS, \n    BROWSER_WINDOW_CLASS,\n    style,\n    100,\n    100,\n    300,\n    300,\n    nullptr,\n    nullptr, \n    hinstance,\n    nullptr\n);\n...\nSetLayeredWindowAttributes(hWnd, RGB(255, 255, 255), 255, LWA_COLORKEY);\n</code></pre>\n\n<p>Could you help me with these problems?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c", "pointers", "casting"], "comments": [{"owner": {"reputation": 22202, "user_id": 696391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VrUwT.jpg?s=128&g=1", "display_name": "samgak", "link": "https://stackoverflow.com/users/696391/samgak"}, "edited": false, "score": 0, "creation_date": 1475653287, "post_id": 39868008, "comment_id": 67023427, "body": "The result will depend on the <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">endianness</a> of the system. It&#39;s therefore not portable code."}, {"owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "edited": false, "score": 0, "creation_date": 1475653408, "post_id": 39868008, "comment_id": 67023509, "body": "Strict aliasing does not apply since you can always alias to an 8 bit pointer."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1475653527, "post_id": 39868008, "comment_id": 67023567, "body": "@unwind maybe <a href=\"http://stackoverflow.com/questions/23848188/strict-aliasing-rule-and-char-pointers\" title=\"strict aliasing rule and char pointers\">stackoverflow.com/questions/23848188/&hellip;</a> is a better duplicate"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "reply_to_user": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "edited": false, "score": 0, "creation_date": 1475654238, "post_id": 39868008, "comment_id": 67023982, "body": "@doron Not if <code>CHAR_BIT &gt; 8</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "edited": false, "score": 0, "creation_date": 1475654523, "post_id": 39868008, "comment_id": 67024145, "body": "@doron You can convert from pointer-to-x to pointer-to-char, but not the other way around. So strict aliasing does apply, assuming the &quot;8 bit pointer&quot; is a character type."}, {"owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "edited": false, "score": 0, "creation_date": 1475655000, "post_id": 39868008, "comment_id": 67024409, "body": "You are right. You will have to copy the bytes into the integer"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1481562347, "post_id": 39868008, "comment_id": 69415916, "body": "@Rhymoid: No conforming compiler can define types uint8_t and int8_t unless CHAR_BIT==8.  A conforming compiler, however, may define integer types other than &quot;char&quot;, &quot;short&quot;, &quot;int&quot;, &quot;long&quot;, and &quot;long long&quot;; if it defined an 8-bit type with no padding which was none of the above, it could use the identifiers <code>uint8_t</code> and <code>int8_t</code> to identify such a type.  I would think that was a horrible idea (IMHO, there should be a pair of signed/unsigned types with some other name for that purpose) but it would allowed under the Standard."}], "answers": [{"tags": [], "owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "is_accepted": false, "score": 0, "last_activity_date": 1475653675, "creation_date": 1475653675, "answer_id": 39868214, "question_id": 39868008, "link": "https://stackoverflow.com/questions/39868008/write-with-8bit-pointer-read-with-32bit-pointer/39868214#39868214", "title": "Write with 8bit pointer, read with 32bit pointer", "body": "<p>When you read the 32bits back as an integer you get the integer representation of whatever you wrote.</p>\n\n<p>What you have described is a technique commonly used to deserialize binary data. The reverse procedure will serialize the data.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6385115"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "closed_date": 1475653313, "answer_count": 1, "score": 0, "last_activity_date": 1475653675, "creation_date": 1475652964, "question_id": 39868008, "link": "https://stackoverflow.com/questions/39868008/write-with-8bit-pointer-read-with-32bit-pointer", "closed_reason": "Duplicate", "title": "Write with 8bit pointer, read with 32bit pointer", "body": "<p>What really happens if we write 4 times 1B of char with 8bit pointer, and then we read that 4B with 32bit pointer? Why this is not recommended, what can happen?</p>\n"}, {"tags": ["c", "memory", "segmentation-fault", "bit-manipulation"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 2, "creation_date": 1475652969, "post_id": 39867953, "comment_id": 67023243, "body": "As we cannot reproduce your problem we cannot answer. Use a debugger, you will certainly find the source of the problem."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1475653056, "post_id": 39867953, "comment_id": 67023292, "body": "<code>i &lt; i + num_instrs*2</code> ?"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1475656143, "post_id": 39867953, "comment_id": 67024993, "body": "I think @BLUEPIXY nailed it. Changing to <code>i &lt; starting_addr&#47;2 + num_instrs*2</code> should fix it."}], "answers": [{"tags": [], "owner": {"reputation": 134, "user_id": 6915174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BUmUa.jpg?s=128&g=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/6915174/peter-k"}, "is_accepted": false, "score": 2, "last_activity_date": 1475656407, "creation_date": 1475656407, "answer_id": 39869042, "question_id": 39867953, "link": "https://stackoverflow.com/questions/39867953/segemention-fault-core-dumped/39869042#39869042", "title": "Segemention fault (core dumped)", "body": "<p>As told in comments above, the error is in <code>i &lt; i + num_instrs*2</code> condition. Note, the value of 'i' is not frizzed in <code>i + num_instrs*2</code> - it is incremented on each step - i. e. condition will looks like <code>0 &lt; 0 +10*2</code>,  <code>2 &lt; 2 +10*2</code>, <code>4 &lt; 4 +10*2</code>. So you need to use initial value <code>starting_addr/2</code> in condition:</p>\n\n<p>Please change</p>\n\n<pre><code>for(i = starting_addr/2; i &lt; i + num_instrs*2; i += 2){\n</code></pre>\n\n<p>to</p>\n\n<pre><code>for(i = starting_addr/2; i &lt; starting_addr/2 + num_instrs*2; i += 2){\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6924897, "user_type": "registered", "profile_image": "https://graph.facebook.com/341670292891019/picture?type=large", "display_name": "Ellison Larry", "link": "https://stackoverflow.com/users/6924897/ellison-larry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1475656407, "creation_date": 1475652754, "question_id": 39867953, "link": "https://stackoverflow.com/questions/39867953/segemention-fault-core-dumped", "title": "Segemention fault (core dumped)", "body": "<p>I'm writing some code for school that mimics a simple CPU. I know what segmentation faults are but I can't find what's wrong with my code.</p>\n\n<p><strong><em>There is nothing wrong with the header or main, I'm including it for referrence</em></strong></p>\n\n<p>Here is my header: </p>\n\n<pre><code>#define NUM_BYTES (16 * 1024) \n#define BYTES_PER_WORD 2\n#define WORDS_PER_INSTRUCTION 2\n#define NUM_WORDS (NUM_BYTES / BYTES_PER_WORD)\n#define NUM_INSTRUCTIONS (NUM_WORDS / WORDS_PER_INSTRUCTION)\n#define R0 0\n#define R1 1\n#define R2 2\n#define R3 3\n#define R4 4\n#define R5 5\n\ntypedef unsigned short Machine_word;\n\ntypedef enum { PLUS, MINUS, TIMES, DIV, NEG, AND, OR, NOT, LI, LW, SW,\n               MOVE, CMP, READ, WRITE, HALT } Opcode;\n\ntypedef enum { LT, LE, GT, GE, EQ, NE } Comparison;\n\ntypedef struct {\n  Opcode opcode;\n  Comparison comparison;\n  unsigned short reg1;\n  unsigned short reg2;\n  unsigned short reg3;\n  unsigned short addr_or_imm;\n} Instruction;\n\nvoid print_instruction(Instruction instr);\nint disassemble(const Machine_word memory[], int starting_addr, int num_instrs,\n                Instruction instrs[], int *const valid_instrs);\nint valid_instruction(Machine_word instr_word1, Machine_word instr_word2);\nint assemble(unsigned short opcode, unsigned short comparison,\n             unsigned short reg1, unsigned short reg2, unsigned short reg3,\n             unsigned short addr_or_imm, Machine_word *const word1,\n             Machine_word *const word2);\n</code></pre>\n\n<p>My main: </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include \"header.h\"\n\n#define PROGRAM_SIZE 10\n\n\nint main() {\n  Machine_word words[NUM_WORDS]= {0x10a5,      0,  /* 2 words of 1st instr. */\n                                  0x80c0, 0x03ff,  /* 2 words of 2nd instr. */\n                                  0xa040, 0x00d8,  /* etc. */\n                                  0x5008,      0,\n                                  0x7080,      0,\n                                  0xc528, 0x21f8,\n                                  0x9080, 0x2718,\n                                  0xb058,      0,\n                                  0xe100,      0,\n                                  0xf000,      0};\n  /* double braces because it's an array of structures */\n  Instruction instrs[NUM_INSTRUCTIONS]= {{0}};\n  int i, num_valid_instrs= 0;\n\n  disassemble(words, 0, PROGRAM_SIZE, instrs, &amp;num_valid_instrs);\n\n  for (i= 0; i &lt; num_valid_instrs; i++) {\n    print_instruction(instrs[i]);\n    printf(\"\\n\");\n  }\n</code></pre>\n\n<p><strong><em>My functions: (the first function has no issue!)</em></strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include \"machine.h\"\n\n\nvoid print_instruction(Instruction instr) {\n\n  if (instr.opcode == HALT) {\n    printf(\"halt\");\n  } else if (instr.opcode == PLUS) {\n    printf(\"plus\\tR%hu\\tR%hu\\tR%hu\", instr.reg1, instr.reg2, instr.reg3);\n  } else if (instr.opcode == MINUS) {\n    printf(\"minus\\tR%hu\\tR%hu\\tR%hu\", instr.reg1, instr.reg2, instr.reg3);\n  } else if (instr.opcode == TIMES) {\n    printf(\"times\\tR%hu\\tR%hu\\tR%hu\", instr.reg1, instr.reg2, instr.reg3);\n  } else if (instr.opcode == DIV) {\n    printf(\"div\\tR%hu\\tR%hu\\tR%hu\", instr.reg1, instr.reg2, instr.reg3);\n  } else if (instr.opcode == NEG) {\n    printf(\"neg\\tR%hu\\tR%hu\", instr.reg1, instr.reg2);\n  } else if (instr.opcode == AND) {\n    printf(\"and\\tR%hu\\tR%hu\\tR%hu\", instr.reg1, instr.reg2, instr.reg3);\n  } else if (instr.opcode == OR) {\n    printf(\"or\\tR%hu\\tR%hu\\tR%hu\", instr.reg1, instr.reg2, instr.reg3);\n  } else if (instr.opcode == NOT) {\n    printf(\"not\\tR%hu\\tR%hu\", instr.reg1, instr.reg2);\n  } else if(instr.opcode == LI) {\n    printf(\"li\\tR%hu\\t%05hu\", instr.reg1, instr.addr_or_imm);\n  }else if (instr.opcode == LW) {\n    printf(\"lw\\tR%hu\\t%05hu\", instr.reg1, instr.addr_or_imm);\n  } else if (instr.opcode == SW) {\n    printf(\"sw\\tR%hu\\t%05hu\", instr.reg1, instr.addr_or_imm);\n  } else if (instr.opcode == MOVE) {\n    printf(\"move\\tR%hu\\tR%hu\", instr.reg1, instr.reg2);\n  } else if (instr.opcode == CMP) {\n    printf(\"cmp %d\\tR%hu\\tR%hu\\t%05hu\", (int)instr.comparison, instr.reg1, instr.reg2, instr.addr_or_imm);\n  } else if (instr.opcode == READ) {\n    printf(\"read\\tR%hu\", instr.reg1);\n  } else if (instr.opcode == WRITE) {\n    printf(\"write\\tR%hu\", instr.reg1);\n  }\n}\n\n\nint disassemble(const Machine_word memory[], int starting_addr, int num_instrs, Instruction instrs[], int *const valid_instrs) {\n  int i, count= 0, index= 0;\n\n  if(starting_addr % 4 != 0)\n    return 0;\n  if(starting_addr &lt; 0 || starting_addr &gt; 16384)\n    return 0;\n  if(starting_addr + num_instrs*4 &gt; 16384)\n    return 0;\n  if(memory == NULL || instrs == NULL)\n    return 0;\n\n  for(i = starting_addr/2; i &lt; i + num_instrs*2; i += 2){\n    /*read instructions*/\n    Machine_word opcode = memory[i];\n    Machine_word comparison = memory[i];\n    Machine_word reg1 = memory[i];\n    Machine_word reg2 = memory[i];\n    Machine_word reg3 = memory[i];\n    Machine_word mem_addr = memory[i + 1];\n\n    opcode = (opcode &amp; 0xf000) &gt;&gt; 12;\n    comparison = (comparison &amp; 0x0e00) &gt;&gt; 9;\n    reg1 = (reg1 &amp; 0x01c0) &gt;&gt; 6;\n    reg2 = (reg2 &amp; 0x0038) &gt;&gt; 3;\n    reg3 = (reg3 &amp; 0x0007);\n\n    if(opcode == 0) {\n      instrs[index].opcode = PLUS;\n      instrs[index].reg1 = reg1;\n      instrs[index].reg2 = reg2;\n      instrs[index].reg3 = reg3;\n    } else if(opcode == 1) {\n      instrs[index].opcode = MINUS;\n      instrs[index].reg1 = reg1;\n      instrs[index].reg2 = reg2;\n      instrs[index].reg3 = reg3;\n    } else if(opcode == 2) {\n      instrs[index].opcode = TIMES;\n      instrs[index].reg1 = reg1;\n      instrs[index].reg2 = reg2;\n      instrs[index].reg3 = reg3;\n    } else if(opcode == 3) {\n      instrs[index].opcode = DIV;\n      instrs[index].reg1 = reg1;\n      instrs[index].reg2 = reg2;\n      instrs[index].reg3 = reg3;\n    } else if(opcode == 4) {\n      instrs[index].opcode = NEG;\n      instrs[index].reg1 = reg1;\n      instrs[index].reg2 = reg2;\n    } else if(opcode == 5) {\n      instrs[index].opcode = AND;\n      instrs[index].reg1 = reg1;\n      instrs[index].reg2 = reg2;\n      instrs[index].reg3 = reg3;\n    } else if(opcode == 6) {\n      instrs[index].opcode = OR;\n      instrs[index].reg1 = reg1;\n      instrs[index].reg2 = reg2;\n      instrs[index].reg3 = reg3;\n    } else if(opcode == 7) {\n      instrs[index].opcode = NOT;\n      instrs[index].reg1 = reg1;\n      instrs[index].reg2 = reg2;\n    } else if(opcode == 8){\n      instrs[index].opcode = LI;\n      instrs[index].reg1 = reg1;\n      instrs[index].addr_or_imm = mem_addr;\n    } else if(opcode == 9) {\n      instrs[index].opcode = LW;\n      instrs[index].reg1 = reg1;\n      instrs[index].addr_or_imm = mem_addr;\n    } else if(opcode == 10) {\n      instrs[index].opcode = SW;\n      instrs[index].reg1 = reg1;\n      instrs[index].addr_or_imm = mem_addr;\n    } else if(opcode == 11) {\n      instrs[index].opcode = MOVE;\n      instrs[index].reg1 = reg1;\n      instrs[index].reg2 = reg2;\n    } else if(opcode == 12) {\n      instrs[index].opcode = CMP;\n      instrs[index].comparison = (Comparison)comparison;\n      instrs[index].reg1 = reg1;\n      instrs[index].reg2 = reg2;\n    } else if(opcode == 13) {\n      instrs[index].opcode = READ;\n      instrs[index].reg1 = reg1;\n    } else if(opcode == 14) {\n      instrs[index].opcode = WRITE;\n      instrs[index].reg1 = reg1;\n    } else if(opcode == 15) {\n      instrs[index].opcode = HALT;\n    }\n\n    index++;\n    count++;\n\n  }\n\n  *valid_instrs = count;\n  return 1;\n}\n</code></pre>\n\n<p><strong><em>Only the second function, which does bit manipulations, has issues</em></strong></p>\n\n<p>apologies for it being so long.</p>\n"}, {"tags": ["android", "c", "android-studio", "rom"], "answers": [{"tags": [], "owner": {"reputation": 1548, "user_id": 3082873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wT9Nk.jpg?s=128&g=1", "display_name": "cagdas", "link": "https://stackoverflow.com/users/3082873/cagdas"}, "is_accepted": true, "score": 0, "last_activity_date": 1475656579, "creation_date": 1475656579, "answer_id": 39869098, "question_id": 39867419, "link": "https://stackoverflow.com/questions/39867419/how-to-import-the-android-rom-source-code-into-android-studio/39869098#39869098", "title": "How to import the Android ROM source code into Android Studio?", "body": "<p>Here are Google docs to describe how you do it :</p>\n\n<p><a href=\"https://developer.android.com/studio/projects/add-native-code.html\" rel=\"nofollow\">https://developer.android.com/studio/projects/add-native-code.html</a></p>\n\n<p>Go for \"Create a New Project with C/C++ Support\" step directly if you do not like to have a native build in it.</p>\n"}], "owner": {"reputation": 105, "user_id": 2871337, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/wlQGc.jpg?s=128&g=1", "display_name": "user2871337", "link": "https://stackoverflow.com/users/2871337/user2871337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 1, "accepted_answer_id": 39869098, "answer_count": 1, "score": 1, "last_activity_date": 1475656579, "creation_date": 1475651026, "last_edit_date": 1475651291, "question_id": 39867419, "link": "https://stackoverflow.com/questions/39867419/how-to-import-the-android-rom-source-code-into-android-studio", "title": "How to import the Android ROM source code into Android Studio?", "body": "<p>I have downloaded one <code>Android ROM source code</code>, it has many file and folder, which takes a lot disk space (about 40GB). If I want to use android studio to edit some file, for example, <code>/$ROM/frameworks/av/media/libstagefright/DataSource.cpp</code></p>\n\n<p>Because, while editing the <code>.cpp file</code>, I want the android studio IDE can point out where the wrong code is, and provide the function library. Just like editing normal android project java file. </p>\n\n<p>How to import the <code>ROM source code into</code> Android Studio??</p>\n"}, {"tags": ["c++", "c", "linux", "native", "machine-language"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1475651395, "post_id": 39867396, "comment_id": 67022325, "body": "This probably depends on OS and compiler, so you should add that info. You may need compiler-specific stuff to tell that <code>prog</code> should be executable, just as you suspect."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1475651557, "post_id": 39867396, "comment_id": 67022444, "body": "Also, make the function return <code>void</code> to avoid any problems related to that."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1475651640, "post_id": 39867396, "comment_id": 67022494, "body": "You need to allocate a page of memory and make it executable."}, {"owner": {"reputation": 1281, "user_id": 402390, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/bf0b81f0e833bbfbe809a254e72a2171?s=128&d=identicon&r=PG", "display_name": "Doddy", "link": "https://stackoverflow.com/users/402390/doddy"}, "edited": false, "score": 1, "creation_date": 1475666308, "post_id": 39867396, "comment_id": 67031632, "body": "Incase it helps anyone: I&#39;ve often found that SIGBUS is indicative of bad alignment."}, {"owner": {"reputation": 12144, "user_id": 72882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9d17e71eae127205da470fffa2dba899?s=128&d=identicon&r=PG", "display_name": "dandan78", "link": "https://stackoverflow.com/users/72882/dandan78"}, "edited": false, "score": 7, "creation_date": 1475670792, "post_id": 39867396, "comment_id": 67034658, "body": "@user Please post your solution as an answer instead of editing it into your question."}, {"owner": {"reputation": 20213, "user_id": 147845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e225ff5beb684088f5c9131d3979a18?s=128&d=identicon&r=PG", "display_name": "You", "link": "https://stackoverflow.com/users/147845/you"}, "reply_to_user": {"reputation": 12144, "user_id": 72882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9d17e71eae127205da470fffa2dba899?s=128&d=identicon&r=PG", "display_name": "dandan78", "link": "https://stackoverflow.com/users/72882/dandan78"}, "edited": false, "score": 3, "creation_date": 1475677620, "post_id": 39867396, "comment_id": 67039986, "body": "I reverted the changes to the code sample, so the question makes sense again. Please do what @dandan78 already suggested and accept an answer instead of updating your question, changing its meaning in the process."}, {"owner": {"reputation": 2923, "user_id": 3434508, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/gFffm.png?s=128&g=1", "display_name": "Stavr00", "link": "https://stackoverflow.com/users/3434508/stavr00"}, "edited": false, "score": 3, "creation_date": 1475678765, "post_id": 39867396, "comment_id": 67040922, "body": "Would it be more practical to use the <code>asm()</code> function?"}, {"owner": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "reply_to_user": {"reputation": 2923, "user_id": 3434508, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/gFffm.png?s=128&g=1", "display_name": "Stavr00", "link": "https://stackoverflow.com/users/3434508/stavr00"}, "edited": false, "score": 9, "creation_date": 1475703605, "post_id": 39867396, "comment_id": 67055169, "body": "Please, please, please, please, please, please, please use <code>asm()</code> (per @Stavr00&#39;s comment and Graham&#39;s answer) rather than any of the other approaches, especially if your code has <i>any</i> possibility of ever seeing the light of day on a piece of silicon that is in any way connected to the internet or has any possibility of interacting with anyone beyond yourself."}, {"owner": {"reputation": 73538, "user_id": 43681, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6c2dd6a39d3f38f1bb47a8c1fe8325e2?s=128&d=identicon&r=PG", "display_name": "sleske", "link": "https://stackoverflow.com/users/43681/sleske"}, "edited": false, "score": 0, "creation_date": 1475753925, "post_id": 39867396, "comment_id": 67075599, "body": "I took the liberty of replacing &quot;native code&quot; with &quot;machine code&quot; in the title - that should avoid misunderstandings."}], "answers": [{"comments": [{"owner": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 0, "creation_date": 1475651927, "post_id": 39867566, "comment_id": 67022675, "body": "True! <i>(this is just padding)</i>"}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 6, "last_activity_date": 1475651494, "creation_date": 1475651494, "answer_id": 39867566, "question_id": 39867396, "link": "https://stackoverflow.com/questions/39867396/how-to-call-machine-code-stored-in-char-array/39867566#39867566", "title": "How to call machine code stored in char array?", "body": "<p>One obvious error is that <code>\\xc3</code> is not returning the <code>double</code> that you claim it's returning.</p>\n"}, {"comments": [{"owner": {"reputation": 475, "user_id": 778617, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2fc8fa88bad87f766e76d7c9345aaaab?s=128&d=identicon&r=PG", "display_name": "Mr. Zurg", "link": "https://stackoverflow.com/users/778617/mr-zurg"}, "edited": false, "score": 4, "creation_date": 1475761745, "post_id": 39867665, "comment_id": 67081148, "body": "<a href=\"http://jroweboy.github.io/c/asm/2015/01/26/when-is-main-not-a-function.html\" rel=\"nofollow noreferrer\">This article</a> goes into remarkably complete detail on how to embed and call machine code in C. It starts with the premise of turning main() into a char array."}], "tags": [], "owner": {"reputation": 8064, "user_id": 5910563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/snpEp.jpg?s=128&g=1", "display_name": "Horia Coman", "link": "https://stackoverflow.com/users/5910563/horia-coman"}, "is_accepted": true, "score": 51, "last_activity_date": 1475651785, "last_edit_date": 1495542850, "creation_date": 1475651785, "answer_id": 39867665, "question_id": 39867396, "link": "https://stackoverflow.com/questions/39867396/how-to-call-machine-code-stored-in-char-array/39867665#39867665", "title": "How to call machine code stored in char array?", "body": "<p>One first problem might be that the location where the prog data is stored is not executable.</p>\n\n<p>On Linux at least, the resulting binary will place the contents of global variables in the <a href=\"https://en.wikipedia.org/wiki/Data_segment\" rel=\"nofollow noreferrer\">\"data\" segment</a> or <a href=\"http://www.hep.wisc.edu/~pinghc/Process_Memory.htm\" rel=\"nofollow noreferrer\">here</a>, which is not executable in <a href=\"https://stackoverflow.com/questions/7863200/why-data-and-stack-segments-are-executable\">most normal cases</a>.</p>\n\n<p>The second problem might be that the code you are invoking is invalid in some way. There's a certain procedure to calling a method in C, called the <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions\" rel=\"nofollow noreferrer\">calling convention</a> (you might be using the \"cdecl\" one, for example). It might not be enough for the called function to just \"ret\". It might also need to do some stack cleanup etc. otherwise the program will behave unexpectedly. This might prove an issue once you get past the first problem.</p>\n"}, {"comments": [{"owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 0, "creation_date": 1475763829, "post_id": 39868486, "comment_id": 67082672, "body": "In this case, you can also declare the array <code>const</code> to let it be stored in the executable part of the process memory: <a href=\"http://stackoverflow.com/q/12446965/1025391\">stackoverflow.com/q/12446965/1025391</a>"}, {"owner": {"reputation": 99643, "user_id": 445517, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/57e2ba76e6290c4e9e19821a068bc8c1?s=128&d=identicon&r=PG", "display_name": "CodesInChaos", "link": "https://stackoverflow.com/users/445517/codesinchaos"}, "reply_to_user": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 3, "creation_date": 1475763966, "post_id": 39868486, "comment_id": 67082774, "body": "@moooeeeep You can&#39;t generally assume that the memory section for readonly data is executable, even if some shitty linkers do it like that."}, {"owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "reply_to_user": {"reputation": 99643, "user_id": 445517, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/57e2ba76e6290c4e9e19821a068bc8c1?s=128&d=identicon&r=PG", "display_name": "CodesInChaos", "link": "https://stackoverflow.com/users/445517/codesinchaos"}, "edited": false, "score": 3, "creation_date": 1475764221, "post_id": 39868486, "comment_id": 67082974, "body": "@CodesInChaos You can&#39;t generally assume that you can execute machine code stored in an array, yet the OP asked for it."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 1, "creation_date": 1591635806, "post_id": 39868486, "comment_id": 110124939, "body": "@moooeeeep: sometime in the last year or so, GNU <code>ld</code> started linking <code>.rodata</code> into its own ELF segment so it can be read-only <i>without</i> exec permission.  Not part of the text segment like it used to do.  So that simple trick no longer works.  You could use an <code>__attribute__((section(&quot;.text&quot;)))</code> on a const array, though, in GNU C."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1591635926, "post_id": 39868486, "comment_id": 110125013, "body": "Your shellcode reads past the end of its array with <code>movsd  0x0(%rip),%xmm0</code>.  That&#39;s an 8-byte load starting at the <code>0x5d</code> byte (the byte after the <code>movsd</code> instruction because RIP+0).  x86 is little-endian so the exponent field of the <code>double</code> will be from whatever garbage comes next.  It looks like you naively copied <code>objdump</code> output for compiler-generated debug-mode code for a function that returns a <code>double</code>.  It will of course load that constant from <code>.rodata</code> because x86 doesn&#39;t have FP immediate operands.  But you didn&#39;t put the referenced double into the shellcode."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1591635978, "post_id": 39868486, "comment_id": 110125044, "body": "Some FP constants can be generated on the fly in a few instructions, like in <a href=\"https://stackoverflow.com/q/35085059\">What are the best instruction sequences to generate vector constants on the fly?</a>.  Or just convert your example to returning an <code>int</code> because <code>mov $123, eax</code> / <code>ret</code> is self-contained."}], "tags": [], "owner": {"reputation": 17446, "user_id": 311635, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4907cea9d97688aa7a5e722d742f71?s=128&d=identicon&r=PG", "display_name": "Rudi", "link": "https://stackoverflow.com/users/311635/rudi"}, "is_accepted": false, "score": 51, "last_activity_date": 1475756780, "last_edit_date": 1475756780, "creation_date": 1475654515, "answer_id": 39868486, "question_id": 39867396, "link": "https://stackoverflow.com/questions/39867396/how-to-call-machine-code-stored-in-char-array/39868486#39868486", "title": "How to call machine code stored in char array?", "body": "<p>You need to call memprotect in order to make the page where prog lives executable. The following code does make this call, and can execute the text in prog.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/mman.h&gt;\n\nchar prog[] = {\n   0x55,             // push   %rbp\n   0x48, 0x89, 0xe5, // mov    %rsp,%rbp\n   0xf2, 0x0f, 0x10, 0x05, 0x00, 0x00, 0x00,\n       //movsd  0x0(%rip),%xmm0        # c &lt;x+0xc&gt;\n   0x00,\n   0x5d,             // pop    %rbp\n   0xc3,             // retq\n};\n\nint main()\n{\n    long pagesize = sysconf(_SC_PAGE_SIZE);\n    long page_no = (long)prog/pagesize;\n    int res = mprotect((void*)(page_no*pagesize), (long)page_no+sizeof(prog), PROT_EXEC|PROT_READ|PROT_WRITE);\n    if(res)\n    {\n        fprintf(stderr, \"mprotect error:%d\\n\", res);\n        return 1;\n    }\n    typedef double (*dfunc)(void);\n\n    dfunc d = (dfunc)(&amp;prog[0]);\n    double x = (*d)();\n    printf(\"x=%f\\n\", x);\n    fflush(stdout);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 9, "last_activity_date": 1475664138, "creation_date": 1475664138, "answer_id": 39871809, "question_id": 39867396, "link": "https://stackoverflow.com/questions/39867396/how-to-call-machine-code-stored-in-char-array/39871809#39871809", "title": "How to call machine code stored in char array?", "body": "<p>Essentially this has been clamped down on because it was an open invitation to virus writers. But you can allocate and buffer and set it up with native machinecode in straight C - that's no problem. The issue is calling it. Whilst you can try setting up a function pointer with the address of the buffer and calling it, that's highly unlikely to work, and highly likely to break on the next version of the compiler if somehow you do manage to coax it into doing what you want. So the best bet is to simply resort to a bit of inline assembly, to set up the return and jump to the automatically generated code. But if the system protects against this, you'll have to find methods of circumventing the protection, as Rudi described in his answer (but very specific to one particular system).</p>\n"}, {"tags": [], "owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "is_accepted": false, "score": 31, "last_activity_date": 1476922344, "last_edit_date": 1476922344, "creation_date": 1475665075, "answer_id": 39872134, "question_id": 39867396, "link": "https://stackoverflow.com/questions/39867396/how-to-call-machine-code-stored-in-char-array/39872134#39872134", "title": "How to call machine code stored in char array?", "body": "<p>As everyone already said, you must ensure <code>prog[]</code> is executable, however the proper way to do it, unless you're writing a JIT compiler, is to put the symbol in an executable area, either by using a linker script or by specifying the section in the C code if the compiler allows , e.g.:</p>\n\n<pre><code>const char prog[] __attribute__((section(\".text\"))) = {...}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "edited": false, "score": 7, "creation_date": 1475703448, "post_id": 39880120, "comment_id": 67055115, "body": "Good lord, how did five separate users answer this question without even <i>mentioning</i> <code>asm</code>? Bleeeeeeaaaaaaaarrrrrrrgggggghhhhh."}, {"owner": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "reply_to_user": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "edited": false, "score": 6, "creation_date": 1475706564, "post_id": 39880120, "comment_id": 67056189, "body": "@KyleStrand Maybe everyone else makes the distinction between <i>machine language</i> (what the user wants) and <i>assembler</i>. <code>asm</code> is for example less useful if you want to generate the code on-the-fly."}, {"owner": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 1, "creation_date": 1475738127, "post_id": 39880120, "comment_id": 67065579, "body": "Also you can&#39;t use true assembly in every C compiler. E.g. MSVC will treat its <code>__asm</code> codes as code in yet another high-level language: it will try to optimize it, and won&#39;t let you emit raw bytes (like with <code>db</code> directive in MASM)."}, {"owner": {"reputation": 1597, "user_id": 5162810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pDGmO.jpg?s=128&g=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/5162810/graham"}, "reply_to_user": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "edited": false, "score": 2, "creation_date": 1475749995, "post_id": 39880120, "comment_id": 67073092, "body": "@pipe Except that he&#39;s setting up constant arrays with instruction byte codes.  If he knows what instructions he wants, all he&#39;s doing is a complicated version of embedding an &quot;asm&quot; block."}, {"owner": {"reputation": 1597, "user_id": 5162810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pDGmO.jpg?s=128&g=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/5162810/graham"}, "reply_to_user": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "edited": false, "score": 0, "creation_date": 1475750043, "post_id": 39880120, "comment_id": 67073120, "body": "@KyleStrand Very much so!  Scary stuff... :)"}, {"owner": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "edited": false, "score": 0, "creation_date": 1475767832, "post_id": 39880120, "comment_id": 67085773, "body": "@Graham No, he is not, it&#39;s a plain <code>char</code> array, nothing constant about that. He&#39;s <i>initializing</i> it with a constant."}, {"owner": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "reply_to_user": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "edited": false, "score": 0, "creation_date": 1475778924, "post_id": 39880120, "comment_id": 67092026, "body": "@pipe If you&#39;re going to be pedantic, then note that Graham said &quot;constant&quot;, not &quot;<code>const</code>&quot;."}, {"owner": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "reply_to_user": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "edited": false, "score": 3, "creation_date": 1475779726, "post_id": 39880120, "comment_id": 67092460, "body": "@KyleStrand I never mentioned <code>const</code>. I&#39;m pretty sure that someone who&#39;s trying to execute machine language from C is aware of the <code>asm()</code> construct, and I&#39;m glad that he reduced the <i>example code snippet</i> to the bare minimum that demonstrates the problem."}, {"owner": {"reputation": 1597, "user_id": 5162810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pDGmO.jpg?s=128&g=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/5162810/graham"}, "reply_to_user": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "edited": false, "score": 1, "creation_date": 1475835241, "post_id": 39880120, "comment_id": 67113614, "body": "@pipe If that&#39;s definitely what he wants to do, then fine.  But based on what he originally asked for, and the fact that his byte array is set by a constant initialiser and is not subsequently changed, it&#39;d be negligent <b><i>not</i></b> to point out the &quot;asm&quot; solution as the best (and only good) solution for running a known chunk of assembler."}], "tags": [], "owner": {"reputation": 1597, "user_id": 5162810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pDGmO.jpg?s=128&g=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/5162810/graham"}, "is_accepted": false, "score": 30, "last_activity_date": 1475687848, "creation_date": 1475687848, "answer_id": 39880120, "question_id": 39867396, "link": "https://stackoverflow.com/questions/39867396/how-to-call-machine-code-stored-in-char-array/39880120#39880120", "title": "How to call machine code stored in char array?", "body": "<p>Virtually all C compilers will let you do this by embedding regular assembly language in your code.  Of course it's a non-standard extension to C, but compiler writers recognise that it's often necessary.  As a non-standard extension, you'll have to read your compiler manual and check how to do it, but the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html\">GCC \"asm\" extension</a> is a fairly standard approach.</p>\n\n<pre><code> void DoCheck(uint32_t dwSomeValue)\n {\n    uint32_t dwRes;\n\n    // Assumes dwSomeValue is not zero.\n    asm (\"bsfl %1,%0\"\n      : \"=r\" (dwRes)\n      : \"r\" (dwSomeValue)\n      : \"cc\");\n\n    assert(dwRes &gt; 3);\n }\n</code></pre>\n\n<p>Since it's easy to trash the stack in assembler, compilers often also allow you to identify registers you'll use as part of your assembler.  The compiler can then ensure the rest of that function steers clear of those registers.</p>\n\n<p>If you're writing the assembler code yourself, there is no good reason to set up that assembler as an array of bytes.  It's not just a code smell - I'd say it is a genuine error which could only happen by being unaware of the \"asm\" extension which is the right way to embed assembler in your C.</p>\n"}], "owner": {"reputation": 1169, "user_id": 5406764, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QHi4y.png?s=128&g=1", "display_name": "user5406764", "link": "https://stackoverflow.com/users/5406764/user5406764"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14322, "favorite_count": 25, "accepted_answer_id": 39867665, "answer_count": 6, "score": 57, "last_activity_date": 1476922344, "creation_date": 1475650937, "last_edit_date": 1475756916, "question_id": 39867396, "link": "https://stackoverflow.com/questions/39867396/how-to-call-machine-code-stored-in-char-array", "title": "How to call machine code stored in char array?", "body": "<p>I'm trying to call native machine-language code. Here's what I have so far (it gets a bus error):</p>\n\n<pre><code>char prog[] = {'\\xc3'}; // x86 ret instruction\n\nint main()\n{\n    typedef double (*dfunc)();\n\n    dfunc d = (dfunc)(&amp;prog[0]);\n    (*d)();\n    return 0;\n}\n</code></pre>\n\n<p>It does correctly call the function and it gets to the ret instruction.  But when it tries to execute the ret instruction, it has a SIGBUS error.  Is it because I'm executing code on a page that is not cleared for execution or something like that?</p>\n\n<p>So what am I doing wrong here? </p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1475650337, "post_id": 39867056, "comment_id": 67021784, "body": "Why wouldn&#39;t it be <code>8 + 8 + 16 + 16</code> ? You require <code>aligned(8)</code> on each member and <code>aligned(16)</code> on the final two members. Looks like 48, but note it is not guaranteed the same on all compilers or operating systems."}, {"owner": {"reputation": 7, "user_id": 1710979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43043cc4cad7e97dddd339a13507e211?s=128&d=identicon&r=PG", "display_name": "user1710979", "link": "https://stackoverflow.com/users/1710979/user1710979"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1475651753, "post_id": 39867056, "comment_id": 67022571, "body": "I think, I am not clear with __attribute__((aligned(8)) if it is applied to structure. what i understood that structure will start at multiple of 8 ie 0,8,16,24,32.... This alignment will not be applicable to member of structure. means if would be applicable  to each member of structure  , then the address of s1 should be 0x601068 rather than 0x601064. Please correct me if I am wrong. And compiler and os where i have run this program is gcc version 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3)"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1475684524, "post_id": 39867056, "comment_id": 67044902, "body": "First I don&#39;t think packed can be used with aligned. But that seems to work. Your confusion is caused the alignment of the struct as a whole. Say you have an array of <code>Ball_t</code>, then you will find all <code>s2</code> members and all <code>q</code> members are all aligned to 16 bytes. To achieve that, s2 members of neighboring elements must be at least 48 bytes apart. Finally, you will find in C standard that <code>sizeof</code> is defined as &quot;average storage used by a element in an array with padding included if any&quot;."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1475684685, "post_id": 39867056, "comment_id": 67045012, "body": "Simply, if <code>sizeof(Ball_t)==40</code>, then the even elements in an array would be perfectly aligned, but odd elements would not have their <code>s2</code> and <code>q</code> members aligned to a 16-byte boundary."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1475717656, "post_id": 39867056, "comment_id": 67058861, "body": "Checking with <code>offsetof</code> (in <code>stddef.h</code>) shows the offsets of the members to be <code>size : 0, s1 : 4, s2 : 16, q : 32</code> (which itself requires <code>16-byte</code> alignment resulting in <code>sizeof</code> returning <code>48</code>) Try it yourself by adding <code>printf (&quot;\\n size : %zu\\n s1   : %zu\\n s2   : %zu\\n q    : %zu\\n&quot;, offsetof (Ball_t, size), offsetof (Ball_t, s1), offsetof (Ball_t, s2), offsetof (Ball_t, q));</code> to your code. In other words <code>s1</code> requires <code>12-bytes</code> to make <code>s2</code> <code>16-byte</code> aligned."}, {"owner": {"reputation": 7, "user_id": 1710979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43043cc4cad7e97dddd339a13507e211?s=128&d=identicon&r=PG", "display_name": "user1710979", "link": "https://stackoverflow.com/users/1710979/user1710979"}, "edited": false, "score": 0, "creation_date": 1475761135, "post_id": 39867056, "comment_id": 67080700, "body": "I agree what u have explained. I agree , the starting address of q will be 32 if structure starting address is 0 but, why q requires 16 bytes, it is a double that takes 8 bytes,<b>attribute__((aligned(16)</b> , the starting address of q should be multiple of 8 ie 0,16,32,48.... . Let suppose I have taken the array of structure, like Ball_t a[3]; let suppose a base address is 0, a[0].size ,a[0].s1, a[0].s2, a[0].q will have offset 0,4,16,32. if i m considering the addr of structure is 40, then offset of  a[1].size ,a[1].s1, a[1].s2, a[1].q ll be 40,44,48,64,72. Then why 48 size is required?"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1475893419, "post_id": 39867056, "comment_id": 67139466, "body": "because in if that were the case, even elements and odd elements would have different layouts. 4+4+ (8)+4 +(12)+8 v.s. 4+4+4+(12)+8+(8)"}], "owner": {"reputation": 7, "user_id": 1710979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43043cc4cad7e97dddd339a13507e211?s=128&d=identicon&r=PG", "display_name": "user1710979", "link": "https://stackoverflow.com/users/1710979/user1710979"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476119293, "creation_date": 1475649739, "last_edit_date": 1476119293, "question_id": 39867056, "link": "https://stackoverflow.com/questions/39867056/attritbute-aligned8-on-structure-tag-as-well-as-structure-member", "title": "__attritbute__((aligned(8))) on structure tag as well as structure member", "body": "<p>I have tried below program:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\ntypedef struct __attribute__((packed,aligned(8))) Ball {\n\n    int  size;\n    int s1;\n    int s2 __attribute__((packed,aligned(16)));\n    double q __attribute__((packed,aligned(16)));\n} Ball_t;\n\nBall_t var;\nint main()\n{\n   printf(\"%lu\\n\",sizeof(Ball_t));\n   printf(\"%p %p %p %p\\n\",&amp;var.size,&amp;var.s1,&amp;var.s2,&amp;var.q);\n   return 0;\n}\n\nOutput-\n48\n0x601060 0x601064 0x601070 0x601080\n</code></pre>\n\n<p>I have expected the output like- sizeof structure should be 40 bytes.\nBut, I am getting 48 bytes. As per my understanding, alignment  should happen  like this-</p>\n\n<pre><code>(let suppose start address of structure is 0)\n\ntypedef struct __attribute__((packed,aligned(8))) Ball {\n    int  size;  // start at 0th and occupy 4 bytes\n    int s1;      //start at 4th and occupy 4 bytes  + padding of 8 bytes\n    int s2 __attribute__((packed,aligned(16)));  // starts at 16th byte and occupy 4 bytes +padding 12 bytes\n    double q __attribute__((packed,aligned(16))); //starts at 32nd and occupy 8 bytes \n} Ball_t;\n</code></pre>\n\n<p>So,total size will be 4+4+ 8+4 +12+8=40. Please clarify me if I am wrong in understanding. </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "edited": false, "score": 1, "creation_date": 1475650628, "post_id": 39867011, "comment_id": 67021937, "body": "I think it is precision - the multiply by 2^32 ensures all the bits of accuracy are moved into the top of the number, then the value is truncated to 32, leaving only 5 bits of information, from the lower end of the accuracy of the double.   Try multiplying by 0x10000 =&gt;  65536 instead of 0x100000000."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1475650729, "post_id": 39867011, "comment_id": 67021989, "body": "or use <code>int n32bit = rand() | (rand() &lt;&lt; 16)</code>"}, {"owner": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1475656222, "post_id": 39867011, "comment_id": 67025026, "body": "use uint32_t when you want a integer with 32 bit. not int, long or something like that, even it is 32 bit on your plattform. On other platform, int and long will have a different size."}, {"owner": {"reputation": 456, "user_id": 5529678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d52fceadf783b1021718b90c86b53403?s=128&d=identicon&r=PG&f=1", "display_name": "sendaran", "link": "https://stackoverflow.com/users/5529678/sendaran"}, "edited": false, "score": 0, "creation_date": 1475658843, "post_id": 39867011, "comment_id": 67026686, "body": "Don&#39;t create macros for types, that&#39;s what <code>typedef</code> is for. And don&#39;t create macros with reserved names. <code>ul</code> is a built-in suffix for for <code>unsigned long</code> integer literals, <code>ull</code> is the same for <code>unsigned long long</code>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1475652309, "post_id": 39867492, "comment_id": 67022886, "body": "What is &quot;bicimal&quot;?"}], "tags": [], "owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "is_accepted": true, "score": 1, "last_activity_date": 1475653743, "last_edit_date": 1475653743, "creation_date": 1475651239, "answer_id": 39867492, "question_id": 39867011, "link": "https://stackoverflow.com/questions/39867011/error-in-my-random-32-bit-generation/39867492#39867492", "title": "Error in my random 32 bit generation", "body": "<p>So drand48 uses 48 bits of randmonness.  This generates a number between 0 and 1 as follows in binary floating point.</p>\n\n<pre><code>0.000000000000000000000000000000000000000000000000\nand\n0.111111111111111111111111111111111111111111111111\n</code></pre>\n\n<p>(not quite 1, but with 48 '1's.)</p>\n\n<p>when multiplied by 4billion, that turns into</p>\n\n<pre><code>0000000000000000000000000000000000000000000000000000000000000000\nto\n1111111111111111111111111111111111111111111111110000000000000000\n</code></pre>\n\n<p>When truncated to 5 bits, that is </p>\n\n<pre><code>00000\n00000\n</code></pre>\n\n<p>Multiply by the range required... e.g. 32, rather than a large number.</p>\n"}], "owner": {"reputation": 21, "user_id": 5222972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bfa98b0e10548af22c9155370fe7b76?s=128&d=identicon&r=PG&f=1", "display_name": "str", "link": "https://stackoverflow.com/users/5222972/str"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 39867492, "answer_count": 1, "score": 1, "last_activity_date": 1475653743, "creation_date": 1475649544, "question_id": 39867011, "link": "https://stackoverflow.com/questions/39867011/error-in-my-random-32-bit-generation", "title": "Error in my random 32 bit generation", "body": "<p>I want to generate 32 bit random number using the following C code. For small 'LOOP', it works well. But for larger LOOP>1024*1024*4, all final value becomes 1/32. Can you kindly explain where is problem in the following code. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;math.h&gt;\n\n#define ul unsigned int\n#define ull unsigned long long \n\n\n\nul myrand32(){\n\n        ul temp=4294967296.0*drand48();\n\n        return temp;\n\n}\n\nint main(){\n\nul temp;\null i,j,s,Z, LOOP=1024*1024*1024;\ndouble A[32];\nsrand(time(NULL));\nsrand48(time(NULL));\n\nfor(i=0;i&lt;32;i++)\n   A[i]=0;\n\nfor(i=0;i&lt;LOOP;i++){\n                    temp=myrand32();      \n\n                    j=temp%32;\n                    A[j]+=1;\n\n\n               }\n\nfor(j=0;j&lt;32;j++)\n    printf(\"%lf   %llu   %lf\\n\", A[j]/i,j,1.0/32);\n\n}\n</code></pre>\n"}, {"tags": ["c", "double", "byte", "bitmask"], "comments": [{"owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "edited": false, "score": 0, "creation_date": 1475649619, "post_id": 39866974, "comment_id": 67021411, "body": "Are you going to use <code>double</code> to store bit-masks? Really?"}, {"owner": {"reputation": 241, "user_id": 2350459, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9eaf3d41493d3ecf72af1d9aba52fb18?s=128&d=identicon&r=PG", "display_name": "user2350459", "link": "https://stackoverflow.com/users/2350459/user2350459"}, "reply_to_user": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "edited": false, "score": 0, "creation_date": 1475649705, "post_id": 39866974, "comment_id": 67021456, "body": "Yeah, so I know this doesn&#39;t seem right, but I don&#39;t know what I&#39;m supposed to do. What would you do?"}, {"owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "edited": false, "score": 0, "creation_date": 1475649902, "post_id": 39866974, "comment_id": 67021545, "body": "What about <code>uint64_t</code> from <code>stdint.h</code>?"}, {"owner": {"reputation": 241, "user_id": 2350459, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9eaf3d41493d3ecf72af1d9aba52fb18?s=128&d=identicon&r=PG", "display_name": "user2350459", "link": "https://stackoverflow.com/users/2350459/user2350459"}, "reply_to_user": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "edited": false, "score": 0, "creation_date": 1475649987, "post_id": 39866974, "comment_id": 67021596, "body": "why is that better than using a double?"}, {"owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "edited": false, "score": 0, "creation_date": 1475650142, "post_id": 39866974, "comment_id": 67021681, "body": "Double is for floating point values, bit-masks are normally integer (and usually unsigned)"}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 2350459, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9eaf3d41493d3ecf72af1d9aba52fb18?s=128&d=identicon&r=PG", "display_name": "user2350459", "link": "https://stackoverflow.com/users/2350459/user2350459"}, "edited": false, "score": 0, "creation_date": 1475650444, "post_id": 39867203, "comment_id": 67021842, "body": "you would use hexadecimal even when the positions got more complicated?"}, {"owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "reply_to_user": {"reputation": 241, "user_id": 2350459, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9eaf3d41493d3ecf72af1d9aba52fb18?s=128&d=identicon&r=PG", "display_name": "user2350459", "link": "https://stackoverflow.com/users/2350459/user2350459"}, "edited": false, "score": 0, "creation_date": 1475650665, "post_id": 39867203, "comment_id": 67021953, "body": "two hexadecimal number is one byte, so for chess I expect masks like <code>AA55AA55AA55AA55</code>, where <code>AA</code> = <code>10101010</code> and <code>55</code> = <code>01010101</code>. But, of course, it is a matter of taste and habits - use binary"}], "tags": [], "owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "is_accepted": true, "score": 1, "last_activity_date": 1475650307, "creation_date": 1475650307, "answer_id": 39867203, "question_id": 39866974, "link": "https://stackoverflow.com/questions/39866974/how-do-i-wrap-large-lines-of-bits-so-its-not-one-big-line/39867203#39867203", "title": "How do I wrap large lines of bits so it&#39;s not one big line?", "body": "<p>That looks not very fine, but consider the following:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint main(void)\n{\n    uint64_t blackpawns = 0b\\\n11111111\\\n11111111\\\n11111111\\\n11111111\\\n11111111\\\n11111111\\\n11111111\\ \n11111111;\n        // your code\n        return 0;\n}\n</code></pre>\n\n<p>My personal opinion is: it is better to use hexadecimal notation in that case, like:</p>\n\n<pre><code>     uint64_t blackpawns = 0xFFFFFFFFFFFFFFFF;\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 2350459, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9eaf3d41493d3ecf72af1d9aba52fb18?s=128&d=identicon&r=PG", "display_name": "user2350459", "link": "https://stackoverflow.com/users/2350459/user2350459"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 39867203, "answer_count": 1, "score": 0, "last_activity_date": 1475650307, "creation_date": 1475649426, "question_id": 39866974, "link": "https://stackoverflow.com/questions/39866974/how-do-i-wrap-large-lines-of-bits-so-its-not-one-big-line", "title": "How do I wrap large lines of bits so it&#39;s not one big line?", "body": "<p>i'm going to try to make a chess ai, and need long lines of bits(I think, unless someone else has a better method) to represent the pieces positions on the 8x8 board.\nIt looks like this-</p>\n\n<pre><code>double blackpawns=0b1111111111111111111111111111111111111111111111111111111111111111;\n</code></pre>\n\n<p>but I would like to make it look like-</p>\n\n<pre><code>double blackpawns=0b11111111\n                    11111111\n                    11111111\n                    11111111\n                    11111111\n                    11111111\n                    11111111\n                    11111111;\n</code></pre>\n\n<p>just so it looks neater. The problem is that if I put any spaces between the 1's, then the 0b only applies to that chunk of ones, and the rest isn't counted, and an error is thrown. Thanks!</p>\n\n<p>btw, I'm not going to have a board full of pawns, I was using that for demonstration.</p>\n"}, {"tags": ["objective-c", "c", "struct", "malloc"], "answers": [{"comments": [{"owner": {"reputation": 50374, "user_id": 568283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120ceee2dc40d539b9983265a2e0a2f8?s=128&d=identicon&r=PG", "display_name": "CRD", "link": "https://stackoverflow.com/users/568283/crd"}, "edited": false, "score": 0, "creation_date": 1475654235, "post_id": 39867220, "comment_id": 67023980, "body": "&quot;newer languages like C++ and Swift&quot; - on hearing that C++ threw away her walking stick and went skipping off down the street! She&#39;ll pay for it tomorrow though, with aching templates and memory faults everywhere :-) [Sorry, your turn of phrase just made me smile, normal service will now resume.]"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1475692191, "post_id": 39867220, "comment_id": 67049256, "body": "Thanks for #2 - That idiom deserve more use amongst learners."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 4, "last_activity_date": 1475650364, "creation_date": 1475650364, "answer_id": 39867220, "question_id": 39866908, "link": "https://stackoverflow.com/questions/39866908/why-does-the-c-compiler-not-warn-about-malloc-size-errors/39867220#39867220", "title": "Why does the C compiler not warn about malloc size errors?", "body": "<p>\"How can I find this error faster?\"</p>\n\n<p>There are a bunch of ways to find the error faster.</p>\n\n<h2>Solution #1</h2>\n\n<p>The static analyzer cathes this error.  Press command-shift-B in Xcode.  For example, take the following code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nstruct x { double x; };\nstruct y { char y; };\n\nint main(int argc, char **argv) {\n    struct x *p = malloc(sizeof(struct y));\n    p-&gt;x = 1.0;\n    return 0;\n}\n</code></pre>\n\n<p>Running the analyzer produces this error for me:</p>\n\n<blockquote>\n  <p>Result of 'malloc' is converted to a pointer of type 'struct x' which is incompatible with sizeof operand type 'struct y'</p>\n</blockquote>\n\n<h2>Solution #2</h2>\n\n<p>It is recommended to write the code this way instead:</p>\n\n<pre><code>self.myData = malloc(sizeof(*self.myData));\n</code></pre>\n\n<p>Just do it this way in the future.  This is not only less error-prone, but it is easier to remember.</p>\n\n<h2>Solution #3</h2>\n\n<p>Use a language like Swift or C++ where the language's type system help you avoid this kind of error.  C is less forgiving in many ways.  It was invented in the early 1970s, you just kind of have to accept that if you want to use it, and these kinds of errors are a <em>major</em> part of the reason why C++ and Swift even exist in the first place.</p>\n\n<h2>Solution #4</h2>\n\n<p>Use a run-time memory bounds checker, like the address sanitizer.  This will detect the error when memory is accessed, not when it is allocated, but it will still give you stack traces for both access and allocation (and free, if the memory has been freed).  Anyone writing C these days should familiarize themselves with the address sanitizer and its friends, tsan, ubsan, etc.</p>\n\n<p>Valgrind also achieves the same effect but the address sanitizer has a better user experience for common use cases.</p>\n\n<h1>Question as asked</h1>\n\n<p>The compiler only really gives you errors and warnings for type errors. This isn't a type error, it's a runtime error.  There are a few \"likely\" runtime errors that the compiler can detect, but they are very few in number.  Things like forgetting to use the return value of <code>malloc()</code>... e.g.,</p>\n\n<pre><code>void f(void) {\n    malloc(1); // warning\n}\n</code></pre>\n\n<p>The compiler isn't much better than that.</p>\n\n<p>Again, this is the impetus for newer languages like C++ and Swift, which have type systems which allow you to generate errors when you allocate things incorrectly, and this is also the impetus for static analysis (which is a tough problem).</p>\n"}, {"tags": [], "owner": {"reputation": 809, "user_id": 6861041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tw2mJ.jpg?s=128&g=1", "display_name": "Lucas Batista Gabriel", "link": "https://stackoverflow.com/users/6861041/lucas-batista-gabriel"}, "is_accepted": false, "score": 0, "last_activity_date": 1475651536, "creation_date": 1475651536, "answer_id": 39867577, "question_id": 39866908, "link": "https://stackoverflow.com/questions/39866908/why-does-the-c-compiler-not-warn-about-malloc-size-errors/39867577#39867577", "title": "Why does the C compiler not warn about malloc size errors?", "body": "<p>That happens because is not ARC responsability to deal with <code>malloc()</code> and even <code>free()</code></p>\n\n<p>The ARC just handle with objects allocated like <code>[Object alloc]</code></p>\n\n<p>In your case, when you do <code>self.myData = malloc(sizeof(MyOtherStruct));</code>, that can be interpreted for example with something like this: </p>\n\n<pre><code>self.myData = malloc(N*sizeof(MyData));\n//what can represents self.myData[0]..self.myData[N-1]\n</code></pre>\n\n<p>For the last, remember when you use <code>sizeof()</code>, it will tell you about the size of the type, that you are passing as a paramter, calculated in compile-time.</p>\n\n<p>You can check this <a href=\"http://www.cocoawithlove.com/2010/08/alternative-objective-c-object.html\" rel=\"nofollow\">link</a> for more information about object allocation</p>\n\n<p>And also check Apple Documentation about <a href=\"https://developer.apple.com/library/content/documentation/Performance/Conceptual/ManagingMemory/Articles/MemoryAlloc.html\" rel=\"nofollow\">Memory Alloc</a></p>\n"}], "owner": {"reputation": 13, "user_id": 6895282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd60ac8a354820e33e474455a6f8cd1e?s=128&d=identicon&r=PG&f=1", "display_name": "jtdeez", "link": "https://stackoverflow.com/users/6895282/jtdeez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 39867220, "answer_count": 2, "score": 1, "last_activity_date": 1475651536, "creation_date": 1475649158, "question_id": 39866908, "link": "https://stackoverflow.com/questions/39866908/why-does-the-c-compiler-not-warn-about-malloc-size-errors", "title": "Why does the C compiler not warn about malloc size errors?", "body": "<p>I made a member struct that I assigned in the ViewDidLoad of my iOS app. I used malloc to allocate space for this struct that was then used throughout my class. Like this:</p>\n\n<pre><code>self.myData = malloc(sizeof(MyData));\n</code></pre>\n\n<p>Except what I really did was this:</p>\n\n<pre><code>self.myData = malloc(sizeof(MyOtherStruct));\n</code></pre>\n\n<p>I accidentally set sizeof() in the malloc call to be a different struct (that isn't the same size). I didn't notice this mistake for a very long time because the app only rarely crashed. An update to the OS caused the crash to happen more frequently.</p>\n\n<p>My question is, why can compiler's not warn about this sort of thing? Is it something compiler's don't know about or is it a design choice to allow users's to malloc whatever size they please?</p>\n"}, {"tags": ["c++", "c", "arduino"], "comments": [{"owner": {"reputation": 440, "user_id": 3425079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cZIhI.jpg?s=128&g=1", "display_name": "Hussain Patel", "link": "https://stackoverflow.com/users/3425079/hussain-patel"}, "edited": false, "score": 0, "creation_date": 1475648798, "post_id": 39866771, "comment_id": 67021035, "body": "May be you need to post this question in the correct stack exchange for Arduino. <a href=\"http://api.jquery.com/category/selectors/attribute-selectors/\" rel=\"nofollow noreferrer\">api.jquery.com/category/selectors/attribute-selectors</a>"}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1475648800, "post_id": 39866771, "comment_id": 67021036, "body": "Why aren&#39;t you allowed to use the arduino library?"}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "reply_to_user": {"reputation": 440, "user_id": 3425079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cZIhI.jpg?s=128&g=1", "display_name": "Hussain Patel", "link": "https://stackoverflow.com/users/3425079/hussain-patel"}, "edited": false, "score": 0, "creation_date": 1475648841, "post_id": 39866771, "comment_id": 67021053, "body": "@HussainPatel you posted a link to the jQuery api lol"}, {"owner": {"reputation": 851, "user_id": 3942863, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f7e75d95679a8a67e681e8c332f698a1?s=128&d=identicon&r=PG&f=1", "display_name": "kingcobra1986", "link": "https://stackoverflow.com/users/3942863/kingcobra1986"}, "edited": false, "score": 0, "creation_date": 1475649273, "post_id": 39866771, "comment_id": 67021240, "body": "Because the professor said that we cannot use the Library. If it were a real project and not for school, I would use the library."}, {"owner": {"reputation": 440, "user_id": 3425079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cZIhI.jpg?s=128&g=1", "display_name": "Hussain Patel", "link": "https://stackoverflow.com/users/3425079/hussain-patel"}, "edited": false, "score": 0, "creation_date": 1475649853, "post_id": 39866771, "comment_id": 67021528, "body": "i am sorry.. wrong windows.. here&#39;s the correct linkhttp://arduino.stackexchange.com/ please post your questions related to Arduino here"}], "answers": [{"comments": [{"owner": {"reputation": 851, "user_id": 3942863, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f7e75d95679a8a67e681e8c332f698a1?s=128&d=identicon&r=PG&f=1", "display_name": "kingcobra1986", "link": "https://stackoverflow.com/users/3942863/kingcobra1986"}, "edited": false, "score": 0, "creation_date": 1475649904, "post_id": 39867073, "comment_id": 67021549, "body": "So, not using the library at all I would still write a function that accesses PIND correct?"}, {"owner": {"reputation": 286, "user_id": 6734762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WB51t.png?s=128&g=1", "display_name": "Foitn", "link": "https://stackoverflow.com/users/6734762/foitn"}, "edited": false, "score": 1, "creation_date": 1475650014, "post_id": 39867073, "comment_id": 67021614, "body": "Yes, since you are programming on an arduino, you are actually programming on an ATMega328P, so you&#39;d have to write your code as such. The arduino library helps you to not having to worry about this."}, {"owner": {"reputation": 3864, "user_id": 620908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2abd643ecb33f1a18a7a4f976cef0dbe?s=128&d=identicon&r=PG", "display_name": "Adrian Colomitchi", "link": "https://stackoverflow.com/users/620908/adrian-colomitchi"}, "reply_to_user": {"reputation": 286, "user_id": 6734762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WB51t.png?s=128&g=1", "display_name": "Foitn", "link": "https://stackoverflow.com/users/6734762/foitn"}, "edited": false, "score": 0, "creation_date": 1475650292, "post_id": 39867073, "comment_id": 67021754, "body": "@Foitn Or an ATMega168 - like in Arduino Pro mini boards."}, {"owner": {"reputation": 851, "user_id": 3942863, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f7e75d95679a8a67e681e8c332f698a1?s=128&d=identicon&r=PG&f=1", "display_name": "kingcobra1986", "link": "https://stackoverflow.com/users/3942863/kingcobra1986"}, "edited": false, "score": 0, "creation_date": 1475650296, "post_id": 39867073, "comment_id": 67021756, "body": "I would normally use a library. I don&#39;t believe in re-inventing the wheel. Thanks for your answer."}, {"owner": {"reputation": 286, "user_id": 6734762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WB51t.png?s=128&g=1", "display_name": "Foitn", "link": "https://stackoverflow.com/users/6734762/foitn"}, "reply_to_user": {"reputation": 3864, "user_id": 620908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2abd643ecb33f1a18a7a4f976cef0dbe?s=128&d=identicon&r=PG", "display_name": "Adrian Colomitchi", "link": "https://stackoverflow.com/users/620908/adrian-colomitchi"}, "edited": false, "score": 0, "creation_date": 1475650370, "post_id": 39867073, "comment_id": 67021802, "body": "@AdrianColomitchi True that"}, {"owner": {"reputation": 36, "user_id": 6742327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQoef.jpg?s=128&g=1", "display_name": "Sanu - Open Maker", "link": "https://stackoverflow.com/users/6742327/sanu-open-maker"}, "edited": false, "score": 0, "creation_date": 1475656101, "post_id": 39867073, "comment_id": 67024967, "body": "Yea. This is the general way of programing AVR chips. DDRD and PIND are registers, not macros or functions, which are the very fundamentals. Good luck"}], "tags": [], "owner": {"reputation": 36, "user_id": 6742327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQoef.jpg?s=128&g=1", "display_name": "Sanu - Open Maker", "link": "https://stackoverflow.com/users/6742327/sanu-open-maker"}, "is_accepted": true, "score": 1, "last_activity_date": 1475649780, "creation_date": 1475649780, "answer_id": 39867073, "question_id": 39866771, "link": "https://stackoverflow.com/questions/39866771/get-pin-input-without-the-arduino-library/39867073#39867073", "title": "Get pin input without the Arduino Library", "body": "<p>There is no need to go to these implementations. It pretty simple as follows.</p>\n\n<p>LED13 will turn on when Pin 0 is high. I tested this code on arduino </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>#include &lt;avr/io.h&gt;                                      // Includes all the definition of register port etc  \r\n#ifndef F_CPU\r\n\r\n#define F_CPU 16000000UL      //Need to include it before &lt;util/delay.h&gt;\r\n\r\n#endif                                       //Change 16000000 with your crystal freq. In my case its 16 MHz\r\n\r\n#include &lt;util/delay.h&gt;    //includes delay functions delay_ms and delay_us\r\n\r\nvoid setup() {\r\n  // put your setup code here, to run once:\r\n  DDRB |= 0xFF; //Configured Port B as OP\r\n  DDRD &amp;= 0x00; //Configured Port D as IP\r\n}\r\n\r\nvoid loop() {\r\n  // put your main code here, to run repeatedly:\r\n  \r\n  if (PIND&amp;(0x01)) //to check pin0 of portD (which is Pin 0 of arduino)\r\n    PORTB |= 0xFF;\r\n  else\r\n    PORTB &amp;= 0x00;\r\n\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 486, "user_id": 2677670, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9e4be09701a10c2335f590abd4116d9d?s=128&d=identicon&r=PG&f=1", "display_name": "mactro", "link": "https://stackoverflow.com/users/2677670/mactro"}, "is_accepted": false, "score": 0, "last_activity_date": 1475651051, "last_edit_date": 1495541708, "creation_date": 1475651051, "answer_id": 39867429, "question_id": 39866771, "link": "https://stackoverflow.com/questions/39866771/get-pin-input-without-the-arduino-library/39867429#39867429", "title": "Get pin input without the Arduino Library", "body": "<p>I will assume that you use Arduino Uno, however, general rule applies to any Arduino. </p>\n\n<p>First, you need to check Arduino pin mapping:<a href=\"https://i.stack.imgur.com/IAQvk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IAQvk.png\" alt=\"\"></a> </p>\n\n<p>Then, let's assume you want to use digital pin 2, so PD2 on Atmega168/328. (PD2 is short for PORTD pin 2). To use it as an input you need to do:</p>\n\n<pre><code>DDRD &amp;= ~(1 &lt;&lt; PD2); \n</code></pre>\n\n<p><code>DDRD</code> is data direction register for port D. Whole operation sets bit corresponding to pin 2 to 0. \nThen to read this pin:</p>\n\n<pre><code>if (PIND &amp; (1&lt;&lt;PD2)) {\n  // do something\n}\n</code></pre>\n\n<p>Also, please check, how to manipulate single bits: <a href=\"https://stackoverflow.com/q/47981/2677670\">How do you set, clear, and toggle a single bit?</a></p>\n"}], "owner": {"reputation": 851, "user_id": 3942863, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f7e75d95679a8a67e681e8c332f698a1?s=128&d=identicon&r=PG&f=1", "display_name": "kingcobra1986", "link": "https://stackoverflow.com/users/3942863/kingcobra1986"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 39867073, "answer_count": 2, "score": 1, "last_activity_date": 1475651051, "creation_date": 1475648645, "question_id": 39866771, "link": "https://stackoverflow.com/questions/39866771/get-pin-input-without-the-arduino-library", "title": "Get pin input without the Arduino Library", "body": "<p>I am not allowed to use the Arduino Library (or any Library) for this program. How would I check the input of a pin? </p>\n\n<p>I found two different functions: </p>\n\n<p>In Arduino.h:</p>\n\n<pre><code>#define bitRead(value, bit) (((value) &gt;&gt; (bit)) &amp; 0x01)\n</code></pre>\n\n<p>Following digitalRead back to pgmspace.h:</p>\n\n<pre><code>#define __LPM_enhanced__(addr)  \\\n(__extension__({                \\\n    uint16_t __addr16 = (uint16_t)(addr); \\\n    uint8_t __result;           \\\n    __asm__ __volatile__        \\\n    (                           \\\n        \"lpm %0, Z\" \"\\n\\t\"      \\\n        : \"=r\" (__result)       \\\n        : \"z\" (__addr16)        \\\n    );                          \\\n    __result;                   \\\n}))\n</code></pre>\n\n<p>For the first one, I don't know where bit and value come from and I just don't understand the second one at all. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 4, "creation_date": 1475648836, "post_id": 39866737, "comment_id": 67021052, "body": "I doubt this question can be answered for any language, because it&#39;s too broad. Also, you&#39;d do well to remove these typedefs and rewrite the API to use <code>&lt;stdint.h&gt;</code> types instead. It&#39;ll probably be a simple find and replace operation."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 2, "creation_date": 1475649622, "post_id": 39866737, "comment_id": 67021415, "body": "Redeclaration should not cause any problems. Are you sure both declarations are the same? Or one is using <code>#define</code> and the other is using <code>typedef</code>?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1475649802, "post_id": 39866737, "comment_id": 67021498, "body": "Could you show <i>both</i> typedef declarations and the actual error you receive?"}, {"owner": {"reputation": 93, "user_id": 3629375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a32a2791ae854cf9d440a139d6b33c?s=128&d=identicon&r=PG&f=1", "display_name": "Radon", "link": "https://stackoverflow.com/users/3629375/radon"}, "edited": false, "score": 1, "creation_date": 1475664597, "post_id": 39866737, "comment_id": 67030468, "body": "Removing typedefs and including stdint.h would jus generate errors, because stdint uses *_t postfixes. You can make a single types header with include guards and include that header to files there was old typedefs you removed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "reply_to_user": {"reputation": 93, "user_id": 3629375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a32a2791ae854cf9d440a139d6b33c?s=128&d=identicon&r=PG&f=1", "display_name": "Radon", "link": "https://stackoverflow.com/users/3629375/radon"}, "edited": false, "score": 0, "creation_date": 1475702837, "post_id": 39866737, "comment_id": 67054836, "body": "@Radon Bad excuse. Like I wrote: it&#39;s a simple find and replace operation to fix it."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1491738785, "post_id": 39866737, "comment_id": 73677460, "body": "Which code do you not want to change? The code doing these typedefs (and using them for implementation)? Or the code including these headers? You only get problems when including the two different typedefs (i.e. their headers) into the same code file."}], "owner": {"reputation": 11, "user_id": 5303342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3576f54015119f4c8845f4f40a169a9?s=128&d=identicon&r=PG&f=1", "display_name": "wong_stackoverflow", "link": "https://stackoverflow.com/users/5303342/wong-stackoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 824, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1585101480, "creation_date": 1475648521, "question_id": 39866737, "link": "https://stackoverflow.com/questions/39866737/invalid-redeclaration-of-type-name-uint8-in-c", "title": "Invalid redeclaration of type name &quot;uint8&quot; in C", "body": "<p>I'm merging 2 C API source codes into an application code.\nI have encountered the issue that conflicting in data type in two API source codes .</p>\n\n<p>both have standard generic typedef like the following...</p>\n\n<pre><code>typedef signed char int8;\ntypedef unsigned char uint8;\ntypedef signed short sint16;\ntypedef unsigned short uint16;\n...\n...\n</code></pre>\n\n<p>Is that any way to wrap around the API source code and don't want to change anything in API source code for solve the error encountered??</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++", "c", "arduino"], "answers": [{"tags": [], "owner": {"reputation": 486, "user_id": 2677670, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9e4be09701a10c2335f590abd4116d9d?s=128&d=identicon&r=PG&f=1", "display_name": "mactro", "link": "https://stackoverflow.com/users/2677670/mactro"}, "is_accepted": false, "score": 0, "last_activity_date": 1475667633, "creation_date": 1475667633, "answer_id": 39873005, "question_id": 39866623, "link": "https://stackoverflow.com/questions/39866623/defficult-time-to-assign-the-servos-in-coding/39873005#39873005", "title": "defficult time to assign the servos in coding", "body": "<p>I have no idea what you try to achieve here:</p>\n\n<pre><code>#define SERVO1 2 ); Servo attach ;2\n#define SERVO2 3 ); Servo attach ;-3\n#define SERVO3 4 ); Servo attach ;4\n#define SERVO4 5 ); Servo attach ; -5\n#define PIEZO 6 ); attach ; -6\n#define BUTTON 9 ); attach 9\n</code></pre>\n\n<p>but what you get is, in every place where <code>SERVO1</code> appears in the code, it is substituted with <code>2 ); Servo attach ;2</code> string. So <code>servo1.attach(SERVO1);</code> becomes <code>servo1.attach(2 ); Servo attach ;2);</code> which is nonsense. Just make the defines like <code>#define SERVO1 2</code> and you should be fine.</p>\n"}], "owner": {"reputation": 1, "user_id": 6924543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/600eab301fb0e793e1b5235a25254c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Cyndastar", "link": "https://stackoverflow.com/users/6924543/cyndastar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1475826593, "creation_date": 1475648021, "last_edit_date": 1475826593, "question_id": 39866623, "link": "https://stackoverflow.com/questions/39866623/defficult-time-to-assign-the-servos-in-coding", "title": "defficult time to assign the servos in coding", "body": "<p>So I more or lees just got the arudino in a few days ago for a specefic project with four servos clicking down eight buttons on my 3ds. Completely new to coding, I need help with assigning my servos and a photocell in the coding I have been given. Every time I try to give the pin numbers of where the servos are, I get an error somewhere else. I've tried to get this working for days now so any suggestion would be lovely!</p>\n\n<pre><code>#include &lt;Servo.h&gt;\n\n// Define the slots (says digital ~PWM) on the Arduino where various parts of the machine will go\n/* Diyode CodeShield Constants */\n#define SERVO1 2 ); Servo attach ;2\n#define SERVO2 3 ); Servo attach ;-3\n#define SERVO3 4 ); Servo attach ;4\n#define SERVO4 5 ); Servo attach ; -5\n#define PIEZO 6 ); attach ; -6\n#define BUTTON 9 ); attach 9\n\n// Define a couple constants of length of time in milliseconds\n#define CHECK_SCREEN_DELAY 150\n#define WALKING_BUTTONPRESS_DURATION 3300\n\n// Define a couple cases, don't mess with these\n#define STARTING 1\n#define WALKING 2\n#define WATCHING 3\n#define FOUND 4\n\n//servo1 presses left and up\nServo servo1;\n//servo2 presses right and down\n;Servo servo2;\n//servo3 presses b and y\nServo servo3;\n//servo4 presses a and x\nServo servo4;\n\n// Defines the starting positions of the servos. \n// These will need to be adjusted during setup.\nint servo1Flat = 108;\nint servo1Deflect = 18;\nint servo2Flat = 95;\nint servo2Deflect = 20;\nint servo3Flat = 83;\nint servo3Deflect = 15;\nint servo4Flat = 65;\nint servo4Deflect = 15;\nString name = \"A\";\n\n//Define the photoreceptor.\nint photocellPin = 1;     // the cell and 10K pulldown are connected to a1\nint photocellReading;     // the analog reading from the sensor divider\n\n//Define counts so the program knows when to collect, hatch, or deposit eggs.\nunsigned int mode = 1;\nunsigned int egg_count = 0;\nunsigned int clutch_count = 0;\nunsigned int box_count = 0;\nunsigned int bike_count = 0;\n\n//This is the level of light that the program uses to make decisions on whether to collect\n//an egg or to hatch one.\nunsigned char dark_threshold = 400;\n\n//Setting up and writing in th servos. Don't mess with these.\nvoid setup() {\n  Serial.begin (115200);\n  Serial.print(\"Start Unit \");\n  Serial.println(name);\n\n  servo1.attach(SERVO1);\n  servo1.write(servo1Flat);\n\n  servo2.attach(SERVO2);\n  servo2.write(servo2Flat);\n\n  servo3.attach(SERVO3);\n  servo3.write(servo3Flat);\n\n  servo4.attach(SERVO4);\n  servo4.write(servo4Flat);\n}\nvoid loop() {\n\n  switch (mode) {\n    case STARTING:\n      watchButton();\n      break;\n    case WALKING:\n      doWalking();\n      break;\n    case WATCHING:\n      break;\n    case FOUND:\n      watchButton();\n      break;\n  }\n}\nvoid watchButton() {\n  if (digitalRead(BUTTON) == HIGH) {\n   mode = WALKING;\n  }  \n}    \n\nint is_between(long val, long lower, long upper)\n{\n    return (val &gt; lower &amp;&amp; val &lt; upper);\n}\n\n//Define the actions to take when you've hatched all your eggs, \n//i.e. go to the PC, deposit the eggs, come back outside and ask for\n//another egg.\nvoid tapScreen() {\n// Go east and get off bike\n  if(clutch_count &lt; 6)\n  {\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(4000);\n  servo2.write(servo2Flat);\n  delay(100);\n  servo3.write(servo3Flat - 5*servo3Deflect);\n  delay(500);\n  servo3.write(servo3Flat);\n  delay(600);\n//Walk into daycare center and over to pc\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(300);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(200);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(200);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(200);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(200);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo1.write(servo1Flat - 2*servo1Deflect);\n  delay(3500);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(300);\n  servo2.write(servo2Flat);\n  delay(600);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(200);\n  servo2.write(servo2Flat);\n  delay(600);\n  servo1.write(servo1Flat - 2*servo1Deflect);\n  delay(200);\n  servo1.write(servo1Flat);\n  delay(600);\n//Open PC, navigate to eggs  \n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(2200);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo2.write(servo2Flat - 4*servo2Deflect);\n  delay(300);\n  servo2.write(servo2Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(2300);\n//Deposit 5 eggs  \n  servo2.write(servo2Flat + servo2Deflect);\n  delay(300);\n  servo2.write(servo2Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(200);\n  servo2.write(servo2Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(200);\n  servo2.write(servo2Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(200);\n  servo2.write(servo2Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(200);\n  servo2.write(servo2Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n//Exit out of PC and walk back outside, get on bike, ask for egg\n  servo4.write(servo4Flat + 4*servo4Deflect);\n  delay(400);\n  servo4.write(servo4Flat);\n  delay(2500);\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(300);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(250);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo2.write(servo2Flat - 4*servo2Deflect);\n  delay(3000);\n  servo2.write(servo2Flat);\n  delay(1200);\n  servo2.write(servo2Flat - 4*servo2Deflect);\n  delay(300);\n  servo2.write(servo2Flat);\n  delay(300);\n  servo3.write(servo3Flat - 5*servo3Deflect);\n  delay(500);\n  servo3.write(servo3Flat);\n  delay(600);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(500);\n  servo2.write(servo2Flat);\n  delay(400);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(400);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(400);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(400);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(400);\n  clutch_count++;\n  }\n//When the box is full, the program follows these commands, which are\n//identical to the above except it changes the box and resets the clutch count.  \n  else\n  {\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(4000);\n  servo2.write(servo2Flat);\n  delay(100);\n  servo3.write(servo3Flat - 5*servo3Deflect);\n  delay(500);\n  servo3.write(servo3Flat);\n  delay(600);\n//Walk into daycare center and over to pc\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(300);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(200);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(200);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(200);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(200);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo1.write(servo1Flat - 2*servo1Deflect);\n  delay(3500);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(300);\n  servo2.write(servo2Flat);\n  delay(600);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(200);\n  servo2.write(servo2Flat);\n  delay(600);\n  servo1.write(servo1Flat - 2*servo1Deflect);\n  delay(300);\n  servo1.write(servo1Flat);\n  delay(600);\n//Open PC, navigate to eggs  \n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(2200);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo2.write(servo2Flat - 4*servo2Deflect);\n  delay(300);\n  servo2.write(servo2Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(2300);\n//Change box, deposit 5 eggs  \n  servo2.write(servo2Flat + servo2Deflect);\n  delay(300);\n  servo2.write(servo2Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(900);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(300);\n  servo2.write(servo2Flat);\n  delay(700);  \n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(200);\n  servo2.write(servo2Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(200);\n  servo2.write(servo2Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(200);\n  servo2.write(servo2Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(200);\n  servo2.write(servo2Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(700);\n//Exit out of PC and walk back outside, get on bike, ask for egg  \n  servo4.write(servo4Flat + 4*servo4Deflect);\n  delay(250);\n  servo4.write(servo4Flat);\n  delay(2500);\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(300);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo1.write(servo1Flat + servo1Deflect);\n  delay(250);\n  servo1.write(servo1Flat);\n  delay(600);\n  servo2.write(servo2Flat - 4*servo2Deflect);\n  delay(3000);\n  servo2.write(servo2Flat);\n  delay(1200);\n  servo2.write(servo2Flat - 4*servo2Deflect);\n  delay(300);\n  servo2.write(servo2Flat);\n  delay(300);\n  servo3.write(servo3Flat - 5*servo3Deflect);\n  delay(500);\n  servo3.write(servo3Flat);\n  delay(600);\n  servo2.write(servo2Flat + servo2Deflect);\n  delay(500);\n  servo2.write(servo2Flat);\n  delay(400);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(400);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(400);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(400);\n  servo4.write(servo4Flat - servo4Deflect);\n  delay(200);\n  servo4.write(servo4Flat);\n  delay(400);\n  clutch_count = 1;\n  box_count++;\n  Serial.print(\"***BOXES FILLED***: \");\n  Serial.println(box_count);\n  }\n  Serial.print(\"Clutches: \");\n  Serial.println(clutch_count);\n  bike_count = 0;\n}\n\n//Define the beep that will occur if the program messes up, which\n//happens when the program rides back and forth on the bike 50 times without\n//the screen darkening. The screen should always darken before riding back and\n//forth 50 times due to an egg being accepted from the breeder or hatched.\nvoid beep() {\n analogWrite( PIEZO, 35);\n delay(400);\n digitalWrite(PIEZO, LOW);\n}    \n\nvoid doWalking()\n{\n    while(1)\n    {\n        photocellReading = analogRead(photocellPin);\n        //As I mentioned above the beep definition, when the program messes up, \n        //i.e. your character ends up in a place they shouldn't be and cannot \n        //collecting eggs, the program follows these commands. It will press \"b\" a bunch\n        //of times, then walk around a bit in case you are in the breeder's house,\n        //and then will use Talonflame to fly to in front of the Pokemon center. Then\n        //you will deposit any eggs/pokemon you might have (besides Talonflame), you will\n        // switch to a new box, and start over.\n        if(bike_count &gt;= 50)\n        {\n          beep();\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(600);\n          servo1.write(servo1Flat + servo1Deflect);\n          delay(250);\n          servo1.write(servo1Flat);\n          delay(600);\n          servo1.write(servo1Flat + servo1Deflect);\n          delay(250);\n          servo1.write(servo1Flat);\n          delay(600);\n          servo2.write(servo2Flat - 4*servo2Deflect);\n          delay(4000);\n          servo2.write(servo2Flat);\n          delay(200);\n          servo4.write(servo4Flat + 4*servo4Deflect);\n          delay(250);\n          servo4.write(servo4Flat);\n          delay(2500);\n          servo1.write(servo1Flat + servo1Deflect);\n          delay(250);\n          servo1.write(servo1Flat);\n          delay(600);\n          servo1.write(servo1Flat + servo1Deflect);\n          delay(250);\n          servo1.write(servo1Flat);\n          delay(600);\n          servo2.write(servo2Flat - 4*servo2Deflect);\n          delay(4000);\n          servo2.write(servo2Flat);\n          delay(200);\n          servo4.write(servo4Flat + 4*servo4Deflect);\n          delay(250);\n          servo4.write(servo4Flat);\n          delay(2500);                                            \n          servo4.write(servo4Flat - servo4Deflect);\n          delay(250);\n          servo4.write(servo4Flat);\n          delay(2000);\n          servo4.write(servo4Flat + 4*servo4Deflect);\n          delay(250);\n          servo4.write(servo4Flat);\n          delay(5000);\n          servo4.write(servo4Flat + 4*servo4Deflect);\n          delay(250);\n          servo4.write(servo4Flat);\n          delay(2000);\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(250);\n          servo4.write(servo4Flat);\n          delay(2000);\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(250);\n          servo4.write(servo4Flat);\n          delay(1000);\n          servo2.write(servo2Flat - 4*servo2Deflect);\n          delay(300);\n          servo2.write(servo2Flat);\n          delay(1000); \n          servo4.write(servo4Flat - servo4Deflect);\n          delay(250);\n          servo4.write(servo4Flat);\n          delay(1000);\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(250);\n          servo4.write(servo4Flat);\n          delay(1500);\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(250);\n          servo4.write(servo4Flat);\n          delay(13000);\n          servo3.write(servo3Flat - 5*servo3Deflect);\n          delay(500);\n          servo3.write(servo3Flat);\n          delay(600);\n          clutch_count = 6;\n          beep();\n          tapScreen();\n          beep();\n          egg_count = 0;\n          bike_count = 0;\n\n        }\n\n        //If the screen is bright after asking for an egg and you have fewer than 5 eggs,\n        //the program bikes back and forth and asks for an egg.\n        else if(photocellReading &gt; 350 &amp;&amp; egg_count &lt;5)\n        {\n          servo1.write(servo1Flat + servo1Deflect);\n          delay(WALKING_BUTTONPRESS_DURATION);\n          servo1.write(servo1Flat);\n          delay(50);\n          servo2.write(servo2Flat + servo2Deflect);\n          delay(3200);\n          servo2.write(servo2Flat);\n          delay(50);\n          servo1.write(servo1Flat + servo1Deflect);\n          delay(WALKING_BUTTONPRESS_DURATION);\n          servo1.write(servo1Flat);\n          delay(50);\n          servo2.write(servo2Flat + servo2Deflect);\n          delay(3500);\n          servo2.write(servo2Flat);\n          delay(100);\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(200);\n          servo4.write(servo4Flat);\n          delay(400);\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(200);\n          servo4.write(servo4Flat);\n          delay(400);\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(200);\n          servo4.write(servo4Flat);\n          delay(400);\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(200);\n          servo4.write(servo4Flat);\n          delay(400);\n          bike_count++;\n            }\n        //Deposits eggs if you've hatched them all.\n        else if(egg_count &gt;= 10)\n          {                \n            tapScreen();\n            egg_count = 0;\n          }\n\n        //Focuses on hatching eggs after you've collected 5 eggs.\n        else if(photocellReading &gt; 350 &amp;&amp; egg_count &gt;=5)\n          {          \n          servo1.write(servo1Flat + servo1Deflect);\n          delay(3300);\n          servo1.write(servo1Flat);\n          delay(50);\n          servo2.write(servo2Flat + servo2Deflect);\n          delay(3300);\n          servo2.write(servo2Flat);\n          delay(50);\n          bike_count++;\n          }\n\n        //Hatches an egg when the screen goes dark after you've collected 5 eggs.\n        else if(photocellReading &lt; 350 &amp;&amp; egg_count &gt;=5)\n          {\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(19000);\n          servo3.write(servo3Flat + servo3Deflect);\n          delay(400);\n          servo3.write(servo3Flat);\n          delay(3000);\n          egg_count++;\n          Serial.print(\"Eggs hatched: \");\n          Serial.println(egg_count - 5);\n          servo1.write(servo1Flat + servo1Deflect);\n          delay(800);\n          servo1.write(servo1Flat);\n          bike_count = 0;\n          }\n\n        //If you've collected fewer than five eggs and the screen is still dark after asking\n        //for an egg, the program will take the egg.\n        else if(photocellReading &lt; 350 &amp;&amp; egg_count &lt; 5)\n        {\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(200);\n          servo4.write(servo4Flat);\n          delay(400);\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(200);\n          servo4.write(servo4Flat);\n          delay(400);\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(200);\n          servo4.write(servo4Flat);\n          delay(3000);\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(200);\n          servo4.write(servo4Flat);\n          delay(400);\n          servo4.write(servo4Flat - servo4Deflect);\n          delay(200);\n          servo4.write(servo4Flat);\n          delay(400);\n          egg_count++;\n          Serial.print(\"Eggs: \");\n          Serial.println(egg_count);\n          bike_count = 0;\n        }\n\n        int curr = analogRead(photocellPin);            \n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "gcc", "dynamic-linking"], "comments": [{"owner": {"reputation": 3864, "user_id": 620908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2abd643ecb33f1a18a7a4f976cef0dbe?s=128&d=identicon&r=PG", "display_name": "Adrian Colomitchi", "link": "https://stackoverflow.com/users/620908/adrian-colomitchi"}, "edited": false, "score": 0, "creation_date": 1475647787, "post_id": 39866262, "comment_id": 67020627, "body": "Does a <a href=\"http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html\" rel=\"nofollow noreferrer\">missing <code>-soname</code></a> has anything to do with your problem?"}, {"owner": {"reputation": 511, "user_id": 1710750, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1d115633302d3a1523c4d83a9831b879?s=128&d=identicon&r=PG", "display_name": "ZXcvbnM", "link": "https://stackoverflow.com/users/1710750/zxcvbnm"}, "reply_to_user": {"reputation": 3864, "user_id": 620908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2abd643ecb33f1a18a7a4f976cef0dbe?s=128&d=identicon&r=PG", "display_name": "Adrian Colomitchi", "link": "https://stackoverflow.com/users/620908/adrian-colomitchi"}, "edited": false, "score": 0, "creation_date": 1475650327, "post_id": 39866262, "comment_id": 67021776, "body": "@AdrianColomitchi tried adding a suitable -soname parameter to both, no difference"}, {"owner": {"reputation": 511, "user_id": 1710750, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1d115633302d3a1523c4d83a9831b879?s=128&d=identicon&r=PG", "display_name": "ZXcvbnM", "link": "https://stackoverflow.com/users/1710750/zxcvbnm"}, "reply_to_user": {"reputation": 3864, "user_id": 620908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2abd643ecb33f1a18a7a4f976cef0dbe?s=128&d=identicon&r=PG", "display_name": "Adrian Colomitchi", "link": "https://stackoverflow.com/users/620908/adrian-colomitchi"}, "edited": false, "score": 0, "creation_date": 1475650338, "post_id": 39866262, "comment_id": 67021789, "body": "@Leon, the output of -DC is identical to that of -gC sadly"}, {"owner": {"reputation": 27522, "user_id": 6394138, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/u64Lc.png?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/6394138/leon"}, "edited": false, "score": 1, "creation_date": 1475651296, "post_id": 39866262, "comment_id": 67022271, "body": "Can you prepare a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>?"}, {"owner": {"reputation": 511, "user_id": 1710750, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1d115633302d3a1523c4d83a9831b879?s=128&d=identicon&r=PG", "display_name": "ZXcvbnM", "link": "https://stackoverflow.com/users/1710750/zxcvbnm"}, "edited": false, "score": 0, "creation_date": 1475655176, "post_id": 39866262, "comment_id": 67024491, "body": "I&#39;m now at work, but will strip it out when I get back this evening. No doubt I&#39;ll probably find the solution just as I get started...!"}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 1710750, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1d115633302d3a1523c4d83a9831b879?s=128&d=identicon&r=PG", "display_name": "ZXcvbnM", "link": "https://stackoverflow.com/users/1710750/zxcvbnm"}, "edited": false, "score": 0, "creation_date": 1475655400, "post_id": 39868170, "comment_id": 67024616, "body": "Yeah, I suspect something more complex is at fault. This code (and the other libraries I haven&#39;t gotten to yet) already fully build in msvc2015 for Windows, and it does work if I disable my memory debugging (so the MEM_priv* functions are never used or exported). I&#39;ll strip it down into minimal and see what I find later this evening."}], "tags": [], "owner": {"reputation": 134, "user_id": 6915174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BUmUa.jpg?s=128&g=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/6915174/peter-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1475653525, "last_edit_date": 1495542790, "creation_date": 1475653525, "answer_id": 39868170, "question_id": 39866262, "link": "https://stackoverflow.com/questions/39866262/ld-undefined-reference-despite-library-found-and-symbols-exported/39868170#39868170", "title": "ld undefined reference, despite library found and symbols exported", "body": "<p>You should mark <code>MEM_priv_alloc()</code> function as <code>extern \"C\"</code> or wrap function body into <code>extern \"C\" { /* function implementation */ }</code> (already done as I can see from description).\nAnd use combination of <code>__cplusplus</code> and <code>extern \"C\"</code> in header</p>\n\n<pre><code>#ifdef __cplusplus\n   #define EXTERNC extern \"C\"\n#else\n   #define EXTERNC\n#endif\n\nEXTERNC int MEM_priv_alloc (void);\n</code></pre>\n\n<p>Please also double check how <code>MEM_priv_alloc</code> prototype is done. For example, <code>MEM_priv_alloc</code> should <strong>not</strong> be <code>inline</code> (unfortunately I do not know phisics of this, however <code>inline</code> example failed for me)</p>\n\n<hr>\n\n<p>Below is simplified example that works for me:</p>\n\n<p>files:</p>\n\n<pre><code>$ ls\nmain.c  Makefile  mem.cpp  mem.h  strings.c  strings.h\n</code></pre>\n\n<p>mem.cpp</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"mem.h\"\nextern \"C\" int MEM_priv_alloc (void)\n{\n   return 0;\n}\n</code></pre>\n\n<p>mem.h</p>\n\n<pre><code>#ifdef __cplusplus\n   #define EXTERNC extern \"C\"\n#else\n   #define EXTERNC\n#endif\nEXTERNC int MEM_priv_alloc (void);\n</code></pre>\n\n<p>strings.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"mem.h\"\nint STR_duplicate_replace (void)\n{\n   MEM_priv_alloc();\n}\n</code></pre>\n\n<p>strings.h:</p>\n\n<pre><code>int STR_duplicate_replace (void);\n</code></pre>\n\n<p>main.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"string.h\"\nint main (void)\n{\n   STR_duplicate_replace ();\n   return 0;\n}\n</code></pre>\n\n<p>Makefile:</p>\n\n<pre><code>prog: libmemory.so libstrings.so\n        gcc -o $@ -L. -lmemory -lstrings main.c\n\nlibmemory.so: mem.cpp\n        g++ -shared -fPIC -o $@ $^\n\nlibstrings.so: strings.c\n        gcc -shared -fPIC -o $@ $^\n</code></pre>\n\n<p>and the build log:</p>\n\n<pre><code>g++ -shared -fPIC -o libmemory.so mem.cpp\ngcc -shared -fPIC -o libstrings.so strings.c\ngcc -o prog -L. -lmemory -lstrings main.c\n</code></pre>\n\n<hr>\n\n<p>please also see more details in\n<a href=\"https://stackoverflow.com/questions/199418/using-c-library-in-c-code\">Using C++ library in C code</a> and \n<a href=\"https://isocpp.org/wiki/faq/mixing-c-and-cpp\" rel=\"nofollow noreferrer\">wiki How to mix C and C++</a></p>\n"}, {"tags": [], "owner": {"reputation": 511, "user_id": 1710750, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1d115633302d3a1523c4d83a9831b879?s=128&d=identicon&r=PG", "display_name": "ZXcvbnM", "link": "https://stackoverflow.com/users/1710750/zxcvbnm"}, "is_accepted": true, "score": 0, "last_activity_date": 1475692620, "creation_date": 1475692620, "answer_id": 39881396, "question_id": 39866262, "link": "https://stackoverflow.com/questions/39866262/ld-undefined-reference-despite-library-found-and-symbols-exported/39881396#39881396", "title": "ld undefined reference, despite library found and symbols exported", "body": "<p>So, I was stripping out the final parts of the amalgamation, and uncovered the issue.</p>\n\n<p>My import/export is modelled off of this: <a href=\"https://gcc.gnu.org/wiki/Visibility\" rel=\"nofollow\">https://gcc.gnu.org/wiki/Visibility</a></p>\n\n<p>My equivalent implementation ends up looking like this:</p>\n\n<pre><code>#     if GCC_IS_V4_OR_LATER\n#             define DLLEXPORT        __attribute__((visibility(\"default\")))\n#             define DLLIMPORT        __attribute__((visibility(\"hidden\")))\n#     else\n#             define DLLEXPORT\n#             define DLLIMPORT\n#     endif\n</code></pre>\n\n<p>The DLLIMPORT (visibility hidden) is causing the problem; I replace it with a blank definition and it's all ok. Yes, I did also have the equivalent for clang, which is why that also failed in the same way.</p>\n\n<p>My takeaway from this is that the C code only ever saw these would-be-symbols as hidden, and therefore couldn't import them no matter how hard it tried, and however much they actually existed!</p>\n"}], "owner": {"reputation": 511, "user_id": 1710750, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1d115633302d3a1523c4d83a9831b879?s=128&d=identicon&r=PG", "display_name": "ZXcvbnM", "link": "https://stackoverflow.com/users/1710750/zxcvbnm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1985, "favorite_count": 0, "accepted_answer_id": 39881396, "answer_count": 2, "score": 3, "last_activity_date": 1475692620, "creation_date": 1475646433, "question_id": 39866262, "link": "https://stackoverflow.com/questions/39866262/ld-undefined-reference-despite-library-found-and-symbols-exported", "title": "ld undefined reference, despite library found and symbols exported", "body": "<p>Been fighting with this on and off for 48 hours now; I'm still getting undefined reference errors when attempting to link a dynamic library with its dependency - despite all exports existing, and the library being found successfully.</p>\n\n<p>Scenario:</p>\n\n<ul>\n<li>libmemory (C++) - exports functions with <code>extern \"C\"</code></li>\n<li>libstring (C) - exports functions, imports from libmemory</li>\n</ul>\n\n<p>libmemory builds successfully:</p>\n\n<pre><code>$ g++ -shared -fPIC -o ./builds/libmemory.so ...$(OBJECTS)...\n</code></pre>\n\n<p>libstring compiles successfully, but fails to link:</p>\n\n<pre><code>$ gcc -shared -fPIC -o ./builds/libstring.so ...$(OBJECTS)... -L./builds -lmemory\n./temp/libstring/string.o: In function `STR_duplicate':\nstring.c:(.text+0x1cb): undefined reference to `MEM_priv_alloc'\n./temp/libstring/string.o: In function `STR_duplicate_replace':\nstring.c:(.text+0x2a0): undefined reference to `MEM_priv_free'\nstring.c:(.text+0x2bf): undefined reference to `MEM_priv_alloc'\n/usr/bin/ld: ./builds/libstring.so: hidden symbol `MEM_priv_free' isn't defined\n/usr/bin/ld: final link failed: Bad value\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Verifying libmemory exports its symbols, and the library itself is found by using <code>-v</code> to gcc:</p>\n\n<pre><code>...\nattempt to open ./builds/libmemory.so succeeded\n-lmemory (./builds/libmemory.so)\n...\n\n$ nm -gC ./builds/libmemory.so | grep MEM_\n0000000000009178 T MEM_exit\n0000000000009343 T MEM_init\n00000000000093e9 T MEM_print_leaks\n00000000000095be T MEM_priv_alloc\n000000000000971d T MEM_priv_free\n00000000000099c1 T MEM_priv_realloc\n0000000000009d26 T MEM_set_callback_leak\n0000000000009d3f T MEM_set_callback_noleak\n\n$ objdump -T ./builds/libmemory.so | grep MEM_\n0000000000009d3f g    DF .text  0000000000000019  Base        MEM_set_callback_noleak\n00000000000093e9 g    DF .text  00000000000001d5  Base        MEM_print_leaks\n0000000000009d26 g    DF .text  0000000000000019  Base        MEM_set_callback_leak\n00000000000099c1 g    DF .text  0000000000000365  Base        MEM_priv_realloc\n0000000000009343 g    DF .text  00000000000000a6  Base        MEM_init\n00000000000095be g    DF .text  000000000000015f  Base        MEM_priv_alloc\n000000000000971d g    DF .text  00000000000002a4  Base        MEM_priv_free\n0000000000009178 g    DF .text  00000000000000a7  Base        MEM_exit\n\n$ readelf -Ws ./builds/libmemory.so | grep MEM_\n    49: 0000000000009d3f    25 FUNC    GLOBAL DEFAULT   11 MEM_set_callback_noleak\n    95: 00000000000093e9   469 FUNC    GLOBAL DEFAULT   11 MEM_print_leaks\n    99: 0000000000009d26    25 FUNC    GLOBAL DEFAULT   11 MEM_set_callback_leak\n   118: 00000000000099c1   869 FUNC    GLOBAL DEFAULT   11 MEM_priv_realloc\n   126: 0000000000009343   166 FUNC    GLOBAL DEFAULT   11 MEM_init\n   145: 00000000000095be   351 FUNC    GLOBAL DEFAULT   11 MEM_priv_alloc\n   192: 000000000000971d   676 FUNC    GLOBAL DEFAULT   11 MEM_priv_free\n   272: 0000000000009178   167 FUNC    GLOBAL DEFAULT   11 MEM_exit\n   103: 0000000000009343   166 FUNC    GLOBAL DEFAULT   11 MEM_init\n   108: 0000000000009178   167 FUNC    GLOBAL DEFAULT   11 MEM_exit\n   148: 0000000000009d3f    25 FUNC    GLOBAL DEFAULT   11 MEM_set_callback_noleak\n   202: 00000000000095be   351 FUNC    GLOBAL DEFAULT   11 MEM_priv_alloc\n   267: 000000000000971d   676 FUNC    GLOBAL DEFAULT   11 MEM_priv_free\n   342: 0000000000009d26    25 FUNC    GLOBAL DEFAULT   11 MEM_set_callback_leak\n   346: 00000000000099c1   869 FUNC    GLOBAL DEFAULT   11 MEM_priv_realloc\n   366: 00000000000093e9   469 FUNC    GLOBAL DEFAULT   11 MEM_print_leaks\n</code></pre>\n\n<p>Is there something horribly simple I'm missing? All the other related questions to this have simple answers such as link library order, and the paths used - but I've already verified they're in place and working as expected.</p>\n\n<p>Tinkering with <code>-fvisibility</code> led to no changes either.</p>\n\n<p>The same result exists whether using clang or gcc.</p>\n\n<p><code>Linux 3.16.0-38-generic</code>\n<code>gcc version 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3)</code></p>\n"}, {"tags": ["c", "multithreading", "semaphore"], "comments": [{"owner": {"reputation": 891, "user_id": 2627068, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/uLtlf.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/2627068/dan"}, "edited": false, "score": 1, "creation_date": 1475644807, "post_id": 39865838, "comment_id": 67019527, "body": "Mutexes don&#39;t really report status in C, you usually have to do this manually with condition variables. Does this question help you at all? <a href=\"http://stackoverflow.com/questions/4362459/check-to-see-if-a-pthread-mutex-is-locked-or-unlocked-after-a-thread-has-locked\" title=\"check to see if a pthread mutex is locked or unlocked after a thread has locked\">stackoverflow.com/questions/4362459/&hellip;</a>"}, {"owner": {"reputation": 13712, "user_id": 1313233, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/hBeXC.png?s=128&g=1", "display_name": "rkachach", "link": "https://stackoverflow.com/users/1313233/rkachach"}, "reply_to_user": {"reputation": 891, "user_id": 2627068, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/uLtlf.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/2627068/dan"}, "edited": false, "score": 0, "creation_date": 1475645871, "post_id": 39865838, "comment_id": 67019930, "body": "The code in this case only uses pthread_mutex_t and I&#39;m having some strange issues with threads synchronization. Thus I want to print the status for each mutex for debugging."}, {"owner": {"reputation": 891, "user_id": 2627068, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/uLtlf.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/2627068/dan"}, "edited": false, "score": 1, "creation_date": 1475646202, "post_id": 39865838, "comment_id": 67020040, "body": "I think you want to use condition variables. Just have some basic integer primitives flag different messages when your mutexes run through different parts of the code. To synchronize you&#39;d just check your condition variables for the optimal condition, then proceed or halt as needed."}, {"owner": {"reputation": 13712, "user_id": 1313233, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/hBeXC.png?s=128&g=1", "display_name": "rkachach", "link": "https://stackoverflow.com/users/1313233/rkachach"}, "reply_to_user": {"reputation": 891, "user_id": 2627068, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/uLtlf.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/2627068/dan"}, "edited": false, "score": 0, "creation_date": 1475654360, "post_id": 39865838, "comment_id": 67024050, "body": "I can&#39;t change the source code. I need to debug using mutexes .."}, {"owner": {"reputation": 891, "user_id": 2627068, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/uLtlf.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/2627068/dan"}, "edited": false, "score": 0, "creation_date": 1475680689, "post_id": 39865838, "comment_id": 67042418, "body": "If you can&#39;t change the code then I&#39;m afraid you&#39;re out of luck"}], "owner": {"reputation": 13712, "user_id": 1313233, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/hBeXC.png?s=128&g=1", "display_name": "rkachach", "link": "https://stackoverflow.com/users/1313233/rkachach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 926, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475644190, "creation_date": 1475644190, "question_id": 39865838, "link": "https://stackoverflow.com/questions/39865838/print-show-a-pthread-mutex-t-variable-status", "title": "print/show a pthread_mutex_t variable status", "body": "<p>Is there a simple way to print/show what's the current status of a mutex (pthread_mutex_t)? I can't find any function for this purpose. </p>\n"}]