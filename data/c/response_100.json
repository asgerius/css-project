[{"tags": ["c", "linux", "pipe", "system-calls", "dup2"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1481162447, "post_id": 41029398, "comment_id": 69268675, "body": "Like we don&#39;t have the code of your other program. We can&#39;t help you more. You have a lot of strange code. For example, you replace 1 by pipe[0]. This is useless because write on the exit of a pipe don&#39;t work. I don&#39;t understand why you want use signal."}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1481166085, "post_id": 41029398, "comment_id": 69269588, "body": "You need to read from the read end and write into the write end. You are reading from the write end and writing to the read end."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 5615628, "user_type": "registered", "profile_image": "https://graph.facebook.com/536001879907052/picture?type=large", "display_name": "Lev Kolomazov", "link": "https://stackoverflow.com/users/5615628/lev-kolomazov"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1481161236, "post_id": 41029429, "comment_id": 69268357, "body": "@Stargateur Emm, thanks, still empty though. However, I noticed a thing. The program, that executes in <code>execl()</code> command prompts &quot;DONE&quot; to stdout, when done. My program prompts &quot;TERMINATED&quot;,when done. And &quot;DONE&quot; appears before &quot;TERMINATED&quot;, so <code>execl()</code> somehow doesn&#39;t wait for the major program and its numbers. Can&#39;t see the way fixing though."}, {"owner": {"reputation": 87, "user_id": 5615628, "user_type": "registered", "profile_image": "https://graph.facebook.com/536001879907052/picture?type=large", "display_name": "Lev Kolomazov", "link": "https://stackoverflow.com/users/5615628/lev-kolomazov"}, "edited": false, "score": 0, "creation_date": 1481161299, "post_id": 41029429, "comment_id": 69268371, "body": "@DavidSchwartz Thank you for advice. I&#39;ve changed it a little bit, but still get the same issue. int fdOut = open(&quot;out.txt&quot;, O_WRONLY | O_CREAT | O_TRUNC, S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH); dup2(fdOut,1); //Redirecting output to &quot;out.txt&quot; close(fd[PIPE_WRITEEND]); execl(&quot;c1/main&quot;,&quot;main&quot;,(char *)NULL); Observe any idea where the bug can be?"}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1481154507, "creation_date": 1481154507, "answer_id": 41029429, "question_id": 41029398, "link": "https://stackoverflow.com/questions/41029398/c-using-different-pipe-ends-in-different-processes/41029429#41029429", "title": "C - using different pipe ends in different processes", "body": "<pre><code>    FILE *outfile = fopen(\"out.txt\",\"w\");\n    dup2(fd[PIPE_WRITEEND],0); \n    dup2(outfile,1); \n</code></pre>\n\n<p>This makes no sense. The <code>dup2</code> function doesn't take a <code>FILE *</code> as a parameter. Use <code>open</code>, not <code>fopen</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1069, "user_id": 5923374, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd4f47d4ba513ba8ed316520a12f94a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ford O.", "link": "https://stackoverflow.com/users/5923374/ford-o"}, "is_accepted": true, "score": 1, "last_activity_date": 1481196446, "creation_date": 1481196446, "answer_id": 41038362, "question_id": 41029398, "link": "https://stackoverflow.com/questions/41029398/c-using-different-pipe-ends-in-different-processes/41038362#41038362", "title": "C - using different pipe ends in different processes", "body": "<p>You write and read from wrong indexes of pipe. You need to change them:</p>\n\n<p>This redirects stdout to pipe input.</p>\n\n<pre><code>   close(fd[0]);\n   dup2(fd[1], STDOUT_FILENO);\n</code></pre>\n\n<p>This redirects pipe output to stdin.</p>\n\n<pre><code>   close(fd[1]);\n   dup2(fd[0], STDIN_FILENO);\n</code></pre>\n\n<p>Also <code>dup2</code> takes integer, not pointer, so you should do:</p>\n\n<pre><code>   f = fopen(\"out.txt\", \"w\");\n   dup2(fileno(f), STDOUT_FILENO);\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 5615628, "user_type": "registered", "profile_image": "https://graph.facebook.com/536001879907052/picture?type=large", "display_name": "Lev Kolomazov", "link": "https://stackoverflow.com/users/5615628/lev-kolomazov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 41038362, "answer_count": 2, "score": 1, "last_activity_date": 1544371948, "creation_date": 1481154349, "last_edit_date": 1544371948, "question_id": 41029398, "link": "https://stackoverflow.com/questions/41029398/c-using-different-pipe-ends-in-different-processes", "title": "C - using different pipe ends in different processes", "body": "<p>I've been searching and reading manuals, but still can't get the pipe mechanism. I'm making a program, which should do the following:</p>\n\n<ol>\n<li><p>Parent process creates pipe, two child proccesses and waits.</p>\n\n<ol start=\"2\">\n<li>First child generates pairs of random numbers and passes them with space between to the second process via pipe. It goes on till\ngets signal from parent.</li>\n<li>Second child redirects it input so it is the output of the first child and redirects output to the out.txt file. Then it executes\nalready compiled program, calculating GCD of numbers from (1);</li>\n</ol></li>\n<li><p>Parent closes pipe and kills child.</p></li>\n</ol>\n\n<p>So I got this C code (I reduced it so the post can fit the rules):</p>\n\n<pre><code>const int PIPE_READEND=0;\nconst int PIPE_WRITEEND=1;\n\n        (...)\nif (child1 == 0) {\n        //Child1 code here\n        close(fd[1]);\n\n        struct sigaction sa;\n        sa.sa_handler = sigHandler;\n        sigemptyset(&amp;sa.sa_mask);\n        sa.sa_flags = 0;\n        if (sigaction(SIGUSR1,&amp;sa,NULL) == -1){ //Handling SIGUSR1 signal\n            perror(\"Signal handling unexpected error\");\n            exit(errno);\n        }\n        int a,b;\n        srand(time(&amp;t));\n        if (dup2(fd[PIPE_READEND],1) &lt; 0){ //Redirecting stdout to the pipe fd.\n            perror(\"In Child1 Redirecting stdout to pipe error\");\n            exit(errno);\n        } \n        close(fd[0]);\n        while(1){\n            a = rand();\n            b = rand();\n            printf(\"%d %d\\n\", a, b);\n            sleep(1);\n        }\n\n\n       (...)\nif ((child2 = fork()) &lt; 0){\n        perror(\"Fork error in Child2 process\");\n        exit(errno);\n    } else if (child2 == 0){\n        //Child2 code here\n        close(fd[PIPE_READEND]);\n        FILE *outfile = fopen(\"out.txt\",\"w\");\n        dup2(fd[PIPE_WRITEEND],0); \n        dup2(outfile,1); \n        close(fd[PIPE_WRITEEND]);\n        execl(\"c1/main\",\"main\",(char *)NULL);   \n</code></pre>\n\n<p>The problem is, after executing it, out.txt stays empty. I'm disappointed about the pipe array indices, which one is used for what.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481153544, "post_id": 41029229, "comment_id": 69266057, "body": "<code>m[0] -&gt; rows = i;</code> --&gt; <code>m-&gt;rows = i;</code>"}, {"owner": {"reputation": 13, "user_id": 7264943, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y_WMasocjdk/AAAAAAAAAAI/AAAAAAAAAnM/7VaWw_44w1s/photo.jpg?sz=128", "display_name": "Taito", "link": "https://stackoverflow.com/users/7264943/taito"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481153637, "post_id": 41029229, "comment_id": 69266096, "body": "matrix.c: In function &#39;matrix_loadFromFile&#39;: matrix.c:246:6: error: request for member &#39;rows&#39; in something not a structure or union     m -&gt; rows = i;       ^"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481153999, "post_id": 41029229, "comment_id": 69266227, "body": "if You define <code>typedef struct Matrix *Matrix;</code>, <code>(*m)-&gt;rows = i;</code> : Show caller side code."}, {"owner": {"reputation": 1711, "user_id": 3171693, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b3f51428576d48dd6bc1a5851faa717a?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip Kumar", "link": "https://stackoverflow.com/users/3171693/dilip-kumar"}, "edited": false, "score": 0, "creation_date": 1481154051, "post_id": 41029229, "comment_id": 69266239, "body": "are you sure that you are receiving valid pointer address (m)?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481154454, "post_id": 41029229, "comment_id": 69266371, "body": "How was parameter of <code>m</code>(<code>Matrix * m</code>) made?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1481154600, "post_id": 41029229, "comment_id": 69266428, "body": "Does this code even compile? <code>m[0]-&gt;rows = i;</code> should get a compiler error, since <code>m[0]</code> is not a pointer."}, {"owner": {"reputation": 13, "user_id": 7264943, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y_WMasocjdk/AAAAAAAAAAI/AAAAAAAAAnM/7VaWw_44w1s/photo.jpg?sz=128", "display_name": "Taito", "link": "https://stackoverflow.com/users/7264943/taito"}, "edited": false, "score": 0, "creation_date": 1481154907, "post_id": 41029229, "comment_id": 69266541, "body": "the code compile but the program stoped working <code>m[0] -&gt; rows = i;</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1481155043, "post_id": 41029229, "comment_id": 69266577, "body": "What is the <code>typedef</code> for <code>Matrix</code>? In C you can&#39;t use a structure name as a type without something like <code>typedef struct Matrix Matrix</code>."}, {"owner": {"reputation": 13, "user_id": 7264943, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y_WMasocjdk/AAAAAAAAAAI/AAAAAAAAAnM/7VaWw_44w1s/photo.jpg?sz=128", "display_name": "Taito", "link": "https://stackoverflow.com/users/7264943/taito"}, "edited": false, "score": 1, "creation_date": 1481155724, "post_id": 41029229, "comment_id": 69266792, "body": "<code>typedef struct Matrix *Matrix;</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481157690, "post_id": 41029229, "comment_id": 69267395, "body": "I think there is a problem in creating <code>m</code>. if it is not created outside the function, <code>*m = malloc(sizeof(**m));</code> is required at the beginning of the this function."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481154468, "post_id": 41029328, "comment_id": 69266379, "body": "You&#39;re only allocating space for 1 double, but then you&#39;re assigning to the i&#39;th element of it."}, {"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481154562, "post_id": 41029328, "comment_id": 69266419, "body": "Sorry about that, fixed!"}], "tags": [], "owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "is_accepted": false, "score": 0, "last_activity_date": 1481154550, "last_edit_date": 1481154550, "creation_date": 1481153946, "answer_id": 41029328, "question_id": 41029229, "link": "https://stackoverflow.com/questions/41029229/c-program-stop-working-m0-rows-i/41029328#41029328", "title": "C Program stop working (m[0] -&gt; rows = i;)", "body": "<p>You need to allocate elems first, like this:</p>\n\n<pre><code>for(i = 0; i &lt; (matrix_rows(m[0]) * matrix_cols(m[0])); ++i) {\n    m[0] -&gt; elems[i] = malloc(sizeof(double));\n    m[0] -&gt; elems[i] = matrix_getnumber(fp);\n};\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7264943, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y_WMasocjdk/AAAAAAAAAAI/AAAAAAAAAnM/7VaWw_44w1s/photo.jpg?sz=128", "display_name": "Taito", "link": "https://stackoverflow.com/users/7264943/taito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496853617, "creation_date": 1481153342, "last_edit_date": 1496853617, "question_id": 41029229, "link": "https://stackoverflow.com/questions/41029229/c-program-stop-working-m0-rows-i", "title": "C Program stop working (m[0] -&gt; rows = i;)", "body": "<p>my program stopped working... .\nI don't know why the program stop working if someone can help me, I would be very grateful</p>\n\n<pre><code>struct Matrix {\n    unsigned int rows, cols;\n    double * elems;\n};\n</code></pre>\n\n<p>and here the function</p>\n\n<pre><code>Errorcode matrix_loadFromFile (Matrix * m, char * mFileName) {\nchar c;\nunsigned int i;\nFILE *fp;\n\nfp = fopen(mFileName, \"r\");\nif(fp == NULL) {\n    return ERR_FOPEN;\n}else {\n    i = matrix_getnumber(fp);\n    if(i == 0) {\n        return ERR_INVALID_ROWS;\n    }else {\n        m[0] -&gt; rows = i; /**here the program stop working ...*/\n    };\n    i = matrix_getnumber(fp);\n    if(i == 0) {\n        return ERR_INVALID_COLS;\n    }else {\n        m[0] -&gt; cols = i;\n    };\n\n    for(i = 0; i &lt; (matrix_rows(m[0]) * matrix_cols(m[0])); ++i) {\n        m[0] -&gt; elems[i] = matrix_getnumber(fp);\n    };\n\n    c = fgetc(fp);\n    if(c != EOF) {\n        return ERR_TRAILING_CHARS;\n    };\n\n    fclose(fp);\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>Delivery is tomorrow, so I have not much time :/</p>\n"}, {"tags": ["c", "memory", "struct", "shared", "mmap"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1481153412, "post_id": 41029202, "comment_id": 69266003, "body": "Using <code>strcpy</code> has nothing to do with whether the string is in shared memory. What memory does <code>name</code> point to and how did you allocate that memory?"}, {"owner": {"reputation": 293, "user_id": 4293261, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/qGWfT.jpg?s=128&g=1", "display_name": "bart-kn", "link": "https://stackoverflow.com/users/4293261/bart-kn"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1481154587, "post_id": 41029202, "comment_id": 69266425, "body": "@immibis I am using strcpy to the shared memory pointer. I allocate with char * str = &quot;string&quot;."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1481164262, "post_id": 41029202, "comment_id": 69269109, "body": "So you do <code>tptr = mmap(...); char *str = &quot;string&quot;; strcpy(tptr-&gt;name, str);</code>?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1481183433, "post_id": 41029202, "comment_id": 69275914, "body": "@immibis Well that won&#39;t work because <code>tptr-&gt;name</code> has no particular value, so you&#39;re passing garbage (likely NULL) to <code>strcpy</code>."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1481188086, "post_id": 41029202, "comment_id": 69278341, "body": "@DavidSchwartz <b><i>I</i></b> know why it won&#39;t work. I asked the asker if that is what the asker has written."}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 1, "last_activity_date": 1481153616, "creation_date": 1481153616, "answer_id": 41029276, "question_id": 41029202, "link": "https://stackoverflow.com/questions/41029202/segmentation-fault-when-accessing-shared-memory-in-c/41029276#41029276", "title": "Segmentation fault when accessing shared memory in C", "body": "<p>There's no point in putting a pointer in shared memory. A pointer gives a location inside the address space of a particular process. It would have no meaning to another process with another address space. (With some complicated exceptions such as a pointer to memory allocated before a call to <code>fork</code> accessed by related processes running the same executable.)</p>\n\n<p>You can store the string data itself in shared memory if you wish. For example, this will work:</p>\n\n<pre><code>#define MAX_NAME_SIZE 100\n\nstruct town_t\n{\n    int population;\n    char name[MAX_NAME_SIZE];\n};\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 4293261, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/qGWfT.jpg?s=128&g=1", "display_name": "bart-kn", "link": "https://stackoverflow.com/users/4293261/bart-kn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 0, "accepted_answer_id": 41029276, "answer_count": 1, "score": 2, "last_activity_date": 1481153616, "creation_date": 1481153213, "question_id": 41029202, "link": "https://stackoverflow.com/questions/41029202/segmentation-fault-when-accessing-shared-memory-in-c", "title": "Segmentation fault when accessing shared memory in C", "body": "<p>I have 2 programs which need to share memory. Let's call one program A, the other one B. </p>\n\n<p>There is a struct in this format for this purpose:</p>\n\n<pre><code>struct town_t {\n    int population;\n    char * name; \n}\n</code></pre>\n\n<p>In program A, data gets written to shared memory using mmap. This works for program A. (It uses strcpy for the <code>name</code>)</p>\n\n<p>Program B's purpose is to simply read the data. This too works with mmap. Accessing the shared memory's <code>population</code> field works without any problems. However, accessing the <code>population</code> field gives a segmentation fault.</p>\n\n<p>Since I used strcpy, the entire string should be in the shared memory right?</p>\n\n<p>I use the following flags to get the pointer to shared memory, which returns no error.</p>\n\n<pre><code>tptr = (struct town_t *) mmap(0, 1024, PROT_READ, MAP_SHARED, shm_fd, 0)\n</code></pre>\n\n<p>How could I make it so I can actually read the string (char*) from program B?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 43, "user_id": 7264919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2b5ec0bfbe3f680789270bbcb36894?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Valentine", "link": "https://stackoverflow.com/users/7264919/scott-valentine"}, "edited": false, "score": 0, "creation_date": 1481153831, "post_id": 41029177, "comment_id": 69266163, "body": "To clarify, the problem is the initialization of f.c"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481155227, "post_id": 41029177, "comment_id": 69266632, "body": "Edit your clarification into the question, not a comment."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7264919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2b5ec0bfbe3f680789270bbcb36894?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Valentine", "link": "https://stackoverflow.com/users/7264919/scott-valentine"}, "edited": false, "score": 0, "creation_date": 1481153545, "post_id": 41029196, "comment_id": 69266059, "body": "No, what I am actually trying to accomplish is using the preprocessor to compile things down to a true static constant value (.rodata), and my blocking issue is that it doesn&#39;t treat array elements as constant expressions, but it does treat an array as a constant expression...  Your example could never be uses as a static initializer for something else, and the &#39;\\0&#39; is always implicit (well, unless you use a fixed array size)."}, {"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "reply_to_user": {"reputation": 43, "user_id": 7264919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2b5ec0bfbe3f680789270bbcb36894?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Valentine", "link": "https://stackoverflow.com/users/7264919/scott-valentine"}, "edited": false, "score": 0, "creation_date": 1481153627, "post_id": 41029196, "comment_id": 69266092, "body": "Fixed it should be const!"}, {"owner": {"reputation": 43, "user_id": 7264919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2b5ec0bfbe3f680789270bbcb36894?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Valentine", "link": "https://stackoverflow.com/users/7264919/scott-valentine"}, "edited": false, "score": 0, "creation_date": 1481153785, "post_id": 41029196, "comment_id": 69266150, "body": "I think you are missing the point... I have no problem initializing f.s, the problem is f.c. In your example, *S is fine, sure, but it can never be used as a static initializer for something else."}, {"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "reply_to_user": {"reputation": 43, "user_id": 7264919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2b5ec0bfbe3f680789270bbcb36894?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Valentine", "link": "https://stackoverflow.com/users/7264919/scott-valentine"}, "edited": false, "score": 0, "creation_date": 1481153859, "post_id": 41029196, "comment_id": 69266178, "body": "Fixed C should be const as well."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1481154026, "post_id": 41029196, "comment_id": 69266235, "body": "@koper89: This will not achieve anything at all."}, {"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1481154085, "post_id": 41029196, "comment_id": 69266249, "body": "Why you think not, @AnT?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1481154306, "post_id": 41029196, "comment_id": 69266322, "body": "@koper89: In C language <code>const</code> objects are not <i>constants</i>. They cannot be used to initialize objects with static storage duration. E.g. <code>const int a = 5; static int b = a;</code> will not compile in C."}, {"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "edited": false, "score": 0, "creation_date": 1481154417, "post_id": 41029196, "comment_id": 69266357, "body": "Yep but two separately will compile."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1481154461, "post_id": 41029196, "comment_id": 69266375, "body": "@koper89: Um... What does &quot;two separately&quot; mean? How do you &quot;separate&quot; <code>static int b = a;</code> when it relies on <code>a</code>?"}, {"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "edited": false, "score": 0, "creation_date": 1481154497, "post_id": 41029196, "comment_id": 69266389, "body": "I&#39;m saying that in my example they are not relying on each other."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1481154609, "post_id": 41029196, "comment_id": 69266433, "body": "@koper89: But the ultimate purpose of this question is to initialize the OP&#39;s <code>static foo const f</code>. The OP does not have any issues with <code>S</code> or <code>C</code>. The OP is getting an error in the declaration of <code>static foo const f</code>. What is the point of changing <code>S</code> and <code>C</code>, if it will not help with the error at all? (This is what I meant when I said that &quot;This will not achieve anything at all&quot;)."}, {"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "edited": false, "score": 0, "creation_date": 1481154656, "post_id": 41029196, "comment_id": 69266456, "body": "And I&#39;m saying replace it with mine, the other one delete and it&#39;ll work."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 2, "creation_date": 1481154738, "post_id": 41029196, "comment_id": 69266482, "body": "@koper89: Wrong. It will not. Your <code>const</code> objects cannot be used to initialize <code>static foo const f</code>. That&#39;s the whole point of my comments. Try it and see for yourself."}], "tags": [], "owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "is_accepted": false, "score": -5, "last_activity_date": 1481157798, "last_edit_date": 1481157798, "creation_date": 1481153156, "answer_id": 41029196, "question_id": 41029177, "link": "https://stackoverflow.com/questions/41029177/initializer-is-not-constant-i-know-but-i-feel-like-this-should-work-why-doe/41029196#41029196", "title": "Initializer is not constant... I know, but I feel like this should work, why doesn&#39;t it", "body": "<p>You're problem is that define does not initialise just used in preprocessor. You would need:</p>\n\n<pre><code>static const char *S = \"Testing/0\";\nstatic const char C = 't';\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 7264919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2b5ec0bfbe3f680789270bbcb36894?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Valentine", "link": "https://stackoverflow.com/users/7264919/scott-valentine"}, "edited": false, "score": 0, "creation_date": 1481154059, "post_id": 41029307, "comment_id": 69266242, "body": "Why though? If S is a const expression, how hard is it to treat S[i] as a const expression. It is literally *((&amp;S) + sizeof(S[0]) * i)"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 43, "user_id": 7264919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2b5ec0bfbe3f680789270bbcb36894?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Valentine", "link": "https://stackoverflow.com/users/7264919/scott-valentine"}, "edited": false, "score": 0, "creation_date": 1481154148, "post_id": 41029307, "comment_id": 69266266, "body": "@Scott Valentine: Yes, you are right, it should not be hard for the compiler to figure out what <code>&quot;Testing&quot;[3]</code> is in this specific case. However, the general rules of C constant expressions prohibit <code>[]</code> operator in this context. No exception is made for &quot;obvious&quot; situations."}, {"owner": {"reputation": 43, "user_id": 7264919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2b5ec0bfbe3f680789270bbcb36894?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Valentine", "link": "https://stackoverflow.com/users/7264919/scott-valentine"}, "edited": false, "score": 0, "creation_date": 1481154271, "post_id": 41029307, "comment_id": 69266309, "body": "well, I guess I&#39;m minorly hosed then... I up voted your answer, but I got no rep."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1481154496, "post_id": 41029307, "comment_id": 69266388, "body": "I think that the relevant section of the standard is ISO/IEC 9899:2011 6.6/9: &quot;The array-subscript <b>[]</b>... may be used in the creation of an address constant, but the value of an object shall not be accessed by use of these operators.&quot;"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 43, "user_id": 7264919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2b5ec0bfbe3f680789270bbcb36894?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Valentine", "link": "https://stackoverflow.com/users/7264919/scott-valentine"}, "edited": false, "score": 0, "creation_date": 1481156912, "post_id": 41029307, "comment_id": 69267144, "body": "@ScottValentine: <code>const</code> and &quot;constant&quot; are two very different things. <code>const</code> just means &quot;read-only&quot;. A constant expression is one that&#39;s required to be evaluated at compile time. An example of the difference: <code>const int r = rand();</code>."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1481160604, "post_id": 41029307, "comment_id": 69268197, "body": "@AnT-- I have added my own answer that proposes a modification to OP&#39;s <code>struct</code> as a solution to the problem. It is clear that you know your way around this stuff, and I would appreciate any thoughts that you might care to offer."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1481160897, "post_id": 41029307, "comment_id": 69268269, "body": "@David Bowling: Your answer is perfectly correct. It is just a question of whether the proposed change is acceptable for the OP."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 4, "last_activity_date": 1481154365, "last_edit_date": 1481154365, "creation_date": 1481153821, "answer_id": 41029307, "question_id": 41029177, "link": "https://stackoverflow.com/questions/41029177/initializer-is-not-constant-i-know-but-i-feel-like-this-should-work-why-doe/41029307#41029307", "title": "Initializer is not constant... I know, but I feel like this should work, why doesn&#39;t it", "body": "<p>In C language objects with static storage duration require <em>constant expressions</em> as initializers. <code>S[3]</code> is not a constant expression in C. You are basically not allowed to \"read from memory\" in constant expressions, i.e. you are not allowed to use unary <code>*</code> operator and, consequently, not allowed to use <code>[]</code> operator to read array elements.</p>\n\n<p>Meanwhile, <code>'t'</code> is immediately a constant, which is why your code compiles when you replace <code>S[3]</code> with <code>C</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1481218171, "post_id": 41029404, "comment_id": 69298424, "body": "More significant than than the fact that some compilers have &quot;allowed&quot; modification of string literals is the fact that some compilers have documented behavior in such cases even though the Standard does not require them to do so."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1481155014, "last_edit_date": 1481155014, "creation_date": 1481154363, "answer_id": 41029404, "question_id": 41029177, "link": "https://stackoverflow.com/questions/41029177/initializer-is-not-constant-i-know-but-i-feel-like-this-should-work-why-doe/41029404#41029404", "title": "Initializer is not constant... I know, but I feel like this should work, why doesn&#39;t it", "body": "<p>From C11 6.7.9/4 (Initialization - Constraints):</p>\n\n<blockquote>\n  <p>All the expressions in an initializer for an object that has static or thread storage duration shall be constant expressions or string literals.</p>\n</blockquote>\n\n<p>The definition of <em>constant expression</em> is found in 6.6. Specifically 6.6/7:</p>\n\n<blockquote>\n  <p>More latitude is permitted for constant expressions in initializers. Such a constant expression shall be, or evaluate to, one of the following:</p>\n  \n  <ul>\n  <li>an arithmetic constant expression,</li>\n  <li>a null pointer constant,</li>\n  <li>an address constant, or</li>\n  <li>an address constant for a complete object type plus or minus an integer constant expression.</li>\n  </ul>\n</blockquote>\n\n<p>However <code>S[3]</code> is none of those. An arithmetic constant expression is only allowed to have operands that are constants of arithmetic type (in brief), however <code>S[3]</code> means <code>*(S + 3)</code> which has a pointer operand.</p>\n\n<p>Using <code>'t'</code> as initializer is fine, that is a character constant and therefore an arithmetic constant expression.</p>\n\n<p>Note: <em>constant expression</em> has a quite separate meaning to \"<code>const</code>-qualified variable\". Constant expressions are never <code>const</code>-qualified and are a disjoint set from variables and objects.</p>\n\n<hr>\n\n<p>Possibly the language could have been defined so that indexing a string literal with a valid index counts as a constant expression, but it wasn't.</p>\n\n<p>Note that string literals are not constant expressions (although their address is). They are arrays of non-const <code>char</code> . There is also a rule that it is undefined behaviour to modify a string literal. So portable code has to treat a string literal as if it were <code>const</code>, although technically it is not. Historically some compilers have allowed modification of string literals.</p>\n"}, {"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 0, "last_activity_date": 1481160066, "creation_date": 1481160066, "answer_id": 41030231, "question_id": 41029177, "link": "https://stackoverflow.com/questions/41029177/initializer-is-not-constant-i-know-but-i-feel-like-this-should-work-why-doe/41030231#41030231", "title": "Initializer is not constant... I know, but I feel like this should work, why doesn&#39;t it", "body": "<p>I am not sure what your eventual goal is, but maybe this small change in your <code>struct</code> can help. According to the standard:</p>\n\n<blockquote>\n  <p>The array-subscript <strong>[ ]</strong> and member-access <strong>.</strong> and <strong>-></strong>\n  operators, the address <strong>&amp;</strong> and indirection <strong>*</strong> unary operators,\n  and pointer casts may be used in the creation of an address constant,\n  but the value of an object shall not be accessed by the use of these\n  operators.<br>\n  ISO/IEC 9899:2011 6.6/9</p>\n</blockquote>\n\n<p>In the code from your example, you attempt to use the value of <code>S[3]</code> in an initializer as a constant expression. The above shows why this is not possible, but you can use the <em>address</em> of <code>S[3]</code> as a constant expression:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define S \"Testing\"\n#define C 't'\ntypedef struct {\n    char const * const s;\n    char const * const c;\n} foo;\nint main(int argc, char **argv)\n{\n    static foo const f = {\n        .s = S,\n        .c = &amp;S[3],\n    };\n    printf(\"s = %s, c = %c\\n\", f.s, *(f.c));\n    return 0;\n}\n</code></pre>\n\n<p>When I compile and run this code, the output is:</p>\n\n<pre><code>s = Testing, c = t\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7264919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2b5ec0bfbe3f680789270bbcb36894?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Valentine", "link": "https://stackoverflow.com/users/7264919/scott-valentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 41029307, "answer_count": 4, "score": 3, "last_activity_date": 1481160066, "creation_date": 1481153049, "last_edit_date": 1481156622, "question_id": 41029177, "link": "https://stackoverflow.com/questions/41029177/initializer-is-not-constant-i-know-but-i-feel-like-this-should-work-why-doe", "title": "Initializer is not constant... I know, but I feel like this should work, why doesn&#39;t it", "body": "<p>The following code compiles fine if I remove the static qualifier, but I don't understand why it doesn't work otherwise. I can see the string in the .rodata section (when compiling without the static qualifier), and the final assembly just loads pointers appropriately before calling printf.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define S \"Testing\"\n#define C 't'\ntypedef struct {\n    char const * const s;\n    char const c;\n} foo;\nint main(int argc, char **argv)\n{\n    static foo const f = {\n        .s = S,\n        .c = S[3],\n    };\n    printf(\"s = %s, c = %c\\n\", f.s, f.c);\n    return 0;\n}\n</code></pre>\n\n<p>Also, it compiles fine with the static qualifier if I use:</p>\n\n<pre><code>.c = C,\n</code></pre>\n\n<p>Interestingly, the assembly looks identical (yeah, gcc hijacks the 't' from \"Testing\")</p>\n\n<p>This snippet is just to demonstrate the specific example I'm encountering in a much more complex problem. Why can't the compiler treat a string literal [] element as a constant, when clearly it does?</p>\n\n<p>BTW, compiled with gcc 5.4 with only -O2</p>\n\n<p>Edit: To clarify, the problem is the initialization of f.c</p>\n\n<p>Edit: Thanks for the insights everyone. In summary, the preprocessor can't do anything with strings, which is lame. If I actually implement what I am trying to do in the scope of a function, the compiler (with optimization) will eventually process everything down to constants in the .rodata section, but I can't accomplish the same at the global scope, unfortunately.</p>\n\n<p>Solution: Write a custom python script (or whatever your favorite scripting language is) to generate code, or use c++</p>\n"}, {"tags": ["c", "cygwin", "c-preprocessor", "typedef", "ksh"], "comments": [{"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "edited": false, "score": 0, "creation_date": 1481153033, "post_id": 41029160, "comment_id": 69265861, "body": "Maybe use #undef ?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1492152066, "post_id": 41029160, "comment_id": 73872682, "body": "Could you provide an MCVE? <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1947, "user_id": 127259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a03d0d7cef50d64a2035198c2a657a?s=128&d=identicon&r=PG&f=1", "display_name": "fpmurphy", "link": "https://stackoverflow.com/users/127259/fpmurphy"}, "is_accepted": false, "score": 1, "last_activity_date": 1518256447, "creation_date": 1518256447, "answer_id": 48719439, "question_id": 41029160, "link": "https://stackoverflow.com/questions/41029160/typedef-and-define-with-same-name/48719439#48719439", "title": "typedef and #define with same name", "body": "<p>The error was due to a change in glibc. See Red Hat Bugzilla #1477082 for more information and what changes to source files are needed.</p>\n"}], "owner": {"reputation": 29, "user_id": 2382988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2740a14617a2f467b5ee2ee7b8aea027?s=128&d=identicon&r=PG", "display_name": "Mike Trinka", "link": "https://stackoverflow.com/users/2382988/mike-trinka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1518256447, "creation_date": 1481152936, "last_edit_date": 1495541391, "question_id": 41029160, "link": "https://stackoverflow.com/questions/41029160/typedef-and-define-with-same-name", "title": "typedef and #define with same name", "body": "<p><strong>A little background:</strong></p>\n\n<p>I'm trying to port some .ksh files that I have running on Solaris to run on Windows using Cygwin.  There is a difference between the ksh implementation running on the Solaris box and the pdksh implementation that is easily installable in Cygwin that deals with subshells - you can check <a href=\"https://stackoverflow.com/questions/74372/how-to-overcome-an-incompatibility-between-the-ksh-on-linux-vs-that-installed-o\">this question</a> for the details if you'd like.</p>\n\n<p>Because of this difference, I'm trying to build the AST toolkit found <a href=\"https://github.com/att/ast\" rel=\"nofollow noreferrer\">here</a> because the binaries are no longer available from AT&amp;T according to <a href=\"https://unix.stackexchange.com/questions/246338/is-the-shell-ksh93-dead\">this question</a>.</p>\n\n<p><strong>My Question:</strong></p>\n\n<p>When I try to build according to the instructions on the GitHub site, I wind up with an error compiling a file called fastfind.c:</p>\n\n<pre><code>+ cc -D_BLD_STATIC -D_BLD_DLL -D_BLD_ast -I. -I/ast-master/src/lib/libast -Icomp -I/ast-master/src/lib/libast/comp -Imisc -I/ast-master/src/lib/libast/misc -Iinclude -I/ast-master/src/lib/libast/include -Istd -I/ast-master/src/lib/libast/std -D_PACKAGE_ast -c /ast-master/src/lib/libast/misc/fastfind.c,\nIn file included from /ast-master/src/lib/libast/std/stdio.h:22:0,\n    from ./ast_wchar.h:87,\n    from /ast-master/src/lib/libast/include/regex.h:39,\n    from /ast-master/src/lib/libast/misc/findlib.h:35,\n    from /ast-master/src/lib/libast/misc/fastfind.c:77:\n./ast_stdio.h:82:15: error: conflicting types for '_sfio_FILE'\n #define FILE  _sfio_FILE\n               ^\n./ast_stdio.h:80:24: note: previous declaration of '_sfio_FILE' was here\n typedef struct _sfio_s _sfio_FILE;\n                        ^\nmamake [lib/libast]: *** exit code 1 making fastfind.o\n</code></pre>\n\n<p>Lines 80-82 of the file ast_stdio.h are as follows:</p>\n\n<pre><code>80: typedef struct _sfio_s _sfio_FILE;\n81:\n82: #define FILE        _sfio_FILE\n</code></pre>\n\n<p>Also, the top of the ast_stdio.h file have this:</p>\n\n<pre><code>/* : : generated by proto : : */\n/* : : generated from /ast-master/src/lib/libast/features/stdio by iffe version 2012-07-17 : : */\n</code></pre>\n\n<p>Lastly, here's my relevant cc information:</p>\n\n<pre><code>$ cc --version\ncc (GCC) 5.4.0\n</code></pre>\n\n<p>A little disclaimer: my C is rusty as I've been a Java guy for the past 14 years.  My understanding is that the #define directive gets evaluated by the preprocessor, so line 82 would essentially replace the string FILE with _sfio_FILE in the code, and the typedef line wouldn't be evaluated until actual compilation.</p>\n\n<p>Obviously I'm wrong, or this error wouldn't be happening.  And obviously this code compiles for someone, or it wouldn't have been released this way.  Any insights as to what's going on here and how I can make this file compile are appreciated.  I found <a href=\"https://stackoverflow.com/questions/17918380/typedef-and-enum-with-same-name\">this question</a> which seems close to what I'm asking, but there's either something different between my case and that question's, or my C brain is not able to comprehend why that question should cover my particular situation.</p>\n\n<p>Thanks for your time!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1481152989, "post_id": 41029117, "comment_id": 69265847, "body": "How do you detect the process doesn&#39;t exist yet? There is no error handling in your code."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1481153510, "post_id": 41029117, "comment_id": 69266044, "body": "Sometimes or always? <code>pidg2</code> will always be 0 in the parent process for example."}, {"owner": {"reputation": 53, "user_id": 7254389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f0617cc835cfaeaec0aa9be96de06a2?s=128&d=identicon&r=PG&f=1", "display_name": "Daphne", "link": "https://stackoverflow.com/users/7254389/daphne"}, "edited": false, "score": 0, "creation_date": 1481153605, "post_id": 41029117, "comment_id": 69266084, "body": "I mean always. All processes have to be created before sending signals."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481156017, "post_id": 41029117, "comment_id": 69266887, "body": "If you need to wait for the grandchild processes to be created, you need some kind of communication from the child to the parent, so it can send the grandchild&#39;s PID. Shared memory and a mutex would be a way to do this."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1527596174, "creation_date": 1527596174, "answer_id": 50584194, "question_id": 41029117, "link": "https://stackoverflow.com/questions/41029117/how-could-i-know-if-all-processes-have-been-already-created-before-sending-signa/50584194#50584194", "title": "How could I know if all processes have been already created before sending signals?", "body": "<p>Preliminary note: The child code parts in your example program fall through to their parent's code, which is certainly not intended; I'll assume something like <code>return sleep(5);</code> at the end of each block. Also note that the <code>printf()</code>s may malfunction with <code>fork()</code>s and buffered output.</p>\n\n<p>Barmar wrote:</p>\n\n<blockquote>\n  <p>If you need to wait for the grandchild processes to be created, you need some kind of communication from the child to the parent, so it can send the grandchild's PID. Shared memory and a mutex would be a way to do this.</p>\n</blockquote>\n\n<p>That's absolutely correct. (The direct children are no problem, since the parent knows their PIDs.) Another way to communicate the grandchild's PID is a pipe; your example <code>main()</code> could become:</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    int status;\n    sigaction(SIGUSR1, &amp;(struct sigaction){.sa_handler = handler}, NULL);\n    setbuf(stdout, NULL);   // printf() may malfunction without this\n    pidc1 = fork();\n    if (pidc1 == 0)\n    {\n        printf(\"Child 1\\n\");    return sleep(5);\n    }\n    int pipefd[2];\n    pipe(pipefd);   // for communicating the grandson's PID\n    pidc2 = fork();\n    if (pidc2 == 0)\n    {\n         printf(\"Child 2\\n\");\n         pidg2 = fork();\n         if (pidg2 == 0)\n         {\n             printf(\"Grandson 2\\n\");   return sleep(5);\n         }\n         write(pipefd[1], &amp;pidg2, sizeof pidg2);    // write pidg2 to write end\n         wait(&amp;status);    return sleep(5);\n    }\n    pidc3 = fork();\n    if(pidc3 == 0)\n    {\n        printf(\"Child 3\\n\");    return sleep(5);\n    }\n    read(pipefd[0], &amp;pidg2, sizeof pidg2);  // read pidg2 from pipe's read end\n    kill(pidg2, SIGUSR1);\n    kill(pidc3, SIGUSR1);\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7254389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f0617cc835cfaeaec0aa9be96de06a2?s=128&d=identicon&r=PG&f=1", "display_name": "Daphne", "link": "https://stackoverflow.com/users/7254389/daphne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527596174, "creation_date": 1481152647, "last_edit_date": 1481153217, "question_id": 41029117, "link": "https://stackoverflow.com/questions/41029117/how-could-i-know-if-all-processes-have-been-already-created-before-sending-signa", "title": "How could I know if all processes have been already created before sending signals?", "body": "<p>I'm writing a Unix program where the parent process has to send signals to children and a grandson. How could I know if all processes have been already created before sending signals? Because sometimes they don't exist yet. Thanks a lot!</p>\n\n<pre><code>void t(int sig)\n{\n   kill(SIGKILL, pidc1);\n   kill(SIGKILL, pidc2);\n   kill(SIGKILL, pidg2);\n   kill(SIGKILL, pidc3);\n}\n\nvoid handler()\n{\n    write(1, \"Signal SIGUSR1\\n\", 15);\n}\n\npid_t pidc1, pidc2, pidc3, pidg2;\n\nint main(int argc, char **argv)\n{\n    struct sigaction action;\n    int status;\n\n    action.sa_flags = 0;\n    action.sa_handler = handler;\n    sigaction(SIGUSR1, &amp;action, NULL);\n\n    pidc1 = fork();\n    if(pidc1 == 0)\n    {\n        printf(\"Child 1\\n\");\n    }\n    pidc2 = fork();\n    if(pidc2 == 0)\n    {\n         printf(\"Child 2\\n\");\n         pidg2 = fork();\n         if(pidg2 == 0)\n         {\n             printf(\"Grandson 2\\n\");\n         }\n         wait(&amp;status);\n    }\n    pidc3 = fork();\n    if(pidc3 == 0)\n    {\n        printf(\"Child 3\\n\");\n    }\n\n    kill(pidg2, SIGUSR1);\n    kill(pidc3, SIGUSR1);\n    signal(SIGALRM, t);\n    alarm(10);\n    wait(&amp;status);\n}\n</code></pre>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1481151574, "post_id": 41028880, "comment_id": 69265288, "body": "We can&#39;t debug incomplete code. Your problem likely stems from code not shown. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1481151743, "post_id": 41028880, "comment_id": 69265361, "body": "<code>(*ptr).Name</code> is more commonly written as <code>ptr-&gt;Name</code>"}, {"owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "edited": false, "score": 0, "creation_date": 1481152009, "post_id": 41028880, "comment_id": 69265470, "body": "oh wow i didn&#39;t see the record+1 being incorrect thank you."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481152109, "post_id": 41028880, "comment_id": 69265514, "body": "<code>strlen(record+1)</code> has the <i>opposite</i> effect to that intended ;) that is, one shorter."}, {"owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "edited": false, "score": 0, "creation_date": 1481153067, "post_id": 41028880, "comment_id": 69265881, "body": "Thank you, everything works as intended!"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481153421, "post_id": 41028880, "comment_id": 69266015, "body": "<a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc in C</a>"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1481153395, "post_id": 41029176, "comment_id": 69265997, "body": "<code>ptr-&gt;.Name</code> should be <code>ptr-&gt;Name</code>"}], "tags": [], "owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "is_accepted": false, "score": 2, "last_activity_date": 1481153546, "last_edit_date": 1481153546, "creation_date": 1481153047, "answer_id": 41029176, "question_id": 41028880, "link": "https://stackoverflow.com/questions/41028880/hanging-program-after-trying-to-free-allocated-memory/41029176#41029176", "title": "Hanging program after trying to free allocated memory", "body": "<pre><code>(*ptr).Name = (char*)malloc(strlen(record+1)); //This is the problem!\nstrcpy((*ptr).Name, record); \nfree((*ptr).Name); //problem area              //Better practice to use free(ptr-&gt;Name\n</code></pre>\n\n<p>Fix:</p>\n\n<pre><code>ptr-&gt;Name = (char*)malloc(strlen(record)+1);   //(record+1) in previouse code was doing \n                                                 //the opposite of what it was intended to do\nstrcpy(ptr-&gt;Name, record); \nfree(ptr-&gt;Name); \n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "closed_date": 1481166911, "answer_count": 1, "score": -2, "last_activity_date": 1481153546, "creation_date": 1481151475, "last_edit_date": 1481151592, "question_id": 41028880, "link": "https://stackoverflow.com/questions/41028880/hanging-program-after-trying-to-free-allocated-memory", "closed_reason": "Not suitable for this site", "title": "Hanging program after trying to free allocated memory", "body": "<p>I'm not quite sure what is wrong with my current program and I have reach a bit of a road block:</p>\n\n<pre><code>(*ptr).Name = (char*)malloc(strlen(record+1));\nstrcpy((*ptr).Name, record); \nfree((*ptr).Name); //problem area\n</code></pre>\n\n<p>*ptr is a pointer that points to a structure that has various fields. After I copy some data into the Name field I want to free my allocated memory. When I step through my program I get no errors rather just a hanging program that will not continue after I try and free the memory. Any ideas? Thank you. </p>\n"}, {"tags": ["c", "pipe", "fork"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481151273, "post_id": 41028807, "comment_id": 69265172, "body": "You&#39;re not writing to <code>stdout</code> in the parent program, you&#39;re writing to the pipe. But you do need to read from <code>stdin</code> in the child."}, {"owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481151430, "post_id": 41028807, "comment_id": 69265234, "body": "Just a mistake copying, sorry. Fixed it!"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481151450, "post_id": 41028807, "comment_id": 69265244, "body": "You&#39;re still writing to <code>f1[1]</code>, not <code>STDOUT_FILENO</code>."}, {"owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481151583, "post_id": 41028807, "comment_id": 69265292, "body": "I duplicated the f1[1] to the stdout."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481151636, "post_id": 41028807, "comment_id": 69265312, "body": "I know, but you didn&#39;t write to <code>STDOUT</code>."}, {"owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481151829, "post_id": 41028807, "comment_id": 69265401, "body": "I&#39;m not supposed to write to STDOUT, I&#39;m supposed to write to the pipe so the child reads from it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481152059, "post_id": 41028807, "comment_id": 69265497, "body": "That&#39;s my point. Since you&#39;re not writing to STDOUT, there&#39;s no point in duplicating to it."}, {"owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481152243, "post_id": 41028807, "comment_id": 69265571, "body": "Can you point me to the exact insctruction you&#39;re talking about?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481152326, "post_id": 41028807, "comment_id": 69265604, "body": "The program does <code>write(f1[1], data, sizeof(data));</code> but the question says <code>the data I write in STDOUT</code>. The question doesn&#39;t describe what the program does."}, {"owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481152450, "post_id": 41028807, "comment_id": 69265649, "body": "I think I&#39;m just confused between the two words, I mean when I write in the pipe(supposdly writing in STDIN), the child reads from the STDOUT, is that it?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481152595, "post_id": 41028807, "comment_id": 69265699, "body": "When you write to the pipe, the child reads from <code>STDIN</code>. The fact that you duplicated the pipe to <code>STDOUT</code> in the parent is totally irrelevant."}], "answers": [{"comments": [{"owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "edited": false, "score": 0, "creation_date": 1481151538, "post_id": 41028866, "comment_id": 69265266, "body": "That&#39;s what I did, I read from the stdin in the child program and it works fine if I execute the program itself, but if I use the main program, nothing happens, it just exists."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "edited": false, "score": 0, "creation_date": 1481151720, "post_id": 41028866, "comment_id": 69265348, "body": "There&#39;s no <code>c</code> in <code>Hello World!</code>"}, {"owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "edited": false, "score": 0, "creation_date": 1481152542, "post_id": 41028866, "comment_id": 69265675, "body": "If I use two pipes, where parent write in the first and child reads from the first, then child writes in the second and parent reads from the second, could there be any errors when executing the program ./2 as it reads directly from STDIN?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "edited": false, "score": 0, "creation_date": 1481152670, "post_id": 41028866, "comment_id": 69265731, "body": "When you try to use two pipes like that, you can run into deadlock situations if you&#39;re not careful."}, {"owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "edited": false, "score": 0, "creation_date": 1481152878, "post_id": 41028866, "comment_id": 69265812, "body": "Considering the code above, what do I exactly do to make the child write to the parent in the second pipe?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "edited": false, "score": 0, "creation_date": 1481153097, "post_id": 41028866, "comment_id": 69265892, "body": "You would need <code>int f2[2]; pipe(f2);</code>. In the child you do <code>dup2(f2[1], STDOUT_FILENO)</code>, and the parent reads from <code>f2[0]</code>."}, {"owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "edited": false, "score": 0, "creation_date": 1481153417, "post_id": 41028866, "comment_id": 69266011, "body": "I guess I wasn&#39;t careful, running the program always ends with a deadlock."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "edited": false, "score": 0, "creation_date": 1481153496, "post_id": 41028866, "comment_id": 69266038, "body": "Turn off stdio output buffering with <code>setbuf()</code>"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1481151979, "last_edit_date": 1481151979, "creation_date": 1481151391, "answer_id": 41028866, "question_id": 41028807, "link": "https://stackoverflow.com/questions/41028807/how-to-use-stdin-data-in-an-external-program-through-a-pipe/41028866#41028866", "title": "How to use STDIN data in an external program through a pipe", "body": "<p>Since you duplicate the pipe to <code>STDIN_FILENO</code>, you need to read from <code>stdin</code> in the child program to get what the parent is writing to the pipe.</p>\n\n<p>Also, you need to move the <code>close(f1[0]);</code> call to <strong>before</strong> the call to <code>execlp()</code>. If the exec is successful, nothing after it in the original program runs.</p>\n\n<p>And if you want to see output in the child program, you should look for a character that's in <code>Hello World!</code>:</p>\n\n<pre><code>if (DATA[i] == 'o') {\n    printf(\"found\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481151979, "creation_date": 1481151064, "last_edit_date": 1481151389, "question_id": 41028807, "link": "https://stackoverflow.com/questions/41028807/how-to-use-stdin-data-in-an-external-program-through-a-pipe", "title": "How to use STDIN data in an external program through a pipe", "body": "<p>I have this main program:</p>\n\n<pre><code>char data[1024]=\"Hello World!\";\nint main(int argc,char *argv[])\n{\n    pid_t pid;\n    int f1[2];\n    pipe(f1);\n    if((pid=fork())==0)\n    {\n        close(f1[1]);\n        dup2(f1[0], STDIN_FILENO);\n        if((execlp(\"./2\",\"./2\",NULL))==-1) printf(\"error\");\n        close(f1[0]);\n    }\n    else\n    {\n        close(f1[0]);\n        dup2(f1[1],STDOUT_FILENO);\n        write(f1[1], data, sizeof(data));\n        close(f1[1]);\n        wait(NULL);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>and the 2.c program:</p>\n\n<pre><code>int main(int argc,char *argv[])\n{\n    char DATA[1024];\n    //sprintf(DATA,\"J'ai lu %s\",argv[1]);\n    //read(0,DATA,sizeof(DATA));\n    int taille=strlen(DATA);\n    int i;\n    for(i=0;i&lt;taille;i++)\n    {\n        if(DATA[i]=='c')\n        {\n            printf(\"found\");\n        }\n    }   \n}\n</code></pre>\n\n<p>If I want to use the data I write in STDOUT by the parent in the program executed by the child, do I have to read from the STDIN in the exec program or do I have to pass the data as an argument in the execlp? Or maybe something else?</p>\n"}, {"tags": ["c", "arrays", "string", "buffer-overflow"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 6, "creation_date": 1481150944, "post_id": 41028752, "comment_id": 69265018, "body": "That&#39;s just how the language is specified."}, {"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "edited": false, "score": 0, "creation_date": 1481151043, "post_id": 41028752, "comment_id": 69265071, "body": "I think it&#39;s because you pass it as string, and string has to be NULL terminated so it may be undefined behaviour but not sure. So in general I think both are wrong."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1481151238, "post_id": 41028752, "comment_id": 69265155, "body": "<code>void main()</code> is wrong; it should be <code>int main(void)</code>. <code>char wbuf[16] = &quot;0123456789abcdef&quot;;</code> is valid, as kaylum&#39;s answer explains. <code>printf(&quot;%s\\n&quot;, wbuf);</code> is legal but has undefined behavior, because <code>wbuf</code> does not contain a (null-terminated) string.\\"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1481151279, "post_id": 41028752, "comment_id": 69265174, "body": "The object to be initialized is a charcter array (size=16); the string constant used as an initializer is ... a string. What are you initializing? The object. What is its size? 16. You told the compiler it should have size=16."}], "answers": [{"comments": [{"owner": {"reputation": 459, "user_id": 2950979, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b1ac6037b68b0347e437a7006cf6a1d1?s=128&d=identicon&r=PG&f=1", "display_name": "jithu83", "link": "https://stackoverflow.com/users/2950979/jithu83"}, "edited": false, "score": 0, "creation_date": 1481155440, "post_id": 41028805, "comment_id": 69266704, "body": "Does the spec say anything about implicitly  adding Null terminators to all  string initialization ? If I had an explicit \\0 like (<i>char wbuf[16] = &quot;0123456789abcdef\\0&quot;</i> ) then the compiler would have warned I guess."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1481163486, "post_id": 41028805, "comment_id": 69268921, "body": "you would think the compiler would warn. Seems like an odd design choice to have one length generate a valid c string and the other generate an invalid one, without muttering a word"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 459, "user_id": 2950979, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b1ac6037b68b0347e437a7006cf6a1d1?s=128&d=identicon&r=PG&f=1", "display_name": "jithu83", "link": "https://stackoverflow.com/users/2950979/jithu83"}, "edited": false, "score": 1, "creation_date": 1588251842, "post_id": 41028805, "comment_id": 108831052, "body": "@jithu83: All four mainstream x86 compilers <i>do</i> warn these days, by default without even needing <code>-Wall</code>  <a href=\"https://godbolt.org/z/WMK2SR\" rel=\"nofollow noreferrer\">godbolt.org/z/WMK2SR</a> shows GCC/clang/ICC/MSVC.  ICC for some reason errors even in C mode.  (This code is illegal in C++.)"}], "tags": [], "owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "is_accepted": true, "score": 7, "last_activity_date": 1481156575, "last_edit_date": 1481156575, "creation_date": 1481151059, "answer_id": 41028805, "question_id": 41028752, "link": "https://stackoverflow.com/questions/41028752/what-explains-this-behavior-of-c-compiler-w-r-t-string-initialization/41028805#41028805", "title": "What explains this behavior of C compiler w.r.t string initialization?", "body": "<p>From the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C11 standard</a> section 6.7.9 on Initialization (emphasis mine):</p>\n\n<blockquote>\n  <p>An array of character type may be initialized by a character string\n  literal or UTF\u22128 string literal, optionally enclosed in braces. \n  Successive bytes of the string literal (including the terminating null\n  character <strong>if there is room</strong> or if the array is of unknown size)\n  initialize the elements of the array.</p>\n</blockquote>\n\n<p>So the compiler is conforming exactly to spec.</p>\n"}, {"comments": [{"owner": {"reputation": 459, "user_id": 2950979, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b1ac6037b68b0347e437a7006cf6a1d1?s=128&d=identicon&r=PG&f=1", "display_name": "jithu83", "link": "https://stackoverflow.com/users/2950979/jithu83"}, "edited": false, "score": 0, "creation_date": 1481154175, "post_id": 41029054, "comment_id": 69266275, "body": "Interesting to note that C++ prevents case1 (null termination from getting lost)"}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 3, "last_activity_date": 1481152634, "last_edit_date": 1495540378, "creation_date": 1481152329, "answer_id": 41029054, "question_id": 41028752, "link": "https://stackoverflow.com/questions/41028752/what-explains-this-behavior-of-c-compiler-w-r-t-string-initialization/41029054#41029054", "title": "What explains this behavior of C compiler w.r.t string initialization?", "body": "<p>In C language <code>char</code> arrays with string literal initializers can be used to define both regular zero-terminated strings as well as so called <em>fixed-width strings</em> (see <a href=\"https://stackoverflow.com/questions/2886931/difference-fixed-width-strings-and-zero-terminated-strings\">difference fixed width strings and zero-terminated strings</a>). The idea of fixed-width strings is largely forgotten, but it had its role at the early ages of C language and Unix OS.</p>\n\n<p>Fixed-width string conventions allow an array of, say, 8 <code>char</code>s to contain a fixed-width string of length 8 (without a zero terminator)</p>\n\n<pre><code>char fws_hello[8] = \"Hello!!!\";\n/* `fws_hello` is a valid fixed-width string for width 8 */\n</code></pre>\n\n<p>It is most likely that the permission to have that terminating zero to \"fall off the end of the array\" is there in the language to support such strings.</p>\n\n<p>Another language feature - all-or-nothing approach to initialization - can also be seen as serving the needs of fixed-width strings</p>\n\n<pre><code>char fws_hi[8] = \"Hi\";\n/* `fws_hi` is padded with zeros all the way to the very end of \n    the array, which makes it a valid fixed-width string for width 8 */\n</code></pre>\n\n<p>I'd guess that C++ no longer saw the need for such string format, which is what allowed it to tighten its initialization rules and prevent the terminating zero from getting lost.</p>\n"}], "owner": {"reputation": 459, "user_id": 2950979, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b1ac6037b68b0347e437a7006cf6a1d1?s=128&d=identicon&r=PG&f=1", "display_name": "jithu83", "link": "https://stackoverflow.com/users/2950979/jithu83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 41028805, "answer_count": 2, "score": 0, "last_activity_date": 1481163161, "creation_date": 1481150777, "last_edit_date": 1481163161, "question_id": 41028752, "link": "https://stackoverflow.com/questions/41028752/what-explains-this-behavior-of-c-compiler-w-r-t-string-initialization", "title": "What explains this behavior of C compiler w.r.t string initialization?", "body": "<p>The following code doesn't generate a null terminator</p>\n\n<pre><code>/* Case 1 */\n#include &lt;stdio.h&gt;\nvoid main () {\n    char wbuf[16] = \"0123456789abcdef\";\n    printf(\"%s\\n\", wbuf);\n}\n</code></pre>\n\n<p>See the relevant parts of the dis-assembly</p>\n\n<pre><code>0x4005b4 &lt;main+23&gt;:  movabs $0x3736353433323130,%rax\n0x4005be &lt;main+33&gt;:  mov    %rax,-0x20(%rbp)\n0x4005c2 &lt;main+37&gt;:  movabs $0x6665646362613938,%rax\n0x4005cc &lt;main+47&gt;:  mov    %rax,-0x18(%rbp)\n0x4005d0 &lt;main+51&gt;:  lea    -0x20(%rbp),%rax ---&gt;prinft related\n0x4005d4 &lt;main+55&gt;:  mov    %rax,%rdi\n0x4005d7 &lt;main+58&gt;:  callq  0x400470 &lt;puts@plt&gt;\n</code></pre>\n\n<p>Whereas the following code generates one:</p>\n\n<pre><code>/* Case 2 */\n#include &lt;stdio.h&gt;\nvoid main () {\n    char wbuf[17] = \"0123456789abcdef\";\n    printf(\"%s\\n\", wbuf);\n}\n</code></pre>\n\n<p>Again see the relevant parts of the dis-assembly</p>\n\n<pre><code>0x4005b4 &lt;main+23&gt;:  movabs $0x3736353433323130,%rax\n0x4005be &lt;main+33&gt;:  mov    %rax,-0x20(%rbp)\n0x4005c2 &lt;main+37&gt;:  movabs $0x6665646362613938,%rax\n0x4005cc &lt;main+47&gt;:  mov    %rax,-0x18(%rbp)\n0x4005d0 &lt;main+51&gt;:  movb   $0x0,-0x10(%rbp) &gt;&gt;&gt;&gt;&gt;&gt; Null terminator comes here\n0x4005d4 &lt;main+55&gt;:  lea    -0x20(%rbp),%rax  ---&gt;prinft related\n0x4005d8 &lt;main+59&gt;:  mov    %rax,%rdi\n0x4005db &lt;main+62&gt;:  callq  0x400470 &lt;puts@plt&gt;\n</code></pre>\n\n<p>I would assume a string intialization like <code>char wbuf[xxx] = \"yyyy\"</code>  to add a null terminator, like in the second case. However the following questions linger :</p>\n\n<ol>\n<li>Why doesn't the compiler warn <em>\"too long initialization\"</em> in the first case rather\nthan silently avoid the null terminator. One more character like <code>char wbuf[16] = \"0123456789abcdef\\0\"</code> triggers <em>warning: initializer-string for array of chars is too long</em> .</li>\n<li>Would this behavior change across compilers. I was using <em>gcc on\nubuntu</em> and was compiling with <em>O0</em> option</li>\n<li>Why doesn't it behave consistently in 1 and 2, for e.g it could have\nblindly written past 16 in case1 and added Null terminator ?</li>\n</ol>\n\n<p>`</p>\n"}, {"tags": ["c", "process", "sequence", "dup2", "dup"], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1481150923, "post_id": 41028696, "comment_id": 69265008, "body": "<code>dup()</code> does use the first available descriptor. His code is how things were done before <code>dup2()</code> was added."}, {"owner": {"reputation": 649, "user_id": 5602491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2426d2645029b0fa49495a956020ee66?s=128&d=identicon&r=PG&f=1", "display_name": "gilez", "link": "https://stackoverflow.com/users/5602491/gilez"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481151316, "post_id": 41028696, "comment_id": 69265186, "body": "@Barmar, I think the confusion is over what &quot;first available&quot; means. Is it 1 because that&#39;s closed, or 4 because that&#39;s never been used?"}, {"owner": {"reputation": 649, "user_id": 5602491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2426d2645029b0fa49495a956020ee66?s=128&d=identicon&r=PG&f=1", "display_name": "gilez", "link": "https://stackoverflow.com/users/5602491/gilez"}, "reply_to_user": {"reputation": 328, "user_id": 6762142, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/70f0ddb770d4f893fed76e34dae7bfdb?s=128&d=identicon&r=PG&f=1", "display_name": "posixKing", "link": "https://stackoverflow.com/users/6762142/posixking"}, "edited": false, "score": 0, "creation_date": 1481151435, "post_id": 41028696, "comment_id": 69265235, "body": "@posixKing, turns out it&#39;s using 4 on my system, and perhaps OP&#39;s. Why &quot;should&quot;?  On linux the description in the man page is not precise."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481151524, "post_id": 41028696, "comment_id": 69265261, "body": "On my system (OS X) the man page says &quot;the lowest numbered descriptor currently      not in use by the process.&quot;"}, {"owner": {"reputation": 649, "user_id": 5602491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2426d2645029b0fa49495a956020ee66?s=128&d=identicon&r=PG&f=1", "display_name": "gilez", "link": "https://stackoverflow.com/users/5602491/gilez"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481151712, "post_id": 41028696, "comment_id": 69265342, "body": "@Barmar, that is similar to my Linux system. But it&#39;s not doing what we seem to expect. Does it open 1 or 4 on your system? See <a href=\"http://pastebin.com/tQbGrMLe\" rel=\"nofollow noreferrer\">pastebin.com/tQbGrMLe</a> for a compilable copy."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481151812, "post_id": 41028696, "comment_id": 69265392, "body": "Your program prints <code>fd</code>, not what <code>dup()</code> returns."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481152129, "post_id": 41028696, "comment_id": 69265524, "body": "However, you&#39;re right that <code>dup2()</code> is preferred. Otherwise, you have to depend on knowing that <code>stdin</code> hasn&#39;t been closed."}], "tags": [], "owner": {"reputation": 649, "user_id": 5602491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2426d2645029b0fa49495a956020ee66?s=128&d=identicon&r=PG&f=1", "display_name": "gilez", "link": "https://stackoverflow.com/users/5602491/gilez"}, "is_accepted": false, "score": 0, "last_activity_date": 1481153252, "last_edit_date": 1481153252, "creation_date": 1481150550, "answer_id": 41028696, "question_id": 41028447, "link": "https://stackoverflow.com/questions/41028447/why-doesnt-dup2-occur-in-sequential-order/41028696#41028696", "title": "Why doesn&#39;t dup2 occur in sequential order?", "body": "<p>I removed my prior answer as it's wrong.... But when you use <code>printf()</code> you're using the <code>FILE *</code> for <code>stdout</code>, inside of which there's a descriptor or something pointing to the terminal. Changing fd 1 is apparently not changing that.</p>\n\n<p>I'm getting inconsistent results with testing, so giving up here. I just want to add that putting this line just after the <code>open()</code> makes it work for me, which highlights the obscure behaviour:</p>\n\n<pre><code>printf(\"fileno is %i\\n\", fileno(stdout));\n</code></pre>\n\n<p>Don't mix <code>FILE *</code> operations such as <code>printf()</code> with file descriptor manipulation. You should use <code>write()</code> with the descriptor.</p>\n"}, {"comments": [{"owner": {"reputation": 328, "user_id": 6762142, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/70f0ddb770d4f893fed76e34dae7bfdb?s=128&d=identicon&r=PG&f=1", "display_name": "posixKing", "link": "https://stackoverflow.com/users/6762142/posixking"}, "edited": false, "score": 0, "creation_date": 1481151318, "post_id": 41028800, "comment_id": 69265187, "body": "This is what I was looking for. Thanks"}, {"owner": {"reputation": 649, "user_id": 5602491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2426d2645029b0fa49495a956020ee66?s=128&d=identicon&r=PG&f=1", "display_name": "gilez", "link": "https://stackoverflow.com/users/5602491/gilez"}, "edited": false, "score": 0, "creation_date": 1481158596, "post_id": 41028800, "comment_id": 69267673, "body": "While <code>fflush()</code> &quot;works&quot;, I suspect it&#39;s for the wrong reason. There&#39;s something more subtle going on here, as simply putting any <code>printf()</code> immediately after the <code>open()</code> also works. The problem is the mixing of file descriptors and FILE structures, which is perhaps undefined territory, meaning you might get different results on different systems. The correct way to do what you want is to <code>freopen(&quot;file.txt&quot;, &quot;w&quot;, stdout)</code>. That operation is clearly defined."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 649, "user_id": 5602491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2426d2645029b0fa49495a956020ee66?s=128&d=identicon&r=PG&f=1", "display_name": "gilez", "link": "https://stackoverflow.com/users/5602491/gilez"}, "edited": false, "score": 0, "creation_date": 1481158824, "post_id": 41028800, "comment_id": 69267744, "body": "@gilez I think as long as you flush between writing something and changing the file descriptor, you should be safe. Although I admit I&#39;m a little hesitant with this answer, because I suspect that the buffering is initialized when <code>stdin</code> is opened, not when <code>printf()</code> occurs. But it could be lazy and do it at the first write."}, {"owner": {"reputation": 649, "user_id": 5602491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2426d2645029b0fa49495a956020ee66?s=128&d=identicon&r=PG&f=1", "display_name": "gilez", "link": "https://stackoverflow.com/users/5602491/gilez"}, "edited": false, "score": 0, "creation_date": 1481160715, "post_id": 41028800, "comment_id": 69268230, "body": "@Barmar, I suspect the stdout <code>FILE *</code> is somehow not initialized completely until used, so the order of operations matters too, and my <code>printf()</code> option thus makes it &quot;work&quot;. You could be correct about the buffering too. It&#39;s all a bit dodgy :-)"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 5, "last_activity_date": 1481151030, "creation_date": 1481151030, "answer_id": 41028800, "question_id": 41028447, "link": "https://stackoverflow.com/questions/41028447/why-doesnt-dup2-occur-in-sequential-order/41028800#41028800", "title": "Why doesn&#39;t dup2 occur in sequential order?", "body": "<p>The problem may be due to output buffering. <code>stdout</code> is fully buffered if it's not writing to a terminal, so when you redirect it to the file with <code>dup()</code> it will be buffered. Try flushing the output after the <code>printf()</code>.</p>\n\n<pre><code>printf(\"This text should go into the file\\n\");\nfflush(stdout);\n</code></pre>\n"}], "owner": {"reputation": 328, "user_id": 6762142, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/70f0ddb770d4f893fed76e34dae7bfdb?s=128&d=identicon&r=PG&f=1", "display_name": "posixKing", "link": "https://stackoverflow.com/users/6762142/posixking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 41028800, "answer_count": 2, "score": 1, "last_activity_date": 1481153252, "creation_date": 1481149311, "question_id": 41028447, "link": "https://stackoverflow.com/questions/41028447/why-doesnt-dup2-occur-in-sequential-order", "title": "Why doesn&#39;t dup2 occur in sequential order?", "body": "<p>Here is a code snippet.</p>\n\n<pre><code>int saved_stdout = dup(1);\nint fd = open(\"file.txt\", O_WRONLY | O_CREAT, 0640);\n\nclose(1);\ndup(fd);\nclose(fd);\n\nprintf(\"This text should go into the file\\n\");\n\n//restore stdout\ndup2(saved_stdout, 1);\nprintf(\"stdout restore\");\n</code></pre>\n\n<p>I am trying to learn about dup and dup2. So I initially connected my file.txt to stdout. So whenever I use printf, I should be writing to file.txt instead of stdout. But I want to restore it back as well once I am done with this usage, so I use dup2 at the end as well.</p>\n\n<p>The problem is that the text \"This text should go into the file\\n\" never actually goes into the file, but gets printed on stdout. Why so? I straced for it, only to find that dup2 call occurs before that printf(\"This text...\"); statement, why so?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3697, "user_id": 1848578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7e2bfa9bcb3299428c8321c37db0560?s=128&d=identicon&r=PG", "display_name": "qxz", "link": "https://stackoverflow.com/users/1848578/qxz"}, "edited": false, "score": 0, "creation_date": 1481148648, "post_id": 41028239, "comment_id": 69264029, "body": "What line is giving you the access violation? Have you stepped through with a debugger?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7264725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2870a521c2ae524668b0a5731fb2632?s=128&d=identicon&r=PG&f=1", "display_name": "Thaeryn", "link": "https://stackoverflow.com/users/7264725/thaeryn"}, "edited": false, "score": 0, "creation_date": 1481149456, "post_id": 41028310, "comment_id": 69264382, "body": "That mostly makes a lot of sense and is so much simpler, thank you. I was wondering though, I thought to access a member of a pointer you needed the -&gt; operator?"}, {"owner": {"reputation": 1477, "user_id": 3761456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5dd6b4cdf49e95980017fe08358262?s=128&d=identicon&r=PG&f=1", "display_name": "Iluvatar", "link": "https://stackoverflow.com/users/3761456/iluvatar"}, "edited": false, "score": 0, "creation_date": 1481149641, "post_id": 41028310, "comment_id": 69264459, "body": "<code>hashTable[i]</code> is equivalent to <code>*(hashTable+i)</code>, so you don&#39;t need to dereference it again."}, {"owner": {"reputation": 23, "user_id": 7264725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2870a521c2ae524668b0a5731fb2632?s=128&d=identicon&r=PG&f=1", "display_name": "Thaeryn", "link": "https://stackoverflow.com/users/7264725/thaeryn"}, "edited": false, "score": 0, "creation_date": 1481150119, "post_id": 41028310, "comment_id": 69264677, "body": "So in this case would hashTable[i].isOccupied and *(hashTable+i)-&gt;isOccupied be identical?"}, {"owner": {"reputation": 1477, "user_id": 3761456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5dd6b4cdf49e95980017fe08358262?s=128&d=identicon&r=PG&f=1", "display_name": "Iluvatar", "link": "https://stackoverflow.com/users/3761456/iluvatar"}, "edited": false, "score": 0, "creation_date": 1481150225, "post_id": 41028310, "comment_id": 69264725, "body": "No, just <code>(*(hashTable+i)).isOccupied</code>. (I think order of operations means you need the extra parens...)"}], "tags": [], "owner": {"reputation": 5092, "user_id": 5481471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6efc50461d3521db348bf483652040?s=128&d=identicon&r=PG&f=1", "display_name": "G. Sliepen", "link": "https://stackoverflow.com/users/5481471/g-sliepen"}, "is_accepted": true, "score": 3, "last_activity_date": 1481149077, "last_edit_date": 1481149077, "creation_date": 1481148702, "answer_id": 41028310, "question_id": 41028239, "link": "https://stackoverflow.com/questions/41028239/initialising-member-elements-of-a-dynamically-allocated-array-of-structs-to-zero/41028310#41028310", "title": "Initialising member elements of a dynamically allocated array of structs to zero", "body": "<p>The problem is in this line:</p>\n\n<pre><code>*hashTable = *(tempStartingcell + (i * sizeof(HashTableCell)));\n</code></pre>\n\n<p>When you are adding an integer to a pointer, C and C++ already take into account the size of the array elements, so you should not multiply with sizeof(HashTableCell), but rather do:</p>\n\n<pre><code>*hashTable = *(tempStartingcell + i);\n</code></pre>\n\n<p>Otherwise, your extra multiplication will cause an access outside of the <code>tempStartingCell</code> array. It makes even more sense to write it like this:</p>\n\n<pre><code>*hashTable = tempStartingcell[i];\n</code></pre>\n\n<p>But there is more wrong with your code; if you just want to set <code>isOccupied</code> to zero for each element in <code>hashTable</code>, just do:</p>\n\n<pre><code>void initialiseTable(HashTableCell *hashTable, int tableSize)\n{\n    for (int i = 0; i &lt; tableSize; i++)\n        hashTable[i].isOccupied = 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7264725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2870a521c2ae524668b0a5731fb2632?s=128&d=identicon&r=PG&f=1", "display_name": "Thaeryn", "link": "https://stackoverflow.com/users/7264725/thaeryn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 41028310, "answer_count": 1, "score": 0, "last_activity_date": 1481149077, "creation_date": 1481148374, "question_id": 41028239, "link": "https://stackoverflow.com/questions/41028239/initialising-member-elements-of-a-dynamically-allocated-array-of-structs-to-zero", "title": "Initialising member elements of a dynamically allocated array of structs to zero", "body": "<p>I have had a look around but have not been able to find an answer to this question already. I am trying to create a hash table of which each element is a struct. In each struct is a variable to let the program know if the cell has been occupied, for this to work I need to set all of them to zero. The thing is it worked fine but now and then (seemingly randomly) I'd get an access violation. I thought I fixed it but when I come to grow my array the error creeps up again, leading me to believe that I have made an error. My pointer knowledge is not that good at all, so any help would be appreciated. This is what the function looks like:</p>\n\n<pre><code>HashTableCell *initialiseTable(HashTableCell *hashTable, int *tableSizePtr)\n{\nint i = 0;\nint totalSize = *tableSizePtr * sizeof(HashTableCell);\nHashTableCell *tempStartingcell;\n\ntempStartingcell = (HashTableCell*)malloc(sizeof(HashTableCell));\n*tempStartingcell = *hashTable;\n\n\nwhile (i &lt;= *tableSizePtr)\n{\n    /*we keep moving forward, need to use the first entry*/\n    *hashTable = *(tempStartingcell + (i * sizeof(HashTableCell)));\n    hashTable-&gt;isOccupied = 0;\n    i++;\n}\n\n\nfree(tempStartingcell);\n\nreturn hashTable;\n}\n</code></pre>\n\n<p>And before I malloced some space for the table and passed it in another function like so:</p>\n\n<pre><code>HashTableCell *hashTable;\nhashTable = (HashTableCell*)malloc((sizeof(HashTableCell)*tableSize));\nhashTable = initialiseTable(hashTable, tableSizePtr);\n</code></pre>\n\n<p>The idea is to start at the beginning and move along the correct number of spaces along  per iteration of the while loop. When I come to resize I merely make a new array with double the malloced space and pass it to the initialise function but this throws up an access violation error at seemingly random indexes.</p>\n\n<p>I am using VS2015 if that helps anything.</p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["c", "malloc", "valgrind"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1481148199, "post_id": 41028180, "comment_id": 69263831, "body": "Since you are not telling <i>which</i> Valgrind errors you are getting, I would assume it doesn&#39;t like the lack of <code>free</code> calls..."}, {"owner": {"reputation": 89, "user_id": 5394924, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l8lnd.jpg?s=128&g=1", "display_name": "Wesley", "link": "https://stackoverflow.com/users/5394924/wesley"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1481148285, "post_id": 41028180, "comment_id": 69263862, "body": "@EugeneSh I&#39;ll update post with valgrind errors."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1481148566, "post_id": 41028180, "comment_id": 69263996, "body": "<code>size_t sizeOfRacer = sizeof(Racer);</code> what is the intention here?"}, {"owner": {"reputation": 89, "user_id": 5394924, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l8lnd.jpg?s=128&g=1", "display_name": "Wesley", "link": "https://stackoverflow.com/users/5394924/wesley"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1481148602, "post_id": 41028180, "comment_id": 69264013, "body": "@wildplasser it was the way I was taught to simplify the code more"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1481148734, "post_id": 41028180, "comment_id": 69264078, "body": "<code>sizeof</code> never failed me. No need to wrap it into a variable. That will only introduce yet another unneeded identifier. Which will <i>not</i> simplify things."}, {"owner": {"reputation": 89, "user_id": 5394924, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l8lnd.jpg?s=128&g=1", "display_name": "Wesley", "link": "https://stackoverflow.com/users/5394924/wesley"}, "edited": false, "score": 0, "creation_date": 1481148798, "post_id": 41028180, "comment_id": 69264105, "body": "Alright thanks, but would that really be the cause of my problems?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1481148959, "post_id": 41028180, "comment_id": 69264184, "body": "Yes: it could reduce the size of your source code by maybe 25 %. Fewer lines := fewer chances to make or hide errors. and <code>nRacer-&gt;graphic = (char *)malloc(lengthOfName);</code> should be <code>nRacer-&gt;graphic = malloc(1+ lengthOfName);</code> or use strdup(name)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1481149028, "post_id": 41028180, "comment_id": 69264219, "body": "What is the point of this exercise: <code>int lengthOfRearSide = strlen(rearSide); .... strncpy(nRacer-&gt;graphic, rearSide, lengthOfRearSide + 1);</code>?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1481149180, "post_id": 41028180, "comment_id": 69264283, "body": "... and <b>never</b> use <code>strncpy()</code> until you read and understood its manual page."}, {"owner": {"reputation": 640, "user_id": 4208554, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-gBcqSc3JZr8/AAAAAAAAAAI/AAAAAAAAAFY/cyp4486Yrfg/photo.jpg?sz=128", "display_name": "Jake Psimos", "link": "https://stackoverflow.com/users/4208554/jake-psimos"}, "edited": false, "score": 0, "creation_date": 1481156224, "post_id": 41028180, "comment_id": 69266948, "body": "Always check the result of Malloc against NULL because it returns null if it failed.  Also never ever ever ever, eva Eva Eva use strcat, use strncat to avoid memory overflow exploit"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 5394924, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l8lnd.jpg?s=128&g=1", "display_name": "Wesley", "link": "https://stackoverflow.com/users/5394924/wesley"}, "edited": false, "score": 0, "creation_date": 1481151793, "post_id": 41028389, "comment_id": 69265384, "body": "So I should be only assigning either lengthOfName or lengthOfRearSide?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 89, "user_id": 5394924, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l8lnd.jpg?s=128&g=1", "display_name": "Wesley", "link": "https://stackoverflow.com/users/5394924/wesley"}, "edited": false, "score": 0, "creation_date": 1481151826, "post_id": 41028389, "comment_id": 69265399, "body": "@ShaolinGOD You should allocate enough memory for the strings you intend to store in your variables."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 3, "last_activity_date": 1481149022, "creation_date": 1481149022, "answer_id": 41028389, "question_id": 41028180, "link": "https://stackoverflow.com/questions/41028180/how-to-malloc-correctly-for-a-struct-and-certain-variables/41028389#41028389", "title": "How to malloc correctly for a struct and certain variables?", "body": "<p>I don't know why you marked line 49, but the first valgrind error complains about line 52:</p>\n\n<pre><code>==18972== Invalid write of size 1\n==18972==    at 0x4C31644: __strncpy_sse2_unaligned (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x401208: makeRacer (racer.c:52)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n</code></pre>\n\n<p>Which tells you that (by way of <code>strncpy</code>) you're writing to memory you don't own.</p>\n\n<p>Line 52 is:</p>\n\n<pre><code>    strncpy(nRacer-&gt;graphic, rearSide, lengthOfRearSide + 1);\n</code></pre>\n\n<p>The memory for <code>nRacer-&gt;graphic</code> was allocated as:</p>\n\n<pre><code>    nRacer-&gt;graphic = (char *)malloc(lengthOfName);\n</code></pre>\n\n<p>So you allocated <code>lengthOfName</code> bytes, but you're writing <code>lengthOfRearSide + 1</code> bytes. Those are two completely different values: <code>lengthOfName</code> is 3 but <code>lengthOfRearSide + 1</code> is 4.</p>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 5394924, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l8lnd.jpg?s=128&g=1", "display_name": "Wesley", "link": "https://stackoverflow.com/users/5394924/wesley"}, "edited": false, "score": 0, "creation_date": 1481150751, "post_id": 41028440, "comment_id": 69264942, "body": "should I free anything else within that function? Freeing middleOfCar fixed the leak."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 89, "user_id": 5394924, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l8lnd.jpg?s=128&g=1", "display_name": "Wesley", "link": "https://stackoverflow.com/users/5394924/wesley"}, "edited": false, "score": 0, "creation_date": 1481152489, "post_id": 41028440, "comment_id": 69265663, "body": "@ShaolinGOD - you must free everything that you don&#39;t carry a reference to."}, {"owner": {"reputation": 89, "user_id": 5394924, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l8lnd.jpg?s=128&g=1", "display_name": "Wesley", "link": "https://stackoverflow.com/users/5394924/wesley"}, "edited": false, "score": 0, "creation_date": 1481156000, "post_id": 41028440, "comment_id": 69266882, "body": "So valgrind says I need to free nRacer-&gt;graphics, but I need to return nRacer... how would I free something I need to return?"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1481149261, "creation_date": 1481149261, "answer_id": 41028440, "question_id": 41028180, "link": "https://stackoverflow.com/questions/41028180/how-to-malloc-correctly-for-a-struct-and-certain-variables/41028440#41028440", "title": "How to malloc correctly for a struct and certain variables?", "body": "<p>I looked into <code>middleOfCar</code>. What happens to that?</p>\n\n<p>You allocate it here:</p>\n\n<pre><code>middleOfCar = (char *)malloc(remain);\n</code></pre>\n\n<p>then you use it here:</p>\n\n<pre><code>middleOfCar[x] = '-';\n    }\n    strcat(middleOfCar, frontSide);\n    strcat(nRacer-&gt;graphic, middleOfCar);\n</code></pre>\n\n<p>but what happens then?</p>\n\n<p>Nothing more.... so you leak memory.</p>\n\n<p>Maybe you need to <code>free</code> it before leaving the function</p>\n"}], "owner": {"reputation": 89, "user_id": 5394924, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l8lnd.jpg?s=128&g=1", "display_name": "Wesley", "link": "https://stackoverflow.com/users/5394924/wesley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1481149261, "creation_date": 1481148107, "last_edit_date": 1481148490, "question_id": 41028180, "link": "https://stackoverflow.com/questions/41028180/how-to-malloc-correctly-for-a-struct-and-certain-variables", "title": "How to malloc correctly for a struct and certain variables?", "body": "<p>I'm trying to malloc for Racer but I keep getting errors in Valgrind can someone help me understand why it is not the way I have it?</p>\n\n<p>Valgrind tells me the errors are at lines 49, 50, and 57... I marked them with arrows.</p>\n\n<p>Here's my racer.c code:</p>\n\n<pre><code>#define _BSD_SOURCE\n#include &lt;stdlib.h&gt; \n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\nlong waitTime = DEFAULT_WAIT;\npthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;\n\n// Does the setup work for all racers at the start of the program.\nvoid initRacers( long milliseconds ){\n    clear();\n    if (milliseconds != 0){\n        waitTime = milliseconds;\n    }\n    pthread_mutex_init(&amp;lock, NULL);\n    srand(time(NULL));\n}\n\n// Creates a new racer.\nRacer *makeRacer( char *name, int position ){\n    int remain;\n    int sizeOfRear = 0;\n    char *frontSide = \"o&gt;\";\n    char *rearSide = \"~0=\";\n    char *middleOfCar;\n\n    int lengthOfName = strlen(name);\n    int lengthOfRearSide = strlen(rearSide);\n    size_t sizeOfRacer = sizeof(Racer);\n-&gt;  Racer *nRacer = (Racer *)malloc(sizeOfRacer);\n-&gt;  nRacer-&gt;graphic = (char *)malloc(lengthOfName);\n\n    strncpy(nRacer-&gt;graphic, rearSide, lengthOfRearSide + 1);\n    strcat(nRacer-&gt;graphic, name);\n    sizeOfRear = strlen(nRacer-&gt;graphic);\n\n    remain = MAX_CAR_LEN - sizeOfRear;\n-&gt;  middleOfCar = (char *)malloc(remain);\n    for (int x = 0; x &lt; remain - 2; x++){\n        middleOfCar[x] = '-';\n    }\n    strcat(middleOfCar, frontSide);\n    strcat(nRacer-&gt;graphic, middleOfCar);\n    nRacer-&gt;dist = 0;\n    nRacer-&gt;row = position;\n    return nRacer;\n}\n</code></pre>\n\n<p>and here's the struct:</p>\n\n<pre><code>/// Rcr struct represents a racer position and display graphic.\n///\ntypedef struct Rcr {\n\n    /// current distance from starting line of the rear of the car\n    ///\n    int dist;\n\n    /// vertical position of the racer, i.e. \"racing lane\"\n    ///\n    int row;\n\n    /// graphic: the drawable text\n    ///\n    char *graphic;\n\n} Racer;\n</code></pre>\n\n<p>Valgrind Errors:</p>\n\n<pre><code>ShaolinGOD@comp:~/Desktop/Threads$ valgrind --leak-check=full --show-leak-kinds=all --track-origins=yes ./pt-cruisers one two\n==18972== Memcheck, a memory error detector\n==18972== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==18972== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==18972== Command: ./pt-cruisers one two\n==18972== \n==18972== Invalid write of size 1\n==18972==    at 0x4C31644: __strncpy_sse2_unaligned (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x401208: makeRacer (racer.c:52)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972==  Address 0x5420093 is 0 bytes after a block of size 3 alloc'd\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4011DD: makeRacer (racer.c:50)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== Invalid read of size 1\n==18972==    at 0x4C30C14: strcat (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x40121F: makeRacer (racer.c:53)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972==  Address 0x5420093 is 0 bytes after a block of size 3 alloc'd\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4011DD: makeRacer (racer.c:50)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== Invalid write of size 1\n==18972==    at 0x4C30C30: strcat (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x40121F: makeRacer (racer.c:53)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972==  Address 0x5420093 is 0 bytes after a block of size 3 alloc'd\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4011DD: makeRacer (racer.c:50)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== Invalid write of size 1\n==18972==    at 0x4C30C3F: strcat (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x40121F: makeRacer (racer.c:53)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972==  Address 0x5420096 is 3 bytes after a block of size 3 alloc'd\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4011DD: makeRacer (racer.c:50)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== Invalid read of size 1\n==18972==    at 0x4C30F74: strlen (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x40122F: makeRacer (racer.c:54)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972==  Address 0x5420093 is 0 bytes after a block of size 3 alloc'd\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4011DD: makeRacer (racer.c:50)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== Conditional jump or move depends on uninitialised value(s)\n==18972==    at 0x4C30C17: strcat (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x401289: makeRacer (racer.c:61)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972==  Uninitialised value was created by a heap allocation\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x40124A: makeRacer (racer.c:57)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== Invalid write of size 1\n==18972==    at 0x4C30C3F: strcat (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x401289: makeRacer (racer.c:61)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972==  Address 0x54200e6 is 0 bytes after a block of size 6 alloc'd\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x40124A: makeRacer (racer.c:57)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== Invalid read of size 1\n==18972==    at 0x4C30C14: strcat (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4012A0: makeRacer (racer.c:62)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972==  Address 0x5420093 is 0 bytes after a block of size 3 alloc'd\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4011DD: makeRacer (racer.c:50)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== Invalid write of size 1\n==18972==    at 0x4C30C30: strcat (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4012A0: makeRacer (racer.c:62)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972==  Address 0x5420096 is 3 bytes after a block of size 3 alloc'd\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4011DD: makeRacer (racer.c:50)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== Invalid read of size 1\n==18972==    at 0x4C30C33: strcat (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4012A0: makeRacer (racer.c:62)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972==  Address 0x54200e6 is 0 bytes after a block of size 6 alloc'd\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x40124A: makeRacer (racer.c:57)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== Invalid write of size 1\n==18972==    at 0x4C30C3F: strcat (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4012A0: makeRacer (racer.c:62)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972==  Address 0x542009c is 9 bytes after a block of size 3 alloc'd\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4011DD: makeRacer (racer.c:50)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n0=two----o&gt; Thread 3:\n==18972== Invalid read of size 1\n==18972==    at 0x401413: run (racer.c:116)\n==18972==    by 0x4E416F9: start_thread (pthread_create.c:333)\n==18972==  Address 0x5420183 is 0 bytes after a block of size 3 alloc'd\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4011DD: makeRacer (racer.c:50)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n                    ~X=one----o&gt; Thread 2:\n==18972== Invalid read of                                  ~X=two----o&gt;\n==18972==    at 0x4013C7: run (racer.c:107)\n==18972== HEAP SUMMARY:F9: start_thread (pthread_create.c:333)\n==18972==     in use at exit: 50 bytes in 6 blocksock of size 3 alloc'd\n==18972==   total heap usage: 14 allocs, 8 frees, 3,288 bytes allocatedeck-amd64-linux.so)\n==18972==    by 0x4011DD: makeRacer (racer.c:50)\n==18972== Thread 1:00F4F: main (pt-cruisers.c:74)\n==18972== 6 bytes in 2 blocks are indirectly lost in loss record 1 of 3\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4011DD: makeRacer (racer.c:50)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== 12 bytes in 2 blocks are definitely lost in loss record 2 of 3\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x40124A: makeRacer (racer.c:57)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== 38 (32 direct, 6 indirect) bytes in 2 blocks are definitely lost in loss record 3 of 3\n==18972==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==18972==    by 0x4011CC: makeRacer (racer.c:49)\n==18972==    by 0x400F4F: main (pt-cruisers.c:74)\n==18972== \n==18972== LEAK SUMMARY:\n==18972==    definitely lost: 44 bytes in 4 blocks\n==18972==    indirectly lost: 6 bytes in 2 blocks\n==18972==      possibly lost: 0 bytes in 0 blocks\n==18972==    still reachable: 0 bytes in 0 blocks\n==18972==         suppressed: 0 bytes in 0 blocks\n==18972== \n==18972== For counts of detected and suppressed errors, rerun with: -v\n==18972== ERROR SUMMARY: 797 errors from 15 contexts (suppressed: 0 from 0)\nShaolinGOD@comp:~/Desktop/Threads$ \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481147435, "post_id": 41027954, "comment_id": 69263467, "body": "Use <code>memcmp</code>..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481147457, "post_id": 41027954, "comment_id": 69263478, "body": "With <a href=\"https://msdn.microsoft.com/en-us/library/zyaebf12.aspx\" rel=\"nofollow noreferrer\"><code>memcmp</code></a>?"}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1481148277, "post_id": 41028169, "comment_id": 69263858, "body": "Down Voter please explain"}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481148385, "post_id": 41028169, "comment_id": 69263913, "body": "Yeah, mine was immediately downvoted too."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481148452, "post_id": 41028169, "comment_id": 69263939, "body": "@MDXF Get used you will see this things here."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481148472, "post_id": 41028169, "comment_id": 69263949, "body": "Oh, I&#39;m used to it. This has happened before."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481148746, "post_id": 41028169, "comment_id": 69264084, "body": "I don&#39;t mind the reps, I just enjoy helping people and sharing my programming experience. But the downvote didn&#39;t make any sense."}, {"owner": {"reputation": 3, "user_id": 7264659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e6e6f7b25c9012702d7d7b814ac534?s=128&d=identicon&r=PG&f=1", "display_name": "MBV", "link": "https://stackoverflow.com/users/7264659/mbv"}, "edited": false, "score": 0, "creation_date": 1481263074, "post_id": 41028169, "comment_id": 69315110, "body": "Thank you for your help :)"}], "tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": false, "score": 0, "last_activity_date": 1481148059, "creation_date": 1481148059, "answer_id": 41028169, "question_id": 41027954, "link": "https://stackoverflow.com/questions/41027954/how-to-compare-two-multidimensional-arrays/41028169#41028169", "title": "how to compare two multidimensional arrays", "body": "<p>Based on your example, I'll doit like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define line 2\n#define col 5\n\nint main(void){\nint num[line][col] = {\n        { '1', '1', '1', '1', '1' },\n        { '1', '1', '1', '1', '1' },\n    };\n\nint solution[line][col] = {\n        { '1', '1', '1', '1', '1' },\n        { '1', '1', '1', '1', '1' },\n    };\n\n\n    for (size_t i = 0; i &lt; line; ++i)\n    {\n        for (size_t j = 0; j &lt; col; ++j)\n        {\n            if (num[i][j] != solution[i][j])\n            {\n                printf(\"Not equal\\n\");\n                return 1;\n            }\n        }\n    }\n    printf(\"are equal\\n\");\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>are equal\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1481148354, "post_id": 41028220, "comment_id": 69263898, "body": "I wasn&#39;t positive about what to put as the 3rd argument in <code>memcmp</code>. If 10 is wrong, feel free to correct me."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1481148378, "post_id": 41028220, "comment_id": 69263911, "body": "Down Voter please stop acting like a coward and Explain your reasons."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1481148528, "post_id": 41028220, "comment_id": 69263976, "body": "You know, I don&#39;t mind the downvote (as I&#39;m not a rep-junkie), but I don&#39;t understand what&#39;s wrong with my solution. It answers the question, it&#39;s clear and concise, and it uses proper programming technique. Explain, please."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1481149803, "post_id": 41028220, "comment_id": 69264537, "body": "<code>as I&#39;m not a rep-junkie</code> hmmm.... then you shouldn&#39;t have answered this in the first place. BTW: don&#39;t hardcode <code>10</code> - <code>sizeof</code> is much better."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1481149845, "post_id": 41028220, "comment_id": 69264558, "body": "@4386427 Exactly my thoughts, but I figured I&#39;d rather hardcode it than use <code>sizeof</code> incorrectly. How could I use it in this instance?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1481150101, "post_id": 41028220, "comment_id": 69264671, "body": "You shouldn&#39;t have answered in the first place. However, if you do, you better make a perfect one. Oh, BTW - upvoting each other answers will sooner or later get you in to trouble."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1481150127, "post_id": 41028220, "comment_id": 69264682, "body": "@4386427 I did not ask the other user to upvote my answer. I simply noticed that his answer was a valid, good response, and upvoted it. Whether or not he returned the vote was 100% his choice and doing, and I did not vote his in hopes of getting reputation."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1481150217, "post_id": 41028220, "comment_id": 69264719, "body": "@4386427 I really <i>don&#39;t</i> care so much about the reputation. I don&#39;t <i>mind</i> the points, but they&#39;re not why I&#39;m here. I simply enjoy sharing my knowledge with the rest of the community."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1481150290, "post_id": 41028220, "comment_id": 69264753, "body": "@4386427 If it makes this much of a difference in your mind, I&#39;ll edit the answer and request that Michi reverses his vote."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1481150424, "post_id": 41028220, "comment_id": 69264810, "body": "I don&#39;t care what this particular answer is. I care about learning you not to answer this kind of questions. SO is not a &quot;write my code&quot; service."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1481150462, "post_id": 41028220, "comment_id": 69264823, "body": "@4386427 So punish good users for answering bad questions? Is that what you&#39;re saying?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1481150534, "post_id": 41028220, "comment_id": 69264849, "body": "Yes - exactly. Don&#39;t answer questions which shows not effort from OP at all. That is not welcome at SO."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1481150546, "post_id": 41028220, "comment_id": 69264855, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/130052/discussion-between-md-xf-and-4386427\">continue this discussion in chat</a>."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1481281963, "post_id": 41028220, "comment_id": 69324676, "body": "@4386427 This means that <a href=\"http://stackoverflow.com/questions/37538/how-do-i-determine-the-size-of-my-array-in-c\">This Question shows a lot of effort</a> ? At least the OP showed 7 lines of Code."}], "tags": [], "owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "is_accepted": true, "score": 0, "last_activity_date": 1481148690, "last_edit_date": 1481148690, "creation_date": 1481148283, "answer_id": 41028220, "question_id": 41027954, "link": "https://stackoverflow.com/questions/41027954/how-to-compare-two-multidimensional-arrays/41028220#41028220", "title": "how to compare two multidimensional arrays", "body": "<p>Try using <code>memcmp</code> to compare <code>num</code> and <code>solution</code>:</p>\n\n<pre><code>char num[line][col] = {\n    { '\\0', '1', '\\0', '\\0', '\\0' },\n    { '\\0', '\\0', '\\0', '3', '\\0'  },\n    };  \nchar solution[line][col] = {\n    { '5', '1', '3', '4', '2' },\n    { '4', '2', '5', '3', '1'  }, };\n\nint main(void)\n{\n    printf(\"Comparing num[][] to solution[][]...\\n\");\n    int result = memcmp(num, solution, 10);\n\n    if (result != 0)\n        printf(\"Not equal.\\n\");\n    else\n        printf(\"Equal.\\n\");\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7264659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e6e6f7b25c9012702d7d7b814ac534?s=128&d=identicon&r=PG&f=1", "display_name": "MBV", "link": "https://stackoverflow.com/users/7264659/mbv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "closed_date": 1481151607, "accepted_answer_id": 41028220, "answer_count": 2, "score": -3, "last_activity_date": 1481507801, "creation_date": 1481147172, "last_edit_date": 1481507801, "question_id": 41027954, "link": "https://stackoverflow.com/questions/41027954/how-to-compare-two-multidimensional-arrays", "closed_reason": "Needs details or clarity", "title": "how to compare two multidimensional arrays", "body": "<p>I have two multi-dimension arrays </p>\n\n<pre><code>num[line][col] = {\n        { '\\0', '1', '\\0', '\\0', '\\0' },\n        { '\\0', '\\0', '\\0', '3', '\\0'  },\n        };  \nsolution[line][col] = {\n        { '5', '1', '3', '4', '2' },\n        { '4', '2', '5', '3', '1'  },};\n</code></pre>\n\n<ol>\n<li>How do I write in num?\n2.How do I compare num and solution?\nThank you so much</li>\n</ol>\n"}, {"tags": ["c", "cuda"], "comments": [{"owner": {"reputation": 10963, "user_id": 306257, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/701752cfc3dd805d412884f38a464296?s=128&d=identicon&r=PG", "display_name": "Haldean Brown", "link": "https://stackoverflow.com/users/306257/haldean-brown"}, "edited": false, "score": 0, "creation_date": 1481147790, "post_id": 41027916, "comment_id": 69263646, "body": "We need to see the code that calls <code>update()</code> to really know. Could you add more context?"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 6343388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bb0ab34e8c8e40d7f29901756cb0e5?s=128&d=identicon&r=PG&f=1", "display_name": "stak0verflow", "link": "https://stackoverflow.com/users/6343388/stak0verflow"}, "is_accepted": false, "score": 1, "last_activity_date": 1481148242, "creation_date": 1481148242, "answer_id": 41028212, "question_id": 41027916, "link": "https://stackoverflow.com/questions/41027916/cuda-copy-and-kernel-call-within-a-loop/41028212#41028212", "title": "CUDA copy and kernel call within a loop", "body": "<p>I was able to fix it by creating the following:</p>\n\n<pre><code>__global__ void update_c(const double *d_u, double *d_u_new, const int nx, const double k)\n{\n    int i = blockDim.x * blockIdx.x + threadIdx.x;\n\n    if (i &lt; nx-1 &amp;&amp; i &gt; 0)\n    {\n        d_u_new[i] =  d_u[i] + k*(d_u[i+1] + d_u[i-1] -2*d_u[i]);\n    }\n}\n\nvoid copyToDev(){\n  cudaMemcpy(d_u, u, size, cudaMemcpyHostToDevice);\n  cudaMemcpy(d_u_new, u_new, size, cudaMemcpyHostToDevice);\n}\n\nvoid copyToHost(){\n  cudaMemcpy(u, d_u, size, cudaMemcpyDeviceToHost);\n  cudaMemcpy(u_new, d_u_new, size, cudaMemcpyDeviceToHost);\n}\n\n/* updates u for next time step. */\nvoid update() {\n\n  update_c&lt;&lt;&lt;blocksPerGrid, threadsPerBlock&gt;&gt;&gt;(d_u, d_u_new, nx, k);\n  double *tmp = d_u_new; d_u_new = d_u; d_u = tmp;\n}\n</code></pre>\n\n<p>I call copyToDev() before the loop that calls update and copyToHost after. </p>\n"}], "owner": {"reputation": 27, "user_id": 6343388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bb0ab34e8c8e40d7f29901756cb0e5?s=128&d=identicon&r=PG&f=1", "display_name": "stak0verflow", "link": "https://stackoverflow.com/users/6343388/stak0verflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1481148242, "creation_date": 1481147026, "question_id": 41027916, "link": "https://stackoverflow.com/questions/41027916/cuda-copy-and-kernel-call-within-a-loop", "title": "CUDA copy and kernel call within a loop", "body": "<p>So I am working on an assignment which involves coding in C using CUDA. I have written a function and a kernel that work (produce the correct result). However, I am looking to increase the speed. </p>\n\n<p>This is the kernel:</p>\n\n<pre><code>__global__ void update_c(const double *d_u, double *d_u_new, const int nx, const double k)\n{\n    int i = blockDim.x * blockIdx.x + threadIdx.x;\n\n    if (i &lt; nx-1 &amp;&amp; i &gt; 0)\n    {\n        d_u_new[i] =  d_u[i] + k*(d_u[i+1] + d_u[i-1] -2*d_u[i]);\n    }\n}\n</code></pre>\n\n<p>and this is the function:</p>\n\n<pre><code>void update() {\n\n  cudaMemcpy(d_u, u, size, cudaMemcpyHostToDevice);\n  cudaMemcpy(d_u_new, u_new, size, cudaMemcpyHostToDevice);\n  update_c&lt;&lt;&lt;blocksPerGrid, threadsPerBlock&gt;&gt;&gt;(d_u, d_u_new, nx, k);\n  cudaMemcpy(u, d_u, size, cudaMemcpyDeviceToHost);\n  cudaMemcpy(u_new, d_u_new, size, cudaMemcpyDeviceToHost);\n\n  double *tmp = u_new; u_new = u; u = tmp;\n}\n</code></pre>\n\n<p>I understand that once copied d_u and d_u_new will stay on the device so I do not need to copy them each time. My question is how do I re-write this to use the variables over and over and only copy memory at the start and end of the program? I am brand new to CUDA and only got a very brief crash course in it before this was assigned.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 1, "creation_date": 1481146680, "post_id": 41027807, "comment_id": 69263071, "body": "What line does the debugger say the seg-fault occurred on?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1481146750, "post_id": 41027807, "comment_id": 69263109, "body": "<code>fflush(stdin)</code> is bad - <code>fflush</code> is only valid for output streams."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1481146919, "post_id": 41027807, "comment_id": 69263207, "body": "In your <code>switch</code> ==&gt;&gt; <code>case &#39;c&#39;:</code> in the <code>else</code> part you have a statement with no efect, which is <code>test.ptr;</code> Check on that. What should <code>test.ptr</code> should do here?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1481147076, "post_id": 41027807, "comment_id": 69263288, "body": "<code>test.userWord[45] = &#39;\\0&#39;;</code> write to out of bounds."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1481147188, "post_id": 41027807, "comment_id": 69263352, "body": "<code>void goToExit();</code> ==&gt;&gt; <code>void goToExit(int);</code> Don&#39;t use <code>gets</code>, is deprecated."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1481147197, "post_id": 41027807, "comment_id": 69263359, "body": "A compilation gave 2 warnings. In <code>pos = test.attempt + (i*movement);</code> the warning &quot; &#39;=&#39;: &#39;int&#39; differs in levels of indirection from &#39;int *&#39; &quot;. And in <code>printf(&quot;In file %s %c was not found.\\n&quot;, test.userWord, fileN);</code> the warning &quot; &#39;printf&#39; : format string &#39;%c&#39; requires an argument of type &#39;int&#39;, but variadic argument 2 has type &#39;char *&#39; &quot;. Better fix all warnings."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 1, "creation_date": 1481147265, "post_id": 41027807, "comment_id": 69263388, "body": "Line 598 is causing the problem. arPos= *test.attempt. attempt is pointing to NULL. Perhaps you need to provide an input file so we can run the code..."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1481147387, "post_id": 41027807, "comment_id": 69263442, "body": "Here =&gt; <code>printf(&quot;In file %s %c was not found.\\n&quot;, test.userWord, fileN);</code> also ==&gt;&gt; <code>error: format \u2018%c\u2019 expects argument of type \u2018int\u2019, but argument 3 has type \u2018char *\u2019</code> You have a lot of errors and conversion problems."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1481147480, "post_id": 41027807, "comment_id": 69263484, "body": "Please provide an input file....."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1481148639, "post_id": 41027807, "comment_id": 69264022, "body": "Where was the error?"}], "answers": [{"tags": [], "owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "is_accepted": false, "score": 0, "last_activity_date": 1481149532, "creation_date": 1481149532, "answer_id": 41028494, "question_id": 41027807, "link": "https://stackoverflow.com/questions/41027807/struct-malloc-or-other-sigsegv-error/41028494#41028494", "title": "Struct/Malloc or Other? SIGSEGV Error", "body": "<p><em>(Posted on behalf of the OP)</em>.</p>\n\n<p>SOLVED! - the error was I was not dereferencing and then referencing a pointer.</p>\n"}], "owner": {"reputation": 11, "user_id": 7264088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d948ac52c44f2ca1cfa5424807dec97e?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Goodman", "link": "https://stackoverflow.com/users/7264088/christopher-goodman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1481149585, "creation_date": 1481146526, "last_edit_date": 1481149585, "question_id": 41027807, "link": "https://stackoverflow.com/questions/41027807/struct-malloc-or-other-sigsegv-error", "title": "Struct/Malloc or Other? SIGSEGV Error", "body": "<p>I have debugged and watched my \"watch window\" to get an idea where the problem was. It does not even finish the code though. During the test sequence to find the user inputted word, it fails. It has a SIGSEGV fault at the found function.</p>\n\n<p>The code is meant to take in a word puzzle and then allow the user to find the words.</p>\n\n<p>puzzleInput.txt:</p>\n\n<pre><code>M,N,O,S,L,I,W,E,R,E,L,Y,T,L,E,A,G,N\nA,H,O,O,V,E,R,T,A,Y,L,O,R,V,E,N,N,A\nD,F,D,R,O,O,S,E,V,E,L,T,O,N,O,M,I,M\nI,N,T,P,M,H,I,E,G,D,I,L,O,O,C,O,D,U\nS,O,N,L,I,J,Q,A,D,A,M,S,S,R,N,N,R,R\nO,X,L,O,G,E,F,F,M,O,I,R,E,E,G,R,A,T\nN,I,B,T,S,O,R,A,O,R,M,O,V,A,W,O,H,N\nF,N,H,U,R,R,B,C,R,N,L,R,E,G,B,E,W,E\nR,O,S,D,C,O,E,A,E,I,O,N,L,A,U,A,J,R\nK,W,U,N,L,H,H,F,N,I,O,S,T,N,S,W,A,U\nE,R,B,A,J,B,A,C,F,S,S,M,N,H,H,R,D,B\nN,E,W,L,O,T,O,N,K,E,C,E,I,H,T,H,A,N\nN,T,H,E,H,L,A,C,A,K,J,N,N,H,O,I,M,A\nE,R,G,V,N,C,A,F,I,N,G,H,U,H,A,J,S,V\nD,A,R,E,S,J,C,N,T,T,A,R,N,B,O,Y,A,E\nY,C,A,L,O,D,L,N,O,S,I,R,R,A,H,W,E,O\nN,E,N,C,N,E,T,N,N,O,T,N,I,L,C,O,E,S\nD,A,T,Y,Y,P,O,L,K,G,A,R,F,I,E,L,D,R\n\nenter code here\n</code></pre>\n\n<p>code:</p>\n\n<pre><code>/*  This program reads a puzzle from a file\n    and allows the user to define a word which\n    they want to find in the word puzzle.*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nvoid fileNam(char[]);\nchar showMenu();\nint fileData(char*);\nvoid alphaArray();\nvoid getUser();\nvoid fileError(char*);\nvoid findUserFirst();\nint createString();\nvoid found(int);\nvoid notFound(char*);\nvoid goToExit();\nvoid display();\n\nstruct alphabet\n{\n      int *A;int *B; int *C; int *D; int *E; int *F;\n      int *G; int *H; int *I; int *J; int *K; int *L; int *M;\n      int *N; int *O; int *P; int *Q; int *R; int *S;\n      int *T; int *U; int *V; int *W; int *X; int *Y; int *Z;\n      int a; int b; int c; int d; int e; int f; int g; int h; int i; int j; int k; int l; int m;\n      int n; int o; int p; int q; int r; int s; int t; int u; int v; int w; int x; int y; int z;\n}fill;\n\nstruct user\n{\n    struct alphabet* ptr;\n    int *attempt;\n    int testNum;\n    int columns;\n    int rows;\n    int userSize;\n    int puzzleSize;\n    char *puzzleArray;\n    char userWord[45];\n}test;\n\n\nint main()\n{\n    int wordsFound = 0;\n    int fileErr = 0;\n    int wordF = 0;\n    char option;\n    char fileLoc[100] = {0};\n\n    do\n    {\n        fflush(stdin);\n        option = showMenu();\n        fflush(stdin);\n\n        if(fileErr == -1)\n        {\n            fileError(fileLoc);\n        }\n\n        switch(option)\n        {\n            case 'a':;\n                fileNam(fileLoc);\n                strcat(fileLoc,\"\\\\puzzleInput.txt\");\n                fileErr = fileData(fileLoc);\n                break;\n            case 'b':\n                display();\n                break;\n            case 'c':\n                getUser();\n                findUserFirst();\n                wordF = 0;\n                do{\n                    wordF = createString();\n                    if(wordF &gt; 0)\n                    {\n                        found(wordF);\n                        wordsFound++;\n                    }\n                    else\n                    {\n                        test.ptr;\n                    }\n                    }while(*test.attempt &lt;= test.testNum);\n                    if(wordF &lt; -1)\n                        notFound(fileLoc);\n                break;\n            case 'd':\n                goToExit(wordsFound);\n                break;\n            default:\n                printf(\"Invalid selection.\\nPlease choose again.\\n\");\n                break;\n        }\n    }while(option != 'd');\n\n\n    return 0;\n}\n\nchar showMenu()\n{\n    char option;\n    printf(\"Choose one of the following:\\n\");\n    printf(\"\\ta. Enter file location(full path)\\n\");\n    printf(\"\\tb. Display the puzzle\\n\");\n    printf(\"\\tc. Find a word\\n\");\n    printf(\"\\td. Exit\\n\");\n    option = getchar();\n    return option;\n}\n\nvoid goToExit(int found)\n{\n    printf(\"\\nYou found %d words!\\n\", found);\n    if(found &gt; 5)\n    {\n        printf(\"Awesome job! Come back to play again!\");\n    }\n    else{\n        printf(\"Better luck next time!\");\n    }\n    printf(\"Press any key to close window.\");\n    getchar();\n    free(fill.A);free(fill.B); free(fill.C); free(fill.D); free(fill.E); free(fill.F);\n    free(fill.G); free(fill.H); free(fill.I); free(fill.J); free(fill.K); free(fill.L); free(fill.M);\n    free(fill.N); free(fill.O); free(fill.P); free(fill.Q); free(fill.R); free(fill.S);\n    free(fill.T); free(fill.U); free(fill.V); free(fill.W); free(fill.X); free(fill.Y); free(fill.Z);\n    free(test.puzzleArray);\n}\n\nvoid display()\n{\n    int i, j, k = 0;\n    for(i=0; i &lt;= test.columns; i++)\n    {\n        for(j=0; j &lt;= test.rows; j++)\n        {\n            printf(\"%c, \", test.puzzleArray[k]);\n            k++;\n        }\n        printf(\"\\n\");\n    }\n\n}\n\n\nvoid fileNam(char fileLoc[])\n{\n    printf(\"When entering file location, do not \\n\");\n    printf(\"include the file name.\\nLOCATION:\\n\");\n    gets(fileLoc);\n}\n\nvoid fileError(char* fileName)\n{\n    printf(\"There was an error with the file location\");\n    printf(\" that you typed in.\\nPlease make sure file \");\n    printf(\"location and name are correct.\\nIf name is wrong, \");\n    printf(\"please change the name of your file to match.\\n\");\n    printf(\"FILE LOCATION AND NAME: \\\"%s\\\"\\n\\n\", fileName);\n}\n\nint fileData(char* fname)\n{\n    int i = 0;\n    char curr;\n    FILE * fPtr;\n    fPtr = fopen(fname, \"r\");\n\n    char buffer[1000] = {0};\n\n    if(fPtr == NULL)//test if file opened\n    {\n        printf(\"There has been an error in opening %s!\\n\", fname);\n        return -1;\n    }\n\n    while (!feof(fPtr))\n    {\n        fgets(buffer, 1000, fPtr);\n        test.rows++;\n    }\n\n    rewind(fPtr);\n\n    while(fgetc(fPtr) &gt;= 65 &amp;&amp; fgetc(fPtr) &lt;= 90)\n    {\n        test.puzzleSize++;\n    }\n\n    test.puzzleArray = (char*) malloc((test.puzzleSize) * sizeof(char));\n    printf(\"%d\", test.puzzleSize);\n    rewind(fPtr);\n    i = 0;\n    while ((curr = fgetc(fPtr)) != EOF)\n    {\n        if(curr == ',' || curr == '\\n')\n        {\n            if(curr == '\\n')\n                test.columns++;\n        }\n        if(curr &gt;= 65 &amp;&amp; curr &lt;= 90)\n        {\n            test.puzzleArray[i] = curr;\n            i++;\n        }\n\n    }\n\n    fclose(fPtr);\n    alphaArray();\n    return 0;\n}\n\nvoid alphaArray()\n{\n    int i = 0;\n    char current = 0;\n\n\n    while(test.puzzleArray[i] != '\\0')\n    {\n        current = test.puzzleArray[i];\n        switch(tolower(current))//accidentally coded lowercase, quick fix\n        {\n        case 'a':\n            fill.a++;\n            break;\n        case 'b':\n            fill.b++;\n            break;\n        case 'c':\n            fill.c++;\n            break;\n        case 'd':\n            fill.d++;\n            break;\n        case 'e':\n            fill.e++;\n            break;\n        case 'f':\n            fill.f++;\n            break;\n        case 'g':\n            fill.g++;\n            break;\n        case 'h':\n            fill.h++;\n            break;\n        case 'i':\n            fill.i++;\n            break;\n        case 'j':\n            fill.j++;\n            break;\n        case 'k':\n            fill.k++;\n            break;\n        case 'l':\n            fill.l++;\n            break;\n        case 'm':\n            fill.m++;\n            break;\n        case 'n':\n            fill.n++;\n            break;\n        case 'o':\n            fill.o++;\n            break;\n        case 'p':\n            fill.p++;\n            break;\n        case 'q':\n            fill.q++;\n            break;\n        case 'r':\n            fill.r++;\n            break;\n        case 's':\n            fill.s++;\n            break;\n        case 't':\n            fill.t++;\n            break;\n        case 'u':\n            fill.u++;\n            break;\n        case 'v':\n            fill.v++;\n            break;\n        case 'w':\n            fill.w++;\n            break;\n        case 'x':\n            fill.x++;\n            break;\n        case 'y':\n            fill.y++;\n            break;\n        case 'z':\n            fill.z++;\n            break;\n        default: printf(\"\\n\");\n        break;\n        }\n    i++;\n    }\n\n    fill.A = (int *)malloc(sizeof(int)*fill.a); fill.B = (int *)malloc(sizeof(int)*fill.b);\n    fill.C = (int *)malloc(sizeof(int)*fill.c); fill.D = (int *)malloc(sizeof(int)*fill.d);\n    fill.E = (int *)malloc(sizeof(int)*fill.e); fill.F = (int *)malloc(sizeof(int)*fill.f);\n    fill.G = (int *)malloc(sizeof(int)*fill.g); fill.H = (int *)malloc(sizeof(int)*fill.h);\n    fill.I = (int *)malloc(sizeof(int)*fill.i); fill.J = (int *)malloc(sizeof(int)*fill.j);\n    fill.K = (int *)malloc(sizeof(int)*fill.k); fill.L = (int *)malloc(sizeof(int)*fill.l);\n    fill.M = (int *)malloc(sizeof(int)*fill.m); fill.N = (int *)malloc(sizeof(int)*fill.n);\n    fill.O = (int *)malloc(sizeof(int)*fill.o); fill.P = (int *)malloc(sizeof(int)*fill.p);\n    fill.Q = (int *)malloc(sizeof(int)*fill.q); fill.R = (int *)malloc(sizeof(int)*fill.r);\n    fill.S = (int *)malloc(sizeof(int)*fill.s); fill.T = (int *)malloc(sizeof(int)*fill.t);\n    fill.U = (int *)malloc(sizeof(int)*fill.u); fill.V = (int *)malloc(sizeof(int)*fill.v);\n    fill.W = (int *)malloc(sizeof(int)*fill.w); fill.X = (int *)malloc(sizeof(int)*fill.x);\n    fill.Y = (int *)malloc(sizeof(int)*fill.y); fill.Z = (int *)malloc(sizeof(int)*fill.z);\n\n    fill.a = 0;fill.b =0; fill.c =0; fill.d =0; fill.e =0; fill.f =0;\n    fill.g =0; fill.k =0; fill.o =0; fill.s =0; fill.w =0;\n    fill.h =0; fill.l =0; fill.p =0; fill.t =0; fill.x =0;\n    fill.i =0; fill.m =0; fill.q =0; fill.u =0; fill.y =0;\n    fill.j =0; fill.n =0; fill.r =0; fill.v =0; fill.z =0;\n    i = 0;\n\n    while(test.puzzleArray[i] != '\\0')\n    {\n        current = test.puzzleArray[i];\n        switch(tolower(current))//accidentally coded lowercase, quick fix\n        {\n        case 'a':\n            fill.A[fill.a] = i;\n            fill.a++;\n            break;\n        case 'b':\n            fill.B[fill.b] = i;\n            fill.b++;\n            break;\n        case 'c':\n            fill.C[fill.c] = i;\n            fill.c++;\n            break;\n        case 'd':\n            fill.D[fill.d] = i;\n            fill.d++;\n            break;\n        case 'e':\n            fill.E[fill.e] = i;\n            fill.e++;\n            break;\n        case 'f':\n            fill.F[fill.f] = i;\n            fill.f++;\n            break;\n        case 'g':\n            fill.G[fill.g] = i;\n            fill.g++;\n            break;\n        case 'h':\n            fill.H[fill.h] = i;\n            fill.h++;\n            break;\n        case 'i':\n            fill.I[fill.i] = i;\n            fill.i++;\n            break;\n        case 'j':\n            fill.J[fill.j] = i;\n            fill.j++;\n            break;\n        case 'k':\n            fill.K[fill.k] = i;\n            fill.k++;\n            break;\n        case 'l':\n            fill.L[fill.l] = i;\n            fill.l++;\n            break;\n        case 'm':\n            fill.M[fill.m] = i;\n            fill.m++;\n            break;\n        case 'n':\n            fill.N[fill.n] = i;\n            fill.n++;\n            break;\n        case 'o':\n            fill.O[fill.o] = i;\n            fill.o++;\n            break;\n        case 'p':\n            fill.P[fill.p] = i;\n            fill.p++;\n            break;\n        case 'q':\n            fill.Q[fill.q] = i;\n            fill.q++;\n            break;\n        case 'r':\n            fill.R[fill.r] = i;\n            fill.r++;\n            break;\n        case 's':\n            fill.S[fill.s] = i;\n            fill.s++;\n            break;\n        case 't':\n            fill.T[fill.t] = i;\n            fill.t++;\n            break;\n        case 'u':\n            fill.U[fill.u] = i;\n            fill.u++;\n            break;\n        case 'v':\n            fill.V[fill.v] = i;\n            fill.v++;\n            break;\n        case 'w':\n            fill.W[fill.w] = i;\n            fill.w++;\n            break;\n        case 'x':\n            fill.X[fill.x] = i;\n            fill.x++;\n            break;\n        case 'y':\n            fill.Y[fill.y] = i;\n            fill.y++;\n            break;\n        case 'z':\n            fill.Z[fill.z] = i;\n            fill.z++;\n            break;\n        default: printf(\"\\n\");\n        break;\n        }\n    i++;\n    }\n}\n\nvoid getUser()\n{\n    test.testNum = 0;\n    test.userWord[45] = '\\0';\n    test.ptr = 0;\n    printf(\"\\nWhat word would you like to search for?\\n\");\n    scanf(\"%s\", test.userWord);\n    test.userSize = strlen(test.userWord);\n}\n\nvoid findUserFirst()\n{\n    switch(tolower(test.userWord[0]))\n    {\n    case 'a':\n        test.attempt = &amp;fill.A[0];\n        test.testNum = fill.a;\n        break;\n    case 'b':\n        test.attempt = &amp;fill.B[0];\n        test.testNum =  fill.b;\n        break;\n    case 'c':\n        test.attempt = &amp;fill.C[0];\n        test.testNum =  fill.c;\n        break;\n    case 'd':\n        test.attempt = &amp;fill.D[0];\n        test.testNum =  fill.d;\n        break;\n    case 'e':\n        test.attempt = &amp;fill.E[0];\n        test.testNum =  fill.e;\n        break;\n    case 'f':\n        test.attempt = &amp;fill.F[0];\n        test.testNum =  fill.f;\n        break;\n    case 'g':\n        test.attempt = &amp;fill.G[0];\n        test.testNum =  fill.g;\n        break;\n    case 'h':\n        test.attempt = &amp;fill.H[0];\n        test.testNum =  fill.h;\n        break;\n    case 'i':\n        test.attempt = &amp;fill.I[0];\n        test.testNum =  fill.i;\n        break;\n    case 'j':\n        test.attempt = &amp;fill.J[0];\n        test.testNum =  fill.j;\n        break;\n    case 'k':\n        test.attempt = &amp;fill.K[0];\n        test.testNum =  fill.k;\n        break;\n    case 'l':\n        test.attempt = &amp;fill.L[0];\n        test.testNum =  fill.l;\n        break;\n    case 'm':\n        test.attempt = &amp;fill.M[0];\n        test.testNum =  fill.m;\n        break;\n    case 'n':\n        test.attempt = &amp;fill.N[0];\n        test.testNum =  fill.n;\n        break;\n    case 'o':\n        test.attempt = &amp;fill.O[0];\n        test.testNum =  fill.o;\n        break;\n    case 'p':\n        test.attempt = &amp;fill.P[0];\n        test.testNum =  fill.p;\n        break;\n    case 'q':\n        test.attempt = &amp;fill.Q[0];\n        test.testNum =  fill.q;\n        break;\n    case 'r':\n        test.attempt = &amp;fill.R[0];\n        test.testNum =  fill.r;\n        break;\n    case 's':\n        test.attempt = &amp;fill.S[0];\n        test.testNum =  fill.s;\n        break;\n    case 't':\n        test.attempt = &amp;fill.T[0];\n        test.testNum =  fill.t;\n        break;\n    case 'u':\n        test.attempt = &amp;fill.U[0];\n        test.testNum =  fill.u;\n        break;\n    case 'v':\n        test.attempt = &amp;fill.V[0];\n        test.testNum =  fill.v;\n        break;\n    case 'w':\n        test.attempt = &amp;fill.W[0];\n        test.testNum =  fill.w;\n        break;\n    case 'x':\n        test.attempt = &amp;fill.X[0];\n        test.testNum =  fill.x;\n        break;\n    case 'y':\n        test.attempt = &amp;fill.Y[0];\n        test.testNum =  fill.y;\n        break;\n    case 'z':\n        test.attempt = &amp;fill.Z[0];\n        test.testNum = fill.z;\n        break;\n    default: printf(\"\\n\");\n    }\n}\n\nint createString()\n{\n\n    int i = 0, upRoom = 0, rightRoom = 0;\n    int leftRoom = 0, downRoom = 0;\n    int columnPos = 0, rowPos = 0;\n    int arPos = 0;\n    int moveup = 0, moveupr = 0;\n    int moveupl = 0, mover = 0;\n    int movel = 0, moved = 0;\n    int movedr = 0, movedl = 0;\n    char up[45];\n    char upRight[45];\n    char right[45];\n    char downRight[45];\n    char down[45];\n    char downLeft[45];\n    char left[45];\n    char upLeft[45];\n\n\n    arPos = *test.attempt;\n\n    columnPos = arPos / test.columns;\n    rowPos = arPos % test.rows;\n\n    upRoom = test.columns/2 - columnPos;\n    downRoom = test.columns/2 - columnPos;\n    rightRoom = test.rows/2 - rowPos;\n    leftRoom =  test.rows/2 - rowPos;\n\n    moveup = -(test.rows);\n    moveupr = (test.rows - 1) * (-1),\n    moveupl = -(test.rows + 1);\n    mover = 1;\n    movel = 1;\n    moved = test.rows,\n    movedr = 1 * (test.rows + 1);\n    movedl = 1 * (test.rows - 1);\n\n    for(i=0; i &lt; test.userSize; i++)\n    {\n        if(rightRoom &gt;= 0)\n        {\n            right[i] = test.puzzleArray[arPos + i*mover];\n            if(upRoom &gt;= 0)\n                upRight[i] = test.puzzleArray[arPos + i*moveupr];\n            if(downRoom &gt;= 0)\n                downRight[i] = test.puzzleArray[arPos + i*movedr];\n        }\n        if(leftRoom &gt;= 0)\n        {\n            left[i] = test.puzzleArray[arPos - movel];\n            if(upRoom &gt;= 0)\n                upLeft[i] = test.puzzleArray[arPos + i*moveupl];\n            if(downRoom &gt;= 0)\n                downLeft[i] = test.puzzleArray[arPos + i*movedl];\n        }\n        if(upRoom &gt;= 0)\n            up[i] = test.puzzleArray[arPos + i*moveup];\n        if(downRoom &gt;= 0)\n            down[i] = test.puzzleArray[arPos + i*moved];\n    }\n\n    for(i = 0; i &lt; test.userSize; i++)\n    {\n        if(strcmp(up, test.userWord) == 0)\n            return 1;\n        if(strcmp(upRight, test.userWord) == 0)\n            return 2;\n        if(strcmp(right, test.userWord) == 0)\n            return 3;\n        if(strcmp(downRight, test.userWord) == 0)\n            return 4;\n        if(strcmp(down, test.userWord) == 0)\n            return 5;\n        if(strcmp(downLeft, test.userWord) == 0)\n            return 6;\n        if(strcmp(left, test.userWord) == 0)\n            return 7;\n        if(strcmp(upLeft, test.userWord) == 0)\n            return 8;\n        else\n            return -1;\n    }\n    return -1;\n}\n\nvoid found(int style)\n{\n    int pos = 0, movement = 0;\n    int i, j, k = 0;\n    char *cpyPuzzle;\n\n    cpyPuzzle = (char*) malloc((test.puzzleSize) * sizeof(char));\n\n    strcpy(cpyPuzzle, test.puzzleArray);\n\n\n    switch(style){\n        case 1:\n            movement = test.rows;\n            break;\n        case 2:\n            movement = test.rows - 1;\n            break;\n        case 3:\n            movement = 1;\n            break;\n        case 4:\n            movement = test.rows + 1;\n            break;\n        case 5:\n            movement = test.rows;\n            break;\n        case 6:\n            movement = test.rows - 1;\n            break;\n        case 7:\n            movement = 1;\n            break;\n        case 8:\n            movement = test.rows + 1;\n            break;\n    }\n\n    for(i = 0; i &lt; test.puzzleSize; i++)\n    {\n        cpyPuzzle[i] = '~';\n    }\n\n    for(i=0; i &lt; test.userSize; i++)\n    {\n        pos = test.attempt + (i*movement);\n        cpyPuzzle[pos] = test.userWord[i];\n    }\n\n    for(i=0; i &lt; test.columns; i++)\n    {\n        for(j=0; j &lt; test.rows; j++)\n        {\n            printf(\"%c, \", cpyPuzzle[k]);\n            k++;\n        }\n        printf(\"\\n\");\n    }\n\n    free(cpyPuzzle);\n}\nvoid notFound(char *fileN)\n{\n    printf(\"In file %s %c was not found.\\n\", test.userWord, fileN);\n    printf(\"You can try finding another word\");\n    printf(\" by pressing the option to show puzzle and\\n\");\n    printf(\"then the option to find a word, once you've found one.\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "command-line-arguments"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 3, "creation_date": 1481145769, "post_id": 41027594, "comment_id": 69262642, "body": "your function declaration doesn&#39;t match your definition. <code>(char, char)</code> is not the same as <code>(const char*, const char*)</code>. And <code>first</code> is an <code>int</code>, so you won&#39;t be able to pass that to either version."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 3, "creation_date": 1481145898, "post_id": 41027594, "comment_id": 69262700, "body": "Turn on your compiler warnings.  Pay attention to them too."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1481146164, "last_edit_date": 1481146164, "creation_date": 1481145853, "answer_id": 41027629, "question_id": 41027594, "link": "https://stackoverflow.com/questions/41027594/undefined-reference-to-startswith/41027629#41027629", "title": "Undefined reference to `startswith&#39;", "body": "<p>Your declaration and definition of <code>startswith</code> are incompatible.</p>\n\n<p>The declaration has two parameters of type <code>char</code>, but the function actually has two parameters of type <code>const char *</code>.  </p>\n\n<p>You also defined <code>startswith</code> <em>inside</em> of <code>main</code>.  Functions cannot be nested.</p>\n\n<p>Because no function exists that matches the declaration, you have an undefined reference.</p>\n\n<p>Fix your declaration to match the definition.</p>\n\n<pre><code>int startswith( const char *, const char *);\n</code></pre>\n\n<p>You're also not calling this function correctly.  You pass in an <code>int</code> and a <code>char</code>.  It should be called like this:</p>\n\n<pre><code>if(startswith(argv[1],\".\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9301001, "user_type": "registered", "profile_image": "https://graph.facebook.com/1284219108363355/picture?type=large", "display_name": "Devendra Yadav", "link": "https://stackoverflow.com/users/9301001/devendra-yadav"}, "is_accepted": false, "score": 0, "last_activity_date": 1579595186, "last_edit_date": 1579595186, "creation_date": 1579591984, "answer_id": 59836135, "question_id": 41027594, "link": "https://stackoverflow.com/questions/41027594/undefined-reference-to-startswith/59836135#59836135", "title": "Undefined reference to `startswith&#39;", "body": "<pre><code>Try replacing int startswith(char,char); with below \n\nstatic inline const char *startwith(const char *s, const char *prefix)\n{\n    size_t sz = prefix ? strlen(prefix) : 0;\n    if(s &amp;&amp; sz &amp;&amp; strncmp(s, prefix, sz) == 0){\n        return s+sz;\n    }\n\n    return NULL;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7132786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e0ba2abbe8b51d58271445caddb736?s=128&d=identicon&r=PG&f=1", "display_name": "Amanda Vallet", "link": "https://stackoverflow.com/users/7132786/amanda-vallet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1579595186, "creation_date": 1481145698, "last_edit_date": 1481148218, "question_id": 41027594, "link": "https://stackoverflow.com/questions/41027594/undefined-reference-to-startswith", "title": "Undefined reference to `startswith&#39;", "body": "<p>I am writing some <code>C</code> in which the program is going to convert the first command line argument into a int and check to see if it is an int. If it isnt a integer value it will then attempt to check to see whether the string begins with a '.' character or not. For some reason I am getting an undefined reference. <br/>How is this an undefined reference when it seems to be defined?</p>\n\n<p>Here is the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\nint startswith(char,char);\n\nint main(int argc, char * argv[]) {\n    int forst;\n    srand(time(NULL));\n    int speed_delay = rand() % 20;\n    printf(\"The speed delay is:%i\\n\", speed_delay);\n    int first = atoi(argv[1]);\n    printf(\"First:%i\\n\", first);\n\n    if (first == 0) {\n        //this means text was inserted instead of a number\n        if (startswith(first, '.')) {\n            printf(\"string starts with a period !\");\n\n        }\n    } else {\n\n    }\n\n    int startswith(const char * one,\n        const char * two) {\n        if (strncmp(one, two, strlen(two)) == 0) {\n            return 1;\n        }\n        return 0;\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26715, "user_id": 137080, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/86bdc5ff5eee5288200118aeebf680d0?s=128&d=identicon&r=PG", "display_name": "Williham Totland", "link": "https://stackoverflow.com/users/137080/williham-totland"}, "edited": false, "score": 2, "creation_date": 1481145214, "post_id": 41027456, "comment_id": 69262337, "body": "You just wrinkled my brain."}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1481145336, "post_id": 41027456, "comment_id": 69262412, "body": "If <code>*</code> is a suffix operator, then the compiler won&#39;t know what <code>x*=value</code>mean. Is it <code>x = x * value</code> or <code>(x*) = value</code>? But in prefix this it not ambiguous. <code>*x=value</code> will assign <code>value</code> to the memory pointed by <code>x</code> while <code>x*=value</code> will multiply <code>x</code> by <code>value</code> and store result in <code>x</code>."}, {"owner": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "edited": false, "score": 0, "creation_date": 1481145346, "post_id": 41027456, "comment_id": 69262418, "body": "How would the multiply operator be described otherwise?"}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1481145542, "post_id": 41027456, "comment_id": 69262518, "body": "Oh and try to rewrite <code>*x*=*x</code> if <code>*</code> is a suffix."}, {"owner": {"reputation": 134595, "user_id": 140740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6eddcd47c263a1a5d31bdb4f7b6424?s=128&d=identicon&r=PG", "display_name": "DigitalRoss", "link": "https://stackoverflow.com/users/140740/digitalross"}, "edited": false, "score": 1, "creation_date": 1481145737, "post_id": 41027456, "comment_id": 69262628, "body": "Good question. A suffix operator would have eliminated the need for <code>-&gt;</code>. Say it was <code>^</code>. Then, like at least one other language: <code>ptr^.field</code>"}, {"owner": {"reputation": 134595, "user_id": 140740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6eddcd47c263a1a5d31bdb4f7b6424?s=128&d=identicon&r=PG", "display_name": "DigitalRoss", "link": "https://stackoverflow.com/users/140740/digitalross"}, "edited": false, "score": 1, "creation_date": 1481145831, "post_id": 41027456, "comment_id": 69262666, "body": "And ambiguity with <code>*</code> isn&#39;t the answer. First of all, <i>originally there was no</i> <code>*=</code>, that operation existed but it was written <code>x =* y</code>.  A different character could have been used. Ambiguities are resolvable, etc..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1481146251, "post_id": 41027456, "comment_id": 69262876, "body": "This is one of these questions where the most natural answer is &quot;Why not?&quot;"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 4, "creation_date": 1481146921, "post_id": 41027456, "comment_id": 69263209, "body": "For what it&#39;s worth, it <b>already has</b> an alias suffix form: <code>[0]</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481148685, "post_id": 41027456, "comment_id": 69264045, "body": "<code>[]</code> and <code>.</code> are binary operators .  <code>*</code> (dereference) is a unary operator. While the operand order is arbitrary in both cases, it&#39;s not valid to use one case to reason about the other."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481148797, "post_id": 41027456, "comment_id": 69264102, "body": "The way it is now, all unary operators are prefix, except for postfix-increment (which only has to exist because prefix-increment is already taken). You could argue that is more consistent than having some prefix and some postfix. Would you want to see <code>5-</code> instead of <code>-5</code> , or <code>x!</code> for boolean negation?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481149484, "post_id": 41027456, "comment_id": 69264394, "body": "@M.M I guess it&#39;s good that there&#39;s no built-in factorial operator. :)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1481149513, "post_id": 41027456, "comment_id": 69264402, "body": "The prefix <code>*</code> came from the B language, which was the inspiration for C."}], "answers": [{"comments": [{"owner": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "edited": false, "score": 3, "creation_date": 1481145432, "post_id": 41027519, "comment_id": 69262476, "body": "<code>int *c = 3;</code> seems invalid"}, {"owner": {"reputation": 2040, "user_id": 5939079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d6ff8fc2f032cf9d4e34de6eb60940?s=128&d=identicon&r=PG&f=1", "display_name": "cokceken", "link": "https://stackoverflow.com/users/5939079/cokceken"}, "reply_to_user": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "edited": false, "score": 0, "creation_date": 1481145548, "post_id": 41027519, "comment_id": 69262523, "body": "i added memory allocation"}, {"owner": {"reputation": 11262, "user_id": 3580294, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GODPL.jpg?s=128&g=1", "display_name": "awksp", "link": "https://stackoverflow.com/users/3580294/awksp"}, "reply_to_user": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "edited": false, "score": 3, "creation_date": 1481145560, "post_id": 41027519, "comment_id": 69262531, "body": "@AdityaGulavani It&#39;s technically valid, just probably not sensical"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1481145586, "post_id": 41027519, "comment_id": 69262543, "body": "still that&#39;s based on using <code>*</code>. say we use <code>-&gt;</code> with no right hand side to mean &quot;deference the whole thing&quot; then it&#39;s totally usable."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 11262, "user_id": 3580294, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GODPL.jpg?s=128&g=1", "display_name": "awksp", "link": "https://stackoverflow.com/users/3580294/awksp"}, "edited": false, "score": 0, "creation_date": 1481145739, "post_id": 41027519, "comment_id": 69262630, "body": "@awksp; <code>int *c = 3; *c = 3</code> can blow up your system."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 11262, "user_id": 3580294, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GODPL.jpg?s=128&g=1", "display_name": "awksp", "link": "https://stackoverflow.com/users/3580294/awksp"}, "edited": false, "score": 2, "creation_date": 1481145840, "post_id": 41027519, "comment_id": 69262673, "body": "@awksp: It&#39;s not even technically valid. While <i>casts</i> from integer to pointer types are implementation-defined, there is no implicit conversion at all; it&#39;s a constraint violation. Compilers are just bad about enforcing this."}, {"owner": {"reputation": 11262, "user_id": 3580294, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GODPL.jpg?s=128&g=1", "display_name": "awksp", "link": "https://stackoverflow.com/users/3580294/awksp"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1481146387, "post_id": 41027519, "comment_id": 69262940, "body": "@R.. I didn&#39;t know that! ~~Surprised that clang didn&#39;t give anything more than a warning.~~ Bad at enforcing this, indeed. Something about saying how this is an error instead of warning about a conversion would be nice. Guess I have to change what I said to &quot;it&#39;s valid in that it compiles, ...&quot;"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 11262, "user_id": 3580294, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GODPL.jpg?s=128&g=1", "display_name": "awksp", "link": "https://stackoverflow.com/users/3580294/awksp"}, "edited": false, "score": 0, "creation_date": 1481148926, "post_id": 41027519, "comment_id": 69264167, "body": "@awksp you could get in the habit of compiling in standard mode, e.g. <code>-std=c11 -pedantic</code>.  Compilers tend to default to a mode that is not going to throw new errors for codebases that compiled cleanly on older versions"}, {"owner": {"reputation": 11262, "user_id": 3580294, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GODPL.jpg?s=128&g=1", "display_name": "awksp", "link": "https://stackoverflow.com/users/3580294/awksp"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481150220, "post_id": 41027519, "comment_id": 69264722, "body": "@M.M I usually do, but it didn&#39;t occur to me that I should be doing that for quick tests."}, {"owner": {"reputation": 134595, "user_id": 140740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6eddcd47c263a1a5d31bdb4f7b6424?s=128&d=identicon&r=PG", "display_name": "DigitalRoss", "link": "https://stackoverflow.com/users/140740/digitalross"}, "edited": false, "score": 1, "creation_date": 1542020688, "post_id": 41027519, "comment_id": 93405919, "body": "Actually, when the prefix choice was made, <code>*=</code> did not exist, it was only <code>=*</code> in early C. So, it wasn&#39;t ambiguity, it was just existing practice <i>(copied it from B)</i>  retained by choice. It could have been a suffix, it just wasn&#39;t designed that way. Also, compilers aren&#39;t &quot;bad&quot; at enforcing the type system; they allow unsafe code in order to process type aliasing written before -- or in spite of -- the later stricter type rules as C evolved. Somewhere, there <i>could</i> be a firmware ROM where <code>int *c = 3</code> makes sense, but there probably isn&#39;t."}, {"owner": {"reputation": 2040, "user_id": 5939079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d6ff8fc2f032cf9d4e34de6eb60940?s=128&d=identicon&r=PG&f=1", "display_name": "cokceken", "link": "https://stackoverflow.com/users/5939079/cokceken"}, "reply_to_user": {"reputation": 134595, "user_id": 140740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6eddcd47c263a1a5d31bdb4f7b6424?s=128&d=identicon&r=PG", "display_name": "DigitalRoss", "link": "https://stackoverflow.com/users/140740/digitalross"}, "edited": false, "score": 0, "creation_date": 1542635540, "post_id": 41027519, "comment_id": 93627778, "body": "wow, thank you for detailed information @DigitalRoss"}], "tags": [], "owner": {"reputation": 2040, "user_id": 5939079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d6ff8fc2f032cf9d4e34de6eb60940?s=128&d=identicon&r=PG&f=1", "display_name": "cokceken", "link": "https://stackoverflow.com/users/5939079/cokceken"}, "is_accepted": false, "score": 3, "last_activity_date": 1481145541, "last_edit_date": 1481145541, "creation_date": 1481145362, "answer_id": 41027519, "question_id": 41027456, "link": "https://stackoverflow.com/questions/41027456/why-is-pointer-dereference-a-prefix-operator-in-c/41027519#41027519", "title": "Why is pointer dereference a prefix operator in C?", "body": "<pre><code>int *c = malloc(sizeof(int));\n*c=3; //clear statement\nc*=3; //would be ambiguous\n</code></pre>\n\n<p>I don't know why C implemented in this way but this is the first thing i think of.</p>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1481149425, "post_id": 41027775, "comment_id": 69264371, "body": "DMR didn&#39;t make this choice, he just copied it from B."}, {"owner": {"reputation": 134595, "user_id": 140740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6eddcd47c263a1a5d31bdb4f7b6424?s=128&d=identicon&r=PG", "display_name": "DigitalRoss", "link": "https://stackoverflow.com/users/140740/digitalross"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1542019249, "post_id": 41027775, "comment_id": 93405134, "body": "Thanks, good point.   Strictly speaking, of course, &quot;copied from B&quot; and &quot;just made a choice&quot; are not mutually exclusive statements."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1542042329, "post_id": 41027775, "comment_id": 93417857, "body": "Technically true. When he was designing C and based it on B, he chose to leave this part alone."}], "tags": [], "owner": {"reputation": 134595, "user_id": 140740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6eddcd47c263a1a5d31bdb4f7b6424?s=128&d=identicon&r=PG", "display_name": "DigitalRoss", "link": "https://stackoverflow.com/users/140740/digitalross"}, "is_accepted": false, "score": 1, "last_activity_date": 1542020109, "last_edit_date": 1542020109, "creation_date": 1481146402, "answer_id": 41027775, "question_id": 41027456, "link": "https://stackoverflow.com/questions/41027456/why-is-pointer-dereference-a-prefix-operator-in-c/41027775#41027775", "title": "Why is pointer dereference a prefix operator in C?", "body": "<p>It could have been a suffix. That was the case in Pascal and it worked out well there. In the end, dmr just made a choice and wrote it that way.</p>\n\n<p><em>Suffix Pros:</em><br>\n  &nbsp;&nbsp;&nbsp;No need for <code>-&gt;</code><br>\n  &nbsp;&nbsp;&nbsp;Left-to-right expression flow</p>\n\n<p><em>Suffix Cons:</em><br>\n  &nbsp;&nbsp;&nbsp;<em>Maybe</em> more ambiguity, depending<br>\n  &nbsp;&nbsp;&nbsp;Declarations read a little less left-to-right</p>\n"}], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "closed_date": 1481147662, "answer_count": 2, "score": 2, "last_activity_date": 1542020109, "creation_date": 1481145115, "question_id": 41027456, "link": "https://stackoverflow.com/questions/41027456/why-is-pointer-dereference-a-prefix-operator-in-c", "closed_reason": "Opinion-based", "title": "Why is pointer dereference a prefix operator in C?", "body": "<p>Why was the pointer dereference operator <code>*</code> designed to be a prefix operator while the other designator selectors, array element selector <code>[i]</code> and record field selector <code>.f</code>, use suffix operators. With only suffix selectors their individual precedence is not an issue.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1481145128, "post_id": 41027392, "comment_id": 69262294, "body": "int main (int argc, char* argv[]) ==&gt;&gt;&gt; int main (void). Because are not needed"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1481145430, "post_id": 41027392, "comment_id": 69262473, "body": "I think your file isn&#39;t a plain text file. Try using a hex dump utility to examine it."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1481145934, "post_id": 41027392, "comment_id": 69262719, "body": "UTF8-BOM?......"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481146296, "post_id": 41027392, "comment_id": 69262902, "body": "Works perfectly well with my simple text file containing <code>abcdefghijklmnopqrstuvwxyz</code>. Except when the file does not exist, or there is not enough memory available, or less than <code>num</code> bytes were read from file."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7264506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d76cd2ddabde837b271fe29db604cb7b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel S.", "link": "https://stackoverflow.com/users/7264506/marcel-s"}, "edited": false, "score": 0, "creation_date": 1481184613, "post_id": 41027836, "comment_id": 69276425, "body": "That solved my problem. Never heard about BOM before. I am using notepad++ and your hint and the settings for Notepad++ explained in this <a href=\"http://stackoverflow.com/questions/8432584/how-to-make-notepad-to-save-text-in-utf-8-without-bom\">answer</a> made it also run on my machine. Thanks!"}], "tags": [], "owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1481146676, "creation_date": 1481146676, "answer_id": 41027836, "question_id": 41027392, "link": "https://stackoverflow.com/questions/41027392/store-text-from-file-in-character-array-using-fread/41027836#41027836", "title": "Store text from file in character array using fread()", "body": "<p>The issue is that your file is encoded using UTF-8. While UTF-8 is backwards-compatible with ASCII (which is what your code will be using) there are many differences. </p>\n\n<p>In particular, many programs will put a BOM (Byte Order Mark) symbol at the start of the file to indicate which direction the bytes go. If you print the BOM using the default windows code page, you get the two symbols you saw.</p>\n\n<p>Whatever program you used to create your text file was automatically inserting that BOM at the start of the file. Notepad++ is notorious for doing this. Check the save options and make sure to save either as plain ASCII or as UTF-8 without BOM. That will solve your problem.</p>\n"}], "owner": {"reputation": 13, "user_id": 7264506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d76cd2ddabde837b271fe29db604cb7b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel S.", "link": "https://stackoverflow.com/users/7264506/marcel-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 41027836, "answer_count": 1, "score": 0, "last_activity_date": 1515929210, "creation_date": 1481144897, "last_edit_date": 1515929210, "question_id": 41027392, "link": "https://stackoverflow.com/questions/41027392/store-text-from-file-in-character-array-using-fread", "title": "Store text from file in character array using fread()", "body": "<p>Here is a minimal \"working\" example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main (int argc, char* argv[])\n{\n    int num = 10;\n\n    FILE* fp = fopen(\"test.txt\", \"r\");     // test.txt contains character sequence\n\n    char* ptr = (char*) malloc(sizeof (char)*(num+1));  // +1 for '\\0'\n\n    fread(ptr, sizeof(char), num, fp);      // read bytes from file\n    ptr[num] = '\\0';\n\n    printf(\"%s\\n\", ptr);        // output: \u00b4\u2557\u2510abcdefg\n\n    free(ptr);\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n\n<p>I would like to read some letters from a text file, containing all letters from the alphabet in a single line. I want my array to store the first 10 letters, but the first 3 shown in the output are weird symbols (see the comment at the printf statement).</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "arrays", "for-loop", "type-conversion"], "answers": [{"comments": [{"owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "edited": false, "score": 1, "creation_date": 1481145602, "post_id": 41027531, "comment_id": 69262555, "body": "sorry if my questain is confusing, I mean val[8] contains the hex value of 78661EB54FE76763 and this is what I am trying to split."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "edited": false, "score": 0, "creation_date": 1481145693, "post_id": 41027531, "comment_id": 69262603, "body": "<code>val[8]</code> does not contain anything, it is a stepping stone. Your question asked how to split that value into 2 unsigned ints and this answer does it without any need for an 8-byte char array."}, {"owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "edited": false, "score": 1, "creation_date": 1481146162, "post_id": 41027531, "comment_id": 69262832, "body": "Sorry that code is confusing, I was filling BYTE val[8] with the value. I am  trying to split BYTE val[8]. I have made example less confusing"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1481145404, "creation_date": 1481145404, "answer_id": 41027531, "question_id": 41027258, "link": "https://stackoverflow.com/questions/41027258/divide-contents-of-a-unsigned-char-array-into-2-halves/41027531#41027531", "title": "Divide contents of a unsigned char array into 2 halves", "body": "<p>Your variable <code>long long hex</code> is not a \"char array\", but you can try something like this, notice unsigned types throughout.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint main(void)\n{\n    uint64_t hex = 0x78661EB54FE76763;\n    uint32_t lo, hi;\n\n    hi = hex &gt;&gt; 32;\n    lo = hex &amp; 0xFFFFFFFF;\n    printf(\"%08X %08X\\n\", hi, lo);\n    return 0;\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre><code>78661EB5 4FE76763\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1527599866, "post_id": 41029000, "comment_id": 88179952, "body": "If you like to pose puzzles, you should make them solvable, what they are not really if a symbol TBD is used for different values."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1481152052, "creation_date": 1481152052, "answer_id": 41029000, "question_id": 41027258, "link": "https://stackoverflow.com/questions/41027258/divide-contents-of-a-unsigned-char-array-into-2-halves/41029000#41029000", "title": "Divide contents of a unsigned char array into 2 halves", "body": "<p>Create a helper function that takes a pointer to an array of <code>unsigned char</code> and call it twice.</p>\n\n<p>Left some things out for OP to discover.</p>\n\n<pre><code>unsigned long form_big_endian4(const unsigned char * x) {\n  unsigned long y = TBB;           // What should the initial value be?\n  for (int i = 0; i &lt; TBD; i++) {  // How many times to loop?\n    y *= TBD;                      // Hint: max value of 8 bits + 1\n    y += x[i];                     \n  }\n  return y;\n}\n\n#include &lt;stdio.h&gt;\nint main(void) {\n  const unsigned char val[8] =\n      { 0x78, 0x66, 0x1E, 0xB5, 0x4F, 0xE7, 0x67, 0x63 };\n  unsigned long half = form_big_endian4(val); // Why long: Hint how small can unsigned be?\n  printf(\"%08lX\\n\", half);                    // Why 0 in format? Why `lX`?\n  half = form_big_endian4(val + TBD);         // How far an offset?\n  printf(\"%08lX\\n\", half);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 532, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1481152052, "creation_date": 1481144366, "last_edit_date": 1481146237, "question_id": 41027258, "link": "https://stackoverflow.com/questions/41027258/divide-contents-of-a-unsigned-char-array-into-2-halves", "title": "Divide contents of a unsigned char array into 2 halves", "body": "<p>I am wondering if anyone can help me I am only learning c, I am trying to Divide contents of a unsigned char array into 2 halves, which the result can stored in two unsigned int's,</p>\n\n<p>For example purposes, I have some code below which adds a hex value into a BYTE array, so How would split the contents of val[] into two but keep the same order</p>\n\n<pre><code>#include &lt;stdio.h&gt;\ntypedef unsigned char BYTE;\nint main()\n{\n    // Sample purposes putting hex into val[8]\n    int i,j;\n    long long hex=0x78661EB54FE76763;\n    BYTE val[8];\n\n    for(j=0,i=7; i&gt;=0; i--,j++){\n        val[j]= (hex&gt;&gt;(i*8))&amp;0xff;\n    }       \n\n    // How to split the contents of val[8] which now holds the hex\n\n    return 0;  \n}\n</code></pre>\n\n<p>I am trying to split the hex value into 78661EB5, 4FE76763 and store each one inside an unsigned int which is stored inside val[8] in my example</p>\n"}, {"tags": ["c", "pointers", "compiler-errors", "constants"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1481143874, "post_id": 41027067, "comment_id": 69261563, "body": "You should do it outside of <code>main</code>, as the addresses have to be constant, I.e. have a static storage class. And defining types inside of <code>main</code> is a bad idea by itself."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1481143989, "post_id": 41027067, "comment_id": 69261633, "body": "works fine outside the <code>main</code> function."}, {"owner": {"reputation": 744, "user_id": 6913016, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0b6177616ddaeed18dab5860e52d112a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/6913016/sergio"}, "edited": false, "score": 0, "creation_date": 1481144037, "post_id": 41027067, "comment_id": 69261658, "body": "Thanks a lot! That solves the problem. If you want, post it like an answer instead of a comment so I can mark it as an accepted answer."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1481144121, "post_id": 41027067, "comment_id": 69261728, "body": "works fine as-is with gcc, though. The answer below explains why."}], "answers": [{"comments": [{"owner": {"reputation": 744, "user_id": 6913016, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0b6177616ddaeed18dab5860e52d112a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/6913016/sergio"}, "edited": false, "score": 0, "creation_date": 1481145022, "post_id": 41027186, "comment_id": 69262247, "body": "Hi, thanks for the answer. I find your explanation a bit hard to understand, in part because English is not my principal language and maybe I don&#39;t have the knowledge necessary. But I understand that the problem is that my compiler is an old one and requires constants to be initialized outside the main. If you are interested, I am using Keil uVision4. Thank you again for the explanation!"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 744, "user_id": 6913016, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0b6177616ddaeed18dab5860e52d112a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/6913016/sergio"}, "edited": false, "score": 0, "creation_date": 1481146850, "post_id": 41027186, "comment_id": 69263168, "body": "@Sergio: Your compiler is not necessarily &quot;old&quot;. It might simply be configured to pedantically enforce the rules of &quot;classic&quot; C language standard from 1989. Whether it is its &quot;natural&quot; configuration - I don&#39;t really know."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 2, "last_activity_date": 1481144361, "last_edit_date": 1481144361, "creation_date": 1481144059, "answer_id": 41027186, "question_id": 41027067, "link": "https://stackoverflow.com/questions/41027067/expression-must-have-a-constant-value-error-in-c/41027186#41027186", "title": "Expression must have a constant value (Error in C)", "body": "<p>There's nothing wrong with your code from the point of view of modern C language.</p>\n\n<p>But if you are using a very pedantic old C89/90 compiler, it will insist on all aggregate initializers to be made up from <em>constant expressions</em>. This will prevent you from using addresses of local objects in such initializers, since such addresses are not constants.</p>\n\n<p>This restriction has been lifted in C99: aggregate initializers for automatic objects are no longer restricted to constant expressions only.</p>\n\n<p>However, every C89/90 compiler I know has been ignoring that restriction and supporting the modern behavior since the beginning of times. Could it be that your compiler is deliberately configured for very pedantic enforcement of C89/90 rules?</p>\n"}], "owner": {"reputation": 744, "user_id": 6913016, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0b6177616ddaeed18dab5860e52d112a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/6913016/sergio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 0, "accepted_answer_id": 41027186, "answer_count": 1, "score": 1, "last_activity_date": 1481144361, "creation_date": 1481143607, "last_edit_date": 1481144327, "question_id": 41027067, "link": "https://stackoverflow.com/questions/41027067/expression-must-have-a-constant-value-error-in-c", "title": "Expression must have a constant value (Error in C)", "body": "<p>This is my code:</p>\n\n<pre><code>int main (void) {\n\n    struct state\n    {\n        int output;\n        int time;\n        const struct state *next[4];\n    };\n\n    typedef const struct state state_t;\n\n    # define wait1noclick &amp;fsm[0]\n    # define fast2 &amp;fsm[1]\n    # define wait2noclick &amp;fsm[2]\n    # define fast1 &amp;fsm[3]\n    # define wait1click &amp;fsm[4]\n    # define wait1 &amp;fsm[5]\n    # define wait2click &amp;fsm[6]\n    # define wait2 &amp;fsm[7]\n\n    state_t fsm[8] = \n    {\n        {0xC, 600, {wait1noclick, fast2, wait1click, fast2}},\n        {0x1, 150, {fast2, wait2noclick, fast2, wait2noclick}},\n        {0x3, 600, {wait2noclick, fast1, wait2click, fast1}},\n        {0x4, 150, {fast1, wait1noclick, fast1, wait1noclick}},\n        {0x8, 200, {wait1click, wait1, wait1click, wait1}},\n        {0x5, 200, {wait1, fast2, wait1, fast2}},\n        {0x2, 200, {wait2click, wait2, wait2click, wait2}},\n        {0xA, 200, {wait2, fast1, wait2, fast1}}\n    };\n}\n</code></pre>\n\n<p>It is suposed to compile without problems but I am getting this error message all the time, 4 times in each \"fsm\" row:</p>\n\n<pre><code>error: #28: expression must have a constant value\n</code></pre>\n\n<p>Does anyone know what I am doing wrong?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481143186, "post_id": 41026830, "comment_id": 69261169, "body": "<code>char *myArrayPtr = &amp;myArray;</code> is wrong. Check your compiler messages, if you don&#39;t see any then you need to configure the error/warning level.  You need to understand this case before moving onto the 2-D array case."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1481143440, "post_id": 41026830, "comment_id": 69261298, "body": "Please do not try to correct the question in response to comments, unless to add clarity."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1481143490, "post_id": 41026830, "comment_id": 69261325, "body": "In <code>C</code> arrays are just pointers. There is no difference between a pointer to a single dimensional array of <code>char</code> and a pointer to a multi dimensional one. They are both <code>char*</code> values."}, {"owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "edited": false, "score": 0, "creation_date": 1481143510, "post_id": 41026830, "comment_id": 69261340, "body": "I&#39;m sorry i had a warning, noticed the comment, and edited the question."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1481143650, "post_id": 41026830, "comment_id": 69261419, "body": "@SunKnight0 there is. The compiler has no idea how to resolve the row length a 2-D array from <code>char*</code>. Assigning  a <code>char*</code> from the 2-D array generates a compiler warning."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1481143699, "post_id": 41026830, "comment_id": 69261438, "body": "You can access <code>myArray[x][y]</code> as <code>myArrayPtr[x*100+y]</code>"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481143873, "post_id": 41026830, "comment_id": 69261562, "body": "@Weather Vane: It is exactly because there is no difference that the compiler cannot do that. A pointer to a multi-dimensional array is still a <code>char*</code> type variable. If the question was on how to get back to a multi-dimensional array from a pointer to it that would be another, and much more complicated, discussion."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1481143930, "post_id": 41026830, "comment_id": 69261594, "body": "where&#39;s Olaf? He&#39;s usually Johnny-on-the-spot about discrepancies between arrays and pointers: <a href=\"http://www.c-faq.com/aryptr/index.html\" rel=\"nofollow noreferrer\">c-faq.com/aryptr/index.html</a>"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 1, "creation_date": 1481144049, "post_id": 41026830, "comment_id": 69261663, "body": "@SunKnight0; In C, pointer are not arrays and arrays are not pointers."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1481144249, "post_id": 41026830, "comment_id": 69261806, "body": "This seems like an unusual way to initialize an array of <code>char</code>s. Usually it seems that we see <code>myArray[100] = &quot;&quot;</code> or <code>myArray[100] = {&#39;\\0&#39;}</code>. Do the bracket delimiters in the OP&#39;s example place the empty string literal in a block?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1481144948, "post_id": 41026830, "comment_id": 69262211, "body": "@DavidBowling;  Yes it does. Extra braces will do no harm. C11-<b>&#167;6.7.9/14</b>: <i>&quot;An array of character type may be initialized by a character string literal or UTF\u22128 string literal, <b>optionally enclosed in braces</b>&quot;</i>"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1481145508, "post_id": 41026830, "comment_id": 69262506, "body": "@haccks-- thanks for the citation. So it is not a block, but rather part of the syntax for initializing character arrays. Extra braces may do harm in this case: note that <code>myArray[100] = {{&quot;&quot;}}</code> will not compile!"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1481145893, "post_id": 41026830, "comment_id": 69262698, "body": "@DavidBowling; <code>myArray[100] = {{&quot;&quot;}}</code> will not compile because seeing initializer list <code>{{}}</code>, compiler expects a 2D array."}], "answers": [{"comments": [{"owner": {"reputation": 585, "user_id": 7039091, "user_type": "registered", "profile_image": "https://graph.facebook.com/1228413217190279/picture?type=large", "display_name": "yLaguardia", "link": "https://stackoverflow.com/users/7039091/ylaguardia"}, "edited": false, "score": 0, "creation_date": 1481145214, "post_id": 41027082, "comment_id": 69262339, "body": "One could further simplify things with a typedef: <code>typedef char array2d[100];</code>, <code>array2d myArray[10] = {&quot;&quot;};</code> <code>array2d *myArrayPtr = myArray;</code>"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 585, "user_id": 7039091, "user_type": "registered", "profile_image": "https://graph.facebook.com/1228413217190279/picture?type=large", "display_name": "yLaguardia", "link": "https://stackoverflow.com/users/7039091/ylaguardia"}, "edited": false, "score": 1, "creation_date": 1481145283, "post_id": 41027082, "comment_id": 69262382, "body": "@yLaguardia; In case of pointers and arrays, <code>typedef</code> just obfuscate the code."}, {"owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "edited": false, "score": 0, "creation_date": 1481145348, "post_id": 41027082, "comment_id": 69262421, "body": "@haccks Thank you this really helped, now this may be off topic but is there a way to allocated memory space for the 2 dimensional array pointer?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "edited": false, "score": 0, "creation_date": 1481145389, "post_id": 41027082, "comment_id": 69262445, "body": "@bodotheguy; Do you mean how to dynamically allocate 2D arrays?"}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 5, "last_activity_date": 1481143670, "creation_date": 1481143670, "answer_id": 41027082, "question_id": 41026830, "link": "https://stackoverflow.com/questions/41026830/how-can-i-set-a-pointer-to-a-2-d-array/41027082#41027082", "title": "How can i set a pointer to a 2-D array", "body": "<p>In case of   </p>\n\n<pre><code>char myArray[100] = {\"\"};  \n</code></pre>\n\n<p><code>char *myArrayPtr = myArray;</code> works because <code>myArray</code> decays<sup>1</sup> to pointer to its first element. Its type after decay is <code>char *</code>.</p>\n\n<p>In case of </p>\n\n<pre><code>char myArray[10][100] = {\"\"}; \n</code></pre>\n\n<p><code>char *myArrayPtr = myArray;</code> won't work because after decay <code>myArray</code> will point to its first element and its type after decay is <code>char (*)[100]</code>.  </p>\n\n<p>To make types compatible <code>myArrayPtr</code> should be of the same type.  </p>\n\n<pre><code>char (*myArrayPtr)[100] = myArray; \n</code></pre>\n\n<hr>\n\n<p><sub>1 Array to pointer conversion takes place when array used in an expression except when it is an operand of <code>sizeof</code> and unary <code>&amp;</code> operator.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481145854, "post_id": 41027261, "comment_id": 69262684, "body": "<code>int *b=a;</code> is an error. <code>char **d=&amp;c;</code> is an error. Your program output is undefined behaviour."}], "tags": [], "owner": {"reputation": 1139, "user_id": 4954434, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/820014a12e2c692ff8cd170a33a60141?s=128&d=identicon&r=PG", "display_name": "Jithin Pavithran", "link": "https://stackoverflow.com/users/4954434/jithin-pavithran"}, "is_accepted": false, "score": 0, "last_activity_date": 1481144691, "last_edit_date": 1481144691, "creation_date": 1481144376, "answer_id": 41027261, "question_id": 41026830, "link": "https://stackoverflow.com/questions/41026830/how-can-i-set-a-pointer-to-a-2-d-array/41027261#41027261", "title": "How can i set a pointer to a 2-D array", "body": "<p>Two-dimensional arrays are no different from one-dimensional arrays as far as memory allocation is concerned.<br>\nPossibly following code will clear all your confusions:</p>\n\n<pre><code>int a[3][3]={{0,1,2},\n             {3,4,5},\n             {6,7,8}};\nchar *c[3][3]={{\"00\",\"11\",\"22\"},\n               {\"33\",\"44\",\"55\"},\n               {\"66\",\"77\",\"88\"}};\nint *b=a;\nprintf(\"a[0][0]: %d\\ta[0][1]: %d\\ta[0][1]: %d\\n\", *(b+3*0+0), *(b+3*0+1), *(b+3*0+2));\nprintf(\"a[1][0]: %d\\ta[1][1]: %d\\ta[1][1]: %d\\n\", *(b+3*1+0), *(b+3*1+1), *(b+3*1+2));\nprintf(\"a[2][0]: %d\\ta[2][1]: %d\\ta[2][1]: %d\\n\", *(b+3*2+0), *(b+3*2+1), *(b+3*2+2));\nchar **d=&amp;c;\nprintf(\"c[0][0]: %s\\tc[0][1]: %s\\tc[0][1]: %s\\n\", (*d+9*0+0), (*d+9*0+3), (*d+9*0+6));\nprintf(\"c[1][0]: %s\\tc[1][1]: %s\\tc[1][1]: %s\\n\", (*d+9*1+0), (*d+9*1+3), (*d+9*1+6));\nprintf(\"c[2][0]: %s\\tc[2][1]: %s\\tc[2][1]: %s\\n\", (*d+9*2+0), (*d+9*2+3), (*d+9*2+6));\n</code></pre>\n\n<p>will give an output:</p>\n\n<pre><code>a[0][0]: 0  a[0][1]: 1  a[0][1]: 2\na[1][0]: 3  a[1][1]: 4  a[1][1]: 5\na[2][0]: 6  a[2][1]: 7  a[2][1]: 8\nc[0][0]: 00 c[0][1]: 11 c[0][1]: 22\nc[1][0]: 33 c[1][1]: 44 c[1][1]: 55\nc[2][0]: 66 c[2][1]: 77 c[2][1]: 88\n</code></pre>\n\n<p>Note that I used <code>(*d+9*1+6)</code> instead of <code>(*d+3*1+2)</code>. This is because each string is 3 char long (including <code>\\0</code>).  </p>\n\n<p>Also note that you will get warnings for the assignment statements(<code>int *b=a; and</code>char <code>**d=&amp;c;</code>). This example is just for your clarity about how memory is allocated. </p>\n"}], "owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 41027082, "answer_count": 2, "score": 0, "last_activity_date": 1481144691, "creation_date": 1481142645, "last_edit_date": 1481143233, "question_id": 41026830, "link": "https://stackoverflow.com/questions/41026830/how-can-i-set-a-pointer-to-a-2-d-array", "title": "How can i set a pointer to a 2-D array", "body": "<p>just want to say thank in advance. I understand that i can set a pointer to an array by example:</p>\n\n<pre><code>char myArray[100] = {\"\"};\nchar *myArrayPtr = myArray;\n</code></pre>\n\n<p>But i am confused about how to point to a multi dimensional array. For example.</p>\n\n<pre><code>char myArray[10][100] = {\"\"}; \nchar *myArrayPtr = myArray;\n</code></pre>\n\n<p>My thinking is that these are the same thing except the second one is a tad bit different. The first is a pointer pointing to an array that has a size of [100], and the second is a poitner pointing to first row of the multidimensional array. Is that the correct way of thought? If so, how can i make the second pointer point to the entire multidimensional array?</p>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1481142668, "post_id": 41026812, "comment_id": 69260910, "body": "Keys that do not represent printable characters (like the left-arrow key) don&#39;t <i>have</i> ASCII codes."}, {"owner": {"reputation": 15, "user_id": 5618953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d65d696501de7be4e80387147a66a910?s=128&d=identicon&r=PG&f=1", "display_name": "unskilled programmer", "link": "https://stackoverflow.com/users/5618953/unskilled-programmer"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1481142755, "post_id": 41026812, "comment_id": 69260953, "body": "But when I type capital K, it doesn&#39;t work."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1481142768, "post_id": 41026812, "comment_id": 69260962, "body": "Don&#39;t tag your question with both C++ and C: they&#39;re different languages, and the solution to a problem for one language is not going to look the same in another language."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481142915, "post_id": 41026812, "comment_id": 69261040, "body": "&quot;how can I distinguish two variables which have same ASCII codes&quot; --&gt; &quot; how can I distinguish two keystrokes which have similar responses from <code>getch()</code>&quot;"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1481142945, "post_id": 41026812, "comment_id": 69261054, "body": "<code>getch</code> is a windows function. Keys that are cursor controls or Fn keys return <i>two</i> successive codes. The first is either <code>0</code> or <code>224</code>. But you must define <code>int ch2</code> since that is the return value from <code>getch()</code>. You have not shown your variable types."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481143561, "post_id": 41026893, "comment_id": 69261369, "body": "Via Windows, can the keyboard generate a single ^@  - the null character aka ASCII NUL (or maybe a single 0xE0)?  If so, how to distinguish that a another character is due or not?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481143846, "post_id": 41026893, "comment_id": 69261537, "body": "The value 0 isn&#39;t listed in the set of key codes, and key code 0xE0 is marked as &quot;reserved&quot;.  I don&#39;t see any mention of null, so it doesn&#39;t appear to be possible."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481144349, "post_id": 41026893, "comment_id": 69261870, "body": "I see the link to Virtual-Key Codes, but having trouble finding the list of the of set of key codes for <code>a</code>, <code>^</code>, <code>ctrl z</code>, etc..  Suggestions?  (found a <a href=\"https://msdn.microsoft.com/en-us/library/aa243025(v=vs.60).aspx\" rel=\"nofollow noreferrer\">Basic</a> one)"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481144720, "post_id": 41026893, "comment_id": 69262084, "body": "@chux From what I read <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646267(v=vs.85).aspx\" rel=\"nofollow noreferrer\">here</a>, there are hardware specific scan codes which are translated into virtual key codes.  Not sure how to go about reading the scan codes."}, {"owner": {"reputation": 15, "user_id": 5618953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d65d696501de7be4e80387147a66a910?s=128&d=identicon&r=PG&f=1", "display_name": "unskilled programmer", "link": "https://stackoverflow.com/users/5618953/unskilled-programmer"}, "edited": false, "score": 0, "creation_date": 1481144869, "post_id": 41026893, "comment_id": 69262170, "body": "Thanks for your answer dbush, I already tried it but I didn&#39;t mention in question, my fault. Still not working. I&#39;m going to edit my question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481145309, "post_id": 41026893, "comment_id": 69262398, "body": "Perhaps a link for the set of key codes that has code 0xE0 marked as &quot;reserved&quot; as comment <a href=\"http://stackoverflow.com/questions/41026812/how-can-i-distinguish-two-keystrokes-which-have-similar-responses-from-getch/41026893?noredirect=1#comment69261537_41026893\">here</a>?"}, {"owner": {"reputation": 15, "user_id": 5618953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d65d696501de7be4e80387147a66a910?s=128&d=identicon&r=PG&f=1", "display_name": "unskilled programmer", "link": "https://stackoverflow.com/users/5618953/unskilled-programmer"}, "edited": false, "score": 0, "creation_date": 1481146695, "post_id": 41026893, "comment_id": 69263079, "body": "I write if-else in case&#39;s, I mean case 75: if(keycode== blabla, then it worked. Thank you a lot dbush."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1481145565, "last_edit_date": 1481145565, "creation_date": 1481142956, "answer_id": 41026893, "question_id": 41026812, "link": "https://stackoverflow.com/questions/41026812/how-can-i-distinguish-two-keystrokes-which-have-similar-responses-from-getch/41026893#41026893", "title": "How can I distinguish two keystrokes which have similar responses from getch()", "body": "<p>When a special character such as left-arrow is pressed, <code>getch</code> will first return either the value 0 or 0xE0, then it will return a key code (which is not the same as an ASCII code).  </p>\n\n<p>From <a href=\"https://msdn.microsoft.com/en-us/library/078sfkak.aspx\" rel=\"nofollow noreferrer\">MSDN</a>:</p>\n\n<blockquote>\n  <p>The <code>_getch</code> and <code>_getwch</code> functions read a single character from the\n  console without echoing the character. None of these functions can be\n  used to read CTRL+C. When reading a function key or an arrow key, each\n  function must be called twice; the first call returns 0 or 0xE0, and\n  the second call returns the actual key code.</p>\n</blockquote>\n\n<p>So you need to check for a 0 or 0xE0 which tells you the next character is a key code, not an ASCII code.</p>\n\n<p>The list of key codes: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx</a></p>\n\n<p>EDIT:</p>\n\n<p>Your <code>if(ch1 != 0xE0)</code> is outside of any <code>case</code>, so it gets skipped over.  Also, you're always calling <code>getch</code> twice when you enter the loop.  So if you didn't get a key code, you end up reading 2 regular characters and most likely skip one of them.</p>\n\n<p>Start you loop with a single <code>getch</code>.  Then check for 0 or 0xE0, and if found <strong>then</strong> call <code>getch</code> again.</p>\n\n<pre><code>while (1) {\n    int ch = getch();\n    int keycode = 0;\n\n    if (ch == 0 || ch == 0xe0) {\n        keycode = 1;\n        ch = getch();\n    }\n    switch (ch) {\n    ...\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5618953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d65d696501de7be4e80387147a66a910?s=128&d=identicon&r=PG&f=1", "display_name": "unskilled programmer", "link": "https://stackoverflow.com/users/5618953/unskilled-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 41026893, "answer_count": 1, "score": -2, "last_activity_date": 1481149246, "creation_date": 1481142584, "last_edit_date": 1481149246, "question_id": 41026812, "link": "https://stackoverflow.com/questions/41026812/how-can-i-distinguish-two-keystrokes-which-have-similar-responses-from-getch", "title": "How can I distinguish two keystrokes which have similar responses from getch()", "body": "<p>As I said in title, How can I distinguish two keystrokes which have similar responses from getch(). In this code block, K's and left arrow key's getch() responses are same, so when I type capital k case 75 works. How can I fix it? Also I got this problem with some other words.</p>\n\n<pre><code>     while(1){\n            ch1=getch();\n        switch( ch2 = getch())\n       {\nif(ch1 != 0xE0)\n{\n             default:\n            for(i=' ';i&lt;'}';i++)\n            {\n                if(i == ch2)\n                {\n                /*SOME STUFF*/\n                printf(\"%c\" , iter-&gt;x);\n                }\n break;\n            }\n\n\n            else\n            {\n                case 72: printf(\"UP WAS PRESSED\\n\");\n            break;\n           /*Some other stuff*/\n            }\n        }\n    }\n</code></pre>\n"}, {"tags": ["c", "matrix"], "comments": [{"owner": {"reputation": 1139, "user_id": 4954434, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/820014a12e2c692ff8cd170a33a60141?s=128&d=identicon&r=PG", "display_name": "Jithin Pavithran", "link": "https://stackoverflow.com/users/4954434/jithin-pavithran"}, "edited": false, "score": 2, "creation_date": 1481142722, "post_id": 41026809, "comment_id": 69260941, "body": "Some effort is expected from your side."}, {"owner": {"reputation": 51, "user_id": 7264339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c78febc2e1c5b5e907df38871994933e?s=128&d=identicon&r=PG&f=1", "display_name": "Overflower", "link": "https://stackoverflow.com/users/7264339/overflower"}, "reply_to_user": {"reputation": 1139, "user_id": 4954434, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/820014a12e2c692ff8cd170a33a60141?s=128&d=identicon&r=PG", "display_name": "Jithin Pavithran", "link": "https://stackoverflow.com/users/4954434/jithin-pavithran"}, "edited": false, "score": 0, "creation_date": 1481143119, "post_id": 41026809, "comment_id": 69261131, "body": "I was thinking about using realloc in some way but I cant figure out how.. The malloc is made line by line and how would I use the realloc in cases such as this example? When I need to get rid just of certain elements from the line."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1481144094, "post_id": 41026809, "comment_id": 69261701, "body": "You can&#39;t really use <code>realloc()</code> because it only keeps the start of the data when you shrink, so you&#39;ll need to allocate a new matrix of the right size and copy the relevant part of the big matrix into the new one.  Then you have to sort out the return value and freeing the old matrix if appropriate."}, {"owner": {"reputation": 51, "user_id": 7264339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c78febc2e1c5b5e907df38871994933e?s=128&d=identicon&r=PG&f=1", "display_name": "Overflower", "link": "https://stackoverflow.com/users/7264339/overflower"}, "edited": false, "score": 0, "creation_date": 1481145609, "post_id": 41026809, "comment_id": 69262559, "body": "I see. Thanks for the tip! :D"}], "answers": [{"tags": [], "owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "is_accepted": false, "score": 0, "last_activity_date": 1481147868, "creation_date": 1481147868, "answer_id": 41028119, "question_id": 41026809, "link": "https://stackoverflow.com/questions/41026809/c-matrix-crop-function/41028119#41028119", "title": "C matrix &quot;crop&quot; function", "body": "<p>You could allocate rows the same as columns (so they'll be just pointer's to pixels, not pixels itself) then you could:</p>\n\n<ul>\n<li>create \"smaller\" table and reference pixel's to new table (and maybe free unused once)</li>\n<li>moving them to start and reallocating the whole matrix</li>\n<li>set all pixels that are \"not used\" to NULL and everything that is not NULL is your cropped image.</li>\n<li>return the structure or pointer to start point of cropping ([x][y] of start pixel, or pointer to pixel). and width[how many pixels to the right]/height[how many pixels to the left] of cropping - this way you wouldn't have to change structure at all just work on cropped image.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1527669759, "creation_date": 1527669759, "answer_id": 50600150, "question_id": 41026809, "link": "https://stackoverflow.com/questions/41026809/c-matrix-crop-function/50600150#50600150", "title": "C matrix &quot;crop&quot; function", "body": "<blockquote>\n  <p>Now how should I use realloc to keep just the small submatrix that I need?</p>\n</blockquote>\n\n<p>At first, you can free the not-to-be-kept rows' data. Then, after you have moved the remaining rows' data and pointers to the start of their respective memory space, you can <code>realloc</code> the spaces, e. g.:</p>\n\n<pre><code>void crop(Pixel ***img, int start_col, int start_line,\n                        int * end_col, int * end_line)\n{\n    Pixel **imp = *img;\n    // free the memory space of the to-be-dropped row data\n    for (int i = 0;     i &lt; start_line; ++i) free(imp[i]);\n    for (int i = * end_line; ++i &lt; height; ) free(imp[i]);\n    // move the to-be-kept row pointers to start at row 0\n    *end_line -= start_line;    // resulting last row\n    size_t col_size = (*end_line+1) * sizeof *imp;  // resulting pointers' size\n    memmove(imp, imp+start_line, col_size);\n    // move the to-be-kept column data to start at column 0\n    *end_col -= start_col;      // resulting last column\n    size_t row_size = (*end_col+1) * sizeof **imp;  // resulting row data size\n    for (int i = 0; i &lt;= * end_line; ++i)\n        memmove(imp[i], imp[i]+start_col, row_size),\n        imp[i] = realloc(imp[i], row_size); // trim the memory space of the row\n    *img = realloc(imp, col_size);  // trim the memory space of the row pointers\n}\n</code></pre>\n\n<p>You'd call this function like:</p>\n\n<pre><code>    int end_col = 1, end_line = 1;\n    crop(&amp;img, 1, 1, &amp;end_col, &amp;end_line),  // yields new matrix and new ends\n    height = end_line+1, width = end_col+1; // important: set new dimensions\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7264339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c78febc2e1c5b5e907df38871994933e?s=128&d=identicon&r=PG&f=1", "display_name": "Overflower", "link": "https://stackoverflow.com/users/7264339/overflower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1527669759, "creation_date": 1481142577, "last_edit_date": 1481143822, "question_id": 41026809, "link": "https://stackoverflow.com/questions/41026809/c-matrix-crop-function", "title": "C matrix &quot;crop&quot; function", "body": "<p>I am given a matrix of elements of dimensions <strong>Width</strong>x<strong>Height</strong> which is allocated dynamically. I need to \"crop\" a part of this matrix defined by the rectangle formed by: (start_col, start_line) (end_col, end_line)</p>\n\n<hr>\n\n<p><strong>Example:</strong></p>\n\n<p>Given the matrix (3*3):</p>\n\n<pre><code>1 2 3\n4 5 6\n7 8 9\n</code></pre>\n\n<p>And the coords: (1, 1) (1, 1)</p>\n\n<p>The resulting matrix is:</p>\n\n<pre><code>5\n</code></pre>\n\n<p>How would I do this? </p>\n\n<hr>\n\n<p>My matrix consists of struct elements like this:</p>\n\n<pre><code>typedef struct Pixel{\n   int R;\n   int G;\n   int B;\n}Pixel;\n</code></pre>\n\n<p>And so I declared and allocated the matrix like this:</p>\n\n<pre><code>Pixel** img;\n\nimg = (Pixel**)malloc(height*sizeof(Pixel*));\nfor (int i = 0; i &lt;= height-1; i++){\n    img[i] = (Pixel*)malloc(width*sizeof(Pixel));\n}\n\n// ...\n//code to populate matrix\n</code></pre>\n\n<p>Now how should I use realloc to keep just the small submatrix that I need?</p>\n"}, {"tags": ["c", "file", "parsing", "delimiter"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1481143588, "post_id": 41026704, "comment_id": 69261382, "body": "Could you post the exact data please? No clarifying whitespace, just the exact data. Also, can you give us some context about where this file comes from? Also, try looking at the file in a hex editor."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1481144106, "post_id": 41026704, "comment_id": 69261713, "body": "Is it all text?  Are there newlines?"}, {"owner": {"reputation": 973, "user_id": 1734032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/69zJo.jpg?s=128&g=1", "display_name": "mckenzm", "link": "https://stackoverflow.com/users/1734032/mckenzm"}, "edited": false, "score": 1, "creation_date": 1481144406, "post_id": 41026704, "comment_id": 69261894, "body": "The invisible control characters are probably important."}, {"owner": {"reputation": 8672, "user_id": 2209048, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c1f9dd7f1d6e2dca5db9b8befa39162d?s=128&d=identicon&r=PG", "display_name": "JstnPwll", "link": "https://stackoverflow.com/users/2209048/jstnpwll"}, "reply_to_user": {"reputation": 973, "user_id": 1734032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/69zJo.jpg?s=128&g=1", "display_name": "mckenzm", "link": "https://stackoverflow.com/users/1734032/mckenzm"}, "edited": false, "score": 0, "creation_date": 1481144491, "post_id": 41026704, "comment_id": 69261940, "body": "@mckenzm There&#39;s an <code>EOT</code> immediately preceding the data I&#39;m interested in, but no invisible characters after that one."}], "answers": [{"tags": [], "owner": {"reputation": 973, "user_id": 1734032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/69zJo.jpg?s=128&g=1", "display_name": "mckenzm", "link": "https://stackoverflow.com/users/1734032/mckenzm"}, "is_accepted": false, "score": 1, "last_activity_date": 1481144253, "creation_date": 1481144253, "answer_id": 41027231, "question_id": 41026704, "link": "https://stackoverflow.com/questions/41026704/what-type-of-delimiter-is-being-used/41027231#41027231", "title": "What type of delimiter is being used?", "body": "<p>It may have been better if you had posted one or two more records, and and hex as well. You firstly need to identify record types if they differ.  It does indeed look like the leading fields might be handled differently, a record level header, they look space delimited. Try assuming there is a fixed number of fields here. If this fails, there may be different record types and included data may be conditional upon a map or type at the beginning of the record. It may be possible the fields can be read in arbitrary sequence similarly to argv[] elements as value pairs. Architecture would also be useful information, trailing bytes look suspiciously binary..  </p>\n"}], "owner": {"reputation": 8672, "user_id": 2209048, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c1f9dd7f1d6e2dca5db9b8befa39162d?s=128&d=identicon&r=PG", "display_name": "JstnPwll", "link": "https://stackoverflow.com/users/2209048/jstnpwll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1481144253, "creation_date": 1481142276, "last_edit_date": 1481144215, "question_id": 41026704, "link": "https://stackoverflow.com/questions/41026704/what-type-of-delimiter-is-being-used", "title": "What type of delimiter is being used?", "body": "<p>I'm attempting to parse a file without any sort of specification to guide me. I plan to split a section of this file into variable names, but I'm not sure how the fields are delimited. Clearly there is a pattern in the way the delimiters change...could someone point me in the right direction?</p>\n\n<p>Here's the data I'm interested in (spaces added by me for clarity):</p>\n\n<blockquote>\n  <p>@EEFDAAH  <strong>TFLBFile</strong> CM <strong>ExecutionName</strong> EL <strong>FileContents</strong> GI <strong>%reserved</strong> IJ  <strong>&amp;ReadCount</strong> KE <strong>vTest</strong> B@CQETMV@Dmain@\u017d\u00be\u00e0\u00c5U</p>\n</blockquote>\n\n<p>Full file (minus some invisible control characters):</p>\n\n<pre><code>MFP214DTest\nJA\nBMExecutionNameLFileContents\nBCEA\u0192STCF01TFLBFileTestRead0f36c096fa0~1~2~1~2~0~0~0~0~0~0~0~0~0~0~0~0~0~0~TFLBFile~TFLBFile~~0~0~2~0~0~0~0~1~0~0~0~0~0~0~ExecutionName~ExecutionName~0~0~0~0~0~0~0~0~0~0~0~0~0~0~0~1~0~0~0~0~FileContents~FileContents~0~0~0~0~0~0~0~0~0~0~0~0~0~0~0~1~0~0~0~0~0~1~~0~2~'Test'~15~0~1~0~FQ_dbopenwithfieldsDG_dbreadHprintoutFAHJ@A@WSHSJSGSASDSFSLQNhSHSJSGSISPQRhSESHQThSBTKf@EEFDAAHTFLBFileCMExecutionNameELFileContentsGI%reservedIJ&amp;ReadCountKEvTestB@CQETMV@Dmain@\u017d\u00be\u00e0\u00c5U\n</code></pre>\n"}, {"tags": ["c", "binary"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1481141708, "creation_date": 1481141708, "answer_id": 41026551, "question_id": 41026499, "link": "https://stackoverflow.com/questions/41026499/binary-to-decimal-algorithm-in-c-giving-strange-results/41026551#41026551", "title": "Binary to decimal algorithm in c giving strange results", "body": "<p>The <code>^</code> operator is not for exponentiation, but is instead the bitwise XOR operator.</p>\n\n<p>If you want to raise a number to a power of 2, use the left shift operator <code>&lt;&lt;</code> to shift the value <code>1</code> by the exponent in question.</p>\n\n<pre><code>decimal += 1 &lt;&lt; ((len - 1) - i);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 5463969, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-EXHkH_PCSR8/AAAAAAAAAAI/AAAAAAAAAMw/VyZ-WsGSeJ0/photo.jpg?sz=128", "display_name": "Blazing Code", "link": "https://stackoverflow.com/users/5463969/blazing-code"}, "edited": false, "score": 0, "creation_date": 1481144294, "post_id": 41026630, "comment_id": 69261832, "body": "I&#39;m not sure how the + binaryString[i] works. Does c automatically convert it to an integer?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 25, "user_id": 5463969, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-EXHkH_PCSR8/AAAAAAAAAAI/AAAAAAAAAMw/VyZ-WsGSeJ0/photo.jpg?sz=128", "display_name": "Blazing Code", "link": "https://stackoverflow.com/users/5463969/blazing-code"}, "edited": false, "score": 0, "creation_date": 1481144469, "post_id": 41026630, "comment_id": 69261934, "body": "The <code>char</code> type is promoted to <code>int</code> before the calculation. The <code>&#39;0&#39;</code> is subtracted as ASCII or EBCDIC or other character coding adjustment. Numeral encodings are required to be consecutive. That might have been clearer if written as <code>decimal * 2 + (binaryString[i] - &#39;0&#39;)</code>"}, {"owner": {"reputation": 25, "user_id": 5463969, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-EXHkH_PCSR8/AAAAAAAAAAI/AAAAAAAAAMw/VyZ-WsGSeJ0/photo.jpg?sz=128", "display_name": "Blazing Code", "link": "https://stackoverflow.com/users/5463969/blazing-code"}, "edited": false, "score": 0, "creation_date": 1481144770, "post_id": 41026630, "comment_id": 69262110, "body": "What compiler and standard do you use? cause running this with gcc c99 gives me 64 as an answer"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 25, "user_id": 5463969, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-EXHkH_PCSR8/AAAAAAAAAAI/AAAAAAAAAMw/VyZ-WsGSeJ0/photo.jpg?sz=128", "display_name": "Blazing Code", "link": "https://stackoverflow.com/users/5463969/blazing-code"}, "edited": false, "score": 0, "creation_date": 1481144820, "post_id": 41026630, "comment_id": 69262145, "body": "Please check your code: did you put <code>BinaryToInt(&quot;1000000&quot;)</code>?"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 2, "last_activity_date": 1481142285, "last_edit_date": 1481142285, "creation_date": 1481141961, "answer_id": 41026630, "question_id": 41026499, "link": "https://stackoverflow.com/questions/41026499/binary-to-decimal-algorithm-in-c-giving-strange-results/41026630#41026630", "title": "Binary to decimal algorithm in c giving strange results", "body": "<p>The trick is the same as with any number base: for each incoming digit, multiply the accumulator by the number base and add the digit.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint BinaryToInt(char *binaryString)\n{\n    int decimal = 0;\n    int len = strlen(binaryString);\n    for(int i = 0; i &lt; len; i++) {\n        decimal = decimal * 2 + binaryString[i] - '0';\n    }\n    return decimal;\n}\n\nint main(void)\n{\n    printf(\"%d\", BinaryToInt(\"10000000\"));\n    return 0;\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre><code>128\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5463969, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-EXHkH_PCSR8/AAAAAAAAAAI/AAAAAAAAAMw/VyZ-WsGSeJ0/photo.jpg?sz=128", "display_name": "Blazing Code", "link": "https://stackoverflow.com/users/5463969/blazing-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 41026551, "answer_count": 2, "score": 0, "last_activity_date": 1481142285, "creation_date": 1481141540, "question_id": 41026499, "link": "https://stackoverflow.com/questions/41026499/binary-to-decimal-algorithm-in-c-giving-strange-results", "title": "Binary to decimal algorithm in c giving strange results", "body": "<p>Hi i'm fairly new to c but for a program I'm writing I need to convert binary strings to decimal numbers. here is my current code:</p>\n\n<pre><code>int BinaryToInt(char *binaryString)\n{\n    int decimal = 0;\n    int len = strlen(binaryString);\n    for(int i = 0; i &lt; len; i++)\n    {\n\n        if(binaryString[i] == '1')\n            decimal += 2^((len - 1) - i);\n        printf(\"i is %i and dec is %i and the char is %c but the length is %i\\n\", i, decimal, binaryString[i], len);\n    }\n    return decimal;\n}\n\nint main(int argc, char **argv)\n{\n    printf(\"%i\", BinaryToInt(\"10000000\"));\n}\n</code></pre>\n\n<p>and here is the output:</p>\n\n<pre><code>i is 0 and dec is 5 and the char is 1 but the length is 8\ni is 1 and dec is 5 and the char is 0 but the length is 8\ni is 2 and dec is 5 and the char is 0 but the length is 8\ni is 3 and dec is 5 and the char is 0 but the length is 8\ni is 4 and dec is 5 and the char is 0 but the length is 8\ni is 5 and dec is 5 and the char is 0 but the length is 8\ni is 6 and dec is 5 and the char is 0 but the length is 8\ni is 7 and dec is 5 and the char is 0 but the length is 8\n5\n</code></pre>\n\n<p>I'm confused as to why this doesn't work, all help is greatly appreciated. Thanks in advance!</p>\n\n<p>Ps: I'm used to java so at the moment C just makes me cry</p>\n"}, {"tags": ["c#", "c", "volatile"], "comments": [{"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 5, "creation_date": 1481141406, "post_id": 41026418, "comment_id": 69260137, "body": "Yes, it matters by language. My answer to that question would be &quot;No, I can&#39;t - not with precision and accuracy.&quot; I think that&#39;s the <i>truthful</i> answer of 99% of C# developers."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1481141443, "post_id": 41026418, "comment_id": 69260160, "body": "Why are they mutually exclusive?  The keyword is there to ensure that <i>nothing</i> is violating the constraints that <code>volatile</code> is there to ensure.  This includes the language compiler, the runtime, the operating system, and even the hardware on the CPU.  Each layer of abstraction needs to not only not make improper optimizations given the rules <code>volatile</code> restricts, and also needs to ensure none of the layers it is built on do so either."}, {"owner": {"reputation": 181, "user_id": 7066959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1310ac92430854ed0d85ecfc21aa1a?s=128&d=identicon&r=PG&f=1", "display_name": "10101088101010", "link": "https://stackoverflow.com/users/7066959/10101088101010"}, "reply_to_user": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 0, "creation_date": 1481141495, "post_id": 41026418, "comment_id": 69260197, "body": "@JonSkeet Can you expand on what you mean by the latter half of your comment?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1481141582, "post_id": 41026418, "comment_id": 69260269, "body": "@10101088101010 Jon is asserting that almost no C# developers, including himself, accurately understand the exact semantics <code>volatile</code> results in, even if they might say otherwise."}, {"owner": {"reputation": 181, "user_id": 7066959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1310ac92430854ed0d85ecfc21aa1a?s=128&d=identicon&r=PG&f=1", "display_name": "10101088101010", "link": "https://stackoverflow.com/users/7066959/10101088101010"}, "edited": false, "score": 0, "creation_date": 1481141636, "post_id": 41026418, "comment_id": 69260309, "body": "Ah okay! That is indeed interesting..."}, {"owner": {"reputation": 181, "user_id": 7066959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1310ac92430854ed0d85ecfc21aa1a?s=128&d=identicon&r=PG&f=1", "display_name": "10101088101010", "link": "https://stackoverflow.com/users/7066959/10101088101010"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1481141663, "post_id": 41026418, "comment_id": 69260325, "body": "@Servy post as answer and I&#39;ll accept..."}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 5, "creation_date": 1481141699, "post_id": 41026418, "comment_id": 69260355, "body": "I&#39;m saying that almost no C# developers know what volatile really means in C#. Even MSDN doesn&#39;t (the description <a href=\"https://msdn.microsoft.com/en-us/library/x13ttww7.aspx\" rel=\"nofollow noreferrer\">here</a> is an oversimplification). I&#39;ve read the C# spec several times and the relevant section of the ECMA CLI spec several times, and I believe they&#39;re somewhat unclear. Do I have a vague approximation of an understanding? Sure. But could I describe it precisely and accurately? Nope."}, {"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1481141712, "post_id": 41026418, "comment_id": 69260361, "body": "@Servy In C# im not sure because it&#39;s JIT compiled but how in C after compilation CPU/OS/Runtime would now that &quot;this variable is volatile or not&quot; if it&#39;s just following the compiled instructions? volatile in C is solely for compiler."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1481141729, "post_id": 41026418, "comment_id": 69260367, "body": "I think the interviewer is wrong.  The compiler has to add code (pseudo ops) to prevent cross-threading.  The operating system can&#39;t modify the code without the compiler information.  It may be the operating system that actually behaves differently, but without the compiler adding marks into the code the Operating System will not know what to do."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1481141734, "post_id": 41026418, "comment_id": 69260369, "body": "Your C answer is actually very incorrect."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 4, "creation_date": 1481141758, "post_id": 41026418, "comment_id": 69260382, "body": "No, that is absolutely wrong. It does not warn the OS. You might argue that it informs the <i>runtime</i> environment, since C# is a managed language, but <code>volatile</code> absolutely does not send any signal to the operating system itself. Jon et al. are right that the semantics of <code>volatile</code> in C# are confusing and ill-understood, but there is really no way someone could plausibly argue that it is a semantic hint to the operating system."}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 3, "creation_date": 1481141788, "post_id": 41026418, "comment_id": 69260402, "body": "One exception I know about for this is Joe Duffy. He knows. I&#39;m sure some of his old colleagues know as well. Vance Morrison knows. I&#39;m sure some of the equivalent folks on the Mono runtime team know. Basically, it&#39;s a handful compared with the swathes of &quot;us common folk&quot; who don&#39;t."}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 1, "creation_date": 1481141879, "post_id": 41026418, "comment_id": 69260448, "body": "@CodyGray: I&#39;m glad you said that. I was thinking it was runtime rather than OS, too. I would expect it to affect the assembly code generated - and it could involve making system calls - but I would be surprised if the OS <i>implicitly</i> got involved. I didn&#39;t say so before for fear of being wrong due to my aforementioned ignorance."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "edited": false, "score": 0, "creation_date": 1481141892, "post_id": 41026418, "comment_id": 69260454, "body": "@koper89 The compiler would need to ensure that the operations it performed on the underlying runtime provided guarantees such that <code>volatile</code> semantics were maintained.  How it goes about doing that is its business, and I&#39;m sure the specifics would vary between runtimes, but if a compiler ended up writing out machine code that was instructing the runtime to perform operations that would (potentially) violate the volatile semantics, then that would be a bug in the compiler."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 8, "creation_date": 1481141895, "post_id": 41026418, "comment_id": 69260456, "body": "@JonSkeet &quot;us common folk&quot;, says the Chuck Norris of programming."}, {"owner": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 0, "creation_date": 1481141961, "post_id": 41026418, "comment_id": 69260495, "body": "This is outside my scope of experience, but the <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=7029\" rel=\"nofollow noreferrer\">Language Specification</a> at least mentions this: &quot;These optimizations can be performed by the compiler, by the run-time system, or by hardware. For volatile fields, such reordering optimizations are restricted&quot;. Whether &quot;run-time system&quot; (or &quot;hardware&quot;, depending on context) counts as &quot;the operating system&quot; I do not know."}, {"owner": {"reputation": 10516, "user_id": 2872388, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8a10ec2ce33bfdb3a0c44e39adf3092b?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/2872388/steve"}, "edited": false, "score": 0, "creation_date": 1481142334, "post_id": 41026418, "comment_id": 69260716, "body": "if I remember correctly it has to do with compiler. not the OS. It is basically telling the compiler not to optimize it. I absolutely hate when the interviewer keeps saying you are wrong while he/she is wrong. I had a time where the interviewer keeps telling me I need to use gcnew in c# for GC to work. And I was like....Nope! (not gonna mention which but its one of the top 10 software company)"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 10516, "user_id": 2872388, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8a10ec2ce33bfdb3a0c44e39adf3092b?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/2872388/steve"}, "edited": false, "score": 0, "creation_date": 1481142629, "post_id": 41026418, "comment_id": 69260887, "body": "@Steve What would be the point in telling the compiler not to re-order certain operations if the OS (or any other layers of abstraction underneath the compiler) is allowed to re-order those operations?  If it would be allowed to, then you couldn&#39;t assume anything about how the order the operations are performed in, so you might as well not use <code>volatile</code> at all.  It&#39;s only worth using if the constraints it mandes happen are enforced &quot;all the way down&quot;."}, {"owner": {"reputation": 181, "user_id": 7066959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1310ac92430854ed0d85ecfc21aa1a?s=128&d=identicon&r=PG&f=1", "display_name": "10101088101010", "link": "https://stackoverflow.com/users/7066959/10101088101010"}, "edited": false, "score": 0, "creation_date": 1481143059, "post_id": 41026418, "comment_id": 69261107, "body": "So would it them be a safe assumption to say it&#39;s... both?"}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 0, "creation_date": 1481143948, "post_id": 41026418, "comment_id": 69261605, "body": "It would be a safe assumption to say it&#39;s... complicated."}, {"owner": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 1, "creation_date": 1481144415, "post_id": 41026418, "comment_id": 69261900, "body": "<a href=\"http://joeduffyblog.com/2010/12/04/sayonara-volatile/\" rel=\"nofollow noreferrer\">joeduffyblog.com/2010/12/04/sayonara-volatile</a>"}, {"owner": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 1, "creation_date": 1481144941, "post_id": 41026418, "comment_id": 69262207, "body": "<a href=\"http://stackoverflow.com/questions/72275/when-should-the-volatile-keyword-be-used-in-c\">Lippert</a>"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 4, "creation_date": 1481165131, "post_id": 41026418, "comment_id": 69269345, "body": "The interviewer is sufficiently wrong that they should not be using volatile in any language."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 7066959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1310ac92430854ed0d85ecfc21aa1a?s=128&d=identicon&r=PG&f=1", "display_name": "10101088101010", "link": "https://stackoverflow.com/users/7066959/10101088101010"}, "edited": false, "score": 0, "creation_date": 1481144358, "post_id": 41027240, "comment_id": 69261871, "body": "Interesting... I had no idea that this topic was so grey as opposed to black and white. Thanks for the insight and summary."}, {"owner": {"reputation": 613, "user_id": 4245870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cW8C3.jpg?s=128&g=1", "display_name": "dovedevic", "link": "https://stackoverflow.com/users/4245870/dovedevic"}, "reply_to_user": {"reputation": 181, "user_id": 7066959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1310ac92430854ed0d85ecfc21aa1a?s=128&d=identicon&r=PG&f=1", "display_name": "10101088101010", "link": "https://stackoverflow.com/users/7066959/10101088101010"}, "edited": false, "score": 1, "creation_date": 1481144742, "post_id": 41027240, "comment_id": 69262097, "body": "I just want to point out, even though you marked this as the answer, this is by no means a concrete and distinctive answer... as the topic is complicated..."}], "tags": [], "owner": {"reputation": 613, "user_id": 4245870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cW8C3.jpg?s=128&g=1", "display_name": "dovedevic", "link": "https://stackoverflow.com/users/4245870/dovedevic"}, "is_accepted": true, "score": 3, "last_activity_date": 1481144518, "last_edit_date": 1481144518, "creation_date": 1481144301, "answer_id": 41027240, "question_id": 41026418, "link": "https://stackoverflow.com/questions/41026418/volatile-variables/41027240#41027240", "title": "Volatile variables", "body": "<p>To be fairly honest, the question posed by the interviewer is kinda foggy as it is.</p>\n\n<p>It really depends on what he/she meant by \"OS\". Are they talking about the \"upfront OS\", the pure software side of things, or what they might be misconstruing the \"OS\" as the hardware-software relationship, ie the RTE and MMM (I've seen either assumptions and comparisons in some of my own personal interviews). I think it should be noted that these two are quite distinctly different! If he/she is talking about the former, then <strong>NO</strong> volatile does not \"inform\" the OS. If they are talking about the latter, then <em>yes</em> (this is a loose yes). At this point you are in the realm of the differences between the languages. As Cody Gray mentioned, C# is a managed language, and so then the latter definition of the OS does indeed \"get notified\" of the variable and the precautions to take.</p>\n\n<p>But also, in any case or definition of OS, the compiler <strong><em>does</em></strong> specially manage and deal with the volatile field, regardless of language. Otherwise, why have the keyword in the first place?</p>\n\n<p>In my personal opinion, what ever that's worth, I think you answered correctly, albeit, judging by the comments, can get complicated and hectic by nature.</p>\n"}, {"tags": [], "owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "is_accepted": false, "score": 22, "last_activity_date": 1481167039, "creation_date": 1481167039, "answer_id": 41031198, "question_id": 41026418, "link": "https://stackoverflow.com/questions/41026418/volatile-variables/41031198#41031198", "title": "Volatile variables", "body": "<blockquote>\n  <p>I answered by saying it just lets the compiler know that the variable can be used across processes or threads, and that it should not use optimization on that variable; as optimizing it can deteriorate behavior. In a nutshell, it's a warning to the compiler.</p>\n</blockquote>\n\n<p>This is going in the right direction for C# but misses some important aspects.</p>\n\n<p>First off, delete \"processes\" entirely. Variables are not shared across processes in C#.</p>\n\n<p>Second, don't concentrate on <em>optimizations</em>. Instead concentrate on <em>permissible semantics</em>. A compiler is not required to generate optimal code; a compiler is required to generate specification-compliant code. A re-ordering need not be for performance reasons and need not be faster / smaller / whatever. A volatile declaration adds an additional restriction on the permissible semantics of a multithreaded program.</p>\n\n<p>Third, don't think of it as a warning to the compiler. It's a directive to the compiler: to generate code that is guaranteed to be compliant with the specification for volatile variables. How the compiler does so is up to it.</p>\n\n<p>The actual answer to the question</p>\n\n<blockquote>\n  <p>Can you describe to me what adding volatile in front of variables does?</p>\n</blockquote>\n\n<p>is: A C# compiler and runtime environment have great latitude to re-order variable reads and writes for any reason they see fit. They are restricted to only those re-orderings which preserve the meaning of programs on a single thread. So \"x = y; a = b;\" could move the read of b to before the read to y; that's legal because the outcome is unchanged. (This is not the only restriction on re-ordering, but it is in some sense the most fundamental one.) However, re-orderings are permitted to be noticeable on multiple threads; it is possible that another thread observes that b is read before y. This can cause problems.</p>\n\n<p>The C# compiler and runtime have additional restrictions on how volatile reads and writes may be re-ordered with respect to each other, and furthermore how they may be ordered with respect to other events such as threads starting and stopping, locks, exceptions being thrown, and so on.  </p>\n\n<p>Consult the C# specification for a detailed list of the restrictions on observed orderings of reads, writes and other effects. </p>\n\n<p>Note in particular that even with volatile variables, there is not required to be a <em>consistent total ordering of all variable accesses as seen from all threads</em>. And specifically, the notion that volatile \"reads the latest value of the variable\" is simply false; that phrasing suggests that there is such a thing as \"the latest value\", which implies a total consistent ordering.</p>\n\n<p>If that sounds confusing, it is. <strong>Don't write multithreaded programs that share data across threads.</strong> If you must, use the highest level abstractions at your disposal. Hardly anyone should be writing code that uses volatile; use the TPL and let it manage your threads.</p>\n\n<p>Now let's consider your answer in the context of C.</p>\n\n<p>The question is ill-posed with respect to C. In C# volatile is a modifier on member variable declarations; in C, it's part of a <em>type</em>. So saying \"before a variable\" is ambiguous; where before the variable? There's a difference between a <code>volatile int * x</code> and an <code>int * volatile x</code>. (Can you see the difference?)</p>\n\n<p>But more importantly: the C specification does not guarantee that volatile will have any particular behaviour with respect to threads. If your C compiler does, that's an extension of the language by your compiler vendor. Volatile in C is guaranteed to have certain behaviour with respect to memory mapped IO, long jumps, and signals, and that's all; if you rely on it to have certain behaviour with respect to threads then you are writing non-portable code.</p>\n\n<blockquote>\n  <p>According to the interviewer: it's the other way around, and the volatile keyword warns the OS, not the compiler.</p>\n</blockquote>\n\n<p>That's nonsense from start to finish. Interviewers should not ask questions that they don't understand the answers to.</p>\n"}], "owner": {"reputation": 181, "user_id": 7066959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1310ac92430854ed0d85ecfc21aa1a?s=128&d=identicon&r=PG&f=1", "display_name": "10101088101010", "link": "https://stackoverflow.com/users/7066959/10101088101010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 3, "accepted_answer_id": 41027240, "answer_count": 2, "score": 18, "last_activity_date": 1481167039, "creation_date": 1481141256, "last_edit_date": 1481145235, "question_id": 41026418, "link": "https://stackoverflow.com/questions/41026418/volatile-variables", "title": "Volatile variables", "body": "<p>I recently had an interview with a software company who asked me the following question:</p>\n\n<blockquote>\n  <p>Can you describe to me what adding <em>volatile</em> in front of variables does? Can you explain to me why it's important?</p>\n</blockquote>\n\n<p>Most of my programming knowledge comes from C, yet the job position is for C# (I thought I might add this bit of info if necessary for the question specifically)</p>\n\n<p>I answered by saying it just lets the <strong><em>compiler</em></strong> know that the variable can be used across processes or threads, and that it should not use optimization on that variable; as optimizing it can deteriorate behavior. In a nutshell, it's a warning to the compiler.</p>\n\n<p>According to the interviewer, however, it's the other way around, and the volatile keyword warns the <strong><em>OS</em></strong>, not the compiler. </p>\n\n<p>I was a bit befuddled by this, so I did some research and actually found conflicting answers! Some sources say it's for the compiler, and others for the OS.</p>\n\n<p>Which is it? Does it differ by language?</p>\n"}, {"tags": ["c++", "c", "opengl"], "comments": [{"owner": {"reputation": 4122, "user_id": 3951525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/hix21.jpg?s=128&g=1", "display_name": "Starl1ght", "link": "https://stackoverflow.com/users/3951525/starl1ght"}, "edited": false, "score": 0, "creation_date": 1481228742, "post_id": 41026267, "comment_id": 69303919, "body": "Consider using Visual Studio as industry standard for Windows"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3968963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75780ccfb838a2d47e8988ede2379de0?s=128&d=identicon&r=PG&f=1", "display_name": "Arnab Bhattacharya", "link": "https://stackoverflow.com/users/3968963/arnab-bhattacharya"}, "edited": false, "score": 1, "creation_date": 1481225856, "post_id": 41039817, "comment_id": 69302433, "body": "First of all, I would like to thank you for taking out your valuable time. Today the issue has been solved. The problem was with the compiler and debugger settings of codeblocks software. The compiler was set as &quot;Dev C++&quot; maybe because I had Dev C++ installed in my system before installing CodeBlocks. I changed that to TDM-GCC directory and the problem was fixed. However, with that &quot;Dev C++&quot; one I was able to use GLFW 2.7."}], "tags": [], "owner": {"reputation": 300, "user_id": 7172363, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000922552347/picture?type=large", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0435\u0439 \u041d\u0435\u0443\u0434\u0430\u0447\u0438\u043d", "link": "https://stackoverflow.com/users/7172363/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b5%d0%b9-%d0%9d%d0%b5%d1%83%d0%b4%d0%b0%d1%87%d0%b8%d0%bd"}, "is_accepted": false, "score": 0, "last_activity_date": 1481200979, "creation_date": 1481200979, "answer_id": 41039817, "question_id": 41026267, "link": "https://stackoverflow.com/questions/41026267/building-glfw3-programs-in-codeblocks-16-01-in-windows-7-failed/41039817#41039817", "title": "Building glfw3 programs in CodeBlocks 16.01 in Windows 7 failed", "body": "<p>looks like you need to add library(.lib) with this stuff. <code>.h</code> file has been \ndeployed  already so you need to detect it. Then you can google for library.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 3968963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75780ccfb838a2d47e8988ede2379de0?s=128&d=identicon&r=PG&f=1", "display_name": "Arnab Bhattacharya", "link": "https://stackoverflow.com/users/3968963/arnab-bhattacharya"}, "is_accepted": false, "score": 1, "last_activity_date": 1481228283, "last_edit_date": 1481228283, "creation_date": 1481227247, "answer_id": 41047837, "question_id": 41026267, "link": "https://stackoverflow.com/questions/41026267/building-glfw3-programs-in-codeblocks-16-01-in-windows-7-failed/41047837#41047837", "title": "Building glfw3 programs in CodeBlocks 16.01 in Windows 7 failed", "body": "<p>Today the problem is solved. The problem was with the compiler settings in CodeBlocks. In CodeBlocks, under <em>\"Settings\"</em> tab <em>\"Compiler\"->\"ToolchainExecutables\"</em>, it was <em>\"Dev C++\"</em>. I installed <em>TDM-GCC-32</em> (<a href=\"http://tdm-gcc.tdragon.net/download\" rel=\"nofollow noreferrer\">http://tdm-gcc.tdragon.net/download</a>) 32 bit version. Then changed <em>\"Dev C++\"</em> with the directory where TDM-GCC-32 is installed in my computer. </p>\n\n<p>Next in <em>\"Settings\"->\"Debugger\"</em> option, I selected <em>\"GDB/CDB Debugger\"</em> and \"Default\". Then provided the path of <strong><em>gdb32.exe</em></strong> located in the <em>TDM-GCC-32/bin</em> directory. </p>\n\n<p>I think as I had installed Dev C++ before installing codeblocks, Dev C++ was selected by default (not sure). For those who are facing similar problems but DEV C++ is not their case, updating TDM-GCC may help.</p>\n\n<p>However, this DEV C++ compiler was working for older GLFW 2.7. Today, I have also found another problem with this DEV C++ one. I was using freeglut. When I was including <em>iostream</em> along with <em>GL/glut.h</em> similar <strong><em>\"undefined reference to `__chkstk_ms'\"</em></strong> error message was appearing.</p>\n\n<p>But now, it is ok. Thank you all :)</p>\n"}], "owner": {"reputation": 31, "user_id": 3968963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75780ccfb838a2d47e8988ede2379de0?s=128&d=identicon&r=PG&f=1", "display_name": "Arnab Bhattacharya", "link": "https://stackoverflow.com/users/3968963/arnab-bhattacharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1481228283, "creation_date": 1481140732, "last_edit_date": 1481208553, "question_id": 41026267, "link": "https://stackoverflow.com/questions/41026267/building-glfw3-programs-in-codeblocks-16-01-in-windows-7-failed", "title": "Building glfw3 programs in CodeBlocks 16.01 in Windows 7 failed", "body": "<p>I am using <em>CodeBlocks 16.01</em> in Windows7. I have downloaded <em>GLFW</em> windows binary <a href=\"http://www.glfw.org/\" rel=\"nofollow noreferrer\">from here</a>. I have copied include and <code>lib-mingw</code> to my project folder. Have provided the include and <code>lib-mingw</code> directories for Compiler and Linker options respectively in the build options. In the Linker settings tab, I have added <code>glfw3</code>,<code>gdi32</code> and <code>opengl32</code>. I'm running the sample program given in the documentation page of the <em>GLFW</em> website. The program is compiling. While building a warning and an error message is displayed:</p>\n\n<blockquote>\n  <p>Warning: .drectve `-aligncomm:\"__glfw\",5' unrecognized</p>\n</blockquote>\n\n<p>And</p>\n\n<blockquote>\n  <p>init.c     undefined reference to `__chkstk_ms'</p>\n</blockquote>\n\n<p>Have googled a lot, but in vain. Any help would be great.</p>\n"}, {"tags": ["c", "switch-statement"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481141287, "post_id": 41026253, "comment_id": 69260070, "body": "Output buffering, probably. But it&#39;s impossible to say for sure because you didn&#39;t post a <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481141375, "post_id": 41026253, "comment_id": 69260124, "body": "<a href=\"http://c-faq.com/stdio/fflush.html\" rel=\"nofollow noreferrer\">c-faq.com/stdio/fflush.html</a>"}, {"owner": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481142112, "post_id": 41026253, "comment_id": 69260586, "body": "Okay, I streamlined my post."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481142170, "post_id": 41026253, "comment_id": 69260616, "body": "OK, that confirms it&#39;s just buffering."}, {"owner": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1481142270, "post_id": 41026253, "comment_id": 69260689, "body": "Wow... Thanks... A simple \\n or fflush(stdout) fixes it..."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "edited": false, "score": 1, "creation_date": 1481142915, "post_id": 41026474, "comment_id": 69261039, "body": "i guess it looked like I thought its a jump because I didn&#39;t do a good post, i just called it jump because it should enter the next case in the next run of the &quot;while(1)&quot; loop around it."}], "tags": [], "owner": {"reputation": 6557, "user_id": 2495795, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13606de0b736d7191e2cf2bfea1d4fda?s=128&d=identicon&r=PG", "display_name": "BufBills", "link": "https://stackoverflow.com/users/2495795/bufbills"}, "is_accepted": false, "score": -1, "last_activity_date": 1481141461, "creation_date": 1481141461, "answer_id": 41026474, "question_id": 41026253, "link": "https://stackoverflow.com/questions/41026253/strange-behavior-with-program-sequence/41026474#41026474", "title": "Strange behavior with program sequence", "body": "<p>This is no 'jump' as you mentioned.\nYou see the 'break' keyword? That will break the whole switch-case logic.</p>\n\n<p>Check this link:\n<a href=\"https://www.tutorialspoint.com/cprogramming/switch_statement_in_c.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/cprogramming/switch_statement_in_c.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 1, "last_activity_date": 1527581807, "creation_date": 1527581807, "answer_id": 50579495, "question_id": 41026253, "link": "https://stackoverflow.com/questions/41026253/strange-behavior-with-program-sequence/50579495#50579495", "title": "Strange behavior with program sequence", "body": "<p>it's just buffering. \u2013 melpomene</p>\n\n<p>A simple \\n or fflush(stdout) fixes it... \u2013 Manuel Burgstaller</p>\n"}], "owner": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 50579495, "answer_count": 2, "score": 0, "last_activity_date": 1527581807, "creation_date": 1481140681, "last_edit_date": 1481142087, "question_id": 41026253, "link": "https://stackoverflow.com/questions/41026253/strange-behavior-with-program-sequence", "title": "Strange behavior with program sequence", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\nvoid delay(int milliseconds) //by http://c-for-dummies.com/blog/?p=69\n{ \nlong pause;\nclock_t now,then;\n\npause = milliseconds*(CLOCKS_PER_SEC/1000);\nnow = then = clock();\nwhile( (now-then) &lt; pause )\n    now = clock();\n}\n\n\nint main()\n{\nint i=1;\nint j;\nwhile(1)\n{\nswitch (i)\n{\n    case 1:\n    for(j=0; j &lt; 10; j++)\n    {\n        printf(\"%d\\n\",j);\n        if(j==9)\n        {\n            printf(\"jump 2\");\n            i=2;\n        }\n    }\n    break;\n\n    case 2:\n    printf(\"in 2\");\n    delay(5000);\n    printf(\"jump 1\");\n    i=1;\n}\n}\nreturn 0;\n}\n</code></pre>\n\n<p>So i streamlined it a bit.</p>\n\n<p>It now should output the numbers 1-9, \"jump 2\", \"in 2\" followed by a delay of 5 second and then \"jump 1\".</p>\n\n<p>In reality it puts out the numbers 1-9, waits 5 seconds and then puts out \"jump 2\" \"in 2\" and \"jump 1\"</p>\n"}, {"tags": ["c++", "c", "linux", "multithreading", "signals"], "comments": [{"owner": {"reputation": 17765, "user_id": 95710, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6rg2j.png?s=128&g=1", "display_name": "DForck42", "link": "https://stackoverflow.com/users/95710/dforck42"}, "edited": false, "score": 0, "creation_date": 1481143511, "post_id": 41026184, "comment_id": 69261341, "body": "can you provide an example of what you&#39;re talking about?"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7064870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1560b305d9b31e8b794c4c5527c10537?s=128&d=identicon&r=PG&f=1", "display_name": "lukecam95", "link": "https://stackoverflow.com/users/7064870/lukecam95"}, "edited": false, "score": 0, "creation_date": 1481144152, "post_id": 41026562, "comment_id": 69261750, "body": "Thanks for your reply! If I am setting up a timer in the main and then I create the threads, how do I decide which thread should handle it then?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 55, "user_id": 7064870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1560b305d9b31e8b794c4c5527c10537?s=128&d=identicon&r=PG&f=1", "display_name": "lukecam95", "link": "https://stackoverflow.com/users/7064870/lukecam95"}, "edited": false, "score": 0, "creation_date": 1481144414, "post_id": 41026562, "comment_id": 69261899, "body": "Common approach is to create a dedicated thread. See <a href=\"http://man7.org/linux/man-pages/man3/pthread_sigmask.3.html\" rel=\"nofollow noreferrer\">pthread_sigmask()</a> where you can find a complete example."}, {"owner": {"reputation": 340, "user_id": 2063520, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/a0mfP.jpg?s=128&g=1", "display_name": "Parthiv Shah", "link": "https://stackoverflow.com/users/2063520/parthiv-shah"}, "reply_to_user": {"reputation": 55, "user_id": 7064870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1560b305d9b31e8b794c4c5527c10537?s=128&d=identicon&r=PG&f=1", "display_name": "lukecam95", "link": "https://stackoverflow.com/users/7064870/lukecam95"}, "edited": false, "score": 0, "creation_date": 1486381873, "post_id": 41026562, "comment_id": 71305464, "body": "@lukecam95 Go through this thread <a href=\"http://stackoverflow.com/questions/13114678/posix-threads-block-signal-and-unblock\" title=\"posix threads block signal and unblock\">stackoverflow.com/questions/13114678/&hellip;</a> to understand how pthread_sigmask works."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1481141752, "creation_date": 1481141752, "answer_id": 41026562, "question_id": 41026184, "link": "https://stackoverflow.com/questions/41026184/why-do-i-need-to-use-pthread-sigmask-in-multithreaded-programs-to-assure-that-a/41026562#41026562", "title": "Why do I need to use Pthread_sigmask in multithreaded programs to assure that a signal is being handled by the set handler?", "body": "<blockquote>\n  <p>Won't the signal be handled anyway when it is sent, regardless of which thread is processing at the given time instant? </p>\n</blockquote>\n\n<p>In a single threaded program, yes. But in a multi-threaded program, POSIX doesn't specify which thread would receive the signal <code>SIGVTALRM</code> you send. Hence, <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_sigmask.html\" rel=\"nofollow noreferrer\"><code>pthread_sigmask()</code></a> is typically used to block the interested signals and handle fetch those signal(s) <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sigwait.html\" rel=\"nofollow noreferrer\"><code>sigwait()</code></a> in a dedicated thread. This is probably the reason why you are using or asked to use <code>pthread_sigmask()</code>.</p>\n\n<p>The linked POSIX manual also provides a simple example showing how this can be done.</p>\n"}], "owner": {"reputation": 55, "user_id": 7064870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1560b305d9b31e8b794c4c5527c10537?s=128&d=identicon&r=PG&f=1", "display_name": "lukecam95", "link": "https://stackoverflow.com/users/7064870/lukecam95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 791, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1481141752, "creation_date": 1481140435, "question_id": 41026184, "link": "https://stackoverflow.com/questions/41026184/why-do-i-need-to-use-pthread-sigmask-in-multithreaded-programs-to-assure-that-a", "title": "Why do I need to use Pthread_sigmask in multithreaded programs to assure that a signal is being handled by the set handler?", "body": "<p>I have a multi-threaded program which needs to handle the Linux signal SIGVTALRM sent by a setitimer() every 25ms. However I am confused. I do not know why I need to use the Pthread_sigmask() to block and unblock the signal. Won't the signal be handled anyway when it is sent, regardless of which thread is processing at the given time instant? </p>\n"}, {"tags": ["c", "arrays", "char"], "comments": [{"owner": {"reputation": 17337, "user_id": 83605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a214bcecbc04c7c42696e55cbdea3e17?s=128&d=identicon&r=PG", "display_name": "Aziz", "link": "https://stackoverflow.com/users/83605/aziz"}, "edited": false, "score": 3, "creation_date": 1481140212, "post_id": 41026087, "comment_id": 69259385, "body": "It&#39;s an empty string (equivalent to <code>&quot;&quot;</code>) <b>EDIT: I&#39;m wrong. It isn&#39;t.</b>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 17337, "user_id": 83605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a214bcecbc04c7c42696e55cbdea3e17?s=128&d=identicon&r=PG", "display_name": "Aziz", "link": "https://stackoverflow.com/users/83605/aziz"}, "edited": false, "score": 4, "creation_date": 1481140222, "post_id": 41026087, "comment_id": 69259389, "body": "@Aziz No it isn&#39;t."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1481140230, "post_id": 41026087, "comment_id": 69259394, "body": "It is a sentinel: value <code>NULL</code>, to indicate the end of the array."}, {"owner": {"reputation": 1139, "user_id": 4954434, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/820014a12e2c692ff8cd170a33a60141?s=128&d=identicon&r=PG", "display_name": "Jithin Pavithran", "link": "https://stackoverflow.com/users/4954434/jithin-pavithran"}, "edited": false, "score": 1, "creation_date": 1481140589, "post_id": 41026087, "comment_id": 69259614, "body": "You should not get any error here. This should work just fine."}, {"owner": {"reputation": 149, "user_id": 3577115, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005881620383/picture?type=large", "display_name": "milanow", "link": "https://stackoverflow.com/users/3577115/milanow"}, "edited": false, "score": 0, "creation_date": 1481140868, "post_id": 41026087, "comment_id": 69259810, "body": "To those all said it should be fine with my compiler. YES u r right I was wrong :S"}], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1481140586, "post_id": 41026138, "comment_id": 69259612, "body": "The question is for C, so C++ specific constructs like <code>nullptr</code> don&#39;t apply here."}], "tags": [], "owner": {"reputation": 9740, "user_id": 1459996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/df2798299346f952d526d49a27fbde4e?s=128&d=identicon&r=PG", "display_name": "Kirill Kobelev", "link": "https://stackoverflow.com/users/1459996/kirill-kobelev"}, "is_accepted": false, "score": 2, "last_activity_date": 1481140270, "creation_date": 1481140270, "answer_id": 41026138, "question_id": 41026087, "link": "https://stackoverflow.com/questions/41026087/what-is-0-mean-in-a-2d-char-array-char-in-c/41026138#41026138", "title": "What is &quot;0&quot; mean in a 2D char array (char* []) in C", "body": "<p>In C/C++ NULL is effectively the same thing to numerical 0. It is ok to have NULL pointer as an element of an array of pointers. Your <code>char *data[]</code> is an array of pointers.</p>\n\n<p>This causes problems because in many cases it would be nice to distinguish integer 0 from NULL pointer. That is why since C++ 11 <code>nullptr</code> and <code>nullptr_t</code> were introduced. I would definitely recommend using them instead of NULL or 0.</p>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 3577115, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005881620383/picture?type=large", "display_name": "milanow", "link": "https://stackoverflow.com/users/3577115/milanow"}, "edited": false, "score": 1, "creation_date": 1481140612, "post_id": 41026145, "comment_id": 69259631, "body": "So how should I detect it has terminated in the function? Would it be if(data[iterator] == 0) or (*iterator == 0) ?"}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 149, "user_id": 3577115, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005881620383/picture?type=large", "display_name": "milanow", "link": "https://stackoverflow.com/users/3577115/milanow"}, "edited": false, "score": 0, "creation_date": 1481140711, "post_id": 41026145, "comment_id": 69259701, "body": "@milanow Yes, that&#39;s how you&#39;d do it, unless you decided to use Barmar&#39;s version. In that case, you&#39;d want to do <code>if (data[iterator] == NULL)</code> or <code>if (*data == NULL)</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481140812, "post_id": 41026145, "comment_id": 69259774, "body": "<code>data[iterator] == 0</code>, <code>data[iterator] == NULL</code>, and <code>!data[iterator]</code> all do the same thing: Check whether <code>data[iterator]</code> is a null pointer."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481140819, "post_id": 41026145, "comment_id": 69259780, "body": "@melpomene True, but it seems like the OP is simply trying to find the end of the string."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 6, "last_activity_date": 1481141099, "last_edit_date": 1481141099, "creation_date": 1481140295, "answer_id": 41026145, "question_id": 41026087, "link": "https://stackoverflow.com/questions/41026087/what-is-0-mean-in-a-2d-char-array-char-in-c/41026145#41026145", "title": "What is &quot;0&quot; mean in a 2D char array (char* []) in C", "body": "<p><code>0</code> is one of the ways to write a null pointer constant in C. It would probably be more obvious if they'd written:</p>\n\n<pre><code>char* data[] = {\"4352\", \"3242\", \"2432143\", \"234\", \"\", \"324\", NULL};\n</code></pre>\n\n<p>which is equivalent.</p>\n\n<p>The null pointer is being used as an indicator of the end of the array (similar to the way the character <code>'\\0'</code> marks the end of strings. If you're iterating over the array, you can use something like:</p>\n\n<pre><code>for (var i = 0; data[i] != 0; i++) {\n    // do something with data[i]\n}\n</code></pre>\n\n<p>You can also use <code>data[i] != NULL;</code>, they're equivalent.</p>\n"}, {"comments": [{"owner": {"reputation": 387, "user_id": 6149112, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0btmin8oCMo/AAAAAAAAAAI/AAAAAAAAAAA/lnk059CLpqg/photo.jpg?sz=128", "display_name": "Ya\u011fmur Oymak", "link": "https://stackoverflow.com/users/6149112/ya%c4%9fmur-oymak"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481140642, "post_id": 41026156, "comment_id": 69259660, "body": "Oh, sorry. I guess it is usually defined that way, am I right? If yes we can fix it that way."}], "tags": [], "owner": {"reputation": 387, "user_id": 6149112, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0btmin8oCMo/AAAAAAAAAAI/AAAAAAAAAAA/lnk059CLpqg/photo.jpg?sz=128", "display_name": "Ya\u011fmur Oymak", "link": "https://stackoverflow.com/users/6149112/ya%c4%9fmur-oymak"}, "is_accepted": false, "score": 2, "last_activity_date": 1527915738, "last_edit_date": 1527915738, "creation_date": 1481140326, "answer_id": 41026156, "question_id": 41026087, "link": "https://stackoverflow.com/questions/41026087/what-is-0-mean-in-a-2d-char-array-char-in-c/41026156#41026156", "title": "What is &quot;0&quot; mean in a 2D char array (char* []) in C", "body": "<p>You declared an array of pointers, and the last element of the array is set to zero, which is effectively a <code>NULL</code> pointer. In fact, the <code>NULL</code> macro is usually defined as <code>(void *) 0</code>, although its value is implementation dependent.</p>\n"}, {"comments": [{"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "edited": false, "score": 0, "creation_date": 1481140977, "post_id": 41026223, "comment_id": 69259863, "body": "Anyone can say to me what&#39;s wrong in my answer that I&#39;m getting down-votes?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481141035, "post_id": 41026223, "comment_id": 69259905, "body": "<code>NULL</code> isn&#39;t necessarily a pointer. <code>#define NULL 0</code> is allowed by the standard."}, {"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481141174, "post_id": 41026223, "comment_id": 69260001, "body": "@melpomene Thanks!"}], "tags": [], "owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "is_accepted": false, "score": -1, "last_activity_date": 1481141131, "last_edit_date": 1481141131, "creation_date": 1481140556, "answer_id": 41026223, "question_id": 41026087, "link": "https://stackoverflow.com/questions/41026087/what-is-0-mean-in-a-2d-char-array-char-in-c/41026223#41026223", "title": "What is &quot;0&quot; mean in a 2D char array (char* []) in C", "body": "<p>NULL is a pointer defined usually as (void*) 0. This is used to declare the pointer which is pointing to nothing, it's usually used to show the end of list/tree, or that pointer was not allocated etc.</p>\n"}], "owner": {"reputation": 149, "user_id": 3577115, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005881620383/picture?type=large", "display_name": "milanow", "link": "https://stackoverflow.com/users/3577115/milanow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 41026145, "answer_count": 4, "score": 1, "last_activity_date": 1527915738, "creation_date": 1481140064, "last_edit_date": 1481325653, "question_id": 41026087, "link": "https://stackoverflow.com/questions/41026087/what-is-0-mean-in-a-2d-char-array-char-in-c", "title": "What is &quot;0&quot; mean in a 2D char array (char* []) in C", "body": "<p>I recently encounter a C interview coding question. A general function like \"void Foo(char** sarr)\". And it gives me a input </p>\n\n<pre><code>char* data[] = {\"4352\", \"3242\", \"2432143\", \"234\", \"\", \"324\", 0}\n</code></pre>\n\n<p>I am kind of new to C, but familiar with C++. For this case, I really don't know what does this '0' mean in this char* array. I know C has a terminator for string as '\\0'. But what 0 means? Or this input is simply wrong/invalid?\nThanks in advance.</p>\n"}, {"tags": ["c", "file", "struct", "do-while", "scanf"], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 5504999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/l6HUN.jpg?s=128&g=1", "display_name": "Imtiaz Raqib", "link": "https://stackoverflow.com/users/5504999/imtiaz-raqib"}, "is_accepted": true, "score": 1, "last_activity_date": 1481141923, "last_edit_date": 1481141923, "creation_date": 1481141411, "answer_id": 41026453, "question_id": 41025971, "link": "https://stackoverflow.com/questions/41025971/increment-sscanf-in-a-do-while-loop-and-store-lines-into-a-struct/41026453#41026453", "title": "Increment sscanf() in a do..while loop and store lines into a struct", "body": "<p><strong>UPDATE : I HAVE SOLVED MY PROBLEM!</strong></p>\n\n<p>Doing more research, I have found it is better to use <code>fscanf</code> instead of <code>sscanf</code> in my <code>do..while</code> loop as <code>fscanf</code> utilizes the input filestream. Therefore I dont have to create a loop to further iterate each line, like I had to for <code>sscanf</code>.</p>\n\n<p>In changing my code according to <code>fscanf</code>, my program yields the correct output. </p>\n\n<p>Also I had to <em>hard increment</em> my <code>counter</code> to get the indices correct. The following can also be done by leaving the <code>counter</code> as the same and <em>hard decrementing</em> the <code>index</code> instead.</p>\n\n<p><strong>CHANGED STRUCTURE OF CODE :</strong></p>\n\n<pre><code>if (counter == (index))\n  {\n    printf(\"Check for counter 13\\n\");\n    printf(\"Counter is: %d\\n\", counter);\n    do {\n      fscanf(input_file, \"%d %d %d\", &amp;points[(counter + 1)-index].parent, &amp;points[(counter + 1)-index].x, &amp;points[(counter+1)-index].distance_to_tree);\n      check++;\n      counter++;\n    } while (check &lt;= num_pt - 2);\n    break;\n</code></pre>\n\n<p><strong>Output after executing the following:</strong></p>\n\n<pre><code>collect_edges(argv[inputfile]);\nprintf(\"%d\\n\", points[3].parent);\nprintf(\"%d\\n\", points[3].x);\nprintf(\"%d\\n\", points[3].distance_to_tree);\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/EF3ZZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EF3ZZ.png\" alt=\"Corrected Output\"></a></p>\n"}], "owner": {"reputation": 317, "user_id": 5504999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/l6HUN.jpg?s=128&g=1", "display_name": "Imtiaz Raqib", "link": "https://stackoverflow.com/users/5504999/imtiaz-raqib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 41026453, "answer_count": 1, "score": 0, "last_activity_date": 1481141923, "creation_date": 1481139700, "question_id": 41025971, "link": "https://stackoverflow.com/questions/41025971/increment-sscanf-in-a-do-while-loop-and-store-lines-into-a-struct", "title": "Increment sscanf() in a do..while loop and store lines into a struct", "body": "<p>I am given a file as such, <a href=\"http://pastebin.com/0apvhdMg\" rel=\"nofollow noreferrer\">instance10_002</a>. I am trying to store the MST data points into a struct that I have made. From my debugging <code>printf</code> statements, I can see I have successfully iterated through the file and reached my MST data points.</p>\n\n<p><strong>Here is my code:</strong></p>\n\n<pre><code>void collect_edges(char filename[31])\n{\n\n  int counter = 0, check = 0;\n  char c, str[64];\n  int index;\n  input_file = fopen(filename, \"r\");\n  if (input_file == NULL)\n    {\n      printf(\"Input file does not exist\\n\");\n      exit(1);\n    }\n\n  while (fgets(str, 64, input_file))\n    {\n      c = str[0];\n      if (c != '#' &amp;&amp; c != '\\n')\n        {\n          counter++;\n          printf(\"Check for counter\\n\");\n          if (counter == 2)\n            {\n              printf(\"Check Check\\n\");\n              sscanf(str, \"%d\", &amp;num_pt);\n              printf(\"Check for counter 2\\n\");\n              index = num_pt + 3;\n            }\n\n\n           if (counter == (index))\n             {\n               printf(\"Check for counter 13\\n\");\n               printf(\"Counter is: %d\\n\", counter);\n               do {\n                 sscanf(str, \"%d %d %d\", &amp;points[counter-index].parent, &amp;points[counter-index].x, &amp;points[counter-index].distance_to_tree);\n                 check++;\n                 counter++;\n               } while (check &lt;= num_pt - 2);\n               break;\n             }\n         }\n    }\n  fclose(input_file);\n\n}\n</code></pre>\n\n<p>I have used a <code>do..while</code> loop to store all the MST data points into my struct, but when I go to access them, it prints out <code>0 9 45</code>, which is the <strong><code>0th index</code></strong> of my struct and not the right data for all the indices. </p>\n\n<p><strong>Output by the following method:</strong></p>\n\n<pre><code>collect_edges(argv[inputfile]);\nprintf(\"%d\\n\", points[3].parent);\nprintf(\"%d\\n\", points[3].x);\nprintf(\"%d\\n\", points[3].distance_to_tree);\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/6jryF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6jryF.png\" alt=\"Output\"></a></p>\n\n<p><strong>Correct output as seen in instance file:</strong></p>\n\n<blockquote>\n  <p>5  8  40</p>\n</blockquote>\n\n<p>I initially thought my counter was not being incremented in my <code>do..while</code> loop but I have included the increment and now it scans the first MST data line and saves it in all the indices of the struct.\nIs there a way to increment the <code>sscanf</code> function to increment and scan all the other lines of data points?</p>\n"}, {"tags": ["c", "microcontroller", "attiny"], "comments": [{"owner": {"reputation": 3706, "user_id": 2018455, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e75a41fc224930ef1fa9ddcc9c714174?s=128&d=identicon&r=PG", "display_name": "Neil Locketz", "link": "https://stackoverflow.com/users/2018455/neil-locketz"}, "edited": false, "score": 2, "creation_date": 1481139713, "post_id": 41025951, "comment_id": 69259121, "body": "make sure the interrupt is actually being run, and it sets gameStatus to 1"}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1481139793, "post_id": 41025951, "comment_id": 69259155, "body": "When you say it will not recognise <code>gameStatus</code>, does it fail to compile?  A possibility is that you have a global initialised to zero (default) and it is not getting set to 1 for some reason."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1481139801, "post_id": 41025951, "comment_id": 69259160, "body": "and what does the ISR do when <code>gameStatus == 2</code> as set in <code>main</code>? What does &quot;not recognize&quot; mean? That it does not compile?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 5, "creation_date": 1481139865, "post_id": 41025951, "comment_id": 69259197, "body": "<code>volatile sig_atomic_t</code> could help here."}, {"owner": {"reputation": 65, "user_id": 2574504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2efb54af2000cc96f5fd3cbdf1b739b3?s=128&d=identicon&r=PG", "display_name": "3jfx", "link": "https://stackoverflow.com/users/2574504/3jfx"}, "edited": false, "score": 1, "creation_date": 1481139994, "post_id": 41025951, "comment_id": 69259266, "body": "volatile helped :) now it works!"}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 2574504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2efb54af2000cc96f5fd3cbdf1b739b3?s=128&d=identicon&r=PG", "display_name": "3jfx", "link": "https://stackoverflow.com/users/2574504/3jfx"}, "is_accepted": true, "score": 2, "last_activity_date": 1481140519, "creation_date": 1481140519, "answer_id": 41026212, "question_id": 41025951, "link": "https://stackoverflow.com/questions/41025951/if-wont-trigger-inside-while/41026212#41026212", "title": "If won&#39;t trigger inside while", "body": "<p>Thanks to wildplasser!</p>\n\n<p>Changing</p>\n\n<pre><code>uint8_t gameStatus = 0;\n</code></pre>\n\n<p>into</p>\n\n<pre><code>volatile uint8_t gameStatus = 0;\n</code></pre>\n\n<p>did the trick.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Volatile_(computer_programming)\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Volatile_(computer_programming)</a></p>\n"}], "owner": {"reputation": 65, "user_id": 2574504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2efb54af2000cc96f5fd3cbdf1b739b3?s=128&d=identicon&r=PG", "display_name": "3jfx", "link": "https://stackoverflow.com/users/2574504/3jfx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 41026212, "answer_count": 1, "score": 0, "last_activity_date": 1481140519, "creation_date": 1481139640, "last_edit_date": 1481139756, "question_id": 41025951, "link": "https://stackoverflow.com/questions/41025951/if-wont-trigger-inside-while", "title": "If won&#39;t trigger inside while", "body": "<p>currently I'm trying my best at programming a microcontroller.</p>\n\n<pre><code>int main()\n{\n    init_ports();\n\n    while(1){\n        if(gameStatus == 1){\n            gameStatus = 2;\n            beep(120);\n        }\n    }\n}\n</code></pre>\n\n<p>is my main, gameStatus is a global uint_8. It gets set by an interrupt that is caused by pressing a button.</p>\n\n<pre><code>ISR(INT0_vect){\n    if(gameStatus == 0)\n        gameStatus = 1; // that works\n\n}\n</code></pre>\n\n<p>The main however won't recognize gameStatus at all. Is there a reason why this could be?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "encryption"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481140343, "post_id": 41025926, "comment_id": 69259452, "body": "It looks like this sub-expression in your C code: <code>key[j % 20]</code> does not match the analogous sub-expression in your C# code: <code>key[j % key.Length]</code>.  That might not be the issue for your particular test case, but it seems likely to be <i>an</i> issue."}, {"owner": {"reputation": 27, "user_id": 7264137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AOXQ_M6Eybo/AAAAAAAAAAI/AAAAAAAAABI/qeN42qOuxf4/photo.jpg?sz=128", "display_name": "Hect0r Xorius", "link": "https://stackoverflow.com/users/7264137/hect0r-xorius"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481140438, "post_id": 41025926, "comment_id": 69259511, "body": "I made that static, as the input key length is 20 and always will be, I cannot I think it might be a casting issue but still looking through it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481140690, "post_id": 41025926, "comment_id": 69259687, "body": "If you&#39;re using a fixed key length, then it is worse than useless to pass the key length as a function argument."}, {"owner": {"reputation": 27, "user_id": 7264137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AOXQ_M6Eybo/AAAAAAAAAAI/AAAAAAAAABI/qeN42qOuxf4/photo.jpg?sz=128", "display_name": "Hect0r Xorius", "link": "https://stackoverflow.com/users/7264137/hect0r-xorius"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481141013, "post_id": 41025926, "comment_id": 69259886, "body": "Fixed, your right it was a mistake I changed that while debugging to see if it was that thanks for point that out :)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481141030, "post_id": 41025926, "comment_id": 69259901, "body": "You appear to have a classic memory allocation problem.  You pass <code>outbuf</code>, a <code>uint8_t *</code>, to function <code>rc4_crypt()</code>.  Because the argument (<code>buf4</code>) is an uninitialized pointer variable, this is passing an indeterminate pointer value <b><i>by value</i></b> (C has <i>only</i> pass by value).  You do assign a value to <code>outbuf</code> inside the function, but that has no effect on the value of <code>buf4</code> in the caller (because pass by value).  You leak that memory, and <code>buf4</code>&#39;s value remains indeterminate."}, {"owner": {"reputation": 27, "user_id": 7264137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AOXQ_M6Eybo/AAAAAAAAAAI/AAAAAAAAABI/qeN42qOuxf4/photo.jpg?sz=128", "display_name": "Hect0r Xorius", "link": "https://stackoverflow.com/users/7264137/hect0r-xorius"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481141553, "post_id": 41025926, "comment_id": 69260249, "body": "Sorry John I forgot to write the original snippet and just quickly wrote some usage, I have pasted the original code (without the static bytes of cpu key and hmac data) but both are 16 bytes each."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481141769, "post_id": 41025926, "comment_id": 69260389, "body": "The problem I pointed out is not fundamentally changed by the altered usage.  Function <code>rc4_crypt()</code> <i>allocates its own output buffer</i>, ignoring the pointer you pass to it.  The pointer to that buffer is not communicated back to the caller."}, {"owner": {"reputation": 27, "user_id": 7264137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AOXQ_M6Eybo/AAAAAAAAAAI/AAAAAAAAABI/qeN42qOuxf4/photo.jpg?sz=128", "display_name": "Hect0r Xorius", "link": "https://stackoverflow.com/users/7264137/hect0r-xorius"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481142392, "post_id": 41025926, "comment_id": 69260753, "body": "Ahh thank you, but it is still incorrect output &quot;77D776CC77D77600&quot; :("}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481143467, "post_id": 41025926, "comment_id": 69261314, "body": "The <code>printf()</code> output of <code>rc4_crypt()</code> does not reflect the encrypted data, at all.  Each byte you output is the as-yet unset value of the <i>next</i> position you intend to write.  This is an output problem, not a computational one.  Move the <code>num++</code> to the very end of the loop to fix it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481145239, "post_id": 41025926, "comment_id": 69262352, "body": "Inasmuch as you seem still to not be getting the expected output, I have to ask you to present how you are using the C# version that is serving as a reference implementation for you.  It may be that there is also some kind of difference there."}, {"owner": {"reputation": 27, "user_id": 7264137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AOXQ_M6Eybo/AAAAAAAAAAI/AAAAAAAAABI/qeN42qOuxf4/photo.jpg?sz=128", "display_name": "Hect0r Xorius", "link": "https://stackoverflow.com/users/7264137/hect0r-xorius"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481145598, "post_id": 41025926, "comment_id": 69262551, "body": "Updated, I only used the above statement to get the correct key, since I have already decrypted the keyvault data, I have the original crypted (which I took the original data from) and the unencrypted version (I know it says Xbox 360), ive been looking at this for 3 hours now and still cannot figure it out :("}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481146526, "post_id": 41025926, "comment_id": 69262991, "body": "I&#39;m afraid that doesn&#39;t really help.  Additionally, I don&#39;t think there&#39;s much more I can do for you.  As far as I can determine, the C code you now have performs the same computation as your C# code, given equivalent input.  If you&#39;re getting different output than you expect then I&#39;m going to attribute that to differences in the input."}, {"owner": {"reputation": 27, "user_id": 7264137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AOXQ_M6Eybo/AAAAAAAAAAI/AAAAAAAAABI/qeN42qOuxf4/photo.jpg?sz=128", "display_name": "Hect0r Xorius", "link": "https://stackoverflow.com/users/7264137/hect0r-xorius"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481147931, "post_id": 41025926, "comment_id": 69263697, "body": "Its the input, it works correct, its down to the way i handle the key data, im still tracing what ive done wrong in the c# version, so it all works thanks to you John, no more help needed :)"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7264137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AOXQ_M6Eybo/AAAAAAAAAAI/AAAAAAAAABI/qeN42qOuxf4/photo.jpg?sz=128", "display_name": "Hect0r Xorius", "link": "https://stackoverflow.com/users/7264137/hect0r-xorius"}, "edited": false, "score": 0, "creation_date": 1481144588, "post_id": 41026781, "comment_id": 69262007, "body": "Genuinly john thank you for all your help, i made simple mistakes but it must be a compution error in rc4 crypt, I modifed the mistakes (Ill update the original) and it outputs &quot;624AF65892273BB0&quot; now, I mean I might have read your answer wrong here also and im probably still outputting the incorrect values. plus the only reason I didnt use for over while is it complained to much, I know I could pass the -gnu99 flag to the makefile as im building on ubuntu/rasbain."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1481143824, "last_edit_date": 1481143824, "creation_date": 1481142480, "answer_id": 41026781, "question_id": 41025926, "link": "https://stackoverflow.com/questions/41025926/figure-out-why-my-rc4-implementation-doesent-produce-the-correct-result/41026781#41026781", "title": "figure out why my RC4 Implementation doesent produce the correct result", "body": "<p>As I remarked in comments, your main problem appeared to involve how the output buffer is managed.  You have since revised the question to fix that, but I describe it anyway here, along with some other alternatives for fixing it.  The remaining problem is discussed at the end.</p>\n\n<p>Function <code>rc4_crypt()</code> allocates an output buffer for itself, but it has no mechanism to communicate a pointer to the allocated space back to its caller.  Your revised usage furthermore exhibits some inconsistency with <code>rc4_crypt()</code> with respect to how the output buffer is expected to be managed.</p>\n\n<p>There are three main ways to approach the problem.</p>\n\n<ol>\n<li><p>Function <code>rc4_crypt()</code> presently returns nothing, so you could let it continue to allocate the buffer itself, and modify it to return a pointer to the allocated output buffer.</p></li>\n<li><p>You could modify the type of the <code>outbuf</code> parameter to <code>uint8_t **</code> to enable <code>rc4_crypt()</code> to set the caller's pointer value indirectly.</p></li>\n<li><p>You could rely on the caller to manage the output buffer, and make <code>rc4_crypt()</code> just write the output via the pointer passed to it.</p></li>\n</ol>\n\n<p>The only one of those that might be tricky for you is #2; it would look something like this:</p>\n\n<pre><code>void rc4_crypt(rc4_state_t* state, const uint8_t *inbuf, uint8_t **outbuf, int buflen) {\n    *outbuf = malloc(buflen);\n    if (*outbuf) {  // do not forget to test for failed allocation\n        // ...\n        (*outbuf)[idx] = (uint8_t)(num2 ^ num3);\n        // ...\n    }\n}\n</code></pre>\n\n<p>And you would use it like this:</p>\n\n<pre><code>rc4_crypt(rc4, buf3, &amp;buf4, 8);\n</code></pre>\n\n<p>... without otherwise allocating any memory for <code>buf4</code>.</p>\n\n<p>The caller in any case has the responsibility for freeing the output buffer when it is no longer needed.  This is clearer when it performs the allocation itself; you should document that requirement if <code>rc4_crypt()</code> is going to be responsible for the allocation.</p>\n\n<hr>\n\n<p>The remaining problem appears to be strictly an output problem.  You are apparently relying on print statements in <code>rc4_crypt()</code> to report on the encrypted data.  I have no problem whatever with debugging via print statements, but you <em>do</em> need to be careful to print the data you actually want to examine.  In this case you do not.  You update the joint buffer index <code>idx</code> at the end of the encryption loop <em>before</em> printing a byte from the output buffer.  As a result, at each iteration you print not the encrypted byte value you've just computed, but rather an indeterminate value that happens to be in the <em>next</em> position of the output buffer.</p>\n\n<p>Move the <code>idx++</code> to the very end of the loop to fix this problem, or change it from a <code>while</code> loop to a <code>for</code> loop and increment <code>idx</code> in the third term of the loop control statement.  In fact, I strongly recommend <code>for</code> loops over <code>while</code> loops where the former are a good fit to the structure of the code (as here); I daresay you would not have made this mistake if your loop had been structured that way.</p>\n"}], "owner": {"reputation": 27, "user_id": 7264137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AOXQ_M6Eybo/AAAAAAAAAAI/AAAAAAAAABI/qeN42qOuxf4/photo.jpg?sz=128", "display_name": "Hect0r Xorius", "link": "https://stackoverflow.com/users/7264137/hect0r-xorius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527582233, "creation_date": 1481139560, "last_edit_date": 1527582233, "question_id": 41025926, "link": "https://stackoverflow.com/questions/41025926/figure-out-why-my-rc4-implementation-doesent-produce-the-correct-result", "title": "figure out why my RC4 Implementation doesent produce the correct result", "body": "<p>Ok I am new to C, I have programmed in C# for around 10 years now so still getting used to the whole language, Ive been doing great in learning but im still having a few hickups, currently im trying to write a implementation of RC4 used on the Xbox 360 to encrypt KeyVault/Account data.</p>\n\n<p>However Ive run into a snag, the code works but it is outputting the incorrect data, I have provided the original c# code I am working with that I know works and I have provided the snippet of code from my C project, any help / pointers will be much appreciated :)</p>\n\n<p>Original C# Code :</p>\n\n<pre><code>public struct RC4Session\n{\n    public byte[] Key;\n    public int SBoxLen;\n    public byte[] SBox;\n    public int I;\n    public int J;\n}\n\n\n    public static RC4Session RC4CreateSession(byte[] key)\n    {\n        RC4Session session = new RC4Session\n        {\n            Key = key,\n            I = 0,\n            J = 0,\n            SBoxLen = 0x100,\n            SBox = new byte[0x100]\n        };\n        for (int i = 0; i &lt; session.SBoxLen; i++)\n        {\n            session.SBox[i] = (byte)i;\n        }\n        int index = 0;\n        for (int j = 0; j &lt; session.SBoxLen; j++)\n        {\n            index = ((index + session.SBox[j]) + key[j % key.Length]) % session.SBoxLen;\n            byte num4 = session.SBox[index];\n            session.SBox[index] = session.SBox[j];\n            session.SBox[j] = num4;\n        }\n        return session;\n    }\n\n\n    public static void RC4Encrypt(ref RC4Session session, byte[] data, int index, int count)\n    {\n        int num = index;\n        do\n        {\n            session.I = (session.I + 1) % 0x100;\n            session.J = (session.J + session.SBox[session.I]) % 0x100;\n            byte num2 = session.SBox[session.I];\n            session.SBox[session.I] = session.SBox[session.J];\n            session.SBox[session.J] = num2;\n            byte num3 = data[num];\n            byte num4 = session.SBox[(session.SBox[session.I] + session.SBox[session.J]) % 0x100];\n            data[num] = (byte)(num3 ^ num4);\n            num++;\n        }\n        while (num != (index + count));\n    }\n</code></pre>\n\n<p>Now Here is my own c version :</p>\n\n<pre><code>    typedef struct rc4_state {\n         int s_box_len;\n         uint8_t* sbox;\n         int i;\n         int j;\n     } rc4_state_t;\n     unsigned char* HMAC_SHA1(const char* cpukey, const unsigned char* hmac_key) {\n         unsigned char* digest = malloc(20);\n\n         digest = HMAC(EVP_sha1(), cpukey, 16, hmac_key, 16, NULL, NULL);\n\n         return digest;\n     }\n     void rc4_init(rc4_state_t* state, const uint8_t *key, int keylen)\n     {\n         state-&gt;i = 0;\n         state-&gt;j = 0;\n         state-&gt;s_box_len = 0x100;\n         state-&gt;sbox = malloc(0x100);\n\n         // Init sbox.\n         int i = 0, index = 0, j = 0;\n         uint8_t buf;\n         while(i &lt; state-&gt;s_box_len) {\n             state-&gt;sbox[i] = (uint8_t)i;\n             i++;\n         }\n         while(j &lt; state-&gt;s_box_len) {\n             index = ((index + state-&gt;sbox[j]) + key[j % keylen]) % state-&gt;s_box_len;\n             buf = state-&gt;sbox[index];\n             state-&gt;sbox[index] = (uint8_t)state-&gt;sbox[j];\n             state-&gt;sbox[j] = (uint8_t)buf;\n             j++;\n         }\n     }\n\n   void rc4_crypt(rc4_state_t* state, const uint8_t *inbuf, uint8_t **outbuf, int buflen)\n     {\n         int idx = 0;\n         uint8_t num, num2, num3;\n\n         *outbuf = malloc(buflen);\n         if (*outbuf) {  // do not forget to test for failed allocation\n             while(idx != buflen) {\n                 state-&gt;i = (int)(state-&gt;i + 1) % 0x100;\n                 state-&gt;j = (int)(state-&gt;j + state-&gt;sbox[state-&gt;i]) % 0x100;\n                 num = (uint8_t)state-&gt;sbox[state-&gt;i];\n                 state-&gt;sbox[state-&gt;i] = (uint8_t)state-&gt;sbox[state-&gt;j];\n                 state-&gt;sbox[state-&gt;j] = (uint8_t)num;\n                 num2 = (uint8_t)inbuf[idx];\n                 num3 = (uint8_t)state-&gt;sbox[(state-&gt;sbox[state-&gt;i] + (uint8_t)state-&gt;sbox[state-&gt;j]) % 0x100];\n                 (*outbuf)[idx] = (uint8_t)(num2 ^ num3);\n                 printf(\"%02X\", (*outbuf)[idx]);\n                 idx++;\n             }\n         }\n         printf(\"\\n\");\n     }\n</code></pre>\n\n<p>Usage (c#) :</p>\n\n<pre><code>         byte[] cpukey = new byte[16]\n        {\n            ...\n        };\n        byte[] hmac_key = new byte[16]\n        {\n            ...\n        };\n\n        byte[] buf = new System.Security.Cryptography.HMACSHA1(cpukey).ComputeHash(hmac_key);\n        MessageBox.Show(BitConverter.ToString(buf).Replace(\"-\", \"\"), \"\");\n</code></pre>\n\n<p>Usage(c): </p>\n\n<pre><code>const char cpu_key[16] = { 0xXX, 0xXX, 0xXX };\nconst unsigned char hmac_key[16] = { ... };\nunsigned char* buf = HMAC_SHA1(cpu_key, hmac_key);\n\nuint8_t buf2[20];\nuint8_t buf3[8] = { 0x1E, 0xF7, 0x94, 0x48, 0x22, 0x26, 0x89, 0x8E }; // Encrypted Xbox 360 data\nuint8_t* buf4;\n\n// Allocated 8 bytes out.\nbuf4 = malloc(8);\nint num = 0; \nwhile(num &lt; 20) {\n    buf2[num] = (uint8_t)buf[num]; // convert const char\n    num++;\n}\n\nrc4_state_t* rc4 = malloc(sizeof(rc4_state_t));\n\nrc4_init(rc4, buf2, 20);\nrc4_crypt(rc4, buf3, &amp;buf4, 8);\n</code></pre>\n\n<p>Now I have the HMACsha1 figured out, im using openssl for that and I confirm I am getting the correct hmac/decryption key its just the rc4 isnt working, Im trying to decrypt part of the Kyevault that should == \"Xbox 360\"||\"58626F7820333630\" </p>\n\n<p>The output is currently : \"0000008108020000\" I do not get any errors in the compilation, again any help would be great ^.^</p>\n\n<p>Thanks to John's help I was able to fix it, it was a error in the c# version, thanks John !</p>\n"}, {"tags": ["c", "algorithm", "if-statement", "cryptography", "sequence"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1481139418, "post_id": 41025831, "comment_id": 69258956, "body": "Does it mean that you don&#39;t care about bits 1-7 and 24-rest?"}, {"owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1481139580, "post_id": 41025831, "comment_id": 69259050, "body": "the bits not listed I don&#39;t care about, only the sequence stated I mean in algorithm"}], "answers": [{"tags": [], "owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "is_accepted": false, "score": 3, "last_activity_date": 1481140088, "last_edit_date": 1481140088, "creation_date": 1481139787, "answer_id": 41025999, "question_id": 41025831, "link": "https://stackoverflow.com/questions/41025831/get-a-sequence-bits-from-a-unsigned-long-c/41025999#41025999", "title": "Get a sequence bits from a unsigned long c", "body": "<p>You use bit-masking to do so, so basically you define a mask that is setting bits 8-23 to '1' and all the rest as '0' then you use AND (&amp;) operator  on your value and this mask to ignore all other parts, like:</p>\n\n<pre><code>unsigned long zprime   = 2501328903\nunsigned long q0XORq1  = 3736417748;\n\nif ( (q0XORq1 &amp; 0xFFFF00) == (zprime &amp; 0xFFFF00) )\n{\n\n}\n</code></pre>\n\n<p>I would suggest to learn all operators in C, here you got good place to start:\n<a href=\"https://www.tutorialspoint.com/cprogramming/c_operators.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/cprogramming/c_operators.htm</a></p>\n"}, {"comments": [{"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "edited": false, "score": 0, "creation_date": 1481142187, "post_id": 41026148, "comment_id": 69260627, "body": "@R Sahu Even if sizeof(in) == 64 the mask would still be 0xFFFF00, this 0xFFFF0000000000 will set bit&#39;s 40-55."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "edited": false, "score": 0, "creation_date": 1481142434, "post_id": 41026148, "comment_id": 69260781, "body": "@koper89, it depends. If the OP wants the most significant 8-23 bits, then what I suggest is what they need."}, {"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "edited": false, "score": 0, "creation_date": 1481142672, "post_id": 41026148, "comment_id": 69260914, "body": "@R Sahu There&#39;s only one most significant bit, so saying that someone want&#39;s X most significant bits would be semantically incorrect. So I&#39;m pretty sure they didn&#39;t mean that."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "edited": false, "score": 0, "creation_date": 1481142803, "post_id": 41026148, "comment_id": 69260975, "body": "@koper89, the most significant 8th bit through the most significant 23rd bit."}, {"owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "edited": false, "score": 0, "creation_date": 1481143021, "post_id": 41026148, "comment_id": 69261089, "body": "@R Sahu To be fair I would not understand the question, or find it really misleading because for me 8th bit is still 8th bit which is 0x100, if you would say that 8th bit counting from most significant bit to 24th bit counting from most significant bit. But it&#39;s just subjective, because it&#39;s semantics.  It&#39;s a little bit like trying to say that you want value 1 from maximum value. Instead of saying you want maximum value minus 1."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": -1, "last_activity_date": 1481143216, "last_edit_date": 1481143216, "creation_date": 1481140307, "answer_id": 41026148, "question_id": 41025831, "link": "https://stackoverflow.com/questions/41025831/get-a-sequence-bits-from-a-unsigned-long-c/41026148#41026148", "title": "Get a sequence bits from a unsigned long c", "body": "<ol>\n<li><p>Write a function that returns a number in which all but bits 8-23 are turned off.</p>\n\n<pre><code>unsigned long getTransformedNumber(unsigned long in);\n</code></pre></li>\n<li><p>Use that function while comparing the numbers.</p>\n\n<pre><code>if ( getTransformedNumber(q0XORq1) == getTransformedNumber(zprime) )\n{\n   ...\n}\n</code></pre></li>\n</ol>\n\n<p>You can implement <code>getTransformedNumber</code> as:</p>\n\n<pre><code>unsigned long getTransformedNumber(unsigned long in)\n{\n   unsigned long mask = 0;\n   if ( sizeof(in) == 32 )\n   {\n      mask = 0xFFFF00;\n   }\n   else if ( sizeof(in) == 64 )\n   {\n      mask = 0xFFFF0000000000;\n   }\n   else\n   {\n      // Make sure to deal with the case where sizeof(in) is\n      // different from 32 and 64.\n      assert(0);\n   }\n\n   return (mask &amp; in);\n}\n</code></pre>\n\n<p><strong>Clarification regarding bits 8-23</strong></p>\n\n<p>For a 32 bit unsigned long, the bits 8-23 are the middle 16 bits. Hence, the mask <code>0x00FFFF00</code> works without any confusion.</p>\n\n<p>However, for a 64 bit unsigned long, the notion of bits 8-23 is not clear. If you use mask <code>0x0000000000FFFF00</code>, you pick the bits 8-23 from the right hand side. If you use the mask <code>0x00FFFF0000000000</code>, you pick the bits 8-23 from the left hand side. Depending on which bits are desired, you need to pick the right mask.</p>\n"}], "owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481143216, "creation_date": 1481139207, "last_edit_date": 1481139783, "question_id": 41025831, "link": "https://stackoverflow.com/questions/41025831/get-a-sequence-bits-from-a-unsigned-long-c", "title": "Get a sequence bits from a unsigned long c", "body": "<p>I am wondering if anyone can help me I am just learning c and I apologize in advance if I am using the incorrect terms. I am trying to implement a an algorithm but I am having a problem at one particular part where there is a check compare a sequence of bits.</p>\n\n<p>The algorithm  states this check. </p>\n\n<p><a href=\"https://i.stack.imgur.com/KAsQo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KAsQo.png\" alt=\"algorithm if check\"></a></p>\n\n<p>But cant seem to find an example how to implement the if statement part.</p>\n\n<pre><code>        unsigned long zprime   = 2501328903\n        unsigned long q0XORq1  = 3736417748;\n\n        if ( q0XORq1 == zprime )\n        {\n\n        }\n</code></pre>\n\n<p>so I want to compare bits 8 to 23 on q0XORq1 to bits 8 to 23 on zprime </p>\n"}, {"tags": ["c", "arrays", "algorithm"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1481139058, "post_id": 41025752, "comment_id": 69258771, "body": "so you want to check if <code>arr1</code> and <code>arr2</code> have the same contents irregardless of order?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1481139351, "post_id": 41025752, "comment_id": 69258917, "body": "@yano the edit says (implies) it is rotated, otherwise same order."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481139550, "post_id": 41025752, "comment_id": 69259031, "body": "What is your question please?"}, {"owner": {"reputation": 591, "user_id": 6129388, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4eUyg.jpg?s=128&g=1", "display_name": "Ahmed Aboumalek", "link": "https://stackoverflow.com/users/6129388/ahmed-aboumalek"}, "edited": false, "score": 0, "creation_date": 1481139669, "post_id": 41025752, "comment_id": 69259105, "body": "Did you write any code or tried to at least? If yes please do post it to help us help you."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1481139712, "post_id": 41025752, "comment_id": 69259120, "body": "ohh, got it. Well my first un-optimized instinct would just be to rotate <code>arr1</code> by one, then <code>memcmp</code> with <code>arr2</code> .. rinse and repeat until you find a match or rotate the length of <code>arr1</code>. I&#39;m sure there&#39;s a more optimal solution, however. First thing, check that <code>arr1</code> and <code>arr2</code> are the same length."}], "answers": [{"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481140812, "post_id": 41026096, "comment_id": 69259776, "body": "I think you&#39;re missing the headers that declare those functions - are they in <code>&lt;algorithm&gt;</code>?  Actually, they can&#39;t be, because this is C, not C++."}, {"owner": {"reputation": 12925, "user_id": 4668606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9l7Y.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/4668606/paul"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481141210, "post_id": 41026096, "comment_id": 69260024, "body": "@TobySpeight This is obviously a homework question. I&#39;m willing to throw in an approach to solve the problem and a bit of help understanding the problem, but not more. As for the headers: this is pseudocode, not an actual implementation."}], "tags": [], "owner": {"reputation": 12925, "user_id": 4668606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9l7Y.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/4668606/paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1481140632, "last_edit_date": 1481140632, "creation_date": 1481140103, "answer_id": 41026096, "question_id": 41025752, "link": "https://stackoverflow.com/questions/41025752/compare-arrays-integer-values-with-shifted-values/41026096#41026096", "title": "compare arrays integer values with shifted values", "body": "<p>Well, if the arrays are just rotated versions of each other, they must be of equal length and there must exist at least one offset, such that <code>rotate(arr1, offset) == arr2</code>.  </p>\n\n<p>Thus we know that <code>concat(arr2, arr2)</code> must be equivalent to <code>rotate(concat(arr1, arr1), offset)</code> and thus must contain <code>arr1</code> without rotation at position <code>offset</code>. </p>\n\n<p>And there we are with the classical substring-matching problem. There won't be any better solution to this problem than the algorithms to solve the former simply because they are equivalent.</p>\n\n<p>A pretty simple solution to this problem would be elimination of probable offsets:</p>\n\n<pre><code>//generate a list of offsets from the first element in arr1\nlist offsets = indicesOf(arr1[0], arr2)\n\nint i = 0\nwhile !offsets.empty &amp;&amp; i &lt; length(arr1):\n    //generate the rotational offsets of the next char\n    list nextoffsets = indicesOf(arr1[i], arr2)\n    //make offsets the list of offsets that are valid for all elements up to arr1[i]\n    offsets = intersection(offsets, nextoffsets)\n\n    i++\n\nreturn !offsets.empty\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 12925, "user_id": 4668606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9l7Y.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/4668606/paul"}, "edited": false, "score": 0, "creation_date": 1481143258, "post_id": 41026162, "comment_id": 69261206, "body": "@Paul You are right. But it is enough to add an external loop and the function will work for any arrays."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 0, "creation_date": 1481143358, "post_id": 41026162, "comment_id": 69261258, "body": "@JohnKugelman You need to find where the second array starts in the first array. To do that you need to find the first element of the second array in the first array and then starting with the found position to compare all elements of the arrays."}, {"owner": {"reputation": 12925, "user_id": 4668606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9l7Y.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/4668606/paul"}, "edited": false, "score": 0, "creation_date": 1481143582, "post_id": 41026162, "comment_id": 69261380, "body": "@VladfromMoscow this code could be simplified quite a lot. You could simply leave the loop for calculating the offset away and wouldn&#39;t need to check if <code>m &lt; n</code> before the comparison without altering the functionality at all. It&#39;s brute-force, but it works. As for the explanation: I think what JohnKugelman meant was that you should add comments to the question. Personally I don&#39;t have a problem with understand the code, but I doubt OP will cope with this that easy."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1481145808, "last_edit_date": 1481145808, "creation_date": 1481140344, "answer_id": 41026162, "question_id": 41025752, "link": "https://stackoverflow.com/questions/41025752/compare-arrays-integer-values-with-shifted-values/41026162#41026162", "title": "compare arrays integer values with shifted values", "body": "<p>Here you are</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint is_equivalent(const int a[], const int b[], size_t n)\n{\n    int success = 0;\n\n    for ( size_t m = 0; !success &amp;&amp; m &lt; n;  )\n    {\n        // Try to find in the array a the first element of the array b\n        // If there is no such an element then the arrays are different.\n        // Otherwise compare elements of the arrays starting from the\n        // found element in a and the first element in b\n        while (m &lt; n &amp;&amp; a[m] != b[0]) ++m;\n\n        if (m != n)\n        {\n            size_t i = 1;\n            size_t j = ++m % n;\n\n            while (i &lt; n &amp;&amp; b[i] == a[j])\n            {\n                ++i; ++j;\n                j %= n;\n            }\n\n            success = i == n;\n        }\n    }\n\n    return success;\n}\n\nint main( void )\n{\n    {\n        int a[] = { 1, 2, 3, 4, 5 };\n        int b[] = { 3, 4, 5, 1, 2 };\n\n        printf(\"The arrays are equivalent: %d\\n\",\n            is_equivalent(a, b, sizeof(a) / sizeof(*a)));\n    }\n\n    {\n        int a[] = { 1, 2, 3, 4, 5 };\n        int b[] = { 3, 4, 5, 2, 1 };\n\n        printf(\"The arrays are equivalent: %d\\n\",\n            is_equivalent(a, b, sizeof(a) / sizeof(*a)));\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>The arrays are equivalent: 1\nThe arrays are equivalent: 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481140749, "post_id": 41026224, "comment_id": 69259727, "body": "Although this code may help to solve the problem, it doesn&#39;t explain <i>why</i> and/or <i>how</i> it answers the question. Providing this additional context  would significantly improve its long-term value. Please <a href=\"https://stackoverflow.com/posts/41026224/edit\">edit</a> your answer to add explanation, including what limitations and assumptions apply.  Just because the question is poor and vague doesn&#39;t mean that the answer should be terse and uninformative!"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481140968, "post_id": 41026224, "comment_id": 69259860, "body": "It is almost self explanatory, so there is no need to add further explanation."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 12925, "user_id": 4668606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9l7Y.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/4668606/paul"}, "edited": false, "score": 0, "creation_date": 1481142896, "post_id": 41026224, "comment_id": 69261028, "body": "@Paul Sure. I changed the algorithm."}, {"owner": {"reputation": 12925, "user_id": 4668606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9l7Y.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/4668606/paul"}, "edited": false, "score": 0, "creation_date": 1481143215, "post_id": 41026224, "comment_id": 69261190, "body": "@BLUEPIXY looks fine to me. Though it&#39;s just the bruteforce-search which OP wanted to avoid..."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481143590, "post_id": 41026224, "comment_id": 69261383, "body": "<code>memcmp</code> is not to search exhaustively every time."}, {"owner": {"reputation": 12925, "user_id": 4668606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9l7Y.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/4668606/paul"}, "edited": false, "score": 0, "creation_date": 1481143761, "post_id": 41026224, "comment_id": 69261467, "body": "@BLUEPIXY so what do you think <code>memcmp</code> does? It&#39;s a tweaked exhaustive search under the hood."}], "tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 1, "last_activity_date": 1481143249, "last_edit_date": 1481143249, "creation_date": 1481140560, "answer_id": 41026224, "question_id": 41025752, "link": "https://stackoverflow.com/questions/41025752/compare-arrays-integer-values-with-shifted-values/41026224#41026224", "title": "compare arrays integer values with shifted values", "body": "<p>try this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\nbool check(size_t size, int arr1[], int arr2[]){\n    int *temp = malloc(size * 2 * sizeof *temp);\n    memcpy(temp, arr1, size * sizeof *temp);\n    memcpy(temp+size, arr1, size * sizeof *temp);//[1,2,3] --&gt; [1,2,3,1,2,3]\n\n    size_t i;\n    for(i = 0; i &lt; size; ++i)\n        if(memcmp(temp+i, arr2, size * sizeof *temp) == 0)\n            break;\n    free(temp);\n    return i != size;\n}    \n\n#define TEST(size, a1, a2) puts(check(size, a1, a2) ? \"same\" : \"not same\")\n\nint main(void) {\n    int arr1[] = {1,2,3,4,5};\n    int arr2[] = {3,4,5,1,2};\n    int arr3[] = {3,4,5,2,1};\n    int arr4[] = {1, 0, 1, 1, 0};\n    int arr5[] = {1, 0, 1, 0, 1};\n    size_t size = sizeof(arr1)/sizeof(*arr1);\n\n    TEST(size, arr1, arr2);\n    TEST(size, arr1, arr3);\n    TEST(size, arr4, arr5);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1481147542, "post_id": 41027546, "comment_id": 69263513, "body": "Well... no, I&#39;m sorry. Please, consider what your function will return in case of <code>int arr1[] = {1,1,1}; int arr2[] = {3};</code> or <code>int arr1[] = {-1,2,1}; int arr2[] = {1,1,0};</code>, for example."}], "tags": [], "owner": {"reputation": 15, "user_id": 7202123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/405201f2050c9b791673d7dbf694afe0?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/7202123/adam"}, "is_accepted": false, "score": 0, "last_activity_date": 1481145469, "creation_date": 1481145469, "answer_id": 41027546, "question_id": 41025752, "link": "https://stackoverflow.com/questions/41025752/compare-arrays-integer-values-with-shifted-values/41027546#41027546", "title": "compare arrays integer values with shifted values", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint isArraySame(int arr1[], int arr2[], int len1, int len2){\n    int var1=0;\n    int var2=0;\n    int index=0;\n\n    for (index=0;index&lt;len1;index++){\n        var1+=arr1[index];\n    }\n\n    for (index=0;index&lt;len2;index++){\n        var2+=arr2[index];\n    }\n\n    if (var1==var2) return 1;\n    return 0;\n}\n\nint main(){\n    int arr1[] = {1,2,3,4,5};\n    int arr2[] = {3,4,5,1,2};\n    if (isArraySame(arr1, arr2, 5, 5)) {\n        printf(\"true\");\n    } else {\n        printf(\"false\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 0, "last_activity_date": 1484896568, "last_edit_date": 1484896568, "creation_date": 1484870241, "answer_id": 41753864, "question_id": 41025752, "link": "https://stackoverflow.com/questions/41025752/compare-arrays-integer-values-with-shifted-values/41753864#41753864", "title": "compare arrays integer values with shifted values", "body": "<p>You may be interested in the C++ equivalent for this.  It's instructive to see how the Standard Library provides much higher-level abstractions than are available to the C programmer.</p>\n\n<p>First of all, we'll want a sensible signature for our function.  Let's make it a template, so we can use <code>std::array</code> as happily as <code>std::vector</code> and <code>struct Foo</code> as happily as <code>int</code>:</p>\n\n<pre><code>template&lt;typename T&gt;\nbool equals_rotated(const std::vector&lt;T&gt;&amp; a, const std::vector&lt;T&gt;&amp; b);\n</code></pre>\n\n<p>And some simple tests:</p>\n\n<pre><code>int main()\n{\n    const auto e = equals_rotated&lt;int&gt;;\n    return !e({}, {})\n        +   e({1, 2, 3, 4} , {1, 2, 3})\n        +  !e({1, 2, 3}    , {1, 2, 3})\n        +   e({1, 2, 3, 4} , {1, 2, 4, 3})\n        +  !e({1, 2, 3, 4} , {4, 1, 2, 3})\n        ;\n}\n</code></pre>\n\n<p>The implementation is straightforward.  We know that if the arrays differ in length then they can't be equivalent; conversely, if they are identical, they must be equivalent.  So let's return early in those cases:</p>\n\n<pre><code>if (a.size() != b.size())\n    return false;\nif (a == b)\n    return true;\n</code></pre>\n\n<p>For the general case, we can make a concatenation of <code>a</code> and itself, and then test whether that contains <code>b</code> as a subsequence.  This will have an impact on the memory requirement, but it makes for a simple implementation:</p>\n\n<pre><code>auto v = a;\nv.reserve(2*a.size());\nstd::copy(a.begin(), a.end(), std::back_inserter(v));\nreturn std::search(v.begin(), v.end(), b.begin(), b.end()) != v.end();\n</code></pre>\n\n<hr>\n\n<p>If we put that all together, include the necessary headers, and add a wrapper so that we can call it from C, we get:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;iterator&gt;\n#include &lt;vector&gt;\n\ntemplate&lt;typename IterA, typename IterB&gt;\nbool equals_rotated(IterA a_begin, IterA a_end, IterB b_begin, IterB b_end)\n{\n    // trivial tests\n    if (a_end - a_begin != b_end - b_begin)\n        return false;\n    if (std::equal(a_begin, a_end, b_begin, b_end))\n        return true;\n    // Otherwise, make a copy of a+a\n    std::vector&lt;typename std::iterator_traits&lt;IterA&gt;::value_type&gt; v;\n    v.reserve(2 * (a_end - a_begin));\n    const auto ins = std::back_inserter(v);\n    std::copy(a_begin, a_end, ins);\n    std::copy(a_begin, a_end, ins);\n    // and test whether it contains b\n    return std::search(v.begin(), v.end(), b_begin, b_end) != v.end();\n}\n\ntemplate&lt;typename T&gt;\nbool equals_rotated(const std::vector&lt;T&gt;&amp; a, const std::vector&lt;T&gt;&amp; b)\n{\n    return equals_rotated(a.begin(), a.end(), b.begin(), b.end());\n}\n\nextern \"C\" {\n    bool is_rotated_array(int *a, size_t a_len, int *b, size_t b_len)\n    {\n        return equals_rotated(a, a+a_len, b, b+b_len);\n    }\n}\n\nint main()\n{\n    const auto e = equals_rotated&lt;int&gt;;\n    return !e({}, {})\n        +   e({1, 2, 3, 4} , {1, 2, 3})\n        +  !e({1, 2, 3}    , {1, 2, 3})\n        +   e({1, 2, 3, 4} , {1, 2, 4, 3})\n        +  !e({1, 2, 3, 4} , {4, 1, 2, 3})\n        ;\n}\n</code></pre>\n"}], "owner": {"reputation": 999, "user_id": 759468, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iFYiM.jpg?s=128&g=1", "display_name": "mardon", "link": "https://stackoverflow.com/users/759468/mardon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 41026162, "answer_count": 5, "score": 3, "last_activity_date": 1484896568, "creation_date": 1481138881, "last_edit_date": 1481163924, "question_id": 41025752, "link": "https://stackoverflow.com/questions/41025752/compare-arrays-integer-values-with-shifted-values", "title": "compare arrays integer values with shifted values", "body": "<p>I want create function which compares two arrays so that if they have the same values in a certain order (which may be maybe shifted) returns <code>true</code>.</p>\n\n<p>For example</p>\n\n<pre><code>int arr1[] = {1,2,3,4,5}\nint arr2[] = {3,4,5,1,2}\n</code></pre>\n\n<p>are the same, or <code>true</code></p>\n\n<p>while</p>\n\n<pre><code>int arr1[] = {1,2,3,4,5}\nint arr2[] = {3,4,5,2,1}\n</code></pre>\n\n<p>are not same, and so <code>false</code>.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c++", "c", "multidimensional-array", "parallel-processing", "mpi"], "answers": [{"tags": [], "owner": {"reputation": 35454, "user_id": 1366871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3ec9d9128a25ba6eae8a1d42c2eb04a?s=128&d=identicon&r=PG", "display_name": "dreamcrash", "link": "https://stackoverflow.com/users/1366871/dreamcrash"}, "is_accepted": true, "score": 2, "last_activity_date": 1481148878, "last_edit_date": 1481148878, "creation_date": 1481147805, "answer_id": 41028109, "question_id": 41025693, "link": "https://stackoverflow.com/questions/41025693/mpi-scatter-a-2d-array-in-other-2d-arrays/41028109#41028109", "title": "MPI_Scatter a 2D array in other 2D arrays", "body": "<p>The problem with your code is that you declared two variables with the name matrix:</p>\n\n<p><code>int **matrix;</code> </p>\n\n<p>and </p>\n\n<p><code>int (*matrix)[cols] = malloc(sizeof *matrix* rows);</code></p>\n\n<p>and since the latter was declared inside the if (my_rank == 0) {..} the variable begin used in the scatter <code>MPI_Scatter(matrix, local_rows*rows, MPI_INT,local_matrix, local_rows*rows, MPI_INT, 0,   MPI_COMM_WORLD);</code></p>\n\n<p>is the first one, the not allocated one, and not the one you allocated space for. That is why you are getting the error.</p>\n\n<p>Try this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include \"mpi.h\"\n\nint main(int argc, char** argv) {\n\nint my_rank;\nint p;\nint root;\nint rows = 0;\nint cols = 0;\n\nint i, j;\nint local_rows;\nint answer = 0;\nint broke = 0;\nMPI_Init(&amp; argc, &amp; argv);\nMPI_Comm_rank(MPI_COMM_WORLD, &amp; my_rank);\nMPI_Comm_size(MPI_COMM_WORLD, &amp; p);\n\nint (*matrix)[cols];\n\nif (my_rank == 0) {\n\n    do {\n        printf(\"Enter Dimensions NxN\\n\");\n        scanf(\"%d\", &amp; rows);\n        scanf(\"%d\", &amp; cols);\n        if (cols != rows) {\n            printf(\"Columns must be the same as rows,enter dimensions again.\\n\");\n        }\n\n    } while (rows != cols);        \n\n    matrix = malloc(sizeof *matrix * rows);\n\n    printf(\"Fill array %dx%d\\n\", rows, cols);\n    for (i = 0; i &lt; rows; i++) {\n        for (j = 0; j &lt; cols; j++) {\n            scanf(\"%d\",&amp;matrix[i][j]);\n\n        }\n    }\n\n    printf(\"\\n\");\n    for (i = 0; i &lt; rows; i++) {\n        for (j = 0; j &lt; cols; j++) {\n            printf(\"%d \",matrix[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n\nroot = 0;\nMPI_Bcast(&amp;rows, 1, MPI_INT, root, MPI_COMM_WORLD);\nMPI_Bcast(&amp;cols, 1, MPI_INT, root, MPI_COMM_WORLD);\nlocal_rows = rows / p;\n\n// Changed from the original\nint (*local_matrix)[cols] = malloc(sizeof *local_matrix* local_rows);\n\nprintf(\"R = (%d, %d, %d) \\n\",my_rank, local_rows, cols);\n\n\nif(my_rank == 0)\n{\n    printf(\"\\n\");\n    for (i = 0; i &lt; rows; i++) {\n        for (j = 0; j &lt; cols; j++) {\n            printf(\"%d \",matrix[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n\n\nMPI_Scatter(matrix, local_rows*cols, MPI_INT,local_matrix, \n            local_rows*cols, MPI_INT, 0,   MPI_COMM_WORLD);\n</code></pre>\n\n<p>...</p>\n\n<p>Btw I think you meant:</p>\n\n<p><code>int (*local_matrix)[cols] = malloc(sizeof *local_matrix* local_rows);</code></p>\n\n<p>and not</p>\n\n<p><code>int (*local_matrix)[rows] = malloc(sizeof *local_matrix* local_rows);</code></p>\n\n<p>Also do not forget to free the \"local_matrix\" for the slaves also.</p>\n"}], "owner": {"reputation": 13, "user_id": 7264095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1ukcOMp1OE8/AAAAAAAAAAI/AAAAAAAAAJk/jyYYH2VVppw/photo.jpg?sz=128", "display_name": "georgep", "link": "https://stackoverflow.com/users/7264095/georgep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 914, "favorite_count": 0, "accepted_answer_id": 41028109, "answer_count": 1, "score": 1, "last_activity_date": 1607797495, "creation_date": 1481138677, "last_edit_date": 1607797495, "question_id": 41025693, "link": "https://stackoverflow.com/questions/41025693/mpi-scatter-a-2d-array-in-other-2d-arrays", "title": "MPI_Scatter a 2D array in other 2D arrays", "body": "<p>I want to scatter a 2D array in other 2D arrays (one for each process) using this specific way of allocating memory.</p>\n<pre><code>int (*matrix)[cols] = malloc(sizeof *matrix* rows);\n \n</code></pre>\n<p>I keep getting this error:</p>\n<blockquote>\n<p>One of the processes started by mpirun has exited with a nonzero exit\ncode.  This typically indicates that the process finished in error.\nIf your process did not finish in error, be sure to include a &quot;return\n0&quot; or &quot;exit(0)&quot; in your C code before exiting the application.</p>\n</blockquote>\n<blockquote>\n<p>PID 7035 failed on node n0 (127.0.0.1) due to signal 11.</p>\n</blockquote>\n<p>I think the problem is on scatter but I am new to parallel programming so if anyone knows what the issue is please help me.\nThanks in advance.</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &quot;mpi.h&quot;\n\nint main(int argc, char** argv) {\n\n  int my_rank;\n  int p;\n  int root;\n  int rows = 0;\n  int cols = 0;\n  int **matrix;\n\n  int i, j;\n  int local_rows;\n  int answer = 0;\n  int broke = 0;\n\n  MPI_Init(&amp; argc, &amp; argv);\n  MPI_Comm_rank(MPI_COMM_WORLD, &amp; my_rank);\n  MPI_Comm_size(MPI_COMM_WORLD, &amp; p);\n\n  if (my_rank == 0) {\n\n    do {\n        printf(&quot;Enter Dimensions NxN\\n&quot;);\n        scanf(&quot;%d&quot;, &amp; rows);\n        scanf(&quot;%d&quot;, &amp; cols);\n        if (cols != rows) {\n            printf(&quot;Columns must be the same as rows,enter dimensions again.\\n&quot;);\n        }\n    } while (rows != cols);        \n    int (*matrix)[cols] = malloc(sizeof *matrix* rows);\n\n    printf(&quot;Fill array %dx%d\\n&quot;, rows, cols);\n    for (i = 0; i &lt; rows; i++) {\n        for (j = 0; j &lt; cols; j++) {\n            scanf(&quot;%d&quot;,&amp;matrix[i][j]);\n\n        }\n    }\n\n    printf(&quot;\\n&quot;);\n    for (i = 0; i &lt; rows; i++) {\n        for (j = 0; j &lt; cols; j++) {\n            printf(&quot;%d &quot;,matrix[i][j]);\n        }\n        printf(&quot;\\n&quot;);\n    }\n  }\n\n  root = 0;\n  MPI_Bcast(&amp;rows, 1, MPI_INT, root, MPI_COMM_WORLD);\n  MPI_Bcast(&amp;cols, 1, MPI_INT, root, MPI_COMM_WORLD);\n  local_rows = rows / p;\n\n\n  int (*local_matrix)[rows] = malloc(sizeof *local_matrix* local_rows);\n\n  MPI_Scatter(matrix, local_rows*rows, MPI_INT,local_matrix, local_rows*rows, MPI_INT, 0,   MPI_COMM_WORLD);\n\n  printf(&quot;\\nLocal matrix fo the process %d is :\\n&quot;, my_rank);\n\n  for (i = 0; i &lt; local_rows; i++) {\n      for (j = 0; j &lt; cols; j++) {\n        printf(&quot;%d &quot;, local_matrix[i][j]);\n    }\n    printf(&quot;\\n&quot;);\n  }\n  if (my_rank==0){\n     free(matrix);\n     free(local_matrix);\n  }   \n  MPI_Finalize();\n}\n</code></pre>\n"}, {"tags": ["c", "casting"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1481138432, "post_id": 41025604, "comment_id": 69258423, "body": "I can&#39;t imagine why your colleague believes this - it is most assuredly a feature of the <code>c</code> language.  It is a common (and required) functionality."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1481138465, "post_id": 41025604, "comment_id": 69258441, "body": "return value is just an rvalue"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1481138552, "post_id": 41025604, "comment_id": 69258492, "body": "Any claim has to be supported by some evidence. Does your colleague have one? Otherwise it is called a &quot;speculation&quot;."}, {"owner": {"reputation": 405, "user_id": 6870832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26263481771ee7b018c7b3ccdba56d30?s=128&d=identicon&r=PG&f=1", "display_name": "phreaknik", "link": "https://stackoverflow.com/users/6870832/phreaknik"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1481138682, "post_id": 41025604, "comment_id": 69258558, "body": "@EugeneSh. I agree completely! He had no evidence, but he is also an intelligent person, so I did not want to immediately discount his claim. Thanks for your response."}], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 6870832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26263481771ee7b018c7b3ccdba56d30?s=128&d=identicon&r=PG&f=1", "display_name": "phreaknik", "link": "https://stackoverflow.com/users/6870832/phreaknik"}, "edited": false, "score": 0, "creation_date": 1481140205, "post_id": 41026058, "comment_id": 69259375, "body": "Sure enough. Thanks for backing up your claims!"}], "tags": [], "owner": {"reputation": 585, "user_id": 7039091, "user_type": "registered", "profile_image": "https://graph.facebook.com/1228413217190279/picture?type=large", "display_name": "yLaguardia", "link": "https://stackoverflow.com/users/7039091/ylaguardia"}, "is_accepted": true, "score": 2, "last_activity_date": 1481140324, "last_edit_date": 1481140324, "creation_date": 1481139961, "answer_id": 41026058, "question_id": 41025604, "link": "https://stackoverflow.com/questions/41025604/is-it-acceptable-to-type-cast-the-return-value-of-a-c-function/41026058#41026058", "title": "Is it acceptable to type-cast the return value of a C function?", "body": "<p>Other than what's answered in the comments, you can back your argument with some article like <a href=\"https://www.securecoding.cert.org/confluence/display/c/FLP07-C.+Cast+the+return+value+of+a+function+that+returns+a+floating-point+type\" rel=\"nofollow noreferrer\">this</a>, that repeatedly talks about casting return values.</p>\n\n<p>One trivial example that we use every now and then is to cast the return value of the <code>round()</code> function.</p>\n\n<p>This is so trivial that you can even see it mentioned in the <a href=\"http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1570.pdf#page=567\" rel=\"nofollow noreferrer\">C Standard, page 567 of this pdf</a>.</p>\n\n<blockquote>\n  <p>In the above conversions from floating to integer, the use of (cast)x\n  can be replaced with (cast)round(x), (cast)rint(x),\n  (cast)nearbyint(x), (cast)trunc(x), (cast)ceil(x), or (cast)floor(x)</p>\n</blockquote>\n"}], "owner": {"reputation": 405, "user_id": 6870832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26263481771ee7b018c7b3ccdba56d30?s=128&d=identicon&r=PG&f=1", "display_name": "phreaknik", "link": "https://stackoverflow.com/users/6870832/phreaknik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3056, "favorite_count": 2, "accepted_answer_id": 41026058, "answer_count": 1, "score": 4, "last_activity_date": 1481140366, "creation_date": 1481138325, "last_edit_date": 1495541631, "question_id": 41025604, "link": "https://stackoverflow.com/questions/41025604/is-it-acceptable-to-type-cast-the-return-value-of-a-c-function", "title": "Is it acceptable to type-cast the return value of a C function?", "body": "<p>A colleague of mine claims that type-casting the return value of a function is undefined in C, however I cannot find anything to support his claim.</p>\n\n<p>I know that type-casting a function pointer is bad, see here:\n<a href=\"https://stackoverflow.com/questions/559581/casting-a-function-pointer-to-another-type\">Casting a function pointer to another type</a></p>\n\n<p>But I want to confirm that the following code would be acceptable and well defined:</p>\n\n<pre><code>// Some function\nint ret = foo(bar);\n\n// Some variable with some different type\nunsigned int a;\n\n// Cast function result to match variable type\na = (unsigned int) foo(bar);\n</code></pre>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1481137821, "post_id": 41025398, "comment_id": 69258096, "body": "What do you mean outcomes? With what you&#39;ve provided, the program will execute forever."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 5, "creation_date": 1481137825, "post_id": 41025398, "comment_id": 69258100, "body": "There&#39;s actually only one, syntax error."}, {"owner": {"reputation": 36701, "user_id": 830680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1055182f84974a5990d07097e94279ed?s=128&d=identicon&r=PG", "display_name": "Clive", "link": "https://stackoverflow.com/users/830680/clive"}, "edited": false, "score": 7, "creation_date": 1481137827, "post_id": 41025398, "comment_id": 69258101, "body": "Possibility 1: if you don&#39;t do your own work, you&#39;ll fail your course."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1481138685, "post_id": 41025398, "comment_id": 69258562, "body": "To expand on George&#39;s answer - the program won&#39;t run, it will fail during compilation with a syntax error."}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 4245870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cW8C3.jpg?s=128&g=1", "display_name": "dovedevic", "link": "https://stackoverflow.com/users/4245870/dovedevic"}, "edited": false, "score": 0, "creation_date": 1481138056, "post_id": 41025463, "comment_id": 69258223, "body": "Not sure why the downvotes..?"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 1, "creation_date": 1481138124, "post_id": 41025463, "comment_id": 69258253, "body": "Not the dv, but even if we pretend the code is compilable, it says to display 4 possible outcomes, it doesn&#39;t imply that 4 includes every possible outcome."}, {"owner": {"reputation": 9, "user_id": 7264100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d5736b6989ac20e229d3654aa86d00?s=128&d=identicon&r=PG&f=1", "display_name": "Amathunga", "link": "https://stackoverflow.com/users/7264100/amathunga"}, "edited": false, "score": 0, "creation_date": 1481138258, "post_id": 41025463, "comment_id": 69258333, "body": "Thanks, think I can accept Dove Devic&#39;s answer."}, {"owner": {"reputation": 613, "user_id": 4245870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cW8C3.jpg?s=128&g=1", "display_name": "dovedevic", "link": "https://stackoverflow.com/users/4245870/dovedevic"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1481138282, "post_id": 41025463, "comment_id": 69258349, "body": "Ah okay, well I will edit that then accordingly @George. Thanks"}, {"owner": {"reputation": 9, "user_id": 7264100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d5736b6989ac20e229d3654aa86d00?s=128&d=identicon&r=PG&f=1", "display_name": "Amathunga", "link": "https://stackoverflow.com/users/7264100/amathunga"}, "edited": false, "score": 1, "creation_date": 1481138478, "post_id": 41025463, "comment_id": 69258452, "body": "Thanks again, seems it has more than four answers. :-)"}], "tags": [], "owner": {"reputation": 613, "user_id": 4245870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cW8C3.jpg?s=128&g=1", "display_name": "dovedevic", "link": "https://stackoverflow.com/users/4245870/dovedevic"}, "is_accepted": true, "score": -2, "last_activity_date": 1481138255, "last_edit_date": 1481138255, "creation_date": 1481137901, "answer_id": 41025463, "question_id": 41025398, "link": "https://stackoverflow.com/questions/41025398/provide-4-possible-outcomes-of-the-following-program/41025463#41025463", "title": "Provide 4 possible outcomes of the following program", "body": "<p>Since the <code>while(true)</code> loops will go on indefinitely there are infinitely many outcomes... but here are a couple nonetheless:</p>\n\n<p>Option 1:</p>\n\n<ul>\n<li>Red Red Blue Blue...</li>\n</ul>\n\n<p>Option 2:</p>\n\n<ul>\n<li>Red Blue Red Blue... </li>\n</ul>\n\n<p>Option 3:</p>\n\n<ul>\n<li>Blue Red Red Red...</li>\n</ul>\n\n<p>Option 4:</p>\n\n<ul>\n<li>Red Red Red Red...</li>\n</ul>\n\n<p>Option 5:</p>\n\n<ul>\n<li>Blue Blue Red Red...</li>\n</ul>\n"}], "owner": {"reputation": 9, "user_id": 7264100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d5736b6989ac20e229d3654aa86d00?s=128&d=identicon&r=PG&f=1", "display_name": "Amathunga", "link": "https://stackoverflow.com/users/7264100/amathunga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "closed_date": 1483902046, "accepted_answer_id": 41025463, "answer_count": 1, "score": -7, "last_activity_date": 1481295343, "creation_date": 1481137658, "last_edit_date": 1481295343, "question_id": 41025398, "link": "https://stackoverflow.com/questions/41025398/provide-4-possible-outcomes-of-the-following-program", "closed_reason": "Needs more focus", "title": "Provide 4 possible outcomes of the following program", "body": "<p>Consider the following program with 2 threads</p>\n\n<p>Lock.lock = new Lock()</p>\n\n<p>::Thread 1::</p>\n\n<pre><code>while(true){\n   print(\"Red\");\n   print(\"Red\");\n   lock.unlock();\n}\n</code></pre>\n\n<p>::Thread 2::</p>\n\n<pre><code>while(true){\n   lock. lock()\n   print(\"Blue\");\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 5, "creation_date": 1481137650, "post_id": 41025373, "comment_id": 69258001, "body": "This kind of &quot;optimization&quot; is never going to make any difference on a modern compiler. You can easily verify this on your target platform(s) if it matters."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1481137679, "post_id": 41025373, "comment_id": 69258021, "body": "The world&#39;s code would be incredibly slow if things like this mattered. Your compiler&#39;s optimizer will deal with this. Even better, declare the variable in the for-loop."}, {"owner": {"reputation": 12925, "user_id": 4668606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9l7Y.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/4668606/paul"}, "edited": false, "score": 0, "creation_date": 1481137726, "post_id": 41025373, "comment_id": 69258044, "body": "depends on how much the code gets optimized. It should get optimized away by any uptodate compiler if optimization is enabled and shouldn&#39;t have much of an impact on performance anyways."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1481138015, "post_id": 41025373, "comment_id": 69258199, "body": "Well, <i>theoretically</i>, without any compiler optimizations, and with a dumb straight-forward compiler the initializer value has to be a part of the binary, impacting it&#39;s size along with a startup code performing the actual assignment. It should be noted, that uninitialized variables with a static storage class will somewhat suffer from similar issue, as they have to be reset to zero by the startup code."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1481138152, "post_id": 41025373, "comment_id": 69258268, "body": "Once a while ago, before <code>-O65535</code> was common, there were &quot;native compilers&quot; that does not do any optimization (ones that do are called &quot;optimization compilers&quot;). At that time, this kind of tuning is useful. But now things are different, because only a few optimization compilers survived."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1481138955, "post_id": 41025373, "comment_id": 69258716, "body": "This is trivial for an optimizing compiler to elide. Think about it a bit. You basically have <code>int i = 0; i = 0;</code>. You don&#39;t even have to be as smart as a modern optimizer to see that one of those is redundant! But that doesn&#39;t mean you should write code like this; it is confusing for humans that are reading it. In fact, you should keep the declaration of variables to as limited a scope as possible. Thus, you should write the loop as <code>for (int i = 0; i &lt; 10; i++) { ... }</code>, so that <code>i</code> is not even accessible outside of the loop body."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1481137907, "post_id": 41025396, "comment_id": 69258147, "body": "I think it is bad advice to tell anyone reading the code to look somewhere else to see what the initial value of the control variable is to be."}], "tags": [], "owner": {"reputation": 4060, "user_id": 763355, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/dxAhW.jpg?s=128&g=1", "display_name": "MoDJ", "link": "https://stackoverflow.com/users/763355/modj"}, "is_accepted": false, "score": 2, "last_activity_date": 1481137654, "creation_date": 1481137654, "answer_id": 41025396, "question_id": 41025373, "link": "https://stackoverflow.com/questions/41025373/c-variable-initialize-overhead/41025396#41025396", "title": "C variable initialize overhead", "body": "<p>The compiler will generally be able to make short work of a simple case like that. Best approach is to put the int i=0 inside the for loop. If you need to use the i after the loop, then init it before hand and leave the init part of the for loop empty.</p>\n"}, {"tags": [], "owner": {"reputation": 520, "user_id": 5455966, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/74882f5054200f9ab65418e3e1681143?s=128&d=identicon&r=PG&f=1", "display_name": "MateoConLechuga", "link": "https://stackoverflow.com/users/5455966/mateoconlechuga"}, "is_accepted": true, "score": 3, "last_activity_date": 1481138381, "creation_date": 1481138381, "answer_id": 41025617, "question_id": 41025373, "link": "https://stackoverflow.com/questions/41025373/c-variable-initialize-overhead/41025617#41025617", "title": "C variable initialize overhead", "body": "<p>The compiler does not dynamically allocate auto variables. There is no 'init', so to speak. Therefore, there is no real purpose behind moving variable declarations around other than preventing scoping issues.</p>\n"}, {"tags": [], "owner": {"reputation": 879, "user_id": 5693785, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/mfKhd.jpg?s=128&g=1", "display_name": "ron", "link": "https://stackoverflow.com/users/5693785/ron"}, "is_accepted": false, "score": 0, "last_activity_date": 1481141804, "creation_date": 1481141804, "answer_id": 41026580, "question_id": 41025373, "link": "https://stackoverflow.com/questions/41025373/c-variable-initialize-overhead/41026580#41026580", "title": "C variable initialize overhead", "body": "<p>to verify overhead you want to generate <strong>assembly language</strong>.\nYou can do this via</p>\n\n<p><strong>gcc -c -O0  -S</strong></p>\n\n<p>you will need to use the <code>-c</code> flag, and and it will result in a file named <code>yourcode.s</code>.</p>\n\n<p>Rename each assembly language .s file before redoing the gcc command with each compiler option for optimization, <strong>-O1, -O2, -O3</strong>.</p>\n\n<p>From these assembly language files you can then determine exactly what overhead there would be and if it is significant.</p>\n\n<pre><code>int main ( int argc, char *argv[] )\n{\n   int i;\n   int j;\n\n   i=5543644;    /* to have or not to have this line*/\n   for ( i = 0; i &lt; 2342465; i++ )\n      j = i;\n\n   return 0;\n}\n</code></pre>\n\n<p>Given this code example, when compiling with optimization <strong>-O0</strong> for the case where <code>i=5543644</code> exists and does not exist, the only difference in the two assembly language files generated is one line which is</p>\n\n<pre><code>movl    $5543644, -8(%rbp)\n</code></pre>\n\n<p>which is the copying of the data value  <strong>5543644</strong> into the memory address of <strong>i</strong>.  I used a value other than zero to make it obvious in the assembly language.</p>\n\n<p>when using compiler optimization <strong>-O3</strong>, the resulting two assembly language files are <strong>identical</strong>.  This proves that optimization results in the compiler identifying the <code>i=5543644;</code> directly before the <code>for</code> loop to be useless, and the resulting <code>movl</code> line found when doing <strong>-O0</strong> is not generated.</p>\n\n<p>this was tested using gcc 4.3.4.</p>\n\n<p>From your simple code example of just <code>int i = 0;</code> one does not need to do this to know there is no real world overhead, but as code gets very large and complex, if the useless <code>i = 5543644;</code> is not directly before the for loop then it may not get optimized out. The source code and assembly language would have to be scrutinized to make that determination.</p>\n\n<p>If this type of data assignment does happen, for example within nested for loops and within OPENMP or other parallelization directives causing it happen millions or billions of times depending on the code, then yes it would cause overhead.  How significant that may be could be quite subjective.</p>\n"}], "owner": {"reputation": 1411, "user_id": 6018651, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/17f6ddba3381095e37c4cc8599316689?s=128&d=identicon&r=PG", "display_name": "beetlej", "link": "https://stackoverflow.com/users/6018651/beetlej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 41025617, "answer_count": 3, "score": 1, "last_activity_date": 1481141804, "creation_date": 1481137535, "question_id": 41025373, "link": "https://stackoverflow.com/questions/41025373/c-variable-initialize-overhead", "title": "C variable initialize overhead", "body": "<p>Think about below code:</p>\n\n<pre><code>int i=0;//initialize here\nfor (i=0;i&lt;10;i++) {\n    //... do something here\n}\n</code></pre>\n\n<p>since i will be initialized in for loop, we no need to initialize it when define it. but if we do initialize, any overhead after translate to binary code?</p>\n"}, {"tags": ["c", "pointers", "malloc"], "comments": [{"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1481134582, "post_id": 41024463, "comment_id": 69256183, "body": "Why are you allocating space for 2 structs? And what do you mean when you say the size of the contents will be different? How so?"}, {"owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "edited": false, "score": 0, "creation_date": 1481134789, "post_id": 41024463, "comment_id": 69256300, "body": "sorry maybe i made a mistake. I want to allocate space for 1 struct. The contents will be different each time i loop. I am looping through a file pulling each line a storing each line in its respected field within the struct. After i have filled all the fields i write to a file those contents in a different order. my loop will then continue reading the file and store the next set of data into the struct so the fields may differ in size the second time around."}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1481143433, "post_id": 41024463, "comment_id": 69261295, "body": "You cannot change the size of the elements in the struct. They will always be the size they were declared as. If the strings you read into those arrays are less then the size of the array, that&#39;s fine. You don&#39;t need to do anything about that."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "edited": false, "score": 0, "creation_date": 1481135087, "post_id": 41024568, "comment_id": 69256461, "body": "I know i don&#39;t necessary need it but would if one of my fields is a char array[101] that is only filled half way. I want to make that field slim down to the exact size needed. I only want to take up as much space as i need to. For practice sake."}, {"owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "edited": false, "score": 0, "creation_date": 1481135472, "post_id": 41024568, "comment_id": 69256691, "body": "I&#39;m not there yet and it is probably a separate question, but i want to make all my fields pointers so that i can just point to one char [101] if that is possible."}, {"owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "edited": false, "score": 0, "creation_date": 1481135561, "post_id": 41024568, "comment_id": 69256742, "body": "if i fill it with data up to [50] id like to only have to use up to [50] . Does that make sense?"}, {"owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "edited": false, "score": 0, "creation_date": 1481136354, "post_id": 41024568, "comment_id": 69257258, "body": "I have edited the question to just try and figure out first how to allocate memory for my studentContent variable."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "edited": false, "score": 1, "creation_date": 1481136665, "post_id": 41024568, "comment_id": 69257440, "body": "@bodotheguy You don&#39;t need to allocate any memory.  Just define an instance of the struct like you&#39;re doing.  If that doesn&#39;t meet your needs, explain <i>why</i> it doesn&#39;t (preferably with code) and what might."}, {"owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "edited": false, "score": 1, "creation_date": 1481136715, "post_id": 41024568, "comment_id": 69257472, "body": "You are right, i need to re-think what i am truly trying to ask. I will do so and ask again after i try a few things."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1481134754, "creation_date": 1481134754, "answer_id": 41024568, "question_id": 41024463, "link": "https://stackoverflow.com/questions/41024463/how-to-allocate-memory-of-a-struct-variable/41024568#41024568", "title": "how to allocate memory of a struct variable", "body": "<p>The first assignment sets <code>ptr</code> to the address of the local variable <code>studentContent</code>, however the next line overwrites that.  It changes <code>ptr</code> to point to a dynamically allocated buffer with space for 2 instances of <code>struct contactInfo</code>. </p>\n\n<p>If what you want is to have an <strong>array</strong> of <code>struct contactInfo</code>, and have the number of elements of that array increase as you have more instances of <code>struct contactInfo</code> to populate, you pass <code>ptr</code> to <code>realloc</code> with a size of <code>n * sizeof *ptr</code>, where <code>n</code> is the number of elements in the array.</p>\n\n<pre><code>struct contactInfo *tmp_ptr = realloc(ptr, n * sizeof *ptr);\nif (tmp_ptr == NULL) {\n    perror(\"realloc failed\");\n    exit(1);\n}\nptr = tmp_ptr;\n</code></pre>\n\n<p>Note that you don't have to declare an instance of <code>struct contactInfo</code> (<code>studentContent</code> in your original code), just a pointer to one.</p>\n\n<p>EDIT:</p>\n\n<p>Based on your comment, since you just need a single instance to populate in order to read and write one chuck of data at a time, you don't need to use dynamic memory allocation.  Just declare a single instance and overwrite the contents each time.</p>\n"}], "owner": {"reputation": 95, "user_id": 7143553, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/02e15ad432d86c5e81b7ad45f1ec357d?s=128&d=identicon&r=PG&f=1", "display_name": "bodotheguy", "link": "https://stackoverflow.com/users/7143553/bodotheguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 1, "accepted_answer_id": 41024568, "answer_count": 1, "score": 1, "last_activity_date": 1481137626, "creation_date": 1481134405, "last_edit_date": 1481137626, "question_id": 41024463, "link": "https://stackoverflow.com/questions/41024463/how-to-allocate-memory-of-a-struct-variable", "title": "how to allocate memory of a struct variable", "body": "<p>I am struggling to figure out how to allocate memory for my <code>studentContent</code> variable.</p>\n\n<pre><code>struct contactInfo {\n    char  Name[101];\n    char  Assignment[101];\n    char  MarkDescription[101];\n    char feedBack[12][101];\n\n};\nstruct contactInfo studentContent\n</code></pre>\n\n<p>I want to use <code>malloc()</code> to allocate memory for my structure variable. After the structure is filled I would like to reallocate the memory so I am only utilizing as much space within each field as I need to.</p>\n"}, {"tags": ["c", "arrays", "pointers", "matrix", "malloc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1481133641, "post_id": 41024221, "comment_id": 69255694, "body": "One dereference versus two? How can it be &quot;the same thing&quot; ? The lhs will even have different types."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481134146, "post_id": 41024221, "comment_id": 69255963, "body": "Unlike a 2-D array, there is no guarantee that the rows will be in contiguous memory."}, {"owner": {"reputation": 3, "user_id": 4114218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bQwzWDTjkoA/AAAAAAAAAAI/AAAAAAAAABU/JJK5NoWGbJc/photo.jpg?sz=128", "display_name": "FraKR", "link": "https://stackoverflow.com/users/4114218/frakr"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481134317, "post_id": 41024221, "comment_id": 69256048, "body": "@WeatherVane aaaah that&#39;s right. i didn&#39;t think about that. Thanks!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481134337, "post_id": 41024221, "comment_id": 69256057, "body": "Something like <code>int **</code> is not a matrix (aka 2D array), cannot point to one, nor represent one. If you want a matrix, use one and leave index-calculations to the compiler."}, {"owner": {"reputation": 3, "user_id": 4114218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bQwzWDTjkoA/AAAAAAAAAAI/AAAAAAAAABU/JJK5NoWGbJc/photo.jpg?sz=128", "display_name": "FraKR", "link": "https://stackoverflow.com/users/4114218/frakr"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481134923, "post_id": 41024221, "comment_id": 69256368, "body": "@Olaf I can&#39;t do that, because i don&#39;t know the dimension of the matrix. As you can see I have a parameter for that, so I have to allocate a &quot;matrix&quot; dynamically. You&#39;re right, it&#39;s just a pointer to pointers, but at the end it does the same thing."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481162027, "post_id": 41024221, "comment_id": 69268557, "body": "&quot;... I don&#39;t know the dimension of the matrix&quot; - A matrix has 2 dimensions! And if you mean <i>lengths</i>: What&#39;s the problem? Use a VLA, resp. pointer to a VLA!"}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1481135626, "creation_date": 1481135626, "answer_id": 41024810, "question_id": 41024221, "link": "https://stackoverflow.com/questions/41024221/c-matrix-and-pointers-error/41024810#41024810", "title": "C Matrix and pointers error", "body": "<p>Unlike a 2-D array, there is no guarantee that the rows will be in contiguous memory.</p>\n\n<p>If you make a <em>single</em> memory allocation for the whole <code>n * n</code> array, then you can index it the way that failed when using an array of pointers to 1-D arrays.</p>\n"}], "owner": {"reputation": 3, "user_id": 4114218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bQwzWDTjkoA/AAAAAAAAAAI/AAAAAAAAABU/JJK5NoWGbJc/photo.jpg?sz=128", "display_name": "FraKR", "link": "https://stackoverflow.com/users/4114218/frakr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 41024810, "answer_count": 1, "score": -2, "last_activity_date": 1481135626, "creation_date": 1481133512, "question_id": 41024221, "link": "https://stackoverflow.com/questions/41024221/c-matrix-and-pointers-error", "title": "C Matrix and pointers error", "body": "<p>This version of this function works good:</p>\n\n<pre><code>int** outerProduct(int v[], int n){\n    int i, j;\n    int **a = malloc(n*sizeof(int*));\n    for(i=0; i&lt;n; i++){\n        a[i] = malloc(n*sizeof(int));\n    }\n\n    for(i=0; i&lt;n; i++){\n        for(j=0; j&lt;n; j++){\n            *(*(a+i)+j) = v[i]*v[j];\n        }\n    }\n\n    return a;\n}\n</code></pre>\n\n<p>And this doesn't work:</p>\n\n<pre><code>int** outerProduct(int v[], int n){\n    int i, j;\n    int **a = malloc(n*sizeof(int*));\n    for(i=0; i&lt;n; i++){\n        a[i] = malloc(n*sizeof(int));\n    }\n\n    for(i=0; i&lt;n; i++){\n        for(j=0; j&lt;n; j++){\n            *(a+(i*n)+j) = v[i]*v[j];\n        }\n    }\n\n    return a;\n}\n</code></pre>\n\n<p>The error is <code>*(a+(i*n)+j) = v[i]*v[j];</code> but I don't understand why. It should be the same thing.</p>\n"}, {"tags": ["c++", "c", "cmake"], "answers": [{"comments": [{"owner": {"reputation": 1978, "user_id": 363778, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0066c9b8214ff2db6c99e8216746408d?s=128&d=identicon&r=PG", "display_name": "Linoliumz", "link": "https://stackoverflow.com/users/363778/linoliumz"}, "edited": false, "score": 0, "creation_date": 1481142216, "post_id": 41024176, "comment_id": 69260644, "body": "Thanks, that&#39;s exactly what I was looking for!"}, {"owner": {"reputation": 22989, "user_id": 1622894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fc8ff4593f37f357f8e3985d9f16902?s=128&d=identicon&r=PG&f=1", "display_name": "ollo", "link": "https://stackoverflow.com/users/1622894/ollo"}, "edited": false, "score": 0, "creation_date": 1481299881, "post_id": 41024176, "comment_id": 69335967, "body": "So, please <i>accept</i> the answer to indicate it&#39;s solved."}], "tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": false, "score": 4, "last_activity_date": 1481133358, "creation_date": 1481133358, "answer_id": 41024176, "question_id": 41024062, "link": "https://stackoverflow.com/questions/41024062/cmake-create-binary-foo-library-libfoo/41024176#41024176", "title": "CMake: Create binary foo + library libfoo?", "body": "<p>Name of the executable/library <em>file</em> isn't forced to be the same as the <em>target</em>. You may adjust name of the file created using <a href=\"https://cmake.org/cmake/help/v3.0/prop_tgt/OUTPUT_NAME.html\" rel=\"nofollow noreferrer\">OUTPUT_NAME</a> target's property:</p>\n\n<pre><code>add_library(libfoo ${LIB_SRC})\nset_target_properties(libfoo PROPERTIES OUTPUT_NAME foo)\n</code></pre>\n"}], "owner": {"reputation": 1978, "user_id": 363778, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0066c9b8214ff2db6c99e8216746408d?s=128&d=identicon&r=PG", "display_name": "Linoliumz", "link": "https://stackoverflow.com/users/363778/linoliumz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1481133358, "creation_date": 1481132918, "question_id": 41024062, "link": "https://stackoverflow.com/questions/41024062/cmake-create-binary-foo-library-libfoo", "title": "CMake: Create binary foo + library libfoo?", "body": "<p>In my CMakeLists.txt I want to create a binary named foo and a library named libfoo(.a|.so).</p>\n\n<p>So I have tried using the following code:</p>\n\n<pre><code>add_executable(foo ${BIN_SRC})\nadd_library(foo ${LIB_SRC})\n</code></pre>\n\n<p>But unfortunately the code above fails with the error message:</p>\n\n<pre><code>Make Error at CMakeLists.txt:156 (add_library):\nadd_library cannot create target \"foo\" because another target with\nthe same name already exists.  The existing target is an executable created\n</code></pre>\n\n<p>It is abovious that I have 2 targets named foo in my CMakeLists.txt which is causing the error. I could e.g. fix the bug using:</p>\n\n<pre><code>    add_library(libfoo ${LIB_SRC})\n</code></pre>\n\n<p>But then my library gets named liblibfoo(.a|.so) which is not what I want!? </p>\n"}, {"tags": ["c", "batch-file", "makefile", "c-preprocessor"], "comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 2, "creation_date": 1481163343, "post_id": 41024044, "comment_id": 69268893, "body": "Your description of problem 2 is unclear. The receiver (launched by the <code>server</code> rule) directs the output to <code>product_name.pipe</code>, and the the <code>%.enums</code> rule renames that file to something else. What&#39;s the problem?"}, {"owner": {"reputation": 1401, "user_id": 2737046, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/5gIpP.jpg?s=128&g=1", "display_name": "perencia", "link": "https://stackoverflow.com/users/2737046/perencia"}, "edited": false, "score": 1, "creation_date": 1481196116, "post_id": 41024044, "comment_id": 69283701, "body": "You could reduce all to a single target <code>%.enums</code> by using batch loops as you state in your question. Any reason not to do that ?"}, {"owner": {"reputation": 799, "user_id": 1094670, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2e9c62b124fec3ee23c99d84d58ca5bf?s=128&d=identicon&r=PG", "display_name": "watkipet", "link": "https://stackoverflow.com/users/1094670/watkipet"}, "edited": false, "score": 0, "creation_date": 1481214596, "post_id": 41024044, "comment_id": 69296174, "body": "@Beta--I guess I you&#39;re right. product_name.pipe is just a temporary file. I&#39;ll edit my question to make it clear that it&#39;s a temporary file and remove item #1."}, {"owner": {"reputation": 799, "user_id": 1094670, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2e9c62b124fec3ee23c99d84d58ca5bf?s=128&d=identicon&r=PG", "display_name": "watkipet", "link": "https://stackoverflow.com/users/1094670/watkipet"}, "edited": false, "score": 0, "creation_date": 1481214956, "post_id": 41024044, "comment_id": 69296423, "body": "@perencia--Somehow, using a batch loop seemed dirty to me. However, I&#39;m very Windows-specifc as is (i.e. <code>cmd &#47;c start &#47;B</code>). Care to add a version using a batch loop as an answer?"}], "answers": [{"tags": [], "owner": {"reputation": 13458, "user_id": 1773798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4Ljqn.png?s=128&g=1", "display_name": "Renaud Pacalet", "link": "https://stackoverflow.com/users/1773798/renaud-pacalet"}, "is_accepted": false, "score": 1, "last_activity_date": 1508314287, "last_edit_date": 1508314287, "creation_date": 1508313227, "answer_id": 46805273, "question_id": 41024044, "link": "https://stackoverflow.com/questions/41024044/how-to-feed-multiple-files-to-a-background-process-using-makefile/46805273#46805273", "title": "How to feed multiple files to a background process using Makefile", "body": "<p>I came across this old question while solving a similar problem. Just turn your \"<em>dummy</em>\" files into real (empty) ones to keep track of the last time you processed a source file. In the following I group them in a subdirectory (<code>dummies</code>) such that they do not interfere too much with the source tree:</p>\n\n<pre><code>D_DIR = dummies\nD_FILES = $(patsubst %.c,$(D_DIR)/%.dummy,$(SRCS))   # All dummy files\n\n$(D_DIR)/%.dummy : %.c\n    [ -f server ] || { cmd /c start /B ExtractEnums.exe -server &gt; temp.pipe &amp;&amp; touch server; }\n    cmd /c parser.exe $(DEFINES_AND_OPTS) -e $^ | cmd /c ExtractEnums.exe -client\n    mkdir -p $(dir $@) # create dummy's directory if it does not exist\n    touch $@           # create dummy\n\n# Extract enums from all the preprocessed source:\n%.enums : $(D_FILES)\n    cmd /c echo ;;exit;; | cmd /c ExtractEnums.exe -client\n    rm -f server\n    cmd /c move temp.pipe $@\n</code></pre>\n\n<p>Note: I also use an empty dummy file (<code>server</code>) to mark the server as running and launch it only if needed in the dummy's recipe. This avoids having it as a prerequisite of each dummy and re-building a dummy if its corresponding source file did not change but the server is not running.</p>\n"}], "owner": {"reputation": 799, "user_id": 1094670, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2e9c62b124fec3ee23c99d84d58ca5bf?s=128&d=identicon&r=PG", "display_name": "watkipet", "link": "https://stackoverflow.com/users/1094670/watkipet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1508314287, "creation_date": 1481132828, "last_edit_date": 1481214743, "question_id": 41024044, "link": "https://stackoverflow.com/questions/41024044/how-to-feed-multiple-files-to-a-background-process-using-makefile", "title": "How to feed multiple files to a background process using Makefile", "body": "<p>I have a Makefile where a single target depends on multiple files--each of which must be processed separately (without giving intermediate output files). My specific scenario is more complicated:</p>\n\n<p>I have C source from which I'd like to extract enum definitions. There are a few wrinkles which I cannot change:</p>\n\n<ol>\n<li>The compiler isn't GCC--it's a customized compiler made by Cosmic Software.</li>\n<li>In addition to the compiler, I can run the parser (let's call it parser.exe) by itself and it has the option (<code>-e</code>) to output preprocessed source on STDOUT. </li>\n<li>make is actually a proprietary version which comes with the PTC Integrity software package. It doesn't support loops--if I want to use loops, I'd have to do Windows batch scripting.</li>\n<li>This is all running on Windows</li>\n</ol>\n\n<p>I've written a utility (using C# and ANTLR), let's call it ExtractEnums.exe, which extracts enums (and evaluates expressions) from C source so long as that source has been preprocessed. The preprocessed source in its entirety weighs in at a little over 30 MB. Rather than write the pre-processed source to disk using the Cosmic parser, I've chosen to pipe it into ExtractEnums.exe. Since I need to invoke the parser for each source file, I need to use a named pipe instead of just the pipe (<code>|</code>) operator. On Windows, named pipes don't get real filenames, that's why you'll see <code>ExtractEnums.exe -client</code> to write to the pipe and the background process <code>ExtractEnums.exe -server</code> which reads from the pipe in the example below.</p>\n\n<pre><code>############################################################################\n# Dummy files - these will never exist\n#\nD_FILES = $(SRCS:.c=.dummy)                       # All dummy files\n\nserver :\n    cmd /c start /B ExtractEnums.exe -server &gt; temp.pipe\n\n%.dummy : %.c server\n    cmd /c parser.exe $(DEFINES_AND_OPTS) -e $^ | cmd /c ExtractEnums.exe -client\n\n# Extract enums from all the preprocessed source:\n%.enums : $(D_FILES)\n    cmd /c echo ;;exit;; | cmd /c ExtractEnums.exe -client\n    cmd /c move temp.pipe $@\n</code></pre>\n\n<p>This all runs if I call <code>make product_name.enums</code>. <code>SRCS</code> is a list of all the source files. <code>;;exit;;</code> is a special string I send to <code>ExtractEnums.exe -server</code> to tell it to exit. Here's the problem:</p>\n\n<p>To loop over all the sources and feed them into the preprocessor, I made a list of <code>.dummy</code> files that will never exist. Since they never exist, the targets are always out of date. This means that calling <code>make product_name.enums</code> will always run all the sources through the preprocessor even if the sources haven't changed.</p>\n\n<p>I realize I've come up with a complicated solution. If you have a much simpler way to solve this problem, I'm open to suggestions--in that case, I'll edit the name of this question to be appropriate.</p>\n"}, {"tags": ["c", "exception", "arguments"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1481132678, "post_id": 41023927, "comment_id": 69255125, "body": "<i>Why</i> can&#39;t you print it? The code excerpt you show looks almost good, but is simply missing the printout. And no there&#39;s no &quot;system messages&quot; in the C standard. I also say that the code looks <i>almost</i> good, because you have a logical error: Try adding more than one argument when executing your program."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1481132918, "post_id": 41023927, "comment_id": 69255269, "body": "<code>fprintf(stderr, &quot;My error message here.\\n&quot;);</code>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1481132940, "post_id": 41023927, "comment_id": 69255282, "body": "<code>#include &lt;stdio.h&gt;</code>, <code>#include &lt;string.h&gt;</code>, <code>#include &lt;errno.h&gt;</code>, <code>printf(&quot;%s&quot;, strerror(ENOENT));</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1481132957, "post_id": 41023927, "comment_id": 69255291, "body": "A system message of what system?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7009420"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1481133095, "post_id": 41023927, "comment_id": 69255369, "body": "@Someprogrammerdude Apparently should be a system message rather than a n error printf message. The exerpt I&#39;ve done works perfectly but will not print by default any message. All I want to know if a message such as &quot;No such file or directory&quot; it&#39;s only related to file/directories fails which in that case it&#39;s very likely that I&#39;ll have to store the possible arguments in a file to compare it with."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1481133248, "post_id": 41023927, "comment_id": 69255469, "body": "if I do <code>ls [bogusFileName]</code> I get <code>ls: cannot access [bogusFileName]: No such file or directory</code> .. is that what you want? That&#39;s the application <code>ls</code> printing that error message from the userspace/application level. If you search through its source code you&#39;ll find an <code>fprintf</code> of that message or something very similar. That&#39;s not a message that comes from the OS."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7009420"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1481133360, "post_id": 41023927, "comment_id": 69255529, "body": "@n.m. Operating system in my case Ubuntu"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7009420"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1481133441, "post_id": 41023927, "comment_id": 69255583, "body": "@yano No, just searching in which cases I would get a message like that when typing a wrong argv[1] to execute a program."}, {"owner": {"reputation": 585, "user_id": 7039091, "user_type": "registered", "profile_image": "https://graph.facebook.com/1228413217190279/picture?type=large", "display_name": "yLaguardia", "link": "https://stackoverflow.com/users/7039091/ylaguardia"}, "edited": false, "score": 0, "creation_date": 1481133625, "post_id": 41023927, "comment_id": 69255692, "body": "@krm I don&#39;t understand what you want. What&#39;s wrong with yano&#39;s approach of inserting  <code>fprintf(stderr, &quot;No such file or directory\\n&quot;);</code>  right before <code>return(EXIT_FAILURE);</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7009420"}, "reply_to_user": {"reputation": 585, "user_id": 7039091, "user_type": "registered", "profile_image": "https://graph.facebook.com/1228413217190279/picture?type=large", "display_name": "yLaguardia", "link": "https://stackoverflow.com/users/7039091/ylaguardia"}, "edited": false, "score": 0, "creation_date": 1481133739, "post_id": 41023927, "comment_id": 69255746, "body": "@yLaguardia Nothing wrong, not allowed to do so, that&#39;s all. Assignment norms."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1481133941, "post_id": 41023927, "comment_id": 69255855, "body": "ohh, got it. Bet I&#39;m wrong about <code>ls</code> source code then, it probably does something like this."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7009420"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1481136200, "post_id": 41023927, "comment_id": 69257157, "body": "@IanAbbott That one works, still to confirm if it could be a correct solution."}], "answers": [{"tags": [], "owner": {"reputation": 585, "user_id": 7039091, "user_type": "registered", "profile_image": "https://graph.facebook.com/1228413217190279/picture?type=large", "display_name": "yLaguardia", "link": "https://stackoverflow.com/users/7039091/ylaguardia"}, "is_accepted": false, "score": 1, "last_activity_date": 1481138801, "last_edit_date": 1481138801, "creation_date": 1481135743, "answer_id": 41024850, "question_id": 41023927, "link": "https://stackoverflow.com/questions/41023927/how-to-reproduce-2-no-such-file-or-directory-in-c/41024850#41024850", "title": "How to reproduce &quot;2 No such file or directory&quot; in C", "body": "<p>I think <code>ls</code> does this with the <code>error()</code> function: </p>\n\n<blockquote>\n  <p><a href=\"https://www.gnu.org/software/libc/manual/html_node/Error-Messages.html\" rel=\"nofollow noreferrer\">GNU Error_messages</a>  </p>\n  \n  <p>Function: <strong>void error (int status, int errnum, const char *format, \u2026)</strong>  </p>\n  \n  <p>Preliminary: | MT-Safe locale | AS-Unsafe corrupt heap i18n | AC-Safe\n  | See POSIX Safety Concepts.  </p>\n  \n  <p>The error function can be used to report general problems during\n  program execution. The format argument is a format string just like\n  those given to the printf family of functions. The arguments required\n  for the format can follow the format parameter. Just like perror,\n  error also can report an error code in textual form. But unlike perror\n  the error value is explicitly passed to the function in the errnum\n  parameter. This eliminates the problem mentioned above that the error\n  reporting function must be called immediately after the function\n  causing the error since otherwise errno might have a different value. </p>\n  \n  <p>error prints first the program name. If the application defined a\n  global variable error_print_progname and points it to a function this\n  function will be called to print the program name. Otherwise the\n  string from the global variable program_name is used. The program name\n  is followed by a colon and a space which in turn is followed by the\n  output produced by the format string. If the errnum parameter is\n  non-zero the format string output is followed by a colon and a space,\n  followed by the error message for the error code errnum. In any case\n  is the output terminated with a newline.  </p>\n  \n  <p>The output is directed to the stderr stream. If the stderr wasn\u2019t\n  oriented before the call it will be narrow-oriented afterwards.    </p>\n  \n  <p>The function will return unless the status parameter has a non-zero\n  value. In this case the function will call exit with the status value\n  for its parameter and therefore never return. If error returns, the\n  global variable error_message_count is incremented by one to keep\n  track of the number of errors reported.  </p>\n</blockquote>\n\n<p>So maybe something like this would achieve OP's goal as well as the other answers suggested before:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;error.h&gt;\n\nint main(int argc, char* argv[])\n{\n    if (argc == 2 &amp;&amp; strcmp(argv[1], \"-A\") != 0) {\n        error(ENOENT, ENOENT, \"cannot access %s\", argv[1]);\n    }\n\n    printf(\"program didn't get to here\\n\");\n}\n</code></pre>\n\n<p>Outputs of <code>ls</code> and this example:</p>\n\n<pre><code>~/workspace/tests/ $ ./ctest bogus_dir\n./ctest: cannot access bogus_dir: No such file or directory\n~/workspace/tests/ $ ls bogus_dir\nls: cannot access bogus_dir: No such file or directory\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7009420"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1481138801, "creation_date": 1481132326, "last_edit_date": 1481133227, "question_id": 41023927, "link": "https://stackoverflow.com/questions/41023927/how-to-reproduce-2-no-such-file-or-directory-in-c", "title": "How to reproduce &quot;2 No such file or directory&quot; in C", "body": "<p>I know it might sound strange but I'm trying to find when to get this type of error when passing a wrong argument to a main program.</p>\n\n<p>Let's say I have a program that accepts 1 or 2 arguments. If it's 2 arguments it can only be:</p>\n\n<pre><code>argv[0] =./programName \n</code></pre>\n\n<p>and </p>\n\n<pre><code>argv[1] = \"-A\". \n</code></pre>\n\n<p>Any other argv[1] other than \"-A\" needs to printf a \"2 No such file or directory\" message.</p>\n\n<p>As far as I know, this is a system message, so printing it will not work for me.</p>\n\n<p>DO I need to save all possible main arguments in a file and then compare the typed arguments with the ones in the file?</p>\n\n<p>Right now the way I have it is:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/times.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main (int argc, char *argv[]){\n.....\n...\n\nif (argc == 2 &amp;&amp; strcmp(argv[1], ARGV_2)!=0){\nreturn(EXIT_FAILURE);\n}\n\n...\n.....\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "tcp"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1481153695, "post_id": 41023657, "comment_id": 69266113, "body": "Have you forked a process? <code>close()</code> will only do what it does when it is the <i>last</i> close if there have been forks."}], "answers": [{"comments": [{"owner": {"reputation": 1123, "user_id": 819770, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/D9THw.jpg?s=128&g=1", "display_name": "Dan Tumaykin", "link": "https://stackoverflow.com/users/819770/dan-tumaykin"}, "edited": false, "score": 0, "creation_date": 1481274491, "post_id": 41036158, "comment_id": 69320129, "body": "Thanks for pointing me into right direction. The issue was not immediate - file descriptors were leaked by call to system() (which actually does a fork). Setting the correct file descriptor option solved the issue."}], "tags": [], "owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "is_accepted": true, "score": 2, "last_activity_date": 1481190034, "creation_date": 1481190034, "answer_id": 41036158, "question_id": 41023657, "link": "https://stackoverflow.com/questions/41023657/close-with-so-linger-wont-send-rst/41036158#41036158", "title": "close() with SO_LINGER won&#39;t send RST", "body": "<p>In your case you can no longer send and receive data after calling <code>close</code>. Also, after <code>close</code> call the RST will be sent only if the reference counter of socket descriptor becomes 0. Then the connection goes into <code>CLOSED</code> state and data in the receive and the send buffers are discarded.<br>\nProbably the answer lies in how you forked a process (as mentioned by EJP in comment). It seems that you didn't close the accepted socket in parent process after calling <code>fork</code>. So the socket reference counter is nonzero and there is no RST immediately after your <code>close</code>.<br>\nSuch situations are well described by Stevens in UNIX Network Programming.</p>\n"}], "owner": {"reputation": 1123, "user_id": 819770, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/D9THw.jpg?s=128&g=1", "display_name": "Dan Tumaykin", "link": "https://stackoverflow.com/users/819770/dan-tumaykin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 2, "accepted_answer_id": 41036158, "answer_count": 1, "score": 3, "last_activity_date": 1481274414, "creation_date": 1481131474, "last_edit_date": 1481274414, "question_id": 41023657, "link": "https://stackoverflow.com/questions/41023657/close-with-so-linger-wont-send-rst", "title": "close() with SO_LINGER won&#39;t send RST", "body": "<p>I'm trying to force TCP reset on a connection.\nThe suggested way is to set SO_LINGER to 0 and the call close().</p>\n\n<p>I'm doing exactly that, but the connection remains in ESTABLISHED state.\nThe socket is operating in non blocking mode. The operating system is Raspbian.</p>\n\n<p>The code:</p>\n\n<pre><code>struct linger l;\nl.l_onoff = 1;\nl.l_linger = 0;\n\nif (setsockopt(server-&gt;connection_socket, SOL_SOCKET, SO_LINGER, &amp;l, sizeof(l)) != 0) {\n    LOG_E(tcp, \"setting SO_LINGER failed\");\n}\n\nif (close(server-&gt;connection_socket) != 0) {\n    LOG_E(tcp, \"closing socket failed\");\n}\n\nserver-&gt;connection_socket = 0;\nLOG_I(tcp, \"current TCP connection was closed\");\n</code></pre>\n\n<p>Wireshark trace shows no RST as well.</p>\n\n<p>No other threads of the application are performing any operation on that socket.</p>\n\n<p>I can't figure out what is wrong, any suggestion would be much appreciated.</p>\n\n<hr>\n\n<p><strong>SOLVED</strong></p>\n\n<p>The issue was with file descriptors leaking to children created through <code>system()</code> call. \nIn fact when I listed all TCP socket descriptors with <code>lsof -i tcp</code>, I found out that child processes had opened file descriptor from parent process (even though parent already did not).</p>\n\n<p>The solution was requesting file descriptor to be closed in forked process (right after <code>accept()</code>).</p>\n\n<pre><code>fcntl(server-&gt;connection_socket, F_SETFD, FD_CLOEXEC)\n</code></pre>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1481131222, "post_id": 41023544, "comment_id": 69254202, "body": "The function is passed <i>copies</i> of <code>a</code> and <code>b</code> and passes nothing back. The <code>a</code> and <code>b</code> in the function are different variables from the global ones of the same name, having only local scope (and life)."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1481131292, "post_id": 41023544, "comment_id": 69254251, "body": "The parameter variables <code>a</code> and <code>b</code> inside the function shadow the global variables with the same names."}, {"owner": {"reputation": 22021, "user_id": 236222, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf4f3c341534395199d4dbe35a432f9d?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/236222/jay"}, "edited": false, "score": 0, "creation_date": 1481131376, "post_id": 41023544, "comment_id": 69254300, "body": "Does this code compile?"}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "reply_to_user": {"reputation": 22021, "user_id": 236222, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf4f3c341534395199d4dbe35a432f9d?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/236222/jay"}, "edited": false, "score": 0, "creation_date": 1481131570, "post_id": 41023544, "comment_id": 69254416, "body": "@Jay: What is the issue? It compiles for me."}], "answers": [{"comments": [{"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1481131900, "post_id": 41023600, "comment_id": 69254615, "body": "Since a and b are global variables, just changing  <code>void fact(a,b) {</code> to  <code>void fact(c,d) {</code> gives output 120! :P But your answer is correct."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481132208, "post_id": 41023600, "comment_id": 69254811, "body": "You can pass <code>b</code> by value; it&#39;s only <code>a</code> that&#39;s mutating."}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1481132368, "post_id": 41023600, "comment_id": 69254918, "body": "@sas: You are still doing pass by value. But you are passing memory address."}], "tags": [], "owner": {"reputation": 830, "user_id": 2165524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xg2Jb.jpg?s=128&g=1", "display_name": "&#181;tex", "link": "https://stackoverflow.com/users/2165524/%c2%b5tex"}, "is_accepted": true, "score": 3, "last_activity_date": 1481132368, "last_edit_date": 1495540905, "creation_date": 1481131257, "answer_id": 41023600, "question_id": 41023544, "link": "https://stackoverflow.com/questions/41023544/c-function-not-being-called/41023600#41023600", "title": "c function not being called?", "body": "<p>You are passing copy of variables a and b. Pass Variables as a pointer, if you want to update the value .\nModified the code below -   </p>\n\n<pre><code>void fact(int *a, int *b) {\n\n    if(*b == 1) {\n        return;\n    } else {\n\n        *a = *a * *b;\n        *b = *b - 1;\n        fact(a, b);\n        }\n    }\n\n    int main() {\n\n        fact(&amp;a, &amp;b);\n        printf(\"%d\", a);\n    }\n</code></pre>\n\n<p>You can visit the below link - </p>\n\n<p><a href=\"https://stackoverflow.com/questions/23667497/update-int-variable-in-c-inside-a-function\">How to update the value in another function</a></p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1481133693, "creation_date": 1481133693, "answer_id": 41024270, "question_id": 41023544, "link": "https://stackoverflow.com/questions/41023544/c-function-not-being-called/41024270#41024270", "title": "c function not being called?", "body": "<p>This function definition (provided that the compiler accepts it)</p>\n\n<pre><code>void fact(a,b) {\n\nif(b == 1) {\n    return;\n} else {\n\n    a = a * b;\n    b = b - 1;\n    fact(a, b);\n    }   \n}\n</code></pre>\n\n<p>looks in fact the following way</p>\n\n<pre><code>void fact(a,b) \nint a, b;\n{\n\nif(b == 1) {\n    return;\n} else {\n\n    a = a * b;\n    b = b - 1;\n    fact(a, b);\n    }   \n}\n</code></pre>\n\n<p>That is the variables <code>a</code> and <code>b</code> in the function definition are local variables of the function that have copies of the arguments supplied to the function by this call</p>\n\n<pre><code>fact(a, b);\n</code></pre>\n\n<p>Thus in the function call there are used global variables <code>a</code> and <code>b</code> but inside the function itself there are used local variables <code>a</code> and <code>b</code> that is copies of the global variables. Any changes of these local variables do not influence on the global variables.</p>\n\n<p>How to resolve the problem?</p>\n\n<p>The first approach is to remove the function parameters. In this case <code>a</code> and <code>b</code> inside the function definition will denote the global variables</p>\n\n<pre><code>void fact( void ) \n{\n\nif(b == 1) {\n    return;\n} else {\n\n    a = a * b;\n    b = b - 1;\n    fact(a, b);\n    }   \n}\n</code></pre>\n\n<p>and you will get the expected result.</p>\n\n<p>The second approach is to use parameters but also to return the result. For example</p>\n\n<p>int fact( a, b) \nint a, b;\n{\nif(b == 1) {\n    return a;\n} else {</p>\n\n<pre><code>a = a * b;\nb = b - 1;\nreturn fact(a, b);\n}   \n</code></pre>\n\n<p>}</p>\n\n<p>and call the function the following way</p>\n\n<pre><code>a = fact( a, b );\n</code></pre>\n\n<p>However such a function definition is deprecated.</p>\n\n<p>It would be better to write it like</p>\n\n<pre><code>int fact( int a, int b) \n{\nif(b == 1) {\n    return a;\n} else {\n\n    a = a * b;\n    b = b - 1;\n    return fact(a, b);\n    }   \n}\n</code></pre>\n\n<p>And the third approach is to pass arguments to the function by reference. For example</p>\n\n<pre><code>void fact( int *pa, int *pb ) \n{\n\nif( *pb == 1) {\n    return;\n} else {\n\n    *pa = *pa * b;\n    *pb = *pb - 1;\n    fact(pa, pb);\n    }   \n}\n</code></pre>\n\n<p>and call the function like</p>\n\n<pre><code>fact( &amp;a, &amp;b );\n</code></pre>\n\n<p>However it would be simpler to write the function the following way</p>\n\n<pre><code>int fact( int n )\n{\n    return n &lt; 1 ? 1 : n * fact( n - 1 );\n} \n</code></pre>\n\n<p>and call it like</p>\n\n<pre><code>a = fact( b );\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7263627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d748c62e1bf22ea8d67aa79f02b28b?s=128&d=identicon&r=PG&f=1", "display_name": "Zaedric", "link": "https://stackoverflow.com/users/7263627/zaedric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2035, "favorite_count": 0, "accepted_answer_id": 41023600, "answer_count": 2, "score": 2, "last_activity_date": 1481137581, "creation_date": 1481131099, "last_edit_date": 1481137581, "question_id": 41023544, "link": "https://stackoverflow.com/questions/41023544/c-function-not-being-called", "title": "c function not being called?", "body": "<p>I have basically no experience in c, so i'm not sure why this isn't working.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint a=1; \nint b=5;\n\nvoid fact(a,b) {\n\n    if(b == 1) {\n        return;\n    } else {\n        a = a * b;\n        b = b - 1;\n        fact(a, b);\n    }\n}\n\nint main() {\n\n    fact(a, b); \n    printf(\"%d\", a);\n}\n</code></pre>\n\n<p>The program should call fact recursively until a becomes 120. However it prints 1. I'm not sure why this is happening so any help would be appreciated.</p>\n"}, {"tags": ["c", "visual-studio", "eof"], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481132236, "post_id": 41023461, "comment_id": 69254826, "body": "@WeatherVane At this moment I have no idea and I don&#39;t have a windows system handy, will update you after I try."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481132349, "post_id": 41023461, "comment_id": 69254905, "body": "Oops dear readers I had already removed: &quot;Do you know why <code>scanf</code> requires <i>three</i> such sequences?&quot;"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1481132973, "post_id": 41023461, "comment_id": 69255302, "body": "Control-D doesn&#39;t really send an EOF.  It forces the current pending console input operation to return immediately with whatever has been typed up to that point.  A lot of software assumes that the only reason an input request will return without reading any bytes is that it has reached the end, but control-D has no special meaning aside from cooked-mode consoles, unlike control-Z which MS-DOS interprets as an EOF indication if encountered within a text file."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 4, "last_activity_date": 1481131746, "last_edit_date": 1481131746, "creation_date": 1481130847, "answer_id": 41023461, "question_id": 41023443, "link": "https://stackoverflow.com/questions/41023443/what-is-considered-as-eof-in-stdin/41023461#41023461", "title": "What is considered as EOF in stdin?", "body": "<p>You can send an <code>EOF</code> with <kbd>CTRL</kbd>+<kbd>D</kbd> (for Linux) or <kbd>CTRL</kbd>+<kbd>Z</kbd> (for Windows) systems. </p>\n\n<p>To elaborate, when <code>fgetc()</code> is waiting for an input from <em>empty</em> <code>stdin</code>, this key combination will simulate the <code>EOF</code>. In case, the <code>stdin</code> is not empty, you have to use the key combination twice (once to help flush the <code>stdin</code>, another to actually send the <code>EOF</code>).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6948903"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1314, "favorite_count": 0, "closed_date": 1481137481, "answer_count": 1, "score": 1, "last_activity_date": 1481132759, "creation_date": 1481130775, "last_edit_date": 1481132759, "question_id": 41023443, "link": "https://stackoverflow.com/questions/41023443/what-is-considered-as-eof-in-stdin", "closed_reason": "Duplicate", "title": "What is considered as EOF in stdin?", "body": "<p>My Visual Studio still awaits input even after I keep entering a newline. </p>\n\n<p>For example:</p>\n\n<pre><code>while ((c = fgetc(stdin)) != EOF)\n{\n   // do something\n}\n</code></pre>\n\n<p>What should I enter that sends EOF to Visual Studio?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1481128275, "post_id": 41022577, "comment_id": 69252270, "body": "<code>scanf(&quot;%c&quot;, &amp;b);</code> --&gt; <code>scanf(&quot; %c&quot;, &amp;b);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 2, "last_activity_date": 1481128329, "creation_date": 1481128329, "answer_id": 41022625, "question_id": 41022577, "link": "https://stackoverflow.com/questions/41022577/c-writing-a-loop-to-print-the-alphabet-between-two-characters/41022625#41022625", "title": "C: Writing a loop to print the alphabet between two characters", "body": "<p>You have to consume the <code>\\n</code> in <code>stdin</code> left by first <code>scanf</code>.</p>\n\n<p>Fastest fix</p>\n\n<pre><code>scanf(\" %c\", &amp;b);\n</code></pre>\n\n<p>The space before <code>%c</code> tells to <code>scanf</code> to ignore all whitespaces before to read the <code>char</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "is_accepted": false, "score": 0, "last_activity_date": 1481128361, "creation_date": 1481128361, "answer_id": 41022635, "question_id": 41022577, "link": "https://stackoverflow.com/questions/41022577/c-writing-a-loop-to-print-the-alphabet-between-two-characters/41022635#41022635", "title": "C: Writing a loop to print the alphabet between two characters", "body": "<p>If I read your code correctly, by pressing enter, you would enter the second character, which would most probably (depending on the environment) start with a numeric value of <code>13</code>, which would be smaller than any letter, so the loop's body is executed only once.</p>\n"}], "owner": {"reputation": 73, "user_id": 5971216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pyDBN.jpg?s=128&g=1", "display_name": "Trekkx", "link": "https://stackoverflow.com/users/5971216/trekkx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3466, "favorite_count": 0, "closed_date": 1481128650, "accepted_answer_id": 41022625, "answer_count": 2, "score": 1, "last_activity_date": 1481128361, "creation_date": 1481128207, "question_id": 41022577, "link": "https://stackoverflow.com/questions/41022577/c-writing-a-loop-to-print-the-alphabet-between-two-characters", "closed_reason": "Duplicate", "title": "C: Writing a loop to print the alphabet between two characters", "body": "<p>I've been given the pretty simple task of writing a program that will take two characters and then print the letters inbetween them using a for() loop.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main() {\nchar a, b;\n\nprintf(\"\\nEnter the first character: \");\nscanf(\"%c\", &amp;a);\n\nprintf(\"\\nEnter the second character: \");\nscanf(\"%c\", &amp;b);\n\nfor(char i = a; i &lt;= b; i++) {\n    printf(\"%c \", i);\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>When I run it, I am prompted to enter the first character correctly but when I press enter it only runs the next printf() and then terminates.</p>\n\n<p>No errors or warnings or anything on compilation. Another similar question I found that was apparently solved does not work for me either.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "linux", "multithreading", "pthreads", "signals"], "comments": [{"owner": {"reputation": 10963, "user_id": 306257, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/701752cfc3dd805d412884f38a464296?s=128&d=identicon&r=PG", "display_name": "Haldean Brown", "link": "https://stackoverflow.com/users/306257/haldean-brown"}, "edited": false, "score": 0, "creation_date": 1481128597, "post_id": 41022364, "comment_id": 69252512, "body": "How precise does the timing need to be? +- 1ms? +- 10ms?"}, {"owner": {"reputation": 55, "user_id": 7064870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1560b305d9b31e8b794c4c5527c10537?s=128&d=identicon&r=PG&f=1", "display_name": "lukecam95", "link": "https://stackoverflow.com/users/7064870/lukecam95"}, "reply_to_user": {"reputation": 10963, "user_id": 306257, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/701752cfc3dd805d412884f38a464296?s=128&d=identicon&r=PG", "display_name": "Haldean Brown", "link": "https://stackoverflow.com/users/306257/haldean-brown"}, "edited": false, "score": 0, "creation_date": 1481129192, "post_id": 41022364, "comment_id": 69252942, "body": "+- 0.1ms would be good enough."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1481129996, "post_id": 41022364, "comment_id": 69253453, "body": "Have you looked at <code>timer_create</code> and <code>timer_settime</code>?"}, {"owner": {"reputation": 55, "user_id": 7064870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1560b305d9b31e8b794c4c5527c10537?s=128&d=identicon&r=PG&f=1", "display_name": "lukecam95", "link": "https://stackoverflow.com/users/7064870/lukecam95"}, "edited": false, "score": 0, "creation_date": 1481135080, "post_id": 41022364, "comment_id": 69256456, "body": "I have read about them briefly, but not looked into them in detail. Do they have any particular advantage over the setitimer() method? Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7064870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1560b305d9b31e8b794c4c5527c10537?s=128&d=identicon&r=PG&f=1", "display_name": "lukecam95", "link": "https://stackoverflow.com/users/7064870/lukecam95"}, "edited": false, "score": 0, "creation_date": 1481136822, "post_id": 41023090, "comment_id": 69257528, "body": "Very Helpful! Thanks:)"}], "tags": [], "owner": {"reputation": 10963, "user_id": 306257, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/701752cfc3dd805d412884f38a464296?s=128&d=identicon&r=PG", "display_name": "Haldean Brown", "link": "https://stackoverflow.com/users/306257/haldean-brown"}, "is_accepted": true, "score": 1, "last_activity_date": 1481129633, "creation_date": 1481129633, "answer_id": 41023090, "question_id": 41022364, "link": "https://stackoverflow.com/questions/41022364/implementation-of-a-program-to-carry-out-floating-point-calculations-every-25ms/41023090#41023090", "title": "Implementation of a program to carry out floating point calculations every 25ms using a linux signal handler in a multi-threaded server program?", "body": "<p>As you point out, doing any sort of work in a signal handler is irritating. To avoid the irritation, I would spawn another thread (if you have the space for it), and have that thread wait on a semaphore. You can then post to that semaphore from your signal handler to wake up your processing thread.</p>\n\n<p>This would still be subject to jitter from the scheduler, and I'm not sure (without doing some testing) whether that's going to be able to satisfy your 100us deadline, but it's worth a shot.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 7064870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1560b305d9b31e8b794c4c5527c10537?s=128&d=identicon&r=PG&f=1", "display_name": "lukecam95", "link": "https://stackoverflow.com/users/7064870/lukecam95"}, "edited": false, "score": 0, "creation_date": 1481198176, "post_id": 41032290, "comment_id": 69285016, "body": "Thanks, will try it out and let you know :) !"}], "tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": false, "score": 0, "last_activity_date": 1481174461, "creation_date": 1481174461, "answer_id": 41032290, "question_id": 41022364, "link": "https://stackoverflow.com/questions/41022364/implementation-of-a-program-to-carry-out-floating-point-calculations-every-25ms/41032290#41032290", "title": "Implementation of a program to carry out floating point calculations every 25ms using a linux signal handler in a multi-threaded server program?", "body": "<p>I concur that performing work in signal handler is to be avoided, particularly in a multithreaded application.  There is very little you can safely do in an async-signal environment in POSIX.</p>\n\n<p>I would avoid using signals at all: you can simply spawn a thread that waits for the next deadline before performing the necessary work, then loops around to wait again:</p>\n\n<pre><code>#include &lt;time.h&gt;\n#include &lt;errno.h&gt;\n\nvoid *timed_calculation_thread(void *ptr)\n{\n    struct timespec deadline;\n\n    clock_gettime(CLOCK_MONOTONIC, &amp;deadline);\n\n    while(1)\n    {\n        /* Perform floating point calculations, update robot state\n         * etc. here */\n\n        /* Add 25ms to previous deadline */\n        deadline.tv_nsec += 25000000;\n        deadline.tv_sec += deadline.tv_nsec / 1000000000;\n        deadline.tv_nsec %= 1000000000;\n        /* Sleep until new deadline */\n        while (clock_nanosleep(CLOCK_MONOTONIC, TIMER_ABSTIME, &amp;deadline, NULL) != 0)\n            if (errno != EINTR) return NULL;\n    }\n\n    return NULL;\n}\n</code></pre>\n\n<p>If your process runs with sufficient privileges you can also give this thread a realtime scheduling class, if necessary.</p>\n\n<p>In practice this can give you quite good latency results.</p>\n"}], "owner": {"reputation": 55, "user_id": 7064870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1560b305d9b31e8b794c4c5527c10537?s=128&d=identicon&r=PG&f=1", "display_name": "lukecam95", "link": "https://stackoverflow.com/users/7064870/lukecam95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 41023090, "answer_count": 2, "score": 1, "last_activity_date": 1481174461, "creation_date": 1481127634, "last_edit_date": 1481129386, "question_id": 41022364, "link": "https://stackoverflow.com/questions/41022364/implementation-of-a-program-to-carry-out-floating-point-calculations-every-25ms", "title": "Implementation of a program to carry out floating point calculations every 25ms using a linux signal handler in a multi-threaded server program?", "body": "<p>My Aim: I need to calculate new control inputs of my system and update the position of the robot I am programming at precise sampling instants. </p>\n\n<p>Problem background: I have a functioning server program that services multiple clients and can do simple robot maneuvers. To do this I have two threads, one to control the robot and one to service the multiple clients. Now I need to implement more complex swarm algorithms at precise sample instants. I have successfully written a side program (using setitimer() ) that interrupts every 25ms using SIGVTALRM.  </p>\n\n<p>Now I need advice on how is best to proceed design wise. My main worry is how to execute the algorithm in the signal handler since it has to satisy many constraints due to multi-threads and signal safe functions. </p>\n\n<p>Sorry for the long explanation, but I feel a good explanation will produce a good answer. </p>\n\n<p>Thanks for your time!! </p>\n"}, {"tags": ["c++", "c", "udp", "winsock", "broadcasting"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1481127549, "post_id": 41022253, "comment_id": 69251792, "body": "You might want to add error checking for more functions, like for example the <code>setsockopt</code> calls."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1481127601, "post_id": 41022253, "comment_id": 69251830, "body": "You <i>also</i> need to set the <code>SO_BROADCAST</code> option on the socket you want to <i>receive</i> the broadcast on."}, {"owner": {"reputation": 353, "user_id": 1290806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbce01893b86b704a2920aa7f5ea2e8?s=128&d=identicon&r=PG", "display_name": "yothsoggoth", "link": "https://stackoverflow.com/users/1290806/yothsoggoth"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1481135699, "post_id": 41022253, "comment_id": 69256849, "body": "@Someprogrammerdude I do have error checking in the actual code, I just removed it for this question. None of the functions are returning any errors (except the occasional WSAEWOULDBLOCK, which is to be expected for non-blocking sockets). I think I did try setting SO_BROADCAST on the receiver, but I&#39;ll try that again and see if it helps."}], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 1290806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbce01893b86b704a2920aa7f5ea2e8?s=128&d=identicon&r=PG", "display_name": "yothsoggoth", "link": "https://stackoverflow.com/users/1290806/yothsoggoth"}, "edited": false, "score": 1, "creation_date": 1481406498, "post_id": 41023344, "comment_id": 69367428, "body": "I tried disabling all but one network adapter, but the result was the same - the packet never gets received. Would this problem also affect testing locally (i.e. with the client and server running in separate threads of the same process)?"}, {"owner": {"reputation": 11, "user_id": 7263542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fae0de58f43bfe31a904f24dccf930?s=128&d=identicon&r=PG&f=1", "display_name": "user1243123", "link": "https://stackoverflow.com/users/7263542/user1243123"}, "reply_to_user": {"reputation": 353, "user_id": 1290806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbce01893b86b704a2920aa7f5ea2e8?s=128&d=identicon&r=PG", "display_name": "yothsoggoth", "link": "https://stackoverflow.com/users/1290806/yothsoggoth"}, "edited": false, "score": 0, "creation_date": 1481638652, "post_id": 41023344, "comment_id": 69450279, "body": "@yothsoggoth I don&#39;t think I had the problem locally but I was testing with 2 different processes. I&#39;m not sure what the behavior would be for 2 threads of the same application. I can only suggest Wireshark if you&#39;re not already using it to debug."}], "tags": [], "owner": {"reputation": 11, "user_id": 7263542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fae0de58f43bfe31a904f24dccf930?s=128&d=identicon&r=PG&f=1", "display_name": "user1243123", "link": "https://stackoverflow.com/users/7263542/user1243123"}, "is_accepted": false, "score": 1, "last_activity_date": 1481130452, "creation_date": 1481130452, "answer_id": 41023344, "question_id": 41022253, "link": "https://stackoverflow.com/questions/41022253/udp-winsock-not-receiving-broadcast-packets/41023344#41023344", "title": "UDP WinSock - Not Receiving Broadcast Packets", "body": "<p>(Should be a comment, but my reputation is not high enough)</p>\n\n<p>I don't know if this applies to you, but there is a unintuitive behavior with broadcasts on recent versions of Windows. If you have multiple physical Ethernet adapters, broadcasts will only be received on the \"preferred\" interface (where \"preference\" is determined by Windows' routing table)</p>\n\n<p>See the following for an explanation and potential fix:\n<a href=\"https://github.com/dechamps/WinIPBroadcast\" rel=\"nofollow noreferrer\">https://github.com/dechamps/WinIPBroadcast</a></p>\n\n<p>Another temporary fix would be to disable all other network adapters to make sure the broadcast is received on the correct one (in Control Panel/Network and Sharing Center/Change adapter settings).</p>\n"}], "owner": {"reputation": 353, "user_id": 1290806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbce01893b86b704a2920aa7f5ea2e8?s=128&d=identicon&r=PG", "display_name": "yothsoggoth", "link": "https://stackoverflow.com/users/1290806/yothsoggoth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1403, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511582857, "creation_date": 1481127256, "question_id": 41022253, "link": "https://stackoverflow.com/questions/41022253/udp-winsock-not-receiving-broadcast-packets", "title": "UDP WinSock - Not Receiving Broadcast Packets", "body": "<p>I'm testing a simple socket setup in which a server listens on a specified port, and a client sends a broadcast packet which should be received by that server.</p>\n\n<p>This setup works fine when sending messages directly (i.e. not broadcasting), but when broadcasting the packet is never received on the server.</p>\n\n<p>Some of the code (trimmed down with error checking removed, for simplicity):</p>\n\n<pre><code>// Client (broadcast sender)\n\n// Create and bind the client socket\nclientSocket = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\n\nsockaddr_in sockAddr;\nsockAddr.sin_family = AF_INET;\nsockAddr.sin_port = htons(5678);\nsockAddr.sin_addr.S_un.S_addr = htonl(INADDR_ANY);\n\nbind(clientSocket, (sockaddr*)(&amp;sockAddr), sizeof(sockAddr));\n\nu_long uMode = 1;\nioctlsocket(clientSocket, FIONBIO, &amp;uMode);\n\nchar broadcast = 1;\nsetsockopt(clientSocket, SOL_SOCKET, SO_BROADCAST, &amp;broadcast, sizeof(broadcast));\n\n// ...\n\n// Send the packet\nsockaddr_in sockAddress;\nsockAddress.sin_family = AF_INET;\nsockAddress.sin_addr.S_un.S_addr = htonl(INADDR_BROADCAST);\nsockAddress.sin_port = htons(5679);\n\nchar const* pPacket = \"Test\";\nsize_t uPacketSize = strlen(pPacket) + 1;\n\nsendto(clientSocket, pPacket, (int)uPacketSize, 0, (sockaddr*)&amp;sockAddress, sizeof(sockAddress));\n</code></pre>\n\n<p>-</p>\n\n<pre><code>// Server (listener)\n\n// Create and bind the server socket\nserverSocket = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\n\nsockaddr_in sockAddr;\nsockAddr.sin_family = AF_INET;\nsockAddr.sin_port = htons(5679);\nsockAddr.sin_addr.S_un.S_addr = htonl(INADDR_ANY);\n\nbind(serverSocket, (sockaddr*)(&amp;sockAddr), sizeof(sockAddr));\n\nu_long uMode = 1;\nioctlsocket(serverSocket, FIONBIO, &amp;uMode);\n\n// ...\n\nchar pBuffer[1024];\nwhile (true)\n{\n    int iRecvSize = recv(serverSocket, pBuffer, 1024, 0);\n    if (iRecvSize)\n    {\n        printf(\"Received packet\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "unix", "gcc"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 4, "creation_date": 1481127259, "post_id": 41022219, "comment_id": 69251606, "body": "Just share the compiled file? I don&#39;t understand the question.."}, {"owner": {"reputation": 49, "user_id": 6909706, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-mA7OuVflPcM/AAAAAAAAAAI/AAAAAAAAAF0/yNnkRwOlKqw/photo.jpg?sz=128", "display_name": "Nazeem", "link": "https://stackoverflow.com/users/6909706/nazeem"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1481127524, "post_id": 41022219, "comment_id": 69251777, "body": "yes. without sharing actual source code(.c file), i want to share compiled file(a.out) compiled in gcc compiler"}, {"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1481127554, "post_id": 41022219, "comment_id": 69251795, "body": "Why can&#39;t you just do it? Share the binary executable."}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1481127851, "post_id": 41022219, "comment_id": 69251995, "body": "Do you want to run shared <code>a.out</code> on old environments (older than the one on where you compiled) ?"}, {"owner": {"reputation": 49, "user_id": 6909706, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-mA7OuVflPcM/AAAAAAAAAAI/AAAAAAAAAF0/yNnkRwOlKqw/photo.jpg?sz=128", "display_name": "Nazeem", "link": "https://stackoverflow.com/users/6909706/nazeem"}, "edited": false, "score": 0, "creation_date": 1481127965, "post_id": 41022219, "comment_id": 69252071, "body": "Binary executable created in my gcc environment contains my linux os and my environment information. will it run on other machines with gcc environment??"}, {"owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "edited": false, "score": 0, "creation_date": 1481128184, "post_id": 41022219, "comment_id": 69252211, "body": "Other machine means? Same architecture? If not then you need cross compiler and you have to link library statically."}, {"owner": {"reputation": 49, "user_id": 6909706, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-mA7OuVflPcM/AAAAAAAAAAI/AAAAAAAAAF0/yNnkRwOlKqw/photo.jpg?sz=128", "display_name": "Nazeem", "link": "https://stackoverflow.com/users/6909706/nazeem"}, "edited": false, "score": 0, "creation_date": 1481128520, "post_id": 41022219, "comment_id": 69252452, "body": "same architecture, same linux environment"}, {"owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "edited": false, "score": 2, "creation_date": 1481128720, "post_id": 41022219, "comment_id": 69252611, "body": "Then it will depand on version of the standard library for your compiler is installed in your OS by default (which you can&#39;t rely on, in general). If you install  same Linux version , on two machine then there is a chance your executable run successfully."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481130362, "post_id": 41022454, "comment_id": 69253651, "body": "No, that&#39;s much too strong.  It is downright <i>common</i> to distribute pre-built binaries, including binaries linked against shared libraries.  This does open you up to library compatibility issues, but its not as bad as the execution environment having to have the exact same version of every shared library used."}], "tags": [], "owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "is_accepted": false, "score": 1, "last_activity_date": 1481128345, "last_edit_date": 1481128345, "creation_date": 1481127862, "answer_id": 41022454, "question_id": 41022219, "link": "https://stackoverflow.com/questions/41022219/how-to-run-executable-file-a-out-created-in-my-laptop-gcc-environment-in-other-l/41022454#41022454", "title": "How to run executable file a.out created in my laptop gcc environment in other laptops?", "body": "<p>Executable are often specific to the environment/machine they were created on. Even if the same processor/hardware is involved, there may be dependencies on libraries that may prevent executables from just running on other machines.</p>\n\n<p>A program that uses only \"standard libraries\" and that links all libraries statically, does not need any other dependency (in the sense that all the code it need is in the binary itself or into OS libraries that -being part of the system itself- are already on the system). </p>\n\n<p>You have to link the standard library statically. Otherwise it will only work if the version of the standard library for your compiler is installed in your OS by default (which you can't rely on, in general).</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 3, "last_activity_date": 1481132092, "last_edit_date": 1592644375, "creation_date": 1481132092, "answer_id": 41023849, "question_id": 41022219, "link": "https://stackoverflow.com/questions/41022219/how-to-run-executable-file-a-out-created-in-my-laptop-gcc-environment-in-other-l/41023849#41023849", "title": "How to run executable file a.out created in my laptop gcc environment in other laptops?", "body": "<blockquote>\n<p>Is there any way to share my program without revealing actual source code so that executable file could run on other computers with gcc compilers?</p>\n</blockquote>\n<p><strong>TL;DR</strong>: yes, provided a greater degree of similarity than just having GCC.  One simply copies the binary file and any needed auxiliary files to a compatible system and runs it.</p>\n<hr />\n<h2>In more detail</h2>\n<p>It is quite common to distribute compiled binaries without source code, for execution on machines other than the ones on which those binaries were built.  This mode of distribution does present potential compatibility issues (as described below), but so does source distribution.  In broad terms, you simply install (copy) the binaries and any needed supporting files to suitable locations on a compatible system and execute them.  This is the manner of distribution for most commercial software.</p>\n<h3>Architecture dependence</h3>\n<p>Compiled binaries are certainly specific to a particular hardware architecture, or in certain special cases to a small, predetermined set of two or more architectures (e.g. old Mac universal binaries).  You will not be able to run a binary on hardware too different from what it was built for, but &quot;architecture&quot; is quite a different thing from CPU model.</p>\n<p>For example, there is a very wide range of CPUs that implement the x86_64 architecture.  Most programs targeting that architecture will run on any such CPU.  Indeed, the x86 architecture is similar enough to x86_64 that most programs built for x86 will also run on x86_64 (but not <em>vise versa</em>).  It is possible to introduce finer-grained hardware dependency, but you do not generally get that by default.</p>\n<h3>Operating system dependence</h3>\n<p>Furthermore, most binaries are built to run in the context of a host operating system.  You will not be able to run a binary on an operating system too different from the one it was built for.</p>\n<p>For example, Linux binaries do not run (directly) on Windows.  Windows binaries do not run (directly) on OS X.  Etc.</p>\n<h3>Library dependence</h3>\n<p>Additionally, a program built against shared libraries require a compatible version of each required shared library to be available in the runtime environment.  That does not necessarily have to be exactly the same version against which it was built; that depends on the library, which of its functions and data are used, and whether and how those changed over time.</p>\n<p>You can sidestep this issue by linking every needed library statically, up to and including the C standard library, or by distributing shared libraries along with your binary.  It's fairly common to just live with this issue, however, and therefore to support only a subset of all possible environments with your binary distribution(s).</p>\n<h3>Other</h3>\n<p>There is a veritable universe of other potential compatibility issues, but it's unlikely that any of them would catch you by surprise with respect to a program that you wrote yourself and want to distribute.  For example, if you use nVidia CUDA in your program then it might require an nVidia GPU, but such a requirement would surely be well known to you.</p>\n"}], "owner": {"reputation": 49, "user_id": 6909706, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-mA7OuVflPcM/AAAAAAAAAAI/AAAAAAAAAF0/yNnkRwOlKqw/photo.jpg?sz=128", "display_name": "Nazeem", "link": "https://stackoverflow.com/users/6909706/nazeem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1481132092, "creation_date": 1481127171, "last_edit_date": 1481129305, "question_id": 41022219, "link": "https://stackoverflow.com/questions/41022219/how-to-run-executable-file-a-out-created-in-my-laptop-gcc-environment-in-other-l", "title": "How to run executable file a.out created in my laptop gcc environment in other laptops?", "body": "<p>I have written a program code in c compiled and executed in gcc compiler. I want to share the executable file of program without sharing actual source code. Is there any way to share my program without revealing actual source code so that executable file could run on other computers with gcc compilers??</p>\n"}, {"tags": ["c", "gcc", "clang"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 3, "creation_date": 1481125939, "post_id": 41021765, "comment_id": 69250651, "body": "Um... &quot;Compound statement&quot;? &quot;Compound statement&quot; is a fundamental feature of the language, an therefore of every C compiler since beginning of times. There&#39;s no such thing as C compiler that &quot;doesn&#39;t  have compound statements&quot;. Meanwhile, you seem to be talking about <i>statement expressions</i>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1481126131, "post_id": 41021765, "comment_id": 69250818, "body": "Could you paste up an example of something that your clang compiler doesn&#39;t support?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1481126231, "post_id": 41021765, "comment_id": 69250901, "body": "The feature you describe as a &quot;compound statement&quot; seems really to be the ability to use a compound statement <i>as an expression</i>.  No version of standard C supports this; it is a GCC extension.  Possibly other implementations also support it, but there cannot be any standard way to test specifically for it, because it is not itself standard."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481126451, "post_id": 41021934, "comment_id": 69251057, "body": "Note that the standard uses the term &quot;statement expression&quot; to mean something altogether different -- a valid expression used as a complete statement.  Example: <code>i++;</code>."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481127030, "post_id": 41021934, "comment_id": 69251449, "body": "@John Bollinger: That would be the term &quot;expression statement&quot;. That&#39;s what the standard uses. Meanwhile, the term &quot;statement expression&quot; is free for taking :)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481128798, "post_id": 41021934, "comment_id": 69252663, "body": "Hmm.  You seem to be correct, though footnote 84 actually does use &quot;statement expression&quot; for an expression statement.  One can call that a flaw in the (non-normative) footnote text.  In any case, if you draw this distinction then I think you&#39;re coining a term.  <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html\" rel=\"nofollow noreferrer\">The GCC docs</a> do not appear to assign a name to this kind of expression.  With that being the case, I wish you would choose one that is less easily confused with &quot;expression statement&quot;."}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1481130515, "post_id": 41021934, "comment_id": 69253750, "body": "<i>Compound Expression</i>?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1481131276, "post_id": 41021934, "comment_id": 69254239, "body": "@JohnBollinger: I&#39;m certainly not the originator of the term. Even if GCC might seem to drift away from this nomenclature at times, it is still used extensively in GCC docs: <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html</a> (look through the entire text). I perceive this term as something coined by GCC specifically, not by me."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 1, "last_activity_date": 1481127156, "last_edit_date": 1481127156, "creation_date": 1481126336, "answer_id": 41021934, "question_id": 41021765, "link": "https://stackoverflow.com/questions/41021765/detecting-if-a-c-compiler-supports-statement-expressions/41021934#41021934", "title": "Detecting if a C compiler supports statement expressions", "body": "<p><em>Statement expressions</em> (which is what your question seems to be about) is not a standard feature of C language. Neither is <code>__typeof__</code>, BTW. </p>\n\n<p>This means that if you want something like that, then the best strategy might be a manually defined macro, which would allow (or disallow) usage of such features in the code. You will manually specify the macro for those specific compilers that implement these non-standard features. (Which is basically just GCC.)</p>\n"}, {"tags": [], "owner": {"reputation": 10963, "user_id": 306257, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/701752cfc3dd805d412884f38a464296?s=128&d=identicon&r=PG", "display_name": "Haldean Brown", "link": "https://stackoverflow.com/users/306257/haldean-brown"}, "is_accepted": true, "score": 1, "last_activity_date": 1481129190, "creation_date": 1481129190, "answer_id": 41022943, "question_id": 41021765, "link": "https://stackoverflow.com/questions/41021765/detecting-if-a-c-compiler-supports-statement-expressions/41022943#41022943", "title": "Detecting if a C compiler supports statement expressions", "body": "<p>As AnT stated in their answer, they aren't part of the standard. Unfortunately, I can't find any evidence of a feature-test macro in GCC either, so your best bet is to check to make sure you're using a <code>gnu</code> variant of the C standard and GCC version 3 or later (which is when statement expressions were added)</p>\n\n<pre><code>#if !__STRICT_ANSI__ &amp;&amp; __GNUC__ &gt;= 3\n    /* use statement expressions */\n#else\n    /* use... something else? */\n#endif\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1481130270, "post_id": 41023164, "comment_id": 69253600, "body": "My toy project relies on statement expressions too. I decided I wasn&#39;t going to support compilers other than gcc, clang and tinycc (all three have both <b>typeof</b> and statement expressions)."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1481130676, "last_edit_date": 1481130676, "creation_date": 1481129841, "answer_id": 41023164, "question_id": 41021765, "link": "https://stackoverflow.com/questions/41021765/detecting-if-a-c-compiler-supports-statement-expressions/41023164#41023164", "title": "Detecting if a C compiler supports statement expressions", "body": "<p>I'd do it like autoconf does this kind of thing: try to compile a chunk and output a macro definition into your config.h (or whatever you have) if the compilation succeeded:</p>\n\n<pre><code>echo 'int main(){ int x = ({ puts(\"\"); 32; }); return x; }' &gt; tmp.c\nif cc -c tmp.c; then  #-c only to save on linking time\n   echo '#define HAVE_STMT_EXPR 1'\nfi\n</code></pre>\n"}], "owner": {"reputation": 2077, "user_id": 1071669, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/701fc95be1eaf05adaccd367ba33ec9b?s=128&d=identicon&r=PG", "display_name": "dargaud", "link": "https://stackoverflow.com/users/1071669/dargaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 1, "accepted_answer_id": 41022943, "answer_count": 3, "score": 4, "last_activity_date": 1481130676, "creation_date": 1481125841, "last_edit_date": 1481128711, "question_id": 41021765, "link": "https://stackoverflow.com/questions/41021765/detecting-if-a-c-compiler-supports-statement-expressions", "title": "Detecting if a C compiler supports statement expressions", "body": "<p>Is there a way to detect if a compiler (I have a current GCC which has them and an oldish clang which doesn't) implements statement expressions, so that I can do something like this:</p>\n\n<pre><code>#ifdef NO_COMPOUND_STATEMENTS\n#define MIN(a,b)    ((a)&lt;=(b) ? (a):(b))\n#define MAX(a,b)    ((a)&gt;=(b) ? (a):(b))\n#else\n#define MIN(a,b) ({ __typeof__ (a) _a=(a); __typeof__ (b) _b=(b); _a&lt;_b ? _a : _b; })\n#define MAX(a,b) ({ __typeof__ (a) _a=(a); __typeof__ (b) _b=(b); _a&gt;_b ? _a : _b; })\n#endif\n</code></pre>\n"}, {"tags": ["c", "shell", "serial-port", "linux-device-driver"], "answers": [{"tags": [], "owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "is_accepted": false, "score": 0, "last_activity_date": 1481127284, "creation_date": 1481127284, "answer_id": 41022260, "question_id": 41021726, "link": "https://stackoverflow.com/questions/41021726/why-rts-signal-is-different-if-write-is-done-via-terminal-rather-than-via-applic/41022260#41022260", "title": "Why rts signal is different if write is done via terminal rather than via application?", "body": "<p>I'm not going to include all the error handling, I'll leave that as an exercise for the OP.  Please do <code>man ioctl</code> / <code>man tcgetattr</code> / <code>man tcsetattr</code> for all of the correct include files, etc.</p>\n\n<p>You have to set the <code>CRTSCTS</code> flag first:</p>\n\n<pre><code>struct termios attr, oldterminfo;\nint fd, status;\n\nfd = open(devicename, O_RDWR);\n\ntcgetattr(fd, &amp;oldterminfo);\nmemcpy (&amp;attr, &amp;oldterminfo, sizeof(termios))\nattr.c_cflag |= CRTSCTS | CLOCAL;\nattr.c_oflag = 0;\ntcsetattr(fd, TCSANOW, &amp;attr);\n</code></pre>\n\n<p>Set the <code>RTS</code> flag high</p>\n\n<pre><code>ioctl(fd, TIOCMGET, &amp;status);\nstatus |= TIOCM_RTS;\nioctl(fd, TIOCMSET, &amp;status);\n</code></pre>\n\n<p>Here is where you'll do your write(s) to the device<br>\n.....</p>\n\n<p>And, when complete, set the <code>RTS</code> flag low</p>\n\n<pre><code>ioctl(fd, TIOCMGET, &amp;status);\nstatus &amp;= ~TIOCM_RTS;\nioctl(fd, TIOCMSET, &amp;status);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5930202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f67997a9973b249ffdfd90305de240?s=128&d=identicon&r=PG&f=1", "display_name": "Whitefield", "link": "https://stackoverflow.com/users/5930202/whitefield"}, "is_accepted": false, "score": 1, "last_activity_date": 1481540466, "creation_date": 1481540466, "answer_id": 41099367, "question_id": 41021726, "link": "https://stackoverflow.com/questions/41021726/why-rts-signal-is-different-if-write-is-done-via-terminal-rather-than-via-applic/41099367#41099367", "title": "Why rts signal is different if write is done via terminal rather than via application?", "body": "<p>Actually following Kevin advice isn't working as setting CRTSCTS makes the application hanging every time that I try to write some bytes to the serial device (I think that the CTS signal is not set by the slave so it keeps waiting for it). I'm going to connect a moxa db9 converter to have an rs485 serial output but for now I'm just checking logical status of the signals with my protocol analyser. \nHowever the hint is correct, I mean  if I manually set  RTS flag with ioctl function RTS is correctly managed. So if we are interested only in controlling RTS signal without full hardware flow control we must disable CRTSCTS flag with <code>attr.c_cflag &amp;= ~CRTSCTS</code> and then we can make a write function with proper ioctl functions for RTS pin. If instead we have a slave which supports hardware flow control then enabling CRTSCTS flag should be enough.</p>\n"}], "owner": {"reputation": 31, "user_id": 5930202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f67997a9973b249ffdfd90305de240?s=128&d=identicon&r=PG&f=1", "display_name": "Whitefield", "link": "https://stackoverflow.com/users/5930202/whitefield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1481540466, "creation_date": 1481125735, "question_id": 41021726, "link": "https://stackoverflow.com/questions/41021726/why-rts-signal-is-different-if-write-is-done-via-terminal-rather-than-via-applic", "title": "Why rts signal is different if write is done via terminal rather than via application?", "body": "<p>I'm working with an rs232 db9 male connector under Ubuntu 16.04\nLet's assume that pin 5 is ground\nI can write to the connector from terminal using a command like <code>echo \"pippo\" &gt; /dev/ttyS0</code> and using a protocol analyser I can see that:</p>\n\n<ul>\n<li>pin 3 is correctly transmitting the signal</li>\n<li>pin 4 and pin 7 are both low before the data transmission</li>\n<li>pin 4 and pin 7 are both high while data transmission on pin 3</li>\n<li>pin 4 and pin 7 are both low after data transmission on pin 3</li>\n</ul>\n\n<p>now if I try to run the following C code</p>\n\n<pre><code>int file_descriptor = open (\"/dev/ttyS0\", O_RDWR | O_NOCTTY | O_NDELAY);\nunsigned char* buffer = (unsigned char*)\"pippo\";\nbuffer_length = strlen((char*)buffer);\nunsigned int written = 0;\nwhile(written&lt;buffer_length){\n    unsigned int tmp = write (this_ptr-&gt;dev_file_descriptor, buffer+written, buffer_length-written);\n    if(tmp &lt;0){\n        break;\n    }\n    written += tmp;\n}\ntcdrain(this_ptr-&gt;dev_file_descriptor);\nif(written != buffer_length){\n    perror(\"Serial write failure\\n\");\n    return-1;\n}\nclose(file_descriptor);\n</code></pre>\n\n<p>I can see that</p>\n\n<ul>\n<li>Data is transmitted on pin 3 BUT</li>\n<li>pin 4 and pin 7 are always LOW</li>\n</ul>\n\n<p>I need RTS and I don't understand why the behaviour is different in these two scenarios.</p>\n\n<p>the output of <code>stty -F /dev/ttyS0 -a</code> is actually </p>\n\n<blockquote>\n  <p>speed 9600 baud; rows 0; columns 0; line = 0;\n  intr = ^C; quit = ^\\; erase = ^?; kill = ^U; eof = ^D; eol = ; eol2 = ; swtch = ; start = ^Q; stop = ^S; susp = ^Z; rprnt = ^R; werase = ^W;\n  lnext = ^V; discard = ^O; min = 1; time = 0;\n  -parenb -parodd -cmspar cs8 hupcl -cstopb cread clocal -crtscts\n  -ignbrk -brkint -ignpar -parmrk -inpck -istrip -inlcr -igncr icrnl ixon -ixoff -iuclc -ixany -imaxbel -iutf8\n  opost -olcuc -ocrnl onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0\n  isig icanon iexten echo echoe echok -echonl -noflsh -xcase -tostop -echoprt echoctl echoke -flusho -extproc</p>\n</blockquote>\n\n<p>and as I said it works from terminal but it doesn't from my application.</p>\n\n<p>Thanks and regards</p>\n"}, {"tags": ["c", "arrays", "dynamic-allocation"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1481125640, "post_id": 41021646, "comment_id": 69250458, "body": "Search for, and read about <i>emulating pass by reference in c</i>."}, {"owner": {"reputation": 649, "user_id": 5602491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2426d2645029b0fa49495a956020ee66?s=128&d=identicon&r=PG&f=1", "display_name": "gilez", "link": "https://stackoverflow.com/users/5602491/gilez"}, "edited": false, "score": 0, "creation_date": 1481125838, "post_id": 41021646, "comment_id": 69250586, "body": "<code>sizeof(char)</code> is always going to be 1..... (well, perhaps 2 if you&#39;re using double-width characters -- but it&#39;s a fixed size, which is not what you want)."}], "answers": [{"comments": [{"owner": {"reputation": 2388, "user_id": 348637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Vmm7D.jpg?s=128&g=1", "display_name": "Abhinav Upadhyay", "link": "https://stackoverflow.com/users/348637/abhinav-upadhyay"}, "reply_to_user": {"reputation": 4125, "user_id": 3426025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yxLev.png?s=128&g=1", "display_name": "BeyelerStudios", "link": "https://stackoverflow.com/users/3426025/beyelerstudios"}, "edited": false, "score": 0, "creation_date": 1481126048, "post_id": 41021752, "comment_id": 69250761, "body": "@BeyelerStudios Oops, result of a hurry :-)"}, {"owner": {"reputation": 2388, "user_id": 348637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Vmm7D.jpg?s=128&g=1", "display_name": "Abhinav Upadhyay", "link": "https://stackoverflow.com/users/348637/abhinav-upadhyay"}, "reply_to_user": {"reputation": 4125, "user_id": 3426025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yxLev.png?s=128&g=1", "display_name": "BeyelerStudios", "link": "https://stackoverflow.com/users/3426025/beyelerstudios"}, "edited": false, "score": 0, "creation_date": 1481127086, "post_id": 41021752, "comment_id": 69251485, "body": "@BeyelerStudios Thank you :-)"}], "tags": [], "owner": {"reputation": 2388, "user_id": 348637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Vmm7D.jpg?s=128&g=1", "display_name": "Abhinav Upadhyay", "link": "https://stackoverflow.com/users/348637/abhinav-upadhyay"}, "is_accepted": false, "score": 2, "last_activity_date": 1481127773, "last_edit_date": 1481127773, "creation_date": 1481125804, "answer_id": 41021752, "question_id": 41021646, "link": "https://stackoverflow.com/questions/41021646/trying-to-use-realloc-getting-core-dumped/41021752#41021752", "title": "Trying to use realloc(), getting core dumped", "body": "<p>You are missing one level of indirection in the inputArray function. It should be declared like</p>\n\n<pre><code>void inputArray(char **array)\n</code></pre>\n\n<p>and it should be realloc'd like this (you also need to increase the size of the array by multiplying with <code>count + 1</code>)</p>\n\n<pre><code>*array = realloc(*array, (count + 1) * sizeof(char));\n</code></pre>\n\n<p>Call it like this:</p>\n\n<pre><code> inputArray(&amp;string);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 3, "last_activity_date": 1481127130, "last_edit_date": 1481127130, "creation_date": 1481125910, "answer_id": 41021781, "question_id": 41021646, "link": "https://stackoverflow.com/questions/41021646/trying-to-use-realloc-getting-core-dumped/41021781#41021781", "title": "Trying to use realloc(), getting core dumped", "body": "<p>The size of the new allocated array is incorrect. You have to allocate <code>count + 1</code> characters.</p>\n\n<pre><code>array = realloc(array, ( count + 1 ) * sizeof(char));\n</code></pre>\n\n<p>Take into account that it is more safe to use a temporary pointer to reallocate the memory. Otherwise the original address of the previously allocated memory will be lost.</p>\n\n<p>Also these statements</p>\n\n<pre><code>array = realloc(array, sizeof(char));\nptr += count;\n</code></pre>\n\n<p>are wrong. You should at least write</p>\n\n<pre><code>array = realloc(array, count * sizeof(char));\nptr = array + count - 1;\n</code></pre>\n\n<p>Also the function should be declared like</p>\n\n<pre><code>char * inputArray(char * array);\n</code></pre>\n\n<p>and it must to return the new pointer to the caller.</p>\n\n<p>And in main you have to write</p>\n\n<pre><code>string = inputArray(string);\n</code></pre>\n\n<p>Otherwise the function should accept the argument by reference that is the parameter should be declared like</p>\n\n<pre><code>void inputArray(char ** array);\n</code></pre>\n\n<p>and be processed correspondingly in the function.</p>\n"}], "owner": {"reputation": 215, "user_id": 6219523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXxP8.png?s=128&g=1", "display_name": "fishamit", "link": "https://stackoverflow.com/users/6219523/fishamit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "accepted_answer_id": 41021781, "answer_count": 2, "score": 2, "last_activity_date": 1481127773, "creation_date": 1481125473, "question_id": 41021646, "link": "https://stackoverflow.com/questions/41021646/trying-to-use-realloc-getting-core-dumped", "title": "Trying to use realloc(), getting core dumped", "body": "<p>I'm trying to write a little program which uses realloc(), getchar() and some pointer arithmetic to store an array of characters in the memory. </p>\n\n<p>I have a function called \"inputArray\" (in convert.c) which receives a pointer to a char (which is NULL to begin with, declared in main.c), then gets reallocated with one char until getchar() gets a '\\n' char. the functions seems to work ok, but then when I try to print the string back in main.c, i get a \"segmentation fault (core dumped)\" error. I've been looking for hours, can't find where the problem is. Thanks!</p>\n\n<p>main.c:</p>\n\n<pre><code># include \"convert.h\"\n\nint main()\n{\n  char * string = NULL;\n  inputArray(string);\n  printf(\"%s\", string);    \n  free(string);\n  return 0;\n}\n</code></pre>\n\n<p>convert.c:</p>\n\n<pre><code>#include \"convert.h\"\n\nvoid inputArray(char * array)\n{\n    /*pointer to the array*/\n    char * ptr = NULL;\n\n    /*stores the char*/\n    char c = 0;\n\n    /*counter used for pointer arithmetic*/\n    int count = 0;\n\n    /*loop for getting chars in array*/\n    while ((c = getchar()) != '\\n')\n    {\n      array = realloc(array, sizeof(char));\n      ptr = array + count;\n      *ptr = c;\n      ++count;\n    }\n\n    /*add the null char to the end of the string*/\n    array = realloc(array, sizeof(char));\n    ptr += count;\n    *ptr = '\\0';\n}\n</code></pre>\n\n<p>convert.h:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid inputArray(char * array);\n</code></pre>\n"}, {"tags": ["c", "increment", "post-increment", "pre-increment"], "comments": [{"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "edited": false, "score": 0, "creation_date": 1481125349, "post_id": 41021561, "comment_id": 69250251, "body": "This will produce an undefined behavior."}, {"owner": {"reputation": 114, "user_id": 3632345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460bf4af14c67c2aa734aaafe4bf671f?s=128&d=identicon&r=PG&f=1", "display_name": "deezpeeps", "link": "https://stackoverflow.com/users/3632345/deezpeeps"}, "reply_to_user": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "edited": false, "score": 0, "creation_date": 1481125407, "post_id": 41021561, "comment_id": 69250307, "body": "@Surajeet Bharati why? Is anything in it ambiguous?"}, {"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "edited": false, "score": 0, "creation_date": 1481125514, "post_id": 41021561, "comment_id": 69250381, "body": "Duplicate of <a href=\"http://stackoverflow.com/questions/949433/why-are-these-constructs-using-undefined-behavior?noredirect=1&amp;lq=1\" title=\"why are these constructs using undefined behavior\">stackoverflow.com/questions/949433/&hellip;</a>"}, {"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "edited": false, "score": 0, "creation_date": 1481125859, "post_id": 41021561, "comment_id": 69250603, "body": "Also look into this . <a href=\"http://stackoverflow.com/questions/4176328/undefined-behavior-and-sequence-points\" title=\"undefined behavior and sequence points\">stackoverflow.com/questions/4176328/&hellip;</a>"}], "owner": {"reputation": 114, "user_id": 3632345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460bf4af14c67c2aa734aaafe4bf671f?s=128&d=identicon&r=PG&f=1", "display_name": "deezpeeps", "link": "https://stackoverflow.com/users/3632345/deezpeeps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1481125299, "answer_count": 0, "score": 0, "last_activity_date": 1481125263, "creation_date": 1481125263, "question_id": 41021561, "link": "https://stackoverflow.com/questions/41021561/execution-of-multiple-increment-operators", "closed_reason": "Duplicate", "title": "Execution of multiple increment operators", "body": "<p>How would the output of </p>\n\n<pre><code>int i = 6;\ni += ++i + ++i + i++ + --i;\nprintf(\"%d\", i);\n</code></pre>\n\n<p>be evaluated. When I do it on paper I get 39.\nBut the output after executing is 40.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 4, "creation_date": 1481125046, "post_id": 41021354, "comment_id": 69250019, "body": "So you need an expression evaluator ?"}, {"owner": {"reputation": 7970, "user_id": 4117097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrdeC.jpg?s=128&g=1", "display_name": "Anton Malyshev", "link": "https://stackoverflow.com/users/4117097/anton-malyshev"}, "edited": false, "score": 0, "creation_date": 1481125063, "post_id": 41021354, "comment_id": 69250031, "body": "<a href=\"http://stackoverflow.com/questions/840501/how-do-function-pointers-in-c-work\" title=\"how do function pointers in c work\">stackoverflow.com/questions/840501/&hellip;</a>"}, {"owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "edited": false, "score": 1, "creation_date": 1481125107, "post_id": 41021354, "comment_id": 69250064, "body": "you&#39;ll have to specify your input in more detail. your scanf function will not work."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1481125362, "post_id": 41021354, "comment_id": 69250267, "body": "If you are saying that the user can enter ~arbitrary mathematical expressions for the function, that seems like the hard part of the project, and you have shown no work towards achieving it on your own. And in any case you need to define the allowed input precisely, e.g., what operators are accepted and can well-known functions (like <code>sin</code>) be referenced, etc."}, {"owner": {"reputation": 115, "user_id": 7892665, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KN9OAK3NXeU/AAAAAAAAAAI/AAAAAAAAACM/l-Rbns6KDvQ/photo.jpg?sz=128", "display_name": "Henry Wang", "link": "https://stackoverflow.com/users/7892665/henry-wang"}, "edited": false, "score": 0, "creation_date": 1481125408, "post_id": 41021354, "comment_id": 69250309, "body": "What is an expression evaluator? The input is any mathematical function, for example, sin(2)x^2."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1481125492, "post_id": 41021354, "comment_id": 69250364, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1151127/evaluating-mathematical-expressions\">Evaluating mathematical expressions</a>"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1481125745, "post_id": 41021354, "comment_id": 69250527, "body": "You still need to define the syntax for the input precisely, e.g., what other functions than <code>sin</code> are supported, what is the precedence of operators, in which circumstances can the multiplication operator be omitted, etc. (For example, is <code>sqrt(2)(2 + -3x)^\u03c0&#47;2^2</code> acceptable and what is the order of evaluation.)"}, {"owner": {"reputation": 115, "user_id": 7892665, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KN9OAK3NXeU/AAAAAAAAAAI/AAAAAAAAACM/l-Rbns6KDvQ/photo.jpg?sz=128", "display_name": "Henry Wang", "link": "https://stackoverflow.com/users/7892665/henry-wang"}, "edited": false, "score": 0, "creation_date": 1481125891, "post_id": 41021354, "comment_id": 69250623, "body": "Is there any other way of doing it without using an expression evaluator? It looks like it is beyond the scope of my project right now."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1481126728, "post_id": 41021354, "comment_id": 69251242, "body": "Evaluating (mathematical) expressions is what you are trying to do, so, no, it cannot be done without an &quot;expression evaluator&quot;. Whether it can be done without coding one yourself, yes: find an existing one and use it (assuming it is allowed in your project). For example: <a href=\"https://github.com/codeplea/tinyexpr\" rel=\"nofollow noreferrer\">github.com/codeplea/tinyexpr</a> (as for complexity of the question, this one is called &quot;tiny&quot; and it is over 600 lines)."}, {"owner": {"reputation": 115, "user_id": 7892665, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KN9OAK3NXeU/AAAAAAAAAAI/AAAAAAAAACM/l-Rbns6KDvQ/photo.jpg?sz=128", "display_name": "Henry Wang", "link": "https://stackoverflow.com/users/7892665/henry-wang"}, "edited": false, "score": 0, "creation_date": 1481127652, "post_id": 41021354, "comment_id": 69251864, "body": "Can you show me an example of using tinyexpr to convert a scanned string into a mathematical function, then use it to calculate something? Let&#39;s say scanning x^2 as a string where x is 2."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1481127964, "post_id": 41021354, "comment_id": 69252070, "body": "The github page has examples."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 7892665, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KN9OAK3NXeU/AAAAAAAAAAI/AAAAAAAAACM/l-Rbns6KDvQ/photo.jpg?sz=128", "display_name": "Henry Wang", "link": "https://stackoverflow.com/users/7892665/henry-wang"}, "edited": false, "score": 0, "creation_date": 1481127919, "post_id": 41022317, "comment_id": 69252037, "body": "Thank you for your help!"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "reply_to_user": {"reputation": 115, "user_id": 7892665, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KN9OAK3NXeU/AAAAAAAAAAI/AAAAAAAAACM/l-Rbns6KDvQ/photo.jpg?sz=128", "display_name": "Henry Wang", "link": "https://stackoverflow.com/users/7892665/henry-wang"}, "edited": false, "score": 0, "creation_date": 1481128090, "post_id": 41022317, "comment_id": 69252152, "body": "@WangHenry, you could use the shunting-yard algorithm to parse mathematical expressions"}, {"owner": {"reputation": 115, "user_id": 7892665, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KN9OAK3NXeU/AAAAAAAAAAI/AAAAAAAAACM/l-Rbns6KDvQ/photo.jpg?sz=128", "display_name": "Henry Wang", "link": "https://stackoverflow.com/users/7892665/henry-wang"}, "edited": false, "score": 0, "creation_date": 1481131004, "post_id": 41022317, "comment_id": 69254068, "body": "Hi, the TinyExpr website does not show how to install it, can you please show me how it is installed?"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 115, "user_id": 7892665, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KN9OAK3NXeU/AAAAAAAAAAI/AAAAAAAAACM/l-Rbns6KDvQ/photo.jpg?sz=128", "display_name": "Henry Wang", "link": "https://stackoverflow.com/users/7892665/henry-wang"}, "edited": false, "score": 1, "creation_date": 1481188152, "post_id": 41022317, "comment_id": 69278374, "body": "@WangHenry Compile the sources with your project and <code>#include</code> the header. As it says in the &quot;Building&quot; section on the github page."}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": true, "score": 2, "last_activity_date": 1481127463, "creation_date": 1481127463, "answer_id": 41022317, "question_id": 41021354, "link": "https://stackoverflow.com/questions/41021354/how-to-ask-the-user-to-input-a-mathematical-function-in-c-language/41022317#41022317", "title": "How to ask the user to input a mathematical function in c language?", "body": "<p>The C standard library includes nothing that would allow you to parse arbitrary mathematical expressions directly. The implementation of such an expression parser/evaluator is far outside the scope of a Stack Overflow answer, but if you are allowed to use an external library (i.e., this problem is not what your project is about), there are open source options, such as <a href=\"https://github.com/codeplea/tinyexpr\" rel=\"nofollow noreferrer\">TinyExpr</a>. You should be able to just read the user's input into a string (such as with <code>fgets</code>) and pass it to the library.</p>\n\n<p>(If you are not allowed to use a library, read up on parsers and study the diagrams and source code on the linked github page, then ask a more specific question if you run into problems.)</p>\n"}], "owner": {"reputation": 115, "user_id": 7892665, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KN9OAK3NXeU/AAAAAAAAAAI/AAAAAAAAACM/l-Rbns6KDvQ/photo.jpg?sz=128", "display_name": "Henry Wang", "link": "https://stackoverflow.com/users/7892665/henry-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1762, "favorite_count": 0, "accepted_answer_id": 41022317, "answer_count": 1, "score": 0, "last_activity_date": 1481127800, "creation_date": 1481124622, "last_edit_date": 1481127800, "question_id": 41021354, "link": "https://stackoverflow.com/questions/41021354/how-to-ask-the-user-to-input-a-mathematical-function-in-c-language", "title": "How to ask the user to input a mathematical function in c language?", "body": "<p>I am doing a university project where I have to create a numerical integration calculator. I need the user to input the integrand function to replace the <code>double f(double x)</code> function below so that my program can work for any 1-D integral with non-infinity limits.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\ndouble f(double x)\n{\n    return x;\n}\n\ndouble traprule(double a, double b, double N)\n{\n    double h, sum, fn, fa, fb, I;\n\n    sum = 0;\n    h = (b - a) / N;\n\n    for (int n = 1; n &lt; N; n++)\n    {\n        fn = f(a + n * h);\n        sum = sum + fn;\n    }\n\n    fa = f(a);\n    fb = f(b);\n    I = 0.5 * h * ((fa + fb) + 2 * sum);\n    return I;\n}\n\nint main()\n{\n    scanf(\"%s\", &amp;f)\n    double result;\n    result = traprule(0, 10, 10);\n    printf(\"%lg\", result);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "shared-memory"], "comments": [{"owner": {"reputation": 3574, "user_id": 5793987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a057299226b268d59f2faa0b3f1d1112?s=128&d=identicon&r=PG", "display_name": "gudok", "link": "https://stackoverflow.com/users/5793987/gudok"}, "edited": false, "score": 2, "creation_date": 1481124497, "post_id": 41021255, "comment_id": 69249636, "body": "Maybe simply to call <code>shmget</code> without <code>IPC_CREAT</code> flag?"}, {"owner": {"reputation": 4456, "user_id": 4127569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b728c7d6c1dce81f5a82249b7617756?s=128&d=identicon&r=PG&f=1", "display_name": "jch", "link": "https://stackoverflow.com/users/4127569/jch"}, "edited": false, "score": 0, "creation_date": 1481124990, "post_id": 41021255, "comment_id": 69249990, "body": "Are you sure you want to use System V shared memory?  POSIX shared memory is much easier to work with.  Check <code>shm_open</code>."}, {"owner": {"reputation": 25, "user_id": 6226442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/798fa46e0dad67fef55c2bc354fcb800?s=128&d=identicon&r=PG&f=1", "display_name": "GamerGirl", "link": "https://stackoverflow.com/users/6226442/gamergirl"}, "edited": false, "score": 0, "creation_date": 1481125978, "post_id": 41021255, "comment_id": 69250690, "body": "It worked, im using shmget because its for a project and since the professors use that... thanks for the tip anyway"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6226442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/798fa46e0dad67fef55c2bc354fcb800?s=128&d=identicon&r=PG&f=1", "display_name": "GamerGirl", "link": "https://stackoverflow.com/users/6226442/gamergirl"}, "edited": false, "score": 0, "creation_date": 1481125883, "post_id": 41021341, "comment_id": 69250619, "body": "It worked, i assumed we always had to use IPC_CREAT in order for it to work since i hadn&#39;t seen an example without it. Thanks for the help!"}, {"owner": {"reputation": 830, "user_id": 2165524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xg2Jb.jpg?s=128&g=1", "display_name": "&#181;tex", "link": "https://stackoverflow.com/users/2165524/%c2%b5tex"}, "reply_to_user": {"reputation": 25, "user_id": 6226442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/798fa46e0dad67fef55c2bc354fcb800?s=128&d=identicon&r=PG&f=1", "display_name": "GamerGirl", "link": "https://stackoverflow.com/users/6226442/gamergirl"}, "edited": false, "score": 1, "creation_date": 1481125957, "post_id": 41021341, "comment_id": 69250666, "body": "@Livernal :-)... Check the man page as well, you will have more information from there."}], "tags": [], "owner": {"reputation": 830, "user_id": 2165524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xg2Jb.jpg?s=128&g=1", "display_name": "&#181;tex", "link": "https://stackoverflow.com/users/2165524/%c2%b5tex"}, "is_accepted": true, "score": 5, "last_activity_date": 1481124572, "creation_date": 1481124572, "answer_id": 41021341, "question_id": 41021255, "link": "https://stackoverflow.com/questions/41021255/checking-if-a-shared-memory-exists-and-if-it-does-access-it/41021341#41021341", "title": "Checking if a shared memory exists and if it does access it", "body": "<p>Do not use <code>IPC_CREAT</code> flag. It will return error <code>ENOENT</code> if that shared memory does not exist.</p>\n\n<p>Check the man page for further information..</p>\n\n<p><a href=\"http://man7.org/linux/man-pages/man2/shmget.2.html\" rel=\"noreferrer\">SHMGET</a></p>\n"}], "owner": {"reputation": 25, "user_id": 6226442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/798fa46e0dad67fef55c2bc354fcb800?s=128&d=identicon&r=PG&f=1", "display_name": "GamerGirl", "link": "https://stackoverflow.com/users/6226442/gamergirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4838, "favorite_count": 0, "accepted_answer_id": 41021341, "answer_count": 1, "score": 1, "last_activity_date": 1481124572, "creation_date": 1481124284, "question_id": 41021255, "link": "https://stackoverflow.com/questions/41021255/checking-if-a-shared-memory-exists-and-if-it-does-access-it", "title": "Checking if a shared memory exists and if it does access it", "body": "<p>I have another program1 where i create a shared memory and i have a program2 that i want to check if the shared memory has been created, if not then print an error and dont do nothing and if it has been created already then acess it.\nIf the shared memory has been created before then it works fine and i can acess it but the problem im having is that if the shared memory has not been created then instead of doing nothing and printing an error the program2 creates the shared memory and i didn't want that to happen.\nAny help would be appreciated and please ask any information that might be usefull, thanks!</p>\n\n<pre><code>void main(){\n\nint sm_id;\nsm_id = shmget(9000, MAX_USERS * sizeof(User), IPC_CREAT | IPC_EXCL | 0666);\nif(sm_id&gt;0){\n    perror(\"Shared memory has not been created yet\");\n    exit(1);\n}else{\n    sm_id = shmget(9000, MAX_USERS * sizeof(User), IPC_CREAT | 0666);\n    list = (User *)shmat(sm_id,0,0);\n    exit_on_null(list, \"Exit on null(error attach)\");\n}\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6525, "user_id": 936083, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dace92a4c0b65a1f52abbabd294ca1a8?s=128&d=identicon&r=PG", "display_name": "Casey Kuball", "link": "https://stackoverflow.com/users/936083/casey-kuball"}, "edited": false, "score": 0, "creation_date": 1481124293, "post_id": 41021149, "comment_id": 69249490, "body": "<a href=\"http://stackoverflow.com/questions/4480552/why-does-the-following-c-program-give-a-bus-error\">See also</a>"}, {"owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1481127925, "post_id": 41021149, "comment_id": 69252041, "body": "Also, Your code above is missing a <code>)</code> before the <code>;</code> on the <code>for()</code> line. (and quite possibly some <code>{</code>, <code>}</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 4, "last_activity_date": 1481124178, "creation_date": 1481124178, "answer_id": 41021208, "question_id": 41021149, "link": "https://stackoverflow.com/questions/41021149/bus-error10-with-strtok-in-c/41021208#41021208", "title": "Bus Error:10 with strtok in C", "body": "<p>You cannot modify a string constant. Define <code>line</code> this way:</p>\n\n<pre><code>char line[] = \"test test test\";\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1481125084, "creation_date": 1481125084, "answer_id": 41021507, "question_id": 41021149, "link": "https://stackoverflow.com/questions/41021149/bus-error10-with-strtok-in-c/41021507#41021507", "title": "Bus Error:10 with strtok in C", "body": "<p><code>strtok</code> will modify the buffer it is passed; this is <a href=\"https://linux.die.net/man/3/strtok\" rel=\"nofollow noreferrer\">contractual</a>: </p>\n\n<blockquote>\n  <p>Be cautious when using these functions. If you do use them, note that:</p>\n  \n  <p>*\n  These functions modify their first argument.</p>\n  \n  <p>*\n  These functions cannot be used on constant strings.</p>\n</blockquote>\n\n<p>When you declare a string as <code>char *str = \"blah blah\";</code> in C, you are declaring it to be read-only memory, so when you pass it to <code>strtok</code> the result is undefined since <code>strtok</code> wants to modify the buffer but can't since it's read-only.</p>\n\n<p>To address this issue declare <code>str</code> as an array instead: <code>char str[] = \"blah blah\";</code></p>\n"}], "owner": {"reputation": 49, "user_id": 6846785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ba7c6b82c099ba96f18438f4bff68ce?s=128&d=identicon&r=PG&f=1", "display_name": "Legolas", "link": "https://stackoverflow.com/users/6846785/legolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 0, "accepted_answer_id": 41021507, "answer_count": 2, "score": 2, "last_activity_date": 1481125084, "creation_date": 1481123972, "question_id": 41021149, "link": "https://stackoverflow.com/questions/41021149/bus-error10-with-strtok-in-c", "title": "Bus Error:10 with strtok in C", "body": "<p>Here is my code, when I running the code, always bus error 10:</p>\n\n<pre><code>void print_tokens(char *line)\n{\n    static char whitespace[] = \" \\t\\f\\r\\v\\n\";\n    char *token;\n\n    for(token = strtok(line, whitespace);\n       token != NULL;\n       token = strtok(NULL, whitespace))\n       printf(\"Next token is %s\\n\", token);\n}\n\nint main(void)\n{\n    char *line = \"test test test\";\n    print_tokens(line);\n    return 0;\n}\n</code></pre>\n\n<p>Please help me!</p>\n"}, {"tags": ["c", "matrix"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481128113, "post_id": 41020961, "comment_id": 69252164, "body": "Note: To see more of the <code>float</code> value,use <code>printf(&quot; %e&quot;,some_float);</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1481128165, "post_id": 41020961, "comment_id": 69252197, "body": "Posting sample input, output and expected output would help."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481128508, "post_id": 41020961, "comment_id": 69252444, "body": "Save time, turn on compiler warnings:  <code>printf(&quot;\\n\\nLe determinant de la matrice A est = %f&quot;, n);</code> --&gt; <code>... %d&quot;, n);</code>"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1481129034, "post_id": 41020961, "comment_id": 69252828, "body": "What chux said, but why is the determinant of a floating-point matrix an integer? <code>n</code> is the determinant in <code>transpose</code>, but not in <code>main</code>, where you wnt to print it. (You should also use a consistent nomenclature for the order of the matrix, sometimes it&#39;s <code>n</code>, sometimes it&#39;s <code>k</code> and in <code>transpose</code> you even use a float, <code>r</code> for the order.)"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1481131583, "post_id": 41020961, "comment_id": 69254423, "body": "Note that this algorithm may be very slow. You could try the Gauss algorithm instead for <code>O(n)</code> complexity."}], "answers": [{"tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 2, "last_activity_date": 1481131333, "last_edit_date": 1481131333, "creation_date": 1481130890, "answer_id": 41023474, "question_id": 41020961, "link": "https://stackoverflow.com/questions/41020961/matrix-inverse-always-null/41023474#41023474", "title": "Matrix : Inverse always null", "body": "<p>There are several issues with your code, but the principal error is that you pass a wrong parameter to</p>\n\n<pre><code>cofactor(A,k);\n</code></pre>\n\n<p>Here, <code>k</code> is a loop variable that has the value it had after it was used in the code that does the triangular decomposition. (You can see that this value is 1, because only one entry of the matrix is printed.)</p>\n\n<p>You should use the order of the matrices, <code>n</code>:</p>\n\n<pre><code>cofactor(A, n);\n</code></pre>\n\n<p>In general, you should use a more consistent nomenclature. In <code>main</code>, the order of the matrices is <code>n</code>, in <code>determinant</code> it's <code>k</code>, in <code>cofactor</code> you use the floating-point variable <code>f</code> and in <code>transpose</code>, you use the floating-point variable <code>r</code>. To add to the confusion, <code>n</code> is a float here that represents the determinant. I suggest you use the integer <code>n</code> for the order, local integers <code>i</code>, <code>j</code> and <code>k</code> as loop variables &ndash; C99 allows you to define them only for the scope of the loop, e.g. <code>for (int i = 0; ...)</code> &ndash; and more or less meaningful names for the floating-point numbers; <code>det</code> for the determinant is good.</p>\n\n<p>Further suggestions:</p>\n\n<ul>\n<li>Don't write explicit loops to print matrices every time; write a function to print a matrix and a function to print a vector instead and call them.</li>\n<li>Separate calculating from printing. For example, the code to print the inverse should not be part of (the badly named?) <code>transpose</code>. Instead, <code>transpose</code> should fill a matrix passed in from <code>main</code>, and <code>main</code> should then print that matrix.</li>\n<li>Ideally, triangular decomposition and solving the equation should be functions, too. Experience the joys of nicely organised code. <code>:)</code></li>\n</ul>\n"}], "owner": {"reputation": 27, "user_id": 7263000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eaoUc.jpg?s=128&g=1", "display_name": "Zarkoffe", "link": "https://stackoverflow.com/users/7263000/zarkoffe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 41023474, "answer_count": 1, "score": 0, "last_activity_date": 1481131333, "creation_date": 1481123429, "question_id": 41020961, "link": "https://stackoverflow.com/questions/41020961/matrix-inverse-always-null", "title": "Matrix : Inverse always null", "body": "<p>The inverse of my matrix shows always 0 and I don't understand why. Thank you for advance.\n4 fonctions : \n-main : user enters the matrix, and the results (of matrix, determinant, LU factorisation and inverse) are display.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;math.h&gt;\n\nfloat determinant(float[20][20],float);\nvoid cofactor(float[20][20],float);\nvoid transpose(float[20][20],float[20][20],float);\n\nvoid main() \n{\n    float A[20][20]= {0},L[20][20]= {0}, U[20][20];\n    float B[20]= {0}, X[20]= {0},Y[20]= {0};\n    int i,j,k,n;\n    printf(\"Enter the order of square matrix: \");\n    scanf(\"%d\",&amp;n);\n    printf(\"\\nEntrer les elements de la matrice A:\\n\");\n    for(i=0; i&lt;n; i++)\n    {\n        for(j=0; j&lt;n; j++)\n        {\n            printf(\"Entrer l'element A[%d][%d] : \", i,j);\n            scanf(\"%f\",&amp;A[i][j]);\n        }\n    }\n    printf(\"\\nEntrer les termes de la matrice B\\n\");\n    for(i=0; i&lt;n; i++)\n    {\n        printf(\"B[%d]\",i);\n        scanf(\"%f\",&amp;B[i]);\n    }\n    for(j=0; j&lt;n; j++)\n    {\n        for(i=0; i&lt;n; i++)\n        {\n            if(i&lt;=j)\n            {\n                U[i][j]=A[i][j];\n                for(k=0; k&lt;i-1; k++)\n                    U[i][j]-=L[i][k]*U[k][j];\n                if(i==j)\n                    L[i][j]=1;\n                else\n                    L[i][j]=0;\n            }\n            else\n            {\n                L[i][j]=A[i][j];\n                for(k=0; k&lt;=j-1; k++)\n                    L[i][j]-=L[i][k]*U[k][j];\n                L[i][j]/=U[j][j];\n                U[i][j]=0;\n            }\n        }\n    }\n    printf(\"[L]: \\n\");\n    for(i=0; i&lt;n; i++)\n    {\n        for(j=0; j&lt;n; j++)\n            printf(\"%9.3f\",L[i][j]);\n        printf(\"\\n\");\n    }\n    printf(\"\\n\\n[U]: \\n\");\n    for(i=0; i&lt;n; i++)\n    {\n        for(j=0; j&lt;n; j++)\n            printf(\"%9.3f\",U[i][j]);\n        printf(\"\\n\");\n    }\n   //Y pour calculer X\n    for(i=0; i&lt;n; i++)\n    {\n        Y[i]=B[i];\n        for(j=0; j&lt;i; j++)\n        {\n            Y[i]-=L[i][j]*Y[j];\n        }\n    }\n    for(i=0; i&lt;n; i++)\n    {\n        printf(\"%9.3f\",Y[i]);\n    }\n    for(i=n-1; i&gt;=0; i--)\n    {\n        X[i]= Y[i];\n        for(j=i+1; j&lt;n; j++)\n        {\n            X[i]-=U[i][j]*X[j];\n        }\n        X[i]/=U[i][i];\n    }\n    printf(\"\\n\\n[X]: \\n\");\n    for(i=0; i&lt;n; i++)\n    {\n        printf(\"%9.3f\",X[i]);\n    }\n    printf(\"\\n\\nLe determinant de la matrice A est = %f\",n);\n  if (n==0)\n   printf(\"\\nCette matrice n'a pas d'inverse!\\n\");\n  else {\n   cofactor(A,k);\n  }\n\ngetch();\n}\n\nfloat determinant(float a[20][20],float k)\n{\n  float s=1,det=0,b[20][20];\n  int i,j,m,n,c;\n  if (k==1)\n    {\n     return (a[0][0]);\n    }\n  else\n    {\n     det=0;\n     for (c=0;c&lt;k;c++)\n       {\n        m=0;\n        n=0;\n        for (i=0;i&lt;k;i++)\n          {\n            for (j=0;j&lt;k;j++)\n              {\n                b[i][j]=0;\n                if (i != 0 &amp;&amp; j != c)\n                 {\n                   b[m][n]=a[i][j];\n                   if (n&lt;(k-2))\n                    n++;\n                   else\n                    {\n                     n=0;\n                     m++;\n                     }\n                   }\n               }\n             }\n          det=det + s * (a[0][c] * determinant(b,k-1));\n          s=-1 * s;\n          }\n    }\n\n    return (det);\n}\n\nvoid cofactor(float num[20][20],float f) //fonction which will calculate the cofactof of matrix\n{\n float b[20][20],fac[20][20];\n int p,q,m,n,i,j;\n for (q=0;q&lt;f;q++)\n {\n   for (p=0;p&lt;f;p++)\n    {\n     m=0;\n     n=0;\n     for (i=0;i&lt;f;i++)\n     {\n       for (j=0;j&lt;f;j++)\n        {\n          if (i != q &amp;&amp; j != p)\n          {\n            b[m][n]=num[i][j];\n            if (n&lt;(f-2))\n             n++;\n            else\n             {\n               n=0;\n               m++;\n               }\n            }\n        }\n      }\n      fac[q][p]=pow(-1,q + p) * determinant(b,f-1);\n    }\n  }\n  transpose(num,fac,f);\n}\n/*Finding transpose of matrix*/\nvoid transpose(float num[20][20],float fac[20][20],float r)\n{\n  int i,j;\n  float b[20][20],inverse[20][20],n;\n\n  for (i=0;i&lt;r;i++)\n    {\n     for (j=0;j&lt;r;j++)\n       {\n         b[i][j]=fac[j][i];\n        }\n    }\n  n=determinant(num,r);\n  for (i=0;i&lt;r;i++)\n    {\n     for (j=0;j&lt;r;j++)\n       {\n        inverse[i][j]=b[i][j] / n;\n        }\n    }\n   printf(\"\\n\\n\\nThe inverse of matrix is : \\n\");\n\n   for (i=0;i&lt;r;i++)\n    {\n     for (j=0;j&lt;r;j++)\n       {\n         printf(\"\\t%f\",inverse[i][j]); //show inverse of the matrix\n        }\n    printf(\"\\n\");\n     }\n}\n</code></pre>\n"}, {"tags": ["c", "signals", "wait", "semaphore", "dining-philosopher"], "comments": [{"owner": {"reputation": 86, "user_id": 6078437, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c445d61a467a9198039c66cf2fbaaff1?s=128&d=identicon&r=PG&f=1", "display_name": "scarecrow-", "link": "https://stackoverflow.com/users/6078437/scarecrow"}, "edited": false, "score": 0, "creation_date": 1481123292, "post_id": 41020851, "comment_id": 69248733, "body": "philosopher needs to be declared properly with return data type"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1481123354, "post_id": 41020851, "comment_id": 69248771, "body": "Have you tried to read the manual for the functions you are trying to use? It helps in most of the cases like this."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4780686"}, "edited": false, "score": 0, "creation_date": 1481123365, "post_id": 41020851, "comment_id": 69248778, "body": "I tried adding a <code>void</code> type to the function but I still get the same errors."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4780686"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1481123405, "post_id": 41020851, "comment_id": 69248802, "body": "@EugeneSh. Can you point me in the right direction to the manual?"}, {"owner": {"reputation": 86, "user_id": 6078437, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c445d61a467a9198039c66cf2fbaaff1?s=128&d=identicon&r=PG&f=1", "display_name": "scarecrow-", "link": "https://stackoverflow.com/users/6078437/scarecrow"}, "edited": false, "score": 0, "creation_date": 1481123417, "post_id": 41020851, "comment_id": 69248811, "body": "apparently signal takes 2 arguments and you&#39;re only supplying one"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4780686"}, "edited": false, "score": 0, "creation_date": 1481123465, "post_id": 41020851, "comment_id": 69248842, "body": "I have found that it is supposed to take a <code>sighandler</code> as a second parameter. I am unsure of what that means though."}, {"owner": {"reputation": 86, "user_id": 6078437, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c445d61a467a9198039c66cf2fbaaff1?s=128&d=identicon&r=PG&f=1", "display_name": "scarecrow-", "link": "https://stackoverflow.com/users/6078437/scarecrow"}, "edited": false, "score": 0, "creation_date": 1481123520, "post_id": 41020851, "comment_id": 69248872, "body": "take a look at the prototype definition and it will tell you what type the sighandler is supposed to be"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1481124235, "creation_date": 1481124235, "answer_id": 41021232, "question_id": 41020851, "link": "https://stackoverflow.com/questions/41020851/c-signal-has-too-few-arguments/41021232#41021232", "title": "C `signal` has too few arguments", "body": "<p>It appears that the <code>wait()</code> and <code>signal()</code> functions called by <code>Philosopher()</code> are like the <code>think()</code> and <code>eat()</code> functions -- intended to be provided by you (or else included with <code>Philosopher()</code>).  The name clash between those and two POSIX functions is unfortunate and confusing, but not meaningful.</p>\n\n<p><strong>Do not</strong> include <code>signal.h</code> or <code>sys/wait.h</code>.  Instead, provide declarations, by header file or otherwise, for <em>your</em> functions of those names, and make sure your implementations are linked into the executable.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4780686"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "accepted_answer_id": 41021232, "answer_count": 1, "score": 1, "last_activity_date": 1481124235, "creation_date": 1481123141, "last_edit_date": 1481123591, "question_id": 41020851, "link": "https://stackoverflow.com/questions/41020851/c-signal-has-too-few-arguments", "title": "C `signal` has too few arguments", "body": "<p>I am working on a problem where I am supposed to implement an example of the dining philosopher paradigm. <strong>Note</strong>: Yes this a homework assignment, before anyone asks.</p>\n\n<p>I am not asking for a solution though. I am confused because this <code>Philosopher</code> function that was supplied below by my teacher is theoretically supposed to work. <code>wait</code> and <code>signal</code> are the function used in C for OS system calls.</p>\n\n<p>I have included them using:</p>\n\n<pre><code>/* Wait and Signal */\n#include &lt;signal.h&gt;\n#include &lt;sys/wait.h&gt;\n\nstruct semaphore\n{\n    int count = 1;\n    struct PCB *Sem_Queue ;\n};\nstruct semaphore Forks[5];\n\nPhilosopher()\n{\n    i = getPID() ;\n    while (1)\n    {\n        think ();\n        wait (Forks[i]);\n        wait (Forks[(i+1) % 5]);\n        eat ();\n        signal (Forks[i]);\n        signal (Forks[(i + 1) % 5]);\n    }\n}\n</code></pre>\n\n<p>However, when compiled I get the error:</p>\n\n<pre><code>Main.c:38:19: error: too few arguments to function call, expected 2, have 1\n                signal (Forks[i]);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 834, "user_id": 7131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a1cf5eb86c98bcf94e80e722fff20e?s=128&d=identicon&r=PG&f=1", "display_name": "Fefux", "link": "https://stackoverflow.com/users/7131047/fefux"}, "edited": false, "score": 0, "creation_date": 1481123461, "post_id": 41020850, "comment_id": 69248840, "body": "I don&#39;t understand what do you want to do. Could you post a better example?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481123542, "post_id": 41020850, "comment_id": 69248886, "body": "What system are you running this on?"}, {"owner": {"reputation": 1215, "user_id": 6686454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56a060e2f62b3ebdca28de71f2c6ad78?s=128&d=identicon&r=PG&f=1", "display_name": "t.m.", "link": "https://stackoverflow.com/users/6686454/t-m"}, "edited": false, "score": 0, "creation_date": 1481123543, "post_id": 41020850, "comment_id": 69248890, "body": "int is not 8 bits, you can use unsigned char for 8 bits, even than outvalue won&#39;t print 5566"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1481123934, "post_id": 41020850, "comment_id": 69249187, "body": "What is your actual use case for this? In the example code currently given, you could just index the array directly without any cast or macro. If you want the <code>55</code> and <code>66</code> to occupy adjacent bytes in memory, the elements of <code>Array</code> (which should probably be called <code>array</code>) should be <code>uint8_t</code> instead of<code>int</code>, and then I see no reason why you are casting it to <code>volatile long *</code> in the macro (and it may not be correctly aligned for such a cast). Also, if <code>out_value</code> is <code>long</code>, the format should be <code>%ld</code>."}, {"owner": {"reputation": 834, "user_id": 7131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a1cf5eb86c98bcf94e80e722fff20e?s=128&d=identicon&r=PG&f=1", "display_name": "Fefux", "link": "https://stackoverflow.com/users/7131047/fefux"}, "edited": false, "score": 0, "creation_date": 1481123935, "post_id": 41020850, "comment_id": 69249188, "body": "Even if you want to read 8, 16 or 32 bit, an int value (which size is 32bit) =&lt; 255 return the same value."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1481124124, "post_id": 41020850, "comment_id": 69249341, "body": "You&#39;ll need to provide more information on what you&#39;re attempting to do.  If you&#39;re reading from hardware at a fixed address, you should declare a constant pointer of the appropriate type, e.g. <code>uint8_t *const status_register = 0xa0;</code> or similar."}, {"owner": {"reputation": 69, "user_id": 3544218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f9d83024ca3b8c12c3f2ce1717a0c693?s=128&d=identicon&r=PG&f=1", "display_name": "Gopi M", "link": "https://stackoverflow.com/users/3544218/gopi-m"}, "edited": false, "score": 0, "creation_date": 1481124813, "post_id": 41020850, "comment_id": 69249866, "body": "Actually i want store values in consecutive memory location as 123456 and need to access 8 bit as 56 and 16 bit as 3456 and 32 bit as 123456 in one shot. i think some how i clearly explain what it need .."}], "answers": [{"comments": [{"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1481134929, "post_id": 41021595, "comment_id": 69256373, "body": "MSVC won&#39;t optimize this, or at least I&#39;ve never seen it do so. Another reasonably portable approach would be to read the full native-width value, and then mask it off as appropriate to fit into a smaller type. <i>All</i> compilers are guaranteed to generate efficient code for that."}, {"owner": {"reputation": 4456, "user_id": 4127569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b728c7d6c1dce81f5a82249b7617756?s=128&d=identicon&r=PG&f=1", "display_name": "jch", "link": "https://stackoverflow.com/users/4127569/jch"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1481147784, "post_id": 41021595, "comment_id": 69263640, "body": "The question was about copying data from a smaller to a larger type."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1481189054, "post_id": 41021595, "comment_id": 69278941, "body": "I thought that was obvious. The compiler will do extension just fine for scalar types; this is well-defined behavior. There is only a problem if, as you mentioned, you try to cast between <i>pointer</i> types."}, {"owner": {"reputation": 69, "user_id": 3544218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f9d83024ca3b8c12c3f2ce1717a0c693?s=128&d=identicon&r=PG&f=1", "display_name": "Gopi M", "link": "https://stackoverflow.com/users/3544218/gopi-m"}, "edited": false, "score": 1, "creation_date": 1481197672, "post_id": 41021595, "comment_id": 69284675, "body": "Actually i am working with controller so i will copy the values from address of micro controller. can&#39;t use memcpy keyword. Please provide alternate solution of that."}], "tags": [], "owner": {"reputation": 4456, "user_id": 4127569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b728c7d6c1dce81f5a82249b7617756?s=128&d=identicon&r=PG&f=1", "display_name": "jch", "link": "https://stackoverflow.com/users/4127569/jch"}, "is_accepted": false, "score": 0, "last_activity_date": 1481125353, "creation_date": 1481125353, "answer_id": 41021595, "question_id": 41020850, "link": "https://stackoverflow.com/questions/41020850/read-8-bit-or-16-or-32-bit-from-address-in-c-language/41021595#41021595", "title": "Read 8 bit or 16 or 32 bit from address in C language", "body": "<p>Casting between pointer types is not portable, and will break horribly due to unaligned access or to compiler optimisations.  The (reasonably) portable way is to use memcpy:</p>\n\n<pre><code>unsigned int a[1000] = {...};\nunsigned long long x;\nmemcpy(&amp;x, &amp;a[57], sizeof(unsigned long long))\n</code></pre>\n\n<p>Don't worry about the extra function call \u2014 both gcc and clang will recognise this pattern and optimise the call to <code>memcpy</code> away.</p>\n"}, {"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1527256815, "creation_date": 1527256815, "answer_id": 50530918, "question_id": 41020850, "link": "https://stackoverflow.com/questions/41020850/read-8-bit-or-16-or-32-bit-from-address-in-c-language/50530918#50530918", "title": "Read 8 bit or 16 or 32 bit from address in C language", "body": "<p>Obviously what you were after wasn't meant to be portable. Your observations revealed that <code>int</code> and <code>long</code> have the same size (most probably 4 byte) in your environment, and are stored in little-endian byte order. You seem to think <code>sizeof(int)</code> were 2 when you define <code>int Array[2]</code>; if you want a data type with a certain size, you should use the standard types from <code>&lt;stdint.h&gt;</code>, for 16 bits this would be <code>int16_t</code> instead of <code>int</code>.</p>\n\n<blockquote>\n  <p>i want to print as 55 and also 5566</p>\n</blockquote>\n\n<p>If you read the two consecutive 16-bit words <code>(int16_t []){55, 66}</code> into a 32-bit <code>long</code> on your <em>controller</em>, the resulting value cannot be 5566, but rather 4325431 (55 + 66 \u00d7 0x10000). </p>\n"}], "owner": {"reputation": 69, "user_id": 3544218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f9d83024ca3b8c12c3f2ce1717a0c693?s=128&d=identicon&r=PG&f=1", "display_name": "Gopi M", "link": "https://stackoverflow.com/users/3544218/gopi-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 814, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1527256815, "creation_date": 1481123139, "question_id": 41020850, "link": "https://stackoverflow.com/questions/41020850/read-8-bit-or-16-or-32-bit-from-address-in-c-language", "title": "Read 8 bit or 16 or 32 bit from address in C language", "body": "<pre><code>#include &lt;stdio.h&gt;\n#define READ8(Address)  \\\n            (*((volatile long *)(Address)))\nint main()\n{\n   int Array[2]; \n   long out_value;\n   Array[0] = 55;\n   Array[1] = 66;\n   out_value = READ8(&amp;Array[0]);\n   printf(\"%d\\n\", out_value);\n}\n</code></pre>\n\n<p>I am trying to read 8 bit data, 16 bit data and 32 bit data and store in out_value variable. i am changing reading size of data type by changing the data type in Macro as int / long but every time out put is printed as 55 only.</p>\n\n<p>i want to print as 55 and also 5566.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1481122893, "post_id": 41020736, "comment_id": 69248488, "body": "A debugger is helpful here."}, {"owner": {"reputation": 21, "user_id": 7224932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GNrsN.png?s=128&g=1", "display_name": "daniel Graham", "link": "https://stackoverflow.com/users/7224932/daniel-graham"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481168575, "post_id": 41020736, "comment_id": 69270274, "body": "I tried using a debugger and I got this;                                                                                                        t1/../../../ is not an existing directory und// is not an existing directory t1/../.././ is not an existing directory  is not an existing directory //../../../ is not an existing directory //../../lib/ is not an existing directory Error while reading //../../vmlinuz //../../vmlinuz: Too many open files"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1527490983, "post_id": 41020736, "comment_id": 88132022, "body": "Missing POSIX or Linux tag. For example, on Windows, directories are handled differently."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 1, "last_activity_date": 1527490271, "creation_date": 1527490271, "answer_id": 50560633, "question_id": 41020736, "link": "https://stackoverflow.com/questions/41020736/a-c-program-that-copies-all-the-content-a-directory-including-files-and-folders/50560633#50560633", "title": "A C program that copies all the content a directory including files and folders", "body": "<p>You are indefinitely adding <code>/.</code> to the temporary source and destination paths when the directory entry <code>.</code> is read, which is present in all directories. Instead, you should skip the <code>.</code> and <code>..</code> entries.</p>\n\n<p>Another error is the dimensioning of the temporary paths:</p>\n\n<pre><code>  char tempsrc[strlen(srcpath)+1];\n  char tempdest[strlen(destpath)+1];\n</code></pre>\n\n<p>The arrays are made just long enough to hold the original paths, though sub-directory names are then appended, overflowing the arrays. Better:</p>\n\n<pre><code>  char tempsrc[PATH_MAX];\n  char tempdest[PATH_MAX];\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7224932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GNrsN.png?s=128&g=1", "display_name": "daniel Graham", "link": "https://stackoverflow.com/users/7224932/daniel-graham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527490271, "creation_date": 1481122797, "question_id": 41020736, "link": "https://stackoverflow.com/questions/41020736/a-c-program-that-copies-all-the-content-a-directory-including-files-and-folders", "title": "A C program that copies all the content a directory including files and folders", "body": "<p>The last Code I just posted now works. That is, it is able to copy all files from one directory to another. But now, I wanted to update it in such a way that it copies also directories including it contents be it files or folders.\nHere is what I did so far, but this has been unable to accomplish my dream.\nI really don't know what is wrong with the code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\n#define Max 8192\n\nint copy_files(char *src, char *dest);\nint copy_dir(char *srcpath, char *destpath);\n\nint copy_dir(char *srcpath, char *destpath)\n{\n  DIR *sdp = NULL;\n  DIR *ddp = NULL;\n  struct dirent *entry;\n  struct stat sb;\n\n  char tempsrc[strlen(srcpath)+1];\n  char tempdest[strlen(destpath)+1];\n\n  strcat(srcpath, \"/\");\n  strcat(destpath, \"/\");\n  strcpy(tempdest, destpath);\n  strcpy(tempsrc, srcpath);\n\n  if( (sdp = opendir(srcpath)) == NULL )\n  {\n    printf (\"%s is not an existing directory\\n\", srcpath);\n    return 0;\n  }\n  else\n  {\n    while( (entry = readdir(sdp)) )\n    {\n        stat(entry-&gt;d_name, &amp;sb);\n\n        //  printf(\"Cannot open directory\\n\");\n        //  exit(EXIT_FAILURE);\n\n\n        switch (sb.st_mode &amp; S_IFMT) \n        {\n            case S_IFREG:\n            {\n                strcat(tempdest, entry-&gt;d_name);\n                strcat(tempsrc, entry-&gt;d_name);\n\n                copy_files(tempsrc, tempdest);\n\n                strcpy(tempdest, destpath);\n                strcpy(tempsrc, srcpath);\n\n                break;\n            }\n            case S_IFDIR:\n            {\n                strcat(tempsrc, entry-&gt;d_name);         \n                strcat(tempdest, entry-&gt;d_name);\n                mkdir(tempdest, 0777);\n\n                ddp = opendir(tempdest);\n\n                copy_dir(tempsrc, tempdest);\n                strcpy(tempdest, destpath);\n                strcpy(tempsrc, srcpath);  \n\n                break;\n            }\n        }\n      }\n\n      closedir(sdp);\n      closedir(ddp);\n      return 1;\n  }\n}\n\nint copy_files(char *src, char *dest)\n{\n  int sfd, dfd, ret_in, ret_out;\n  char buff[Max];\n\n  if ( (sfd = open(src, O_RDONLY)) == -1 )\n  {\n    printf(\"Error while reading %s\\n\", src);\n    perror(src);\n    exit(1);\n  }\n\n  if ( (dfd = creat(dest, 0644)) == -1 )\n  {\n    printf(\"Error while creating %s\\n\", dest);\n    perror(dest);\n    exit(1);\n  }\n\n  while( (ret_in = read(sfd, &amp;buff, Max)) &gt; 0 )\n  {\n    ret_out = write (dfd, &amp;buff, ret_in);\n\n    if (ret_out != ret_in)\n    {\n        printf(\"write error to %s\", dest);\n        perror(dest);\n        exit(1);\n    }\n\n    if (ret_in == -1)\n    {\n        printf(\"read error from %s\", src);\n        perror(src);\n        exit(1);\n    }\n  }\n\n  close(sfd);\n  close(dfd);\n\n  return 1;\n}\n\nint main(int argc, char *argv[])\n{\n  int i; \n\n  if (argc != 3)\n  {\n    printf (\"Usage: Programme_name src dest\\n e.g. ./cp src dest\\n\");\n    exit(1);\n  }\n\n  char *srcp = argv[1];\n  char *destp = argv[2];\n\n  if (srcp[0] == '/' &amp;&amp; destp[0] == '/')\n  {\n\n    for (i = 1; i &lt;= strlen(destp); i++)\n        destp[(i-1)] = destp[i];\n\n    for (i = 1; i &lt;= strlen(srcp); i++)\n        srcp[(i-1)] = srcp[i];\n\n    copy_dir(srcp, destp);\n  }\n  else if (srcp[0] != '/' &amp;&amp; destp[0] == '/') //./ass1 test /t2\n  {\n    for (i = 1; i &lt;= strlen(destp); i++)\n        destp[i-1] = destp[i];\n\n    strcat(destp, \"/\");\n    strcat(destp, srcp);\n\n    copy_files(srcp, destp);\n  }\n  else \n  {\n    printf (\"Usage: Programme_name src dest\\n e.g. ./cp src dest\\n\");\n    exit(1);\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 3, "creation_date": 1481123153, "post_id": 41020720, "comment_id": 69248631, "body": "<code>(struct ListNode*)malloc(sizeof(struct ListNode*))</code> should be <code>malloc(sizeof(struct ListNode))</code>. You need to allocate enough space for a <code>ListNode</code>, not a pointer to one. And it&#39;s good style in C to omit casts for <code>malloc()</code>."}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1481146676, "post_id": 41020720, "comment_id": 69263070, "body": "If you want to be sure that both node exists, replace <code>while(p1 || p2)</code> by <code>while(p1 &amp;&amp; p2)</code> and after don&#39;t check if <code>(p1 != NULL)</code> or <code>(p2 != NULL)</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481164130, "post_id": 41020720, "comment_id": 69269075, "body": "Your list not NULL terminated. Also You have memory leak."}, {"owner": {"reputation": 11, "user_id": 7262883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p1P85.jpg?s=128&g=1", "display_name": "Henry Tsang", "link": "https://stackoverflow.com/users/7262883/henry-tsang"}, "edited": false, "score": 0, "creation_date": 1481170032, "post_id": 41020720, "comment_id": 69270614, "body": "So how to edit the code then?"}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1527493334, "creation_date": 1527493334, "answer_id": 50561426, "question_id": 41020720, "link": "https://stackoverflow.com/questions/41020720/add-two-numbers-using-linked-list/50561426#50561426", "title": "Add two numbers using linked list", "body": "<blockquote>\n  <p>So how to edit the code then?</p>\n</blockquote>\n\n<p>Exactly as John Kugelman wrote above:</p>\n\n<pre><code>    head = malloc(sizeof(struct ListNode));\n\u2026\n        nxt = malloc(sizeof(struct ListNode));\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7262883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p1P85.jpg?s=128&g=1", "display_name": "Henry Tsang", "link": "https://stackoverflow.com/users/7262883/henry-tsang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1513, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1527493334, "creation_date": 1481122767, "last_edit_date": 1592644375, "question_id": 41020720, "link": "https://stackoverflow.com/questions/41020720/add-two-numbers-using-linked-list", "title": "Add two numbers using linked list", "body": "<blockquote>\n<h3>2. Add Two Numbers</h3>\n<p>You are given two linked lists representing two non-negative numbers. The digits are stored in reverse order and each of their nodes contain a single digit. Add the two numbers and return it as a linked list.</p>\n<p>Input: <code>(2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)</code><br />\nOutput: <code>7 -&gt; 0 -&gt; 8</code></p>\n</blockquote>\n<p>I've finished the code for the second problem in Leetcode. When I submitted my answer, I bumped into a runtime error when the input is two zeros. But when I used my own custom Testcase, it worked seemingly quite well.</p>\n<p>I've checked my code really carefully, still can't find where the error is. Could you help me with that?</p>\n<pre><code>/**\n * Definition for singly-linked list.\n * struct ListNode {\n *     int val;\n *     struct ListNode *next;\n * };\n */\nstruct ListNode* addTwoNumbers(struct ListNode* l1, struct ListNode* l2) {\n    struct ListNode* p1;\n    struct ListNode* p2;\n    struct ListNode* head;\n    head = (struct ListNode*)malloc(sizeof(struct ListNode*));\n    struct ListNode* cur = head;\n    \n    p1 = l1; p2 = l2;\n    \n    int sum, carry = 0, x, y;\n    \n    while(p1 || p2)\n    {\n        //Assign the values of the listnode to x and y.\n        if(p1 != NULL) x = p1 -&gt; val; else x = 0;\n        if(p2 != NULL) y = p2 -&gt; val; else y = 0;\n        sum = x + y + carry;\n        \n        //Declare a new node nxt(next) and insert it after the current node\n        struct ListNode* nxt;\n        nxt = (struct ListNode*)malloc(sizeof(struct ListNode*));\n        nxt -&gt; val = sum % 10;\n        carry = sum / 10;\n        \n        cur -&gt; next = nxt;\n        cur = cur -&gt; next;\n        \n        if(p1 != NULL) p1 = p1 -&gt; next;\n        if(p2 != NULL) p2 = p2 -&gt; next;\n    }\n    \n    if(carry &gt; 0)\n    {\n        struct ListNode* nxt;\n        nxt = (struct ListNode*)malloc(sizeof(struct ListNode*));\n        nxt -&gt; val = carry;\n        cur -&gt; next = nxt;\n    }\n    \n    head = head -&gt; next;\n    \n    return head;\n}\n</code></pre>\n<p>The error:</p>\n<p><img src=\"https://i.stack.imgur.com/YaCHz.jpg\" alt=\"The error\" /></p>\n<p>Custom test case:</p>\n<p><img src=\"https://i.stack.imgur.com/cIajw.jpg\" alt=\"custom testcase\" /></p>\n"}, {"tags": ["c", "string", "loops", "ncurses"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1481122523, "post_id": 41020564, "comment_id": 69248258, "body": "Run it through a debugger."}, {"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 0, "creation_date": 1481122718, "post_id": 41020564, "comment_id": 69248375, "body": "If you could, remove all of the code that&#39;s not directly relevant. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. We don&#39;t need to see your full game. All we need is a short example program that doesn&#39;t work the way you expect it to. This is not only a guideline for posting to SO; narrowing down the problem area is also a good way to debug your code."}, {"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 0, "creation_date": 1481122768, "post_id": 41020564, "comment_id": 69248409, "body": "Also, please post the output you expect and the output you&#39;re actually getting."}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "edited": false, "score": 0, "creation_date": 1481123380, "post_id": 41020564, "comment_id": 69248790, "body": "Cursory inspection reveals to me that your printLog() is suspect. It prints the full contents of the queue without taking into consideration if a line was printed already or not. One way of dealing with this is to clear the queue at the end of printLog(). (There are, of course, many other ways of dealing with this.)"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4687210, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d550a494dc1b39e3c0bb8313a6fbd442?s=128&d=identicon&r=PG&f=1", "display_name": "Hstuart", "link": "https://stackoverflow.com/users/4687210/hstuart"}, "edited": false, "score": 0, "creation_date": 1481123992, "post_id": 41021049, "comment_id": 69249233, "body": "so, in effect, each keypress generates several values, several of which are rejected, and one of which is my actual keypress, and I only move on my actual keypress. However, the mob still moves even when the program is looping through with those rejected values, leading to the extra movement that we see above - seems to make sense. Do you have any recommendations or tips for how to reject the invalid commands?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 55, "user_id": 4687210, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d550a494dc1b39e3c0bb8313a6fbd442?s=128&d=identicon&r=PG&f=1", "display_name": "Hstuart", "link": "https://stackoverflow.com/users/4687210/hstuart"}, "edited": false, "score": 0, "creation_date": 1481125096, "post_id": 41021049, "comment_id": 69250053, "body": "@Hstuart, yes, you&#39;ve got it.  As for validating, I&#39;d consider using a function separate from <code>moveCreature()</code> to handle each command.  It might <i>call</i> <code>moveCreature()</code> when a valid movement command is entered, or do whatever is appropriate for other commands.  Its return value could convey information back to <code>main()</code>, including whether the mob gets to move."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1481125220, "post_id": 41021049, "comment_id": 69250159, "body": "You can get curses to handle the keyboard escape sequences for you."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481125244, "post_id": 41021049, "comment_id": 69250177, "body": "Note also that if you want to handle arrow keys in ncurses, then you probably ought to turn on ncurses&#39; <code>keypad</code> option via the like-named function.  That should make <code>getch()</code> return only one value for each arrow-key keypress, but those will be <i>different</i> values from the ones you get now.  See <code>getch()</code>&#39;s docs for more information."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1481123623, "creation_date": 1481123623, "answer_id": 41021049, "question_id": 41020564, "link": "https://stackoverflow.com/questions/41020564/function-is-being-called-four-times-per-loop-when-there-are-only-two-calls-to-it/41021049#41021049", "title": "Function is being called four times per loop when there are only two calls to it", "body": "<p>Your problem is at the input stage.  You expect directional commands via the arrow keys, but those generate multiple bytes per keypress.  All but one are invalid as commands.</p>\n\n<p>As a secondary problem, you do not reject invalid commands.  You go ahead and move the mob after each command character read, whether that command was valid or not.</p>\n\n<p>The overall upshot is that when you press an arrow key, the program zips through three iterations of the main loop, one right after the other, producing log messages for one valid player move, no log messages for two invalid player moves, and log messages for each of three mob moves.</p>\n\n<p>You could have detected this by logging invalid commands, or by running your program in a debugger.</p>\n"}], "owner": {"reputation": 55, "user_id": 4687210, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d550a494dc1b39e3c0bb8313a6fbd442?s=128&d=identicon&r=PG&f=1", "display_name": "Hstuart", "link": "https://stackoverflow.com/users/4687210/hstuart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 41021049, "answer_count": 1, "score": 0, "last_activity_date": 1481123623, "creation_date": 1481122322, "last_edit_date": 1481122388, "question_id": 41020564, "link": "https://stackoverflow.com/questions/41020564/function-is-being-called-four-times-per-loop-when-there-are-only-two-calls-to-it", "title": "Function is being called four times per loop when there are only two calls to it", "body": "<p>I'm very new to programming in C, and have pretty rusty programming skills overall. In order to learn C and re-orient myself with programming in general, I'm challenging myself to try and make a simple rougelike using ncurses.</p>\n\n<p>I've set up a \"log\", which I should be able to push messages to - the most recent 10 message should be displayed. In order to test this, I've made it so each time either the player or the very simple randomly-moving mob takes a step, a log message is pushed saying \"step [direction]\". However, even though they each only take one step, for some reason, four messages are pushed to the log. The second-to-most-recent one is always the actual direction the character moved, and I presume one of the other two is the mob moving, but I don't know the origin of the other two. Does anyone spot anything glaring in my code that might be causing this issue? All help is appreciated, thanks!</p>\n\n<p>(I believe the only major relevant sections to look at should be the <code>main()</code> function, <code>pushToLog()</code>, <code>printLog()</code>, and <code>moveCreature()</code>. That said, there is a chance the problem might be somewhere else. I'm not sure.)</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;ncurses.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\n#define up 65\n#define down 66\n#define right 67\n#define left 68\n#define quit 113\n\nstruct creature {\n  int x;\n  int y;\n  int hp;\n  int maxhp;\n};\n\nvoid setupMap();\nstruct creature setupCreature();\nvoid moveCreature();\nvoid pushToLog();\nvoid printLog();\n\nint breakFlag = FALSE;\n\nchar mapShape[15][15];\nchar mapFeatures[15][15];\nchar outputLog[10][60];\n\nint main(int argc, char *argv[]){\n  struct creature player = setupCreature(4, 4, 100, 100);\n  struct creature mob = setupCreature(5, 7, 100, 100);\n  setupMap();\n  initscr();\n  noecho();\n  curs_set(FALSE);\n\n  while(1){\n    for (int i = 0; i &lt; 15; i++){\n      for (int c = 0; c &lt; 15; c++){\n        mvprintw(c, i, \"%c\", mapShape[i][c]);\n      }\n    }\n    mvprintw(player.y, player.x, \"%c\", '@');\n    mvprintw(mob.y, mob.x, \"%c\", 'd');\n    printLog();\n\n    int input = getch();\n    moveCreature(input, &amp;player);\n\n    int mobDir = rand() % (68 + 1 - 65) + 65;\n    moveCreature(mobDir, &amp;mob);\n\n    refresh();\n    usleep(300);\n\n    if (breakFlag == TRUE){\n      break;\n    }\n  }\n\n  endwin();\n  return 0;\n}\n\n\nvoid moveCreature(int dir, struct creature *subject){\n  int next;\n\n  if (dir == up){\n    next = (subject-&gt;y - 1);\n    if (mapShape[subject-&gt;x][next] != '#'){\n      subject-&gt;y = next;\n      pushToLog(\"step up     \");\n    }\n  }\n  else if (dir == down){\n    next = (subject-&gt;y + 1);\n    if (mapShape[subject-&gt;x][next] != '#'){\n     subject-&gt;y = next;\n     pushToLog(\"step down     \");\n    }\n  }\n  else if (dir == right){\n    next =  (subject-&gt;x + 1);\n    if (mapShape[next][subject-&gt;y] != '#'){\n      subject-&gt;x = next;\n      pushToLog(\"step right     \");\n    }\n  }\n  else if (dir == left){\n    next =  (subject-&gt;x - 1);\n    if (mapShape[next][subject-&gt;y] != '#'){\n      subject-&gt;x = next;\n      pushToLog(\"step left     \");\n    }\n  }\n\n  else if (dir == quit){\n    breakFlag = TRUE;\n  }\n\n}\n\nvoid pushToLog(char string[]){\n  for (int i = 10; i &gt; 0; i--){\n    strcpy(outputLog[i], outputLog[i-1]);\n  }\n  strcpy(outputLog[0], string);\n}\n\nvoid printLog(){\n  for (int i = 0; i &lt; 10; i++){\n    mvprintw(28-i, 0, outputLog[i]);\n  }\n}\n\n\nstruct creature setupCreature(int x,int y,int hp,int maxhp){\n\n  struct creature frankenstien;\n\n  frankenstien.x = x;\n  frankenstien.y = y;\n  frankenstien.hp = hp;\n  frankenstien.maxhp = maxhp;\n\n  return frankenstien;\n}\n\n\nvoid setupMap(){\n  for (int i = 0; i &lt; 15; i++){\n    for (int c = 0; c &lt; 15; c++){\n      mapShape[i][c] = '.';\n    }\n  }\n  for (int i = 0; i &lt; 15; i++){\n    mapShape[0][i] = '#';\n    mapShape[14][i] = '#';\n    mapShape[i][0] = '#';\n    mapShape[i][14] = '#';\n  }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1481122523, "post_id": 41020513, "comment_id": 69248257, "body": "Stepping through this code with a debugger should show you what&#39;s going on. This really very simple."}, {"owner": {"reputation": 155, "user_id": 7261924, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/tvHRe.jpg?s=128&g=1", "display_name": "chatay", "link": "https://stackoverflow.com/users/7261924/chatay"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1481123254, "post_id": 41020513, "comment_id": 69248702, "body": "@George **** is a mistake, don t take them into account."}, {"owner": {"reputation": 155, "user_id": 7261924, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/tvHRe.jpg?s=128&g=1", "display_name": "chatay", "link": "https://stackoverflow.com/users/7261924/chatay"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481123447, "post_id": 41020513, "comment_id": 69248829, "body": "@MichaelWalz I see the result when debug the program however it s been 2 months I ve started programming so I am trying to grasp the logic of it."}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 7256251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e79d6cfad4d0a8c8b1ed61f4dcf8e16?s=128&d=identicon&r=PG&f=1", "display_name": "dbmongo", "link": "https://stackoverflow.com/users/7256251/dbmongo"}, "is_accepted": false, "score": 0, "last_activity_date": 1481123008, "creation_date": 1481123008, "answer_id": 41020806, "question_id": 41020513, "link": "https://stackoverflow.com/questions/41020513/how-does-the-recursion-work-in-this-number-reversal-program/41020806#41020806", "title": "How does the recursion work in this number reversal program?", "body": "<p>The function does always call itself with the parameter startSubscript +1 until the startSubscript is equal then SIZE. Then the function call with the highest number, means this one with size == startsubscript will end. From there on the function call will process to an end in a backwards way. backwards means with a (last in first out logic). </p>\n\n<p>Hint: Alway reproduce recursions with small numbers to see whats going on</p>\n"}, {"tags": [], "owner": {"reputation": 1136, "user_id": 6063698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1K6L.jpg?s=128&g=1", "display_name": "Igbaryya", "link": "https://stackoverflow.com/users/6063698/igbaryya"}, "is_accepted": false, "score": 1, "last_activity_date": 1481124103, "creation_date": 1481124103, "answer_id": 41021176, "question_id": 41020513, "link": "https://stackoverflow.com/questions/41020513/how-does-the-recursion-work-in-this-number-reversal-program/41021176#41021176", "title": "How does the recursion work in this number reversal program?", "body": "<p>It will re-call the function until the <code>startSubscript</code> variable will be greater than the <code>size</code> variable then we can say that the index is on the last value on the <code>a</code> Array and then it will back to the first call (Which we were on the 0 index). </p>\n\n<p><p> Calls: </p>\n\n<pre><code>Call #   |       Function call       | Return  | Outputs  \n1          someFunction( a, 0, 10 )      -         -\n2          someFunction( a, 1, 10 )      -         -\n3          someFunction( a, 2, 10 )      -         -\n4          someFunction( a, 3, 10 )      -         -\n5          someFunction( a, 4, 10 )      -         -\n6          someFunction( a, 5, 10 )      -         -\n7          someFunction( a, 6, 10 )      -         -\n8          someFunction( a, 7, 10 )      -         -\n9          someFunction( a, 8, 10 )      -         -\n10         someFunction( a, 9, 10 )      -         -\n11         someFunction( a, 10, 10)      -         -\n</code></pre>\n\n<p>10 &lt; 10 ? <strong>False</strong> Here we stop the recursive calls and we back again to the first call that was called from the main. : \n<p> As we can see that every time we was re-calling the <code>someFunction</code> there was  <code>printf( \"%d \", b[ startSubscript ] );</code> That we could not get to it because of the recursive. </p>\n\n<p>Backing : </p>\n\n<pre><code>Call #   |       Function call       | Return  | Outputs (a[startSubscript]) \n10         someFunction( a, 9, 10 )      -         5 \n9          someFunction( a, 8, 10 )      -         4\n8          someFunction( a, 7, 10 )      -         7\n7          someFunction( a, 6, 10 )      -         9\n6          someFunction( a, 5, 10 )      -         0\n5          someFunction( a, 4, 10 )      -         6\n4          someFunction( a, 3, 10 )      -         2\n3          someFunction( a, 2, 10 )      -         1\n2          someFunction( a, 1, 10 )      -         3\n1          someFunction( a, 0, 10 )      -         8\n</code></pre>\n\n<p>No we can see the array has been \"Reversed\"</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 7217171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sqDmx.jpg?s=128&g=1", "display_name": "Evangelos Bampas", "link": "https://stackoverflow.com/users/7217171/evangelos-bampas"}, "is_accepted": false, "score": 0, "last_activity_date": 1481126120, "creation_date": 1481126120, "answer_id": 41021857, "question_id": 41020513, "link": "https://stackoverflow.com/questions/41020513/how-does-the-recursion-work-in-this-number-reversal-program/41021857#41021857", "title": "How does the recursion work in this number reversal program?", "body": "<p>One way to display an array in reverse order is the following:</p>\n\n<ul>\n<li>First, display in reverse order the sub-array consisting of all elements except the first one.</li>\n<li>Then, display the first element.</li>\n</ul>\n\n<p>The first bullet is implemented recursively. The recursion ends when the size of the array is 0, in which case you do nothing.</p>\n\n<p>This is exactly what the function someFunction does.</p>\n"}], "owner": {"reputation": 155, "user_id": 7261924, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/tvHRe.jpg?s=128&g=1", "display_name": "chatay", "link": "https://stackoverflow.com/users/7261924/chatay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1481217650, "creation_date": 1481122205, "last_edit_date": 1481217650, "question_id": 41020513, "link": "https://stackoverflow.com/questions/41020513/how-does-the-recursion-work-in-this-number-reversal-program", "title": "How does the recursion work in this number reversal program?", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\n#include&lt;math.h&gt;\n\n// ex06_18.c\n// What does this program do?\n\n#define SIZE 10\n\n// function prototype\nvoid someFunction( const int b[], size_t startSubscript, size_t size );\n\n// function main begins program execution\nint main( void )\n{\n    int a[ SIZE ] = { 8, 3, 1, 2, 6, 0, 9, 7, 4, 5 }; // initialize a\n\n    puts( \"Answer is:\" );\n    someFunction( a, 0, SIZE );\n    puts( \"\" );\n\n    _sleep(1000*100);\n\n} // end main\n\n// What does this function do?\nvoid someFunction( const int b[], size_t startSubscript, size_t size )\n{\n    if ( startSubscript &lt; size ) \n    {\n        someFunction( b, startSubscript + 1, size );\n\n        printf( \"%d \", b[ startSubscript ] );\n    } // end if\n} // end function someFunction\n</code></pre>\n\n<p><code>someFunction( b, startSubscript + 1, size )</code> - can you explain this part please? I debugged it but it is hard to understand how does the recursive part process?</p>\n"}, {"tags": ["c", "cross-compiling", "libjson"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7262762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272eccbf4fb184fcdf34a1bc57dfa8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Gunasekaran", "link": "https://stackoverflow.com/users/7262762/vignesh-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1481121489, "post_id": 41020088, "comment_id": 69247522, "body": "Then how do I avoid appending -Werror in the makfiles CFLAGS. Because on ./configure it generates a makefile with -Werror appended with it"}], "tags": [], "owner": {"reputation": 834, "user_id": 7131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a1cf5eb86c98bcf94e80e722fff20e?s=128&d=identicon&r=PG&f=1", "display_name": "Fefux", "link": "https://stackoverflow.com/users/7131047/fefux"}, "is_accepted": false, "score": 2, "last_activity_date": 1481121107, "creation_date": 1481121107, "answer_id": 41020088, "question_id": 41019792, "link": "https://stackoverflow.com/questions/41019792/cross-compiling-libjson-c-make-unsuccessful-in-libjson-c-linkhash-c-warning/41020088#41020088", "title": "Cross compiling libjson-c : Make unsuccessful in libjson-c, Linkhash.c warning", "body": "<p><code>cc1: all warnings being treated as errors</code></p>\n\n<p>Sure, find where <code>-Werror</code> is set and remove that flag. Then warnings will be only warnings.</p>\n"}], "owner": {"reputation": 11, "user_id": 7262762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272eccbf4fb184fcdf34a1bc57dfa8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Gunasekaran", "link": "https://stackoverflow.com/users/7262762/vignesh-gunasekaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527493909, "creation_date": 1481120387, "last_edit_date": 1527493909, "question_id": 41019792, "link": "https://stackoverflow.com/questions/41019792/cross-compiling-libjson-c-make-unsuccessful-in-libjson-c-linkhash-c-warning", "title": "Cross compiling libjson-c : Make unsuccessful in libjson-c, Linkhash.c warning", "body": "<p>Should I add any flags to avoid this?</p>\n\n<pre>\nmake  all-recursive\nmake[1]: Entering directory '/home/local/ZOHOCORP/vignesh-4691/Downloads/json-c-master'\nMaking all in .\nmake[2]: Entering directory '/home/local/ZOHOCORP/vignesh-4691/Downloads/json-c-master'\n  CC       linkhash.lo\nlinkhash.c: In function 'lh_char_hash':\nlinkhash.c:480:2: error: #warning \"racy random seed initializtion if used by multiple threads\" [-Werror=cpp]\n #warning \"racy random seed initializtion if used by multiple threads\"\n  ^\ncc1: all warnings being treated as errors\nMakefile:585: recipe for target 'linkhash.lo' failed\nmake[2]: *** [linkhash.lo] Error 1\nmake[2]: Leaving directory '/home/local/ZOHOCORP/vignesh-4691/Downloads/json-c-master'\nMakefile:649: recipe for target 'all-recursive' failed\nmake[1]: *** [all-recursive] Error 1\nmake[1]: Leaving directory '/home/local/ZOHOCORP/vignesh-4691/Downloads/json-c-master'\nMakefile:448: recipe for target 'all' failed\nmake: *** [all] Error 2\n</pre>\n"}, {"tags": ["c", "unicode", "nlp", "embedded", "glyphicons"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1481121277, "post_id": 41019547, "comment_id": 69247361, "body": "probably you can find tools that make the job for you. Tools that can convert a standard font (ttf ...) to your required type. I this tools does not exist, better to develop it by yourself."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1481151698, "post_id": 41019547, "comment_id": 69265334, "body": "The use of an STM32 and a GLCD is entirely irellevant but it is the only technical information you have provided.  What is probably more important is the identity of the font rendering or graphics library you are using to render the characters, and what font technoloyy/format is being used."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1481152000, "post_id": 41019547, "comment_id": 69265467, "body": "&quot;exhaustive list&quot;?  Did you mean &quot;extensive list&quot;?  &quot;exhaustive&quot; probably does not mean what you intended. (<a href=\"https://www.google.com/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=define%20%22exhaustive%22\" rel=\"nofollow noreferrer\">definition</a>).  If you truely had an &quot;exhaustive&quot; i.e. &quot;complete&quot; list, there would be no problem."}, {"owner": {"reputation": 21, "user_id": 7262540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176c856950b3d8a3f22292edf51cd3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Hemanth Boddu", "link": "https://stackoverflow.com/users/7262540/hemanth-boddu"}, "edited": false, "score": 0, "creation_date": 1481176537, "post_id": 41019547, "comment_id": 69272634, "body": "I&#39;m using a using a GLCD font creation software [link] ( <a href=\"http://www.mikroe.com/glcd-font-creator/\" rel=\"nofollow noreferrer\">mikroe.com/glcd-font-creator</a> ) where you can create custom fonts and export them as C library. I mentioned STM32 and GLCD coz my objective was not to print it to a console. And sorry it&#39;s an extensive list not exhaustive list"}, {"owner": {"reputation": 2030, "user_id": 550235, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/934de7ad57af9a8f6a37e0c78017f942?s=128&d=identicon&r=PG", "display_name": "Russ Schultz", "link": "https://stackoverflow.com/users/550235/russ-schultz"}, "edited": false, "score": 0, "creation_date": 1481214270, "post_id": 41019547, "comment_id": 69295939, "body": "My guess is the library you&#39;re using doesn&#39;t support combining characters, so you&#39;ll have to do that yourself prior to feeding it to the library.  It probably just tries to find a glyph for each each unicode character you pass it, and prints out one for one.   if there aren&#39;t THAT many combos, it might not be too hard or too large to write the preprocessor."}, {"owner": {"reputation": 21, "user_id": 7262540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176c856950b3d8a3f22292edf51cd3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Hemanth Boddu", "link": "https://stackoverflow.com/users/7262540/hemanth-boddu"}, "edited": false, "score": 0, "creation_date": 1481349334, "post_id": 41019547, "comment_id": 69351997, "body": "I found a way to use ttf files to display the ligatures, diacritics etc. emWin offers a library to do that. ttf files already have the &#39;mort&#39; and &#39;morx&#39; tables (<a href=\"https://developer.apple.com/fonts/TrueType-Reference-Manual/RM06/Chap6mort.html\" rel=\"nofollow noreferrer\">developer.apple.com/fonts/TrueType-Reference-Manual/RM06/&hellip;</a>) which take care of different combinations of the glyphs depending on the context."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7262540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176c856950b3d8a3f22292edf51cd3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Hemanth Boddu", "link": "https://stackoverflow.com/users/7262540/hemanth-boddu"}, "edited": false, "score": 1, "creation_date": 1481182749, "post_id": 41020581, "comment_id": 69275596, "body": "Yeah, exactly! If it was a big one instead of STM32, I could directly use .ttf files (each one approx. 70KB). But now I have to create glyphs for all possible combination cases. The link was very useful in increasing my understanding on what these font files do, thank you."}], "tags": [], "owner": {"reputation": 1826, "user_id": 4389432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RcLKe.png?s=128&g=1", "display_name": "Paulo Soares", "link": "https://stackoverflow.com/users/4389432/paulo-soares"}, "is_accepted": false, "score": 1, "last_activity_date": 1481122364, "creation_date": 1481122364, "answer_id": 41020581, "question_id": 41019547, "link": "https://stackoverflow.com/questions/41019547/how-to-display-indic-languages-on-glcd/41020581#41020581", "title": "How to display Indic languages on GLCD", "body": "<p>You'll have to do so some work and I'm not even sure that the code will fit in a stm32, maybe a big one, perhaps. Have a look at <a href=\"https://www.freedesktop.org/wiki/Software/HarfBuzz/\" rel=\"nofollow noreferrer\">https://www.freedesktop.org/wiki/Software/HarfBuzz/</a>, it's a text shaper for many languages including indic ones.</p>\n"}], "owner": {"reputation": 21, "user_id": 7262540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176c856950b3d8a3f22292edf51cd3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Hemanth Boddu", "link": "https://stackoverflow.com/users/7262540/hemanth-boddu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1481219402, "creation_date": 1481119695, "last_edit_date": 1481205310, "question_id": 41019547, "link": "https://stackoverflow.com/questions/41019547/how-to-display-indic-languages-on-glcd", "title": "How to display Indic languages on GLCD", "body": "<p>I have a file which is read by STM32 and it displays the contents on a GLCD. </p>\n\n<p>It displays the glyphs of the unicode stream even when there are combining characters (e.g. \u0915 + \u094d + \u0924 = \u0915\u094d\u0924 ). Here it displays \u0915 \u094d \u0924 instead of \u0915\u094d\u0924. </p>\n\n<p>I have done some reading on this and found that every font uses a character mapping( cmap table ) to map character encoding ( e.g. Unicode) with the glyphs. I tried writing a cmap table in C for devanagari but it was an extensive list . Is there any logic I'm missing here which will simplify my cmap table or my objective to map unicodes to the glyphs? </p>\n"}, {"tags": ["c", "libev"], "answers": [{"comments": [{"owner": {"reputation": 3372, "user_id": 762649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21acc9d59af609a140703b8c2c2aca1?s=128&d=identicon&r=PG", "display_name": "sunil", "link": "https://stackoverflow.com/users/762649/sunil"}, "edited": false, "score": 1, "creation_date": 1512366843, "post_id": 41020699, "comment_id": 82212238, "body": "Thanks. This helped me. I was behind timers causing high CPU. But this solved my issue. I was setting both EV_READ and EV_WRITE for new socket."}], "tags": [], "owner": {"reputation": 3883, "user_id": 530424, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/Xv2CA.jpg?s=128&g=1", "display_name": "elhadi dp \u0131p\u0250\u0265\u05df\u01dd", "link": "https://stackoverflow.com/users/530424/elhadi-dp-%c4%b1p%c9%90%c9%a5%d7%9f%c7%9d"}, "is_accepted": false, "score": 4, "last_activity_date": 1481122706, "creation_date": 1481122706, "answer_id": 41020699, "question_id": 41019277, "link": "https://stackoverflow.com/questions/41019277/100-cpu-usage-with-libev/41020699#41020699", "title": "100% CPU usage with libev", "body": "<p>I've found a solution, For those who are interested in this question:</p>\n\n<p>when accepting a new socket, do not <strong>call ev_io_init</strong> with <strong>EV_WRITE</strong>, call it only with EV_READ.</p>\n\n<pre><code>ev_io_init(&amp;conn-&gt;io, tcp_conn_on_event_cb, conn-&gt;fd, EV_READ);\n</code></pre>\n\n<p>in the callback, if you have a data to write (to the socket), you can use <strong>ev_feed_fd_event</strong></p>\n\n<pre><code>static void tcp_conn_on_event_cb(ev_loop_t *loop, ev_io *ev, int revents)\n{\n      ....\n\n    if (revents | EV_WRITE) {\n         /* write your data here */\n    }\n\n    if (data_is_ready()) {\n        ev_feed_fd_event(loop, conn-&gt;fd, EV_WRITE | revents);\n        return;\n    }\n\n    /* do other job */\n}\n</code></pre>\n"}], "owner": {"reputation": 3883, "user_id": 530424, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/Xv2CA.jpg?s=128&g=1", "display_name": "elhadi dp \u0131p\u0250\u0265\u05df\u01dd", "link": "https://stackoverflow.com/users/530424/elhadi-dp-%c4%b1p%c9%90%c9%a5%d7%9f%c7%9d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1481122706, "creation_date": 1481118860, "question_id": 41019277, "link": "https://stackoverflow.com/questions/41019277/100-cpu-usage-with-libev", "title": "100% CPU usage with libev", "body": "<p>I have a tcp server which uses libev as an event loop; for new accepted sockets\ni set:</p>\n\n<pre><code> ev_io_init(&amp;conn-&gt;io, tcp_conn_on_event_cb, conn-&gt;fd, EV_READ | EV_WRITE);\n</code></pre>\n\n<p>when a new connection is comming, my server consumes whole the CPU cycles, i have 100% CPU usage. my program calls all the time the callback <strong>tcp_conn_on_event_cb</strong> with revents set as EV_WRITE</p>\n\n<pre><code>static void tcp_conn_on_event_cb(ev_loop_t *loop, ev_io *ev, int revents)\n</code></pre>\n\n<p>when i make </p>\n\n<pre><code>strace mybinary\n</code></pre>\n\n<p>i've this:</p>\n\n<pre><code>epoll_wait(4, {{EPOLLOUT, {u32=7, u64=4294967303}}}, 64, 59743) = 1\nepoll_wait(4, {{EPOLLOUT, {u32=7, u64=4294967303}}}, 64, 59743) = 1\nepoll_wait(4, {{EPOLLOUT, {u32=7, u64=4294967303}}}, 64, 59743) = 1\nepoll_wait(4, {{EPOLLOUT, {u32=7, u64=4294967303}}}, 64, 59743) = 1\nepoll_wait(4, {{EPOLLOUT, {u32=7, u64=4294967303}}}, 64, 59743) = 1\nepoll_wait(4, {{EPOLLOUT, {u32=7, u64=4294967303}}}, 64, 59743) = 1\nepoll_wait(4, {{EPOLLOUT, {u32=7, u64=4294967303}}}, 64, 59743) = 1\n                           ....\n</code></pre>\n\n<p>is there a solution fo this problem please?</p>\n"}, {"tags": ["c", "arrays", "string", "scanf"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1481118901, "post_id": 41019229, "comment_id": 69245674, "body": "When you use <code>getchar</code> to search for the ending parentheses, you <i>extract</i> the characters from the input buffer and lose them. Also remember that the arguments for <code>scanf</code> needs to be <i>pointers</i>."}, {"owner": {"reputation": 33, "user_id": 5838575, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7a1babaa8b61bbed7127062160b5267?s=128&d=identicon&r=PG&f=1", "display_name": "Pernick", "link": "https://stackoverflow.com/users/5838575/pernick"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1481119125, "post_id": 41019229, "comment_id": 69245824, "body": "So if I ask if c = getchar() is not &#39;)&#39; I can no longer scan it after?"}, {"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "edited": false, "score": 0, "creation_date": 1481119196, "post_id": 41019229, "comment_id": 69245876, "body": "You are losing characters for using <code>getchar</code>. You have to use that <code>c</code> (variable) into which you have <code>getchar()</code>-ed within <code>while</code> body."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1481119577, "post_id": 41019229, "comment_id": 69246135, "body": "Possible duplicate <a href=\"http://stackoverflow.com/questions/2082743/c-equivalent-to-fstreams-peek\" title=\"c equivalent to fstreams peek\">stackoverflow.com/questions/2082743/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 5838575, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7a1babaa8b61bbed7127062160b5267?s=128&d=identicon&r=PG&f=1", "display_name": "Pernick", "link": "https://stackoverflow.com/users/5838575/pernick"}, "edited": false, "score": 0, "creation_date": 1481120308, "post_id": 41019229, "comment_id": 69246642, "body": "It gives me segmentation fault when I try to do that. Is there a way I can store those numbers somehow and then create dynamically allocated array based on how many numbers I have?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1481164497, "post_id": 41019229, "comment_id": 69269176, "body": "<code>scanf(&quot;%d&quot;, weights[pos]);</code> --&gt; <code>scanf(&quot;%d&quot;, &amp;weights[pos]);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2388, "user_id": 348637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Vmm7D.jpg?s=128&g=1", "display_name": "Abhinav Upadhyay", "link": "https://stackoverflow.com/users/348637/abhinav-upadhyay"}, "is_accepted": false, "score": 0, "last_activity_date": 1481125470, "last_edit_date": 1481125470, "creation_date": 1481124480, "answer_id": 41021312, "question_id": 41019229, "link": "https://stackoverflow.com/questions/41019229/scanf-for-reading-string-and-int-array-in-brackets/41021312#41021312", "title": "Scanf for reading string and int array in brackets", "body": "<p>I think it would be simpler to read the complete line from stdin and then parse it by hand using <code>strtok</code> or <code>strcspn</code>. Something like below could be done. </p>\n\n<p><strong>Disclaimer</strong>: This is just some sample code and doesn't handle all possible inputs and will crash with invalid input, it is just to give you an idea about how to do it. If you want to go this way, you would have to handle various error conditions, such as:</p>\n\n<ul>\n<li>checking return value of <code>malloc</code>/<code>getline</code>/<code>realloc</code></li>\n<li>instead of <code>atoi</code> using a better function like <code>strtol</code> (which allows error checking),</li>\n<li>handling white spaces in the input and</li>\n<li>handling input which does not contain any parenthesis</li>\n</ul>\n\n<p>Those are some of the many things which you would have to think about.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstatic int *parse_numbers(char *numstr, size_t *size)\n{\n    char *p;\n    char *s = numstr;\n    char *last;\n    size_t array_size = 10;\n    int *numbers = malloc(sizeof(int) * array_size);\n    size_t offset = 0;\n    for (p = strtok_r(s, \",\", &amp;last); p; p = strtok_r(NULL, \",\", &amp;last)) {\n        if (offset == array_size) {\n            array_size *= 2;\n            numbers = realloc(numbers, sizeof(int) * array_size);\n            //TODO do error check\n        }\n        numbers[offset++] = atoi(p); //strtol would be a better choice\n    }\n    *size = offset;\n    return numbers;\n}\n\nint main()\n{\n    char *s = NULL;\n    char *p;\n    char *last;\n    int i = 0;\n    int *numbers;\n    size_t size;\n    size_t linesize = 0;\n\n    getline(&amp;s, &amp;linesize, stdin);\n    for (p = strtok_r(s, \"(\", &amp;last); p; p = strtok_r(NULL, \"(\", &amp;last)) {\n        if (i++ == 0) {\n            //This is the part of the string before '('\n            cmd = p;\n        } else {\n            // This is the part of the string after '('\n            numbers = parse_numbers(p, &amp;size);\n        }\n    }\n    for (i = 0; i &lt; size; i++) {\n        printf(\"%d\\n\", numbers[i]);\n    }\n    free(numbers);\n    free(s);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1481135743, "last_edit_date": 1481135743, "creation_date": 1481133770, "answer_id": 41024294, "question_id": 41019229, "link": "https://stackoverflow.com/questions/41019229/scanf-for-reading-string-and-int-array-in-brackets/41024294#41024294", "title": "Scanf for reading string and int array in brackets", "body": "<p>Separate input from parsing.  Far easier to handle the various issues of command processing. Concerning \"don't know how many numbers will be inputed\", IMO, a reasonable upper bound should be established.  Else code is susceptible to overwhelming memory resources due to user input - a hacker exploit.</p>\n\n<pre><code>char command[1000];\nwhile (fgets(command, sizeof command, stdin)) {\n</code></pre>\n\n<p>Now process the command using <code>sscanf()</code>, <code>strtok()</code> or your own code.  The best method depends on maybe things not posted by OP, especially error handling.</p>\n\n<pre><code>    int cmd_start;\n    int cmd_end;\n    int n = 0;\n    // sacrifice (1, 2, 4, 2, ...)\n    //               +----------------- skip optional white space\n    //               |+---------------- record scan position \n    //               || +-------------- scan, but not save, lower case letters\n    //               || |      +------- record scan position \n    //               || |      | +----- skip optional white space\n    //               || |      | |+---- scan (\n    //               || |      | ||+--- skip optional white space\n    //               || |      | |||+-- record scan position \n    sscanf(command, \" %n%*[a-z]%n ( %n\", &amp;cmd_start, &amp;cmd_end, &amp;n);\n    if (n == 0) {\n      printf(\"Invalid command '%s'\\n\", command);\n      continue;\n    }\n    int x[sizeof command / 2];\n    int x_count = 0;\n    char *p = &amp;command[n];  // pick up where previous scan ended.\n\n    char sep[2] = {0};\n    while (sscanf(p, \"%d %1[,)] %n\", &amp;x[x_count], sep, &amp;n) == 2) {\n      x_count++;\n      p += n;\n      if (sep[0] == ')') break;\n    }\n\n    if (*p || sep[0] != ')') {\n      printf(\"Invalid separator '%s'\\n\", command);\n      continue;\n    }\n\n    // Use command \n    command[cmd_end] = '\\0';\n    Process_Command(&amp;command[cmd_start], x, x_count);\n  }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1526372627, "creation_date": 1526372627, "answer_id": 50345543, "question_id": 41019229, "link": "https://stackoverflow.com/questions/41019229/scanf-for-reading-string-and-int-array-in-brackets/50345543#50345543", "title": "Scanf for reading string and int array in brackets", "body": "<blockquote>\n  <p><code>scanf(\"%d\", weights[pos]);</code> --> <code>scanf(\"%d\", &amp;weights[pos]);</code> \u2013 BLUEPIXY</p>\n</blockquote>\n\n<p>That's indeed adequate to make the code work, provided a sufficiently dimensioned <code>weights</code> array.</p>\n"}], "owner": {"reputation": 33, "user_id": 5838575, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7a1babaa8b61bbed7127062160b5267?s=128&d=identicon&r=PG&f=1", "display_name": "Pernick", "link": "https://stackoverflow.com/users/5838575/pernick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1394, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1526372627, "creation_date": 1481118733, "question_id": 41019229, "link": "https://stackoverflow.com/questions/41019229/scanf-for-reading-string-and-int-array-in-brackets", "title": "Scanf for reading string and int array in brackets", "body": "<p>I've been trying to come up with solution for reading input which contains string and then brackets with array of numbers (I don't know how many numbers will be inputed.</p>\n\n<p>Input could look like:</p>\n\n<pre><code>sacrifice (1, 2, 4, 2)\n</code></pre>\n\n<p>I am wondering if it is possible to achieve with scanf. I've been looking for different functions such as getline, sscanf, fgets and so on. But I couldn't come up with solution.</p>\n\n<p>My code looks like this:</p>\n\n<pre><code>    scanf(\"%[^(]\", command);\n    while ( ( c = getchar() ) != ')' )\n    {\n        scanf(\"%d\", weights[pos]);\n        pos++;\n    }\n</code></pre>\n\n<p>Which should read string until the bracket is found and then I tried to load the numbers in array as long as it doesn't reach the ')'. Yet it doesn't seem to work.</p>\n\n<p><strong>Is scanf viable to achieve this? Could anyone point me in better direction if not please?</strong></p>\n"}, {"tags": ["c", "tree", "binary-tree"], "comments": [{"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "edited": false, "score": 3, "creation_date": 1481118397, "post_id": 41019084, "comment_id": 69245349, "body": "Try to avoid native language in code segments. It loses readability. P.S. - I like French though."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481118703, "post_id": 41019084, "comment_id": 69245540, "body": "The first alternative of your <code>Ajouter()</code> function appears to do the same thing as <code>NouvelArbreVide()</code>, except <code>NouvelArbreVide()</code> does it better by accounting for memory allocation failures.  Why not just call <code>NouvelArbreVide()</code> instead of duplicating it?"}, {"owner": {"reputation": 71, "user_id": 7231480, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/91348ab660b7bcca80facfdf0fcf3d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher M.", "link": "https://stackoverflow.com/users/7231480/christopher-m"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481118946, "post_id": 41019084, "comment_id": 69245701, "body": "@JohnBollinger thank you for the advice. But in my post I am just wondering how to just add an element to the left of the tree for now"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1481119273, "post_id": 41019084, "comment_id": 69245935, "body": "The error is probably in the code that calls these functions. Could you please provide it? As for <code>NouvelArbreVide</code>, I think it would be best to remove it and have <code>Ajouter</code> insert the root, which is possible if you initialise your empty tree to <code>NULL</code>."}, {"owner": {"reputation": 71, "user_id": 7231480, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/91348ab660b7bcca80facfdf0fcf3d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher M.", "link": "https://stackoverflow.com/users/7231480/christopher-m"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1481119404, "post_id": 41019084, "comment_id": 69246022, "body": "@MOehm that is the problem; I did it that way because I want to initialise the tree root to a value and not NULL.Edited the post with the function call"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481119414, "post_id": 41019084, "comment_id": 69246030, "body": "You should not hide pointer nature behind a typedef, as you presently do with type <code>arbre_binaire</code>.  It is usually more confusing than helpful."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1481119599, "post_id": 41019084, "comment_id": 69246153, "body": "@ChristopherM., you seem to be missing MOehm&#39;s point about <code>NouvelArbreVide()</code>.  It is approximately the same as my earlier comment about code duplication, only he recommends de-duplicating by removing <code>NouvelArbreVide()</code> instead of by making <code>Ajouter()</code> call it."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1481119636, "post_id": 41019084, "comment_id": 69246187, "body": "Thanks for adding the code, but when I requested the calling code, I thought about having some context, too: How do you construct the tree from scractch, i.e. please show everything from <code>arbre_binaire arbre</code> up to the call of <code>AjouterGauche</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 4, "creation_date": 1481119685, "post_id": 41019084, "comment_id": 69246222, "body": "... In other words, we need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to sort this out."}, {"owner": {"reputation": 71, "user_id": 7231480, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/91348ab660b7bcca80facfdf0fcf3d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher M.", "link": "https://stackoverflow.com/users/7231480/christopher-m"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1481119791, "post_id": 41019084, "comment_id": 69246295, "body": "@MOehm the tree is created with arbre_binaire NouvelArbreVide(int value_root)  and I add elements to it with void Ajouter( arbre_binaire* arbre , int val ). Also edited the post with more codes I dont know what else I can add"}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1481120215, "post_id": 41019084, "comment_id": 69246581, "body": "it&#39;s called a <i>leaf</i>............"}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 1, "creation_date": 1481120304, "post_id": 41019084, "comment_id": 69246637, "body": "gdb or valgrind will show you why you crash"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1481120617, "post_id": 41019084, "comment_id": 69246869, "body": "I cannot reproduce the error. You should run the program in a debugger to see where the crash happens exactly and which of the dereferenced pointers is invalid."}, {"owner": {"reputation": 71, "user_id": 7231480, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/91348ab660b7bcca80facfdf0fcf3d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher M.", "link": "https://stackoverflow.com/users/7231480/christopher-m"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1481121422, "post_id": 41019084, "comment_id": 69247480, "body": "@MOehm I just noticed something.the errors not always happen.It happen if I initialise the tree,then right after call the <code>void AjouterGauche(arbre_binaire *arbre, int val)</code>it does crash. But if I initialise the tree, then add an element with <code>void Ajouter(arbre_binaire *arbre, int val)</code> , and then call the <code>void AjouterGauche(arbre_binaire *arbre, int val)</code>, it will work"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1481121429, "post_id": 41019084, "comment_id": 69247485, "body": "Peux-tu utiliser l&#39;anglais pour les identificateurs dans ton programme? Ce m&#233;lange de fran&#231;ais sans accents et de mots-cl&#233;s anglais est d&#233;j&#224; indigeste pour un adepte de la langue de Moli&#232;re, il rend le code incompr&#233;hensible pour les nombreux lecteurs du monde entier sur Stack-overflow qui font l&#39;effort d&#39;intervenir en anglais."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1481121705, "post_id": 41019084, "comment_id": 69247690, "body": "Aha! By &quot;initialise&quot;, do you mean a call to <code>NouvelArbreVide</code> or do you mean something like <code>arbre = NULL</code>? Your function <code>AjouterGauche</code> will not work for a root node that is <code>NULL</code>, but your function <code>Ajouter</code> will."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1481121760, "post_id": 41019084, "comment_id": 69247729, "body": "La plupart utilisent l&#39;anglais, mais je pense que ce n&#39;est pas la langue maternelle de la majorit&#233; d&#39;entre eux. Cette discussion est d&#39;ailleurs tr&#232;s p&#233;nible pour eux.  You seem to master English quite well, use English for the identifiers in your code too, it will make it much more readable to everyone here."}, {"owner": {"reputation": 71, "user_id": 7231480, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/91348ab660b7bcca80facfdf0fcf3d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher M.", "link": "https://stackoverflow.com/users/7231480/christopher-m"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1481121806, "post_id": 41019084, "comment_id": 69247756, "body": "@MOehm by initialise I mean a call to  <code>arbre = NouvelArbreVide(3);</code>"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1481122034, "post_id": 41019084, "comment_id": 69247923, "body": "Hmmm. Unless the returned value is <code>NULL</code>, which isn&#39;t very likely (but you can check), I don&#39;t see how that could happen."}, {"owner": {"reputation": 71, "user_id": 7231480, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/91348ab660b7bcca80facfdf0fcf3d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher M.", "link": "https://stackoverflow.com/users/7231480/christopher-m"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1481122300, "post_id": 41019084, "comment_id": 69248117, "body": "@MOehm I just tried something else; I initialised the tree then added all these value: 2, 567, 34253. Then I called AjouterGauche wich worked.I then added 12 and 40, then I tried to add value 0 and it crashed.. Im lost."}, {"owner": {"reputation": 71, "user_id": 7231480, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/91348ab660b7bcca80facfdf0fcf3d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher M.", "link": "https://stackoverflow.com/users/7231480/christopher-m"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1481122574, "post_id": 41019084, "comment_id": 69248290, "body": "@MOehm it seems that the problems is when trying to add a value afterwards calling AjouterGauche and  that is inferior to the value I added using AjouterGauche, it crash"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1481123208, "post_id": 41019084, "comment_id": 69248671, "body": "I can&#39;t really see that happening either. The <code>-&gt;gauche</code> of all new nodes is <code>NULL</code> and <code>AjouterGauche</code> only goes left on the first node, By creating the tree with a root value, that should be safe. I think you really need to look into this in detail with a debugger."}, {"owner": {"reputation": 71, "user_id": 7231480, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/91348ab660b7bcca80facfdf0fcf3d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher M.", "link": "https://stackoverflow.com/users/7231480/christopher-m"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1481123625, "post_id": 41019084, "comment_id": 69248952, "body": "@MOehm ok, and also I have a function the display the entire binary tree,and as soon I previously called the AjouterGauche function, the display function will not work.I will add this function to the post so you can see"}, {"owner": {"reputation": 71, "user_id": 7231480, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/91348ab660b7bcca80facfdf0fcf3d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher M.", "link": "https://stackoverflow.com/users/7231480/christopher-m"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1481124463, "post_id": 41019084, "comment_id": 69249607, "body": "@chqrlie there the post has been edited and converted to english"}, {"owner": {"reputation": 286969, "user_id": 541136, "user_type": "moderator", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/wftMn.jpg?s=128&g=1", "display_name": "Aaron Hall", "link": "https://stackoverflow.com/users/541136/aaron-hall"}, "edited": false, "score": 0, "creation_date": 1481297885, "post_id": 41019084, "comment_id": 69334789, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/130235/discussion-on-question-by-christopher-m-add-a-left-leaf-to-binary-tree-in-c\">moved to chat</a>."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1526375638, "post_id": 41019084, "comment_id": 87708501, "body": "Please <a href=\"https://stackoverflow.com/posts/41019084/edit\">edit</a> your question to show us what kind of debugging you&#39;ve done.  I expect you to have run your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> within Valgrind or a similar checker, and to have investigated with a debugger such as GDB, for example.  Ensure you&#39;ve enabled a full set of compiler warnings, too.  What did the tools tell you, and what information are they missing?  And read Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}], "owner": {"reputation": 71, "user_id": 7231480, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/91348ab660b7bcca80facfdf0fcf3d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher M.", "link": "https://stackoverflow.com/users/7231480/christopher-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 456, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1481124690, "creation_date": 1481118244, "last_edit_date": 1481124399, "question_id": 41019084, "link": "https://stackoverflow.com/questions/41019084/add-a-left-leaf-to-binary-tree-in-c", "title": "Add a left &quot;leaf&quot; to binary tree in C", "body": "<p>I am learning the C language and trying to build a C binary tree library. My structure is defined as:</p>\n\n<pre><code>struct Node {\n    int value;\n    struct Node *left;\n    struct Node *right;\n};\n\ntypedef struct Node TNode;\ntypedef struct Node *binary_tree;\n</code></pre>\n\n<p>It is created like this:</p>\n\n<pre><code>binary_tree NewBinaryTree(int value_root) {\n    binary_tree newRoot = malloc(sizeof(TNode));\n    if (newRoot) {\n        newRoot-&gt;value = value_root;\n        newRoot-&gt;left = NULL;\n        newRoot-&gt;right = NULL;\n    }\n    return newRoot;\n}\n</code></pre>\n\n<p>I add elements to it like:</p>\n\n<pre><code>void Insert(binary_tree *tree, int val) {\n    if (*tree == NULL) {\n        *tree = (binary_tree)malloc(sizeof(TNode));\n        (*tree)-&gt;value = val;\n        (*tree)-&gt;left = NULL;\n        (*tree)-&gt;right = NULL;\n    } else {\n        if (val &lt; (*tree)-&gt;value) {\n            Insert(&amp;(*tree)-&gt;left, val);\n        } else {\n            Insert(&amp;(*tree)-&gt;right, val);\n        }\n    }\n}\n</code></pre>\n\n<p>This kinda \"sort\" the tree by checking the value.However I would like a function that simply add the val value to the left(left) without doing any sorting. I did:</p>\n\n<pre><code>void InsertLeft(binary_tree *tree, int val) {\n     Insert(&amp;(*tree)-&gt;left, val);\n}\n</code></pre>\n\n<p>I call the function like this:</p>\n\n<pre><code>InsertLeft(&amp;tree, 8);\n</code></pre>\n\n<p>I have a main program that initialise the tree like this:</p>\n\n<pre><code>  tree = NewBinaryTree(3);\n</code></pre>\n\n<p>Also a tree display method:</p>\n\n<pre><code>void display_binary_tree( binary_tree tree )\n{\n    if( tree != NULL )\n    {\n        display_binary_tree( tree-&gt;left ) ;\n        printf( \"%d \" , tree-&gt;value ) ;\n        display_binary_tree( tree-&gt;right ) ;\n    }\n}\n</code></pre>\n\n<p>and afterwards I can add elements by calling the <code>Insert(binary_tree *tree, int val)</code> function,  however when calling this function, it just crashes the program. I dont understand why.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7262397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faff13f2aa699e79ec864353f893ddb7?s=128&d=identicon&r=PG&f=1", "display_name": "Crocboss", "link": "https://stackoverflow.com/users/7262397/crocboss"}, "edited": false, "score": 0, "creation_date": 1481119103, "post_id": 41019184, "comment_id": 69245813, "body": "I tried that but that cant be the solution. In the main header file <code>squash.h</code> are a lot more headers that are included like the <code>hedley.h</code> so i would have to rename 10+ header files in the <code>squash.h</code> file. I doubt thats the intended way to make the library work."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1481121031, "post_id": 41019184, "comment_id": 69247189, "body": "You can tell your compiler to add the path to the squash-includes to its default include paths."}, {"owner": {"reputation": 5198, "user_id": 186580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51af0a007f1bdc7134c0f02d3a156abb?s=128&d=identicon&r=PG", "display_name": "Oleksandr Kravchuk", "link": "https://stackoverflow.com/users/186580/oleksandr-kravchuk"}, "reply_to_user": {"reputation": 3, "user_id": 7262397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faff13f2aa699e79ec864353f893ddb7?s=128&d=identicon&r=PG&f=1", "display_name": "Crocboss", "link": "https://stackoverflow.com/users/7262397/crocboss"}, "edited": false, "score": 0, "creation_date": 1481122422, "post_id": 41019184, "comment_id": 69248190, "body": "@Crocboss see edit: you can make your compiler look for header files in squash-0.8/squash/ as Paul has pointed out."}, {"owner": {"reputation": 3, "user_id": 7262397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faff13f2aa699e79ec864353f893ddb7?s=128&d=identicon&r=PG&f=1", "display_name": "Crocboss", "link": "https://stackoverflow.com/users/7262397/crocboss"}, "edited": false, "score": 0, "creation_date": 1481125171, "post_id": 41019184, "comment_id": 69250119, "body": "Yes, thank you very much. I copied the <code>squash</code> directory from the repository, which includes the <code>squash.h</code> and all other necessary headers like <code>hedley&#47;hedley.h</code>, into a <code>lib&#47;</code> directory in my project and ran the compiler with <code>-Ilib -rdynamic lib&#47;squash&#47;libsquash0.8.so.0.8</code> and it works!"}], "tags": [], "owner": {"reputation": 5198, "user_id": 186580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51af0a007f1bdc7134c0f02d3a156abb?s=128&d=identicon&r=PG", "display_name": "Oleksandr Kravchuk", "link": "https://stackoverflow.com/users/186580/oleksandr-kravchuk"}, "is_accepted": true, "score": 1, "last_activity_date": 1481122340, "last_edit_date": 1481122340, "creation_date": 1481118599, "answer_id": 41019184, "question_id": 41019045, "link": "https://stackoverflow.com/questions/41019045/c-how-to-include-the-squash-compression-library/41019184#41019184", "title": "C: How to include the squash compression library?", "body": "<p>Try to change</p>\n\n<pre><code>#include &lt;squash/squash.h&gt; \n</code></pre>\n\n<p>to</p>\n\n<pre><code>#include \"squash/hedley/hedley.h\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>#include \"&lt;squash-0.8/squash/hedley/hedley.h&gt;\"\n</code></pre>\n\n<p>easier and faster solution would be adding the path to your includes during compilation:</p>\n\n<pre><code>-I/usr/local/include/squash-0.8/squash/\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7262397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faff13f2aa699e79ec864353f893ddb7?s=128&d=identicon&r=PG&f=1", "display_name": "Crocboss", "link": "https://stackoverflow.com/users/7262397/crocboss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 41019184, "answer_count": 1, "score": 0, "last_activity_date": 1537347105, "creation_date": 1481118126, "question_id": 41019045, "link": "https://stackoverflow.com/questions/41019045/c-how-to-include-the-squash-compression-library", "title": "C: How to include the squash compression library?", "body": "<p>I'm fairly new to programming with c and i am having a hard time including the <a href=\"https://github.com/quixdb/squash\" rel=\"nofollow noreferrer\">squash</a> library into my program.</p>\n\n<p>I cloned the repository and ran <code>./configure</code> and <code>make</code> <code>sudo make install</code>.</p>\n\n<p>That installed the files:</p>\n\n<pre><code>/usr/local/lib/pkgconfig/squash-0.8.pc\n/usr/local/lib/libsquash0.8.so.0.8\n/usr/local/lib/libsquash0.8.so.0.8.0\n/usr/local/lib/libsquash0.8.so\n/usr/local/lib/cmake/Squash-0.8.0/SquashConfig.cmake\n/usr/local/bin/squash\n</code></pre>\n\n<p>And some more files in this directories:</p>\n\n<pre><code>/usr/local/include/squash-0.8/\n/usr/local/lib/squash/0.8/plugins/\n</code></pre>\n\n<p>In the squash examples the library is included by <code>#include &lt;squash/squash.h&gt;</code> but when i am trying to compile it i get <code>fatal error: squash/squash.h: No such file or directory</code></p>\n\n<p>Also <code>#include &lt;squash-0.8/squash.h&gt;</code> doesnt work because then i get <code>fatal error: hedley/hedley.h: No such file or directory</code> That file is located at \n<code>/usr/local/include/squash-0.8/squash/hedley/hedley.h</code></p>\n\n<p>I guess the solution is pretty simple for an experienced c programmer but i am failing here..</p>\n\n<p>Do i need to set some sort of environment variable to let the compiler find the library? </p>\n\n<p>And how do i link the library to the compiler anyway? \nI found something like:</p>\n\n<p><code>-rdynamic ../squash/libsquash0.8.so.0.8</code> but could not test it yet because of the error above.</p>\n"}, {"tags": ["c", "linux-kernel", "operating-system", "firewall", "netfilter"], "comments": [{"owner": {"reputation": 1195, "user_id": 1865106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/15dc57110dac17f6bae8187c8a405b11?s=128&d=identicon&r=PG&f=1", "display_name": "SSC", "link": "https://stackoverflow.com/users/1865106/ssc"}, "edited": false, "score": 0, "creation_date": 1481120654, "post_id": 41019027, "comment_id": 69246901, "body": "I think you are looking for <code>iptables</code> instead of using <code>libnetfilter</code> or <code>libiptc</code> as the maintainer of <code>netfilter</code> has mentioned the API are not stable <a href=\"http://www.netfilter.org/documentation/FAQ/netfilter-faq-4.html#ss4.5\" rel=\"nofollow noreferrer\">reference</a>.  However, if you want to use <code>libiptc</code> directly, you can read <a href=\"https://bani.com.br/2012/05/programmatically-managing-iptables-rules-in-c-iptc/\" rel=\"nofollow noreferrer\">this tutorial</a>"}, {"owner": {"reputation": 3, "user_id": 7261874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47dbc2b3cfd038b39390150301a9a37a?s=128&d=identicon&r=PG&f=1", "display_name": "Hardil", "link": "https://stackoverflow.com/users/7261874/hardil"}, "reply_to_user": {"reputation": 1195, "user_id": 1865106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/15dc57110dac17f6bae8187c8a405b11?s=128&d=identicon&r=PG&f=1", "display_name": "SSC", "link": "https://stackoverflow.com/users/1865106/ssc"}, "edited": false, "score": 0, "creation_date": 1481120711, "post_id": 41019027, "comment_id": 69246954, "body": "I want to code in C rather then using Command of Iptable. Is it possible to code iptable? @SSC"}, {"owner": {"reputation": 1195, "user_id": 1865106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/15dc57110dac17f6bae8187c8a405b11?s=128&d=identicon&r=PG&f=1", "display_name": "SSC", "link": "https://stackoverflow.com/users/1865106/ssc"}, "edited": false, "score": 0, "creation_date": 1481120800, "post_id": 41019027, "comment_id": 69247013, "body": "You can read the <a href=\"https://bani.com.br/2012/05/programmatically-managing-iptables-rules-in-c-iptc/\" rel=\"nofollow noreferrer\">tutorial</a> or just google <code>libiptc</code> for more information."}, {"owner": {"reputation": 3, "user_id": 7261874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47dbc2b3cfd038b39390150301a9a37a?s=128&d=identicon&r=PG&f=1", "display_name": "Hardil", "link": "https://stackoverflow.com/users/7261874/hardil"}, "reply_to_user": {"reputation": 1195, "user_id": 1865106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/15dc57110dac17f6bae8187c8a405b11?s=128&d=identicon&r=PG&f=1", "display_name": "SSC", "link": "https://stackoverflow.com/users/1865106/ssc"}, "edited": false, "score": 0, "creation_date": 1481121337, "post_id": 41019027, "comment_id": 69247412, "body": "@SSC libiptc/libiptc.h: No such file or directory that&#39;s what i am getting while compiling"}, {"owner": {"reputation": 1195, "user_id": 1865106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/15dc57110dac17f6bae8187c8a405b11?s=128&d=identicon&r=PG&f=1", "display_name": "SSC", "link": "https://stackoverflow.com/users/1865106/ssc"}, "edited": false, "score": 1, "creation_date": 1481122218, "post_id": 41019027, "comment_id": 69248067, "body": "I am not sure what linux distro you are using.  So I don&#39;t why you cannot find <code>libiptc.h</code>.  In Debian/Ubuntu, it is included in the <code>iptables-dev</code> package.  After the package is installed, it is in <code>&#47;usr&#47;include&#47;libiptc&#47;</code>."}], "owner": {"reputation": 3, "user_id": 7261874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47dbc2b3cfd038b39390150301a9a37a?s=128&d=identicon&r=PG&f=1", "display_name": "Hardil", "link": "https://stackoverflow.com/users/7261874/hardil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481118074, "creation_date": 1481118074, "question_id": 41019027, "link": "https://stackoverflow.com/questions/41019027/resolving-firewall-after-packet-capture", "title": "Resolving Firewall after Packet Capture", "body": "<p>I am stuck up a bit while writing a C Program, I am using <code>lpcap</code>and sockets for sniffing traffic and currently i am storing it in a text file.\nThe second thing i want to do is make a firewall to block a specific port. Now, i came across a <code>netfilter</code> Library which works at Kernel space. But the problem is most of my code of Sniffing is currently running in User-Space. I compile my code of sniffer using <code>gcc</code> as this sniffer is in user-space. Now, After including trying to implement netfilter for firewall on the same code. It doesn't work as it's a kernel space code. \nThe firewall code needs a make file to implement.\nand the sniffer is compiled using gcc\nNow, How can i mitigate this. i.e. combine both of the things into a single program space.</p>\n"}, {"tags": ["c", "arm", "portability", "arm64"], "comments": [{"owner": {"reputation": 5988, "user_id": 1989995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6513dc6e38a1f5e1da198fda245b055?s=128&d=identicon&r=PG", "display_name": "alexeykuzmin0", "link": "https://stackoverflow.com/users/1989995/alexeykuzmin0"}, "edited": false, "score": 1, "creation_date": 1481117150, "post_id": 41018680, "comment_id": 69244372, "body": "Probably you should use some fixed-width types instead of <code>unsigned</code> and <code>unsigned long</code>"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1481117259, "post_id": 41018680, "comment_id": 69244449, "body": "Is this C or C++?   Two different languages with two different solutions."}, {"owner": {"reputation": 1851, "user_id": 226342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/17c6ed9982d27d297a4d7976c3936811?s=128&d=identicon&r=PG", "display_name": "Henrik", "link": "https://stackoverflow.com/users/226342/henrik"}, "edited": false, "score": 0, "creation_date": 1481117384, "post_id": 41018680, "comment_id": 69244548, "body": "Removed C++ tag"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481117545, "post_id": 41018680, "comment_id": 69244689, "body": "There is no problem with <code>1ULL &lt;&lt; (n)</code>. But your question suggests your code has a separate problem: that there are instances where you are storing a 16-bit set of flags (via <code>unsigned int</code>) , but then you try to access more than 16 flags within that unit.  To solve this problem you should use fixed-width types for your flag sets, and make sure the <code>1</code> in <code>BIT</code> is as least as big a type as the largest flag set"}, {"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1481117566, "post_id": 41018680, "comment_id": 69244706, "body": "What exactly is the issue with using unsigned long? I can understand a 16-bit architecture not handling &gt;=32-bit values efficiently, much like the long long case on 32-bit machines, but if you need to shift a value beyond the range of an int it&#39;s not like you have much of a choice."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1481117960, "post_id": 41018680, "comment_id": 69245014, "body": "The macro definition will not give this error. You apparently use a bit &gt; 15. Any reason you try to use a bit which apparently does not exist in your architecture? What is that supposed to do? Without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> it is hard to tell, but from experience, I can say your code is broken."}, {"owner": {"reputation": 1851, "user_id": 226342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/17c6ed9982d27d297a4d7976c3936811?s=128&d=identicon&r=PG", "display_name": "Henrik", "link": "https://stackoverflow.com/users/226342/henrik"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481119243, "post_id": 41018680, "comment_id": 69245907, "body": "@Olaf, I am asking about the portability of my BIT macro and U,UL,ULL. It is not related to any broken code  as it works fine for my ARCHX by using UL in the bit macro when doing 32-bit operations (then there&#39;s a discussion if I should use a BIT macro or not but we can take that later... :-)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481129147, "post_id": 41018680, "comment_id": 69252904, "body": "@Henrik: The code relies on implementation details which are not guaranteed by the standard, nor by all targeted architectures. So yes, it <b>is</b> broken! Note that neither <code>int</code> nor <code>unsigned long</code> are guaranteed to have 32 bits. The latter is just guaranteed to have a <b>range</b> which requires <b>at least</b> 32 bits. Note that the problem is not the BIT-macro on ARCHX, but the value of <code>n</code> and whatever type your variable is! As I wrote, you should comply to site-rules and provide all required information!"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481118078, "post_id": 41018851, "comment_id": 69245112, "body": "Don&#39;t use hand-crafted stuff where the standard already provides (better) solutions."}], "tags": [], "owner": {"reputation": 585, "user_id": 3897125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd88edbc10bf1d18cbb9c5a66df389f?s=128&d=identicon&r=PG&f=1", "display_name": "koper89", "link": "https://stackoverflow.com/users/3897125/koper89"}, "is_accepted": false, "score": 0, "last_activity_date": 1481117593, "creation_date": 1481117593, "answer_id": 41018851, "question_id": 41018680, "link": "https://stackoverflow.com/questions/41018680/portable-bit-macro-in-c/41018851#41018851", "title": "Portable BIT macro in C", "body": "<p>You could solve the issue by config define for different platform.\nLet's say</p>\n\n<pre><code>#ifdef SYSTEM_A\n#define BIT_BASE_VALUE 0x1U\n#else\n#ifdef SYSTEM_B\n#define BIT_BASE_VALUE 0x1UL\n#endif\n#endif\n\n#define BIT(n) (BIT_BASE_VALUE &lt;&lt; (n))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481117880, "post_id": 41018931, "comment_id": 69244955, "body": "Will have problem when <code>n &gt;= 32</code>"}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481118437, "post_id": 41018931, "comment_id": 69245372, "body": "Trying to portably represent <code>n&gt;=32</code> is not possible.  If it is an issue, the macro can range check the argument and throw a build error.  If this is a concern the OP needs <code>BIT16()</code>, <code>BIT32()</code> type macros as his one target CPU is 16 bit <code>int</code> based."}], "tags": [], "owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "is_accepted": false, "score": 1, "last_activity_date": 1481118081, "last_edit_date": 1481118081, "creation_date": 1481117795, "answer_id": 41018931, "question_id": 41018680, "link": "https://stackoverflow.com/questions/41018680/portable-bit-macro-in-c/41018931#41018931", "title": "Portable BIT macro in C", "body": "<p>The <code>UINT32_C</code> macro can be used to make a portable unsigned 32 bit constant.</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#define BIT(n) (UINT32_C(1) &lt;&lt; (n))    \nint main(void)\n{\n    return BIT(10);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481118008, "post_id": 41018951, "comment_id": 69245050, "body": "<code>x |= 1 &lt;&lt; n</code> is bugged though.  Correctness &gt; clarity.  IMO <code>BIT(n)</code> is clearer than having casts (or UINT32_C) or suffixes littered throughout the code. That&#39;s a maintenance nightmare if something needs to change."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481118155, "post_id": 41018951, "comment_id": 69245182, "body": "&quot;is fully portable to any known computer.&quot; - unless it does not support 32 bit integers. But that would generate a compile-time error, which is acceptable."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481118223, "post_id": 41018951, "comment_id": 69245228, "body": "@M.M It is not less bugged than <code>#define BIT (1 &lt;&lt; (n))</code>. Obviously you shouldn&#39;t use signed type literals to perform bit-wise arithmetic (ill edit...). Thats why an explicit cast is excellent practice: it says: &quot;the programmer has given thought to both implicit type promotion and signedness, this code was written by a veteran&quot;. Makes the reader relax."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481118254, "post_id": 41018951, "comment_id": 69245239, "body": "@Olaf Which known computer did you have in mind when you made that comment?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481118460, "post_id": 41018951, "comment_id": 69245388, "body": "@Lundin: I thought about 9/18 bit architectures, but primarily I had some 24 bit DSPs in mind. But as I wrote: if you target architectures which support 32 bit integers, the approach is fine. Focus should be the compiler definitively will catch errors and that&#39;s true here."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481118546, "post_id": 41018951, "comment_id": 69245445, "body": "@Olaf Anyone grabbing mainstream C code and try to use it on wildly obscure DSPs deserve all the problems they can get. Similarly, anyone spending time making their mainstream C code portable to such systems is wasting everyone&#39;s time."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481118676, "post_id": 41018951, "comment_id": 69245523, "body": "@Lundin: I wouldn&#39;t call 24 bit DSPs and the other archs &quot;obscure&quot;. After all, the C language has been designed to support a wide variety of archs and 8 bit/byte is not &quot;&lt;insert your prefered divine entity&gt; given&quot;. And I don&#39;t think OP just grabbed maistream C code, but wrote it himself (or from a co-worker)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481118762, "post_id": 41018951, "comment_id": 69245586, "body": "@Olaf The problem is rather that those DSPs in turn were not designed with C in mind. If they had anything at all in their minds when they designed them, it was assembler."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481118886, "post_id": 41018951, "comment_id": 69245664, "body": "I agree about that. But it does not change my objection. Why not simply restrict the statement to the archs OP asks for, which apparently <b>do</b> support 32 bit integers, thus shall provide <code>uint32_t</code>?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481118972, "post_id": 41018951, "comment_id": 69245719, "body": "@Lundin I guess we differ,  most of the time when I&#39;m browsing code and see casts everywhere, I do not assume it was written thoughtfully by a veteran!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481119477, "post_id": 41018951, "comment_id": 69246075, "body": "@M.M Naive beginner code: <code>char data; x = data &lt;&lt; n;</code>. This code is has around 3-4 severe bugs. Professional code written by a veteran: <code>uint8_t data; x = (uint32_t)data &lt;&lt; n;</code> Or pedantically, code with no implicit conversions present at all: <code>x = (uint8_t)((uint32_t)data &lt;&lt; n);</code>. Although evil-looking, this is how you write robust, portable code."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481119654, "post_id": 41018951, "comment_id": 69246198, "body": "Though of course there are naive beginner mistakes caused by casting too, such as the rather classic overflow bug <code>uint32_t x = (uint32_t)(u16 + u16);</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1481119664, "post_id": 41018951, "comment_id": 69246206, "body": "That doesn&#39;t imply that any code with a cast is robust and portable"}, {"owner": {"reputation": 1851, "user_id": 226342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/17c6ed9982d27d297a4d7976c3936811?s=128&d=identicon&r=PG", "display_name": "Henrik", "link": "https://stackoverflow.com/users/226342/henrik"}, "edited": false, "score": 0, "creation_date": 1481120174, "post_id": 41018951, "comment_id": 69246550, "body": "@Lundin I&#39;m not using &quot;mainstream&quot; C code on the architectures, rather a barebone C test SW. In my opinion, making the C test SW code portable to run on both ARM32/64 and the 16-bit DSP architectures, help me create better, cleaner, decoupled and more portable code. At least for us that aren&#39;t able to write <i>perfectly</i> portable code at the first attempt :-)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1851, "user_id": 226342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/17c6ed9982d27d297a4d7976c3936811?s=128&d=identicon&r=PG", "display_name": "Henrik", "link": "https://stackoverflow.com/users/226342/henrik"}, "edited": false, "score": 0, "creation_date": 1481120616, "post_id": 41018951, "comment_id": 69246868, "body": "@Henrik That shouldn&#39;t be an issue if you use the method from this answer. Though in case it is one of those oddball DSPs with 1 byte = 16 bits, then all bets about portability are usually off anyway."}, {"owner": {"reputation": 1851, "user_id": 226342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/17c6ed9982d27d297a4d7976c3936811?s=128&d=identicon&r=PG", "display_name": "Henrik", "link": "https://stackoverflow.com/users/226342/henrik"}, "edited": false, "score": 0, "creation_date": 1481120913, "post_id": 41018951, "comment_id": 69247104, "body": "@Lundin Yep it&#39;s an oddball DSP with 16-bit bytes. But besides those major hurdles I&#39;ve been able to reuse most, if not all, the C code I&#39;ve initially designed on the ARM architecture. The biggest problem so far would be creating portable correctly packed data structures in the memory to be transferred through some kind of interface, but other than that..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1851, "user_id": 226342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/17c6ed9982d27d297a4d7976c3936811?s=128&d=identicon&r=PG", "display_name": "Henrik", "link": "https://stackoverflow.com/users/226342/henrik"}, "edited": false, "score": 0, "creation_date": 1481121150, "post_id": 41018951, "comment_id": 69247279, "body": "@Henrik Structures aren&#39;t portable. You&#39;d have to disable padding or use serialization/de-serialization routines. But that&#39;s another topic entirely."}, {"owner": {"reputation": 1851, "user_id": 226342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/17c6ed9982d27d297a4d7976c3936811?s=128&d=identicon&r=PG", "display_name": "Henrik", "link": "https://stackoverflow.com/users/226342/henrik"}, "edited": false, "score": 0, "creation_date": 1481121496, "post_id": 41018951, "comment_id": 69247534, "body": "@Lundin OK I was using the wrong word: &quot;portable&quot;. What I meant was that it&#39;s a pain creating a data structure in 16-bit aligned memory. And that&#39;s the only part of my code which is kind of ugly and really doesn&#39;t work well on other archs than the one I am using.  But in general it&#39;s quite exciting using odd-ball archs :-)"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1481118327, "last_edit_date": 1481118327, "creation_date": 1481117853, "answer_id": 41018951, "question_id": 41018680, "link": "https://stackoverflow.com/questions/41018680/portable-bit-macro-in-c/41018951#41018951", "title": "Portable BIT macro in C", "body": "<p>First of all, there is absolutely no reason to use macros like these to hide away very basic functionality. <code>x |= 1U &lt;&lt; n;</code> is much clearer than the obscure <code>x |= BIT(n);</code>. Always assume that the person reading your code knows the C language, but doesn't know your secret macro language.</p>\n\n<p>So the first thing you should do is to get rid of the macro.</p>\n\n<hr>\n\n<p>That being said, portability is achieved by using the types from <code>stdint.h</code>.</p>\n\n<pre><code>uint32_t x = (uint32_t)1U &lt;&lt; n;\n</code></pre>\n\n<p>is fully portable to any known computer.</p>\n\n<p>Similarly, you could also use the standard <code>UINTn_C</code> literal format and type </p>\n\n<pre><code>uint32_t x = UINT32_C(1) &lt;&lt; n;\n</code></pre>\n"}], "owner": {"reputation": 1851, "user_id": 226342, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/17c6ed9982d27d297a4d7976c3936811?s=128&d=identicon&r=PG", "display_name": "Henrik", "link": "https://stackoverflow.com/users/226342/henrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3415, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1481118327, "creation_date": 1481117019, "last_edit_date": 1481117759, "question_id": 41018680, "link": "https://stackoverflow.com/questions/41018680/portable-bit-macro-in-c", "title": "Portable BIT macro in C", "body": "<p>I have a bare metal SW environment that can and compile run on multiple architectures such as <code>ARM 32-bit v7</code>/<code>ARM 64-bit v8</code> and a custom in-house architecture: let's call it <code>ARCHX</code>:</p>\n\n<p>First how different data types are defined on <code>ARM32</code>, <code>ARM64</code> and <code>ARCHX</code>:</p>\n\n<p>(Note: <code>ARM64</code> uses <code>LP64</code> programming model in this example).</p>\n\n<ul>\n<li>ARM32/ARM64/ARCHX\n\n<ul>\n<li>int: 32/32/16</li>\n<li>long: 32/64/32</li>\n<li>pointer: 32/64/16</li>\n</ul></li>\n</ul>\n\n<p>I've implemented a BIT-macro:</p>\n\n<pre><code>#define BIT(n) (0x1U &lt;&lt; (n))\n</code></pre>\n\n<p>Now on <code>ARCHX</code> if using <code>BIT</code> on an int (16-bit in <code>ARCHX</code>) this gives an error:</p>\n\n<blockquote>\n  <p>Warning: shiftcount too large, result is undefined</p>\n</blockquote>\n\n<p>Now adding <code>UL</code> to this macro solves that problem but in general might cause problems on other architectures.</p>\n\n<p>So my question is: </p>\n\n<p>Is this definition of the <code>BIT</code> macro not portable between architectures and compilers since I need to use <code>UL</code> on some archs, <code>U</code> on some and perhaps even <code>ULL</code> on some combinations (<code>ARM64</code> and <code>LLP</code> programming model?). </p>\n\n<p>Perhaps the <code>BIT</code> macro should be renamed and divided into <code>BIT16</code>, <code>BIT32</code> &amp; <code>BIT64</code> and be implemented per architecture rather than a generic <code>BIT</code>-macro for all architectures? </p>\n"}, {"tags": ["c", "cryptography", "xor"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1481116895, "post_id": 41018443, "comment_id": 69244191, "body": "What specifically do you want to XOR?"}, {"owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1481116975, "post_id": 41018443, "comment_id": 69244254, "body": "I want to convert the value into bytes so I can xor certain bytes. Sorry if my terms are incorrect."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481117051, "post_id": 41018443, "comment_id": 69244311, "body": "You mean someting like this: <code>(x &amp; 0xff) ^ ((x &gt;&gt; 8) &amp; 0xff)) ^ ((x &gt;&gt; 16) &amp; 0xff) ^ ((x &gt;&gt; 24) &amp; 0xff)</code> ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1481117076, "post_id": 41018443, "comment_id": 69244328, "body": "So you want to XOR each byte in the value, i.e. <code>03 XOR BF XOR F1 XOR 27</code>?"}, {"owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "edited": false, "score": 0, "creation_date": 1481117330, "post_id": 41018443, "comment_id": 69244504, "body": "Yes dbush sorry for confusion"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481127397, "post_id": 41018443, "comment_id": 69251701, "body": "Note: <code>L</code> means the constant <code>0x04000000L</code> is at least long/unsigned long<code>.  </code>unsigned int L` is an <code>unsigned</code>.  If code is assigning a constant that is at least <code>long&#47;unsigned long</code>, better to assign it to a <code>long&#47;unsigned long</code> rather than an <code>unsigned</code>.  <code>unsigned long L = 0x04000000L^ W ;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "edited": false, "score": 0, "creation_date": 1481122350, "post_id": 41018767, "comment_id": 69248143, "body": "How would I complete this step  Method(0x02000000L^ W) where W  = (0, a0 \u2295 a1,a2 \u2295a3,0) and Method accepts an unsigned int"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481123280, "post_id": 41018767, "comment_id": 69248722, "body": "Using bitwise operators on a signed int is not a good idea, because it can lead to poorly-specified behavior bugs in many cases. Using bitwise operators on character types is therefore not a good idea either, because they will end up as signed int through implicit integer promotion. Thus this whole code is vulnerable to bugs."}, {"owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481123845, "post_id": 41018767, "comment_id": 69249122, "body": "@Lundin corrected to unsigned int. Would uint8_t instead of unsigned char make it better?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481127179, "post_id": 41018767, "comment_id": 69251545, "body": "If type <code>uint8_t</code> exist, it is the same size/range of <code>unsigned char</code>.  In that case, use whatever type that best conveys the meaning.  <code>unsigned char</code> is more portable as <code>uint8_t</code> is common, yet an optional type."}, {"owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "edited": false, "score": 0, "creation_date": 1481128149, "post_id": 41018767, "comment_id": 69252187, "body": "Thank you ever so much for all your help, your a legend"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481182428, "post_id": 41018767, "comment_id": 69275422, "body": "@izlin Both types have the same problem with implicit integer promotion."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481183934, "post_id": 41018767, "comment_id": 69276135, "body": "@chux <code>uint8_t</code> is more portable since it is of deterministic size. It doesn&#39;t matter that stdint.h is optional in C11, because nobody in the real world is going to accept a compiler which does not support stdint.h. Such crap compilers should not be used, so designing for portability to them, if they even exist, is nonsense."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481213216, "post_id": 41018767, "comment_id": 69295237, "body": "@Lundin  <code>uint8_t</code> is not more nor less portable than <code>unsigned char</code> given <code>uint8_t</code> exist as you suggest that only that case is considered.  When <code>uint8_t</code> exist, it is the same size/range as <code>unsigned char</code> and does not make code more/less portable.  Perhaps you can present a use case where when <code>uint8_t</code>  exist and using one or the other improves <i>portability</i>?  As I see it, when <code>uint8_t</code> exist, the selection is for code clarity and not portability."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481269080, "post_id": 41018767, "comment_id": 69317425, "body": "@chux  The obvious: <code>type t; for(uint8_t* ptr=(uint8_t*)&amp;t; ptr &lt; &amp;t; ptr++) bits += 8;</code> This code is portable with uint8_t but could break with unsigned char, because unsigned char is not guaranteed to have 8 bits. (Strict aliasing is not a concern here unless the compiler is hopelessly broken.)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481293020, "post_id": 41018767, "comment_id": 69331563, "body": "@Lundin Disagree with &quot;could break&quot; sample code.  For <code>uint8_t</code> to exist, <code>unsigned char</code>  must also be 8 bit.  If <code>unsigned char</code> is &gt; 8 bit, <code>uint8_t</code> does not exist and code sample would not compile due to <code>uint8_t</code>, not <code>unsigned char</code>.   &quot;number of bits for smallest object that is not a bit-field&quot; is <code>CHAR_BIT</code> which is <code>unsigned char</code> bit size.  Both <code>unsigned char</code> and <code>uint8_t</code> cannot have padding."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1481293156, "post_id": 41018767, "comment_id": 69331656, "body": "@chux That only proves the point. If <code>char</code> is 16 bit on the given system, and you have written a program which relies on a byte being 8 bits, then <code>uint8_t</code> will not compile, while <code>unsigned char</code> will silently compile and give the wrong result."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481293269, "post_id": 41018767, "comment_id": 69331737, "body": "<code>type t; for(uint8_t* ptr=(uint8_t*)&amp;t; ptr &lt; &amp;t; ptr++) bits += 8;</code> // ensured to be safe by the compiler"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481293305, "post_id": 41018767, "comment_id": 69331768, "body": "<code>type t; for(unsigned char* ptr=(unsigned char*)&amp;t; ptr &lt; &amp;t; ptr++) bits += 8;</code> // dangerous and non-portable"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481293352, "post_id": 41018767, "comment_id": 69331800, "body": "@Lundin <code>type t; for(unsigned char* ptr=(unsigned char*)&amp;t; ptr &lt; &amp;t; ptr++) bits += CHAR_BIT;</code> is portable."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481293361, "post_id": 41018767, "comment_id": 69331809, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/130225/discussion-between-chux-and-lundin\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "is_accepted": true, "score": 4, "last_activity_date": 1481124234, "last_edit_date": 1481124234, "creation_date": 1481117331, "answer_id": 41018767, "question_id": 41018443, "link": "https://stackoverflow.com/questions/41018443/xor-certain-bytes-in-c/41018767#41018767", "title": "XOR certain bytes in c", "body": "<p>I don't know if this helps you, but i calculate the bytes first and then XOR some of them:</p>\n\n<pre><code>unsigned int value = 62910759;\nunsigned char a = value &gt;&gt; 24 &amp; 0xFF; // First byte/ high byte\nunsigned char b = value &gt;&gt; 16 &amp; 0xFF;\nunsigned char c = value &gt;&gt; 8 &amp; 0xFF;\nunsigned char d = value &amp; 0xFF; // Last byte/ smallest byte\nprintf(\"%.2X %.2X %.2X %.2X\\n\", a,b,c,d);\n\nunsigned char aXORb = a^b; // a XOR b\nunsigned char bXORc = b^c;\nunsigned char cXORd = c^d;\nunsigned char dXORa = d^a;\n\nprintf(\"%.2X %.2X %.2X %.2X\\n\", aXORb,bXORc,cXORd,dXORa);\n</code></pre>\n\n<p><a href=\"http://ideone.com/qiLj3D\" rel=\"nofollow noreferrer\">Try it here.</a></p>\n\n<p>Output:</p>\n\n<pre><code>03 BF F1 27\nBC 4E D6 24\n</code></pre>\n\n<p>Note: I think uint8_t would be more \"C-like\" but the result will be the same anyway.</p>\n\n<p>@Jimbo Jones Here is the last step. The zeros are unnecessary, but i included them for better understanding the code.</p>\n\n<pre><code>unsigned int result = (0x00 &lt;&lt; 24) + (aXORb &lt;&lt; 16) + (cXORd &lt;&lt; 8) + 0x00;\nMethod(0x02000000L^ result);\n</code></pre>\n\n<p>If you mean with W = (0, a0 \u2295 a1,a2 \u2295a3,0) that the first 8 bit are 0 and the next 8 a XOR b and so on.</p>\n"}], "owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 824, "favorite_count": 0, "accepted_answer_id": 41018767, "answer_count": 1, "score": 1, "last_activity_date": 1481124234, "creation_date": 1481116339, "last_edit_date": 1481116872, "question_id": 41018443, "link": "https://stackoverflow.com/questions/41018443/xor-certain-bytes-in-c", "title": "XOR certain bytes in c", "body": "<p>I am wondering if anyone can help me. I am new to c and only learning. So this questain may seem confused. I have an unsigned int value that I need to split into bytes then xor certain bytes together and then get the result. I want represent the value as (0, a0 \u2295 a1,a2 \u2295a3,0). </p>\n\n<p>Decimal value = 62910759 or Hex value = 3BFF127;</p>\n\n<pre><code>unsigned int value = 62910759;\n</code></pre>\n\n<p>// W  = (0, a0 \u2295 a1,a2 \u2295a3,0);</p>\n\n<pre><code>unsigned int L = 0x04000000L^ W ;\n</code></pre>\n"}, {"tags": ["c", "delimiter"], "comments": [{"owner": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "edited": false, "score": 0, "creation_date": 1481116620, "post_id": 41018367, "comment_id": 69243987, "body": "i forgot to mention, gender of person is also included , example :             <code>add John Smith [m] brother Jack Smith [m] </code>   [m] and [f] are for male and female genders..."}, {"owner": {"reputation": 313, "user_id": 2390668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752a1ba199d3c1990177d55b3c6fd460?s=128&d=identicon&r=PG&f=1", "display_name": "MrMuMu", "link": "https://stackoverflow.com/users/2390668/mrmumu"}, "edited": false, "score": 1, "creation_date": 1481116622, "post_id": 41018367, "comment_id": 69243991, "body": "You need to decide that it is a keyword for you. You can store them as global and check every output of the <code>strtok</code> to decide what is the current token. Then do something according to it"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1481116653, "post_id": 41018367, "comment_id": 69244012, "body": "Your input syntax is flawed. Answer this for yourself: How is the program supposed to know if a space is between name-parts or other tokens?"}, {"owner": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "reply_to_user": {"reputation": 313, "user_id": 2390668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752a1ba199d3c1990177d55b3c6fd460?s=128&d=identicon&r=PG&f=1", "display_name": "MrMuMu", "link": "https://stackoverflow.com/users/2390668/mrmumu"}, "edited": false, "score": 3, "creation_date": 1481116667, "post_id": 41018367, "comment_id": 69244025, "body": "@NanonA and hope that that keyword isn&#39;t something that might turn up in someone&#39;s name... :)"}, {"owner": {"reputation": 830, "user_id": 2165524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xg2Jb.jpg?s=128&g=1", "display_name": "&#181;tex", "link": "https://stackoverflow.com/users/2165524/%c2%b5tex"}, "edited": false, "score": 0, "creation_date": 1481116692, "post_id": 41018367, "comment_id": 69244044, "body": "Are you really confused.. what do you want to do really..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 313, "user_id": 2390668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752a1ba199d3c1990177d55b3c6fd460?s=128&d=identicon&r=PG&f=1", "display_name": "MrMuMu", "link": "https://stackoverflow.com/users/2390668/mrmumu"}, "edited": false, "score": 2, "creation_date": 1481116701, "post_id": 41018367, "comment_id": 69244054, "body": "@NanonA That&#39;s quite error-prone and am XY-solution."}, {"owner": {"reputation": 313, "user_id": 2390668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752a1ba199d3c1990177d55b3c6fd460?s=128&d=identicon&r=PG&f=1", "display_name": "MrMuMu", "link": "https://stackoverflow.com/users/2390668/mrmumu"}, "reply_to_user": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 0, "creation_date": 1481116701, "post_id": 41018367, "comment_id": 69244055, "body": "@Alnitak Well it is a start point to go:P"}, {"owner": {"reputation": 313, "user_id": 2390668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752a1ba199d3c1990177d55b3c6fd460?s=128&d=identicon&r=PG&f=1", "display_name": "MrMuMu", "link": "https://stackoverflow.com/users/2390668/mrmumu"}, "edited": false, "score": 0, "creation_date": 1481117140, "post_id": 41018367, "comment_id": 69244362, "body": "@Totenkoph93 Does every entry look like this: <code>add person [gender] relation person [gender]</code>?"}, {"owner": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "reply_to_user": {"reputation": 830, "user_id": 2165524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xg2Jb.jpg?s=128&g=1", "display_name": "&#181;tex", "link": "https://stackoverflow.com/users/2165524/%c2%b5tex"}, "edited": false, "score": 0, "creation_date": 1481117825, "post_id": 41018367, "comment_id": 69244915, "body": "@sas i am bit confused , here is short summary of what i have to do. the assignment is about creating family tree. in this part of exercise i want to take input from user ( input are commands from user) and first decide which command user wrote. commands are: 1st:  add person [gender] relation person [ gender] , 2nd: draw person [file_name] and few more... for now i just want to read input and use strcmp() to find which command has been called. But in assignment is specified that : all comands are case sensitive, parameters are separated by one space. One parameter can contain space (ex: Name)"}, {"owner": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "reply_to_user": {"reputation": 830, "user_id": 2165524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xg2Jb.jpg?s=128&g=1", "display_name": "&#181;tex", "link": "https://stackoverflow.com/users/2165524/%c2%b5tex"}, "edited": false, "score": 2, "creation_date": 1481118237, "post_id": 41018367, "comment_id": 69245234, "body": "@sas and also, if one parameter has more spaces, it should be counted as one parameter. Maybe for now i just need to find which command user wrote and make another function for that specific command where i can write all of the requirements ( functionality of that command) for it..."}, {"owner": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1481118511, "post_id": 41018367, "comment_id": 69245418, "body": "@user3121023  yes, names with upper case and other words with lower case"}, {"owner": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "reply_to_user": {"reputation": 313, "user_id": 2390668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752a1ba199d3c1990177d55b3c6fd460?s=128&d=identicon&r=PG&f=1", "display_name": "MrMuMu", "link": "https://stackoverflow.com/users/2390668/mrmumu"}, "edited": false, "score": 0, "creation_date": 1481119030, "post_id": 41018367, "comment_id": 69245758, "body": "@NanonA there are other type of entries:  <code>add person [gender] relation person </code> ; <code>draw-all file-name</code> ( filename not separated by space ex: family-tree) <code>draw person file-name</code> ; <code>relationship person 1 person 2</code>"}, {"owner": {"reputation": 313, "user_id": 2390668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752a1ba199d3c1990177d55b3c6fd460?s=128&d=identicon&r=PG&f=1", "display_name": "MrMuMu", "link": "https://stackoverflow.com/users/2390668/mrmumu"}, "edited": false, "score": 0, "creation_date": 1481122263, "post_id": 41018367, "comment_id": 69248093, "body": "Okay, let me give you one example. The example may not be appropriate for your case but try to grasp the idea. Let&#39;s assume command <code>add</code> is read. What you can do is as follows: you can use <code>strtok</code> until first white space. Then you can use <code>strtok</code> until <code>[</code> which gives you the name. Then you can parse until <code>]</code> which gives you gender.Then parse until white space which gives you relation. Then parse until <code>[</code> this gives you name and so on. I hope it help. I was writing in a hurry."}], "answers": [{"tags": [], "owner": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "is_accepted": true, "score": 0, "last_activity_date": 1481122183, "creation_date": 1481122183, "answer_id": 41020501, "question_id": 41018367, "link": "https://stackoverflow.com/questions/41018367/c-split-string-by-space-with-delimiter-but-escape-space-between-certain-words/41020501#41020501", "title": "&quot;C&quot; split string by space with delimiter but escape space between certain words (last, first name)", "body": "<p>Using <code>strchr</code> you can iterate through the string, parsing command name gender relation sex. This will fail if there are more than one space between words but additional logic could be added to accommodate multiple spaces. It also fails if the format <code>command name relation name</code> is not observed but again additional logic could be added to handle that.<br>\nChecks need to be added to handle a failure of <code>malloc</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nstruct parse {\n    char *command;\n    char *name;\n    char gender;\n    char *relation;\n    char *identity;\n    char sex;\n};\n\n\nint main(void)\n{\n    //char input[] = \"add John Smith III [m] brother David William Smith [m]\";\n    char input[] = \"add John Smith III brother David William Smith\";\n    char *start = NULL;\n    char *stop = NULL;\n    int span = 0;\n    struct parse item;\n    //parse command - one word\n    start = input;\n    if ( ( stop = strchr ( start, ' '))) {\n        span = stop - start;\n        item.command = malloc ( span + 1);\n        memmove ( item.command, start, span);\n        item.command[span] = '\\0';\n    }\n    //parse name - could be many words, each begins with upper case\n    start = stop + 1;\n    stop = start;;\n    while ( ( stop = strchr ( stop, ' '))) {\n        if ( !isupper( *(stop + 1))) {\n            span = stop - start;\n            item.name = malloc ( span + 1);\n            memmove ( item.name, start, span);\n            item.name[span] = '\\0';\n            break;\n        }\n        stop = stop + 1;\n    }\n    //optional - parse gender - one character in []\n    start = stop;\n    item.gender = '*';\n    if ( *(start + 1) == '[') {\n        item.gender = *(start + 2);\n        stop = strchr ( start + 1, ' ');\n    }\n    //parse relation - one word\n    start = stop + 1;\n    if ( ( stop = strchr ( start, ' '))) {\n        span = stop - start;\n        item.relation = malloc ( span + 1);\n        memmove ( item.relation, start, span);\n        item.relation[span] = '\\0';\n    }\n    //parse name - could be many words, each begins with upper case\n    start = stop + 1;\n    stop = start;;\n    while ( ( stop = strchr ( stop, ' '))) {\n        if ( !isupper( *(stop + 1))) {\n            span = stop - start;\n            item.identity = malloc ( span + 1);\n            memmove ( item.identity, start, span);\n            item.identity[span] = '\\0';\n            break;\n        }\n        stop = stop + 1;\n    }\n    if ( !stop) { // if nothing follows identity...strchr failed on last name\n        span = strlen ( start);\n        item.identity = malloc ( span + 1);\n        memmove ( item.identity, start, span);\n        item.identity[span] = '\\0';\n        stop = start + span;\n    }\n    //optional - parse sex - one character in []\n    start = stop;\n    item.sex = '*';\n    if ( *(start + 1) == '[') {\n        item.sex = *(start + 2);\n    }\n\n    printf ( \"%s\\n\", item.command);\n    printf ( \"%s\\n\", item.name);\n    printf ( \"%c\\n\", item.gender);\n    printf ( \"%s\\n\", item.relation);\n    printf ( \"%s\\n\", item.identity);\n    printf ( \"%c\\n\", item.sex);\n\n    free ( item.command);\n    free ( item.name);\n    free ( item.relation);\n    free ( item.identity);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 695, "favorite_count": 0, "accepted_answer_id": 41020501, "answer_count": 1, "score": -1, "last_activity_date": 1481122183, "creation_date": 1481116116, "last_edit_date": 1481117190, "question_id": 41018367, "link": "https://stackoverflow.com/questions/41018367/c-split-string-by-space-with-delimiter-but-escape-space-between-certain-words", "title": "&quot;C&quot; split string by space with delimiter but escape space between certain words (last, first name)", "body": "<p>I want to check input commands from user \nsuch as: </p>\n\n<p><code>add person relation person   (person can be for example John, or \"John Smith\")</code></p>\n\n<p>example: <code>add John Smith brother Jack Smith</code>\n...</p>\n\n<p>I used delimiter (space) to split string into mult. strings, but I have to leave name of person as one string/parameter (between first and last name of person could be 1 space or more , in each case I have to use interpret it as one parameter).</p>\n\n<p><code>// input from cmd stored in \"input\" variable with fgets() in main function...</code> </p>\n\n<pre><code>char inputTerminalCommands(char *input) // takes char input from main, splits strings and then should compare type of command from user\n{\n\nint i = 0;\nchar *str = input;      \nchar *split = strtok(str, \" \");  // split string into words after \"space\"\n\nchar *array[6];\n\nwhile(split!= 0)\n{\n    array[i++] = split;\n    split = strtok(NULL, \" \");\n}\n\nreturn 0;\n</code></pre>\n\n<p>With my code I split strings by space, but how to ignore space between names? \nor to say, store strings between \"add\" and \"relation\" in one string and after \"relation\" also in one string...</p>\n"}, {"tags": ["c", "pointers", "linked-list", "void-pointers"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1481116394, "post_id": 41018254, "comment_id": 69243839, "body": "When the user presses 0, the function will return NULL. There are many errors. Please read a book, rethink your code, and then come back if you have problems."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1481117632, "post_id": 41018254, "comment_id": 69244756, "body": "When <code>head</code> is null, and you print the error message (which should go to stderr, not stdout), you should do something other than continue with the next line that requires <code>head</code> be non-null.  Your program has undefined behaviour."}, {"owner": {"reputation": 603, "user_id": 3291639, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/777fc86473207d1010f34448d8aa7014?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Sourav", "link": "https://stackoverflow.com/users/3291639/himanshu-sourav"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1481175013, "post_id": 41018254, "comment_id": 69272081, "body": "@PaulOgilvie thanks for the sharp observation, I have modified code to rectify this problem and other errors. could you have one more look to see if any other issue is there..? posted in answer."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1481200199, "post_id": 41018254, "comment_id": 69286286, "body": "I don&#39;t see any improvements. Still many errors."}, {"owner": {"reputation": 603, "user_id": 3291639, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/777fc86473207d1010f34448d8aa7014?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Sourav", "link": "https://stackoverflow.com/users/3291639/himanshu-sourav"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1481258600, "post_id": 41018254, "comment_id": 69313771, "body": "@PaulOgilvie, I had added in answer, updated question as well..."}], "answers": [{"comments": [{"owner": {"reputation": 603, "user_id": 3291639, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/777fc86473207d1010f34448d8aa7014?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Sourav", "link": "https://stackoverflow.com/users/3291639/himanshu-sourav"}, "edited": false, "score": 0, "creation_date": 1481116123, "post_id": 41018319, "comment_id": 69243656, "body": "I have allocated memory to head in main function, which is passed as current in create function..."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 603, "user_id": 3291639, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/777fc86473207d1010f34448d8aa7014?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Sourav", "link": "https://stackoverflow.com/users/3291639/himanshu-sourav"}, "edited": false, "score": 4, "creation_date": 1481116272, "post_id": 41018319, "comment_id": 69243747, "body": "@HimanshuSourav exactly, you&#39;ve allocated for <code>head</code>, not for <code>head-&gt;data</code>. think from this perspective."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1481115945, "creation_date": 1481115945, "answer_id": 41018319, "question_id": 41018254, "link": "https://stackoverflow.com/questions/41018254/storing-and-printing-string-in-void-pointer/41018319#41018319", "title": "storing and printing string in void pointer", "body": "<p>In your code,</p>\n\n<pre><code> scanf(\"%s\",current-&gt;data);\n</code></pre>\n\n<p>is attempt to make use of an unitialized pointer, it invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>You need to follow either of bellow approach,</p>\n\n<ul>\n<li>make the pointer point to valid chunk of memory (using <code>malloc()</code> and family for dynamic allocation, for example)</li>\n<li>use an array.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "is_accepted": false, "score": 1, "last_activity_date": 1481117523, "last_edit_date": 1481117523, "creation_date": 1481116502, "answer_id": 41018508, "question_id": 41018254, "link": "https://stackoverflow.com/questions/41018254/storing-and-printing-string-in-void-pointer/41018508#41018508", "title": "storing and printing string in void pointer", "body": "<p>You should first initialize data member of structure because </p>\n\n<pre><code>current-&gt;data  = malloc(\"passes size here\");\n</code></pre>\n\n<p>For putting data you have to typecast first this data because void is not storage type.  void pointer can be used to point to any data type.</p>\n\n<p>Like</p>\n\n<pre><code>*(char *)(current-&gt;data) = 1;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1481121068, "post_id": 41019554, "comment_id": 69247218, "body": "You aren&#39;t showing that you&#39;ve allocated any memory for <code>current-&gt;data</code> at any point.  Nor do you always initialize all the elements of a newly allocated node.  In C, you always have to think about &quot;where are my pointers pointing&quot;."}, {"owner": {"reputation": 2268, "user_id": 6680585, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/eMjQ1.jpg?s=128&g=1", "display_name": "Tom Taylor", "link": "https://stackoverflow.com/users/6680585/tom-taylor"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1481122287, "post_id": 41019554, "comment_id": 69248108, "body": "<code>current = (node *)malloc(sizeof(node));</code> allocating memory of a node allocates memory for its elements like <code>current-&gt;data</code> and <code>current-&gt;next</code>"}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 2, "creation_date": 1481122565, "post_id": 41019554, "comment_id": 69248281, "body": "But <code>current-&gt;data</code> will hold a <code>void*</code> pointer, which needs to be allocated before use."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1481122697, "post_id": 41019554, "comment_id": 69248357, "body": "What I meant is that the data element of the new node doesn&#39;t point to anything (it isn&#39;t even a null pointer necessarily), but to be able to read data into the space pointed at by the data element, you must first allocate space for it to point at."}], "tags": [], "owner": {"reputation": 2268, "user_id": 6680585, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/eMjQ1.jpg?s=128&g=1", "display_name": "Tom Taylor", "link": "https://stackoverflow.com/users/6680585/tom-taylor"}, "is_accepted": false, "score": -1, "last_activity_date": 1481120675, "last_edit_date": 1481120675, "creation_date": 1481119707, "answer_id": 41019554, "question_id": 41018254, "link": "https://stackoverflow.com/questions/41018254/storing-and-printing-string-in-void-pointer/41019554#41019554", "title": "storing and printing string in void pointer", "body": "<p>Please try with this</p>\n\n<pre><code>void *create(node *current)\n{\n        int user_choice;\n        while(true){\n                if(current == NULL) {\n                   current = (node *)malloc(sizeof(node));\n                   current-&gt;data = NULL;\n                   current-&gt;next = NULL;\n                }\n                printf(\"\\nEnter the data:\");\n                scanf(\"%s\",current-&gt;data);\n                printf(\"stored at %p\\n\", (void *)current-&gt;data);\n                printf(\"%s\",current-&gt;data);\n                //printf(\"%s\",(char*)current-&gt;data);\n                printf(\"\\nType '1' to continue, '0' to exit:\\n\");\n                scanf(\"%d\",&amp;user_choice);\n\n                if(user_choice == 1){\n                        current-&gt;next=(node*)malloc(sizeof(node));\n                        current=current-&gt;next;\n                }\n                else{\n                        current-&gt;next=NULL;\n                        tail = current;\n                        current=current-&gt;next;\n                        break;\n                }\n        }\n        return current;\n}\n</code></pre>\n\n<p>Note: The element has to be initialized (ie; it has to be alloted with some memory) before we are trying to make use of it.</p>\n"}, {"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": false, "score": 1, "last_activity_date": 1481162348, "last_edit_date": 1481162348, "creation_date": 1481121742, "answer_id": 41020332, "question_id": 41018254, "link": "https://stackoverflow.com/questions/41018254/storing-and-printing-string-in-void-pointer/41020332#41020332", "title": "storing and printing string in void pointer", "body": "<p>As others have said:</p>\n\n<pre><code>scanf(\"%s\",current-&gt;data);\n</code></pre>\n\n<p>Is undefined in C. <code>current-&gt;data</code> needs to be pointing somewhere before you can store anything in it. </p>\n\n<p>You should instead:</p>\n\n<ol>\n<li>Accept input from <code>scanf</code>.</li>\n<li>Store in temporary buffer.</li>\n<li>Insert into linked list</li>\n<li>print out whole linked list at the end</li>\n<li><code>free()</code> linked list at the end.</li>\n</ol>\n\n<p>I also feel that your current <code>void *create</code> function is doing too much, and it would be easier to split up your code into different functions, just to make it easier to handle all the pointer operations, inserting etc. </p>\n\n<p>To demonstrate these points, I wrote some code a while ago which does these things, and has been modified to help you with your code. It is not the best code, but it does use these points that will help you with your code.</p>\n\n<p>Here it is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXSTRLEN 100\n\ntypedef struct node {\n    void *data;\n    struct node *next;\n} node_t;\n\ntypedef struct {\n    node_t *head;\n    node_t *foot;\n} list_t;\n\nlist_t *create_list(void);\nnode_t *generate_node(void);\nlist_t *insert_node(list_t *list, char *data);\nvoid print_list(list_t *list);\nvoid free_list(list_t *list);\n\nint\nmain(int argc, char *argv[]) {\n    list_t *list;\n    char data[MAXSTRLEN];\n    int user_choice;\n\n    list = create_list();\n\n    while (1) {\n        printf(\"Enter the data: \");\n        scanf(\"%s\", data);\n\n        printf(\"\\nType '1' to continue, '0' to exit:\\n\");\n        if (scanf(\"%d\",&amp;user_choice) != 1) {\n            printf(\"Invalid input\\n\");\n            exit(EXIT_FAILURE);\n        }\n\n        if (user_choice == 1) {\n            list = insert_node(list, data);\n        } else {\n            list = insert_node(list, data);\n            break;\n        }\n    }\n\n    print_list(list);\n\n    free_list(list);\n    list = NULL;\n\n    return 0;\n}\n\n/* inserting at foot, you can insert at the head if you wish. */\nlist_t\n*insert_node(list_t *list, char *data) {\n    node_t *newnode = generate_node();\n\n    newnode-&gt;data = malloc(strlen(data)+1);\n    strcpy(newnode-&gt;data, data);\n\n    newnode-&gt;next = NULL;\n    if (list-&gt;foot == NULL) {\n        list-&gt;head = newnode;\n        list-&gt;foot = newnode;\n    } else {\n        list-&gt;foot-&gt;next = newnode;\n        list-&gt;foot = newnode;\n    }\n    return list;\n\n}\n\nnode_t\n*generate_node(void) {\n    node_t *new = malloc(sizeof(*new));\n    new-&gt;data = NULL;\n    return new;\n}\n\nvoid\nprint_list(list_t *list) {\n    node_t *curr = list-&gt;head;\n\n    printf(\"\\nlinked list data:\\n\");\n    while(curr != NULL) {\n        printf(\"%s\\n\", (char*)curr-&gt;data);\n        curr = curr-&gt;next;\n    }\n}\n\nlist_t\n*create_list(void) {\n    list_t *list = malloc(sizeof(*list));\n\n    if (list == NULL) {\n        fprintf(stderr, \"%s\\n\", \"Error allocating memory\");\n        exit(EXIT_FAILURE);\n    }\n\n    list-&gt;head = NULL;\n    list-&gt;foot = NULL;\n    return list;\n}\n\nvoid\nfree_list(list_t *list) {\n    node_t *curr, *prev;\n    curr = list-&gt;head;\n    while (curr) {\n        prev = curr;\n        curr = curr-&gt;next;\n        free(prev);\n    }\n    free(list);\n}\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Also note how I allocated memory for <code>newnode-&gt;data</code>? </p>\n\n<p>Like this: </p>\n\n<pre><code>newnode-&gt;data = malloc(strlen(data)+1); //using buffer from scanf\n</code></pre>\n\n<p>This now means I can store data in this pointer, your <code>current-&gt;data</code> will need to do something similar.</p>\n"}, {"comments": [{"owner": {"reputation": 603, "user_id": 3291639, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/777fc86473207d1010f34448d8aa7014?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Sourav", "link": "https://stackoverflow.com/users/3291639/himanshu-sourav"}, "reply_to_user": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1481186573, "post_id": 41032406, "comment_id": 69277417, "body": "@RoadRunner it did indeed :)"}], "tags": [], "owner": {"reputation": 603, "user_id": 3291639, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/777fc86473207d1010f34448d8aa7014?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Sourav", "link": "https://stackoverflow.com/users/3291639/himanshu-sourav"}, "is_accepted": false, "score": 1, "last_activity_date": 1481175908, "last_edit_date": 1481175908, "creation_date": 1481175103, "answer_id": 41032406, "question_id": 41018254, "link": "https://stackoverflow.com/questions/41018254/storing-and-printing-string-in-void-pointer/41032406#41032406", "title": "storing and printing string in void pointer", "body": "<blockquote>\n  <p>working code--></p>\n</blockquote>\n\n<pre><code>void *create(node *current)\n{\n        node *temp;\n        int user_choice;\n        while(current){\n                printf(\"\\nEnter the data:\");\n                current-&gt;data=(char*)malloc(10*sizeof(char));\n                scanf(\"%s\",current-&gt;data);\n                printf(\"stored at %p\\n\",(void*)current-&gt;data);\n                printf(\"%s\",(char*)current-&gt;data);\n                printf(\"\\nType '1' to continue, '0' to exit:\\n\");\n                scanf(\"%d\",&amp;user_choice);\n\n                if(user_choice == 1){\n                        current-&gt;next=(node*)malloc(sizeof(node));\n                }\n                else{\n                        current-&gt;next=NULL;\n                        temp=current;\n                }\n                current=current-&gt;next;\n        }\n        return temp;\n}\n</code></pre>\n"}], "owner": {"reputation": 603, "user_id": 3291639, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/777fc86473207d1010f34448d8aa7014?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Sourav", "link": "https://stackoverflow.com/users/3291639/himanshu-sourav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2995, "favorite_count": 0, "accepted_answer_id": 41018319, "answer_count": 5, "score": 2, "last_activity_date": 1481258495, "creation_date": 1481115798, "last_edit_date": 1481258495, "question_id": 41018254, "link": "https://stackoverflow.com/questions/41018254/storing-and-printing-string-in-void-pointer", "title": "storing and printing string in void pointer", "body": "<p>I have written a linked list program which stores data member as void *.\nwhile trying to store annd print using scanf/printf functions, I am getting segmentation fault. </p>\n\n<p><strong>node definition --></strong></p>\n\n<pre><code>typedef struct node {\n        struct node *next;\n        void *data;\n        }node;\n</code></pre>\n\n<p><strong>main function --></strong> </p>\n\n<pre><code>                head=(node *)malloc(sizeof(node));\n                if (head==NULL){\n                        printf(\"error in allocation of memory\\n\");\n                        exit(EXIT_FAILURE);\n                }\n                tail=(node*)create(head);\n</code></pre>\n\n<p><strong>create function --></strong></p>\n\n<pre><code>void *create(node *current)\n{\n        int user_choice;\n        while(current){\n                printf(\"\\nEnter the data:\");\n                scanf(\"%s\",current-&gt;data);\n                printf(\"stored at %p\\n\",(void*)current-&gt;data);\n                printf(\"%s\",(char*)current-&gt;data);\n                printf(\"\\nType '1' to continue, '0' to exit:\\n\");\n                scanf(\"%d\",&amp;user_choice);\n\n                if(user_choice == 1){\n                        current-&gt;next=(node*)malloc(sizeof(node));\n                        current=current-&gt;next;\n                }\n                else{\n                        current-&gt;next=NULL;\n                }\n        }\n        return current;\n}\n</code></pre>\n\n<p>can anyone tell what is the correct argument for scanf &amp; prinf should be..?</p>\n\n<hr>\n\n<blockquote>\n  <p>working code after incorporating points given in answers...</p>\n</blockquote>\n\n<pre><code>void *create(node *current)\n{\n        node *temp;\n        int user_choice;\n        while(current){\n                printf(\"\\nEnter the data:\");\n                current-&gt;data=(char*)malloc(10*sizeof(char));\n                scanf(\"%s\",current-&gt;data);\n                printf(\"stored at %p\\n\",(void*)current-&gt;data);\n                printf(\"%s\",(char*)current-&gt;data);\n                printf(\"\\nType '1' to continue, '0' to exit:\\n\");\n                scanf(\"%d\",&amp;user_choice);\n\n                if(user_choice == 1){\n                        current-&gt;next=(node*)malloc(sizeof(node));\n                }\n                else{\n                        current-&gt;next=NULL;\n                        temp=current;\n                }\n                current=current-&gt;next;\n        }\n        return temp;\n}\n</code></pre>\n"}, {"tags": ["c", "microcontroller", "68hc12"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481115989, "post_id": 41018178, "comment_id": 69243544, "body": "You are checking other port values too, suggest <code>if ((PTH &amp; 0x1f) == 0x0f)</code>"}, {"owner": {"reputation": 35, "user_id": 5558046, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/281d26d9ceea9c35d15338736b6f7827?s=128&d=identicon&r=PG&f=1", "display_name": "user_1", "link": "https://stackoverflow.com/users/5558046/user-1"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481116273, "post_id": 41018178, "comment_id": 69243749, "body": "Thanks for the reply.  I just tried this and although it doesn&#39;t skip straight to the new menu it has no response when zero is pressed @WeatherVane"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481116558, "post_id": 41018178, "comment_id": 69243934, "body": "You just changed the question, but you do not say how many (which) port bits are from the keyboard."}, {"owner": {"reputation": 35, "user_id": 5558046, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/281d26d9ceea9c35d15338736b6f7827?s=128&d=identicon&r=PG&f=1", "display_name": "user_1", "link": "https://stackoverflow.com/users/5558046/user-1"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481116890, "post_id": 41018178, "comment_id": 69244187, "body": "sorry I posted the zero key bits incorrectly.  So the keypad only uses the upper 5 bits, the keypad has 0 - F on it. @WeatherVane"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1481117013, "post_id": 41018178, "comment_id": 69244290, "body": "See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>  and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Not idea why you even mention port <code>B</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1481119140, "post_id": 41018178, "comment_id": 69245840, "body": "If the zero key is found at pin 4 and is active low, you should write <code>if( (PTH &amp; (1&lt;&lt;4)) == 0)</code>. That being said, there is not enough info to answer the question. Did you set up DDRH? How do you debounce the key? Which 68HC12 is this and does it have a port routing register (MODRR) that applies to this port? Are any other hardware peripheral on that port (SPI, PWM, timers etc) active? Are you using pull resistors, if so are they internal or external?"}, {"owner": {"reputation": 35, "user_id": 5558046, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/281d26d9ceea9c35d15338736b6f7827?s=128&d=identicon&r=PG&f=1", "display_name": "user_1", "link": "https://stackoverflow.com/users/5558046/user-1"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481120160, "post_id": 41018178, "comment_id": 69246537, "body": "yes DDRH is set up. its a Motorola 68HC12 16 bit microcontroller. it has an SPI port that my LCD module screen connects to.  I am unsure about the rest. @Lundin"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481120855, "post_id": 41018178, "comment_id": 69247059, "body": "@user_1 It matters <i>which</i> 68HC12 this is. For example HCS12DP256 or whatever.  Namely if there are any peripherals present and potentially active on those pins. Because as soon as you activate a peripheral that is shared with GPIO, the peripheral takes precedence and the GPIO is disconnected from the pins. So if you enable SPI on that port, it is going to disable 4 GPIO pins for you: MOSI, MISO, SS and SCLK. You can no longer use those pins for GPIO while SPI is enabled. And if there is a module routing register, you must check how it is configured."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481120975, "post_id": 41018178, "comment_id": 69247147, "body": "If you don&#39;t know about pull resistors nor about signal de-bouncing, you cannot possibly succeed in writing a program which reads a keyboard. You&#39;ll have to study these things... it&#39;s usually found in any beginner-level material on embedded systems programming. Pretty much any button out there will need both pull resistors and de-bouncing to work. You can use internal or external pull resistors. You can use software de-bouncing or a hardware RC filter."}], "owner": {"reputation": 35, "user_id": 5558046, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/281d26d9ceea9c35d15338736b6f7827?s=128&d=identicon&r=PG&f=1", "display_name": "user_1", "link": "https://stackoverflow.com/users/5558046/user-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481118441, "creation_date": 1481115631, "last_edit_date": 1481118441, "question_id": 41018178, "link": "https://stackoverflow.com/questions/41018178/prompting-a-user-to-press-a-certain-key-in-c", "title": "prompting a user to press a certain key in c", "body": "<p>I am using icc12 (ImageCraft) and a hc6812 microcontroller.  I want to prompt the user to press the zero key on the LCD keypad for the next menu to appear on the LCD display.  I can't seem to get my code to do this.  ( zero key pressed = 0b11110000)</p>\n\n<pre><code>  if ((PTH &amp; 0x1f) != 0x10) // if zero key pressed...\n  {\n\n  lcd_init();  // initialise the lcd module\n  lcd_clear(); // clear the lcd module\n\n  lcd_putstr(\" *New menu is displayed* \");\n  }\n</code></pre>\n\n<p>The keypad makes use of the upper 5 bits of Port H, it has 16 keys (0-f) and the most upper bit is high when the key that is pressed is odd and it is low when the key pressed is high. \nPort H is an input port which is connected to the keypad on my LCD module.\nI'm trying to make use of a mask to show when the zero key is pressed but when I run the program the LCD module display goes straight to the new menu.  Is masking the best way to do this and if so how can I change my IF statement for the code to function properly?</p>\n"}, {"tags": ["c", "linux-kernel"], "answers": [{"tags": [], "owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "is_accepted": false, "score": 6, "last_activity_date": 1481115564, "creation_date": 1481115564, "answer_id": 41018150, "question_id": 41018115, "link": "https://stackoverflow.com/questions/41018115/why-does-the-linux-kernel-define-a-symbol-as-itself/41018150#41018150", "title": "Why does the Linux kernel #define a symbol as itself?", "body": "<p>Trick to ensure <code>#if defined(__arch_swahb32)</code> passes but doesn't replace. (Often used to implement macro type functions)</p>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 15, "last_activity_date": 1481115689, "creation_date": 1481115689, "answer_id": 41018204, "question_id": 41018115, "link": "https://stackoverflow.com/questions/41018115/why-does-the-linux-kernel-define-a-symbol-as-itself/41018204#41018204", "title": "Why does the Linux kernel #define a symbol as itself?", "body": "<p>Consider the following code:</p>\n\n<pre><code>#ifdef foo\n    foo();\n#endif\n</code></pre>\n\n<p>If you want a snippet like the above to call function <code>foo</code>, you need to define <code>foo</code>. However, if you just</p>\n\n<pre><code>#define foo\n</code></pre>\n\n<p>then the function <code>foo</code> name will be replaced with an empty token, and the first snippet is preprocessed to just <code>();</code>. If, however, you</p>\n\n<pre><code>#define foo foo\n</code></pre>\n\n<p>then the first snippet will preprocess to <code>foo();</code> as it should.</p>\n"}], "owner": {"reputation": 553, "user_id": 887412, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8qd93.jpg?s=128&g=1", "display_name": "IljaBek", "link": "https://stackoverflow.com/users/887412/iljabek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 41018204, "answer_count": 2, "score": 14, "last_activity_date": 1481115746, "creation_date": 1481115472, "last_edit_date": 1481115746, "question_id": 41018115, "link": "https://stackoverflow.com/questions/41018115/why-does-the-linux-kernel-define-a-symbol-as-itself", "title": "Why does the Linux kernel #define a symbol as itself?", "body": "<p>In the Linux kernel, <a href=\"https://github.com/Constellation/linux-3.10.17/blob/master/arch/blackfin/include/uapi/asm/swab.h\" rel=\"noreferrer\">there can be found a line of code</a> that looks redundant to me:</p>\n\n<pre><code>#define __arch_swahb32 __arch_swahb32\n</code></pre>\n\n<p>What is the purpose of an idiom like this?</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 7262246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363494413fae5bdb07013ff61d42c85c?s=128&d=identicon&r=PG", "display_name": "Sajed Almorsy", "link": "https://stackoverflow.com/users/7262246/sajed-almorsy"}, "edited": false, "score": 0, "creation_date": 1481409238, "post_id": 41017996, "comment_id": 69368162, "body": "I already made that but at that case I only can update the time when the player make an action so I could calculate and print the new time  but what I need is if the player was idle for a minute it should be updated automaticly."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 2, "last_activity_date": 1481115142, "creation_date": 1481115142, "answer_id": 41017996, "question_id": 41017852, "link": "https://stackoverflow.com/questions/41017852/adding-an-ascending-timer-to-a-program/41017996#41017996", "title": "Adding an ascending timer to a program", "body": "<p>You can simply use <a href=\"https://linux.die.net/man/2/time\" rel=\"nofollow noreferrer\"><code>time()</code></a>.</p>\n\n<p>Call it once as the game starts, and remember the value:</p>\n\n<pre><code>const time_t time_start = time(NULL);\n</code></pre>\n\n<p>Then in your main loop (I assume you have one), compute the elapsed time:</p>\n\n<pre><code>const time_t elapsed = time(NULL) - time_start;\n</code></pre>\n\n<p>This value is the time in seconds since the game started, and you can format that into a string and display that as needed.</p>\n"}], "owner": {"reputation": 61, "user_id": 7262246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363494413fae5bdb07013ff61d42c85c?s=128&d=identicon&r=PG", "display_name": "Sajed Almorsy", "link": "https://stackoverflow.com/users/7262246/sajed-almorsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1481115142, "creation_date": 1481114680, "last_edit_date": 1481115023, "question_id": 41017852, "link": "https://stackoverflow.com/questions/41017852/adding-an-ascending-timer-to-a-program", "title": "Adding an ascending timer to a program", "body": "<p>I am making a simple game with c , I need to add a time counter showing time passed after the user types s (to start the game), I need it to be updated every second without affecting the other printed items, and I have no idea how could it count the time regardless what the user is doing in the game!</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1481114497, "post_id": 41017764, "comment_id": 69242481, "body": "<i>Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a Minimal, Complete, and Verifiable example.</i>"}, {"owner": {"reputation": 20345, "user_id": 6094348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JPVct.jpg?s=128&g=1", "display_name": "Yousaf", "link": "https://stackoverflow.com/users/6094348/yousaf"}, "edited": false, "score": 0, "creation_date": 1481114557, "post_id": 41017764, "comment_id": 69242525, "body": "Instead of posting link to an image, post your code here."}, {"owner": {"reputation": 2866, "user_id": 2584786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KbRVX.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/2584786/neo"}, "edited": false, "score": 0, "creation_date": 1481114560, "post_id": 41017764, "comment_id": 69242529, "body": "Post your code as code, not an image.  The folks you want to have help will not waste time with this question."}, {"owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1481115206, "post_id": 41017764, "comment_id": 69242989, "body": "Have you tried rounding 100.0 times input? I am guessing right now your code is truncating 419.99 something."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1481121202, "post_id": 41017764, "comment_id": 69247313, "body": "Teaching you the best way to ask your questions (&quot;don&#39;t post code as an image&quot;, &quot;use a relevant title&quot;) <i>is</i> helpful, and the people you sneer at for &quot;complaining&quot; <i>are</i> attempting to help you."}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1481115415, "last_edit_date": 1495542293, "creation_date": 1481114996, "answer_id": 41017952, "question_id": 41017764, "link": "https://stackoverflow.com/questions/41017764/why-is-100-4-2-coming-out-as-419-and-not-420/41017952#41017952", "title": "Why is 100 * 4.2 coming out as 419 and not 420?", "body": "<p><code>4.2</code> cannot be expressed exactly with the binary floating point format used on you platform. When you multiply it by <code>100</code>, it gives a number that is just slightly smaller than <code>420</code>. Converting it to an integer yields <code>419</code>.</p>\n\n<p>You can prevent this by rounding the number prior to conversion with:</p>\n\n<pre><code>int n = round(number);\n</code></pre>\n\n<p>Or by adding a rounding adjustment:</p>\n\n<pre><code>int n = (int)(number + 0.5);\n</code></pre>\n\n<p>Do not use <code>float</code> for this computation, use a properly rounded amount of cents as explained on this answer: <a href=\"https://stackoverflow.com/questions/40765164/integer-overflow-in-greedy-coin-counting/40766857?s=3|0.1803#40766857\">Integer overflow in greedy coin counting</a>.</p>\n"}], "owner": {"reputation": 413, "user_id": 6906156, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/b9e01ff805da23a9163bd01fc225ec7d?s=128&d=identicon&r=PG&f=1", "display_name": "4rshdeep", "link": "https://stackoverflow.com/users/6906156/4rshdeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "closed_date": 1481335818, "answer_count": 1, "score": -4, "last_activity_date": 1481335612, "creation_date": 1481114443, "last_edit_date": 1481335612, "question_id": 41017764, "link": "https://stackoverflow.com/questions/41017764/why-is-100-4-2-coming-out-as-419-and-not-420", "closed_reason": "Duplicate", "title": "Why is 100 * 4.2 coming out as 419 and not 420?", "body": "<p>Can't figure out error in my code when 4.2 is input as change will be then 420 but instead is coming out to be 419. What is wrong in my code?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;cs50.h&gt;\n\nint evaluate(int change){\n\n    int quarter,dime,nickel,penny;\n    int coins = 0;\n\n    quarter = change/25;\n    change = change%25;\n    printf(\"quarters:%d\\n\" ,quarter);\n    printf(\"change left: %d\\n\",change);\n    dime = change/10;\n    change = change%10;\n\n    printf(\"dimes:%d\\n\" ,dime);\n    printf(\"change left: %d\\n\",change);\n    nickel = change/5;\n    change = change%5;\n\n    printf(\"nickels:%d\\n\" ,nickel);\n    printf(\"change left: %d\\n\",change);\n    penny = change;\n    coins = quarter+dime+nickel+penny;\n\n    printf(\"pennies:%d\\n\" ,penny);\n    printf(\"change left: %d\\n\",change);\n    return coins;\n}\n\n\nint main()\n{\n    printf(\"How much:\");\n    float input = GetFloat();\n    int coin = 0;\n\n    while(true)\n    {\n        if(input&gt;0)\n        {\n            int change = (100*input);\n                printf(\"change: %d\\n\",change);\n\n            coin = evaluate(change);\n\n            printf(\"%d\\n\",coin);\n            return 0;\n        }    \n\n        else\n        {\n            printf(\"are you serious? retry:\");\n            input = GetFloat();\n    }    }\n}\n</code></pre>\n\n<p>The program is to evaluate the least number of coins a cashier has to give to customer. Problem is that on getting input 4.2, the output is coming out wrong; also <code>change=100*input</code> is coming out to be 419 for input to be 4.2. Please help me figure out problem.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yViCc.png\" rel=\"nofollow noreferrer\">Code on left side and output on right.</a></p>\n"}, {"tags": ["c", "string", "function", "security", "c++11"], "comments": [{"owner": {"reputation": 9524, "user_id": 1403794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1420515a7407d0b5867ad3fe6f37f0?s=128&d=identicon&r=PG", "display_name": "Kris Vandermotten", "link": "https://stackoverflow.com/users/1403794/kris-vandermotten"}, "edited": false, "score": 1, "creation_date": 1481116426, "post_id": 41017227, "comment_id": 69243855, "body": "You might want to read <a href=\"https://ericlippert.com/2012/12/17/performance-rant/\" rel=\"nofollow noreferrer\">ericlippert.com/2012/12/17/performance-rant</a>"}], "answers": [{"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 0, "last_activity_date": 1481113247, "creation_date": 1481113247, "answer_id": 41017367, "question_id": 41017227, "link": "https://stackoverflow.com/questions/41017227/are-secured-functions-in-c-faster-than-unsecured-ones-or-vice-versa/41017367#41017367", "title": "Are secured functions in C faster than unsecured ones or vice versa?", "body": "<p>The standard makes no requirements for the relative speeds of the functions you mention.</p>\n\n<p>There is no intrinsic reason why there should be a <em>measurable</em> difference between the <code>_s</code> suffixed versions and the plain ones, so the answer, as always, is, \"it depends on the implementation\".</p>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 2, "last_activity_date": 1481116151, "creation_date": 1481116151, "answer_id": 41018379, "question_id": 41017227, "link": "https://stackoverflow.com/questions/41017227/are-secured-functions-in-c-faster-than-unsecured-ones-or-vice-versa/41018379#41018379", "title": "Are secured functions in C faster than unsecured ones or vice versa?", "body": "<p>\"Secure\" only means better protection against buffer overrun. So it must have one or more counter(s) it maintains. When an implementation uses an identical code base for secure and non-secure functions, theoretically the secure versions must be slower as they maintain one or more additional counter(s).</p>\n\n<p>However, the cpu usage thereto is negligable compared to the complexity of the base functions. In other words: don't bother about this; you can't even measure it.</p>\n"}, {"comments": [{"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 1, "creation_date": 1481120044, "post_id": 41019428, "comment_id": 69246458, "body": "That&#39;s arguably because, in C++, you should not be using any of these functions. You should be using <code>std::string</code> and/or streams instead."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 3, "last_activity_date": 1481121099, "last_edit_date": 1481121099, "creation_date": 1481119372, "answer_id": 41019428, "question_id": 41017227, "link": "https://stackoverflow.com/questions/41017227/are-secured-functions-in-c-faster-than-unsecured-ones-or-vice-versa/41019428#41019428", "title": "Are secured functions in C faster than unsecured ones or vice versa?", "body": "<p>The <code>_s</code> suffixed i.e. the bounds checked functions are specified to behave in the same way as their non-checked versions, except that in addition, they are required to perform additional checks at runtime to guarantee that the preconditions are met. The non-checked versions instead are free to assume that the checks have already been made.</p>\n\n<p>Usually, doing something takes more time than not doing it, so one would expect that it would be possible to implement the non-checked versions more efficiently, than the checked versions.</p>\n\n<p>However, the difference may (but might not) be insignificant or nonexistent, for example if the implementation has chosen to perform the checks also in the \"non-checked\" version - which is not forbidden by the standard. Of course, in the cases where additional information is passed to the checked function, then the non-checked function can't necessarily preform all the checks that the checked function is required to do.</p>\n\n<p>P.S. the bounds checked functions were introduced in the TR 24731-1 document. They are an <em>optional</em> part of C standard library since C11. You've tagged the question as C++ too, so should probably need to know that they are not part of any C++ standard - not even optionally.</p>\n"}], "owner": {"reputation": 169, "user_id": 7012418, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/38a3c9ae60998edc97f2892a18e26543?s=128&d=identicon&r=PG&f=1", "display_name": "Vess", "link": "https://stackoverflow.com/users/7012418/vess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 41019428, "answer_count": 3, "score": 0, "last_activity_date": 1481121099, "creation_date": 1481112881, "question_id": 41017227, "link": "https://stackoverflow.com/questions/41017227/are-secured-functions-in-c-faster-than-unsecured-ones-or-vice-versa", "title": "Are secured functions in C faster than unsecured ones or vice versa?", "body": "<p>For example is swprintf vs swprintf_s or wcstombs vs wcstombs_s faster/slower ? We give it some more information, so I beleave it is faster, but than again, if something is more secure, there must be some kind of trade-off ?</p>\n"}, {"tags": ["c", "arrays", "struct", "fwrite", "fread"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1481112280, "post_id": 41016964, "comment_id": 69241054, "body": "Welcome to Stack Overflow! It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1481112352, "post_id": 41016964, "comment_id": 69241096, "body": "Pointers are specific to a single process. You can&#39;t save pointers. There&#39;s no way of loading pointers into another process, not even if it&#39;s the same program. Either use arrays, or come up with a way to <a href=\"https://en.wikipedia.org/wiki/Serialization\" rel=\"nofollow noreferrer\"><i>serialize</i></a> the data in each structure. And yes, the pointers are all you save."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1481112560, "post_id": 41016964, "comment_id": 69241242, "body": "As for the matter of arrays, you allocate <code>SLENG</code> characters for each string, always and unconditionally. That&#39;s really no better than having a compile-time fixed size array."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1481112561, "post_id": 41016964, "comment_id": 69241243, "body": "You probably want to store the strings directly into the structure like this <code>typedef struct Song { char name[SLENG];  char nameSong[SLENG]; ...</code> rather than have pointers. BTW your comment <code>#define SLENG   50 &#47;&#47;just a random value</code> is inappropriate; it&#39;s not <i>just a random value</i>, it&#39;s nthe length you allocate for your strings."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1481112643, "post_id": 41016964, "comment_id": 69241293, "body": "Lastly, your allocation for the <code>Song</code> structures is wrong. You need to be allocating <code>some_number * sizeof(Song)</code> bytes."}, {"owner": {"reputation": 834, "user_id": 7131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a1cf5eb86c98bcf94e80e722fff20e?s=128&d=identicon&r=PG&f=1", "display_name": "Fefux", "link": "https://stackoverflow.com/users/7131047/fefux"}, "edited": false, "score": 0, "creation_date": 1481112919, "post_id": 41016964, "comment_id": 69241438, "body": "And another thing, there is no malloc without free. If you need to allocate memory, you need to free them"}], "answers": [{"comments": [{"owner": {"reputation": 834, "user_id": 7131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a1cf5eb86c98bcf94e80e722fff20e?s=128&d=identicon&r=PG&f=1", "display_name": "Fefux", "link": "https://stackoverflow.com/users/7131047/fefux"}, "edited": false, "score": 0, "creation_date": 1481113606, "post_id": 41017101, "comment_id": 69241897, "body": "You reversed arguments in calloc function"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 834, "user_id": 7131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a1cf5eb86c98bcf94e80e722fff20e?s=128&d=identicon&r=PG&f=1", "display_name": "Fefux", "link": "https://stackoverflow.com/users/7131047/fefux"}, "edited": false, "score": 0, "creation_date": 1481113998, "post_id": 41017101, "comment_id": 69242140, "body": "@Fefux: The order of arguments to <code>calloc()</code> does not have any impact, but it is indeed documented as <code>void *calloc(size_t nmemb, size_t size);</code> in the C Standard, which is inconsistent with <code>size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream);</code> and <code>fwrite()</code>, although consistent with <code>bsearch</code> and <code>qsort</code>."}, {"owner": {"reputation": 834, "user_id": 7131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a1cf5eb86c98bcf94e80e722fff20e?s=128&d=identicon&r=PG&f=1", "display_name": "Fefux", "link": "https://stackoverflow.com/users/7131047/fefux"}, "edited": false, "score": 0, "creation_date": 1481114121, "post_id": 41017101, "comment_id": 69242217, "body": "Yes, but it&#39;s just to be accorded with the documentation"}, {"owner": {"reputation": 41, "user_id": 7219907, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wtO5xdr03WI/AAAAAAAAAAI/AAAAAAAAAts/xaqO7NCVpzM/photo.jpg?sz=128", "display_name": "Justinas Dauk\u0161a", "link": "https://stackoverflow.com/users/7219907/justinas-dauk%c5%a1a"}, "edited": false, "score": 0, "creation_date": 1481116774, "post_id": 41017101, "comment_id": 69244112, "body": "Thanks for your help, you literaly saved me! :)"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 2, "last_activity_date": 1481113716, "last_edit_date": 1481113716, "creation_date": 1481112562, "answer_id": 41017101, "question_id": 41016964, "link": "https://stackoverflow.com/questions/41016964/c-doesnt-load-info-from-file-fread-fwrite/41017101#41017101", "title": "C doesn&#39;t load info from file (fread, fwrite)", "body": "<p>In order to save the structure to a file, it must only contain scalar values, not pointers into memory objects.  Modify your structure to use arrays instead of pointers:</p>\n\n<pre><code>typedef struct Song {\n    char name[SLENG];\n    char nameSong[SLENG];\n    char timeSong[SLENG];\n    int date;\n} Song;\n</code></pre>\n\n<p>And modify the code accordingly, but note that:</p>\n\n<ul>\n<li>saving and reading the structures to and from a file requires opening it in binary mode <code>\"wb\"</code> and <code>\"rb\"</code>.</li>\n<li>it is <strong>very misleading</strong> to name a binary file <code>array.txt</code>.</li>\n<li>you do not need to pass the address of the count when writing to the file, but you need to pass the address of the array pointer when reading as you do not know yet how much memory to allocate.</li>\n</ul>\n\n<p>Here is the modified code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define SLENG   50   // this value is used in the file format\n\ntypedef struct Song {\n    char name[SLENG];\n    char nameSong[SLENG];\n    char timeSong[SLENG];\n    int date;\n} Song;\n\nint saveToFile(Song *x, int songCount) { //Saves info  to the binary file\n    FILE *f = fopen(\"array.bin\", \"wb\");\n    if (f == NULL) {\n        printf(\"Error\\n\");\n        return -1;\n    }\n    fwrite(songCount, sizeof(int), 1, f);\n    int written = fwrite(x, sizeof(struct Song), songCount, f);\n    fclose(f);\n    return written;\n}\n\nint readSong(Song **x, int *songCount) { //Reads info from the file and writes it\n    int count = 0;\n    FILE *fr = fopen(\"array.bin\", \"rb\");\n    if (fr == NULL)  {\n        printf(\"Error\\n\");\n        return -1;\n    }\n    printf(\"Songs:\\n\");\n    fread(&amp;count, sizeof(int), 1, fr);\n    *x = calloc(count, sizeof(Song));\n    if (*x == NULL) {\n        printf(\"Cannot allocate %d bytes of memory\\n\", count);\n        fclose(fr);\n        return -1;\n    }\n    int found = fread(*x, sizeof(struct Song), count, fr);\n    for (int i = 0; i &lt; found; i++) {\n        printf(\"%d. %s %s %s %d\\n\", i + 1,\n               (*x)[i].name, (*x)[i].nameSong, (*x)[i].timeSong, (*x)[i].date);\n    }\n    fclose(fr);\n    return *songCount = found;\n}\n\nvoid insertSong(Song *x, int Count) { //Inserts new song into the array.\n    printf(\"\\nInsert name of the band:\\n\");\n    scanf(\"%49s\", x[Count].name);\n\n    printf(\"Insert name of the song:\\n\");\n    scanf(\"%49s\", x[Count].nameSong);\n\n    printf(\"Insert length of the song:\\n\");\n    scanf(\"%49s\", x[Count].timeSong);\n\n    printf(\"Insert then song was created:\\n\");\n    scanf(\"%d\", &amp;(x[Count].date));\n    printf(\"\\n\");\n}\n\nint main(void) {\n    int songCount, menuOption;\n    Song *x = NULL;\n\n    printf(\"1. insert song\\n 2. load from file\\n \");\n    scanf(\"%d\", &amp;menuOption);\n\n    switch (menuOption) {\n      case 1:\n        printf(\"Insert how many songs do you want to input?\\n\");\n        if (scanf(\"%d\", &amp;songCount) == 1) {\n            x = calloc(songCount, sizeof(Song));\n            for (int i = 0; i &lt; songCount; i++) {\n                insertSong(x, i);\n            }\n            saveToFile(x, songCount);\n        }\n        break;\n      case 2:\n        readSong(&amp;x, &amp;songCount);\n        break;\n    }\n    free(x);\n    x = NULL;\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7219907, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wtO5xdr03WI/AAAAAAAAAAI/AAAAAAAAAts/xaqO7NCVpzM/photo.jpg?sz=128", "display_name": "Justinas Dauk\u0161a", "link": "https://stackoverflow.com/users/7219907/justinas-dauk%c5%a1a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 41017101, "answer_count": 1, "score": 1, "last_activity_date": 1481113716, "creation_date": 1481112186, "question_id": 41016964, "link": "https://stackoverflow.com/questions/41016964/c-doesnt-load-info-from-file-fread-fwrite", "title": "C doesn&#39;t load info from file (fread, fwrite)", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define SLENG   50 //just a random value\n\ntypedef struct Song \n{\n    char *name;\n    char *nameSong;\n    char *timeSong;\n    int date;\n}  Song;\n\nvoid saveToFile(Song *x, int *songCount) //Saves info  to the binary file\n{\n    FILE *f = fopen(\"array.txt\", \"w\");\n    if (f == NULL)\n    {\n        printf(\"Error\\n\");\n    }\n    fwrite(songCount, sizeof(int), 1, f);\n    fwrite(x, sizeof(struct Song), (*songCount), f);\n    fclose(f);\n}\n\nvoid readSong(Song *x, int *songCount) //Reads info fromt he file and writes it\n{\n    FILE *fr = fopen(\"array.txt\", \"r\");\n    if (fr == NULL)\n    {\n        printf(\"Error\\n\");\n    }\n    printf(\"Songs:\\n\");\n    fread(songCount, sizeof(int), 1, fr);\n    fread(x, sizeof(struct Song), (*songCount), fr);\n    for(int i=0; i &lt; (*songCount); i++)\n    {\n        printf(\"%d. %s %s %s %d\\n\", (i+1), x[i].name, x[i].nameSong, x[i].timeSong, x[i].date);\n    }\n    fclose(fr);\n}\n\nvoid insertSong(Song *x, int Count) //Inserts new song into the array.\n{\n    printf(\"\\nInsert name of the band:\\n\");\n    x[Count].name=malloc(SLENG * sizeof(char));\n    scanf(\"%s\", x[Count].name);\n\n    printf(\"Insert name of the song:\\n\");\n    x[Count].nameSong=malloc(SLENG * sizeof(char));\n    scanf(\"%s\", x[Count].nameSong);\n\n    printf(\"Insert length of the song:\\n\");\n    x[Count].timeSong=malloc(SLENG * sizeof(char));\n    scanf(\"%s\", x[Count].timeSong);\n\n    printf(\"Insert then song was created:\\n\");\n    scanf(\"%d\", &amp;(x[Count].date));\n    printf(\"\\n\");\n}\n\nmain()\n{\n    int songCount, menuOption;\n    Song *x=malloc(SLENG*sizeof(char)+SLENG*sizeof(char)+SLENG*sizeof(char)+sizeof(int));\n    printf(\"1. insert song\\n 2. load from file\\n \");\n    scanf(\"%d\", &amp;menuOption);\n    switch(menuOption)\n    {\n        case(1) :\n            printf(\"Insert how many songs do you want to input?\\n\");\n            scanf(\"%d\", &amp;songCount);\n            for(int i=0; i&lt;songCount; i++)\n            {\n                insertSong(x, i);\n            }\n            saveToFile(x, &amp;songCount);\n            break;\n        case(2) :\n            readSong(x, &amp;songCount);\n            break;\n    }\n}\n</code></pre>\n\n<p>I have an assingment to write a programm which would input some data into file and could read that data from that file, the problem is probably with fwrite or fread, couse it seems to crash everytime I try to load the and write the data from file. Any ideas why is it not working properly? And can I even do it like this as it is dynamic struct array. Thanks in advance.</p>\n"}, {"tags": ["c++", "c", "sdl", "sdl-2"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1481117507, "post_id": 41016962, "comment_id": 69244658, "body": "Why don&#39;t you benchmark?"}], "answers": [{"comments": [{"owner": {"reputation": 4998, "user_id": 7233423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810e59b837c9e8b352615784397db0ea?s=128&d=identicon&r=PG&f=1", "display_name": "xhienne", "link": "https://stackoverflow.com/users/7233423/xhienne"}, "edited": false, "score": 0, "creation_date": 1481113194, "post_id": 41017038, "comment_id": 69241606, "body": "And this is without saying that reinventing the wheel (drawing a rectangle) is a total loss of time and will probably add a new bunch of bugs to your program. There is absolutely no benefit."}, {"owner": {"reputation": 203, "user_id": 3005530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/84ad6eb2a1ae42cd4f31260a41414bbf?s=128&d=identicon&r=PG&f=1", "display_name": "83457", "link": "https://stackoverflow.com/users/3005530/83457"}, "reply_to_user": {"reputation": 4998, "user_id": 7233423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810e59b837c9e8b352615784397db0ea?s=128&d=identicon&r=PG&f=1", "display_name": "xhienne", "link": "https://stackoverflow.com/users/7233423/xhienne"}, "edited": false, "score": 0, "creation_date": 1481143002, "post_id": 41017038, "comment_id": 69261081, "body": "@xhienne No, reinventing the wheel would not add any bugs to any program, I know exactly how I&#39;d go about it (it&#39;s actually quite simple, I briefly described it in my question). And there is benefit, because my reasoning behind this question was that I plan to create a program that fills non-rectangular shapes. As SDL does not have a direct function for this, I can either fill all rectangles within the said shape, or individually fill every pixel in the shape, which was the motivation behind the question."}, {"owner": {"reputation": 203, "user_id": 3005530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/84ad6eb2a1ae42cd4f31260a41414bbf?s=128&d=identicon&r=PG&f=1", "display_name": "83457", "link": "https://stackoverflow.com/users/3005530/83457"}, "reply_to_user": {"reputation": 4998, "user_id": 7233423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810e59b837c9e8b352615784397db0ea?s=128&d=identicon&r=PG&f=1", "display_name": "xhienne", "link": "https://stackoverflow.com/users/7233423/xhienne"}, "edited": false, "score": 0, "creation_date": 1481143085, "post_id": 41017038, "comment_id": 69261114, "body": "@xhienne Regardless, there is absolutely nothing wrong with reinventing the wheel for practising, understanding and gaining experience."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 3, "last_activity_date": 1481112416, "creation_date": 1481112416, "answer_id": 41017038, "question_id": 41016962, "link": "https://stackoverflow.com/questions/41016962/does-drawing-a-rectangle-on-the-screen-using-renderdrawrect-take-the-same-length/41017038#41017038", "title": "Does drawing a rectangle on the screen using RenderDrawRect take the same length of time as filling in every required pixel using RenderDrawPoint?", "body": "<p>Yes, that would be my absolute expectation.</p>\n\n<p>Even if there was no hardware acceleration going on, there's more overhead in doing one function call per pixel. Think of just computing the address inside the surface where each pixel is going to be written: the pixel-at-a-time needs to compute that fresh every time, while the rectangle code must likely can re-use the last value it computed for the vast majority of writes. These things matter.</p>\n\n<p>But there very likely <em>is</em> hardware acceleration, so the difference in performance can be great.</p>\n\n<p>Always use the most high-level API function you can, to give more leverage for optimization and acceleration.</p>\n"}], "owner": {"reputation": 203, "user_id": 3005530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/84ad6eb2a1ae42cd4f31260a41414bbf?s=128&d=identicon&r=PG&f=1", "display_name": "83457", "link": "https://stackoverflow.com/users/3005530/83457"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1481112416, "creation_date": 1481112173, "question_id": 41016962, "link": "https://stackoverflow.com/questions/41016962/does-drawing-a-rectangle-on-the-screen-using-renderdrawrect-take-the-same-length", "title": "Does drawing a rectangle on the screen using RenderDrawRect take the same length of time as filling in every required pixel using RenderDrawPoint?", "body": "<p>Let's say I wanted to draw a <em>50px</em> by <em>60px</em> rectangle in SDL2 starting from the point (0,0). Is it faster to call <code>SDL_RenderDrawRect</code> <code>(renderer, SDL_Rect structure)</code> than to fill in every individual pixel using a nested for loop and calling <code>SDL_RenderDrawPoint</code>?</p>\n\n<p>Or do both operations take the same length of time (which is what I think would happen)? I tried looking at the SDL source code, although I had difficulty fully understanding the functions for rendering.</p>\n"}, {"tags": ["c", "openmp"], "comments": [{"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1481110676, "post_id": 41016279, "comment_id": 69240030, "body": "@squeamishossifrage I did include a sample input and the correct output. The code computes the permanent of a +-1 matrix.  I am not sure how to get useful info from a debugger for this problem. Any help much appreciated. Maybe I just have the wrong compile flags?"}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1481110851, "post_id": 41016279, "comment_id": 69240149, "body": "@eleanora do you get the correct result if you remove <code>-qopenmp</code>?"}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1481110915, "post_id": 41016279, "comment_id": 69240190, "body": "@davmac Yes! That&#39;s a great spot. (It of course now warns &quot;warning #3180: unrecognized OpenMP #pragma&quot; and only runs on one core.)"}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 1, "creation_date": 1481111291, "post_id": 41016279, "comment_id": 69240409, "body": "@eleanora I don&#39;t know much about OpenMP, so I can only suggest then that it&#39;s either a bug in Intel&#39;s implementation or that your code breaks some restriction that doesn&#39;t matter in GCC&#39;s implementation. Maybe someone else here on SO will know better."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1481128016, "post_id": 41016279, "comment_id": 69252102, "body": "@squeamishossifrage Sure, there are things to improve, but the original question already contained a complete and verifiable example with compilation instruction, compiler versions, expected vs actual output. That easily makes it into the top10% questions on [openmp]."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1481129779, "post_id": 41016279, "comment_id": 69253312, "body": "Can I install the Intel C compiler on ubuntu ? How can I do it ?"}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "reply_to_user": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1481130319, "post_id": 41016279, "comment_id": 69253623, "body": "@alinsoar You can get a trial for free.  Just go to their website or do an Internet search."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1481157753, "post_id": 41016279, "comment_id": 69267409, "body": "@eleanora thanks. I remember I tried once and I gave up due to unclear instructions for ubuntu."}], "answers": [{"comments": [{"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1481193193, "post_id": 41021477, "comment_id": 69281810, "body": "Out of interest, is this a known bug? For example, should I report it?"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 1, "creation_date": 1481195738, "post_id": 41021477, "comment_id": 69283448, "body": "Please report it and keep the question updated. I can&#39;t tell whether it is known or not. At least it seems like a trivial fix for Intel."}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 7, "last_activity_date": 1481124989, "creation_date": 1481124989, "answer_id": 41021477, "question_id": 41016279, "link": "https://stackoverflow.com/questions/41016279/intel-c-compiler-giving-the-wrong-output-when-using-openmp/41021477#41021477", "title": "Intel C Compiler giving the wrong output when using openmp", "body": "<p>Looks like a bug in Intel's handling of OpenMP reduction on <code>__int128</code> type variables. This can be easily reproduced:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;inttypes.h&gt;\n\nint main() {\n    __int128 sum = 0;\n    #pragma omp parallel for reduction(+:sum)\n    for (int i = 0; i &lt; 0; i++) {\n        sum += 1;\n    }\n    printf(\"%\" PRIX64 \" %\" PRIX64 \"\\n\", (uint64_t)sum, (uint64_t)(sum &gt;&gt; 64));\n}\n</code></pre>\n\n<p>Output with <code>-fopenmp</code>:</p>\n\n<blockquote>\n  <p>14000000000 78778300</p>\n</blockquote>\n\n<p>Correct output without, or with <code>gcc -fopenmp</code>:</p>\n\n<blockquote>\n  <p>0 0</p>\n</blockquote>\n\n<p>You can work around that (and keep the <code>__int128</code> type) by using a trivial custom reduction declaration:</p>\n\n<pre><code>#pragma omp declare reduction(add128: int128_t: omp_out = omp_out + omp_in) initializer(omp_priv = 0)\n[...]\n#pragma omp parallel for reduction(add128:permanent) num_threads(NUM_THREADS)\n</code></pre>\n\n<p>As far as I can tell the standard does not restrict the type of a reduction list element. At least the compiler should tell you if it's not supported.</p>\n"}, {"comments": [{"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1481209340, "post_id": 41041272, "comment_id": 69292386, "body": "If you have a way to file an internal bug report that would be great."}], "tags": [], "owner": {"reputation": 111, "user_id": 2750457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3126cc58dfbd4c61dc7aa4924ee8d2f3?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Churbanov", "link": "https://stackoverflow.com/users/2750457/andrey-churbanov"}, "is_accepted": false, "score": 5, "last_activity_date": 1481205528, "creation_date": 1481205528, "answer_id": 41041272, "question_id": 41016279, "link": "https://stackoverflow.com/questions/41016279/intel-c-compiler-giving-the-wrong-output-when-using-openmp/41041272#41041272", "title": "Intel C Compiler giving the wrong output when using openmp", "body": "<p>Thanks for the test case, this is definitely a compiler bug in the initialization of the private copy of the reduction variable. You are free to also report the bug, though we will try to file internal bug against appropriate compiler developer.</p>\n\n<p>So, another (not-very-elegant) workaround could be to explicitly initialize the private copy, that is replace</p>\n\n<pre><code>#pragma omp parallel for reduction(+:permanent) num_threads(NUM_THREADS)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>#pragma omp parallel reduction(+:permanent) num_threads(NUM_THREADS)\n{\n  permanent = 0; // that should be done by compiler actually\n  #pragma omp for\n  ...\n}\n</code></pre>\n"}], "owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "accepted_answer_id": 41021477, "answer_count": 2, "score": 4, "last_activity_date": 1481205528, "creation_date": 1481110075, "last_edit_date": 1481124146, "question_id": 41016279, "link": "https://stackoverflow.com/questions/41016279/intel-c-compiler-giving-the-wrong-output-when-using-openmp", "title": "Intel C Compiler giving the wrong output when using openmp", "body": "<p>I am trying to use the Intel C compiler for the first time and am getting completely the wrong answers.  What am I doing wrong?</p>\n\n<p>I have some code as follows:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\n#define CHUNK_SIZE 12\n#define NUM_THREADS 8\n\n#define popcnt __builtin_popcountll\n#define BILLION (1000 * 1000 * 1000)\n#define UPDATE_ROW_PPROD() \\\n    update_row_pprod(row_pprod, row, rows, row_sums, mask, mask_popcnt)\n\ntypedef __int128 int128_t;\n\nstatic inline int64_t update_row_pprod\n(\n    int64_t* row_pprod, int64_t row, int64_t* rows,\n    int64_t* row_sums, int64_t mask, int64_t mask_popcnt\n)\n{\n    int64_t temp = 2 * popcnt(rows[row] &amp; mask) - mask_popcnt;\n\n    row_pprod[0] *= temp;\n    temp -= 1;\n    row_pprod[1] *= temp;\n    temp -= row_sums[row];\n    row_pprod[2] *= temp;\n    temp += 1;\n    row_pprod[3] *= temp;\n\n    return row + 1;\n}\n\nint main(int argc, char* argv[])\n{\n    int64_t size = argc - 1, rows[argc - 1];\n    int64_t row_sums[argc - 1];\n    int128_t permanent = 0, sign = size &amp; 1 ? -1 : 1;\n\n    if (argc == 2)\n    {\n        printf(\"%d\\n\", argv[1][0] == '-' ? -1 : 1);\n        return 0;\n    }\n\n    for (int64_t row = 0; row &lt; size; row++)\n    {\n        char positive = argv[row + 1][0] == '+' ? '-' : '+';\n\n        sign *= ',' - positive;\n        rows[row] = row_sums[row] = 0;\n\n        for (char* p = &amp;argv[row + 1][1]; *p; p++)\n        {\n            rows[row] &lt;&lt;= 1;\n            rows[row] |= *p == positive;\n            row_sums[row] += *p == positive;\n        }\n\n        row_sums[row] = 2 * row_sums[row] - size;\n    }\n\n    #pragma omp parallel for reduction(+:permanent) num_threads(NUM_THREADS)\n    for (int64_t mask = 1; mask &lt; 1LL &lt;&lt; (size - 1); mask += 2)\n    {\n        int64_t mask_popcnt = popcnt(mask);\n        int64_t row = 0;\n        int128_t row_prod = 1 - 2 * (mask_popcnt &amp; 1);\n        int128_t row_prod_high = -row_prod;\n        int128_t row_prod_inv = row_prod;\n        int128_t row_prod_inv_high = -row_prod;\n\n        for (int64_t chunk = 0; chunk &lt; size / CHUNK_SIZE; chunk++)\n        {\n            int64_t row_pprod[4] = {1, 1, 1, 1};\n\n            for (int64_t i = 0; i &lt; CHUNK_SIZE; i++)\n                row = UPDATE_ROW_PPROD();\n\n            row_prod *= row_pprod[0], row_prod_high *= row_pprod[1];\n            row_prod_inv *= row_pprod[3], row_prod_inv_high *= row_pprod[2];\n        }\n\n        int64_t row_pprod[4] = {1, 1, 1, 1};\n\n        while (row &lt; size)\n            row = UPDATE_ROW_PPROD();\n\n        row_prod *= row_pprod[0], row_prod_high *= row_pprod[1];\n        row_prod_inv *= row_pprod[3], row_prod_inv_high *= row_pprod[2];\n        permanent += row_prod + row_prod_high + row_prod_inv + row_prod_inv_high;\n    }\n\n    permanent *= sign;\n\n    if (permanent &lt; 0)\n        printf(\"-\"), permanent *= -1;\n\n    int32_t output[5], print = 0;\n\n    output[0] = permanent % BILLION, permanent /= BILLION;\n    output[1] = permanent % BILLION, permanent /= BILLION;\n    output[2] = permanent % BILLION, permanent /= BILLION;\n    output[3] = permanent % BILLION, permanent /= BILLION;\n    output[4] = permanent % BILLION;\n\n    if (output[4])\n        printf(\"%u\", output[4]), print = 1;\n    if (print)\n        printf(\"%09u\", output[3]);\n    else if (output[3])\n        printf(\"%u\", output[3]), print = 1;\n    if (print)\n        printf(\"%09u\", output[2]);\n    else if (output[2])\n        printf(\"%u\", output[2]), print = 1;\n    if (print)\n        printf(\"%09u\", output[1]);\n    else if (output[1])\n        printf(\"%u\", output[1]), print = 1;\n    if (print)\n        printf(\"%09u\\n\", output[0]);\n    else\n        printf(\"%u\\n\", output[0]);\n}\n</code></pre>\n\n<p>If I compile it with</p>\n\n<pre><code>gcc -Wall -std=c99 -fopenmp  -o permanent permanent.c\n</code></pre>\n\n<p>I can then run it with </p>\n\n<pre><code>permanent -+ -+\n</code></pre>\n\n<p>and get the output</p>\n\n<pre><code>-2\n</code></pre>\n\n<p>which is correct.</p>\n\n<p>If I instead compile using the Intel C compiler (17.0.1) with</p>\n\n<pre><code>icc -std=c99 -qopenmp -Wall permanent.c\n</code></pre>\n\n<p>and then do</p>\n\n<pre><code>a.out -+ -+\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>11910984139051480114196905982\n</code></pre>\n\n<hr>\n\n<p>As noted in the comments, if you remove the -qopenmp then icc produces a version that runs correctly, albeit only on one core. </p>\n"}, {"tags": ["c", "arrays", "function", "recursion"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1481109992, "post_id": 41016219, "comment_id": 69239640, "body": "High time to start using a debugger.\\"}, {"owner": {"reputation": 52699, "user_id": 117362, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7ae86476e784b06ed196f500777fc57?s=128&d=identicon&r=PG", "display_name": "Thorsten Dittmar", "link": "https://stackoverflow.com/users/117362/thorsten-dittmar"}, "edited": false, "score": 5, "creation_date": 1481110015, "post_id": 41016219, "comment_id": 69239650, "body": "Well, how about you write down on paper what&#39;s happening? This is surely some kind of homework to teach you recursion, so: either run the program and debug, or &quot;be the debugger&quot;."}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1481110258, "post_id": 41016219, "comment_id": 69239778, "body": "Format the code. I think you will understand the code yourself. :)"}], "answers": [{"tags": [], "owner": {"reputation": 159, "user_id": 4410805, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/077cc5690c07538b9cf21c27dea94878?s=128&d=identicon&r=PG&f=1", "display_name": "user3697625", "link": "https://stackoverflow.com/users/4410805/user3697625"}, "is_accepted": false, "score": 1, "last_activity_date": 1481110607, "last_edit_date": 1481110607, "creation_date": 1481110193, "answer_id": 41016321, "question_id": 41016219, "link": "https://stackoverflow.com/questions/41016219/i-could-not-understand-what-does-this-program-does-it-is-a-recursive-one/41016321#41016321", "title": "I could not understand what does this program does, it is a recursive one", "body": "<p>The function calculates the sum of the elements in the array recursively.</p>\n\n<p>When the function is called the first time p=10. The part <code>\nreturn b[p-1]+ whatIsThis(b,p-1)</code> will take <code>b[9]</code> and call the the function with  <code>whatIsThis(b,9)</code> which will return <code>\nreturn b[8]+ whatIsThis(b,8)</code>... all the way upto <code>\nreturn b[1]+ whatIsThis(b,1)</code> which will return <code>b[0]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 1362, "user_id": 6386250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/brwvr.jpg?s=128&g=1", "display_name": "Dr.Haimovitz", "link": "https://stackoverflow.com/users/6386250/dr-haimovitz"}, "edited": false, "score": 1, "creation_date": 1481111357, "post_id": 41016563, "comment_id": 69240459, "body": "@Dr.Haimovitz huh? What do you mean? The answer is correct and complete. It even goes beyond what was asked and points out the shortcomings of the function and suggests an improvement. What do you mean by &quot;Defently not the sum of the array.&quot; Please elaborate because as shown in the answer, it is <i>definitely</i> the sum of the elements in the array."}, {"owner": {"reputation": 1362, "user_id": 6386250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/brwvr.jpg?s=128&g=1", "display_name": "Dr.Haimovitz", "link": "https://stackoverflow.com/users/6386250/dr-haimovitz"}, "edited": false, "score": 0, "creation_date": 1481111442, "post_id": 41016563, "comment_id": 69240510, "body": "When the input &quot;size &quot; is 3 the return value is:  whatIsThis(array, 2) + array[2] = array[1] + array[1] + array[2] = 1+ 1 + 2 so you are wrong."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 1362, "user_id": 6386250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/brwvr.jpg?s=128&g=1", "display_name": "Dr.Haimovitz", "link": "https://stackoverflow.com/users/6386250/dr-haimovitz"}, "edited": false, "score": 2, "creation_date": 1481111592, "post_id": 41016563, "comment_id": 69240620, "body": "@Dr.Haimovitz with all do respect, please test something before correcting someone. You are wrong: <code>whatIsthis(arr, 3) = arr[2] + whatIThis(arr, 2) = arr[2] + arr[1] + whatIsThis(arr, 1) = arr[2] + arr[1] + arr[0] = 3 + 2 + 1 = 6</code>"}, {"owner": {"reputation": 1362, "user_id": 6386250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/brwvr.jpg?s=128&g=1", "display_name": "Dr.Haimovitz", "link": "https://stackoverflow.com/users/6386250/dr-haimovitz"}, "edited": false, "score": 0, "creation_date": 1481111726, "post_id": 41016563, "comment_id": 69240708, "body": "Im sorry my fault i thought that the stopping condition is if p equals to 0 sorry!"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1481112122, "post_id": 41016563, "comment_id": 69240942, "body": "<code>f({1,2,3},3) = 3 + f({1,2,3},2) = 3 + 2 + f({1,2,3},1) = 3 + 2 + 1 = \ud835\udf68{1,2,3}</code> for the original version."}, {"owner": {"reputation": 155, "user_id": 7261924, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/tvHRe.jpg?s=128&g=1", "display_name": "chatay", "link": "https://stackoverflow.com/users/7261924/chatay"}, "edited": false, "score": 0, "creation_date": 1481112770, "post_id": 41016563, "comment_id": 69241368, "body": "thanks for your interest and replying the question.appreciate"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 6, "last_activity_date": 1481112080, "last_edit_date": 1481112080, "creation_date": 1481110917, "answer_id": 41016563, "question_id": 41016219, "link": "https://stackoverflow.com/questions/41016219/i-could-not-understand-what-does-this-program-does-it-is-a-recursive-one/41016563#41016563", "title": "I could not understand what does this program does, it is a recursive one", "body": "<p>In order to understand code, you must read it carefully. The code posted was badly presented, which makes it hard to read, even for savvy programmers.  First indent and space the program the way I did it in my edit.</p>\n\n<p>The function <code>whatIsThis()</code> first tests if its second argument <code>p</code> has the value <code>1</code>, with a silly inverted syntax <code>(1 == p)</code> in a lame attempt to detect a potentially mistyped <code>==</code> operator: <code>1 = p</code> would be a syntax error, whereas <code>p = 1</code> would be syntactically correct but not a test on <code>p</code>.</p>\n\n<p>The name of the second argument is misleading, it is the number of elements in <code>b</code>. As such, it would be more readable to name it <code>n</code>, <code>len</code>, <code>count</code>... but not <code>p</code> which is classically used for pointers.</p>\n\n<p>If this size is 1, the function returns the value of the first element of the array.</p>\n\n<p>If not, it returns the sum of the last element and the result of a call to itself for the same array and one less element.</p>\n\n<p>Therefore the function computes the sum of the elements of the array.</p>\n\n<p>Note that this function is bogus: it cannot handle a <code>0</code> value for <code>p</code> and invokes undefined behavior. A simpler and safer version would be:</p>\n\n<pre><code>int whatIsThis(const int b[], size_t n) {\n    if (n == 0) {\n        return 0;\n    } else {\n        return b[n - 1] + whatIsThis(b, n - 1);\n    }\n}\n</code></pre>\n\n<p>Or alternatively:</p>\n\n<pre><code>int whatIsThis(const int b[], size_t n) {\n    if (n == 0) {\n        return 0;\n    } else {\n        return b[0] + whatIsThis(b + 1, n - 1);\n    }\n}\n</code></pre>\n\n<p>Of course a recursive approach for such a simple task is risky as it may recurse very deep into the stack and invoke undefined behavior for moderately large arrays.  The compiler cannot always optimize the recursion out, especially when it is not tail recursion, and this typically isn't.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 3, "last_activity_date": 1481114057, "last_edit_date": 1481114057, "creation_date": 1481112859, "answer_id": 41017220, "question_id": 41016219, "link": "https://stackoverflow.com/questions/41016219/i-could-not-understand-what-does-this-program-does-it-is-a-recursive-one/41017220#41017220", "title": "I could not understand what does this program does, it is a recursive one", "body": "<blockquote>\n  <p>What is this?</p>\n</blockquote>\n\n<p>It is a function with undefined behavior.:)</p>\n\n<p>When the second argument is equal to 0 the function tries to access memory in the position <code>p - 1</code> that in general as the type <code>size_t</code> is an unsigned type is converted to the maximum value that can be stored in an object of type <code>size_t</code>.</p>\n\n<p>Moreover as inside the function there is used the addition operation then there can be overflow for two big numbers. Thus the return type of the function should be some other larger integer type.</p>\n\n<p>So let's rewrite the function that to remove these drawbacks. The logic will be the same. </p>\n\n<pre><code>long long int whatIsThis( const int a[], size_t n ) \n{\n    return n == 0 ? 0 : a[n-1] + whatIsThis( a, n - 1 );\n}\n</code></pre>\n\n<p>Or without using the ternary (conditional) operator the function will look like</p>\n\n<pre><code>long long int whatIsThis( const int a[], size_t n ) \n{\n    if ( n == 0 ) \n    {\n        return 0;\n    }\n    else \n    {\n        return a[n-1] + whatIsThis( a, n - 1 );\n    }\n}\n</code></pre>\n\n<p>Now let-s consider how the function works. If you have an array like this</p>\n\n<pre><code>int a[10] = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };\n</code></pre>\n\n<p>You can imagine it the following way (though this code will not be compiled)</p>\n\n<pre><code>int a[10] = { { 1, 2, 3, 4, 5, 6, 7, 8, 9 }, 10 };\n</code></pre>\n\n<p>or like this</p>\n\n<pre><code>int a[10] = { a1[9], 10 };\n</code></pre>\n\n<p>where a1[9] is an array of 9 elements</p>\n\n<pre><code>int a1[9] = { 1, 2, 3, 4, 5, 6, 7, 8, 9  };\n</code></pre>\n\n<p>In turn the array a1 can be imagined like</p>\n\n<pre><code>int a1[9] = { a2[8], 9 };\n</code></pre>\n\n<p>where a2 is</p>\n\n<pre><code>int a2[8] = { 1, 2, 3, 4, 5, 6, 7, 8  };\n</code></pre>\n\n<p>and so on that at last we will get</p>\n\n<pre><code>int a8[2] = { a9[1], 2 };\n</code></pre>\n\n<p>where a9 is</p>\n\n<pre><code>int a9[1] = { 1 };\n</code></pre>\n\n<p>So what does the function do?</p>\n\n<p>For the array <code>a</code> that was imagined like</p>\n\n<pre><code>int a[10] = { { 1, 2, 3, 4, 5, 6, 7, 8, 9 }, 10 };\n</code></pre>\n\n<p>or like</p>\n\n<pre><code>int a[10] = { a1[9], 10 };\n</code></pre>\n\n<p>the function adds <code>a1[9] + 10</code></p>\n\n<p>In turn for the array <code>a1</code> that is imagined like</p>\n\n<pre><code>int a1[9] = { 1, 2, 3, 4, 5, 6, 7, 8 }, 9  };\n</code></pre>\n\n<p>or like</p>\n\n<pre><code>int a1[9] = { a2[8], 9 };\n</code></pre>\n\n<p>the function calculates <code>a2[8] + 9</code></p>\n\n<p>If to substitute <code>a1[9]</code> in the expression <code>a1[9] + 10</code> with <code>a2[8] + 9</code> then we will get <code>a2[8] + 9 + 10</code> and so on.</p>\n\n<p>So the function calculates the sum of the elements of the array.</p>\n"}], "owner": {"reputation": 155, "user_id": 7261924, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/tvHRe.jpg?s=128&g=1", "display_name": "chatay", "link": "https://stackoverflow.com/users/7261924/chatay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 41017220, "answer_count": 3, "score": 3, "last_activity_date": 1481114057, "creation_date": 1481109883, "last_edit_date": 1481113838, "question_id": 41016219, "link": "https://stackoverflow.com/questions/41016219/i-could-not-understand-what-does-this-program-does-it-is-a-recursive-one", "title": "I could not understand what does this program does, it is a recursive one", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n\n#define SIZE 10 \n\nint whatIsThis(const int b[], size_t p);\n\nint main(void) {\n    int x;\n    int a[SIZE] = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };\n\n    x = whatIsThis(a, SIZE);\n\n    printf(\"result is %d\\n\", x);\n\n    _sleep(1000 * 100);\n}\n\nint whatIsThis(const int b[], size_t p) {\n    if (1 == p) {\n        return b[0];\n    } else {\n        return b[p - 1] + whatIsThis(b, p - 1);\n    }\n}\n</code></pre>\n\n<p>Sorry to ask this question but I am almost beginner in C programming and I could not understand the logic of this program, especially <code>return b[p-1]+ whatIsThis(b,p-1);</code>.  What is the logic of this?</p>\n"}, {"tags": ["c", "global", "extern"], "comments": [{"owner": {"reputation": 22021, "user_id": 236222, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf4f3c341534395199d4dbe35a432f9d?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/236222/jay"}, "edited": false, "score": 2, "creation_date": 1481110124, "post_id": 41016218, "comment_id": 69239704, "body": "Please post your code. Also, post the callstack or the location where the segfault is happening. Else, it is very difficult to imagine the code based on your description and give a solution.  Also, you can be fairly sure, the extern keyword is not causing your seg faults. : )"}, {"owner": {"reputation": 21234, "user_id": 274261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d3be1df1fa2e3588564cdd9a4f517ad0?s=128&d=identicon&r=PG", "display_name": "ArjunShankar", "link": "https://stackoverflow.com/users/274261/arjunshankar"}, "edited": false, "score": 1, "creation_date": 1481110258, "post_id": 41016218, "comment_id": 69239779, "body": "And while you post the offending code as Jay recommends, please try to make it <a href=\"http://sscce.org/\" rel=\"nofollow noreferrer\">&quot;short, self-contained, and compile-able&quot;</a> so that those trying to answer can quickly get to the root cause."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1481112925, "post_id": 41016218, "comment_id": 69241443, "body": "Consider allocating memory <i>after</i> you know the value of x and y.  And never ignore the return value of scanf()."}, {"owner": {"reputation": 7, "user_id": 7103404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff2290cddc923427c8698c5e530e4ea?s=128&d=identicon&r=PG&f=1", "display_name": "rdx1994", "link": "https://stackoverflow.com/users/7103404/rdx1994"}, "edited": false, "score": 0, "creation_date": 1481113595, "post_id": 41016218, "comment_id": 69241891, "body": "Thank you. This solved the problem. I didn&#39;t realise this could be a problem and thought extern would be the problem."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1481117668, "post_id": 41016218, "comment_id": 69244780, "body": "<code>EXTERN</code> is <b>not</b> a keyword, but <code>extern</code> is."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 7187904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebc177f2ca9d3a7281e402356c7d05d?s=128&d=identicon&r=PG&f=1", "display_name": "MGpro", "link": "https://stackoverflow.com/users/7187904/mgpro"}, "is_accepted": false, "score": 1, "last_activity_date": 1481114169, "creation_date": 1481114169, "answer_id": 41017670, "question_id": 41016218, "link": "https://stackoverflow.com/questions/41016218/use-of-extern-keyword-in-header-file-while-its-definition-in-source-file/41017670#41017670", "title": "Use of &quot;EXTERN&quot; Keyword in header file while its definition in source file", "body": "<p>Problem is that you have x and y equal to 0 when you are allocating the memory and later you are making these memory for copy, this will lead to crash.</p>\n\n<p>You need to allocate after </p>\n\n<pre><code>scanf(\"%d\",&amp;y);\n</code></pre>\n\n<p>Also check for NULL before proceeding.</p>\n"}], "owner": {"reputation": 7, "user_id": 7103404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff2290cddc923427c8698c5e530e4ea?s=128&d=identicon&r=PG&f=1", "display_name": "rdx1994", "link": "https://stackoverflow.com/users/7103404/rdx1994"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1481114169, "creation_date": 1481109881, "last_edit_date": 1481112618, "question_id": 41016218, "link": "https://stackoverflow.com/questions/41016218/use-of-extern-keyword-in-header-file-while-its-definition-in-source-file", "title": "Use of &quot;EXTERN&quot; Keyword in header file while its definition in source file", "body": "<p>I am new to C programming and was attempting to write a code in which values of variables x and y are taken from the user in the main function of File1.c. All other functions in the file use the value of these variables. I have used 'extern' keyword to declare it in Header file Header.h and this header file also makes use of the values of x and y entered by the user. Another File2.c also makes use of these variables. Both File1.c and File2.c include Header.h </p>\n\n<p>I have defined variables x and y as global variables in File1.c but I am constantly getting segmentation faults. How should I proceed? </p>\n\n<p>EDIT:\nHere is the code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;Header.h&gt;\n int x,y;\n int main() \n{\n  uint16_t *Buffer_1 = (uint16_t *)malloc(sizeof(uint16_t) *x*y*256);\n  uint16_t *slice = (uint16_t *)malloc(sizeof(uint16_t)*x*y);\n  printf(\"Enter value of x: );\n  scanf(\"%d\",&amp;x);\n  printf(\"Enter value of y: );\n  scanf(\"%d\",&amp;y);\n  memcpy(slice,Buffer_1,x*y*sizeof(uint16_t));\n }\n</code></pre>\n\n<p>I get segmentation fault at memcpy. I have declared variables x,y in Header.h as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nextern int x;\nextern int y;\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1481109761, "post_id": 41016058, "comment_id": 69239478, "body": "Declare <code>uint8_t **buffer; </code>. You can do buffer[0][0] = 0; If you know the address, make buffer = 0xE30014."}, {"owner": {"reputation": 520, "user_id": 5455966, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/74882f5054200f9ab65418e3e1681143?s=128&d=identicon&r=PG&f=1", "display_name": "MateoConLechuga", "link": "https://stackoverflow.com/users/5455966/mateoconlechuga"}, "reply_to_user": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1481110298, "post_id": 41016058, "comment_id": 69239798, "body": "Updated post so it isn&#39;t that easy; but yes that answers the direct question, heh."}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1481110447, "post_id": 41016058, "comment_id": 69239898, "body": "Oh :( <code>However, this throws the error that an array is not a legal lvalue.</code>: What is array here? Post the exact error print."}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1481110841, "post_id": 41016058, "comment_id": 69240140, "body": "Changed <code>uint8_t</code> ro <code>char</code> and not getting any compiler errors for this: <code>#define buffer (*(char (*)[240][320])0xE30014)</code>"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1481188157, "post_id": 41016058, "comment_id": 69278377, "body": "<a href=\"http://coliru.stacked-crooked.com/a/263783a0570696f4\" rel=\"nofollow noreferrer\">Your macro works fine</a>. Of course it segfaults at runtime because <code>0xE30014</code> is an invalid address, but there isn&#39;t any compilation error."}], "answers": [{"comments": [{"owner": {"reputation": 520, "user_id": 5455966, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/74882f5054200f9ab65418e3e1681143?s=128&d=identicon&r=PG&f=1", "display_name": "MateoConLechuga", "link": "https://stackoverflow.com/users/5455966/mateoconlechuga"}, "edited": false, "score": 0, "creation_date": 1481111269, "post_id": 41016587, "comment_id": 69240398, "body": "Right, so it looks like it has to be a variable rather than a macro. I guess that is acceptable."}, {"owner": {"reputation": 22021, "user_id": 236222, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf4f3c341534395199d4dbe35a432f9d?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/236222/jay"}, "reply_to_user": {"reputation": 520, "user_id": 5455966, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/74882f5054200f9ab65418e3e1681143?s=128&d=identicon&r=PG&f=1", "display_name": "MateoConLechuga", "link": "https://stackoverflow.com/users/5455966/mateoconlechuga"}, "edited": false, "score": 0, "creation_date": 1481111909, "post_id": 41016587, "comment_id": 69240815, "body": "Yes, a variable has a type associated with it, so that should be acceptable."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1481188242, "post_id": 41016587, "comment_id": 69278433, "body": "<code>(*(uint8_t (*)[240][320])0xE30014)</code> is an lvalue of type <code>uint8_t[240][320]</code>, an actual array. That it has been obtained by dereferencing a pointer-to-array, which itself comes from a cast, is irrelevant."}], "tags": [], "owner": {"reputation": 22021, "user_id": 236222, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf4f3c341534395199d4dbe35a432f9d?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/236222/jay"}, "is_accepted": true, "score": 0, "last_activity_date": 1481111024, "creation_date": 1481111024, "answer_id": 41016587, "question_id": 41016058, "link": "https://stackoverflow.com/questions/41016058/c-pointer-to-array/41016587#41016587", "title": "C pointer to array", "body": "<p>The subscript operator <code>[]</code> can be mostly used with only arrays or pointers. But, here you are using a macro for the so called pointer which you want to use. Now, <code>buffer</code> will be directly replaced by <code>(*(uint8_t (*)[240][320])0xE30014)</code> which the compiler finds to be neither a pointer nor a declared array and hence the error.</p>\n\n<p>The compiler views your expression as a typecasted constant and doesn't view it as a pointer and hence your error.</p>\n"}, {"tags": [], "owner": {"reputation": 520, "user_id": 5455966, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/74882f5054200f9ab65418e3e1681143?s=128&d=identicon&r=PG&f=1", "display_name": "MateoConLechuga", "link": "https://stackoverflow.com/users/5455966/mateoconlechuga"}, "is_accepted": false, "score": 0, "last_activity_date": 1481186828, "last_edit_date": 1481186828, "creation_date": 1481137531, "answer_id": 41025371, "question_id": 41016058, "link": "https://stackoverflow.com/questions/41016058/c-pointer-to-array/41025371#41025371", "title": "C pointer to array", "body": "<p>I would just like to add that my acceptable answer to this solution is dereferencing the pointer and then type casting it. The extra cast is necessary because pointers to arrays and arrays are the \"same\" thing.</p>\n\n<pre><code>#define buffer (**(uint8_t(**)[240][320])0xE30014)\n</code></pre>\n"}], "owner": {"reputation": 520, "user_id": 5455966, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/74882f5054200f9ab65418e3e1681143?s=128&d=identicon&r=PG&f=1", "display_name": "MateoConLechuga", "link": "https://stackoverflow.com/users/5455966/mateoconlechuga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 41016587, "answer_count": 2, "score": 2, "last_activity_date": 1481186828, "creation_date": 1481109426, "last_edit_date": 1481110254, "question_id": 41016058, "link": "https://stackoverflow.com/questions/41016058/c-pointer-to-array", "title": "C pointer to array", "body": "<p>I have an array that is 240x320 bytes in size, and the pointer to this buffer is stored in the memory address 0xE30014. I have tried to define this as follows:</p>\n\n<pre><code>#define buffer (*(uint8_t (*)[240][320])0xE30014)\n</code></pre>\n\n<p>Because I wish to be able to index the array in a manner like this:</p>\n\n<pre><code>buffer[x][x] = some_val;\n</code></pre>\n\n<p>However, this throws the error that an array is not a legal lvalue. I was wondering what is wrong with the current define? Any help is much appreciated.</p>\n"}, {"tags": ["c", "linux", "posix"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1481111254, "post_id": 41015934, "comment_id": 69240393, "body": "malloc practically just does this"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1481116296, "post_id": 41015934, "comment_id": 69243763, "body": "What, exactly you mean by <i>commit</i>, here? Typically, <i>commit</i> is used in reference to some backing storage. In Linux, on architectures that support virtual memory, memory allocation only prepares the virtual memory for the userspace process to use; it does not actually commit them to physical RAM. That occurs on the first access (and on first write access for memory marked copy-on-write). If you are referring to memory-mapped files or devices, and having to call <code>msync()</code> after writes to ensure the mapping and the backing store are in sync, then at least I am not aware of such an API."}, {"owner": {"reputation": 1683, "user_id": 1829232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3fdd30877095f67a858777ac1b393259?s=128&d=identicon&r=PG", "display_name": "UltimaWeapon", "link": "https://stackoverflow.com/users/1829232/ultimaweapon"}, "edited": false, "score": 0, "creation_date": 1481168600, "post_id": 41015934, "comment_id": 69270281, "body": "Thank you guys! That is what I want. What I want to do is allocate stack for my co-routine and commit only the pages that currently use. That mean I can allocate virtual address in a big size first and slowly commit only pages that need to use."}], "owner": {"reputation": 1683, "user_id": 1829232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3fdd30877095f67a858777ac1b393259?s=128&d=identicon&r=PG", "display_name": "UltimaWeapon", "link": "https://stackoverflow.com/users/1829232/ultimaweapon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481109069, "creation_date": 1481109069, "question_id": 41015934, "link": "https://stackoverflow.com/questions/41015934/in-linux-is-there-anyway-to-reserving-memory-that-will-be-commit-automatically", "title": "In Linux, Is there anyway to reserving memory that will be commit automatically when each page got accessed?", "body": "<p>Let say I want to allocate 2 MB contiguous memory in a reserved state. Then when the page get accessed in the first time it will be automatically commit only that page. Is there any API to do this without manual commit whenever it raise a page fault?</p>\n"}, {"tags": ["c", "multithreading", "operating-system", "semaphore"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1481112040, "post_id": 41015849, "comment_id": 69240880, "body": "<a href=\"https://linux.die.net/man/2/flock\" rel=\"nofollow noreferrer\">linux.die.net/man/2/flock</a> is one easy option, if it is available in your platform."}], "answers": [{"tags": [], "owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "is_accepted": true, "score": 0, "last_activity_date": 1481111690, "last_edit_date": 1481111690, "creation_date": 1481109196, "answer_id": 41015968, "question_id": 41015849, "link": "https://stackoverflow.com/questions/41015849/which-os-concept-should-be-better-in-such-a-scenario/41015968#41015968", "title": "Which OS Concept should be better in such a scenario", "body": "<p>If you are creating threads then you need take semaphore or mutex to protect file descriptor because FD is shared with all threads.</p>\n\n<p>Another method is fcntl() uses <code>struct flock structure</code> to define and check file locks.</p>\n\n<p>As you want to protect a file beyond address space you should use \nstruct flock or semaphore because mutex will not work beyond the address space. for your reference i wrote an application, have a look.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define printf(x) printf(\"%s\\n\", x)\n\nint main(int argc, char *argv[])\n{\n    const char filepath[30] = \"/Users/darthvader/testlock\";\n    struct flock *new_wt_lock = (struct flock *) malloc(sizeof(struct flock));\n    FILE *fp;\n\n    memset(new_wt_lock, 0, sizeof(struct flock));\n    new_wt_lock-&gt;l_type = F_WRLCK;\n    new_wt_lock-&gt;l_len = 0;\n\n    fp = fopen(filepath, \"w+\");\n    if(fp == NULL)\n    {\n        perror(\"Error opening file for writing\");\n        exit(EXIT_FAILURE);\n    }\n    printf(\"Attempting to acquire write lock\"); \n    if( fcntl(fileno(fp), F_SETLK, new_wt_lock) == -1)\n    {\n      printf(\"Unable to acquire lock\");\n      perror(\"error\");\n      exit(EXIT_FAILURE);\n    }\n\n    printf(\"Doing random shit...\");\n    sleep(25);\n    printf(\"Stopped doing random shit\");\n\n    if(fcntl(fileno(fp), F_UNLCK, new_wt_lock) &lt; 0)\n    {\n        perror(\"Error releasing lock\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Released Lock...Exiting\");\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7261874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47dbc2b3cfd038b39390150301a9a37a?s=128&d=identicon&r=PG&f=1", "display_name": "Hardil", "link": "https://stackoverflow.com/users/7261874/hardil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 41015968, "answer_count": 1, "score": 0, "last_activity_date": 1481111690, "creation_date": 1481108872, "question_id": 41015849, "link": "https://stackoverflow.com/questions/41015849/which-os-concept-should-be-better-in-such-a-scenario", "title": "Which OS Concept should be better in such a scenario", "body": "<p>I am having implementation of a C Code in which i have this scenario</p>\n\n<p>I have a binary <code>code</code> which when executed, writes continously into a file called <code>log.txt</code> .. Now at the same time i open terminal 2 and run <code>code</code> binary again, which will also write into the file log.txt at the same time</p>\n\n<p>I want to prevent this . What my logic is that when First Binary is working and writing to file log.txt, the second executed instance of the binary also needs to write on log.txt but it should be prevented.. What options are there which i can implement to do this ?</p>\n\n<p>I am planning to use Semaphores for this in C programming. But if anyone have other options kindly let me know</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1481109517, "creation_date": 1481109517, "answer_id": 41016091, "question_id": 41015452, "link": "https://stackoverflow.com/questions/41015452/variable-access-in-main-function-when-returned-by-another-function/41016091#41016091", "title": "Variable access in main function when returned by another function?", "body": "<p>For starters the function showed by you is wrong. If an empty string is passed to the function like this</p>\n\n<pre><code>reverse(str1, 0, size - 1);\n</code></pre>\n\n<p>then the expression <code>size - 1</code> will be equal to <code>-1</code>. As result the function will have undefined behavior due to an attempt to access memory beyond the array in these statements</p>\n\n<pre><code>str1[index] = str1[size - index];\nstr1[size - index] = temp;\n</code></pre>\n\n<p>The function has two many parameters. String functions usually return pointer to the destination string. So it will be better if the function <code>reverse</code> also returns pointer to the string.</p>\n\n<p>It can be defined simpler. For example</p>\n\n<pre><code>char * reverse(char *s, size_t n)\n{\n    if (!(n &lt; 2))\n    {\n        char c = s[0];\n        s[0] = s[n - 1];\n        s[n - 1] = c;\n\n        reverse(s + 1, n - 2);\n    }\n\n    return s;\n}\n</code></pre>\n\n<p>And you can call it like</p>\n\n<pre><code>printf(\"The string after reversing is: %s\\n\", reverse( str1, strlen( str1) ));\n</code></pre>\n\n<p>As for you question then this declaration</p>\n\n<pre><code>void reverse(char str1[], int index, int size);\n</code></pre>\n\n<p>is equivalent to the following declaration</p>\n\n<pre><code>void reverse(char *str1, int index, int size);\n             ^^^^^^^^^^\n</code></pre>\n\n<p>When an array is passed tp the function like this  </p>\n\n<pre><code>reverse(str1, 0, size - 1);\n</code></pre>\n\n<p>then the array designator is converted to pointer to its first element. Within the function the array is not moved from one memory area to another memory area. It stays at the same address. Only the elements of the array are being changed. So after exiting the function the elements of the array will be modified but they will have the same addresses in memory as in the array before calling the function. In fact the array elements are passed to the function by reference that is by the pointer to the first element of the array.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1481110090, "last_edit_date": 1481110090, "creation_date": 1481109658, "answer_id": 41016145, "question_id": 41015452, "link": "https://stackoverflow.com/questions/41015452/variable-access-in-main-function-when-returned-by-another-function/41016145#41016145", "title": "Variable access in main function when returned by another function?", "body": "<p>The function does not return anything, it receives the array as a pointer to its first element (the array <em>decays</em> into a pointer to its first element) and it performs the transposition in place.  Note that the declaration <code>void reverse(char str1[], int index, int size)</code> is equivalent to <code>void reverse(char *str1, int index, int size)</code>.</p>\n\n<p>The code has multiple problems:</p>\n\n<ul>\n<li><p>It does not function for strings of even lengths. It even invokes undefined behavior on the empty string.</p></li>\n<li><p>It uses recursion for no decent reason.  A simple loop approach would have been simpler and have less bugs.</p></li>\n<li><p>It has a <code>return str1;</code> statement even though it is defined as <code>void</code>.</p></li>\n</ul>\n\n<p>The function does not return anything, it receives the array as a pointer to its first element and performs the transposition in place.</p>\n\n<p>Here is a simpler alternative:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar *reverse(char *str) {\n    for (size_t i = 0, length = strlen(str); i &lt; length / 2; i++) {\n        char temp;\n        temp = str[i];\n        str1[i] = str1[length - i - 1];\n        str1[length - i - 1] = temp;\n    }\n    return str;\n}\n\nint main(void) {\n    char buf[100];\n\n    printf(\"Enter a string to reverse: \");\n    if (scanf(\"%s\", buf) == 1) {\n        printf(\"The string after reversing is: %s\\n\", reverse(buf));\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1362, "user_id": 6386250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/brwvr.jpg?s=128&g=1", "display_name": "Dr.Haimovitz", "link": "https://stackoverflow.com/users/6386250/dr-haimovitz"}, "is_accepted": false, "score": 1, "last_activity_date": 1481109691, "creation_date": 1481109691, "answer_id": 41016154, "question_id": 41015452, "link": "https://stackoverflow.com/questions/41015452/variable-access-in-main-function-when-returned-by-another-function/41016154#41016154", "title": "Variable access in main function when returned by another function?", "body": "<p>A reference of a variable is it's address or more correctly the variable that holds the address.</p>\n\n<p>When you pass an object/variable by ref you acctualy pass it's address, in C you do it by passing the pointer of the variable while in c# for instance you need to declare \"ref\" when you passing an argument to a function.</p>\n"}], "owner": {"reputation": 5, "user_id": 7027927, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207697561978776/picture?type=large", "display_name": "Divyanshu Nandwani", "link": "https://stackoverflow.com/users/7027927/divyanshu-nandwani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1481110090, "creation_date": 1481107742, "last_edit_date": 1481109759, "question_id": 41015452, "link": "https://stackoverflow.com/questions/41015452/variable-access-in-main-function-when-returned-by-another-function", "title": "Variable access in main function when returned by another function?", "body": "<p>So I saw this code on the internet for reversing a string using recursion in C.</p>\n\n<p>I understood the code except the part where the <code>reverse</code> function returns <code>str1</code> and then <code>str1</code> is printed in the <code>main</code> function. <code>str1</code> wasn't passed by reference, but only by address. So how come it prints the reversed string and not the original string when it is printed through <code>main</code> function?  </p>\n\n<pre><code>void reverse(char str1[], int index, int size);\n\nint main() {\n    char str1[20];\n    int size;\n\n    printf(\"Enter a string to reverse: \");\n    scanf(\"%s\", str1);\n    size = strlen(str1);\n    reverse(str1, 0, size - 1);\n    printf(\"The string after reversing is: %s\\n\", str1);\n    return 0;\n}\n\nvoid reverse(char str1[], int index, int size) {\n    char temp;\n    temp = str1[index];\n    str1[index] = str1[size - index];\n    str1[size - index] = temp;\n    if (index == size / 2) {\n        return str1;\n    } else {\n        reverse(str1, index + 1, size);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "static", "initialization"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481107468, "post_id": 41015280, "comment_id": 69237920, "body": "It gives you a null pointer and that&#39;s it. There&#39;s no allocation anywhere, except the static variable itself, which is allocated in the bss segment."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1481107921, "post_id": 41015280, "comment_id": 69238252, "body": "&quot;[...] a null pointer with the correct allocated size&quot; makes no sense at all. You get a pointer, that&#39;s the variable itself (<code>begin</code>), but there will be no further &quot;allocation&quot;. A pointer to a given type always has the same size, there&#39;s nothing that can&#39;t be &quot;correct&quot; there."}, {"owner": {"reputation": 25, "user_id": 6899494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef1f8b7fa3d020a9ead8726bf8c919b?s=128&d=identicon&r=PG&f=1", "display_name": "Khaz", "link": "https://stackoverflow.com/users/6899494/khaz"}, "edited": false, "score": 0, "creation_date": 1481108312, "post_id": 41015280, "comment_id": 69238563, "body": "You&#39;re absolutely right. I was thinking about it totally wrong."}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1481107627, "post_id": 41015320, "comment_id": 69238038, "body": "The <i>&quot;prior to program startup&quot;</i> is important (it also implies the initializer can only be compile-time constant(s)). The initialization statement is not performed upon the (first) call of the function, but (as said), at program startup."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 1, "last_activity_date": 1481107924, "last_edit_date": 1481107924, "creation_date": 1481107385, "answer_id": 41015320, "question_id": 41015280, "link": "https://stackoverflow.com/questions/41015280/static-variable-in-a-function-called-repeatedly-c/41015320#41015320", "title": "Static variable in a function called repeatedly C", "body": "<p>Variables with <code>static</code> storage are initialized only once, you're good to go.</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a76.2.4, <em>emphasis mine</em></p>\n\n<blockquote>\n  <p>An object whose identifier is declared without the storage-class specifier\n  <code>_Thread_local</code>, and either with external or internal linkage or with the storage-class\n  specifier <code>static</code>, has static storage duration. Its lifetime is the entire execution of the\n  program and <strong>its stored value is initialized only once, prior to program startup.</strong></p>\n</blockquote>\n\n<p>That said, regarding retaining the last-stored value, quoting paragraph 2, (<em>again, my emphasis</em>)</p>\n\n<blockquote>\n  <p>The lifetime of an object is the portion of program execution during which storage is\n  guaranteed to be reserved for it. An object exists, has a constant address,<sup>33)</sup> and <strong>retains\n  its last-stored value throughout its lifetime.</strong><sup>34)</sup> [....]</p>\n</blockquote>\n\n<p>and, for <code>static</code> variables, as mentioned above</p>\n\n<blockquote>\n  <p>Its lifetime is the entire execution of the\n  program</p>\n</blockquote>\n"}], "owner": {"reputation": 25, "user_id": 6899494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef1f8b7fa3d020a9ead8726bf8c919b?s=128&d=identicon&r=PG&f=1", "display_name": "Khaz", "link": "https://stackoverflow.com/users/6899494/khaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 41015320, "answer_count": 1, "score": 2, "last_activity_date": 1481107924, "creation_date": 1481107303, "last_edit_date": 1481107807, "question_id": 41015280, "link": "https://stackoverflow.com/questions/41015280/static-variable-in-a-function-called-repeatedly-c", "title": "Static variable in a function called repeatedly C", "body": "<p>I am writing a function which is meant to be called multiple times, where I want to have a static pointer to the beginning of a list. I need the function, no matter how many times it is called, to access the same list, so I have two questions.</p>\n\n<ol>\n<li><p>Am I right that if I declare it <code>static t_line *begin = NULL;</code> where <code>t_line</code> is my struct, I believe it will already have allocated the correct space before <code>main()</code> is called, as I understand <code>static</code> variables do, then this will give me a null pointer with the correct allocated size.</p></li>\n<li><p>Once I give that static pointer the address of the first element in my list, the next time the function is called and it reaches that declaration line, wouldn't it just reset it to <code>NULL</code> and I'd lose my pointer?</p></li>\n</ol>\n"}, {"tags": ["c", "linux", "memory"], "comments": [{"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1481114528, "post_id": 41014740, "comment_id": 69242501, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/12520499/linux-how-to-lock-the-pages-of-a-process-in-memory\">LINUX: How to lock the pages of a process in memory</a>"}, {"owner": {"reputation": 2175, "user_id": 835146, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4d8ae9107254bbb3f0c9df8d8a4f8692?s=128&d=identicon&r=PG&f=1", "display_name": "ocirocir", "link": "https://stackoverflow.com/users/835146/ocirocir"}, "reply_to_user": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1481115005, "post_id": 41014740, "comment_id": 69242850, "body": "Injecting code with gdb is really a bad solution, it should be better to have a syscall or other mechanism that do not involve code injection."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1481117021, "post_id": 41014740, "comment_id": 69244294, "body": "How about starting the real-time process with necessary privileges, and using a small dynamic library to set the resource limits, process priority, and lock memory, <i>and</i> drop the privileges, before the actual process&#39; <code>main()</code> starts? You do need one helper program (setuid) and the dynamic library, but they really should be quite straightforward to implement. Interested?"}, {"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1481117380, "post_id": 41014740, "comment_id": 69244543, "body": "@RicoRico, you can always create that syscall yourself, maybe submit it upstream."}], "answers": [{"tags": [], "owner": {"reputation": 2175, "user_id": 835146, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4d8ae9107254bbb3f0c9df8d8a4f8692?s=128&d=identicon&r=PG&f=1", "display_name": "ocirocir", "link": "https://stackoverflow.com/users/835146/ocirocir"}, "is_accepted": true, "score": 2, "last_activity_date": 1481736622, "creation_date": 1481736622, "answer_id": 41148683, "question_id": 41014740, "link": "https://stackoverflow.com/questions/41014740/mlockall-to-another-process/41148683#41148683", "title": "`mlockall` to another process", "body": "<p>I write a new system call in order to fill the gap.</p>\n\n<p>I attached the patch to the kernel-mm mailing list, you can find it <a href=\"http://marc.info/?l=linux-mm&amp;m=148129782913314&amp;w=2\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 2175, "user_id": 835146, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4d8ae9107254bbb3f0c9df8d8a4f8692?s=128&d=identicon&r=PG&f=1", "display_name": "ocirocir", "link": "https://stackoverflow.com/users/835146/ocirocir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 41148683, "answer_count": 1, "score": 1, "last_activity_date": 1481736622, "creation_date": 1481105768, "last_edit_date": 1495542290, "question_id": 41014740, "link": "https://stackoverflow.com/questions/41014740/mlockall-to-another-process", "title": "`mlockall` to another process", "body": "<p>I would execute a <code>mlockall</code> on a real-time process <a href=\"https://stackoverflow.com/questions/12520499/linux-how-to-lock-the-pages-of-a-process-in-memory\">to lock the memory pages</a> that does no have root privileges. Since the user <code>ulimit</code> for max locked memory is really low (and it is ok due to security considerations), I would lock the memory via another process spawned by <code>root</code> user.</p>\n\n<p>Unfortunately, <code>mlockall</code> has this signature:</p>\n\n<pre><code>int mlockall(int flags);\n</code></pre>\n\n<p>So, it works only if it is called directly by the target process. There exists a way (e.g. another syscall) to lock the memory of another process?\nSomething like:</p>\n\n<pre><code>int mlockall(int flags, pid_t pid);\n</code></pre>\n"}, {"tags": ["c", "file", "binaryfiles"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1481107949, "post_id": 41014552, "comment_id": 69238279, "body": "in <code>insertInFile</code> there is <code>count = 0</code>and then <code>for (i = 0; i &lt; count; i++)</code> ==&gt; this loop should never be entered. Also, the variable <code>Player</code> is an array, so it should be indexed: <code>Player.pontuacion = </code> ==&gt; <code>Player[i].pontuacion = </code> etc etc."}, {"owner": {"reputation": 72, "user_id": 7213999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802f4407dba0ae87d8cf9fcf13ff28a0?s=128&d=identicon&r=PG&f=1", "display_name": "Diogo Soares", "link": "https://stackoverflow.com/users/7213999/diogo-soares"}, "reply_to_user": {"reputation": 221, "user_id": 7017891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/24d64160e3aa5677ba9502cf30802e2c?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesLiuChina", "link": "https://stackoverflow.com/users/7017891/charlesliuchina"}, "edited": false, "score": 0, "creation_date": 1481108010, "post_id": 41014552, "comment_id": 69238322, "body": "@CharlesLiuChina you are saying i used fwrite and fread in the wrong place or that the parameters in between () are  wrong?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1481108607, "post_id": 41014552, "comment_id": 69238759, "body": "There is about a zillion compilation errors here. Is this your real up-to-date code?"}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1481108593, "post_id": 41015638, "comment_id": 69238754, "body": "<code>players[i].nickname[MAXSIZE]=&#39;\\0&#39;;</code> writes beyond the end of <code>nickname</code>. Do not use <code>strncpy()</code>, it is confusing and error prone, even when used correctly, it manages to attract bugs.  Use <code>snprintf(players[i].nickname, sizeof(players[i].nickname), &quot;%s&quot;, playerName);</code> and initialize the array to all bits zero with <code>memset</code> to avoid writing garbage values to the binary file."}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1481108836, "post_id": 41015638, "comment_id": 69238898, "body": "I have used <code>strncpy()</code> instead of <code>strcpy()</code> just to highlight that <code>nickname</code> is allocated to a fixed size (needed to write a fixed size of the Player structure)."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1481109074, "post_id": 41015638, "comment_id": 69239048, "body": "@J.Piquart: I am aware of that. <code>strcpy()</code> could cause a buffer overflow, but <code>strncpy()</code> is the wrong fix for this problem because of its widely misunderstood semantics, which would indeed be almost appropriate in this particular case, but still caused a bug in your code, and will cause more problems for less savvy programmers."}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1481113828, "post_id": 41015638, "comment_id": 69242051, "body": "@chqrlie, sorry, but the code <code>snprintf(players[i].nickname, sizeof(players[i].nickname), &quot;%s&quot;, playerName);</code> doesn&#39;t truncate to <code>MAXSIZE</code> as expected (no place for the <code>&#39;\\0&#39;</code> terminator). Should be <code>snprintf(players[i].nickname, sizeof(players[i].nickname)-1, &quot;%s&quot;, playerName);</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1481114237, "post_id": 41015638, "comment_id": 69242304, "body": "on the contrary, <code>snprintf</code> <b>does</b> truncate its output to make it a properly null terminated string within the boundaries of the destination buffer whose size is provided. It does not write to the destination buffer if passed a size of 0.  This is consistent with <code>fgets()</code> and <code>scanf_s()</code>.  On the other hand, <code>strncpy()</code> is the bad guy with counterintuitive semantics take make it error prone."}], "tags": [], "owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "is_accepted": false, "score": 1, "last_activity_date": 1481114283, "last_edit_date": 1481114283, "creation_date": 1481108260, "answer_id": 41015638, "question_id": 41014552, "link": "https://stackoverflow.com/questions/41014552/write-structure-to-a-binary-file-read-it-from-file-store-in-buffer-print-the/41015638#41015638", "title": "Write structure to a binary file, read it from file, store in buffer, print the buffer", "body": "<p>In <code>insertInFile()</code> there is a misunderstanding of the structure use. Writing <code>Player.pontuacion</code> is not right.</p>\n\n<blockquote>\n  <p>To assign a value in an array of struct <code>Player\n  players[MAX_PLAYERS];</code>, use <code>players[i].Dificulty = (Dificulty)level</code>.</p>\n</blockquote>\n\n<pre><code>//cicle that allows to save int the bin file the struct \"Player\"\nfor (i = 0; i &lt; count; i++) {\n    players[i].pontuacion = timeReceived[count];\n    players[i].Dificulty = (Dificulty)(level[count]);\n    strncpy(players[i].nickname,playerName,MAXSIZE-1);\n    players[i].nickname[MAXSIZE]='\\0';\n}\n// write count players\nfwrite(&amp;(players[0]), sizeof (Player), count, fplayers);\n</code></pre>\n\n<p>Instead of:</p>\n\n<pre><code>for (i = 0; i &lt; count; i++) {\n    Player.pontuacion = &amp;timeReceived[count];\n    Player.Dificulty = &amp;level;\n    Player.nickname = &amp;playerName;\n    fwrite(&amp;players, sizeof (Player), count, fplayers);\n}\n</code></pre>\n"}], "owner": {"reputation": 72, "user_id": 7213999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802f4407dba0ae87d8cf9fcf13ff28a0?s=128&d=identicon&r=PG&f=1", "display_name": "Diogo Soares", "link": "https://stackoverflow.com/users/7213999/diogo-soares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529253175, "creation_date": 1481105173, "last_edit_date": 1529253175, "question_id": 41014552, "link": "https://stackoverflow.com/questions/41014552/write-structure-to-a-binary-file-read-it-from-file-store-in-buffer-print-the", "title": "Write structure to a binary file, read it from file, store in buffer, print the buffer", "body": "<p>I am trying to write a structure to a binary file, the punctuation will be received as a parameter in the <code>insertInFile</code> function, (working with raspberryPi, and store the values of the time reaction with switches). Then I want to read from the file and and store the values on the heap and finally read those values I stored dynamically. I'm having problems with this because either it cannot read properly or it cannot write to the binary file.     </p>\n\n<pre><code>typedef enum dificulty {\n    EASY, MEDIUM, HARD\n} Dificulty;\ntypedef struct player {\n    char nickname[MAXSIZE];\n    enum dificulty Dificulty;\n    float pontuacion;\n} Player;\n\n#define LED_CYCLES 5\n#define MAX_PLAYERS 2\n\nint insertInFile(float const *const timeReceived, unsigned short *level, char *playerName) {\n    Player players[MAX_PLAYERS];\n    int count = 0, i;\n    FILE *fplayers;\n\n    //check if file can be opened\n    if ((fplayers = fopen(\"game.bin\", \"wb\")) == NULL) {\n        fputs(\"Erro ao abrir ficheiro\\n\", stderror);\n        return (-1);\n    }\n    //go to the beginning of the file\n    rewind(fplayers);\n\n    //cycle that allows to save int the bin file the struct \"Player\"\n    for (i = 0; i &lt; count; i++) {\n        Player[i].pontuacion = &amp;timeReceived[count];\n        Player[i].Dificulty = &amp;level;\n        Player[i].nickname = &amp;playerName;\n        fwrite(&amp;players, sizeof (Player), count, fplayers);\n    }\n\n    //close the bin file\n    fclose(fplayers);\n\n    return 0;\n}\n\nvoid obtainFromFile() {\n    Player players;\n    int count = 0;\n    FILE *fplayers;\n    size_t size;\n    unsigned char *buffer;\n    int i;\n\n    //open file\n    fp = fopen(\"game.bin\", \"rb\");\n    fseek(fp, 0, SEEK_END);\n    size = ftell(fp);        // calculate the size needed\n    fseek(fp, 0, SEEK_SET);\n    buffer = (unsigned char *)malloc(size);\n\n    if (fplayers == NULL) {  // check some error if file == empty\n        printf(\"Error\\n\", stderr);\n        return (-1);\n    } else\n    if (fread(&amp;buffer, sizeof (*buffer), size, fp) != size) // if count of read bytes != calculated size of .bin file -&gt; ERROR\n        printf(\"Error\\n\", stderr);\n        return (-1);\n    } else {\n        for (i = 0; i &lt; size; i++) {\n            printf(\"%02x\", buffer[i]);\n        }\n    }\n    fclose(fp);\n    free(buffer);\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "for-loop"], "comments": [{"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 1, "creation_date": 1481104235, "post_id": 41014150, "comment_id": 69235767, "body": "Don&#39;t define <code>WORD32</code>.  Just use the win32 type, <code>DWORD</code> which is the same thing."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 4, "creation_date": 1481104301, "post_id": 41014150, "comment_id": 69235800, "body": "Whether you should use a loop within a loop depends on what <code>for (z0, z1) = (0x00, 0x00) to (0xff,0xff)</code> means. Does that count <code>(0, 0)</code>, <code>(1, 1)</code>, <code>(2, 2)</code>, ..., <code>(255, 255)</code> or does it count <code>(0, 0)</code>, <code>(0, 1)</code>, <code>(1, 2)</code>, ..., <code>(0, 255)</code>, <code>(1, 0)</code>, ...?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1481104647, "post_id": 41014150, "comment_id": 69236019, "body": "The loop end condition is unclear too, you said <code>0x00</code> to <code>0xff</code> and implemented  <code>0x00</code> to <code>0xfe</code>, but note that <code>for (BYTE z = 0x00; z &lt;= 0xff; z++)</code> would run forever."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1481104773, "post_id": 41014150, "comment_id": 69236097, "body": "Does the <code>^</code> in the abstract algorithm stand for <code>XOR</code> (like in C) or for something else?"}, {"owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "edited": false, "score": 0, "creation_date": 1481105953, "post_id": 41014150, "comment_id": 69236875, "body": "Yes it stands for XOR, I have cleaned up above and added some more info, I hope I have made it clearer"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481106911, "post_id": 41014150, "comment_id": 69237526, "body": "<code>a1</code> is not defined."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481107076, "post_id": 41014150, "comment_id": 69237646, "body": "The specification of what you are supposed to do is very much unclear. For example, it isn&#39;t obvious if you should check 0 to 0xff including or excluding the 0xff item. The key to successful engineering is to question the spec and make sure it makes sense, before you start implementing it."}, {"owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "edited": false, "score": 0, "creation_date": 1481107758, "post_id": 41014150, "comment_id": 69238118, "body": "I am sorry if this does not make sense or I have confused myself but I am trying to loop over all possible values for (0,z0,z1,0) where (z0, z1) comes from the range (0x00, 0x00) to (0xff,0xff). Thats my impression of it"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481107924, "post_id": 41014150, "comment_id": 69238258, "body": "Yes, but what does &quot;the range (0x00, 0x00) to (0xff, 0xff)&quot; mean (as MOehm has asked)? And if it means all possible combinations, in which order?"}, {"owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "edited": false, "score": 0, "creation_date": 1481110478, "post_id": 41014150, "comment_id": 69239916, "body": "It is latter ordering: (0, 0), (0, 1), (1, 2), ..., (0, 255), (1, 0), \u2026 So it means all possible combinations - the ordering does not matter so long as you go through them all."}], "answers": [{"comments": [{"owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "edited": false, "score": 0, "creation_date": 1481110896, "post_id": 41016358, "comment_id": 69240178, "body": "Hi thanks for your reply I have updated above with the ordering of the loop"}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "reply_to_user": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "edited": false, "score": 0, "creation_date": 1481111081, "post_id": 41016358, "comment_id": 69240301, "body": "@JimboJones Yes, just write the nested inner loop like you did, but change the same things as I described for the outer loop (range and size) and don&#39;t use <code>a1</code> where you mean <code>z1</code>"}], "tags": [], "owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "is_accepted": true, "score": 1, "last_activity_date": 1481111414, "last_edit_date": 1481111414, "creation_date": 1481110297, "answer_id": 41016358, "question_id": 41014150, "link": "https://stackoverflow.com/questions/41014150/implementing-a-for-loop-from-an-algorithm-in-c/41016358#41016358", "title": "Implementing a for loop from an algorithm in c", "body": "<p>Your approach should almost work, only the variable names, the boundaries (<code>0 &lt;= a &lt;= 0xff</code>) and the size of the loop variable need correction.</p>\n\n<pre><code>for (int z = 0; z &lt;= 0xff; z++)\n{ // inner loop same general approach...\n}\n</code></pre>\n\n<p>Should you ever have a case where you iterate the whole range of numbers and switching to a bigger data type is not an option, a manual break condition at the end of loop can be used. For your loop with <code>BYTE</code> it could look like this</p>\n\n<pre><code>for (BYTE z = 0; z &lt;= 0xff; z++)\n{ // inner loop same general approach, followed by break condition...\n    if (z == 0xff) break; // next increment would overflow to 0\n}\n</code></pre>\n\n<p>Regarding the content of the inner loop, it can be shortened alot, because the <code>0x02000000</code> and the other values don't have any overlapping bytes. (note I write <code>a1</code> because you do, not because it makes any sense)</p>\n\n<pre><code>WORD32 a = (0 &lt;&lt; 24 | a1 &lt;&lt; 16 | z &lt;&lt; 8 | 0);\nWORD32 h0 = f(0x02000000L^a);\n// vs same result\nunsigned long h1 = f(0x02000000L | a1 &lt;&lt; 16 | z &lt;&lt; 8);\n</code></pre>\n\n<p>Even if you need to store <code>a</code> as intermediate result, <code>0 &lt;&lt; X</code> isn't anything useful, just write <code>a = a1 &lt;&lt; 16 | z &lt;&lt; 8</code>.</p>\n\n<p>So the whole code with correct variable names could look like</p>\n\n<pre><code>for (int z0 = 0; z0 &lt;= 0xff; z0++)\n{\n    for (int z1 = 0; z1 &lt;= 0xff; z1++)\n    {\n        unsigned long a = z0 &lt;&lt; 16 | z1 &lt;&lt; 8;\n        unsigned long h = f(0x02000000 | a); // using | or ^ doesn't matter\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 901, "user_id": 3573539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1v9R5.jpg?s=128&g=1", "display_name": "Jimbo Jones", "link": "https://stackoverflow.com/users/3573539/jimbo-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "accepted_answer_id": 41016358, "answer_count": 1, "score": 0, "last_activity_date": 1481111414, "creation_date": 1481104071, "last_edit_date": 1481111003, "question_id": 41014150, "link": "https://stackoverflow.com/questions/41014150/implementing-a-for-loop-from-an-algorithm-in-c", "title": "Implementing a for loop from an algorithm in c", "body": "<p>I am only learning c and I am trying to implement a for loop from an algorithm. I am so so confused in how to implement it, please see my attempt below. Any help or thoughts would be greatly appreciated as I am unsure, does it imply a loop within a loop. Or am I implementing the for loop correctly,</p>\n\n<p>The algorithm states For all possible a = (0,z0,z1,0)</p>\n\n<p>Looop From algorithm</p>\n\n<pre><code>   for (z0, z1) = (0x00, 0x00) to (0xff,0xff)\n   h0 = somemethod( 0x02000000L \u2295 (0x00, z0,z1,0x00)) )\n</code></pre>\n\n<p>My Attempt     </p>\n\n<pre><code>  #define WORD32 unsigned int \n\n    for (BYTE z = 0x00; z &lt; 0xff; z++)\n    {\n        for (BYTE z1 = 0x00; z1 &lt; 0xff; z1++)\n        {\n            WORD32 a = (0 &lt;&lt; 24 | a1 &lt;&lt; 16 | z &lt;&lt; 8 | 0);\n            WORD32 h0 = f(0x02000000L^a);\n        }\n    }      \n</code></pre>\n\n<p>So I unsure about the loop and is the below correct</p>\n\n<pre><code>        h0 = somemethod( 0x02000000L \u2295 (0x00, z0,z1,0x00)) )\n\n        WORD32 a = (0 &lt;&lt; 24 | a1 &lt;&lt; 16 | z &lt;&lt; 8 | 0);\n        WORD32 h0 = f(0x02000000L^a);\n</code></pre>\n\n<p>IE how i get</p>\n\n<pre><code> (0x00, z0,z1,0x00)\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>It is latter ordering: (0, 0), (0, 1), (1, 2), ..., (0, 255), (1, 0), \u2026</p>\n\n<p>It means all possible combinations - the ordering does not matter once you go through them all.</p>\n"}, {"tags": ["c", "memory-leaks", "libmagic"], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 249769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76842926ea1f8bf8fdab4f8e580e912d?s=128&d=identicon&r=PG", "display_name": "jagg", "link": "https://stackoverflow.com/users/249769/jagg"}, "is_accepted": false, "score": 1, "last_activity_date": 1487071972, "creation_date": 1487071972, "answer_id": 42225061, "question_id": 41013977, "link": "https://stackoverflow.com/questions/41013977/memory-leak-in-libmagic/42225061#42225061", "title": "Memory leak in libmagic?", "body": "<p>I just came across the same issue today, it seems there was an defect reported about it:</p>\n\n<p><a href=\"https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=840754\" rel=\"nofollow noreferrer\">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=840754</a></p>\n\n<p>According to the discussion there it should be fixed in the latest version.</p>\n"}], "owner": {"reputation": 636, "user_id": 3333488, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/49Fx1.jpg?s=128&g=1", "display_name": "lash", "link": "https://stackoverflow.com/users/3333488/lash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487071972, "creation_date": 1481103581, "question_id": 41013977, "link": "https://stackoverflow.com/questions/41013977/memory-leak-in-libmagic", "title": "Memory leak in libmagic?", "body": "<p>Trynig some test code for libmagic:</p>\n\n<pre><code> #include &lt;magic.h&gt;\n #include &lt;stdio.h&gt;\n\n int main(int argc, char **argv) {\n\n    magic_t cookie;\n\n    cookie = magic_open(MAGIC_MIME_TYPE);\n\n    if (cookie == NULL) {\n        perror(magic_error(cookie));\n        return 1;\n    }\n\n    if (magic_load(cookie, NULL) == -1) {\n        perror(magic_error(cookie));\n        return 1;\n    }\n\n    const char *string = magic_file(cookie, *(argv+1));\n\n    if (string == NULL) {\n        perror(magic_error(cookie));\n        return 1;\n    }\n\n    printf(\"%s\\n\", string);\n\n    magic_close(cookie);\n    return 0;\n }\n</code></pre>\n\n<p>The code is pretty much ripped from here:</p>\n\n<p><a href=\"http://vivithemage.co.uk/blog/?p=105\" rel=\"nofollow noreferrer\">http://vivithemage.co.uk/blog/?p=105</a></p>\n\n<p>The code runs ok, but using <code>valgrind --leak-check=full ./libmagic /path/to/some/image/file</code> a memleak from the library is reported:</p>\n\n<pre><code> ==6153== HEAP SUMMARY:\n ==6153==     in use at exit: 48 bytes in 3 blocks\n ==6153==   total heap usage: 36 allocs, 33 frees, 990,559 bytes allocated\n ==6153== \n ==6153== 48 bytes in 1 blocks are definitely lost in loss record 2 of 2\n ==6153==    at 0x4C2FB55: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n ==6153==    by 0x4E43D3D: ??? (in /usr/lib/x86_64-linux-gnu/libmagic.so.1.0.0)\n ==6153==    by 0x4E447ED: ??? (in /usr/lib/x86_64-linux-gnu/libmagic.so.1.0.0)\n ==6153==    by 0x4008A8: main (libmagic.c:15)\n ==6153== \n ==6153== LEAK SUMMARY:\n ==6153==    definitely lost: 48 bytes in 1 blocks\n ==6153==    indirectly lost: 0 bytes in 2 blocks\n ==6153==      possibly lost: 0 bytes in 0 blocks\n ==6153==    still reachable: 0 bytes in 0 blocks\n ==6153==         suppressed: 0 bytes in 0 blocks\n</code></pre>\n\n<p>Do I need something else than <code>magic_close()</code> to wrap up, or is there some weakness in the library?</p>\n\n<p>magic.h says <strong>MAGIC_VERSION 524</strong>, I'm using <strong>gcc 5.4.0</strong></p>\n"}, {"tags": ["c", "linear-algebra"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1481103397, "post_id": 41013815, "comment_id": 69235206, "body": "<code>int **mat = (int**) malloc(sizeof(int)*ncol*nrow);</code> this isn&#39;t doing what you think it is. <code>mat[i]</code> results in a <code>int*</code> (pointer to <code>int</code>), which  remains indeterminate. And, stock comment, <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">stop casting memory allocation functions in C program</a>."}, {"owner": {"reputation": 834, "user_id": 7131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a1cf5eb86c98bcf94e80e722fff20e?s=128&d=identicon&r=PG&f=1", "display_name": "Fefux", "link": "https://stackoverflow.com/users/7131047/fefux"}, "edited": false, "score": 2, "creation_date": 1481103499, "post_id": 41013815, "comment_id": 69235275, "body": "And please, never use goto and label..."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1481103700, "post_id": 41013815, "comment_id": 69235425, "body": "<code>int **mat = (int**) malloc(sizeof(int)*ncol*nrow);</code> should be <code>int (*mat)[ncol] = malloc(nrow * sizeof *mat);</code>."}, {"owner": {"reputation": 11, "user_id": 4339674, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ebb526d2ee8254f5a5af1bcfe7103f37?s=128&d=identicon&r=PG&f=1", "display_name": "Chib", "link": "https://stackoverflow.com/users/4339674/chib"}, "edited": false, "score": 0, "creation_date": 1481104520, "post_id": 41013815, "comment_id": 69235927, "body": "Anybody care to share why they downvoted the question?"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1481104678, "post_id": 41013815, "comment_id": 69236042, "body": "probably because it is not a minimal, complete and compilable program."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481104596, "post_id": 41014297, "comment_id": 69235985, "body": "This isn&#39;t a 2D array, it&#39;s a look-up table. The OP is using a 2D array. Of course the correct method is to allocate the memory as one single chunk, otherwise it wouldn&#39;t be an array."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481105675, "post_id": 41014297, "comment_id": 69236683, "body": "Btw that site is awful, please stop reading it and don&#39;t recommend it to others."}, {"owner": {"reputation": 1, "user_id": 7261421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980c41a315bd824def3bcc8e6bc887f2?s=128&d=identicon&r=PG&f=1", "display_name": "pdsr", "link": "https://stackoverflow.com/users/7261421/pdsr"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481108142, "post_id": 41014297, "comment_id": 69238418, "body": "plz suggest an alernative for this geeksforgeeks"}, {"owner": {"reputation": 1, "user_id": 7261421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980c41a315bd824def3bcc8e6bc887f2?s=128&d=identicon&r=PG&f=1", "display_name": "pdsr", "link": "https://stackoverflow.com/users/7261421/pdsr"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481108205, "post_id": 41014297, "comment_id": 69238483, "body": "Also, by the end of the day, it is still an 2D array rt :P"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481111404, "post_id": 41014297, "comment_id": 69240487, "body": "Alternative: <a href=\"http://stackoverflow.com/\">stackoverflow.com</a>. Also, just because something looks like a 2D array doesn&#39;t make it one. You can&#39;t dress up your pigs as cows and then sell the meat as cow meat, no matter how cow-like the pigs looked."}], "tags": [], "owner": {"reputation": 1, "user_id": 7261421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980c41a315bd824def3bcc8e6bc887f2?s=128&d=identicon&r=PG&f=1", "display_name": "pdsr", "link": "https://stackoverflow.com/users/7261421/pdsr"}, "is_accepted": false, "score": -1, "last_activity_date": 1481104439, "creation_date": 1481104439, "answer_id": 41014297, "question_id": 41013815, "link": "https://stackoverflow.com/questions/41013815/scanf-segfaults-outside-of-main/41014297#41014297", "title": "Scanf Segfaults Outside of main()", "body": "<p>I assume the problems is with<code>int **mat = (int**) malloc(sizeof(int)*ncol*nrow);</code> \nYou are trying to allocate the a 2D array right? But this isn't the correct method to allocate the memory. You can't allocate the whole chunk of memory one short.\nWhat you should be doing here is, allocate the memory for all the rows(basically pointer to store the column address) and then for columns</p>\n\n<pre><code>int **mat= (int **)malloc(nrow * sizeof(int *));\nfor (i=0; i&lt;nrow; i++)\n     mat[i] = (int *)malloc(ncol * sizeof(int));\n</code></pre>\n\n<p>Refer this link for more info <a href=\"http://www.geeksforgeeks.org/dynamically-allocate-2d-array-c/\" rel=\"nofollow noreferrer\">http://www.geeksforgeeks.org/dynamically-allocate-2d-array-c/</a> </p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4339674, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ebb526d2ee8254f5a5af1bcfe7103f37?s=128&d=identicon&r=PG&f=1", "display_name": "Chib", "link": "https://stackoverflow.com/users/4339674/chib"}, "edited": false, "score": 0, "creation_date": 1481146524, "post_id": 41014664, "comment_id": 69262989, "body": "That seems to have gotten it.  I think that I more or less understand what you did with the genmat (correct me if I&#39;m wrong), which is that you created an array with two indices in main, told genmat where it lived and then just did the assignments without telling genmat to return a pointer (since <code>**mat[i][j]</code> would effectively be the object pointing to a pointer instead of some actual <i>thing</i> in the memory with <code>i*j</code> entries).  I <i>am</i> unfamiliar with how declarations with parentheses work though.  Can you link me to any good material on declarations?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11, "user_id": 4339674, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ebb526d2ee8254f5a5af1bcfe7103f37?s=128&d=identicon&r=PG&f=1", "display_name": "Chib", "link": "https://stackoverflow.com/users/4339674/chib"}, "edited": false, "score": 0, "creation_date": 1481182341, "post_id": 41014664, "comment_id": 69275384, "body": "@Chib Here is a more detailed explanation: <a href=\"http://stackoverflow.com/questions/32050256/function-to-dynamically-allocate-matrix/32050859#32050859\" title=\"function to dynamically allocate matrix\">stackoverflow.com/questions/32050256/&hellip;</a>"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 0, "last_activity_date": 1481105550, "creation_date": 1481105550, "answer_id": 41014664, "question_id": 41013815, "link": "https://stackoverflow.com/questions/41013815/scanf-segfaults-outside-of-main/41014664#41014664", "title": "Scanf Segfaults Outside of main()", "body": "<p>Dynamically allocated 2D arrays are unfortunately burdensome and ugly in C. To properly allocate one, it is very important that you do so with <strong>a single call to malloc</strong>, just as you tried to do. Otherwise it won't be a 2D array, but instead some segmented, slow look-up table.</p>\n\n<p>However, the result of that malloc call will be a pointer to a 2D array, not a pointer-to-pointer. In fact, pointer-pointers have nothing to do with 2D arrays whatsoever - this is a widespread but incorrect belief.</p>\n\n<p>What you should have done is this:</p>\n\n<pre><code>int (*mat)[nrow][ncol] = malloc( sizeof(int[nrow][ncol] );\n</code></pre>\n\n<p>This is an array pointer to a 2D array. This syntax is already a bit burdensome, but to make things worse, it is not easy to pass this array pointer back to main, because it is a local pointer variable. So you would need to use a pointer to an array pointer... and there's no pretty way to do that. It goes like this:</p>\n\n<pre><code>void genmat (size_t nrow, size_t ncol, int (**mat)[nrow][ncol] )\n{\n  *mat = malloc( sizeof(int[nrow][ncol]) );\n</code></pre>\n\n<p>To ease usage a bit, you can create a temporary pointer to rows, which doesn't require multiple levels of indirection and is therefore much easier to work with:</p>\n\n<pre><code>  int (*matrix)[ncol] = *mat[0]; // in the pointed-at 2D array, point at first row\n\n  for(size_t r=0; r&lt;nrow; r++)  // whatever you want to do with this matrix:\n  {\n    for(size_t c=0; c&lt;ncol; c++)\n    {\n      matrix[r][c] = 1;  // much more convenient syntax than (**mat)[r][c]\n    }\n  }\n</code></pre>\n\n<p>From main, you'll have to call the code like this:</p>\n\n<pre><code>size_t row = 3;\nsize_t col = 4;\n\nint (*mat)[row][col];\ngenmat(row, col, &amp;mat);\n</code></pre>\n\n<hr>\n\n<p>Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;stdlib.h&gt;\n\n\nvoid genmat (size_t nrow, size_t ncol, int (**mat)[nrow][ncol] )\n{\n  *mat = malloc( sizeof(int[nrow][ncol]) );\n  int (*matrix)[ncol] = *mat[0];\n\n  for(size_t r=0; r&lt;nrow; r++)\n  {\n    for(size_t c=0; c&lt;ncol; c++)\n    {\n      matrix[r][c] = 1;\n    }\n  }\n}\n\nvoid printmat (size_t nrow, size_t ncol, int mat[nrow][ncol])\n{\n  for(size_t r=0; r&lt;nrow; r++)\n  {\n    for(size_t c=0; c&lt;ncol; c++)\n    {\n      printf(\"%d \", mat[r][c]);\n    }\n    printf(\"\\n\");\n  }\n}\n\nint main (void)\n{\n  size_t row = 3;\n  size_t col = 4;\n\n  int (*mat)[row][col];\n  genmat(row, col, &amp;mat);\n\n  printmat(row, col, *mat);\n\n  free(mat);\n  return 0;\n} \n</code></pre>\n\n<p>Please note that real code needs to address the case where malloc returns NULL.</p>\n"}], "owner": {"reputation": 11, "user_id": 4339674, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ebb526d2ee8254f5a5af1bcfe7103f37?s=128&d=identicon&r=PG&f=1", "display_name": "Chib", "link": "https://stackoverflow.com/users/4339674/chib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 41014664, "answer_count": 2, "score": -1, "last_activity_date": 1481105550, "creation_date": 1481103096, "question_id": 41013815, "link": "https://stackoverflow.com/questions/41013815/scanf-segfaults-outside-of-main", "title": "Scanf Segfaults Outside of main()", "body": "<p>I'm trying to generate a matrix of some arbitrary dimensions.  I can do it just fine by calling scanf in main and then assigning matrix elements on a row by row basis, but trying to do it in a single function, outside of main, (and only if scanf() is called outside of main) gives me a segfault error:</p>\n\n<pre><code>int **genmat(int nrow, int ncol){\n    int i,j;\n    int **mat = (int**) malloc(sizeof(int)*ncol*nrow);  \n    char rowbuff[16];\n    for(i=0; i &lt; nrow; i++){\n        INPUT: scanf(\"%[^\\n]%*c\",rowbuff);\n        if(strlen(rowbuff) != ncol){\n            printf(\"Error: Input must be string of length %d\\n\", ncol);\n            goto INPUT;\n        }\n        else{\n            for(j=0; j &lt; ncol; j++){\n                if(rowbuff[j] == '1'){\n                    mat[i][j] = 1;\n                }\n                else{\n                    mat[i][j] = 0;\n                }\n            }\n        }\n    }\n    return(mat);\n}\n</code></pre>\n\n<p>The following works just fine:</p>\n\n<pre><code>int *genrow(int ncol, char *rowbuff){\n    int i;\n    int *row = malloc(sizeof(int)*ncol);\n    for(i=0;i&lt;ncol;i++){\n        row[i] = rowbuff[i]%2;\n    }\n    return(row);\n}\n</code></pre>\n\n<p>with the following in my main function to call genrow() for each row of the matrix:</p>\n\n<pre><code>    for(i=0; i &lt; row; i++){\n        INPUT: scanf(\"%[^\\n]%*c\",rowbuff);\n        if(strlen(rowbuff) != col){\n            printf(\"Error: Input must be string of length %d\\n\", col);\n            goto INPUT;\n        }\n        else{\n            int *newrow = genrow(col, rowbuff);\n            for(j=0; j &lt; col; j++){\n                matrix[i][j] = newrow[j];\n            }\n            free(newrow);\n            newrow = NULL;\n        }\n    }\n</code></pre>\n\n<p>Why is the behavior different in these two contexts?</p>\n"}, {"tags": ["c", "linux", "pipe", "fork", "dup2"], "comments": [{"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 1, "creation_date": 1481103569, "post_id": 41013795, "comment_id": 69235327, "body": "Remove the <code>CHK</code> macro and check the return yourself. Print an error message if you detect an error. See what happens then. RIght now there&#39;s no way for us to try your code since we don&#39;t have a <code>CHK</code> macro definition."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 2, "creation_date": 1481103677, "post_id": 41013795, "comment_id": 69235408, "body": "(also, fix your indentation, and post a <i>complete</i> but also <i>minimal verifiable</i> example - the main method is missing. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1481106984, "post_id": 41013795, "comment_id": 69237590, "body": "The CHK() macro probably evaluates its arguments more than once."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1481107788, "post_id": 41013795, "comment_id": 69238143, "body": "<code>Broken pipe</code> means you were killed by a <code>SIGPIPE</code>, which occurs when you try to write to a pipe whose read end is closed (you can avoid this by ignoring <code>SIGPIPE</code>, which would make <code>write</code> fail with <code>EPIPE</code> instead)."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1481125438, "post_id": 41013795, "comment_id": 69250330, "body": "When you say &quot;I have found that no child does the dup2() command (except for dup2(inFD...) and dup2(outFD...) when the flags are appropriate).&quot;, what are you seeing (or not seeing) that makes you think this? You can run <code>strace -f yourprogramname</code> and look at its output to see all the <code>dup2</code> calls and their return values."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1481126182, "post_id": 41013795, "comment_id": 69250865, "body": "<code>printf(&quot;*****doing dup2 fildes[writeDes] was a success!\\n&quot;);</code> just after you did <code>dup2(fildes[writeDes], STDOUT_FILENO)</code> means the printf will go into the pipe, not your terminal, and will only be seen by the program that middlechild runs."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1481126213, "post_id": 41013795, "comment_id": 69250883, "body": "Is <code>dup2(fildes[readDes], STDOUT_FILENO)</code> a typo? A program won&#39;t be able to write to the read end of a pipe."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1481126336, "post_id": 41013795, "comment_id": 69250971, "body": "<code>readDes += 2;  writeDes += 2;</code> will only affect the values of those variables in middlechild. It won&#39;t affect the parent process. fork duplicates the address space. `"}, {"owner": {"reputation": 11, "user_id": 7171449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c3a5263daa77342b627b8f0d7c89113?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/7171449/ken"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1481149340, "post_id": 41013795, "comment_id": 69264336, "body": "@MarkPlotnick Ah I see. I figured the dup2 isn&#39;t working because no print statements following it printed, but since output goes onto the pipe then that doesn&#39;t mean dup2 isn&#39;t working. I thought this because doing dup2(inFD) would be followed up with a print statement, but that&#39;s probable cause it&#39;s using STDIN."}, {"owner": {"reputation": 11, "user_id": 7171449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c3a5263daa77342b627b8f0d7c89113?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/7171449/ken"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1481149524, "post_id": 41013795, "comment_id": 69264411, "body": "@MarkPlotnick Also, yes thank you for catching that typo, that should be STDIN_FILENO. I also then need to figure out how to index fildes[] since readDes and writeDes only affects the middle child and not the parent. I thought it would work since they&#39;re both global variables."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7171449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c3a5263daa77342b627b8f0d7c89113?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/7171449/ken"}, "is_accepted": false, "score": 1, "last_activity_date": 1481150747, "creation_date": 1481150747, "answer_id": 41028744, "question_id": 41013795, "link": "https://stackoverflow.com/questions/41013795/c-dup2-not-executing/41028744#41028744", "title": "C - dup2() not executing", "body": "<p>@MarkPlotnick you're right! It's not that dup2 isn't executing or anything. Because I did dup2(fildes[1], STDOUT_FILENO), all print statements will be piped.</p>\n\n<p>I fixed the typo mentioned as well. I tried my teacher's test file\n     &lt; input1 cat|>your.outputc tr a-z A-Z | tr \\ q\nWhich should result with a file called your.outputc. It does, and the contents are input1 with the effects of tr. However, I also have the printf statements at the top of this file.</p>\n\n<p>I assumed the dup2 wasn't working because no printf statement followed, unlike it did in dup2(inFD, STDIN_FILENO), but that's probably because it was STDIN. </p>\n"}], "owner": {"reputation": 11, "user_id": 7171449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c3a5263daa77342b627b8f0d7c89113?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/7171449/ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1085, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1481150747, "creation_date": 1481103040, "last_edit_date": 1481117665, "question_id": 41013795, "link": "https://stackoverflow.com/questions/41013795/c-dup2-not-executing", "title": "C - dup2() not executing", "body": "<p>This is my first question so I apologize if I'm omitting anything important.  So I've been working on an assignment that handles piping via forking. My code is pretty messy, littered with printf statements so I see what's going on. </p>\n\n<p>I've looked around online and I think I get the idea of how to handle piping, but the problem I'm having is that my code skips dup2() on any file descriptor except inFD and outFD.</p>\n\n<p>Here's the code for my function. Also, from what I understand, my teacher made a macro called CHK which checks for errors. If there is an error (such as dup2 returning -1), it'll terminate with a print to stderr.</p>\n\n<p>My includes, global variables and myhandler() for signal</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;strings.h&gt;\n#include &lt;math.h&gt;\n#include &lt;signal.h&gt;\n\n// Function calls\nvoid parse(char *w, char **ptrArray, char *inArray, char *outArray, int *pipeArray);\nint flagHandler(char **ptrArray, char *inArray, char *outArray);\nint pipeHandler(char **ptrArray, char *inArray, char *outArray, int *pipeArray);\n\n// Global Variables\nconst int STORAGE = 254;\nconst int MAXITEM = 100;\nint inFD;   // file descriptor for &lt;\nint outFD;  // file descriptor for &gt;\nint complete = 0; // for sighandler\nint readDes = 0;\nint writeDes = 1;\nint numPipes = 0;\nint status;\nint forCounter = 0;\n\nint fildes[4];\nint pipeIndex = 0;\n\n// MetaChar flags\nint lessthanSign = 0; // &lt; flag\nint greaterthanSign = 0; // &gt; flag\nint firstChildFlag = 0;\nint lastChildFlag = 0;\n\nvoid myhandler(int signum)\n{\n    complete = 1;\n}\n</code></pre>\n\n<p>My main function</p>\n\n<pre><code>int main()\n{\n    char s[STORAGE]; // array of words\n    char *newargv[MAXITEM];\n    char inArray[STORAGE]; // for &lt;\n    char outArray[STORAGE]; // for &gt;\n    int firstCheck;\n    int pidBackground; // holds value from fork(), used for background calls\n    struct stat st; // for stat(), checks if file exists\n\n    // dynamic array based on numPipes\n    // first child doesn't use this array, as it uses newargv[0] and newargv\n    // only the middle children and last child use this array, hence 10\n    int *pipeArray = malloc(10 * sizeof(int));\n\n    int numLoops = 0;\n    int i = 0;\n\n    signal(SIGTERM, myhandler);\n\n    for(;;)\n    {\n        // Reset flags here\n        lessthanSign = 0;\n        greaterthanSign = 0;\n        pipeSign = 0;\n        firstChildFlag = 0;\n        lastChildFlag = 0;\n        pipeIndex = 0;\n\n\n        parse(s, newargv, inArray, outArray, pipeArray);\n        pipeHandler(newargv, inArray, outArray, pipeArray);\n        wait(NULL);\n        fflush(NULL);\n\n    } // end for\n    printf(\"Entering killpg; numLoops = %d\\n\", numLoops);\n    killpg(getpid(), SIGTERM);\n    printf(\"p2 terminated.\\n\");\n    exit(0);\n}   // end main\n</code></pre>\n\n<p>Main calls parse which fills in newargv[]. It also fills in inArray[] and outArray[] with the string immediately after a &lt; and > respectively. When detecting a pipe sign, it puts a null on newargv[], as well as putting a value in pipeArray[] for indexing the executable's name in newargv. I omitted the parse() and flagHandler() calls to keep it minimal.</p>\n\n<p>My parseHandler() function</p>\n\n<pre><code>int pipeHandler(char **ptrArray, char *inArray, char *outArray, int *pipeArray)\n{\n    pid_t firstChild;\n    pid_t firstChildBackground;\n    pid_t middleChild;\n    pid_t lastChild;\n    pid_t lastChildBackground;\n    int i = 0; // plain integer for for loops\n\n    printf(\"Initializing pipes\\n\");\n    //pipe(fildes);\n    //pipe(fildes + 2);\n    for (i = 0; i &lt; (2*numPipes); i+=2)\n    {\n        printf(\"pipe initializing; i is %d\\n\", i);\n        if (pipe(fildes + i) &lt; 0)\n        {\n            perror(\"pipe initialization failed\");\n            exit(EXIT_FAILURE);\n        }\n    }\n\n\n    fflush(stdout);\n    if ((firstChild = fork()) &lt; 0)\n    {\n        perror(\"First child's fork failed!\");\n        exit(EXIT_FAILURE);\n    }\n    printf(\"firstChild pid = %d\\n\", getpid());\n    if (firstChild == 0)\n    {\n\n        if (firstChildFlag == 1)\n        {\n            printf(\"inFD = open...\\n\");\n            inFD = open(inArray, O_RDONLY);\n            printf(\"Doing dup2 inFD\\n\");\n            if (dup2(inFD, STDIN_FILENO) &lt; 0)\n            {\n                perror(\"First child's &lt; dup2 failed\");\n                exit(EXIT_FAILURE);\n            }\n        }\n\n        printf(\"doing dup2 fildes[writeDes]\\n\");\n        if (dup2(fildes[writeDes], STDOUT_FILENO) &lt; 0)\n        {\n            perror(\"First child's dup2 failed\");\n            exit(EXIT_FAILURE);\n        }\n        printf(\"*****doing dup2 fildes[writeDes] was a success!\\n\");\n\n        for (i = 0; i &lt; 4; i++)\n        {\n            if (close(fildes[i]) &lt; 0)\n            {\n                perror(\"close failed\");\n                exit(EXIT_FAILURE);\n            }\n        }\n        if (firstChildFlag == 1)\n        {\n            lessthanSign = 0;\n            firstChildFlag = 0;\n\n            if (close(inFD) &lt; 0)\n            {\n                perror(\"close inFD failed\");\n                exit(EXIT_FAILURE);\n            }\n        }\n\n        writeDes += 2;\n\n        printf(\"About to execvp first child\\n\");\n        if (execvp(ptrArray[0], ptrArray) &lt; 0)\n        {\n            perror(\"execvp failed\");\n            exit(EXIT_FAILURE);\n        }\n    }\n    else\n    {\n        fflush(stdout);\n        if ((middleChild = fork() &lt; 0))\n        {\n            perror(\"Middle child's fork failed\");\n            exit(EXIT_FAILURE);\n        }\n        printf(\"middleChild pid = %d\\n\", getpid());\n        if (middleChild == 0)\n        {\n            if (dup2(fildes[readDes], STDIN_FILENO) &lt; 0)\n            {\n                perror(\"Middle child's dup2 on reading failed\");\n                exit(EXIT_FAILURE);\n            }\n            if (dup2(fildes[writeDes], STDOUT_FILENO) &lt; 0)\n            {\n                perror(\"Middle child's dup2 on writing failed\");\n                exit(EXIT_FAILURE);\n            }\n\n            for (i = 0; i &lt; 4; i++)\n            {\n                if (close(fildes[i]) &lt; 0)\n                {\n                    perror(\"close failed\");\n                    exit(EXIT_FAILURE);\n                }\n            }\n\n            readDes += 2;\n            writeDes += 2;\n\n            if (execvp(ptrArray[pipeArray[0]], ptrArray + pipeArray[0]) &lt; 0)\n            {\n                perror(\"Middle child's execvp failed\");\n                exit(EXIT_FAILURE);\n            }\n        }\n        else\n        {\n            fflush(stdout);\n            if ((lastChild = fork() &lt; 0))\n            {\n                perror(\"Last child's fork failed\");\n                exit(EXIT_FAILURE);\n            }\n            printf(\"lastChild pid = %d\\n\", getpid());\n            if (lastChild == 0)\n            {\n                if (dup2(fildes[readDes], STDOUT_FILENO) &lt; 0)\n                {\n                    perror(\"Last child's dup2 on reading failed\");\n                    exit(EXIT_FAILURE);\n                }\n                if (lastChildFlag == 1)\n                {\n                    outFD = open(outArray, O_CREAT | O_RDWR, 0400 | 0200);\n                    if (dup2(outFD, STDOUT_FILENO) &lt; 0)\n                    {\n                        perror(\"Last child's &gt; dup2 failed\");\n                        exit(EXIT_FAILURE);\n                    }\n                }\n\n                for (i = 0; i &lt; 4; i++)\n                {\n                    if (close(fildes[i]) &lt; 0)\n                    {\n                        perror(\"close failed\");\n                        exit(EXIT_FAILURE);\n                    }\n                }\n                if (lastChildFlag == 1)\n                {\n                    greaterthanSign = 0;\n                    lastChildFlag = 0;\n                    if (close(outFD) &lt; 0)\n                    {\n                        perror(\"close on outFD failed\");\n                        exit(EXIT_FAILURE);\n                    }\n                }\n\n                printf(\"Execvp last child\\n\");\n                if (execvp(ptrArray[pipeArray[1]], ptrArray + pipeArray[1]) &lt; 0)\n                {\n                    perror(\"Last child's execvp failed\");\n                    exit(EXIT_FAILURE);\n                }\n                printf(\"Last child execvp finished\\n\");\n            }\n        }\n    }\n\n\n    // Only the parent gets here\n    printf(\"Only the parent should be here\\n\");\n    printf(\"My pid is %d\\n\", getpid());\n    for (i = 0; i &lt; 4; i++)\n    {\n        if (close(fildes[i]) &lt; 0)\n        {\n            perror(\"close failed\");\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    for (;;)\n    {\n        pid_t pid;\n        if (pid = wait(NULL) &lt; 0)\n        {\n            perror(\"wait failed\");\n            exit(EXIT_FAILURE);\n        }\n        if (pid == lastChild)\n        {\n            printf(\"Parent is waiting for lastChild\\n\");\n            break;\n        }\n    }\n\n    printf(\"Parent finished waiting. Returning...\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>I did pipe(fildes) before any fork, so that all children and a parent have their copy. Therefore, I must close all file descriptors in each child (after dup2 but before execvp) and the parent. The parent will then wait until it gets the pid of lastChild.</p>\n\n<p>With a lot of printf statements, I have found that no child does the dup2() command (except for dup2(inFD...) and dup2(outFD...) when the flags are appropriate). There is also no error printed.</p>\n\n<p>I printed out my (char) newargv[] and my (int) pipeArray[] and they contain the correct values. It seems to be just the dup2 problem, and I have absolutely no idea what's going wrong with it.</p>\n\n<p>I made a simple text file called test2 containing\n    ls | sort | cat someString\nWhere someString is just a file with some text. With all the print statements in the pipeHandler() function my output is:</p>\n\n<p>EDIT: I fixed a couple typos I had. I forgot to lace an extra set of parenthesis on 3 ifs, if ((firstChild = fork()0 &lt; 0)</p>\n\n<p>I now have an infinite loop as the parent is waiting for the lastChild's pid. Here's the output:</p>\n\n<pre><code>Initializing pipes\nnumpipes = 2\npipe initializing; i is 0\npipe initializing; i is 2\nfirstChild pid = 20521\nfirstChild pid = 20522\ndoing dup2 fildes[writeDes]\nmiddleChild pid = 20521\nmiddleChild pid = 20523\nlastChild pid = 20521\nOnly the parent should be here\nMy pid is 20521\nlastChild pid = 20524\n &lt;infinite loop&gt;\n</code></pre>\n\n<p>I'm still clueless though as to what's going on or what's potentially stopping the child.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481101867, "post_id": 41013343, "comment_id": 69234181, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1481101929, "post_id": 41013343, "comment_id": 69234220, "body": "<code>for (k=0;</code> --&gt; <code>for (int k=0;</code>, at least."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1481101946, "post_id": 41013343, "comment_id": 69234235, "body": "You do realize that line numbers are not shown, right? A good idea is to mark with a code comment the place you&#39;re talking about, to make it easier to help you."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1481101979, "post_id": 41013343, "comment_id": 69234256, "body": "<i>&quot;doesn&#39;t work&quot;</i> is not suitable problem description. Please read about <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, <a href=\"https://stackoverflow.com/posts/41013343/edit\">edit</a> your question and provide input you gave, output you got, and output you expected."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1481101985, "post_id": 41013343, "comment_id": 69234260, "body": "are you actually using nested functions? that&#39;s non-standard."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1481102290, "post_id": 41013343, "comment_id": 69234469, "body": "<code>c</code> which was obtained from <code>fgets</code> contains a newline, but <code>&quot;A B&quot;</code> does not - so <code>strstr</code> will not find the substring."}, {"owner": {"reputation": 31, "user_id": 7217535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e234b0b0ea1e16a541210359d16c87?s=128&d=identicon&r=PG&f=1", "display_name": "Noktua", "link": "https://stackoverflow.com/users/7217535/noktua"}, "edited": false, "score": 0, "creation_date": 1481102759, "post_id": 41013343, "comment_id": 69234787, "body": "Thanks everybody. The problem was the the new line. Now can you help me how to delete it from c? As you can see I&#39;m not a coding genius"}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1481102822, "creation_date": 1481102822, "answer_id": 41013709, "question_id": 41013343, "link": "https://stackoverflow.com/questions/41013343/fgets-strstr-do-not-seems-to-work/41013709#41013709", "title": "fgets &amp; strstr do not seems to work?", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/c37dh6kf.aspx\" rel=\"nofollow noreferrer\"><code>fgets</code> man page</a> says</p>\n\n<blockquote>\n  <p>fgets reads characters from the current stream position to and\n  including the first newline character, to the end of the stream, or\n  until the number of characters read is equal to n \u2013 1, whichever comes\n  first.</p>\n</blockquote>\n\n<p>That is why you get a match when you set up <code>c</code> with <code>strcpy</code> but not with <code>fgets</code>.</p>\n\n<p>You can remove the newline like this</p>\n\n<pre><code>c [ strcspn(c, \"\\r\\n\") ] = 0;\n</code></pre>\n\n<p>and if there is no newline present, this is harmless.</p>\n"}, {"tags": [], "owner": {"reputation": 1560, "user_id": 4303216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-crjc3oGU_5c/AAAAAAAAAAI/AAAAAAAAADc/BTLu8OHFfRM/photo.jpg?sz=128", "display_name": "sameera sy", "link": "https://stackoverflow.com/users/4303216/sameera-sy"}, "is_accepted": false, "score": 0, "last_activity_date": 1481103120, "creation_date": 1481103120, "answer_id": 41013830, "question_id": 41013343, "link": "https://stackoverflow.com/questions/41013343/fgets-strstr-do-not-seems-to-work/41013830#41013830", "title": "fgets &amp; strstr do not seems to work?", "body": "<p>Add this line after the <code>fgets</code>. You need to remove the <code>\\n</code> after reading it from <code>stdin</code></p>\n\n<pre><code>fgets(c, 60, stdin);\nstrtok(c, \"\\n\"); // add this statement\n</code></pre>\n\n<p>Tokenize the <code>c</code> array after reading it from stdin. Should work fine after this. Cheers!</p>\n"}], "owner": {"reputation": 31, "user_id": 7217535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e234b0b0ea1e16a541210359d16c87?s=128&d=identicon&r=PG&f=1", "display_name": "Noktua", "link": "https://stackoverflow.com/users/7217535/noktua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 0, "accepted_answer_id": 41013709, "answer_count": 2, "score": -2, "last_activity_date": 1481103120, "creation_date": 1481101808, "last_edit_date": 1481102084, "question_id": 41013343, "link": "https://stackoverflow.com/questions/41013343/fgets-strstr-do-not-seems-to-work", "title": "fgets &amp; strstr do not seems to work?", "body": "<p>Here is the whole code, the problem is in the 25th line. If I give the value withe strcpy, the code works. If I try to read the value with fgets, the strstr in the 23th line doesn't work. Thanks for your help.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\ntypedef struct tk {\n    char name[60];\n} tk;\n\nint main() {\n    tk* array;\n    array = (tk*) calloc(1, sizeof(tk));\n    int k;\n    char c[60], h[60];\n    strcpy(array[0].name, \"A B\");\n\n    void find(char *c, tk *array) {\n        for (k = 0; k &lt; strlen(array[0].name); k++) {\n            h[k] = tolower(array[0].name[k]);\n        }\n        printf(\"%s %s\", array[0].name,c);\n        if (strstr(h, c) != NULL) printf(\"1\");\n    }\n    fgets(c, 60, stdin);\n    k = 0;\n    for (k = 0; (k &lt; strlen(c)); k++) {\n        c[k] = tolower(c[k]);\n    }\n    find(c, array);\n    free(array);\n    return (0);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "vhdl", "fpga", "avr"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1481100929, "post_id": 41012935, "comment_id": 69233574, "body": "Are you sure your clocking sequence is correct? The instruction says you should write the data and then strobe the clock hi and low."}, {"owner": {"reputation": 329, "user_id": 4107537, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f02be5829fe59ab0cb5e30e8d13b3ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Evans", "link": "https://stackoverflow.com/users/4107537/bradley-evans"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481100993, "post_id": 41012935, "comment_id": 69233623, "body": "I tested the clocking sequence in a VHDL testbench and from all appearances it was correct. I could re-examine that aspect of it if you see no issues with the C as written. This is all custom modules I wrote. Prolly could have done SPI, but this is a bit of a hack and personal exercise."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481101100, "post_id": 41012935, "comment_id": 69233689, "body": "You have not brought the clock low at the end of the loop but at the <i>start</i>. Where clause 4a) says &quot;the output is written....&quot; that means &quot;the output you have already written gets transmitted&quot;, and <i>not</i> &quot;this is when you write the data.&quot;"}, {"owner": {"reputation": 329, "user_id": 4107537, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f02be5829fe59ab0cb5e30e8d13b3ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Evans", "link": "https://stackoverflow.com/users/4107537/bradley-evans"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481101178, "post_id": 41012935, "comment_id": 69233742, "body": "The clock is brought low at the beginning of the loop, then the input bit is set, then the clock is brought high. The FPGA sets the bit on the rising edge. My mistake if my description didn&#39;t reflect that."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1481101240, "post_id": 41012935, "comment_id": 69233777, "body": "That step where you convert &quot;bits into an array of binary values&quot; makes no sense to me. You should be able to send bits directly from the 128-bit array you end up with after the hex-to-binary conversion."}, {"owner": {"reputation": 329, "user_id": 4107537, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f02be5829fe59ab0cb5e30e8d13b3ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Evans", "link": "https://stackoverflow.com/users/4107537/bradley-evans"}, "edited": false, "score": 0, "creation_date": 1481101351, "post_id": 41012935, "comment_id": 69233845, "body": "That could be an artifact of how I think (and, being a student, it&#39;s not given that how I think is appropriate). Put that way, you&#39;re right. I ought to be able to just send all eight bits while in that point in the array."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1481101404, "post_id": 41012935, "comment_id": 69233890, "body": "@BradleyEvans I see that now, it just seems a peculiar way to do it when clock is already low from a few lines before the loop."}, {"owner": {"reputation": 329, "user_id": 4107537, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f02be5829fe59ab0cb5e30e8d13b3ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Evans", "link": "https://stackoverflow.com/users/4107537/bradley-evans"}, "edited": false, "score": 0, "creation_date": 1481101690, "post_id": 41012935, "comment_id": 69234065, "body": "I just added the VHDL code of the module this communicates with"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1481107172, "post_id": 41012935, "comment_id": 69237716, "body": "Why do you have the binary values as strings in the first place?"}, {"owner": {"reputation": 329, "user_id": 4107537, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f02be5829fe59ab0cb5e30e8d13b3ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Evans", "link": "https://stackoverflow.com/users/4107537/bradley-evans"}, "edited": false, "score": 0, "creation_date": 1481132370, "post_id": 41012935, "comment_id": 69254920, "body": "The user enters the hex values via a keypad, and other routines are displaying the value entered on an LCD. I have to convert the input into a bitstream."}], "answers": [{"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 1, "last_activity_date": 1481114414, "creation_date": 1481114414, "answer_id": 41017757, "question_id": 41012935, "link": "https://stackoverflow.com/questions/41012935/convert-c-string-to-an-array-of-binary-values-then-transmit-the-array-bit-by-bi/41017757#41017757", "title": "Convert C-string to an array of binary values, then transmit the array bit-by-bit", "body": "<p>If I were you, I'd write the function so that it takes the 128 bits in binary. </p>\n\n<p>Also, I suspect your bit setting is incorrect (as of writing this answer). I've tried to explain my logic in the comments in the code:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;errno.h&gt;\n\n#define FPGA_LONG_DELAY() delay_ms(1)\n#define FPGA_DELAY()      delay_ms(1)\n\nint fpga_write_128bit(const uint8_t data[16])\n{\n    int i;\n\n    if (!data)\n        return EINVAL;\n\n    /* Ensure non-active state. */\n    CLR_BIT(FPGA_DDR, AVR_EN);\n    CLR_BIT(FPGA_DDR, AVR_CLK);\n    CLR_BIT(FPGA_DDR, MD5_RST);\n    CLR_BIT(FPGA_DDR, AVR_IN);\n    FPGA_LONG_DELAY();\n\n    /* Prepare for reset on rising clock edge. */\n    SET_BIT(FPGA_DDR, AVR_EN);\n    SET_BIT(FPGA_DDR, MD5_RST);\n    FPGA_DELAY();\n\n    /* Pulse clock (rising and trailing edges). */\n    SET_BIT(FPGA_DDR, AVR_CLK);\n    FPGA_DELAY();\n    CLR_BIT(FPGA_DDR, AVR_CLK);\n\n    /* Set reset low, and prepare for sending the data bits. */\n    CLR_BIT(FPGA_DDR, MD5_RST);\n\n    for (i = 0; i &lt; 128; i++) {\n\n        /* AVR_CLK is low and AVR_EN high at this point. */\n\n        /* Set data; LSB of first byte first. */\n        if ((data[i / 8] &amp; (1U &lt;&lt; (i &amp; 7))))\n            SET_BIT(FPGA_DDR, AVR_IN);\n        else\n            CLR_BIT(FPGA_DDR, AVR_IN);\n\n        /* Ensure data bit state is stable before rising edge of clock. */\n        FPGA_DELAY();\n\n        /* Clock pulse (both rising and trailing edges) */\n        SET_BIT(FPGA_DDR, AVR_CLK);\n        FPGA_DELAY();\n        CLR_BIT(FPGA_DDR, AVR_CLK);\n    }\n\n    /* All bits transferred, clock is low. */\n\n    CLR_BIT(FPGA_DDR, AVR_IN);   /* Irrelevant, but let's leave a known state behind */\n    CLR_BIT(FPGA_DDR, AVR_EN);\n\n    return 0;\n}\n</code></pre>\n\n<p>You probably noticed that I used two macros, <code>FPGA_LONG_DELAY()</code> and <code>FPGA_DELAY()</code> in there. As they are defined now, sending a single 128 bit value takes 259ms, or a bit over a quarter second. You can probably define both as empty strings; if not, at least much shorter than 1ms.</p>\n\n<p>Test the above function that it works as you need it to.</p>\n\n<p>If you still want a function that takes the 128-bit word as a string, just create a wrapper function that parses the hex value, then calls the above function.</p>\n\n<p>The above function sends the least significant bit of the first byte first. If we consider the hex string as a single 128-bit number, then we need to parse it from right to left, with the first (rightmost) character denoting the least significant nibble (four bits).</p>\n\n<p>If you want the VHDL <code>HASH_OUT</code> states to be</p>\n\n<pre><code>HASH_OUT(   0 ) = 0\nHASH_OUT(   1 ) = 0\nHASH_OUT(   2 ) = 0\nHASH_OUT(   3 ) = 0\nHASH_OUT(   4 ) = 0\nHASH_OUT(   5 ) = 0\nHASH_OUT(   6 ) = 0\nHASH_OUT(   7 ) = 0\n\nHASH_OUT(   8 ) = 1\nHASH_OUT(   9 ) = 0\nHASH_OUT(  10 ) = 0\nHASH_OUT(  11 ) = 0\nHASH_OUT(  12 ) = 0\nHASH_OUT(  13 ) = 0\nHASH_OUT(  14 ) = 0\nHASH_OUT(  15 ) = 0\n\nHASH_OUT(  16 ) = 0\nHASH_OUT(  17 ) = 1\nHASH_OUT(  18 ) = 0\nHASH_OUT(  19 ) = 0\nHASH_OUT(  20 ) = 0\nHASH_OUT(  21 ) = 0\nHASH_OUT(  22 ) = 0\nHASH_OUT(  23 ) = 0\n\nHASH_OUT(  24 ) = 1\nHASH_OUT(  25 ) = 1\nHASH_OUT(  26 ) = 0\nHASH_OUT(  27 ) = 0\nHASH_OUT(  28 ) = 0\nHASH_OUT(  29 ) = 0\nHASH_OUT(  30 ) = 0\nHASH_OUT(  31 ) = 0\n</code></pre>\n\n<p>and so on, up to</p>\n\n<pre><code>HASH_OUT( 120 ) = 1\nHASH_OUT( 121 ) = 1\nHASH_OUT( 122 ) = 1\nHASH_OUT( 123 ) = 1\nHASH_OUT( 124 ) = 0\nHASH_OUT( 125 ) = 0\nHASH_OUT( 126 ) = 0\nHASH_OUT( 127 ) = 0\n</code></pre>\n\n<p>you can use the following macro and <code>data</code> array:</p>\n\n<pre><code>#define PACKBYTE(b0, b1, b2, b3, b4, b5, b6, b7) \\\n                (  (uint8_t)(!!(b0))       \\\n                | ((uint8_t)(!!(b1)) &lt;&lt; 1) \\\n                | ((uint8_t)(!!(b2)) &lt;&lt; 2) \\\n                | ((uint8_t)(!!(b3)) &lt;&lt; 3) \\\n                | ((uint8_t)(!!(b4)) &lt;&lt; 4) \\\n                | ((uint8_t)(!!(b5)) &lt;&lt; 5) \\\n                | ((uint8_t)(!!(b6)) &lt;&lt; 6) \\\n                | ((uint8_t)(!!(b7)) &lt;&lt; 7) )\n\nconst uint8_t data[16] = {\n     PACKBYTE( 0, 0, 0, 0, 0, 0, 0, 0 ),\n     PACKBYTE( 1, 0, 0, 0, 0, 0, 0, 0 ),\n     PACKBYTE( 0, 1, 0, 0, 0, 0, 0, 0 ),\n     PACKBYTE( 1, 1, 0, 0, 0, 0, 0, 0 ),\n     PACKBYTE( 0, 0, 1, 0, 0, 0, 0, 0 ),\n     /* 10 PACKBYTE() lines omitted for brevity */\n     PACKBYTE( 1, 1, 1, 1, 0, 0, 0, 0 )\n};\n</code></pre>\n\n<p>Note that the <code>!!</code> in the macro is just two not operators. <code>!!x</code> evaluates to 0 if <code>x</code> is zero, and to 1 if <code>x</code> is nonzero. Unlike normally, the leftmost bit is the least significant, so that the array above has the bits in the same order as the <code>HASH_OUT</code> in the VHDL.</p>\n\n<p>For the string-in-hex version, I'd recommend using a function to convert the character to decimal:</p>\n\n<pre><code>static uint8_t hex_digit(const char c)\n{\n    switch (c) {\n    case '0':           return  0U;\n    case '1':           return  1U;\n    case '2':           return  2U;\n    case '3':           return  3U;\n    case '4':           return  4U;\n    case '5':           return  5U;\n    case '6':           return  6U;\n    case '7':           return  7U;\n    case '8':           return  8U;\n    case '9':           return  9U;\n    case 'A': case 'a': return 10U;\n    case 'B': case 'b': return 11U;\n    case 'C': case 'c': return 12U;\n    case 'D': case 'd': return 13U;\n    case 'E': case 'e': return 14U;\n    case 'F': case 'f': return 15U;\n    default:            return 255U; /* Invalid value. */\n    }\n}\n\nint fpga_write_hex_string(const char *const hex)\n{\n    uint8_t data[16], hi, lo;\n    int     i;\n\n    if (!hex)\n        return EINVAL;\n\n    for (i = 0; i &lt; 16; i++) {\n\n        /* Note: we parse the input string in pairs of\n                 characters, leftmost first, so that if\n                 it happens to be short, we won't try\n                 to access it past its end. */\n\n        hi = hex_digit(hex[2*i]);\n        if (hi &gt; 15U)\n            return EINVAL;\n\n        lo = hex_digit(hex[2*i + 1]);\n        if (lo &gt; 15U)\n            return EINVAL;\n\n        /* The i'th pair of hex digits form the\n           (15-i)'th byte value. */\n        data[15 - i] = lo | (hi &lt;&lt; 4);\n    }\n\n    return fpga_write_128bit(data);\n}\n</code></pre>\n\n<p>You could of course just accept a binary string (composed of 128 characters of <code>0</code> or <code>1</code>, in the same order as the VHDL <code>HASH_OUT</code>):</p>\n\n<pre><code>int fpga_write_bin_string(const char *const bin)\n{\n    uint8_t data[16] = {0};\n    int     i;\n\n    if (!bin)\n        return EINVAL;\n\n    for (i = 0; i &lt; 128; i++)\n        if (bin[i] == '1')\n            data[i/8] |= 1U &lt;&lt; (i &amp; 7);\n        else\n        if (bin[i] != '0')\n            return EINVAL;\n\n    return fpga_write_128bit(data);\n}\n</code></pre>\n\n<p>I wish I had one of these (AVR or ARM with an FPGA) to play with myself. So, obviously, all of the above code is untested. Feel free to use it as you wish (it's in public domain), but don't blame me if it breaks your board.</p>\n"}], "owner": {"reputation": 329, "user_id": 4107537, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f02be5829fe59ab0cb5e30e8d13b3ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Evans", "link": "https://stackoverflow.com/users/4107537/bradley-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1481114414, "creation_date": 1481100505, "last_edit_date": 1481101674, "question_id": 41012935, "link": "https://stackoverflow.com/questions/41012935/convert-c-string-to-an-array-of-binary-values-then-transmit-the-array-bit-by-bi", "title": "Convert C-string to an array of binary values, then transmit the array bit-by-bit", "body": "<p>I want to send a 128-bit value to an FPGA, bit-by-bit, from an AVR. The FPGA expects the following transaction to occur:<br>\n1) RST signal to clear the FPGA's 128-bit register. Goes high, then goes low. A \"CLOCK\" signal is set to low.<br>\n2) An ENABLE bit is set to high to indicate that a transfer is underway.<br>\n3) An INPUT bit is set to the value of arrayOfBinaryValues[i].<br>\n4a) CLOCK signal goes high. On leading edge, the value of INPUT is stored in position i on the FPGA.<br>\n4b) CLOCK signal goes low.<br>\n4c) INPUT bit set to next value of arrayOfBinaryValues[i]<br>\n[Repeat 4a-4c until whole array is sent]<br></p>\n\n<p>So, I wrote a function to get this done. It happens in stages. Step 1, the user inputs a 32-character value that is stored as a c-string. Since these are characters, I have to convert them to corresponding hex values:</p>\n\n<pre><code>void transmitToFPGA(unsigned char hash[32]) {\n    // convert the characters to their corresponding hex values\n    unsigned char hash_hex[32];\n    unsigned char j = 0;\n\n    SET_BIT(FPGA_DDR,MD5_RST); // sets reset bit high\n\n    for (unsigned char i=0; i&lt;32; i++) {\n        switch (hash[i]) {\n            case '0': hash_hex[i] = 0x00; break;\n            case '1': hash_hex[i] = 0x01; break;\n            case '2': hash_hex[i] = 0x02; break;\n            case '3': hash_hex[i] = 0x03; break;\n            case '4': hash_hex[i] = 0x04; break;\n            case '5': hash_hex[i] = 0x05; break;\n            case '6': hash_hex[i] = 0x06; break;\n            case '7': hash_hex[i] = 0x07; break;\n            case '8': hash_hex[i] = 0x08; break;\n            case '9': hash_hex[i] = 0x09; break;\n            case 'A': hash_hex[i] = 0x0a; break;\n            case 'B': hash_hex[i] = 0x0b; break;\n            case 'C': hash_hex[i] = 0x0c; break;\n            case 'D': hash_hex[i] = 0x0d; break;\n            case 'E': hash_hex[i] = 0x0e; break;\n            case 'F': hash_hex[i] = 0x0f; break;\n            default:  hash_hex[i] = 0x00; break;\n        }\n    }\n</code></pre>\n\n<p>Then I tried converting the corresponding bits into an array of binary values like so:</p>\n\n<pre><code>   unsigned char hash_bin[128];\n    for (unsigned char i=0; i&lt;32; i++) {\n        hash_bin[j] = hash_hex[i] &amp; 0x01; j++;\n        hash_bin[j] = hash_hex[i] &amp; 0x02; j++;\n        hash_bin[j] = hash_hex[i] &amp; 0x04; j++;\n        hash_bin[j] = hash_hex[i] &amp; 0x08; j++;\n    }\n</code></pre>\n\n<p>Then I perform the transmission</p>\n\n<pre><code>    // conduct transmission\n    CLR_BIT(FPGA_DDR,MD5_RST);  // clear reset\n    delay_ms(1);\n    CLR_BIT(FPGA_DDR,AVR_CLK);         // AVR_CLK = 0\n    delay_ms(1);\n    CLR_BIT(FPGA_DDR,AVR_EN);          // AVR_EN = 0\n    delay_ms(1);\n    CLR_BIT(FPGA_DDR,AVR_IN);        // AVR_IN = 0\n    delay_ms(1);\n    for (unsigned char i=0; i&lt;128; i++) {\n        CLR_BIT(FPGA_DDR,AVR_CLK);     // AVR_CLK = 0\n        delay_ms(1);\n        SET_BIT(FPGA_DDR,AVR_EN);      // AVR_EN = 1\n        delay_ms(1);\n        if (hash_bin[i] == 0) {         // AVR_IN = hash_bin[i]\n            CLR_BIT(FPGA_DDR,AVR_IN);\n        } else {\n            SET_BIT(FPGA_DDR,AVR_IN);\n        }\n        delay_ms(1);\n  t      SET_BIT(FPGA_DDR,AVR_EN);      // AVR_CLK = 1\n        delay_ms(1);\n    }\n}\n</code></pre>\n\n<p>Unfortunately, this doesn't seem to work and I'm not entirely sure why. I suspect the way I perform conversion is not working properly. Does anyone have any insights?</p>\n\n<p>edit: This is the VHDL module this code communicates with:</p>\n\n<pre><code>library IEEE;\nuse IEEE.STD_LOGIC_1164.ALL;\nentity SPI_Slave is\n    Port ( AVR_IN   :   in      STD_LOGIC;\n           AVR_CLK  :  in   STD_LOGIC;\n           RST      :   in      STD_LOGIC;\n              ENABLE        :   in  STD_LOGIC;\n              READY         :   out     STD_LOGIC;\n           HASH_OUT     :   out     STD_LOGIC_VECTOR (127 downto 0) := x\"00000000000000000000000000000000\" );\nend SPI_Slave;\n\narchitecture Behavioral of SPI_Slave is\n\n    shared variable count : integer := 0;\n    signal hash : std_logic_vector(127 downto 0);   \n\nbegin\n\n    PROCESS(AVR_CLK, ENABLE)\n    BEGIN\n        IF (ENABLE = '1') THEN                  -- If ENABLE is HIGH\n            IF (rising_edge(AVR_CLK)) THEN  -- If CLK goes HIGH\n                IF (RST = '1') THEN             -- If RST is HIGH\n                    hash &lt;= x\"00000000000000000000000000000000\"; -- then zero HASH_OUT and count\n                    count := 0;\n                    READY &lt;= '0';               \n                ELSE                                -- Otherwise, if RST is LOW\n                    IF (count &gt; 126) THEN\n                        hash(count) &lt;= AVR_IN;\n                        HASH_OUT &lt;= hash (127 downto 0);\n                        READY &lt;= '1';\n                        count := count + 1;\n                    ELSE \n                        hash(count) &lt;= AVR_IN;\n                        count := count + 1;\n                        READY &lt;= '0';\n                    END IF;\n                END IF;\n            END IF;\n        END IF;\n    END PROCESS;\n\n\n\n\n\nend Behavioral;\n</code></pre>\n"}, {"tags": ["c", "ansi-c", "atof"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1481100287, "post_id": 41012781, "comment_id": 69233163, "body": "It really doesn&#39;t matter. If you assign the result to a variable it doesn&#39;t matter if you cast it or not, no more memory will be used and the compiler might have some nice optimized function that will make it all negligible. Don&#39;t do premature optimizations, concentrate on writing good and readable and maintainable code first of all."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 2, "creation_date": 1481102031, "post_id": 41012781, "comment_id": 69234295, "body": "Unless you&#39;re on an embedded platform with software floating point, your CPU most likely stores all floating point values in registers that are double sized."}, {"owner": {"reputation": 251, "user_id": 1510299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e7f104e338e70ecdfb8ab48292022d?s=128&d=identicon&r=PG", "display_name": "ojs", "link": "https://stackoverflow.com/users/1510299/ojs"}, "edited": false, "score": 1, "creation_date": 1503506292, "post_id": 41012781, "comment_id": 78648322, "body": "For the record, I&#39;m looking at this question because I am on an embedded platform with hardware single precision and software double precision float."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1506850812, "post_id": 41012781, "comment_id": 79976167, "body": "Consider rolling your own version, or checking if your platform offers platform-specific function for this task"}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1481100704, "post_id": 41012842, "comment_id": 69233430, "body": "Question is tagged [ansi-c]. According to <a href=\"http://en.cppreference.com/w/c/string/byte/strtof\" rel=\"nofollow noreferrer\">this reference</a> <code>strtof</code>was added in C99, so you&#39;re at compilers mercy on whether that function exists. (BTW www.cplusplus.com is a poor reference for C questions)"}], "tags": [], "owner": {"reputation": 1215, "user_id": 3021786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aCk4s.jpg?s=128&g=1", "display_name": "Henningsson", "link": "https://stackoverflow.com/users/3021786/henningsson"}, "is_accepted": true, "score": 4, "last_activity_date": 1481100219, "creation_date": 1481100219, "answer_id": 41012842, "question_id": 41012781, "link": "https://stackoverflow.com/questions/41012781/atof-for-float-instead-of-double/41012842#41012842", "title": "atof() for float instead of double", "body": "<p>Use <code>strtof</code> instead, it will return a float.</p>\n\n<p><a href=\"http://www.cplusplus.com/reference/cstdlib/strtof/\" rel=\"nofollow noreferrer\">See documentation here</a></p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1481119068, "creation_date": 1481119068, "answer_id": 41019341, "question_id": 41012781, "link": "https://stackoverflow.com/questions/41012781/atof-for-float-instead-of-double/41019341#41019341", "title": "atof() for float instead of double", "body": "<p>If the platform does have a direct \"string to float\" conversion routine and the compiler is optimizing, it will certainly call that conversion routine via:</p>\n\n<pre><code>char *buf = ...\nfloat y; \nif (sscanf(buf, \"%f\", &amp;y) == 1) Success();\n</code></pre>\n\n<p>If not, then use</p>\n\n<pre><code>float y = (float)atof(buf);\n</code></pre>\n\n<p>Note that the second could be optimized by the compiler to call the \"string to float\" if it violates the subtle <a href=\"https://en.wikipedia.org/wiki/Rounding#Double_rounding\" rel=\"nofollow noreferrer\">double rounding</a> that otherwise occurs with this 2nd code.</p>\n"}], "owner": {"reputation": 5191, "user_id": 1138160, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/76ba5bd954a4f842d93c7eaba0b39227?s=128&d=identicon&r=PG", "display_name": "Elmi", "link": "https://stackoverflow.com/users/1138160/elmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6580, "favorite_count": 0, "accepted_answer_id": 41012842, "answer_count": 2, "score": 6, "last_activity_date": 1506850352, "creation_date": 1481100032, "last_edit_date": 1481100150, "question_id": 41012781, "link": "https://stackoverflow.com/questions/41012781/atof-for-float-instead-of-double", "title": "atof() for float instead of double", "body": "<p><code>atof()</code> returns a double, which results in a warning when I assign it to a float-value (and yes, I definitively have to use float).</p>\n\n<p>So my question: is there a <code>atof()</code>-variant available which returns a plain float? Or do I have to solve this by a cast - which would be a pity because it wastes resources for creating a double which will be thrown away immediately.</p>\n"}]