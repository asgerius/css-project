[{"tags": ["c", "stdin", "fgets"], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484178716, "post_id": 41602843, "comment_id": 70408215, "body": "Certainly <code>strrchr(pseudo, &#39;\\n&#39;);</code> would always provide the same result as <code>strchr(pseudo, &#39;\\n&#39;);</code> after a <code>fgets()</code>.   Do you suspect better performance <code>strrchr()</code>?  I suppose there could be."}, {"owner": {"reputation": 97, "user_id": 6896250, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1c0eb5b76b2ffcb0530fc90d4464898?s=128&d=identicon&r=PG&f=1", "display_name": "StuYYY", "link": "https://stackoverflow.com/users/6896250/stuyyy"}, "edited": false, "score": 0, "creation_date": 1484179023, "post_id": 41602843, "comment_id": 70408302, "body": "Since fgets add &#39;\\n&#39; at the end of the input, finding a &#39;\\n&#39; with strrrchr doesn&#39;t always mean that we read all character, does it ?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484179117, "post_id": 41602843, "comment_id": 70408331, "body": "@chux  Honestly I&#39;m with you in doubting it makes a difference. It is <i>feasible</i> a scasb under rep could be faster (akin to <code>strlen</code> + backoff one slot and load) compared to a forward hunt for a non-zero value, but I honestly have never taken the time to count the clock cycles. I usually use <code>strrchr</code> when explaining a question like this because it&#39;s easier for beginners to understand searching from the end of the string backwards. If it did make a performance difference, I&#39;d be surprised."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 97, "user_id": 6896250, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1c0eb5b76b2ffcb0530fc90d4464898?s=128&d=identicon&r=PG&f=1", "display_name": "StuYYY", "link": "https://stackoverflow.com/users/6896250/stuyyy"}, "edited": false, "score": 0, "creation_date": 1484179192, "post_id": 41602843, "comment_id": 70408362, "body": "@StuYYY Who told you <code>fgets</code> &quot;adds <code>&#39;\\n&#39;</code> to the end of input&quot; ? It doesn&#39;t. It <i>keeps</i> it if it is present within the input stream (consuming it from said-same in the process) and space is available in the target buffer. It doesn&#39;t &quot;add&quot; it out of thin air. See <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\">the documentation of <code>fgets</code></a> and read it carefully."}, {"owner": {"reputation": 97, "user_id": 6896250, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1c0eb5b76b2ffcb0530fc90d4464898?s=128&d=identicon&r=PG&f=1", "display_name": "StuYYY", "link": "https://stackoverflow.com/users/6896250/stuyyy"}, "edited": false, "score": 0, "creation_date": 1484179418, "post_id": 41602843, "comment_id": 70408443, "body": "Indeed i misunderstood fgets doc. It work perfectly , thanks a lot !"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 97, "user_id": 6896250, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1c0eb5b76b2ffcb0530fc90d4464898?s=128&d=identicon&r=PG&f=1", "display_name": "StuYYY", "link": "https://stackoverflow.com/users/6896250/stuyyy"}, "edited": false, "score": 0, "creation_date": 1484179461, "post_id": 41602843, "comment_id": 70408455, "body": "@StuYYY No worries. Bookmark that site. it is honestly the best C and C++ language and library site you&#39;re apt to find, and is very well maintained. Best of luck."}], "tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": false, "score": 2, "last_activity_date": 1484178431, "creation_date": 1484178431, "answer_id": 41602843, "question_id": 41602620, "link": "https://stackoverflow.com/questions/41602620/empty-stdin-between-fgets-calls/41602843#41602843", "title": "Empty stdin between fgets calls", "body": "<p>You have several problems:</p>\n\n<ul>\n<li>Your loop logic is broken.</li>\n<li>Your should only execute the <em>fixed</em> loop if you detect your input line did not end with a newline, which is not being done at all.</li>\n</ul>\n\n<p>So something like this trivial example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char *pseudo = malloc(21);\n    if (fgets(pseudo,21,stdin))\n    {\n        char *cr = strrchr(pseudo, '\\n');\n        if (cr == NULL)\n        {\n            int c;\n            while ((c = fgetc(stdin)) != '\\n' &amp;&amp; c != EOF);\n        }\n        else\n        {\n            *cr = 0;\n        }\n    }\n    else\n    {\n        *pseudo = 0;\n    }\n\n    char * tube = malloc(21);\n    if (fgets(tube,21,stdin))\n    {\n        char *cr = strrchr(tube, '\\n');\n        if (cr == NULL)\n        {\n            int c;\n            while ((c = fgetc(stdin)) != '\\n' &amp;&amp; c != EOF);\n        }\n        else\n        {\n            *cr = 0;\n        }\n    }\n    else\n    {\n        *tube = 0;\n    }\n\n    printf(\"%s : %s\\n\", pseudo, tube);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Input</strong></p>\n\n<pre><code>01234567890123456789012345\n0123456789012345678\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>01234567890123456789 : 0123456789012345678\n</code></pre>\n\n<p>Obviously you could refactor this to put all that duplicate code in a well-crafted function or two, but hopefully you get the idea.</p>\n"}], "owner": {"reputation": 97, "user_id": 6896250, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1c0eb5b76b2ffcb0530fc90d4464898?s=128&d=identicon&r=PG&f=1", "display_name": "StuYYY", "link": "https://stackoverflow.com/users/6896250/stuyyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1484178431, "creation_date": 1484177033, "question_id": 41602620, "link": "https://stackoverflow.com/questions/41602620/empty-stdin-between-fgets-calls", "title": "Empty stdin between fgets calls", "body": "<p>i have a code where i want 2 users input of 20 char max.\nI want to only keep 20. My problem is that after the 1st input, if user entered more than 20 char, those chars are still in stdin so it will be read by the next fgets.</p>\n\n<pre><code>  char *pseudo = malloc(21);\n  fgets(pseudo,21,stdin);\n  strtok(pseudo,\"\\n\");\n\n  char * tube = malloc(21);\n  fgets(tube,21,stdin);\n  strtok(tube,\"\\n\");\n</code></pre>\n\n<p>I found the following solution to empty stdin between 2 fgets calls, it works but it blocks between the 2 calls : i have to enter something to get asked the 2nd input.</p>\n\n<pre><code>int c = 0;\n    while (c != '\\n' &amp;&amp; c != EOF)\n    {\n        c = getchar();\n    }\n</code></pre>\n"}, {"tags": ["c", "parsing", "arduino", "gps"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1484177209, "post_id": 41602594, "comment_id": 70407729, "body": "This is a great question, which I will upvote, but I have trimmed out a lot of chat. Please try to avoid material like &quot;I really have searched for ages&quot; and &quot;is this question okay&quot; as that often features in questions without any effort or research, and you don&#39;t want to sound like them! <code>:-)</code>"}, {"owner": {"reputation": 21891, "user_id": 1243762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9b83cf6ca76699d7abfbba07f4675a3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Coder", "link": "https://stackoverflow.com/users/1243762/guy-coder"}, "edited": false, "score": 0, "creation_date": 1484177390, "post_id": 41602594, "comment_id": 70407794, "body": "Of interest: <a href=\"http://aprs.gids.nl/nmea/\" rel=\"nofollow noreferrer\">GPS - NMEA sentence information</a>"}, {"owner": {"reputation": 21891, "user_id": 1243762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9b83cf6ca76699d7abfbba07f4675a3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Coder", "link": "https://stackoverflow.com/users/1243762/guy-coder"}, "edited": false, "score": 0, "creation_date": 1484178035, "post_id": 41602594, "comment_id": 70408010, "body": "Did you notice that each example line has a different start, e.g. <code>$GPRMC</code>,<code>$GPGGA</code>, and <code>$GPGSA</code>. If you just Google that you will quickly find <a href=\"http://aprs.gids.nl/nmea/\" rel=\"nofollow noreferrer\">GPS - NMEA sentence information</a> which give the details on each line type. Also without running this I see <code>const char delimiters[] = &quot;$GPRMC,&quot;;</code> which looks very wrong as <code>$</code>,<code>G</code>,<code>P</code>,<code>R</code>,<code>M</code>,and <code>C</code> are not used as delimiters; I would expect something link <code>const char delimiters[] = &quot;,&quot;;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21891, "user_id": 1243762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9b83cf6ca76699d7abfbba07f4675a3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Coder", "link": "https://stackoverflow.com/users/1243762/guy-coder"}, "edited": false, "score": 1, "creation_date": 1484178511, "post_id": 41602688, "comment_id": 70408145, "body": "<code>First rule in programming is research potential existing solutions to exploit</code> you sound line a <a href=\"https://en.wikipedia.org/wiki/Ferengi\" rel=\"nofollow noreferrer\">Ferengi</a> with Rules of Acquisition."}], "tags": [], "owner": {"reputation": 181, "user_id": 4603962, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/175ty.jpg?s=128&g=1", "display_name": "daemondave", "link": "https://stackoverflow.com/users/4603962/daemondave"}, "is_accepted": false, "score": 1, "last_activity_date": 1484177399, "creation_date": 1484177399, "answer_id": 41602688, "question_id": 41602594, "link": "https://stackoverflow.com/questions/41602594/strtok-for-gps-parsing-cannot-identify-string/41602688#41602688", "title": "strtok for GPS parsing, cannot identify string", "body": "<p>First rule in programming is research potential existing solutions to exploit - so you can concentrate on your problem.</p>\n\n<p>There is (at least) one open source C project that has solved this and has source code in a C library to consider - for free.</p>\n\n<p><a href=\"http://nmea.sourceforge.net/\" rel=\"nofollow noreferrer\">http://nmea.sourceforge.net/</a> \nhas the features:</p>\n\n<p>Features </p>\n\n<ul>\n<li><p>Analysis NMEA sentences and granting GPS data in C structures</p></li>\n<li><p>Generate NMEA sentences</p></li>\n<li>Supported sentences: GPGGA, GPGSA, GPGSV, GPRMC, GPVTG</li>\n<li>Multilevel architecture of algorithms</li>\n<li>Additional functions of geographical mathematics and work with navigation data</li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 7407075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d500d848a02b48b80ec9cb5bf3a4508b?s=128&d=identicon&r=PG&f=1", "display_name": "tumyaaaa", "link": "https://stackoverflow.com/users/7407075/tumyaaaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1484177399, "creation_date": 1484176898, "last_edit_date": 1484177069, "question_id": 41602594, "link": "https://stackoverflow.com/questions/41602594/strtok-for-gps-parsing-cannot-identify-string", "title": "strtok for GPS parsing, cannot identify string", "body": "<p>I am not the best programmer, but I have researched and tried different angles to parsing a GPS string. </p>\n\n<p>I am currently working on a University project where my team and I are building the autonomous section of a Robotic Yard Weeder. I am in charge of creating a custom D-GPS. I cannot use TinyGPS because we are not allowed to use Arduino software, so I have to work with 'C'. </p>\n\n<p>We don't have our microcontroller yet, so I am still using Arduino software, just trying to do it without TinyGPS.</p>\n\n<p>This was all the setup given by TinyGPS:</p>\n\n<pre><code>#include &lt;SoftwareSerial.h&gt;\n#define ARDUINO_GPS_RX 9 // Arduino RX pin connected to GPS TX\n#define ARDUINO_GPS_TX 8 // Arduino TX pin connected to GPS RX\n#define GPS_BAUD_RATE 9600 // The GPS Shield module defaults to 9600 baud\n// Create a SoftwareSerial object called gps:\nSoftwareSerial gpsPort(ARDUINO_GPS_TX, ARDUINO_GPS_RX);\n\n// We'll also define a more descriptive moniker for the Serial Monitor port.\n// This is the hardware serial port on pins 0/1.\n#define SerialMonitor Serial\n\n#include &lt;string.h&gt;\n#include &lt;stddef.h&gt;\n</code></pre>\n\n<p>Here is where I try to parse:</p>\n\n<pre><code>const char string[] = gpsPort.read();\nconst char delimiters[] = \"$GPRMC,\";\nchar *cp, *tokentime, *tokenA, *tokenlat, *tokenlng, *tokenfixed, *tokensat, *tokendil, *tokenalt, *tokengeoid, *tokenempty, *tokenchecksum;\n\nvoid setup() \n{\n  gpsPort.begin(GPS_BAUD_RATE);\n  SerialMonitor.begin(9600);\n}\n\nvoid loop() \n{\n if (gpsPort.available()) // If GPS data is available\n    //SerialMonitor.write(gpsPort.read()); // Read it and print to SerialMonitor\n\n  if (SerialMonitor.available()) // If SerialMonitor data is available\n    gpsPort.write(SerialMonitor.read()); // Read it and send to GPS\n\ncp = strdupa (string);                /* Make writable copy.  */\ntokensentence = strtok (cp, delimiters); /*gets the first sentence to parse*/\n tokentime = strtok (NULL, delimiters);      /* token =&gt; 123519 \"time taken at 12 o clock 35 min 19 sec\" */\ntokenA = strtok (NULL, delimiters);    /* token =&gt; \"A\"ignore */\ntokenlat = strtok (NULL, delimiters);    /* token =&gt;  4807.038,N     \"Latitude 48 deg 07.038' N\" */\ntokenlng = strtok (NULL, delimiters);    /* token =&gt; 01131.000,E \"Longitude 11 deg 31.000' E\" */\ntokenfixed = strtok (NULL, delimiters);    /* token =&gt; 1 \"Fix quality: 0 = invalid\" */\ntokensat = strtok (NULL, delimiters);    /* token =&gt; 08 \"Number of satellites being tracked\" */\ntokendil = strtok (NULL, delimiters);    /* token =&gt; 0.9 \"Horizontal dilution of position\" */\ntokenalt = strtok (NULL, delimiters);    /* token =&gt; 545.4,M \"Altitude, Meters, above mean sea level\" */\ntokengeoid = strtok (NULL, delimiters);    /* token =&gt; 46.9,M \"Height of geoid (mean sea level) above WGS84 ellipsoid */\ntokenempty = strtok (NULL, delimiters);    /* token =&gt; empty field */\ntokenchecksum = strtok (NULL, delimiters);    /* token =&gt; *47 \"the checksum data, always begins with *\" */\n\nSerialMonitor.print(\"Lat: \"); SerialMonitor.println(tokenlat);\nSerialMonitor.print(\"Lng: \"); SerialMonitor.println(tokenlng);\n\n}\n</code></pre>\n\n<p>The issue that I am having is that the 'initializer fails to determine the size of the string'. All the examples I have seen have a set defined string, but I don't know how to parse using strtok with 'live' data (if that is the best way to call it). I have tried using 'serial.read' by itself instead of 'gpsPort.available', but had no luck.</p>\n\n<p>Just some background information, this code:</p>\n\n<pre><code>void setup() \n{\n  SerialMonitor.begin(9600); // Initialize the serial monitor port at 9600 baud\n  gpsPort.begin(GPS_BAUD_RATE); // The GPS module's default baud is 9600\n}\n\nvoid loop() \n{\n  if (gpsPort.available()) // If GPS data is available\n    SerialMonitor.write(gpsPort.read()); // Send it to the serial monitor\n  if (SerialMonitor.available()) // If data is sent to the serial monitor\n    gpsPort.write(SerialMonitor.read()); // send it to the GPS module\n}\n</code></pre>\n\n<p>Gives out this set of strings:</p>\n\n<pre><code>$GPRMC,235316.000,A,4003.9040,N,10512.5792,W,0.09,144.75,141112,,*19\n$GPGGA,235317.000,4003.9039,N,10512.5793,W,1,08,1.6,1577.9,M,-20.7,M,,0000*5F\n$GPGSA,A,3,22,18,21,06,03,09,24,15,,,,,2.5,1.6,1.9*3E\n</code></pre>\n\n<p>I am ultimately trying to parse out the latitude and longitude.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1484176896, "post_id": 41602546, "comment_id": 70407635, "body": "For those of us not biting at the chance to click to an offsite link, are you saying you have two threads, both waiting for the <i>same</i> synchronous input, and each is robbing the other of its chance at the table?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1484176914, "post_id": 41602546, "comment_id": 70407647, "body": "Your post needs to contain a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> <b>here</b>, in the question itself, and not in two separate links off-site. First, your question should be self-contained; using external links for major content means that if that link is unavailable for some reason your question has no value to future users here. Second, expecting us to leave this site and go elsewhere to figure out what you&#39;re asking is simply unreasonable. You&#39;re asking us for <b>free help</b> to solve <b>your problem</b> - you should make it as easy for us as possible, and bouncing all over the place to read it isn&#39;t doing so. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 1, "user_id": 7407001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5faffd924fcfbb04fb7a839f3f68aad1?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/7407001/thomas"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1484177586, "post_id": 41602546, "comment_id": 70407862, "body": "edited @WhozCraig"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1484189801, "post_id": 41602546, "comment_id": 70411096, "body": "You clearly did not read the link I provided. I&#39;ll try again: Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (stressing <b>complete</b>)."}], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 0, "last_activity_date": 1484187847, "creation_date": 1484187847, "answer_id": 41604126, "question_id": 41602546, "link": "https://stackoverflow.com/questions/41602546/snake-for-2-players-multithreading-doesnt-work/41604126#41604126", "title": "Snake for 2 players - multithreading doesn&#39;t work", "body": "<p>This is not a good use case for threads.</p>\n\n<p>Both of your threads are calling <code>_kbhit()</code> and <code>_getch()</code> periodically. This means they're effectively \"fighting\" over input -- when a key is pressed, whichever one manages to call <code>_getch()</code> first gets that key, and the other one gets nothing.</p>\n\n<p>Rewrite your program to run as a single loop that handles both players. You don't need threads for this.</p>\n"}], "owner": {"reputation": 1, "user_id": 7407001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5faffd924fcfbb04fb7a839f3f68aad1?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/7407001/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1484187847, "creation_date": 1484176665, "last_edit_date": 1484177427, "question_id": 41602546, "link": "https://stackoverflow.com/questions/41602546/snake-for-2-players-multithreading-doesnt-work", "title": "Snake for 2 players - multithreading doesn&#39;t work", "body": "<p>I'm trying to get into C \"deeper\" so I decided to write a game - Snake for 2 players.</p>\n\n<p>Creating a \"map\", Snake structure, putting it into the \"map\" (using COORD) is not a problem, but I knew, I would stuck somewhere, so... here it is.</p>\n\n<p>/* I created two functions called ruch() and ruch2() that both use _kbhit() and _getch() to move the s1 and s2 Snake structures (only \"head\" is already written, will take care of \"tail\" later).\nThe problem is that I want each Snake to move simultaneously in one of chosen direction (based on _getch()), so I tried to use a multithreading function from on of the guides, but it doesn't work.</p>\n\n<p>Here's the code: <a href=\"http://pastebin.com/psm6hm3p\" rel=\"nofollow noreferrer\">http://pastebin.com/psm6hm3p</a> </p>\n\n<p>Previosly, there was no function called ruch2() and it was merged with original ruch().\nAnd here is original ruch(): <a href=\"http://pastebin.com/WXpPfK8H\" rel=\"nofollow noreferrer\">http://pastebin.com/WXpPfK8H</a> - so as you can see whenever user presses the key, one of the cases starts the loop (till next _getch()) - it works, but it's bugged - only one Snake is able to move continuously, because when one moves - second waits for _getch() and vice versa. It also doesn't allow other function in main() to run. */</p>\n\n<p>function that is responsible for moving both snakes</p>\n\n<pre><code>void ruch(Snake *g){\nwhile (_kbhit()){\n    switch (_getch()){\n    case lewo:\n        if (g-&gt;y &gt; 1){\n            while (1){\n                putcharXY(g-&gt;x, g-&gt;y, 32);\n                g-&gt;y--;\n                putcharXY(g-&gt;x, g-&gt;y, 176);\n                Sleep(500);\n                if (_getch()){\n                    ruch(g);\n                }\n            }\n        }\n        break;\n    case prawo:\n        if (g-&gt;y &lt; width - 2){\n            while (1){\n                putcharXY(g-&gt;x, g-&gt;y, 32);\n                g-&gt;y++;\n                putcharXY(g-&gt;x, g-&gt;y, 176);\n                Sleep(500);\n                if (_getch()){\n                    ruch(g);\n                }\n            }\n        }\n        break;\n    case gora:\n        if (g-&gt;x &gt; 1){\n            while (1){\n                putcharXY(g-&gt;x, g-&gt;y, 32);\n                g-&gt;x--;\n                putcharXY(g-&gt;x, g-&gt;y, 176);\n                Sleep(500);\n                if (_getch()){\n                    ruch(g);\n                }\n            }\n        }\n        break;\n    case dol:\n        if (g-&gt;x &lt; height - 2){\n            while (1){\n                putcharXY(g-&gt;x, g-&gt;y, 32);\n                g-&gt;x++;\n                putcharXY(g-&gt;x, g-&gt;y, 176);\n                Sleep(500);\n                if (_getch()){\n                    ruch(g);\n                }\n            }\n        }\n        break;\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<pre><code>void ruch2(Snake *h){\nwhile (_kbhit()){\n    switch (_getch()){\n    case 'a':\n        if (h-&gt;y&gt;1){\n            while (1){\n                putcharXY(h-&gt;x, h-&gt;y, 32);\n                h-&gt;y--;\n                putcharXY(h-&gt;x, h-&gt;y, 178);\n                Sleep(500);\n                if (_getch()){\n                    ruch2(h);\n                }\n            }\n        }\n        break;\n    case 'd':\n        if (h-&gt;y&lt;width - 2){\n            while (1){\n                putcharXY(h-&gt;x, h-&gt;y, 32);\n                h-&gt;y++;\n                putcharXY(h-&gt;x, h-&gt;y, 178);\n                Sleep(500);\n                if (_getch()){\n                    ruch2(h);\n                }\n            }\n        }\n        break;\n    case 'w':\n        if (h-&gt;x&gt;1){\n            while (1){\n                putcharXY(h-&gt;x, h-&gt;y, 32);\n                h-&gt;x--;\n                putcharXY(h-&gt;x, h-&gt;y, 178);\n                Sleep(500);\n                if (_getch()){\n                    ruch2(h);\n                }\n            }\n        }\n        break;\n    case 's':\n        if (h-&gt;x&lt;height - 2){\n            while (1){\n                putcharXY(h-&gt;x, h-&gt;y, 32);\n                h-&gt;x++;\n                putcharXY(h-&gt;x, h-&gt;y, 178);\n                Sleep(500);\n                if (_getch()){\n                    ruch2(h);\n                }\n            }\n        }\n        break;\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>and</p>\n\n<p>some lines of code that are responsible for multithreading that doesn't work:</p>\n\n<pre><code>DWORD WINAPI ThreadId1, ThreadId2;\nHANDLE hHandles1, hHandles2;\nhHandles1 = CreateThread(NULL, 0, ruch(&amp;s1),\n    0, 0, &amp;ThreadId1);\nhHandles2 = CreateThread(NULL, 0, ruch2(&amp;s2),\n    0, 0, &amp;ThreadId2);\nif (hHandles1 == NULL || hHandles2 == NULL)\n{\n    printf(\"Nieudane tworzenie watkow\\n\");\n    exit(0);\n}\n//Oczekiwanie na zako\u0144czenie funkcji\nWaitForSingleObject(hHandles1, INFINITE);\nWaitForSingleObject(hHandles2, INFINITE);\n</code></pre>\n\n<p>tl;dr - Problem with multithreading</p>\n\n<p>edit: some of the function's names are polish words, so ruch = move, zryj = food, Snake japko = food structure, rysuj = draw map once and \"travel\" on it via putcharXY (COORD)</p>\n"}, {"tags": ["c", "validation", "integer", "infinite-loop"], "comments": [{"owner": {"reputation": 13948, "user_id": 283342, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e3ef6dbec3a443e7cda5b5624311ca08?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/283342/adrian"}, "edited": false, "score": 0, "creation_date": 1484176871, "post_id": 41602532, "comment_id": 70407626, "body": "I suggest reading some <a href=\"http://www.cplusplus.com/reference/cstdio/scanf/\" rel=\"nofollow noreferrer\">documentation for the function scanf</a> and then mentally simulating the execution of your code to see why it doesn&#39;t work."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1484176977, "post_id": 41602532, "comment_id": 70407661, "body": "1) Why is there a call to <code>scanf()</code> before the loop? 2) You should be checking the value returned by the call to <code>scanf()</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1484177025, "post_id": 41602532, "comment_id": 70407678, "body": "That you have two <code>scanf</code> calls is suspect. That the first of them is not passing it&#39;s variable by address invokes <i>undefined behavior</i>. I&#39;d start with those."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1484177132, "post_id": 41602532, "comment_id": 70407706, "body": "@Andrei Pak: Why are you trying to apply <code>isdigit</code> to  your <code>input</code> and what did you expect it to do? Please, explain your thinking behind this application of <code>isdigit</code>. How did you come up with the idea?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1484177486, "post_id": 41602532, "comment_id": 70407831, "body": "isdigit checks if a character is a digit, it is meaningless to apply it to an int filled out by scanf - scanf will have called isdigit while processing the input string"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1484216811, "post_id": 41602532, "comment_id": 70422760, "body": "Start by fixing the compilation warnings.  The most important (from compiling with <code>gcc -std=c11 -Wall -Wextra</code>) are <i>incompatible implicit declaration of built-in function <code>printf</code></i>, <i>incompatible implicit declaration of built-in function <code>scanf</code></i> and <i>format <code>%d</code> expects argument of type <code>int *</code>, but argument 2 has type <code>int</code></i>."}], "answers": [{"tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": false, "score": 0, "last_activity_date": 1484177162, "creation_date": 1484177162, "answer_id": 41602649, "question_id": 41602532, "link": "https://stackoverflow.com/questions/41602532/c-trying-to-validate-integer/41602649#41602649", "title": "C Trying to validate integer", "body": "<p>Your logic is wrong for two reasons:</p>\n\n<ul>\n<li>You checked <code>input</code> at the end of <code>do..while</code>, but used it previously in <code>for</code> loop.</li>\n<li>There is absolutely no need to use double <code>do..while</code> loop.</li>\n</ul>\n\n<p>There is another error with your initial <code>scanf</code> as well:</p>\n\n<pre><code>scanf(\"%d\", input);  // &lt;-- should be `&amp;input`\n</code></pre>\n\n<hr>\n\n<p>For what you need, a single <code>do..while</code> would be suffice:</p>\n\n<pre><code>    int input;\n    do{\n        int starCount;\n        printf(\"Please enter a number:\");\n        if( 1 != scanf(\"%d\",&amp;input) || input &lt; 0 )   // &lt;-- check return value of scanf and valid `input`\n        {\n            break;\n        }\n        for(starCount=0; starCount&lt;input; starCount++){\n            printf(\"*\");\n        }\n        printf(\"\\n\");       \n    }while(1);\n</code></pre>\n\n<p>Notice that you can/should use the return value of <code>scanf</code> and check if <code>input</code> is valid before the <code>for</code> loop.</p>\n"}], "owner": {"reputation": 57, "user_id": 1914620, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/92cf32b43dd07ebc6fb96a86b07686a5?s=128&d=identicon&r=PG", "display_name": "Andrei Pak", "link": "https://stackoverflow.com/users/1914620/andrei-pak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1485386190, "creation_date": 1484176594, "last_edit_date": 1485386190, "question_id": 41602532, "link": "https://stackoverflow.com/questions/41602532/c-trying-to-validate-integer", "title": "C Trying to validate integer", "body": "<p>Trying to validate integer but when wrong value type entered an infinite loop of first printf appears.</p>\n\n<pre><code>int main(int argc, char *argv[]) {\nint input;\ndo{\n    int starCount;\n    printf(\"Please enter a number:\");\n    scanf(\"%d\",input);\n    do{\n        scanf(\"%d\",&amp;input);\n    }while(isdigit(input));\n    for(starCount=0; starCount&lt;input; starCount++){\n        printf(\"*\");\n    }\n    printf(\"\\n\");       \n}while(input&gt;0);\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484175405, "post_id": 41602184, "comment_id": 70407091, "body": "<code>scanf(&quot;%c&quot;,&amp;n);</code> --&gt; <code>scanf(&quot; %c&quot;,&amp;n);</code> Clear previous newline."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484175477, "post_id": 41602184, "comment_id": 70407117, "body": "The last question I looked had this same problem: <code>scanf(&quot;%c&quot;,&amp;n);</code> \u2014 this reads the newline left behind by the <code>%d</code>.  Use <code>scanf(&quot; %c&quot;,&amp;n);</code> where the blank is all-important and skips the newline (and other white space).  Don&#39;t use a trailing blank (or other white space character, such as tab or newline) in a format, though \u2014 that&#39;s a different problem.  Yes, <code>scanf()</code> et al are very hard to use correctly."}], "owner": {"reputation": 409, "user_id": 2808264, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/49d8ad1cd9c9f7be40fcfb17e3f1e25e?s=128&d=identicon&r=PG&f=1", "display_name": "user2808264", "link": "https://stackoverflow.com/users/2808264/user2808264"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1484175536, "answer_count": 0, "score": 0, "last_activity_date": 1484175533, "creation_date": 1484175073, "question_id": 41602184, "link": "https://stackoverflow.com/questions/41602184/c-skips-user-input-from-subsequent-scanf-statement", "closed_reason": "Duplicate", "title": "C skips user input from subsequent scanf statement", "body": "<p>I have a main program that implements some functions for a stack in C. While accepting input from the user I find unusual results. Can someone point out what is a better way to accept user input in C.</p>\n\n<pre><code>int main()\n{\n    int choice;\n    int flag=1;\n    char n;\n    char string[100];\n    while(flag==1)\n    {\n        printf(\"\\nMake a selection\\n\");\n        printf(\"Enter 1 to push an element in the stack\\n\");\n        printf(\"Enter 2 to pop an element from the stack\\n\");\n        printf(\"Enter 3 to print the stack elements\\n\");\n        printf(\"Enter 4 to display the top element of the stack\\n\");\n        printf(\"Enter 5 to reverse a string using stack\\n\");\n        printf(\"Enter 6 to verify balanced brackets in an expression\\n\");\n        printf(\"Enter 9 to quit\\n\");\n        scanf(\"%d\",&amp;choice);\n        printf(\"Entered choice %d\\n\",choice);\n        switch(choice)\n        {\n            case 1:\n                printf(\"Enter an element to push into the stack --&gt;  \");\n                scanf(\"%c\",&amp;n);\n                Push(n);\n                break;\n\n            case 2:\n                top=Pop();\n                break;\n\n            case 3:\n                PrintElements();\n                break;\n\n            case 4:\n                if(top==NULL)\n                    printf(\"Stack is empty\");\n                else\n                    printf(\"\\nThe top element on the stack is --&gt; %c\",top-&gt;data);\n                break;\n\n            case 5:\n                printf(\"Enter a string\\n\");\n                fgets (string,100,stdin);\n                printf(\"\\n Original string is --&gt; %s\",string);\n                for(int i=0;i&lt;100;i++)\n                {\n                    if(string[i]=='\\0')\n                        string[i-1]='\\0';\n                }\n                StringReverse(string);\n                printf(\"Modified string is --&gt; %s\",string);\n                break;\n\n            case 6:\n                printf(\"Enter a string\\n\");\n                fgets (string,100,stdin);\n                for(int i=0;i&lt;100;i++)\n                {\n                    if(string[i]=='\\0')\n                        string[i-1]='\\0';\n                }\n                CheckParanthese(string);\n                break;\n\n            case 9:\n                flag=0;\n                break;\n\n            default:\n                printf(\"Incorrect selection\");\n                break;\n        }\n\n\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Sample Output\nHere when I enter 1 it automatically skips the next scanf statement which asks for user input for an element to push into stack</p>\n\n<pre><code>Make a selection\nEnter 1 to push an element in the stack\nEnter 2 to pop an element from the stack\nEnter 3 to print the stack elements\nEnter 4 to display the top element of the stack\nEnter 5 to reverse a string using stack\nEnter 6 to verify balanced brackets in an expression\nEnter 9 to quit\n1\nEntered choice 1\nEnter an element to push into the stack --&gt;\nMake a selection\nEnter 1 to push an element in the stack\nEnter 2 to pop an element from the stack\nEnter 3 to print the stack elements\nEnter 4 to display the top element of the stack\nEnter 5 to reverse a string using stack\nEnter 6 to verify balanced brackets in an expression\nEnter 9 to quit\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1484172673, "post_id": 41601591, "comment_id": 70406010, "body": "The function receives <code>states</code> as a parameter. Why are you assigning it with <code>malloc()</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1484172715, "post_id": 41601591, "comment_id": 70406038, "body": "<a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast the result of malloc in C</a>"}, {"owner": {"reputation": 85, "user_id": 5374021, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9be44285b536b39aa12d7b237e8eba48?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/5374021/nick"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1484173207, "post_id": 41601591, "comment_id": 70406244, "body": "Thanks folks. Easy fix. I&#39;m still somewhat mystified as to why I received the segfault where I did and got the backtrace that I did. But it now seems that the title of the posting is pretty unrelated to the problem/solution. Should I delete the question, retitle, or is there some other way to handle situations like this?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1484173400, "post_id": 41601591, "comment_id": 70406313, "body": "When you cause undefined behavior, the error can happen anywhere. You might not even get an error at all."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1484173578, "post_id": 41601591, "comment_id": 70406389, "body": "Deleting would be the more reasonable. The code is not good and it will not help others. It is the n*100th incarnation of the same fault."}, {"owner": {"reputation": 85, "user_id": 5374021, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9be44285b536b39aa12d7b237e8eba48?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/5374021/nick"}, "edited": false, "score": 0, "creation_date": 1484177102, "post_id": 41601591, "comment_id": 70407700, "body": "Hokey doke; I wasn&#39;t able to delete but I&#39;ve flagged the question."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1484172768, "creation_date": 1484172768, "answer_id": 41601646, "question_id": 41601591, "link": "https://stackoverflow.com/questions/41601591/segfault-from-usr-lib-system-libsystem-platform-dylib-flagged-for-deletion-by/41601646#41601646", "title": "Segfault from /usr/lib/system/libsystem_platform.dylib (flagged for deletion by author)", "body": "<p>The argument corresponding to <code>%c</code> in <code>scanf()</code> has to be a pointer:</p>\n\n<pre><code>  scanf(\" %c\", &amp;states[counter]);\n</code></pre>\n\n<p>You should have gotten a compiler warning about this.</p>\n\n<p>You should also put a space before <code>%c</code> so it will skip over whitespace before reading the character. Otherwise, every other <code>state</code> will contain a newline character.</p>\n\n<p>I wonder why you're allocating <code>states</code> when the function receives this as an argument. If the function is supposed to allocate the <code>states</code> array itself and return it to the caller (like it does with <code>state_count), the argument should be</code>char **states`. Then you would do:</p>\n\n<pre><code>*states = malloc(sizeof(char) * (*state_count));\n</code></pre>\n\n<p>All the other references to <code>states</code> in the function will also need to be changed to <code>*states</code>.</p>\n"}], "owner": {"reputation": 85, "user_id": 5374021, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9be44285b536b39aa12d7b237e8eba48?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/5374021/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 773, "favorite_count": 0, "accepted_answer_id": 41601646, "answer_count": 1, "score": 0, "last_activity_date": 1484177146, "creation_date": 1484172528, "last_edit_date": 1484177146, "question_id": 41601591, "link": "https://stackoverflow.com/questions/41601591/segfault-from-usr-lib-system-libsystem-platform-dylib-flagged-for-deletion-by", "title": "Segfault from /usr/lib/system/libsystem_platform.dylib (flagged for deletion by author)", "body": "<p>I'm running the following C code.</p>\n\n<pre><code>void manual_enter(int * state_count, char * states, char * alphabet, char * start_state, char * accept_states) {\n   int counter;\n\n   printf(\"Please enter the number of states in the DFA. \");\n   scanf(\"%d\", state_count);\n   states = (char *) malloc(sizeof(char) * (*state_count) );\n   printf(\"\\n!\");\n   counter = 0;\n   for(counter = 0; counter &lt; *state_count; counter++) {\n      printf(\"\\n!\");\n      printf(\"\\nPlease enter state: %d\", counter);\n      scanf(\"%c\", states[counter]);\n      printf(\"%c\", states[counter]);\n   }\n\n   return;\n\n}\n</code></pre>\n\n<p>I receive a segfault after the 2nd exclamation point but before the prompt to enter a given state number. I ran in gdb to get a backtrace and this is what I got:</p>\n\n<pre><code> (gdb) bt\n #0  0x00007fff8b313fda in ?? () from /usr/lib/system/libsystem_platform.dylib\n #1  0x00007fff5fbff360 in ?? ()\n #2  0x00007fff88db1fbb in __fread () from /usr/lib/system/libsystem_c.dylib\n Backtrace stopped: frame did not save the PC\n</code></pre>\n\n<p>I'm a programming novice, so it may well be that I'm approaching this debugging this all wrong. Any help or tips for how to approach this would be much appreciated. Thanks!</p>\n"}, {"tags": ["c", "binary-search-tree", "nodes", "free"], "comments": [{"owner": {"reputation": 4939, "user_id": 6292621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a024e1125c7f69a49d7f1a4861d7b63?s=128&d=identicon&r=PG&f=1", "display_name": "lorro", "link": "https://stackoverflow.com/users/6292621/lorro"}, "edited": false, "score": 0, "creation_date": 1484170275, "post_id": 41600992, "comment_id": 70404914, "body": "Please show a MCVE. I can&#39;t see <code>removeAndWrite()</code> and <code>NODE</code>, for instance."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484170606, "post_id": 41600992, "comment_id": 70405073, "body": "One basic requirement when deleting nodes from trees/linked lists is to remember the next pointer(s) before you do the deletions/modifications."}, {"owner": {"reputation": 51, "user_id": 5970819, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/eb267eecaf9555cd351e5c9103c08bb4?s=128&d=identicon&r=PG&f=1", "display_name": "Savo Debeljak", "link": "https://stackoverflow.com/users/5970819/savo-debeljak"}, "reply_to_user": {"reputation": 4939, "user_id": 6292621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a024e1125c7f69a49d7f1a4861d7b63?s=128&d=identicon&r=PG&f=1", "display_name": "lorro", "link": "https://stackoverflow.com/users/6292621/lorro"}, "edited": false, "score": 0, "creation_date": 1484170616, "post_id": 41600992, "comment_id": 70405082, "body": "@lorro I have uploaded the structs used above, and renamed the removeAndWrite() function, which was the previous name for the removeBelowGivenValue() function."}, {"owner": {"reputation": 51, "user_id": 5970819, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/eb267eecaf9555cd351e5c9103c08bb4?s=128&d=identicon&r=PG&f=1", "display_name": "Savo Debeljak", "link": "https://stackoverflow.com/users/5970819/savo-debeljak"}, "reply_to_user": {"reputation": 3189, "user_id": 7016303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dYmXc.jpg?s=128&g=1", "display_name": "Mikel F", "link": "https://stackoverflow.com/users/7016303/mikel-f"}, "edited": false, "score": 0, "creation_date": 1484170679, "post_id": 41600992, "comment_id": 70405119, "body": "@MikelF I know, that&#39;s why I came here seeking for help."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1484170841, "post_id": 41600992, "comment_id": 70405188, "body": "Write a function that can correctly remove either the left or right child node of a root node. Notice that you will have to reattach the children of the removed node to the tree under the root somehow. Once that function is written, then you can solve this one."}, {"owner": {"reputation": 4939, "user_id": 6292621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a024e1125c7f69a49d7f1a4861d7b63?s=128&d=identicon&r=PG&f=1", "display_name": "lorro", "link": "https://stackoverflow.com/users/6292621/lorro"}, "edited": false, "score": 1, "creation_date": 1484171401, "post_id": 41600992, "comment_id": 70405441, "body": "... and the tree that breaks it?"}, {"owner": {"reputation": 51, "user_id": 5970819, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/eb267eecaf9555cd351e5c9103c08bb4?s=128&d=identicon&r=PG&f=1", "display_name": "Savo Debeljak", "link": "https://stackoverflow.com/users/5970819/savo-debeljak"}, "edited": false, "score": 0, "creation_date": 1484172541, "post_id": 41600992, "comment_id": 70405943, "body": "@jhx The tree is sorted, but it is not balanced."}], "answers": [{"comments": [{"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1484176760, "post_id": 41601256, "comment_id": 70407581, "body": "A binary tree is a tree where each node got 2/1/0 children. It does&#39;nt have to be a binary search tree."}, {"owner": {"reputation": 3189, "user_id": 7016303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dYmXc.jpg?s=128&g=1", "display_name": "Mikel F", "link": "https://stackoverflow.com/users/7016303/mikel-f"}, "reply_to_user": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1484180358, "post_id": 41601256, "comment_id": 70408747, "body": "@TonyTannous The tree in his case is sorted, but your point is well made."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1484182957, "post_id": 41601256, "comment_id": 70409366, "body": "We actually don&#39;t know if the tree is sorted by the same criteria being used to decide deletion. For example, the tree may be binary indexed by last name."}], "tags": [], "owner": {"reputation": 3189, "user_id": 7016303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dYmXc.jpg?s=128&g=1", "display_name": "Mikel F", "link": "https://stackoverflow.com/users/7016303/mikel-f"}, "is_accepted": false, "score": 2, "last_activity_date": 1484176960, "last_edit_date": 1484176960, "creation_date": 1484171165, "answer_id": 41601256, "question_id": 41600992, "link": "https://stackoverflow.com/questions/41600992/remove-all-values-from-a-binary-tree-smaller-greater-than-a-given-value-in-c/41601256#41601256", "title": "Remove all values from a binary tree smaller/greater than a given value in C?", "body": "<p>If you have a binary search tree, all nodes to the left of the current node are of a lesser value, while all nodes to the right are greater. Equal nodes go in whichever direction you choose. For your task, you need to traverse until you find your pivot, aka the node which is greater than your value. </p>\n\n<p>For each node that you find, starting with the top, that is less than your target value, you need to:</p>\n\n<ol>\n<li>Preserve the right child node.</li>\n<li>Traverse the left tree, deleting every node.</li>\n<li>Delete the top node where you started the process.</li>\n<li>Move to the remaining right node and repeat. </li>\n</ol>\n\n<p>When you find a node that is greater than your key value, you start moving down the left side from that node, until you find a node with a lower value. At that point, you repeat the above steps until you reach a point where there are no lesser nodes left. </p>\n\n<p>If your tree is unsorted, I am not certain of how you'd approach the problem.</p>\n\n<p>Please bear in mind that your entry point will need to be <code>NODE **</code> rather than <code>NODE *</code> as you may need to delete the root node and change the pointer to a new root.</p>\n"}, {"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 1, "last_activity_date": 1484181298, "creation_date": 1484181298, "answer_id": 41603252, "question_id": 41600992, "link": "https://stackoverflow.com/questions/41600992/remove-all-values-from-a-binary-tree-smaller-greater-than-a-given-value-in-c/41603252#41603252", "title": "Remove all values from a binary tree smaller/greater than a given value in C?", "body": "<p>Here is a pretty generic method of removing a node from a tree. The method below assumes you want to preserve the <em>in order traversal</em> order, which means that all other nodes (besides the one removed) will still appear in the same relative order after the removal as they had appeared before the removal in an in order traversal of the binary tree.</p>\n\n<p>First, the function signature will take the node to be removed, and its parent as parameters. Let's establish the preconditions.</p>\n\n<pre><code>NODE *\nremoveNode (NODE *node, NODE *parent)\n{\n    NODE **from;\n    assert(parent);\n    assert(parent-&gt;left == node || parent-&gt;right == node);\n    from = (parent-&gt;left == node) ? &amp;parent-&gt;left : &amp;parent-&gt;right;\n    /*...*/\n}\n</code></pre>\n\n<p>First, the easy case is if the node has at most one child. Then, that child is adopted by the parent, and the node can be removed.</p>\n\n<pre><code>    if (node-&gt;left == NULL || node-&gt;right == NULL) {\n        *from = node-&gt;left ? node-&gt;left : node-&gt;right;\n        node-&gt;left = node-&gt;right = NULL;\n        return node; /* caller frees the node */\n    }\n</code></pre>\n\n<p>Otherwise, the node is a completely interior node that needs both its subtrees preserved. One way to accomplish this is to attach the left subtree of to the left of the right subtree. To do that, we need to find the leftmost node of the right subtree.</p>\n\n<pre><code>    NODE *leftmost = findLeftmostNode(node-&gt;right);\n    assert(leftmost-&gt;left == NULL);\n    leftmost-&gt;left = node-&gt;left;\n    *from = node-&gt;right;\n    node-&gt;left = node-&gt;right = NULL;\n    return node; /* caller frees the node */\n</code></pre>\n\n<p>And, <code>findLeftmost()</code> is fairly straightforward. It follows down the left side of the subtree until it hits the end.</p>\n\n<pre><code>NODE *\nfindLeftmostNode (NODE *node)\n{\n    assert(node);\n    while (node-&gt;left) {\n        node = node-&gt;left;\n    }\n    return node;\n}\n</code></pre>\n\n<p>Now, that the <code>removeNode()</code> logic is understood, the <code>removeBelowGivenValue()</code> can be considered. Since it was not made clear that the criterion value is related to the binary tree ordering, the general solution is to visit every node and see if some deletion criterion is met.</p>\n\n<p>To accomplish this, we implement helper functions that prunes all nodes off a tree that satisfy a condition. The helper function assumes that the parent has already been disqualified for pruning, so it is only concerned with pruning the subtrees under the parent.</p>\n\n<pre><code>typedef struct prune_node_condition {\n    bool (*test)(struct prune_node_condition *, NODE *);\n} PRUNE_NODE_COND;\n\nvoid pruneOneSide (NODE **, NODE *, PRUNE_NODE_COND *);\n\nvoid\npruneBothSides (NODE *parent, PRUNE_NODE_COND *condition)\n{\n    /* parent's removal already ruled out */\n    if (parent == NULL) return;\n\n    pruneOneSide(&amp;parent-&gt;left, parent, condition);\n    pruneOneSide(&amp;parent-&gt;right, parent, condition);\n}\n</code></pre>\n\n<p>We need a loop to perform the pruning because each removed node may actually change the node that the parent is pointing to, and that changed node needs to be tested against the condition again.</p>\n\n<pre><code>void\npruneOneSide (NODE **side, NODE *parent, PRUNE_NODE_COND *condition)\n{\n    while (*side &amp;&amp; condition-&gt;test(condition, *side)) {\n        free(removeNode(*side, parent));\n    }\n    pruneBothSides(*side, condition);\n}\n</code></pre>\n\n<p>Since node removal may affect the root itself, the wrapper to the pruning helper returns the new root. To get the new root, it creates a dummy parent to hold the root, and then prunes the single dummy side.</p>\n\n<pre><code>NODE *\nremoveNodesIf (NODE *root, PRUNE_NODE_COND *condition)\n{\n    NODE dummy;\n    dummy.left = root;\n    pruneOneSide(&amp;dummy.left, &amp;dummy, condition);\n    return dummy.left;\n}\n</code></pre>\n\n<p>Finally, we can implement the originally asked function. <code>removeBelowGivenValue</code> needs a less than check as the condition.</p>\n\n<pre><code>struct prune_with_key_condition {\n    PRUNE_NODE_COND base;\n    unsigned key;\n};\n\nbool\nremove_below_given_value_test (PRUNE_NODE_COND *base, NODE *node)\n{\n    struct prune_with_key_condition *s = (void *)base;\n    return node-&gt;data.numOfPoints &lt; s-&gt;key;\n}\n</code></pre>\n\n<p>Now, the actual function can be implemented by passing this condition to the <code>removeNodesIf()</code> function.</p>\n\n<pre><code>NODE *\nremoveBelowGivenValue(NODE** root, unsigned key)\n{\n    struct prune_with_key_condition c = {\n        { remove_below_given_value_test },\n        key\n    };\n\n    if (root == NULL || *root == NULL) {\n        return NULL;\n    }\n\n    *root = removeNodesIf(*root, &amp;c.base);\n    return *root;\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5970819, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/eb267eecaf9555cd351e5c9103c08bb4?s=128&d=identicon&r=PG&f=1", "display_name": "Savo Debeljak", "link": "https://stackoverflow.com/users/5970819/savo-debeljak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1946, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1484181298, "creation_date": 1484170092, "last_edit_date": 1484172657, "question_id": 41600992, "link": "https://stackoverflow.com/questions/41600992/remove-all-values-from-a-binary-tree-smaller-greater-than-a-given-value-in-c", "title": "Remove all values from a binary tree smaller/greater than a given value in C?", "body": "<p>Basically what I'm trying to do is remove all nodes from a binary tree that have a value lesser than the one passed through the function argument. I wrote an implementation but it doesn't seem to be working 100% correct.It does remove some nodes with a lesser value, but not all. Any input is greatly appreciated. Thanks in advance to anyone willing to help. :-)</p>\n\n<p>The code of the function is given here below : </p>\n\n<pre><code>NODE* removeBelowGivenValue(NODE** root, unsigned key)\n{\n    if (*root == NULL)\n        return *root;\n    (*root)-&gt;left = removeBelowGivenValue(&amp;(*root)-&gt;left, key);\n    (*root)-&gt;right = removeBelowGivenValue(&amp;(*root)-&gt;right, key);\n    if ((*root)-&gt;data.numOfPoints &lt; key)\n    {\n        NODE* rightChild = (*root)-&gt;right;\n        free(*root);\n        *root=NULL;\n        return rightChild;\n    }\n    return *root;\n}\n\ntypedef struct\n{\n    char index[12];\n    char firstName[21], lastName[21];\n    unsigned numOfPoints;\n}STUDENT;\n\ntypedef struct node\n{\n    STUDENT data;\n    struct node* left, *right;\n}NODE;\n</code></pre>\n"}, {"tags": ["c", "sockets", "tcp", "binding", "server"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1484169239, "post_id": 41600750, "comment_id": 70404367, "body": "Check <code>errno</code> if <code>bind()</code> fails."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1484169246, "post_id": 41600750, "comment_id": 70404370, "body": "Use <code>perror</code> instead of <code>printf</code> when checking errors.  That will print out the error string for the last failed command."}, {"owner": {"reputation": 3189, "user_id": 7016303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dYmXc.jpg?s=128&g=1", "display_name": "Mikel F", "link": "https://stackoverflow.com/users/7016303/mikel-f"}, "edited": false, "score": 2, "creation_date": 1484169256, "post_id": 41600750, "comment_id": 70404374, "body": "Something is missing from this line <code>sockfd = (AF_INET, SOCK_STREAM, 0);</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484170473, "post_id": 41600750, "comment_id": 70405008, "body": "Which would you consider &quot;bad libraries&quot;? You should include only <b>the headers</b> of the libraries you actually use."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1484175996, "post_id": 41600750, "comment_id": 70407309, "body": "Wasn&#39;t there a restriction that only <i>root</i> is allowed to bind on ports &lt; 1024? (the devil&#39;s port meets the criteria)."}], "answers": [{"tags": [], "owner": {"reputation": 3189, "user_id": 7016303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dYmXc.jpg?s=128&g=1", "display_name": "Mikel F", "link": "https://stackoverflow.com/users/7016303/mikel-f"}, "is_accepted": false, "score": 3, "last_activity_date": 1484169426, "creation_date": 1484169426, "answer_id": 41600855, "question_id": 41600750, "link": "https://stackoverflow.com/questions/41600750/programming-c-getting-error-when-binding-address-and-port-to-socket/41600855#41600855", "title": "Programming C: getting error when binding address and port to socket", "body": "<p>Try replacing:</p>\n\n<p><code>sockfd = (AF_INET, SOCK_STREAM, 0);</code></p>\n\n<p>with</p>\n\n<p><code>sockfd = socket(AF_INET, SOCK_STREAM, 0);</code></p>\n"}, {"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 11, "user_id": 7406676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a888b6d9c04f907104d91957e39139?s=128&d=identicon&r=PG&f=1", "display_name": "tr0ubl3", "link": "https://stackoverflow.com/users/7406676/tr0ubl3"}, "edited": false, "score": 0, "creation_date": 1484172994, "post_id": 41600861, "comment_id": 70406158, "body": "@tr0ubl3 Do you run the program with root privileges? Otherwise, you will have to choose a port number above 1024 to succeed."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 4, "last_activity_date": 1484169447, "creation_date": 1484169447, "answer_id": 41600861, "question_id": 41600750, "link": "https://stackoverflow.com/questions/41600750/programming-c-getting-error-when-binding-address-and-port-to-socket/41600861#41600861", "title": "Programming C: getting error when binding address and port to socket", "body": "<p>The problem is this line:</p>\n\n<pre><code> sockfd = (AF_INET, SOCK_STREAM, 0);\n</code></pre>\n\n<p>It is valid and the expression on the right side evaluates to <code>0</code> (see comma-operator in C).</p>\n\n<p>Now the call to <code>bind()</code> is placed on fd 0, which is usually a (pseudo-)terminal. This cannot succeed.</p>\n\n<p>The solution is:</p>\n\n<pre><code> sockfd = socket(AF_INET, SOCK_STREAM, 0);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7406676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a888b6d9c04f907104d91957e39139?s=128&d=identicon&r=PG&f=1", "display_name": "tr0ubl3", "link": "https://stackoverflow.com/users/7406676/tr0ubl3"}, "is_accepted": false, "score": 0, "last_activity_date": 1484207108, "creation_date": 1484207108, "answer_id": 41607642, "question_id": 41600750, "link": "https://stackoverflow.com/questions/41600750/programming-c-getting-error-when-binding-address-and-port-to-socket/41607642#41607642", "title": "Programming C: getting error when binding address and port to socket", "body": "<p>This helped me: </p>\n\n<p>Ofcourse changing the <code>sockfd = (AF_INET, SOCK_STREAM, 0);</code> to <code>sockfd = socket(AF_INET, SOCK_STREAM, 0);</code> and for some reason I had to use root privileges for a <code>port under 1024</code>. </p>\n\n<p>Can someone maybe explain why?</p>\n\n<p>Thank you for the help all :D</p>\n"}], "owner": {"reputation": 11, "user_id": 7406676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a888b6d9c04f907104d91957e39139?s=128&d=identicon&r=PG&f=1", "display_name": "tr0ubl3", "link": "https://stackoverflow.com/users/7406676/tr0ubl3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "accepted_answer_id": 41600861, "answer_count": 3, "score": 0, "last_activity_date": 1484207108, "creation_date": 1484169053, "last_edit_date": 1484175797, "question_id": 41600750, "link": "https://stackoverflow.com/questions/41600750/programming-c-getting-error-when-binding-address-and-port-to-socket", "title": "Programming C: getting error when binding address and port to socket", "body": "<p>I really don't know what I did wrong. I included all the good libraries. And tested it on my VPS and local Ubuntu installation. Also I looked up other code for the same program that do work. But I keep getting the \"ERROR: could not bind internet address to the socket method\" message.\nHere is my TCP server in C code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;strings.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;stdlib.h&gt;\n\n//Enter The Port and the Ip Address here.\n\n#define PORT 666\n#define ADRESS 0\n\n//Enter the amount of Maximum Poeple entering the server.\n#define NUMBER_OF_CONNECTIONS 8\n\nint main(){\n    int sockfd, newsockfd, portno = 666, clilen;\n    char message[1024];\n    struct sockaddr_in serv_addr, cli_addr;\n    int n;\n\n    sockfd = (AF_INET, SOCK_STREAM, 0);\n\n    if (sockfd &lt; 0){\n        printf(\"ERROR: could not create server-socket.\\n\");\n        exit(1);\n    }\n\n    bzero((char *) &amp;serv_addr, sizeof(serv_addr));\n\n    // Declaring the port.\n    //portno = 666;\n    // Declaring the type of connection. (internet connection)\n    serv_addr.sin_family =  AF_INET;\n    // Declaring the IP.\n    serv_addr.sin_addr.s_addr = INADDR_ANY;\n    // Declaring the Port.\n    serv_addr.sin_port = htons(portno);\n\n    // Binding the Socket?\n    if (bind(sockfd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr)) &lt; 0){\n        printf(\"ERROR: could not bind internet address to the socket method.\\n\");\n        exit(1);\n    }\n\n    // Entering \"Listen Mode\".\n    listen(sockfd, NUMBER_OF_CONNECTIONS);\n    clilen = sizeof(cli_addr);\n\n    // Creating a New Socket for the client.\n    newsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr, &amp;clilen);\n\n    if (newsockfd &lt; 0){\n        printf(\"ERROR: could not accept connection.\\n\");\n        exit(1);\n    }\n\n    //Clearing the message-buffer.\n    bzero(message,1024);\n\n    // Reading the message.\n    n = read(newsockfd,message,1023);\n\n    if (n &lt; 0){\n        printf(\"ERROR: could not read message.\\n\");\n    }\n\n    printf(\"Message: %s\\n\",message);\n\n    n = write(newsockfd, \"I got your message.\", 18);\n\n    if (n &lt; 0)\n    {\n        printf(\"ERROR: sending to client.\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "function", "multidimensional-array"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484169563, "post_id": 41600749, "comment_id": 70404550, "body": "In the usual sense of <code>array[N][M]</code>, and where the meaning of <code>y</code> is usually row and <code>x</code> is column, you seem to be comparing the indexing limits with the wrong dimension. I would expect <code>y</code> to be associated with <code>N</code>, and <code>x</code> with <code>M</code>."}, {"owner": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484169733, "post_id": 41600749, "comment_id": 70404626, "body": "I can flip the names then y would be representing rows and x columns. that&#39;s no problem. I&#39;ll update my code."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484169990, "post_id": 41600749, "comment_id": 70404772, "body": "It is a problem in the future if the matrix is not square."}, {"owner": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484170135, "post_id": 41600749, "comment_id": 70404856, "body": "I&#39;m more used to think of xs as rows. I changed the code if it&#39;s easier to understand."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484170415, "post_id": 41600749, "comment_id": 70404975, "body": "Start with <code>int minval = mat[0][0];</code> and where <code>&#47;*CONDITION TO TAKE MINIMUM*&#47;</code> you can have <code>if(minval &gt; mat[y+j][x+i]) { minval = mat[y+j][x+i];}</code>"}, {"owner": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484170840, "post_id": 41600749, "comment_id": 70405186, "body": "First off thanks for the help. Second, you init minval to mat[0][0] according to my specific example? In general you mean minval=mat[x][y]?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484171086, "post_id": 41600749, "comment_id": 70405295, "body": "Oh, yes sorry that&#39;s right."}, {"owner": {"reputation": 3252, "user_id": 6131611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3789df5ff075b7a2bfa71c8e2dccd18d?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/6131611/pavel"}, "edited": false, "score": 0, "creation_date": 1484171102, "post_id": 41600749, "comment_id": 70405302, "body": "You can init <code>minval</code> with some value that is bigger than all elements, like 1000000"}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1484171137, "post_id": 41600749, "comment_id": 70405319, "body": "you probably want to init minval to <code>INT_MAX</code>  found in  <code>limits.h</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 3252, "user_id": 6131611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3789df5ff075b7a2bfa71c8e2dccd18d?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/6131611/pavel"}, "edited": false, "score": 0, "creation_date": 1484171162, "post_id": 41600749, "comment_id": 70405328, "body": "@Pavel only worth it with <code>minval = INT_MAX;</code> but using an actual element value is more maintainable."}, {"owner": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "edited": false, "score": 0, "creation_date": 1484171219, "post_id": 41600749, "comment_id": 70405351, "body": "By my example, this wouldn&#39;t work because the cell will stay 1 (I want to changed to the minimum value of the cells surrounding it horizontally, vertically and diagonally. Hence it changes to 9)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484171289, "post_id": 41600749, "comment_id": 70405391, "body": "Then use <code>minval = INT_MAX;</code>. Sorry, didn;t read the code fragment properly."}, {"owner": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "edited": false, "score": 0, "creation_date": 1484171350, "post_id": 41600749, "comment_id": 70405423, "body": "No idea what that is to be honest. I suppose it&#39;s another library. I can&#39;t use other than stdio.h"}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1484171592, "post_id": 41600749, "comment_id": 70405534, "body": "<code>INT_MAX</code> is in <code>limits.h</code> but if you are not allowed, just use the largest number you will ever get in the array."}, {"owner": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "edited": false, "score": 0, "creation_date": 1484171595, "post_id": 41600749, "comment_id": 70405537, "body": "I&#39;m a little confused. How would what you suggested change the value of mat[y][x]?"}, {"owner": {"reputation": 3252, "user_id": 6131611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3789df5ff075b7a2bfa71c8e2dccd18d?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/6131611/pavel"}, "edited": false, "score": 0, "creation_date": 1484171807, "post_id": 41600749, "comment_id": 70405636, "body": "Do you want to consider the <code>[y][x]</code> cell?"}, {"owner": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "edited": false, "score": 0, "creation_date": 1484171903, "post_id": 41600749, "comment_id": 70405684, "body": "the [y][x] cell is what I want to change to the minimum of the neighboring cells. In the example the [y][x] cell is is the [0][0] cell and I want to change its value from 1 (mat[0][0]=1) to 9 (mat[0][0]=9 since it&#39;s the minimum cell value of [0][0]&#39;s closest neighbors"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "edited": false, "score": 0, "creation_date": 1484171800, "post_id": 41601340, "comment_id": 70405632, "body": "A couple of questions: why not use if(x+i != 0 &amp;&amp; y+j != 0)? This condition guarantees that I&#39;m looking at a neighbor and not the cell itself. Also, I&#39;m not allowed to work with other libraries. And how would this all change the value of mat[y][x]? I don&#39;t see it anywhere."}, {"owner": {"reputation": 3252, "user_id": 6131611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3789df5ff075b7a2bfa71c8e2dccd18d?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/6131611/pavel"}, "reply_to_user": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "edited": false, "score": 0, "creation_date": 1484172107, "post_id": 41601340, "comment_id": 70405762, "body": "You doesn&#39;t want to look at the cell itself? I edited answer (2nd item)"}, {"owner": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "edited": false, "score": 0, "creation_date": 1484172223, "post_id": 41601340, "comment_id": 70405810, "body": "No. Check out the example above I edited it to what I have before and what I want after. I hope that would make what I&#39;m saying clear."}, {"owner": {"reputation": 3252, "user_id": 6131611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3789df5ff075b7a2bfa71c8e2dccd18d?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/6131611/pavel"}, "reply_to_user": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "edited": false, "score": 0, "creation_date": 1484172339, "post_id": 41601340, "comment_id": 70405863, "body": "In the example I saw that you doesn&#39;t want to consider the <code>[y][x]</code> cell while finding minimum. In 2nd item at my answer I wrote how to do it"}, {"owner": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "edited": false, "score": 0, "creation_date": 1484172428, "post_id": 41601340, "comment_id": 70405906, "body": "I want the minimum of the closet cells around [y][x] and then that minimum to store in mat[y][x]"}], "tags": [], "owner": {"reputation": 3252, "user_id": 6131611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3789df5ff075b7a2bfa71c8e2dccd18d?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/6131611/pavel"}, "is_accepted": true, "score": 0, "last_activity_date": 1484174033, "last_edit_date": 1484174033, "creation_date": 1484171463, "answer_id": 41601340, "question_id": 41600749, "link": "https://stackoverflow.com/questions/41600749/taking-minimum-value-of-neighboring-cells/41601340#41601340", "title": "Taking minimum value of neighboring cells", "body": "<p>1) <code>matr[N][M]</code> it doesn't have elements like <code>matr[?][M]</code> and <code>matr[N][?]</code> because numeration is from <code>0</code> to <code>N-1</code> (or <code>M-1</code>). So you should change condition <code>y+i&lt;=N</code> to <code>y+i&lt;N</code> and <code>x+j&lt;=M</code> to <code>x+j&lt;M</code>.</p>\n\n<p>2) To check that you aren't looking at the cell <code>[y][x]</code> itself you should check <code>if(!(i == 0 &amp;&amp; j == 0))</code> or, equivalent, <code>if(i != 0 || j != 0)</code> instead of <code>if(x+i != 0 &amp;&amp; y+j != 0)</code></p>\n\n<p>3) To find minimum first make <code>int min = INT_MAX;</code> at beginning of the function. The <em>condition to take minimum</em> will be</p>\n\n<pre><code>if (mat[y+i][x+j] &lt; min)\n    min = mat[y+i][x+j];\n</code></pre>\n\n<p>4) To write the minimum to the cell <code>[y][x]</code>, use <code>matr[y][x] = Min(matr, y, x);</code> in main function or where you want</p>\n\n<hr>\n\n<p>Alternatively you can walk through all possible cells <code>[i][j]</code> such a way:</p>\n\n<pre><code>int u = max(0, y - 1), d = min(y + 1, N - 1);\nint l = max(0, x - 1), r = min(x + 1, M - 1);\nfor (i = d; i &lt;= u; i++)\n    for (j = l; j &lt;= r; j++)\n        if (i != y || j != x)\n            if (mat[i][j] &lt; min)\n                min = mat[i][j];\nreturn min;\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7322932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd8a0346c39f195ee9759fddc9af0d0?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7322932/flyguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 41601340, "answer_count": 1, "score": -2, "last_activity_date": 1484174033, "creation_date": 1484169053, "last_edit_date": 1484172142, "question_id": 41600749, "link": "https://stackoverflow.com/questions/41600749/taking-minimum-value-of-neighboring-cells", "title": "Taking minimum value of neighboring cells", "body": "<p>I'm trying to write a function that takes receives some matrix[N][M] (N and M are defined at the beginning and they're both always 3), two integers and returns the smallest value of neighboring cells (horizontally, vertically and diagonally) to that specific (y,x) cell  (The function is part of a larger code that takes specific (y,x)s and not any (y,x). it is called in some specific cases) in a 2D array - Minimum(int mat[N][M], int y, int x).</p>\n\n<p>Say for example I have the 2D array and I'm looking specifically at the 0,0 element</p>\n\n<p>1  10  9</p>\n\n<p>18  9  10</p>\n\n<p>19 10 8</p>\n\n<p>I want that cell to change to 9 since its the smallest value of the neighboring cells (the cell itself doesn't matter if it's the minimum of them all or not) so the array becomes</p>\n\n<p>9  10  9</p>\n\n<p>18  9  10</p>\n\n<p>19 10 8</p>\n\n<p>What I tried: First I went over each neighboring cell. After that, I mainly tried storing the value of that neighboring cell in some other variable</p>\n\n<pre><code>tmp=mat[y+i][x+j]\n</code></pre>\n\n<p>that changes in every iteration and then add some if condition after it which takes the minimum value to the <code>mat[y][x]=mat[y+i][x+j]</code> cell. I tried a lot of conditions and none worked.</p>\n\n<p>Another thing I thought of and tried implementing was adding a 1D array that stores the values of the all the neighboring cells (if there are less than the size of the array - store 0) and then checking the minimum between every two cells excluding the 0s. The code got scrambled and I got lost on where I would put the loop for that array.</p>\n\n<p>I went over the neighboring cells of some specific y,x cell in the following way:</p>\n\n<pre><code>Min(int mat[N][M], int y, int x)\n{\n    for(i=-1;i&lt;=1;i++)\n    {\n        if((y+i&gt;=0) &amp;&amp; (y+i&lt;=N))\n        {\n            for(j=-1;j&lt;=1;j++)\n            {\n                if((x+j&gt;=0) &amp;&amp; (x+j&lt;=M))\n                {\n                    if((x+i != 0) &amp;&amp; (y+j != 0))\n                    {\n                        /*CONDITION TO TAKE MINIMUM*/    \n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Any help would be very much appreciated.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 3, "creation_date": 1484167752, "post_id": 41600400, "comment_id": 70403610, "body": "<code>*(&amp;a \u2013 i)</code> is a terrible idea, given the code."}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 8, "creation_date": 1484167758, "post_id": 41600400, "comment_id": 70403615, "body": "That is not multiplication, that is dereferencing a pointer."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1484167773, "post_id": 41600400, "comment_id": 70403627, "body": "There is no multiplication, that&#39;s the unary prefix pointer dereferencing operator. You need to study C basics."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1484167799, "post_id": 41600400, "comment_id": 70403643, "body": "A recipe for asssuming that undefined behaviour can somehow be quantified."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1484167814, "post_id": 41600400, "comment_id": 70403655, "body": "There&#39;s no multiplication here. It&#39;s a poor example that omits the brackets around the body of the for-loop. The <code>*</code> is for dealing with pointers."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1484168114, "post_id": 41600400, "comment_id": 70403790, "body": "I would totally draw some noses and some demons."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484168171, "post_id": 41600400, "comment_id": 70403810, "body": "This will be edxplained in every C book. You just should not skip chapters. And that code invokes undefined behaviour."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1484168525, "post_id": 41600400, "comment_id": 70403964, "body": "With <code>i</code> other than 0, <code>*(&amp;a \u2013 i)</code> is undefined behavior (UB)."}, {"owner": {"reputation": 9353, "user_id": 1887101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6840488291a0b81df1e6fd0f91f7929?s=128&d=identicon&r=PG&f=1", "display_name": "Adjit", "link": "https://stackoverflow.com/users/1887101/adjit"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484168575, "post_id": 41600400, "comment_id": 70403994, "body": "@chux why is that undefined behavior?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484169089, "post_id": 41600400, "comment_id": 70404287, "body": "C11dr &#167;6.5.6 8 details the addition of a pointer and an integer. &quot;When an expression that has integer type is added to or subtracted from a pointer, ... &quot;  <code>*(&amp;a \u2013 i)</code> meets none of the defined criteria, so the behavior is undefined  (UB)."}], "answers": [{"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484168909, "post_id": 41600457, "comment_id": 70404192, "body": "Well, it is undefined behavior <i>in all circumstances</i>. Of course behavior covered under this term includes overwriting values that happen to reside at the computed addresses. But compilers are free to simply ignore all code after that expression, etc., and have done so for example when strict aliasing was violated (and the programmer&#39;s intention was much clearer)."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484168955, "post_id": 41600457, "comment_id": 70404216, "body": "@PeterA.Schneider Very true, I&#39;m just answering the case of the senseless exam question."}], "tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": false, "score": 3, "last_activity_date": 1484169088, "last_edit_date": 1484169088, "creation_date": 1484167839, "answer_id": 41600457, "question_id": 41600400, "link": "https://stackoverflow.com/questions/41600400/meaning-of-a-i-in-a-for-loop-is-that-multiplication/41600457#41600457", "title": "Meaning of *(&amp;a \u2013 i) in a for loop. Is that multiplication?", "body": "<p>That's not multiplication, that's dereferencing a pointer. However, <code>*(&amp;a \u2013 i)</code> is already undefined behaviour the moment <code>i &gt; 0</code>. In your particular question however where there are unicorns and UB is a thing of the past and where you have to assume variable allocations are done in the reverse order they're declared and there is no padding whatsoever this would overwrite the variables <code>b</code> and <code>ai</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484181048, "post_id": 41601322, "comment_id": 70408918, "body": "Certainly <code>59 | 0x02  | &#47;&#47; int ai[] = { 1, 2 }; </code> is amiss.  I&#39;d expect <code>59 | 0x01 ...</code> Comment <code>&#47;&#47; int ai[] = { 0x02007a7a, 0x7a7a7a7a };</code> looks wrong, inconsistent  endian.  Suggest &quot;assuming integers are LSB&quot; --&gt; &quot;assuming integers are little endian&quot;"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484209111, "post_id": 41601322, "comment_id": 70417918, "body": "@chux is right: While the question defines that stack allocation proceeds towards smaller addresses, resulting on the defined entities residing in in memory in the reverse order of declaration, <i>arrays are compound but single objects</i> whose members are arranged in the order specified by the standard. Specifically, the address of array elements can <i>always</i> be computed by <i>adding</i> the index to the address of the first element, which numerically equals the array&#39;s address. Therefore, the <i>first</i> element (not the second) of <code>ai</code> has the 0x02 byte in it somewhere. Btw, very lucid answer otherwise."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484209589, "post_id": 41601322, "comment_id": 70418145, "body": "To elaborate, I think the memory layout you gave in the first table for the array // int ai[] = { 1, 2 };` is reversed: it must be <i>0x01</i> at address 59 for <code>ai[0]</code>, and 0x02 at address 63 for <code>ai[1]</code>. In the second table, consequently the comment is wrong: it must be <code>&#47;&#47; int ai[] = { 0x7a7a0002 , 0x7a7a7a7a};</code> because <code>ai[0]</code> resides at the lower address,  independent of endianness. Here that address is 59 with the (endianness dependent) contents 0x02,"}], "tags": [], "owner": {"reputation": 14988, "user_id": 881441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ktk8b.jpg?s=128&g=1", "display_name": "Stephen Quan", "link": "https://stackoverflow.com/users/881441/stephen-quan"}, "is_accepted": true, "score": 3, "last_activity_date": 1484626018, "last_edit_date": 1484626018, "creation_date": 1484171377, "answer_id": 41601322, "question_id": 41600400, "link": "https://stackoverflow.com/questions/41600400/meaning-of-a-i-in-a-for-loop-is-that-multiplication/41601322#41601322", "title": "Meaning of *(&amp;a \u2013 i) in a for loop. Is that multiplication?", "body": "<p>I think we can assume that this is a theoretical question, which, given additional assumptions not defined within the question (i.e. byte order, padding) - the question is answerable. But, as @chux pointed, there are standards against such behavior. For, if it were allowed, the code yields to  corruption of stack memory. As an exam question, it is actually asking you to diagram which memory is being corrupted.</p>\n\n<p>If I interpret the question correctly, one possible representation of the memory (assuming integers are LSB, there is 1 byte padding, and reverse order for declarations):</p>\n\n<p><code>\n| Addr | Value | Desc                           |\n| ---- | ----- | ------------------------------ |\n|   55 | 0x00  | // int i = 0;                  |\n|   56 | 0x00  |                                |\n|   57 | 0x00  |                                |\n|   58 | 0x00  |                                |\n|   59 | 0x01  | // int ai[] = { 1, 2 };        |\n|   60 | 0x00  |                                |\n|   61 | 0x00  |                                |\n|   62 | 0x00  |                                |\n|   63 | 0x02  |                                |\n|   64 | 0x00  |                                |\n|   65 | 0x00  |                                |\n|   66 | 0x00  |                                |\n|   67 | 0x62  |  // char b = 'b';              |\n|   68 | 0x61  |  // char a = 'a';              |\n</code></p>\n\n<p>The loop, unrolled, evaluates to:</p>\n\n<p><code>\n[68] = 0x7a; // 'z';\n[67] = 0x7a; // 'z';\n[66] = 0x7a; // 'z';\n[65] = 0x7a; // 'z';\n[64] = 0x7a; // 'z';\n[63] = 0x7a; // 'z';\n[62] = 0x7a; // 'z';\n[61] = 0x7a; // 'z';\n</code></p>\n\n<p>So memories represent by variables, a, b and parts of the ai[] array will be corrupted. (Incorporated @chux observation about endianess. Also, I adjusted the order in which elements of the ai[] appears as per @chux and @Peter A. Schneider comments.)</p>\n\n<p><code>\n| Addr | Value | Desc                                      |\n| ---- | ----- | ----------------------------------------- |\n|   55 | 0x08  | // int i = 8;                             |\n|   56 | 0x00  |                                           |\n|   57 | 0x00  |                                           |\n|   58 | 0x00  |                                           |\n|   59 | 0x01  | // int ai[] = { 0x7a7a0001, 0x7a7a7a7a }; |\n|   60 | 0x00  |                                           |\n|   61 | 0x7a  |                                           |\n|   62 | 0x7a  |                                           |\n|   63 | 0x7a  |                                           |\n|   64 | 0x7a  |                                           |\n|   65 | 0x7a  |                                           |\n|   66 | 0x7a  |                                           |\n|   67 | 0x7a  | // char b = 'z';                          |\n|   68 | 0x7a  | // char a = 'z';                          |\n</code></p>\n"}], "owner": {"reputation": 131, "user_id": 5915476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534f77120afefa686894ee7e3311dc77?s=128&d=identicon&r=PG&f=1", "display_name": "Ne7WoRK", "link": "https://stackoverflow.com/users/5915476/ne7work"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 41601322, "answer_count": 2, "score": -2, "last_activity_date": 1484626018, "creation_date": 1484167622, "last_edit_date": 1592644375, "question_id": 41600400, "link": "https://stackoverflow.com/questions/41600400/meaning-of-a-i-in-a-for-loop-is-that-multiplication", "title": "Meaning of *(&amp;a \u2013 i) in a for loop. Is that multiplication?", "body": "<p>I am preparing for an upcoming exam when I came across this:</p>\n<blockquote>\n<pre><code>char a = 'a';\nchar b = 'b';\nint ai[] = { 1, 2 };\nint i = 0;\n</code></pre>\n<p>Assume that word size is 32 bits, that an int is 32 bits and that memory allocations are made in the reverse order to the declarations starting at address location 68.</p>\n<p>Draw a diagram that shows the effect of executing the following lines of code.</p>\n<pre><code>for (i = 0; i &lt; 8; i++)\n    *(&amp;a \u2013 i) = 'z';\n</code></pre>\n</blockquote>\n<p>It might sound weird, but I am a newbie to C and it is the first time I've seen multiplication of a for loop. Explanation to this for loop and the multiplication applied to it would be appreciated.</p>\n"}, {"tags": ["c", "pointers", "gdb", "memory-address", "dereference"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1484167476, "post_id": 41600318, "comment_id": 70403472, "body": "Firstly, there&#39;s no <code>*x</code> in the snippet you posted. Secondly, <code>*x = 5</code> does not set <code>x</code> to <code>5</code>, it sets <code>*x</code> to <code>5</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484168074, "post_id": 41600318, "comment_id": 70403770, "body": "That&#39;s normal C syntax. About the details, you should consult your C book."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 6674630, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/66c9d3405b429b8c7abf38ac0507a267?s=128&d=identicon&r=PG&f=1", "display_name": "TigerCode", "link": "https://stackoverflow.com/users/6674630/tigercode"}, "edited": false, "score": 0, "creation_date": 1484168028, "post_id": 41600348, "comment_id": 70403748, "body": "so if it was x+1 then 1*sizeof(*x) would result in just the base address for x.   Thank you!"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 143, "user_id": 6674630, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/66c9d3405b429b8c7abf38ac0507a267?s=128&d=identicon&r=PG&f=1", "display_name": "TigerCode", "link": "https://stackoverflow.com/users/6674630/tigercode"}, "edited": false, "score": 0, "creation_date": 1484168101, "post_id": 41600348, "comment_id": 70403781, "body": "@TigerCode Actually <code>0*sizeof(*x)</code>, when added to <code>x</code>, gives you the base address."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1484167402, "creation_date": 1484167402, "answer_id": 41600348, "question_id": 41600318, "link": "https://stackoverflow.com/questions/41600318/in-gdb-what-does-xvalue-value-do/41600348#41600348", "title": "In GDB, what does *(x+value) = value do?", "body": "<p><code>x + 5</code> adds <code>5*sizeof(*x)</code> to the value of <code>x</code> and dereferences that location.</p>\n\n<p><code>*(x + 5)</code> is exactly equivalent to <code>x[5]</code>.</p>\n"}], "owner": {"reputation": 143, "user_id": 6674630, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/66c9d3405b429b8c7abf38ac0507a267?s=128&d=identicon&r=PG&f=1", "display_name": "TigerCode", "link": "https://stackoverflow.com/users/6674630/tigercode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1484167541, "creation_date": 1484167290, "last_edit_date": 1484167541, "question_id": 41600318, "link": "https://stackoverflow.com/questions/41600318/in-gdb-what-does-xvalue-value-do", "title": "In GDB, what does *(x+value) = value do?", "body": "<p>I understand that </p>\n\n<p><code>*</code> = dereference</p>\n\n<p><code>*x</code> = dereferencing <code>x</code> to grab the value in <code>x</code> if <code>x</code> is a pointer. </p>\n\n<p><code>*x = 5</code> , set <code>x</code> = 5 if <code>x</code> is a pointer and a variable <code>x</code> exists.</p>\n\n<p>What  does the +value portion do here?</p>\n\n<pre><code>Ie. \n\nx = 5 \n\n*ptr;\n\nptr = &amp;x\n\n*ptr gives us 5.\n</code></pre>\n"}, {"tags": ["java", "c", "sockets"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1484169095, "post_id": 41600206, "comment_id": 70404290, "body": "You don&#39;t check how many bytes was returned by <code>recv</code>. You assume you can send <code>MAXBUF</code> of <code>buffer</code>. client code implies it is only reading one line."}, {"owner": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "edited": false, "score": 0, "creation_date": 1484169151, "post_id": 41600206, "comment_id": 70404324, "body": "I think that <code>accpet</code> call should go inside the while loop. I&#39;ve been playing around with sockets recently, take a look at my <a href=\"https://gist.github.com/Jacajack/82c5904d9cce10fdd574e5ff77a2214e#file-sock-c\" rel=\"nofollow noreferrer\">messy gist here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4893, "user_id": 1925997, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nfivT.jpg?s=128&g=1", "display_name": "Kishore Bandi", "link": "https://stackoverflow.com/users/1925997/kishore-bandi"}, "edited": false, "score": 1, "creation_date": 1484177997, "post_id": 41600950, "comment_id": 70407989, "body": "I don&#39;t think this will help. If you look at the java code, the client is not trying to connect second time in order to send second message. He just connected once and is sending multiple messages. Changing the accept to while loop will result in<code>java.net.SocketTimeoutException: Read timed out</code> in java side because no new client is connecting to CPP Server, so he is stuck at <code>accept</code> function and nor is he responding to existing client."}], "tags": [], "owner": {"reputation": 1044, "user_id": 6451874, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fcba324f29f2095a65d59ba83dd4bdd?s=128&d=identicon&r=PG&f=1", "display_name": "Ofer Arial", "link": "https://stackoverflow.com/users/6451874/ofer-arial"}, "is_accepted": false, "score": 1, "last_activity_date": 1484172044, "last_edit_date": 1484172044, "creation_date": 1484169895, "answer_id": 41600950, "question_id": 41600206, "link": "https://stackoverflow.com/questions/41600206/c-server-returns-only-first-message/41600950#41600950", "title": "C server returns only first message", "body": "<p>I'm not sure that this will solve your problem, but I think that your <code>accept</code> function call should go in the <code>while</code> loop, as I saw that Jacajack just commented.</p>\n\n<p>This way, the loop will accure each time you will recieve a connection. It should look like this:</p>\n\n<p><strong>Example</strong>:</p>\n\n<pre><code>/* Do what's in the loop every time that you accept a connection */\n\nwhile (clientfd = accept(sockfd, (struct sockaddr*)&amp;client_addr, &amp;addrlen))\n{\n    memset(buffer, 0, MAXBUF);\n    /*---accept a connection (creating a data pipe)---*/\n    printf(\"%s:%d connected\\n\", inet_ntoa(client_addr.sin_addr), ntohs(client_addr.sin_port));\n\n    int iResult = recv(clientfd, buffer, MAXBUF, 0); \n    // iResult is the amount of data from recv\n\n    // Handle information and echo it back \n\n\n}\n</code></pre>\n\n<p>Additionally, I think you should implement some kind of protocol that will <strong>validate the message that the server got</strong> (see that it really does ends with a end of line or any other validitation that you would like to specify).</p>\n"}, {"comments": [{"owner": {"reputation": 4893, "user_id": 1925997, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nfivT.jpg?s=128&g=1", "display_name": "Kishore Bandi", "link": "https://stackoverflow.com/users/1925997/kishore-bandi"}, "reply_to_user": {"reputation": 8001, "user_id": 307297, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/e28FD.png?s=128&g=1", "display_name": "chris01", "link": "https://stackoverflow.com/users/307297/chris01"}, "edited": false, "score": 0, "creation_date": 1484177889, "post_id": 41601905, "comment_id": 70407956, "body": "@chris01 I tried this code with the given change. It worked. I tried the <code>accept</code> function in loop as well, but it didn&#39;t work. because the previous client was never disconnected. Writing accept in the loop resulted in <code>java.net.SocketTimeoutException: Read timed out</code> in java side and CPP server logs is stuck at <code>accept</code> because no new client is connecting and nor is he responding to existing client."}, {"owner": {"reputation": 55, "user_id": 5025869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204849158970741/picture?type=large", "display_name": "Daniel Holub&#225;\u0159", "link": "https://stackoverflow.com/users/5025869/daniel-holub%c3%a1%c5%99"}, "edited": false, "score": 0, "creation_date": 1484214663, "post_id": 41601905, "comment_id": 70421300, "body": "So, this solution above is working. I am very glad, it drove me crazy. And Second. The accept is outside because I want that one client that connects to comunicate endlessly with server, so why should I have accept in the loop? It will be waste of connections."}, {"owner": {"reputation": 4893, "user_id": 1925997, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nfivT.jpg?s=128&g=1", "display_name": "Kishore Bandi", "link": "https://stackoverflow.com/users/1925997/kishore-bandi"}, "edited": false, "score": 0, "creation_date": 1484808605, "post_id": 41601905, "comment_id": 70664612, "body": "Yes, <code>accept</code> should not be in the while loop. That was the point I was making for chris01&#39;s answer. Writing it inside means your client also needs to create so many connections which is not needed for your scenario."}], "tags": [], "owner": {"reputation": 4893, "user_id": 1925997, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nfivT.jpg?s=128&g=1", "display_name": "Kishore Bandi", "link": "https://stackoverflow.com/users/1925997/kishore-bandi"}, "is_accepted": true, "score": 3, "last_activity_date": 1484174563, "last_edit_date": 1495539947, "creation_date": 1484173794, "answer_id": 41601905, "question_id": 41600206, "link": "https://stackoverflow.com/questions/41600206/c-server-returns-only-first-message/41601905#41601905", "title": "C server returns only first message", "body": "<p>Well, here goes the <strong>root cause</strong>. (Skip to fix if you don't want the details)</p>\n\n<ol>\n<li>When you were sending data back to Java Client, you were sending the length of the data as MAXBUF (1024) in your case.</li>\n<li><p>Now, What apparently happened is java received 1024 characters as the input. You can see this in your (C-language) Server output. <code>sent: 1024</code><br/>\nTo fill for this remaining characters, <strong>it sends the ASCII value 0</strong> (which is NUL) <br/>\nYou can verify this by removing your readLine() API in your java code and adding this.</p>\n\n<pre><code>    StringBuilder strb = new StringBuilder();\n    while ((value = inputStream.read()) != -1) {\n        if(value != 0)\n            strb.append((char) value);\n        System.out.print(value + \":\" + (char) value+\",\");\n    }\n    return strb.toString();\n</code></pre></li>\n<li><p>The first time request comes from server back to client with user-entered-data followed by remaining nulls, the following happens</p>\n\n<ul>\n<li>Since readLine() API was used. It reads till <code>\\n</code> or <code>\\r</code> character. So you're able to see the output.</li>\n<li>At this point bufferedReader still has those NUL characters stored in its buffer.</li>\n<li><p>Now when second time we try to read from this reader, it first tries to empty the old buffer until (No <code>\\n</code> or <code>\\r</code> was found, except all NULs). It appends all these to the StringBuilder (which it internally uses) followed by which it appends the newly read string to the builder.<br/>\n<strong>If This NUL character occurs, then all characters appended to the StringBuilder disappears in its buffer</strong>. (<a href=\"https://stackoverflow.com/q/17449887/1925997\">Explanation given here</a>) You can try this with this code:</p>\n\n<pre><code>StringBuilder str = new StringBuilder().append((char)0).append(\"kishore\");\nSystem.out.println(str.toString()); // Output : Blank\n</code></pre></li>\n<li><p>That's the reason you were not able to see the output. So you client and server communication had no issue.</p></li>\n</ul></li>\n<li><p><strong>Fix:</strong> Change your \"C\" Server code to send the proper length.</p>\n\n<pre><code>    int bytes = recv(clientfd, buffer, MAXBUF, 0);\n    ...\n    int n = send(clientfd, buffer, bytes, 0);\n</code></pre></li>\n</ol>\n\n<p>With this it should work.</p>\n"}, {"comments": [{"owner": {"reputation": 4893, "user_id": 1925997, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nfivT.jpg?s=128&g=1", "display_name": "Kishore Bandi", "link": "https://stackoverflow.com/users/1925997/kishore-bandi"}, "edited": false, "score": 0, "creation_date": 1484178009, "post_id": 41602155, "comment_id": 70408001, "body": "I don&#39;t think this will help. If you look at the java code, the client is not trying to connect second time in order to send second message. He just connected once and is sending multiple messages. Changing the accept to while loop will result in<code>java.net.SocketTimeoutException: Read timed out</code> in java side because no new client is connecting to CPP Server, so he is stuck at <code>accept</code> function and nor is he responding to existing client."}, {"owner": {"reputation": 4893, "user_id": 1925997, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nfivT.jpg?s=128&g=1", "display_name": "Kishore Bandi", "link": "https://stackoverflow.com/users/1925997/kishore-bandi"}, "edited": false, "score": 0, "creation_date": 1484178223, "post_id": 41602155, "comment_id": 70408065, "body": "I guess the problem is about accepting just one client and having the connection alive so you can respond on it multiple times. Its something like the keep-alive of HTTP."}, {"owner": {"reputation": 8001, "user_id": 307297, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/e28FD.png?s=128&g=1", "display_name": "chris01", "link": "https://stackoverflow.com/users/307297/chris01"}, "reply_to_user": {"reputation": 4893, "user_id": 1925997, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nfivT.jpg?s=128&g=1", "display_name": "Kishore Bandi", "link": "https://stackoverflow.com/users/1925997/kishore-bandi"}, "edited": false, "score": 0, "creation_date": 1484209931, "post_id": 41602155, "comment_id": 70418314, "body": "@Bandi: I am talking about the C server, not the Java client."}, {"owner": {"reputation": 55, "user_id": 5025869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204849158970741/picture?type=large", "display_name": "Daniel Holub&#225;\u0159", "link": "https://stackoverflow.com/users/5025869/daniel-holub%c3%a1%c5%99"}, "edited": false, "score": 0, "creation_date": 1484221088, "post_id": 41602155, "comment_id": 70425694, "body": "@chris01: When I want to comunicate just with one client and the same client, the accept is outside. It is working that way for me."}, {"owner": {"reputation": 8001, "user_id": 307297, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/e28FD.png?s=128&g=1", "display_name": "chris01", "link": "https://stackoverflow.com/users/307297/chris01"}, "edited": false, "score": 0, "creation_date": 1484221593, "post_id": 41602155, "comment_id": 70426047, "body": "If you have just one connection and no one more that is true. I am not talking about only one consecutive - I mean only one in the lifetime of the server. But normally a server should be able to accept more than 1 connection in his lifetime and then there the accept is inside a loop. Maybe it is a 2nd problem in the code but I read it is not working for a 2nd client."}], "tags": [], "owner": {"reputation": 8001, "user_id": 307297, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/e28FD.png?s=128&g=1", "display_name": "chris01", "link": "https://stackoverflow.com/users/307297/chris01"}, "is_accepted": false, "score": 0, "last_activity_date": 1484174972, "creation_date": 1484174972, "answer_id": 41602155, "question_id": 41600206, "link": "https://stackoverflow.com/questions/41600206/c-server-returns-only-first-message/41602155#41602155", "title": "C server returns only first message", "body": "<p>The accept must be inside your endless-loop.\nIt accepts any new connection there. So you only accept the 1st one and no other.</p>\n\n<p>listen is the last call you do only once. Then you do it per connection. Thats also the way if you would have some scalability (e.g. fork at accept).</p>\n"}], "owner": {"reputation": 55, "user_id": 5025869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204849158970741/picture?type=large", "display_name": "Daniel Holub&#225;\u0159", "link": "https://stackoverflow.com/users/5025869/daniel-holub%c3%a1%c5%99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 41601905, "answer_count": 3, "score": 1, "last_activity_date": 1484178768, "creation_date": 1484166865, "last_edit_date": 1484178768, "question_id": 41600206, "link": "https://stackoverflow.com/questions/41600206/c-server-returns-only-first-message", "title": "C server returns only first message", "body": "<p>I have a simple C server and simple Java client. Client takes input from keyboard and sends it to server. Server prints it and sends it back. But it works only for the first time, what can be the problem?</p>\n\n<p>Main:</p>\n\n<pre><code>package test;\n\nimport java.util.Scanner;\n\npublic class Main {\n\n\n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        Client cli = new Client();\n        cli.connect();\n\n        while(sc.hasNextLine()) {\n            cli.send(sc.nextLine());\n            System.out.println(cli.rec());\n        }\n\n    }\n}\n</code></pre>\n\n<p>Client:</p>\n\n<pre><code>package test;\n\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.io.OutputStreamWriter;\nimport java.net.Socket;\nimport java.net.UnknownHostException;\n\npublic class Client {\n\n    Socket socket;\n    OutputStreamWriter out;\n    BufferedReader in;\n\n    public void connect() {\n\n        try {\n            socket = new Socket(\"localhost\", 50001);\n            socket.setSoTimeout(5000);\n        } catch (UnknownHostException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n\n        try {\n            out = new OutputStreamWriter(socket.getOutputStream());\n        } catch (IOException e1) {\n            // TODO Auto-generated catch block\n            e1.printStackTrace();\n        }\n        try {\n            in = new BufferedReader(new InputStreamReader(socket.getInputStream()));\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n    }\n\n    public void send(String message) {\n        try {\n            this.out.write(message + \"\\n\");\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n        try {\n            this.out.flush();\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n    }\n\n    public String rec() {\n        try {\n            return in.readLine();\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n        return \"\";\n    }\n}\n</code></pre>\n\n<p>Server:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;resolv.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;errno.h&gt;\n\n#define MY_PORT     50001\n#define MAXBUF      1024\n\nint main(int Count, char *Strings[])\n{   int sockfd;\n    struct sockaddr_in self;\n    char buffer[MAXBUF];\n    int clientfd;\n    struct sockaddr_in client_addr;\n    int addrlen=sizeof(client_addr);\n    int yes = 1;\n\n    /*---Create streaming socket---*/\n    if ( (sockfd = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0 )\n    {\n        perror(\"Socket\");\n        exit(errno);\n    }\n\n    /*---Initialize address/port structure---*/\n    bzero(&amp;self, sizeof(self));\n    self.sin_family = AF_INET;\n    self.sin_port = htons(MY_PORT);\n    self.sin_addr.s_addr = INADDR_ANY;\n\n    if (setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &amp;yes, sizeof(int)) == 0)\n        {\n            printf(\"Socket options was set.\\n\"); //TODO\n        }\n        else\n        {\n            printf(\"Set socket options failure.\\n\"); //TODO\n        }\n\n    /*---Assign a port number to the socket---*/\n    if ( bind(sockfd, (struct sockaddr*)&amp;self, sizeof(self)) != 0 )\n    {\n        perror(\"socket--bind\");\n        exit(errno);\n    }\n\n    /*---Make it a \"listening socket\"---*/\n    if ( listen(sockfd, 20) != 0 )\n    {\n        perror(\"socket--listen\");\n        exit(errno);\n    }\n\n    clientfd = accept(sockfd, (struct sockaddr*)&amp;client_addr, &amp;addrlen);\n\n    /*---Forever... ---*/\n    while (1)\n    {\n        memset(buffer, 0, MAXBUF);\n        /*---accept a connection (creating a data pipe)---*/\n        printf(\"%s:%d connected\\n\", inet_ntoa(client_addr.sin_addr), ntohs(client_addr.sin_port));\n\n        recv(clientfd, buffer, MAXBUF, 0);\n        printf(\"Server got: %s\", buffer);\n        //sprintf(buffer, \"%s\\r\\n\", buffer);\n        /*---Echo back anything sent---*/\n        printf(\"sending...\\n\");\n        int n = send(clientfd, buffer, MAXBUF, 0);\n        printf(\"sent: %d\\n\", n);\n    }\n\n    /*---Close data connection---*/\n            close(clientfd);\n\n    /*---Clean up (should never get here!)---*/\n    close(sockfd);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "terminal"], "comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 2, "creation_date": 1484166141, "post_id": 41599965, "comment_id": 70402787, "body": "The easy way to do this is to use the GNU Readline library (or its BSD equivalent, the Editline library).  Also note that a tail-call to <code>receiveInput</code> may exhaust the stack in C, unlike Scheme."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1484166211, "post_id": 41599965, "comment_id": 70402820, "body": "Take a look at <a href=\"https://cnswww.cns.cwru.edu/php/chet/readline/rltop.html\" rel=\"nofollow noreferrer\">GNU readline library</a> which already provides the interfaces for history."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1484166751, "post_id": 41599965, "comment_id": 70403085, "body": "Keyboards are operating-system specific things, so how you read them will depend on whether you&#39;re running Windows, Mac, or Linux."}, {"owner": {"reputation": 1389, "user_id": 5615274, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/caTA9.jpg?s=128&g=1", "display_name": "robertsan", "link": "https://stackoverflow.com/users/5615274/robertsan"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1484167057, "post_id": 41599965, "comment_id": 70403235, "body": "Is there any other way, like a workaround that will help me not to use a library? @LeeDanielCrocker I&#39;m using Linux."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484167150, "post_id": 41599965, "comment_id": 70403285, "body": "Why the recursion?"}, {"owner": {"reputation": 1389, "user_id": 5615274, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/caTA9.jpg?s=128&g=1", "display_name": "robertsan", "link": "https://stackoverflow.com/users/5615274/robertsan"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484167200, "post_id": 41599965, "comment_id": 70403314, "body": "@WeatherVane beacause I want to wait for another command until you write &quot;exit&quot;."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484167341, "post_id": 41599965, "comment_id": 70403391, "body": "So what will <code>processInput(input);</code> do in that case? <code>free(input);</code> and recurse even further? Better for <code>processInput</code> to return status. The flow control is muddy."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1484167386, "post_id": 41599965, "comment_id": 70403432, "body": "Linux uses terminals, which are normally set up for character I/O. If you want to detect keyboard events, you have to put the terminal in a special mode and use ioctls and such. The &quot;curses&quot; (and ncurses) libraries are commonly used to make this easier and more portable."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484167469, "post_id": 41599965, "comment_id": 70403465, "body": "Aside: the clumsy newline removal after <code>fgets</code> can be done with <code>input [ strcspn(input, &quot;\\r\\n&quot;) ] = 0;</code>"}, {"owner": {"reputation": 1389, "user_id": 5615274, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/caTA9.jpg?s=128&g=1", "display_name": "robertsan", "link": "https://stackoverflow.com/users/5615274/robertsan"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1484167484, "post_id": 41599965, "comment_id": 70403476, "body": "@WeatherVane processInput is either executing a command or exits with exit(0). I know that it&#39;s muddy, it&#39;s just a quick code to challenge myself."}], "owner": {"reputation": 1389, "user_id": 5615274, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/caTA9.jpg?s=128&g=1", "display_name": "robertsan", "link": "https://stackoverflow.com/users/5615274/robertsan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 633, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1484221565, "creation_date": 1484165840, "question_id": 41599965, "link": "https://stackoverflow.com/questions/41599965/detect-up-and-down-arrow-keys-in-c", "title": "Detect UP and DOWN arrow keys in C", "body": "<p>I'm a beginner in C programming and I'm building a command line interpreter. I'm getting the user input from the terminal using <code>fgets()</code> and I was trying to make a 'history' of commands using the arrow keys.</p>\n\n<pre><code>void receiveInput() {\n  char *input = malloc(256);\n\n  printf(\"&gt;&gt; \");\n  fgets(input, 256, stdin);\n  if ((strlen(input) &gt; 0) &amp;&amp;\n      (input[strlen(input) - 1] == '\\n')) {\n      input[strlen(input) - 1] = '\\0';\n  }\n  processInput(input);\n  free(input);\n  receiveInput();\n}\n</code></pre>\n\n<p>The function above builds the input and the problem is that I have to catch the keypress in the same time I'm trying to get the user input. Is there any way of doing this? I already found some solutions that I'm trying to understand but they seem too hard for me at this level.  </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484166143, "post_id": 41599940, "comment_id": 70402789, "body": "<code>printCouples</code> assumes they have adjacent array index by printing <code>size+1, size+2</code>. Add another argument for the other index."}], "answers": [{"tags": [], "owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "is_accepted": false, "score": 0, "last_activity_date": 1484167239, "creation_date": 1484167239, "answer_id": 41600300, "question_id": 41599940, "link": "https://stackoverflow.com/questions/41599940/how-to-print-the-next-index-of-the-same-element-in-array/41600300#41600300", "title": "How to print the next index of the same element in array", "body": "<p>Your test assumes that there are two entries in the age array. That is, the age of the guest looking for a friend is not unique and that the array has been sorted. The array that you pass in is not sorted by age. Thus, size+2 will not contain the same age as size+1.</p>\n\n<p>First sort your age array and then search for the first and last entry of that age in the array.</p>\n\n<p>If you do not want to sort the array, then you would have to test every entry in the array and keep track of matching indexes.</p>\n\n<p>You also exit coupleSearch() as soon as you have found the first match. You need to search for the second match separately if you do not want to sort and search for first and last match.</p>\n\n<p>Since you print size+1, then your printed answer is one based.</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1484167500, "creation_date": 1484167500, "answer_id": 41600379, "question_id": 41599940, "link": "https://stackoverflow.com/questions/41599940/how-to-print-the-next-index-of-the-same-element-in-array/41600379#41600379", "title": "How to print the next index of the same element in array", "body": "<p>You only search for the first match. In other words - you never search for a couple.</p>\n\n<p>Maybe you should try something like:</p>\n\n<pre><code>void printCouples(int size, int condition2, int ageFriend)\n{\n    int j = size+1;  // Start after the first match\n    int found = 0;\n\n    while (j &lt; NUM_GUESTS )\n    {\n        if (ageFriend == guestAges[j])\n        {\n            found = 1; \n            printf(\"Two guest with age %d at index %d and index %d\\n\", ageFriend, size, j);\n        }\n    }\n    if (!found)\n    {\n        printf(\"No guest this age.\\n\");\n    } \n}\n</code></pre>\n\n<p>Notice that <code>condition2</code> isn't used anymore.</p>\n"}], "owner": {"reputation": 345, "user_id": 7350448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/649078feaf1e14298ad543d388f0a4f7?s=128&d=identicon&r=PG&f=1", "display_name": "Ma250", "link": "https://stackoverflow.com/users/7350448/ma250"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484167500, "creation_date": 1484165725, "question_id": 41599940, "link": "https://stackoverflow.com/questions/41599940/how-to-print-the-next-index-of-the-same-element-in-array", "title": "How to print the next index of the same element in array", "body": "<p>I'm writing a function that finds two identical elements in an array and then prints the value of their index. I can't seem to get the right second index. What's my problem?</p>\n\n<p>code:</p>\n\n<blockquote>\n  <p>the function I'm troubled with called 'couplesSearch' and it returns its\n  value to 'printCouples'.line 139</p>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define NUM_GUESTS 200\n#define FALSE 0\n#define TRUE 1\n#define KIDS_AGE 12\n\nfloat averageAge(int ages[], int size);\nint meals(int guestAges[], int size);\nint search(int guestAges[], int size);\nvoid print(int condition);\nint coupleSearch(int guestAges[], int size);\nvoid printCouples(int size, int condition2, int ageFriend);\n\nint main(void)\n{\n    int guestAges[NUM_GUESTS] = {42, 108, 95, 101, 90, 5, 79, 79, 83, 105, 66, 66, 2, 28, 2, 12, 116, 63, 28, 37,   \n    112, 85, 63, 34, 53, 23, 22, 117, 39, 96, 48, 7, 12, 19, 70, 113, 108, 20, 116,\n    55, 24, 52, 3, 94, 34, 105, 22, 32, 54, 29, 108, 45, 23, 118, 118, 20, 84, 22,\n    50, 59, 77, 36, 111, 43, 49, 107, 41, 63, 65, 89, 87, 46, 51, 10, 11, 111, 7, 22,\n    34, 69, 70, 24, 85, 35, 37, 81, 47, 57, 12, 29, 25, 40, 27, 44, 18, 59, 39, 43, \n    10, 102, 34, 36, 80, 19, 25, 91, 100, 27, 114, 67, 102, 66, 45, 113, 31, 70, 18, \n    94, 58, 73, 107, 91, 42, 37, 36, 48, 16, 95, 72, 53, 111, 71, 22, 5, 47, 71, 28, \n    72, 8, 58, 98, 48, 34, 64, 66, 30, 50, 39, 102, 109, 63, 107, 27, 71, 94, 9,\n    61, 72, 43, 96, 11, 120, 25, 18, 69, 4, 116, 82, 3, 111, 92, 117, 15, 101, 37, 22, \n    109, 40, 109, 5, 2, 55, 54, 80, 19, 99, 61, 69, 8, 108, 9, 14, 49, 44, 48, 22, \n    31, 18, 14, 35};\n    int size = 0;\n    printf(\"average is: %.2f\\n\", averageAge(guestAges,size));\n    printf(\"Number of kids 12 and under: %d\\n\" , meals(guestAges, size));\n    print(search(guestAges,size));\n    coupleSearch(guestAges,size);\n    /*printf(\"Two guests with age 16 at index %d and index %d\");\n    printf(\"Youngest guest age: \");\n    printf(\"Oldest guest age: \");*/\n    return 0;\n}\n\n/*\nFunction will return average age of party guests\ninput: age array, number of guests\noutput: average age\n*/\nfloat averageAge(int guestAges[], int size)\n{\n    float sum = 0;\n    float avg = 0;\n\n    for(size = 0; size &lt; NUM_GUESTS; ++size)\n    {\n        sum += guestAges[size];\n    }\n    avg = sum / NUM_GUESTS;\n    return avg;\n}\n\nint meals(int guestAges[], int size)\n{\n    int kids = 0;\n    for (size = 0; size &lt; NUM_GUESTS; size++)\n    {\n        if (guestAges[size] == KIDS_AGE || guestAges[size] &lt; KIDS_AGE)\n        {\n        kids++;\n        }\n    }\n    return kids;\n}\n\nint search(int guestAges[], int size)\n{\n    int condition = 0;\n    int age = 0;\n    printf(\"Enter age to search: \");\n    scanf(\"%d\", &amp;age);\n\n    while (size &lt; NUM_GUESTS &amp;&amp; age != guestAges[size]) \n    {\n      size++;\n    }\n\n   if (size &lt; NUM_GUESTS) \n   {\n      condition = TRUE;\n   } else \n   {\n      condition = FALSE;\n   }\n\n\n   return condition;\n}\n\nvoid print(int condition)\n{\n    if (condition == TRUE)\n    {\n        printf(\"Guest found!\\n\");\n    }\n    else if (condition == FALSE)\n    {\n        printf(\"No guest this age.\\n\");\n    }\n}\n\nint coupleSearch(int guestAges[], int size)\n{\n    int condition2 = 0;\n    int ageFriend = 0;\n    printf(\"Enter age of guest looking for friend: \");\n    scanf(\"%d\", &amp;ageFriend);\n\n     while (size &lt; NUM_GUESTS &amp;&amp; ageFriend != guestAges[size]) \n    {\n      size++;\n    }\n\n   if (size &lt; NUM_GUESTS) \n   {\n      condition2 = TRUE;\n   } else {\n      condition2 = FALSE;\n   }\n   printCouples(size,condition2,ageFriend);\n    return condition2;\n}\n\nvoid printCouples(int size, int condition2, int ageFriend)\n{\n    if (condition2 == TRUE)\n    {\n        printf(\"Two guest with age %d at index %d and index %d\\n\", ageFriend, size+1, size+2);\n    }\n    else if (condition2 == FALSE)\n    {\n        printf(\"No guest this age.\\n\");\n    } \n}\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "c", "flash"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1484164857, "post_id": 41599678, "comment_id": 70402052, "body": "By reading the framework documentation."}, {"owner": {"reputation": 45, "user_id": 7399522, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/87f2a07c5256ec2cd5c43950741fba93?s=128&d=identicon&r=PG&f=1", "display_name": "Crearo Lisifi", "link": "https://stackoverflow.com/users/7399522/crearo-lisifi"}, "edited": false, "score": 0, "creation_date": 1484164944, "post_id": 41599678, "comment_id": 70402108, "body": "is there a command for ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1484165192, "post_id": 41599678, "comment_id": 70402263, "body": "For what, exactly?"}, {"owner": {"reputation": 45, "user_id": 7399522, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/87f2a07c5256ec2cd5c43950741fba93?s=128&d=identicon&r=PG&f=1", "display_name": "Crearo Lisifi", "link": "https://stackoverflow.com/users/7399522/crearo-lisifi"}, "edited": false, "score": 0, "creation_date": 1484165223, "post_id": 41599678, "comment_id": 70402282, "body": "To know the -flag option from a dylib file"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1484165304, "post_id": 41599678, "comment_id": 70402330, "body": "Do you understand the meaning of the word &quot;documentation&quot;?"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1484165306, "post_id": 41599678, "comment_id": 70402333, "body": "No, as latedeveloper said you read the documentation to know which libs you need to link against, and you read your compiler&#39;s documentation to know what flag is used for specifying libs (in this case -l$(lib_name))"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1484166060, "last_edit_date": 1592644375, "creation_date": 1484166060, "answer_id": 41600016, "question_id": 41599678, "link": "https://stackoverflow.com/questions/41599678/how-to-know-a-link-flag-from-a-framework/41600016#41600016", "title": "How to know a link flag from a framework?", "body": "<p>The answer may depend on what compiler you use. You'll find the answer in the manual of that compiler.</p>\n<p>Here is an excerpt of one particular compilers <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html\" rel=\"nofollow noreferrer\">manual</a></p>\n<blockquote>\n<p>-l library</p>\n<p>... The linker searches a standard list of directories for the library, which is actually a file named liblibrary.a. The linker then uses this file as if it had been specified precisely by name.</p>\n<p>...     The only difference between using an -l option and specifying a file name is that -l surrounds library with \u2018lib\u2019 and \u2018.a\u2019 and searches several directories.</p>\n</blockquote>\n<p>The documentation fails to mention, that '.so' extended filenames are also considered.</p>\n<p>So, if this is the compiler that you are using, and if the file that you intend to link with is called <code>libSDL2main.a</code>, then you'll know that you'll need to specify <code>-lSDL2main</code> to the link command.</p>\n<hr />\n<p>A framework may provide multiple archive files. The documentation of the framework should tell you which of those files you should link with.</p>\n"}], "owner": {"reputation": 45, "user_id": 7399522, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/87f2a07c5256ec2cd5c43950741fba93?s=128&d=identicon&r=PG&f=1", "display_name": "Crearo Lisifi", "link": "https://stackoverflow.com/users/7399522/crearo-lisifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1484166060, "creation_date": 1484164760, "question_id": 41599678, "link": "https://stackoverflow.com/questions/41599678/how-to-know-a-link-flag-from-a-framework", "title": "How to know a link flag from a framework?", "body": "<p>For example, I have SDL2/Include and SDL2/lib in my computer\nHow to know what link flags options that will be use by the compiler fir linking options ? How to know it is -lSDL2main ?</p>\n"}, {"tags": ["c", "file", "io"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1484164844, "post_id": 41599651, "comment_id": 70402046, "body": "Read each file in succession?"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1484164847, "post_id": 41599651, "comment_id": 70402047, "body": "Can&#39;t you just open them one at a time to read the data, then close them?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484164973, "post_id": 41599651, "comment_id": 70402125, "body": "Something like <code>FILE *ptr_file[100]; for (...) { sprintf(name, &quot;input%02d.txt&quot;, i); ptr_file[i] =fopen(name,&quot;r&quot;); }</code>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1484164989, "post_id": 41599651, "comment_id": 70402133, "body": "Take a look at <a href=\"https://linux.die.net/man/3/sprintf\" rel=\"nofollow noreferrer\"><code>sprintf</code></a>. You can go in a loop from 0-99, construct the filename during runtime, open it, read it, rinse and repeat."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1484165042, "post_id": 41599651, "comment_id": 70402165, "body": "@yano Love the <a href=\"https://en.wikipedia.org/wiki/Lather,_rinse,_repeat\" rel=\"nofollow noreferrer\">rinse &amp; repeat</a>."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484165232, "post_id": 41599651, "comment_id": 70402288, "body": "@chux Well, what little hair I have left I like to keep super clean ;) Geez, there&#39;s a wikipedia entry for everything!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484165639, "post_id": 41599651, "comment_id": 70402525, "body": "Please close <code>ptr_file</code> after use to dye that hair. Most systems have a limit on how many files may be open at one time."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484176302, "post_id": 41599651, "comment_id": 70407401, "body": "There are functions like <code>opendir()</code>, <code>readdir()</code>, <code>closedir()</code> which can scan file names from a directory that are defined by POSIX.  You could use that to read names and there are functions to check whether the name matches shell-style globs \u2014 or to do shell-style globbing \u2014 also.  You could use some combination of these to find the names that match the pattern you want.  This might be quicker than trying 100 files if most of the files won&#39;t be present.  It does I/O on the directory instead of attempting to open the files."}], "answers": [{"tags": [], "owner": {"reputation": 28403, "user_id": 9867451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hqqWe.jpg?s=128&g=1", "display_name": "ibrahim mahrir", "link": "https://stackoverflow.com/users/9867451/ibrahim-mahrir"}, "is_accepted": false, "score": -1, "last_activity_date": 1484166370, "creation_date": 1484166370, "answer_id": 41600091, "question_id": 41599651, "link": "https://stackoverflow.com/questions/41599651/c-how-to-read-from-valid-multiple-files/41600091#41600091", "title": "C how to read from valid multiple files?", "body": "<p>You can try:</p>\n\n<pre><code>char filename[256];\nFILE *f = NULL;\nint i;\nfor(i = 0; i &lt; 100; i++){\n    sprintf(filename, \"new_File%02i\", i);\n    f = fopen(filename, \"r\");\n    if(f == NULL) // file does not exist\n        continue; // ignore the rest of the loop for this iteration\n\n    // do your reading here.\n\n    fclose(f);\n}\n</code></pre>\n\n<p><code>%02i</code> means print an integer padded over <code>2</code> characters (the result will be at least <code>2</code> characters long) and use <code>0</code> as the padding character (print as much preceeding <code>0</code> as possible to acheive the padding <code>2</code>).</p>\n\n<p><code>sprintf</code> is like <code>printf</code> but instead of showing the result on screen it saves it in a string (<code>filename</code> in this case).</p>\n\n<p><code>\"new_File%02i\"</code> means that the file name should be new_File + a number between 00 and 99. In general it should be <code>\"something%02i.extension\"</code> (I think you forgot the extension).</p>\n\n<p>if <code>f</code> is <code>NULL</code> then there is something wrong (when using mode <code>\"r\"</code> for <code>fopen</code>, it's usually that the file does not exist), so we ignore the rest of the loop where the reading occurs by using the keyword <code>continue</code>.</p>\n"}], "owner": {"reputation": 5, "user_id": 7286185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2245ec3f6de61e431a6a6a782ca760ea?s=128&d=identicon&r=PG&f=1", "display_name": "BellaconBud", "link": "https://stackoverflow.com/users/7286185/bellaconbud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1542549496, "creation_date": 1484164655, "last_edit_date": 1542549496, "question_id": 41599651, "link": "https://stackoverflow.com/questions/41599651/c-how-to-read-from-valid-multiple-files", "title": "C how to read from valid multiple files?", "body": "<p>Suppose I need to read from given files data, and it can be up to 100 files. \nLet's name it new_FileXX , and XX is a value from 00 up to 99.\nBelow there is an example of such program  - it's creating an array, opens file in read mode, and prints everything that is written in the file\nBut it's on reading one file.\nThe question is: how do I write a function that will read every existing file that named new_FileXX (if it exists of course)? </p>\n\n<pre><code>int main()\n{\n    FILE *ptr_file;\n    char buf[1000];\n\n    ptr_file =fopen(\"input.txt\",\"r\");\n    if (!ptr_file)\n        return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "validation", "loops"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1484163473, "post_id": 41599287, "comment_id": 70401281, "body": "Have you ever heard of a do-while loop? If not, look it up. Otherwise, use it. You can circumvent the <code>break</code> with a <code>goto</code> or a flag anyway, so &quot;with out [sic] using break&quot; is pointless here."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1484163646, "post_id": 41599287, "comment_id": 70401377, "body": "If you don&#39;t want to use a <code>break</code> then don&#39;t call <code>break</code>? It&#39;s not clear what you are asking. Don&#39;t tell us what you <i>don&#39;t</i> want to do. Tell us what do you want to do if the validation fails."}, {"owner": {"reputation": 57, "user_id": 1914620, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/92cf32b43dd07ebc6fb96a86b07686a5?s=128&d=identicon&r=PG", "display_name": "Andrei Pak", "link": "https://stackoverflow.com/users/1914620/andrei-pak"}, "edited": false, "score": 0, "creation_date": 1484163753, "post_id": 41599287, "comment_id": 70401440, "body": "I cant use break or goto, i need to go through 5 inputs to process but they must be integer"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1484163828, "post_id": 41599287, "comment_id": 70401480, "body": "Then use a do-while loop. Makes for cleaner code and is easy to write."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1484163885, "post_id": 41599287, "comment_id": 70401518, "body": "Use a <code>while</code> or <code>do&#47;while</code> loop which  has an exit condition on a counter that only increments on successful validation."}, {"owner": {"reputation": 57, "user_id": 1914620, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/92cf32b43dd07ebc6fb96a86b07686a5?s=128&d=identicon&r=PG", "display_name": "Andrei Pak", "link": "https://stackoverflow.com/users/1914620/andrei-pak"}, "edited": false, "score": 0, "creation_date": 1484163973, "post_id": 41599287, "comment_id": 70401563, "body": "It still gives me the infinite error resutl"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1484164048, "post_id": 41599287, "comment_id": 70401609, "body": "Well show that code! Do you expect us to tell you what you did wrong without seeing the code?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484164758, "post_id": 41599287, "comment_id": 70401988, "body": "What is your objection to using <code>break</code>? You have multiple conditions to satisfy (valid input, number range, number of attempts), as well as preventing an input block when the input is refused by <code>%d</code> format."}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 4, "last_activity_date": 1484165114, "last_edit_date": 1484165114, "creation_date": 1484164226, "answer_id": 41599530, "question_id": 41599287, "link": "https://stackoverflow.com/questions/41599287/c-how-to-validate-input-in-a-loop-without-using-break/41599530#41599530", "title": "C How to validate input in a loop Without using break", "body": "<p>Perhaps like this. It checks for valid input, but because there is difficulty dumping input to <code>scanf</code> when it is not accepted (such as a string for a number), I read the line with <code>fgets</code>, and if it is faulty, forget it and get another input.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main (void)\n{\n    int input, attempts = 0;\n    char str[100];\n    do {\n        if(++attempts == 6) {\n            exit(1);\n        }\n        printf(\"Please enter a number 1-5: \");\n        if(fgets(str, sizeof str, stdin) == NULL) {\n            exit(1);\n        }\n    } while(sscanf(str, \"%d\", &amp;input) != 1 || input &lt; 1 || input &gt; 5);\n    printf(\"You entered %d\\n\", input);\n    return 0;\n}\n</code></pre>\n\n<p>Program session</p>\n\n<pre>\nPlease enter a number 1-5: -1\nPlease enter a number 1-5: 42\nPlease enter a number 1-5: obi\nPlease enter a number 1-5: 3\nYou entered 3\n</pre>\n"}], "owner": {"reputation": 57, "user_id": 1914620, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/92cf32b43dd07ebc6fb96a86b07686a5?s=128&d=identicon&r=PG", "display_name": "Andrei Pak", "link": "https://stackoverflow.com/users/1914620/andrei-pak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1484165114, "creation_date": 1484163327, "last_edit_date": 1484163519, "question_id": 41599287, "link": "https://stackoverflow.com/questions/41599287/c-how-to-validate-input-in-a-loop-without-using-break", "title": "C How to validate input in a loop Without using break", "body": "<p>Ho do I validate an input each time in a loop with out having an infinite loop that shows error in validation with out using break:</p>\n\n<pre><code>int main(int argc, char *argv[]) {\nint count;\n\n\nfor(count=1; count&lt;6;count++) {\n    int input;\n    printf(\"Please enter a number 1-5:\");\n\n    if(!scanf(\"%d\",&amp;input)){\n        printf(\"nil\");\n        scanf(\"%d\",&amp;input);\n\n    }\n\n}\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "glut"], "comments": [{"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1484165156, "post_id": 41598993, "comment_id": 70402234, "body": "What do you mean by &quot;multiply&quot;? Do you mean increasing its size, or drawing more than one object?"}, {"owner": {"reputation": 221, "user_id": 5939874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gEhcc.jpg?s=128&g=1", "display_name": "Schneej&#228;ger", "link": "https://stackoverflow.com/users/5939874/schneej%c3%a4ger"}, "reply_to_user": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1484165213, "post_id": 41598993, "comment_id": 70402275, "body": "more of the same object."}], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 5939874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gEhcc.jpg?s=128&g=1", "display_name": "Schneej&#228;ger", "link": "https://stackoverflow.com/users/5939874/schneej%c3%a4ger"}, "edited": false, "score": 0, "creation_date": 1484169142, "post_id": 41600098, "comment_id": 70404319, "body": "So I would copy-paste the display content into itself and change coordinates?"}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 1, "last_activity_date": 1484166430, "creation_date": 1484166430, "answer_id": 41600098, "question_id": 41598993, "link": "https://stackoverflow.com/questions/41598993/multiple-objects-in-glut/41600098#41600098", "title": "Multiple objects in GLUT", "body": "<p>Each time you call <code>glutSolidCube()</code>, it draws one cube. If you want more than one cube to appear, you'll need to call the function more than once in your implementation of <code>display()</code>.</p>\n\n<p>(Make sure you change the model matrix between each call! Otherwise, the cubes will end up in the same place.)</p>\n"}], "owner": {"reputation": 221, "user_id": 5939874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gEhcc.jpg?s=128&g=1", "display_name": "Schneej&#228;ger", "link": "https://stackoverflow.com/users/5939874/schneej%c3%a4ger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 41600098, "answer_count": 1, "score": 0, "last_activity_date": 1484166430, "creation_date": 1484162230, "question_id": 41598993, "link": "https://stackoverflow.com/questions/41598993/multiple-objects-in-glut", "title": "Multiple objects in GLUT", "body": "<p>I want to multiply an object(cube) to a certain number, in this case let's say 25, and I do have the code for one cube, and it works, but I can't figure out how to make more. I am a new-comer to GLUT.</p>\n\n<pre><code>#include &lt;GL/gl.h&gt;\n#include &lt;GL/glut.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid initGL(int width, int height)\n{\n\n glMatrixMode(GL_PROJECTION);\n glLoadIdentity();\n gluPerspective(45.0f,(GLfloat)width/(GLfloat)height,2.0f, 100.0f);\n glMatrixMode(GL_MODELVIEW);\n}\nstatic void display(void)\n{\n\nglLoadIdentity();\nglPushMatrix();\n    glTranslatef(0.0,0.0,-10);\n    glRotatef(60,1,0,0);\n    glRotatef(60,0,1,0);\n    glutSolidCube(2);\nglPopMatrix();\n\nglFlush();\n}\n\nstatic void idle(void)\n{\nglutPostRedisplay();\n}\n\nint main(int argc, char *argv[])\n{\n\nint width = 640;\nint height = 480;\n\nglutInit(&amp;argc, argv);\nglutInitWindowSize(width, height);\nglutInitWindowPosition(10,10);\nglutInitDisplayMode(GLUT_RGB | GLUT_SINGLE);\n\nglutCreateWindow(\"GLUT cube\");\n\nglutDisplayFunc(display);\nglutIdleFunc(idle);\n\ninitGL(width, height);\n\nglutMainLoop();\n\nreturn EXIT_SUCCESS;\n\n}\n</code></pre>\n\n<p>And if there is a more detailed guide on how to, I'd be more than thankful if you share.</p>\n"}, {"tags": ["java", "c", "sockets"], "answers": [{"comments": [{"owner": {"reputation": 362, "user_id": 647701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lKeQ2.jpg?s=128&g=1", "display_name": "Panu", "link": "https://stackoverflow.com/users/647701/panu"}, "reply_to_user": {"reputation": 508, "user_id": 3425331, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/5aD5j.jpg?s=128&g=1", "display_name": "amkz", "link": "https://stackoverflow.com/users/3425331/amkz"}, "edited": false, "score": 0, "creation_date": 1484243170, "post_id": 41599219, "comment_id": 70440792, "body": "readLine method never return character &#39;\\n&#39;. It returns string. Now (if my assumption is correct) the textarea is not updated at all even if the server is closed.  Simple approach would be to add line with END when the output ends. And then check if &quot;END&quot; equals the result of readline."}, {"owner": {"reputation": 362, "user_id": 647701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lKeQ2.jpg?s=128&g=1", "display_name": "Panu", "link": "https://stackoverflow.com/users/647701/panu"}, "reply_to_user": {"reputation": 508, "user_id": 3425331, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/5aD5j.jpg?s=128&g=1", "display_name": "amkz", "link": "https://stackoverflow.com/users/3425331/amkz"}, "edited": false, "score": 0, "creation_date": 1484243523, "post_id": 41599219, "comment_id": 70441005, "body": "Aa... But you could check it the line is empty. Because you are sending empy line. This happens by        while(&quot;&quot;.equals(response = reader.readLine())."}, {"owner": {"reputation": 362, "user_id": 647701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lKeQ2.jpg?s=128&g=1", "display_name": "Panu", "link": "https://stackoverflow.com/users/647701/panu"}, "reply_to_user": {"reputation": 508, "user_id": 3425331, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/5aD5j.jpg?s=128&g=1", "display_name": "amkz", "link": "https://stackoverflow.com/users/3425331/amkz"}, "edited": false, "score": 0, "creation_date": 1484243813, "post_id": 41599219, "comment_id": 70441160, "body": "And even more simple solution is for the server to close connection after it has sent all the data. Of course client needs to reconnect if it wants to send another command."}, {"owner": {"reputation": 508, "user_id": 3425331, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/5aD5j.jpg?s=128&g=1", "display_name": "amkz", "link": "https://stackoverflow.com/users/3425331/amkz"}, "edited": false, "score": 0, "creation_date": 1484244232, "post_id": 41599219, "comment_id": 70441396, "body": "I don&#39;t want to disconnect from the server, this one (&quot;&quot;.equals(response = reader.readLine()) didnt works, first space and end. Option with while (!(response = reader.readLine()).equals(&quot;end&quot;)) didn&#39;t work too."}, {"owner": {"reputation": 362, "user_id": 647701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lKeQ2.jpg?s=128&g=1", "display_name": "Panu", "link": "https://stackoverflow.com/users/647701/panu"}, "reply_to_user": {"reputation": 508, "user_id": 3425331, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/5aD5j.jpg?s=128&g=1", "display_name": "amkz", "link": "https://stackoverflow.com/users/3425331/amkz"}, "edited": false, "score": 0, "creation_date": 1484246831, "post_id": 41599219, "comment_id": 70442738, "body": "Sorry. The while(&quot;&quot;.equals(..)) was of course wrong because I forgot to negate the condition. Glad you got it working."}], "tags": [], "owner": {"reputation": 362, "user_id": 647701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lKeQ2.jpg?s=128&g=1", "display_name": "Panu", "link": "https://stackoverflow.com/users/647701/panu"}, "is_accepted": false, "score": 1, "last_activity_date": 1484247296, "last_edit_date": 1484247296, "creation_date": 1484163101, "answer_id": 41599219, "question_id": 41598854, "link": "https://stackoverflow.com/questions/41598854/java-socket-client-cant-receive-response-from-c-server/41599219#41599219", "title": "Java socket client can&#39;t receive response from C server", "body": "<p>Original code had following line to check wether receiving should continue: </p>\n\n<pre><code>while ((response = reader.readLine()) != null){\n</code></pre>\n\n<p>Problem is that the <a href=\"https://docs.oracle.com/javase/7/docs/api/java/io/BufferedReader.html#readLine()\" rel=\"nofollow noreferrer\">readLine() method</a> returns null only after the connection has been closed by the peer. The updating of the user interface happens only after the method return. Thus the UI gets updated only when the connection is closed.</p>\n\n<p>There has to be some kind of end marker to signal that there is no more data coming from server to the last request (command in this case) so the while loop can end.</p>\n\n<p>Code should work if Java side is implemented like this</p>\n\n<pre><code>while (!\"\".equals(response = reader.readLine())){\n</code></pre>\n\n<p>and C side like this</p>\n\n<pre><code>if(result != NULL) {\n    while(1){\n        char buffer[BUFFSIZE];\n        memset(buffer, '\\0', BUFFSIZE);\n        char *pipeData = fgets(buffer, BUFFSIZE, result);\n        if(pipeData == NULL)\n            break;\n        int r = send(socketId, buffer, strlen(buffer), 0);\n        if(r &lt;= 0) break;           \n    }\n}\nsend(socketId, \"\\n\", 1, 0);        \n</code></pre>\n\n<p>Generally this is problem caused by the fact that using raw byte stream as communication channel is a pain in the ass. Even the simplest things, like the code here, need to have some kind of protocol. In this case the code tries to lean heavily on the newline character ('\\n', byte 0x0A).</p>\n\n<p>For the request side this approach is ok. Code just assumes that all of the bytes except 0x0A (newline, '\\n') is of a command being transmitted and 0x0A ends the command. Sometimes in communication there is discussion about control channel and data channel. Here they are separated by using different \"alphabets\". There is no change of mixup.</p>\n\n<p>Unfortunately the reply from the server, what the command generated, can contain any characters even the newline. This means that the control and data can not have different alphabets. The fixed code assumes that empty line (two newlines in a row, 0x0A 0x0A) ends the reply. Unfortunately this is totally valid output for many commands. This approach will cause problems. Control and data channels should be separated differently.</p>\n\n<p>One approach is to read all of the output of the command first, then send the length of it and finally the data. Now the sequence of bytes separates control and data channels. Another option could be to choose some end character and escape it in the normal data.</p>\n\n<p>It might be worth to look <a href=\"http://zeromq.org/\" rel=\"nofollow noreferrer\">ZeroMQ</a>. It can solve this kind of problems easily and in additionally even if you decide not to use it, the guide is fun to read. :)</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 508, "user_id": 3425331, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/5aD5j.jpg?s=128&g=1", "display_name": "amkz", "link": "https://stackoverflow.com/users/3425331/amkz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484328793, "creation_date": 1484161760, "last_edit_date": 1484237910, "question_id": 41598854, "link": "https://stackoverflow.com/questions/41598854/java-socket-client-cant-receive-response-from-c-server", "title": "Java socket client can&#39;t receive response from C server", "body": "<p>I want to connect with java to c socket server, send linux command which will be executed on server and the receive the result on java client.</p>\n\n<p>I have socket client in C which looks like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;pthread.h&gt;\n\n#define MAXCON 500 \n#define BUFFSIZE 256\n#define MAXCOMMAND 500\n\nvoid *newClient(void *argSocket);\n\nint main (int argc, char *argv[]) {\n\n    fflush(stdout);\n    struct sockaddr_in addrIn;\n    struct sockaddr_in clientAddr;\n    int mainSocket = socket(PF_INET, SOCK_STREAM, 0);\n\n    memset(&amp;addrIn, '\\0', sizeof(addrIn));\n    addrIn.sin_family = AF_INET;\n    addrIn.sin_addr.s_addr = INADDR_ANY;\n    addrIn.sin_port = htons(6666);\n\n    if(setsockopt(mainSocket, SOL_SOCKET, SO_REUSEADDR, &amp;(int){1}, sizeof(int))&lt;0){\n        perror(\"SETSOCKOPT ERROR\");\n        exit(-1);\n    }\n\n    if(bind(mainSocket, (struct sockaddr *)&amp;addrIn, sizeof(addrIn))&lt;0){\n        perror(\"PORT IS ALREADY IN USE\");\n        exit(-1);\n    }\n\n    listen(mainSocket, MAXCON); \n\n    while(1){\n        int newSocket;\n        int clientAddrLength = sizeof(clientAddr);\n\n        if((newSocket = accept(mainSocket, (struct sockaddr*)&amp;clientAddr, &amp;clientAddrLength)) &lt; 0){\n            perror(\"ERROR DURING CONNECTION\");\n            continue;\n        }\n\n        pthread_t *newThread;\n        pthread_create(&amp;newThread, NULL, newClient, (void*)newSocket);\n        pthread_detach(newThread);\n    }\n\n    return EXIT_SUCCESS;\n\n}\n\nvoid *newClient(void *argSocket){\n\n    fflush(stdout);\n    int socketId = (int)argSocket;\n    while(1){\n        char command[MAXCOMMAND];\n        memset(command, '\\0', MAXCOMMAND);\n\n        for(int i = 0;i&lt;MAXCOMMAND;i++){\n            int answer = recv(socketId, &amp;command[i], 1, 0);\n            if(answer==0)       \n                break;\n            if(answer&lt;0)\n                break;\n            if(command[i]=='\\n')\n                break;\n        }\n\n        int commandLength = strlen(command);\n\n        if(commandLength &gt; 0 &amp;&amp; command[commandLength-1] == '\\n'){\n            command[commandLength-1] = '\\0';\n            if(commandLength-2 &gt;= 0 &amp;&amp; command[commandLength-2] == '\\r')\n                command[commandLength-2] = '\\0';\n        }\n\n        if(commandLength == 0)\n            continue;\n\n        printf(\"NEW COMMAND: %s\\n\", command);\n        fflush(stdout);\n\n        FILE *result = popen(command, \"r\");\n\n        if(result != NULL)\n            while(1){\n                char buffer[BUFFSIZE];\n                memset(buffer, '\\0', BUFFSIZE);\n                char *pipeData = fgets(buffer, BUFFSIZE, result);\n                if(pipeData == NULL)\n                    break;\n                int r = send(socketId, buffer, strlen(buffer), 0);\n                r = send(socketId, '\\n', 1, 0);\n                if(r &lt;= 0)\n                    break;\n            }\n    }\n\n    end:\n    printf(\"END\\n\");\n\n}\n</code></pre>\n\n<p>and JavaFX Client </p>\n\n<pre><code>package sample;\n\nimport javafx.fxml.FXML;\nimport javafx.fxml.Initializable;\nimport javafx.scene.control.Button;\nimport javafx.scene.control.TextArea;\nimport javafx.scene.control.TextField;\n\nimport java.io.*;\nimport java.net.Socket;\nimport java.net.URL;\nimport java.util.ResourceBundle;\n\npublic class Controller implements Initializable {\n\n    @FXML\n    TextField textField = new TextField();\n    @FXML\n    TextArea textArea = new TextArea();\n    @FXML\n    Button button = new Button(\"Accept\");\n\n    private DataOutputStream dataOutputStream;\n    private BufferedReader reader;\n\n    private void connectAndReceive() {\n        try {\n            textArea.setText(\"\");\n            dataOutputStream.writeBytes(textField.getText() + \"\\n\");\n            String response;\n            while ((response = reader.readLine()) != '\\n') {\n                textArea.appendText(\"-\" + response);\n            }\n\n        } catch (IOException e) {\n            textArea.appendText(\"1\" + e.getMessage() + e.toString());\n        }\n    }\n\n    @Override\n    public void initialize(URL location, ResourceBundle resources) {\n        textField.setId(\"textField\");\n        textArea.setId(\"textArea\");\n        button.setId(\"button\");\n        button.setOnAction(e -&gt; connectAndReceive());\n        try {\n            Socket client = new Socket(\"127.0.0.1\", 6666);\n            dataOutputStream = new DataOutputStream(client.getOutputStream());\n            reader = new BufferedReader(new InputStreamReader(client.getInputStream()));\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n\n}\n</code></pre>\n\n<p>Server is working good, receive and resend linux command result, but java client receive answer and fill textarea only when I shut down the server.\nOtherwise client is going to hang...\nI am using Ubuntu virtual machine with gcc on Oracle VM and Java 1.8.\nWhat I am doing wrong with this?</p>\n"}, {"tags": ["c", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1484234995, "post_id": 41598151, "comment_id": 70435263, "body": "<code>threadprivate</code> is the simplest solution."}], "answers": [{"tags": [], "owner": {"reputation": 1002, "user_id": 5770664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd347861d0f5a6605b49213fa2065eaf?s=128&d=identicon&r=PG&f=1", "display_name": "Armen Avetisyan", "link": "https://stackoverflow.com/users/5770664/armen-avetisyan"}, "is_accepted": false, "score": 0, "last_activity_date": 1484163922, "creation_date": 1484163922, "answer_id": 41599441, "question_id": 41598151, "link": "https://stackoverflow.com/questions/41598151/compute-number-of-iterations-in-openmp-for-loop-with-dynamic-schedule/41599441#41599441", "title": "Compute number of iterations in openmp for loop with dynamic schedule", "body": "<p>Use a private individual counter for each thread. There is no other way around.</p>\n\n<p>Something like </p>\n\n<pre><code>int workload[n_threads] = {0, ...};\n#pragma omp parallel for schedule(dynamic) private(i)\nfor(int i=0;i&lt;n;i++){\n    //loop code\n    workload[omp_get_thread_num()]++;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1484232875, "post_id": 41609542, "comment_id": 70433672, "body": "Shouldn&#39;t you have <code>#pragma omp critical</code> before the <code>printf</code>. Also the OP said &quot;at the end of the program&quot; so the OP may have meant he/she wants to save the results and print them at a later time outside of the parallel region."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1484235898, "post_id": 41609542, "comment_id": 70435955, "body": "&quot;Nothing easier.&quot; <code>threadprivate</code> is easier and also does not require change the structure of the code."}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1484236534, "post_id": 41609542, "comment_id": 70436452, "body": "<code>threadprivate</code> requires a static/global variable, which opens yet another can of worms."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1484257876, "post_id": 41609542, "comment_id": 70448737, "body": "Shouldn&#39;t you have <code>#pragma omp critical</code> before the <code>printf</code>?"}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1484263081, "post_id": 41609542, "comment_id": 70450836, "body": "I probably should... But the idea here is to show the general working of things. I&#39;m less and less convinced that spoon-feeding people the complete solutions is the proper way to teach them (I know, SO is not a school/university...)"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1484263948, "post_id": 41609542, "comment_id": 70451106, "body": "Can you give some examples of why using <code>threadprivate</code> in this case opens another can of worms? What kind of problems can it cause?"}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1484301622, "post_id": 41609542, "comment_id": 70463556, "body": "In this particular case - no. But using static and global variables in multithreaded programs is a bad practice in general and one has to be really careful to avoid possible data races. Also, using thread-private variables results in non-portable performance. For example, the ELF TLS based thread-private implementation of GCC is fast on real ELF systems and terribly slow on macOS, where it is emulated. But then, ELF TLS does not (used to not?) support constructors/destructors and GCC cannot make non-POD C++ classes thread-private in OpenMP. That&#39;s why I try to avoid thread-private solutions."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1484414410, "post_id": 41609542, "comment_id": 70504234, "body": "Is TLS slow on macOS because of how it&#39;s implemented in GCC or because of a limitation of Mach-O? Do you have a link about this to recommend?"}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1484416233, "post_id": 41609542, "comment_id": 70504830, "body": "I&#39;ve seen the assembly code. On ELF platforms, FS is loaded with a selector that points to the beginning of the TCB, the first element of which is the thread pointer. The TLS is then at a fixed offset from the thread pointer. On GNU systems, the thread pointer points to the TCB itself, therefore accessing the TLS is just <code>[FS]:const_offset</code>. On Mach-O this gets emulated for some reason, at least by GCC. The proper way to handle TLS there is <a href=\"http://lifecs.likai.org/2010/05/mac-os-x-thread-local-storage.html\" rel=\"nofollow noreferrer\">to use pthread_getspecific()</a>."}], "tags": [], "owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "is_accepted": true, "score": 3, "last_activity_date": 1484302172, "last_edit_date": 1484302172, "creation_date": 1484213710, "answer_id": 41609542, "question_id": 41598151, "link": "https://stackoverflow.com/questions/41598151/compute-number-of-iterations-in-openmp-for-loop-with-dynamic-schedule/41609542#41609542", "title": "Compute number of iterations in openmp for loop with dynamic schedule", "body": "<p>Nothing easier. Just split the combined <code>parallel for</code> directive into two separate constructs, which allows you to add extra code before and after the loop:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#pragma omp parallel\n{\n   int iters = 0;\n   #pragma omp for schedule(dynamic,chunk)\n   for (int i = 0; i &lt; n; i++) {\n      ...\n      iters++;\n   }\n   #pragma omp critical\n   printf(\"Thread %d did %d iterations\\n\", omp_get_thread_num(), iters);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1484237281, "post_id": 41616553, "comment_id": 70437040, "body": "There is no guarantee that the two parallel regions in your first sample will execute with the same number of threads. <i>dyn-var</i> must be explicitly set to <i>false</i>."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1484257818, "post_id": 41616553, "comment_id": 70448705, "body": "@HristoIliev, I fixed it I think using <code>omp_set_dynamic(0)</code>. I was not aware that number of threads could dynamically change between parallel regions without explicitly telling OpenMP to do this. That may be true in principle but I don&#39;t know if I have ever seen it in practice. Have you?"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1484258842, "post_id": 41616553, "comment_id": 70449158, "body": "@HristoIliev, how come you did not point that out <a href=\"http://stackoverflow.com/questions/18719257/parallel-cumulative-prefix-sums-in-openmp-communicating-values-between-thread#comment27598031_18719257\">here</a> &quot;schedule(static) has special properties guaranteed by the standard like repeatable distribution pattern&quot;. I can&#39;t rely on schedule(static) having the same repeatable distribution if the number of threads dynamical changes between parallel regions."}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1484262991, "post_id": 41616553, "comment_id": 70450804, "body": "I&#39;ve overlooked it or was less aware at that time."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1484263834, "post_id": 41616553, "comment_id": 70451061, "body": "@HristoIliev, well in any case thank you for correcting me now. I&#39;m embarrassed that I did not know of dynamic teams by now. I noticed there are several answers/questions about dynamic teams on SO. It&#39;s my first time answering an OpenMP question on SO in months and I already learned something."}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 1, "creation_date": 1484301884, "post_id": 41616553, "comment_id": 70463684, "body": "I&#39;ve learned so much myself answering questions here. Just keep the OpenMP specs open while writing the answer :)"}], "tags": [], "owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "is_accepted": false, "score": 1, "last_activity_date": 1484257705, "last_edit_date": 1484257705, "creation_date": 1484233775, "answer_id": 41616553, "question_id": 41598151, "link": "https://stackoverflow.com/questions/41598151/compute-number-of-iterations-in-openmp-for-loop-with-dynamic-schedule/41616553#41616553", "title": "Compute number of iterations in openmp for loop with dynamic schedule", "body": "<p>If you truly want to print the number of iterations at the end of your program outside of your parallel region or other code you did (and avoid false sharing) the simple solution is to use <code>threadprivate</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;omp.h&gt;\n\nint iters;\n#pragma omp threadprivate(iters)\n\nint main(void) {\n  omp_set_dynamic(0); //Explicitly turn off dynamic threads\n  int i;\n  int n = 10000;\n  #pragma omp parallel for schedule(dynamic)\n  for(i=0; i&lt;n; i++) {\n    iters++;\n  }\n  #pragma omp parallel\n  #pragma omp critical\n  printf(\"Thread %d did %d iterations\\n\", omp_get_thread_num(), iters);\n}\n</code></pre>\n\n<p>Here is a complicated solution which also requires you to change the structure of your code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;omp.h&gt;\n\nint main(void) {\n  int i;\n  int n = 100;\n  int nthreads;\n  int *aiters;\n  #pragma omp parallel\n  {\n    nthreads = omp_get_num_threads();\n    #pragma omp single\n    aiters = malloc(sizeof *aiters * nthreads);\n    int iters = 0;\n    #pragma omp for schedule(dynamic)\n    for(i=0; i&lt;n; i++) {\n      iters++;\n    }\n    aiters[omp_get_thread_num()]=iters;\n  }\n  for(i=0; i&lt;nthreads; i++)\n    printf(\"Thread %d did %d iterations\\n\", i, aiters[i]);\n  free(aiters);\n}\n</code></pre>\n"}], "owner": {"reputation": 756, "user_id": 3963540, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c331beaac3186a94a522a77586937cfc?s=128&d=identicon&r=PG&f=1", "display_name": "Marouen", "link": "https://stackoverflow.com/users/3963540/marouen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 991, "favorite_count": 0, "accepted_answer_id": 41609542, "answer_count": 3, "score": 3, "last_activity_date": 1484302172, "creation_date": 1484159402, "question_id": 41598151, "link": "https://stackoverflow.com/questions/41598151/compute-number-of-iterations-in-openmp-for-loop-with-dynamic-schedule", "title": "Compute number of iterations in openmp for loop with dynamic schedule", "body": "<p>I am running a for loop with openmp with dynamic load balancing. I\u00b4d like to print how many tasks/iterations each thread processed at the end of the program.\nThe loop looks like this:</p>\n\n<pre><code>chunk=1;\n#pragma omp parallel for schedule(dynamic,chunk) private(i)\nfor(i=0;i&lt;n;i++){\n//loop code\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1484156413, "post_id": 41597229, "comment_id": 70397414, "body": "Actually MSVC already does automatically for <code>malloc</code> calls if certain security features are enabled. like here: <a href=\"http://stackoverflow.com/questions/34442943/can-someone-explain-the-meaning-of-malloc20-c-20-unsigned-int64uns/34443299#34443299\" title=\"can someone explain the meaning of malloc20 c 20 unsigned int64uns\">stackoverflow.com/questions/34442943/&hellip;</a> . To answer your question: promote the operands to wider types and check if it beyond the range that the result operands can hold, is how MSVC&#39;s implementation."}, {"owner": {"reputation": 7116, "user_id": 5083516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2aeeefc1a95ddb2f19612150ccd7ba?s=128&d=identicon&r=PG&f=1", "display_name": "plugwash", "link": "https://stackoverflow.com/users/5083516/plugwash"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1484156547, "post_id": 41597229, "comment_id": 70397511, "body": "Sure, specific compilers may have a type available that is wider than pointer. What i&#39;m interested in is whether there is a better way that works in the general case."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1484156843, "post_id": 41597229, "comment_id": 70397696, "body": "The simple answer is to divide the maximum value of the variable type by one of the multipliers. If the quotient is less than the other multiplier, their product will overflow."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1484161465, "post_id": 41597229, "comment_id": 70400178, "body": "For 32-bit unsigned integers (and easily adapted to other sizes), you can split the numbers in two parts and check the partial multiplications and additions for overflow, something like: <code>answer = a * b; ah = a &#47; 65536; al = a % 65536; bh = b &#47; 65536; bl = b % 65536; t1 = ah * bl; t2 = al * bh; overflow = (ah &amp;&amp; bh || t1 &gt;= 65536 || t2 &gt;= 65536 || t1 + t2 &gt;= 65536 || answer &lt; (t1 + t2) * 65536 || answer &lt; al * bl);</code> The compiler should be able to optimize the subexpressions involving 65536, but if it can&#39;t, you can replace them with shifts and masks."}], "owner": {"reputation": 7116, "user_id": 5083516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2aeeefc1a95ddb2f19612150ccd7ba?s=128&d=identicon&r=PG&f=1", "display_name": "plugwash", "link": "https://stackoverflow.com/users/5083516/plugwash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "closed_date": 1484156385, "answer_count": 0, "score": 0, "last_activity_date": 1484156122, "creation_date": 1484156122, "question_id": 41597229, "link": "https://stackoverflow.com/questions/41597229/what-is-the-best-way-to-do-a-multiply-with-overflow-check-in-c", "closed_reason": "Duplicate", "title": "what is the best way to do a multiply with overflow check in C?", "body": "<p>I want to multiply two unsigned numbers and I want to know if the result has overflowed. For example I may be calculating the size of a memory block to allocate.</p>\n\n<p>I could use a type for the multiplication that is at least twice as large as the types I am multiplying so that overflow simply cannot happen but such a type may not be available. </p>\n\n<p>I could do a division after the multiplication and compare the result with the original operands but divisions is a relatively slow operation</p>\n\n<p>Is there a better way?</p>\n"}, {"tags": ["c++", "c", "arrays"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 2, "creation_date": 1484155646, "post_id": 41597039, "comment_id": 70396911, "body": "The array is being interpreted as a <i>pointer</i> inside the function, hence the problem. Even worse, you&#39;re passing <i>a single member</i> of <code>ary</code> to the function, not the whole array."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484155673, "post_id": 41597039, "comment_id": 70396933, "body": "<code>ary</code> is pointer in <code>printAry</code>, not <code>array of int</code>."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1484155677, "creation_date": 1484155677, "answer_id": 41597085, "question_id": 41597039, "link": "https://stackoverflow.com/questions/41597039/why-am-i-iterating-less-times-than-expected/41597085#41597085", "title": "Why am I iterating less times than expected?", "body": "<p>You can't use the <code>sizeof(ary) / sizeof(ary[0])</code> idiom if <code>ary</code> is a function parameter since it will have already <em>decayed</em> into a pointer type: <code>sizeof(ary)</code> is merely the size of a pointer to <code>int</code> on your platform.</p>\n\n<p>In C, you need to pass the size information explicitly, or adopt a convention that a particular value signals the end of the array (cf. <code>'\\0'</code> in the C standard library string functions.)</p>\n\n<p>In C++, you can use a <code>std::vector</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1484155858, "post_id": 41597089, "comment_id": 70397046, "body": "If you don&#39;t mind: I&#39;ve added &quot;pointer to <code>int</code>&quot; as not all pointers <i>necessarily</i> need to be the same size."}, {"owner": {"reputation": 16382, "user_id": 5507349, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IaCUb.jpg?s=128&g=1", "display_name": "Edgar Rokj\u0101n", "link": "https://stackoverflow.com/users/5507349/edgar-rokj%c4%81n"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1484155942, "post_id": 41597089, "comment_id": 70397091, "body": "@Bathsheba yes, for example pointers to functions hypothetically may have another size. Good point!"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1484156005, "post_id": 41597089, "comment_id": 70397126, "body": "It&#39;s true for primitives too, e.g. <code>sizeof(int*)</code> might be different to <code>sizeof(long*)</code>."}, {"owner": {"reputation": 16382, "user_id": 5507349, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IaCUb.jpg?s=128&g=1", "display_name": "Edgar Rokj\u0101n", "link": "https://stackoverflow.com/users/5507349/edgar-rokj%c4%81n"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1484156160, "post_id": 41597089, "comment_id": 70397239, "body": "@Bathsheba is it guaranteed by the standard?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1484156201, "post_id": 41597089, "comment_id": 70397269, "body": "I wouldn&#39;t bet my job on it, but I&#39;m sure the standard allows for <code>sizeof(int*)</code> to be different to <code>sizeof(long*)</code>."}], "tags": [], "owner": {"reputation": 16382, "user_id": 5507349, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IaCUb.jpg?s=128&g=1", "display_name": "Edgar Rokj\u0101n", "link": "https://stackoverflow.com/users/5507349/edgar-rokj%c4%81n"}, "is_accepted": true, "score": 4, "last_activity_date": 1484155777, "last_edit_date": 1484155777, "creation_date": 1484155691, "answer_id": 41597089, "question_id": 41597039, "link": "https://stackoverflow.com/questions/41597039/why-am-i-iterating-less-times-than-expected/41597089#41597089", "title": "Why am I iterating less times than expected?", "body": "<p>The reason is that <em>arrays decay into pointers</em>.</p>\n\n<p>Basically</p>\n\n<pre><code>void printAry(int ary[])\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>void printAry(int* ary)\n</code></pre>\n\n<p>So <code>sizeof(ary)</code> is equal to the size of pointer to <code>int</code> on your system.</p>\n"}], "owner": {"reputation": 31, "user_id": 6677201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fcbe69f1698e21dd1dd458d6975b8b2?s=128&d=identicon&r=PG&f=1", "display_name": "BrandonW000", "link": "https://stackoverflow.com/users/6677201/brandonw000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1484155767, "accepted_answer_id": 41597089, "answer_count": 2, "score": 0, "last_activity_date": 1484162440, "creation_date": 1484155561, "last_edit_date": 1484162440, "question_id": 41597039, "link": "https://stackoverflow.com/questions/41597039/why-am-i-iterating-less-times-than-expected", "closed_reason": "Duplicate", "title": "Why am I iterating less times than expected?", "body": "<p>I have printed out my <code>sizeof(array)/sizeof(*array)</code> and receive the number three, but when I pass my array into my function it prints out 2 when stored into a variable and therefor iterates one less time than it should. </p>\n\n<pre><code> void printAry(int ary[])\n {\n     int size = sizeof(ary)/sizeof(ary[0]);\n       cout&lt;&lt;size;//size will print out 2! why?\n       for(int i = 0; i &lt; size;i++)\n     {\n         cout&lt;&lt;ary[i];\n     }\n }\n\n int main() {\n     int ary[3] = {1,2,3};\n     cout&lt;&lt;sizeof(ary[0]);\n\n     return 0;\n }\n</code></pre>\n\n<p>Why is it iterating one time less than expected ?</p>\n"}, {"tags": ["c", "stack"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 15, "creation_date": 1484155019, "post_id": 41596830, "comment_id": 70396519, "body": "It is totally implementation defined. It doesn&#39;t even have to be on stack at all. C standard doesn&#39;t have a notion for stack."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484155088, "post_id": 41596830, "comment_id": 70396568, "body": "@EugeneSh. So where are the variables mentioned by the OP allocated?"}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1484155151, "post_id": 41596830, "comment_id": 70396604, "body": "JohnnyH, by the way, what&#39;s your problem of me editing your question? My edits are only made to hopefully improve the question not to customise it."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1484155161, "post_id": 41596830, "comment_id": 70396614, "body": "@nbro we don&#39;t know, we don&#39;t even know if they are allocated."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 4, "creation_date": 1484155162, "post_id": 41596830, "comment_id": 70396615, "body": "@nbro Anywhere. In register, in memory, on a sticky note on your fridge. Or even nowhere, as some of the variables doing nothing and get optimized away."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 1, "creation_date": 1484155224, "post_id": 41596830, "comment_id": 70396644, "body": "@nbro, I think your edit got accidentally clobbered by a larger edit."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484155310, "post_id": 41596830, "comment_id": 70396706, "body": "The way to understand what your implementation is doing would be to look at an assembler output."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484155336, "post_id": 41596830, "comment_id": 70396727, "body": "@EugeneSh. So, are you saying there&#39;s no difference between allocating memory with malloc and declaring any other variable on the body of a function?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1484155448, "post_id": 41596830, "comment_id": 70396793, "body": "@nbro on some PICs for example, the hardware stack is a call stack only. Other processors have two stacks - call stack and user stack. And so on. As to, your recent question local variables have the lifetime of the function, but  memory from <code>malloc</code> persists."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1484155554, "post_id": 41596830, "comment_id": 70396847, "body": "@nbro, no, he&#39;s saying that <i>the standard doesn&#39;t specify</i> and therefore <i>implementations may and do differ</i>."}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1484155567, "post_id": 41596830, "comment_id": 70396860, "body": "Essentially a duplicate of this one <a href=\"http://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap?rq=1\" title=\"what and where are the stack and heap\">stackoverflow.com/questions/79923/&hellip;</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 1, "creation_date": 1484155575, "post_id": 41596830, "comment_id": 70396866, "body": "@nbro Am I? No. But yes, it is possible to have a complying compiler allocating local variables the same way <code>malloc</code> does. Moreover, I&#39;ve encountered a compiler allocating VLAs with <code>malloc</code> (it gave me some headache, as the platform did not have a proper <code>malloc</code> implementation)..."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "reply_to_user": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1484155648, "post_id": 41596830, "comment_id": 70396913, "body": "@MalcolmMcLean Why should this question be a duplicate of the one you&#39;re linking to?"}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1484155723, "post_id": 41596830, "comment_id": 70396963, "body": "You just confuse newbies by saying an implementation doesn&#39;t have to have a stack. The stack is a small region of memory on which local variables and (usually) function return addresses and pushed and popped with every call."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "reply_to_user": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1484155977, "post_id": 41596830, "comment_id": 70397106, "body": "@MalcolmMcLean What? What&#39;s your pointing of explaining what&#39;s a stack? The point of this question is all about the memory model of the C programming language, not what&#39;s a stack or a heap, but the OP doesn&#39;t know it."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1484156016, "post_id": 41596830, "comment_id": 70397132, "body": "@Malcolm OK, can you answer this question, such that it will be always true? I don&#39;t think so, as any correct answer will contain &quot;it depends on implementation&quot;."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1484156024, "post_id": 41596830, "comment_id": 70397142, "body": "I guess this question can receive a meaningful answer if it&#39;s not tagged as <code>C</code> language but a (and only one) popular implementation. Like &quot;How does the stack work in GCC&#39;s (or clang&#39;s or MSVC&#39;s) (current) C implementation (on x86-64 platforms)?&quot;."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484156252, "post_id": 41596830, "comment_id": 70397301, "body": "@EugeneSh. My point was that in C there&#39;s a difference between allocating memory which will be freed once the stack frame of a function is destroyed (because the function returns) and allocating memory with <code>malloc</code>. Now, if the memory allocated with <code>malloc</code> is on the heap or stack of the current thread, I don&#39;t know."}, {"owner": {"reputation": 3252, "user_id": 6131611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3789df5ff075b7a2bfa71c8e2dccd18d?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/6131611/pavel"}, "edited": false, "score": 0, "creation_date": 1484156265, "post_id": 41596830, "comment_id": 70397313, "body": "<a href=\"https://gcc.godbolt.org/\" rel=\"nofollow noreferrer\">This</a> may help"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 3, "creation_date": 1484156495, "post_id": 41596830, "comment_id": 70397468, "body": "@nbro the lifetime and scope of a local variable have nothing to do with any stack, but C itself. A newbie is better informed with information that a local variable has the scope and lifetime only of the function, regardless of the implementation&#39;s storage method, since that is one of the most common faults of newbie code."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1484156751, "post_id": 41596830, "comment_id": 70397641, "body": "So what do you guys have to say regarding these slides: <a href=\"http://www.cs.cornell.edu/courses/cs2022/2011sp/lectures/lect06.pdf\" rel=\"nofollow noreferrer\">cs.cornell.edu/courses/cs2022/2011sp/lectures/lect06.pdf</a>?"}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484156904, "post_id": 41596830, "comment_id": 70397738, "body": "@WeatherVane By the way, having worked with PintOS, I was accustomed to think that local variables of a function are really allocated on a stack, or at least in a LIFO data structure. Now, if that isn&#39;t always the case, could you please point me to the official documentation where it&#39;s said that C has no notion of stack and heap?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 3, "creation_date": 1484157240, "post_id": 41596830, "comment_id": 70397922, "body": "@nbro no, the standard does not say &quot;C does/not use a heap/stack&quot;. In fact the word &quot;stack&quot; does not appear. No mention of greenfly or toads either. It only dictates <i>what</i> will happen, and not <i>how</i>."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1484157253, "post_id": 41596830, "comment_id": 70397928, "body": "@nbro <a href=\"http://port70.net/~nsz/c/c11/n1570.html\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html</a> you can do a ctrl+f and find nothing about stack or heap"}, {"owner": {"reputation": 459, "user_id": 7320865, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ea95f5204ba35b15398fdcf0c3e18848?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyH", "link": "https://stackoverflow.com/users/7320865/johnnyh"}, "edited": false, "score": 0, "creation_date": 1484157577, "post_id": 41596830, "comment_id": 70398102, "body": "Is it possible that someone make a post with all the considerations you talked about, or maybe gives an answer for a casual &quot;case&quot;, like running this program on Ubuntu 14"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484157646, "post_id": 41596830, "comment_id": 70398134, "body": "@JohnnyH that&#39;s not my system, but comments say it is a function of the compiler you are using, on that system."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 1, "creation_date": 1484159582, "post_id": 41596830, "comment_id": 70399136, "body": "@nbro, with respect to what your slide deck has to say about stack and heap: it describes characteristics of <i>one possible way</i> to implement C.  To the extent that it implies that all C implementations must use a stack as it describes, it is both wrong in theory and inconsistent with some real, conforming implementations.  Many implementations are structured similarly to the slides&#39; description, but it is common for the details to vary."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1484160692, "post_id": 41596830, "comment_id": 70399773, "body": "@JohnBollinger It&#39;s not my slide deck, I found it by googling. Could you please pointing me to an implementation of C which doesn&#39;t use stacks. I&#39;m curious to know which other concepts and tools can be used to implement something that really is asking for a stack."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1484162825, "post_id": 41596830, "comment_id": 70400923, "body": "By the way guys, <a href=\"http://stackoverflow.com/a/79936/3924118\">this</a> answer (with more than 1000 upvotes) to the post someone in this comment section has mentioned says: &quot;In C, variables on the <i>heap</i> must be destroyed manually and never fall out of scope. The data is freed with delete, delete[], or free&quot;. It seems for me that a lot of people don&#39;t know what they are doing."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1484163395, "post_id": 41596830, "comment_id": 70401249, "body": "@nbro As I said previously, I am working with <code>armcc</code> compiler, and at some point I wanted to use VLA, assuming it will use the stack to allocate. And I was really surprised it was attempting to use <code>malloc</code> internally instead. As a consequence the same implementation would perform <code>free</code> at the function exit.."}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1484163574, "post_id": 41596830, "comment_id": 70401336, "body": "So, in today&#39;s world, there is ~1% of compilers and architectures which won&#39;t store local variables on stack and registers. But it&#39;s implementation dependent, so there is no point in explaining to the OP how the remaining 99% compilers operate."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1484163702, "post_id": 41596830, "comment_id": 70401413, "body": "@Lousy Even if 100% are operating with stack, the specific stack usage is varying much more than the above distribution."}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484164140, "post_id": 41596830, "comment_id": 70401648, "body": "@EugeneSh.: I am only saying that, IMHO, understanding how stack works and looking at exact emitted assembly of different compilers has only helped me understand each architecture <i>better</i>. And there is a practical difference in malloc&#39;ing a huge array on the heap, or simply creating a huge local temporary array and risk running out of stack."}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1484169610, "post_id": 41596830, "comment_id": 70404576, "body": "@JohnBollinger I&#39;ve used tiny C compilers for small embedded targets which don&#39;t use stacks. Local variables are simply mapped to a global space, and recursion is prohibited. But most hosted C implementations have a stack."}], "answers": [{"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": true, "score": 2, "last_activity_date": 1484177447, "last_edit_date": 1484177447, "creation_date": 1484157714, "answer_id": 41597669, "question_id": 41596830, "link": "https://stackoverflow.com/questions/41596830/how-does-the-stack-works/41597669#41597669", "title": "How does the stack works?", "body": "<p>Wiki article:</p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Stack_(abstract_data_type)\" rel=\"nofollow noreferrer\">http://en.wikipedia.org/wiki/Stack_(abstract_data_type)</a></p>\n\n<p>The wiki article makes an analogy to a stack of objects, where the top of the stack is the only object you can see (peek) or remove (pop), and where you would add (push) another object onto.</p>\n\n<p>For a typical implementation of a stack, the stack starts at some address and the address decreases as elements are pushed onto the stack. A push typically decrements the stack pointer before storing an element onto the stack, and a pop typically loads an element from the stack and increments the stack pointer after.</p>\n\n<p>However, a stack could also grow upwards, where a push stores an element then increments the stack pointer after, and a pop would decrement the stack pointer before, then load an element from the stack. This is a common way to implement a software stack using an array, where the stack pointer could be a pointer or an index.</p>\n\n<p>Back to the original question, there's no rule on the ordering of local variables on a stack. Typically the total size of all local variables is subtracted from the stack pointer, and the local variables are accessed as offsets from the stack pointer (or a register copy of the stack pointer, such as bp, ebp, or rbp in the case of a X86 processor).</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1484171945, "last_edit_date": 1484171945, "creation_date": 1484166710, "answer_id": 41600169, "question_id": 41596830, "link": "https://stackoverflow.com/questions/41596830/how-does-the-stack-works/41600169#41600169", "title": "How does the stack works?", "body": "<p>The <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C language definition</a> does not specify how objects are to be laid out in memory, nor does it specify how arguments are to be passed to functions (the words \"stack\" and \"heap\" don't appear anywhere in the language definition itself).  That is <em>entirely</em> a function of the compiler and the underlying platform.  The answer for x86 may be different from the answer for M68K which may be different from the answer for MIPS which may be different from the answer for SPARC which may be different from the answer for an embedded controller, etc.  </p>\n\n<p>All the language definition specifies is <em>lifetime</em> of objects (when storage for an object is allocated and how long it lasts) and the <em>linkage</em> and <em>visibility</em> of identifiers (linkage controls whether multiple instances of the same identifier refer to the same object, visibility controls whether that identifier is usable at a given point).</p>\n\n<p>Having said all that, almost any desktop or server system you're likely to use will have a runtime stack.  Also, C was initially developed on a system with a runtime stack, and much of its behavior certainly <em>implies</em> a stack model.  A C compiler would be a bugger to implement on a system that didn't use a runtime stack.  </p>\n\n<blockquote>\n  <p>I also understood that the bottom of the stack correspond to the largest address, and the top to the smallest ones.</p>\n</blockquote>\n\n<p>That doesn't have to be true at all.  The top of the stack is simply the place something was most recently pushed.  Stack elements don't even have to be consecutive in memory (such as when using a linked-list implementation of a stack).  On x86, the runtime stack grows \"downwards\" (towards decreasing addresses), but don't assume that's universal.  </p>\n\n<blockquote>\n  <p>Where would be pointer named \"file1\" in the stack compared to pointer named \"buffer\" ? would it be with upper in the stack (smaller address), or down (larger address) ?</p>\n</blockquote>\n\n<p>First, the compiler is not required to lay out distinct objects in memory in the same order that they were declared; it may re-order those objects to minimize padding and alignment issues (<code>struct</code> members <em>must</em> be laid out in the order declared, but there may be unused \"padding\" bytes between members).</p>\n\n<p>Secondly, only <code>file1</code> is a pointer.  <code>buffer</code> is an <em>array</em>, so space will only be allocated for the array elements themselves - no space is set aside for any pointer.  </p>\n\n<blockquote>\n  <p>Also, I know that printf() when giving format args (like %d, or %s) will read on the stack, but in this example where will it start to read ?</p>\n</blockquote>\n\n<p>It may not read arguments from the stack <em>at all</em>.  For example, Linux on x86-64 uses the <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI\" rel=\"nofollow noreferrer\">System V AMD64 ABI calling convention</a>, which passes the first six arguments via registers.  </p>\n\n<p>If you're <em>really</em> curious how things look on a particular platform, you need to a) read up on that platform's calling conventions, and b) look at the generated machine code.  Most compilers have an option to output a machine code listing.  For example, we can take your program and compile it as</p>\n\n<pre><code>gcc -S file.c\n</code></pre>\n\n<p>which creates a file named <code>file.s</code> containing the following (lightly edited) output:</p>\n\n<pre><code>        .file   \"file.c\"\n        .section        .rodata\n.LC0:\n        .string \"rt\"\n.LC1:\n        .string \"~/file.txt\"\n        .text\n.globl main\n        .type   main, @function\nmain:\n.LFB2:\n        pushq   %rbp                 ;; save the current base (frame) pointer\n.LCFI0:\n        movq    %rsp, %rbp           ;; make the stack pointer the new base pointer\n.LCFI1:\n        subq    $48, %rsp            ;; allocate an additional 48 bytes on the stack\n.LCFI2:\n        movl    %edi, -36(%rbp)      ;; since we use the contents of the %rdi(%edi) and %rsi(esi) registers\n        movq    %rsi, -48(%rbp)      ;; below, we need to preserve their contents on the stack frame before overwriting them\n        movl    $.LC0, %esi          ;; Write the *second* argument of fopen to esi\n        movl    $.LC1, %edi          ;; Write the *first* argument of fopen to edi\n        call    fopen                ;; arguments to fopen are passed via register, not the stack\n        movq    %rax, -8(%rbp)       ;; save the result of fopen to file1\n        movq    $0, -32(%rbp)        ;; zero out the elements of buffer (I added\n        movw    $0, -24(%rbp)        ;; an explicit initializer to your code)\n        movq    -48(%rbp), %rax      ;; copy the pointer value stored in argv to rax\n        addq    $8, %rax             ;; offset 8 bytes (giving us the address of argv[1])\n        movq    (%rax), %rdi         ;; copy the value rax points to to rdi\n        movl    $0, %eax             \n        call    printf               ;; like with fopen, arguments to printf are passed via register, not the stack\n        movq    -8(%rbp), %rdi       ;; copy file1 to rdi\n        call    fclose               ;; again, arguments are passed via register\n        movl    $0, %eax\n        leave\n        ret\n</code></pre>\n\n<p>Now, this is for <em>my specific platform</em>, which is Linux (SLES-10) on x86-64.  This does not apply to different hardware/OS combinations.  </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Just realized that I left out some important stuff.</p>\n\n<p>The notation <em>N</em>(<em>reg</em>) means offset <em>N</em> bytes from the address stored in register <em>reg</em> (basically, <em>reg</em> acts as a pointer).  <code>%rbp</code> is the base (frame) pointer - it basically acts as the \"handle\" for the current stack frame.  Local variables and function arguments (assuming they are present on the stack) are accessed by offsetting from the address stored in <code>%rbp</code>.  On x86, local variables typically have a negative offset from <code>%rbp</code>, while function arguments have a positive offset.  </p>\n\n<p>The memory for <code>file1</code> starts at <code>-8(%rbp)</code> (pointers on x86-64 are 64 bits wide, so we need 8 bytes to store it).  That's fairly easy to determine based on the lines</p>\n\n<pre><code>    call    fopen                \n    movq    %rax, -8(%rbp)       \n</code></pre>\n\n<p>On x86, function return values are written to <code>%rax</code> or <code>%eax</code> (<code>%eax</code> is the lower 32 bits of <code>%rax</code>).  So the result of <code>fopen</code> is written to <code>%rax</code>, and we copy the contents of <code>%rax</code> to <code>-8(%rbp)</code>.</p>\n\n<p>The location for <code>buffer</code> is a little trickier to determine, since you don't do anything with it.  I added an explicit initializer (<code>char buffer[10] = {0};</code>) just to generate some instructions that access it, and those are</p>\n\n<pre><code>        movq    $0, -32(%rbp)       \n        movw    $0, -24(%rbp)       \n</code></pre>\n\n<p>From this, we can determine that <code>buffer</code> starts at <code>-32(%rbp)</code>.  There's 14 bytes of unused \"padding\" space between the end of <code>buffer</code> and the beginning of <code>file1</code>.  </p>\n\n<p>Again, this is how things play out on my specific system; you may see something different.  </p>\n"}, {"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484169365, "post_id": 41600453, "comment_id": 70404429, "body": "Why is this answer here, given we have two comprehensive answers and a long list of comments providing much more information each?"}, {"owner": {"reputation": 1017, "user_id": 1577626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8b76fa5adfe311d171acbe62690174?s=128&d=identicon&r=PG", "display_name": "vpathak", "link": "https://stackoverflow.com/users/1577626/vpathak"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484218288, "post_id": 41600453, "comment_id": 70423830, "body": "both the answers above are pedantic in nature - talking in terms of data structures and standards - some information you can get for yourself in an undergraduate text book.  however they just ignore the fact that this organization of the stack is the main means setting up a very important class of hacking attacks on modern systems.    but if this aspect must be hidden - i will wait for a few more down votes and remove it.   thanks"}], "tags": [], "owner": {"reputation": 1017, "user_id": 1577626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8b76fa5adfe311d171acbe62690174?s=128&d=identicon&r=PG", "display_name": "vpathak", "link": "https://stackoverflow.com/users/1577626/vpathak"}, "is_accepted": false, "score": -2, "last_activity_date": 1484167828, "creation_date": 1484167828, "answer_id": 41600453, "question_id": 41596830, "link": "https://stackoverflow.com/questions/41596830/how-does-the-stack-works/41600453#41600453", "title": "How does the stack works?", "body": "<p>Very implementation dependent but still nearby.  In faxt this is very crucial to setting up buffer overflow based attacks.</p>\n"}], "owner": {"reputation": 459, "user_id": 7320865, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ea95f5204ba35b15398fdcf0c3e18848?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyH", "link": "https://stackoverflow.com/users/7320865/johnnyh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 41597669, "answer_count": 3, "score": 2, "last_activity_date": 1484177447, "creation_date": 1484154902, "last_edit_date": 1484155065, "question_id": 41596830, "link": "https://stackoverflow.com/questions/41596830/how-does-the-stack-works", "title": "How does the stack works?", "body": "<p>from what I understood the stack is used in a function to stock all the local variables that are declared.</p>\n\n<p>I also understood that the bottom of the stack correspond to the largest address, and the top to the smallest ones.</p>\n\n<p>So, let's say I have this C program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char *argv[]){\n    FILE *file1 = fopen(\"~/file.txt\", \"rt\");\n    char buffer[10];\n    printf(argv[1]);\n    fclose(file1);\n    return 0;\n}\n</code></pre>\n\n<p>Where would be pointer named \"file1\" in the stack compared to pointer named \"buffer\" ? would it be with upper in the stack (smaller address), or down (larger address) ?</p>\n\n<p>Also, I know that <code>printf()</code> when giving format args (like <code>%d</code>, or <code>%s</code>) will read on the stack, but in this example where will it start to read ?</p>\n"}, {"tags": ["c++", "c", "stl"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1484155023, "post_id": 41596689, "comment_id": 70396522, "body": "<code>std::vector&lt;FooTypes&gt; myFooTypes{ FOO_TYPE_A, FOO_TYPE_ZZ, FOO_TYPE_B, FOO_TYPE_NONE };</code>, or <code>myFooTypes.push_back(FOO_TYPE_NONE)</code>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1484156116, "post_id": 41596689, "comment_id": 70397203, "body": "Consider using <a href=\"http://en.cppreference.com/w/cpp/container/vector/data\" rel=\"nofollow noreferrer\">std::vector::data</a> instead of <code>&amp;myFooTypes.front()</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1484156133, "post_id": 41596689, "comment_id": 70397216, "body": "&quot;I don&#39;t want to create unnecessary mutations or copies&quot; -- if the C function expects a terminated array, then you must either copy the original vector (or at least its contents), or mutate the vector by appending a terminator.  There are no other alternatives.  You could conceivably add the terminator for the duration of the call, then remove it again."}], "answers": [{"comments": [{"owner": {"reputation": 1351, "user_id": 328316, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8face8afbe4e34480ae1c65a232c46ca?s=128&d=identicon&r=PG", "display_name": "Ben L", "link": "https://stackoverflow.com/users/328316/ben-l"}, "edited": false, "score": 0, "creation_date": 1484931378, "post_id": 41767554, "comment_id": 70728844, "body": "NO. If I could change the api, I would. But this is not under my control."}], "tags": [], "owner": {"reputation": 13563, "user_id": 992490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac727873c5724326c84ed245faa9fe6c?s=128&d=identicon&r=PG", "display_name": "Marshall Clow", "link": "https://stackoverflow.com/users/992490/marshall-clow"}, "is_accepted": false, "score": -1, "last_activity_date": 1484927439, "creation_date": 1484927439, "answer_id": 41767554, "question_id": 41596689, "link": "https://stackoverflow.com/questions/41596689/guidelines-for-passing-stl-containers-to-c-functions/41767554#41767554", "title": "Guidelines for passing stl containers to C functions", "body": "<p>A better solution is to change the interface of <code>find_best_footype</code> to take a pointer and a length, rather than assuming a terminator.\n(if you have to maintain C compatibility for <code>find_best_footype</code>)</p>\n\n<p>Then you can write:</p>\n\n<pre><code>FooTypes foo = find_best_footype(myFooTypes.data(), myFooTypes.size(), 42); \n</code></pre>\n\n<p>and not have to change the vector. However, this will require changes elsewhere.</p>\n"}], "owner": {"reputation": 1351, "user_id": 328316, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8face8afbe4e34480ae1c65a232c46ca?s=128&d=identicon&r=PG", "display_name": "Ben L", "link": "https://stackoverflow.com/users/328316/ben-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484927439, "creation_date": 1484154444, "question_id": 41596689, "link": "https://stackoverflow.com/questions/41596689/guidelines-for-passing-stl-containers-to-c-functions", "title": "Guidelines for passing stl containers to C functions", "body": "<p>We're migrating to modern c++ with stl containers. But the old c with classes style persists. One of the hardest areas to refactor are the interfaces to C api's.</p>\n\n<pre><code>// foo_types_list (array terminated by FOO_TYPE_NONE)\nenum FooTypes find_best_footype(const enum FooTypes *foo_types_list,\n                                        unsigned int capabilities);\n\nstd::vector&lt;FooTypes&gt; myFooTypes{ FOO_TYPE_A, FOO_TYPE_ZZ, FOO_TYPE_B };\n\nFooTypes foo = find_best_footype( &amp;myFooTypes.front(), 42); // fail, not terminated.\n</code></pre>\n\n<p>What is the best strategy for accommodating these c-api's? I need to terminate the vector to make the call, but I don't want to create unnecessary mutations or copies?  </p>\n\n<p>If creating a copy is the only way to go, whats a simple way to make a data structure that will be compatible with the accessors in the C function?</p>\n"}, {"tags": ["c", "algorithm", "stm32"], "comments": [{"owner": {"reputation": 1167, "user_id": 5339807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5db3c9fa9b80760fc44ae03008f7a1?s=128&d=identicon&r=PG&f=1", "display_name": "mascoj", "link": "https://stackoverflow.com/users/5339807/mascoj"}, "edited": false, "score": 4, "creation_date": 1484153283, "post_id": 41596243, "comment_id": 70395360, "body": "Might want to move this over to <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1484153489, "post_id": 41596243, "comment_id": 70395498, "body": "Might be better to rely on <code>GPIO_PIN_13</code> interrupts rather than timer interrupts."}, {"owner": {"reputation": 49, "user_id": 6474426, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cGVf-zm6dg0/AAAAAAAAAAI/AAAAAAAACnI/escG8r17QJ0/photo.jpg?sz=128", "display_name": "ree", "link": "https://stackoverflow.com/users/6474426/ree"}, "edited": false, "score": 0, "creation_date": 1484153511, "post_id": 41596243, "comment_id": 70395515, "body": "Ok, didn&#39;t know that. I&#39;ll move it"}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1484153645, "post_id": 41596243, "comment_id": 70395607, "body": "BTW, what&#39;s the point of maintaining both <code>ShortPressed</code> and <code>ShortPressed</code>? Just maintain a single enumerator indicating 3 states (off, short and long)."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1484153772, "post_id": 41596243, "comment_id": 70395685, "body": "I might be reading the code incorrectly, but doesn&#39;t your first <code>if</code> determine if the button is still pressed? If so, why the need to do yet another <code>if( ButtonState.Released == FALSE)</code> in the <code>else</code>? In the else can&#39;t you just assume the button is released and just check how long is was pressed?"}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1484158191, "post_id": 41596243, "comment_id": 70398402, "body": "Your updated code looks more reasonable now. Only thing is you say the timer is firing every 1ms but your tick counter is named usTick. Maybe that should be msTick?"}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1484161609, "post_id": 41596243, "comment_id": 70400253, "body": "For double-tap detection you&#39;ll need to compare the tick difference between two button closed states. You&#39;ll need a <code>lastClosedTickCount</code> variable that is perhaps <code>static</code> to the interrupt routine so the value is saved between calls. And compare it against <code>usTick</code>. If you detect a double-tap then set set both <code>usTick</code> and <code>lastClosedTickCount</code> to 0 to prepare for detecting next double-tap."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1484170553, "post_id": 41596243, "comment_id": 70405051, "body": "Why not just subtract button down time from button up time and compare to 1000.  Are you doing anything before the button is released?"}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1484178711, "post_id": 41596243, "comment_id": 70408213, "body": "@stark Because the code is zeroing <code>usTick</code> when the button is released the code is basically subtracting button down time from button up time."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1484181890, "post_id": 41596243, "comment_id": 70409105, "body": "Where are you de-bouncing the button?"}, {"owner": {"reputation": 635, "user_id": 2010398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GnCdn.png?s=128&g=1", "display_name": "gmug", "link": "https://stackoverflow.com/users/2010398/gmug"}, "edited": false, "score": 0, "creation_date": 1484210766, "post_id": 41596243, "comment_id": 70418813, "body": "I agree with barak manos, if possible I also would use the EXTI Interrupt of GPIO_PIN_13. In the ISR you can qery the pin state and save the systick time. Then you can just determine the difference."}, {"owner": {"reputation": 635, "user_id": 2010398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GnCdn.png?s=128&g=1", "display_name": "gmug", "link": "https://stackoverflow.com/users/2010398/gmug"}, "edited": false, "score": 0, "creation_date": 1484210833, "post_id": 41596243, "comment_id": 70418865, "body": "But I also agree with  Chimera, debouncing is also something you should take into account."}], "answers": [{"comments": [{"owner": {"reputation": 516, "user_id": 6490190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c28036f5e41e1db1ea8d989c9264820?s=128&d=identicon&r=PG", "display_name": "Yuriy", "link": "https://stackoverflow.com/users/6490190/yuriy"}, "edited": false, "score": 0, "creation_date": 1484267543, "post_id": 41625501, "comment_id": 70452190, "body": "Also STM32 timers have PWM input mode that can be used to measure duration of a single signal. This way is more difficult in coding, but also more beautiful. Maybe there is other ways, cause STM32 timers are very very clever, to find them you can read reference manual table of contents at least:)"}], "tags": [], "owner": {"reputation": 516, "user_id": 6490190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c28036f5e41e1db1ea8d989c9264820?s=128&d=identicon&r=PG", "display_name": "Yuriy", "link": "https://stackoverflow.com/users/6490190/yuriy"}, "is_accepted": false, "score": 0, "last_activity_date": 1484267205, "creation_date": 1484267205, "answer_id": 41625501, "question_id": 41596243, "link": "https://stackoverflow.com/questions/41596243/how-can-i-distinguish-short-from-long-button-press-in-c/41625501#41625501", "title": "How can I distinguish short from long button press in C?", "body": "<p>Almost every STM32 timer has \"external trigger synchronization\" function. You can read about it in timer functional description in reference manual. You can use \"Slave mode: Trigger mode\" to start counting on \"button down\" event. And in EXTI interrupt of \"button up event\" you can read timer counter and do your business.</p>\n\n<p>I don't know how to implement this via HAL, but Standard Peripheral Library should have the example.    </p>\n"}, {"tags": [], "owner": {"reputation": 823, "user_id": 1850429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aeac2c1534ffc9cd94072b3196838b9?s=128&d=identicon&r=PG", "display_name": "Jeroen3", "link": "https://stackoverflow.com/users/1850429/jeroen3"}, "is_accepted": false, "score": 0, "last_activity_date": 1484600813, "creation_date": 1484600813, "answer_id": 41684992, "question_id": 41596243, "link": "https://stackoverflow.com/questions/41596243/how-can-i-distinguish-short-from-long-button-press-in-c/41684992#41684992", "title": "How can I distinguish short from long button press in C?", "body": "<p><strong>1)</strong> Your code is only able to handle 1 button. Make it object oriented to read <strong><em>n</em></strong> buttons.</p>\n\n<p>1 ms is much too fast. 20 ms should work fine. Remember: humans are slow.</p>\n\n<p><strong>2)</strong> I once had spent some time creating a LED controller with two pushbutton rotary encoders. These would feature advanced programming methods by means of pushing them long or multiple times. You could use the result of my sparring (it was never completed) as inspiration. The button code is fairly complex, it should fulfill your needs. And I remember it to be functional.</p>\n\n<p><a href=\"https://github.com/Jeroen6/LED-Rotary-Dimmer-SW/blob/master/user/button.c\" rel=\"nofollow noreferrer\">https://github.com/Jeroen6/LED-Rotary-Dimmer-SW/blob/master/user/button.c</a>\n<a href=\"https://github.com/Jeroen6/LED-Rotary-Dimmer-SW/blob/master/user/button.h\" rel=\"nofollow noreferrer\">https://github.com/Jeroen6/LED-Rotary-Dimmer-SW/blob/master/user/button.h</a></p>\n\n<p><em>Forgive me for not having the indentations worked out correctly.</em></p>\n"}], "owner": {"reputation": 49, "user_id": 6474426, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cGVf-zm6dg0/AAAAAAAAAAI/AAAAAAAACnI/escG8r17QJ0/photo.jpg?sz=128", "display_name": "ree", "link": "https://stackoverflow.com/users/6474426/ree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1438, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549212476, "creation_date": 1484153086, "last_edit_date": 1549212476, "question_id": 41596243, "link": "https://stackoverflow.com/questions/41596243/how-can-i-distinguish-short-from-long-button-press-in-c", "title": "How can I distinguish short from long button press in C?", "body": "<p>I wrote a code for determining the push button state wheather it's long pressed or not. By the way this function is called by a timer interrupt routine in every 1 ms.</p>\n\n<p>If you pressed more than 1 second, LongPressed is active ShortPressed is passive .so vice versa.</p>\n\n<p><strong>1-</strong> But it seems really dummy how can I make it shorter and more efficient according to both readibilty and professional rules?</p>\n\n<p>BTW I updated the code like below.</p>\n\n<pre><code>void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim)\n{   \n    /*button pressed and count*/\n    if(!HAL_GPIO_ReadPin(GPIOC, GPIO_PIN_13))\n    {\n        usTick++;\n    }\n    /*not pressed*/\n    else\n    {\n        if( usTick &gt; 1000){\n            ButtonState.PressedState = LongPressed;\n            HAL_GPIO_TogglePin(GPIOA,GPIO_PIN_5);       \n            usTick = 0;\n        }\n        else if( usTick &gt;350){\n            ButtonState.PressedState = ShortPressed;\n            HAL_GPIO_TogglePin(GPIOA,GPIO_PIN_5);               \n            usTick = 0;\n        }               \n        usTick = 0;\n    }\n}\n</code></pre>\n\n<p><strong>2-</strong> What should I add or change to get double Tap pressing information in this updated code?</p>\n"}, {"tags": ["c", "matrix", "random", "double"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1484151482, "post_id": 41595672, "comment_id": 70394242, "body": "<code>myMatr[i]</code> is <code>double</code>, so apparently you cannot subscript it further."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1484151582, "post_id": 41595672, "comment_id": 70394324, "body": "<code>myMatr[i][y]</code> --&gt; <code>myMatr[i * yDim + y]</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1484151892, "post_id": 41595672, "comment_id": 70394518, "body": "<code>malloc</code> does not receive the <code>xDim * yDim</code> spec, only their product, so there is no way that the memory allocated could be somehow interpreted as a 2-D array by the language."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484152154, "post_id": 41595672, "comment_id": 70394695, "body": "<code>myMatr</code> not a 2D array but a pointer to <code>double</code>. These are two different things."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1484152159, "post_id": 41595672, "comment_id": 70394701, "body": "As you only define a pointer, how should the compiler be able to make any difference between <code>myMatr[10][5]</code> and <code>myMatr[5][10]</code>. This can only be done if the limits are all known (except for one dimension)"}], "answers": [{"tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": false, "score": 1, "last_activity_date": 1484154596, "creation_date": 1484154596, "answer_id": 41596738, "question_id": 41595672, "link": "https://stackoverflow.com/questions/41595672/populate-matrix-in-c-with-rand/41596738#41596738", "title": "Populate Matrix in C with rand()", "body": "<p>In C, <code>a[x][y]</code> can mean a couple of things: first, it can mean that <code>a</code> is an array of or a pointer to arrays of known length, declared like this:</p>\n\n<pre><code>double (*a)[5];\n</code></pre>\n\n<p>That is, <code>a</code> points to arrays of 5 doubles. Since this size is known ahead of time, you can allocate a big block and do the double indexing on it. But this won't work if you need to determine the size of both indices at runtime. In that case, you have no choice but to declare <code>a</code> as an array of pointers, and allocate this array and each of its sub-arrays separately:</p>\n\n<pre><code>double **a;\na = malloc(xDim * sizeof(double *));\nfor (int i = 0; i &lt; xDim; i += 1) {\n    a[i] = malloc(yDim * sizeof(double));\n}\n</code></pre>\n\n<p>Now, <code>a[x][y]</code> means \"find the xth pointer in array a, then find the yth double in the array it points to\".</p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1484159005, "creation_date": 1484159005, "answer_id": 41598029, "question_id": 41595672, "link": "https://stackoverflow.com/questions/41595672/populate-matrix-in-c-with-rand/41598029#41598029", "title": "Populate Matrix in C with rand()", "body": "<p>The minimum change to your code is probably to make <code>myMatr</code> into a pointer to an array.</p>\n\n<p>Change:</p>\n\n<pre><code>double *myMatr = (double *)malloc(xDim * yDim * sizeof(double));\n</code></pre>\n\n<p>(which is currently spread over two lines in the source) into:</p>\n\n<pre><code>double (*myMatr)[yDim] = malloc(xDim * yDim * sizeof(double));\n</code></pre>\n\n<p>The rest of the code shown then works.  You should add <code>free(myMatr);</code> before the end, of course.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    srand(time(NULL)); // init. is needed only once\n\n    /* random number generator for matrix dimensions */\n    int xDim = (rand() % (10000 + 1) + 50);\n    int yDim = (rand() % (10000 + 1) + 50);\n\n    //double *myMatr = (double *)malloc(xDim * yDim * sizeof(double));\n    double (*myMatr)[yDim] = malloc(xDim * yDim * sizeof(double));\n\n    /* random number generator for matrix contents */\n    for (int i = 0; i &lt; xDim; i++)\n    {\n        for (int y = 0; y &lt; yDim; y++)\n        {\n            myMatr[i][y] = (double)rand() / RAND_MAX * 100.0;\n        }\n    }\n\n    /* print matrix contents */\n    for (int i = 0; i &lt; xDim; i++)\n    {\n        for (int y = 0; y &lt; yDim; y++)\n            printf(\"%6.2f\", myMatr[i][y]);\n        putchar('\\n');\n    }\n\n    free(myMatr);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 240, "user_id": 5879036, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mby9E.jpg?s=128&g=1", "display_name": "Sarriman", "link": "https://stackoverflow.com/users/5879036/sarriman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 41598029, "answer_count": 2, "score": 0, "last_activity_date": 1484159005, "creation_date": 1484151342, "last_edit_date": 1484153075, "question_id": 41595672, "link": "https://stackoverflow.com/questions/41595672/populate-matrix-in-c-with-rand", "title": "Populate Matrix in C with rand()", "body": "<p>I am trying to understand how a Matrix in C works.</p>\n\n<p>I have the following code:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt; \n#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char* argv[])\n{\n\n    /* random number generator for matrix dimensions */\n    int xDim, yDim;\n    srand(time(NULL)); //init. is needed only once\n    xDim = (rand() % (10000+1) + 50);\n    yDim = (rand() % (10000+1) + 50);\n\n    /* random number generator for matrix contents */\n    double* myMatr;\n    myMatr = (double *)malloc(xDim * yDim * sizeof(double));\n    for(int i=0; i&lt;xDim; i++)\n    {\n        for(int y=0; y&lt;yDim; y++)\n        {\n            myMatr[i][y]= (double)rand()/RAND_MAX*100.0;\n        }\n    }\n}   \n</code></pre>\n\n<p>However, I am getting this error:</p>\n\n<pre><code>test.c:24:13: error: subscripted value is neither array nor pointer nor vector\nmyMatr[i][y]= (double)rand()/RAND_MAX*100.0;\n</code></pre>\n"}, {"tags": ["c", "dependencies", "llvm", "compiler-optimization"], "answers": [{"tags": [], "owner": {"reputation": 669, "user_id": 7406508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8vnaf.jpg?s=128&g=1", "display_name": "Jeandey Boris", "link": "https://stackoverflow.com/users/7406508/jeandey-boris"}, "is_accepted": false, "score": 0, "last_activity_date": 1484258504, "creation_date": 1484258504, "answer_id": 41623766, "question_id": 41595545, "link": "https://stackoverflow.com/questions/41595545/read-after-read-dependency-in-llvm-memory-dependence-analysis/41623766#41623766", "title": "Read after Read Dependency in LLVM Memory Dependence Analysis", "body": "<p>I've never used LLVM but based on your provided C code and LLVM IR, the <code>a</code> variable is read 2 times. I don't see any mistake. May I'm wrong?</p>\n\n<p><a href=\"https://i.stack.imgur.com/BeJKi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BeJKi.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 690, "user_id": 6661026, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/36f9bbecbbd034e86d0058d4f66140b2?s=128&d=identicon&r=PG&f=1", "display_name": "TheAhmad", "link": "https://stackoverflow.com/users/6661026/theahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 391, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484358682, "creation_date": 1484150984, "last_edit_date": 1484358682, "question_id": 41595545, "link": "https://stackoverflow.com/questions/41595545/read-after-read-dependency-in-llvm-memory-dependence-analysis", "title": "Read after Read Dependency in LLVM Memory Dependence Analysis", "body": "<p>In the figure below, on the left you can see the C code while the part on the right shows the unoptimized LLVM IR form of it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/nOoRa.png\" rel=\"nofollow noreferrer\">The Figure</a></p>\n\n<p>Running MemoryDependenceAnalysis on the IR finds the memory dependencies. One dependency is shown in both the original code and its IR equivalent using the arrow line.</p>\n\n<p>Here is the output of the analysis which includes the mentioned dependency:</p>\n\n<pre><code>Printing analysis 'Print MemDeps of function' for function 'main':\n    Def from:   %retval = alloca i32, align 4\n  store i32 0, i32* %retval, align 4\n\n    Def from:   %d = alloca i32, align 4\n  store i32 0, i32* %d, align 4\n\n    Def from:   %a = alloca i32, align 4\n  store i32 0, i32* %a, align 4\n\n    Def from:   store i32 0, i32* %a, align 4\n  %0 = load i32, i32* %a, align 4\n\n    Def from:   %b = alloca i32, align 4\n  store i32 %0, i32* %b, align 4\n\n    Def from:   %0 = load i32, i32* %a, align 4\n  %1 = load i32, i32* %a, align 4\n\n    Def from:   store i32 0, i32* %d, align 4\n  %2 = load i32, i32* %d, align 4\n\n    Def from:   %c = alloca i32, align 4\n  store i32 %add, i32* %c, align 4\n\n    Def from:   %2 = load i32, i32* %d, align 4\n  store i32 2, i32* %d, align 4\n</code></pre>\n\n<p>In the output from the analysis, we have:</p>\n\n<pre><code>Def from:   %0 = load i32, i32* %a, align 4\n  %1 = load i32, i32* %a, align 4\n</code></pre>\n\n<p>The variable <code>a</code> is read in both statements which is a RAR dependency. As is shown in the code snippet (LLVM-3.9.0 at lib/Analysis/MemoryDependenceAnalysis.cpp:549-551) LLVM considers these loads as defs of each other. What does that mean?</p>\n\n<pre><code>    // Must aliased loads are defs of each other.\n    if (R == MustAlias)\n      return MemDepResult::getDef(Inst);\n</code></pre>\n\n<p>Also, note that the analysis is performed on the IR, not on the C source.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "edited": false, "score": 0, "creation_date": 1484150461, "post_id": 41595260, "comment_id": 70393541, "body": "How exactly did you attempt to free the memory?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1484150466, "post_id": 41595260, "comment_id": 70393544, "body": "Where is the part that frees the content?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1484150548, "post_id": 41595260, "comment_id": 70393599, "body": "@LPs: You probably mean <code>strchr()</code>, don&#39;t you?"}, {"owner": {"reputation": 581, "user_id": 3552082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dbdf003b0668ef367a938584e5dbe2a6?s=128&d=identicon&r=PG", "display_name": "Romain-p", "link": "https://stackoverflow.com/users/3552082/romain-p"}, "edited": false, "score": 0, "creation_date": 1484150647, "post_id": 41595260, "comment_id": 70393669, "body": "I try to free each element from 0 to 3 in this example."}, {"owner": {"reputation": 581, "user_id": 3552082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dbdf003b0668ef367a938584e5dbe2a6?s=128&d=identicon&r=PG", "display_name": "Romain-p", "link": "https://stackoverflow.com/users/3552082/romain-p"}, "edited": false, "score": 0, "creation_date": 1484150676, "post_id": 41595260, "comment_id": 70393687, "body": "And i get : Aborted (Core drump)"}, {"owner": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "edited": false, "score": 2, "creation_date": 1484150678, "post_id": 41595260, "comment_id": 70393688, "body": "Well, I think you should be using just <code>free( content )</code> then. That&#39;s because you allocated it as a single block of memory (you called <code>malloc</code> just once)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1484150749, "post_id": 41595260, "comment_id": 70393744, "body": "You only have one allocated block of memory. Putting &#39;\\0&#39; at some places does not change anything. Only free first block <code>content [0]</code> and <code>content</code> itself."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1484150764, "post_id": 41595260, "comment_id": 70393755, "body": "@Gerhardh No I don&#39;t, but still wrong ;)  <a href=\"https://linux.die.net/man/3/strtok_r\" rel=\"nofollow noreferrer\">strok</a> to tokenize the string."}, {"owner": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1484150808, "post_id": 41595260, "comment_id": 70393788, "body": "@LPs You mean <code>strtok</code> ;)"}, {"owner": {"reputation": 581, "user_id": 3552082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dbdf003b0668ef367a938584e5dbe2a6?s=128&d=identicon&r=PG", "display_name": "Romain-p", "link": "https://stackoverflow.com/users/3552082/romain-p"}, "edited": false, "score": 1, "creation_date": 1484150853, "post_id": 41595260, "comment_id": 70393811, "body": "i dont need this, i wanna do it myself"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1484150855, "post_id": 41595260, "comment_id": 70393813, "body": "@LPs No, <code>strtok</code> is a bad idea as it changes the string. When the function is called the second time, it will not work any more."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1484150961, "post_id": 41595260, "comment_id": 70393902, "body": "@Gerhardh exacly what OP code is doing... ;)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1484151084, "post_id": 41595260, "comment_id": 70393979, "body": "@LPs: No. He first passes content==NULL and no memory is altered. In the second call content != NULL. If you uses strtok to find all the &#39;\\n&#39; this would already be done at the first call."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1484151102, "post_id": 41595260, "comment_id": 70393987, "body": "It seems to me that you are trying to free the &quot;substring&quot; you split, but you didn&#39;t really split them. You only stored pointers of chars inside a string. So you cannot free them as far as you don&#39;t strdup strings into your double pointer."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484152694, "post_id": 41595260, "comment_id": 70395018, "body": "<i>I try to free each element from 0 to 3 in this example.</i> It is not possible to release only part of the secured memory."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1484154575, "post_id": 41595260, "comment_id": 70396231, "body": "@Romain-p What is this code trying to do exactly?"}], "answers": [{"tags": [], "owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1484150762, "creation_date": 1484150762, "answer_id": 41595467, "question_id": 41595260, "link": "https://stackoverflow.com/questions/41595260/how-to-free-a-dynamically-allocated-string-divided-into-a-matrix/41595467#41595467", "title": "How to free a dynamically allocated string divided into a matrix?", "body": "<p>When you alloc() memory, the system keeps track of the size of the block you allocated - when freeing, the system frees the same amount was allocated.\nSo, if you use only one malloc(), you can free() only once - any pointer pointing into the area now freed, gets invalidated.</p>\n\n<p>Hence, you need a free() for \"str\", and a free() for \"content\". After freeing str, all the pointers in \"content\" get invalid, but you must free \"content\" itself. Or, free \"content\" first and \"str\" later.</p>\n"}, {"comments": [{"owner": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "edited": false, "score": 0, "creation_date": 1484150909, "post_id": 41595512, "comment_id": 70393855, "body": "Or allocate it once, and free it once - that&#39;s simpler"}, {"owner": {"reputation": 581, "user_id": 3552082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dbdf003b0668ef367a938584e5dbe2a6?s=128&d=identicon&r=PG", "display_name": "Romain-p", "link": "https://stackoverflow.com/users/3552082/romain-p"}, "edited": false, "score": 0, "creation_date": 1484150913, "post_id": 41595512, "comment_id": 70393860, "body": "hm no you didn&#39;t understand my way"}], "tags": [], "owner": {"reputation": 1, "user_id": 7405565, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8WK0hlU6D2Q/AAAAAAAAAAI/AAAAAAAAAFM/mtwyIwHV9Ds/photo.jpg?sz=128", "display_name": "Viko Lan", "link": "https://stackoverflow.com/users/7405565/viko-lan"}, "is_accepted": false, "score": 0, "last_activity_date": 1484150917, "last_edit_date": 1484150917, "creation_date": 1484150880, "answer_id": 41595512, "question_id": 41595260, "link": "https://stackoverflow.com/questions/41595260/how-to-free-a-dynamically-allocated-string-divided-into-a-matrix/41595512#41595512", "title": "How to free a dynamically allocated string divided into a matrix?", "body": "<p>You have to malloc each of these words. 1 free == 1 malloc. Please paste the code where u try to free</p>\n"}], "owner": {"reputation": 581, "user_id": 3552082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dbdf003b0668ef367a938584e5dbe2a6?s=128&d=identicon&r=PG", "display_name": "Romain-p", "link": "https://stackoverflow.com/users/3552082/romain-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1484150917, "creation_date": 1484150112, "last_edit_date": 1484150187, "question_id": 41595260, "link": "https://stackoverflow.com/questions/41595260/how-to-free-a-dynamically-allocated-string-divided-into-a-matrix", "title": "How to free a dynamically allocated string divided into a matrix?", "body": "<p>I have a malloced char *str.</p>\n\n<pre><code>char *str = strdup(\"first\\nsecond\\nthird\\nfourth\");\n</code></pre>\n\n<p>I have a matrix char **content.</p>\n\n<pre><code>char **content;\n</code></pre>\n\n<p>My objective is to cut str replacing '\\n' by '\\0' and put each first address after every '\\0' in my matrix in order. The following code works:</p>\n\n<pre><code>int      count_lines(char *str, char **content)\n{\n  int    len;\n\n  if (content)\n    content[0] = str;\n  len = 0;\n  while (str &amp;&amp; *(str++))\n    {\n      if (*str &amp;&amp; *(str - 1) == '\\n')\n        {\n          len++;\n          if (content)\n            {\n              *(str - 1) = 0;\n              content[len] = str;\n            }\n        }\n    }\n  if (content)\n    content[len + 1] = 0;\n  return (len + 1);\n}\n\nvoid   test()\n{\n  char **content;\n  int  lines;\n\n  lines = count_lines(str, NULL);\n  content = malloc(sizeof(char *) * (lines + 1));\n  count_lines(str, content);\n}\n</code></pre>\n\n<blockquote>\n  <p>Then, content[0] contains \"first\", contant[1] contains \"second\" and\n  [contant[2] contains \"third\" and contant[3] contains \"fourth\".</p>\n</blockquote>\n\n<p>Now my problem is the following one: I got an error when I try to free from the first address. I dont know if what I do brokes the memory or idk.. Help please, how to free this if possible.</p>\n"}, {"tags": ["c", "networking", "network-programming"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484149625, "post_id": 41595060, "comment_id": 70392981, "body": "Port forwarding is a router feature. Pretty much like nothing to do with either of the tags."}, {"owner": {"reputation": 329, "user_id": 1483023, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/h3sYS.png?s=128&g=1", "display_name": "Gabriel kotev", "link": "https://stackoverflow.com/users/1483023/gabriel-kotev"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484149693, "post_id": 41595060, "comment_id": 70393025, "body": "Yes, but is there something that can be done to prevent users to manually do it ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484149798, "post_id": 41595060, "comment_id": 70393109, "body": "If your user is a &quot;server&quot;, no. Nothing can be done. Servers behind a router/firewall have to be configured properly by the server administrator, otherwise it will be a security hole."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1484150249, "post_id": 41595060, "comment_id": 70393406, "body": "I&#39;m not an expert on this matter: can UPnP be useful? Crystal that this open security matters..."}], "owner": {"reputation": 329, "user_id": 1483023, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/h3sYS.png?s=128&g=1", "display_name": "Gabriel kotev", "link": "https://stackoverflow.com/users/1483023/gabriel-kotev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484149485, "creation_date": 1484149485, "question_id": 41595060, "link": "https://stackoverflow.com/questions/41595060/mobile-game-p2p-port-forwarding", "title": "Mobile game p2p port-forwarding", "body": "<p>I am trying to create a mobile P2P game with network library written in c (enet/libuv).\nI have read in some forum that there is risk of blocked port by the router and I need to do something called port-forwarding.\nMost of the topic related are for console games and I'm trying to do mobile game, which theoretically should be the same.</p>\n\n<p>Sorry for my noob question but,  will it be a big issue for my game and how can I fix this problem (without using any third-party help) ? </p>\n\n<p>Many thanks for the help.</p>\n"}, {"tags": ["java", "c"], "comments": [{"owner": {"reputation": 21161, "user_id": 1788806, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0ca4c6bc08e59c34de7fc39e09de8dbe?s=128&d=identicon&r=PG", "display_name": "Willi Mentzel", "link": "https://stackoverflow.com/users/1788806/willi-mentzel"}, "edited": false, "score": 0, "creation_date": 1484156104, "post_id": 41595039, "comment_id": 70397195, "body": "it would truly help others if you would create a minimal example of this code which reproduces the problem and then create an answer to your own question (and not post it as edit in your question). if you would do that, have my upvotes for both the question and the answer."}], "answers": [{"tags": [], "owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "is_accepted": true, "score": 1, "last_activity_date": 1484156304, "creation_date": 1484156304, "answer_id": 41597276, "question_id": 41595039, "link": "https://stackoverflow.com/questions/41595039/java-client-only-receives-first-response-from-c-server/41597276#41597276", "title": "Java client only receives first response from C server", "body": "<p>You have to add the enline character, but if you had use the printWriter instead then you could use the <strong>println</strong> method...</p>\n\n<pre><code>PrintWriter pw =  new PrintWriter(socket.getOutputStream(), true);\npw.println(\"Bla bla\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 5025869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204849158970741/picture?type=large", "display_name": "Daniel Holub&#225;\u0159", "link": "https://stackoverflow.com/users/5025869/daniel-holub%c3%a1%c5%99"}, "is_accepted": false, "score": 0, "last_activity_date": 1484157538, "creation_date": 1484157538, "answer_id": 41597626, "question_id": 41595039, "link": "https://stackoverflow.com/questions/41595039/java-client-only-receives-first-response-from-c-server/41597626#41597626", "title": "Java client only receives first response from C server", "body": "<p>So the answer is simple. If you are using OutputStreamWritter you have to add newline character to your message.</p>\n"}], "owner": {"reputation": 55, "user_id": 5025869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204849158970741/picture?type=large", "display_name": "Daniel Holub&#225;\u0159", "link": "https://stackoverflow.com/users/5025869/daniel-holub%c3%a1%c5%99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 41597276, "answer_count": 2, "score": 1, "last_activity_date": 1484157538, "creation_date": 1484149427, "last_edit_date": 1484157441, "question_id": 41595039, "link": "https://stackoverflow.com/questions/41595039/java-client-only-receives-first-response-from-c-server", "title": "Java client only receives first response from C server", "body": "<p>I am creating a simple game which consists of Java client and C server. When client sends first request to server, it is ok. The server sends response and client reads it. But when client send second request, the server sends response like always but client reads nothing. When I delete \\n from response, clinet is stuck on readLine() which is ok, but when I place \\n back, readLine() reads nothing. I am pretty desperate and I tryied variety of actions and changed the message from server like 1000 times but nothing works.</p>\n\n<p>Here is connection method:</p>\n\n<pre><code>public int connect() {\n    try {\n        if (port != 0 &amp;&amp; !host.equals(null)) {\n            socket = new Socket(host, port);\n            socket.setSoTimeout(5000);\n            socket.setKeepAlive(true);\n        } else {\n            socket = new Socket(\"localhost\", 50001);\n        }\n\n        out = new OutputStreamWriter(socket.getOutputStream());\n        in = new BufferedReader(new InputStreamReader(socket.getInputStream()));\n\n    } catch (UnknownHostException ex1) {\n        System.out.println(\"Unknown host: \" + host);\n        return 1;\n    } catch (IOException ex2) {\n        System.out.println(\"No I/O: \" + ex2.getMessage());\n        return 2;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Here are methods for comunication:</p>\n\n<pre><code>public String listRooms() throws DisconnectedException, IOException {\n    this.send(LIST_ROOMS);\n\n    String data = this.receive();\n    System.out.println(\"Action: \" + LIST_ROOMS + \" Result: \" + data);\n\n    return data;        \n}\n\npublic int createRoom(String playerName) throws IOException, DisconnectedException {\n    this.send(playerName, CREATE_ROOM);\n\n    int result = this.receiveInt();\n    System.out.println(\"Action: \" + CREATE_ROOM + \" Result: \" + result);\n    return result;\n}\n\npublic void joinRoom(String playerName, int number) throws IOException, DisconnectedException {\n\n    String message = number + \"\\0\" + playerName;\n\n    this.send(message, JOIN_ROOM);\n\n    try {\n        System.out.println(\"Action: \" + JOIN_ROOM + \" Result: \" + this.receive());\n    } catch (SocketTimeoutException e) {\n        throw new DisconnectedException(\"Connection with server lost...\");\n    }\n}\n\nprivate void send(String message, int actionNumber) throws IOException {\n    out.write((char) actionNumber);\n    out.write(message);\n    out.flush();\n}\n\nprivate void send(int actionNumber) throws IOException {\n    out.write((char) actionNumber);\n    out.flush();\n}\n\nprivate int receiveInt() throws IOException {\n    int response = in.read();\n    System.out.println(response);\n\n\n    return 0;\n}\n\nprivate String receive() throws IOException {\n    String answer = in.readLine();\n\n    System.out.println(\"ANSWER: \" + answer);        \n\n    if (answer == null) {\n        System.out.println(\"You recieved nothing Jon Snow...\");\n    } else if (\"0\".equals(answer)) {\n        System.out.println(\"Error recieveing answer from server\");\n        return \"0\";\n    }\n\n    return answer;\n}\n</code></pre>\n\n<p>and here is server:</p>\n\n<pre><code>#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;unistd.h&gt;\n\n#include \"room.h\"\n\nvoid error_message(const char *msg);\n\ntypedef struct thread_args\n{\n    int client_sock;\n    char ip_address[16];\n} thread_args;\n\n\nvoid *thread_service(void *args)\n{\n    int client_sock;\n    char buffer[256] = \"\";\n    char cbuf;\n    int n;\n    char address[16] = \"\";\n    int result = 0;\n    room *room = NULL;\n\n\n    client_sock = ((thread_args *) args)-&gt;client_sock;\n    strcpy(address, ((thread_args *) args)-&gt;ip_address);\n\n    pthread_detach(pthread_self());\n\n    while(1)\n    {\n        if ((recv(client_sock, &amp;cbuf, 1, 0)) == -1)\n        {\n            printf(\"Receive message from %s failure\\n\", address);\n            break;\n        }\n\n        switch (cbuf) {\n            case 0:\n                result = create_room(&amp;room, client_sock);\n\n                if(!result)\n                {\n                    /* TODO */\n                }\n                memset(buffer, 0, 256);\n                sprintf(buffer, \"%d\\n\", result);\n\n                n = send(client_sock, buffer, 256, 0);\n\n                if (n &lt;= 0) {\n                  perror(\"ERROR writing to socket\\n\");\n                  close(client_sock);\n                  break;\n                }\n                printf(\"sent\\n\");\n                break;\n            case 1:\n                result = join_room(&amp;room, client_sock);\n                if(!result)\n                {\n                    /* TODO */\n                }\n\n                printf(\"Join to room for %s\\n\", address);\n                sprintf(buffer, \"%d\\n\", result);\n                n = send(client_sock, buffer, 256, 0);\n\n                if (n &lt;= 0) {\n                  perror(\"ERROR writing to socket\\n\");\n                  break;\n                }\n\n                break;\n            case 2:\n                printf(\"List rooms\\n\");\n                memset(buffer, 0, 256);\n                result = list_rooms(buffer);\n\n                if(!result) {\n                    /* TODO */\n                }\n\n                printf(\"Sending message: %s\", buffer);\n                n = send(client_sock, buffer, 256, 0);\n\n                if (n &lt;= 0) {\n                  perror(\"ERROR writing to socket\\n\");\n                  close(client_sock);\n                  break;\n                }\n                printf(\"Sent\\n\");\n                break;\n            case 5:\n                exit(0);\n                break;\n        }\n\n    }\n    close(client_sock);\n    free(args);\n    return 0;\n}\n\nint main(int argc, char *argv[])\n{\nint sock_fd = 0, new_sock_fd = 0, port = 0, clilen = 0;\nstruct sockaddr_in serv_addr, cli_addr;\nint *th_socket;\npthread_t thread_id;\nthread_args *args = (thread_args *)malloc(sizeof(thread_args));\nchar address[16];\nint yes = 1;\n\nif(argc &lt; 2)\n{\n    fprintf(stderr, \"Error missing port\");\n    return 0;\n}\n\nsock_fd = socket(AF_INET, SOCK_STREAM, 0);\n\nif(sock_fd &lt; 0)\n    fprintf(stderr, \"Error opening socket\");\n\nmemset(&amp;serv_addr, 0, sizeof(serv_addr));\n\nport = atoi(argv[1]);\n\nserv_addr.sin_family = AF_INET;\nserv_addr.sin_port = htons(port);\nserv_addr.sin_addr.s_addr = INADDR_ANY;\n\nif (setsockopt(sock_fd, SOL_SOCKET, SO_REUSEADDR, &amp;yes, sizeof(int)) == 0)\n{\n    printf(\"Socket options was set.\\n\"); //TODO\n}\nelse\n{\n    printf(\"Set socket options failure.\\n\"); //TODO\n}\n\nif(bind(sock_fd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr)) &lt; 0)\n    error_message(\"Error in connection\");\n\nlisten(sock_fd, 5);\n\nif (pthread_mutex_init(&amp;lock, NULL) != 0)\n{\n    printf(\"Mutex init failed.\\n\");\n    return 1;\n}\n\nwhile(1)\n{\n    printf(\"Waiting for new connection\\n\");\n    clilen = sizeof(cli_addr);\n    new_sock_fd = accept(sock_fd, (struct sockaddr *)&amp;cli_addr, &amp;clilen);\n\n    if (new_sock_fd &lt; 0) {\n        printf(\"Error accepting new connection!\\n\");\n        continue;\n    }\n\n    strcpy(args-&gt;ip_address, inet_ntoa(cli_addr.sin_addr));\n    args-&gt;client_sock = new_sock_fd;\n\n    if (new_sock_fd &gt; 0 ) {\n        th_socket=malloc(sizeof(int));\n        *th_socket=new_sock_fd;\n\n        printf(\"Creating new thread for %s\\n\", args-&gt;ip_address);\n        pthread_create(&amp;thread_id, NULL, (void *)&amp;thread_service, (void *)args);\n    } else {\n        printf(\"Error creating thread for new connection.\\n\");\n        return -1;\n    }\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>So if you want to send C servera message, it will look like this:</p>\n\n<pre><code>String message = \"Hello world!\";\n\nOutputStreamWriter out = new OutputStreamWriter(socket.getOutputStream());\nout.write(message + \"\\n\");\nout.flush();\n</code></pre>\n\n<p><strong>UPDATE</strong>: A have figured that out, it was pretty nasty fault, maybe it would help others.. In message from JAVA client to server must be (in my case) manually appended \"\\n\" character, otherwise it sends some characters that will confuse the server. so my code looks like this <code>out.write(message + \"\\n\");</code> and then just call flush() and it will be ok.</p>\n"}, {"tags": ["c", "data-structures", "linked-list", "cygwin"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1100264"}, "edited": false, "score": 1, "creation_date": 1484149134, "post_id": 41594544, "comment_id": 70392677, "body": "&quot;It&quot; crashes? Please elaborate. Also it would be easy to single step through the code when max size is reached. Did you try that?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484149797, "post_id": 41594544, "comment_id": 70393108, "body": "Linked list seldom means fixed size; ring buffer does mean fixed size. It&#39;s a puzzling combo."}, {"owner": {"reputation": 23, "user_id": 7297726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8379f6727b4c75b008afc8f34000c975?s=128&d=identicon&r=PG&f=1", "display_name": "Tropical", "link": "https://stackoverflow.com/users/7297726/tropical"}, "edited": false, "score": 0, "creation_date": 1484162008, "post_id": 41594544, "comment_id": 70400470, "body": "@Peter when it enters the if  p_size==5 condition it just crashes, I used the cygwin debugger and it does not give me any information as seen in the image attached!"}], "answers": [{"tags": [], "owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "is_accepted": false, "score": 0, "last_activity_date": 1484228408, "creation_date": 1484228408, "answer_id": 41614711, "question_id": 41594544, "link": "https://stackoverflow.com/questions/41594544/char-linked-list-with-buffer-ring-in-c/41614711#41614711", "title": "Char Linked list with Buffer Ring in C", "body": "<p>When looking on the <code>push_item()</code> function for the problem located in case of <code>if(p_size==5)</code>, the error is when writing data of the node to be removed.</p>\n\n<p><strong>Error 1</strong> - temporary <code>itemVal</code> and <code>itemKey</code> are declared as <code>char *</code> but never allocated to an array.</p>\n\n<pre><code>// To do\nstrcpy(itemVal,(*Front)-&gt;value);\nstrcpy(itemKey,(*Front)-&gt;key);\n// or\nstrcpy(itemVal,new_node-&gt;value);\nstrcpy(itemKey,new_node-&gt;key);\n</code></pre>\n\n<blockquote>\n  <p>Both <code>char *itemVal;</code> and <code>char *itemKey;</code> shall be allocated.</p>\n</blockquote>\n\n<pre><code>// Local variables (STR_SIZE has to be adjusted)\nchar itemVal[STR_SIZE+1];\nchar itemKey[STR_SIZE+1];\n</code></pre>\n\n<p><strong>Warning 1</strong> - but solving that issue will reveal a malfunction in the Ring Buffer algorithm when using linked-list.</p>\n\n<blockquote>\n  <p>In the <code>push_item()</code> function, the writing/push pointer <code>*Front</code> and\n  the reading/pop pointer <code>*Rear</code> are managed independently. When the\n  Ring Buffer is full (<code>if(p_size==5)</code>) the new item is deleted instead\n  of the oldest one.</p>\n</blockquote>\n"}], "owner": {"reputation": 23, "user_id": 7297726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8379f6727b4c75b008afc8f34000c975?s=128&d=identicon&r=PG&f=1", "display_name": "Tropical", "link": "https://stackoverflow.com/users/7297726/tropical"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484228408, "creation_date": 1484147984, "last_edit_date": 1484161855, "question_id": 41594544, "link": "https://stackoverflow.com/questions/41594544/char-linked-list-with-buffer-ring-in-c", "title": "Char Linked list with Buffer Ring in C", "body": "<p>I have a server and a client. The client can send request like ADD to list by entering ADD:Joe:2 it should add to list. Key = Joe Value =2.</p>\n\n<p>I'm trying to ADD a key:value into a linked list that uses a buffer ring of max 5 elements. When the linked list reaches the max size of elements(5) and a new key:value is entered, the oldest element is overwritten with the new element.</p>\n\n<p>Every time I adding it seems to add fine, but when the max size is reached and tries to delete the first KEY:VALUE it crashes.</p>\n\n<p>Add to LIST:</p>\n\n<pre><code> void push_item(struct item** Front,struct item** Rear,char *new_key,char *new_value,int newsockfd)\n    {\n        char buffer [50] = {0};\n\n            struct item* new_node = malloc(sizeof(struct item));\n            strcpy(new_node-&gt;value,new_value);\n            strcpy(new_node-&gt;key,new_key);\n            //new_node-&gt;next = NULL;\n            if(p_size==5)\n            {\n\n\n                char *itemVal;\n                char *itemKey;\n                /* if queue is empty */\n                if ( *Front == NULL )\n                {\n                    printf ( \"List is empty\");\n                }\n                else\n                {\n                    if (*Front == *Rear)\n                    {\n                        strcpy(itemVal,(*Front)-&gt;value);\n                        strcpy(itemKey,(*Front)-&gt;key);\n                        free(*Front);\n                        *Front = NULL ;\n                        *Rear = NULL ;\n                    }\n                    else\n                    {\n                        //delete node\n                        new_node = *Front;\n                        strcpy(itemVal,new_node-&gt;value);\n                        strcpy(itemKey,new_node-&gt;key);\n                        *Front=(*Front)-&gt;next;\n                        (*Rear)-&gt;next=*Front;\n                        free(new_node);\n                    }\n                    printf(\"Node deleted Key: %s Value: %s\",itemKey,itemVal);\n                }\n            }\n            else\n            {\n                *Rear=new_node;\n                (*Rear)-&gt;next=new_node;\n\n                if(*Front==NULL)\n                {\n                    (*Front)=new_node;\n                    p_size++;\n                }\n                else\n                {\n                    (*Rear)-&gt;next=new_node;\n                    p_size++;\n                    printf(\"Elements in List: %d\\n\",p_size);\n                }\n\n            }\n\n            sprintf(buffer,\"Added\");\n            int num_bytes = write(newsockfd, buffer, strlen(buffer));\n            if (num_bytes &lt; 0) \n            {\n                fprintf(stderr, \"Thread ERROR: write() failed\\n\");\n            }\n}\n</code></pre>\n\n<p>Server:</p>\n\n<pre><code>struct item *Front = NULL;\nstruct item *Rear = NULL;\nchar buffer[BUFFER_SIZE] = {0};\n\nvoid* handle_client(void *socket)\n{\n    int newsockfd = (int)socket;\n    pthread_t thread_id = pthread_self();\n\n    printf(\"----------\\nThread %lu using socket %x\\n\", (unsigned long)thread_id, newsockfd);\n\n    /* Start communicating */\n    int num_bytes = read(newsockfd, buffer, BUFFER_SIZE-1);\n    if (num_bytes &lt; 0) {\n        fprintf(stderr, \"Thread %lu ERROR: read() failed\\n\", (unsigned long)thread_id);\n        return NULL;\n    }\n    printf(\"Thread %lu recieved request\\n\", (unsigned long)thread_id);\n\n    if(strncmp(buffer,\"ADD\",3)==0)\n    {\n        char* key = buffer+4;\n        int charIndex;\n        char *new_value = strchr(buffer+4 , ':')+1;\n        charIndex = (int)(new_value-buffer)-1;\n        buffer[charIndex] = '\\0';\n\n        push_item(&amp;Front,&amp;Rear,key,new_value,newsockfd);\n\n        printf(\"Value:%s Key:%s\\n\",new_value,key);\n    }\n</code></pre>\n\n<p><strong>EDIT:</strong>\nImages of CMD :\n<a href=\"https://i.stack.imgur.com/nDgm4.jpg\" rel=\"nofollow noreferrer\">Left cmd is the client and the right one is the server</a></p>\n\n<p>The p_size represents the current number of elements in the linked list.\nIt Crashes  after it enters the if condition P_size == 5.</p>\n"}, {"tags": ["c", "windows", "pipe", "named"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1484148066, "post_id": 41594511, "comment_id": 70391996, "body": "Do you mean, it uses _un_named pipes? That&#39;s what I would expect when <code>STDIN&#47;STDOUT</code> is used."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1484181263, "post_id": 41594511, "comment_id": 70408966, "body": "I can&#39;t find any documentation to confirm this, but based on how the FastCGI protocol works over TCP/IP I would expect that the handle you&#39;ve been given is to the <i>server</i> end of the named pipe.  (My previous comment, now deleted, assumed that it was the client end; my mistake.)  So instead of closing the handle, you want to call DisconnectNamedPipe followed by ConnectNamedPipe (which will block until a new request is ready)."}, {"owner": {"reputation": 21, "user_id": 7405204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e83a85f59477179186babb555d8da01?s=128&d=identicon&r=PG&f=1", "display_name": "user7405204", "link": "https://stackoverflow.com/users/7405204/user7405204"}, "edited": false, "score": 0, "creation_date": 1484864103, "post_id": 41594511, "comment_id": 70697919, "body": "Harry, thanks for that. I do believe I need to use those NamedPipe functions. I&#39;ve been pouring through the source for mod_fcgi which includes the libfcgi.dll that people can use to include in their apps. I see it using the ConnectNamedPipe and DisconnectNamedPipe, As well it&#39;s using some IOCompletion that I don&#39;t really understand what it is used for, but I believe your right about the NamedPipe calls. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7405204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e83a85f59477179186babb555d8da01?s=128&d=identicon&r=PG&f=1", "display_name": "user7405204", "link": "https://stackoverflow.com/users/7405204/user7405204"}, "is_accepted": true, "score": 1, "last_activity_date": 1485107572, "creation_date": 1485107572, "answer_id": 41794246, "question_id": 41594511, "link": "https://stackoverflow.com/questions/41594511/mod-fcgid-windows-named-pipes-2nd-and-subsequent-requests/41794246#41794246", "title": "mod_fcgid windows named pipes 2nd and subsequent requests", "body": "<p>Harry, your comment on using the NamedPipe functions did the trick, I needed to use FileFlushBuffers followed by a DisconnectNamedPipe at the end of the first request, and then a ConnectNamedPipe to wait for the next request to come in. Thank you again.</p>\n"}], "owner": {"reputation": 21, "user_id": 7405204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e83a85f59477179186babb555d8da01?s=128&d=identicon&r=PG&f=1", "display_name": "user7405204", "link": "https://stackoverflow.com/users/7405204/user7405204"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "accepted_answer_id": 41794246, "answer_count": 1, "score": 1, "last_activity_date": 1485107572, "creation_date": 1484147878, "question_id": 41594511, "link": "https://stackoverflow.com/questions/41594511/mod-fcgid-windows-named-pipes-2nd-and-subsequent-requests", "title": "mod_fcgid windows named pipes 2nd and subsequent requests", "body": "<p>All, I'm building a fastCGI interface for a programming language which is run-time based, and runs in Windows, Linux and UNIX environments.</p>\n\n<p>I've implemented the fastCGI protocol within program code that runs within that run-time but I'm having an issue with Windows code which talks to mod_fcgid. In this case I cannot use prebuilt dll's to expose fastCGI functions, but I can make calls to most C functions from within that runtime language. I cannot modify the runtime as it belongs to another company... Think of it as being a php or perl like language. What I'm trying to do is similar to creating a dll like set of code (its not a dll) to process a fastCGI request. While many would say I'm \"re-inventing the wheel\" here, I have no choice of using someone's prebuilt dll to provide the interface to fastCGI.</p>\n\n<p>I've successfully implemented everything and I can get the initial request, and respond back with a web page thru my fastCGI interface. The problem I am having is dealing with the \"next\" request when running under Windows. My code when running under Linux works terrific, I accept() the socket, read() write() to do my processing, close() the socket, and then go back and accept() again, and I get the next request and everything processes perfectly.</p>\n\n<p>Under Windows mod_fcgid uses named pipes. Within my code I use GetStdHandle() to get a handle to stdin, then use ReadFile() and WriteFile() and the data wrapped in the fastCGI protocol goes to mod_fcgid and then on to the browser when done with a request I use CloseHandle() and then am looping back to GetStdHandle() to wait for the next request.</p>\n\n<p>Everything works perfectly for the first request, the browser gets my cgi output. The same code under Linux using sockets, gets the 2nd and subsequent requests and works like a charm.</p>\n\n<p>My issues is: when running under Windows, after I process the first request, I cannot get mod_fcgid to send me a second request. It will end up killing my windows process and starts a new one in its place. Which of course is not what I want.</p>\n\n<p>I must being doing something wrong between the time I send the fastCGI EndRequest and when I loop around to wait for the next request to come in.</p>\n\n<p>To get the initial request from mod_fcgid, I use GetStdHandle() then I use ReadFile() and WriteFile() (all from kernel32.dll) and when I've finished the protocol with its EndRequest, I cannot get the code right to be able to receive a second request.</p>\n\n<p>I've tried fflush() I've tried FileFlushBuffers(), I've tried not closing the handle I was given from GetStdHandle(), I simply cannot figure out what mod_fcgid needs from my windows app so that I can receive the second and subsequent requests.</p>\n\n<p>After the first request, closing my handle, getting a handle to stdin from GetStdHandle, and then sitting on ReadFile, The ReadFile() comes back with 0 bytes, and GetLastError() always returns 6 (Invalid Handle).</p>\n\n<p>I simply cannot figure out the C functions to use to cleanup after the first request is complete and to be able to wait for the next request to come in when running under Windows. As I've said before the code works perfect under Linux when using sockets instead of Windows which is using a handle from STDIN that is a named pipe.</p>\n"}, {"tags": ["c", "windows", "mpi", "distributed-computing", "simd"], "comments": [{"owner": {"reputation": 5713, "user_id": 639771, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/yLDsC.jpg?s=128&g=1", "display_name": "Clint", "link": "https://stackoverflow.com/users/639771/clint"}, "edited": false, "score": 1, "creation_date": 1484147837, "post_id": 41594438, "comment_id": 70391831, "body": "What have you tried already? What research have you done yourself, and what partial conclusions have you drawn? What specifically about the research you&#39;ve done so far has led you to seeking outside opinions on the &quot;correct&quot; approach to take?"}, {"owner": {"reputation": 63, "user_id": 1108876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120158d4fc696570e1bada1136a8fe5d?s=128&d=identicon&r=PG", "display_name": "aknet", "link": "https://stackoverflow.com/users/1108876/aknet"}, "reply_to_user": {"reputation": 5713, "user_id": 639771, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/yLDsC.jpg?s=128&g=1", "display_name": "Clint", "link": "https://stackoverflow.com/users/639771/clint"}, "edited": false, "score": 0, "creation_date": 1484207576, "post_id": 41594438, "comment_id": 70417129, "body": "@Clint I tried MPICH(3.2) on Linux with two hosts(virtual machines), MS-MPI(7.1) on Windows 10 with one host(with the second host i still have some issues with smpd manager). I cannot use Linux because it&#39;s impossible to switch the end users from Windows to Linux, so i have to stick with Windows. I&#39;m new in parallel and distributed computing and still searching, if you have something in your mind from your experience to recommend me, it will save me days of research."}], "owner": {"reputation": 63, "user_id": 1108876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120158d4fc696570e1bada1136a8fe5d?s=128&d=identicon&r=PG", "display_name": "aknet", "link": "https://stackoverflow.com/users/1108876/aknet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484150179, "creation_date": 1484147688, "last_edit_date": 1484150179, "question_id": 41594438, "link": "https://stackoverflow.com/questions/41594438/simd-program-with-mpi-on-a-windows-network", "title": "SIMD program with MPI on a Windows network", "body": "<p>I have a network of computers(approximately 20), which has <strong>MS Windows</strong>(7, 10, Server 2008, Server 2012) installed on them.\n<br>\nAll the computers have different <strong>hardware specs</strong>(different number of CPU cores) and are used by <strong>many users</strong> but in the <strong>same domain</strong>.\n<br><br>\nI have a program which calculates a formula(lets say the square root of a number) of some thousands/millions numbers and saves them on a database.\n<br>\nI need to <strong>distribute portions</strong> of these millions of numbers to the available CPU cores on the network.\n<br>\nSomething like this:\n<br></p>\n\n<pre><code>int p, rank;\nMPI_Comm_size(MPI_COMM_WORLD, &amp;p);\nMPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\nint dsize = 1000000;\nint part = dsize / p;\nint bpart = part + (dsize%p);\nif(rank==0)\n{\n    for(int i=1;i&lt;p;i++)\n    {\n        int start = bpart+(i-1)*part;\n        int stop = start+part;\n        //SEND PORTION\n        for (int s=start; s&lt;stop;s++)\n        {\n            MPI_Send(...);\n        }\n    }\n    CalcFormula(PORTION_OF_RANK0);\n}//if rank0\nelse\n{\n    //RECEIVE PORTION\n    MPI_Recv(...);\n    CalcFormula(PORTION_OF_RANKi);\n}//else rank!=0\n</code></pre>\n\n<p><br>\nWhat <strong>libraries</strong>(MSMPI, Open MPI, MPICH) and what <strong>software</strong> do you suggest me to use for an <strong><em>easy implementation</em></strong>?\n<br></p>\n"}, {"tags": ["c", "input", "output", "scanf"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 3, "creation_date": 1484147143, "post_id": 41594181, "comment_id": 70391383, "body": "<code>scanf()</code> leaves a <code>&#39;\\n&#39;</code> behind in the input stream, and the <code>getchar()</code> is discarding it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1100264"}, "edited": false, "score": 0, "creation_date": 1484149445, "post_id": 41594181, "comment_id": 70392884, "body": "while (getchar() != EOF);  getchar();"}], "owner": {"reputation": 9, "user_id": 7405264, "user_type": "registered", "profile_image": "https://graph.facebook.com/1824583144447201/picture?type=large", "display_name": "Ruiqian Yao", "link": "https://stackoverflow.com/users/7405264/ruiqian-yao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "closed_date": 1484148104, "answer_count": 0, "score": 0, "last_activity_date": 1487889153, "creation_date": 1484147003, "last_edit_date": 1487889153, "question_id": 41594181, "link": "https://stackoverflow.com/questions/41594181/getchar-ignored-in-c", "closed_reason": "Duplicate", "title": "getchar() ignored in C", "body": "<p>I have the following code about input and output in C.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    int this_is_a_number;\n    printf(\"Please enter a number: \");\n    scanf(\"%d\", &amp;this_is_a_number);\n    printf(\"You entered %d\\n\", this_is_a_number);\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>When I entered a number, the console displays \"You have entered NUM\" and just exit. My question is what does the getchar() do? (shouldn't the program wait for me to enter something and hit enter before it exits?). Thank you in advance!</p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1484165847, "post_id": 41593922, "comment_id": 70402622, "body": "It should be a pointer to type that have enough capacity to keep an unsigned int."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1484166034, "post_id": 41593922, "comment_id": 70402732, "body": "By the way, can you find similar examples (<code>ar1335.c::read_reg()</code>) in upstream kernel?"}, {"owner": {"reputation": 21, "user_id": 3388460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddfbc1dabbc5b8a591ea2bdff2f2e3a4?s=128&d=identicon&r=PG&f=1", "display_name": "Bram", "link": "https://stackoverflow.com/users/3388460/bram"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1484228273, "post_id": 41593922, "comment_id": 70430416, "body": "I checked a few cases with 8 or 16 bit val_bits settings, and they all seem to follow [1], so using an intermediate unsigned int value.  Eg: <a href=\"http://lxr.free-electrons.com/source/drivers/staging/iio/light/isl29018.c#L644\" rel=\"nofollow noreferrer\">lxr.free-electrons.com/source/drivers/staging/iio/light/&hellip;</a>   (8bit) <a href=\"http://lxr.free-electrons.com/source/sound/soc/codecs/wm8904.c?v=3.14\" rel=\"nofollow noreferrer\">lxr.free-electrons.com/source/sound/soc/codecs/wm8904.c?v=3.&zwnj;&#8203;14</a>            (16bit)  So maybe the ar1335 is just wrong then .... ? (i still think it is a bad idea to use unsigned int instead of uint32/uint64 as a type in this API though)"}, {"owner": {"reputation": 21, "user_id": 3388460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddfbc1dabbc5b8a591ea2bdff2f2e3a4?s=128&d=identicon&r=PG&f=1", "display_name": "Bram", "link": "https://stackoverflow.com/users/3388460/bram"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1484228741, "post_id": 41593922, "comment_id": 70430748, "body": "Anyway as soon as my driver shows signs of life :) i will check empirically."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1484239661, "post_id": 41593922, "comment_id": 70438669, "body": "Better just to think about a bit more. And think why it&#39;s done this way in the first place."}], "owner": {"reputation": 21, "user_id": 3388460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddfbc1dabbc5b8a591ea2bdff2f2e3a4?s=128&d=identicon&r=PG&f=1", "display_name": "Bram", "link": "https://stackoverflow.com/users/3388460/bram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 618, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484146185, "creation_date": 1484146185, "question_id": 41593922, "link": "https://stackoverflow.com/questions/41593922/what-should-be-the-type-of-the-regmap-read-val-pointer", "title": "What should be the type of the regmap_read val pointer", "body": "<p>I am trying to use the regmap api for accessing an I2C device and it is totally unclear what the expected type is of the val pointer.</p>\n\n<p>Cfr : int regmap_read(struct regmap *map, unsigned int reg, unsigned int *val)</p>\n\n<p>The 2 options I see are (both are bad btw imho): </p>\n\n<p>[1] It is really suppose to be a pointer to an unsigned int type and you have to use an intermediate variable when reading it.  Since you do not know what bitsize and unsigned int type will be, you can never be sure that it will hold 32 bits.</p>\n\n<p>[2] It is suppose to be a pointer to a type that corresponds to what you passed in val_bits in the regmap_config (and you have to incorrectly recast that pointer to the type  to what to API expects to make it compilable).</p>\n\n<p>The documentation is not helpful at all (surprise):</p>\n\n<pre><code>/**\n...\n* @val: Pointer to store read value\n...\n*/\n</code></pre>\n\n<p>Things like <a href=\"https://patchwork.kernel.org/patch/9378201/\" rel=\"nofollow noreferrer\">https://patchwork.kernel.org/patch/9378201/</a> seems to suggest that it is [1], \nbut i see other drivers which i assume work that do [2] eg:</p>\n\n<pre><code>static inline int\nar1335_read_reg(struct ar1335_info *info, u16 addr, u16 *val)\n{\n    return regmap_read(info-&gt;regmap, addr, (unsigned int *) val);\n}\n</code></pre>\n\n<p>(<a href=\"https://github.com/Bogdacutu/STLinux-Kernel/blob/master/drivers/media/platform/tegra/ar1335.c\" rel=\"nofollow noreferrer\">https://github.com/Bogdacutu/STLinux-Kernel/blob/master/drivers/media/platform/tegra/ar1335.c</a>)</p>\n\n<p>If i try to follow the functions that (i think, it is full abstractions and more abstractions) are actually assigned to the read i think i end up at </p>\n\n<pre><code>static int regmap_i2c_read(void *context,\n                       const void *reg, size_t reg_size,\n                       void *val, size_t val_size)\n{\n    struct device *dev = context;\n    struct i2c_client *i2c = to_i2c_client(dev);\n    struct i2c_msg xfer[2];\n    int ret;\n\n    xfer[0].addr = i2c-&gt;addr;\n    xfer[0].flags = 0;\n    xfer[0].len = reg_size;\n    xfer[0].buf = (void *)reg;\n\n    xfer[1].addr = i2c-&gt;addr;\n    xfer[1].flags = I2C_M_RD;\n    xfer[1].len = val_size;\n    xfer[1].buf = val;\n\n    ret = i2c_transfer(i2c-&gt;adapter, xfer, 2);\n    if (ret == 2)\n            return 0;\n    else if (ret &lt; 0)\n            return ret;\n    else\n            return -EIO;\n}\n</code></pre>\n\n<p>which would suggest that it has to be a pointer to the real data type, so eg u16 * in case val_bits = 16. </p>\n\n<p>Anyone any insights ?\nIf it is [2] why not use a void * pointer to avoid the ugly casts like in the i2c read ? Historical mess ?</p>\n\n<p>Thanks,</p>\n\n<p>Bram </p>\n"}, {"tags": ["python", "c", "python-3.x", "ctypes"], "comments": [{"owner": {"reputation": 4318, "user_id": 681870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efd42a5f2e0cec71c5b93f0113273213?s=128&d=identicon&r=PG", "display_name": "J. P. Petersen", "link": "https://stackoverflow.com/users/681870/j-p-petersen"}, "edited": false, "score": 0, "creation_date": 1484213067, "post_id": 41593872, "comment_id": 70420222, "body": "Code looks ok and it worked for me. Strange. And <code>g</code> is not a null pointer?"}], "answers": [{"comments": [{"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 1, "creation_date": 1484360128, "post_id": 41613097, "comment_id": 70491876, "body": "In addition, use <code>libc.strstr.argtypes = c_char_p,c_char_p</code> and just call with <code>g = libc.strstr(b&#39;abc&#39;,b&#39;bc&#39;)</code>.  You only need to <code>create_string_buffer</code> to create a writable buffer.  <code>strstr</code> takes const char pointers, so it&#39;s not needed."}], "tags": [], "owner": {"reputation": 2634, "user_id": 5138909, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/qBvCy.png?s=128&g=1", "display_name": "KiYugadgeter", "link": "https://stackoverflow.com/users/5138909/kiyugadgeter"}, "is_accepted": true, "score": 1, "last_activity_date": 1484223574, "creation_date": 1484223574, "answer_id": 41613097, "question_id": 41593872, "link": "https://stackoverflow.com/questions/41593872/how-i-can-c-char-p-value-get-as-a-bytes-in-python3-ctypes/41613097#41613097", "title": "How I can c_char_p value get as a bytes in python3 ctypes?", "body": "<p>I found an answer of the question myself.</p>\n\n<p>According to official Python ctypes documentation, called C function return the integer by default.</p>\n\n<p>So When before calling C function, specify the type of return value with <code>restype</code> attribute.</p>\n\n<p>correct code example:</p>\n\n<pre><code>from ctypes import *\n\nlibc = cdll.LoadLibrary(\"libSystem.B.dylib\")\ns1 = create_string_buffer(b\"abc\") # create a null terminated string buffer\ns2 = create_string_buffer(b\"bc\")  # same at above\n\n\nlibc.strstr.restype = c_char_p # specify the type of return value  \n\ng = libc.strstr(s1, s2)  # execute strstr (this function return character pointer)\nprint(g) # =&gt; b\"bc\"      (g is bytes object.)\n</code></pre>\n"}], "owner": {"reputation": 2634, "user_id": 5138909, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/qBvCy.png?s=128&g=1", "display_name": "KiYugadgeter", "link": "https://stackoverflow.com/users/5138909/kiyugadgeter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1536, "favorite_count": 0, "accepted_answer_id": 41613097, "answer_count": 1, "score": 2, "last_activity_date": 1484223574, "creation_date": 1484146058, "question_id": 41593872, "link": "https://stackoverflow.com/questions/41593872/how-i-can-c-char-p-value-get-as-a-bytes-in-python3-ctypes", "title": "How I can c_char_p value get as a bytes in python3 ctypes?", "body": "<p>I have a question about ctypes in python3.</p>\n\n<p>I am trying to get a c_char_p as a python bytes object.<br>\nThe following code is trying to get its value as a python3 bytes object.</p>\n\n<p>How to get its value as bytes object?</p>\n\n<pre><code>from ctypes import *\n\nlibc = cdll.LoadLibrary(\"libSystem.B.dylib\")\ns1 = create_string_buffer(b\"abc\") # create a null terminated string buffer\ns2 = create_string_buffer(b\"bc\")  # same at above\n\n\ng = libc.strstr(s1, s2)  # execute strstr (this function return character pointer)\nprint(g) # print the returned value as integer\nmatched_point = c_char_p(g) # cast to char_p\nprint(matched_point.value) # trying to getting value as bytes object (cause segmentation fault here)\n</code></pre>\n"}, {"tags": ["c++", "c", "memory", "malloc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1484146155, "post_id": 41593858, "comment_id": 70390720, "body": "3149454400 floats is a <b>bit</b> too much for a stack-allocated array..."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1484146195, "post_id": 41593858, "comment_id": 70390747, "body": "One reason might be that the allocated memory has to be contiguous. If there is no such large block available then the allocation will fail."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1484146257, "post_id": 41593858, "comment_id": 70390781, "body": "As for the problem with the array, remember that most compilers puts their local variables on the stack, and the stack is quite limited (the default process stack size on Linux is 8MB)."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1484146258, "post_id": 41593858, "comment_id": 70390783, "body": "What is your platform? linux 64-bit?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1484146353, "post_id": 41593858, "comment_id": 70390864, "body": "Also, regarding the array, it&#39;s not an allocation in the same way that <code>malloc</code> does it. It is the compiler that handles it, and it sets the size at the time of compilation (C and C++ can differ here!). An array can <i>never</i> be <code>NULL</code>."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1484146697, "post_id": 41593858, "comment_id": 70391101, "body": "One thing I noticed is you&#39;re using <code>int i</code> in your calculation. Try casting those like this maybe <code>(size_t)i * i * sizeof float</code>"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1484146733, "post_id": 41593858, "comment_id": 70391137, "body": "I meant <code>num</code> instead of <code>i</code>"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 2, "creation_date": 1484148998, "post_id": 41593858, "comment_id": 70392592, "body": "You really should remove the C tag, seeing as how you use <code>std::cout</code> and <code>std::endl</code>. This then of course bears the question why you use <code>malloc</code> in the first place, and why <code>NULL</code> instead of <code>nullptr</code>, and why you declare variables before using them."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1484154068, "post_id": 41593858, "comment_id": 70395880, "body": "@ZanLynx Casting is not needed here as in <code>(size_t)i * i * sizeof float</code>.  <a href=\"http://stackoverflow.com/a/41595104/2410359\">Reversing</a> the order accomplishes the needed widening.  <code>sizeof (float) * i * i </code>.  At least that stops the UB of <code>int</code> overflow."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 7116, "user_id": 5083516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2aeeefc1a95ddb2f19612150ccd7ba?s=128&d=identicon&r=PG&f=1", "display_name": "plugwash", "link": "https://stackoverflow.com/users/5083516/plugwash"}, "edited": false, "score": 0, "creation_date": 1484157902, "post_id": 41593858, "comment_id": 70398271, "body": "@plugwash: It&#39;s the same problem but with a different number of bits."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1484147039, "post_id": 41593968, "comment_id": 70391324, "body": "@Stargateur Of course. It would move it from the automatic storage into the static storage. Still not a very good idea though... The startup code will have to set the whole array to zeros, which might be a bit time-consuming."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 1, "creation_date": 1484148381, "post_id": 41593968, "comment_id": 70392197, "body": "Going slightly off topic here, but most mainstream OS&#39;s would <i>probably</i> actually manage this being a very large array in static storage without being very time consuming - they either share a &#39;zero page&#39; or have a supply of &#39;already zero&#39;d pages&#39; or only allocate a zero page when accessed. Still probably not a great idea though - large allocations should always be on the heap."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1484148793, "post_id": 41593968, "comment_id": 70392471, "body": "It&#39;s also not what the OP is doing - 3x10^9 is the result of the multiplication, but the overflow is resulting in a very different request"}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 2, "last_activity_date": 1484146358, "creation_date": 1484146358, "answer_id": 41593968, "question_id": 41593858, "link": "https://stackoverflow.com/questions/41593858/why-does-malloc-fail-when-there-is-enough-memory/41593968#41593968", "title": "Why does malloc() fail when there is enough memory?", "body": "<p><code>float ls[3149454400];</code> is an array with automatic storage type, which is usually allocated on the process stack. A process stack is limited by default by a value <em>much</em> smaller than 12GB you are attempting to push there. So the <em>segmentation fault</em> you are observing is caused by the stack overflow, rather than by the <code>malloc</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484150540, "post_id": 41594029, "comment_id": 70393594, "body": "Note that with 32-bit <code>size_t</code> and using <code>size_t num = 56120;</code>, <code>(num * num)*sizeof(float)</code> is still a problem.  That product overflows 32-bit math."}], "tags": [], "owner": {"reputation": 107, "user_id": 7308775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5754f639744d2f97c5fc09b75d61530c?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas", "link": "https://stackoverflow.com/users/7308775/kostas"}, "is_accepted": false, "score": 6, "last_activity_date": 1484146564, "creation_date": 1484146564, "answer_id": 41594029, "question_id": 41593858, "link": "https://stackoverflow.com/questions/41593858/why-does-malloc-fail-when-there-is-enough-memory/41594029#41594029", "title": "Why does malloc() fail when there is enough memory?", "body": "<p>This is in contrast to what others have written, but for me, changing the variable num to size_t from int allows allocation. It could be that num*num overflows the int for malloc. Doing malloc with 56120 * 56120 instead of num*num should throw an overflow error.</p>\n"}, {"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 5, "creation_date": 1484146700, "post_id": 41594035, "comment_id": 70391103, "body": "num should be <code>size_t</code> not <code>long long</code> or even <code>unsigned int</code>."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1484146863, "post_id": 41594035, "comment_id": 70391216, "body": "@Stargateur actually, any type that is large enough to hold the number will do just fine.  A long, or even unsigned int which can hold a number that size will work."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 5, "creation_date": 1484146959, "post_id": 41594035, "comment_id": 70391275, "body": "@UKMonkey <code>malloc()</code> take a <code>size_t</code>, use a <code>size_t</code>. Don&#39;t mix type or you will have problem like this question..."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1484147094, "post_id": 41594035, "comment_id": 70391353, "body": "@Stargateur That depends on the use case, we don&#39;t really know what <code>num</code> means in this context. Imagine it means something like &#39;the number of dimensions I&#39;m doing my calculation in&#39; then that&#39;s not a good reason to make it a <code>size_t</code>. Yes, it is used in an expression which will eventually lead to a <code>size_t</code> as memory for those dimension is allocated, but in general you dont propagate types backwards like that and make <code>num</code> a <code>size_t</code>."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1484147477, "post_id": 41594035, "comment_id": 70391618, "body": "@MikeVine If <code>num</code> represent the size of the array, yes it should be <code>size_t</code>. Or the OP need to cast it properly. Here you say &quot;use a long long&quot; but what if the value don&#39;t fit in a <code>long long</code> next time? You propose to change the type of <code>num</code> why don&#39;t use the proper type?"}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1484147966, "post_id": 41594035, "comment_id": 70391937, "body": "@Stargateur Semantically, <code>num</code> should be whatever it properly represents. What if we also had a later line which went <code>float angle = (1&#47;num) * 360.0f;</code>. This has a very similar problem. Would you also fix this by saying &#39;num should be a float&#39;? In which case it needs to be a float AND a size_t... The only way round this is by properly casting to the right type <i>at the point of use</i> and having its local type be semantically whatever makes sense no matter what its use case is later."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1484148697, "post_id": 41594035, "comment_id": 70392404, "body": "@Stargateur you almost certainly mix types all the time without knowing it.  unsigned int x = 5 for example mixes types."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1484154635, "post_id": 41594035, "comment_id": 70396263, "body": "@UKMonkey &quot;any type that is large enough to hold the number will do just fine.&quot; is true yet considering <code>long</code>  or <code>unsigned int</code> for a memory size calculation is not using the best type available, which is <code>size_t</code> as that is the type <code>malloc()</code> receives.  <a href=\"http://stackoverflow.com/a/41595104/2410359\">Code can check memory requirements</a> using just <code>size_t</code> and the type of <code>num</code>.  No need to introduce another type."}], "tags": [], "owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "is_accepted": false, "score": 7, "last_activity_date": 1484146582, "creation_date": 1484146582, "answer_id": 41594035, "question_id": 41593858, "link": "https://stackoverflow.com/questions/41593858/why-does-malloc-fail-when-there-is-enough-memory/41594035#41594035", "title": "Why does malloc() fail when there is enough memory?", "body": "<pre><code>int num = 56120,i,j;\nls = (float *)malloc((num * num)*sizeof(float));\n</code></pre>\n\n<p><code>num</code> * <code>num</code> is <code>56120*56120</code> which is <code>3149454400</code> which overflows a <code>signed int</code> which causes undefined behavoir.</p>\n\n<p>The reason 40000 works is that 40000*40000 is representable as an int.</p>\n\n<p>Change the type of <code>num</code> to <code>long long</code> (or even <code>unsigned int</code>)</p>\n"}, {"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 10, "creation_date": 1484146647, "post_id": 41594041, "comment_id": 70391065, "body": "num should be <code>size_t</code> not <code>long</code>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1484146712, "post_id": 41594041, "comment_id": 70391121, "body": "@Stargateur Why should it be? <code>num</code> is not a size itself, so <code>size_t</code> seems inappropriate"}, {"owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 0, "creation_date": 1484146867, "post_id": 41594041, "comment_id": 70391219, "body": "Even after using <code>long</code>, it fails : <a href=\"http://code.geeksforgeeks.org/gkj53M\" rel=\"nofollow noreferrer\">code.geeksforgeeks.org/gkj53M</a>"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484146880, "post_id": 41594041, "comment_id": 70391226, "body": "@Ctx That&#39;s what malloc is defined like. <code>size_t</code> will correspond to one of the unsigned integer types of the platform and is defined as the type of the result of the <code>sizeof</code>   operator. The beauty is that code written that way is platform independent.  <code>size_t</code>  may be defined as <code>unsigned int</code> or <code>unsigned long</code> or even <code>unsigned long long</code> depending on the <code>int</code> and address size. Of course you can use the native type, but the code may fail (as we see) on other platforms."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 7, "creation_date": 1484146909, "post_id": 41594041, "comment_id": 70391238, "body": "@Ctx <code>malloc()</code> take a <code>size_t</code>, use a <code>size_t</code>."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 0, "creation_date": 1484146917, "post_id": 41594041, "comment_id": 70391247, "body": "@SauravSahu The site there probably has imposed some limits on how much memory a program may use there"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1484146994, "post_id": 41594041, "comment_id": 70391301, "body": "@Stargateur I still disagree, you could cast the result of <code>(num * num) * sizeof(float)</code> to <code>size_t</code> inside the malloc, but this is unnecessary."}, {"owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 0, "creation_date": 1484147021, "post_id": 41594041, "comment_id": 70391315, "body": "Do you know any website where there is no limit imposed? Please let me know."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 1, "creation_date": 1484147121, "post_id": 41594041, "comment_id": 70391371, "body": "@SauravSahu I would be surprised if there was one... Just try it locally on a machine with sufficient RAM."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1484147187, "post_id": 41594041, "comment_id": 70391414, "body": "@Ctx If you cast the result it will fail, you must cast <code>num</code> not the result. use cast only when you can&#39;t do something else. And when you do you have to <b>verify</b> that you can. Here <code>num</code> must be positive and inferior to <code>SIZE_MAX</code>."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1484147268, "post_id": 41594041, "comment_id": 70391485, "body": "@Stargateur I meant &quot;leave num as long and cast the result&quot;. num is semantically <i>not</i> a <code>size_t</code> in this program, so declaring it as one is outright misleading and wrong in my eyes."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484147309, "post_id": 41594041, "comment_id": 70391517, "body": "@PeterA.Schneider what are you trying to say? I know this command. ulimit for data segment is unlimited by default on linux, btw."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484147412, "post_id": 41594041, "comment_id": 70391585, "body": "@Ctx I thought you were not aware of it since you said &quot; I would be surprised if there was one [a limit on memory usage]... Just try it locally on a machine with sufficient RAM.&quot; On a properly managed server with more than one user I&#39;d actually be amazed <i>if there were no limits.</i>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484147539, "post_id": 41594041, "comment_id": 70391655, "body": "@PeterA.Schneider Yes, on a shared server with many users there should be such a limit, I agree. But it&#39;s not default on a vanilla linux installation."}, {"owner": {"reputation": 1521, "user_id": 5005808, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/008c946eaae26038155b08097603f230?s=128&d=identicon&r=PG&f=1", "display_name": "pfc", "link": "https://stackoverflow.com/users/5005808/pfc"}, "edited": false, "score": 0, "creation_date": 1484149295, "post_id": 41594041, "comment_id": 70392789, "body": "Oh yes. This is the right solution. I change the type of <code>num</code> to <code>long</code> and everything becomes correct. Thank you so much!"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 5, "creation_date": 1484150559, "post_id": 41594041, "comment_id": 70393607, "body": "@Ctx <i>Use the data type <code>long</code> for <code>num</code></i>  and <i>you could cast the result of <code>(num * num) * sizeof(float)</code> to <code>size_t</code></i> Try that on Windows, where <code>long</code> is still a 32-bit <i>signed</i> value even for 64-bit applications.  Still nasty."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1484150810, "post_id": 41594041, "comment_id": 70393789, "body": "@AndrewHenle Well, you will always find a combination of &quot;value of num&quot;, &quot;datatype&quot; and &quot;platform&quot; which will fail in this context."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1484150955, "post_id": 41594041, "comment_id": 70393897, "body": "@Ctx Which is <i>why</i> such things as <code>size_t</code> exist.  You still should check for overflow, though."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1484151113, "post_id": 41594041, "comment_id": 70393994, "body": "@AndrewHenle It is definitively the wrong way to declare all variables as size_t which could somehow be part of a calculation for a malloc size. Imagine using a formula based on argc. <code>int main (size_t argc, char **argv)</code>?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1484151218, "post_id": 41594041, "comment_id": 70394062, "body": "@Ctx <i>It is definitively the wrong way to declare all variables as <code>size_t</code> which could somehow be part of a calculation for a malloc size. Imagine using a formula based on argc. <code>int main (size_t argc, char **argv)</code>?</i>  That&#39;s an irrelevant <a href=\"https://en.wikipedia.org/wiki/Straw_man\" rel=\"nofollow noreferrer\">strawman</a>."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1484153297, "post_id": 41594041, "comment_id": 70395376, "body": "@AndrewHenle I am sorry, but the definition of &quot;Strawman&quot; you linked is not appropriate for this situation at all. Please do not try to cover your lack of reasoning with such unfair methods. Thank you."}, {"owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 1, "creation_date": 1484155557, "post_id": 41594041, "comment_id": 70396850, "body": "@Ctx I think Andrew&#39;s point is that, when facing the need to allocate memory, the type <code>size_t</code> is explicitly defined to avoid these sorts of issues.  You could do a platform-specific approach, true.  Alternatively, you could use <code>size_t</code> and get the correct result on all platforms, including future ones!  Even if you don&#39;t declare the variables as <code>size_t</code>, you should be doing your math in that type."}, {"owner": {"reputation": 1060, "user_id": 1941945, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cc3358da4e76cedadb381c2fd32f3e45?s=128&d=identicon&r=PG", "display_name": "Kahler", "link": "https://stackoverflow.com/users/1941945/kahler"}, "edited": false, "score": 0, "creation_date": 1484155678, "post_id": 41594041, "comment_id": 70396937, "body": "Time to move to chat? I won&#39;t edit the answer to <code>size_t</code> due to the arguing, but it would improve it."}, {"owner": {"reputation": 7116, "user_id": 5083516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2aeeefc1a95ddb2f19612150ccd7ba?s=128&d=identicon&r=PG&f=1", "display_name": "plugwash", "link": "https://stackoverflow.com/users/5083516/plugwash"}, "edited": false, "score": 1, "creation_date": 1484155790, "post_id": 41594041, "comment_id": 70397002, "body": "Using &quot;long&quot; in C is generally the wrong answer, if you want something of a fixed size use one of the C99 fixed size types. If you want something that represents the maximum size of a single allocation use size_t."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 0, "creation_date": 1484156184, "post_id": 41594041, "comment_id": 70397254, "body": "@CortAmmon Yes, casting it to size_t in the calculation itself would also be an appropriate option. If this is what we all can live with, I will edit the answer to this."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1484158230, "post_id": 41594041, "comment_id": 70398424, "body": "@Ctx: <code>num</code> is semantically unsigned. It is meaningless to make it negative. Making it a <code>size_t</code> would make a lot of sense."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 22, "last_activity_date": 1484156212, "last_edit_date": 1484156212, "creation_date": 1484146604, "answer_id": 41594041, "question_id": 41593858, "link": "https://stackoverflow.com/questions/41593858/why-does-malloc-fail-when-there-is-enough-memory/41594041#41594041", "title": "Why does malloc() fail when there is enough memory?", "body": "<p>The problem is, that your calculation</p>\n\n<pre><code>(num * num) * sizeof(float)\n</code></pre>\n\n<p>is done as 32-bit signed integer calculation and the result for num=56120 is</p>\n\n<pre><code>-4582051584\n</code></pre>\n\n<p>Which is then interpreted for size_t with a very huge value</p>\n\n<pre><code>18446744069127500032\n</code></pre>\n\n<p>You do not have so much memory ;) This is the reason why <code>malloc()</code> fails.</p>\n\n<p>Cast <code>num</code> to <code>size_t</code> in the calculation of malloc, then it should work as expected.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 10, "last_activity_date": 1484150029, "last_edit_date": 1484150029, "creation_date": 1484149602, "answer_id": 41595104, "question_id": 41593858, "link": "https://stackoverflow.com/questions/41593858/why-does-malloc-fail-when-there-is-enough-memory/41595104#41595104", "title": "Why does malloc() fail when there is enough memory?", "body": "<p>As other have pointed out, <code>56120*56120</code> overflows <code>int</code> math on OP's platform.  That is undefined behavior (UB).</p>\n\n<p><code>malloc(size_t x)</code> takes a <code>size_t</code> argument and the values passed to it is best calculated using at least <code>size_t</code> math.  By reversing the multiplication order, this is accomplished.  <code>sizeof(float) * num</code> cause <code>num</code> to be widened to at least <code>size_t</code> before the multiplication.</p>\n\n<pre><code>int num = 56120,i,j;\n// ls = (float *)malloc((num * num)*sizeof(float));\nls = (float *) malloc(sizeof(float) * num * num);\n</code></pre>\n\n<p>Even though this prevents UB, This does not prevent overflow as mathematically  <code>sizeof(float)*56120*56120</code> may still exceed <code>SIZE_MAX</code>.</p>\n\n<p>Code could detect potential overflow beforehand.</p>\n\n<pre><code>if (num &lt; 0 || SIZE_MAX/sizeof(float)/num &lt; num) Handle_Error();\n</code></pre>\n\n<p>No need to cast the result of <code>malloc()</code>.<br>\nUsing the size of the referenced variable is easier to code and maintain than sizing to the type.<br>\nWhen <code>num == 0</code>, <code>malloc(0) == NULL</code> is not necessarily an out-of-memory.<br>\nAll together:</p>\n\n<pre><code>int num = 56120;\nif (num &lt; 0 || ((num &gt; 0) &amp;&amp; SIZE_MAX/(sizeof *ls)/num &lt; num)) {\n  Handle_Error();\n}\nls = malloc(sizeof *ls * num * num);\nif (ls == NULL &amp;&amp; num != 0) {\n  Handle_OOM();\n}\n</code></pre>\n"}], "owner": {"reputation": 1521, "user_id": 5005808, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/008c946eaae26038155b08097603f230?s=128&d=identicon&r=PG&f=1", "display_name": "pfc", "link": "https://stackoverflow.com/users/5005808/pfc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4568, "favorite_count": 1, "accepted_answer_id": 41594041, "answer_count": 5, "score": 15, "last_activity_date": 1484193506, "creation_date": 1484146028, "last_edit_date": 1484156332, "question_id": 41593858, "link": "https://stackoverflow.com/questions/41593858/why-does-malloc-fail-when-there-is-enough-memory", "title": "Why does malloc() fail when there is enough memory?", "body": "<p>I'm using a server with 128GB memory to do some computation. I need to <code>malloc()</code> a 2D float array of size 56120 * 56120. An example code is as follows:</p>\n\n<pre><code>int main(int argc, char const *argv[])\n{\n    float *ls;\n    int num = 56120,i,j;\n    ls = (float *)malloc((num * num)*sizeof(float));\n    if(ls == NULL){\n        cout &lt;&lt; \"malloc failed !!!\" &lt;&lt; endl;\n        while(1);\n    }\n    cout &lt;&lt; \"malloc succeeded ~~~\" &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>The code compiles successfully but when I run it, it says <code>\"malloc failed !!!\"</code>. As I calculated, it only takes about 11GB of memory to hold the whole array. Before I started the code, I checked the server and there was 110GB of free memory available. Why does the error happen?</p>\n\n<p>I also found that if I reduce <code>num</code> to, say 40000, then the malloc will succeed.</p>\n\n<p>Does this mean that there is a limit on the maximum memory that can be allocated by <code>malloc()</code>?</p>\n\n<p>Moreover, if I change the way of allocation, directly declaring a 2D float array of such size, as follows:</p>\n\n<pre><code>int main(int argc, char const *argv[])\n{\n    int num = 56120,i,j;\n    float ls[3149454400];\n    if(ls == NULL){\n        cout &lt;&lt; \"malloc failed !!!\" &lt;&lt; endl;\n        while(1);\n    }\n    cout &lt;&lt; \"malloc succeeded ~~~\" &lt;&lt; endl;\n    for(i = num - 10 ; i &lt; num; i ++){\n        for( j = num - 10; j &lt; num ; j++){\n            ls[i*num + j] = 1;\n        }\n    }\n    for(i = num - 11 ; i &lt; num; i ++){\n        for( j = num - 11; j &lt; num ; j++){\n            cout &lt;&lt; ls[i*num + j] &lt;&lt; endl;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>then I compile and run it. I get a <code>\"Segmentation fault\"</code>.</p>\n\n<p>How can I solve this?</p>\n"}, {"tags": ["c", "buffer", "zlib", "deflate", "inflate"], "answers": [{"tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": true, "score": 1, "last_activity_date": 1484147491, "last_edit_date": 1592644375, "creation_date": 1484147491, "answer_id": 41594360, "question_id": 41593841, "link": "https://stackoverflow.com/questions/41593841/what-is-the-minimum-maximum-input-size-for-deflate-or-inflate-in-zlib/41594360#41594360", "title": "What is the minimum/maximum input size for deflate() or inflate() in zlib?", "body": "<p>The minimum buffer size is 0. Regarding the maximum size, see the <a href=\"http://www.zlib.net/zlib_faq.html\" rel=\"nofollow noreferrer\">zlib FAQ</a>:</p>\n<blockquote>\n<p><em>Can zlib work with greater than 4 GB of data?</em></p>\n<p>Yes. <code>inflate()</code> and <code>deflate()</code> will process any amount of data correctly. Each call of <code>inflate()</code> or <code>deflate()</code> is limited to input and output chunks of the maximum value that can be stored in the compiler's &quot;unsigned int&quot; type, but there is no limit to the number of chunks. Note however that the <code>strm.total_in</code> and <code>strm_total_out</code> counters may be limited to 4 GB. These counters are provided as a convenience and are not used internally by <code>inflate()</code> or <code>deflate()</code>. The application can easily set up its own counters updated after each call of <code>inflate()</code> or <code>deflate()</code> to count beyond 4 GB.</p>\n</blockquote>\n"}], "owner": {"reputation": 141, "user_id": 7368428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nc4Lt.jpg?s=128&g=1", "display_name": "gl393", "link": "https://stackoverflow.com/users/7368428/gl393"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 759, "favorite_count": 0, "accepted_answer_id": 41594360, "answer_count": 1, "score": 0, "last_activity_date": 1484147491, "creation_date": 1484145975, "question_id": 41593841, "link": "https://stackoverflow.com/questions/41593841/what-is-the-minimum-maximum-input-size-for-deflate-or-inflate-in-zlib", "title": "What is the minimum/maximum input size for deflate() or inflate() in zlib?", "body": "<p>When using <code>zlib</code>, what is the minimum and maximum input buffer size that can handle <code>deflate()</code> and <code>inflate()</code> ?</p>\n"}, {"tags": ["c", "printf", "precision"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7174257, "user_type": "registered", "profile_image": "https://graph.facebook.com/1809336919308964/picture?type=large", "display_name": "Chris Prolls", "link": "https://stackoverflow.com/users/7174257/chris-prolls"}, "edited": false, "score": 0, "creation_date": 1484144883, "post_id": 41593292, "comment_id": 70389832, "body": "I already tried this, but it doesn&#39;t works very well, if I test with digits = 29 I got this output :      1.2345678899999998900938180668"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "reply_to_user": {"reputation": 69, "user_id": 7174257, "user_type": "registered", "profile_image": "https://graph.facebook.com/1809336919308964/picture?type=large", "display_name": "Chris Prolls", "link": "https://stackoverflow.com/users/7174257/chris-prolls"}, "edited": false, "score": 3, "creation_date": 1484145515, "post_id": 41593292, "comment_id": 70390260, "body": "@ChrisProlls that is because the exact number is <code>0.12345678899999999733605449137030518613755702972412109375</code>. This is the nearest <code>double</code> number to <code>0.123456789</code>."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1484145708, "post_id": 41593292, "comment_id": 70390381, "body": "@ChrisProlls-- also note that a <code>double</code> does not have 29 digits of precision."}, {"owner": {"reputation": 69, "user_id": 7174257, "user_type": "registered", "profile_image": "https://graph.facebook.com/1809336919308964/picture?type=large", "display_name": "Chris Prolls", "link": "https://stackoverflow.com/users/7174257/chris-prolls"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1484146506, "post_id": 41593292, "comment_id": 70390964, "body": "@DavidBowling I know, but I don&#39;t want to let any bug or usable breach, this why I asked if it&#39;s possible to print the float with a maximum precision, without add more digits than the float have."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1484146707, "post_id": 41593292, "comment_id": 70391113, "body": "I thought that you asked to &quot;print a double with a variable float precision.&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 69, "user_id": 7174257, "user_type": "registered", "profile_image": "https://graph.facebook.com/1809336919308964/picture?type=large", "display_name": "Chris Prolls", "link": "https://stackoverflow.com/users/7174257/chris-prolls"}, "edited": false, "score": 3, "creation_date": 1484150973, "post_id": 41593292, "comment_id": 70393913, "body": "@ChrisProlls Little need to print a <code>double</code> with more than <code>DBL_DECIMAL_DIG</code> (typically 17) significant digits.  <a href=\"http://stackoverflow.com/q/16839658/2410359\">Ref</a>."}, {"owner": {"reputation": 69, "user_id": 7174257, "user_type": "registered", "profile_image": "https://graph.facebook.com/1809336919308964/picture?type=large", "display_name": "Chris Prolls", "link": "https://stackoverflow.com/users/7174257/chris-prolls"}, "edited": false, "score": 0, "creation_date": 1538130626, "post_id": 41593292, "comment_id": 92045506, "body": "I wasn&#39;t aware of some behaviours that float and double shares. Here is a good document to understand floating point precision in computer programming, that every beginner should read &gt; <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">link</a>"}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 4, "last_activity_date": 1484144366, "creation_date": 1484144366, "answer_id": 41593292, "question_id": 41593232, "link": "https://stackoverflow.com/questions/41593232/force-printf-to-display-a-determined-number-of-digits-and-remove-remaining-0s/41593292#41593292", "title": "Force printf to display a determined number of digits and remove remaining 0s", "body": "<p>You need to use <code>%g</code> instead of <code>%f</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int digits = 4;\n    printf(\"%0.*g\\n\", digits, 0.123456789);\n    printf(\"%0.*g\\n\", digits, 5.9);\n\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0.1235 \n5.9\n</code></pre>\n\n<p><kbd><a href=\"http://ideone.com/csf8lD\" rel=\"nofollow noreferrer\">LIVE DEMO</a></kbd></p>\n"}], "owner": {"reputation": 69, "user_id": 7174257, "user_type": "registered", "profile_image": "https://graph.facebook.com/1809336919308964/picture?type=large", "display_name": "Chris Prolls", "link": "https://stackoverflow.com/users/7174257/chris-prolls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "closed_date": 1484144535, "accepted_answer_id": 41593292, "answer_count": 1, "score": -1, "last_activity_date": 1538130263, "creation_date": 1484144214, "last_edit_date": 1538130263, "question_id": 41593232, "link": "https://stackoverflow.com/questions/41593232/force-printf-to-display-a-determined-number-of-digits-and-remove-remaining-0s", "closed_reason": "Duplicate", "title": "Force printf to display a determined number of digits and remove remaining 0s", "body": "<p>I don't figure out how to tell printf to print a double with a variable precision.</p>\n\n<p>Where is what I actually do :</p>\n\n<pre><code>int main(void)\n{\n    int digits = 4;\n\n    printf(\"%0.*f\\n\", digits, 0.123456789);\n    printf(\"%0.*f\\n\", digits, 5.9);\n\n    return (0);\n}\n</code></pre>\n\n<p>I actually have the variable precision with the * and the digits variable, but it still prints remaining 0 after the last number.</p>\n\n<p>In order to illustrate my problem, here is what i get :</p>\n\n<pre><code>0.1234\n5.9000\n</code></pre>\n\n<p>And here is what i want :</p>\n\n<pre><code>0.1234\n5.9\n</code></pre>\n\n<p>Could you help me please?</p>\n"}, {"tags": ["c", "linux", "windows", "cross-platform"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1484144230, "post_id": 41593212, "comment_id": 70389374, "body": "If wine is istalled you can run exe file on Linux"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4108694"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484144273, "post_id": 41593212, "comment_id": 70389421, "body": "@Slava no wine is installed."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484144308, "post_id": 41593212, "comment_id": 70389446, "body": "Then no luck, and I afraid you will get a lot of -1 for &quot;generalized wrapper&quot;"}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1484144311, "post_id": 41593212, "comment_id": 70389450, "body": "The simple and short answer is &quot;No&quot;, then."}, {"owner": {"reputation": 27011, "user_id": 1490355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/296f0478cb1b6724e3f862ace601fa99?s=128&d=identicon&r=PG", "display_name": "SingerOfTheFall", "link": "https://stackoverflow.com/users/1490355/singerofthefall"}, "edited": false, "score": 0, "creation_date": 1484144320, "post_id": 41593212, "comment_id": 70389458, "body": "How would you imagine it to work if the executable file format is different on different OS?"}, {"owner": {"reputation": 1136, "user_id": 2999921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0564f700a2fe14bc0aa8152a5b97925?s=128&d=identicon&r=PG", "display_name": "cwschmidt", "link": "https://stackoverflow.com/users/2999921/cwschmidt"}, "edited": false, "score": 0, "creation_date": 1484144324, "post_id": 41593212, "comment_id": 70389462, "body": "No, you can&#39;t run the very same binary on different platforms."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4108694"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484144378, "post_id": 41593212, "comment_id": 70389488, "body": "@Slava I just wanted to be sure. If the community don&#39;t accept this question then I&#39;ll respect it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4108694"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1484144450, "post_id": 41593212, "comment_id": 70389533, "body": "@A.S.H good point. I&#39;ll be more careful in the next time."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1484144451, "post_id": 41593212, "comment_id": 70389535, "body": "@A.S.H - Reeducation camps are being constructed as we speak."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1484144473, "post_id": 41593212, "comment_id": 70389545, "body": "Question is ok, your statement of wrapper is not. It is the same as a say that C is a generalized wrapper of assembler. And all compiled languages are."}], "answers": [{"tags": [], "owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "is_accepted": false, "score": 1, "last_activity_date": 1484144332, "creation_date": 1484144332, "answer_id": 41593280, "question_id": 41593212, "link": "https://stackoverflow.com/questions/41593212/is-it-possible-to-run-program-on-different-operating-systems-with-only-one-compi/41593280#41593280", "title": "Is it possible to run program on different operating systems with only one compile?", "body": "<p>C binary executables are platform dependent. \nSo it is a no.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4108694"}, "edited": false, "score": 0, "creation_date": 1484144501, "post_id": 41593305, "comment_id": 70389559, "body": "If you&#39;d like please provide an example. I refer to simple programs."}, {"owner": {"reputation": 291, "user_id": 1673121, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45c786cba12dc4aa4b28f674db9a1e7c?s=128&d=identicon&r=PG", "display_name": "Edik Mkoyan", "link": "https://stackoverflow.com/users/1673121/edik-mkoyan"}, "edited": false, "score": 0, "creation_date": 1484144720, "post_id": 41593305, "comment_id": 70389723, "body": "I mean something like cout a character, because I guess the std internals may have implemented something like this. Anyways don&#39;t focus on my answers, treat it as addition to others.  <a href=\"https://msdn.microsoft.com/en-us/library/ew2hz0yd.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ew2hz0yd.aspx</a>"}], "tags": [], "owner": {"reputation": 291, "user_id": 1673121, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45c786cba12dc4aa4b28f674db9a1e7c?s=128&d=identicon&r=PG", "display_name": "Edik Mkoyan", "link": "https://stackoverflow.com/users/1673121/edik-mkoyan"}, "is_accepted": false, "score": 0, "last_activity_date": 1484144425, "creation_date": 1484144425, "answer_id": 41593305, "question_id": 41593212, "link": "https://stackoverflow.com/questions/41593212/is-it-possible-to-run-program-on-different-operating-systems-with-only-one-compi/41593305#41593305", "title": "Is it possible to run program on different operating systems with only one compile?", "body": "<p>I guess no, because there should be data for the OSes loader, so it will know how to create data structures in RAM, and as different OSes manage the memory differently the answer should be negative.</p>\n\n<p>The trick you show, probably is suitable for simple programs, that do not use libraries like dotnet.\nYou can make thing complicated and use conditional compilation tricks, I am not sure that is a good idea tough.</p>\n"}, {"tags": [], "owner": {"reputation": 2438, "user_id": 6517320, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/5AiJr.jpg?s=128&g=1", "display_name": "Ivan Rubinson", "link": "https://stackoverflow.com/users/6517320/ivan-rubinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1484144599, "creation_date": 1484144599, "answer_id": 41593360, "question_id": 41593212, "link": "https://stackoverflow.com/questions/41593212/is-it-possible-to-run-program-on-different-operating-systems-with-only-one-compi/41593360#41593360", "title": "Is it possible to run program on different operating systems with only one compile?", "body": "<p>C and C++ get compiled in to <em>native binaries</em>. This, by definition, means they won't run on multiple platforms. Different platforms have a different format for their executables, and have a different ABI.</p>\n\n<p>You can, however, set up your build system to cross-compile to multiple platforms when you build (which means that your toolchain will generate all of the different executables).</p>\n\n<p>If what you're trying to do is to figure out which version of an OS you're on at runtime, maybe your OS has an API for that.</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1484144987, "creation_date": 1484144987, "answer_id": 41593504, "question_id": 41593212, "link": "https://stackoverflow.com/questions/41593212/is-it-possible-to-run-program-on-different-operating-systems-with-only-one-compi/41593504#41593504", "title": "Is it possible to run program on different operating systems with only one compile?", "body": "<p>In the general case, no, it's not possible.</p>\n\n<p>But on POSIX systems, you can use <a href=\"http://man7.org/linux/man-pages/man2/uname.2.html\" rel=\"nofollow noreferrer\"><code>uname(2)</code></a>.</p>\n\n<p>Another option is to use macros for the specific Operating Systems you are interested in.</p>\n\n<p>The following provides the list of macros that can be used to identify specific OS:\n<a href=\"https://sourceforge.net/p/predef/wiki/OperatingSystems/\" rel=\"nofollow noreferrer\">https://sourceforge.net/p/predef/wiki/OperatingSystems/</a></p>\n\n<p>While this list is exhaustive, it may not cover <em>every</em> existing Operating Systems that's out there. But it covers pretty much covers all the majors ones.</p>\n"}, {"tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": false, "score": 1, "last_activity_date": 1484149145, "last_edit_date": 1495542859, "creation_date": 1484145800, "answer_id": 41593787, "question_id": 41593212, "link": "https://stackoverflow.com/questions/41593212/is-it-possible-to-run-program-on-different-operating-systems-with-only-one-compi/41593787#41593787", "title": "Is it possible to run program on different operating systems with only one compile?", "body": "<p>It is not possible in a direct manner, as there are different executable formats on both platforms. Windows uses <a href=\"https://en.wikipedia.org/wiki/Portable_Executable\" rel=\"nofollow noreferrer\">PE</a> format, which is not compatible with Linux's <a href=\"https://en.wikipedia.org/wiki/Executable_and_Linkable_Format\" rel=\"nofollow noreferrer\">ELF</a>.</p>\n\n<p>See also: <a href=\"https://stackoverflow.com/questions/2082336/has-anyone-been-able-to-create-a-hybrid-of-pe-coff-and-elf\">Has anyone been able to create a hybrid of PE COFF and ELF?</a></p>\n\n<p>As already pointed out, you would need some compatibility layer such as Wine or Cygwin.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4108694"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1484149145, "creation_date": 1484144135, "last_edit_date": 1592644375, "question_id": 41593212, "link": "https://stackoverflow.com/questions/41593212/is-it-possible-to-run-program-on-different-operating-systems-with-only-one-compi", "title": "Is it possible to run program on different operating systems with only one compile?", "body": "<p>I don't know if this question was answered before, but I couldn't find any relative one.</p>\n<p>My question is simple.</p>\n<p>Given a simple C program that outputs which operating system we are in, is it possible to detect it <strong>on the fly</strong> and not recompile it?</p>\n<p>We can use macros like <code>_WIN32</code>, <code>_WIN64</code>, <code>linux</code>, etc, but we have to compile the code every time on each system. Can we do it with only one compilation?</p>\n<p>Example of a simple program:</p>\n<pre><code>#include &lt;stdio.h&gt;\n\n#ifdef _WIN32\n#define OS &quot;WINDOWS&quot;\n#endif\n\n#ifdef linux\n#define OS &quot;LINUX&quot;\n#endif\n\nint main(void) {\n    printf(&quot;%s\\n&quot;, OS);\n    return 0;\n}\n</code></pre>\n<p>For instance we compile the above code with <code>gcc</code> in linux environment.\nExpected outputs will be OS dependent.</p>\n<p>Linux : <strong>LINUX</strong></p>\n<p>Windows : <strong>WINDOWS</strong></p>\n<h3>Note:</h3>\n<ol>\n<li>We don't want and don't use <a href=\"https://www.cygwin.com/\" rel=\"nofollow noreferrer\">Gygwin</a>.</li>\n<li>We don't use <a href=\"https://www.winehq.org/\" rel=\"nofollow noreferrer\">wine</a>.</li>\n</ol>\n"}, {"tags": ["c", "coding-style", "refactoring"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484144138, "post_id": 41593108, "comment_id": 70389318, "body": "By not having a global there (virtualImplLayer.c) for it at all. Have <code>findListImplHandler</code> cache the result instead for easy lookup. While working with any 1 list implementation, the lookup will be fast. When switching, it will incur a single lookup miss."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484144335, "post_id": 41593108, "comment_id": 70389467, "body": "And now a nitpick, since your question is nice in my opinion. But you seriously need to work on the &quot;Minimal&quot; aspect of a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484144507, "post_id": 41593108, "comment_id": 70389565, "body": "@StoryTeller Updated query with details on working example"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484144641, "post_id": 41593108, "comment_id": 70389661, "body": "Your example wasn&#39;t short on details. Quite the opposite. If someone wants to actually understand your question, they&#39;d need to sift through a lot of irrelevant details (yes, most of the code you&#39;ve shown as well as the design notes are irrelevant)."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484144692, "post_id": 41593108, "comment_id": 70389697, "body": "@StoryTeller OK. If there are irrelevant details then please edit the query"}], "answers": [{"comments": [{"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484145724, "post_id": 41593624, "comment_id": 70390391, "body": "So, implementation details of <code>struct ListRtti</code> only should be visible to <code>virtualImplLayer.c</code>. Implementation details of <code>struct List</code>, not needed to be visible"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484145965, "post_id": 41593624, "comment_id": 70390585, "body": "@overexchange - Pretty much."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484146486, "post_id": 41593624, "comment_id": 70390955, "body": "Does <code>socket()</code> api allow invoking <code>socket(AF_INET,,)</code> and <code>socket(AF_UNIX,,)</code> from single client using socket library?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484146791, "post_id": 41593624, "comment_id": 70391166, "body": "@overexchange - <a href=\"http://man7.org/linux/man-pages/man2/socket.2.html\" rel=\"nofollow noreferrer\">Nothing in the docs says you can&#39;t</a>"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484176707, "post_id": 41593624, "comment_id": 70407569, "body": "I made the code changes <a href=\"https://github.com/shamhub/Computing/tree/master/design2Code\" rel=\"nofollow noreferrer\">here</a> accordingly and it is working. Thank you!!"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1484205961, "post_id": 41593624, "comment_id": 70416352, "body": "@overexchange - Happy to help :)"}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1484145316, "creation_date": 1484145316, "answer_id": 41593624, "question_id": 41593108, "link": "https://stackoverflow.com/questions/41593108/c-how-client-can-use-access-more-than-one-implementation/41593624#41593624", "title": "C - How client can use/access more than one implementation?", "body": "<p>The only way to remove the global, is by storing some type info in <code>List</code> itself.</p>\n\n<p>You can for instance enforce a convention (by thinking a bit OO, as far as C facilitates it). Both <code>List</code> implementations must include as the first member the following <code>struct</code></p>\n\n<pre><code>struct ListRtti {\n  ListHandler *handler_;\n  // Other relevent meta data you may want\n};\n</code></pre>\n\n<p>So </p>\n\n<pre><code>struct List {\n  ListRtti rtti_;\n\n  // Implementation details\n};\n</code></pre>\n\n<p>Now, you can retrieve the handler from the pointer to the object itself. Since the address of the first member is guaranteed to be the address of the entire object:</p>\n\n<pre><code>((ListRtti*)list)-&gt;handler_;\n</code></pre>\n\n<p>Pro:</p>\n\n<ul>\n<li>The handler is always a single indirection away.</li>\n<li>Users can mix and interchange implementations to their hearts content.</li>\n</ul>\n\n<p>Cons:</p>\n\n<ul>\n<li>The meta data requires extra storage for every object allocated.</li>\n<li>That cast can raise eyebrows.</li>\n</ul>\n"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 41593624, "answer_count": 1, "score": 1, "last_activity_date": 1484145316, "creation_date": 1484143807, "last_edit_date": 1484145037, "question_id": 41593108, "link": "https://stackoverflow.com/questions/41593108/c-how-client-can-use-access-more-than-one-implementation", "title": "C - How client can use/access more than one implementation?", "body": "<p>Below(image) is the imitation approach from  <code>Linux/net/socket.c</code> source. </p>\n\n<blockquote>\n  <p><strong>Background:</strong></p>\n  \n  <p>Reason to implement <code>List</code> abstraction with this approach, is to make a  <strong>working prototype</strong> before implementing snmp library, with same approach.\n  f\n  Inspired from <code>Linux/net/socket.c</code>, where <strong>any one</strong> of the protocol family implementations(like <code>net/ipv4/af_inet.c</code> or <code>net/unix/af_unix.c</code>/..) is available on invoking <code>socket()</code> interface api</p>\n  \n  <p>Client invoking <code>socket()</code> api, avails <strong>any one</strong> protocol family implementation based on the argument(<code>AF_INET</code> | <code>AF_UNIX</code> | <code>AF_XYZ</code>) passed to <code>socket()</code> interface api.</p>\n</blockquote>\n\n<h2><a href=\"https://i.stack.imgur.com/aGxxs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aGxxs.png\" alt=\"enter image description here\"></a></h2>\n\n<p>In the above approach, <code>list.h</code> provides <code>List</code> interface, with code shown below,</p>\n\n<pre><code>/********************** list.h ********************/\n\n\n#ifndef LIST_H /* Header guard */\n#define LIST_H\n#include\"type.h\"\n\n/****************** Interface - start  ********/\n\n typedef struct List List;\n typedef enum {ARRAY_IMPL, LINKED_LIST_IMPL}ImplType;\n\n\n typedef int (*compareTo)(const void *, const void *);\n typedef bool (*isLess)(const void *, const void *);\n typedef bool (*isEqual)(const void *, const void *);\n\n List* createList(ImplType);\n  void freeList(List*);\n  void swim(List*, int, isLess);\n  void sink(List*, int, isLess);\nconst  void* deleteMax(List*, isLess);\nconst  void* sortDeleteMax(List*);\n   int getSize(List*);\nconst void* getItem(List*, const int);\n List* sortInsertItem(List*, const void*, compareTo);\n  void insertItem(List*, const void*);\nconst  void* deleteItem(List*, int);\nconst  void* deleteLastItem(List*);\nconst  void* deleteFirstItem(List*);\n   int lSearch(const void*, List*, size_t, compareTo);\n   int bSearch(const void*, List*, size_t, compareTo);\n  void callInsertionSort(List*, size_t, isLess);\n  void callMergeSort(List*, size_t, isLess);\n  void swap(List*, int, int);\n/****************** Interface - end  ********/\n#endif\n</code></pre>\n\n<hr>\n\n<p>Linking of implementation(<code>arrayImpl.o</code>/<code>linkListImpl.o</code>) to executable(<code>a.out</code>) happen at linker phase.</p>\n\n<p><code>virtualImplLayer.c</code> picks <strong>any one</strong> implementation handler based on the argument(<code>ARRAY_IMPL | LINKED_LIST_IMPL</code>) passed to <code>createList()</code> interface api. This implementation handler is stored in <code>handler</code> global variable, as shown below. <strong>Rest of the interface api rely on this global variable.</strong></p>\n\n<pre><code>/*****************virtualImplLayer.c*************************/\n#include \"list/listHandler.h\"\n\n/*****Private symbol - start *****************/\nstatic ListHandler * findListImplHandler(ImplType);\n/*****Private symbol - end   *****************/\n\n\nListHandler *handler = NULL;\n/***** User interface - start *************/\nList* createList(ImplType implType){\n\n  handler =  findListImplHandler(implType);\n\n  if(handler != NULL){\n\n    List *list = handler-&gt;createList();\n    return list;\n  }\n  fprintf(stderr, \"createList() - No implementation for this feature\\n\");\n  return NULL;\n\n}\n\n\nvoid freeList(List *list){\n\n    handler-&gt;freeList(list);\n}\n\n\nvoid swim(List *list, int parentIndex, isLess less){\n\n    handler-&gt;swim(list, parentIndex, less);\n\n}\n\n\nvoid sink(List *list, int index, isLess less){\n\n    handler-&gt;sink(list, index, less);\n}\n\n\nconst void* deleteMax(List *list, isLess less){\n\n    return handler-&gt;listDeleteMaxElement(list, less);\n}\n\n\nconst void* sortDeleteMax(List *list){\n\n    return handler-&gt;sortedListDeleteMaxElement(list);\n}\nint getSize(List *list){\n\n    return handler-&gt;listGetSize(list);\n}\n\n\nconst void* getItem(List *list, const int index){\n\n    return handler-&gt;listGetItem(list, index);\n}\n\n\nList* sortInsertItem(List *list, const void *item, compareTo compare){\n\n    return handler-&gt;sortedListInsertItem(list, item, compare);\n}\n\n\nvoid insertItem(List *list, const void *item){\n\n    handler-&gt;listInsertItem(list, item);\n}\nconst void* deleteItem(List *list, int listIndex){\n\n    return handler-&gt;listDeleteItem(list, listIndex);\n}\n\n\nconst void* deleteLastItem(List *list){\n\n    return handler-&gt;listDeleteLastItem(list);\n}\n\n\nconst void* deleteFirstItem(List *list){\n\n    return handler-&gt;listDeleteFirstItem(list);\n}\n\n\nint lSearch(const void *key, List *list, size_t size, compareTo compare){\n\n    return handler-&gt;linearSearch(key, list, size, compare);\n}\n\n\nint bSearch(const void *key, List *list, size_t size, compareTo compare){\n\n    return handler-&gt;binarySearch(key, list, size, compare);\n}\nvoid callInsertionSort(List *list, size_t size, isLess less){\n\n    handler-&gt;insertionSort(list, size, less);\n}\n\n\nvoid callMergeSort(List *list, size_t size, isLess less){\n\n    handler-&gt;mergeSort(list, size, less);\n}\n\n\nvoid swap(List *list, int i, int j){\n\n    handler-&gt;swap(list, i, j);\n}\n\n/***** User interface -end *************/\n\n/*****Private symbol - start *****************/\nstatic ListHandler * findListImplHandler(ImplType implType){\n\n  ListHandler *implHandler = NULL;\n  int handlerIndex = 0;\n  while(listHandlers[handlerIndex] !=NULL){\n\n    implHandler = listHandlers[handlerIndex];\n    if( implHandler-&gt;canHandle(implType) ){\n      return implHandler;\n    }\n    handlerIndex++;\n  }\n  return NULL;\n}\n/*****Private symbol - end *****************/\n</code></pre>\n\n<hr>\n\n<p>Implementations like <code>Linux/net/ipv4/af_inet.c</code>,<code>Linux/net/unix/af_unix.c</code> are linked at loading phase by overriding <code>_init()</code> run-time code in the implementation(say <code>af_inet.c</code>), as shown below,</p>\n\n<pre><code>static int __init inet_init(void){\n  ....\n  void)sock_register(&amp;inet_family_ops);\n  ....\n}\n</code></pre>\n\n<hr>\n\n<p>Coming to the question, With given implementation in <code>virtualImplLayer.c</code>, a client program cannot expect to use/access <em>more than one</em> implementations(<code>arrayImpl.c</code>/<code>LinkListImpl.c</code>), because <code>handler</code> variable gets overridden</p>\n\n<hr>\n\n<p>Complete working example is <a href=\"https://github.com/shamhub/Computing/tree/master/design2Code/list\" rel=\"nofollow noreferrer\">here</a> with compilng instructions given <a href=\"https://github.com/shamhub/Computing/blob/master/design2Code/ReadMe.txt\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p><strong>Question:</strong></p>\n\n<p>With the <code>ImplType</code> being passed only to <code>createList()</code> interface, In <code>virtualImplLayer.c</code>, How to avoid overriding of global variable <code>handler</code>, to avail multiple implementations?</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "edited": false, "score": 0, "creation_date": 1484144194, "post_id": 41593085, "comment_id": 70389350, "body": "String to system() API is wrong in a sense that argv[1] will not be replaced by it&#39;s value. E.g. you entered   ./example dexter   but the string which is passed to system API is this  &quot;ps -A &gt;&gt; argv[1]/file.txt&quot;"}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1484159550, "post_id": 41593085, "comment_id": 70399112, "body": "Why do you need to use <code>fork</code>? You could achieve this much more simply without using <code>fork</code> at all; it&#39;s not clear what you gain by forking."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7396648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4fb34fbc30d79de223d655bc2230c9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dexter", "link": "https://stackoverflow.com/users/7396648/dexter"}, "edited": false, "score": 0, "creation_date": 1484146531, "post_id": 41593300, "comment_id": 70390986, "body": "Solved, thank you ,one of my mistakes was the wait(&amp;status) in child as well."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1484161211, "post_id": 41593300, "comment_id": 70400052, "body": "Too bad if someone passes a long filename to your program, though... a better solution would calculate the right buffer size and allocate it dynamically, rather than using a fixed-size array."}], "tags": [], "owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "is_accepted": true, "score": 0, "last_activity_date": 1484144393, "creation_date": 1484144393, "answer_id": 41593300, "question_id": 41593085, "link": "https://stackoverflow.com/questions/41593085/using-fork-to-create-a-folder-and-file/41593300#41593300", "title": "Using fork to create a folder and file", "body": "<p>Try this one. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main(int argc , char *argv[])\n{\n    int fid,status;\n\n    char string[50];\n    sprintf(string, \"ps -A &gt;&gt; %s/file.txt\", argv[1]);\n\n    fid=fork();\n    if(fid==0)\n    {\n        mkdir(argv[1],0777);\n        wait(&amp;status);\n    }\n    else if(fid&gt;0)\n    {\n        system(string);\n    }\n    else\n        printf(\"fork failed\");\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7396648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4fb34fbc30d79de223d655bc2230c9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dexter", "link": "https://stackoverflow.com/users/7396648/dexter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 41593300, "answer_count": 1, "score": -1, "last_activity_date": 1484144804, "creation_date": 1484143723, "last_edit_date": 1484144804, "question_id": 41593085, "link": "https://stackoverflow.com/questions/41593085/using-fork-to-create-a-folder-and-file", "title": "Using fork to create a folder and file", "body": "<p>Using <code>fork()</code>, I want the child to create a folder with the argument that I gave from console:  </p>\n\n<blockquote>\n  <p>./example abc</p>\n</blockquote>\n\n<p>and the parent will put a <code>file.txt</code> inside this folder with all current processes.</p>\n\n<p>My problem is that the parent doesn't recognize this folder.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main(int argc , char *argv[])\n{\n    int fid,status;\n    fid=fork();\n    if(fid==0)\n    {\n        mkdir(argv[1],0777);\n        wait(&amp;status);\n    }\n    else if(fid&gt;0)\n    {\n        system(\"ps -A &gt;&gt; argv[1]/file.txt\");\n    }\n    else\n        printf(\"fork failed\");\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 33, "creation_date": 1484143512, "post_id": 41592982, "comment_id": 70388903, "body": "It serves no purpose. It&#39;s just an empty statement."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 5, "creation_date": 1484143666, "post_id": 41592982, "comment_id": 70388999, "body": "Is this C or C++?"}, {"owner": {"reputation": 44381, "user_id": 471160, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/9Z23A.jpg?s=128&g=1", "display_name": "marcinj", "link": "https://stackoverflow.com/users/471160/marcinj"}, "edited": false, "score": 2, "creation_date": 1484144158, "post_id": 41592982, "comment_id": 70389334, "body": "I never tried this but wouldnt such empty statement be usefull for debugging purposes? like adding breakpoints?"}, {"owner": {"reputation": 5184, "user_id": 6350078, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fcbd9246215586c3ff1b5c338570dd8d?s=128&d=identicon&r=PG&f=1", "display_name": "metalfox", "link": "https://stackoverflow.com/users/6350078/metalfox"}, "edited": false, "score": 2, "creation_date": 1484144506, "post_id": 41592982, "comment_id": 70389563, "body": "There are some use cases, e.g. <code>while (x.compare_exchange_weak(xexp,xexp+2.0)) ;</code>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1484144642, "post_id": 41592982, "comment_id": 70389662, "body": "In which case, it&#39;s either unsigned behaviour or a no-op, depending on what <code>a</code> is. See my answer (which sadly suffers from a complete lack of attention)."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 26, "creation_date": 1484144941, "post_id": 41592982, "comment_id": 70389866, "body": "@Bathsheba unsigned behaviour? Is that what fans do when they&#39;re queuing for autographs?"}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1484144967, "post_id": 41592982, "comment_id": 70389884, "body": "In conjunction with an else it can make conditions easier to read if(has_car &amp;&amp; has_licence);else{...} ratheer than if(!has_car || !has_licence){...}"}, {"owner": {"reputation": 522, "user_id": 5472899, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/906d78201e3d2cdf72b9ca471f77a568?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Sanford", "link": "https://stackoverflow.com/users/5472899/josh-sanford"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1484145053, "post_id": 41592982, "comment_id": 70389962, "body": "@Quentin I believe that was supposed to be &quot;undefined behavior&quot;."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 1, "creation_date": 1484145633, "post_id": 41592982, "comment_id": 70390335, "body": "@MalcolmMcLean <code>if(!(hasCar &amp;&amp; hasLicence))</code> still looks clearer to me..."}, {"owner": {"reputation": 1748, "user_id": 1158692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9788d7b4332bae4016546a3a481786d9?s=128&d=identicon&r=PG", "display_name": "Grimm The Opiner", "link": "https://stackoverflow.com/users/1158692/grimm-the-opiner"}, "edited": false, "score": 1, "creation_date": 1484150275, "post_id": 41592982, "comment_id": 70393418, "body": "I&#39;ve seen this sort of thing appear where there&#39;s an inflexible coding standard of &quot;every if must have an else&quot;.  (A thoroughly, infuriatingly, stupid standard.)  In those cases where you simply just don&#39;t need an <code>else</code>, then either the <code>if</code> or <code>else</code> must be a no-op ."}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "reply_to_user": {"reputation": 44381, "user_id": 471160, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/9Z23A.jpg?s=128&g=1", "display_name": "marcinj", "link": "https://stackoverflow.com/users/471160/marcinj"}, "edited": false, "score": 2, "creation_date": 1484150433, "post_id": 41592982, "comment_id": 70393520, "body": "@marcinj Nope, because it generates no assembler code, so there is not an instruction which you could breakpoint (on Windows, <code>asm(int 3);</code> would be a good idea - you don&#39;t need to set a breakpoint, but the debugger always stops there - and it does nothing when running outside of a debugger."}, {"owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "reply_to_user": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484157611, "post_id": 41592982, "comment_id": 70398121, "body": "@Mawg Wouldn&#39;t that be <code>asm(&quot;int 3&quot;);</code>? Or perhaps <code>asm((int)3);</code> if you&#39;re trying to pass it the number (but it would already be an <code>int</code> afaik...)."}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1484157725, "post_id": 41592982, "comment_id": 70398179, "body": "Nope, the <code>int</code> refers to triggering an <code>interrupt</code> - see <a href=\"https://en.wikipedia.org/wiki/INT_%28x86_instruction%29#INT_3\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/INT_%28x86_instruction%29#INT_3</a>"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1484158354, "post_id": 41592982, "comment_id": 70398509, "body": "Better for portability if, rather than using inline assembly for breakpoints, you use an intrinsic. <code>__debugbreak()</code> on MSVC. @mawg"}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484158582, "post_id": 41592982, "comment_id": 70398619, "body": "Fine and dandy - if you use MSVC :-)  +1 otherwise, just inline it. Either way, it&#39;s a nice trick, which doesn&#39;t get enough publicity. I add it to error branches and don\u2019t have to remove it for  release. I can leave it there when when debugging, clear all breakpoints, set new ones, and still stop on any error branch marked such."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 3, "creation_date": 1484160834, "post_id": 41592982, "comment_id": 70399853, "body": "It might <i>possibly</i> suppress a compiler warning about the variable <code>a</code> being unused.  But more likely it\u2019s what Stephen Jay Gould called a spandrel: a piece of code (he was talking about our genetic code) that once served a purpose in its original context, but now is just left over after the other pieces were removed."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1484188492, "post_id": 41592982, "comment_id": 70410770, "body": "Partially related: <a href=\"http://stackoverflow.com/q/154136/5399734\">stackoverflow.com/q/154136/5399734</a>"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 1, "creation_date": 1484216813, "post_id": 41592982, "comment_id": 70422763, "body": "Casting the final close vote, since 4 people already agreed this is probably a duplicate. I figured that was as good as protecting it. Either way, something needed to be done; this already has <i>more than enough</i> answers."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1484238404, "post_id": 41592982, "comment_id": 70437852, "body": "@NadeemKhan Did one of the answers provided below answer your question?  If so you should <a href=\"http://stackoverflow.com/help/accepted-answer\">accept one of them</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2659, "user_id": 2026276, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/8wAi8.jpg?s=128&g=1", "display_name": "Bauss", "link": "https://stackoverflow.com/users/2026276/bauss"}, "edited": false, "score": 10, "creation_date": 1484144703, "post_id": 41593014, "comment_id": 70389708, "body": "I disagree with the <code>might be cleaner than this</code>. I know it&#39;s opinionated but at least for me it&#39;s much easier to read the code as <code>if none of these, do this</code> instead of <code>if this and this and this and this do nothing else do this</code>"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 21, "creation_date": 1484146329, "post_id": 41593014, "comment_id": 70390842, "body": "This would all apply without the semicolon."}, {"owner": {"reputation": 74851, "user_id": 238419, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/460167b95ff5a363d3977ddb56cfe074?s=128&d=identicon&r=PG", "display_name": "BlueRaja - Danny Pflughoeft", "link": "https://stackoverflow.com/users/238419/blueraja-danny-pflughoeft"}, "edited": false, "score": 1, "creation_date": 1484148018, "post_id": 41593014, "comment_id": 70391970, "body": "All of those options are terrible.  If the condition is that complex it should be extracted to a well-named function."}, {"owner": {"reputation": 7851, "user_id": 1390430, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/5816e6bbc741b4ae175b3f932f08d641?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/1390430/ben"}, "edited": false, "score": 4, "creation_date": 1484148522, "post_id": 41593014, "comment_id": 70392282, "body": "Concrete example where it might be clearer to write this way: consider a flag variable with a negative in the name, such as &quot;not_found&quot;. It&#39;s probably clearer to do &quot;if (not_found) {;} else { ... }&quot; than to have a double negative &quot;if (!not_found) {...}&quot;"}, {"owner": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "reply_to_user": {"reputation": 74851, "user_id": 238419, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/460167b95ff5a363d3977ddb56cfe074?s=128&d=identicon&r=PG", "display_name": "BlueRaja - Danny Pflughoeft", "link": "https://stackoverflow.com/users/238419/blueraja-danny-pflughoeft"}, "edited": false, "score": 0, "creation_date": 1484150379, "post_id": 41593014, "comment_id": 70393485, "body": "@BlueRaja: if you extract a complex condition to a well-named function, you will just move the problem to the function: what code will you write there? Sooner or later you will have to deal with the complex condition. At that point you will have to make a choice: which of the options presented here is better? They might all be terrible, but you will have to choose one eventually."}, {"owner": {"reputation": 3797, "user_id": 4022608, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27c9e8430426724a1f39c98b268f0a98?s=128&d=identicon&r=PG&f=1", "display_name": "Baldrickk", "link": "https://stackoverflow.com/users/4022608/baldrickk"}, "reply_to_user": {"reputation": 7851, "user_id": 1390430, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/5816e6bbc741b4ae175b3f932f08d641?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/1390430/ben"}, "edited": false, "score": 0, "creation_date": 1484150519, "post_id": 41593014, "comment_id": 70393576, "body": "@Ben that&#39;s why you should have coding guidlines that <i>discorage</i> the use of negatives in variable names.  For your example, it would be much clearer for the variable to be named <code>found</code> and have inverse boolean values to your <code>not_found</code>."}, {"owner": {"reputation": 816, "user_id": 1773325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db3d3afee8d55eef4d855f438e2c3988?s=128&d=identicon&r=PG", "display_name": "iceman", "link": "https://stackoverflow.com/users/1773325/iceman"}, "edited": false, "score": 0, "creation_date": 1484153206, "post_id": 41593014, "comment_id": 70395322, "body": "<code>!not_found</code> -&gt; <code>found</code>??"}, {"owner": {"reputation": 74851, "user_id": 238419, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/460167b95ff5a363d3977ddb56cfe074?s=128&d=identicon&r=PG", "display_name": "BlueRaja - Danny Pflughoeft", "link": "https://stackoverflow.com/users/238419/blueraja-danny-pflughoeft"}, "reply_to_user": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1484153741, "post_id": 41593014, "comment_id": 70395668, "body": "@FabioTurati: With respect to what we&#39;re talking about, <code>if(!(complex_condition)){ &#47;*stuff*&#47; }</code> vs. <code>if(complex_condition) {} else { &#47;*stuff*&#47; }</code>, no, you wouldn&#39;t.  You&#39;d have a function that does <code>return (complex_condition)</code> at which point the horrible second-option becomes unnecessary."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 6, "creation_date": 1484162989, "post_id": 41593014, "comment_id": 70401022, "body": "I&#39;m aware of only one case in which <code>;</code> is absolutely necessary. One needs to put it after <code>goto</code> labels if the next token after them is <code>}</code>: <code>label: }</code> wont work, but <code>label: ; }</code> will."}, {"owner": {"reputation": 11474, "user_id": 1195056, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pe03k.jpg?s=128&g=1", "display_name": "krillgar", "link": "https://stackoverflow.com/users/1195056/krillgar"}, "edited": false, "score": 0, "creation_date": 1484165400, "post_id": 41593014, "comment_id": 70402397, "body": "In your <code>if</code>/<code>else if</code> example, it might be clearer if the final section is an <code>else</code>. Of course, if you&#39;re going for clarity, than this sort of empty statement would be one of the first things to go."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1484168620, "post_id": 41593014, "comment_id": 70404029, "body": "I think the last example is perhaps the best one, though as written all the tests after the first include a redundant term.  What&#39;s important is that having the positive case on the third test &quot;do nothing&quot; makes the &quot;none-of-the-above&quot; case read like a negative-fall-through cases for the original if-elseif chain, rather than being a fall-through case within the third <code>if</code>&#39;s positive case."}, {"owner": {"reputation": 156, "user_id": 5195304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd61af6765e21930006cbbe4b2c6d617?s=128&d=identicon&r=PG", "display_name": "alephzero", "link": "https://stackoverflow.com/users/5195304/alephzero"}, "reply_to_user": {"reputation": 74851, "user_id": 238419, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/460167b95ff5a363d3977ddb56cfe074?s=128&d=identicon&r=PG", "display_name": "BlueRaja - Danny Pflughoeft", "link": "https://stackoverflow.com/users/238419/blueraja-danny-pflughoeft"}, "edited": false, "score": 0, "creation_date": 1484177585, "post_id": 41593014, "comment_id": 70407861, "body": "@BlueRaja-DannyPflughoeft I absolutely agree - there are two huge great advantage of moving the logical condition into a separate function: (1) you can put it somewhere else in the code - preferably in a completely different file with a hard-to-guess name. Ideally, you should also give it the same overloaded name as 20 other similar functions, just to make it easier for the next programmer to figure out what&#39;s going on; (2) if your manager measures &quot;productivity&quot; by counting lines of code, doing that just increased your productivity! (Irony intentional, of course)"}, {"owner": {"reputation": 7148, "user_id": 501439, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Vq6Nw.jpg?s=128&g=1", "display_name": "GeneCode", "link": "https://stackoverflow.com/users/501439/genecode"}, "edited": false, "score": 0, "creation_date": 1484190865, "post_id": 41593014, "comment_id": 70411356, "body": "if should always comes with else."}, {"owner": {"reputation": 3784, "user_id": 7927, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/abbddf7434a6982f4790032a8b99aaad?s=128&d=identicon&r=PG", "display_name": "Wouter Lievens", "link": "https://stackoverflow.com/users/7927/wouter-lievens"}, "edited": false, "score": 1, "creation_date": 1484213671, "post_id": 41593014, "comment_id": 70420606, "body": "A flag variable named <code>not_found</code> is a bad code smell."}, {"owner": {"reputation": 8178, "user_id": 2920343, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dbfe32738597d61775971cab5efebb67?s=128&d=identicon&r=PG&f=1", "display_name": "CompuChip", "link": "https://stackoverflow.com/users/2920343/compuchip"}, "edited": false, "score": 1, "creation_date": 1484216520, "post_id": 41593014, "comment_id": 70422536, "body": "<code>int usefulStuffAlreadyDone = (a==1) &amp;&amp; (b==2) &amp;&amp; (c==3) &amp;&amp; (d==4); if(!usefulStuffAlreadyDone) { &#47;* usefull stuff *&#47; }</code>  -- problem solved: no null statements and no awkward inversions."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 55, "last_activity_date": 1484156662, "last_edit_date": 1484156662, "creation_date": 1484143558, "answer_id": 41593014, "question_id": 41592982, "link": "https://stackoverflow.com/questions/41592982/what-does-just-inside-an-if-block-mean/41593014#41593014", "title": "What does just &quot;;&quot; inside an &quot;if&quot; block mean?", "body": "<p>It's an empty statement.  A single semicolon by itself performs no operation.</p>\n\n<p>In this context, it means that if the <code>if</code> condition is true, do nothing.</p>\n\n<p>Without an <code>else</code> section, there is not much use to this code.  If there is, then it's a matter of style whether the condition should be inverted and should contain just a non-empty <code>if</code> portion.  </p>\n\n<p>In this case it's a simple conditional, so style-wise it's probably better to invert it, however if the condition is more complicated it may be clearer to write this way.  For example, this:</p>\n\n<pre><code>if ((a==1) &amp;&amp; (b==2) &amp;&amp; (c==3) &amp;&amp; (d==4)) {\n    ;\n} else {\n    // do something useful\n}\n</code></pre>\n\n<p>Might be clearer than this:</p>\n\n<pre><code>if (!((a==1) &amp;&amp; (b==2) &amp;&amp; (c==3) &amp;&amp; (d==4))) {\n    // do something useful\n}\n</code></pre>\n\n<p>Or this:</p>\n\n<pre><code>if ((a!=1) || (b!=2) || (c!=3) || (d!=4)) {\n    // do something useful\n}\n</code></pre>\n\n<p>A better example from the comments (thanks Ben):</p>\n\n<pre><code>if (not_found) {\n    ;\n} else {\n    // do something\n}\n</code></pre>\n\n<p>Versus:</p>\n\n<pre><code>if (!not_found) {\n    // do something\n}\n</code></pre>\n\n<p>Which method to use depends largely on exactly what is being compared, how many terms there are, how nested the terms are, and even the names of the variables / functions involved.</p>\n\n<p>Another example of when you might use this is when you have a set of <code>if..else</code> statements to check a range of values and you want to document in the code that nothing should happen for a particular range:</p>\n\n<pre><code>if (a &lt; 0) {\n    process_negative(a);\n} else if (a &gt;=0 &amp;&amp; a &lt; 10) {\n    process_under_10(a);\n} else if (a &gt;=10 &amp;&amp; a &lt; 20) {\n    ;   // do nothing\n} else if (a &gt;=20 &amp;&amp; a &lt; 30) {\n    process_20s(a);\n} else if (a &gt;= 30) {\n    process_30s_and_up(a);\n}\n</code></pre>\n\n<p>If the empty <code>if</code> was left out, a reader might wonder if something should have happened there and the developer forgot about it.  By including the empty <code>if</code>, it says to the reader \"yes I accounted for this and nothing should happen in this case\".</p>\n\n<p>Certain coding standards require that all possible outcomes be explicitly accounted for in code.  So code adhering to such a standard might look something like this.</p>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484143873, "post_id": 41593044, "comment_id": 70389124, "body": "In this case, yes. But sometimes the reverse condition (for the useful code) is easier to write/read. The author may have done this to improve readability (in their opinion anyway)."}, {"owner": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "edited": false, "score": 2, "creation_date": 1484144510, "post_id": 41593044, "comment_id": 70389568, "body": "But the <code>;</code> char is not required, is it? You can simply leave the <code>if</code> block empty and add an <code>else</code> block"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "edited": false, "score": 0, "creation_date": 1484144555, "post_id": 41593044, "comment_id": 70389602, "body": "@SomethingSomething Correct, although some people think it makes it more readable"}, {"owner": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "edited": false, "score": 0, "creation_date": 1484144609, "post_id": 41593044, "comment_id": 70389636, "body": "@GillBates I think the opposite ;D"}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "reply_to_user": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "edited": false, "score": 1, "creation_date": 1484144647, "post_id": 41593044, "comment_id": 70389665, "body": "@SomethingSomething Either that or curly braces, there need to be a statement of some kind after <code>if</code>."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484144899, "post_id": 41593044, "comment_id": 70389846, "body": "Good point about the invisible side effects. You can never be certain nothing is happening in C++. And such code definitely raises the question whether something hidden is in fact happening."}, {"owner": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "reply_to_user": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 0, "creation_date": 1484145272, "post_id": 41593044, "comment_id": 70390107, "body": "@skyking you mean I can write something like <code>if (a == 5) ; else do_something()</code>, right? I by the way, always use blocks to avoid mistakes"}, {"owner": {"reputation": 2501, "user_id": 450000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f522ea287d08a156b51d3d75ad1eb2?s=128&d=identicon&r=PG", "display_name": "greggo", "link": "https://stackoverflow.com/users/450000/greggo"}, "edited": false, "score": 0, "creation_date": 1484154117, "post_id": 41593044, "comment_id": 70395913, "body": "The redundant <code>;</code> could  mean &quot;intentionally null, ok?&quot;. In cases where that clarification could be helpful,  I&#39;d prefer the more explicit <code>{ &#47;*null*&#47; }</code>"}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "reply_to_user": {"reputation": 9280, "user_id": 3322273, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WBXKk.png?s=128&g=1", "display_name": "SomethingSomething", "link": "https://stackoverflow.com/users/3322273/somethingsomething"}, "edited": false, "score": 0, "creation_date": 1484204736, "post_id": 41593044, "comment_id": 70415769, "body": "@SomethingSomething Yes, or you can write <code>if (a == 5) {} else do_something();</code>. Both <code>;</code> and <code>{}</code> work as an empty statement..."}], "tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": false, "score": 18, "last_activity_date": 1484144581, "last_edit_date": 1484144581, "creation_date": 1484143638, "answer_id": 41593044, "question_id": 41592982, "link": "https://stackoverflow.com/questions/41592982/what-does-just-inside-an-if-block-mean/41593044#41593044", "title": "What does just &quot;;&quot; inside an &quot;if&quot; block mean?", "body": "<p>No purpose at all. It's an empty statement. It's possible that the developer wanted to do something if <code>a</code> was not <code>1</code> in which case the code would be something like (even though the <code>;</code> can still be omitted) :</p>\n\n<pre><code>if(a==1)\n{\n  ;\n}\nelse\n{\n  //useful code...\n}\n</code></pre>\n\n<p>But in that case, it could've easily been written as <code>if(a != 1)</code>.</p>\n\n<hr>\n\n<p>Note however, if this is C++(tags aren't clear yet) then there would be a possibility that the <code>operator==</code> of type <code>a</code> was overloaded and some side effects could've been observed. That would mean that the code is insane though.</p>\n"}, {"comments": [{"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484208228, "post_id": 41593050, "comment_id": 70417461, "body": "You only show the generated code for one of them?  I wonder why the compiler generated a nop? Presumably for alignment of the following stamen?"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484216715, "post_id": 41593050, "comment_id": 70422686, "body": "No, the nop isn&#39;t for alignment. It&#39;s because this was compiled without optimization enabled, which makes the whole thing rather meaningless. The compiler doesn&#39;t care about alignment when optimizations are disabled. It emits a nop when optimization is disabled to facilitate your setting a breakpoint on that line of code. If you&#39;re going to post answers that analyze the disassembly, it needs to be of optimized code, otherwise it&#39;s misleading and a waste of everyone&#39;s time. (cc @mawg)"}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484217494, "post_id": 41593050, "comment_id": 70423259, "body": "I see. I see. T&#39;was but a mere guess. Thansk for justifying the <code>NOP</code>; that is interesting. Is it a trick that I can rely on? (althoguh I still prefer <code>asm(int 3)</code>?"}, {"owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 0, "creation_date": 1484218534, "post_id": 41593050, "comment_id": 70423971, "body": "Yes that shows only one of them, but <code>;</code> can be easily commented out to see if there is any effect."}], "tags": [], "owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "is_accepted": false, "score": 4, "last_activity_date": 1484200668, "last_edit_date": 1484200668, "creation_date": 1484143648, "answer_id": 41593050, "question_id": 41592982, "link": "https://stackoverflow.com/questions/41592982/what-does-just-inside-an-if-block-mean/41593050#41593050", "title": "What does just &quot;;&quot; inside an &quot;if&quot; block mean?", "body": "<p>It is basically an <strong>null/empty</strong> statement, which does <strong>nothing</strong>, and is as expected benign (no error) in nature.</p>\n\n<p><em>C Spec draft N1570</em> clarifies that: </p>\n\n<blockquote>\n  <ol>\n  <li>the expressions are optional:    <strong><em>expression[opt] ;</em></strong></li>\n  <li>A null statement (consisting of just a semicolon) performs no operations.</li>\n  </ol>\n</blockquote>\n\n<p>On the other hand, Bjarne quotes in his C++ book <code>#9.2 Statement Summary</code>:</p>\n\n<blockquote>\n  <p>A semicolon is by itself a statement, the empty statement.</p>\n</blockquote>\n\n<p>Note that these two codes, <code>if(1) {;}</code> and <code>if(1) {}</code>,  have <a href=\"https://godbolt.org/g/Tez0aK\" rel=\"nofollow noreferrer\">no difference</a> in the generated gcc instructions. </p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "edited": false, "score": 7, "creation_date": 1484144580, "post_id": 41593109, "comment_id": 70389620, "body": "Finally, an answer that mentions the redundancy!"}, {"owner": {"reputation": 14194, "user_id": 732016, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d2eb40aff994d83e1d271a3543efb22?s=128&d=identicon&r=PG", "display_name": "wchargin", "link": "https://stackoverflow.com/users/732016/wchargin"}, "edited": false, "score": 1, "creation_date": 1484200934, "post_id": 41593109, "comment_id": 70414174, "body": "Personally, I prefer <code>if (a == 1) {{ ; }}</code>. You can never be too safe."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 44, "last_activity_date": 1484143810, "creation_date": 1484143810, "answer_id": 41593109, "question_id": 41592982, "link": "https://stackoverflow.com/questions/41592982/what-does-just-inside-an-if-block-mean/41593109#41593109", "title": "What does just &quot;;&quot; inside an &quot;if&quot; block mean?", "body": "<p>It's called <em>null statement</em>.</p>\n\n<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.8.3\" rel=\"noreferrer\">From 6.8.3 Expression and null statements</a>:</p>\n\n<blockquote>\n  <p>A null statement (consisting of just a semicolon) performs no\n  operations.</p>\n</blockquote>\n\n<p>In this particular example <code>if(a==1){;}</code>, it doesn't do anything useful (except perhaps a bit more obvious) as it's same as <code>if(a==1){}</code> or <code>if(a==1);</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 1, "creation_date": 1484143908, "post_id": 41593112, "comment_id": 70389143, "body": "But not in C++..."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 0, "creation_date": 1484144138, "post_id": 41593112, "comment_id": 70389317, "body": "@skyking: Absolutely! In C++, <code>a</code> might be an instance of a class with an overloaded <code>==</code> operator."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 11, "creation_date": 1484144390, "post_id": 41593112, "comment_id": 70389496, "body": "@Bathsheba In which case the developer is nuts."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1484144041, "last_edit_date": 1484144041, "creation_date": 1484143819, "answer_id": 41593112, "question_id": 41592982, "link": "https://stackoverflow.com/questions/41592982/what-does-just-inside-an-if-block-mean/41593112#41593112", "title": "What does just &quot;;&quot; inside an &quot;if&quot; block mean?", "body": "<p><code>;</code> on its own is an <em>empty statement</em>. If <code>a</code> is an initialised non-pointer type, then </p>\n\n<p><code>if(a==1){;}</code></p>\n\n<p>is <em>always</em> a no-op in C. Using the braces adds extra weight to the assertion that there is no typo. Perhaps there is an <code>else</code> directly beneath it, which would execute if <code>a</code> was not 1.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 13, "last_activity_date": 1484145575, "last_edit_date": 1484145575, "creation_date": 1484144865, "answer_id": 41593458, "question_id": 41592982, "link": "https://stackoverflow.com/questions/41592982/what-does-just-inside-an-if-block-mean/41593458#41593458", "title": "What does just &quot;;&quot; inside an &quot;if&quot; block mean?", "body": "<p>It is so called null statement. It is a kind of the expression statement where the expression is missed.</p>\n\n<p>Sometimes it is used in if-else statements as you showed when it is easy to write the if condition than its negation (or the if condition is more clear) but the code should be executed when the if condition is evaluated to false.</p>\n\n<p>For example</p>\n\n<pre><code>if ( some_condition )\n{\n   ; // do nothing\n}\nelse\n{\n   // here there is some code\n} \n</code></pre>\n\n<p>Usually the null statement is used for exposition only to show that for example body of a function, or a class constructor or a for loop is empty. For example</p>\n\n<pre><code>struct A\n{\n    A( int x ) : x( x )\n    {\n        ;\n    }\n\n    //...\n};\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>char * copy_string( char *dsn, const char *src )\n{\n    char *p = dsn;\n\n    while ( ( *dsn++ = *src++ ) ) ;\n                                 ^^^\n    return p;\n}\n</code></pre>\n\n<p>Here the null statement is required for the while loop. You could also rewrite it like</p>\n\n<pre><code>    while ( ( *dsn++ = *src++ ) ) {}\n</code></pre>\n\n<p>Sometimes the null statement is required especially in rare cases when goto statement is used. For example in C declarations are not statements. If you want to pass the program control to a point before some declaration you could place a label before the declaration. However in C a label may be placed only before a statement. In this case you could place a null statement with a label before the declaration. For example</p>\n\n<pre><code>Repeat:;\n      ^^^\n    int a[n];\n\n    //....\n\n    n++;\n    goto Repeat;\n</code></pre>\n\n<p>Pay attention to the null statement after the label. If to remove it then the C compiler will issue an error.</p>\n\n<p>This trick also is used to pass the program control to the end of a compound statement. For example</p>\n\n<pre><code>{\n   // some code\n    goto Done;\n   //...\n\n   Done:;\n}\n</code></pre>\n\n<p>Though you should not use the goto statement but you should know about these cases.:)</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1484168751, "post_id": 41593568, "comment_id": 70404101, "body": "If one of the intermediate items in the chain would have an empty body, I&#39;d code would be more readable using a consisent <code>if</code>/<code>else if</code> pattern than it would be if it inverted the logic on the empty-body case and moved everything from its &quot;else&quot; case to its &quot;true&quot; case."}], "tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": false, "score": 7, "last_activity_date": 1484145772, "last_edit_date": 1484145772, "creation_date": 1484145170, "answer_id": 41593568, "question_id": 41592982, "link": "https://stackoverflow.com/questions/41592982/what-does-just-inside-an-if-block-mean/41593568#41593568", "title": "What does just &quot;;&quot; inside an &quot;if&quot; block mean?", "body": "<p>A single <code>;</code> is the <em>null statement</em> which does nothing. It's often used in long if/else chains like:</p>\n\n<pre><code>if (a == 1) {\n    // Do nothing.\n    ;\n}\nelse if (...) {\n    ...\n}\nelse if (...) {\n    ...\n}\n</code></pre>\n\n<p>This could also be written as:</p>\n\n<pre><code>if (a != 1) {\n    if (...) {\n        ...\n    }\n    else if (...) {\n        ...\n    }\n}\n</code></pre>\n\n<p>The latter adds another level of indentation but IMO, it's clearer. But null statements can sometimes be useful to avoid excessive indentation if there are multiple branches without code.</p>\n\n<p>Note that an empty <em>compound statement</em> (also called <em>block</em>) has the same effect:</p>\n\n<pre><code>if (a == 1) {}\n</code></pre>\n\n<p>Technically, you only need the semicolon if you want to use an <em>expression statement</em> directly:</p>\n\n<pre><code>if (a == 1) ;\nelse if (...) { ... }\nelse if (...) { ... }\n</code></pre>\n\n<p>So writing <code>{;}</code> is redundant and only serves a dubious illustrative purpose.</p>\n\n<p>Another example from the C standard where the null statement is used to supply an empty loop body:</p>\n\n<pre><code>char *s;\n/* ... */\nwhile (*s++ != '\\0')\n    ;\n</code></pre>\n\n<p>But here I'd also prefer an empty compound statement.</p>\n"}, {"comments": [{"owner": {"reputation": 3297, "user_id": 1436796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a4b86c1c90bc06112c2c069b58bf995?s=128&d=identicon&r=PG", "display_name": "Marc van Leeuwen", "link": "https://stackoverflow.com/users/1436796/marc-van-leeuwen"}, "edited": false, "score": 0, "creation_date": 1484210432, "post_id": 41595579, "comment_id": 70418602, "body": "OP asked about the utility of the semicolon, not of that of the <code>if</code> clause."}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "reply_to_user": {"reputation": 3297, "user_id": 1436796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a4b86c1c90bc06112c2c069b58bf995?s=128&d=identicon&r=PG", "display_name": "Marc van Leeuwen", "link": "https://stackoverflow.com/users/1436796/marc-van-leeuwen"}, "edited": false, "score": 0, "creation_date": 1484210849, "post_id": 41595579, "comment_id": 70418876, "body": "Why pick on me? :-) Seriously, all other answer are using <code>if</code>. Look at nwellnhof&#39;s currently directly below this ... <code>often used in long if&#47;else chains</code> and others. Vlad\u2019s below that ` used in if-else statements` , etc, etc, etc I do understand that we can use a semic as  standalone statement <code>i++;  &#47;*here it comes*&#47; ; &#47;* what was that for? *&#47; j++;</code>, but the OP didn&#39;t phrase it that way, so I sought to explain it <b><i>in the context of the question</i></b> (as did all the others) while also teaching a much underused pragma."}], "tags": [], "owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "is_accepted": false, "score": 8, "last_activity_date": 1484151067, "last_edit_date": 1495542262, "creation_date": 1484151067, "answer_id": 41595579, "question_id": 41592982, "link": "https://stackoverflow.com/questions/41592982/what-does-just-inside-an-if-block-mean/41595579#41595579", "title": "What does just &quot;;&quot; inside an &quot;if&quot; block mean?", "body": "<p>As so many have said - it does nothing. </p>\n\n<p>Why is it there? Here is a possibility \u2026</p>\n\n<p>I am fed up with bad coders on my team not checking return values of functions. </p>\n\n<p>So, since we develop in Linux with the GCC compiler, I add <code>__attribute__((warn_unused_result))</code> to the declaration of all of my typed functions. See also <a href=\"https://stackoverflow.com/questions/4226308/msvc-equivalent-of-attribute-warn-unused-result\">this question</a> for a MS VC equivalent.</p>\n\n<p>If the user does not check the return value, then the compiler generates a warning.</p>\n\n<p>The cowboys, of course, have gamed the system and code <code>if (foo() != SUCCESS) ;</code> which satisfies the compiler (although it does not satisfy <strong><em>me</em></strong> :-).</p>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 6110389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ljs5G.jpg?s=128&g=1", "display_name": "alex.peter", "link": "https://stackoverflow.com/users/6110389/alex-peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1484164919, "creation_date": 1484164919, "answer_id": 41599724, "question_id": 41592982, "link": "https://stackoverflow.com/questions/41592982/what-does-just-inside-an-if-block-mean/41599724#41599724", "title": "What does just &quot;;&quot; inside an &quot;if&quot; block mean?", "body": "<p>; is an empty statement noop</p>\n\n<p>What is its purpose? </p>\n\n<p>Sometimes we just want to compare things like in this case the equality of a and 1. With primitive types like integer, this will set condition register so if you have after this if something like if(a > 1) or if(a &lt; 1), and a is not changed in the meantime, this might not be evaluated again depending on the compiler decision.</p>\n\n<p>This code </p>\n\n<pre><code> int f(int a){\n        if(a == 1){;}\n        if(a &gt; 1){return 3;}\n        if(a &lt; 1){return 5;}\n\n        return 0;\n }\n</code></pre>\n\n<p>will give</p>\n\n<pre><code>.file   \"c_rcrYxj\"\n.text\n.p2align 2,,3\n.globl  f\n.type   f, @function\nf:\n.LFB0:\n    .cfi_startproc\n    cmpl    $1, 4(%esp)\n    jle .L6\n    movl    $3, %eax\n    ret\n    .p2align 2,,3\n.L6:\n    setne   %al\n    movzbl  %al, %eax\n    leal    (%eax,%eax,4), %eax\n    ret\n    .cfi_endproc\n .LFE0:\n.size   f, .-f\n.ident  \"GCC: (Ubuntu 4.8.4-2ubuntu1~14.04.3) 4.8.4\"\n.section    .note.GNU-stack,\"\",@progbits\n</code></pre>\n\n<p>The comparison is done only once <strong>cmpl $1, 4(%esp)</strong>, exactly where if(a==1) is written.</p>\n"}, {"tags": [], "owner": {"reputation": 558, "user_id": 2142680, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d1cbde369f4b2d4c7b9783f7166c20a9?s=128&d=identicon&r=PG", "display_name": "Brenton Thomas", "link": "https://stackoverflow.com/users/2142680/brenton-thomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1484207579, "creation_date": 1484207579, "answer_id": 41607759, "question_id": 41592982, "link": "https://stackoverflow.com/questions/41592982/what-does-just-inside-an-if-block-mean/41607759#41607759", "title": "What does just &quot;;&quot; inside an &quot;if&quot; block mean?", "body": "<p>Why would you do it? I do similar things all the time when debugging to give me something that (I hope) won't be optimized away so I can put a break point on it.</p>\n\n<p>Normally though I make it obvious its a debug mark</p>\n\n<pre><code>if( (a==1) &amp;&amp; (b==2) &amp;&amp; (c==3) &amp;&amp; (d==4) ){\n\n  int debug=1;\n\n}\n</code></pre>\n\n<p>Otherwise I end up with weird little bits of code stuck everywhere that make absolutely no sense even to me.</p>\n\n<p>But that is not guarantee that's what this was.  </p>\n"}, {"tags": [], "owner": {"reputation": 3297, "user_id": 1436796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a4b86c1c90bc06112c2c069b58bf995?s=128&d=identicon&r=PG", "display_name": "Marc van Leeuwen", "link": "https://stackoverflow.com/users/1436796/marc-van-leeuwen"}, "is_accepted": false, "score": 0, "last_activity_date": 1484211867, "last_edit_date": 1484211867, "creation_date": 1484211256, "answer_id": 41608764, "question_id": 41592982, "link": "https://stackoverflow.com/questions/41592982/what-does-just-inside-an-if-block-mean/41608764#41608764", "title": "What does just &quot;;&quot; inside an &quot;if&quot; block mean?", "body": "<p>You probably already know that the semicolon is an empty statement. Concerning the actual question \"what purpose does this semicolon serve\", the answer is (unless the author of this code wanted to enliven the code with some weird emoticon), that it serves absolutely <strong>no purpose at all</strong>. That is, <code>{;}</code> is completely equivalent to <code>{}</code> in <em>any context</em> (where a statement is expected, which I think is the only place where <code>{;}</code> can be used). The presence of the semicolon changes a compound statement with 0 constituent statements into a compound statement with 1 constituent statement which is an empty statement, but the two cases are equivalent as far as semantics is concerned.</p>\n\n<p>I'll add a personal opinion that for readability concern of not being accidentally overlooked by a reader of the code, <code>{;}</code> is no better than <code>{}</code> (if it were, then maybe <code>{;;;;;;;;}</code> would be better still), though both are considerably better than a lone <code>;</code> (and as a consequence the language would have been better off without allowing <code>;</code> as empty statement at all, since replacing it with <code>{}</code> is always advantageous).</p>\n"}], "owner": {"reputation": 364, "user_id": 6314621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0TGdE_BSibo/AAAAAAAAAAI/AAAAAAAAAbs/afXy56ET3qs/photo.jpg?sz=128", "display_name": "Nadeem Khan", "link": "https://stackoverflow.com/users/6314621/nadeem-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6223, "favorite_count": 3, "closed_date": 1484216763, "accepted_answer_id": 41593014, "answer_count": 11, "score": 41, "last_activity_date": 1484211867, "creation_date": 1484143471, "last_edit_date": 1484147958, "question_id": 41592982, "link": "https://stackoverflow.com/questions/41592982/what-does-just-inside-an-if-block-mean", "closed_reason": "Duplicate", "title": "What does just &quot;;&quot; inside an &quot;if&quot; block mean?", "body": "<p>Why would someone use this? </p>\n\n<pre><code>if(a==1){;} \n</code></pre>\n\n<p>There no statement, only one semicolon, and it doesn't throw an error.\nWhat purpose does this semicolon serve?</p>\n"}, {"tags": ["c", "voip", "sofia-sip"], "comments": [{"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1484141834, "post_id": 41592375, "comment_id": 70387878, "body": "Have you re-registered to the server using the new IP?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484142606, "post_id": 41592375, "comment_id": 70388383, "body": "Commonly daemons re-read theit configuration on <code>SIGHUP</code>. You should follow that convention. And permanently changing the IP is probably not a good idea anyway."}, {"owner": {"reputation": 105, "user_id": 2982253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f8057bb7a382b6481deb47e9c0f2de1?s=128&d=identicon&r=PG&f=1", "display_name": "Omsitelta", "link": "https://stackoverflow.com/users/2982253/omsitelta"}, "reply_to_user": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1484230444, "post_id": 41592375, "comment_id": 70431955, "body": "@Shark I have tried to do this using the ssc_register service, but I&#39;m not sure if that is what you mean. What server do you refer to?"}, {"owner": {"reputation": 105, "user_id": 2982253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f8057bb7a382b6481deb47e9c0f2de1?s=128&d=identicon&r=PG&f=1", "display_name": "Omsitelta", "link": "https://stackoverflow.com/users/2982253/omsitelta"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484230564, "post_id": 41592375, "comment_id": 70432040, "body": "@Olaf The daemon is not the problem here. It does it works correctly (which is update the network configuration files and ifdown &amp;&amp; ifup to restart the network whe the user wants to change the IP). The IP is not going to change permnently, but it can be changed from time to time and the main application should not be rebooted."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484234701, "post_id": 41592375, "comment_id": 70435052, "body": "That was not my point. Your program should catch <code>SIGHUP</code> and reconnect correctly. You might need your of if-up/down script or dbus integration for this."}, {"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1484236471, "post_id": 41592375, "comment_id": 70436403, "body": "The server you send your initial REGISTRATION request to..."}], "owner": {"reputation": 105, "user_id": 2982253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f8057bb7a382b6481deb47e9c0f2de1?s=128&d=identicon&r=PG&f=1", "display_name": "Omsitelta", "link": "https://stackoverflow.com/users/2982253/omsitelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484141672, "creation_date": 1484141672, "question_id": 41592375, "link": "https://stackoverflow.com/questions/41592375/how-can-i-update-sofia-when-the-current-ip-address-changes", "title": "How can I update sofia when the current Ip address changes?", "body": "<p>I have developed a <strong>small voip client application in C</strong> using sofia library and based on the sofia-sip client example.\nEvertyhing works fine but one thing, if my Ip address changes once the application is running sofia doesn't update itself. I'll explain myself:</p>\n\n<p>When I execute my voip application (running in Linux) sofia takes the current Ip address and the application will accept all the incoming calls to that address.</p>\n\n<p>If the IP of the device where the application is running is changed (updating network config of Linux) <strong>i'm not able to update sofia in order to work with the new ip</strong>, therefore any incoming call is not received. </p>\n\n<p>I've tried with ssc_set_public_address, which updates ssc_address and set the new value in nua using nua_set_params:</p>\n\n<pre><code>/**\n* Sets the public address used for invites, messages,\n* registrations, etc method.\n*/\nvoid ssc_set_public_address(ssc_t *ssc, const char *address)\n{\n  if (address) {\n    su_free(ssc-&gt;ssc_home, ssc-&gt;ssc_address);\n    ssc-&gt;ssc_address = su_strdup(ssc-&gt;ssc_home, address);\n\n    nua_set_params(ssc-&gt;ssc_nua,\n    SIPTAG_FROM_STR(ssc-&gt;ssc_address),\n    TAG_NULL());\n  }\n}\n</code></pre>\n\n<p>After doing it, it looks like the internal ip address has changed (if I read it using get_params I get the new one), however something is missed because no incoming call will be received.</p>\n\n<p>In order to work with the new IP <strong>I need to reboot the whole application</strong>.</p>\n\n<p>Does anybody know how to really update the sofia IP without rebooting the application?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1484141676, "post_id": 41592363, "comment_id": 70387767, "body": "What is the range of <code>signed int</code>?...."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1484141716, "post_id": 41592363, "comment_id": 70387793, "body": "integer overflow (which is undefined behavior on signed integers). Grab a good book and maybe start to learn by reading it. Somewhere on SO is a list of good books."}, {"owner": {"reputation": 7, "user_id": 6116233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8537530e6333855580a3dcee2e54ca62?s=128&d=identicon&r=PG&f=1", "display_name": "Pravesh Shukla", "link": "https://stackoverflow.com/users/6116233/pravesh-shukla"}, "edited": false, "score": 0, "creation_date": 1484151440, "post_id": 41592363, "comment_id": 70394216, "body": "even if i put signed , then also the result is same"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484146324, "post_id": 41592460, "comment_id": 70390835, "body": "&quot; it wraps around modulo 2N where N is the number of bits in the unsigned type.&quot; - not exactly. There can be padding bits. Better to say it wraps modulo <code>UINT_MAX + 1</code>"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1484146534, "last_edit_date": 1484146534, "creation_date": 1484141914, "answer_id": 41592460, "question_id": 41592363, "link": "https://stackoverflow.com/questions/41592363/when-multiplying-large-positive-numbers-why-is-the-result-negative/41592460#41592460", "title": "When multiplying large positive numbers, why is the result negative?", "body": "<p>What you end up with when overflowing an <code>int</code> is <em>undefined behaviour</em>. <code>INT_MAX</code> is defined to be the largest value that an <code>int</code> can represent on your platform.</p>\n\n<p>Note that overflowing an <code>unsigned</code> is well defined: it wraps around modulo <code>UINT_MAX + 1</code>.</p>\n\n<p>(For what it's worth, what's <em>probably</em> happening in your case is that the <code>int</code> is wrapping around in exactly the same way as it would do if the memory is interpreted as an <code>unsigned</code>).</p>\n"}], "owner": {"reputation": 7, "user_id": 6116233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8537530e6333855580a3dcee2e54ca62?s=128&d=identicon&r=PG&f=1", "display_name": "Pravesh Shukla", "link": "https://stackoverflow.com/users/6116233/pravesh-shukla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1484146534, "creation_date": 1484141644, "last_edit_date": 1484143814, "question_id": 41592363, "link": "https://stackoverflow.com/questions/41592363/when-multiplying-large-positive-numbers-why-is-the-result-negative", "title": "When multiplying large positive numbers, why is the result negative?", "body": "<p>Here is the snippets of my code and the output. Suggest the reason behind a negative result when large positive numbers are multiplied?</p>\n\n<pre><code>int printM(int v)\n{\n     int g=v+5;\n     g=g*3344564*452346;\n     printf(\"The value of g is %d\\n\",g);\n     return g;\n}\nint main()\n{\n    int f=0;\n    int a=45;\n    a=a+334;\n    a=a+534534;\n    a=a+939;\n    a=a+45345654645;\n    f=printM(a);\n    return 0;\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>pravesh@pravesh-Aspire-4552:~/Desktop/c_d$ gcc -g linked_list.c \npravesh@pravesh-Aspire-4552:~/Desktop/c_d$ ./a.out \nThe value of g is -377042000\n</code></pre>\n\n<p>\n`</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 5, "creation_date": 1484141505, "post_id": 41592205, "comment_id": 70387656, "body": "You&#39;ll get the right output when you print <code>print_pascal_line(i)</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484142147, "post_id": 41592205, "comment_id": 70388085, "body": "Don&#39;t post images of text! Code-formatting is sufficient to keep the indentation."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1484141556, "creation_date": 1484141556, "answer_id": 41592326, "question_id": 41592205, "link": "https://stackoverflow.com/questions/41592205/how-can-i-print-pascals-triangle-without-using-factorial/41592326#41592326", "title": "How can I print Pascal&#39;s triangle without using factorial?", "body": "<p>You need to call <code>print_pascal_line(i);</code> instead of <code>print_pascal_line(n);</code></p>\n"}], "owner": {"reputation": 35, "user_id": 7401063, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1851aa073836635911a3b9cf6eeb5cc2?s=128&d=identicon&r=PG&f=1", "display_name": "TRUMPI", "link": "https://stackoverflow.com/users/7401063/trumpi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "closed_date": 1484144741, "answer_count": 1, "score": -3, "last_activity_date": 1484142013, "creation_date": 1484141219, "last_edit_date": 1484142013, "question_id": 41592205, "link": "https://stackoverflow.com/questions/41592205/how-can-i-print-pascals-triangle-without-using-factorial", "closed_reason": "Not suitable for this site", "title": "How can I print Pascal&#39;s triangle without using factorial?", "body": "<p>I have written a function that prints spaces in a row of the triangle, and another function that prints the numbers in that row. I have compiled the code, but for some reason it does not give the wanted output:</p>\n\n<p><img src=\"https://i.stack.imgur.com/wHEIf.png\" alt=\"Pascal&#39;s Triangle\"></p>\n\n<p>Here are my functions :</p>\n\n<pre><code>void print_pascal_triangle(int n)\n{\n   int i = 0;\n\n   while (i &lt;= n)\n   {\n    print_space(i, n);\n    print_pascal_line(n);\n    i++;\n    printf(\"\\n\");\n   }\n}\n\nvoid print_pascal_line(int i)\n{\n   int k = 0, num = 1; \n\n   printf(\"1\");\n\n   while (k &lt; i)\n   {\n    num = (num *(i-k))/(k+1); \n    printf(\" %d\", num);\n    k++; \n   }\n\n}\n\nvoid print_space(int i, int n)\n{\n    int space=i;\n    while (space &lt; n) \n   {\n   printf(\" \");\n   space++;\n   }\n}\n</code></pre>\n\n<p>Here is the output I get when n=5:</p>\n\n<p><img src=\"https://i.stack.imgur.com/quYDL.png\" alt=\"Output\"></p>\n"}, {"tags": ["c", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 6, "creation_date": 1484141120, "post_id": 41592051, "comment_id": 70387381, "body": "Getting references to stack based variables is a Bad Idea\u2122."}, {"owner": {"reputation": 13431, "user_id": 7051394, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/035a36a4ffaec4c1c1efd85e34181ace?s=128&d=identicon&r=PG&f=1", "display_name": "Right leg", "link": "https://stackoverflow.com/users/7051394/right-leg"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1484141207, "post_id": 41592051, "comment_id": 70387434, "body": "@Lousy Could you please argument?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1484141276, "post_id": 41592051, "comment_id": 70387476, "body": "<code>newContent-&gt;data = &amp;val;</code> stores address of <code>val</code>. Think about what will happen to <code>val</code> when you return from <code>createContent***</code> function: It&#39;s destroyed, and your address is invalid."}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 1, "creation_date": 1484141297, "post_id": 41592051, "comment_id": 70387496, "body": "Well, for example, <code>int val</code> is passed as a parameter and placed somewhere on the stack, meaning that once you exit the <code>createContentInt</code> function, the <code>data</code> pointer points to the stack area which has been popped. OP needs to use <code>malloc</code> to create the space somewhere on the heap. Alternatively, for a smaller set of possible &quot;content&quot; types, <code>data</code> could be a <code>union</code> of all the possible values user can pass, because then it would be copied by value. That&#39;s a dirtier solution maintenance-wise, but reduces the number of allocations."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5794711"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1484141868, "post_id": 41592051, "comment_id": 70387900, "body": "@user694733 Thank you so very much. That makes perfect sense..!"}], "answers": [{"tags": [], "owner": {"reputation": 3357, "user_id": 3194340, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b99bac217534b05a3f7b957e14025ccc?s=128&d=identicon&r=PG&f=1", "display_name": "n0p", "link": "https://stackoverflow.com/users/3194340/n0p"}, "is_accepted": true, "score": 3, "last_activity_date": 1484141830, "last_edit_date": 1484141830, "creation_date": 1484141206, "answer_id": 41592201, "question_id": 41592051, "link": "https://stackoverflow.com/questions/41592051/structure-pointer-loses-data/41592201#41592201", "title": "Structure pointer loses data", "body": "<pre><code>newContent-&gt;data = &amp;val;\n</code></pre>\n\n<p>You are assigning <code>data</code> with the ADDRESS of your function's parameter (which is on the stack).</p>\n\n<p>If the register that holds <code>val</code> is re-used through successive calls the content of <code>data</code> is overwritten.</p>\n\n<p>More generally, once you exit the function the address of <code>val</code> can be reused at leisure so <code>data</code> will point to garbage.</p>\n\n<p>instead you could, for example:</p>\n\n<pre><code>newContent-&gt;data = malloc(sizeof(TYPE)); // Set TYPE to INT/CHAR/...\n// test return of malloc\nmemcpy(newContent-&gt;data, &amp;val, sizeof(TYPE));\n// Note that you will need an extra function to free() the allocated memory\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5794711"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 41592201, "answer_count": 1, "score": 1, "last_activity_date": 1484144672, "creation_date": 1484140827, "last_edit_date": 1484144672, "question_id": 41592051, "link": "https://stackoverflow.com/questions/41592051/structure-pointer-loses-data", "title": "Structure pointer loses data", "body": "<p>So I'm trying to build a linked list which can accept any data type, more like a non-homogenous list.</p>\n\n<pre><code>#define CNode malloc (sizeof(listnode));\n#define CNodeContent malloc (sizeof(content));\n\ntypedef enum datatypes {\n    CHAR,\n    INT ,\n    FLOAT,\n    STRING,\n    LIST\n}datatype;\n\ntypedef struct contentInfo {\n    void *data;\n    datatype type;\n}content;\n\ntypedef struct node {\n    content* val;\n    struct node *next;\n} listnode;\n\ntypedef listnode* list;\n\n\n// Creating content\n//----------------------------------------------------------------------------------------------\n\ncontent* createContentInt(int val) {\n    content *newContent = CNodeContent;\n    newContent-&gt;type= INT;\n    newContent-&gt;data = &amp;val;\n    return newContent;\n}\n\ncontent* createContentFloat(float val) {\n    content *newContent = CNodeContent;\n    newContent-&gt;type= FLOAT;\n    (newContent-&gt;data) = &amp;val;\n    return newContent;\n}\n\ncontent* createContentChar(char val) {\n    content *newContent = CNodeContent;\n    newContent-&gt;type= CHAR;\n    newContent-&gt;data = &amp;val;\n    return newContent;\n}\n\ncontent* createContentString(char* val) {\n    content *newContent = CNodeContent;\n    newContent-&gt;type= STRING;\n    newContent-&gt;data = val;\n    return newContent;\n}\n\n//---------------------------------------------------------------------------------------------\n\n// List Functions\n\nlist createList(content *cont) {\n    list newnode = CNode;\n    printf(\"\\n--%d--value: %d \",(cont-&gt;type),*((int*)cont-&gt;data));\n    newnode-&gt;val = cont;\n    printf(\"&lt;leh %d &gt;\",(newnode-&gt;val-&gt;type));\n    newnode-&gt;next= NULL;\n    return newnode;\n}\nint main() {\n  list llist = createList(createContentInt(4));\n  content * c = createContentInt(5);\n  printf(\"Main-&gt; %d &lt;\",(*(int*)c-&gt;data));\n  createList(c);\n  /* append(llist,c); */\n  /* display(llist); */\n  /* append(llist,createContentInt(5)); */\n  /* append(llist,createContentInt(6)); */\n  /* display(llist); */\n  return 0;\n}\n</code></pre>\n\n<p>So here is the problem:</p>\n\n<p>When I call <code>createContentInt(4)</code>, it returns the content node properly,\nbut as soon I as call <code>createList</code> or the <code>append</code> function with the same content node, the value <code>data</code> is set to <code>0</code>.</p>\n\n<p>I checked the return value from <code>createContentInt</code> and what not everything works fine except when in <code>createList</code> or <code>append</code>.</p>\n\n<p>Moreover, the <code>content-&gt;type</code> also has the appropriate value but <code>data</code> has lost its.</p>\n\n<p>I have agonized a lot over this searching over the forum and what not but can't seem to find the reason why the value is being set to <code>0</code>\n.\nAnother thing I figured out is if I use something like this:</p>\n\n<pre><code>newContent-&gt;data = (int*)4;\n</code></pre>\n\n<p>the code works fine. What is the difference?</p>\n\n<p>Please, someone, give some insights over why it is not working.\nAny alternate solutions would be highly appreciated, though I'm more inclined to know why it isn't working.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484141133, "post_id": 41591963, "comment_id": 70387390, "body": "A pointer is not an array!"}], "answers": [{"comments": [{"owner": {"reputation": 705, "user_id": 4437044, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f4ef761590498c405d63f6f2e87dad38?s=128&d=identicon&r=PG&f=1", "display_name": "shurrok", "link": "https://stackoverflow.com/users/4437044/shurrok"}, "edited": false, "score": 0, "creation_date": 1484141328, "post_id": 41592004, "comment_id": 70387525, "body": "The first two sentences told me everything. I can see that dynamic part of this language works much different to my picture of it."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 7, "last_activity_date": 1484140709, "creation_date": 1484140709, "answer_id": 41592004, "question_id": 41591963, "link": "https://stackoverflow.com/questions/41591963/how-to-determine-sizeof-array-in-c-using-pointers/41592004#41592004", "title": "How to determine sizeof array in C using pointers?", "body": "<p>You can't. Once an array has decayed to a pointer you no longer have the information about the size of the array. You need to keep track of it some other way.</p>\n\n<p>In your case with the code shown, you could have a second array <code>TAB_SIZES</code> which contains the sizes of the arrays pointed to in <code>TAB</code>.</p>\n\n<hr>\n\n<p>Also remember that for any array or pointer <code>p</code> and index <code>i</code> the expression <code>p[i]</code> is equal to <code>*(p + i)</code>. That means you don't have to do <code>*(TAB[i]+j)</code>. Instead do <code>TAB[i][j]</code>, which feels more \"natural\" to most people.</p>\n"}, {"tags": [], "owner": {"reputation": 4154, "user_id": 3844480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ho59A.jpg?s=128&g=1", "display_name": "ilim", "link": "https://stackoverflow.com/users/3844480/ilim"}, "is_accepted": false, "score": 1, "last_activity_date": 1484141358, "last_edit_date": 1484141358, "creation_date": 1484140828, "answer_id": 41592053, "question_id": 41591963, "link": "https://stackoverflow.com/questions/41591963/how-to-determine-sizeof-array-in-c-using-pointers/41592053#41592053", "title": "How to determine sizeof array in C using pointers?", "body": "<p>When used on an array, sizeof returns the number of elements in that array multiplied by the size of each array, as you may see below.</p>\n\n<pre><code>int a[10];\nsizeof(a); /* returns (sizeof(int) * 10) */\n</code></pre>\n\n<p>See <a href=\"http://ideone.com/eDdhAG\" rel=\"nofollow noreferrer\">here</a> for an example of this code at work.</p>\n\n<p>However, when you assign T1, T2, T3, T4,and T5 as elements of TAB, they are converted to float*, and the information on them being an array is not present in TAB. Consequently, when sizeof is called with the argument TAB[i], it is only interpreted as a pointer to a float, and sizeof(float*) is returned.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484141383, "post_id": 41592175, "comment_id": 70387553, "body": "Don&#39;t use compiler extensions if there are identical standard ways. The gcc documentation itself notest that this is deprecated in forvour of the standard FAM. And this does not answer the question."}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484141721, "post_id": 41592175, "comment_id": 70387798, "body": "@Olaf my gcc doc indicates no deprecation of zero length array. in fact, it elaborates the difference between zla and fam, and the latter, for example, doesn&#39;t have a complete type. what&#39;s your version of documentation?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484142075, "post_id": 41592175, "comment_id": 70388035, "body": "At least since 4.9.3, it states &quot;In ISO C99, <b>you would use</b> a flexible array member, which is slightly different in syntax and semantics:&quot; (C99 should read &quot;C99 and newer&quot; actually, they have not changed that sentence since first appearance). I don&#39;t intend to digg deeper, but I know it was ther in 4.6, too; if you use an older compiler than 4.9.3, you definitively should upgrade. The different semantics don&#39;t matter, but make it actually more correct for usage. Your zero-length array invokes UB for instance. Note that C standard is C11."}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484142159, "post_id": 41592175, "comment_id": 70388097, "body": "@Olaf <a href=\"https://gcc.gnu.org/onlinedocs/gcc-6.3.0/gcc/Zero-Length.html#Zero-Length\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc-6.3.0/gcc/&hellip;</a> there is no a word indicating deprecation in the latest doc. i read <code>you would use</code> as <code>you can also use as an alternative but mind the differences</code>, hence no superiority between both. i also explicitly stated it&#39;s a gcc expansion, which is a part of the side knowledge which completes info didn&#39;t mention in other answer. i don&#39;t see it deserves a downvote."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484142419, "post_id": 41592175, "comment_id": 70388266, "body": "&quot;would use&quot; is much stronger than &quot;may/can&quot;. Nevertheless, you cannot use zero-length arrays for anything else than dynamic allocation anyway! And for the part shown, a FAM will do fine. Don&#39;t use dirty hacks, with modern compilers like gcc which optimise very agressively, this easily breaks your code if you exploit UB. And, again: <b>this is not the point of the question</b>! It does not even use a <code>struct</code>!."}], "tags": [], "owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "is_accepted": false, "score": 0, "last_activity_date": 1484141148, "creation_date": 1484141148, "answer_id": 41592175, "question_id": 41591963, "link": "https://stackoverflow.com/questions/41591963/how-to-determine-sizeof-array-in-c-using-pointers/41592175#41592175", "title": "How to determine sizeof array in C using pointers?", "body": "<p>you have to keep track of it yourself. in GCC, follow extension is supported:</p>\n\n<pre><code>struct sized_array {\n  int size;\n  float array[0];\n}\n</code></pre>\n\n<p>it's called <em>zero length array</em>. and it's how you allocate the memory:</p>\n\n<pre><code>int target_size = 100;\nstruct sized_array *the_array = malloc(sizeof(struct sized_array) + target_size * sizeof(float));\nthe_array-&gt;size = target_size;\n</code></pre>\n\n<p>and <code>the_array</code> automatically contains an array with (at least) 100 float slots. more details you can refer to <code>info gcc</code>, 6.17.</p>\n"}], "owner": {"reputation": 705, "user_id": 4437044, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f4ef761590498c405d63f6f2e87dad38?s=128&d=identicon&r=PG&f=1", "display_name": "shurrok", "link": "https://stackoverflow.com/users/4437044/shurrok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "closed_date": 1484144779, "answer_count": 3, "score": 0, "last_activity_date": 1484145318, "creation_date": 1484140598, "last_edit_date": 1484145318, "question_id": 41591963, "link": "https://stackoverflow.com/questions/41591963/how-to-determine-sizeof-array-in-c-using-pointers", "closed_reason": "Duplicate", "title": "How to determine sizeof array in C using pointers?", "body": "<p>I've got an array which hold pointers to other arrays. I want to print all the values but i can't get the sizeof of the specific array. What am I doing wrong?</p>\n\n<pre><code>int main(void){\n    int i, j;\n    float T1[4]={1.1, 1.2, 1.3, 1.4};\n    float T2[6]={2.1, 2.2, 2.3, 2.4, 2.5, 2.6};\n    float T3[3]={3.1, 3.2, 3.3};\n    float T4[2]={4.1, 4.2};\n    float T5[4]={5.1, 5.2, 5.3, 5.4};\n\n    float *TAB[5]={T1, T2, T3, T4, T5};\n    for(i=0; i&lt;5; i++){\n        for(j=0; j&lt;sizeof(TAB[i])/(sizeof (int)); j++){\n            printf(\"%f \", *(TAB[i]+j));\n        }\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "dynamic", "segmentation-fault", "malloc"], "comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 4, "creation_date": 1484139614, "post_id": 41591621, "comment_id": 70386436, "body": "Please debug your code step-by-step and come back with a more accurate description of the problem."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484140337, "post_id": 41591621, "comment_id": 70386880, "body": "1) <code>array[ start + j -1 ] = array2[j]</code> --&gt; <code>array[ start + j] = array2[j]</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484140424, "post_id": 41591621, "comment_id": 70386951, "body": "2) <code>merge_sort(array, array[0], len);</code> --&gt; <code>merge_sort(array, 0, len-1);</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484142143, "post_id": 41591621, "comment_id": 70388081, "body": "3) <code>while ( m &lt;= end ) {         array2[i] = array[k];         k++;</code> --&gt; <code>while ( m &lt;= end ) {         array2[i] = array[m];         m++;</code>"}, {"owner": {"reputation": 13, "user_id": 7404671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b228785f53ff4de2fe1b72dc185553?s=128&d=identicon&r=PG&f=1", "display_name": "CL89", "link": "https://stackoverflow.com/users/7404671/cl89"}, "edited": false, "score": 0, "creation_date": 1484155384, "post_id": 41591621, "comment_id": 70396752, "body": "thank you very much ...after ich changed 3. it works!"}], "answers": [{"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1484140043, "post_id": 41591764, "comment_id": 70386703, "body": "same for <code>array = malloc(size*sizeof(array));</code> =&gt; <code>array = malloc(size * sizeof *array);</code>"}], "tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": false, "score": 1, "last_activity_date": 1484140112, "last_edit_date": 1484140112, "creation_date": 1484139940, "answer_id": 41591764, "question_id": 41591621, "link": "https://stackoverflow.com/questions/41591621/ive-got-a-segmentation-fault-but-i-dont-find-oo/41591764#41591764", "title": "I&#39;ve got a segmentation fault but I dont find oO?", "body": "<p>At least this is wrong:</p>\n\n<pre><code>int *array2 = malloc(size*sizeof(array2));\n</code></pre>\n\n<p>I think you mean:</p>\n\n<pre><code>int *array2 = malloc(size * sizeof(*array2));\n</code></pre>\n\n<p>You want to allocate <code>size</code> times the size of each entry, not the size of the array pointer.</p>\n\n<p>But (on a 64-bit machine) this will actually make your array half the number of bytes, causing your overrun to happen sooner. You have a logic error that you need to figure out by stepping through your code with a debugger.</p>\n"}], "owner": {"reputation": 13, "user_id": 7404671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b228785f53ff4de2fe1b72dc185553?s=128&d=identicon&r=PG&f=1", "display_name": "CL89", "link": "https://stackoverflow.com/users/7404671/cl89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484140717, "creation_date": 1484139532, "last_edit_date": 1484140717, "question_id": 41591621, "link": "https://stackoverflow.com/questions/41591621/ive-got-a-segmentation-fault-but-i-dont-find-oo", "title": "I&#39;ve got a segmentation fault but I dont find oO?", "body": "<p>It should sort with merge. There are two functions the merge and the sort merge. Some not known functions (read array from file and print array) are totally functional in an input file.</p>\n\n<p>Valgrind show me that the failure is at the allocation from array2 and when it read and write at the 3rd while-loop in void merge.</p>\n\n<pre><code>void merge(int* array, int start, int middle, int end) {\n\n    int size = end - start + 1;\n    int *array2 = malloc(size*sizeof(array2));\n\n    int k = start;\n    int m = middle + 1;\n    int i = 0;\n    int j = 0;\n\n    while ( k &lt;= middle &amp;&amp; m &lt;= end ) {\n        if ( array[k] &lt;= array[m] ) {\n            array2[i] = array[k];\n            k++;        \n        }\n        else {\n            array2[i] = array[m];\n            m++;\n        }\n        i++;\n    }\n    while ( k &lt;= middle ) {\n        array2[i] = array[k];\n        k++;\n        i++;\n    }\n    while ( m &lt;= end ) {\n        array2[i] = array[k];\n        k++;\n        i++;\n    }\n    while ( j &lt; i ) {\n        array[ start + j -1 ] = array2[j];\n        j++;\n    }\n    free(array2);\n}\n\nvoid merge_sort(int* array, int first, int last) {\n\n    int middle;\n\n    if ( first &lt; last ) {\n        middle = ((first+last) / 2);\n        merge_sort (array, first, middle);\n        merge_sort (array, middle + 1, last);\n        merge (array, first, middle, last); \n    }\n}\n\nint main (int argc, char *argv[])\n{\n    if (argc!=3) {\n            printf (\"usage: %s &lt;maximale anzahl&gt;  &lt;dateipfad&gt;\\n\", argv[0]);\n            exit(2);\n        }\n\n    char *filename = argv[2];\n\n    int *array; \n    int size = atoi(argv[1]);    \n    array = malloc(size*sizeof(array));\n\n    int len = read_array_from_file(array, atoi(argv[1]), filename);\n\n    printf(\"Eingabe:\\n\");\n    print_array(array, len);\n\n    merge_sort(array, array[0], len);\n\n    printf(\"Sortiert:\\n\");\n    print_array(array, len);\n\n    free(array);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "stm32", "uart", "adc", "hal"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 6747867, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c22dcfe30ccc757cc2ee8182980409c7?s=128&d=identicon&r=PG&f=1", "display_name": "coollime", "link": "https://stackoverflow.com/users/6747867/coollime"}, "edited": false, "score": 0, "creation_date": 1484295254, "post_id": 41609643, "comment_id": 70460126, "body": "Thanks for your comment. Now, I am reading adc value,but when I used IF Statement in sample code,ADC Value wasn&#39;t read. Can you explain function of HAL_ADC_PollForConversion() ?"}], "tags": [], "owner": {"reputation": 6260, "user_id": 3820025, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zXOn4.png?s=128&g=1", "display_name": "Bence Kaulics", "link": "https://stackoverflow.com/users/3820025/bence-kaulics"}, "is_accepted": false, "score": 1, "last_activity_date": 1484213960, "creation_date": 1484213960, "answer_id": 41609643, "question_id": 41591548, "link": "https://stackoverflow.com/questions/41591548/stm32-reading-adc-value-and-transmitting-using-uart-hal-library/41609643#41609643", "title": "STM32,Reading ADC Value and Transmitting using UART (HAL Library)", "body": "<p>Assuming that you call<code>HAL_ADC_Start(&amp;hadc1)</code> before entering the while loop.\nBasically it is OK to call you code in a <code>while</code> loop, but I have some remarks.</p>\n\n<p>Make sure that <code>ADCValue</code> variable is <code>uint32_t</code> or at least <code>uin16_t</code> as the <a href=\"http://www.st.com/content/ccc/resource/technical/document/user_manual/2f/71/ba/b8/75/54/47/cf/DM00105879.pdf/files/DM00105879.pdf/jcr:content/translations/en.DM00105879.pdf\" rel=\"nofollow noreferrer\">return value</a> of <code>HAL_ADC_GetValue</code> is <code>uint32_t</code>.  If the ADC's resolution is above 8 bit then 1 byte won't be enough to store the result.</p>\n\n<pre><code>HAL_StatusTypeDef HAL_UART_Transmit(UART_HandleTypeDef *huart, uint8_t *pData, uint16_t Size, uint32_t Timeout);\n</code></pre>\n\n<p>The <code>HAL_UART_Transmit</code> expects an <code>uint8_t*</code> as a second parameter, given your code you pass a simple variable. You should use the <code>&amp;</code> operator before <code>ADCValue</code> and cast it to <code>uint8_t*</code>. Also it only sends 1 byte in your code, based on the third parameter. If <code>ADCValue</code> is <code>uint32_t</code> then you should modify this parameter to 4. Also note that you send raw byte value and not ASCII. All in all:</p>\n\n<pre><code>uint32_t ADCValue;\n\nif (HAL_ADC_PollForConversion(&amp;hadc1, 1000000) == HAL_OK)\n{\n    ADCValue = HAL_ADC_GetValue(&amp;hadc1);\n    sprintf(str, \"%d\", ADCValue);\n    HAL_UART_Transmit(&amp;huart2, (uint8_t*)(&amp;ADCValue), 4, 100);\n}\n</code></pre>\n\n<p><code>(&amp;ADCValue)</code> returns the address of <code>ADCValue</code> which is an <code>uint32_t*</code> so it should be casted to <code>uint8_t*</code> when passing to <code>HAL_UART_Transmit</code>. And as an <code>uint32_t</code> is 4 byte, third param should be 4.</p>\n\n<p>If you want to send the <code>str</code> you should calculate its correct length before sending as well.</p>\n\n<p>By the way here is an ADC example from this <a href=\"http://visualgdb.com/tutorials/arm/stm32/adc/\" rel=\"nofollow noreferrer\">STM32 HAL ADC Tutorial</a>.</p>\n\n<pre><code>uint32_t g_ADCValue;    \nint g_MeasurementNumber;\n\n\nint main(void)\n{\n    HAL_Init();\n    SystemClock_Config();\n    ConfigureADC();\n\n    HAL_ADC_Start(&amp;g_AdcHandle);\n    for (;;)\n    {\n        if (HAL_ADC_PollForConversion(&amp;g_AdcHandle, 1000000) == HAL_OK)\n        {\n            g_ADCValue = HAL_ADC_GetValue(&amp;g_AdcHandle);\n            g_MeasurementNumber++;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10144627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4368f36cecd3b4ead68f238dbd757ecc?s=128&d=identicon&r=PG", "display_name": "Wiktor", "link": "https://stackoverflow.com/users/10144627/wiktor"}, "is_accepted": false, "score": -1, "last_activity_date": 1535552702, "last_edit_date": 1535552702, "creation_date": 1535550333, "answer_id": 52078960, "question_id": 41591548, "link": "https://stackoverflow.com/questions/41591548/stm32-reading-adc-value-and-transmitting-using-uart-hal-library/52078960#52078960", "title": "STM32,Reading ADC Value and Transmitting using UART (HAL Library)", "body": "<p>What I did as the simplest working solution was to force an ADC reset:</p>\n\n<pre><code>HAL_StatusTypeDef stat = HAL_ADC_PollForConversion(&amp;hadc1, 900);\n\nif (stat != HAL_OK)  {\n    HAL_ADC_Stop(&amp;hadc1);\n    HAL_ADC_Start(&amp;hadc1);\n}\n</code></pre>\n\n<p>This should be executed earlier than just before GetValue, I had improper action then.</p>\n\n<p>P.S. Sorry for poor visibility</p>\n\n<p>Slightly more elegant would be stopping after GetValue function, yet I left this code as properly working.</p>\n"}], "owner": {"reputation": 137, "user_id": 6747867, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c22dcfe30ccc757cc2ee8182980409c7?s=128&d=identicon&r=PG&f=1", "display_name": "coollime", "link": "https://stackoverflow.com/users/6747867/coollime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14287, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1535552702, "creation_date": 1484139281, "last_edit_date": 1484176242, "question_id": 41591548, "link": "https://stackoverflow.com/questions/41591548/stm32-reading-adc-value-and-transmitting-using-uart-hal-library", "title": "STM32,Reading ADC Value and Transmitting using UART (HAL Library)", "body": "<p>I am new user of STM32(L476RG).I've done some work with Arduino so far. Now,I want to read ADC Value and transmit this value with UART. I setup hardware part and initial software configuration part. I want to know,  this part of code in while loop is correct? </p>\n\n<pre><code>if (HAL_ADC_PollForConversion(&amp;hadc1, 1000000) == HAL_OK)\n{\n    ADCValue = HAL_ADC_GetValue(&amp;hadc1);\n    sprintf(str, \"%d\", ADCValue);\n    HAL_UART_Transmit(&amp;huart2,ADCValue,1,100);\n}\n</code></pre>\n"}, {"tags": ["c", "c-preprocessor", "stdout", "stderr", "console-redirect"], "answers": [{"comments": [{"owner": {"reputation": 930, "user_id": 6594367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/03c046cae270605c2376680482e52f6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6594367/john-doe"}, "edited": false, "score": 0, "creation_date": 1484651082, "post_id": 41591722, "comment_id": 70586742, "body": "Now it makes sense! Thanks for the detailed explanation and for the explicit compare between my problem and the real solution!"}, {"owner": {"reputation": 930, "user_id": 6594367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/03c046cae270605c2376680482e52f6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6594367/john-doe"}, "edited": false, "score": 0, "creation_date": 1484658894, "post_id": 41591722, "comment_id": 70591990, "body": "Even with this solution it won&#39;t make the redirection, my assumption is that stdout and stderr are both compacted in stdout..."}, {"owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "reply_to_user": {"reputation": 930, "user_id": 6594367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/03c046cae270605c2376680482e52f6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6594367/john-doe"}, "edited": false, "score": 0, "creation_date": 1484668717, "post_id": 41591722, "comment_id": 70599090, "body": "That&#39;s strange. It works for me, both in a Unix shell where this syntax originated and on the Windows command line which seems to be what you are using. (If you happen to have Python installed and in your path, you can do the same test I just did: <code>python -c &quot;import sys; sys.stdout.write(&#39;stdout\\n&#39;); sys.stderr.write(&#39;stderr\\n&#39;);&quot;</code> followed by either <code>&gt;test.txt 2&gt;&amp;1</code> or <code>2&gt;&amp;1 &gt;test.txt</code>.) The former puts both &quot;stdout&quot; and &quot;stderr&quot; in the file; the latter puts &quot;stdout&quot; in the file and &quot;stderr&quot; on the console."}, {"owner": {"reputation": 930, "user_id": 6594367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/03c046cae270605c2376680482e52f6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6594367/john-doe"}, "edited": false, "score": 0, "creation_date": 1484669150, "post_id": 41591722, "comment_id": 70599369, "body": "For normal tests it works for me too, but this one is different, it uses some compiler specific options to feed the preprocessed files with some adittional information (line numbers, include paths)..."}, {"owner": {"reputation": 930, "user_id": 6594367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/03c046cae270605c2376680482e52f6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6594367/john-doe"}, "edited": false, "score": 0, "creation_date": 1484744488, "post_id": 41591722, "comment_id": 70634757, "body": "If I only redirect <code>stderr</code> to where <code>stdout</code> is put, the errors are shown in console and the .pp file is empty (from the .ii file, I construct the .pp file and this is ok for now). If I redirect <code>stdout</code> to the <code>.ii</code> files, then <code>stderr</code> appears in the <code>.pp</code> file."}, {"owner": {"reputation": 930, "user_id": 6594367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/03c046cae270605c2376680482e52f6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6594367/john-doe"}, "edited": false, "score": 0, "creation_date": 1484746042, "post_id": 41591722, "comment_id": 70635908, "body": "So my final assumption is that <code>stdout</code> contains the <code>stderr</code> too"}, {"owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "reply_to_user": {"reputation": 930, "user_id": 6594367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/03c046cae270605c2376680482e52f6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6594367/john-doe"}, "edited": false, "score": 0, "creation_date": 1484751372, "post_id": 41591722, "comment_id": 70639739, "body": "Your question and comments refer to <code>.ii</code> and <code>.pp</code> files, but the actual command line you quote mentions only <code>.c</code> and <code>.i</code>. Can we focus on the effects of that command, as distinct from whatever later processing is done? If you say <code>2&gt;&amp;1 </code>&gt;hello.i<code>, where does the command&#39;s error output go? If you redirect only stderr by saying </code>2&gt;errors.txt<code>, where does the error output go? ... Is it possible that </code>dcc` actually just puts its error output on stdout rather than stderr?"}, {"owner": {"reputation": 930, "user_id": 6594367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/03c046cae270605c2376680482e52f6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6594367/john-doe"}, "edited": false, "score": 0, "creation_date": 1484753929, "post_id": 41591722, "comment_id": 70641653, "body": "<code>2&gt;&amp;1 &gt;hello.i</code> - error goes in hello.i file .     <code>2&gt;errors.txt</code> - no information .    That&#39;s why I thought as you mentioned that there is a possibility that it just puts it&#39;s error output on stdout... I will mark your answer as accepted because it does answer the question, but this is a special case"}, {"owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "reply_to_user": {"reputation": 930, "user_id": 6594367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/03c046cae270605c2376680482e52f6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6594367/john-doe"}, "edited": false, "score": 0, "creation_date": 1484754198, "post_id": 41591722, "comment_id": 70641838, "body": "It looks as if <a href=\"http://www.vxdev.com/docs/vx55man/diab5.0ppc/c-invoke.htm\" rel=\"nofollow noreferrer\">this</a> is documentation for another version of the <code>dcc</code> compiler and it seems like it has its own way of redirecting its output. (Search that page for &quot;redirect&quot;.) Does that by any chance let you do what you want?"}], "tags": [], "owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "is_accepted": true, "score": 3, "last_activity_date": 1484139837, "creation_date": 1484139837, "answer_id": 41591722, "question_id": 41591493, "link": "https://stackoverflow.com/questions/41591493/redirecting-stderr-to-file-and-stdout-to-console/41591722#41591722", "title": "Redirecting stderr to file and stdout to console", "body": "<p><code>2&gt;&amp;1</code> doesn't mean \"redirect stderr to console\", it means \"redirect stderr to the same place as stdout currently goes\". If you do the redirections in the other order -- <code>2&gt;&amp;1 1&gt;hello.i</code> instead of <code>1&gt;hello.i 2&gt;&amp;1</code> -- then you will get the effect I believe you are looking for.</p>\n\n<p>You need to think of the redirections happening one at a time. If you say <code>1&gt;hello.i 2&gt;&amp;1</code> then this happens:</p>\n\n<ul>\n<li>First, stdout is redirected to <code>hello.i</code>.</li>\n<li>Then stderr is redirected to the current destination of stdout, namely <code>hello.i</code>.</li>\n</ul>\n\n<p>But if you say <code>2&gt;&amp;1 1&gt;hello.i</code> then this happens:</p>\n\n<ul>\n<li>First, stderr is redirected to the current destination of stdout, namely the console.</li>\n<li>Then stdout is redirected to <code>hello.i</code>.</li>\n</ul>\n"}], "owner": {"reputation": 930, "user_id": 6594367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/03c046cae270605c2376680482e52f6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6594367/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1066, "favorite_count": 0, "accepted_answer_id": 41591722, "answer_count": 1, "score": 0, "last_activity_date": 1484139837, "creation_date": 1484139127, "question_id": 41591493, "link": "https://stackoverflow.com/questions/41591493/redirecting-stderr-to-file-and-stdout-to-console", "title": "Redirecting stderr to file and stdout to console", "body": "<pre><code>dcc  -tPPCE200Z4VEN:simple -Xdialect-ansi -XO -g3 -Xsize-opt -Xsmall-data=0 -Xno-common -Xnested-interrupts -Xdebug-dwarf2 -Xdebug-local-all -Xdebug-local-cie -Xdebug-struct-all -Xforce-declarations -ee1481 -Xmacro-undefined-warn -Xlink-time-lint -W:as:,-l -Wa,-Xisa-vle -Xsmall-const=0 -Xforce-prototypes -Xpass-source -Xkeep-assembly-file -c -Xlint -Xenum-is-best -Xinline=0 -Xaddr-sconst=0x11 -Xaddr-sdata=0x11  -DDISABLE_MCAL_INTERMODULE_ASR_CHECK -DOSDIABPPC -DSC667349 -DFLASH_START -DV_SUPPRESS_EXTENDED_VERSION_CHECK -DV_USE_DUMMY_STATEMENT=STD_OFF -DEU_DISABLE_ANSILIB_CALLS -DMCAL_CER_VALIDATION -DOsAppMode=OSAPPMODEDEFAULT -DSKIP_MAGIC_NUMBER -DRTE_MICROSAR_PIM_EXPORT -DMEMIF_FAST_NVM_ACTIVATED=STD_ON -DESCLmgr_IsENABLED -DESCLmgr_CANrouting_RESvalidity=1 -DFEE_SWITCH_NOT_CONFIG_BLOCKS=STD_OFF -DFILL_NOINIT_WITH_ZERO -Dsrc -ID:\\project\\src -ID:\\project\\obj -E D:\\project\\src\\hello.c 1&gt; D:\\project\\obj\\hello.i 2&gt;&amp;1\n</code></pre>\n\n<p>I am preprocessing a .c file (compiler wind river mpc ), then the stdout is redirected in the .i file and from the .i file, the .pp file is construcred. After that, I am redirecting the stderr to console (<code>2&gt;&amp;1</code>). Check the redirection at the end of the command line above.</p>\n\n<p>I know there are a lot of question on this topic, but I am doing the correct redirectioning, yet the error appear in the .pp file:</p>\n\n<p><code># 4 D:\\project\\src\\hello.c\", line 5: error (dcc:1573): Only Debug builds are supported</code></p>\n\n<p>Is this error actually from the stdout, can't it be splitted?</p>\n"}, {"tags": ["c", "arrays", "null", "trie"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1484138471, "post_id": 41591163, "comment_id": 70385723, "body": "First you should check <code>ne</code> itself. Second you should not read uninitialised objects. &quot;Can I avoid going through the whole array to set pointers to NULL?&quot; - Don&#39;t use their values. But it would be easier to just follow C conventions."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1484138684, "post_id": 41591217, "comment_id": 70385863, "body": "@Stargateur: A clever compiler might convert this to <code>memset</code> anyway (or an heavily optimised inlined variant), as he should know if the architecture uses an all-bits-zero representation for null pointers. Leave implementation details to the toolchain (unless you really identified this as a problem)."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1484138424, "last_edit_date": 1484138424, "creation_date": 1484138341, "answer_id": 41591217, "question_id": 41591163, "link": "https://stackoverflow.com/questions/41591163/how-to-set-all-the-children-to-null-in-the-trie/41591217#41591217", "title": "How to set all the children to NULL in the trie", "body": "<p>A loop is the only way to set all the pointers portably to a NULL value</p>\n\n<pre><code>for (int i = 0; i &lt; 26; ++i)\n  ne-&gt;chil[i] = NULL;\n</code></pre>\n\n<p>You may hear suggestions to use <code>calloc</code> or <code>memset</code>. But a zero-bit pattern is not necessarily the same as a NULL value for a pointer. Even if many platforms implement it that way.</p>\n"}], "owner": {"reputation": 13, "user_id": 7360722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43cf43691ab97228d38733d9104c13ec?s=128&d=identicon&r=PG&f=1", "display_name": "Karol Skalski", "link": "https://stackoverflow.com/users/7360722/karol-skalski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 41591217, "answer_count": 1, "score": 1, "last_activity_date": 1484138424, "creation_date": 1484138183, "last_edit_date": 1592644375, "question_id": 41591163, "link": "https://stackoverflow.com/questions/41591163/how-to-set-all-the-children-to-null-in-the-trie", "title": "How to set all the children to NULL in the trie", "body": "<p>I am trying to implement a trie in C. My code compiles correctly, but when I run it with valgrind it shows an error. here is the problematic part:</p>\n<pre><code>typedef struct node {\nbool end;\nstruct node *chil[26];\n} NODE;\nint main()\n{\n   NODE* ne = (NODE*)malloc(sizeof(NODE)); \n   if(ne-&gt;chil[1] == NULL) printf(&quot;\\nzwyci\u0119stwo!\\n&quot;); \n   free(ne);\n   return 0;\n}\n</code></pre>\n<p>and here is the error report:</p>\n<blockquote>\n<p>==3346== Conditional jump or move depends on uninitialised value(s)</p>\n<p>==3346==    at 0x40076B: main (exp.c:21)</p>\n<p>==3346==  Uninitialised value was created by a heap allocation</p>\n<p>==3346==    at 0x4C2AB80: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-&gt;linux.so)</p>\n<p>==3346==    by 0x40075A: main (exp.c:20)`</p>\n</blockquote>\n<p>I guess I have to explicitly say that</p>\n<pre><code>ne-&gt;chill = {NULL};\n</code></pre>\n<p>but this results in compiler error\n&quot;expected expression&quot;</p>\n<p>What should I do? Can I avoid going through the whole array to set pointers to NULL?</p>\n"}, {"tags": ["c++", "c", "wav"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1484209734, "post_id": 41591157, "comment_id": 70418218, "body": "the posted code does not compile and looks more like C++ than C.  Suggest, at the least, post the header files that are included, which board, which OS, etc"}, {"owner": {"reputation": 83, "user_id": 7313184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4829a0800b66b58de689364dcb2ee468?s=128&d=identicon&r=PG&f=1", "display_name": "gab55", "link": "https://stackoverflow.com/users/7313184/gab55"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1484769824, "post_id": 41591157, "comment_id": 70651311, "body": "here are the library <a href=\"https://developer.mbed.org/users/shintamainjp/code/wavfile/#c853ba46d0b9\" rel=\"nofollow noreferrer\">developer.mbed.org/users/shintamainjp/code/wavfile/&hellip;</a>  i&#39;m using stm32f746, mbed with keil ide"}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484772392, "post_id": 41591157, "comment_id": 70652613, "body": "Hmm... maybe try writing smaller packets of data (since you can handle 4 seconds, maybe try two-second packets, so you can buffer one while the other writes)?  I&#39;m pretty sure that works well with limited memory; I believe it&#39;s how, for example, <i>Tales of Phantasia</i> managed to get the SNES to play a fully voiced opening song, by constantly loading tiny clips from the ROM into the sound processor&#39;s 32 kB RAM.  (It also had a custom sound driver, though, that managed to effectively double the sound RAM, but I digress...)"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7313184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4829a0800b66b58de689364dcb2ee468?s=128&d=identicon&r=PG&f=1", "display_name": "gab55", "link": "https://stackoverflow.com/users/7313184/gab55"}, "edited": false, "score": 0, "creation_date": 1484771075, "post_id": 41608268, "comment_id": 70651967, "body": "i understand what you say but this is not my problem for now. i&#39;m trying to record for a 5 minutes file but i have only 320k of ram on the board and i need to bypass this. how to make a long wav file without making a huge array ?"}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1484786388, "post_id": 41608268, "comment_id": 70658096, "body": "You&#39;ve only got 320K of ram. So 4 seconds of audio at 44.1kHz is going to take more memory that you have. You need to double buffer and process in chunks of maybe 1024 samples, maybe go up if you&#39;re doing some priocessing. ."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1484209632, "creation_date": 1484209632, "answer_id": 41608268, "question_id": 41591157, "link": "https://stackoverflow.com/questions/41591157/how-to-fill-the-data-field-of-wavfile/41608268#41608268", "title": "how to fill the &quot;data field&quot; of wavfile", "body": "<p>things to note: 1) while a write operation is being performed, more data is still coming in.   </p>\n\n<p>At the very least I would double buffer that data, so can be writing one buffer while the other one fills.   </p>\n\n<p>Usually this means using an interrupt to collect the samples (into which ever buffer is currently being filed.) </p>\n\n<p>the foreground program waits for the current buffer to be 'full', then initiates write operation., </p>\n\n<p>then waits again for a buffer to be 'full'   </p>\n\n<p>The interrupt function tracks which buffer is being filled and the current index into that buffer.  When a buffer is full, set a 'global' status to let the foreground program know which buffer is ready to be written.  </p>\n\n<p>The foreground program writes the buffer, then resets the status for that buffer.</p>\n"}], "owner": {"reputation": 83, "user_id": 7313184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4829a0800b66b58de689364dcb2ee468?s=128&d=identicon&r=PG&f=1", "display_name": "gab55", "link": "https://stackoverflow.com/users/7313184/gab55"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1485072631, "creation_date": 1484138170, "last_edit_date": 1484771297, "question_id": 41591157, "link": "https://stackoverflow.com/questions/41591157/how-to-fill-the-data-field-of-wavfile", "title": "how to fill the &quot;data field&quot; of wavfile", "body": "<p>Hi i am trying to record from a board and i have successfully record 4 seconds. Problem is when i try to record for more time, i got an error telling me that there not enough memory. my target is to record a 5 minutes file. Until now i have create a buffer named snIn[256] where are the samples. i send it to a big buffer of [16K * 4sec] and when it is full, i create the wav file.</p>\n\n<pre><code>#include \"SAI_InOut.hpp\"\n#include \"F746_GUI.hpp\"\n#include \"Delay.hpp\"\n#include \"WaveformDisplay.hpp\"\n#include \"SDFileSystem.h\"\n#include \"wavfile.h\"\nusing namespace Mikami;\n\n#define RES_STR_SIZE 0x20\n#define WAVFILE_SAMPLES_PER_SECOND 16000\n#define REC_TIME 4\n\n  //Create an SDFileSystem object\n SDFileSystem sd(\"sd\");\n\nbool flag = 1;\nint count = 0;\nchar *res_buf; \nint rp = 0;\nconst int NUM_SAMPLES = WAVFILE_SAMPLES_PER_SECOND * REC_TIME;\nArray&lt;int16_t&gt; my_buffer(NUM_SAMPLES);\nint j = 0;\nstatic const char *target_filename = \"/sd/rectest.wav\";     \nconst int SEG_SIZE = 256;\nint sent_array = 0;\n\n\nint rec(const char *filename, Array&lt;int16_t&gt; my_buffer)\n{   \n    j = 0;\n    flag = 0;\n    sent_array = 0;\n\n    WavFileResult result;\n    wavfile_info_t info;\n    wavfile_data_t data;\n\n    WAVFILE_INFO_AUDIO_FORMAT(&amp;info)    = 1;\n    WAVFILE_INFO_NUM_CHANNELS(&amp;info)    = 1;\n    WAVFILE_INFO_SAMPLE_RATE(&amp;info)     = WAVFILE_SAMPLES_PER_SECOND;\n    WAVFILE_INFO_BITS_PER_SAMPLE(&amp;info) = 16;\n    WAVFILE_INFO_BYTE_RATE(&amp;info)       = WAVFILE_INFO_NUM_CHANNELS(&amp;info) * WAVFILE_INFO_SAMPLE_RATE(&amp;info) * (WAVFILE_INFO_BITS_PER_SAMPLE(&amp;info) / 8);\n    WAVFILE_INFO_BLOCK_ALIGN(&amp;info)     = 2;\n\n\n    WAVFILE *wf = wavfile_open(filename, WavFileModeWrite, &amp;result);\n    if (result != WavFileResultOK) {\n        wavfile_result_string(result, res_buf, RES_STR_SIZE);\n        printf(\"%s\", res_buf);\n        return result; \n    } else printf (\"Open file success \\r\\n\");\n\n    rp = 0;\n    WAVFILE_DATA_NUM_CHANNELS(&amp;data) = 1;\n\n         result = wavfile_write_info(wf, &amp;info);\n        if (result != WavFileResultOK) {\n            wavfile_result_string(result, res_buf, RES_STR_SIZE);\n            printf(\"%s\", res_buf);\n            return result; } else printf (\"Write info success \\r\\n\");\n\n    while ( rp &lt; NUM_SAMPLES ) {\n        WAVFILE_DATA_CHANNEL_DATA(&amp;data, 0) = my_buffer[rp];       \n        result = wavfile_write_data(wf, &amp;data);\n        rp += 1;\n    }\n\n    if (result != WavFileResultOK) {\n        wavfile_result_string(result, res_buf, RES_STR_SIZE);\n        printf(\"%s\", res_buf);\n        return result; }  else printf (\"Write Data file success \\r\\n\");\n\n    result = wavfile_close(wf);\n    if (result != WavFileResultOK) {\n        wavfile_result_string(result, res_buf , RES_STR_SIZE);\n        printf(\"%s\", res_buf);\n        return result; }  else printf (\"Close file success \\r\\n\");\n\n    //UnMount the filesystem\n    sd.unmount();\n\n    printf(\"Success rec !\\r\\n\");\n    return 0;\n}\n\n\nint main()\n{\n    //Mount the filesystem\n      sd.mount();\n\n    const float MAX_DELAY = 0.5f;       // \u6700\u5927\u9045\u5ef6\uff0c\u5358\u4f4d\uff1a\u79d2\n    const int FS = I2S_AUDIOFREQ_16K;   // \u6a19\u672c\u5316\u5468\u6ce2\u6570: 16 kHz\n    const uint32_t MAX_ARRAY_SIZE = (uint32_t)(MAX_DELAY*FS);\n    SaiIO mySai(SaiIO::BOTH, 256, FS, INPUT_DEVICE_DIGITAL_MICROPHONE_2);\n    Label myLabel(185, 10, \"Delay System\", Label::CENTER, Font16);\n    // ButtonGroup: \"ON\", \"OFF\"\n    const uint16_t BG_LEFT = 370;\n    const uint16_t BG_WIDTH = 100;\n    const uint16_t BG_HEIGHT = 45;\n    ButtonGroup onOff(BG_LEFT, 40, BG_WIDTH/2, BG_HEIGHT,\n                      2, (string[]){\"ON\", \"OFF\"}, 0, 0, 2, 1);\n    const uint16_t SB_LEFT = BG_LEFT - 320;\n    const uint16_t SB_WIDTH = 270;\n    const uint16_t SB_Y0 = 240;\n    char str[20];\n    sprintf(str, \"    %3.1f [s]\", MAX_DELAY);\n    SeekBar barDelay(SB_LEFT, SB_Y0, SB_WIDTH,\n                     0, MAX_ARRAY_SIZE, 0, \"0\", \"\", str);\n    NumericLabel&lt;float&gt; labelDelay(SB_LEFT+SB_WIDTH/2, SB_Y0-40, \"DELEY: %4.2f\", 0, Label::CENTER);\n    DelaySystem delaySystem(MAX_ARRAY_SIZE);\n    WaveformDisplay displayIn(*GuiBase::GetLcdPtr(), SB_LEFT+7, 70, 256, 9,LCD_COLOR_WHITE, LCD_COLOR_CYAN,GuiBase::ENUM_BACK);\n    Label inLabel(SB_LEFT-30, 65, \"IN\");\n    WaveformDisplay displayOut(*GuiBase::GetLcdPtr(), SB_LEFT+7, 130, 256, 9,LCD_COLOR_WHITE, LCD_COLOR_CYAN,GuiBase::ENUM_BACK);\n    Label outLabel(SB_LEFT-30, 125, \"OUT\");\n\n    int runStop = 1;\n    Array&lt;int16_t&gt; snIn(mySai.GetLength());\n    Array&lt;int16_t&gt; snOut(mySai.GetLength());\n\n    mySai.RecordIn();\n    mySai.PlayOut();\n    mySai.PauseOut();\n\n\n    while (true)\n    {\n        // On/OFF\n        int num;\n        if (onOff.GetTouchedNumber(num))\n            if (runStop != num)\n            {\n                if (num == 0) mySai.ResumeOut();\n                else          mySai.PauseOut();\n                runStop = num;\n            }\n\n        if (mySai.IsCompleted())\n        {\n            for (int n=0; n&lt;mySai.GetLength() ; n++)\n            {\n                int16_t xL, xR;\n                mySai.Input(xL,xR);\n                int16_t xn = xL + xR;\n                snIn[n] = xn;\n                my_buffer[j] = xn;\n                j++;\n                if (j == NUM_SAMPLES &amp;&amp; flag == 1) {\n                    rec (target_filename , my_buffer); } \n\n                int16_t yn = delaySystem.Execute(xn);\n                mySai.Output(yn, yn);\n                snOut[n] = yn;  \n            }\n\n            mySai.Reset();     \n            displayIn.Execute(snIn);  \n\n        }     \n    }\n}\n</code></pre>\n\n<p>I thought about a possible solution, to fill directly the \"data field\" of the wavefile with the snIn[256] buffer (instead of using my_buffer) again and again and at the end close the wavfile. Please let me know what you think about that and other solutions</p>\n"}, {"tags": ["c", "casting", "warnings", "fgets"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 4, "creation_date": 1484135964, "post_id": 41590361, "comment_id": 70384020, "body": "<code>buffer</code> is uninitialized. It&#39;s <i>undefined behaviour</i>."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 4, "creation_date": 1484136095, "post_id": 41590361, "comment_id": 70384111, "body": "The code should not emit the warning you cite above. Please show the real code you use"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1484136128, "post_id": 41590361, "comment_id": 70384137, "body": "first, <code>printf(&quot;Error&quot;)</code> --&gt; <code>printf(&quot;Error&quot;);</code> and <code>return 0:</code> --&gt; <code>return 0;</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484137309, "post_id": 41590361, "comment_id": 70384921, "body": "Using an uninitialised variable <i>in general</i> is not undefined behaviour. But you dereference an indeterminate address. That&#39;s something different!"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1484137405, "post_id": 41590405, "comment_id": 70384980, "body": "That&#39;s not exactly correct. Accessing the pointer is not UB in C, but dereferencing it&#39;s value is."}], "tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": false, "score": 0, "last_activity_date": 1484135991, "creation_date": 1484135991, "answer_id": 41590405, "question_id": 41590361, "link": "https://stackoverflow.com/questions/41590361/warning-initialization-makes-integer-from-pointer-without-a-cast-with-fgets/41590405#41590405", "title": "Warning initialization makes integer from pointer without a cast with fgets", "body": "<p>You are using <code>buffer</code> without initialising it, which causes undefined behaviour.</p>\n\n<p>You don't need to use pointer, and can use char array instead (given the max size already defined):</p>\n\n<pre><code>char buffer[MAX_LINIA];\n</code></pre>\n\n<p>The fgets then be better written as:</p>\n\n<pre><code>if(fgets(buffer,sizeof(buffer),stdin)==NULL)\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 5654171, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DHQttW6OW_E/AAAAAAAAAAI/AAAAAAAAAFM/Vxf2Lo_06JA/photo.jpg?sz=128", "display_name": "Arnau Van Boschken ArnauB", "link": "https://stackoverflow.com/users/5654171/arnau-van-boschken-arnaub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 854, "favorite_count": 0, "closed_date": 1484136856, "answer_count": 1, "score": -5, "last_activity_date": 1484135991, "creation_date": 1484135859, "question_id": 41590361, "link": "https://stackoverflow.com/questions/41590361/warning-initialization-makes-integer-from-pointer-without-a-cast-with-fgets", "closed_reason": "Duplicate", "title": "Warning initialization makes integer from pointer without a cast with fgets", "body": "<p>I want want to read a character string, over the stdin, so I have chosen fgets. But I got this warning: initialization makes integer from pointer without a cast.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stddef.h&gt;\n\n#define MAX_LINIA 301\n\nint main(int argc,char *argv[]){\n    char *buffer;\n    printf(\"Enter the input\\n\");\n    if (fgets(buffer,MAX_LINIA-1,stdin)==NULL) printf(\"Error\")\n    else printf(\"%s\", buffer);\n    return 0:\n}\n</code></pre>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1484134223, "post_id": 41589662, "comment_id": 70382914, "body": "<code>const char *filename</code> --&gt; <code>char filename[100];</code>. Also If <code>filename</code> contains a newline, it is necessary to remove it."}, {"owner": {"reputation": 49, "user_id": 5155752, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6e84a1087a171a499f297d0b53e4543a?s=128&d=identicon&r=PG&f=1", "display_name": "Lazu Razvan", "link": "https://stackoverflow.com/users/5155752/lazu-razvan"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1484134414, "post_id": 41589662, "comment_id": 70383037, "body": "I know that code is wrong, i want to know the right alternative"}, {"owner": {"reputation": 149, "user_id": 6527069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed5dafb099cb8d761542704bfc4a8e6?s=128&d=identicon&r=PG&f=1", "display_name": "Ludvig Rydahl", "link": "https://stackoverflow.com/users/6527069/ludvig-rydahl"}, "edited": false, "score": 1, "creation_date": 1484134600, "post_id": 41589662, "comment_id": 70383158, "body": "@LazuRazvan I suggest you read up on the usage of constants (<code>const</code>) in C. There are tons of results just from googling &quot;Using const in C&quot;."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1484135549, "post_id": 41589662, "comment_id": 70383762, "body": "<code>fopen</code> expects a char pointer as argument; the <code>const</code> in the formal parameter list only denotes, that the memory contents pointed to will not be changed by <code>fopen()</code>."}, {"owner": {"reputation": 3697, "user_id": 1848578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7e2bfa9bcb3299428c8321c37db0560?s=128&d=identicon&r=PG", "display_name": "qxz", "link": "https://stackoverflow.com/users/1848578/qxz"}, "edited": false, "score": 0, "creation_date": 1484287587, "post_id": 41589662, "comment_id": 70457065, "body": "The key is not that you&#39;re passing <code>fopen</code> a <code>const char*</code>, but that you&#39;re passing it a <i>pointer to a string</i>. Your problem is thus how to read a <i>string</i> from a file; try googling that, you should get some sort of <code>char</code> array/pointer."}], "answers": [{"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 0, "last_activity_date": 1484142160, "last_edit_date": 1484142160, "creation_date": 1484135782, "answer_id": 41590337, "question_id": 41589662, "link": "https://stackoverflow.com/questions/41589662/how-to-read-const-char-from-files/41590337#41590337", "title": "How to read const char * from files", "body": "<p>You may have seen that <code>fopen()</code> takes an argument of type <code>(const char *)</code>, but you need to be able to modify your string before you pass it to the function. Also, you need to allocate space for your string, and you might consider allocating space for more than 100 <code>char</code>s. The <code>stdio.h</code> header file contains the macro <code>FILENAME_MAX</code>, which expands to an integer constant of the correct size for an array that will hold the longest possible file name string on a system. For example, you can use <code>char filename[FILENAME_MAX];</code>. When the identifier <code>filename</code> is encountered in the call to <code>fopen()</code>, it decays to a pointer to <code>char</code>, which is converted to a pointer to <code>const char</code>, as per the function prototype.</p>\n\n<p>Furthermore, <code>fgets()</code> keeps the newline when if fetches a line of text, so you will need to remove that. You should check the result of <code>fgets()</code>, as it returns a <code>NULL</code> pointer in the event of an error or if it is called at end-of-file; otherwise it returns a pointer to the first <code>char</code> in <code>filename[]</code>.</p>\n\n<pre><code>FILE *a;\na=fopen(\"a.txt\",\"r\");\nchar filename[FILENAME_MAX];\nchar *ch;\n\nch = fgets(filename,FILENAME_MAX,a);\n\n/* Remove trailing newline */\nif (ch) {\n    while (*ch != '\\0' &amp;&amp; *ch != '\\n') {\n        ++ch;\n    }\n    if (*ch == '\\n') {                  // replace '\\n' with '\\0'\n        *ch = '\\0';\n    }\n    image=fopen(filename,\"rb\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1484144271, "creation_date": 1484144271, "answer_id": 41593254, "question_id": 41589662, "link": "https://stackoverflow.com/questions/41589662/how-to-read-const-char-from-files/41593254#41593254", "title": "How to read const char * from files", "body": "<p>First, your seg fault likely comes from trying to use memory that you do not own.  i.e. by creating the variable:</p>\n\n<pre><code>const char *filename;\n</code></pre>\n\n<p>And not giving it any memory (<em><a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_calloc.htm\" rel=\"nofollow noreferrer\">[c][m]alloc</a></em>) before trying to use it.  </p>\n\n<p>Regarding your statement:<br>\n<em>Consequently , i need to read it as a const char*</em>.</p>\n\n<p>Not necessarily.<br>\nThe first argument of the <code>fopen</code> prototype:  <em><a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_fopen.htm\" rel=\"nofollow noreferrer\">\"FILE *fopen(const char *filename, const char *mode)\"</a></em> simply guarantees that the argument passed in that position will be treated as a <code>const char *</code> within the <code>fopen</code> function.\nThe argument can be passed using a simple <code>char *</code>, eg. either of these forms:</p>\n\n<pre><code>char *filename = {\"somefilename.txt\"};\n</code></pre>\n\n<p>or</p>\n\n<pre><code>char filename[80];\nstrcpy(filename, \"somefilename.txt\");\n</code></pre>\n\n<p>And, as mentioned in comments, and other answers, remove the newline character, <code>\\n</code> before passing as an argument.</p>\n"}], "owner": {"reputation": 49, "user_id": 5155752, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6e84a1087a171a499f297d0b53e4543a?s=128&d=identicon&r=PG&f=1", "display_name": "Lazu Razvan", "link": "https://stackoverflow.com/users/5155752/lazu-razvan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3615, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484286765, "creation_date": 1484133969, "last_edit_date": 1484286765, "question_id": 41589662, "link": "https://stackoverflow.com/questions/41589662/how-to-read-const-char-from-files", "title": "How to read const char * from files", "body": "<p>I need to <code>read</code> a <code>filename</code> from a text file. \nThen I have to use it as an argument for <code>fopen</code> . \nConsequently , I need to read it as a <code>const char*</code> because this is the type <code>fopen</code> accepts as a first argument. How do I do this? </p>\n\n<p>I tried something like:</p>\n\n<pre><code> FILE *a;\n a=fopen(\"a.txt\",\"r\");\n const char *filename\n fgets(filename,100,a);\n image=fopen(filename,\"rb\");\n</code></pre>\n\n<p>Something is be wrong as I receive a segmentation fault when I do this. I think that the variable <code>filename</code> is not well-received by the <code>fopen</code> function.</p>\n"}, {"tags": ["c", "variables", "pointers", "char"], "comments": [{"owner": {"reputation": 41796, "user_id": 1870232, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rbI29.jpg?s=128&g=1", "display_name": "P0W", "link": "https://stackoverflow.com/users/1870232/p0w"}, "edited": false, "score": 6, "creation_date": 1484133428, "post_id": 41589448, "comment_id": 70382377, "body": "<code>p</code> is a pointer to an unallocated memory space ."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1484133831, "last_edit_date": 1484133831, "creation_date": 1484133518, "answer_id": 41589500, "question_id": 41589448, "link": "https://stackoverflow.com/questions/41589448/char-pointer-how-can-i-debug-this-code/41589500#41589500", "title": "char pointer- How can I debug this code?", "body": "<p>Undefined behavior. You don't set <code>p</code> to point to any valid memory location. So <code>*p = c</code> does not a well defined program make.</p>\n\n<p>You can either have <code>p</code> point to a fixed sized buffer (if you <strong>know</strong> input will never be beyond a certain number of characters):</p>\n\n<pre><code>char buff[MAX_SIZE];\nchar *p = buff;\n</code></pre>\n\n<p>Or use dynamic memory allocation:</p>\n\n<pre><code>char *p = malloc(INITIAL_SIZE);\nsize_t current_size = INITIAL_SIZE;\n// Later\nif (p - initial == current_size) {\n  char *buff_new = realloc(initial, current_size * 2);\n  if (buff_new) {\n    initial = buff_new;\n    p = initial + current_size;\n    current_size *= 2;\n  }\n  else\n    // should probably abort here, the program is out of memory. Bad bad bad.\n}\n</code></pre>\n"}], "owner": {"reputation": 525, "user_id": 4418163, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/0bd3eaa3560a67a8b2117c7aa02c18ec?s=128&d=identicon&r=PG", "display_name": "Atul", "link": "https://stackoverflow.com/users/4418163/atul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "closed_date": 1484133603, "accepted_answer_id": 41589500, "answer_count": 1, "score": -1, "last_activity_date": 1484144310, "creation_date": 1484133358, "last_edit_date": 1484144310, "question_id": 41589448, "link": "https://stackoverflow.com/questions/41589448/char-pointer-how-can-i-debug-this-code", "closed_reason": "Duplicate", "title": "char pointer- How can I debug this code?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\n    char *p, *initial;\n    int c, in=0;\n\n    for(initial=p; (c = getchar()) != EOF; p++, in++)\n        *p = c;\n\n    for(int i=0; i&lt;in; i++)\n        printf(\"%p = %c\\n\", initial, *initial++);\n}\n</code></pre>\n\n<p>For an input like <code>hello hai</code>, the program gives incomplete output:</p>\n\n<pre><code>0028FF29 = h\n0028FF2A = e\n0028FF2B = l\n0028FF2C = l\n0028FF2D = \u00a0\n0028FF2E = \u00a0\n0028FF2F = \u00a0\n0028FF30 = \u00a0\n0028FF31 =\n</code></pre>\n\n<p>It is working fine for small text, but it's not working for large text.</p>\n"}, {"tags": ["c", "cmake", "windows64"], "comments": [{"owner": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "edited": false, "score": 0, "creation_date": 1484134485, "post_id": 41589430, "comment_id": 70383077, "body": "Have you tried creating your own <a href=\"https://cmake.org/cmake/help/v3.7/manual/cmake-toolchains.7.html\" rel=\"nofollow noreferrer\">CMake Toolchain file</a>?  We do something similar to the cross-compiling for Linux.  Since we build for both the host and an embedded target, we specify the toolchain on the command line with <code>-DCMAKE_TOOLCHAIN_FILE=path&#47;to&#47;toolchain.cmake</code>."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1484134665, "post_id": 41589430, "comment_id": 70383206, "body": "<code>CMake cannot identify my compiler (TriCore_v6.0r1).</code> - Try to identify compiler in toolchain, by setting <a href=\"https://cmake.org/cmake/help/v3.7/variable/CMAKE_LANG_COMPILER_ID.html\" rel=\"nofollow noreferrer\">CMAKE_C_COMPILER_ID</a> variable. If none of indentification, listed in the doc, suits for your case, you may use any string. At least, this will omit compilation of <code>CMakeCCompilerId.c</code>, which is failed for you."}, {"owner": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1484134703, "post_id": 41589430, "comment_id": 70383226, "body": "Welcome to StackOverflow. Can you please please add your toolchain file? Just from the output there seems to be something weird going on. If you really have to force the compiler using <code>SET(CMAKE_C_COMPILER_WORKS 1 CACHE INTERNAL &quot;&quot;)</code> and <code>SET(CMAKE_CXX_COMPILER_WORKS 1 CACHE INTERNAL &quot;&quot;)</code> does still work also with newer versions of CMake."}, {"owner": {"reputation": 151, "user_id": 7404098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1381f2010e9a133e75cebf945472f8?s=128&d=identicon&r=PG&f=1", "display_name": "ichiwahato", "link": "https://stackoverflow.com/users/7404098/ichiwahato"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1484141287, "post_id": 41589430, "comment_id": 70387485, "body": "@Tsyvarev I set the variable <code>CMAKE_C_COMPILER_ID</code> to my own string, however <code>CMakeCCompilerId.c</code> compilation is still attempted and fails due to the <code>-Aa</code> flag."}, {"owner": {"reputation": 151, "user_id": 7404098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1381f2010e9a133e75cebf945472f8?s=128&d=identicon&r=PG&f=1", "display_name": "ichiwahato", "link": "https://stackoverflow.com/users/7404098/ichiwahato"}, "reply_to_user": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "edited": false, "score": 0, "creation_date": 1484141470, "post_id": 41589430, "comment_id": 70387629, "body": "@jszakmeister, Yes I have a Toolchain file for this compiler which specifies the compiler install and ID etc."}, {"owner": {"reputation": 151, "user_id": 7404098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1381f2010e9a133e75cebf945472f8?s=128&d=identicon&r=PG&f=1", "display_name": "ichiwahato", "link": "https://stackoverflow.com/users/7404098/ichiwahato"}, "reply_to_user": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1484141829, "post_id": 41589430, "comment_id": 70387871, "body": "@Florian Thanks for the hint.  Forcing the compiler with <code>SET(CMAKE_C_COMPILER_WORKS 1 CACHE INTERNAL &quot;&quot;)</code> somehow makes CMake misidentify the compiler as GNU,   <code>The C compiler identification is GNU 4.8.1</code>   despite specifying the TASKING path in the toolchain file.  I&#39;ll post the Toolchain file."}, {"owner": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1484146350, "post_id": 41589430, "comment_id": 70390862, "body": "Ok, you are then still missing to set <code>CMAKE_C_COMPILER_ID</code> to <code>ctc</code>. And one problem with your toolchain could be that you are prefixing some scripts before your compiler/linker calls. That&#39;s something normally added via <a href=\"https://cmake.org/cmake/help/latest/prop_gbl/RULE_LAUNCH_COMPILE.html\" rel=\"nofollow noreferrer\"><code>RULE_LAUNCH_COMPILE</code></a> and <a href=\"https://cmake.org/cmake/help/latest/prop_gbl/RULE_LAUNCH_LINK.html\" rel=\"nofollow noreferrer\"><code>RULE_LAUNCH_LINK</code></a> global properties."}, {"owner": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1484148691, "post_id": 41589430, "comment_id": 70392397, "body": "And it looks like you are mixing environment variables with normal CMake variables. If you actually wanted to set/overwrite environment variables then you would have to call <code>SET(ENV{CC} &quot;${CCPATH}&#47;ctc&#47;bin&#47;cctc.exe&quot;)</code> and <code>SET(ENV{CXX} &quot;${CCPATH}&#47;ctc&#47;bin&#47;cctc.exe&quot;)</code>."}, {"owner": {"reputation": 151, "user_id": 7404098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1381f2010e9a133e75cebf945472f8?s=128&d=identicon&r=PG&f=1", "display_name": "ichiwahato", "link": "https://stackoverflow.com/users/7404098/ichiwahato"}, "reply_to_user": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1484149838, "post_id": 41589430, "comment_id": 70393131, "body": "@Florian, Thanks!  I didn&#39;t know about that - I updated my outermost <code>CMakeLists.txt</code> file to call the perl scripts.  The GNU confusion was solved by adding the <code>CMAKE_C_COMPILER</code> variable to the toolchain file instead the cmake commandline call.  It looks like cmake was re-called and didn&#39;t get this variable again.   Compilation of the project is now starting, but still some problems.  I am often receiving the notification that <code>Detecting C compiler ABI info - failed</code>"}, {"owner": {"reputation": 151, "user_id": 7404098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1381f2010e9a133e75cebf945472f8?s=128&d=identicon&r=PG&f=1", "display_name": "ichiwahato", "link": "https://stackoverflow.com/users/7404098/ichiwahato"}, "reply_to_user": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1484149971, "post_id": 41589430, "comment_id": 70393211, "body": "@Florian  And another possible symptom - receiving compile errors that some header files cannot be opened when scanning the dependencies of my project"}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 7404098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1381f2010e9a133e75cebf945472f8?s=128&d=identicon&r=PG&f=1", "display_name": "ichiwahato", "link": "https://stackoverflow.com/users/7404098/ichiwahato"}, "is_accepted": false, "score": 5, "last_activity_date": 1605879152, "last_edit_date": 1605879152, "creation_date": 1484233212, "answer_id": 41616333, "question_id": 41589430, "link": "https://stackoverflow.com/questions/41589430/cmake-c-compiler-identification-fails/41616333#41616333", "title": "CMake C compiler identification fails", "body": "<p>Thanks to everyone who replied!</p>\n<p>As @Florian suggested, the compiler could be forced by setting the variables</p>\n<pre><code>SET(CMAKE_C_COMPILER_WORKS TRUE CACHE INTERNAL &quot;&quot;)\nSET(CMAKE_CXX_COMPILER_WORKS TRUE CACHE INTERNAL &quot;&quot;)\n</code></pre>\n<p>However, I also noticed that the above variables are <strong>unset</strong> without the following:</p>\n<pre><code>SET(CMAKE_C_COMPILER_FORCED TRUE CACHE INTERNAL &quot;&quot;)\nSET(CMAKE_CXX_COMPILER_FORCED TRUE CACHE INTERNAL &quot;&quot;)\n</code></pre>\n<p>Finally, another pair of variables needed to be set to prevent an attempt to identify the compiler:</p>\n<pre><code>SET(CMAKE_C_COMPILER_ID_RUN TRUE CACHE INTERNAL &quot;&quot;)\nSET(CMAKE_CXX_COMPILER_ID_RUN TRUE CACHE INTERNAL &quot;&quot;)\n</code></pre>\n<p>However, it should be noted what Brad King remarks <a href=\"https://gitlab.kitware.com/cmake/cmake/-/issues/19539\" rel=\"nofollow noreferrer\">in this ticket</a>:</p>\n<blockquote>\n<p>Those toolchain files are setting internal CMake variables like</p>\n<pre><code>set(CMAKE_C_COMPILER_ID_RUN TRUE)\nset(CMAKE_C_COMPILER_FORCED TRUE)\nset(CMAKE_C_COMPILER_WORKS TRUE)\n</code></pre>\n<p>That is not supported because it causes CMake to skip its internal\nchecks that are used to populate other internal settings.  <strong>Any\ntoolchain file that does that is taking responsibility for updating to\nset other internal variables as they are added.</strong></p>\n</blockquote>\n"}], "owner": {"reputation": 151, "user_id": 7404098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1381f2010e9a133e75cebf945472f8?s=128&d=identicon&r=PG&f=1", "display_name": "ichiwahato", "link": "https://stackoverflow.com/users/7404098/ichiwahato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6672, "favorite_count": 3, "answer_count": 1, "score": 6, "last_activity_date": 1605879152, "creation_date": 1484133288, "last_edit_date": 1484142754, "question_id": 41589430, "link": "https://stackoverflow.com/questions/41589430/cmake-c-compiler-identification-fails", "title": "CMake C compiler identification fails", "body": "<p>Recently updated CMake to version 3.7.1 from 2.8.1, which was working perfectly.</p>\n\n<p>The update required the removal of the deprecated <code>CMAKE_FORCE_C_COMPILER</code> command from the toolchain file, which was used to skip the automatic check for a working compiler.   </p>\n\n<p>I tried to set the variable, <code>SET(CMAKE_TRY_COMPILE_TARGET_TYPE STATIC_LIBRARY)</code> to skip the test, but there is no change in behaviour.</p>\n\n<p>Now that the checks seem to be required, CMake cannot identify my compiler (TriCore_v6.0r1). </p>\n\n<hr>\n\n<p>Error messages:</p>\n\n<blockquote>\n  <p>The C compiler identification could not be found in \"C:/Build/CMakeFiles/3.7.1/CompilerIdC/CMakeCCompilerId.elf\"</p>\n  \n  <p>The C compiler identification could not be found in \"C:/Build/CMakeFiles/3.7.1/CompilerIdC/CMakeCCompilerId.map\"</p>\n  \n  <p>The C compiler identification could not be found in \"C:/Build/CMakeFiles/3.7.1/CompilerIdC/CMakeCCompilerId.mdf\"</p>\n  \n  <p>The C compiler identification could not be found in \"C:/Build/CMakeFiles/3.7.1/CompilerIdC/CMakeCCompilerId.o\"</p>\n  \n  <p>Compiling the C compiler identification source file \"CMakeCCompilerId.c\" failed.\n  Compiler: C:/TASKING/TriCore_v6.0r1/ctc/bin/cctc.exe \n  Build flags: \n  Id flags: -Aa</p>\n</blockquote>\n\n<p>Note: according to the usage, the compiler doesn't accept this flag (-Aa)</p>\n\n<blockquote>\n  <p>The output was:</p>\n  \n  <p>1</p>\n  \n  <p>ctc E200: commandline: option \"-A\": invalid sub-option \"a\"</p>\n  \n  <p>The C compiler identification could not be found in \"C:/Build/CMakeFiles/3.7.1/CompilerIdC/CMakeCCompilerId.elf\"</p>\n  \n  <p>The C compiler identification could not be found in \"C:/Build/CMakeFiles/3.7.1/CompilerIdC/CMakeCCompilerId.map\"</p>\n  \n  <p>The C compiler identification could not be found in \"C:/Build/CMakeFiles/3.7.1/CompilerIdC/CMakeCCompilerId.mdf\"</p>\n  \n  <p>Checking whether the C compiler is IAR using \"\" did not match \"IAR .+ Compiler\": </p>\n</blockquote>\n\n<p>Ideally I'd like the compiler to be recognised, but as Altium does not support the CMake tool, I'd settle for skipping these checks if it solves my problem and allows me to build successfully again.</p>\n\n<p>Toolchain file:</p>\n\n<pre><code>#################################\n# CMake Tool Chain File\n# for TASKING Build Environment\n#################################\n\n# Deprecated!\n# INCLUDE(CMakeForceCompiler)\n\n# Skip CMake\u2019s checks for a working compiler by omitting compilation of CMakeCCompilerId.c\n# SET(CMAKE_C_COMPILER_ID \"Tasking\") \n\n# Try to force the compiler\nSET(CMAKE_C_COMPILER_WORKS 1 CACHE INTERNAL \"\")\nSET(CMAKE_CXX_COMPILER_WORKS 1 CACHE INTERNAL \"\")\n\n# Use of \"Generic\", because target system is an embedded device\nSET(CMAKE_SYSTEM_NAME Generic)\nSET(CMAKE_SYSTEM_VERSION 1)\nSET(can_use_assembler TRUE)\n\n# Specify the cross compiler\nSET(CCPATH $ENV{TASKING_PATH})\nSET(CC \"${CCPATH}/ctc/bin/cctc.exe\")\nSET(CXX \"${CCPATH}/ctc/bin/cctc.exe\")\n\nSET(CMAKE_AR \"${CCPATH}/ctc/bin/artc.exe\" CACHE FILEPATH \"Archiver\")\n\n# Deprecated! \n# Force CMake to use the specified cross compiler\n# CMAKE_FORCE_C_COMPILER (${CC} ctc)\n# CMAKE_FORCE_CXX_COMPILER (${CXX} ctc)\n\n\nSET(CCVERBOSE \"\")\n\n# Specify compiler call notation and compiler flags\nSET(CMAKE_C_COMPILE_OBJECT \"${CMAKE_CURRENT_SOURCE_DIR}/../../DevelopmentEnv/BuildEnv/BuildUtilities/bin/perl.exe ${CMAKE_CURRENT_SOURCE_DIR}/../../DevelopmentEnv/BuildEnv/BuildUtilities/compliation_manager.pl &lt;CMAKE_C_COMPILER&gt;  &lt;DEFINES&gt;  &lt;FLAGS&gt; -o &lt;OBJECT&gt; &lt;SOURCE&gt; -c\")\n\n# Specify linker call notation and linker flags\n#SET(CMAKE_C_LINK_EXECUTABLE \"&lt;CMAKE_C_COMPILER&gt; &lt;OBJECTS&gt; &lt;CMAKE_C_LINK_FLAGS&gt; &lt;LINK_FLAGS&gt; -r -o &lt;TARGET&gt;\")\n#The Call to the perl script to manage the cross core linking, and will call the linker and scripts for updating the symbols\nSET(CMAKE_C_LINK_EXECUTABLE \"${CMAKE_CURRENT_SOURCE_DIR}/../../DevelopmentEnv/BuildEnv/BuildUtilities/bin/perl.exe ${CMAKE_CURRENT_SOURCE_DIR}/../../DevelopmentEnv/BuildEnv/BuildUtilities/linking_manager.pl -DListOfObjects &lt;CMAKE_C_LINK_FLAGS&gt; &lt;LINK_FLAGS&gt; -o &lt;TARGET&gt;  -Wl--output=${PROJECT_NAME}.hex:IHEX:4,linear\")\n\n# search for programs in the build host directories\nSET(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)\n\n# search for libraries and headers in the target directories\nSET(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)\nSET(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)\n\n#Commented as previously used for Greenhills\n#SET (MAP_OPTIONS \"-map=${PROJECT_NAME}.map -Ml -Mu -Mx -keepmap\")\n\nSET (CORE0_C_FLAGS ${CCVERBOSE} \"-t --core=tc1.6.x --iso=90 --eabi-compliant --integer-enumeration --language=-comments,-gcc,+volatile,-strings --switch=auto --align=0 --default-near-size=0 --default-a0-size=0 --default-a1-size=0 -O2ROPYG --tradeoff=4 -g --source -DOS_TRICOREARCH=OS_TRICOREARCH_16EP -DOS_CPU=OS_TC29XT -DUSE_TASKING_INIT=1 -DCOMPILERCFG_EXTENSION_MCAL_FILE -D__TRICORE -DDEM_DONT_PROVIDE_LEGACY_SYMBOLIC_NAMES  -DTS_ARCH_FAMILY=TS_TRICORE -DTS_ARCH_DERIVATE=TS_TC29XT -DOS_KERNEL_TYPE=OS_SYSTEM_CALL -DOS_USE_TRACE=0 -DOS_USE_CLZ_QUEUE_ALGORITHM=1 -DOS_DEVELOPMENT_SANITY_CHECKS=0 -DOS_MEMORY_MODEL=OS_MM_DEFAULT -DOS_MEMMAP=0 -DOS_MULTICORE=OS_SINGLE -DOS_TRICORE_USED_CORE=0 -DOS_CPU=OS_TC29XT -DOS_TOOL=OS_tasking -DOS_ARCH=OS_TRICORE -DOS_RELEASE_SUFFIX=OS_AS403\")\nSET (CORE0_LINK_FILE \"${CMAKE_CURRENT_SOURCE_DIR}/99_Env/LinkerScript/Core0-TRICORE-tasking.lsl\")\nSET (CORE0_LIB \"${CMAKE_CURRENT_SOURCE_DIR}/01_Static/04_OS/Os_AS403/Lib/Os_c2038bfb98_kern_lib_SoRoooS0.a ${CMAKE_CURRENT_SOURCE_DIR}/01_Static/04_OS/Os_AS403/Lib/Os_ca2b8bdbb8_kern_lib_SoRoooS0.a ${CMAKE_CURRENT_SOURCE_DIR}/01_Static/04_OS/Os_AS403/Lib/Os_Extended_error_lib_SoRoooS0.a ${CMAKE_CURRENT_SOURCE_DIR}/01_Static/04_OS/Os_AS403/Lib/Os_Static_kern_lib_SoRoooS0.a ${CMAKE_CURRENT_SOURCE_DIR}/01_Static/04_OS/Os_AS403/Lib/Os_Static_user_lib_SoRoooS0.a\")\nSET (CORE0_LINK_FLAGS ${CCVERBOSE} \"-lrt -lc -DCore=0 -Wl--define=PreLink=ON -I${CMAKE_CURRENT_SOURCE_DIR}/01_Static/01_App/boards/TriboardTC29XT ${CORE0_LIB} -Wl-OCLtxY -Wl--error-limit=0 --map-file-format=+lsl --library=fp_fpu -d ${CORE0_LINK_FILE}\" )\n\nSET (CORE1_C_FLAGS ${CCVERBOSE} \"-t --core=tc1.6.x --iso=90 --eabi-compliant --integer-enumeration --language=-comments,-gcc,+volatile,-strings --switch=auto --align=0 --default-near-size=0 --default-a0-size=0 --default-a1-size=0 -O2ROPYG --tradeoff=4 -g --source -DOS_TRICOREARCH=OS_TRICOREARCH_16EP -DOS_CPU=OS_TC29XT -DUSE_TASKING_INIT=0 -DCOMPILERCFG_EXTENSION_MCAL_FILE -D__TRICORE -DDEM_DONT_PROVIDE_LEGACY_SYMBOLIC_NAMES  -DTS_ARCH_FAMILY=TS_TRICORE -DTS_ARCH_DERIVATE=TS_TC29XT -DOS_KERNEL_TYPE=OS_SYSTEM_CALL -DOS_USE_TRACE=0 -DOS_USE_CLZ_QUEUE_ALGORITHM=1 -DOS_DEVELOPMENT_SANITY_CHECKS=0 -DOS_MEMORY_MODEL=OS_MM_DEFAULT -DOS_MEMMAP=0 -DOS_MULTICORE=OS_SINGLE -DOS_TRICORE_USED_CORE=1 -DOS_CPU=OS_TC29XT -DOS_TOOL=OS_tasking -DOS_ARCH=OS_TRICORE -DOS_RELEASE_SUFFIX=OS_AS403\")\nSET (CORE1_LINK_FILE \"${CMAKE_CURRENT_SOURCE_DIR}/99_Env/LinkerScript/Core1-TRICORE-tasking.lsl\")\nSET (CORE1_LIB \"${CMAKE_CURRENT_SOURCE_DIR}/01_Static/04_OS/Os_AS403/Lib/Os_c203cbfb98_kern_lib_SoRoooS0.a ${CMAKE_CURRENT_SOURCE_DIR}/01_Static/04_OS/Os_AS403/Lib/Os_Extended_error_lib_SoRoooS0.a ${CMAKE_CURRENT_SOURCE_DIR}/01_Static/04_OS/Os_AS403/Lib/Os_Static_user_lib_SoRoooS0.a\")\nSET (CORE1_LINK_FLAGS ${CCVERBOSE} \"-lrt -lc -DCore=1 -Wl--define=PreLink=ON -DSPM_PATH=${CMAKE_CURRENT_SOURCE_DIR}/01_Static/01_App/application/cvc/obj/ -I${CMAKE_CURRENT_SOURCE_DIR}/01_Static/01_App/boards/TriboardTC29XT ${CORE1_LIB} -Wl-OCLtxY -Wl--error-limit=0  --user-provided-initialization-code --library=fp_fpu -d ${CORE1_LINK_FILE}\")\n\nSET (CORE2_C_FLAGS ${CCVERBOSE} \"-t --core=tc1.6.x --iso=90 --eabi-compliant --integer-enumeration --language=-comments,-gcc,+volatile,-strings --switch=auto --align=0 --default-near-size=0 --default-a0-size=0 --default-a1-size=0 -O2ROPYG --tradeoff=4 -g --source -DOS_TRICOREARCH=OS_TRICOREARCH_16EP -DOS_CPU=OS_TC29XT -DUSE_TASKING_INIT=0 -DCOMPILERCFG_EXTENSION_MCAL_FILE -D__TRICORE -DDEM_DONT_PROVIDE_LEGACY_SYMBOLIC_NAMES  -DTS_ARCH_FAMILY=TS_TRICORE -DTS_ARCH_DERIVATE=TS_TC29XT -DOS_KERNEL_TYPE=OS_SYSTEM_CALL -DOS_USE_TRACE=0 -DOS_USE_CLZ_QUEUE_ALGORITHM=1 -DOS_DEVELOPMENT_SANITY_CHECKS=0 -DOS_MEMORY_MODEL=OS_MM_DEFAULT -DOS_MEMMAP=0 -DOS_MULTICORE=OS_SINGLE -DOS_TRICORE_USED_CORE=2 -DOS_CPU=OS_TC29XT -DOS_TOOL=OS_tasking -DOS_ARCH=OS_TRICORE -DOS_RELEASE_SUFFIX=OS_AS403\")\nSET (CORE2_LINK_FILE \"${CMAKE_CURRENT_SOURCE_DIR}/99_Env/LinkerScript/Core2-TRICORE-tasking.lsl\")\nSET (CORE2_LIB \"${CMAKE_CURRENT_SOURCE_DIR}/01_Static/04_OS/Os_AS403/Lib/Os_c203cbfb98_kern_lib_SoRoooS0.a ${CMAKE_CURRENT_SOURCE_DIR}/01_Static/04_OS/Os_AS403/Lib/Os_Extended_error_lib_SoRoooS0.a ${CMAKE_CURRENT_SOURCE_DIR}/01_Static/04_OS/Os_AS403/Lib/Os_Static_user_lib_SoRoooS0.a \")\nSET (CORE2_LINK_FLAGS ${CCVERBOSE} \"-lrt -lc -DCore=2 -Wl--define=PreLink=ON -I${CMAKE_CURRENT_SOURCE_DIR}/01_Static/01_App/boards/TriboardTC29XT ${CORE2_LIB} -Wl-OCLtxY -Wl--error-limit=0 -Wl--user-provided-initialization-code  --library=fp_fpu -d ${CORE2_LINK_FILE}\")\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116, "user_id": 5935281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f8a36248e8a6ae32b2b5a6e853f18bb?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5935281/jonathan"}, "edited": false, "score": 0, "creation_date": 1484133875, "post_id": 41589428, "comment_id": 70382685, "body": "isn&#39;t scanf blocking... meaning it will actually pause each 20 until the user reacts"}, {"owner": {"reputation": 2241, "user_id": 4004188, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jYWzx.jpg?s=128&g=1", "display_name": "Maulik", "link": "https://stackoverflow.com/users/4004188/maulik"}, "reply_to_user": {"reputation": 116, "user_id": 5935281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f8a36248e8a6ae32b2b5a6e853f18bb?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5935281/jonathan"}, "edited": false, "score": 0, "creation_date": 1484134338, "post_id": 41589428, "comment_id": 70382995, "body": "Yes, that&#39;s what I want. scanf will ask user input after each 20 lines."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484137762, "post_id": 41589428, "comment_id": 70385231, "body": "Sidenote: <code>flag</code>s are typically boolean values, not pointers. Using moire appropriate names makes code much more clear and help spotting logical errors."}], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 2, "last_activity_date": 1484133542, "creation_date": 1484133542, "answer_id": 41589509, "question_id": 41589428, "link": "https://stackoverflow.com/questions/41589428/while-loop-condition-doesnt-terminate-when-reading-file-is-finished/41589509#41589509", "title": "while loop condition doesn&#39;t terminate when reading file is finished", "body": "<p>You are not exiting the outer loop. In the outer while loop change</p>\n\n<pre><code>while (c != 'q');\n</code></pre>\n\n<p>to </p>\n\n<pre><code>while ((c != 'q') &amp;&amp; (flag !=NULL));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2241, "user_id": 4004188, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jYWzx.jpg?s=128&g=1", "display_name": "Maulik", "link": "https://stackoverflow.com/users/4004188/maulik"}, "edited": false, "score": 0, "creation_date": 1484134410, "post_id": 41589539, "comment_id": 70383034, "body": "<a href=\"https://gist.github.com/ganganimaulik/951ec5cbf0fb109b06de893d5742ee3a\" rel=\"nofollow noreferrer\">gist.github.com/ganganimaulik/951ec5cbf0fb109b06de893d5742ee&zwnj;&#8203;3a</a>   I&#39;ve done this and it solves the issue but last line gets printed twice :o"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 2241, "user_id": 4004188, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jYWzx.jpg?s=128&g=1", "display_name": "Maulik", "link": "https://stackoverflow.com/users/4004188/maulik"}, "edited": false, "score": 0, "creation_date": 1484135257, "post_id": 41589539, "comment_id": 70383580, "body": "@MaulikGangani <i>last line gets printed twice</i>  That&#39;s because you call <code>printf()</code> even if your call to <code>fgets()</code> fails and returns <code>NULL</code>.  See my edit"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484140417, "post_id": 41589539, "comment_id": 70386947, "body": "Note:  <code>1000-1</code> not needed in <code>char buffer1[1000]; ... fgets(buffer1, 999, fp);</code>  Better to use 1000 via <code>fgets(buffer1, sizeof buffer, fp);</code>."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484141183, "post_id": 41589539, "comment_id": 70387423, "body": "@chux Those would be improvements, but I decided to not make such changes and just make changes relevant to the question.  I also considered the additional parenthesis used in the other answer, but again, I tried to stay close to the original posted code. (I became a big fan of parenthesizing everything when I spent close to a week trying to run down a bug that I finally traced to a huge conditional clause that omitted such parenthesis...)"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 3, "last_activity_date": 1484135338, "last_edit_date": 1484135338, "creation_date": 1484133598, "answer_id": 41589539, "question_id": 41589428, "link": "https://stackoverflow.com/questions/41589428/while-loop-condition-doesnt-terminate-when-reading-file-is-finished/41589539#41589539", "title": "while loop condition doesn&#39;t terminate when reading file is finished", "body": "<p>Your outer <code>do-while</code> loop won't terminate until the user enters <code>q</code> even when EOF is reached.</p>\n\n<pre><code>do {\n    do {\n        i++;\n        flag = fgets(buffer1, 999, fp);\n        printf(\"%s\", buffer1);\n        //printf(\"%d***\\n\", i);  //debug - print line number\n    } while (i % 20 != 0 &amp;&amp; flag != NULL);\n    scanf(\" %c\", &amp;c);\n} while (c != 'q'); // no EOF checking here\n</code></pre>\n\n<p>This will probably do what you want:</p>\n\n<pre><code>do {\n    do {\n        i++;\n        flag = fgets(buffer1, 999, fp);\n        // only print if fgets() returned new data\n        if (flag != NULL) {\n            printf(\"%s\", buffer1);\n        }\n        //printf(\"%d***\\n\", i);  //debug - print line number\n    } while (i % 20 != 0 &amp;&amp; flag != NULL);\n    scanf(\" %c\", &amp;c);\n} while (c != 'q' &amp;&amp; flag != NULL);\n</code></pre>\n"}], "owner": {"reputation": 2241, "user_id": 4004188, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jYWzx.jpg?s=128&g=1", "display_name": "Maulik", "link": "https://stackoverflow.com/users/4004188/maulik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 41589539, "answer_count": 2, "score": 0, "last_activity_date": 1484135338, "creation_date": 1484133286, "question_id": 41589428, "link": "https://stackoverflow.com/questions/41589428/while-loop-condition-doesnt-terminate-when-reading-file-is-finished", "title": "while loop condition doesn&#39;t terminate when reading file is finished", "body": "<p>this program will keep reading next 20 lines until <strong>user enters 'q'</strong> or <strong>file reading is finished</strong>.</p>\n\n<p>now for <strong>file reading is finished</strong> part, I've condition on line 29 of this program  <code>flag != NULL</code></p>\n\n<p>as per my understanding fgets() returns NULL after it reach EOF but this condition doesn't work. what can I do to stop the loop after file has been read?</p>\n\n<p>I'm using <a href=\"https://gist.github.com/ganganimaulik/940198fd379c8a37ecc16b9d28425097\" rel=\"nofollow noreferrer\">this file</a> for testing and here's my program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char name[66];\n    printf(\"Enter name of  file: \");\n    scanf(\"%65s\", name);\n\n    FILE *fp = fopen(name, \"r\");\n\n    if (!fp) {\n        printf(\"can't open file for reading\\n\");\n        return 1;\n    }\n    int  i = 1;\n\n    char buffer1[1000];\n    char *flag;\n    char c;\n\n    do {\n        do {\n            i++;\n            flag = fgets(buffer1, 999, fp);\n            printf(\"%s\", buffer1);\n            //printf(\"%d***\\n\", i);  //debug - print line number\n        } while (i % 20 != 0 &amp;&amp; flag != NULL);\n        scanf(\" %c\", &amp;c);\n    } while (c != 'q');\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "list"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1484132741, "post_id": 41589175, "comment_id": 70381853, "body": "Don&#39;t use your own null-pointer variant, use <code>NULL</code> like it is supposed to be used."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1484132773, "post_id": 41589175, "comment_id": 70381871, "body": "I also recommend you read <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">this discussion about casting the result from <code>malloc</code></a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1484132832, "post_id": 41589175, "comment_id": 70381915, "body": "As for your problem, probably a null or uninitialized pointer. Use a debugger to find out <i>where</i> the crash happens, and what the values of all involved variables are."}, {"owner": {"reputation": 149, "user_id": 6527069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed5dafb099cb8d761542704bfc4a8e6?s=128&d=identicon&r=PG&f=1", "display_name": "Ludvig Rydahl", "link": "https://stackoverflow.com/users/6527069/ludvig-rydahl"}, "edited": false, "score": 0, "creation_date": 1484133028, "post_id": 41589175, "comment_id": 70382048, "body": "If you&#39;re setting data longer down the road from the allocation, I always find it worth time <code>memset</code>-ing the struct, to avoid undefined behaviour that might happen from uninitialized values within the struct if you happen to use them without setting their values."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 149, "user_id": 6527069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed5dafb099cb8d761542704bfc4a8e6?s=128&d=identicon&r=PG&f=1", "display_name": "Ludvig Rydahl", "link": "https://stackoverflow.com/users/6527069/ludvig-rydahl"}, "edited": false, "score": 0, "creation_date": 1484138237, "post_id": 41589175, "comment_id": 70385556, "body": "@LudvigRydahl: <code>memset</code> is only useful for integers, because those are guaranteed to have an encoding od all-bits-zero for <code>0</code>. Floating point and pointers are not."}], "owner": {"reputation": 29, "user_id": 4255466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b326cabdd382bad0b92c11d55c29262?s=128&d=identicon&r=PG&f=1", "display_name": "jdi", "link": "https://stackoverflow.com/users/4255466/jdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1484133119, "creation_date": 1484132648, "last_edit_date": 1484133119, "question_id": 41589175, "link": "https://stackoverflow.com/questions/41589175/check-if-structure-is-empty-c", "title": "Check if Structure is empty C", "body": "<p>My program is supposed to differenciate given measurements into cycles and then it to a file.</p>\n\n<p>The input file looks like this:</p>\n\n<pre><code>reading | force | displacement | velocity\n1       | 64.69 | 49.67        | 0.002\n2       | 64.54 | 49.66        | 0.002\n3       | 64.39 | 49.66        | 0.003\n...\n</code></pre>\n\n<p>What it should look like in the end:</p>\n\n<pre><code>reading1 | force1 | displacement1 | velocity1 | reading2 | force2 | ...\n1        | 64.69  | 49.67         | 0.002     | 871      | -15.13 | 33.47 | 0.019\n2        | 64.54  | 49.66         | 0.002     | 872      | -15.74 | 33.44 | 0.019\n3        | 64.39  | 49.66         | 0.003     | 873      | -17.75 | 33.41 | 0.02\n...\n</code></pre>\n\n<p>So puts all first measurements of the cycles into the first line, the second measurements in the second line and so on.</p>\n\n<p>The Problem I now have is that the velocity increases with every fourth cylce and so the measurements per cycle decrease. \nSo when saving it to the file it gives me a \"Segmentation fault\", propably because the struct is empty. <br>\nHow can I check if a struct is empty or full? Or are there other mistakes in my code? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define NIL (struct zyklus *)0\n\nstruct zyklus {\n    double reading;\n    double force;\n    double displacement;\n    double velocity;\n    struct zyklus * p_next;\n};    \n\n//structured list on struct zyklus\nstruct zyklus * newElem(double read, double forc, double displace, double velocit){\n    struct zyklus * p_help;\n    p_help=(struct zyklus *)malloc(sizeof(struct zyklus));\n\n    p_help-&gt;reading=read;\n    p_help-&gt;force=forc;\n    p_help-&gt;displacement=displace;\n    p_help-&gt;velocity=velocit;\n    p_help-&gt;p_next=NIL;\n\n    return p_help;\n}\n\nint main(){\n    //set pointers on structure\n    struct zyklus * p_start;\n    struct zyklus * p_act;\n    struct zyklus * p_act_array[28];\n\n    //Open Input and output files and initialise some variables\n    FILE *testdata;\n    FILE *speichern=fopen(\"output.txt\",\"w\");\n    testdata=fopen(\"TESTDATA.txt\",\"rt\");\n    char line[40];\n    double summe;\n    double zwischenarray[20]={0};\n    char *token;\n    int j=0,i=0,k=0,l=0,anzahl=0;\n    double zyklenanfang[40]={0};\n\n    //Go through measurements by line, seperate the data by the comma, write it into \"zwischenarray\" and save it in the structured list. Also remember the Beginning of the different cycles in \"zyklenanfang\"\n    while (fgets(line, sizeof(line),testdata)){\n        i=0;\n\n        token=strtok(line,\",\");\n\n        while(token!=NULL){\n            if(atof(token)!=0){\n                zwischenarray[i]=atof(token);\n            }                   \n\n            token=strtok(NULL,\",\"); \n            i++;    \n        }\n\n        if(j==0 &amp;&amp; zwischenarray[3]&gt;0){\n            p_start=p_act=newElem(zwischenarray[0],zwischenarray[1],zwischenarray[2],zwischenarray[3]);\n            j=1;        \n        }else if(zwischenarray[3]&gt;0){\n            if(k==0){\n                k=1;\n                zyklenanfang[l]=zwischenarray[0];\n                l++;\n            }\n            p_act-&gt;p_next=newElem(zwischenarray[0],zwischenarray[1],zwischenarray[2],zwischenarray[3]);\n            p_act=p_act-&gt;p_next;\n        }else{\n            k=0;\n        } \n    }\n\n/*Output*/\n\n    int f=0;\n\n    //All pointers in array are set to a start pointer\n    while (f&lt;=28){\n        p_act_array[f]=p_start;         \n        printf(\"Array NR. %i Anfang: %lf\",f, zyklenanfang[f]);    \n        f++;\n    }\n\n    //All pointers are increased until they are in the beginning of the next cycle\n    int m=0;\n    while (m&lt;28){\n        while(p_act_array[m]-&gt;reading&lt;zyklenanfang[m]){\n            p_act_array[m]=p_act_array[m]-&gt;p_next;          \n        }\n\n        m++;\n    }\n\n    int n=0;\n    int q=0;\n    printf(\"\\noutside\");\n        //Save while in first cycle\n        while((p_act_array[0]-&gt;reading)&lt;zyklenanfang[1]){   \n        printf(\"gehthalbrein\\n\");\n\n            printf(\"gehtrein\\n\");\n            if (p_act_array[n]!=NULL){//Trying to filter for empty struct(doesn't work)\n\n                fprintf(speichern,\"%lf,%lf,%lf,\",p_act_array[n]-&gt;reading,p_act_array[n]-&gt;displacement,p_act_array[n]-&gt;force);   \n            }           \n            n++;//Save first measurement of every cycle\n\n        if(n==28){//When every cycle has been saved\n            n=0;\n            fprintf(speichern,\"\\n\");//make new line\n            while (n&lt;=28){\n                p_act_array[n]=p_act_array[n]-&gt;p_next;//and increase every pointer\n                n++;    \n            }\n            q++;\n            n=0;//set n to first pointer again  \n        }   \n    }\n    printf(\"\\noutside2\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Hope my code makes sense and there aren't too many other mistakes in it</p>\n"}, {"tags": ["c++", "c", "visual-c++", "visual-studio-2015"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1484128938, "post_id": 41587755, "comment_id": 70379284, "body": "What is the error?"}, {"owner": {"reputation": 252, "user_id": 2585840, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BexFH.png?s=128&g=1", "display_name": "Cipher", "link": "https://stackoverflow.com/users/2585840/cipher"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1484130044, "post_id": 41587755, "comment_id": 70380077, "body": "I update question, Please see the screenshot."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1484130321, "post_id": 41587755, "comment_id": 70380256, "body": "This may sound tough, but you need to provide a <b>reproducible, simple as possible</b> example that is complete, so that readers can try it."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484133302, "post_id": 41587755, "comment_id": 70382282, "body": "When the error dialog appears, click on the Break button, this will break into the debugger and then look at the call stack."}, {"owner": {"reputation": 252, "user_id": 2585840, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BexFH.png?s=128&g=1", "display_name": "Cipher", "link": "https://stackoverflow.com/users/2585840/cipher"}, "edited": false, "score": 0, "creation_date": 1484133308, "post_id": 41587755, "comment_id": 70382286, "body": "I upload a sample."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484135550, "post_id": 41587755, "comment_id": 70383764, "body": "It doesn&#39;t compile here with VS2015. I get : <code>Error C4430 missing type specifier - int assumed. Note: C++ does not support default-int  TLS_Test\tc:\\users\\...\\tls\\tls_test\\tls_test.cpp\t48</code>."}, {"owner": {"reputation": 252, "user_id": 2585840, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BexFH.png?s=128&g=1", "display_name": "Cipher", "link": "https://stackoverflow.com/users/2585840/cipher"}, "edited": false, "score": 0, "creation_date": 1484136065, "post_id": 41587755, "comment_id": 70384089, "body": "Platform set to x86."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484144602, "post_id": 41587755, "comment_id": 70389632, "body": "It doesn&#39;t crash here. What does your call stack look like ?"}, {"owner": {"reputation": 252, "user_id": 2585840, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BexFH.png?s=128&g=1", "display_name": "Cipher", "link": "https://stackoverflow.com/users/2585840/cipher"}, "edited": false, "score": 0, "creation_date": 1484153890, "post_id": 41587755, "comment_id": 70395767, "body": "I noticed the problem occurs when <code>Runtime Library</code> set to /MT or /MTd."}], "owner": {"reputation": 252, "user_id": 2585840, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BexFH.png?s=128&g=1", "display_name": "Cipher", "link": "https://stackoverflow.com/users/2585840/cipher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484206545, "creation_date": 1484128836, "last_edit_date": 1484206545, "question_id": 41587755, "link": "https://stackoverflow.com/questions/41587755/exception-handler-error-code-in-thread-local-storage", "title": "Exception Handler error code in Thread Local Storage", "body": "<p>Exception Handler error when using <em>wprintf</em> in Thread Local Storage but I don't have problem in Main EntryPoint, I noticed the problem occurs when <em>Runtime Library</em> set to <em>/MT</em> or <em>/MTd</em>, Please see the screenshot, What's the solution?<br>\nIDE: Visual Studio 2015, OS: Win10 64bit</p>\n\n<p><a href=\"https://hostr.co/ZSIedMmehLtb\" rel=\"nofollow noreferrer\">Sample Project</a></p>\n\n<pre><code>void NTAPI TLSCallbacks(PVOID DllHandle, DWORD dwReason, PVOID Reserved) \n{wprintf(L\"%s procedure called with DllHandle=0x%p, Reason=%d.\\n\", TEXT(__FUNCTION__), DllHandle, dwReason); }\n\n// end declaration\n\n//linker spec\n#ifdef _M_IX86\n#pragma comment (linker, \"/INCLUDE:__tls_used\")\n#pragma comment (linker, \"/INCLUDE:__xl_b\")\n#else\n#pragma comment (linker, \"/INCLUDE:_tls_used\")\n#pragma comment (linker, \"/INCLUDE:_xl_b\")\n#endif\n#ifdef _M_X64\n#pragma const_seg (\".CRT$XLB\") const\n#else\n#pragma data_seg (\".CRT$XLB\")\n#endif //end linker \n\n//tls import \nEXTERN_C PIMAGE_TLS_CALLBACK _xl_b = TLSCallbacks;\n#pragma data_seg ()\n#pragma const_seg () //end\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vgmEP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vgmEP.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/xVmQ2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xVmQ2.png\" alt=\"CallStack\"></a></p>\n"}, {"tags": ["c", "avro", "kaa"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1484128885, "post_id": 41587720, "comment_id": 70379248, "body": "It looks like <code>read_char</code> and <code>write_char</code> should have two arguments, but you have defined them with only one ?"}, {"owner": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1484129097, "post_id": 41587720, "comment_id": 70379384, "body": "but i am not too sure what are the 2 arguments or parameters i should put..."}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 4399565, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-zxkxLbcAAYs/AAAAAAAAAAI/AAAAAAAAAkw/e_Hi4-Ht7o8/photo.jpg?sz=128", "display_name": "Sebu Elias", "link": "https://stackoverflow.com/users/4399565/sebu-elias"}, "is_accepted": false, "score": 1, "last_activity_date": 1484129364, "creation_date": 1484129364, "answer_id": 41587941, "question_id": 41587720, "link": "https://stackoverflow.com/questions/41587720/what-are-these-errors-avro/41587941#41587941", "title": "What are these errors ? ( avro)", "body": "<p>It seems like you have passed two arguments for functions defined with one argument</p>\n\n<pre><code>static int read_char(avro_reader_t reader)\nstatic int write_char(avro_writer_t writer)\n</code></pre>\n\n<p>has one argument each\nbut you called them using</p>\n\n<pre><code>avro_binary_encoding.read_char(reader, &amp;record-&gt;NodeId);\navro_binary_encoding.read_char(reader, &amp;record-&gt;OnlineStat);\navro_binary_encoding.read_char(reader, &amp;record-&gt;FirmwareVER);\n</code></pre>\n\n<p>which passed 2 arguments.</p>\n"}], "owner": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484675936, "creation_date": 1484128735, "last_edit_date": 1484675936, "question_id": 41587720, "link": "https://stackoverflow.com/questions/41587720/what-are-these-errors-avro", "title": "What are these errors ? ( avro)", "body": "<pre><code>What are these errors ?\n\n/home/pi/try/client/c/libs/kaa/src/kaa/gen/kaa_logging_gen.c:93:9: error: too many arguments to function \u2018avro_binary_encoding.read_char\u2019\n         avro_binary_encoding.read_char(reader, &amp;record-&gt;NodeId);\n         ^\n/home/pi/try/client/c/libs/kaa/src/kaa/gen/kaa_logging_gen.c:95:2: error: too many arguments to function \u2018avro_binary_encoding.read_char\u2019\n  avro_binary_encoding.read_char(reader, &amp;record-&gt;OnlineStat);\n  ^\n/home/pi/try/client/c/libs/kaa/src/kaa/gen/kaa_logging_gen.c:99:2: error: too many arguments to function \u2018avro_binary_encoding.read_char\u2019\n  avro_binary_encoding.read_char(reader, &amp;record-&gt;FirmwareVER);\n</code></pre>\n\n<p>Previously i gotten errors where they said read_char and write_char is not declared as functions. but after declaring the function , i still got an error. But the function is something we dont know how to do .</p>\n\n<p>What we done for write_char and read_char is :</p>\n\n<pre><code>static int read_char(avro_reader_t reader)\n{\n    /*\n     * no-op\n     */\n    AVRO_UNUSED(reader);\n\n    return 3;\n}\n\nstatic int write_char(avro_writer_t writer)\n{\n    /*\n     * no-op\n     */\n    AVRO_UNUSED(writer);\n\n    return 3;\n}\n</code></pre>\n\n<p>Below are other examples of other functions :</p>\n\n<pre><code>static int read_string(avro_reader_t reader, char **s, int64_t *len)\n{\n    (void)len;\n    int64_t  str_len = 0;\n    int rval;\n    check_prefix(rval, read_long(reader, &amp;str_len),\n             \"Cannot read string length: \");\n    *s = (char *) KAA_MALLOC(str_len + 1);\n    if (!*s) {\n        return ENOMEM;\n    }\n    (*s)[str_len] = '\\0';\n    AVRO_READ(reader, *s, str_len);\n    return 0;\n}\n\nstatic int write_string(avro_writer_t writer, const char *s)\n{\n    int64_t len = strlen(s);\n    return write_bytes(writer, s, len);\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "compiler-errors", "compiler-warnings", "variadic-functions"], "comments": [{"owner": {"reputation": 193, "user_id": 4858756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d88f37cacc425d12a120fb809293247d?s=128&d=identicon&r=PG&f=1", "display_name": "shim_mang", "link": "https://stackoverflow.com/users/4858756/shim-mang"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1484129209, "post_id": 41587638, "comment_id": 70379466, "body": "I did try strcpy(ad, va_arg(ap, mac_t));. It doesn&#39;t give me any compiler error. But it doesn&#39;t serve the purpose. I mean, the arguments are not copied to array ad. I see invalid data when I print the contents of ad."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1484129326, "post_id": 41587638, "comment_id": 70379550, "body": "Arrays decay to a pointer type when passed to a function. gcc 6.1.0 gets it right, you cannot assign to an array."}, {"owner": {"reputation": 193, "user_id": 4858756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d88f37cacc425d12a120fb809293247d?s=128&d=identicon&r=PG&f=1", "display_name": "shim_mang", "link": "https://stackoverflow.com/users/4858756/shim-mang"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1484129402, "post_id": 41587638, "comment_id": 70379607, "body": "@jxh Exactly. strcpy() doesn&#39;t work on pointers. Any other way to parse the arguments in gcc 6.1.0?"}, {"owner": {"reputation": 193, "user_id": 4858756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d88f37cacc425d12a120fb809293247d?s=128&d=identicon&r=PG&f=1", "display_name": "shim_mang", "link": "https://stackoverflow.com/users/4858756/shim-mang"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1484129648, "post_id": 41587638, "comment_id": 70379789, "body": "@George But how do I use it with va_arg()? I want parse my arguments and store in ad array."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1484130072, "post_id": 41587638, "comment_id": 70380092, "body": "Just for clarity, what are you ultimately hoping will be in <code>ad[]</code> when this is finished? Is it the ascii values <code>0x41, 0x41, 0x42, 0x42, 0x43, 0x43</code> ? Or is it the octets from the hex chars, <code>0x10, 0x10, 0x11, 0x11, 0x12, 0x12</code> ?"}, {"owner": {"reputation": 193, "user_id": 4858756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d88f37cacc425d12a120fb809293247d?s=128&d=identicon&r=PG&f=1", "display_name": "shim_mang", "link": "https://stackoverflow.com/users/4858756/shim-mang"}, "edited": false, "score": 0, "creation_date": 1484130223, "post_id": 41587638, "comment_id": 70380174, "body": "I need hex characters. But how does that matter? can you please elaborate?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1484136565, "post_id": 41587638, "comment_id": 70384419, "body": "It matters because conversion to the latter sequence isn&#39;t hinted at in your posted code. At <i>best</i> the result will be the ascii chars from the input string to an <code>unsigned char</code> array with no translation to basic octets. If that&#39;s what you want, outstanding. If not, and indeed you simply want a six-octet mac you have a ways to go."}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 1, "last_activity_date": 1484129943, "creation_date": 1484129943, "answer_id": 41588143, "question_id": 41587638, "link": "https://stackoverflow.com/questions/41587638/error-found-only-in-gcc-6-1-0-while-parsing-the-arguements-using-va-arg/41588143#41588143", "title": "Error found only in gcc-6.1.0 while parsing the arguements using va_arg()", "body": "<p>You have:</p>\n\n<pre><code>typedef unsigned char mac_t[6];\nmac_t ad;   \n</code></pre>\n\n<p>And then you attempt:</p>\n\n<pre><code>ad = va_arg(ap, mac_t);\n</code></pre>\n\n<p>When, you have passed the argument like this:</p>\n\n<pre><code>foo(\"%c\", \"AABBCC\");\n</code></pre>\n\n<p>This is an error. You cannot assign to an array. Also, <code>\"AABBCC\"</code> is an array [7] of char because of the NUL terminated string literal. However, that doesn't matter. <code>foo()</code> receives a <code>char *</code>, since an array type decays to the pointer containing the address of its first element.</p>\n\n<p>You should be able to see the error if you pass <code>-std=c99</code> to GCC. Apparently, this enables more strict checking.</p>\n\n<pre><code>gcc -std=c99 -W -Wall -O c.c\nc.c: In function \u2018foo\u2019:\nc.c:25:12: error: incompatible types when assigning to type \u2018mac_t\u2019 from type \u2018unsigned char *\u2019\n         ad = va_arg(ap, mac_t);  // error here only on gcc 6.1.0 compiler\n            ^\n</code></pre>\n\n<p>To fix this, tell <code>va_arg</code> you are parsing a pointer. If you must copy the contents, then use <code>strncpy</code>.</p>\n\n<pre><code>strncpy((void *)ad, va_arg(ap, char *), sizeof(ad));\n</code></pre>\n\n<p>We coerce <code>ad</code>, because <code>strncpy</code> expects a <code>char *</code> as the first argument.</p>\n"}], "owner": {"reputation": 193, "user_id": 4858756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d88f37cacc425d12a120fb809293247d?s=128&d=identicon&r=PG&f=1", "display_name": "shim_mang", "link": "https://stackoverflow.com/users/4858756/shim-mang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 41588143, "answer_count": 1, "score": 1, "last_activity_date": 1484131098, "creation_date": 1484128560, "last_edit_date": 1484131098, "question_id": 41587638, "link": "https://stackoverflow.com/questions/41587638/error-found-only-in-gcc-6-1-0-while-parsing-the-arguements-using-va-arg", "title": "Error found only in gcc-6.1.0 while parsing the arguements using va_arg()", "body": "<p>I find error saying \" error: assignment to expression with array type \" for my following piece of code compiled in gcc 6.1.0 but not in gcc 4.4.6. </p>\n\n<pre><code>void foo(char *fmt, ...)\n{\n    va_list ap;\n    int d;\n    char *c, *s;\n    typedef unsigned char mac_t[6];\n\n    mac_t ad;   \n    va_start(ap, fmt);\n    while (*fmt)\n    switch (*fmt++) {\n    case 's':  \n        s = va_arg(ap, char *);\n        printf(\"string %s\\n\", s);\n     break;\n    case 'd':              /* int */\n        d = va_arg(ap, int);\n        printf(\"int %d\\n\", d);\n    break;\n    case 'c':              /* char */\n        ad = va_arg(ap, mac_t);  //**** error here only on gcc 6.1.0 compiler \n        printf(\"With unsigned char: char %c.%c.%c.%c.%c.%c\\n\", ad[0],ad[1],ad[2],ad[3],ad[4],ad[5]);                                              \n    }\n    va_end(ap);\n}\nint main()\n{\n    foo(\"%c\", \"AABBCC\");\n}    \n</code></pre>\n\n<p>How can I solve this error? In gcc 4.4.6, the compilation passes smoothly. For some reasons I need to use gcc 6.1.0 compiler only. </p>\n"}, {"tags": ["c", "memset", "variadic-functions"], "comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1484126890, "post_id": 41586986, "comment_id": 70377831, "body": "It fills the <code>args</code> variable with zeros."}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "edited": false, "score": 2, "creation_date": 1484127391, "post_id": 41586986, "comment_id": 70378206, "body": "Where did you find this code? I think that is useless since <code>va_start</code> write in <code>args</code> after."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484140950, "post_id": 41586986, "comment_id": 70387269, "body": "Interesting.  <code>va_start(args, xxx);</code> does not <i>look</i> like is initializes <code>args</code> any more than <code>foo(args)</code> would not be expected to affect <code>main()</code>&#39;s <code>args</code>.  Yet <code>va_start</code> is a macro and does affect <code>args</code>."}], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": -1, "last_activity_date": 1484126908, "creation_date": 1484126908, "answer_id": 41587049, "question_id": 41586986, "link": "https://stackoverflow.com/questions/41586986/what-is-the-implication-of-memset-for-va-list/41587049#41587049", "title": "What is the implication of memset() for va_list?", "body": "<p><code>memset</code> sets the memory bytewise. It does not care what the type of the arguments are, in fact, it takes a <code>void</code> pointer.</p>\n\n<p>It will set <code>count</code> no of memory locations after <code>dest</code> to the character <code>ch</code></p>\n\n<pre><code>void* memset( void* dest, int ch, size_t count )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": true, "score": 6, "last_activity_date": 1484127390, "creation_date": 1484127390, "answer_id": 41587219, "question_id": 41586986, "link": "https://stackoverflow.com/questions/41586986/what-is-the-implication-of-memset-for-va-list/41587219#41587219", "title": "What is the implication of memset() for va_list?", "body": "<p>The implication is that the programmer who wrote this does not know what they are doing, and enjoys wasting code.   </p>\n\n<p>They may be blindly following the directive of some static analysis tool that variables must be initialized before they are used.</p>\n\n<p><code>va_start(args, xxx);</code> does all the necessary initialization, and overwrites all the 0-values that <code>memset</code> just put in, making the work of <code>memset</code> worthless.</p>\n"}], "owner": {"reputation": 841, "user_id": 5392892, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ongCZ.png?s=128&g=1", "display_name": "Shuangistan", "link": "https://stackoverflow.com/users/5392892/shuangistan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 41587219, "answer_count": 2, "score": 1, "last_activity_date": 1484127390, "creation_date": 1484126747, "last_edit_date": 1484127301, "question_id": 41586986, "link": "https://stackoverflow.com/questions/41586986/what-is-the-implication-of-memset-for-va-list", "title": "What is the implication of memset() for va_list?", "body": "<p>I read the following code fragment:</p>\n\n<pre><code>va_list args;\nmemset(&amp;args, 0, sizeof(va_list));\n\nva_start(args, xxx);\n...\nva_end(args);\n</code></pre>\n\n<p>What is the implication of <code>memset()</code> here directly before <code>va_start()</code>?</p>\n\n<p>What is the difference if the <code>memset()</code> line is removed?</p>\n"}, {"tags": ["c", "gstreamer", "rtsp", "gstreamer-1.0", "playbin2"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7402791, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/edc502892b25aa5c1a734fd1d2985d29?s=128&d=identicon&r=PG&f=1", "display_name": "RajviK", "link": "https://stackoverflow.com/users/7402791/rajvik"}, "edited": false, "score": 0, "creation_date": 1484202155, "post_id": 41601972, "comment_id": 70414614, "body": "Thank you so much @jgorosdev. Pretty new to pads stuff. Can you help me get more insights to pads, why should we use them?"}], "tags": [], "owner": {"reputation": 1155, "user_id": 5986252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cabd17a359de6510f3f774ab5975f9a?s=128&d=identicon&r=PG&f=1", "display_name": "jgorostegui", "link": "https://stackoverflow.com/users/5986252/jgorostegui"}, "is_accepted": true, "score": 1, "last_activity_date": 1484174112, "creation_date": 1484174112, "answer_id": 41601972, "question_id": 41585909, "link": "https://stackoverflow.com/questions/41585909/linking-gstrplaybin-to-custom-video-sink-videoconvert-and-sink-not-linking-gstre/41601972#41601972", "title": "Linking Gstrplaybin to custom video sink videoconvert and sink not linking gstreamer", "body": "<p>It should be noted that the <code>playbin</code> element gives a full pipeline from src to sink, so the pipeline without the sink stuff would play perfectly:</p>\n\n<pre><code>gst-launch-1.0 playbin uri=rtsp://127.0.0.1:8551/test\n</code></pre>\n\n<p>The correct pipeline that you want to create is next:</p>\n\n<pre><code>gst-launch-1.0 playbin uri=rtsp://127.0.0.1:8551/test video-sink=\"videoconvert ! video/x-raw,width=320,height=240 ! ximagesink\"\n</code></pre>\n\n<p>In order to embed this into GStreamer application, it is not necessary to link all the elements. Instead of that, the necessary steps to make are to build a custom video output bin and set it to playbin's <code>video-sink</code> property. In other words, the way to go is create a bin and link the necessary elements and then tell playbin to use it via it's <code>video-sink</code> property. It is also necessary to create a GhostPad for the bin and point it to the sink pad of the first element within the bin.</p>\n\n<p>This is the result:</p>\n\n<pre><code>#include &lt;gst/gst.h&gt;\n\nint main(int argc, char *argv[]) {\n    GstElement *source, *videosink, *pipeline, *videoconvert, *customoutput;\n    GstCaps *capsFilter;\n    GstBus *bus;\n    GstMessage *msg;\n    GstPad *pad;\n    gboolean add_ok;\n    gboolean link_ok;\n    GstStateChangeReturn ret;\n    GMainLoop *loop;\n\n    /* Initialize GStreamer */\n    gst_init (&amp;argc, &amp;argv);\n    loop = g_main_loop_new (NULL, FALSE);\n\n\n    /* Create Elements */\n    pipeline = gst_pipeline_new(\"my-pipeline\");\n    source = gst_element_factory_make (\"playbin\", \"source\");\n    videoconvert = gst_element_factory_make(\"videoconvert\", \"videoconvert\");\n    capsFilter = gst_caps_new_simple(\"video/x-raw\",\n                    \"width\", G_TYPE_INT, 320,\n                    \"height\", G_TYPE_INT, 240, \n                    NULL);\n    videosink = gst_element_factory_make(\"ximagesink\", \"videosink\");\n    customoutput = gst_bin_new(\"customoutput\");\n\n    // It is possible to create the bin like this \n    // Ghost pads on the bin for unlinked source or sink pads within the bin can automatically be created\n    // customoutput =  gst_parse_bin_from_description (\"videoconvert ! video/x-raw,width=320 ! ximagesink\", TRUE, NULL);\n    gst_bin_add_many (GST_BIN (customoutput), videoconvert, videosink, NULL);\n\n    link_ok = gst_element_link_filtered(videoconvert,videosink, capsFilter);\n    gst_caps_unref (capsFilter);\n    if (!link_ok) {\n            g_warning (\"Failed to link element1 and element2!\");\n    }\n\n    GstPad *sinkpad,*ghost_sinkpad;\n    sinkpad = gst_element_get_static_pad (videoconvert, \"sink\"); \n    ghost_sinkpad = gst_ghost_pad_new (\"sink\", sinkpad); \n    gst_pad_set_active (ghost_sinkpad, TRUE); \n    gst_element_add_pad (customoutput, ghost_sinkpad); \n\n    /* set property value */\n    g_object_set (source, \"video-sink\", customoutput, NULL);\n    g_object_set (source, \"uri\", \"rtsp://127.0.0.1:8551/test\", NULL);\n\n    if (!pipeline || !source || !videoconvert || !capsFilter || !videosink || !customoutput)\n    {   \n            g_printerr (\"Not all elements could be created.\\n\");\n            return -1;\n    }\n\n    gst_bin_add_many (GST_BIN(pipeline), source,NULL);\n\n    // Start playing */\n    ret = gst_element_set_state (pipeline, GST_STATE_PLAYING);\n    g_print (\"Running...\\n\");\n    g_main_loop_run (loop);\n    if (ret == GST_STATE_CHANGE_FAILURE) {\n        g_printerr (\"Unable to set the pipeline to the playing state.\\n\");\n        gst_object_unref (pipeline);\n        return -1;\n    }\n    /* Wait until error or EOS */\n    //bus = gst_element_get_bus (pipeline);\n    //msg = gst_bus_timed_pop_filtered (bus, GST_CLOCK_TIME_NONE,GST_MESSAGE_ERROR | GST_MESSAGE_EOS);\n\n      /* Free resources */\n    gst_object_unref (bus);\n    gst_element_set_state (pipeline, GST_STATE_NULL);\n    gst_object_unref (pipeline);\n    g_main_loop_unref (loop);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7402791, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/edc502892b25aa5c1a734fd1d2985d29?s=128&d=identicon&r=PG&f=1", "display_name": "RajviK", "link": "https://stackoverflow.com/users/7402791/rajvik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2706, "favorite_count": 1, "accepted_answer_id": 41601972, "answer_count": 1, "score": 1, "last_activity_date": 1484182572, "creation_date": 1484123134, "last_edit_date": 1484182572, "question_id": 41585909, "link": "https://stackoverflow.com/questions/41585909/linking-gstrplaybin-to-custom-video-sink-videoconvert-and-sink-not-linking-gstre", "title": "Linking Gstrplaybin to custom video sink videoconvert and sink not linking gstreamer", "body": "<p>Trying to make gstreamer application from the pipeline: gst-launch-1.0 playbin uri=rtsp:// video-sink=\"videoconvert ! video/x-raw,width=720, height=480 ! ximagesink\"</p>\n\n<p>Getting error to link elements. Posting my code:</p>\n\n<pre><code>#include &lt;gst/gst.h&gt;\n\nint main(int argc, char *argv[]) {\n    GstElement *source, *videosink, *pipeline, *videoconvert;\n    GstCaps *capsFilter;\n    GstBus *bus;\n    GstMessage *msg;\n    GstPad *pad;\n    gboolean link_ok;\n\n    /* Initialize GStreamer */\n    gst_init (&amp;argc, &amp;argv);\n\n\n    /* Create Elements */\n    pipeline = gst_pipeline_new(\"my-pipeline\");\n    source = gst_element_factory_make (\"playbin\", \"source\");\n    videoconvert = gst_element_factory_make(\"videoconvert\", \"convert\");\n    videosink = gst_element_factory_make(\"ximagesink\", \"autovideosink\");\n\n    /* set property value */\n    g_object_set (source, \"uri\", \"rtsp:&lt;file location&gt;\", NULL);\n\n    if (!pipeline || !source || !videoconvert || !videosink)\n    {   \n            g_printerr (\"Not all elements could be created.\\n\");\n            return;\n    }   \n\n\n    gst_bin_add_many (GST_BIN(pipeline), videoconvert, videosink, NULL);\n    capsFilter = gst_caps_new_simple(\"video/x-raw\",\n                    \"width\", G_TYPE_INT, 176,\n                    \"height\", G_TYPE_INT, 144, \n                    NULL);\n    link_ok = gst_element_link_filtered(videoconvert,videosink, capsFilter);\n    gst_caps_unref (capsFilter);\n\n    if (!link_ok) {\n            g_warning (\"Failed to link element1 and element2!\");\n    }   \n    if (gst_element_link_many( videoconvert, videosink, NULL) != TRUE) {\n            g_print (\"Failed to link some elements .....1 !\\n\");\n            gst_object_unref (pipeline);\n            return -1; \n    }   \n\n\n      /* Start playing */\n    gst_element_set_state (source, GST_STATE_PLAYING);\n\n    /* Wait until error or EOS */\n    bus = gst_element_get_bus (source);\n    msg = gst_bus_timed_pop_filtered (bus, GST_CLOCK_TIME_NONE,\nGST_MESSAGE_ERROR | GST_MESSAGE_EOS);\n</code></pre>\n"}, {"tags": ["c", "bit-manipulation", "bit-shift"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 3, "creation_date": 1484119725, "post_id": 41584919, "comment_id": 70373991, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3948479/integer-overflow-and-undefined-behavior\">Integer overflow and undefined behavior</a>"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484120000, "post_id": 41584919, "comment_id": 70374119, "body": "Is it possible that your architecture has 64 bit <code>int</code>s?"}], "answers": [{"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484119928, "post_id": 41584967, "comment_id": 70374083, "body": "Where do you see an overflowing integer operation? All shifts are done on (afaics none-overflowing) <code>int</code>s."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1484120255, "post_id": 41584967, "comment_id": 70374263, "body": "This is not an integer overflow, it is a direct manipulation of the sign bits. It is undefined behavior per C11 6.5.7/4: &quot;The result of E1 &lt;&lt; E2 is E1 left-shifted E2 bit positions;&quot; /--/ &quot;If E1 has a signed type and nonnegative value, and E1 &#215; 2E2 is representable in the result type, then that is the resulting value; otherwise, the behavior is undefined.&quot;"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484121408, "post_id": 41584967, "comment_id": 70374826, "body": "@Lundin: You are right, since there is a more specific specification of bit shift&#39;s behaviour. I actually thought it would also violate the more general overflow rule, but maybe I am wrong."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484121778, "post_id": 41584967, "comment_id": 70375007, "body": "@Lundin All shits are well defined, cf. my comment to Saurav&#39;s post. Stephan: The shifts are not the issue here."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484122544, "post_id": 41584967, "comment_id": 70375391, "body": "@PeterA.Schneider - ignore my comment.  It was wrong."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484125943, "post_id": 41584967, "comment_id": 70377162, "body": "<code>buf[3]</code> is not negative; it is 4 for a 32 bit little endian. <code>outval</code> is never negative when shifted. Your answer is plain wrong."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484129376, "post_id": 41584967, "comment_id": 70379587, "body": "@PeterA.Schneider In the case where any byte from the original int has a value larger than 127 and <code>char</code> is a signed type, the value will get converted to a signed type in some implementation-defined way. The result may be a negative number. And then when the <code>char</code> gets used in an expression, it gets promoted to <code>int</code>, the sign is preserved, and the code might invoke undefined behavior. In this specific case, 67502978 -&gt; 0x04060382. <code>buf[0]</code> will contain raw value 0x82, which is possibly a negative number. Which will turn <code>outVal</code> negative too."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484129672, "post_id": 41584967, "comment_id": 70379810, "body": "So the shifts are not a problem in this very specific case only by pure luck, since the ls byte was never shifted. Had any other byte gotten a value over 127 there would have been undefined behavior."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484137529, "post_id": 41584967, "comment_id": 70385080, "body": "@Lundin I understand that (admittedly after the discussion with chqrlie elsewhere). My &quot;never negative&quot; referred to the program as presented by the OP. Stephan&#39;s wrapping up his answer  &quot;So the main issue is [the bit shift]&quot; is not correct, because the bit shift as presented is not an issue. Sure, that is coincidental  and not portably safe, but I think there is some value in understanding where the unexpected negative value comes from, and exactly <i>why</i> using unsigned chars helps (not because it shifts correctly)."}, {"owner": {"reputation": 1981, "user_id": 1149771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137867b6ca114eb65ff5ead055832ea7?s=128&d=identicon&r=PG", "display_name": "bronekk", "link": "https://stackoverflow.com/users/1149771/bronekk"}, "edited": false, "score": 0, "creation_date": 1484166011, "post_id": 41584967, "comment_id": 70402716, "body": "If OP cares about the highest bit in in/out value, I would also recommend using &quot;unsigned int&quot; for inVal and outVal"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 28015, "user_id": 63550, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/RIZKi.png?s=128&g=1", "display_name": "Peter Mortensen", "link": "https://stackoverflow.com/users/63550/peter-mortensen"}, "edited": false, "score": 0, "creation_date": 1484172315, "post_id": 41584967, "comment_id": 70405851, "body": "@Peter A. Schneider: you are right, the actual problem with OP&#39;s <code>intVal</code> arises not due to undefined behaviour of shift operators on negative numbers (although this problem will potentially arise for other <code>intVal</code>s). Thanks for pointing this out in a consequent manner. Adapted my answer accordingly."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 4, "last_activity_date": 1484171959, "last_edit_date": 1484171959, "creation_date": 1484119471, "answer_id": 41584967, "question_id": 41584919, "link": "https://stackoverflow.com/questions/41584919/store-an-int-in-a-char-buffer-in-c-and-then-retrieve-the-same/41584967#41584967", "title": "Store an int in a char buffer in C and then retrieve the same", "body": "<p>Use <code>unsigned char buf[5] = {0};</code> and <code>unsigned int</code> for <code>inVal</code> and <code>outVal</code>, and it should work.</p>\n\n<p>When using signed integral types, there arise two sorts of problems:</p>\n\n<p>First, if <code>buf[3]</code> is negative, then due to <code>outVal = buf[3]</code> variable <code>outVal</code> becomes negative; consequent bit shift operators on <code>outVal</code> are then undefined behaviour <a href=\"http://en.cppreference.com/w/cpp/language/operator_arithmetic\" rel=\"nofollow noreferrer\">cppreference.com concerning bit shift operators</a>:</p>\n\n<blockquote>\n  <p>For signed and positive a, the value of a &lt;&lt; b is a * 2b  if it is\n  representable the return type, otherwise the behavior is\n  undefined. (until C++14), the value of a &lt;&lt; b is a * 2b  if it is\n  representable in the unsigned version of the return type (which is\n  then converted to signed: this makes it legal to create INT_MIN as\n  1&lt;&lt;31), otherwise the behavior is undefined. (since C++14)</p>\n  \n  <p><strong>For negative a, the behavior of a &lt;&lt; b is undefined.</strong></p>\n</blockquote>\n\n<p>Note that with OP's <code>inVal = 67502978</code> this does not occur, since <code>buf[3]=4</code>; But for other <code>inVal</code>s it may occur and then may bring problems due to \"undefined behaviour\".</p>\n\n<p>The second problem is that with operation <code>outVal |= buf[0]</code> with <code>buf[0]=-126</code>, the value <code>(char)-126</code>, which in binary format is <code>10000010</code>, is converted to <code>(int)-126</code>, which in binary format is <code>11111111111111111111111110000010</code> before operator <code>|=</code> is applied, and this then will fill up <code>outVal</code> with a lot of <code>1</code>-bits. The reason for conversion is defined at <a href=\"http://en.cppreference.com/w/cpp/language/operator_arithmetic\" rel=\"nofollow noreferrer\">conversion rules for arithmetic operations (cppreference.com)</a>:</p>\n\n<blockquote>\n  <p>If both operands are signed or both are unsigned, the operand with\n  lesser conversion rank is converted to the operand with the greater\n  integer conversion rank</p>\n</blockquote>\n\n<p>So the problem in OP's case is actually not because of any undefined behaviour, but because of having character <code>buf[3]</code> being a negative value, which is converted to <code>int</code> before <code>|=</code> operation.</p>\n\n<p>Note, however, that if either <code>buf[2]</code> or <code>buf[1]</code> had been negative, this would have made <code>outVal</code> negative and would have lead to undefined behaviour on subsequent shift operations, too.</p>\n"}, {"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1484121094, "post_id": 41585127, "comment_id": 70374682, "body": "@LPs My thinking too. The general algorithmic idea is, if I&#39;m not mistaken, endianness-independent because the bit shift operator is endianness-ignorant (or -invariant, or whatever: left shift is always multiplying, right-shift dividing). This is the way to go in order to implement ntohl and friends without looking at the architecture&#39;s endianness."}, {"owner": {"reputation": 1942, "user_id": 969365, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/1EnZd.png?s=128&g=1", "display_name": "simon", "link": "https://stackoverflow.com/users/969365/simon"}, "edited": false, "score": 0, "creation_date": 1484153258, "post_id": 41585127, "comment_id": 70395351, "body": "I don&#39;t understand <i>Should you use bit shifts on a number that is negative, you might get bugs.</i>. How can he have negative numbers if he changes the types to <code>uint32_t</code> and <code>uint8_t</code>?"}, {"owner": {"reputation": 174367, "user_id": 1011995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jca5Q.jpg?s=128&g=1", "display_name": "Daniel Fischer", "link": "https://stackoverflow.com/users/1011995/daniel-fischer"}, "reply_to_user": {"reputation": 1942, "user_id": 969365, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/1EnZd.png?s=128&g=1", "display_name": "simon", "link": "https://stackoverflow.com/users/969365/simon"}, "edited": false, "score": 0, "creation_date": 1484154097, "post_id": 41585127, "comment_id": 70395897, "body": "@gurka The point is to use unsigned types of specified width to prevent such bugs. Since you misunderstood, the answer is apparently not optimally worded."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484206627, "post_id": 41585127, "comment_id": 70416708, "body": "Unfortunately, C is a very inconsistent and irrational language. What&#39;s not mentioned here is that even if you use <code>uint8_t</code>, you could end up with negative numbers, because of the integer promotion rules in C. For example <code>~uint8 &lt;&lt; n</code> always invokes undefined behavior, unlike <code>~uint32 &lt;&lt; n</code> which is always perfectly fine (on 32 bit sys).  This is because the former is equivalent to <code>~(int)uint8 &lt;&lt; n</code>. The key to avoiding these subtle but disastrous bugs is to learn about the various forms of implicit type promotion in C."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 19, "last_activity_date": 1484202793, "last_edit_date": 1484202793, "creation_date": 1484120049, "answer_id": 41585127, "question_id": 41584919, "link": "https://stackoverflow.com/questions/41584919/store-an-int-in-a-char-buffer-in-c-and-then-retrieve-the-same/41585127#41585127", "title": "Store an int in a char buffer in C and then retrieve the same", "body": "<p>One problem is that you are using bit-wise operators on signed numbers. This is always a bad idea and almost always incorrect. Please note that <code>char</code> has implementation-defined signedness, unlike <code>int</code> which is always signed.</p>\n\n<p>Therefore you should replace <code>int</code> with <code>uint32_t</code> and <code>char</code> with <code>uint8_t</code>. With such unsigned types you eliminate the possibility of using bit shifts on negative numbers, which would be a bug. Similarly, if you shift data into the sign bits of a signed number, you <em>will</em> get bugs.</p>\n\n<p>And needless to say, the code will not work if integers are not 4 bytes large.</p>\n"}, {"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484121642, "post_id": 41585204, "comment_id": 70374946, "body": "Hm. I see the following values for <code>outval</code> before each shift: (32 bit little endian ints): 4; 1030; 263680. None of them are negative, and the results are all within range, so they are all well defined. The value after the last shift is 67502848. It&#39;s the last OR that creates the negative value."}], "tags": [], "owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "is_accepted": false, "score": 4, "last_activity_date": 1484123763, "last_edit_date": 1484123763, "creation_date": 1484120325, "answer_id": 41585204, "question_id": 41584919, "link": "https://stackoverflow.com/questions/41584919/store-an-int-in-a-char-buffer-in-c-and-then-retrieve-the-same/41585204#41585204", "title": "Store an int in a char buffer in C and then retrieve the same", "body": "<p>C++ standard N3936 quotes about shift operators:</p>\n\n<blockquote>\n  <blockquote>\n    <p>The value of <code>E1 &lt;&lt; E2</code> is <code>E1</code> left-shifted <code>E2</code> bit positions; vacated\n    bits are zero-filled. </p>\n  </blockquote>\n  \n  <p>If <code>E1</code> has an <strong>unsigned type</strong>, </p>\n  \n  <blockquote>\n    <p>the value of the result is <code>E1 \u00d7 2^E2</code>, reduced modulo one more than the maximum value\n    representable in the result type. </p>\n  </blockquote>\n  \n  <p>Otherwise, if <code>E1</code> has a <strong>signed type</strong> and non-negative value, </p>\n  \n  <blockquote>\n    <p>and <code>E1 \u00d7 2^E2</code> is representable in the\n    corresponding unsigned type of the result type, then that value,\n    converted to the result type, is the resulting value; otherwise, the\n    behavior is <em>undefined</em>.</p>\n  </blockquote>\n</blockquote>\n\n<p>So, to avoid <code>undefined</code> behaviour, it is recommended to use <code>unsigned</code> data types, and ensure the <code>64-bits</code> length of data type. </p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1484121765, "post_id": 41585515, "comment_id": 70375001, "body": "While your remark raises an important point for the binary exchange of values, it does not explain the OP&#39;s problem. Using a different byte order would not solve the problem either."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 2, "creation_date": 1484122010, "post_id": 41585515, "comment_id": 70375122, "body": "While @chqrlie has a point, +1 for the mandatory pointer to <code>htonl</code> and friends. I suspect that many spontaneous resets of the various embedded systems in my household could be avoided if people stopped attempts at re-implementing <code>htonl</code> etc. Disseminating best practice is a service to mankind. Especially because the attempts are usually not a sign of competence and thus bound to fail."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 2, "creation_date": 1484122710, "post_id": 41585515, "comment_id": 70375478, "body": "I <i>really</i> <i>really</i> don&#39;t like the interface of htonl et al.  htonl should return an array of octets - not an int (I can imagine a platform where htonl of a valid integer ends up returning a trap value)."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1484123169, "post_id": 41585515, "comment_id": 70375713, "body": "@MartinBonner I cannot.  If there is padding or such which should have defined values (for example, 0), <code>htonl</code> should make damn sure that it conforms for that architecture; any amateurish DIY attempt would be even more failure-prone in such thorny environment."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1484123306, "post_id": 41585515, "comment_id": 70375776, "body": "A little endian sign and magnitude or ones-complement machine where negative zero is a trap.  A 0x00000080 would end up as a big-endian 0x80000000 which is the trap value."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1484123489, "post_id": 41585515, "comment_id": 70375873, "body": "If htonl returned { 0x00, 0x00, 0x00, 0x80 } there wouldn&#39;t be a problem.  (Well, apart from the fact that returning an array is tricky.)  The point is that &quot;network values&quot; should just be sequences of octets.  Trying to pass them around as anything else is conceptually wrong."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1484123606, "post_id": 41585515, "comment_id": 70375923, "body": "<i>I suspect that many spontaneous resets of the various embedded systems in my household could be avoided if people stopped attempts at re-implementing htonl etc.</i> ...well many of embedded devices uses very low price mcu and toolchains or SDK (if you are lucky) of vendor are very poor. htonl and friends are a mirage..."}, {"owner": {"reputation": 2043, "user_id": 7218127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FFGPE.gif?s=128&g=1", "display_name": "Jim D.", "link": "https://stackoverflow.com/users/7218127/jim-d"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1484123956, "post_id": 41585515, "comment_id": 70376082, "body": "@MartinBonner  Although it is called <code>htonl()</code> it doesn&#39;t return an int, it returns a uint32_t.  I would expect that <code>0x80000000</code> is a valid unsigned 32 bit integer on all architectures."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1484124122, "post_id": 41585515, "comment_id": 70376164, "body": "@MartinBonner I get your point (do not interpret network bytes as natively typed values). I think it is valid."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1484125146, "post_id": 41585515, "comment_id": 70376719, "body": "uint32_t - Aah!  I think that may be recent (within the last 20 years).  Yes, that makes it much safer (but my conceptual argument still stands)."}], "tags": [], "owner": {"reputation": 2043, "user_id": 7218127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FFGPE.gif?s=128&g=1", "display_name": "Jim D.", "link": "https://stackoverflow.com/users/7218127/jim-d"}, "is_accepted": false, "score": 2, "last_activity_date": 1484121543, "creation_date": 1484121543, "answer_id": 41585515, "question_id": 41584919, "link": "https://stackoverflow.com/questions/41584919/store-an-int-in-a-char-buffer-in-c-and-then-retrieve-the-same/41585515#41585515", "title": "Store an int in a char buffer in C and then retrieve the same", "body": "<p>Because of endian differences between architectures, it is best practice to convert numeric values to <code>network order</code>, which is big-endian.  On receipt, they can then be converted to the native host order.  We can do this in a portable way by using <code>htonl()</code> (host to network \"long\" = uint32_t), and convert to host order on receipt with <code>ntohl()</code>.  Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;arpa/inet.h&gt;\n\nint main(int argc, char **argv) {\n  uint32_t inval = 67502978, outval, backinval;\n\n  outval = htonl(inval);\n  printf(\"outval: %d\\n\", outval);\n  backinval = ntohl(outval);\n  printf(\"backinval: %d\\n\", backinval);\n  return 0;\n}\n</code></pre>\n\n<p>This gives the following result on my 64 bit x86 which is little endian:</p>\n\n<pre><code>$ gcc -Wall example.c\n$ ./a.out\noutval: -2113731068\nbackinval: 67502978\n$\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": false, "score": 6, "last_activity_date": 1484126229, "last_edit_date": 1484126229, "creation_date": 1484122759, "answer_id": 41585814, "question_id": 41584919, "link": "https://stackoverflow.com/questions/41584919/store-an-int-in-a-char-buffer-in-c-and-then-retrieve-the-same/41585814#41585814", "title": "Store an int in a char buffer in C and then retrieve the same", "body": "<p>While bit shifts of signed values <em>can</em> be a problem, this is not the case here (all left hand values are positive, and all results are within the range of a 32 bit unsigned int). </p>\n\n<p>The problematic expression with somewhat unintuitive semantics is the last bitwise OR:</p>\n\n<pre><code>outVal |= buf[0];\n</code></pre>\n\n<p><code>buf[0]</code> is a (on your and my architecture) signed char with the value -126, simply because the most significant bit in the least significant byte of 67502978 is set. In C all operands in an arithmetic expression are subject to the arithmetic conversions. Specifically, they undergo <em>integer promotion</em> which states: \"If an int can represent all values of the original type [...], the value is converted to an int\". Accordingly, the signed character <code>buf[0]</code> is converted to a (signed) <code>int</code>, <em>preserving its value of  -126.</em> A negative signed int has the sign bit set. ORing that with another signed int sets the result's sign bit as well, making that value negative. That is exactly what we are seeing.</p>\n\n<p>Making the bytes <code>unsigned char</code>s fixes the issue because the value of the temporary integer to which the unsigned char is converted is then a simple 8 bit value of 130.</p>\n"}, {"comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1484123695, "post_id": 41585872, "comment_id": 70375960, "body": "Actually, it <i>doesn&#39;t</i> assume 8-bit bytes.  It assumes that unsigned char can hold <i>at least</i> 8 bits (which the standard guarantees).  (For the calculation of outval it also assumes that buf only contains valid values in the range 0..255.)"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484123935, "post_id": 41585872, "comment_id": 70376071, "body": "The program does <i>not</i> have undefined behavior. It also does not have implementation defined behavior since all values stored in the chars are masked by <code>0xff</code> and thus representable in a <code>char</code> which is guaranteed to have at least 8 bits."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484126914, "post_id": 41585872, "comment_id": 70377847, "body": "@PeterA.Schneider: it <i>does</i> have implementation defined behavior in C: <b>6.3.1.3 Signed and unsigned integers:</b> <i>When a value with integer type is converted to another integer type other than _Bool, if the value can be represented by the new type, it is unchanged. 2 Otherwise, if the new type is unsigned, ... 3 Otherwise, the new type is signed and the value cannot be represented in it; either the result is implementation-defined or an implementation-defined signal is raised.</i> The values masked by <code>0xff</code> may exceed the range of type <code>char</code>, and 130 indeed does."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484127100, "post_id": 41585872, "comment_id": 70377991, "body": "@PeterA.Schneider: The program does not invoke undefined behavior for the specific value <code>inVal = 67502978</code>, but the method used does for many other values, such as <code>inVal = 32768</code>."}, {"owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "edited": false, "score": 0, "creation_date": 1484133684, "post_id": 41585872, "comment_id": 70382554, "body": "For the avoidance of doubt, use std types with fixed widths <code>uint8_t</code> and <code>uint32_t</code> for example. As an embedded coder I only ever use these types (<i>never</i> just <code>int</code> for example) as I&#39;ve learned that assumption will bite you eventually."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 12, "last_activity_date": 1485019261, "last_edit_date": 1485019261, "creation_date": 1484123000, "answer_id": 41585872, "question_id": 41584919, "link": "https://stackoverflow.com/questions/41584919/store-an-int-in-a-char-buffer-in-c-and-then-retrieve-the-same/41585872#41585872", "title": "Store an int in a char buffer in C and then retrieve the same", "body": "<p>Your method has potential implementation defined behavior as well as undefined behavior:</p>\n\n<ul>\n<li><p>storing values into the array of type <code>char</code> beyond the range of type <code>char</code> has implementation defined behavior: <code>buf[0] = inVal &amp; 0xff;</code> and the next 3 statements (<code>inVal &amp; 0xff</code> might be larger than <code>CHAR_MAX</code> if <code>char</code> type is signed by default).</p></li>\n<li><p>left shifting negative values invokes undefined behavior: if any of the 3 first bytes in the array becomes negative as the implementation defined result of storing a value larger than <code>CHAR_MAX</code> into it, the resulting <code>outVal</code> becomes negative, left shifting it is undefined.</p></li>\n</ul>\n\n<p>In your specific example, your architecture uses 2's complement representation for negative values and the type <code>char</code> is signed. The value stored into <code>buf[0]</code> is <code>67502978 &amp; 0xff = 130</code>, becomes <code>-126</code>. The last statement <code>outVal |= buf[0];</code> sets bits 7 through 31 of <code>outVal</code> and the result is <code>-126</code>.</p>\n\n<p>You can avoid these issues by using an array of <code>unsigned char</code> and values of type <code>unsigned int</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    unsigned int inVal = 0, outVal = 0;\n    unsigned char buf[4] = { 0 };\n\n    inVal = 67502978;\n\n    printf(\"inVal: %u\\n\", inVal);\n\n    buf[0] = inVal &amp; 0xff;\n    buf[1] = (inVal &gt;&gt; 8) &amp; 0xff;\n    buf[2] = (inVal &gt;&gt; 16) &amp; 0xff;\n    buf[3] = (inVal &gt;&gt; 24) &amp; 0xff;\n\n    outVal = buf[3];\n    outVal &lt;&lt;= 8;\n    outVal |= buf[2];\n    outVal &lt;&lt;= 8;\n    outVal |= buf[1];\n    outVal &lt;&lt;= 8;\n    outVal |= buf[0];\n\n    printf(\"outVal: %u\\n\", outVal);\n    return 0;\n}\n</code></pre>\n\n<p>Note that the above code still assumes 32-bit ints.</p>\n"}, {"comments": [{"owner": {"reputation": 16855, "user_id": 1502345, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1beba9dc5373529ea99d294b23118d1b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Aidley", "link": "https://stackoverflow.com/users/1502345/jack-aidley"}, "edited": false, "score": 1, "creation_date": 1484138522, "post_id": 41589783, "comment_id": 70385756, "body": "+1 This is the best way of doing this. It is both non-portable, and undefined behaviour, <b>but so is anything assuming that assumes you can translate between an <code>int</code> and four <code>chars</code></b>. I would combine with Jim D.&#39;s answer to ensure endian-correctness, however."}, {"owner": {"reputation": 16855, "user_id": 1502345, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1beba9dc5373529ea99d294b23118d1b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Aidley", "link": "https://stackoverflow.com/users/1502345/jack-aidley"}, "edited": false, "score": 0, "creation_date": 1484138586, "post_id": 41589783, "comment_id": 70385799, "body": "Also, I&#39;m pretty sure you&#39;ve made an error in your code beginning with <code>outVal = data.bytes.byte3</code>, etc."}, {"owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "reply_to_user": {"reputation": 16855, "user_id": 1502345, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1beba9dc5373529ea99d294b23118d1b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Aidley", "link": "https://stackoverflow.com/users/1502345/jack-aidley"}, "edited": false, "score": 0, "creation_date": 1484139454, "post_id": 41589783, "comment_id": 70386326, "body": "Thanks Jack, well spotted. I&#39;ve updated code now to reflect the task at hand (getting bytes into <code>buf</code> from <code>inVal</code>)."}, {"owner": {"reputation": 3702, "user_id": 1059969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JKhUL.jpg?s=128&g=1", "display_name": "Agent_L", "link": "https://stackoverflow.com/users/1059969/agent-l"}, "edited": false, "score": 0, "creation_date": 1484147930, "post_id": 41589783, "comment_id": 70391908, "body": "That&#39;s precisely <b>not</b> what unions are for. Anyway, you forgot <code>#pragma pack 1</code>. Alternatively, <code>uint8_t [4]</code> is much safer than 4 independent fields because it avoids the packing issue."}, {"owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "edited": false, "score": 0, "creation_date": 1484305462, "post_id": 41589783, "comment_id": 70465848, "body": "I did say it&#39;s probably a terrible idea, so I was right."}], "tags": [], "owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "is_accepted": false, "score": 3, "last_activity_date": 1484139387, "last_edit_date": 1484139387, "creation_date": 1484134311, "answer_id": 41589783, "question_id": 41584919, "link": "https://stackoverflow.com/questions/41584919/store-an-int-in-a-char-buffer-in-c-and-then-retrieve-the-same/41589783#41589783", "title": "Store an int in a char buffer in C and then retrieve the same", "body": "<p>This may be a terrible idea but I'll post it here for interest - you can use a <a href=\"http://www.cplusplus.com/doc/tutorial/other_data_types/\" rel=\"nofollow noreferrer\">union</a>:</p>\n\n<pre><code>union my_data\n{\n    uint32_t one_int;\n\n    struct\n    {\n        uint8_t  byte3;\n        uint8_t  byte2;\n        uint8_t  byte1;\n        uint8_t  byte0;\n    }bytes;\n};\n\n\n// Your original code modified to use union my_data\n#include &lt;stdio.h&gt;\n\nint main(void) {\n    union my_data data;\n    uint32_t inVal = 0, outVal = 0;\n    uint8_t buf[4] = {0};\n\n    inVal = 67502978;\n\n    printf(\"inVal: %u\\n\", inVal);\n\n    data.one_int = inVal;\n\n    // Populate bytes into buff    \n    buf[3] = data.bytes.byte3;\n    buf[2] = data.bytes.byte2;\n    buf[1] = data.bytes.byte1;\n    buf[0] = data.bytes.byte0;\n\n    return 0;\n}\n</code></pre>\n\n<p>I don't know if this would also work, can't see why not:</p>\n\n<pre><code>union my_data\n{\n    uint32_t one_int;\n    uint8_t  bytes[4];\n};\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 2603637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601b46dbd62d1688beb03b5137adabdd?s=128&d=identicon&r=PG", "display_name": "Pratik", "link": "https://stackoverflow.com/users/2603637/pratik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4937, "favorite_count": 1, "answer_count": 7, "score": 9, "last_activity_date": 1485019388, "creation_date": 1484119291, "last_edit_date": 1485019388, "question_id": 41584919, "link": "https://stackoverflow.com/questions/41584919/store-an-int-in-a-char-buffer-in-c-and-then-retrieve-the-same", "title": "Store an int in a char buffer in C and then retrieve the same", "body": "<p>I am writing a socket client-server application where the server needs to send a large buffer to a client and all buffers should be processed separately, so I want to put the buffer length in the buffer so that the client can read the length of data from the buffer and process accordingly.</p>\n\n<p>To put the length value I need to divide an integer value in one byte each and store it in a buffer to be sent over the socket. I am able to break the integer into four parts, but at the time of joining I am not able to retrieve the correct value. To demonstrate my problem I have written a sample program where I am dividing int into four char variables and then join it back in another integer. The goal is that after joining I should get the same result.</p>\n\n<p>Here is my small program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n    int inVal = 0, outVal =0;\n    char buf[5] = {0};\n\n    inVal = 67502978;\n\n    printf (\"inVal: %d\\n\", inVal);\n\n    buf[0] = inVal &amp; 0xff;\n    buf[1] = (inVal &gt;&gt; 8) &amp; 0xff;\n    buf[2] = (inVal &gt;&gt; 16) &amp; 0xff;\n    buf[3] = (inVal &gt;&gt; 24) &amp; 0xff;\n\n    outVal = buf[3];\n    outVal = outVal &lt;&lt; 8;\n    outVal |= buf[2];\n    outVal = outVal &lt;&lt; 8;\n    outVal |= buf[1];\n    outVal = outVal &lt;&lt; 8;\n    outVal |= buf[0];\n\n    printf (\"outVal: %d\\n\",outVal);\n    return 0;\n}\n</code></pre>\n\n<h3>Output</h3>\n\n<p>inVal: 67502978\noutVal: -126</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "postgresql"], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 820922, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/df5b76e25306a43d373d32696c82a14c?s=128&d=identicon&r=PG", "display_name": "gnuger", "link": "https://stackoverflow.com/users/820922/gnuger"}, "edited": false, "score": 0, "creation_date": 1484136728, "post_id": 41586039, "comment_id": 70384526, "body": "This is not working, perhaps because it is expecting first argument to be <i>timestamp[]</i> type but actually is a composite-type argument <i>mytype</i>. Also <a href=\"https://www.postgresql.org/docs/current/static/xfunc-c.html#AEN60514\" rel=\"nofollow noreferrer\">this page</a> says that for composite-type HeapTupleHeader should be used."}, {"owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "reply_to_user": {"reputation": 187, "user_id": 820922, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/df5b76e25306a43d373d32696c82a14c?s=128&d=identicon&r=PG", "display_name": "gnuger", "link": "https://stackoverflow.com/users/820922/gnuger"}, "edited": false, "score": 0, "creation_date": 1484139209, "post_id": 41586039, "comment_id": 70386184, "body": "Argh, I forgot that it is a user-defined type. I have fixed the answer."}], "tags": [], "owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "is_accepted": true, "score": 1, "last_activity_date": 1484139161, "last_edit_date": 1484139161, "creation_date": 1484123652, "answer_id": 41586039, "question_id": 41583790, "link": "https://stackoverflow.com/questions/41583790/access-array-of-timestamp-from-composite-type-argument-in-postgres-c-function/41586039#41586039", "title": "Access array of timestamp from composite-type argument in Postgres C Function", "body": "<p>Look at the PostgreSQL source code to see how to handle array arguments.</p>\n\n<p>Your code should look somewhat like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>HeapTupleHeader at = PG_GETARG_HEAPTUPLEHEADER(0);\nDatum dt = GetAttributeByName(at, \"timestamps\", &amp;isnull);\nArrayType *ts = DatumGetArrayTypeP(dt);\nTimestamp *timestamps = (Timestamp *) ARR_DATA_PTR(ts);\n</code></pre>\n\n<p>This is not complete; you might want to add checks for <code>NULL</code>, if the array has the expected number of dimensions and similar.</p>\n"}], "owner": {"reputation": 187, "user_id": 820922, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/df5b76e25306a43d373d32696c82a14c?s=128&d=identicon&r=PG", "display_name": "gnuger", "link": "https://stackoverflow.com/users/820922/gnuger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 41586039, "answer_count": 1, "score": 0, "last_activity_date": 1484139161, "creation_date": 1484114727, "question_id": 41583790, "link": "https://stackoverflow.com/questions/41583790/access-array-of-timestamp-from-composite-type-argument-in-postgres-c-function", "title": "Access array of timestamp from composite-type argument in Postgres C Function", "body": "<p>I have a user-defined type <em>mytype</em> :</p>\n\n<pre><code>CREATE TYPE mytype AS (\n    timestamps timestamp[], \n    last integer\n);\n</code></pre>\n\n<p>I want to access values in <em>timestamps</em> field using C function. Here is what I have written :</p>\n\n<pre><code>#include \"postgres.h\"\n#include \"fmgr.h\"\n#include \"executor/executor.h\"\n#include \"datatype/timestamp.h\"\n\n\n#ifdef PG_MODULE_MAGIC\nPG_MODULE_MAGIC;\n#endif\n\nPG_FUNCTION_INFO_V1(testfunc);\n\nDatum\ntestfunc(PG_FUNCTION_ARGS) {\n    bool isnull;\n    HeapTupleHeader  at = PG_GETARG_HEAPTUPLEHEADER(0);\n    Datum dt = GetAttributeByName(at, \"timestamps\", &amp;isnull);\n\n    Timestamp ** tts = (Timestamp **) DatumGetPointer(dt);\n\n    PG_RETURN_DATUM(**tts);\n}\n</code></pre>\n\n<p>SQL reference :</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION testfunc(mytype) RETURNS timestamp AS 'path/to/library.so', 'testfunc' LANGUAGE C STRICT;\n</code></pre>\n\n<p>Now I am getting garbage result when I am trying to test:</p>\n\n<pre><code>postgres=# SELECT testfunc('(\"{\"\"2017-01-11 00:00:00\"\", NULL}\", 10)');\n        testfunc        \n---------------------------\n 2000-01-01 00:00:00.00001\n(1 row)\n</code></pre>\n"}, {"tags": ["c", "linux", "multithreading", "gdb"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1484113509, "post_id": 41583401, "comment_id": 70371423, "body": "<code>address of p changing</code> - hmmm, isn&#39;t it the value held by <code>p</code> that changes? It changes because you assign to <code>p</code>"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1484115123, "post_id": 41583401, "comment_id": 70372036, "body": "Non-readonly, non-atomic, unsynchronized access to a shared object from multiple threads -&gt; race-condition, undefined behavior."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484115126, "post_id": 41583401, "comment_id": 70372037, "body": "You need to use <code>strcpy()</code> to copy strings around."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1484115869, "post_id": 41583401, "comment_id": 70372310, "body": "<code>p = malloc(sizeof(100));</code> random code mutations rarely help in fixing bugs, don&#39;t do that."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7398886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/573d96851a3611c83aba35d3aea4a0ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jaydeep ", "link": "https://stackoverflow.com/users/7398886/jaydeep"}, "edited": false, "score": 0, "creation_date": 1484126116, "post_id": 41584448, "comment_id": 70377263, "body": "Thanks you ... Rishikesh...!!  I am not able to understand.... according to thread main process and all thread process shares same heap memory... while switching to main process stack to thread stack , why pointer address is changing??  Could you please elaborate this with some more explaining...  thanks in advance...!!"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 3, "user_id": 7398886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/573d96851a3611c83aba35d3aea4a0ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jaydeep ", "link": "https://stackoverflow.com/users/7398886/jaydeep"}, "edited": false, "score": 0, "creation_date": 1484126431, "post_id": 41584448, "comment_id": 70377468, "body": "@Jaydeep You are passing the function <code>handler</code> to <code>pthread_create</code> The handler function is changing the pointer."}, {"owner": {"reputation": 3, "user_id": 7398886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/573d96851a3611c83aba35d3aea4a0ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jaydeep ", "link": "https://stackoverflow.com/users/7398886/jaydeep"}, "edited": false, "score": 0, "creation_date": 1484127762, "post_id": 41584448, "comment_id": 70378448, "body": "Thanks Rishikesh...  But , still why handler is changing pointer , but pointer is globally uninitialized, then it is in BSS section of memory, as per thread concept, Everything is shared except stack...  then how again it is changed??"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 3, "user_id": 7398886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/573d96851a3611c83aba35d3aea4a0ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jaydeep ", "link": "https://stackoverflow.com/users/7398886/jaydeep"}, "edited": false, "score": 0, "creation_date": 1484200550, "post_id": 41584448, "comment_id": 70414042, "body": "@Jaydeep - Exactly, globals are shared. The pointer is  modified first in the main function and then in the handler function. When it comes back to the main function, it gets the new value."}, {"owner": {"reputation": 3, "user_id": 7398886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/573d96851a3611c83aba35d3aea4a0ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jaydeep ", "link": "https://stackoverflow.com/users/7398886/jaydeep"}, "edited": false, "score": 0, "creation_date": 1484213574, "post_id": 41584448, "comment_id": 70420539, "body": "Still I am not getting...!!  pointer&#39;s address or pointer I am not passing like any parameters as well I am not defining any local pointer , then how it is changing!!!!!!!!!!???"}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 2, "last_activity_date": 1484117389, "creation_date": 1484117389, "answer_id": 41584448, "question_id": 41583401, "link": "https://stackoverflow.com/questions/41583401/thread-changing-heap-memory/41584448#41584448", "title": "Thread changing heap memory", "body": "<p>The issue is in </p>\n\n<pre><code>// in main\np = malloc(sizeof(100)); // allocating memory tried (p =malloc(sizeof(char)*100);)\n\n// in handler function\np = \"hello\"; // initializing p \n</code></pre>\n\n<p>Here <code>p</code> is a global variable, and you have previously used malloc on it. In the handler function, you are assigning <code>p</code> to the address of a string literal, resulting in a dangling pointer. When you try to free this modified <code>p</code> you get an error.</p>\n\n<p>What you should do is</p>\n\n<pre><code>const char *hell = \"hello\";\nstrcpy(p,hell);\n</code></pre>\n\n<p>Also, fix the malloc to what you had previously. The current code allocates only 4 bytes. (<code>sizeof (100)</code> is the same as <code>sizeof(int)</code>)</p>\n"}], "owner": {"reputation": 3, "user_id": 7398886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/573d96851a3611c83aba35d3aea4a0ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jaydeep ", "link": "https://stackoverflow.com/users/7398886/jaydeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484117389, "creation_date": 1484112883, "last_edit_date": 1484113514, "question_id": 41583401, "link": "https://stackoverflow.com/questions/41583401/thread-changing-heap-memory", "title": "Thread changing heap memory", "body": "<p>I am compiling this program.</p>\n\n<pre><code>char * p;    \nvoid * handler(void * arg)\n{\n  p = \"hello\"; // initializing p \n  puts(p);\n  puts(\"------\");\n  long tid = (long) arg;\n  printf(\"Hello wrold! it is in thread : %ld\\n\", tid);\n  pthread_exit(NULL); //exiting thread \n}\n\nint main() {\n  pthread_t t_id[2];\n  int rc;\n  long t;\n  p = malloc(sizeof(100)); // allocating memory tried (p =malloc(sizeof(char)*100);)\n  if (p == NULL) {\n    perror(\"malloc\");\n    exit(EXIT_FAILURE);\n  }\n\n\n  for (t = 0; t &lt; 2; t++) {\n    printf(\"Creating Thread  %ld\\n\", t);\n    rc = pthread_create( &amp; t_id[t], NULL, handler, (void * ) t);\n    if (rc) {\n      perror(\"pthread_create\");\n      exit(EXIT_FAILURE);\n    }\n  }\n  pthread_join(t_id[0], NULL);\n  pthread_join(t_id[1], NULL);\n  free(p); /// segmentation fault here... \n  puts(\"***\");\n  //      pthread_exit(NULL);\n\n}\n</code></pre>\n\n<p>I am getting segmentation fault here,\nI checked using <code>gdb</code>.\nSurprisingly,Address of <code>p</code>  is changing.WHY?</p>\n\n<p>Any helping hand will be appreciated! </p>\n\n<p>Using host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".</p>\n\n<pre><code>Temporary breakpoint 1, main () at thread_heap.c:27\n27              p=malloc(sizeof(100));\n(gdb) p p\n*$1 = 0x0*    **/// adress of p**\n(gdb) next\n28              if(p==NULL)\n(gdb) p p      \n*$2 = 0x602010 \"\"*  **// why changed here????**\n(gdb) next\n35              for (t=0;t&lt;2;t++)\n(gdb) p p\n$3 = 0x602010 \"\"\n(gdb) next\n37                      printf(\"Creating Thread  %ld\\n\",t);\n(gdb)\nCreating Thread  0\n38                      rc=pthread_create(&amp;t_id[t],NULL,handler,(void *)t);\n(gdb)\n[New Thread 0x7ffff77fe700 (LWP 21632)]\n.\n.\n.\n\n114     in pthread_join.c\n(gdb)\nmain () at thread_heap.c:49\n49      free(p);\n(gdb) p p\n*$4 = 0x4009e0 \"hello\"*   **/// again why changed here?**\n(gdb)\n$5 = 0x4009e0 \"hello\"\n(gdb) step\n__GI___libc_free (mem=0x4009e0) at malloc.c:2959\n2959    malloc.c: No such file or directory.\n(gdb) q\n\nProgram received signal SIGSEGV, Segmentation fault.\n_int_free (av=0x7ffff7bb6720, p=0x4009d0, have_lock=0) at malloc.c:4098\n4098    malloc.c: No such file or directory.   // Why this address changed?\n(gdb)\n</code></pre>\n"}, {"tags": ["c", "token", "lexer"], "comments": [{"owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 0, "creation_date": 1484111034, "post_id": 41583056, "comment_id": 70370569, "body": "I&#39;m voting to close this question as off-topic because homework should be attempted"}, {"owner": {"reputation": 1, "user_id": 6231920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68933ed6268dd6cc243498d9eed62dae?s=128&d=identicon&r=PG", "display_name": "Dash_25", "link": "https://stackoverflow.com/users/6231920/dash-25"}, "reply_to_user": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 0, "creation_date": 1484111374, "post_id": 41583056, "comment_id": 70370691, "body": "sorry, but this is not a homework question."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1484111421, "post_id": 41583056, "comment_id": 70370709, "body": "it is 2 preprocessing tokens, <code>#</code> and <code>define</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1484111436, "post_id": 41583056, "comment_id": 70370713, "body": "Then why did it originally say &quot;<i>For the following \u2018C\u2019 fragment, identify and list the lexemes that make up tokens.</i>&quot;?"}, {"owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 2, "creation_date": 1484111439, "post_id": 41583056, "comment_id": 70370714, "body": "best idea ever!: &quot;#define int char &quot; !"}, {"owner": {"reputation": 1, "user_id": 6231920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68933ed6268dd6cc243498d9eed62dae?s=128&d=identicon&r=PG", "display_name": "Dash_25", "link": "https://stackoverflow.com/users/6231920/dash-25"}, "edited": false, "score": 0, "creation_date": 1484111732, "post_id": 41583056, "comment_id": 70370809, "body": "first of all it is question from previous year paper and after 2 hours my exam will be taken.i am only concerned about preprocessor directives else part i can handle. if anyone knows the anser then plz tell me."}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 1, "creation_date": 1484112178, "post_id": 41583056, "comment_id": 70370970, "body": "In the future, I recommend learning to use your favorite search engine for questions that will obviously have publicly available answers instead of asking other people to find them for you. Who knows, in the process you might learn something in addition to your one narrow question."}, {"owner": {"reputation": 1, "user_id": 6231920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68933ed6268dd6cc243498d9eed62dae?s=128&d=identicon&r=PG", "display_name": "Dash_25", "link": "https://stackoverflow.com/users/6231920/dash-25"}, "reply_to_user": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1484112286, "post_id": 41583056, "comment_id": 70371000, "body": "@CareyGregory i will remember this for next time,thank you sir."}], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1484111936, "last_edit_date": 1484111936, "creation_date": 1484111738, "answer_id": 41583178, "question_id": 41583056, "link": "https://stackoverflow.com/questions/41583056/can-we-consider-preprocessor-directives-as-token/41583178#41583178", "title": "Can we consider preprocessor directives as token?", "body": "<p>The ISO C standard explicitly calls out what tokens exist, for example, in <code>c11 6.4</code>:</p>\n\n<pre><code>token:\n    keyword\n    identifier\n    constant\n    string-literal\n    punctuator\npreprocessing-token:\n    header-name\n    identifier\n    pp-number\n    character-constant\n    string-literal\n    punctuator\n    each non-white-space character that cannot be one of the above\n</code></pre>\n\n<p>So, no, <code>#define</code> is <em>not</em> a token, it's two pre-processing tokens, <code>#</code> and the <code>define</code> identifier.</p>\n\n<p>It's an identifier as per <code>6.4.2.1</code> where it's defined as basically <code>[_A-Za-z][_A-Za-z0-9]*</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 6231920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68933ed6268dd6cc243498d9eed62dae?s=128&d=identicon&r=PG", "display_name": "Dash_25", "link": "https://stackoverflow.com/users/6231920/dash-25"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "closed_date": 1484122234, "accepted_answer_id": 41583178, "answer_count": 1, "score": -5, "last_activity_date": 1484111936, "creation_date": 1484110912, "last_edit_date": 1484111306, "question_id": 41583056, "link": "https://stackoverflow.com/questions/41583056/can-we-consider-preprocessor-directives-as-token", "closed_reason": "Needs details or clarity", "title": "Can we consider preprocessor directives as token?", "body": "<p>for the following code can we consider <strong>'#define'</strong> as token?</p>\n\n<pre><code>#define int char \n main(){\n   int i=65;               // i is initialized  \n   printf(\"sizeof(i)=%d\",sizeof(i)); \n}\n</code></pre>\n"}, {"tags": ["c", "kaa"], "comments": [{"owner": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "edited": false, "score": 0, "creation_date": 1484109931, "post_id": 41582847, "comment_id": 70370191, "body": "Would like to clarify some of these errors with you and what do they mean ? @Mikel F , sorry for the inconvenience caused."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1484110163, "post_id": 41582847, "comment_id": 70370262, "body": "I would hope that <code>&#39;X&#39; has no member named &#39;Y&#39;</code> is pretty straightforward..."}, {"owner": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1484111120, "post_id": 41582847, "comment_id": 70370610, "body": "But i did add the members into the log record where the kaa_logging_data_collection_t saves them all up."}, {"owner": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1484111898, "post_id": 41582847, "comment_id": 70370877, "body": "How about should i do it for the &#39;no member&#39; error for my codes ?"}, {"owner": {"reputation": 659, "user_id": 7356924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fd0d6a9d8db7cffe199c9be89424c20?s=128&d=identicon&r=PG&f=1", "display_name": "Vimal Bhaskar", "link": "https://stackoverflow.com/users/7356924/vimal-bhaskar"}, "edited": false, "score": 0, "creation_date": 1484112150, "post_id": 41582847, "comment_id": 70370958, "body": "You have used batt,cel,wt as float and doing rand() operation and that too with an additional usage of &quot;%&quot; operator. Guess that wont work out. Please check the usage of rand() function."}, {"owner": {"reputation": 313, "user_id": 6620886, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/512eac7f669d64cad36f37e0c8c67cba?s=128&d=identicon&r=PG&f=1", "display_name": "mahesh Rao", "link": "https://stackoverflow.com/users/6620886/mahesh-rao"}, "edited": false, "score": 0, "creation_date": 1484112572, "post_id": 41582847, "comment_id": 70371113, "body": "Since you did add members into the log record, it is possible that the program has not been compiled properly. Did you compile the entire program with an updated object code?"}, {"owner": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "edited": false, "score": 0, "creation_date": 1484112574, "post_id": 41582847, "comment_id": 70371116, "body": "i have changed my codes to : fmod(rand(), (5.0 - 3.0 + 1)) + 3.0; for the 3 because all of them are around the same values. but funnny is that i only have errors for batt but not for wt and cel"}, {"owner": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "edited": false, "score": 0, "creation_date": 1484112624, "post_id": 41582847, "comment_id": 70371135, "body": "Does the &#39;has no member&#39; errors osos dependent on the error you told me"}, {"owner": {"reputation": 313, "user_id": 6620886, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/512eac7f669d64cad36f37e0c8c67cba?s=128&d=identicon&r=PG&f=1", "display_name": "mahesh Rao", "link": "https://stackoverflow.com/users/6620886/mahesh-rao"}, "edited": false, "score": 0, "creation_date": 1484113135, "post_id": 41582847, "comment_id": 70371298, "body": "On making said changes, do all the errors still remain ? if not, which of them do ?"}, {"owner": {"reputation": 313, "user_id": 6620886, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/512eac7f669d64cad36f37e0c8c67cba?s=128&d=identicon&r=PG&f=1", "display_name": "mahesh Rao", "link": "https://stackoverflow.com/users/6620886/mahesh-rao"}, "edited": false, "score": 0, "creation_date": 1484113706, "post_id": 41582847, "comment_id": 70371494, "body": "The errors that occurred are self explanatory. The modulo operator is integer based, hence you use <code>fmod</code>. <code>rand</code> is generally initialized via <code>srand</code> but, if it isn&#39;t, you have set the random number seed to 1. The <b>has no member</b> error also tells you that the compiler isn&#39;t able to find that particular member. This may occur if the compiler is not referring to the desired structure, the object code of the program has not been updated or the structure actually does not have those members."}, {"owner": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "edited": false, "score": 0, "creation_date": 1484113707, "post_id": 41582847, "comment_id": 70371495, "body": "im debugging errors by errors. i first editted &#39;%&#39; for all the batt,cel and wt because its a common error. But all of them are of the same method , so i searched on the right rand function and then i applied to all of them. but then i only got error for batt for : incompatible implicit declaration of built-in function \u2018fmod\u2019      whereas not for wt and cel"}, {"owner": {"reputation": 313, "user_id": 6620886, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/512eac7f669d64cad36f37e0c8c67cba?s=128&d=identicon&r=PG&f=1", "display_name": "mahesh Rao", "link": "https://stackoverflow.com/users/6620886/mahesh-rao"}, "edited": false, "score": 0, "creation_date": 1484114088, "post_id": 41582847, "comment_id": 70371644, "body": "Did you include math.h header ?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1484115619, "post_id": 41582847, "comment_id": 70372214, "body": "@darrensim How are we supposed to know whether the members are in the structure if we can&#39;t see the structure? But I assume they aren&#39;t in the structure because the compiler says they aren&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "edited": false, "score": 0, "creation_date": 1484120744, "post_id": 41583573, "comment_id": 70374516, "body": "i couldnt find this function or structure..isit possible like its being pointed to another variable or address containing the temperature and timestamp?"}, {"owner": {"reputation": 484, "user_id": 5834521, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QBMYVTwXyGs/AAAAAAAAAAI/AAAAAAAAA8M/y7HIjlZQRVA/photo.jpg?sz=128", "display_name": "Vishwajeet Vishu", "link": "https://stackoverflow.com/users/5834521/vishwajeet-vishu"}, "reply_to_user": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "edited": false, "score": 1, "creation_date": 1484126504, "post_id": 41583573, "comment_id": 70377512, "body": "You need to find the structure, because then only you will be sure what it contains are and how to access those elements otherwise you wont be able to access them properly. It might be possible that these elements are there in the structure but they are being accessed through some other pointer or DE-reference variable.   Just like before using a machine you should know what are its  components and what they do individually,   You can look for the definition of this structure in custom header files.  Hope this helps"}, {"owner": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "edited": false, "score": 0, "creation_date": 1484127499, "post_id": 41583573, "comment_id": 70378274, "body": "Found it ! haha but now am stucked with another problem with something called avro_Reader. do not worry , after i get 15 reputations , i will be back to upvote for you !"}, {"owner": {"reputation": 484, "user_id": 5834521, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QBMYVTwXyGs/AAAAAAAAAAI/AAAAAAAAA8M/y7HIjlZQRVA/photo.jpg?sz=128", "display_name": "Vishwajeet Vishu", "link": "https://stackoverflow.com/users/5834521/vishwajeet-vishu"}, "reply_to_user": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "edited": false, "score": 0, "creation_date": 1484127748, "post_id": 41583573, "comment_id": 70378435, "body": "ok try to sort it out, if it does not go away. you can alwaysshare it with us"}], "tags": [], "owner": {"reputation": 484, "user_id": 5834521, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QBMYVTwXyGs/AAAAAAAAAAI/AAAAAAAAA8M/y7HIjlZQRVA/photo.jpg?sz=128", "display_name": "Vishwajeet Vishu", "link": "https://stackoverflow.com/users/5834521/vishwajeet-vishu"}, "is_accepted": false, "score": 0, "last_activity_date": 1484113777, "last_edit_date": 1495542832, "creation_date": 1484113777, "answer_id": 41583573, "question_id": 41582847, "link": "https://stackoverflow.com/questions/41582847/what-are-these-errors/41583573#41583573", "title": "What are these errors?", "body": "<p>Your first three errors are are caused by the fact that modulus operator doesn't work with real number. and you are using real number to divide the output of rand() which is integer. The topic is explained here:\n(<a href=\"https://stackoverflow.com/questions/6102948/why-does-modulus-division-only-work-with-integers\">Why does modulus division (%) only work with integers?</a>)</p>\n\n<p>Can you please share the structure (kaa_logging_data_collection_t) elements:\nIf you can. then only anyone can be sure that why these errors are coming here.</p>\n"}], "owner": {"reputation": 9, "user_id": 7369999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-gGr2cPGUhsk/AAAAAAAAAAI/AAAAAAAAACo/Ni_an060G7Q/photo.jpg?sz=128", "display_name": "darren sim", "link": "https://stackoverflow.com/users/7369999/darren-sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484676164, "creation_date": 1484109795, "last_edit_date": 1484676164, "question_id": 41582847, "link": "https://stackoverflow.com/questions/41582847/what-are-these-errors", "title": "What are these errors?", "body": "<pre><code>These above are the codes.                  \n    demo_printf(\"Sampled NodeId %d %lu\\n\", NodeId,\"Sampled SignalSTR %d %lu\\n\", Signal,\"Sampled FirmwareVER %d %lu\\n\", FirmwareVER,\"Sampled battery %f %lu\\n\", batt,timestamp);\n    kaa_error_t error = kaa_logging_add_record(\n            kaa_client_get_context(kaa_client)-&gt;log_collector,\n            log_record, NULL);  \n</code></pre>\n\n<p>Below are the errors. I dont understand what the errors are. New to C language so far...It seems like for my float variables , i cannot use '%' to carry out my random() function. Below are the errors :</p>\n\n<pre><code>/home/pi/try/client/c/src/kaa_demo.c: In function \u2018send_temperature\u2019:\n/home/pi/try/client/c/src/kaa_demo.c:72:22: error: invalid operands to binary % (have \u2018int\u2019 and \u2018double\u2019)\n  float batt = rand() % 5.0;\n                      ^\n/home/pi/try/client/c/src/kaa_demo.c:73:21: error: invalid operands to binary % (have \u2018int\u2019 and \u2018double\u2019)\n  float cel = rand() % 5.0;\n                     ^\n/home/pi/try/client/c/src/kaa_demo.c:74:20: error: invalid operands to binary % (have \u2018int\u2019 and \u2018double\u2019)\n  float wt = rand() % 5.0;                                                       // kaa_logging_data_collection_t is the structure defined to contain temperature and time_stamp\n                    ^\n/home/pi/try/client/c/src/kaa_demo.c:81:12: error: \u2018kaa_logging_data_collection_t\u2019 has no member named \u2018NodeId\u2019\n  log_record-&gt;NodeId = kaa_string_copy_create(\"Screws\");\n            ^\n/home/pi/try/client/c/src/kaa_demo.c:82:15: error: \u2018kaa_logging_data_collection_t\u2019 has no member named \u2018SignalSTR\u2019\n     log_record-&gt;SignalSTR = Signal;\n               ^\n/home/pi/try/client/c/src/kaa_demo.c:83:12: error: \u2018kaa_logging_data_collection_t\u2019 has no member named \u2018FirmwareVER\u2019\n  log_record-&gt;FirmwareVER = kaa_string_copy_create(\"Linux KIDS\");\n            ^\n/home/pi/try/client/c/src/kaa_demo.c:84:12: error: \u2018kaa_logging_data_collection_t\u2019 has no member named \u2018OnlineStat\u2019\n  log_record-&gt;OnlineStat = status;\n</code></pre>\n"}, {"tags": ["c", "pointers", "initialization", "malloc"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1484109544, "post_id": 41582793, "comment_id": 70370084, "body": "The pointers &#39;fit&#39;, but the interpretation of the pointers is wrong, so all hell breaks loose."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1484109580, "post_id": 41582793, "comment_id": 70370093, "body": "Why do you think it doesn&#39;t work?"}, {"owner": {"reputation": 183, "user_id": 4475130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a4d640a92aa265f9c429dd098d77f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas Gudmundsson", "link": "https://stackoverflow.com/users/4475130/tomas-gudmundsson"}, "edited": false, "score": 0, "creation_date": 1484109730, "post_id": 41582793, "comment_id": 70370134, "body": "pointer is just a pointer, why does it have to take as many bits as long long int * instead of just int *?"}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1484109743, "post_id": 41582793, "comment_id": 70370136, "body": "There is a difference between <code>int</code> and <code>long long int</code>. First example will work if you do <code>m[i] = malloc(n * sizeof(int));</code>"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1484109874, "post_id": 41582793, "comment_id": 70370172, "body": "@TomasGudmundsson The question in your comment makes no sense."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1484134881, "post_id": 41582793, "comment_id": 70383355, "body": "when calling <code>malloc()</code>, always check (!=NULL) the returned value to assure the operation was successful."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1484109961, "creation_date": 1484109961, "answer_id": 41582875, "question_id": 41582793, "link": "https://stackoverflow.com/questions/41582793/2d-initialization-syntax-in-c/41582875#41582875", "title": "2D initialization syntax in C", "body": "<p>It's not the size of the pointer, it's the type associated with it. When your allocation has finished, which is completely fine, as long as you use <code>m</code> as a matrix of <code>int</code>s, you will eventually write something like this:</p>\n\n<pre><code>long long int myLongLongInt = 1234567;\nm[row][col] = myLongLongInt;\n</code></pre>\n\n<p>This is where the problem is, because <code>m[row][col]</code> is an <em>lvalue</em> of integer type, not <code>long long int</code> type. Two adjacent elements of <code>m</code>'s row are <code>sizeof(int)</code> apart, not <code>sizeof(long long int)</code>. Hence the assignment will not work correctly.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 2, "last_activity_date": 1484115820, "creation_date": 1484115820, "answer_id": 41584023, "question_id": 41582793, "link": "https://stackoverflow.com/questions/41582793/2d-initialization-syntax-in-c/41584023#41584023", "title": "2D initialization syntax in C", "body": "<p>Neither of the 2 fragments in your question initializes an <em>array</em> of <code>long long int</code>s.</p>\n\n<ul>\n<li>You merely allocate an array of pointers to arrays of <code>int</code> of <code>long long int</code> respectively, but none of these are initialized.</li>\n<li>The first fragment is inconsistent as you allocate memory for the second level arrays with a size of <code>n * sizeof(long long int)</code> instead of <code>n * sizeof(int)</code>, but it will not cause problems since <code>long long int</code> cannot be smaller than <code>int</code>.</li>\n<li>The second fragment is more consistent, but you should use type <code>size_t</code> for the index <code>i</code> for complete consistency.</li>\n</ul>\n\n<p><em>pointer to the long long ints does not fit in an int? It's just an address, right?</em> :</p>\n\n<ul>\n<li>No, pointers indeed contain addresses, but may be larger than <code>int</code>. Most 64-bit systems have 32-bit <code>int</code> and 64-bit pointers.</li>\n</ul>\n\n<p>Here are more reliable ways to allocate and initialize your 2D pseudo arrays:</p>\n\n<pre><code>// allocate and initialize the 2D indirect array\nlong long int **m = malloc(n * sizeof(*m));\nfor (size_t i = 0; i &lt; n; i++) {\n    m[i] = calloc(n, sizeof(*m[i]));\n}\n\n// allocate and initialize a 2D indirect array with a single chunk\nlong long int **m = malloc(n * sizeof(*m));\nm[0] = calloc(n * n, sizeof(*m[0]));\nfor (size_t i = 1; i &lt; n; i++) {\n    m[i] = m[i - 1] + n;\n}\n\n// allocate and initialize a flat 2D array:\nlong long int m[n][n] = calloc(1, sizeof(m));\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 4475130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a4d640a92aa265f9c429dd098d77f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas Gudmundsson", "link": "https://stackoverflow.com/users/4475130/tomas-gudmundsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 41584023, "answer_count": 2, "score": 1, "last_activity_date": 1484115820, "creation_date": 1484109444, "last_edit_date": 1484109685, "question_id": 41582793, "link": "https://stackoverflow.com/questions/41582793/2d-initialization-syntax-in-c", "title": "2D initialization syntax in C", "body": "<p>Why doesn't the following work to initialise an array of long long ints in C:</p>\n\n<pre><code>int **m = malloc(n * sizeof(int *));\nfor (int i = 0; i &lt; n; i++) m[i] = malloc(n * sizeof(long long int));\n</code></pre>\n\n<p>To work it has to be:</p>\n\n<pre><code>long long int **m = malloc(n * sizeof(long long int *));\nfor (int i = 0; i &lt; n; i++) m[i] = malloc(n *sizeof(long long int));\n</code></pre>\n\n<p>I don't understand why the pointer to the long long ints does not fit in an int? It's just an address, right?</p>\n"}, {"tags": ["c", "linux-kernel", "embedded-linux", "kernel-module", "udev"], "comments": [{"owner": {"reputation": 149, "user_id": 6527069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed5dafb099cb8d761542704bfc4a8e6?s=128&d=identicon&r=PG&f=1", "display_name": "Ludvig Rydahl", "link": "https://stackoverflow.com/users/6527069/ludvig-rydahl"}, "edited": false, "score": 0, "creation_date": 1484108360, "post_id": 41582608, "comment_id": 70369732, "body": "Have you read this <a href=\"https://www.kernel.org/doc/Documentation/usb/hotplug.txt\" rel=\"nofollow noreferrer\">documentation</a>?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1484109084, "post_id": 41582608, "comment_id": 70369961, "body": "How are you currently polling?"}, {"owner": {"reputation": 191, "user_id": 6739618, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2498d7dc6fee4a8f84841cc41b4935c8?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Rawat", "link": "https://stackoverflow.com/users/6739618/ankit-rawat"}, "edited": false, "score": 0, "creation_date": 1484110047, "post_id": 41582608, "comment_id": 70370226, "body": "using udevadm monitor and i also did it by creating netlink socket to listen uevent, but stil its a polling technique, in my application there are lots of threads already and one more thread for polling is costly for me"}, {"owner": {"reputation": 26831, "user_id": 1778421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HIUgI.png?s=128&g=1", "display_name": "Alex P.", "link": "https://stackoverflow.com/users/1778421/alex-p"}, "edited": false, "score": 1, "creation_date": 1484117052, "post_id": 41582608, "comment_id": 70372819, "body": "you could create a <code>udev</code> rule to send a signal to your process when a matching device is plugged in"}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 6739618, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2498d7dc6fee4a8f84841cc41b4935c8?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Rawat", "link": "https://stackoverflow.com/users/6739618/ankit-rawat"}, "edited": false, "score": 0, "creation_date": 1484191466, "post_id": 41591128, "comment_id": 70411492, "body": "how to identify the process id in shell script, if multiple processes are running of same name @SD"}, {"owner": {"reputation": 1214, "user_id": 2007944, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/6WVNY.png?s=128&g=1", "display_name": "SD.", "link": "https://stackoverflow.com/users/2007944/sd"}, "reply_to_user": {"reputation": 191, "user_id": 6739618, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2498d7dc6fee4a8f84841cc41b4935c8?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Rawat", "link": "https://stackoverflow.com/users/6739618/ankit-rawat"}, "edited": false, "score": 0, "creation_date": 1484197879, "post_id": 41591128, "comment_id": 70413148, "body": "You should <code>getpid()</code> your process within the code and store it somewhere and use when needed."}, {"owner": {"reputation": 191, "user_id": 6739618, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2498d7dc6fee4a8f84841cc41b4935c8?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Rawat", "link": "https://stackoverflow.com/users/6739618/ankit-rawat"}, "edited": false, "score": 0, "creation_date": 1484201744, "post_id": 41591128, "comment_id": 70414452, "body": "i have to signal my process whnever hotplug in is detected, i am using PID=<code>pgrep myApp</code> in my script but what if multiple process of same name is running , in that case it always sends signal  to the process having lowest process id"}, {"owner": {"reputation": 1214, "user_id": 2007944, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/6WVNY.png?s=128&g=1", "display_name": "SD.", "link": "https://stackoverflow.com/users/2007944/sd"}, "reply_to_user": {"reputation": 191, "user_id": 6739618, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2498d7dc6fee4a8f84841cc41b4935c8?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Rawat", "link": "https://stackoverflow.com/users/6739618/ankit-rawat"}, "edited": false, "score": 0, "creation_date": 1484203124, "post_id": 41591128, "comment_id": 70415021, "body": "You can do something like this - printf(&quot;myApp process ID: %d\\n&quot;, getpid()); write code to store this pid somewhere on the filesystem - e.g in /var/run/myApp.pid file. Read pid from /var/run/myApp.pid file in script and send the signal."}, {"owner": {"reputation": 26831, "user_id": 1778421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HIUgI.png?s=128&g=1", "display_name": "Alex P.", "link": "https://stackoverflow.com/users/1778421/alex-p"}, "edited": false, "score": 0, "creation_date": 1484378202, "post_id": 41591128, "comment_id": 70494530, "body": "<code>killall -s SIGNAL myApp</code> would send the <code>SIGNAL</code> to all <code>myApp</code> processes"}], "tags": [], "owner": {"reputation": 1214, "user_id": 2007944, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/6WVNY.png?s=128&g=1", "display_name": "SD.", "link": "https://stackoverflow.com/users/2007944/sd"}, "is_accepted": false, "score": 0, "last_activity_date": 1484138086, "creation_date": 1484138086, "answer_id": 41591128, "question_id": 41582608, "link": "https://stackoverflow.com/questions/41582608/hot-plug-in-detect-by-interrupt/41591128#41591128", "title": "Hot-plug in detect by Interrupt", "body": "<p>First write a udev rule to identify the device and run a script (action) when that device is connected to the host.</p>\n\n<ol>\n<li>Get the information of your device with below command, in my example, it is USB console adapter. This command will report a bunch of things that we can use to identify the device on hotplugging by means of udev rule file.</li>\n</ol>\n\n<blockquote>\n  <p>$ udevadm info -a -n /dev/ttyUSB0</p>\n</blockquote>\n\n<p>Now make a file - /etc/udev/rules.d/99-usbdev.rules with below content.</p>\n\n<blockquote>\n  <p>SUBSYSTEM==\"tty\", ATTRS{idVendor}==\"xxxx\", ATTRS{idProduct}==\"xxxx\",\n  ATTRS{product}==\"USB to UART Bridge Controller\",\n  RUN+=\"/usr/bin/devattached.sh\"</p>\n</blockquote>\n\n<p><strong>Reload udev rules and service:</strong></p>\n\n<pre><code>$ udevadm control --reload-rules\n$ systemctl restart udev.service\n</code></pre>\n\n<p><strong>Debug:</strong> if the udev rule is not working!!</p>\n\n<pre><code>udevadm monitor --udev\n</code></pre>\n\n<ol start=\"2\">\n<li>Make a script with your desired action and put it on the exact same path provided in 'RUN+'. Don't forget to give executable permission to that script. Make use of pgrep and kill commands to send the signal to your process from the script.</li>\n</ol>\n"}], "owner": {"reputation": 191, "user_id": 6739618, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2498d7dc6fee4a8f84841cc41b4935c8?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Rawat", "link": "https://stackoverflow.com/users/6739618/ankit-rawat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 626, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1484138086, "creation_date": 1484108109, "last_edit_date": 1484114314, "question_id": 41582608, "link": "https://stackoverflow.com/questions/41582608/hot-plug-in-detect-by-interrupt", "title": "Hot-plug in detect by Interrupt", "body": "<p>I am currently using udev to detect USB hot-plug event in my application but as far as I know its a polling process, it requires one thread continuously monitoring kernel uevent.\nIs there any way that kernel notifies me by an interrupt or it signal to my process whenever Hot-Plug event detected?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "volatile", "avr-gcc"], "comments": [{"owner": {"reputation": 149, "user_id": 6527069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed5dafb099cb8d761542704bfc4a8e6?s=128&d=identicon&r=PG&f=1", "display_name": "Ludvig Rydahl", "link": "https://stackoverflow.com/users/6527069/ludvig-rydahl"}, "edited": false, "score": 0, "creation_date": 1484105678, "post_id": 41582121, "comment_id": 70369094, "body": "IMHO, that&#39;s extremely weird that GCC would opt to push your read outside the for-loop. Might want to post a bit more of your code for us to make a good judgement of this. I know AVR-GCC can do some funky stuff, but not completely without reason, but this small example might become more understandable if we get a bit more of context."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1484105717, "post_id": 41582121, "comment_id": 70369099, "body": "<i>The code I posted that shows the problem isn&#39;t real. I just made it up. Why is the compiler producing something different?</i> isn&#39;t going to work."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1484105724, "post_id": 41582121, "comment_id": 70369101, "body": "Maybe you misread the assembly? No one can verify unless you show the asm together with whatever else is needed to verify your conclusions."}, {"owner": {"reputation": 149, "user_id": 6527069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed5dafb099cb8d761542704bfc4a8e6?s=128&d=identicon&r=PG&f=1", "display_name": "Ludvig Rydahl", "link": "https://stackoverflow.com/users/6527069/ludvig-rydahl"}, "edited": false, "score": 0, "creation_date": 1484105883, "post_id": 41582121, "comment_id": 70369133, "body": "If you could post more of the assembly, we could debunk this easier. (you could use, say pastebin or something (I&#39;m not that sure about code posting alternatives) if you don&#39;t want to completly clog up the question with assembler code."}, {"owner": {"reputation": 85, "user_id": 1542099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2n91B.jpg?s=128&g=1", "display_name": "howard", "link": "https://stackoverflow.com/users/1542099/howard"}, "edited": false, "score": 0, "creation_date": 1484124206, "post_id": 41582121, "comment_id": 70376207, "body": "Compiler considers <code>for</code> statement is useless for variable <code>pwm</code>. just assigned the final value <code>forward[5]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "is_accepted": false, "score": 3, "last_activity_date": 1484108583, "last_edit_date": 1495542831, "creation_date": 1484107643, "answer_id": 41582530, "question_id": 41582121, "link": "https://stackoverflow.com/questions/41582121/avr-gcc-compiler-optimized-out-a-global-variable/41582530#41582530", "title": "avr-gcc compiler optimized out a global variable", "body": "<p>The problem is that the compiler has no way of knowing that you intend to use <code>pwm</code> in a different location from a different thread.  As you don't use the value in the loop the compiler just sets the value to the last value it would have written to the variable (the other values will be over written anyway).</p>\n\n<p>You need to use a memory fence to get around this (so the compiler and the CPU) don't reorder the writes to memory.</p>\n\n<p>edit: Looking at <a href=\"https://stackoverflow.com/a/27816848/450609\">this</a> answer suggests that adding <code>volatile</code> to <code>pwm</code> should be enough to make sure that all the writes occur.</p>\n"}], "owner": {"reputation": 85, "user_id": 1542099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2n91B.jpg?s=128&g=1", "display_name": "howard", "link": "https://stackoverflow.com/users/1542099/howard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "closed_date": 1484108853, "answer_count": 1, "score": -1, "last_activity_date": 1484123096, "creation_date": 1484104630, "last_edit_date": 1484123096, "question_id": 41582121, "link": "https://stackoverflow.com/questions/41582121/avr-gcc-compiler-optimized-out-a-global-variable", "closed_reason": "Not suitable for this site", "title": "avr-gcc compiler optimized out a global variable", "body": "<p>here,</p>\n\n<p>My origin code</p>\n\n<pre><code>OCR0A=30;\nuint16_t start=TCNT1;\nuint16_t w;\nfor(uint8_t i=0;i&lt;6;i++){\n  pwm=pgm_read_byte(&amp;forward[i]);     // mark here\n  // delay\n  do{\n    w=TCNT1;\n  } while(w-start&gt;300);\n}\nOCR0A=127;\n</code></pre>\n\n<p>compile it, and look into asm, I found my code's business was changed. it became some other like bellow</p>\n\n<pre><code>OCR0A=30;\nuint16_t start=TCNT1;\nuint16_t w;\nfor(uint8_t i=0;i&lt;6;i++){\n  // delay\n  do{\n    w=TCNT1;\n  } while(w-start&gt;300);\n}\npwm=pgm_read_byte(&amp;forward[5]);      // mark here\nOCR0A=127;\n</code></pre>\n\n<p>Attention on line \"mark here\".\nIn my origin code. <code>pwm</code> should be used by timer overflow interrupt. the second code is not really generated by compiler. I wrote it just for convenience describe</p>\n\n<p>Any suggestion?\nThanks</p>\n"}, {"tags": ["c", "fgets"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1484101617, "post_id": 41581735, "comment_id": 70368117, "body": "Have you done any basic debugging? Such as using a debugger or printing out the <code>line</code> and <code>entry</code> values? Surely you can find out more about the problem before asking for help."}, {"owner": {"reputation": 445, "user_id": 6658290, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c1f203333e0c03c51b9c41eab1310599?s=128&d=identicon&r=PG&f=1", "display_name": "Polyphase29", "link": "https://stackoverflow.com/users/6658290/polyphase29"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1484101657, "post_id": 41581735, "comment_id": 70368126, "body": "Yes. I printed my entry value and it keeps giving me a &quot;45&quot; or a &quot;52&quot;. Not sure where it is coming from, and line gives me 119054520."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1484101661, "post_id": 41581735, "comment_id": 70368128, "body": "Well, then why didn&#39;t you provide that info and ask about that rather than the <code>while</code> loop? Because clearly <code>entry</code> is not what you expect and that is the initial point of failure. I suggest you review what casting does. It can not turn a string into its <code>int</code> equivalent. Then look up <a href=\"https://linux.die.net/man/3/atoi\" rel=\"nofollow noreferrer\">atoi</a>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1484101683, "post_id": 41581735, "comment_id": 70368133, "body": "Never use a cast if you are not 100% sure what it does! Without any offence, but your apparently don&#39;t know what casts are for. Briefly: casts are not for string to numerical conversion. That in mind, the rest should be easy to find."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1484102391, "post_id": 41581735, "comment_id": 70368301, "body": "better to check the return code from fgets, like this: <code>if ( fgets (line, MAX_LINE, stdin) != NULL )</code>"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1484102716, "post_id": 41581735, "comment_id": 70368395, "body": "did you know that 45 is the ascii code for the <code>-</code> character and 52 is the ascii code for the <code>4</code> character?"}], "answers": [{"tags": [], "owner": {"reputation": 1016, "user_id": 5788276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OHVtt.jpg?s=128&g=1", "display_name": "Pejman", "link": "https://stackoverflow.com/users/5788276/pejman"}, "is_accepted": true, "score": 0, "last_activity_date": 1484107690, "creation_date": 1484107690, "answer_id": 41582537, "question_id": 41581735, "link": "https://stackoverflow.com/questions/41581735/using-fgets-for-input-in-c/41582537#41582537", "title": "Using fgets for input in C", "body": "<p>Your intuition is correct. You are not properly converting user input to a numeric value. <code>fgets</code> reads user input and stores it (along with <code>\\n</code>) into <code>line</code> variable; an array of characters. Let's assume the user is an old man entering his age <code>99</code>, so <code>line</code> will be an array of <code>9</code>, <code>9</code>, <code>\\n</code> and <code>\\0</code> characters. In the next line however, you are casting <code>line[0]</code> which is character <code>9</code> (with ASCII code 57) into an integer and assigning 57 to <code>entry</code>. Well, this probably is not what you intend to achieve here.</p>\n\n<p>My recommended solution for this case is to use <code>scanf</code> instead of <code>fgets</code>.</p>\n\n<pre><code>int age;\n\nscanf(\"%d\", &amp;age);\nif (age &lt; min_age || age &gt; max_age)\n    printf(\"age not valid\\n\");\n</code></pre>\n\n<p>In case you want to stick with fgets, you can remove the new line character and replace casting with calling functions like <code>atoi</code> (which is not really safe by the way) to convert <code>line</code> into integer.</p>\n"}], "owner": {"reputation": 445, "user_id": 6658290, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c1f203333e0c03c51b9c41eab1310599?s=128&d=identicon&r=PG&f=1", "display_name": "Polyphase29", "link": "https://stackoverflow.com/users/6658290/polyphase29"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "accepted_answer_id": 41582537, "answer_count": 1, "score": -1, "last_activity_date": 1484138052, "creation_date": 1484101457, "question_id": 41581735, "link": "https://stackoverflow.com/questions/41581735/using-fgets-for-input-in-c", "title": "Using fgets for input in C", "body": "<p>I'm trying to use fgets in a function to obtain input in C. My code displays properly, however it does not follow my parameters for the do/while loop (if I enter a number outside of the range, it proceeds with the program, rather than repeating the loop until the input is proper). I have tried tinkering with it, and I can't figure out what my issue is. I think it might have something to do with it taking the input as a character and not as an integer. But I tried casting my entry variable into an int, and that was no help. Any assistance is greatly appreciated! </p>\n\n<pre><code>{\n char  line[MAX_LINE];\n\n int   entry;\n\n    do\n    {\n     printf(\"Please enter %s(%d-%d) \", descriptionCPtr, low, high);\n     fgets(line, MAX_LINE, stdin);\n     entry = (int)line[0];\n    }\n\n    while(entry &lt; low || entry &gt; high);\n    return(entry);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "char"], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1484100794, "last_edit_date": 1484100794, "creation_date": 1484099932, "answer_id": 41581538, "question_id": 41581523, "link": "https://stackoverflow.com/questions/41581523/how-do-i-store-a-random-string-from-an-array-of-strings-in-c/41581538#41581538", "title": "How do I store a random string from an array of strings in c?", "body": "<p>When you're copying C <em>strings,</em> you don't use assignment, since that will attempt to copy the pointer to the string. Trying to copy that to an array variable is what's causing your issue.</p>\n\n<p>Instead, use the <code>string.h</code> facilities:</p>\n\n<pre><code>strcpy (fruit, fruits[someRandomIndex]);\n</code></pre>\n\n<p>And make sure you never add <code>golden delicious apple</code> to your list of fruits, since it will easily overwrite the 19-character limit :-)</p>\n\n<p>But, in fact, you don't actually <em>need</em> to copy the string since you're quite able to pass the original pointer to <code>printf</code>. You can also clean up your code so as to make maintenance easier:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main (void) {\n    // Const pointer to const data generally allows more\n    // scope for optimisation. Also auto size array.\n\n    static const char const *fruits[] = {\n        \"apple\", \"pear\", \"orange\", \"banana\", \"watermelon\",\n        \"cantaloupe\", \"grape\", \"kiwi\", \"blackberry\",\n        \"blueberry\", \"raspberry\", \"cherry\", \"strawberry\",\n        \"lemon\", \"lime\", \"plum\", \"pineapple\", \"peach\",\n        \"mango\", \"olive\"};   \n    static const int fruitCount = sizeof(fruits) / sizeof(*fruits);\n\n    // Seed generator, no need to store, just use it.\n\n    srand ((unsigned) time(0));\n\n    // Get random pointer based on size, and print it.\n\n    printf (\"Random fruit is %s\\n\", fruits[rand() % fruitCount]);\n\n    // Return usual success code.\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1484099971, "creation_date": 1484099971, "answer_id": 41581547, "question_id": 41581523, "link": "https://stackoverflow.com/questions/41581523/how-do-i-store-a-random-string-from-an-array-of-strings-in-c/41581547#41581547", "title": "How do I store a random string from an array of strings in c?", "body": "<p>Use <code>strcpy</code> (from \"string.h\"):</p>\n\n<pre><code>strcpy(fruit, fruits[rand() % 20]);\n</code></pre>\n\n<p>However, if your result needs only to be a constant string and you wont change it, declare it as a pointer simply <code>const char* fruit;</code> and you can do the assignment as you did.</p>\n"}], "owner": {"reputation": 13, "user_id": 7402152, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S9FlP8pH6eM/AAAAAAAAAAI/AAAAAAAAAGg/elGnCOG5cpc/photo.jpg?sz=128", "display_name": "Nicholas17", "link": "https://stackoverflow.com/users/7402152/nicholas17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 41581538, "answer_count": 2, "score": 0, "last_activity_date": 1484100794, "creation_date": 1484099767, "question_id": 41581523, "link": "https://stackoverflow.com/questions/41581523/how-do-i-store-a-random-string-from-an-array-of-strings-in-c", "title": "How do I store a random string from an array of strings in c?", "body": "<p>I came across an issue when trying to save a random fruit from the array into an array of chars.</p>\n\n<p>The error message reads: error: assignment to expression with array type\n  fruit = fruits[rand() % 20];</p>\n\n<p>Specifically it is these two lines that seem to be the issue:</p>\n\n<pre><code>char fruit[20];\nfruit = fruits[rand() % 20];\n</code></pre>\n\n<p>I have tried combining it into one line such as:</p>\n\n<pre><code>char fruit[] = fruits[rand() % 20];\n</code></pre>\n\n<p>But this also does not work.\nI have tried to figure this out from others posts but I can't seem to figure out the cause. If anyone has a fix or a correct method of doing this I would greatly appreciate it. Thanks.</p>\n\n<p>Full code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main () {\ntime_t t;\nconst char *fruits[20] = {\"apple\", \"pear\", \"orange\", \"banana\", \"watermelon\", \"cantaloupe\", \"grape\", \"kiwi\", \"blackberry\", \"blueberry\", \"raspberry\", \"cherry\", \"strawberry\", \"lemon\", \"lime\", \"plum\", \"pineapple\", \"peach\", \"mango\", \"olive\"};   \n\nsrand((unsigned) time(&amp;t));\n\nchar fruit[20];\nfruit = fruits[rand() % 20];\n\nprintf(\"\\nrandom fruit is %s\\n\", fruit);\nreturn 1;\n}\n</code></pre>\n"}, {"tags": ["c", "image-processing"], "comments": [{"owner": {"reputation": 9263, "user_id": 1536976, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cc2372591e00f2ab504b59b4f7cbed43?s=128&d=identicon&r=PG", "display_name": "Trilarion", "link": "https://stackoverflow.com/users/1536976/trilarion"}, "edited": false, "score": 0, "creation_date": 1484125679, "post_id": 41581503, "comment_id": 70376999, "body": "It&#39;s a linear mapping of coordinates where the pixels are downscaled by a factor of two and shifted by a quarter of the total size."}], "answers": [{"tags": [], "owner": {"reputation": 22202, "user_id": 696391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VrUwT.jpg?s=128&g=1", "display_name": "samgak", "link": "https://stackoverflow.com/users/696391/samgak"}, "is_accepted": false, "score": 0, "last_activity_date": 1484100144, "creation_date": 1484100144, "answer_id": 41581564, "question_id": 41581503, "link": "https://stackoverflow.com/questions/41581503/division-in-code-snippet/41581564#41581564", "title": "Division in code snippet", "body": "<p>What this code appears to do is to set <code>new_pixels</code> to the central quarter of <code>old_pixels</code>, scaled up to be the same size.</p>\n\n<p>For example, if <code>old_pixels</code> is:</p>\n\n<pre><code>ABCDEFGH\nIHJKLMNO\nPQRSTUVW\nXYZabcde\nfghijklm\nnopqrstu\nvwxyz012\n3456789*\n</code></pre>\n\n<p>Then <code>new_pixels</code> will be set to</p>\n\n<pre><code>RRSSTTUU\nRRSSTTUU\nZZaabbcc\nZZaabbcc\nhhiijjkk\nhhiijjkk\nppqqrrss\nppqqrrss\n</code></pre>\n\n<p>(Assuming that there is an outer loop over the rows of the image).</p>\n\n<p>Adding <code>(image_ptr-&gt;height / 4)</code> and <code>(image_ptr-&gt;width / 4)</code> to the indices starts reading from an offset 1/4 of the way vertically and horizontally into <code>old_pixels</code>. Dividing <code>(i / 2)</code> and <code>(j / 2)</code> scales the image up by a factor of 2.</p>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 2195835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d21dd448cfa27991248279395589b9?s=128&d=identicon&r=PG", "display_name": "TanyaV", "link": "https://stackoverflow.com/users/2195835/tanyav"}, "is_accepted": false, "score": 0, "last_activity_date": 1484129205, "creation_date": 1484129205, "answer_id": 41587881, "question_id": 41581503, "link": "https://stackoverflow.com/questions/41581503/division-in-code-snippet/41587881#41587881", "title": "Division in code snippet", "body": "<p>The code snippet is a bit strange as it defaults on the cases where i and j are not even - it could be intentional but does look like a bug.\nIt looks like new pixels is trying to get the central quarter of old pixels, but because of the odd indices, every pixel will be sampled twice</p>\n\n<p>if the old pixels were:</p>\n\n<pre><code>A A B B C C D D\nA A B B C C D D\nA A B B C C D D\nA A B B C C D D\nA A B B C C D D\nA A B B C C D D\nA A B B C C D D\nA A B B C C D D\n</code></pre>\n\n<p>the new pixels will be</p>\n\n<pre><code>B B B B C C C C\nB B B B C C C C\nB B B B C C C C\nB B B B C C C C\nB B B B C C C C\nB B B B C C C C\nB B B B C C C C\nB B B B C C C C\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7356472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adcd7f96b9c9d5051a42c3f3650c9859?s=128&d=identicon&r=PG&f=1", "display_name": "perolako", "link": "https://stackoverflow.com/users/7356472/perolako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484136719, "creation_date": 1484099638, "last_edit_date": 1484136719, "question_id": 41581503, "link": "https://stackoverflow.com/questions/41581503/division-in-code-snippet", "title": "Division in code snippet", "body": "<p>I'm having big problems understanding what the <code>(imageptt-&gt;h / 4) + (i / 2)</code> does in:</p>\n\n<pre><code> for(int i= 0; i &lt; imageptt-&gt;h; i++)\n {\n     for(int j = 0; j &lt; imageptt-&gt;w; j++)\n     { \n        pixels[i][j] = old[(imageptt-&gt;h / 4) + (i / 2)]\n                                     [(imageptt-&gt;w  / 4) + (j / 2)];\n     }\n }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1484105001, "post_id": 41581232, "comment_id": 70368958, "body": "Your existing solution is fine and you should use the cast in case the type changes in a different version of system headers."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1484113177, "post_id": 41581232, "comment_id": 70371309, "body": "Agree with @M.M \u2014 if you&#39;re using <code>PRIuMAX</code> and aren&#39;t sure that <code>cur_bytes</code> is already a type compatible with <code>uintmax_t</code> under the default promotion rules that apply to formatted arguments to <code>printf()</code>, then the cast is necessary to ensure safety across platforms.  Even if you get away with it on your current machine, it may not work on other platforms \u2014 don&#39;t risk it when the cost is negligible."}], "answers": [{"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1484099230, "post_id": 41581278, "comment_id": 70367603, "body": "Well, you need to remove the <code>PRIuMAX</code> macros from that code, and as I stated in my question: &quot;I found that <code>rlim_t</code> is a <code>typedef</code> for <code>unsigned long</code> on my system.&quot; The question is, can I assume that it is <i>always</i> <code>unsigned long</code>, or is it better to use the widest possible <code>unsigned</code> integer type available?"}], "tags": [], "owner": {"reputation": 2296, "user_id": 1575416, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32e1e3caa938438115454a4688a3d4a2?s=128&d=identicon&r=PG", "display_name": "aggaton", "link": "https://stackoverflow.com/users/1575416/aggaton"}, "is_accepted": false, "score": -2, "last_activity_date": 1484097766, "creation_date": 1484097766, "answer_id": 41581278, "question_id": 41581232, "link": "https://stackoverflow.com/questions/41581232/what-is-the-right-way-to-print-a-value-of-type-rlim-t/41581278#41581278", "title": "What is the right way to print a value of type rlim_t?", "body": "<p>I believe it is an unsigned long.</p>\n\n<pre><code>printf(\"Soft limit: %lu\" PRIuMAX \" bytes\\n\", cur_bytes);\nprintf(\"Hard limit: %lu\" PRIuMAX \" bytes\\n\", max_bytes);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": true, "score": 2, "last_activity_date": 1484974824, "creation_date": 1484974824, "answer_id": 41775917, "question_id": 41581232, "link": "https://stackoverflow.com/questions/41581232/what-is-the-right-way-to-print-a-value-of-type-rlim-t/41775917#41775917", "title": "What is the right way to print a value of type rlim_t?", "body": "<p>As mentioned in the comments to the original question, the cast is necessary to ensure that the type matches the conversion specification. The system headers may not define the type of <code>rlim_t</code> to be <code>uintmax_t</code>, but since <code>rlim_t</code> is an <code>unsigned</code> integer type, the cast to <code>uintmax_t</code> is safe.</p>\n\n<p>The above solution using the <code>PRIuMAX</code> macro is fine, but since C99 there has also been the <code>j</code> type modifier, used for printing values of type <code>intmax_t</code> and <code>uintmax_t</code>:</p>\n\n<pre><code>printf(\"Soft limit: %ju bytes\\n\", (uintmax_t)cur_bytes);\nprintf(\"Hard limit: %ju bytes\\n\", (uintmax_t)max_bytes);\n</code></pre>\n"}], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2110, "favorite_count": 3, "accepted_answer_id": 41775917, "answer_count": 2, "score": 2, "last_activity_date": 1484974824, "creation_date": 1484097421, "last_edit_date": 1495539932, "question_id": 41581232, "link": "https://stackoverflow.com/questions/41581232/what-is-the-right-way-to-print-a-value-of-type-rlim-t", "title": "What is the right way to print a value of type rlim_t?", "body": "<p>I am using the <code>getrlimit()</code> function to get the maximum stack size on my system. This function stores both the current limit and the maximum limit in a <code>struct</code> with two <code>rlim_t</code> fields. I want to print these values.</p>\n\n<p>I found <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/basedefs/sys/resource.h.html\" rel=\"nofollow noreferrer\">this link</a> that suggests that <code>rlim_t</code> is an <code>unsigned</code> integer type, so I used the <code>PRIuMAX</code> macro for the conversion specifier, casting the value to <code>(uintmax_t)</code>. I noticed that I could omit the cast without generating any warnings; is the cast really necessary here?</p>\n\n<p>After digging through several header files, I found that <code>rlim_t</code> is a <code>typedef</code> for <code>unsigned long</code> on my system. So I could also use the <code>%lu</code> conversion specifier, and do away with the cast.</p>\n\n<p>I don't think that I can assume that <code>rlim_t</code> is always an <code>unsigned long</code>, so it seems better to use the first method to improve portability. I found <a href=\"https://stackoverflow.com/a/28529326/6879826\">this answer</a> that suggests that <code>%llu</code> may not always be a valid conversion specifier for <code>rlim_t</code>, and advocates casting to <code>long long</code>. What is the best way to print a value of type <code>rlim_t</code>?</p>\n\n<p>Here is a short, illustrative program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;sys/resource.h&gt;\n\nint main(void)\n{\n    struct rlimit stacklim;\n    rlim_t cur_bytes, max_bytes;\n\n    if (getrlimit(RLIMIT_STACK, &amp;stacklim) == 0) {\n        cur_bytes = stacklim.rlim_cur;\n        max_bytes = stacklim.rlim_max;\n    } else {\n        perror(\"Error in getrlimit()\");\n        exit(EXIT_FAILURE);\n    }\n\n    puts(\"Maximum Stack Size\");\n    printf(\"Soft limit: %\" PRIuMAX \" bytes\\n\", (uintmax_t)cur_bytes);\n    printf(\"Hard limit: %\" PRIuMAX \" bytes\\n\", (uintmax_t)max_bytes);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1484095402, "post_id": 41580945, "comment_id": 70366744, "body": "It is not clear what result you want to get."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1484095409, "post_id": 41580945, "comment_id": 70366747, "body": "change int val to char val"}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1484095438, "post_id": 41580945, "comment_id": 70366753, "body": "@VladfromMoscow set <code>str</code> to &quot;s&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 5748, "user_id": 767442, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d26ad3fe7caf43447e39cd2307b515d7?s=128&d=identicon&r=PG&f=1", "display_name": "jforberg", "link": "https://stackoverflow.com/users/767442/jforberg"}, "edited": false, "score": 0, "creation_date": 1484095592, "post_id": 41580978, "comment_id": 70366792, "body": "You&#39;re not wrong, but I don&#39;t think that is wht OP is trying to do. I think he wants to set his malloc&#39;d buffer to just { glob_str[0], &#39;\\0&#39;, ... }"}], "tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": false, "score": 0, "last_activity_date": 1484095473, "last_edit_date": 1495539975, "creation_date": 1484095473, "answer_id": 41580978, "question_id": 41580945, "link": "https://stackoverflow.com/questions/41580945/assign-char-to-char/41580978#41580978", "title": "Assign char to char *", "body": "<p>Given</p>\n\n<pre><code>char *glob_str = \"test test\";  // glob_str is literal string and cannot be modified\n</code></pre>\n\n<p>then</p>\n\n<pre><code>glob_str[0] = val; // modification won't work\n</code></pre>\n\n<p>You need to change to</p>\n\n<pre><code>char glob_str[] = \"test test\";\n</code></pre>\n\n<p>See this <a href=\"https://stackoverflow.com/questions/1704407/what-is-the-difference-between-char-s-and-char-s-in-c\">question</a></p>\n"}, {"comments": [{"owner": {"reputation": 5748, "user_id": 767442, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d26ad3fe7caf43447e39cd2307b515d7?s=128&d=identicon&r=PG&f=1", "display_name": "jforberg", "link": "https://stackoverflow.com/users/767442/jforberg"}, "edited": false, "score": 0, "creation_date": 1484095688, "post_id": 41580982, "comment_id": 70366817, "body": "@Redesign Vlad&#39;s code should work. Please post the entire program you are running which gives you just an empty string."}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1484095947, "post_id": 41580982, "comment_id": 70366881, "body": "Oops, never mind. I had a leftover piece of code that was messing me up."}, {"owner": {"reputation": 5748, "user_id": 767442, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d26ad3fe7caf43447e39cd2307b515d7?s=128&d=identicon&r=PG&f=1", "display_name": "jforberg", "link": "https://stackoverflow.com/users/767442/jforberg"}, "reply_to_user": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1484096072, "post_id": 41580982, "comment_id": 70366908, "body": "@Redesign If your problem is resolved, please do one of (1) accept Vlad&#39;s answer (2) delete your question (3) write some kind of note at the top of your question. This is so that we know it&#39;s solved and people don&#39;t have to spend time reading it."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 3, "last_activity_date": 1484096336, "last_edit_date": 1484096336, "creation_date": 1484095490, "answer_id": 41580982, "question_id": 41580945, "link": "https://stackoverflow.com/questions/41580945/assign-char-to-char/41580982#41580982", "title": "Assign char to char *", "body": "<p>It seems you mean the following</p>\n\n<pre><code>void do_something(char *str, int idx)\n{\n    str[0] = glob_str[idx];\n    str[1] = '\\0';\n}\n</code></pre>\n\n<p>You can add a check to the function that the index is not outside the string literal pointed to by <code>glob_str</code>.</p>\n"}], "owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 0, "accepted_answer_id": 41580982, "answer_count": 2, "score": -3, "last_activity_date": 1487992240, "creation_date": 1484095235, "last_edit_date": 1487992240, "question_id": 41580945, "link": "https://stackoverflow.com/questions/41580945/assign-char-to-char", "title": "Assign char to char *", "body": "<p>I need an entire string to be one char of another string.</p>\n\n<pre><code>const char *const_string = \"FOOBAR\";\nchar *character_string = malloc(1024);\n// character_string = const_string[3];\n</code></pre>\n\n<p>How can I make the last (commented) line work?</p>\n"}, {"tags": ["c", "static-analysis", "splint"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1484096285, "post_id": 41579757, "comment_id": 70366955, "body": "Documentation: <a href=\"http://www.splint.org/faq.html#quest15\" rel=\"nofollow noreferrer\">splint.org/faq.html#quest15</a>"}, {"owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1484147114, "post_id": 41579757, "comment_id": 70391366, "body": "@jxh, thanks for comment. Please see my update. I wonder is there a way to ask <code>splint</code> do not check system headers at all?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1484157122, "post_id": 41579757, "comment_id": 70397858, "body": "You were also supposed to read: <a href=\"http://www.splint.org/faq.html#quest14\" rel=\"nofollow noreferrer\">splint.org/faq.html#quest14</a> as the previous FAQ suggested."}, {"owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1484159663, "post_id": 41579757, "comment_id": 70399184, "body": "@jxh, I did, however declaring nonstandard keywords won&#39;t help <code>splint</code> bypass. I updated the original post."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1484161995, "post_id": 41579757, "comment_id": 70400458, "body": "Try <code>signed</code> rather than empty. Also, <code>+gnuextensions</code>."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1484163165, "post_id": 41579757, "comment_id": 70401115, "body": "<code>splint</code> tries to be like the compiler, so it needs the prototypes to help do the static analysis. If it bypasses the system headers, you will just have a bunch of unknown function usage errors."}], "owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1016, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1484159614, "creation_date": 1484088221, "last_edit_date": 1484159614, "question_id": 41579757, "link": "https://stackoverflow.com/questions/41579757/splint-ask-not-to-check-system-headers", "title": "splint: ask not to check system headers", "body": "<p>Is there a way to stop <code>splint</code> from analyzing system headers included, POSIX, libc etc.? I run with <code>-warnposix -preproc</code>:</p>\n\n<pre><code>% splint -warnposix -preproc my.c\n\n/usr/include/unistd.h:220:8: Parse Error: Non-function declaration:\n    __BEGIN_DECLS : int. (For help on parse errors, see splint -help\n    parseerrors.)\n*** Cannot continue.\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<pre><code>% splint +posixlib +unixlib -I/path/to/myheaders -I/usr/include/x86_64-linux-gnu my.c\n\n/usr/include/asm-generic/int-ll64.h:19:24: Parse Error:\n    Suspect missing struct or union keyword: __signed__ :\n    int. (For help on parse errors, see splint -help parseerrors.)\n</code></pre>\n\n<p>After reading <a href=\"http://www.splint.org/faq.html#quest14\" rel=\"noreferrer\">splint FAQ14</a> I tried to eliminate nonstandard keyword:</p>\n\n<pre><code>% splint +posixlib +unixlib -D__signed__= -I/path/to/myheaders -I/usr/include/x86_64-linux-gnu my.c\n\n/usr/include/x86_64-linux-gnu/sys/syslog.h:200:66: Parse Error:\n    Inconsistent function parameter syntax: __gnuc_va_list :\n    &lt;any&gt;. (For help on parse errors, see splint -help parseerrors.)\n*** Cannot continue.\n</code></pre>\n\n<p>Declaring <code>__gnuc_va_list</code> as nonstandard keyword doesn't help in this particular case. I feel that <code>splint</code> is a powerful tool, but it requires to annotate almost every code it parses. Am I wrong?</p>\n"}, {"tags": ["c", "arrays", "function", "pointers"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1484088316, "post_id": 41579725, "comment_id": 70364600, "body": "Make a structure containing 2 members, one being <code>int</code> as the length of the sequence and other one being <code>*int</code> as the pointer to the beginning of the sequence. Then, make a function that returns that structure"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1484088401, "post_id": 41579725, "comment_id": 70364638, "body": "Save the value of <code>i</code> in the <code>else</code> case. Record that saved value into <code>*begin</code> in the <code>else if</code> case."}, {"owner": {"reputation": 2296, "user_id": 1575416, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32e1e3caa938438115454a4688a3d4a2?s=128&d=identicon&r=PG", "display_name": "aggaton", "link": "https://stackoverflow.com/users/1575416/aggaton"}, "edited": false, "score": 0, "creation_date": 1484088684, "post_id": 41579725, "comment_id": 70364741, "body": "Keep a running tally of the currently found max sequence index and length, if you find any longer sequence, update tally with new info. Return result."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1484088986, "post_id": 41579725, "comment_id": 70364850, "body": "BTW, there are more problems in your code than just that so suggest you do more testing. For example, <code>a[i+1]==a[i]</code> will cause a buffer overflow on the last iteration (when <code>i</code> is <code>n-1</code>)"}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1484089017, "post_id": 41579725, "comment_id": 70364861, "body": "Also, I assume that <code>int n</code> is the length of <code>a[]</code>, right? If so, your <code>for(i=0;i&lt;n;i++)</code> loop tries to access the value that is not in an array. Consider this: <code>a[3] = {0, 0, 0}</code> <code>n = 3</code>. Here, in your for loop, if <code>i</code> is 2, in your if statement (<code>if(a[i+1]==a[i]</code>) you are trying to access <code>a[3]</code> which is beyond the range of an array."}, {"owner": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "edited": false, "score": 0, "creation_date": 1484089089, "post_id": 41579725, "comment_id": 70364886, "body": "Thanks for all the help guys but I tried a couple more examples now and looks like my code isn&#39;t returning the right longest sequence. I tried running the array 0 0 0 1 1 1 1 1  and its returning 7 instead of 5 for the longest array. I need check this again."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1484089145, "post_id": 41579725, "comment_id": 70364917, "body": "That&#39;s because if you reach end of array, you are not checking if the current sequence that&#39;s being checked is the longest one. Just make one more <code>if</code> statement after you finish your <code>for</code> loop"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1484089408, "post_id": 41579725, "comment_id": 70365006, "body": "Also, because you init the <code>count</code> to 1 instead of 0."}, {"owner": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "edited": false, "score": 0, "creation_date": 1484091262, "post_id": 41579725, "comment_id": 70365628, "body": "Hello. I took your suggestions and updated my code in the post. What do you think about it now?"}, {"owner": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "edited": false, "score": 0, "creation_date": 1484091282, "post_id": 41579725, "comment_id": 70365640, "body": "I took out a pen and paper and tried this again though. Seems to work. :P"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1484131346, "post_id": 41579725, "comment_id": 70380932, "body": "this statement: <code>It also needs to return in a pointer the index at which this longest sequence begins.</code> is not possible, either return a pointer to the appropriate address in the string.  OR return the index into the stirng."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "edited": false, "score": 0, "creation_date": 1484091430, "post_id": 41580122, "comment_id": 70365689, "body": "You are undoubtedly a legend. You&#39;ve helped me a lot in the past. Can you please tell me what you think of the code I updated above (before adding the *begin)?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484091547, "post_id": 41580122, "comment_id": 70365729, "body": "Nice.  Note: corner case oops: <code>longestSequence(0, 0, &amp;begin)</code> returns <code>1</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484092173, "post_id": 41580122, "comment_id": 70365916, "body": "@chux You declared <code>int a[0];</code> But C standard forbids zero-size array."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "edited": false, "score": 0, "creation_date": 1484092251, "post_id": 41580122, "comment_id": 70365940, "body": "@FlyGuy I think your code gives the correct length."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484092253, "post_id": 41580122, "comment_id": 70365942, "body": "<code>int a[]</code> is like <code>char *</code>. Would  <code>longestSequence(NULL, 0, &amp;begin)</code> be a better corner case? My example did not declare <code>int a[0]</code>.  If you do not want to handle this case - no problem - OP likely does not care about it either."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484092342, "post_id": 41580122, "comment_id": 70365972, "body": "@chux I think that&#39;s a meaningless call."}, {"owner": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "edited": false, "score": 0, "creation_date": 1484092347, "post_id": 41580122, "comment_id": 70365974, "body": "@BLUEPIXY Thank you. Do you have an idea as to how I would add in it the *begin?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "edited": false, "score": 0, "creation_date": 1484092870, "post_id": 41580122, "comment_id": 70366137, "body": "@FlyGuy My answer is intended as an idea. I think that is sufficiently concise. In the case of your idea I think that it will be back calculated from the break place."}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1484093561, "post_id": 41580122, "comment_id": 70366318, "body": "<code>i + max_length &lt; n</code> is a neat shortcut"}], "tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 3, "last_activity_date": 1484090084, "creation_date": 1484090084, "answer_id": 41580122, "question_id": 41579725, "link": "https://stackoverflow.com/questions/41579725/implement-a-function-that-returns-the-longest-sequence-of-either-1s-or-0s-and-th/41580122#41580122", "title": "Implement a function that returns the longest sequence of either 1s or 0s and the first index of it", "body": "<p>try this:</p>\n\n<pre><code>int longestSequence(int a[], int n, int *begin){\n    int i, count, max_length = 1;\n    *begin = 0;\n\n    for(i = 0; i + max_length &lt; n; i += count){\n        for(count = 1; i + count &lt; n &amp;&amp; a[i] == a[i + count]; ++count)\n            ;\n        if(count &gt; max_length){\n            max_length = count;\n            *begin = i;\n        }\n    }\n    return max_length;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "is_accepted": false, "score": 0, "last_activity_date": 1484092920, "creation_date": 1484092920, "answer_id": 41580607, "question_id": 41579725, "link": "https://stackoverflow.com/questions/41579725/implement-a-function-that-returns-the-longest-sequence-of-either-1s-or-0s-and-th/41580607#41580607", "title": "Implement a function that returns the longest sequence of either 1s or 0s and the first index of it", "body": "<p>your code nearly works.</p>\n\n<p>add <code>max_index = i - count;</code> just below <code>max_length=count;</code>  (both places)</p>\n\n<p>also define <code>int max_index;</code> near the top.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "edited": false, "score": 0, "creation_date": 1484094117, "post_id": 41580730, "comment_id": 70366449, "body": "I did. It doesn&#39;t work. Take for example 0 0 0 0 1 0 0 1. It will return that the sequence begins at 3 which is not correct."}, {"owner": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "edited": false, "score": 0, "creation_date": 1484094364, "post_id": 41580730, "comment_id": 70366501, "body": "Nevermind. I had the order of the count and out_index wrong in the loop. I think it works now. Thank you!"}, {"owner": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "edited": false, "score": 0, "creation_date": 1484095072, "post_id": 41580730, "comment_id": 70366678, "body": "Btw, I also omitted the last else as it doesn&#39;t change a thing."}, {"owner": {"reputation": 131, "user_id": 2195835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d21dd448cfa27991248279395589b9?s=128&d=identicon&r=PG", "display_name": "TanyaV", "link": "https://stackoverflow.com/users/2195835/tanyav"}, "reply_to_user": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "edited": false, "score": 0, "creation_date": 1484095447, "post_id": 41580730, "comment_id": 70366755, "body": "the else at the end takes care of the case where the longest sequence was at the end of the array, for example - {0,0,1,0,0,0}"}, {"owner": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "edited": false, "score": 0, "creation_date": 1484096171, "post_id": 41580730, "comment_id": 70366923, "body": "I just tried it on a piece of paper and you&#39;re right. It keeps the count the same as it was without resetting it as it doesn&#39;t enter any if condition. However, the code seems to work just fine with or without omitting it. I wonder why..."}], "tags": [], "owner": {"reputation": 131, "user_id": 2195835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d21dd448cfa27991248279395589b9?s=128&d=identicon&r=PG", "display_name": "TanyaV", "link": "https://stackoverflow.com/users/2195835/tanyav"}, "is_accepted": false, "score": 0, "last_activity_date": 1484093761, "creation_date": 1484093761, "answer_id": 41580730, "question_id": 41579725, "link": "https://stackoverflow.com/questions/41579725/implement-a-function-that-returns-the-longest-sequence-of-either-1s-or-0s-and-th/41580730#41580730", "title": "Implement a function that returns the longest sequence of either 1s or 0s and the first index of it", "body": "<p>Try this small edit:</p>\n\n<pre><code>int longestSequence(int a[], int n, int* begin)\n{\nint count=1;\nint max_length=1;\nint out_index = 0;\nint i;\n\nfor(i=1;i&lt;n;i++)\n{\n    if(a[i]==a[i-1])\n    {\n        count+=1;\n    }\n    else if (count&gt;max_length)\n    {\n        max_length=count;\n        out_index = i - count;\n        count=1;\n    }\n    else\n    {\n        count=1;\n    }\n}\n\nif(count&gt;max_length)\n{\n       max_length=count;\n       out_index = i - count;\n}\n*begin = out_index;\nreturn max_length;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7274638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d480a240884d27c2ab0a4fdd01294a?s=128&d=identicon&r=PG&f=1", "display_name": "FlyGuy", "link": "https://stackoverflow.com/users/7274638/flyguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1484093761, "creation_date": 1484088055, "last_edit_date": 1484091367, "question_id": 41579725, "link": "https://stackoverflow.com/questions/41579725/implement-a-function-that-returns-the-longest-sequence-of-either-1s-or-0s-and-th", "title": "Implement a function that returns the longest sequence of either 1s or 0s and the first index of it", "body": "<p>I need write a function that return the longest sequence of either 1s or 0s for a given array (of 1s and 0s). It also needs to return in a pointer the index at which this longest sequence begins.</p>\n\n<p>Say for example I have the array</p>\n\n<pre><code>a[]={1, 0, 0, 0, 1, 0, 0, 1}\n</code></pre>\n\n<p>The function returns </p>\n\n<pre><code>3, 1\n</code></pre>\n\n<p>where 3 is the longest sequence (in this case of 0s) and 1 is the index at which it begins.</p>\n\n<p>What I did was this:</p>\n\n<pre><code>int longestSequence(int a[], int n, int* begin)\n{\nint count=1;\nint max_length=1;\nint i;\n\nfor(i=1;i&lt;n;i++)\n{\n    if(a[i]==a[i-1])\n    {\n        count+=1;\n    }\n    else if (count&gt;max_length)\n    {\n        max_length=count;\n        count=1;\n    }\n    else\n    {\n        count=1;\n    }\n}\n\nif(count&gt;max_length)\n   {\n       max_length=count;\n   }\nreturn max_length;\n}\n</code></pre>\n\n<p>I tried a couple of examples to see if the function returns the longest sequence and it works. However, I'm unable to find a way to return the right index at which it begins.</p>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1484085603, "post_id": 41578720, "comment_id": 70363332, "body": "Always compile with maximum &#39;nastiness&#39; -Wall under gcc for example"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1484086101, "post_id": 41578720, "comment_id": 70363600, "body": "@KevinDTimm: <code>Wall</code> is far from &quot;maximum nastiness&quot;. Recommended are at least <code>-Wextra -Wconversion</code>, too (which still does not mean &quot;maximum nastiness&quot;, though). For strict compliant code, <code>-Wpedantic</code> is also a good pick."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484086147, "post_id": 41578720, "comment_id": 70363623, "body": "@Olaf - OK, <code>maximal nastiness</code>. my point being that -Wall would have found the assignment without cast error"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1484086335, "post_id": 41578720, "comment_id": 70363709, "body": "@KevinDTimm: not sure what you mean. The error above is not even from the warnings, yet it was reported. What else would <code>-Wall</code> found here? (btw: we can&#39;t know without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)"}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1484094215, "post_id": 41578720, "comment_id": 70366467, "body": "would have found &quot;may not return a value&quot;"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1484145599, "post_id": 41578720, "comment_id": 70390319, "body": "Just one more FYI - this code won&#39;t pass any compiler. You call findParentNode inside of findParentNode with incompatible types (sending tn-&gt;right and tn-left in the first position where a TreeNode is expected).  It is a prime example of why SO requires a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and not this cobbled together drivel."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 6904738, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eab8bea3f28646fecdd563467276d7fe?s=128&d=identicon&r=PG&f=1", "display_name": "Brec", "link": "https://stackoverflow.com/users/6904738/brec"}, "edited": false, "score": 0, "creation_date": 1484084166, "post_id": 41578766, "comment_id": 70362554, "body": "You&#39;re right I had a ListNode struct as well to make something else and canceled"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484086354, "post_id": 41578766, "comment_id": 70363719, "body": "That&#39;s more of a comment, than an answer."}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484094431, "post_id": 41578766, "comment_id": 70366520, "body": "@Olaf, how would you improve this answer?"}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 2, "last_activity_date": 1484083775, "creation_date": 1484083775, "answer_id": 41578766, "question_id": 41578720, "link": "https://stackoverflow.com/questions/41578720/c-programming-gcc-error-assignment-from-incompatible-pointer-type-enabled-by/41578766#41578766", "title": "c programming gcc error : assignment from incompatible pointer type [enabled by default]", "body": "<p>Why not make </p>\n\n<pre><code>    ListNode *temp1, *temp2;\n</code></pre>\n\n<p>into </p>\n\n<pre><code>    TreeNode *temp1, *temp2;\n</code></pre>\n\n<p>I don't see what's the definition of either one...</p>\n"}], "owner": {"reputation": 89, "user_id": 6904738, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eab8bea3f28646fecdd563467276d7fe?s=128&d=identicon&r=PG&f=1", "display_name": "Brec", "link": "https://stackoverflow.com/users/6904738/brec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "closed_date": 1484137330, "answer_count": 1, "score": -2, "last_activity_date": 1484083775, "creation_date": 1484083593, "question_id": 41578720, "link": "https://stackoverflow.com/questions/41578720/c-programming-gcc-error-assignment-from-incompatible-pointer-type-enabled-by", "closed_reason": "Not suitable for this site", "title": "c programming gcc error : assignment from incompatible pointer type [enabled by default]", "body": "<p>I have the following function</p>\n\n<pre><code>TreeNode* findParentNode(TreeNode *tn, int parentData, int branchSelect)\n{\n    ListNode *temp1, *temp2;\n\n    if (tn-&gt;data == parentData)\n    {\n        if ((branchSelect == 0 &amp;&amp; tn-&gt;left == NULL) || (branchSelect == 1 &amp;&amp; tn-&gt;right == NULL))\n            return tn;\n    }\n    if (tn-&gt;left == NULL &amp;&amp; tn-&gt;right == NULL)\n        return NULL;\n\n\n\n    temp1 = findParentNode(tn-&gt;left, parentData, branchSelect);\n    if (temp1 != NULL)\n        return temp1;\n\n    temp2 = findParentNode(tn-&gt;right, parentData, branchSelect);\n    if (temp2 != NULL)\n        return temp2;\n}\n</code></pre>\n\n<p>The function should return the parent node.<br>\nit works well at vs but when I'm running it at gcc I'm getting the error above and I need it to work under gcc as well,\nI read about this error but still I didn't find a way to fix it.</p>\n\n<p>Can some1 help me fix it so I can run it at gcc as well?<br>\nThanks in advance.</p>\n"}, {"tags": ["c", "linux", "linux-device-driver", "i2c"], "comments": [{"owner": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1484082058, "post_id": 41578175, "comment_id": 70361367, "body": "<a href=\"https://linux.die.net/man/3/readdir\" rel=\"nofollow noreferrer\">linux.die.net/man/3/readdir</a> + <a href=\"https://linux.die.net/man/2/readlink\" rel=\"nofollow noreferrer\">linux.die.net/man/2/readlink</a> + <code>strstr</code>"}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 1, "creation_date": 1484093362, "post_id": 41578175, "comment_id": 70366276, "body": "Basically it&#39;s a wrong approach to use raw interface for serial devices like I2C or SPI. The best way is to do driver in the kernel regarding corresponding framework."}, {"owner": {"reputation": 1186, "user_id": 31698, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7pP88.jpg?s=128&g=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/31698/nathan"}, "reply_to_user": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1484107858, "post_id": 41578175, "comment_id": 70369617, "body": "@DarkFalcon I wasn&#39;t clear, sorry. I wasn&#39;t looking for the POSIX C API, I was looking for a way to query the device directly."}, {"owner": {"reputation": 1186, "user_id": 31698, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7pP88.jpg?s=128&g=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/31698/nathan"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1484108015, "post_id": 41578175, "comment_id": 70369657, "body": "@0andriy the kernel driver for this device is still under development. I&#39;m trying to mess with it in userspace to figure out what capabilities I&#39;ll have to play with once the kernel driver us usable."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1484160013, "post_id": 41578175, "comment_id": 70399409, "body": "@Nathan, yes, for development it&#39;s okay to use raw interface, though as developer you don&#39;t need to have fixed name, right? By the way, you may use <code>udev</code> to make symlinks based on ACPI IDs."}], "owner": {"reputation": 1186, "user_id": 31698, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7pP88.jpg?s=128&g=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/31698/nathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1484107928, "creation_date": 1484081493, "last_edit_date": 1484107928, "question_id": 41578175, "link": "https://stackoverflow.com/questions/41578175/how-do-i-figure-out-which-i2c-device-is-which-programmatically", "title": "How do I figure out which i2c device is which programmatically?", "body": "<p>I have 11 i2c device nodes on my system.</p>\n\n<pre><code>localhost user # ls /dev/i2c*\n/dev/i2c-0  /dev/i2c-1  /dev/i2c-10  /dev/i2c-2  /dev/i2c-3  /dev/i2c-4  /dev/i2c-5  /dev/i2c-6  /dev/i2c-7  /dev/i2c-8  /dev/i2c-9\n</code></pre>\n\n<p>I can figure out which one is which by poking around in the /sys filesystem:</p>\n\n<pre><code>localhost devices # pwd                                                                                                              \n/sys/bus/i2c/devices\nlocalhost devices # ls -al                                                                                                           \ntotal 0\ndrwxr-xr-x 2 root root 0 Jan 10 15:45 .\ndrwxr-xr-x 4 root root 0 Jan 10 15:45 ..\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-0 -&gt; ../../../devices/pci0000:00/0000:00:02.0/i2c-0\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-1 -&gt; ../../../devices/pci0000:00/0000:00:02.0/i2c-1\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-10 -&gt; ../../../devices/pci0000:00/0000:00:19.2/i2c_designware.5/i2c-10\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-10508825:00 -&gt; ../../../devices/pci0000:00/0000:00:19.2/i2c_designware.5/i2c-10/i2c-10508825:00\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-2 -&gt; ../../../devices/pci0000:00/0000:00:02.0/i2c-2\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-3 -&gt; ../../../devices/pci0000:00/0000:00:02.0/i2c-3\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-4 -&gt; ../../../devices/pci0000:00/0000:00:02.0/i2c-4\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-5 -&gt; ../../../devices/pci0000:00/0000:00:02.0/i2c-5\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-6 -&gt; ../../../devices/pci0000:00/0000:00:15.0/i2c_designware.0/i2c-6\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-7 -&gt; ../../../devices/pci0000:00/0000:00:15.1/i2c_designware.1/i2c-7\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-8 -&gt; ../../../devices/pci0000:00/0000:00:15.2/i2c_designware.2/i2c-8\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-9 -&gt; ../../../devices/pci0000:00/0000:00:15.3/i2c_designware.3/i2c-9\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-INT343B:00 -&gt; ../../../devices/pci0000:00/0000:00:19.2/i2c_designware.5/i2c-10/i2c-INT343B:00\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-INT343B:01 -&gt; ../../../devices/pci0000:00/0000:00:19.2/i2c_designware.5/i2c-10/i2c-INT343B:01\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-PRP0001:00 -&gt; ../../../devices/pci0000:00/0000:00:15.2/i2c_designware.2/i2c-8/i2c-PRP0001:00\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-PRP0001:01 -&gt; ../../../devices/pci0000:00/0000:00:15.3/i2c_designware.3/i2c-9/i2c-PRP0001:01\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-SYNA7817:00 -&gt; ../../../devices/pci0000:00/0000:00:15.0/i2c_designware.0/i2c-6/i2c-SYNA7817:00\nlrwxrwxrwx 1 root root 0 Jan 10 15:45 i2c-SYNA7817:01 -&gt; ../../../devices/pci0000:00/0000:00:15.1/i2c_designware.1/i2c-7/i2c-SYNA7817:01\n</code></pre>\n\n<p>The ones that I want are i2c-PRP0001-*, which I can see are currently symlinked to i2c-8 and i2c-9.</p>\n\n<p>i2c offers no guarantee that these node numbers are stable (even across reboots). I would like to give my program the ability to look at an i2c device and determine if it's one I care about or not.</p>\n\n<p>I could hack up a shell script to do basically what I just did on the command line, but is there a programmatic (C) way to find the device information (i.e. where does the kernel get the information that it writes to the sys filesystem)?</p>\n"}, {"tags": ["c", "misra"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484216717, "post_id": 41578027, "comment_id": 70422689, "body": "There is no MISRA rule called &quot;441&quot; in any of the MISRAs. The number is some tool-specific number and doesn&#39;t tell us anything. It would be helpful to know which version of MISRA-C you are using, as this rule differs between 98/2004 and 2012 versions."}, {"owner": {"reputation": 71, "user_id": 5763391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cb2adebaf5bf6db232136564bcce6d?s=128&d=identicon&r=PG&f=1", "display_name": "robrwill", "link": "https://stackoverflow.com/users/5763391/robrwill"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484340795, "post_id": 41578027, "comment_id": 70486393, "body": "Are you meaning the version of MISRA that I select in the Code Review Report? Under the Programming Standards Model drop down?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484488249, "post_id": 41578027, "comment_id": 70521927, "body": "I have no idea what tool you are using. I mean the version of MISRA-C that your company is using."}, {"owner": {"reputation": 71, "user_id": 5763391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cb2adebaf5bf6db232136564bcce6d?s=128&d=identicon&r=PG&f=1", "display_name": "robrwill", "link": "https://stackoverflow.com/users/5763391/robrwill"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484579080, "post_id": 41578027, "comment_id": 70555780, "body": "C LDRA Testbed Version 9.5.3 2015"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484579991, "post_id": 41578027, "comment_id": 70556367, "body": "In order to use MISRA-C, you must use one of the MISRA-C documents from (1998, 2004 or 2012). Each such document has a number of rules. You have to document how you conform to the various rules through a compliance matrix, where one option to demonstrate compliance for a certain rule is to use a static analyser tool. Other rules you could cover by manual code review, compiler warnings etc. Similarly, there will be a deviation process for rules that you do not conform to. Without the original MISRA-C guidelines and your own documentation, you cannot use MISRA-C in a meaningful way."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484580066, "post_id": 41578027, "comment_id": 70556409, "body": "So just running a static analyser through some random code and gawk at the various MISRA-C warnings, without even having access to the MISRA-C document gives nothing. You will likely cause more harm than good when working in such a manner. And since LDRA in particular is filled to the brim with false positives, you need to know MISRA-C. Blindly following LDRA will certainly ruin your code and turn safe code into a safety hazard."}, {"owner": {"reputation": 71, "user_id": 5763391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cb2adebaf5bf6db232136564bcce6d?s=128&d=identicon&r=PG&f=1", "display_name": "robrwill", "link": "https://stackoverflow.com/users/5763391/robrwill"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484582166, "post_id": 41578027, "comment_id": 70557740, "body": "I believe it is MISRA-C: 2004. That is what I have the Programming Standards Model and Rule Reference set to. Sorry I am still very new to MISRA."}], "answers": [{"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 2, "creation_date": 1484082562, "post_id": 41578063, "comment_id": 70361664, "body": "The return value of <code>truncf()</code> is a <code>float</code> so this does not avoid a cast."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1484081120, "creation_date": 1484081120, "answer_id": 41578063, "question_id": 41578027, "link": "https://stackoverflow.com/questions/41578027/misra-violation-441-float-cast-to-non-float/41578063#41578063", "title": "MISRA violation &quot;441 - Float cast to non-float &quot;", "body": "<p>If the idea is to truncate the result, use the <code>truncf</code> function:</p>\n\n<pre><code>ULong frames = truncf(runTimeSeconds * 40.0f);\n</code></pre>\n\n<p>That way, your intention is made explicitly.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 5763391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cb2adebaf5bf6db232136564bcce6d?s=128&d=identicon&r=PG&f=1", "display_name": "robrwill", "link": "https://stackoverflow.com/users/5763391/robrwill"}, "edited": false, "score": 0, "creation_date": 1484083987, "post_id": 41578212, "comment_id": 70362464, "body": "I tried &quot;llrintf&quot; as you specified. I end up with a different MISRA issue. You say no cast needed to convert from float to tULong. So drop the tULong as follows:"}, {"owner": {"reputation": 71, "user_id": 5763391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cb2adebaf5bf6db232136564bcce6d?s=128&d=identicon&r=PG&f=1", "display_name": "robrwill", "link": "https://stackoverflow.com/users/5763391/robrwill"}, "edited": false, "score": 0, "creation_date": 1484084002, "post_id": 41578212, "comment_id": 70362470, "body": "tULong frames = (runTimeSeconds * 40.0f);"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 71, "user_id": 5763391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cb2adebaf5bf6db232136564bcce6d?s=128&d=identicon&r=PG&f=1", "display_name": "robrwill", "link": "https://stackoverflow.com/users/5763391/robrwill"}, "edited": false, "score": 0, "creation_date": 1484084246, "post_id": 41578212, "comment_id": 70362596, "body": "@robrwill  What was the &quot; different MISRA issue&quot;?  What is the maximum value of <code>runTimeSeconds * 40.0f</code>?"}, {"owner": {"reputation": 71, "user_id": 5763391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cb2adebaf5bf6db232136564bcce6d?s=128&d=identicon&r=PG&f=1", "display_name": "robrwill", "link": "https://stackoverflow.com/users/5763391/robrwill"}, "edited": false, "score": 0, "creation_date": 1484084789, "post_id": 41578212, "comment_id": 70362905, "body": "435 S Float/Integer conversion without cast"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 71, "user_id": 5763391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cb2adebaf5bf6db232136564bcce6d?s=128&d=identicon&r=PG&f=1", "display_name": "robrwill", "link": "https://stackoverflow.com/users/5763391/robrwill"}, "edited": false, "score": 0, "creation_date": 1484085175, "post_id": 41578212, "comment_id": 70363109, "body": "@robrwill 1) <code>tULong frames = (tULong) llrintf(runTimeSeconds * 40.0f);</code> should not generate &quot;Float/Integer conversion without cast&quot;  2) For clarity: This answer does not imply &quot;no cast needed to convert from float to tULong&quot; <i>and</i> use <code>tULong frames = (runTimeSeconds * 40.0f);</code>.  It is by  using <code>llrintf()</code> instead that &quot;no cast needed to convert from float to tULong&quot;."}, {"owner": {"reputation": 71, "user_id": 5763391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cb2adebaf5bf6db232136564bcce6d?s=128&d=identicon&r=PG&f=1", "display_name": "robrwill", "link": "https://stackoverflow.com/users/5763391/robrwill"}, "edited": false, "score": 0, "creation_date": 1484143050, "post_id": 41578212, "comment_id": 70388645, "body": "I was able to get it to a &quot;Conditional Pass&quot; when running my static analysis tool by doing the following, tULong frames = (tULong) llrint(runTimeSeconds * 40.0f); . But still can&#39;t figure out why it isn&#39;t a &quot;Pass&quot;."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 71, "user_id": 5763391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cb2adebaf5bf6db232136564bcce6d?s=128&d=identicon&r=PG&f=1", "display_name": "robrwill", "link": "https://stackoverflow.com/users/5763391/robrwill"}, "edited": false, "score": 0, "creation_date": 1484148678, "post_id": 41578212, "comment_id": 70392388, "body": "What happens with <code>tULong frames =  llrint(runTimeSeconds * 40.0f);</code>  (ell-ell, no cast) and <code>tULong frames =  lrint(runTimeSeconds * 40.0f);</code>  (1 ell, no cast)?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484216968, "post_id": 41578212, "comment_id": 70422871, "body": "Why not use <code>long int lrintf(float x);</code> which would probably be more correct here?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1484235136, "post_id": 41578212, "comment_id": 70435373, "body": "@Lundin Perhaps?  It might  be more <i>efficient</i> to use <code>lrintf()</code> vs <code>llrintf()</code>.  Certainly the wider <code>llrint()</code> will not be less functionally correct than <code>lrint()</code>.   <code>tULong</code>, a non C-standard type, is certainly some unsigned type.  It may equate to <code>unsigned long</code> or <code>unsigned long long</code>, or <code>uintmaxt_t</code> or ....  We do not know, so going with the with <code>llrint()</code> is basically CYA. Code could use some conditional processing to select the most efficient  type. OP later commented the range is up to 435 s, something well within the <code>long</code> range,so go with <code>lrint()</code> if we want to abide by that."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1484082798, "last_edit_date": 1484082798, "creation_date": 1484081625, "answer_id": 41578212, "question_id": 41578027, "link": "https://stackoverflow.com/questions/41578027/misra-violation-441-float-cast-to-non-float/41578212#41578212", "title": "MISRA violation &quot;441 - Float cast to non-float &quot;", "body": "<p><code>&lt;math.h&gt;</code> has a nice family of functions that round and convert in one call.  No cast needed to convert from <code>float</code> to <code>tULong</code>.  Below has a <code>(tULong)</code> cast to handle an integer to integer conversion which may be eliminated depending on unposted issues of range and <code>tULong</code> details.</p>\n\n<pre><code>#include &lt;math.h&gt;\n// long int lrintf(float x);\n// long long int llrint(double x);\n// 4 others\n\ntULong frames = (tULong) llrintf(runTimeSeconds * 40.0f);\n</code></pre>\n\n<p>This rounds rather than truncates like OP's original code.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1484580289, "last_edit_date": 1484580289, "creation_date": 1484216584, "answer_id": 41610627, "question_id": 41578027, "link": "https://stackoverflow.com/questions/41578027/misra-violation-441-float-cast-to-non-float/41610627#41610627", "title": "MISRA violation &quot;441 - Float cast to non-float &quot;", "body": "<p>There is a rule (MISRA-C:2004 10.4) stating the value of a complex expression of floating type may only be cast to a narrower floating type.</p>\n\n<p><code>(runTimeSeconds * 40.0f)</code> is such a so-called <em>complex expression</em> (a MISRA-C:2004 term). To dodge the MISRA violation, you can introduce a temporary variable:</p>\n\n<pre><code>float tmp = runTimeSeconds * 40.0f;\ntULong frames = (tULong)tmp; // no complex expression, this is fine\n</code></pre>\n\n<hr>\n\n<p>The rationale for this rule is that complex expressions could potentially contain implicit type promotions and similar dangerous things. </p>\n\n<p>MISRA-C:2004 is also worried/paranoid about incompetent programmers who think that changing code like <code>uint8_t u8a, u8b; ... u8a + u8b</code> into <code>(uint32_t)(u8a + u8b)</code> would somehow cause the addition to get carried out as an unsigned 32 bit type.</p>\n\n<hr>\n\n<p>These rules have been improved in MISRA-C:2012 and are more reasonable there. A cast from a float expression to an unsigned one is fine as per MISRA-C:2012 10.5.</p>\n"}], "owner": {"reputation": 71, "user_id": 5763391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cb2adebaf5bf6db232136564bcce6d?s=128&d=identicon&r=PG&f=1", "display_name": "robrwill", "link": "https://stackoverflow.com/users/5763391/robrwill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2097, "favorite_count": 0, "accepted_answer_id": 41578212, "answer_count": 3, "score": 2, "last_activity_date": 1484580289, "creation_date": 1484081006, "last_edit_date": 1484086656, "question_id": 41578027, "link": "https://stackoverflow.com/questions/41578027/misra-violation-441-float-cast-to-non-float", "title": "MISRA violation &quot;441 - Float cast to non-float &quot;", "body": "<p>I am trying to correct the MISRA violation \"441 - Float cast to non-float\" that is occurring with the following code:</p>\n\n<pre><code>tULong frames = (tULong)(runTimeSeconds * 40.0f);\n</code></pre>\n\n<p><code>runTimeSeconds</code> is a <code>float</code> and obviously <code>40.0f</code> is assigned as a <code>float</code>. Any ideas?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2548, "user_id": 2400454, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/iEfZ3.jpg?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/2400454/jay"}, "edited": false, "score": 0, "creation_date": 1484078234, "post_id": 41577181, "comment_id": 70359390, "body": "Look at <a href=\"http://stackoverflow.com/questions/3536153/c-dynamically-growing-array\" title=\"c dynamically growing array\">stackoverflow.com/questions/3536153/c-dynamically-growing-ar&zwnj;&#8203;ray</a>"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 2, "creation_date": 1484078659, "post_id": 41577181, "comment_id": 70359587, "body": "Are you just wondering how to dynamically allocate a 2D array, or how to resize one?  Something like, <code>char (*arr)[CHARS_PER_LINE] = malloc(sizeof(*arr) * NUM_LINES);</code> maybe?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484080366, "post_id": 41577181, "comment_id": 70360468, "body": "In your example, first line has a &quot;(newline)&quot;, but the second one does not.  Is that intentional, an oversight or what?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484080656, "post_id": 41577181, "comment_id": 70360609, "body": "&quot;second dimension is the number of characters&quot; and &quot;String Array&quot; slightly contradicts.  To store a <i>string</i> in C, the size of the array needs to be &quot;number of characters&quot; + 1."}], "answers": [{"tags": [], "owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "is_accepted": false, "score": 2, "last_activity_date": 1484078257, "creation_date": 1484078257, "answer_id": 41577314, "question_id": 41577181, "link": "https://stackoverflow.com/questions/41577181/create-a-2d-dynamic-string-array/41577314#41577314", "title": "Create a 2D Dynamic String Array", "body": "<p>Non numerical keys are not allowed in C. You're trying to do some PHP and JavaScript nonsense in a language that only works with numbers.</p>\n\n<p>But, with C there is always 2 roads to hell.</p>\n\n<pre><code>char *lookup_key(int index, char *key) { ... }\n\n\nprintf(lookup_key(0, \"hello how\"));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2296, "user_id": 1575416, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32e1e3caa938438115454a4688a3d4a2?s=128&d=identicon&r=PG", "display_name": "aggaton", "link": "https://stackoverflow.com/users/1575416/aggaton"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484082149, "post_id": 41577330, "comment_id": 70361422, "body": "Of course, my bad"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484082533, "post_id": 41577330, "comment_id": 70361649, "body": "Perhaps <code>size_t strLen = foo(); char (*strings)[strLen + 1] = malloc(sizeof *arr * numLines);</code>?"}], "tags": [], "owner": {"reputation": 2296, "user_id": 1575416, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32e1e3caa938438115454a4688a3d4a2?s=128&d=identicon&r=PG", "display_name": "aggaton", "link": "https://stackoverflow.com/users/1575416/aggaton"}, "is_accepted": false, "score": 2, "last_activity_date": 1484082138, "last_edit_date": 1484082138, "creation_date": 1484078317, "answer_id": 41577330, "question_id": 41577181, "link": "https://stackoverflow.com/questions/41577181/create-a-2d-dynamic-string-array/41577330#41577330", "title": "Create a 2D Dynamic String Array", "body": "<p>If you know the length of the strings and how many you have, you can configure the array like this</p>\n\n<pre><code>char strings[numLines][strLen+1];\n</code></pre>\n\n<p>you can then access the array like this</p>\n\n<pre><code>strcpy(strings[1], \"test2\");\n</code></pre>\n\n<p>If you don't know anything beforehand, you need a pointer to pointer array and then use malloc to allocate space as the array grow, free when you are done.</p>\n"}, {"comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1484079689, "post_id": 41577543, "comment_id": 70360113, "body": "Technically that&#39;s not 2D array or an array of arrays... it&#39;s a 1D array of pointers, each of which points to a separately allocated 1D array of <code>char</code>.  An actual 2D array is also possible, but different."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1484080102, "post_id": 41577543, "comment_id": 70360327, "body": "What about <code>char (*arr)[21] = calloc(10, sizeof(*arr));</code>?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1484081237, "post_id": 41577543, "comment_id": 70360945, "body": "@Dmitri - Yes, that works well as long as the 21 is known at run-time.  I have use something similar.  But if not, then malloc or calloc are needed.  Of coarse, there are <i><a href=\"http://www.geeksforgeeks.org/variable-length-arrays-in-c-and-c/\" rel=\"nofollow noreferrer\">variable length arrays</a></i> from C99 and beyond."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1484080052, "last_edit_date": 1484080052, "creation_date": 1484079202, "answer_id": 41577543, "question_id": 41577181, "link": "https://stackoverflow.com/questions/41577181/create-a-2d-dynamic-string-array/41577543#41577543", "title": "Create a 2D Dynamic String Array", "body": "<p><em>dynamic</em> in C implies you will need to use one of [c][m]alloc to create memory for your strings.  And <em>2D</em> implies an array of <code>char</code> arrays.  Assuming you know the number of <em>strings</em> and the longest string needed, the following will create memory to contain them:</p>\n\n<pre><code>char ** Create2DStr(ssize_t numStrings, ssize_t maxStrLen)\n{\n    int i;\n    char **a = {0};\n    a = calloc(numStrings, sizeof(char *));\n    for(i=0;i&lt;numStrings; i++)\n    {\n      a[i] = calloc(maxStrLen + 1, 1);\n    }\n    return a;\n}\n</code></pre>\n\n<p>The following will free the memory created above:</p>\n\n<pre><code>void free2DStr(char ** a, ssize_t numStrings)\n{\n    int i;\n    for(i=0;i&lt;numStrings; i++)\n    {\n        if(a[i]) free(a[i]);\n    }\n    free(a);\n}\n</code></pre>\n\n<p>These can be called like this:  </p>\n\n<pre><code>...\nchar **strArray = {0};\nstrArray = Create2DStr(10, 20);\n//Use strArray...\nfree2DStr(10);\n</code></pre>\n\n<p>Giving 10 arrays, each able to contain 20 char, plus a NULL.  (The <code>+ 1</code> after <code>maxStrLen</code> provides the extra space for the NULL).</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1484084172, "creation_date": 1484084172, "answer_id": 41578864, "question_id": 41577181, "link": "https://stackoverflow.com/questions/41577181/create-a-2d-dynamic-string-array/41578864#41578864", "title": "Create a 2D Dynamic String Array", "body": "<p>If you want to save each line of the file as a row in the array, use a 2D array of <code>char</code>:</p>\n\n<pre><code>char fileContents[NUM_LINES][LINE_LENGTH + 1]; // +1 for zero terminator\n</code></pre>\n\n<p>If you don't know how many lines you have up front, you'll need to do some memory management.  First, you'll need to allocate an initial extent:</p>\n\n<pre><code>#define INITIAL_EXTENT 20 // or some good starting point\n\nchar (*fileContents)[LINE_LENGTH + 1] = malloc( sizeof *fileContents * INITIAL_EXTENT );\nif ( !fileContents )\n{\n  // malloc failed; fatal error\n  fprintf( stderr, \"FATAL: could not allocate memory for array\\n\" );\n  exit( EXIT_FAILURE );\n}\nsize_t numRows = INITIAL_EXTENT; // number of rows in array\nsize_t rowsRead = 0;             // number of rows containing data\n</code></pre>\n\n<p>As you read from the file, you'll check to make sure you have room in the array; if you don't, you'll need to extend the array with a <code>realloc</code> call, which is a potentially expensive operation.  A common technique is to double the size of the array each time you extend it - that minimizes the total number of <code>realloc</code> calls.  The risk is some internal fragmentation if you double the array size because you need just one more row, but that's probably something you can analyze around:</p>\n\n<pre><code>char tmpBuf[LINE_LENGTH + 2]; // account for newline in input buffer\n\nwhile ( fgets( tmpBuf, sizeof tmpBuf, inputFile ) )\n{\n  /**\n   * Check to see if you have any room left in your array; if not, \n   * you'll need to extend it.  You'll probably want to factor this \n   * into its own function.\n   */\n  if ( rowsRead == numRows ) \n  {\n    /**\n     * Use a temporary variable for the result of realloc in case of failure\n     */\n    char (*tmp)[LINE_LENGTH + 1] = \n      realloc( fileContents, sizeof *fileContents * ( 2 * numRows ) );\n\n    if ( !tmp )\n    {\n      /**\n       * realloc failed - we couldn't extend the array any more.  \n       * Break out of the loop. \n       */\n      fprintf( stderr, \"ERROR: could not extend fileContents array - breaking out of loop\\n\" );\n      break;\n    }\n    /**\n     * Otherwise, set fileContents to point to the new, extended buffer\n     * and update the number of rows.  \n     */\n    fileContents = tmp;\n    numRows *= 2;\n  }\n\n  // strip the newline from the input buffer\n  char *newline = strchr( tmpBuf, '\\n' );\n  if ( newline )\n    *newline = 0;\n\n  strcpy( fileContents[rowsRead++], tmpBuf );\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6303748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62f11ec1d534d75581d76cf6f1529f79?s=128&d=identicon&r=PG&f=1", "display_name": "Georgio3", "link": "https://stackoverflow.com/users/6303748/georgio3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1730, "favorite_count": 0, "closed_date": 1484088347, "answer_count": 4, "score": -3, "last_activity_date": 1484084172, "creation_date": 1484077800, "last_edit_date": 1484080281, "question_id": 41577181, "link": "https://stackoverflow.com/questions/41577181/create-a-2d-dynamic-string-array", "closed_reason": "Duplicate", "title": "Create a 2D Dynamic String Array", "body": "<p>Can anyone explain to me the easiest way to create dynamically a 2D string array with stable second dimension? I've got a txt file with some strings in it and I want to transfer this txt to an array. So I want to associate the txt line number with the first dimension and the string itself with the second dimension. The second dimension is the number of characters in every row (which is stable because every line in the txt has a certain syntax) So if I have in my txt:</p>\n\n<pre><code>hello how (newline)\nare youuu\n</code></pre>\n\n<p>*(I wrote <code>youuu</code> because as I said, every line has the same number of characters).</p>\n\n<p>I want something like:</p>\n\n<pre><code>array[0][\"hello how\"],\narray[1][\"are youuu\"]\n</code></pre>\n"}, {"tags": ["c", "cpu-architecture"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 6, "creation_date": 1484077707, "post_id": 41577110, "comment_id": 70359081, "body": "<code>bool.h</code> and booleans in general aren&#39;t an efficiency feature. Your question is based on a misconception."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484077741, "post_id": 41577110, "comment_id": 70359099, "body": "There <i>are</i> some architectures with bit-addressable memories. So C compiler for such an architectures <i>may</i> optimize some instructions to use these specifics. Or provide some extension commands to give this ability to the programmer."}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1484077750, "post_id": 41577110, "comment_id": 70359106, "body": "Good thing that the question isn&#39;t about the efficiency of the bool type then"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1484077854, "post_id": 41577110, "comment_id": 70359174, "body": "Also, the power of an ASIC isn&#39;t in manipulating individual bits."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1484084152, "post_id": 41577110, "comment_id": 70362545, "body": "It&#39;s call bit field."}, {"owner": {"reputation": 17904, "user_id": 364818, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/5fd80d98f96f9adbde7876cbda181715?s=128&d=identicon&r=PG", "display_name": "Mark Lakata", "link": "https://stackoverflow.com/users/364818/mark-lakata"}, "edited": false, "score": 0, "creation_date": 1484091607, "post_id": 41577110, "comment_id": 70365746, "body": "The down votes are for the nature of the question. Stack Overflow questions are supposed to be about solving concrete problems, not soliciting advice or opinions. I think this is a bit short signed on the part of SO, because I think some of the best answers on SO are opinions. BUT that is  probably why you were down voted (by others, not me)."}, {"owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 0, "creation_date": 1484185597, "post_id": 41577110, "comment_id": 70410000, "body": "No big mystery. Application-specific (the AS in ASIC) solutions will <i>virtually always</i> work better in some fashion than general purpose ones (in this case CPU&#39;s). If they didn&#39;t, why would someone pay to implement them? The general purpose solution is shaped by market forces as well. As late as the 80&#39;s there <i>were</i> bit-addressable architectures in use, e.g. Burroughs machines. Eventually bytes proved to be the best use of processor transistors and other resources in average applications."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1484081351, "post_id": 41577242, "comment_id": 70360990, "body": "&quot;By definition, a byte is the smallest addressable piece of memory in a computer.&quot; --&gt; Disagree. See <a href=\"http://stackoverflow.com/questions/41577110/can-bit-level-operations-ever-be-fast-in-software#comment70359099_41577110\">comment</a>  C imposes a minimum &quot;byte&quot; size, but that limits C code addressing, not the computer.  Further code could use  a bit field <code>unsigned x:1; ... x = y;</code> and the compiler generates code that addresses 1 bit and sets it."}, {"owner": {"reputation": 17904, "user_id": 364818, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/5fd80d98f96f9adbde7876cbda181715?s=128&d=identicon&r=PG", "display_name": "Mark Lakata", "link": "https://stackoverflow.com/users/364818/mark-lakata"}, "edited": false, "score": 0, "creation_date": 1484083949, "post_id": 41577242, "comment_id": 70362447, "body": "I&#39;d change the wording to &quot;by convention&quot; not &quot;by definition&quot;."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1484083995, "last_edit_date": 1484083995, "creation_date": 1484078041, "answer_id": 41577242, "question_id": 41577110, "link": "https://stackoverflow.com/questions/41577110/can-bit-level-operations-ever-be-fast-in-software/41577242#41577242", "title": "Can bit-level operations ever be &quot;fast&quot; in software?", "body": "<p>By convention, a byte is the smallest addressable piece of memory in a computer.  The number of bits that a byte has can differ from one system to another.</p>\n\n<p>In the case of x86, there are instructions to move bytes from memory to a register and back, and instructions to manipulate values in registers.  I can't speak to other architectures, but they most likely work in a similar way.</p>\n\n<p>So anytime you need to manipulate some number of bits you need to do so a byte (or word, i.e. multiple bytes) at a time.</p>\n"}, {"comments": [{"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1484078354, "post_id": 41577307, "comment_id": 70359450, "body": "No bit shifting is probably fine and all, but shifting is a byte-level operation really. I&#39;m talking about loading and flipping single bits."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1484078499, "post_id": 41577307, "comment_id": 70359520, "body": "@BenjaminLindqvist why should loading and flipping single bits be any slower than arithmetic operations?"}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 1, "creation_date": 1484078540, "post_id": 41577307, "comment_id": 70359543, "body": "Not slower on an absolute level, but certainly slower <i>per bit manipulated</i> :)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484078613, "post_id": 41577307, "comment_id": 70359573, "body": "You can manipulate <i>more than one bit</i> in a single operation."}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1484078742, "post_id": 41577307, "comment_id": 70359633, "body": "Well clearly batch processing is always more efficient. But sometimes your application simply does not allow it."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484078820, "post_id": 41577307, "comment_id": 70359675, "body": "If you have packed your information into bits, the gain is in memory requirement."}, {"owner": {"reputation": 17904, "user_id": 364818, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/5fd80d98f96f9adbde7876cbda181715?s=128&d=identicon&r=PG", "display_name": "Mark Lakata", "link": "https://stackoverflow.com/users/364818/mark-lakata"}, "edited": false, "score": 1, "creation_date": 1484078988, "post_id": 41577307, "comment_id": 70359759, "body": "CPUs are not bit stream oriented if that is your question.  Processing a compressed bit stream (like music or video or images, that use huffman encoding) is painful on a CPU that only accesses bytes.   There are architecture extensions on some CPUs that let you sort of have a bit stream, but these are not accessible through the C language. You need to write assembly or pseudoassembly to get those."}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1484079135, "post_id": 41577307, "comment_id": 70359832, "body": "Yes you got the gist of my question exactly. If you edit that in you have my checkmark - preferrably with a reference to this architecture extension you mentioned."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1484079206, "post_id": 41577307, "comment_id": 70359868, "body": "Back to question: &quot;Can bit level access be fast?&quot; Yes. If there is bitstream processing you only have a fraction of the file access, often the slowest operation. Yet accessing the next bit from a byte is very quick."}, {"owner": {"reputation": 17904, "user_id": 364818, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/5fd80d98f96f9adbde7876cbda181715?s=128&d=identicon&r=PG", "display_name": "Mark Lakata", "link": "https://stackoverflow.com/users/364818/mark-lakata"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1484083601, "post_id": 41577307, "comment_id": 70362277, "body": "I worked on an architecture once (that doesn&#39;t exist anymore) that had bit stream manipulation instructions: <a href=\"https://www.design-reuse.com/news/8418/3plus1-technology-emerges-stealth-mode-heterogeneous-multiprocessor-architecture-creates-power-performance-coolprocessor-family.html\" rel=\"nofollow noreferrer\">design-reuse.com/news/8418/&hellip;</a> but @WeatherVane brings up the most interesting part in that bit access, it turns out, is not the rate limiting step in most processors these days, but file IO and even memory IO are much slower than the processors."}, {"owner": {"reputation": 17904, "user_id": 364818, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/5fd80d98f96f9adbde7876cbda181715?s=128&d=identicon&r=PG", "display_name": "Mark Lakata", "link": "https://stackoverflow.com/users/364818/mark-lakata"}, "edited": false, "score": 0, "creation_date": 1484083874, "post_id": 41577307, "comment_id": 70362411, "body": "That said, if you solve the IO problem, an ASIC will always win.  Look at Bitcoin mining: <a href=\"https://en.bitcoin.it/wiki/Mining_hardware_comparison\" rel=\"nofollow noreferrer\">en.bitcoin.it/wiki/Mining_hardware_comparison</a>, ASICs are 1000x faster than GPUs and 1000000x faster than CPUs."}], "tags": [], "owner": {"reputation": 17904, "user_id": 364818, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/5fd80d98f96f9adbde7876cbda181715?s=128&d=identicon&r=PG", "display_name": "Mark Lakata", "link": "https://stackoverflow.com/users/364818/mark-lakata"}, "is_accepted": true, "score": 4, "last_activity_date": 1484078240, "creation_date": 1484078240, "answer_id": 41577307, "question_id": 41577110, "link": "https://stackoverflow.com/questions/41577110/can-bit-level-operations-ever-be-fast-in-software/41577307#41577307", "title": "Can bit-level operations ever be &quot;fast&quot; in software?", "body": "<p>No you can't rival the efficiency of an ASIC. An ASIC means you can replicate parallel bit streams as much as you have budget for on the chip. You just cut and paste your HDL until you fill your die space.  A CPU only has a limited number of cores.</p>\n\n<p>I'm guessing that you think that bit operations like <code>z = (x|(1&lt;&lt;y)&gt;&gt;4</code> are slow and yes, all that bit shifting is extra overhead. But that is just accessing the bits. The bit operations (OR, AND, etc) are all as fast as you can get on modern CPU, i.e. 1 cycle throughput.</p>\n\n<p>The 8051 architecture has a way of accessing individual bits directly, without using byte registers, but if you are worried about speed, you wouldn't consider a 8051.</p>\n"}, {"tags": [], "owner": {"reputation": 8256, "user_id": 937324, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/5sD0l.jpg?s=128&g=1", "display_name": "Gabriel Southern", "link": "https://stackoverflow.com/users/937324/gabriel-southern"}, "is_accepted": false, "score": 1, "last_activity_date": 1484101248, "creation_date": 1484101248, "answer_id": 41581705, "question_id": 41577110, "link": "https://stackoverflow.com/questions/41577110/can-bit-level-operations-ever-be-fast-in-software/41581705#41581705", "title": "Can bit-level operations ever be &quot;fast&quot; in software?", "body": "<p>I also don't know why this question got so many downvotes, the question:</p>\n\n<blockquote>\n  <p>In other words, is the atomicity of the byte an inherent property of modern CPUs or could we theoretically rival the efficiency of an ASIC just by using machine code?</p>\n</blockquote>\n\n<p>seems reasonable to me.  It's certainly not a bad compared to many questions on stackoverflow.</p>\n\n<p>The answer is: <strong>no CPUs can't match the efficiency of an ASIC</strong>.  </p>\n\n<p>However, the reason is not because CPUs are manipulating bytes instead of bits.  Instead it's because most of the work that CPUs do to process an instruction is involved with loading it from memory, decoding it, tracking dependencies, etc., rather than performing the actual arithmetic operations on bits or bytes that the instruction directs the CPU to perform. </p>\n\n<p>A good explanation of this is shown in the <a href=\"http://llvm.org/devmtg/2014-10/Slides/Baker-CustomHardwareStateMachines.pdf\" rel=\"nofollow noreferrer\">following presentation</a> from the 2014 LLVM developers meeting.  The presentation shows how OpenCL can be used to generate custom FPGA hardware.  Slides 12 to 28 show a nice pictorial example of overhead associated with a CPU algorithm and how custom hardware can remove much of this overhead.</p>\n"}], "owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 41577307, "answer_count": 3, "score": -3, "last_activity_date": 1484101248, "creation_date": 1484077582, "last_edit_date": 1484079507, "question_id": 41577110, "link": "https://stackoverflow.com/questions/41577110/can-bit-level-operations-ever-be-fast-in-software", "title": "Can bit-level operations ever be &quot;fast&quot; in software?", "body": "<p>Let me clarify the soft-sounding title straight away. This is actually something that has been nagging me for quite a while now, despite feeling like a pretty basic question.</p>\n\n<p>Many languages give a faulty impression of efficiency by letting the developer play with bits, such as the<code>bool.h</code> C header which, as I understand it, is essentially just an int with a wrapper around it. Essentially, the byte seems to be the absolute lowest atomic unit of computation  in C - <code>bool x = 0</code> is not faster/more memory efficient than <code>int x = 0</code>.</p>\n\n<p>What I'm wondering is then, what do we do when we want to implement an algorithm that is inherently tied to loading and manipulating single bits, such as decoding binary codes, unweighted graph connectivity problems and many others? In other words, is the atomicity of the byte an inherent property of modern CPUs or could we <em>theoretically</em> rival the efficiency of an ASIC just by using machine code?</p>\n\n<p>EDIT: Pretty surprised by the downvotes, but I suppose people just didn't understand what I was asking. I think a really good, canonical example is traversing a binary tree (or any other sequential list of yes/no questions really). What I was wondering is if modern cpu architectures are fundamentally poorly equipped to do this (as compared to an ASIC/FPGA, that is), or if this is an artifact of some abstraction layer (language/kernel/etc). Mark's answer was good though (although I'd love a reference to the mentioned architecture extension)</p>\n"}, {"tags": ["c", "csv", "arduino", "esp8266", "spiffs"], "comments": [{"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1484079165, "post_id": 41576696, "comment_id": 70359851, "body": "So, what is your problem... What did you get ?"}, {"owner": {"reputation": 2636, "user_id": 3368201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c46939557e63148d8c8cfa3b14d9e2f?s=128&d=identicon&r=PG&f=1", "display_name": "frarugi87", "link": "https://stackoverflow.com/users/3368201/frarugi87"}, "edited": false, "score": 2, "creation_date": 1484079334, "post_id": 41576696, "comment_id": 70359931, "body": "Piquard is right, it&#39;s hard to say what you need. Anyway, on the strtok_r manual page I read &quot;On the first call to strtok_r(), str should point to the string to be parsed, and the value of saveptr is ignored. In subsequent calls, str should be NULL, and saveptr should be unchanged since the previous call.&quot;. So you should pass NULL to the other calls, like <code>str = strtok_r(sz, &quot;;&quot;, &amp;p); while (str!=NULL) { ... str = strtok_r(NULL,&quot;;&quot;; &amp;p);}</code>"}, {"owner": {"reputation": 2636, "user_id": 3368201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c46939557e63148d8c8cfa3b14d9e2f?s=128&d=identicon&r=PG&f=1", "display_name": "frarugi87", "link": "https://stackoverflow.com/users/3368201/frarugi87"}, "edited": false, "score": 0, "creation_date": 1484079430, "post_id": 41576696, "comment_id": 70359984, "body": "Or you can use your code, but call <code>strtok_r(sz, &quot;;&quot;, &amp;p)</code> and then in the loop put a <code>sz = NULL;</code> instruction."}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1484080018, "post_id": 41576696, "comment_id": 70360293, "body": "Why you need to execute code before <code>setup()</code> is called ? The <code>Serial.println(&quot;file open failed&quot;);</code> will be not displayed correctly because <code>Serial.begin(115200);</code> is called after."}, {"owner": {"reputation": 13, "user_id": 6712329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9584c75ea83c9bb815574d188c668867?s=128&d=identicon&r=PG&f=1", "display_name": "Martin G.", "link": "https://stackoverflow.com/users/6712329/martin-g"}, "edited": false, "score": 0, "creation_date": 1484081046, "post_id": 41576696, "comment_id": 70360840, "body": "There is a void function before setup() -this is not a problem"}, {"owner": {"reputation": 13, "user_id": 6712329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9584c75ea83c9bb815574d188c668867?s=128&d=identicon&r=PG&f=1", "display_name": "Martin G.", "link": "https://stackoverflow.com/users/6712329/martin-g"}, "edited": false, "score": 0, "creation_date": 1484081066, "post_id": 41576696, "comment_id": 70360854, "body": "Problem is that I got error : &quot;cannot convert &#39;String&#39; to &#39;char*&#39; in initialization&quot;"}, {"owner": {"reputation": 217, "user_id": 6701599, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ihw-taH00ZU/AAAAAAAAAAI/AAAAAAAAAoA/LVhK_HfOlx4/photo.jpg?sz=128", "display_name": "Fernando Coelho", "link": "https://stackoverflow.com/users/6701599/fernando-coelho"}, "edited": false, "score": 1, "creation_date": 1484082561, "post_id": 41576696, "comment_id": 70361663, "body": "I have never coded in arduino, but the problem is that a String variable is not the same as a char* variable. Have you tried using: char *p = sz.c_str(); It should work based on this: <a href=\"https://www.arduino.cc/en/Reference/CStr\" rel=\"nofollow noreferrer\">arduino.cc/en/Reference/CStr</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1484082670, "post_id": 41576696, "comment_id": 70361744, "body": "This doesn&#39;t look like C, more like C++."}, {"owner": {"reputation": 13, "user_id": 6712329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9584c75ea83c9bb815574d188c668867?s=128&d=identicon&r=PG&f=1", "display_name": "Martin G.", "link": "https://stackoverflow.com/users/6712329/martin-g"}, "edited": false, "score": 0, "creation_date": 1484083948, "post_id": 41576696, "comment_id": 70362446, "body": "I try but still error : &quot;exit status 1 invalid conversion from &#39;const char*&#39; to &#39;char*&#39; [-fpermissive]&quot;"}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1484084427, "post_id": 41576696, "comment_id": 70362705, "body": "You can not use <code>strtok</code> or <code>strtok_r</code> with a <code>const char *</code> because the add of one <code>&#39;\\0&#39;</code> in place of each found delimiter. Try to duplicate the content of <code>sz.c_str()</code> into a <code>char sTmp[81]</code>."}, {"owner": {"reputation": 13, "user_id": 6712329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9584c75ea83c9bb815574d188c668867?s=128&d=identicon&r=PG&f=1", "display_name": "Martin G.", "link": "https://stackoverflow.com/users/6712329/martin-g"}, "edited": false, "score": 0, "creation_date": 1484085373, "post_id": 41576696, "comment_id": 70363215, "body": "In this case ther is error : &quot;array must be initialized with a brace-enclosed initializer &quot;.   I think there must be a better solution to import data from file into table then my solution"}, {"owner": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 0, "creation_date": 1484087088, "post_id": 41576696, "comment_id": 70364055, "body": "<code>t[i]= new String(str);</code>. <code>String</code> is a class, so a <code>char*</code> can&#39;t be casted to <code>String</code>, a new <code>String</code> must be constructed from a <code>char*</code>. But pretty sure then <code>t</code> must be declared as <code>String* t[10];</code>. On the other hand, why use <code>String</code>? Just  declare <code>char* t[10];</code> and everything should work the same."}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1484127818, "post_id": 41576696, "comment_id": 70378488, "body": "@MartinG. You need to use <code>char sTmp[81];</code>(declaration) then <code>strcpy(sTmp, sz.c_str());</code> (initialization) ==&gt; <code>while ((str = strtok_r(sTmp, &quot;;&quot;, &amp;p)) != NULL)</code> (using with strtok)."}], "owner": {"reputation": 13, "user_id": 6712329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9584c75ea83c9bb815574d188c668867?s=128&d=identicon&r=PG&f=1", "display_name": "Martin G.", "link": "https://stackoverflow.com/users/6712329/martin-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 575, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484081584, "creation_date": 1484075991, "last_edit_date": 1484081584, "question_id": 41576696, "link": "https://stackoverflow.com/questions/41576696/how-to-split-string-into-array-tricky-version", "title": "How to split string into array - (tricky version)", "body": "<p>How can I split string into table ? <br> \nThe string I'm working with is the content of the file in Arduino FS. I'm using SPIFSS.open() to create this string.<br>\nMy goal is to read data from file and put them into table. Separation char is delimeter \";\" just like the same as in .csv file. <br></p>\n\n<blockquote>\n  <p>Goals to achive:<br>\n  t[1] =Here <br>\n  t[2]=is some <br>\n  t[3]=sample<br>\n  t[4]=100<br>\n  ...<br></p>\n</blockquote>\n\n<pre><code>File cfg_s1 = SPIFFS.open(\"/cfg_s1.txt\", \"r\");\nif (!cfg_s1) {\n  Serial.println(\"file open failed\");\n}\n\n// version below with char is working correctly\n//char sz[] = \"Here; is some; sample;100;data;1.414;1020\";\n\n// version with string is not working. \"sz\" is the content of cfg_s1.txt file \nString sz;\nsz=cfg_s1.readString();\n\nvoid setup()\n{\n Serial.begin(115200);\n char *p = sz;\n char *str;\n String t[10];\n int i = 1;\n\n while ((str = strtok_r(p, \";\", &amp;p)) != NULL){\n   t[i]=str;\n   Serial.println(t[i]);\n   i++;\n }\nSerial.println(t[2]);\n}\n\n\nvoid loop()\n{\n\n}\n</code></pre>\n\n<p>Error : \"cannot convert 'String' to 'char*' in initialization\" </p>\n"}, {"tags": ["c", "arrays", "pointers", "dereference", "addressof"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1484073551, "post_id": 41575903, "comment_id": 70356750, "body": "&quot;<code>&amp;array</code> gives you address of the first element&quot; is very wrong! And the rest of your claims don&#39;t look better. It might be aq good idea to read a C book and not listen to your classmates, who seem to be quite clueless. Hint: an array is not a pointer!"}, {"owner": {"reputation": 41430, "user_id": 607407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a061a72feb5b6580dadd5dcbc92d3b5?s=128&d=identicon&r=PG", "display_name": "Tom&#225;\u0161 Zato - Reinstate Monica", "link": "https://stackoverflow.com/users/607407/tom%c3%a1%c5%a1-zato-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1484073716, "post_id": 41575903, "comment_id": 70356821, "body": "@Olaf Those are not <i>claims</i>, since this is a question, not an answer."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1484073912, "post_id": 41575903, "comment_id": 70356947, "body": "<code>int numbers = {1,2,3,4};</code> is a syntax error; I think you <i>meant</i> <code>int numbers[] = {1,2,3,4};</code>.  The type of the expression <code>numbers</code> is <code>int [4]</code>; unless that expression is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, it &quot;decays&quot; to an expression of type <code>int *</code>, and its value is the same as <code>&amp;numbers[0]</code>.  The type of the expression <code>&amp;numbers</code> is <code>int (*)[4]</code> (pointer to 4-element array of int).  It&#39;s value is the same as <code>numbers</code> (modulo any type conversions), but the <i>type</i> is different."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1484074270, "post_id": 41575903, "comment_id": 70357163, "body": "&quot;But turns out they are right.&quot; - that&#39;s a claim, maybe a prerequsite of your question, but not a question as such. And there are many more false assumptions (one of them was just corrected by you)."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1484074569, "post_id": 41575903, "comment_id": 70357326, "body": "@Olaf Strictly speaking <code>&amp;array</code> returns the address of the array; is this not necessarily also the address of the first element of said array? (even if the resulting pointer has a different type)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484075284, "post_id": 41575903, "comment_id": 70357752, "body": "<code>&amp;array</code> and <code>&amp;array[0]</code> are pointers (of different types) that compare equal to each other.  They need not have the same bit pattern."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1484075339, "post_id": 41575903, "comment_id": 70357786, "body": "@davmac: An object has not only a value, but also a type. C is already weakly typed, we should avoid weakening it further. Both are relevant. Try <code>sizeof(&quot;Hello World&quot;) == sizeof(&amp;&quot;Hello World&quot;)</code>. Interestingly there were CPU designs in the 70ies and 80ies which were aware of object types. They did not make it to larger production (among other reasons) because of required logic gates and because back them type-safe programming was just starting in the larger field. Maybe once we hav AVX4096, etc. CPU designers come back to type-safe CPUs. This couldenhance security much more than another VM."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1484075801, "post_id": 41575903, "comment_id": 70358046, "body": "@Olaf yes, an array has a type and its first element has a different type; my point is that they necessarily have the same address. In that sense at least, <code>&amp;a</code> <i>does</i> return the address of the first element of <code>a</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1484076011, "post_id": 41575903, "comment_id": 70358186, "body": "@davmac: They do not have the same address! I tried to make clear that the address is not only the value, but also the type. What is unclear about that? Write type-correct code and don&#39;t use invalid hacks. There is no need for that assumption. If you enable recommended warnings, the compiler will correctly complain about such code."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484083874, "post_id": 41575903, "comment_id": 70362410, "body": "@Olaf an <i>address</i> does not have a type; you said that an <i>object</i> has a type, and that is correct. An <i>address</i> describes a location in storage. An array is sequence of contiguous elements, and necessarily those elements are within the region of storage used by the array itself. It does not make sense to argue that the array object and its elements do no not overlap; therefore their address ranges must overlap. Please do not confuse &quot;address&quot; with &quot;pointer value&quot;."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1484085352, "post_id": 41575903, "comment_id": 70363199, "body": "@davmac: Please provide a reference to the standard where it requires two objects of different type to have the same representation! The address of an object is bound to its type. But this discussion is pointless, you just confuse beginners and seem to propose bad practice. Finally: read 6.5.3.2p3 in the standard: &quot;The unary &amp; operator <b>yields the address</b> of its operand. If the operand has type &#39;&#39;type&#39;&#39;, <b>the result has type</b> &#39;&#39;pointer to type&#39;&#39;&#39;.&quot; This implies addresses according to the standard very well have a type!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484085714, "post_id": 41575903, "comment_id": 70363383, "body": "It <b>is</b> not the same. See my edited comment above and read the standard. Btw: The array name as such is not the address of its first element, but is <b>converted</b> to it! That&#39;s an important difference."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484086283, "post_id": 41575903, "comment_id": 70363684, "body": "@Olaf I did not claim that two objects of different type have the same representation. Your quotation from the standard is seemingly relevant but I believe simply stems from an inconsistency in the standard; the term &quot;address&quot; is used mostly to denote something akin to an address within storage, which is clearly not typed; what they mean in 6.5.3.2p3 is that it yields a <i>pointer</i> to its operand. See eg 6.2.8 in C11 for a more regular usage of &quot;address&quot; which implies no type. If we take &quot;address&quot; to mean &quot;location in storage&quot; then clearly the address of an array and its first element match."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484086497, "post_id": 41575903, "comment_id": 70363785, "body": "<i>sigh</i> you claimed they have the same <i>address</i>. Which the cited part of the standard proves wrong. If that still is not clear, I can&#39;t help you. I give up."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1484087171, "post_id": 41575903, "comment_id": 70364089, "body": "@Olaf, sigh indeed. I have already clearly stated the problem with taking that particular citation as gospel regarding the meaning of &quot;address&quot;. See for another example 6.7.2.1p15: <i>Within a structure object, the non-bit-field members and the units in which bit-fields reside have addresses that increase in the order in which they are declared</i> - this is clearly not meant to imply that pointers to different members of the same structure all have the same type, implying that the type is not part of the <i>address</i>."}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1484138593, "post_id": 41575903, "comment_id": 70385806, "body": "@Olaf &quot;address&quot; is not a term defined by the standard, so insisting that it must have a <i>specific</i> definition involving types is silly. However, its use in the context of alignment descriptions implies that an &quot;address&quot; is a property primarily of <i>bytes</i>, i.e. the actual value (not representation) of their location, i.e. type is irrelevant as it&#39;s too high-level a concept."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 0, "creation_date": 1484139013, "post_id": 41575903, "comment_id": 70386074, "body": "@Leushenko: As this is about the unary <code>&amp;</code> operator, we can asume the most relevant part here is the semantics of that operator. And the standard is quite clear here. Another aspect is that &quot;the array and the first element have the same address&quot; implies they compare equal, which is not guaranteed by the standard. Actually they may not even be compared, as they point to objects of different type."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1484224725, "post_id": 41575903, "comment_id": 70428093, "body": "@Olaf 6.2.5 <i>An array type describes a contiguously allocated nonempty set of objects</i> - strongly implies, at least, that the elements are allocated in order; since the array object necessarily overlaps its element objects, this in turn implies that the location of the first element coincides with the location of the array itself. 6.5.6 <i>For the purposes of these operators, a pointer to an object that is not an element of an array behaves the same as a pointer to the first element of an array of length one with the type of the object as its element type.</i> - proves it for array size == 1."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1484226707, "post_id": 41575903, "comment_id": 70429384, "body": "@Olaf furthermore the paragraph you cite does <i>not</i> actually say that an address has a type (though I see why you think it does). By &quot;yields the address of the operand&quot; it means that the value component of the result is the address; the second part, about the type, is distinct. This is similar to other operators, eg addition: <i>The result of the binary + operator is the sum of the operands</i> - although other paragraphs describe the type of the result, this does not mean that eg the number 8 from <code>4 + 4</code> has an intrinsic type; the type of the expression is distinct from its value."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1484227669, "post_id": 41575903, "comment_id": 70429982, "body": "@davmac: You completely missed the point! Read about compiler optimisations, the abstract machine, observable behaviour and what undefined behaviour implies. Then take a long holiday , come back and read that again. Then meditate 1-2 years about what all these mean and have to do with what I wrote (they have!). Then we can start a <b>true</b> discussion."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1484228509, "post_id": 41575903, "comment_id": 70430585, "body": "@Olaf I did not miss the point, and I understand the concepts of the abstract machine and observable behaviour perfectly well, thank you. Being arrogant and condescending will not help you to understand what I am saying; you need to read it carefully and consider it with care. Although I believe you are incorrect, I have at least replied with courtesy to your remarks; you should do the same. That is all."}], "answers": [{"comments": [{"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 4, "creation_date": 1484073623, "post_id": 41575952, "comment_id": 70356785, "body": "&quot;in some cases&quot; -&gt; interesting note: per <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1930.htm\" rel=\"nofollow noreferrer\">defect report</a>, it&#39;s not currently adequately specified which exactly all of these cases are; the C11 standard appears to contradict itself."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484074065, "post_id": 41575952, "comment_id": 70357041, "body": "As <code>_Generic</code> is not an operator, I&#39;d interpret it as if 6.3.2.1 does apply. But I&#39;m not sure if it <i>should</i>. So you have a point indeed, thanks for the info, very interesting."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 1, "last_activity_date": 1484073683, "last_edit_date": 1484073683, "creation_date": 1484073327, "answer_id": 41575952, "question_id": 41575903, "link": "https://stackoverflow.com/questions/41575903/why-does-pointer-to-array-done-by-array-equal-the-array-itself/41575952#41575952", "title": "Why does pointer to array (done by &amp;array) equal the array itself?", "body": "<p>The address of an array and the address of the first element of the array are essentially same <em>value</em> (same address location). They differ in <em>type</em>.</p>\n\n<blockquote>\n  <p><em>Expression <code>&amp;numbers</code> is essentially meaningless</em></p>\n</blockquote>\n\n<p>No, it is not.</p>\n\n<p>In your case, </p>\n\n<ul>\n<li><code>&amp;numbers</code> is of type <code>int (*) [4]</code></li>\n<li><code>numbers</code> is of type <code>int [4]</code>, and in some cases<sup>Note</sup>, it decays to <code>int *</code>.</li>\n</ul>\n\n<hr>\n\n<p>Note:</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a76.3.2.1</p>\n\n<blockquote>\n  <p>Except when it is the operand of the <code>sizeof</code> operator, the <code>_Alignof</code> operator, or the\n  unary <code>&amp;</code> operator, or is a string literal used to initialize an array, an expression that has\n  type <em>\u2018\u2018array of type\u2019\u2019</em> is converted to an expression with type <em>\u2018\u2018pointer to type\u2019\u2019</em> that points\n  to the initial element of the array object [....]</p>\n</blockquote>\n"}], "owner": {"reputation": 41430, "user_id": 607407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a061a72feb5b6580dadd5dcbc92d3b5?s=128&d=identicon&r=PG", "display_name": "Tom&#225;\u0161 Zato - Reinstate Monica", "link": "https://stackoverflow.com/users/607407/tom%c3%a1%c5%a1-zato-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 1, "closed_date": 1484073460, "accepted_answer_id": 41575952, "answer_count": 1, "score": -3, "last_activity_date": 1484074044, "creation_date": 1484073146, "last_edit_date": 1484074044, "question_id": 41575903, "link": "https://stackoverflow.com/questions/41575903/why-does-pointer-to-array-done-by-array-equal-the-array-itself", "closed_reason": "Duplicate", "title": "Why does pointer to array (done by &amp;array) equal the array itself?", "body": "<p>So I almost went all hurr durr on my classmates when they wrote that</p>\n\n<blockquote>\n  <p><code>&amp;array</code> gives you address of the first element</p>\n</blockquote>\n\n<p>But turns out they are right. This sounds like inconsistency to me. We're talking about array defined like this:</p>\n\n<pre><code>int numbers[] = {1,2,3,4};\n</code></pre>\n\n<p>The variable <code>numbers</code> is (I think) then of type <code>int* const</code>. I'd think that pointer to that would be <code>int** const</code>. But apparently this expression evaluates as true:</p>\n\n<pre><code>if(&amp;numbers == numbers) {\n    printf(\"Pointer to array is still the same array!\\n\");\n}\n</code></pre>\n\n<p>And of course, this then also is true:</p>\n\n<pre><code>int* first_elm_ptr = &amp;numbers;\nif(*first_elm_ptr == *numbers)\n    printf(\"%d == %d\\n\", *first_elm_ptr, *numbers);\n</code></pre>\n\n<p>So apparently you cannot get a pointer to the variable holding address of that array. Expression <code>&amp;numbers</code> is essentially meaningless. Maybe it is even removed by compiler.</p>\n\n<p>How's that possible? I am very confused right now! How does standard explain this behaviour? I made an ideone test code to verify this: <a href=\"http://ideone.com/pYffYx\" rel=\"nofollow noreferrer\">http://ideone.com/pYffYx</a></p>\n"}, {"tags": ["c", "pipe", "fork"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1484073749, "post_id": 41575801, "comment_id": 70356842, "body": "If you check the return values of your function calls as you should do, then you will know where the failure occurs, if indeed there is any actual failure at all."}, {"owner": {"reputation": 46, "user_id": 6715584, "user_type": "registered", "profile_image": "https://graph.facebook.com/318995775103284/picture?type=large", "display_name": "Anastasiia Nikolaienko", "link": "https://stackoverflow.com/users/6715584/anastasiia-nikolaienko"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1484074606, "post_id": 41575801, "comment_id": 70357353, "body": "First child dies after &quot;dup2(fd[1], 1)&quot;, but I don&#39;t understand why.."}, {"owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "edited": false, "score": 0, "creation_date": 1484075111, "post_id": 41575801, "comment_id": 70357650, "body": "What is the return value from <code>dup2</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1484075421, "post_id": 41575801, "comment_id": 70357828, "body": "I&#39;m inclined to think that the first child either fails at the <code>execlp()</code>, or that the exec&#39;d program hangs or blocks, or indeed that the exec&#39;d program runs to completion and terminates.  Note in particular that the output of its <code>printf()</code> will go into the pipe.  You could <code>fprintf()</code> to <code>stderr</code> to avoid that."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1484075619, "post_id": 41575801, "comment_id": 70357942, "body": "Again, however, if any of the function calls fails then you can know it from their return values.  For these particular functions you furthermore can determine the nature of the failure based on <code>errno</code>, and a convenient way to get feedback about that would be via the <code>perror()</code> function (which, by the way, sends its output to <code>stderr</code>, not <code>stdout</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 3, "last_activity_date": 1484081590, "last_edit_date": 1484081590, "creation_date": 1484075119, "answer_id": 41576457, "question_id": 41575801, "link": "https://stackoverflow.com/questions/41575801/pipes-dont-work-in-loop-with-forks/41576457#41576457", "title": "Pipes don&#39;t work in loop with forks", "body": "<p>Aside from the failure to check the return values of your function calls and to handle errors that may be indicated by those return values, your code looks pretty reasonable.  I do see two problems, however:</p>\n\n<ol>\n<li><p>The most significant problem I see is that the main process keeps its own copies of the pipe ends open.  As long as there is at least one open file description referring to the write end of the pipe, in any process, end-of-file will not be signaled to the read end.  If the process running at the read end is one that reads its input to completion, such as <code>cat</code>, <code>grep</code>, or <code>sed</code>, then that process will wait forever for the write end to be closed, because the main process won't exit until that child terminates (because of the <code>wait()</code>).</p></li>\n<li><p>The main process waits for each child immediately after forking it, and in particular, it waits for the first child before forking the second.  Pipes have finite buffers, and if the first child fills the pipe buffer before it finishes writing all its output, then it will block.  In that case, the main process will never launch the second child, which otherwise would have drained the pipe.</p></li>\n</ol>\n\n<p>Overall, it is usually appropriate for a pipe to provide communication between two endpoints only.  In that usual case, it is important to launch both reader and writer without unnecessary delay, and to ensure that all handles on the pipe ends are closed, in all processes, except for one copy of the read end in one thread of one process, and one copy of the write end in a different thread or different process.  In a case such as yours, avoiding unnecessary delay includes not <code>wait()</code>ing for any child process until both (all) of the children have been launched.</p>\n"}], "owner": {"reputation": 46, "user_id": 6715584, "user_type": "registered", "profile_image": "https://graph.facebook.com/318995775103284/picture?type=large", "display_name": "Anastasiia Nikolaienko", "link": "https://stackoverflow.com/users/6715584/anastasiia-nikolaienko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484081590, "creation_date": 1484072726, "last_edit_date": 1484074453, "question_id": 41575801, "link": "https://stackoverflow.com/questions/41575801/pipes-dont-work-in-loop-with-forks", "title": "Pipes don&#39;t work in loop with forks", "body": "<p>How it should work: parent creates a child, that executes first command and redirects the output to the pipe, then second child redirects standart input to that pipe.\n<br/><br/>My problem: when second child tries to read from the pipe, it waits forever \n<br/>(I really need a loop here, because in my actual program I will not know how many commands I will have, so it's just a simple version)</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main(int argc, char**argv) {\n    int fd[2]; \n\n    pipe(fd);\n    for(int i = 0; i &lt; 2; i++) {\n        if (fork() == 0) {\n            printf(\"\\nloop %d\\n\", i);\n            if (i == 0) {\n                dup2(fd[1], 1);\n                close(fd[0]);\n                close(fd[1]);\n                printf(\"\\nbefore exec %s\\n\", argv[1]);\n                execlp(argv[1], argv[1], NULL);\n            }\n            else if(i == 1) {\n                dup2(fd[0], 0);\n                close(fd[0]);\n                close(fd[1]);\n                printf(\"\\nbefore exec %s\\n\", argv[2]);\n                execlp(argv[2], argv[2], NULL);\n            }\n            exit(0);\n        }\n        wait(NULL);\n    }\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484072591, "post_id": 41575722, "comment_id": 70356179, "body": "Where is the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? And the compiler is likely strictly implementing the abstract machine. You might want to read what the <code>volatile</code> qualifier can do for you."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1484072846, "post_id": 41575722, "comment_id": 70356327, "body": "Too much hand-waving. Looking at the C code is much more helpful than the assembly."}, {"owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1484073046, "post_id": 41575722, "comment_id": 70356453, "body": "@Olaf - I&#39;ve definitely got the &#39;minimal&#39; part. Supplying the &#39;complete&#39; part would be a bit lengthy if I included everything including the ISR, so in lieu of that I included the assembly in case anyone wanted more detail. Really the crux of the issue is contained entirely in my &quot;Specifically what&#39;s happening...&quot; paragraph and the &quot;From a &#39;local&#39; perspective...&quot; paragraph near the end. The rest is just details that shouldn&#39;t be too important."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1484073222, "post_id": 41575722, "comment_id": 70356556, "body": "@phonetagger: As much as I will tell is that this is not a compiler bug. Somethimes it is better to not put all into one statement."}, {"owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1484074067, "post_id": 41575722, "comment_id": 70357042, "body": "@EugeneSh. - Since I was concerned that this was a compiler bug (which it apparently isn&#39;t, per David Schwartz&#39;s answer), it seems to me that the assembly code would be a fairly critical piece of information for deciding whether there&#39;s a compiler bug or not. I think the information in my question was very carefully and reasonably picked to address the question, without providing a lot of unnecessary fluff. I don&#39;t think I&#39;ve done any hand-waving here."}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 6, "last_activity_date": 1484073469, "last_edit_date": 1484073469, "creation_date": 1484072927, "answer_id": 41575855, "question_id": 41575722, "link": "https://stackoverflow.com/questions/41575722/is-this-a-compiler-bug/41575855#41575855", "title": "Is this a compiler bug?", "body": "<blockquote>\n  <p>Shouldn't the compiler be writing the incremented value of dbg_TxBufProduceCount to memory after it writes ch to memory?</p>\n</blockquote>\n\n<p>No. There's no reason it should. Nothing imposes any ordering on the operations that take place inside a single statement. This is a single statement that writes to two volatile variables -- it can write to them in either order. Conceptually, it's no different from:</p>\n\n<pre><code>i = a++ + b++;\n</code></pre>\n\n<p>Even if <code>a</code> and <code>b</code> are volatile, the compiler is free to generate code to write to them in either order. The order of evaluation of parts of a single statement, and the order in which side-effects of that instruction are made visible, is unspecified.</p>\n"}], "owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 41575855, "answer_count": 1, "score": 4, "last_activity_date": 1484073469, "creation_date": 1484072466, "question_id": 41575722, "link": "https://stackoverflow.com/questions/41575722/is-this-a-compiler-bug", "title": "Is this a compiler bug?", "body": "<p>My nearly microscopic 8051-based embedded system has a debug serial port, and I wrote a simple serial port output function that was working fine until I made a couple minor tweaks in it to reduce its memory footprint. Then the following line, which WAS working fine (and wasn't part of the changes)...</p>\n\n<pre><code>dbg_TxBuf[(dbg_TxBufProduceCount++) &amp; (sizeof(dbg_TxBuf) - 1)] = ch;\n</code></pre>\n\n<p>...stopped working right. The variables <code>dbg_TxBuf</code> and <code>dbg_TxBufProduceCount</code> are global variables, used only by the output function and the serial port ISR (which was not changed at all):</p>\n\n<pre><code>#define DBG_TX_BUFFER_SIZE 16 // MUST be a power-of-2 (this line is actually in a separate file, not that it matters)\nvolatile uint8_t xdata dbg_TxBuf[DBG_TX_BUFFER_SIZE]; // must be sized by a power-of-2, and MUST BE LESS THAN 256 since the 'count' vars are uint8\nvolatile uint8_t xdata dbg_TxBufProduceCount; // akin to a 'head' index but more useful since it allows use of every byte in the buf\nvolatile uint8_t xdata dbg_TxBufConsumeCount; // akin to a 'tail' index but more useful since it allows use of every byte in the buf\n</code></pre>\n\n<p>Specifically what's happening is that the way the compiler is now optimizing the line of code is that <code>dbg_TxBufProduceCount</code> is being incremented (in memory) prior to the point that <code>ch</code> is written to <code>dbg_TxBuf</code>. Then the serial port ISR \"occasionally\" (actually quite often) sees that <code>dbg_TxBufConsumeCount != dbg_TxBufProduceCount</code> and reads <code>dbg_TxBuf[(dbg_TxBufConsumeCount++) &amp; (sizeof(dbg_TxBuf) - 1)]</code> prior to the point that the output function writes <code>ch</code> to it. Thus I get corrupted output on my serial port.</p>\n\n<p>Here's the 8051 disassembly of that line:</p>\n\n<pre><code>935&gt;       dbg_TxBuf[(dbg_TxBufProduceCount++) &amp; (sizeof(dbg_TxBuf) - 1)] = ch;\nDC84: 9006D6   MOV   DPTR,#dbg_TxBufProduceCount\nDC87: E0       MOVX  A,@DPTR    &lt;--- loads the value in dbg_TxBufProduceCount into the A register\nDC88: FE       MOV   R6,A       &lt;--- saves a copy of it in R6\nDC89: 04       INC   A          &lt;--- increments it\nDC8A: F0       MOVX  @DPTR,A    &lt;--- writes the incremented value \nDC8B: EE       MOV   A,R6       &lt;--- gets the original copy of ProduceCount back in A\nDC8C: 7C00     MOV   R4,#00     Begin computing address of dbg_TxBuf[~]...\nDC8E: 540F     ANL   A,#0F      &lt;--- A = A &amp; (sizeof(dbg_TxBuf) - 1)\nDC90: 24D8     ADD   A,#0D8     &lt;--- A is now the low byte of &amp;dbg_TxBuf[~]\nDC92: F582     MOV   DPL,A      &lt;--- put that in DPL\nDC94: EC       MOV   A,R4       &lt;--- (an inefficient way of loading the...\nDC95: 3406     ADDC  A,#06      &lt;---   ...immediate value 0x06 into A)\nDC97: F583     MOV   DPH,A      &lt;--- DPTR now points to dbg_TxBuf[~]\nDC99: EF       MOV   A,R7       &lt;--- load 'ch' into A\nDC9A: F0       MOVX  @DPTR,A    &lt;--- write 'ch' to *DPTR\n</code></pre>\n\n<p>From a \"local\" perspective the compiler is treating the post-increment operator correctly, in that it's using the value of <code>dbg_TxBufProduceCount</code> prior to the increment in the computation of the index into <code>dbg_TxBuf</code>, but from a \"global\" perspective it seems to me that it's not handling the sequence of events properly, especially since I declared both <code>dbg_TxBuf[]</code> and <code>dbg_TxBufProduceCount</code> as <code>volatile</code>. Shouldn't the compiler be writing the incremented value of <code>dbg_TxBufProduceCount</code> to memory <strong><em>after</em></strong> it writes <code>ch</code> to memory?</p>\n\n<p>BTW I'm using the Keil 8051 C compiler, v7.10. I don't know when v7.10 was released, but it appears that our support for the compiler ended in May 2005.</p>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 1843, "user_id": 3185860, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23e2427bb6481f77d8fb17f990e33ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Toma Radu-Petrescu", "link": "https://stackoverflow.com/users/3185860/toma-radu-petrescu"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1484070317, "post_id": 41575030, "comment_id": 70354922, "body": "@MichaelWalz I did that. It&#39;s in the first if."}, {"owner": {"reputation": 1843, "user_id": 3185860, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23e2427bb6481f77d8fb17f990e33ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Toma Radu-Petrescu", "link": "https://stackoverflow.com/users/3185860/toma-radu-petrescu"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1484070374, "post_id": 41575030, "comment_id": 70354951, "body": "@RadLexus Do you mean my folder structure/tree?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484070378, "post_id": 41575030, "comment_id": 70354953, "body": "If you ste through your code with a debugger you should be able to find this issue quickly. I don&#39;t have a linux here so I cannot check."}], "answers": [{"comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1484070609, "post_id": 41575113, "comment_id": 70355100, "body": "And to correct this, you&#39;d have to make a string out of <code>path</code> + / + <code>ent-&gt;d_name</code> and pass that to <code>stat()</code> - i.e. move the code that populates the <code>x</code> array up, and do <code>stat(x, &amp;my_stat);</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1484070722, "post_id": 41575113, "comment_id": 70355168, "body": "@nos Indeed.  In fact, I somehow had originally read the posted code as calling <code>stat(ent-&gt;d_name, &amp;my_stat);</code>, hence my deleted answer..."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 4, "last_activity_date": 1484070398, "creation_date": 1484070398, "answer_id": 41575113, "question_id": 41575030, "link": "https://stackoverflow.com/questions/41575030/s-isdir-thinks-file-is-a-directory/41575113#41575113", "title": "S_ISDIR thinks file is a directory", "body": "<p>You're calling <code>stat()</code> on the directory you opened with <code>opendir()</code>:</p>\n\n<pre><code>DIR *d = opendir(path);\n\nwhile((ent = readdir(d))){\n\n    struct stat my_stat;\n\n    stat(path, &amp;my_stat);\n</code></pre>\n\n<p>So yes, the contents of <code>my_stat</code> indicate that it's a directory - because <code>path</code> is a directory.</p>\n\n<p>You're also not checking the return code from <code>stat()</code>.  That can fail, and if you do change <code>path</code> to <code>stat()</code> the entry returned from <code>readdir()</code>, you will get incorrect results if <code>stat()</code> fails.</p>\n"}], "owner": {"reputation": 1843, "user_id": 3185860, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23e2427bb6481f77d8fb17f990e33ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Toma Radu-Petrescu", "link": "https://stackoverflow.com/users/3185860/toma-radu-petrescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1125, "favorite_count": 0, "accepted_answer_id": 41575113, "answer_count": 1, "score": 1, "last_activity_date": 1484070398, "creation_date": 1484070099, "question_id": 41575030, "link": "https://stackoverflow.com/questions/41575030/s-isdir-thinks-file-is-a-directory", "title": "S_ISDIR thinks file is a directory", "body": "<p>I am trying to print all the files' and folders' names inside a directory and its subdirectories.\nThe problem is that files are also considered directories? Sorry for posting my whole code, but I really don't have any idea why this is happening. Thank you. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;string.h&gt;\n\nvoid parcurgere(char path[1000]){\n\n    char aux[1000];\n    strcpy(aux, path);\n\n    struct dirent *ent;\n    DIR *d = opendir(path);\n\n    while((ent = readdir(d))){\n\n        struct stat my_stat;\n\n        stat(path, &amp;my_stat);\n        if(S_ISDIR(my_stat.st_mode) &amp;&amp; strcmp(ent-&gt;d_name, \".\")!=0 &amp;&amp; strcmp(ent-&gt;d_name, \"..\")!=0 &amp;&amp; strcmp(ent-&gt;d_name, \".DS_Store\")!=0){\n            printf(\"%s - folder\\n\", ent-&gt;d_name);\n            char x[1000];\n            strcpy(x, path);\n            strcat(x, \"/\");\n            strcat(x, ent-&gt;d_name);\n            parcurgere(x);\n        }\n        if(S_ISREG(my_stat.st_mode)){\n            printf(\"%s - fisier\\n\", ent-&gt;d_name);\n        }\n\n        strcpy(path, aux);\n        //path[strlen(path) - poz] = '\\0';\n    }\n}\n\nint main(){\n\n    char path[1000];\n    strcpy(path, \".\");\n\n    parcurgere(path);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1484069779, "post_id": 41574817, "comment_id": 70354614, "body": "Put all 3 in a <code>struct</code> and return that.  But suggest instead to have the caller pass in the address of where to save the results instead.  Posting an example, even in pseudo code, would help clarify your goals."}, {"owner": {"reputation": 409, "user_id": 3017656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/yoGZy.jpg?s=128&g=1", "display_name": "cthl", "link": "https://stackoverflow.com/users/3017656/cthl"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484069940, "post_id": 41574817, "comment_id": 70354713, "body": "@chux In that case we would have to pass quadruple pointers, right? @M. Baum: Are you sure that you really want to use 3D arrays in C? Unless the sizes <code>Nx,Ny</code> and <code>Nz</code> are known at compile time, the memory management can become very messy."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 409, "user_id": 3017656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/yoGZy.jpg?s=128&g=1", "display_name": "cthl", "link": "https://stackoverflow.com/users/3017656/cthl"}, "edited": false, "score": 0, "creation_date": 1484070043, "post_id": 41574817, "comment_id": 70354776, "body": "@cthl pass quadruple pointers would be one way to do it, though not that advisable.  A good answer needs more info from OP like the nature/use of <code>Ny, Nx, Nz</code> as you commented.  Without that detail, this is too broad."}, {"owner": {"reputation": 409, "user_id": 3017656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/yoGZy.jpg?s=128&g=1", "display_name": "cthl", "link": "https://stackoverflow.com/users/3017656/cthl"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484070206, "post_id": 41574817, "comment_id": 70354855, "body": "@chux Yes, the quadruple pointer is very poor, so my question was not fully serious. Allocating the arrays within the function might also be a bad idea, because then the allocation and deallocation happens at different levels of abstraction."}, {"owner": {"reputation": 494, "user_id": 5182786, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/da86a062a2f7ef545f3231d18cc7025b?s=128&d=identicon&r=PG&f=1", "display_name": "qsfzy", "link": "https://stackoverflow.com/users/5182786/qsfzy"}, "edited": false, "score": 0, "creation_date": 1484070305, "post_id": 41574817, "comment_id": 70354917, "body": "I&#39;m writing these functions to interface with a <code>Python</code> package. Each time they are called <code>Nx</code>, <code>Ny</code>, and <code>Nz</code> will be known. Seems like it will be easiest to pass references to the functions."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484070795, "post_id": 41574817, "comment_id": 70355210, "body": "@M.Baum Nice you described your code a bit in a comment.  Even better to <i>post</i> code in the question."}], "answers": [{"tags": [], "owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "is_accepted": false, "score": 1, "last_activity_date": 1484070194, "last_edit_date": 1484070194, "creation_date": 1484069782, "answer_id": 41574925, "question_id": 41574817, "link": "https://stackoverflow.com/questions/41574817/how-to-return-three-3d-arrays-in-c/41574925#41574925", "title": "How to return three 3d arrays in C?", "body": "<p>There is a couple of options :  </p>\n\n<ul>\n<li><p>Create a struct to hold those arrays and return it</p></li>\n<li><p>Pass pointers to those arrays and modify them without returning anything </p></li>\n<li><p>(Not elegant) Return array of those arrays</p></li>\n<li><p>(Not elegant) Make some global variables and modify them</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1329, "user_id": 1935941, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/04eae9ca4f0cd89c12996c97d486df9c?s=128&d=identicon&r=PG", "display_name": "Aatish Sai", "link": "https://stackoverflow.com/users/1935941/aatish-sai"}, "is_accepted": false, "score": 1, "last_activity_date": 1484069845, "creation_date": 1484069845, "answer_id": 41574952, "question_id": 41574817, "link": "https://stackoverflow.com/questions/41574817/how-to-return-three-3d-arrays-in-c/41574952#41574952", "title": "How to return three 3d arrays in C?", "body": "<p>There are two ways you can follow to return your arrays.</p>\n\n<ol>\n<li>Make a Structure with your three arrays and return the structure</li>\n<li>Pass the reference to the three arrays in the function.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 325, "user_id": 6882231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3b90aec2249238e8f6c8ff7df66ee2?s=128&d=identicon&r=PG&f=1", "display_name": "Dark Matter ", "link": "https://stackoverflow.com/users/6882231/dark-matter"}, "is_accepted": false, "score": 1, "last_activity_date": 1484070019, "creation_date": 1484070019, "answer_id": 41574999, "question_id": 41574817, "link": "https://stackoverflow.com/questions/41574817/how-to-return-three-3d-arrays-in-c/41574999#41574999", "title": "How to return three 3d arrays in C?", "body": "<p>You can't return more than one value at a time in C, so your choices are:<br>\n1) Access them globally.<br>\n2) Send references (pointers) into the function.<br>\n3) Make all three of them into one struct and return that.  </p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484070659, "post_id": 41575091, "comment_id": 70355129, "body": "NMDV, but <code>****</code> programming is not popular.  Certainly introducing <code>void *</code> does not help much either."}, {"owner": {"reputation": 1458, "user_id": 3643303, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sIpdl.jpg?s=128&g=1", "display_name": "Amber Beriwal", "link": "https://stackoverflow.com/users/3643303/amber-beriwal"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484070916, "post_id": 41575091, "comment_id": 70355297, "body": "@chux I know that <code>****</code> programming is not good and not preferred, but if we are dealing with 3D arrays, this is the option we have. Taking 1D array has two bad effects: 1. it requires complete memory chunk as one, which could be avoided in 3D pointers, 2. the index multiplication lies at user end which is more error prone than using array indices."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484071113, "post_id": 41575091, "comment_id": 70355409, "body": "To be clear &quot;NMDV&quot; is &quot;not-my-down-vote&quot;.  I am simply commenting per your <a href=\"http://stackoverflow.com/questions/41574817/how-to-return-three-3d-arrays-in-c/41575091?noredirect=1#comment70355106_41575091\">question</a>.  No need to address <a href=\"http://stackoverflow.com/questions/41574817/how-to-return-three-3d-arrays-in-c/41575091?noredirect=1#comment70355297_41575091\">your rational</a> to me.  Better to improve your post with your reasons as that allows the DVer to change the vote."}, {"owner": {"reputation": 1458, "user_id": 3643303, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sIpdl.jpg?s=128&g=1", "display_name": "Amber Beriwal", "link": "https://stackoverflow.com/users/3643303/amber-beriwal"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484071246, "post_id": 41575091, "comment_id": 70355495, "body": "@chux Sorry, if my above comment seems disturbing...but I already know the meaning of NMDV"}], "tags": [], "owner": {"reputation": 1458, "user_id": 3643303, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sIpdl.jpg?s=128&g=1", "display_name": "Amber Beriwal", "link": "https://stackoverflow.com/users/3643303/amber-beriwal"}, "is_accepted": false, "score": -1, "last_activity_date": 1484070305, "creation_date": 1484070305, "answer_id": 41575091, "question_id": 41574817, "link": "https://stackoverflow.com/questions/41574817/how-to-return-three-3d-arrays-in-c/41575091#41575091", "title": "How to return three 3d arrays in C?", "body": "<p>There could be multiple solutions:</p>\n\n<blockquote>\n  <p><strong>USING 4D-ARRAY RETURN</strong></p>\n</blockquote>\n\n<pre><code>double**** getArrays();\n</code></pre>\n\n<blockquote>\n  <p><strong>USING 4D-ARRAY OUTPUT PARAMETERS:</strong></p>\n</blockquote>\n\n<p><strong><em>Signature:</em></strong></p>\n\n<pre><code>void getArrays(double****, double****, double****)\n</code></pre>\n\n<p><strong><em>Calling:</em></strong></p>\n\n<pre><code>double*** array1 = NULL;\ndouble*** array2 = NULL;\ndouble*** array3 = NULL;\nvoid getArrays(&amp;array1, &amp;array2, &amp;array3)\n</code></pre>\n\n<blockquote>\n  <p><strong>USING Structure:</strong></p>\n</blockquote>\n\n<pre><code>typedef struct{\n  double*** array1;\n  double*** array2;\n  double*** array3;\n} MyStruct;\n\nMyStruct getArrays(); //prototype 1\nvoid getArrays(MyStruct*) //prototype 2\n</code></pre>\n\n<blockquote>\n  <p><strong>USING 2D VOID POINTER OUTPUT PARAMETERS: (if passing 4D parameters is not convenient)</strong></p>\n</blockquote>\n\n<p><strong><em>Signature:</em></strong></p>\n\n<pre><code>void getArrays(void**, void**, void**)\n</code></pre>\n\n<p><strong><em>Calling:</em></strong></p>\n\n<pre><code>void* array1 = NULL;\nvoid* array2 = NULL;\nvoid* array3 = NULL;\nvoid getArrays(&amp;array1, &amp;array2, &amp;array3)\ndouble*** ar1 = (double***)array1;\n...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484070598, "post_id": 41575134, "comment_id": 70355090, "body": "Minor: good to use <code>sizeof(double) * Nx * Ny * Nz</code> to insure <code>size_t</code> math in the multiplication.  <code>sizeof *fac_x  * Nx * Ny * Nz</code> is even better."}, {"owner": {"reputation": 1458, "user_id": 3643303, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sIpdl.jpg?s=128&g=1", "display_name": "Amber Beriwal", "link": "https://stackoverflow.com/users/3643303/amber-beriwal"}, "edited": false, "score": 0, "creation_date": 1484070703, "post_id": 41575134, "comment_id": 70355156, "body": "Using a single pointer, you are forcing it to allocate a single piece of memory chunk, whereas for 3D...it could be done in separate memory chunks."}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1484070834, "post_id": 41575134, "comment_id": 70355234, "body": "No it can&#39;t. C arrays must be contiguous in memory. You can use similar syntax to create arrays of pointers, but that&#39;s not what the OP is doing."}, {"owner": {"reputation": 1458, "user_id": 3643303, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sIpdl.jpg?s=128&g=1", "display_name": "Amber Beriwal", "link": "https://stackoverflow.com/users/3643303/amber-beriwal"}, "edited": false, "score": 0, "creation_date": 1484071036, "post_id": 41575134, "comment_id": 70355367, "body": "sorry..my bad..he is anyways using static arrays. So, this won&#39;t have any effect. unable to remove my downvote."}], "tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 1, "last_activity_date": 1484070485, "creation_date": 1484070485, "answer_id": 41575134, "question_id": 41574817, "link": "https://stackoverflow.com/questions/41574817/how-to-return-three-3d-arrays-in-c/41575134#41575134", "title": "How to return three 3d arrays in C?", "body": "<p>Do yourself a favour, and implement 3D arrays as</p>\n\n<pre><code>  double *fac_x = malloc(Nx * Ny * Nz * sizeof(double));\n\n  fac_x[z*Ny*Nx + y * Nx + x] = 123.0;\n</code></pre>\n\n<p>Now all the syntactical complications fall away. You still need to return three double *s, which entails taking double **s as parameters. That's tolerable. double **** parameters are not.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1484072800, "creation_date": 1484072800, "answer_id": 41575818, "question_id": 41574817, "link": "https://stackoverflow.com/questions/41574817/how-to-return-three-3d-arrays-in-c/41575818#41575818", "title": "How to return three 3d arrays in C?", "body": "<p>The only way to actually return an array is to return a structure or union type with that array as a member.  This involves copying the array contents, which could present an efficiency problem.  More importantly, however, this is viable only if the array dimensions (your <code>Nx</code>, <code>Ny</code>, and <code>Nz</code>) are compile-time constants.  Example:</p>\n\n<pre><code>#define Nx 5\n#define Ny 7\n#define Nz 10\n\nstruct arrays {\n    double fac_x[Ny][Nx][Nz];\n    double fac_y[Ny][Nx][Nz];\n    double fac_z[Ny][Nx][Nz];\n};\n\nstruct arrays foo() {\n    struct arrays rval;\n\n    // ... fill in the elements of rval ...\n\n    return rval;\n}\n</code></pre>\n\n<p>Otherwise, you cannot return arrays at all.  You could return a struct or array of pointers to the arrays or to their first elements (provided again that at least the last two dimensions are compile-time constants), but although that might serve your purpose, it is not the same thing.</p>\n\n<p>More importantly, the arrays you are declaring in your function have lifetime limited to the scope in which they are declared.  Although you can obtain and even return a pointers to or into them, <strong>such pointers will be invalid</strong> after the function returns.</p>\n\n<p>If you want to allocate space inside your function whose lifetime extends past the function's return, you need dynamic allocation via <code>malloc()</code> or <code>calloc()</code>.  Supposing that you want to give the caller access to the allocated space, I recommend using output parameters (pointers) to convey the information back.  Example:</p>\n\n<pre><code>int foo(unsigned Nx, unsigned Ny, unsigned Nz, double(*fac_x)[Nx][Nz],\n        double(*fac_y)[Nx][Nz], double(*fac_z)[Nx][Nz]) {\n    double (*tx)[Nx][Nz] = malloc(Ny * sizeof(*tx));\n\n    if (!tx) {\n        return -1;\n    }\n\n    double (*ty)[Nx][Nz] = malloc(Ny * sizeof(*ty));\n\n    if (!ty) {\n        free(tx);\n        return -1;\n    }\n\n    double (*tz)[Nx][Nz] = malloc(Ny * sizeof(*tz));\n\n    if (!tz) {\n        free(tx);\n        free(ty);\n        return -1;\n    }\n\n    // ... fill tx, ty, and tz ...\n\n    // supposing no errors have occurred:\n    fac_x = tx;\n    fac_y = ty;\n    fac_z = tz;\n    return 0;\n}\n</code></pre>\n\n<p>This would be called like so:</p>\n\n<pre><code>int caller(unsigned Nx, unsigned Ny, unsigned Nz) {\n    if (Nx == 0 || Ny == 0 || Nz == 0) {\n        // error: invalid dimensions\n        return -1;\n    }\n\n    // Note: these are pointers to arrays, not arrays themselves.\n    double (*fac_x)[Nx][Nz];\n    double (*fac_y)[Nx][Nz];\n    double (*fac_z)[Nx][Nz];\n\n    if (foo(Nx, Ny, Nz, fac_x, fac_y, fac_z)) {\n        // handle error ...\n    }\n\n    // We are now responsible for freeing fac_x, fac_y, and fac_z\n\n    // do stuff ... with fac_x[p][q][r], etc. ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 1, "last_activity_date": 1484073066, "creation_date": 1484073066, "answer_id": 41575885, "question_id": 41574817, "link": "https://stackoverflow.com/questions/41574817/how-to-return-three-3d-arrays-in-c/41575885#41575885", "title": "How to return three 3d arrays in C?", "body": "<p>Returning a non static array (1D, 2D or 3D) from a function results in troubles because those arrays haves local scope, you can use dynamic memory, in this case a pointer to a 3D array:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid *func(void)\n{\n    double (*ptr)[3][4][5] = calloc(3, sizeof *ptr);\n\n    if (ptr == NULL) {\n        perror(\"malloc\");\n        exit(EXIT_FAILURE);\n    }\n    ptr[0][0][0][0] = 1.1;\n    ptr[1][1][1][1] = 2.2;\n    ptr[2][2][2][2] = 3.3;\n    return ptr;\n}\n\nint main(void)\n{\n    double (*ptr)[3][4][5] = func();\n\n    printf(\"%f\\n\", ptr[0][0][0][0]);\n    printf(\"%f\\n\", ptr[1][1][1][1]);\n    printf(\"%f\\n\", ptr[2][2][2][2]);\n    free(ptr);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 494, "user_id": 5182786, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/da86a062a2f7ef545f3231d18cc7025b?s=128&d=identicon&r=PG&f=1", "display_name": "qsfzy", "link": "https://stackoverflow.com/users/5182786/qsfzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 7, "score": 1, "last_activity_date": 1484073066, "creation_date": 1484069448, "last_edit_date": 1484069615, "question_id": 41574817, "link": "https://stackoverflow.com/questions/41574817/how-to-return-three-3d-arrays-in-c", "title": "How to return three 3d arrays in C?", "body": "<p>I'm trying to write a <code>C</code> function to perform some vector calculations and generate three separate 3d <code>arrays</code>. I allocate the <code>arrays</code> at the beginning of the function</p>\n\n<pre><code>double fac_x[Ny][Nx][Nz];\ndouble fac_y[Ny][Nx][Nz];\ndouble fac_z[Ny][Nx][Nz];\n</code></pre>\n\n<p>then fill them in with calculated values.</p>\n\n<p>How can I return all three of these arrays? What does the function prototype need to look like?</p>\n"}, {"tags": ["mysql", "c"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1484067109, "post_id": 41574040, "comment_id": 70352846, "body": "From where are you running this code?  Is there a MySQL server running there?"}], "answers": [{"comments": [{"owner": {"reputation": 4590, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "edited": false, "score": 0, "creation_date": 1484067395, "post_id": 41574125, "comment_id": 70353041, "body": "OMG, OMG, OMG! Shame on me. For debugging reasons I moved the output few lines higher [before it worked]. I did not realize I changed the order. Yes, as Sheldon Cooper said: <b>I should not work after 9pm</b>. Thx!"}, {"owner": {"reputation": 71821, "user_id": 57191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1186a46e65dbea4c8900d524c613f926?s=128&d=identicon&r=PG", "display_name": "cwallenpoole", "link": "https://stackoverflow.com/users/57191/cwallenpoole"}, "reply_to_user": {"reputation": 4590, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "edited": false, "score": 0, "creation_date": 1484067481, "post_id": 41574125, "comment_id": 70353098, "body": "@AlBundy For the love of Pete! Change to <code>mysqli</code> before the boogey men get you!"}, {"owner": {"reputation": 4590, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "edited": false, "score": 0, "creation_date": 1484067577, "post_id": 41574125, "comment_id": 70353163, "body": "Hm, I am using the MySQL C Connector. There is only the <code>mysql</code> version. Where should be the <code>mysqli</code> version?"}], "tags": [], "owner": {"reputation": 71821, "user_id": 57191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1186a46e65dbea4c8900d524c613f926?s=128&d=identicon&r=PG", "display_name": "cwallenpoole", "link": "https://stackoverflow.com/users/57191/cwallenpoole"}, "is_accepted": true, "score": 1, "last_activity_date": 1484067249, "creation_date": 1484067249, "answer_id": 41574125, "question_id": 41574040, "link": "https://stackoverflow.com/questions/41574040/mysql-get-server-info-returns-null-but-everything-works-ok/41574125#41574125", "title": "mysql_get_server_info() returns NULL but everything works OK", "body": "<p><code>mysql_get_server_info</code> assumes that there is an existing connection to a MySQL server created earlier in the running process. You'd need to call <code>mysql_connect</code> first, if you want it to return anything.</p>\n\n<p>This is much easier to visualize (and more future proof) with <code>mysqli_get_server_info</code>, which takes an initialized <code>MySQLi</code> object as a parameter.</p>\n"}], "owner": {"reputation": 4590, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 41574125, "answer_count": 1, "score": 0, "last_activity_date": 1484067249, "creation_date": 1484066991, "question_id": 41574040, "link": "https://stackoverflow.com/questions/41574040/mysql-get-server-info-returns-null-but-everything-works-ok", "title": "mysql_get_server_info() returns NULL but everything works OK", "body": "<p>The title says it all. Calling <code>mysql_get_server_info</code> returns <code>(null)</code> but everything works fine.</p>\n\n<p><code>mysql_get_client_info()</code> returns the correct value: <code>6.1.6</code></p>\n\n<p>What can be the reason I don't receive the correct server information <code>5.7.17-log</code>?</p>\n"}, {"tags": ["c", "network-programming", "glib"], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 1401913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c51f5508d99562d68196e2d1bb5db443?s=128&d=identicon&r=PG", "display_name": "Stepan", "link": "https://stackoverflow.com/users/1401913/stepan"}, "is_accepted": false, "score": 1, "last_activity_date": 1484074966, "creation_date": 1484074966, "answer_id": 41576420, "question_id": 41573230, "link": "https://stackoverflow.com/questions/41573230/networkmanager-libnm-thread-safety/41576420#41576420", "title": "NetworkManager libnm thread safety", "body": "<p><a href=\"https://developer.gnome.org/libnm/stable/index.html\" rel=\"nofollow noreferrer\">libnm</a> is written using <a href=\"https://developer.gnome.org/glib/unstable/\" rel=\"nofollow noreferrer\">glib</a> and <a href=\"https://developer.gnome.org/gobject/unstable/\" rel=\"nofollow noreferrer\">gobject</a>. Although they don't seem to explicitly mention it in their doc, in general anything that uses glib runs on <a href=\"https://developer.gnome.org/glib/unstable/glib-The-Main-Event-Loop.html\" rel=\"nofollow noreferrer\">the main event loop</a> and expects that the API will only be called on the main event loop (ie: on the thread that the event loop runs on).</p>\n\n<p>Glib itself, however, is thread safe in general, or provides ways to ensure thread safety.  For example, to connect to signal of libnm, you can use <a href=\"https://developer.gnome.org/gobject/unstable/gobject-Signals.html#g-signal-connect\" rel=\"nofollow noreferrer\">g_signal_connect</a> from any thread; however the signal handler which you provide will be invoked on the thread running the main loop. Also, you can use something like <a href=\"https://developer.gnome.org/glib/stable/glib-The-Main-Event-Loop.html#g-idle-add\" rel=\"nofollow noreferrer\">g_idle_add</a> from any thread, in order to schedule a function to be called from the main event loop.</p>\n\n<p>You can also use the <a href=\"https://developer.gnome.org/gio/stable/GTask.html\" rel=\"nofollow noreferrer\">GTask</a> lib to help you with threading in glib. Thre is more info about the <a href=\"https://developer.gnome.org/programming-guidelines/unstable/main-contexts.html.en\" rel=\"nofollow noreferrer\">Glib main context here</a>.</p>\n"}], "owner": {"reputation": 369, "user_id": 7400340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6380568a3888fda9ed87f3e4f13ea4?s=128&d=identicon&r=PG&f=1", "display_name": "sdobak", "link": "https://stackoverflow.com/users/7400340/sdobak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1484077880, "creation_date": 1484064476, "last_edit_date": 1484077880, "question_id": 41573230, "link": "https://stackoverflow.com/questions/41573230/networkmanager-libnm-thread-safety", "title": "NetworkManager libnm thread safety", "body": "<p>I'm trying to use NetworkManager's libnm binding from a multithreaded program. Is libnm thread safe? I could not found any information about it.</p>\n"}, {"tags": ["c", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1484066873, "post_id": 41573020, "comment_id": 70352681, "body": "It is completely unclear what you actually intend to do, please provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 1, "creation_date": 1484078679, "post_id": 41573020, "comment_id": 70359597, "body": "In the first case you are making your pointer variable private. That means, each thread receives its private <b>uninitialised</b> copy of the pointer itself. This does not create private copies of what is being pointed to."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1484067115, "last_edit_date": 1484067115, "creation_date": 1484066714, "answer_id": 41573931, "question_id": 41573020, "link": "https://stackoverflow.com/questions/41573020/openmp-segfault-when-passing-private-variable-but-not-when-variable-is-declared/41573931#41573931", "title": "Openmp segfault when passing private variable but not when variable is declared within parallel region", "body": "<p>Your assertions about one code working and the other not are approximate at best.  In fact, <em>neither</em> code even compiles successfully as presented.  It seems virtually certain that the misbehavior reported in one case depends also on how variable <code>x</code> is used in the parallel section.</p>\n\n<p>With that said, if the only difference between the working and non-working code is the placement of the declaration of and assignment to <code>x</code>, as shown, then it is unsurprising that the version that assigns <code>x</code> outside the parallel region segfaults.  The OpenMP specs describe the private <code>x</code>s in scope in each thread running in the parallel region of your Case 1 this way:</p>\n\n<blockquote>\n  <p>A new list item of the same type, with automatic storage duration, is allocated for the construct. [...] <strong><em>The new list item is initialized, or has an undefined initial value, as if it had been locally declared without an initializer.</em></strong></p>\n</blockquote>\n\n<p>(from OpenMP 4.5, 2.15.3.3; emphasis added)</p>\n\n<p>That is, the local <code>x</code>s inside your parallel loop do not start with the value that the (separate) <code>x</code> outside the loop has.  Their initial values are indeterminate (per C for an automatic object declared without an initializer).  Using that initial value produces undefined behavior, which might very well manifest as a segmentation fault.</p>\n\n<p>You could fix this by allowing <code>x</code> to be shared, and using a different private variable in the parallel section, initialized from the shared <code>x</code>.  Something like this, for example:</p>\n\n<pre><code>x = (double *) malloc (solution * sizeof(double));\n#pragma omp parallel for\nfor (double *y = x; ...\n</code></pre>\n\n<p>(<code>x</code> is shared and <code>y</code> is private by default).  That serves the scenario where you want each thread to have a private <em>pointer</em> to the same shared space.</p>\n\n<p>Note, however, that the memory to which <code>x</code> points is shared no matter what.  If you want each thread to have its own, separate, dynamically-allocated space, then each one needs to allocate such space itself (and subsequently to free that space).  Even in that case that allocated space is technically shared, but if the threads do not publish any pointers to their allocated spaces then other threads will be unable to access them.</p>\n"}], "owner": {"reputation": 756, "user_id": 3963540, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c331beaac3186a94a522a77586937cfc?s=128&d=identicon&r=PG&f=1", "display_name": "Marouen", "link": "https://stackoverflow.com/users/3963540/marouen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 41573931, "answer_count": 1, "score": 0, "last_activity_date": 1484129576, "creation_date": 1484063906, "last_edit_date": 1484129576, "question_id": 41573020, "link": "https://stackoverflow.com/questions/41573020/openmp-segfault-when-passing-private-variable-but-not-when-variable-is-declared", "title": "Openmp segfault when passing private variable but not when variable is declared within parallel region", "body": "<p>The title says it all. When I declare array x outside the parallel region and pass it as a private variable to the threads, I get a segfault.\nWhen I declare the variable within the parallel region, everything works fine.\nI am interested in passing the variable as private rather than declaring it, hence I need help to debug the issue. \nHere is how it looks like:</p>\n\n<pre><code>//Case1 - doesn't work (segfault)\nx = (double *) malloc (solution * sizeof(double));\n#pragma omp parallel for private(x)\nfor...\n\n//Case2 - works\n#pragma omp parallel for \nfor...\n    x = (double *) malloc (solution * sizeof(double));\n</code></pre>\n\n<p>I am using 72 threads and I've set the KMP_STACKSIZE to 1m as well as</p>\n\n<pre><code>ulimit -s unlimited \n</code></pre>\n\n<p>UPDATE</p>\n\n<p>I still get the segfault despite John's suggestion. Here is the actual piece of code. I am actually using CPLEX optimisation library. I've also tried with memcpy for the private variable allocation.</p>\n\n<pre><code>#pragma omp parallel for private(i) shared(lp,env)\nfor(i=0;i&lt;n;i++){\n    CPXENVptr envi =env;\n    CPXLPptr    lpi = lp\n    CPXLpopt(envi,lpi);//this is where the segfault happens\n}\n</code></pre>\n\n<p>Worth noting the CPLXLpopt command changes the size of both envi and lpi variables/\nDo you recommend any debugger for openmp?</p>\n"}, {"tags": ["c", "assembly", "optimization", "x86", "x86-64"], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 3, "answer_count": 0, "score": 5, "last_activity_date": 1484063342, "creation_date": 1484063342, "question_id": 41572808, "link": "https://stackoverflow.com/questions/41572808/interlockedcompareexchange-optimization", "title": "_InterlockedCompareExchange optimization", "body": "<p>look at this code</p>\n\n<pre><code>extern \"C\" long _InterlockedCompareExchange(long volatile * _Destination, long _Exchange, long _Comparand);\n\n#define MAGIC 1\n\n// Unlike InterlockedIncrement this function not increment from 0 to 1, but return FALSE\n\nbool TryLock(long* pLock)\n{\n    long Value = *pLock, NewValue;\n\n    for ( ; Value; Value = NewValue)\n    {\n        NewValue = _InterlockedCompareExchange(pLock, Value + 1, Value);\n\n        if (\n#if MAGIC\n            NewValue == Value\n#else\n            Value == NewValue\n#endif\n            ) return true;\n    }\n\n    return false;\n}\n</code></pre>\n\n<p>are if set <code>#define MAGIC 0</code> something changed ? by idea must not be. but if using <code>CL.EXE</code> 64bit compiler if we change <code>NewValue == Value</code> to <code>Value == NewValue</code> (simply long values) - generated code serious changed!</p>\n\n<p>I try this with two version of <code>CL</code> - latest <code>19.00.24210.0</code> and with <code>14.00.50727.762</code> (more than 10 years old - December 2006) I got absolute equal code from both in all tests. compile with flags <code>cl /c /FA /O1</code> - so <code>/O1</code> optimization (same results with <code>/Oxs</code> )</p>\n\n<p>with <code>MAGIC 1</code> (<code>NewValue == Value</code>)</p>\n\n<pre><code>TryLock PROC\n    mov eax, [pLock]\n    jmp @@\n@@loop:\n    lea edx, [rax+1]\n    lock cmpxchg [pLock], edx\n    je  @@exit\n@@:\n    test    eax, eax\n    jne @@loop\n    ret\n@@exit:\n    mov al, 1\n    ret\nTryLock ENDP\n</code></pre>\n\n<p>but with <code>MAGIC 0</code> (<code>Value == NewValue</code>)</p>\n\n<pre><code>TryLock PROC\n    mov r8d, [pLock]\n    test    r8d, r8d\n    je  @@0\n@@loop:\n    lea edx, [r8+1]\n    mov eax, r8d\n    lock cmpxchg [pLock], edx\n    cmp r8d, eax        ; !!!!!!!!\n    je  @@exit\n    test    eax, eax\n    mov r8d, eax\n    jne @@loop\n@@0:\n    xor al, al\n    ret\n@@exit:\n    mov al, 1\n    ret\nTryLock ENDP\n</code></pre>\n\n<p>code become large, but main notable difference in instruction </p>\n\n<p><code>cmp Value, NewValue</code></p>\n\n<p>after <code>lock cmpxchg</code> in second variant. really <code>lock cmpxchg [p], NewValue</code> yourself set or reset <code>ZF</code> flag and additional <code>cmp Value, NewValue</code> become excess. we can omit it if we write in assembly, but on <code>c/c++</code> we have no way use <code>ZF</code> for condition branch. \nno statements like <code>ifzf { /* if ZF == 1 */ } else { /* if ZF == 0 */ }</code> as result we need write <code>if (NewValue == Value) {} else {}</code>\nand as result must be <code>cmp NewValue, Value</code> in generated assembly. but how i discovered for <code>CL</code> <code>x64</code> (but not for <code>x86</code> !) already 10+ years (think all versions) do next</p>\n\n<p>this code </p>\n\n<pre><code>NewValue = _InterlockedCompareExchange(p, fn(OldValue), OldValue);\nif (OldValue == NewValue) ...\n</code></pre>\n\n<p>converted to</p>\n\n<pre><code>mov eax, OldValue\nlock cmpxchg [p], fn(OldValue)\nmov NewValue, eax\ncmp OldValue, eax ; !!!!\njne @@\n....\n</code></pre>\n\n<p>but this code </p>\n\n<pre><code>NewValue = _InterlockedCompareExchange(p, fn(OldValue), OldValue);\nif (NewValue == OldValue) ...\n</code></pre>\n\n<p>converted to</p>\n\n<pre><code>mov eax, OldValue\nlock cmpxchg [p], fn(OldValue)\nmov NewValue, eax\njne @@\n...\n</code></pre>\n\n<p>so <code>CL</code> understand <code>cmpxchg</code> semantic and can do optimization, but only in some case.</p>\n\n<p>i test this feature in several test functions and everywhere got the same result for both (very old and new <code>CL</code> )</p>\n\n<pre><code>extern \"C\" long _InterlockedCompareExchange(long volatile * _Destination, long _Exchange, long _Comparand);\n\ntypedef long (*FN)(long* pLock, long Value);\n\n#define MAGIC 1\n\nvoid TestZF1(long* pLock)\n{\n    long Value = *pLock, NewValue;\n\n    do \n    {\n        Value++;\n        NewValue = _InterlockedCompareExchange(pLock, Value ^ 1, Value);\n    } while (\n#if MAGIC\n        NewValue != Value\n#else\n        Value != NewValue\n#endif\n        );\n}\n\nlong TestZF2(long* pLock, FN fn1, FN fn2)\n{\n    long Value = *pLock, NewValue;\n\n    NewValue = _InterlockedCompareExchange(pLock, Value ^ 1, Value);\n\n    return (\n#if MAGIC\n        NewValue == Value\n#else\n        Value == NewValue\n#endif\n        ? fn1 : fn2) (pLock, NewValue);\n}\n</code></pre>\n\n<p>and generated assembly:</p>\n\n<pre><code>TestZF1 PROC\n    mov r8d, DWORD PTR [rcx]\n@@loop:\n    add r8d, 1\n    mov edx, r8d\n    mov eax, r8d\n    xor edx, 1\n    lock cmpxchg [rcx], edx\nIF !MAGIC\n    cmp r8d,eax     ; ! in TestZF1 different exactly in this instruction\nENDIF\n    jne @@loop\n    ret 0\nTestZF1 ENDP\n\nIF MAGIC\n\nTestZF2 PROC\n    mov r9d, [rcx]\n    mov eax, [rcx]\n    xor r9d, 1\n    lock cmpxchg [rcx], r9d\n    cmove   r8, rdx\n    mov edx, eax\n    jmp r8\nTestZF2 ENDP\n\nELSE\n\nTestZF2 PROC\n    mov r10d, [rcx]\n    mov r9d, r10d\n    xor r9d, 1\n    mov eax, r10d\n    lock cmpxchg [rcx], r9d\n    cmp r10d, eax   ; !!!!!!!!\n    cmove   r8, rdx     \n    mov edx, eax\n    jmp r8\nTestZF2 ENDP\n\nENDIF\n</code></pre>\n\n<p>several questions:</p>\n\n<ul>\n<li>why <code>CL</code> <code>x64</code> optimize case <code>if (NewValue == Value)</code> but not\noptimize <code>if (Value == NewValue)</code> ?</li>\n<li>this is consciously, specially designed, or it was suddenly and\nunknown ?</li>\n<li>why <code>CL</code> <code>x86</code> not do this optimization ? how minimum in all my tests\n<code>cmp Value,NewValue</code> instruction exist</li>\n<li>are possible write code on <code>c/c++</code> ,without assembler, for implement\nthis on x86 with <code>CL</code> ?</li>\n<li>interesting - are another <code>c/c++</code> compilers have this kind of\noptimization for <code>_InterlockedCompareExchange[Pointer]</code> ?</li>\n</ul>\n"}, {"tags": ["c", "string", "fgets", "string-length"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1484063216, "post_id": 41572713, "comment_id": 70350114, "body": "What about the man-page of <code>fgets</code> is unclear? Did you inspect the array after the function in your debugger? What did you find at the end of the string?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1484063230, "post_id": 41572713, "comment_id": 70350128, "body": "<code>fgets()</code> includes the newline in the input \u2014 if it reads the newline."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1484063308, "post_id": 41572713, "comment_id": 70350185, "body": "...and after the name your output moves to <b>next line</b>..."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1484063332, "post_id": 41572713, "comment_id": 70350205, "body": "<code>strlen</code> return <code>size_t</code> so use <code>%zu</code> as format specifier"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1484066214, "post_id": 41572713, "comment_id": 70352213, "body": "Look closely at what your code prints and you will see a line break after the four letters you entered had been printed. This new-line is the 5th element: <code>\\n</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484066977, "post_id": 41572713, "comment_id": 70352765, "body": "&quot;I enter 4 letters&quot; --&gt; Hint: you typed 5 keys."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1484067262, "post_id": 41572713, "comment_id": 70352955, "body": "<code>fgets</code> also returns <code>NULL</code> on failure, which you are not checking."}], "answers": [{"tags": [], "owner": {"reputation": 21474, "user_id": 718379, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4810c6c963334e5dce573e6671d746ec?s=128&d=identicon&r=PG", "display_name": "timrau", "link": "https://stackoverflow.com/users/718379/timrau"}, "is_accepted": false, "score": 1, "last_activity_date": 1484063186, "creation_date": 1484063186, "answer_id": 41572757, "question_id": 41572713, "link": "https://stackoverflow.com/questions/41572713/string-length-with-fgets-function-in-c/41572757#41572757", "title": "string length with fgets function in C", "body": "<p>Because the end of line character <code>'\\n'</code> is included in the string copied into <code>name</code> by <code>fgets()</code> .</p>\n"}, {"comments": [{"owner": {"reputation": 225, "user_id": 7182122, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/de372f08e078fcbcf70271dcd8818872?s=128&d=identicon&r=PG&f=1", "display_name": "Raz Omry", "link": "https://stackoverflow.com/users/7182122/raz-omry"}, "edited": false, "score": 0, "creation_date": 1484063824, "post_id": 41572823, "comment_id": 70350553, "body": "so how can I get the string without the new line that it adds (delete the `&#39;\\n&#39; if the function adds it?)"}, {"owner": {"reputation": 1155, "user_id": 5986252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cabd17a359de6510f3f774ab5975f9a?s=128&d=identicon&r=PG&f=1", "display_name": "jgorostegui", "link": "https://stackoverflow.com/users/5986252/jgorostegui"}, "reply_to_user": {"reputation": 225, "user_id": 7182122, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/de372f08e078fcbcf70271dcd8818872?s=128&d=identicon&r=PG&f=1", "display_name": "Raz Omry", "link": "https://stackoverflow.com/users/7182122/raz-omry"}, "edited": false, "score": 0, "creation_date": 1484065500, "post_id": 41572823, "comment_id": 70351763, "body": "I&#39;ve updated the answer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484067034, "post_id": 41572823, "comment_id": 70352799, "body": "See <a href=\"http://stackoverflow.com/questions/41572713/string-length-with-fgets-function-in-c#comment70350205_41572713\">@LPs  %zu</a>"}], "tags": [], "owner": {"reputation": 1155, "user_id": 5986252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cabd17a359de6510f3f774ab5975f9a?s=128&d=identicon&r=PG&f=1", "display_name": "jgorostegui", "link": "https://stackoverflow.com/users/5986252/jgorostegui"}, "is_accepted": false, "score": 4, "last_activity_date": 1484065469, "last_edit_date": 1495540909, "creation_date": 1484063366, "answer_id": 41572823, "question_id": 41572713, "link": "https://stackoverflow.com/questions/41572713/string-length-with-fgets-function-in-c/41572823#41572823", "title": "string length with fgets function in C", "body": "<p>From fgets manual page (<a href=\"https://linux.die.net/man/3/fgets\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/fgets</a>):</p>\n\n<blockquote>\n  <p>fgets() reads in at most one less than size characters from stream and\n  stores them into the buffer pointed to by s. Reading stops after an\n  EOF or a newline. If a newline is read, it is stored into the buffer.\n  A terminating null byte (aq\\0aq) is stored after the last character in\n  the buffer.</p>\n</blockquote>\n\n<p>So it adds <code>'\\n'</code> after your 4 letters, returning <code>string_length+1</code>.</p>\n\n<p>From <a href=\"https://stackoverflow.com/questions/2693776/removing-trailing-newline-character-from-fgets-input\">Removing trailing newline character from fgets() input</a> you can add @Tim \u010cas solution to your code.</p>\n\n<p>The line is still read with the <code>fgets()</code> function and after we remove the newline character.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\nint main(void)\n{\n    char name[10] = { 0 };\n    printf(\"enter your name\\n\");\n    fgets(name, 10, stdin);\n    printf(\"your name is %s and it is %d letters\\n\", name, strlen(name)); // length problem \n    name[strcspn(name, \"\\n\")] = 0;\n    printf(\"NEW - your name is %s and it is %d letters\\n\", name, strlen(name));\n    return 0;\n}\n</code></pre>\n\n<p>That outputs:</p>\n\n<pre><code>enter your name\nAndy\nyour name is Andy\n and it is 5 letters\nNEW - your name is Andy and it is 4 letters\nPress any key to continue . . .\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1484063592, "creation_date": 1484063592, "answer_id": 41572897, "question_id": 41572713, "link": "https://stackoverflow.com/questions/41572713/string-length-with-fgets-function-in-c/41572897#41572897", "title": "string length with fgets function in C", "body": "<p>If character array has enough space then the standard function <code>fgets</code> also includes the new line character in the array that usually corresponds to the entered key Enter.</p>\n\n<p>You can remove this redundant new line character the following way</p>\n\n<pre><code>name[strcspn( name, \"\\n\" )] = '\\0';\n</code></pre>\n\n<p>after that you will get the expected result of applying function <code>strlen</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1484066336, "post_id": 41573185, "comment_id": 70352283, "body": "&quot;<i>It can never go wrong!</i>&quot; sure, as its a machine, but it still can be <i>used</i> wrongly. Imaging using as pointer instead of an array: <code>char * readstr(char * p) { return fgets(p, sizeof p, stdin); }</code> would (on most systems) try to read 4 or 8 <code>char</code>s."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484066831, "post_id": 41573185, "comment_id": 70352652, "body": "&quot;It can never go wrong!&quot;  --&gt; note that <code>sizeof</code> returns type <code>size_t</code>, yet <code>fgets(char * s, int n, FILE *  stream)</code> uses an <code>int</code> for the size.  With huge arrays, this may convert unexpectantly.  Certainly rare, but not <i>never</i>."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1484067404, "post_id": 41573185, "comment_id": 70353051, "body": "How do you know it can never go wrong if you don&#39;t check it&#39;s return value? <code>fgets</code> can return <code>NULL</code> from <code>stdin</code> if <code>EOF</code> is encountered."}, {"owner": {"reputation": 1016, "user_id": 5788276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OHVtt.jpg?s=128&g=1", "display_name": "Pejman", "link": "https://stackoverflow.com/users/5788276/pejman"}, "edited": false, "score": 0, "creation_date": 1484068153, "post_id": 41573185, "comment_id": 70353576, "body": "I am merely suggesting OP to pass sizeof(name) instead of 10 to <code>fgets</code>. It can always go wrong when things are taken out of context. Thanks for the comments. updated the answer."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1484070273, "post_id": 41573185, "comment_id": 70354896, "body": "@PejmanGh I&#39;m sorry if I sounded rude. Up vote from me :)."}], "tags": [], "owner": {"reputation": 1016, "user_id": 5788276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OHVtt.jpg?s=128&g=1", "display_name": "Pejman", "link": "https://stackoverflow.com/users/5788276/pejman"}, "is_accepted": false, "score": 1, "last_activity_date": 1484068264, "last_edit_date": 1484068264, "creation_date": 1484064355, "answer_id": 41573185, "question_id": 41572713, "link": "https://stackoverflow.com/questions/41572713/string-length-with-fgets-function-in-c/41573185#41573185", "title": "string length with fgets function in C", "body": "<p>As is written in <code>man fgets</code>,</p>\n\n<blockquote>\n  <p>The fgets() function reads at most one less than the number of characters\n       specified by size from the given stream and stores them in the string\n       str.  Reading stops when a newline character is found, at end-of-file or\n       error.  The newline, if any, is retained.  If any characters are read and\n       there is no error, a `\\0' character is appended to end the string.</p>\n</blockquote>\n\n<p>Since you are reading from <code>stdin</code>, <code>fgets(name, 10, stdin)</code> reads at most 9 characters from stdin buffer and appends <code>\\0</code> to the end. It just happens that the new line character <code>\\n</code> produced when user hit enter is in the buffer too.</p>\n\n<p>As a sidenote, it is customary (and a good practice) to use <code>sizeof()</code> when specifying size of the array passed to <code>fgets</code>.</p>\n\n<pre><code>fgets(name, (int) sizeof(name), stdin);\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 7182122, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/de372f08e078fcbcf70271dcd8818872?s=128&d=identicon&r=PG&f=1", "display_name": "Raz Omry", "link": "https://stackoverflow.com/users/7182122/raz-omry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13935, "favorite_count": 1, "closed_date": 1484066840, "answer_count": 4, "score": 1, "last_activity_date": 1484068264, "creation_date": 1484063070, "question_id": 41572713, "link": "https://stackoverflow.com/questions/41572713/string-length-with-fgets-function-in-c", "closed_reason": "Duplicate", "title": "string length with fgets function in C", "body": "<p>I have a problem. I've tried to see the length of some string after using fgets function. If I enter string under the number of letter which can be in the string (like: the maximum letters in string is 9 and I enter 4 letters), I get length of the string+1. why?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    char name[10]={0};\n    printf(\"enter your name\\n\");\n    fgets(name, 10, stdin);\n    printf(\"your name is %s and it is %d letters\\n\", name, strlen(name)); // length problem \n\n    return 0;\n} \n</code></pre>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 1, "creation_date": 1484062857, "post_id": 41572572, "comment_id": 70349892, "body": "Yes, indeed you can."}], "answers": [{"comments": [{"owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "edited": false, "score": 0, "creation_date": 1484063199, "post_id": 41572711, "comment_id": 70350098, "body": "&quot;As long as you only have one thread operating on server_socket at a time, you can safely call accept on that socket in a thread&quot; - well this is my point. with fork() you can have several accept()&#39;s in parallel from different children. Single connection is always accepted from single child. And no two children accept same connection. I will edit now."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1484063069, "creation_date": 1484063069, "answer_id": 41572711, "question_id": 41572572, "link": "https://stackoverflow.com/questions/41572572/can-i-accept-inside-a-thread/41572711#41572711", "title": "Can I accept() inside a thread", "body": "<p>As long as you only have one thread operating on <code>server_socket</code> at a time, you can safely call <code>accept</code> on that socket in a thread.</p>\n\n<p>You'll most likely want one thread that calls <code>accept</code> to get new connections, and multiple worker threads that can each handle a connection.  The best way to handle this it to create a number of worker threads at startup and have a queue of connections for each one, each with an associated mutex.   </p>\n\n<p>The accepting thread will choose one of the workers to handle a new connection.  It then locks the mutex for that worker's queue, places the connection on the queue, and unlocks.  Each worker can then lock the mutex for its queue, retrieve a connection from the queue, unlock, then process the connection.</p>\n"}], "owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "closed_date": 1484063206, "answer_count": 1, "score": 0, "last_activity_date": 1484063457, "creation_date": 1484062664, "last_edit_date": 1484063457, "question_id": 41572572, "link": "https://stackoverflow.com/questions/41572572/can-i-accept-inside-a-thread", "closed_reason": "Duplicate", "title": "Can I accept() inside a thread", "body": "<p>I had simple web server that <code>fork()</code> and use <code>accept()</code> inside child process.</p>\n\n<p>Here is pseudo-code:</p>\n\n<pre><code>void server_child_process(int server_socket){\n    // ...\n\n    while (true){\n        if ( ( client = accept(server_socket, addr, addrlen) ) == false ){\n            server_debug(\"Can not socket_accept()...\");\n        }\n        //...\n    }\n}\n</code></pre>\n\n<p><code>accept()</code> seems to have no problem and no need for any synchronization.</p>\n\n<p>With <code>fork()</code> model you can have several <code>accept()</code> at the same time. Single connection is always accepted once from single random child process.<br>\n(e.g. no connection is accepted from two children)</p>\n\n<p>This model is often called pre-fork, because theoretically after initial <code>fork()</code> no new <code>fork()</code> are made.</p>\n\n<p>Can I do the same in a thread?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1484060960, "post_id": 41571939, "comment_id": 70348580, "body": "Do you mean output all elements that are <i>in common</i> between the two arrays? In your description you say &quot;different elements&quot; but in your example you output the elements that are the same in the arrays."}, {"owner": {"reputation": 113, "user_id": 7214316, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1169686309792072/picture?type=large", "display_name": "Nikita Gusev", "link": "https://stackoverflow.com/users/7214316/nikita-gusev"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1484061233, "post_id": 41571939, "comment_id": 70348777, "body": "@GovindParmar SORRY!!!!! I&#39;ve edited"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484061452, "post_id": 41571939, "comment_id": 70348909, "body": "Do you have any other constraints of the arrays? All integers can appear as values?"}, {"owner": {"reputation": 113, "user_id": 7214316, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1169686309792072/picture?type=large", "display_name": "Nikita Gusev", "link": "https://stackoverflow.com/users/7214316/nikita-gusev"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1484061507, "post_id": 41571939, "comment_id": 70348957, "body": "@StoryTeller no, that is it."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484061835, "post_id": 41571939, "comment_id": 70349198, "body": "For debugging this, you should hard code your test case, so you don&#39;t need to type the input on each run."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1484062354, "post_id": 41571939, "comment_id": 70349567, "body": "You should always check result of <code>scanf()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "is_accepted": false, "score": 1, "last_activity_date": 1484061518, "creation_date": 1484061518, "answer_id": 41572176, "question_id": 41571939, "link": "https://stackoverflow.com/questions/41571939/output-different-elements-from-two-arrays/41572176#41572176", "title": "output different elements from two arrays", "body": "<p>You are on the right path. You are taking each value from the first array and comparing to each value in the second.</p>\n\n<p>What you need to do now is to only print <code>a[i]</code> if there isn't any <code>b[j]</code> such that they are the same. The easiest  way is to set a flag (say, <code>unique=1</code>). You can give this flag any name you find suitable, but in this case I'm thinking it says that the number <code>a[i]</code> is \"unique\" to the array <code>a</code>. So in this case you start with the premise that, yes, you won't find <code>a[i]</code> in the array<code>b</code>, and then you try to disprove your assumption. If at any time of you search you find an instance of <code>a[i] == b[j]</code>, then your premise was wrong, so you set <code>unique=0</code>.</p>\n\n<p>After you have compared this <code>a[i]</code> against all elements in <code>b</code>, you review your flag. And you print the appropriate message depending on whether you found this element in <code>b</code> or not.</p>\n\n<p>Note that this assumes that the same value doesn't appear twice in <code>a</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 7214316, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1169686309792072/picture?type=large", "display_name": "Nikita Gusev", "link": "https://stackoverflow.com/users/7214316/nikita-gusev"}, "edited": false, "score": 1, "creation_date": 1484062204, "post_id": 41572256, "comment_id": 70349452, "body": "Thank for your help, i think i was close to you, but i couldnt think to it. Thank you one more time!"}], "tags": [], "owner": {"reputation": 177, "user_id": 3952575, "user_type": "registered", "profile_image": "https://graph.facebook.com/1015977953/picture?type=large", "display_name": "ffguven", "link": "https://stackoverflow.com/users/3952575/ffguven"}, "is_accepted": false, "score": 0, "last_activity_date": 1484061729, "creation_date": 1484061729, "answer_id": 41572256, "question_id": 41571939, "link": "https://stackoverflow.com/questions/41571939/output-different-elements-from-two-arrays/41572256#41572256", "title": "output different elements from two arrays", "body": "<p>I have edited your code a little bit and this code gives you desired output:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void){\n        int a[10],b[10],c,n,i,j;\n        int counter=0;\n        printf(\"enter a number: \");\n        scanf(\"%d\",&amp;n);\n        for(i=0;i&lt;n;i++){\n                printf(\"Enter a[%d]: \\n\",i+1);\n                scanf(\"%d\",&amp;a[i]);\n        }\n        printf(\"\\n\");\n        for(j=0;j&lt;n;j++){\n                printf(\"Enter b[%d]: \\n\",j+1);\n                scanf(\"%d\",&amp;b[j]);\n        }\n        for(i=0;i&lt;n;i++){\n                counter=0;\n                for(j=0;j&lt;n;j++){\n                        if(a[i]!=b[j]){\n                                counter++;\n                        }\n                }\n                if(counter == n){\n                        printf(\"%d \",a[i]);\n                }\n        }\n        return 0;\n}\n</code></pre>\n\n<p>Let's explain this code a little bit:\nIn the last nested for loop, outer loop takes one element from array a. Inner loop gets every element of array b in order to compare it to taken element from array a. If none of the elements of array b is equal to a's taken element, counter will be equal to n(array size). Then we can print this element taken from a(it means there is no match between this taken element and array b's all of elements.</p>\n"}, {"comments": [{"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1484061965, "post_id": 41572262, "comment_id": 70349271, "body": "<code>O((m+n)*log(n))</code> to include the time for sorting"}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1484065365, "post_id": 41572262, "comment_id": 70351660, "body": "Nice answer, I wrote some code in one of the answers to test this out. Definitely a very efficient approach."}, {"owner": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "edited": false, "score": 0, "creation_date": 1484072305, "post_id": 41572262, "comment_id": 70356028, "body": "If you are going to sort, then it&#39;s best to sort both. For instance, sort both descending. If <code>a[i]&lt;b[j]</code>, you won&#39;t find any other <code>a[k]&gt;a[i]</code> such that <code>a[k]==b[j]</code>, so you can exclude the possibility of having <code>b[j]</code> in <code>a</code>. If <code>a[i]&gt;b[j]</code>, then you can exclude the possibility of having <code>a[i]</code> in <code>b</code>. The Big-O is the same, but now you traverse both arrays sequentially."}], "tags": [], "owner": {"reputation": 7400, "user_id": 4391177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zEh1N.jpg?s=128&g=1", "display_name": "Sumeet", "link": "https://stackoverflow.com/users/4391177/sumeet"}, "is_accepted": false, "score": 4, "last_activity_date": 1484061745, "creation_date": 1484061745, "answer_id": 41572262, "question_id": 41571939, "link": "https://stackoverflow.com/questions/41571939/output-different-elements-from-two-arrays/41572262#41572262", "title": "output different elements from two arrays", "body": "<p>This can be easily solved using <strong>Binary search</strong>. Follow the simple steps.</p>\n\n<p><strong>Step 1</strong>: Sort the second array.</p>\n\n<p><strong>Step 2</strong>: For each element of the first array, binary search it in the second array, if its not present , print it, otherwise dont.</p>\n\n<p>The time complexity is <strong>O(m log n)</strong>, where <code>m</code> is length of first array and <code>n</code> is length of second array.</p>\n"}, {"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": true, "score": 2, "last_activity_date": 1484066154, "last_edit_date": 1484066154, "creation_date": 1484064820, "answer_id": 41573321, "question_id": 41571939, "link": "https://stackoverflow.com/questions/41571939/output-different-elements-from-two-arrays/41573321#41573321", "title": "output different elements from two arrays", "body": "<p>If you want a more efficient solution, as suggested by @Sumeet Singh, you can sort the second array with <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_qsort.htm\" rel=\"nofollow noreferrer\"><code>qsort</code></a>, then  find similar elements from the first array with <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_bsearch.htm\" rel=\"nofollow noreferrer\"><code>bsearch</code></a>(binary search). </p>\n\n<p>Your current solution is <strong>O(N^2)</strong> time, which will be very slow with large <code>n</code>, but you can achieve more efficiency with this approach.</p>\n\n<p>Here is some code I wrote up with demonstrates this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define NNUMBERS 10\n\nvoid get_array_input(int array1[], int array2[], size_t *n);\nvoid search_elements(int array1[], int array2[], size_t n);\nvoid print_arrays(int array[], size_t n);\nint cmp_func(const void *a, const void *b);\n\nint main(void) {\n    int array1[NNUMBERS], array2[NNUMBERS];\n    size_t n;\n\n    /* input from user */\n    get_array_input(array1, array2, &amp;n);\n\n    printf(\"\\nFirst array: \");\n    print_arrays(array1, n);\n\n    printf(\"\\nSecond array: \");\n    print_arrays(array2, n);\n\n    /* sorting the second array */\n    qsort(array2, n, sizeof(*array2), cmp_func);\n\n    printf(\"\\nSorted Second array: \");\n    print_arrays(array2, n);\n\n    /* the search begins */\n    search_elements(array1, array2, n);\n\n    return 0;\n}\n\nvoid get_array_input(int array1[], int array2[], size_t *n) {\n    size_t i;\n\n    printf(\"Enter n: \");\n    if (scanf(\"%zu\", n) != 1) {\n        printf(\"Invalid n value.\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    for (i = 0; i &lt; *n; i++) {\n        printf(\"Enter array1[%zu]: \", i);\n        if (scanf(\"%d\", &amp;array1[i]) != 1) {\n            printf(\"Invalud array value.\\n\");\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    for (i = 0; i &lt; *n; i++) {\n        printf(\"Enter array2[%zu]: \", i);\n        if (scanf(\"%d\", &amp;array2[i]) != 1) {\n            printf(\"Invalud array value.\\n\");\n            exit(EXIT_FAILURE);\n        }\n    }\n}\n\nvoid search_elements(int array1[], int array2[], size_t n) {\n    size_t i;\n    void *key;\n\n    printf(\"\\nElements in first array which are not in second array: \");\n    for (i = 0; i &lt; n; i++) {\n        key = bsearch(&amp;array1[i], array2, n, sizeof(*array2), cmp_func);\n        if (!key) {\n            printf(\"%d \", array1[i]); /* not found, so print it */\n        }\n    }\n    printf(\"\\n\");\n}\n\nvoid print_arrays(int array[], size_t n) {\n    size_t i;\n\n    for (i = 0; i &lt; n; i++) {\n        printf(\"%d \", array[i]);\n    }\n    printf(\"\\n\");\n}\n\n/* cmp function needed for qsort and bsearch */\n/* many ways to write these */\nint cmp_func(const void *a, const void *b) {\n    const int *num1 = (const int *)a;\n    const int *num2 = (const int *)b;\n\n    if (*num1 &gt; *num2) {\n        return +1;\n    } else if (*num1 &lt; *num2) {\n        return -1;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Input:</p>\n\n<pre><code>Enter n: 3\nEnter array1[0]: 9\nEnter array1[1]: 0\nEnter array1[2]: 1\nEnter array2[0]: 0\nEnter array2[1]: 8\nEnter array2[2]: 1\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>First array: 9 0 1\n\nSecond array: 0 8 1\n\nSorted Second array: 0 1 8\n\nElements in first array which are not in second array: 9\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7214316, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1169686309792072/picture?type=large", "display_name": "Nikita Gusev", "link": "https://stackoverflow.com/users/7214316/nikita-gusev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 41573321, "answer_count": 4, "score": 4, "last_activity_date": 1484066154, "creation_date": 1484060721, "last_edit_date": 1484061605, "question_id": 41571939, "link": "https://stackoverflow.com/questions/41571939/output-different-elements-from-two-arrays", "title": "output different elements from two arrays", "body": "<p>I am trying to output different elements from two arrays. So if i have an array A: <code>{9, 0, 1}</code> and B is <code>{0, 8, 1}</code>, I need to output an element which included in the first set, but are not included in the second :<code>9</code> Can not think how I should compare all elements from the first array with the second one. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int a[10],b[10],c,n,i,j;\n\n    printf(\"enter a number: \");\n    scanf(\"%d\",&amp;n);\n    for(i=0;i&lt;n;i++){\n    printf(\"Enter a[%d]: \",i+1);\n    scanf(\"%d\",&amp;a[i]);\n    }\n    printf(\"\\n\");\n    for(j=0;j&lt;n;j++){\n    printf(\"Enter b[%d]: \",j+1);\n    scanf(\"%d\",&amp;b[j]);\n    }\n\n    for (i = 0; i &lt; n; i++) {\n            printf(\"%d \", a[i]); }\n\n            printf(\"\\n\");\n\n    for (i = 0; i &lt; n; i++) {\n            printf(\"%d \", b[i]); }\n            printf(\"\\n\");\n\nreturn 0;\n}\n</code></pre>\n\n<p>I'd like to show my thoughts but i think it's stupid:</p>\n\n<pre><code> for(i=0;i&lt;n;i++){\n        for(j=0;j&lt;n;j++){\n            if(a[i]!= b[j]){\n                c=a[i];\n            }\n        }\n    printf(\"%d \",c);\n    }\n</code></pre>\n"}, {"tags": ["c", "sockets", "tcp"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1484061749, "post_id": 41571910, "comment_id": 70349139, "body": "This &quot;<i>while closing newClientFd in server side like this <code>cannot assign requested address</code></i>&quot; reads like a misdiagnosis to me."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1484061773, "post_id": 41571910, "comment_id": 70349156, "body": "This code does not compile.  Post the <b>exact</b> code that generate the error."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1484067531, "post_id": 41571910, "comment_id": 70353136, "body": "Maybe the port identified by CLI_UTIL_PORT_NUM is already in use.  Since the value isn&#39;t shown, it&#39;s hard to know.  If that&#39;s a port number less than 1024, you may not have the relevant privileges to use the port."}, {"owner": {"reputation": 11, "user_id": 7036555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QNH8PtoPcPI/AAAAAAAAAAI/AAAAAAAAADk/6lHneqcLG7I/photo.jpg?sz=128", "display_name": "Krishna murthy Setty", "link": "https://stackoverflow.com/users/7036555/krishna-murthy-setty"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1484113457, "post_id": 41571910, "comment_id": 70371410, "body": "@alk while server and client running i am closing client side like ctrl+c or terminal exit i have added perror before closing the newClientFd in server side then i am getting &quot;cannot assign requested address&quot; in server side."}, {"owner": {"reputation": 11, "user_id": 7036555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QNH8PtoPcPI/AAAAAAAAAAI/AAAAAAAAADk/6lHneqcLG7I/photo.jpg?sz=128", "display_name": "Krishna murthy Setty", "link": "https://stackoverflow.com/users/7036555/krishna-murthy-setty"}, "edited": false, "score": 0, "creation_date": 1484113565, "post_id": 41571910, "comment_id": 70371444, "body": "i just want to know how to resolve it.........."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1484114396, "post_id": 41571910, "comment_id": 70371761, "body": "You should only call <code>perror()</code> if an error occurred <i>and</i> <code>errno</code> had been set, else <code>perror()</code> prints a &quot;random&quot;-message. Recommended reading: <code>man errno</code>, <code>man perror</code>, as well as the man-pages of any function call the code use, in this context especially their <code>RETURN VALUE</code> and <code>ERRORS</code> sections."}, {"owner": {"reputation": 11, "user_id": 7036555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QNH8PtoPcPI/AAAAAAAAAAI/AAAAAAAAADk/6lHneqcLG7I/photo.jpg?sz=128", "display_name": "Krishna murthy Setty", "link": "https://stackoverflow.com/users/7036555/krishna-murthy-setty"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1484203500, "post_id": 41571910, "comment_id": 70415240, "body": "@alk if i didnt call perror() the server get crashes."}], "owner": {"reputation": 11, "user_id": 7036555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QNH8PtoPcPI/AAAAAAAAAAI/AAAAAAAAADk/6lHneqcLG7I/photo.jpg?sz=128", "display_name": "Krishna murthy Setty", "link": "https://stackoverflow.com/users/7036555/krishna-murthy-setty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "closed_date": 1484067587, "answer_count": 0, "score": 0, "last_activity_date": 1484061226, "creation_date": 1484060622, "last_edit_date": 1484061226, "question_id": 41571910, "link": "https://stackoverflow.com/questions/41571910/error-cannot-assign-requested-address", "closed_reason": "Duplicate", "title": "Error: Cannot assign requested address", "body": "<p>I am creating socket communication through TCP.</p>\n\n<p>If I close client side I am getting an error while closing <code>newClientFd</code> in server side like this</p>\n\n<pre><code>cannot assign requested address\n</code></pre>\n\n<p>Here is the server code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/select.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\nint main()\n{\n    int retCode = 0;\n    struct sockaddr_in servAddr;\n\n    pipe(cliPipe);\n    serverFd = socket(AF_INET, SOCK_STREAM, 0);\n    if(-1 == serverFd)\n    {\n        retCode = -1;\n    }\n    else\n    {\n        mem_memset(&amp;servAddr, '\\0', sizeof(servAddr));\n        servAddr.sin_family = AF_INET;\n        servAddr.sin_addr.s_addr = htonl(INADDR_ANY);\n        servAddr.sin_port = htons(CLI_UTIL_PORT_NUM);\n        if (setsockopt(serverFd, SOL_SOCKET, SO_REUSEADDR, &amp;(int){ 1 }, sizeof(int)) &lt; 0)\n        {\n            perror(\"setsockopt(SO_REUSEADDR) failed\");\n            retCode = -1;\n        } \n        if(bind(serverFd, (struct sockaddr*)&amp;servAddr, sizeof(servAddr)) == -1)\n        {\n            retCode = -1;\n        }\n        else\n        {\n            listen(serverFd, 4);\n        }\n    }\n    newClientFd = accept(serverFd, (struct sockaddr*)NULL, NULL);\n    if(-1 != read(newClientFd, &amp;cliMsgHdr, sizeof(CliMsgHdr_t)))\n    {printf(\"read success\");}\nwrite(newClientFd, &amp;cliMsgHdr, sizeof(CliMsgHdr_t));\nclose(newClientFd);\n\nreturn retCode;\n}\n</code></pre>\n\n<p>Here is the client code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/select.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\nint main()\n{\n    int retCode = 0;\n    struct sockaddr_in servAddr;\n    char *loopbackAddr = \"127.0.0.1\";\n\n\n    if(!ipaddr)\n    {\n        ipaddr = loopbackAddr;\n    }\n\n    if((clientFd = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0)\n    {\n        printf(\"\\n Error : Could not create socket \\n\");\n        retCode = -1;\n    }\n    if(RC_SUCCESS == retCode)\n    {\n        memset(&amp;servAddr, '0', sizeof(servAddr)); \n        servAddr.sin_family = AF_INET;\n        servAddr.sin_port = htons(CLI_UTIL_PORT_NUM); \n\n        if(inet_pton(AF_INET, ipaddr, &amp;servAddr.sin_addr)&lt;=0)\n        {\n            printf(\"\\n inet_pton error occured\\n\");\n            retCode = -1;\n        } \n        else if(connect(clientFd, (struct sockaddr *)&amp;servAddr, sizeof(servAddr)) &lt; 0)\n        {\n           printf(\"\\n Error : Connect Failed \\n\");\n           perror(\"\");\n           retCode = -1;\n        }\n    }\n    write(clientFd, &amp;cliMsgHdr, sizeof(CliMsgHdr_t));\n    read(clientFd, &amp;cliMsgHdr, sizeof(CliMsgHdr_t));\n    close(clientFd);\n    return retCode;\n}\n</code></pre>\n\n<p>cliMsghdr is an structure to read and send some data.</p>\n"}, {"tags": ["c", "cmake", "fortran", "shared-libraries", "netcdf"], "comments": [{"owner": {"reputation": 814, "user_id": 6382074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04807dc4decf96efa9a9de10715ac35?s=128&d=identicon&r=PG&f=1", "display_name": "d_1999", "link": "https://stackoverflow.com/users/6382074/d-1999"}, "edited": false, "score": 1, "creation_date": 1484058869, "post_id": 41571163, "comment_id": 70347126, "body": "Did you really mean <code>netcdff.mod</code> or did you want <code>netcdf.mod</code>? Also I don&#39;t really know <code>cmake</code> but if looks like you might be trying to store in <code>NETCDFF_INCLUDES_F90</code> but then your message uses <code>${NETCDF_INCLUDES_F90}</code> (i.e. there&#39;s an extra F in the first)"}, {"owner": {"reputation": 115, "user_id": 3340392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8xiBU.png?s=128&g=1", "display_name": "epascolo", "link": "https://stackoverflow.com/users/3340392/epascolo"}, "reply_to_user": {"reputation": 814, "user_id": 6382074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04807dc4decf96efa9a9de10715ac35?s=128&d=identicon&r=PG&f=1", "display_name": "d_1999", "link": "https://stackoverflow.com/users/6382074/d-1999"}, "edited": false, "score": 0, "creation_date": 1484059143, "post_id": 41571163, "comment_id": 70347323, "body": "thanks to your reply, in copy and paste there are happens some mistakes. The correct include module file is netcdf.mod and message is on NETCDFF_INCLUDES_F90, I correct my previous post."}, {"owner": {"reputation": 4179, "user_id": 7282091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea62f0d9ff8ecd926a64b74f39aa73b?s=128&d=identicon&r=PG&f=1", "display_name": "fedepad", "link": "https://stackoverflow.com/users/7282091/fedepad"}, "edited": false, "score": 0, "creation_date": 1484061882, "post_id": 41571163, "comment_id": 70349223, "body": "which version of CMake are you running?"}, {"owner": {"reputation": 814, "user_id": 6382074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04807dc4decf96efa9a9de10715ac35?s=128&d=identicon&r=PG&f=1", "display_name": "d_1999", "link": "https://stackoverflow.com/users/6382074/d-1999"}, "edited": false, "score": 0, "creation_date": 1484062873, "post_id": 41571163, "comment_id": 70349909, "body": "I think you&#39;ve forgotten to correct the module file name."}, {"owner": {"reputation": 115, "user_id": 3340392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8xiBU.png?s=128&g=1", "display_name": "epascolo", "link": "https://stackoverflow.com/users/3340392/epascolo"}, "edited": false, "score": 0, "creation_date": 1484063454, "post_id": 41571163, "comment_id": 70350299, "body": "The CMAKE version is 3.5.2, the correct name of module is netcdf.mod."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 3340392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8xiBU.png?s=128&g=1", "display_name": "epascolo", "link": "https://stackoverflow.com/users/3340392/epascolo"}, "edited": false, "score": 0, "creation_date": 1484063676, "post_id": 41572784, "comment_id": 70350469, "body": "I have tried the example but  all run only if C and Fortran lib are in the same directory. Because for the first thing the script find the location of C libs and after search the other in the same directory."}, {"owner": {"reputation": 4179, "user_id": 7282091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea62f0d9ff8ecd926a64b74f39aa73b?s=128&d=identicon&r=PG&f=1", "display_name": "fedepad", "link": "https://stackoverflow.com/users/7282091/fedepad"}, "reply_to_user": {"reputation": 115, "user_id": 3340392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8xiBU.png?s=128&g=1", "display_name": "epascolo", "link": "https://stackoverflow.com/users/3340392/epascolo"}, "edited": false, "score": 0, "creation_date": 1484064849, "post_id": 41572784, "comment_id": 70351281, "body": "updated answer, since you can specify different search directories for includes and libraries when you ask for language specific interfaces..."}, {"owner": {"reputation": 115, "user_id": 3340392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8xiBU.png?s=128&g=1", "display_name": "epascolo", "link": "https://stackoverflow.com/users/3340392/epascolo"}, "edited": false, "score": 0, "creation_date": 1484066180, "post_id": 41572784, "comment_id": 70352197, "body": "Thanks to the help I try your suggestion!"}, {"owner": {"reputation": 750, "user_id": 849852, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/auj0r.jpg?s=128&g=1", "display_name": "Edward Hartnett", "link": "https://stackoverflow.com/users/849852/edward-hartnett"}, "edited": false, "score": 0, "creation_date": 1600616479, "post_id": 41572784, "comment_id": 113137540, "body": "There are many different ways that netCDF can be built and autoconf/automake/libtool have absolutely no problem finding all the info they need. However cmake struggles to find even the basic information, because apparently  it does not use the .so file (where all the information can be found) but instead merely hopes that netCDF was also installed with cmake, so that the special cmake install info is present. But this is usually not the case. So in other projects, I also struggle to put netCDF support into cmake builds."}], "tags": [], "owner": {"reputation": 4179, "user_id": 7282091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea62f0d9ff8ecd926a64b74f39aa73b?s=128&d=identicon&r=PG&f=1", "display_name": "fedepad", "link": "https://stackoverflow.com/users/7282091/fedepad"}, "is_accepted": true, "score": 2, "last_activity_date": 1484064805, "last_edit_date": 1484064805, "creation_date": 1484063275, "answer_id": 41572784, "question_id": 41571163, "link": "https://stackoverflow.com/questions/41571163/write-cmake-find-netcdf-for-c-and-fortran-library/41572784#41572784", "title": "Write CMake Find Netcdf for C and Fortran library", "body": "<p>Maybe mine is not an answer per se, but couldn't you just use the FindNetCDF.cmake shipped with VTK?<br>\n<a href=\"https://github.com/Kitware/VTK/blob/master/CMake/FindNetCDF.cmake\" rel=\"nofollow noreferrer\">https://github.com/Kitware/VTK/blob/master/CMake/FindNetCDF.cmake</a><br>\nOr the one from other users which look similar to the previous one (they can look for Fortran and C components)?<br>\n<a href=\"https://github.com/bilke/cmake-modules/blob/master/FindNetCDF.cmake\" rel=\"nofollow noreferrer\">https://github.com/bilke/cmake-modules/blob/master/FindNetCDF.cmake</a><br>\n<a href=\"https://github.com/jedbrown/cmake-modules/blob/master/FindNetCDF.cmake\" rel=\"nofollow noreferrer\">https://github.com/jedbrown/cmake-modules/blob/master/FindNetCDF.cmake</a><br>\nIf you include this file then you could just retrieve the components you need via:  </p>\n\n<pre><code>set (NETCDF_F90 \"YES\")\nfind_package (NetCDF REQUIRED)\ninclude_directories(${NETCDF_INCLUDES})\ntarget_link_libraries (uses_f90_interface ${NETCDF_LIBRARIES})\ntarget_link_libraries (only_uses_c_interface ${NETCDF_LIBRARIES_C}) \n</code></pre>\n\n<p>or in the case of the VTK version something like</p>\n\n<pre><code>find_package (NetCDF COMPONENTS F90)\ninclude_directories(NETCDF_F90_INCLUDE_DIRS)\ntarget_link_libraries (only_uses_f90_interface ${NETCDF_F90_LIBRARIES})\n</code></pre>\n\n<p>As stated by VTK version, you can pass different search directories for C and Fortran libraries via the following:  </p>\n\n<blockquote>\n  <p>When interfaces are requested the user has access to interface specific hints:  </p>\n</blockquote>\n\n<pre><code>NETCDF_${LANG}_INCLUDE_DIR - where to search for interface header files\nNETCDF_${LANG}_LIBRARY     - where to search for interface libraries\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 3340392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8xiBU.png?s=128&g=1", "display_name": "epascolo", "link": "https://stackoverflow.com/users/3340392/epascolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1386, "favorite_count": 0, "accepted_answer_id": 41572784, "answer_count": 1, "score": 2, "last_activity_date": 1484064805, "creation_date": 1484058301, "last_edit_date": 1484059260, "question_id": 41571163, "link": "https://stackoverflow.com/questions/41571163/write-cmake-find-netcdf-for-c-and-fortran-library", "title": "Write CMake Find Netcdf for C and Fortran library", "body": "<p>Hi everybody and thanks to your help,</p>\n\n<p>I'm newbie of CMAKE and I try to write a find library for C and Fortran NETCDF library. The problem is the possible different location and version of fortran and C netcdf. </p>\n\n<p>For fortran library I search <strong>netcdf.mod</strong>(include module) and <strong>libnetcdff.so</strong> (dynamic library) instead for C library I search <strong>netcdf.h</strong> and <strong>libnetcdf.so</strong>. </p>\n\n<p>On the web I find a magic code that find correctly the netcdf C library :</p>\n\n<pre><code>find_path (NETCDF_INCLUDES_C netcdf.h HINTS NETCDF_DIR NETCDF_DIR)\nmessage(\" inc =  ${NETCDF_INCLUDES_C}  \")\nfind_library (NETCDF_LIBRARIES_C  NAMES netcdf)\nmessage(\" lib =  ${NETCDF_LIBRARIES_C}  \")\n</code></pre>\n\n<p>and the two path is correct. I try to reply the code for fortran:</p>\n\n<pre><code>find_path (NETCDFF_INCLUDES_F90 netcdff.mod HINTS NETCDFF_DIR NETCDFF_DIR)\nmessage(\" inc ff =  ${NETCDFF_INCLUDES_F90}  \")\nfind_library (NETCDFF_LIBRARIES_F90  NAMES netcdff HINTS NETCDFF_DIR )\nmessage(\" lib ff=  ${NETCDFF_LIBRARIES_F90}  \")\nmark_as_advanced(NETCDF_LIBRARIES_F90)\n</code></pre>\n\n<p>but the both F90 path is empty, probably because I don't understand how cmake find the C library. Through MODULE ENVIRONMENT i load both library and the module load that env var:</p>\n\n<pre><code>   $NETCDFF_HOME $NETCDFF_INC $NETCDFF_INCLUDE $NETCDFF_LIB\n   $NETCDF_HOME  $NETCDF_INC  $NETCDF_INCLUDE  $NETCDF_LIB \n</code></pre>\n\n<p>I suppose incorrectly that CMAKE search NETCDF_DIR variable and into this search netcdf.h but in my CmakeList and in my ENV that variable is not defined.</p>\n\n<p>How CMake find C var? and how I can reply the find to fortran lib?</p>\n\n<p>Thanks to help me</p>\n\n<p>Best regards</p>\n\n<p>Eric</p>\n"}, {"tags": ["c", "arrays", "pointers", "memory-address"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1484056951, "post_id": 41570637, "comment_id": 70345648, "body": "What is <code>string</code>? C does not have a string type."}, {"owner": {"reputation": 296, "user_id": 6369159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q8NDc.jpg?s=128&g=1", "display_name": "lifecrisis", "link": "https://stackoverflow.com/users/6369159/lifecrisis"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1484056984, "post_id": 41570637, "comment_id": 70345673, "body": "Notice the typedef at the top of the code block! Thanks!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 6, "creation_date": 1484057238, "post_id": 41570637, "comment_id": 70345867, "body": "Ah, yes! So the other warning applies: <b>Never ever</b> <code>typedef</code> a pointer! It obfuscates the code, spams the namespace and makes qualifier-correct code difficult if not impossible."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 8, "creation_date": 1484057245, "post_id": 41570637, "comment_id": 70345873, "body": "Never a good idea to <code>typedef</code> pointers. Read <a href=\"http://stackoverflow.com/questions/3781932/is-typedefing-a-pointer-type-considered-bad-practice\">this</a>."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 3, "creation_date": 1484065197, "post_id": 41570637, "comment_id": 70351523, "body": "Based on your edit, it seems that you&#39;re satisfied with the answers.  If so, you should <a href=\"http://stackoverflow.com/help/accepted-answer\">accept one of them</a>."}, {"owner": {"reputation": 296, "user_id": 6369159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q8NDc.jpg?s=128&g=1", "display_name": "lifecrisis", "link": "https://stackoverflow.com/users/6369159/lifecrisis"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1484065970, "post_id": 41570637, "comment_id": 70352064, "body": "@dbush Good suggestion.  I&#39;m obviously new to Stack Overflow! I&#39;ll pick one after some more review... most of the commentary here adds something of value!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1484087302, "post_id": 41570637, "comment_id": 70364156, "body": "For future reference, problem statements should go beyond &quot;it fails to work&quot;"}, {"owner": {"reputation": 296, "user_id": 6369159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q8NDc.jpg?s=128&g=1", "display_name": "lifecrisis", "link": "https://stackoverflow.com/users/6369159/lifecrisis"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1484091082, "post_id": 41570637, "comment_id": 70365574, "body": "@LightnessRacesinOrbit... that&#39;s fair. Will do next time!"}], "answers": [{"comments": [{"owner": {"reputation": 296, "user_id": 6369159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q8NDc.jpg?s=128&g=1", "display_name": "lifecrisis", "link": "https://stackoverflow.com/users/6369159/lifecrisis"}, "edited": false, "score": 0, "creation_date": 1484057118, "post_id": 41570680, "comment_id": 70345775, "body": "I will agree that <code>s</code> is only accessible locally within the loop.  However, shouldn&#39;t <code>&amp;s</code> be, effectively, a <code>(char**)</code> pointing to the first element of <code>family2</code>, which itself is a <code>(char*)</code>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 296, "user_id": 6369159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q8NDc.jpg?s=128&g=1", "display_name": "lifecrisis", "link": "https://stackoverflow.com/users/6369159/lifecrisis"}, "edited": false, "score": 3, "creation_date": 1484057579, "post_id": 41570680, "comment_id": 70346115, "body": "@lifecrisis No, <code>&amp;s</code> is a pointer pointing to <code>s</code>, nothing else."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484058503, "post_id": 41570680, "comment_id": 70346860, "body": "I wonder why this perfectly correct answer has been downvoted."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1484060532, "post_id": 41570680, "comment_id": 70348284, "body": "@MichaelWalz Obscene if you ask me."}, {"owner": {"reputation": 296, "user_id": 6369159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q8NDc.jpg?s=128&g=1", "display_name": "lifecrisis", "link": "https://stackoverflow.com/users/6369159/lifecrisis"}, "edited": false, "score": 0, "creation_date": 1484062025, "post_id": 41570680, "comment_id": 70349313, "body": "Hey @Someprogrammerdude, check out the summary edit above, I believe I clearly summarized what came of this discussion. Let me know if there is a problem with it (a more experienced eye would be a big help!)."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 19, "last_activity_date": 1484058506, "last_edit_date": 1484058506, "creation_date": 1484056937, "answer_id": 41570680, "question_id": 41570637, "link": "https://stackoverflow.com/questions/41570637/i-have-three-loops-over-an-array-of-char-elements-in-c-why-does-the-third-fa/41570680#41570680", "title": "I have three loops over an array of (char*) elements in C. Why does the third fail?", "body": "<p>When you do <code>s = *(&amp;s + 1)</code> the variable <code>s</code> is a local variable in an implicit scope that only contains the loop. When you do <code>&amp;s</code> you get the address of that local variable, which is unrelated to any of the arrays.</p>\n\n<p>The difference from the previous loop is that there <code>s</code> is a pointer to the first element in the array.</p>\n\n<hr>\n\n<p>To explain it a little more \"graphically\" what you have in the last loop is something like</p>\n\n<pre>\n+----+      +---+      +------------+\n| &s | ---> | s | ---> | family2[0] |\n+----+      +---+      +------------+\n</pre>\n\n<p>That is, <code>&amp;s</code> is pointing to <code>s</code>, and <code>s</code> is pointing to <code>family2[0]</code>.</p>\n\n<p>When you do <code>&amp;s + 1</code> you effectively have something like</p>\n\n<pre>\n+------------+\n| family2[0] |\n+------------+\n^\n|\n+---+----\n| s | ...\n+---+----\n^   ^\n|   |\n&s  &s + 1\n</pre>\n"}, {"comments": [{"owner": {"reputation": 296, "user_id": 6369159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q8NDc.jpg?s=128&g=1", "display_name": "lifecrisis", "link": "https://stackoverflow.com/users/6369159/lifecrisis"}, "edited": false, "score": 0, "creation_date": 1484059552, "post_id": 41571481, "comment_id": 70347617, "body": "In the last part of your answer do you mean <code>&amp;s + 1 != family2[1]</code>?  Both statements are correct, but I&#39;m just wondering which is more important to notice in this context..."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 296, "user_id": 6369159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q8NDc.jpg?s=128&g=1", "display_name": "lifecrisis", "link": "https://stackoverflow.com/users/6369159/lifecrisis"}, "edited": false, "score": 1, "creation_date": 1484060014, "post_id": 41571481, "comment_id": 70347911, "body": "That&#39;s true as well but the types are different. <code>s+1 != family2[1]</code> is a comparison of two <code>char*</code>s while <code>&amp;s+1 != family2[1]</code> is a comparison of a <code>char**</code> and a <code>char*</code> which doesn&#39;t really make sense."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 2, "creation_date": 1484061053, "post_id": 41571481, "comment_id": 70348646, "body": "It isn&#39;t clear which example are you representing here. Regardless, this is wrong. &amp;s+1 doesn&#39;t point to anything. It isn&#39;t even a valid object."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1484061358, "post_id": 41571481, "comment_id": 70348846, "body": "It seems this is the third example. In that case, s+1 points to the second character of &quot;father&quot; and not 1007."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1484061480, "post_id": 41571481, "comment_id": 70348925, "body": "Also family2[0] and s are using misleading arrows. They point to the same address, 1000, but s points to the left of the column instead of the address."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1484061562, "post_id": 41571481, "comment_id": 70349002, "body": "And family2[3] doesn&#39;t point to address 3000, at which is shown to be an object containing the null address, family2[3] quite literally points to a null address."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1484178658, "post_id": 41571481, "comment_id": 70408193, "body": "That&#39;&#39;s a little better. There are still mistakes. &amp;s doesn&#39;t have an address of 7000. Is not an object at all, as it is shown, so it doesn&#39;t have an address at all. &amp;s+1 having the address 7008 is nonsense. How would adding to the value of an object change it&#39;s address !? &amp;s+1 simply points to 6008, and it doesn&#39;t have an address."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1484182850, "post_id": 41571481, "comment_id": 70409329, "body": "@2501 Thanks. Sorry for the late reply, I was busy yesterday. I was totally confused too! Thanks again! Is there any more problems in the answer?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1484214360, "post_id": 41571481, "comment_id": 70421078, "body": "This looks corrects, expect that &amp;s+1 is a valid pointer, you&#39;re just not allowed to dereference it."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1484222528, "post_id": 41571481, "comment_id": 70426631, "body": "@2501 IIRC, using <code>&amp;s+1</code> is illegal and invokes UB, even if you don&#39;t dereference it."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1484227040, "post_id": 41571481, "comment_id": 70429583, "body": "Pointing one past an object is defined behavior."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1484233335, "post_id": 41571481, "comment_id": 70433993, "body": "@2501 Hmm. I think that holds true only in the case of arrays. Is it true for any object?"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485442623, "post_id": 41571481, "comment_id": 70934369, "body": "@2501 It seems I was wrong. You&#39;re right. Pointing to <code>&amp;s+1</code> is indeed valid. Thanks!"}], "tags": [], "owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "is_accepted": false, "score": 9, "last_activity_date": 1485442577, "last_edit_date": 1495541346, "creation_date": 1484059344, "answer_id": 41571481, "question_id": 41570637, "link": "https://stackoverflow.com/questions/41570637/i-have-three-loops-over-an-array-of-char-elements-in-c-why-does-the-third-fa/41571481#41571481", "title": "I have three loops over an array of (char*) elements in C. Why does the third fail?", "body": "<p>Pictures help a lot:</p>\n\n<pre><code>            +----------+\n            | \"father\" |                                    \n            +----------+         +----------+      +-------+      NULL \n   /-----------\u21921000            | \"mother\" |      | \"son\" |        \u2191\n+-----+           \u2191              +----------+      +-------+        |\n|  s  | ?         |                  2000            2500           |\n+-----+           |                   \u2191                \u2191            |\n 6000  6008 +----------------+----------------+--------------+--------------+\n            |   family2[0]   |   family2[1]   |  family2[2]  |  family2[3]  |\n            +----------------+----------------+--------------+--------------+\n                  5000              5008            5016           5024\n\n                    (    &amp;s refers to 6000    ) \n                    ( &amp;s+1 refers to 6008 but )\n                    (   *(&amp;s+1) invokes UB    )\n</code></pre>\n\n<p><sup>Addresses chosen as random integers for simplicity</sup></p>\n\n<hr>\n\n<p>The thing here is that, although both <code>s</code> and <code>family2[0]</code> point to the same base address of the string literal <code>\"father\"</code>, the pointers aren't related with each other and has its own different memory location where they are stored. <code>*(&amp;s+1) != family2[1]</code>.</p>\n\n<p>You hit UB when you do <code>*(&amp;s + 1)</code> because <code>&amp;s + 1</code> is a memory location you're not supposed to tamper with, i.e, it doesn't belong to any object you created. You never know what's stored in there => Undefined Behavior.</p>\n\n<p><sup>Thanks <a href=\"https://stackoverflow.com/users/4082723/2501\">@2501</a> for pointing out several mistakes!</sup></p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1484105421, "post_id": 41573249, "comment_id": 70369039, "body": "<code>s = (s + strlen(family2[i]) + 2)</code> moves <code>s</code> out of bounds of the string"}], "tags": [], "owner": {"reputation": 11, "user_id": 7120892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ac0db3094f2f63b2cbf48b1abb5e3cf?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/7120892/jack"}, "is_accepted": false, "score": 0, "last_activity_date": 1484064543, "creation_date": 1484064543, "answer_id": 41573249, "question_id": 41570637, "link": "https://stackoverflow.com/questions/41570637/i-have-three-loops-over-an-array-of-char-elements-in-c-why-does-the-third-fa/41573249#41573249", "title": "I have three loops over an array of (char*) elements in C. Why does the third fail?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\ntypedef char* string;\n\nint main() {\nchar *family1[4] = { \"father\", \"mother\", \"son\", NULL };\nstring family2[4] = { \"father\", \"mother\", \"son\", NULL };\n\n/* Loop #1: Using a simple pointer to step through \"family1\". */\nfor (char **p = family1; *p != NULL; p++) {\n    printf(\"%s\\n\", *p);\n}\nputchar('\\n');\n\n/* Loop #2: Using the typedef for clarity and stepping through\n* family2. */\nfor (string *s = family2; *s != NULL; s++) {\n    printf(\"%s\\n\", *s);\n}\nputchar('\\n');\n\n/* Loop #3: Again, we use the pointer, but with a unique increment\n* step in our for loop.  This fails to work.  Why? */\n/*for (string s = family2[0]; s != NULL; s = *(&amp;s + 1)) {\n    printf(\"%s\\n\", s);\n}\n*/\nfor (int j = 0; j &lt; 3; j++)\n{\n    printf(\"%d \",family2[j]);\n    printf(\"%d\\n\", strlen(family2[j]));\n}\nprintf(\"\\n\");\nint i = 0;\nfor (string s = family2[i]; i != 3; s = (s + strlen(family2[i]) + 2),i++) {\n    printf(\"%d \",s);\n    printf(\"%s\\n\", s);\n}\n\nsystem(\"pause\");\n</code></pre>\n\n<p>}</p>\n\n<p>this is a example revised from your code,if you run it,you will find the change of the address of the point and the family2, then you will understand the relationship of the loop #3.</p>\n"}], "owner": {"reputation": 296, "user_id": 6369159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q8NDc.jpg?s=128&g=1", "display_name": "lifecrisis", "link": "https://stackoverflow.com/users/6369159/lifecrisis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1308, "favorite_count": 1, "accepted_answer_id": 41570680, "answer_count": 3, "score": 15, "last_activity_date": 1485442577, "creation_date": 1484056818, "last_edit_date": 1484091260, "question_id": 41570637, "link": "https://stackoverflow.com/questions/41570637/i-have-three-loops-over-an-array-of-char-elements-in-c-why-does-the-third-fa", "title": "I have three loops over an array of (char*) elements in C. Why does the third fail?", "body": "<p>While experimenting with methods for stepping through an array of strings in C, I developed the following small program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\ntypedef char* string;\n\nint main() {\n  char *family1[4] = {\"father\", \"mother\", \"son\", NULL};\n  string family2[4] = {\"father\", \"mother\", \"son\", NULL};\n\n  /* Loop #1: Using a simple pointer to step through \"family1\". */\n  for (char **p = family1; *p != NULL; p++) {\n    printf(\"%s\\n\", *p);\n  }\n  putchar('\\n');\n\n  /* Loop #2: Using the typedef for clarity and stepping through\n   * family2. */\n  for (string *s = family2; *s != NULL; s++) {\n    printf(\"%s\\n\", *s);\n  }\n  putchar('\\n');\n\n  /* Loop #3: Again, we use the pointer, but with a unique increment\n   * step in our for loop.  This fails to work.  Why? */\n  for (string s = family2[0]; s != NULL; s = *(&amp;s + 1)) {\n    printf(\"%s\\n\", s);\n  }\n}\n</code></pre>\n\n<p>My specific question involves the failure of Loop #3.  When run through the debugger, Loops #1 and #2 complete successfully, but the last loop fails for an unknown reason.  I would not have asked this here, except for the fact that is shows me that I have some critical misunderstanding regarding the \"&amp;\" operator.</p>\n\n<p><b>My question (and current understanding) is this:</b><br><br>  <code>family2</code> is an array-of-pointer-to-char. Thus, when <code>s</code> is set to <code>family2[0]</code> we have a <code>(char*)</code> pointing to \"father\".  Therefore, taking <code>&amp;s</code> should give us the equivalent of <code>family2</code>, pointing to the first element of <code>family2</code> after the expected pointer decay.  Why doesn't, then,\n<code>*(&amp;s + 1)</code> point to the next element, as expected?</p>\n\n<p>Many thanks,<br>\nlifecrisis</p>\n\n<hr>\n\n<p><strong>EDIT -- Update and Lessons Learned:</strong></p>\n\n<p>The following list is a summary of all of the relevant facts and interpretations that explain why the third loop does not work like the first two. </p>\n\n<ol>\n<li><code>s</code> is a separate variable holding a copy of the value (a pointer-to-char) from the variable <code>family2[0]</code>. I.e., these two equivalent values are positioned at SEPARATE locations in memory.</li>\n<li><code>family2[0]</code> up to <code>family2[3]</code> are contiguous elements of memory, and <code>s</code> has no presence in this space, though it does contain the same value that is stored in <code>family2[0]</code> at the start of our loop.</li>\n<li>These first two facts mean that <code>&amp;s</code> and <code>&amp;family2[0]</code> are NOT equal. Thus, adding one to <code>&amp;s</code> will return a pointer to unknown/undefined data, whereas adding one to <code>&amp;family2[0]</code> will give you <code>&amp;family2[1]</code>, as desired.</li>\n<li>In addition, the update step in the third for loop doesn't actually result in s stepping forward in memory on each iteration. This is because <code>&amp;s</code> is constant throughout all iterations of our loop. This is the cause of the observed infinite loop.</li>\n</ol>\n\n<p>Thanks to EVERYONE for their help!<br>\nlifecrisis</p>\n"}]