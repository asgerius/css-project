[{"tags": ["c", "arrays", "pointers", "struct", "linked-list"], "comments": [{"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 1, "creation_date": 1512000184, "post_id": 47563621, "comment_id": 82085701, "body": "<code>struct number array[10] = ...</code> --&gt; this will create array of 10 elements of type <code>struct number</code> instead of initializing <code>int array[10];</code> member of <code>struct number</code>. Try compiling your program with turn on all warnings <code>-Wall</code>."}, {"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 0, "creation_date": 1512000390, "post_id": 47563621, "comment_id": 82085757, "body": "<code>struct number *tail = 90;</code> --&gt; assigning an <code>int</code> value to <code>struct number *</code> pointer. Isnt compiler throwing warning for this?"}], "answers": [{"tags": [], "owner": {"reputation": 94, "user_id": 7322302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e01b6f1cab4367d3d9a4cdbdf25bf6?s=128&d=identicon&r=PG&f=1", "display_name": "J_Kay", "link": "https://stackoverflow.com/users/7322302/j-kay"}, "is_accepted": false, "score": 0, "last_activity_date": 1512160543, "creation_date": 1512160543, "answer_id": 47601106, "question_id": 47563621, "link": "https://stackoverflow.com/questions/47563621/getting-wrong-integer-when-trying-to-read-through-an-array-via-linked-list/47601106#47601106", "title": "Getting wrong integer when trying to read through an array via linked list", "body": "<p>The reason this isn't working is because of the initializers for <code>struct number</code>. More information on using C initializers can be found <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html\" rel=\"nofollow noreferrer\">on the GCC website.</a></p>\n\n<p><strong>Struct Initializer:</strong> <code>struct number array[10] = {0, 10, 20, 30, 40, 50, 60, 70, 80, 90};</code></p>\n\n<p>This is an ambiguous way of initializing a struct that evaluates to </p>\n\n<pre><code>struct number array[10];\narray[0].array = {0, 10, 20, 30, 40, 50, 60, 70, 80, 90};\n</code></pre>\n\n<p><strong>Head pointer:</strong></p>\n\n<pre><code>struct number *head = 0;\n...\nstruct number *current = head;\nwhile(current != NULL)\n</code></pre>\n\n<p>The first line, <code>struct number *head = 0;</code>, is equivalent to <code>struct number *head = NULL;</code> As is, your while loop will never be executed. You could use either <code>head = array;</code> or <code>head = &amp;array[0];</code> here.</p>\n\n<p><strong>Tail pointer:</strong>  <code>struct number *tail = 90;</code></p>\n\n<p>This gives the following warning in VS2015 - </p>\n\n<pre><code>Warning C4047 'initializing': 'number *' differs in levels of indirection from 'int'\n</code></pre>\n\n<p>You could use <code>tail = &amp;array[9];</code> here.</p>\n\n<p><strong>Print Error:</strong> <code>printf(\"%i\", array[10].array[2]);</code></p>\n\n<p>This is accessing an element outside the bounds of <code>array</code>. C generally uses 0-based indices, so for your definition <code>struct number array[10]</code>, the maximum element is <code>array[9]</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 9028413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027349fcfdf718216a9e77a4a34f5520?s=128&d=identicon&r=PG&f=1", "display_name": "D.Kogut", "link": "https://stackoverflow.com/users/9028413/d-kogut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512160543, "creation_date": 1511998487, "last_edit_date": 1512003059, "question_id": 47563621, "link": "https://stackoverflow.com/questions/47563621/getting-wrong-integer-when-trying-to-read-through-an-array-via-linked-list", "title": "Getting wrong integer when trying to read through an array via linked list", "body": "<p>I've been trying to create a program that will read through a fixed array via linked list. Whenever I run my code, the program gives me a clearly inaccurate number and will not iterate through the array. Any advice on what i'm doing wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct number\n{\nint array[10];\nstruct number *next;\n};\n\nint main()\n{\n\n    struct number array[10] = {0, 10, 20, 30, 40, 50, 60, 70, 80, 90};\n\n    struct number *head = 0;\n    struct number *tail = 90;\n\n    array[0].next = &amp;array[1];\n    array[1].next = &amp;array[2];\n    array[2].next = &amp;array[3];\n    array[3].next = &amp;array[4];\n    array[4].next = &amp;array[5];\n    array[5].next = &amp;array[6];\n    array[6].next = &amp;array[7];\n    array[7].next = &amp;array[8];\n    array[8].next = &amp;array[9];\n    array[9].next = NULL;\n\n    printf(\"%i\", array[10].array[2]);\n\n    struct number *current = head;\n    while(current != NULL)\n    {\n        printf(\"Node %i contains the element and is stored in address %p\\n\", current-&gt;array[0], current);\n        current = current-&gt;next;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "system-calls", "strace", "ptrace"], "owner": {"reputation": 35, "user_id": 8680581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b36a8ac3b451f4a7a9980f778e2095e?s=128&d=identicon&r=PG&f=1", "display_name": "Clark Kent", "link": "https://stackoverflow.com/users/8680581/clark-kent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1540203299, "creation_date": 1511997424, "last_edit_date": 1540203299, "question_id": 47563466, "link": "https://stackoverflow.com/questions/47563466/implementing-strace-with-compatibility-for-the-clone-syscall", "title": "implementing strace with compatibility for the clone() syscall", "body": "<p>how would I get my program to ptrace a cloned application as from the output it appears to execute a clone() syscall but I am not sure how I would ptrace it, could anyone help me, if possible provide a working minimal example as proof that such would work</p>\n\n<pre><code>SYSCALL pipe() IS NOT YET SUPPORTED\n\nsystem call (end) (call number: 22) pipe (with return: 0) from pid 7596\nSYSCALL clone() IS NOT YET SUPPORTED\n\nsystem call (end) (call number: 56) clone (with return: 7597) from pid 7596\n...\nATTEMPTING TO READ SYSTEM CALL rt_sigsuspend argument 1 (REGISTER: rdi)\nORIGINAL system call (start) (call number: 130) rt_sigsuspend(140734241713168, 8) from pid 7596\nTRANSLATED system call (start) (call number: 130) rt_sigsuspend(\"\", 8) from pid 7596\nzsh: command not found: q\n\nsystem call (end) (call number: 130) rt_sigsuspend (with return: -514) from pid 7596\nATTEMPTING TO READ SYSTEM CALL rt_sigsuspend argument 1 (REGISTER: rdi)\nORIGINAL system call (start) (call number: 130) rt_sigsuspend(140734241713168, 8) from pid 7596\nTRANSLATED system call (start) (call number: 130) rt_sigsuspend(\"\", 8) from pid 7596\n\nsystem call (end) (call number: 130) rt_sigsuspend (with return: -38) from pid 7596\n\nhelp\nexit\n^C\n^Z\n</code></pre>\n"}, {"tags": ["c", "string", "while-loop", "scanf"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1511997567, "post_id": 47563422, "comment_id": 82084849, "body": "Why have you declared <code>next</code> and <code>next1</code> <i>after</i> using them in <code>scanf()</code>? Suggest posting actual code would be more helpful."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1511998580, "post_id": 47563422, "comment_id": 82085199, "body": "You need to test the scanf calls for EOF.  After reading the newline that\u2019s the last character in the file, you have two scanf calls that fail, hut you loop back and print the previous values again."}, {"owner": {"reputation": 307, "user_id": 8705157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fff2a5861f364caee41fe505e1f86204?s=128&d=identicon&r=PG&f=1", "display_name": "dshawn", "link": "https://stackoverflow.com/users/8705157/dshawn"}, "edited": false, "score": 0, "creation_date": 1511999174, "post_id": 47563422, "comment_id": 82085397, "body": "How do I test a scanf call? when I call scanf doesn&#39;t it already scan the value? so I don&#39;t really understand how I&#39;m supposed to test scanf and assign my next and next1 values too"}], "answers": [{"tags": [], "owner": {"reputation": 174, "user_id": 9028286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d42f01eb74536ad45592adc388cb4db?s=128&d=identicon&r=PG&f=1", "display_name": "enyard", "link": "https://stackoverflow.com/users/9028286/enyard"}, "is_accepted": false, "score": 1, "last_activity_date": 1511999046, "creation_date": 1511999046, "answer_id": 47563711, "question_id": 47563422, "link": "https://stackoverflow.com/questions/47563422/loop-going-on-longer-than-intended-checking-for-empty-line/47563711#47563711", "title": "Loop going on longer than intended checking for empty line", "body": "<p>I would suggest something like that</p>\n\n<pre><code>int main(){\n    int next,next1;\n    scanf(\"%d\", &amp;next);\n    scanf(\"%d\", &amp;next1);\n    while (getchar()=='\\n') {\n        printf(\"%d,%d.\\n\",next,next1);\n        scanf(\"%d\", &amp;next);\n        scanf(\"%d\", &amp;next1);\n    }\n}\n</code></pre>\n\n<p>by this way you save a little bit of memory, and is more readable. The output should be correct now, try by yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1511999816, "last_edit_date": 1511999816, "creation_date": 1511999062, "answer_id": 47563714, "question_id": 47563422, "link": "https://stackoverflow.com/questions/47563422/loop-going-on-longer-than-intended-checking-for-empty-line/47563714#47563714", "title": "Loop going on longer than intended checking for empty line", "body": "<p><code>scanf()</code> -</p>\n\n<blockquote>\n  <p>If a reading error happens or the end-of-file is reached while reading, the proper indicator is set (feof or ferror). And, if either happens before any data could be successfully read, EOF is returned.</p>\n</blockquote>\n\n<p>So, when the no more lines of the input left, the <code>scanf()</code> returns <code>EOF</code> and the <code>while</code> loop iterate because <code>done</code> is not set to <code>1</code> yet and <code>printf()</code> prints the value stored in <code>next</code> and <code>next1</code> one more time. That's why the last entered value printed twice. After this the condition <code>if (getchar()=='\\n')</code> fails and <code>done</code> set to <code>1</code> and <code>while</code> loop exits.</p>\n\n<p>You can do:</p>\n\n<pre><code>int done=0,next,next1;\nwhile (done==0) {\n    if (scanf(\"%d%d\", &amp;next, &amp;next1) != EOF)\n        printf(\"%d,%d.\",next,next1);\n    else\n        done=1;\n}\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>while (scanf(\"%d%d\", &amp;next, &amp;next1) != EOF)\n    printf(\"%d,%d.\",next,next1);\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 8705157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fff2a5861f364caee41fe505e1f86204?s=128&d=identicon&r=PG&f=1", "display_name": "dshawn", "link": "https://stackoverflow.com/users/8705157/dshawn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 47563714, "answer_count": 2, "score": 0, "last_activity_date": 1511999816, "creation_date": 1511997164, "question_id": 47563422, "link": "https://stackoverflow.com/questions/47563422/loop-going-on-longer-than-intended-checking-for-empty-line", "title": "Loop going on longer than intended checking for empty line", "body": "<p>I have a loop that is stopped once a flag is set to 1.</p>\n\n<pre><code>scanf(\"%d\", &amp;next);\nscanf(\"%d\", &amp;next1);\nint done=0,next,next1;\nwhile (done==0) {\n            printf(\"%d,%d.\",next,next1);\n            if (getchar()=='\\n') {\n                scanf(\"%d\", &amp;next);\n                scanf(\"%d\", &amp;next1);\n            }\n            //if not, set flag and stop looping\n            else{\n                done=1;\n            }\n}\n</code></pre>\n\n<p>It scans for 2 numbers from every line of input every loop until there are no more lines of the input left. I thought this would work fine but I encountered a problem when I tested out the following input:</p>\n\n<pre><code>1 0\n1 1\n1 2\n1 3\n</code></pre>\n\n<p>The output should be </p>\n\n<pre><code>1,0.\n1,1.\n1,2.\n1,3.\n</code></pre>\n\n<p>but instead it prints the last loop twice like this:</p>\n\n<pre><code>1,0.\n1,1.\n1,2.\n1,3.\n1,3.\n</code></pre>\n\n<p>Why does this scan the last line twice before terminating? is there a character I can check for so it ends after it prints the first \"1,3.\"?</p>\n"}, {"tags": ["c", "file-io"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1511997397, "post_id": 47563405, "comment_id": 82084781, "body": "If you are minimizing the size of each struct <code>story</code>, then you can allocate for the filenames, otherwise the standard macro <code>PATH_MAX</code> will provide sufficient storage for each (4096 bytes generally). If you don&#39;t have many, don&#39;t worry about dynamically allocating storage for the filenames, just for the <code>text</code> of each file. No need to dynamically allocate <code>temp</code>, just <code>story temp = { .title = &quot;&quot; );</code> will declare <code>temp</code> on the stack and initialize all bytes zero. If you declare <code>char *text;</code>, then you can dynamically allocate for <code>text</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1511997919, "post_id": 47563405, "comment_id": 82084973, "body": "How will you know when you have reached the last file? Will the last file <i>line 3</i> be blank?"}, {"owner": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1511998299, "post_id": 47563405, "comment_id": 82085094, "body": "The second and third lines each contain a file name of a next file that i have to read/store.If there are no further names of files on 2nd and 3rd line, both of the lines will have &quot; -\\n &quot;.    example:  TITLE:<code>title 25 </code> SECOND LINE<code>:  - </code> THIRD LINE: <code>-</code>   FOURTH LINE: ` text:&quot; This is the end, last file ... &quot;`"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1511998341, "post_id": 47563405, "comment_id": 82085110, "body": "Makes sense. I&#39;ll drop an example in a few minutes."}, {"owner": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1511998560, "post_id": 47563405, "comment_id": 82085192, "body": "thank you for your time , i appreciate it"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "edited": false, "score": 0, "creation_date": 1512160504, "post_id": 47564722, "comment_id": 82160818, "body": "A binary tree would be a good solution. Though I still believe a recursive function that descends the <code>file_x</code> branch until <code>file_x</code> is empty and then recurses the <code>file_y</code> branch on the way out would work as well. Even with a btree, the challenge is still &quot;<i>How do I traverse both <code>file_x</code> and <code>file_y</code> branches for every file?</i>&quot; You can handle the <code>file_x</code> branch as above, but then you need to move to the first <code>fils_y</code> and follow the <code>file_x</code> branch again, then the next <code>file_y</code> and follow the <code>file_x</code> branch again until you exhaust all files (see the pattern)?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "edited": false, "score": 0, "creation_date": 1512160730, "post_id": 47564722, "comment_id": 82160940, "body": "Give me a bit to get a bit of real-world work done and I&#39;ll revisit the code and see if I can&#39;t add a few more pointers."}, {"owner": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "edited": false, "score": 0, "creation_date": 1512163754, "post_id": 47564722, "comment_id": 82162207, "body": "i omitted important part of my taks ( i didnt think it was important for this part) . After user runs program (` /.ass Chapter_1.txt<code>) i have to print the first file in stdout (so with printf) and then user can type in choice</code> A` or <code>B</code> ( which are <code>file_x</code> and <code>file_y</code>) and then i output corresponding file and so on. So as i understand now, i have to make binary tree with where each structure(ex. chapter 1) holds <b>reference</b> to option A and B  ( <code>file_y</code> and f<code>ile_x</code>). I implemented binary tree in addition to your example."}, {"owner": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "edited": false, "score": 0, "creation_date": 1512163875, "post_id": 47564722, "comment_id": 82162263, "body": "My code for storing structures in binary tree is not finished but i have made basics. Would you have time to check my code? This is very important for me to finish and i appreciate  any help."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1594250755, "last_edit_date": 1594250755, "creation_date": 1512007246, "answer_id": 47564722, "question_id": 47563405, "link": "https://stackoverflow.com/questions/47563405/open-multiple-files-and-store-them-in-array-of-structures/47564722#47564722", "title": "Open multiple files and store them in array of structures", "body": "<p>I suspect your lesson is covering recursion as with each element in your array of <code>story</code> you will need to branch an unknown number of times to read <code>file_x</code> and <code>file_y</code> (each of which can contain additional <code>file_x</code> and <code>file_y</code> within). Your procedural option is to follow down the trail of all <code>file_x</code> and then return to each <code>file_y</code> repeating the process until you reach the final files in each chain where <code>file_x</code> and <code>file_y</code> are empty.</p>\n<p>Before determining which approach you will take, you simply need a way to read one file, extract the <code>title</code>, <code>file_x</code>, <code>file_y</code> and allocate and store <code>text</code>. This is a fairly straight-forward process where your primary task is to <em><strong>validate each step</strong></em> so you have confidence that you are processing <em>actual data</em> and are not invoking <em>Undefined Behavior</em> by reading from a file that isn't actually open or attempting to write (or read) beyond the bounds of your storage.</p>\n<p>Here is a short example that takes a pointer to <code>story</code> to fill and the <code>filename</code> to read from. You will note a repetitive process involved. (read the string with <code>fgets</code>, get the length, validate the last char read was <code>'\\n'</code> indicating you read the whole line, and finally trimming the <code>'\\n'</code> by either overwriting with a <em>nul-terminating</em> character so you don't have newlines dangling off the end of your stored string, or overwriting with a <code>' '</code> (space) in the case of <code>text</code> where you are concatenating lines together.</p>\n<p><strong>note:</strong> below, <code>realloc</code> is never called directly on the pointer to <code>text</code>. Instead a <code>tmp</code> pointer is used with <code>realloc</code> to validate <code>realloc</code> succeeds before assigning the new block to <code>text</code>. (otherwise you will lose your pointer to <code>text</code> if <code>realloc</code> fails -- because it returns <code>NULL</code>)</p>\n<pre><code>/* read values into struct story 's' from 'filename' */\nint read_file (story *s, char *filename)\n{\n    size_t len = 0,                 /* var for strlen */\n        text_size = 0,              /* total text_size */\n        nul_char = 0;               /* flag for +1 on first allocation */\n    char buf[TITLE_MAX] = &quot;&quot;;       /* read buffer for 'text' */\n    FILE *fp = fopen (filename, &quot;r&quot;);   /* file pointer */\n    \n    if (!fp)        /* validate file open for reading */\n        return 0;   /* or return silently indicating no file_x or file_y */\n    \n    if (fgets (s-&gt;title, TITLE_MAX, fp) == 0) { /* read title */\n        fprintf (stderr, &quot;error: failed to read title from '%s'.\\n&quot;,\n                filename);\n        fclose(fp);\n        return 0;\n    }\n    len = strlen (s-&gt;title);                /* get title length */\n    if (len &amp;&amp; s-&gt;title[len - 1] == '\\n')   /* check last char is '\\n' */\n        s-&gt;title[--len] = 0;                /* overwrite with nul-character */\n    else {  /* handle error if line too long */\n        fprintf (stderr, &quot;error: title too long, filename '%s'.\\n&quot;,\n                filename);\n        fclose(fp);\n        return 0;\n    }\n    \n    if (fgets (s-&gt;file_x, PATH_MAX, fp) == 0) { /* same for file_x */\n        fprintf (stderr, &quot;error: failed to read file_x from '%s'.\\n&quot;,\n                filename);\n        fclose(fp);\n        return 0;\n    }\n    len = strlen (s-&gt;file_x);\n    if (len &amp;&amp; s-&gt;file_x[len - 1] == '\\n')\n        s-&gt;file_x[--len] = 0;\n    else {\n        fprintf (stderr, &quot;error: file_x too long, filename '%s'.\\n&quot;,\n                filename);\n        fclose(fp);\n        return 0;\n    }\n    \n    if (fgets (s-&gt;file_y, PATH_MAX, fp) == 0) { /* same for file_y */\n        fprintf (stderr, &quot;error: failed to read file_y from '%s'.\\n&quot;,\n                filename);\n        fclose(fp);\n        return 0;\n    }\n    len = strlen (s-&gt;file_y);\n    if (len &amp;&amp; s-&gt;file_y[len - 1] == '\\n')\n        s-&gt;file_y[--len] = 0;\n    else {\n        fprintf (stderr, &quot;error: file_y too long, filename '%s'.\\n&quot;,\n                filename);\n        fclose(fp);\n        return 1;\n    }\n    \n    while (fgets (buf, TITLE_MAX, fp)) {    /* read text in TITLE_MAX chunks */\n        len = strlen (buf);\n        if (len &amp;&amp; buf[len - 1] == '\\n')    /* check for '\\n' */\n            buf[len - 1] = ' ';             /* overwrite with ' ' for concat */\n        if (text_size == 0)\n            nul_char = 1;       /* account for space for '\\0' when empty, and  */\n        else                    /* use a flag to set new block to empty-string */\n            nul_char = 0;\n        void *tmp = realloc (s-&gt;text, text_size + len + nul_char); /* allocate */\n        if (!tmp) {         /* validate realloc succeeded */\n            fprintf (stderr, &quot;error: realloc failed, filename '%s'.\\n&quot;,\n                    filename);\n            break;\n        }\n        s-&gt;text = tmp;          /* assign new block to s-&gt;text */\n        if (nul_char)           /* if first concatenation */\n            *(s)-&gt;text = 0;     /* initialize s-&gt;text to empty-string */\n        strcat (s-&gt;text, buf);  /* concatenate buf with s-&gt;text */\n        text_size += (len + 1); /* update text_size total */\n    }\n    \n    fclose (fp);                /* close file */\n    \n    return 1;\n}\n</code></pre>\n<p>With this, you will need to design a way to work through all <code>file_x</code> and <code>file_y</code> filenames. As mentioned above, this likely lends itself to a recursive function, or you can work your way down the <code>file_x</code> tree and circle back and pick up all the <code>file_y</code> additions. Note, you need to account for the new addition of <code>story</code> each time either <code>file_x</code> or <code>file_y</code> are followed.</p>\n<p>Below is a short example that follows through all <code>file_x</code> additions and comes back and follow through <strong>only the 1st</strong> <code>file_y</code> branch. It is intended to shown you how to handle the calling and filling from both a <code>file_x</code> and <code>file_y</code> rather than write the final code for you. If you add the following above the <code>read_file</code> function, you will have a working example:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;limits.h&gt; /* for PATH_MAX */\n\nenum { STORY_MAX = 12, TITLE_MAX = 1024 };\n\ntypedef struct \n{\n    char title[TITLE_MAX],\n        file_x[PATH_MAX],\n        file_y[PATH_MAX],\n        *text; \n\n} story;\n\nint read_file (story *s, char *filename);\n\nint main (int argc, char **argv) {\n\n    int n = 0, storycnt = 0;\n    story stories[STORY_MAX] = {{ .title = &quot;&quot; }};\n    char *filename = argv[1];\n\n    /* read all file_x filenames */\n    while (n &lt; STORY_MAX &amp;&amp; read_file (&amp;stories[n], filename)) {\n        filename = stories[n++].file_x;\n    }\n    storycnt = n;   /* current story count of all file_x */\n    \n    for (int i = 0; i &lt; storycnt; i++)  /* find all file_y files */\n        while (n &lt; STORY_MAX &amp;&amp; read_file (&amp;stories[n], stories[i].file_y)) {\n            filename = stories[i++].file_y;\n            n++;\n        }\n    \n    for (int i = 0; i &lt; n; i++) {   /* output stories content */\n        printf (&quot;\\ntitle : %s\\nfile_x: %s\\nfile_y: %s\\ntext  : %s\\n&quot;, \n                stories[i].title, stories[i].file_x, \n                stories[i].file_y, stories[i].text);\n        free (stories[i].text);     /* don't forget to free memory */\n    }\n    \n    return 0;\n}\n</code></pre>\n<p><strong>Example Input Files</strong></p>\n<pre><code>$ cat file_1.txt\nFile 1\nfile_8.txt\nfile_25.txt\nText: &quot;this is some example text, lenght is unknown\nso i will have to use  malloc and realloc to\ndynamicaly store it.&quot;\n\n$ cat file_8.txt\nfile_8\n\n\nThis is the text from file 8. Not much,\njust some text.\n\n$ cat file_25.txt\nfile_25\n\n\nThis is the text from file 25. Not much,\njust some text.\n</code></pre>\n<p><strong>Example Use/Output</strong></p>\n<pre><code>$ ./bin/rdstories file_1.txt\n\ntitle : File 1\nfile_x: file_8.txt\nfile_y: file_25.txt\ntext  : Text: &quot;this is some example text, lenght is unknown so i will \n        have to use  malloc and realloc to dynamicaly store it.&quot;\n\ntitle : file_8\nfile_x:\nfile_y:\ntext  : This is the text from file 8. Not much, just some text.\n\ntitle : file_25\nfile_x:\nfile_y:\ntext  : This is the text from file 25. Not much, just some text.\n</code></pre>\n<p><strong>Memory Use/Error Check</strong></p>\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n<pre><code>$ valgrind ./bin/rdstories file_1.txt\n==9488== Memcheck, a memory error detector\n==9488== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==9488== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==9488== Command: ./bin/rdstories file_1.txt\n==9488==\n\ntitle : File 1\nfile_x: file_8.txt\nfile_y: file_25.txt\ntext  : Text: &quot;this is some example text, lenght is unknown so i will \n        have to use  malloc and realloc to dynamicaly store it.&quot;\n\ntitle : file_8\nfile_x:\nfile_y:\ntext  : This is the text from file 8. Not much, just some text.\n\ntitle : file_25\nfile_x:\nfile_y:\ntext  : This is the text from file 25. Not much, just some text.\n==9488==\n==9488== HEAP SUMMARY:\n==9488==     in use at exit: 0 bytes in 0 blocks\n==9488==   total heap usage: 13 allocs, 13 frees, 3,353 bytes allocated\n==9488==\n==9488== All heap blocks were freed -- no leaks are possible\n==9488==\n==9488== For counts of detected and suppressed errors, rerun with: -v\n==9488== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n<p>Look things over and let me know if you have questions.</p>\n"}], "owner": {"reputation": 33, "user_id": 7262160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92c8c75987dc6dcaeb2100ffe010fd39?s=128&d=identicon&r=PG&f=1", "display_name": "Totenkoph93", "link": "https://stackoverflow.com/users/7262160/totenkoph93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 409, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594250755, "creation_date": 1511997046, "question_id": 47563405, "link": "https://stackoverflow.com/questions/47563405/open-multiple-files-and-store-them-in-array-of-structures", "title": "Open multiple files and store them in array of structures", "body": "<p>I need some help with my task. I have to open unknown number of files and store them in data structure at the <strong>start of program</strong>.<br/> First file contains names of two other files and so on ( this is explained more under example of first file).\nEach file has same structure:<br/>  </p>\n\n<blockquote>\n  <p>[Title of file]<br/> [name of file X]<br/>[name of file Y]<br/>[Text]</p>\n</blockquote>\n\n<p>, for <strong>example</strong>,  <strong>first file</strong> will looks like this: <br/> </p>\n\n<p><code>File 1</code><br/> <code>file_8.txt</code><br/>  <code>file_25.txt</code><br/><code>Text: \"this is some example text, lenght is unknown so</code><br/> <code>so i will have to use  malloc and realloc to</code><br/> <code>dynamicaly store it.\"</code>\n<br/>\n<br/>\n<br/>\nThe name of first file  is typed in stdin by user when starting a program \n<br/>(example:  <code>./task1 page_1.txt</code>)<br/>\n<br/></p>\n\n<blockquote>\n  <p>The first line stores the title of the file. <br/>The second and third lines each contain a file name of a next file that i have to read/store.If there are no further names of files on 2nd and 3rd line, both of the lines will have \" <strong>-\\n</strong> \".<br/> Text starts at fourth line (can have multiple lines like in example above)  </p>\n</blockquote>\n\n<p>My <strong>struct</strong> for now: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct \n{\n    char title[1000];    // should use malloc and realloc and not this way\n    char file_x[1000];  // dynamically\n    char file_y[1000];  // dynamically\n    char text[10000]; \n\n} Story;\n</code></pre>\n\n<p>My <strong>main</strong> looks like this: </p>\n\n<pre><code>int main (int argc,char *argv[])\n{\n    char c[100];\n    char buffer[100];\n    FILE *input = fopen(argv[1], \"r\");\n    Story *temp = (Story*) malloc(sizeof(Story) * 8);\nif(input)\n{\n    int flag = 0;\n    while (fgets(c, sizeof(buffer),input) != NULL)      \n    {\n        if(flag == 0)\n        {\n            sscanf(c, \"%s\", temp-&gt;title);\n        }       \n        else if(flag == 1)\n        {\n            sscanf(c, \"%s\", temp-&gt;file_x);\n        }\n        else if(flag == 2)\n        {\n            sscanf(c, \"%s\", temp-&gt;file_y);\n        }\n        else\n        {\n            while(!feof(input))\n            {\n                fread(temp-&gt;text, sizeof(Story),1,input);\n            }\n        }\n        flag++;\n    }\n    printf(\"%s\\n%s\\n%s\\n\", temp-&gt;title,\n    temp-&gt;file_x, temp-&gt;file_y);\n}\nelse if (input == NULL)\n{\n    printf(\"ERROR MESSAGE HERE \\n\");\n    return 1;\n}\nfree(temp);\nfclose(input);\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>For now i managed to open first file and store it to structure. I need an idea how to open and store all other files and also have to implement it using dynamic memory allocation. <br/>\nAny advice is greatly appreciated.</p>\n"}, {"tags": ["c", "depth-first-search"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1511996322, "post_id": 47563251, "comment_id": 82084416, "body": "Show the <i>actual</i> error, not your interpretation."}, {"owner": {"reputation": 5620, "user_id": 6207775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-829KDarOdM8/AAAAAAAAAAI/AAAAAAAAQvE/GIRSun9xf9s/photo.jpg?sz=128", "display_name": "Ayushya", "link": "https://stackoverflow.com/users/6207775/ayushya"}, "edited": false, "score": 2, "creation_date": 1511996633, "post_id": 47563251, "comment_id": 82084527, "body": "You can include some details like &quot;expected behavior&quot; and &quot;actual behavior&quot;"}, {"owner": {"reputation": 11, "user_id": 9028218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0ba7bee9447ae1c0306ce19cf8519a4?s=128&d=identicon&r=PG&f=1", "display_name": "Leo ", "link": "https://stackoverflow.com/users/9028218/leo"}, "edited": false, "score": 0, "creation_date": 1511997502, "post_id": 47563251, "comment_id": 82084820, "body": "I put a comment at the last line of code and explained what the compiler said."}, {"owner": {"reputation": 519, "user_id": 7304514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e4ab7a095c59c76e18a1c8ed1e272c?s=128&d=identicon&r=PG&f=1", "display_name": "Ordoshsen", "link": "https://stackoverflow.com/users/7304514/ordoshsen"}, "edited": false, "score": 0, "creation_date": 1512000381, "post_id": 47563251, "comment_id": 82085755, "body": "also please compile with -Wall and possibly -pedantic flags and post any warnings the compiler complains about before the error. Oh and definition of nullVtx might come handy too"}, {"owner": {"reputation": 11, "user_id": 9028218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0ba7bee9447ae1c0306ce19cf8519a4?s=128&d=identicon&r=PG&f=1", "display_name": "Leo ", "link": "https://stackoverflow.com/users/9028218/leo"}, "edited": false, "score": 0, "creation_date": 1512001683, "post_id": 47563251, "comment_id": 82086078, "body": "Oh yeah, nullVtx is just me trying to figure out if the error was coming from the other return statements. So I created a vertex pointer that was empty and sent it through, but didn&#39;t work. Originally, those return statements sent out the key word &quot;NULL&quot;.  It does not make any difference, it still keeps giving that same error, which is only that one error."}, {"owner": {"reputation": 11, "user_id": 9028218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0ba7bee9447ae1c0306ce19cf8519a4?s=128&d=identicon&r=PG&f=1", "display_name": "Leo ", "link": "https://stackoverflow.com/users/9028218/leo"}, "edited": false, "score": 0, "creation_date": 1512003382, "post_id": 47563251, "comment_id": 82086519, "body": "OK, problem solved I feel stupid now. I forgot to compile my header file..... The whole time I was compiling the c files and forgot that I edited my header file but didn&#39;t compiled it."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1512004114, "post_id": 47563251, "comment_id": 82086724, "body": "If your build system isn&#39;t catching header file changes, you really should get this fixed."}], "owner": {"reputation": 11, "user_id": 9028218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0ba7bee9447ae1c0306ce19cf8519a4?s=128&d=identicon&r=PG&f=1", "display_name": "Leo ", "link": "https://stackoverflow.com/users/9028218/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1522004591, "creation_date": 1511996237, "last_edit_date": 1522004591, "question_id": 47563251, "link": "https://stackoverflow.com/questions/47563251/my-depth-first-search-function-is-receiving-the-wrong-data-type-even-though-im", "title": "My Depth First Search function is receiving the wrong data type even though I&#39;m sending the correct pointer", "body": "<p>My c compiler complains in this code because the \"VERTEX* getAdjUnvisitedVertex(VERTEX* first)\" function returns an integer instead of a VERTEX pointer.<br/>\nSo when I call the function and try to store it as a \"VERTEX*\" it crashes. The compiler lets me store it as an integer though. </p>\n\n<p>I only included the two functions that were giving me trouble and my header file. They are all separate files.\nI also labeled the line that makes the compiler upset, which is at the end. The actual message that I get from the compiler is: \"warning: assignment makes pointer from integer without a cast\". </p>\n\n<p>I'm new to c programming and I really don't understand why is sending an integer. Here is my code:</p>\n\n<pre><code>//////////My Header File//////////\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, const char *argv[]);\ntypedef struct VERTEX VERTEX;\ntypedef struct EDGE EDGE;\ntypedef struct GRAPH GRAPH;\n\n\nstruct VERTEX{\n    char c;\n    bool isVisited;\n    EDGE* p;\n};\n\nstruct EDGE{\n    VERTEX* v;\n    EDGE* q;\n};\n\nstruct GRAPH{\n    int numVertices;\n    VERTEX** adjLists;\n};\n\n\nVERTEX* makeVertex(char ch);\nGRAPH* makeGraph(int length);\nvoid addEdge(GRAPH* graph, char src, char dest);\nvoid displayGraph(GRAPH* graph);\nEDGE* makeEdge(VERTEX* vertex);\nVERTEX* getAdjUnvisitedVertex(VERTEX* first);\nvoid DFS(GRAPH* graph);\n//////////end of my.h/////////////\n\n\n\n\n    ////////getUnvisited function that is supposed to send a vertex////////\n    #include \"my.h\"\n    VERTEX* getAdjUnvisitedVertex(VERTEX* first){\n\n    VERTEX* nullVtx = NULL; //This is a null vertex, it is used in case the\n                            //function finds the end of the vertex list.\n\n    EDGE* currentE = first-&gt;p;//move to next edge that contains next vertex\n    if(currentE ==  NULL)//if there is no edge  send an empty vertex pointer\n            return nullVtx;\n    while((currentE -&gt; v -&gt; isVisited)){ \n            if(currentE -&gt; q == NULL){\n\n                  return nullVtx;\n            }\n            else\n            currentE = currentE -&gt; q;\n    }\n\n    return currentE-&gt; v;//This is where it should send a vertex\n                        // v is the vertex included in currentE\n                        //compiler does not complain here though\n    }\n\n\n\n\n//////DFS function that reads an integer instead of vertex pointer////\n#include \"my.h\"\n\nvoid DFS(GRAPH* graph){\nVERTEX* currentV = graph-&gt;adjLists[0];\ncurrentV -&gt; isVisited = true;\nprintf(\"%c\",currentV -&gt; c);\n\ncurrentV  = getAdjUnvisitedVertex(currentV);//This is where the compiler \n                                 //says that I set a vertex pointer equal to \n                                 // an int\n/////warning: assignment makes pointer from integer without a cast\n\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct", "malloc", "bus-error"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 6, "creation_date": 1511995190, "post_id": 47562999, "comment_id": 82083957, "body": "<code>ent = malloc(sizeof(*ent));</code> overwrites the function agument passed. End of. All that remains is a memory leak and undefined behaviour in <code>main</code>. Crazy - <code>entity_t* ent;</code> has not even been initiliased to <code>NULL</code>, so it might even do something bizzarre without breaking."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1511995929, "post_id": 47562999, "comment_id": 82084239, "body": "@WeatherVane that one again..."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511996485, "post_id": 47562999, "comment_id": 82084471, "body": "when changing, in a sub function, where a pointer points in the calling function, the parameter to the sub function must be the address of the pointer.  In the current scenario, the call should be: <code>entity_init( &amp;ent, 10, 24);</code> and signature should be: <code>void entity_init(entity_t** ent, int _x, int _y)</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511996553, "post_id": 47562999, "comment_id": 82084496, "body": "when writing variable, parameter, and macro names, do NOT use a leading underscore.  The leading underscore, especially when followed by a capital letter, is &#39;reserved&#39; for the OS."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511996655, "post_id": 47562999, "comment_id": 82084532, "body": "regarding: <code>ent = malloc(sizeof(*ent));</code>  always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511996796, "post_id": 47562999, "comment_id": 82084579, "body": "in general, it is a poor programming practice (many examples to the contrary) to define a struct in a typedef statement.  Also, always use a &#39;tag name&#39; as that is what most debuggers use to enable display of the individual fields within the struct."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511996918, "post_id": 47562999, "comment_id": 82084625, "body": "the posted code (due to only passing the contents of <code>ent</code> (which is a pointer)) results in the parameter on the stack being updated, but not the variable declared in <code>main()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1511995835, "post_id": 47563046, "comment_id": 82084192, "body": "...or return it: &#39;entity_t* entity_init(int _x, int _y)&#39;"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1511995911, "post_id": 47563046, "comment_id": 82084229, "body": "@MartinJames Incorporated that into an expanded version of the answer :)"}, {"owner": {"reputation": 783, "user_id": 3995239, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LLKKq.png?s=128&g=1", "display_name": "Accumulator", "link": "https://stackoverflow.com/users/3995239/accumulator"}, "edited": false, "score": 0, "creation_date": 1511997425, "post_id": 47563046, "comment_id": 82084791, "body": "Why would ent ever be NULL, in the entity_new function, in the last example?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 783, "user_id": 3995239, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LLKKq.png?s=128&g=1", "display_name": "Accumulator", "link": "https://stackoverflow.com/users/3995239/accumulator"}, "edited": false, "score": 0, "creation_date": 1511997581, "post_id": 47563046, "comment_id": 82084854, "body": "@Accumulator <code>malloc</code> may fail."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 4, "last_activity_date": 1511995866, "last_edit_date": 1511995866, "creation_date": 1511995205, "answer_id": 47563046, "question_id": 47562999, "link": "https://stackoverflow.com/questions/47562999/why-does-this-c-struct-initialization-code-produce-a-bus-error/47563046#47563046", "title": "Why does this C struct initialization code produce a bus error?", "body": "<p>Move the <code>malloc</code> call outside the initialization function:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n    int x;\n    int y;\n} entity_t;\n\nvoid entity_init(entity_t* ent, int _x, int _y)\n{\n    ent-&gt;x = _x;\n    ent-&gt;y = _y;\n}\n\nint main(void)\n{\n    entity_t* ent;\n    if(NULL==(ent = malloc(sizeof(*ent))))\n        return 1;\n    entity_init(ent, 10, 24);\n    printf(\"Entity: x%d y%d\", ent-&gt;x, ent-&gt;y);\n    return 0;\n}\n</code></pre>\n\n<p>You're assigning the pointer to the allocated block to a local variable (ent). That can't affect the <code>ent</code> in <code>main</code>.</p>\n\n<p>If you wanted to keep the <code>malloc</code> in <code>entity_init</code>, you should use a double pointer, but you should also change the signature to allow for a way to signal <code>malloc</code> failure from <code>entity_init</code></p>\n\n<pre><code>int entity_init(entity_t **ent, int _x, int _y)\n{\n    if(NULL==(*ent = malloc(sizeof(**ent))))\n        return -1;\n    (*ent)-&gt;x = _x;\n    (*ent)-&gt;y = _y;\n}\n\nint main(void)\n{\n    entity_t* ent;\n    if(0&gt;entity_init(&amp;ent, 10, 24))\n        return 1;\n    printf(\"Entity: x%d y%d\", ent-&gt;x, ent-&gt;y);\n    return 0;\n}\n</code></pre>\n\n<p>A more usual pattern for this would be:</p>\n\n<pre><code>entity_t *entity_new(int _x, int _y)\n{\n    entity_t *ent = malloc(sizeof(*ent));\n    if (NULL==ent) \n        return NULL;\n    ent-&gt;x = _x;\n    ent-&gt;y = _y;\n    return ent;\n}\n\nint main(void)\n{\n    entity_t* ent;\n    if(NULL==(ent=entity_new(10,24)))\n        return 1;\n    printf(\"Entity: x%d y%d\", ent-&gt;x, ent-&gt;y);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 1, "last_activity_date": 1511996241, "last_edit_date": 1511996241, "creation_date": 1511995886, "answer_id": 47563187, "question_id": 47562999, "link": "https://stackoverflow.com/questions/47562999/why-does-this-c-struct-initialization-code-produce-a-bus-error/47563187#47563187", "title": "Why does this C struct initialization code produce a bus error?", "body": "<p>If you must allocate within the <code>entity_init()</code> function, you need to either return a pointer to the allocation, or add a layer of indirection by making <code>ent</code> a pointer to pointer to <code>entity_t</code>. In the posted code, within <code>entity_init()</code> <code>ent</code> is a <em>copy</em> of the pointer which was passed to the function. Any changes made to this pointer, such as assigning the address of a memory allocation to the pointer, will not be visible from the calling function since this copy will cease to exist after the function returns.</p>\n\n<p>Also, note that you need to check the value returned from <code>malloc()</code> to be sure that the allocation was successful. If successful, the function can continue with the initialization process; if not, <code>ent</code> can remain a null pointer, which should be checked in the calling function:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n    int x;\n    int y;\n} entity_t;\n\nvoid entity_init(entity_t **ent, int _x, int _y)\n{\n    *ent = malloc(sizeof **ent);\n    if (*ent) {\n        (*ent)-&gt;x = _x;\n        (*ent)-&gt;y = _y;\n    }\n}\n\nint main(void)\n{\n    entity_t *ent;\n    entity_init(&amp;ent, 10, 24);\n\n    if (ent == NULL) {\n        fprintf(stderr, \"Allocation failure in entity_init()\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Entity: x%d y%d\\n\", ent-&gt;x, ent-&gt;y);\n\n    return 0;\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Entity: x10 y24\n</code></pre>\n"}], "owner": {"reputation": 783, "user_id": 3995239, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LLKKq.png?s=128&g=1", "display_name": "Accumulator", "link": "https://stackoverflow.com/users/3995239/accumulator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "closed_date": 1512000910, "accepted_answer_id": 47563046, "answer_count": 2, "score": 0, "last_activity_date": 1511996241, "creation_date": 1511994977, "question_id": 47562999, "link": "https://stackoverflow.com/questions/47562999/why-does-this-c-struct-initialization-code-produce-a-bus-error", "closed_reason": "Duplicate", "title": "Why does this C struct initialization code produce a bus error?", "body": "<p>When designing a game entity system in C, I attempted an \"equals-free\" initialization approach. I was surprised to see a linter tell me there was a memory leak at the end of my init function, and that my variable <code>ent</code> was never initialized in the following code. It turned out to be right because I got a \"bus error\":</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n    int x;\n    int y;\n} entity_t;\n\nvoid entity_init(entity_t* ent, int _x, int _y)\n{\n    ent = malloc(sizeof(*ent));\n    ent-&gt;x = _x;\n    ent-&gt;y = _y;\n}\n\nint main(void)\n{\n    entity_t* ent;\n    entity_init(ent, 10, 24);\n    printf(\"Entity: x%d y%d\", ent-&gt;x, ent-&gt;y);\n    return 0;\n}\n</code></pre>\n\n<p>What I <em>thought</em> the above code would do, was take my empty <code>ent</code> pointer supplied as an argument, tell it to point to some newly allocated memory, and then fill in that memory and everything would be fine. I have no idea what it's really doing to cause a \"bus error\", am I missing something critical about pointers and malloc?</p>\n\n<p>I <em>vaguely</em> remember seeing something very similar to this done before in some C code (equals-free struct initialization) and I would strongly prefer to use an equals-free initialization style similar to this (broken) code <em>if</em> such a thing is possible in C.</p>\n"}, {"tags": ["python", "c", "numpy", "scipy", "package"], "comments": [{"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "edited": false, "score": 2, "creation_date": 1512000445, "post_id": 47562695, "comment_id": 82085769, "body": "I would recommend using Cython. See here: <a href=\"http://cython.readthedocs.io/en/latest/src/tutorial/numpy.html\" rel=\"nofollow noreferrer\">cython.readthedocs.io/en/latest/src/tutorial/numpy.html</a>"}, {"owner": {"reputation": 14220, "user_id": 3547485, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xGJWo.png?s=128&g=1", "display_name": "Kinght \u91d1", "link": "https://stackoverflow.com/users/3547485/kinght-%e9%87%91"}, "edited": false, "score": 0, "creation_date": 1512027014, "post_id": 47562695, "comment_id": 82093523, "body": "I make pure C dll for Python. To pass <code>numpy.ndarray</code> for the <code>void func(int*px);</code> of  <code>C</code> dll in Python, I use the pointer: <code>x = np.arange(10);px=x.ctypes.data</code>."}, {"owner": {"reputation": 840, "user_id": 2076725, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/17802cc66a92cb6c980a23507ac5969f?s=128&d=identicon&r=PG", "display_name": "altroware", "link": "https://stackoverflow.com/users/2076725/altroware"}, "reply_to_user": {"reputation": 14220, "user_id": 3547485, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xGJWo.png?s=128&g=1", "display_name": "Kinght \u91d1", "link": "https://stackoverflow.com/users/3547485/kinght-%e9%87%91"}, "edited": false, "score": 0, "creation_date": 1512031778, "post_id": 47562695, "comment_id": 82095858, "body": "thanks! Watch about performances? Would a well written cython package be as fast as the pure c one? @Silencer Where is documented the ctype for np.array?"}, {"owner": {"reputation": 14220, "user_id": 3547485, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xGJWo.png?s=128&g=1", "display_name": "Kinght \u91d1", "link": "https://stackoverflow.com/users/3547485/kinght-%e9%87%91"}, "edited": false, "score": 0, "creation_date": 1512032855, "post_id": 47562695, "comment_id": 82096410, "body": "@altroware Cython is another language for me. I just write pure python with pure c code, and for now it&#39;s no need for me to use Cython. I learned this in a QQ group. It works well, so I have not search for document. You may google <code>numpy ctypes</code> for some links."}], "answers": [{"comments": [{"owner": {"reputation": 840, "user_id": 2076725, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/17802cc66a92cb6c980a23507ac5969f?s=128&d=identicon&r=PG", "display_name": "altroware", "link": "https://stackoverflow.com/users/2076725/altroware"}, "edited": false, "score": 0, "creation_date": 1511994644, "post_id": 47562857, "comment_id": 82083727, "body": "But, How can I pass a \u2018numpy.array\u2019?"}], "tags": [], "owner": {"reputation": 12703, "user_id": 584597, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3d519ba6b69a89cc8ec99001eea2059b?s=128&d=identicon&r=PG", "display_name": "payne", "link": "https://stackoverflow.com/users/584597/payne"}, "is_accepted": false, "score": 0, "last_activity_date": 1511994266, "creation_date": 1511994266, "answer_id": 47562857, "question_id": 47562695, "link": "https://stackoverflow.com/questions/47562695/how-to-create-a-c-function-of-numpy-array/47562857#47562857", "title": "how to create a c function of `numpy.array`?", "body": "<p>To write a new Python function (generally) in C, see:  <a href=\"https://docs.python.org/2/extending/extending.html\" rel=\"nofollow noreferrer\">https://docs.python.org/2/extending/extending.html</a></p>\n\n<p>And here is page with an example function (addList) to use as a starting point:  <a href=\"http://book.pythontips.com/en/latest/python_c_extension.html#python-c-api\" rel=\"nofollow noreferrer\">http://book.pythontips.com/en/latest/python_c_extension.html#python-c-api</a></p>\n\n<p>Then, to access function arguments that are numpy arrays, see the Numpy C-API documentation, here:  <a href=\"https://docs.scipy.org/doc/numpy-1.13.0/reference/c-api.array.html#array-structure-and-data-access\" rel=\"nofollow noreferrer\">https://docs.scipy.org/doc/numpy-1.13.0/reference/c-api.array.html#array-structure-and-data-access</a></p>\n"}], "owner": {"reputation": 840, "user_id": 2076725, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/17802cc66a92cb6c980a23507ac5969f?s=128&d=identicon&r=PG", "display_name": "altroware", "link": "https://stackoverflow.com/users/2076725/altroware"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511994266, "creation_date": 1511993440, "question_id": 47562695, "link": "https://stackoverflow.com/questions/47562695/how-to-create-a-c-function-of-numpy-array", "title": "how to create a c function of `numpy.array`?", "body": "<p>I was looking at this tutorial:\n<a href=\"https://docs.scipy.org/doc/numpy-1.13.0/user/c-info.ufunc-tutorial.html\" rel=\"nofollow noreferrer\">https://docs.scipy.org/doc/numpy-1.13.0/user/c-info.ufunc-tutorial.html</a>\nand understood how to write <code>c</code> functions of scalar arguments (which return, say, a <code>double</code>) and <em>broadcastable</em> functions that accept as argument <code>numpy.array</code>s and return another <code>numpy.array</code> by default.</p>\n\n<p>How can I write a <code>c</code> function that takes one or more <code>numpy.array</code>s and return a scalar value, instead?</p>\n"}, {"tags": ["c", "file", "scanf", "ansi-c"], "comments": [{"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1511993526, "post_id": 47562647, "comment_id": 82083229, "body": "If you printed 5 lines to the file, you should read those 5 lines from that file, using the same format that you used to write each line."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1511993664, "post_id": 47562647, "comment_id": 82083301, "body": "1) Use the first <code>void savetofile()</code>  2) post examples of your output.  3) post the definitions of your variables."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1511993691, "post_id": 47562647, "comment_id": 82083307, "body": "Is <code>gender</code> really an <code>int</code> (or do you intend to store it as an <code>int</code>), or is it a <code>char</code>? Consider using <code>fgets()</code> to read lines of input from the file, and <code>sscanf()</code> to parse each line."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511993963, "post_id": 47562647, "comment_id": 82083424, "body": "Tip: when writing a name, recall some names have spaces in them.  So write with sentinels like <code>fprintf(savefile, &quot;&lt;%s&gt;\\n&quot;, name);</code>.  Then reading is easier to detect mal-formed data."}, {"owner": {"reputation": 1, "user_id": 9028144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1945935605682739/picture?type=large", "display_name": "Sheerley", "link": "https://stackoverflow.com/users/9028144/sheerley"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511996555, "post_id": 47562647, "comment_id": 82084497, "body": "@chux output is: 1 1 Barbara 100 50"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1511999092, "post_id": 47562647, "comment_id": 82085368, "body": "Your main issue is to specify your file format. Once that is done, coding the parser is common practice, and you&#39;ll find many books about parsing (and compiling: most compiler books are studying parsing techniques in a first part)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9028144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1945935605682739/picture?type=large", "display_name": "Sheerley", "link": "https://stackoverflow.com/users/9028144/sheerley"}, "edited": false, "score": 0, "creation_date": 1511996715, "post_id": 47562938, "comment_id": 82084556, "body": "Nah, I have to use .txt file, that is one the points in this project."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 1, "user_id": 9028144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1945935605682739/picture?type=large", "display_name": "Sheerley", "link": "https://stackoverflow.com/users/9028144/sheerley"}, "edited": false, "score": 0, "creation_date": 1511998029, "post_id": 47562938, "comment_id": 82085009, "body": "The read each line (with <code>getline</code>)"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 1, "user_id": 9028144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1945935605682739/picture?type=large", "display_name": "Sheerley", "link": "https://stackoverflow.com/users/9028144/sheerley"}, "edited": false, "score": 0, "creation_date": 1511998661, "post_id": 47562938, "comment_id": 82085229, "body": "BTW, JSON is a quite readable textual format."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1511999567, "last_edit_date": 1511999567, "creation_date": 1511994645, "answer_id": 47562938, "question_id": 47562647, "link": "https://stackoverflow.com/questions/47562647/reading-specific-lines-from-a-file-with-different-datatypes-in-c/47562938#47562938", "title": "Reading specific lines from a file with different datatypes in C", "body": "<p><a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">fscanf</a> don't know and don't care about <em>lines</em> since the end-of-line marker (e.g. the newline character) is considered as some space character. In particular, spaces, tabs, newlines in the <code>fscanf</code> format control strings play the same role (skipping space-like characters) and are handled likewise by <code>fscanf</code> when occurring as input. </p>\n\n<p>If you care about a <em>specific</em> line, you should read line by line your input file. Use <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">getline</a> like <a href=\"https://stackoverflow.com/a/9171511/841108\">here</a> (or <a href=\"http://man7.org/linux/man-pages/man3/fgets.3.html\" rel=\"nofollow noreferrer\">fgets</a>) to read lines. In other words, if you care about lines, you need to do a sequential read.</p>\n\n<p>You could parse your file twice, and remember (e.g. in some dynamically allocated array) all the offsets of line starts in the first pass (use <a href=\"http://man7.org/linux/man-pages/man3/ftell.3.html\" rel=\"nofollow noreferrer\">ftell</a> and later <code>fseek</code> in your second pass; direct access is only possible to some byte <a href=\"https://en.wikipedia.org/wiki/Offset_(computer_science)\" rel=\"nofollow noreferrer\">offset</a>, not to some line number).</p>\n\n<p>Once you have read some line, you could use common <a href=\"https://en.wikipedia.org/wiki/Parsing\" rel=\"nofollow noreferrer\">parsing</a> techniques (notably <code>sscanf</code> with <code>%n</code>, or your <a href=\"https://en.wikipedia.org/wiki/Recursive_descent_parser\" rel=\"nofollow noreferrer\">recursive descent parser</a>) to parse it. </p>\n\n<p>Be sure to <strong>specify</strong> on paper <strong>the syntax of your textual <a href=\"https://en.wikipedia.org/wiki/File_format\" rel=\"nofollow noreferrer\">file format</a></strong>, e.g. in <a href=\"https://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_form\" rel=\"nofollow noreferrer\">EBNF</a> notation. The role of newlines is your choice (you could consider them as spaces, by using <a href=\"https://en.wikipedia.org/wiki/Lexical_analysis\" rel=\"nofollow noreferrer\">lexing</a> and parsing techniques on the entire file, or you could process line by line by reading each line and parsing that line).</p>\n\n<p>BTW, your use case would rather suggest some other approaches. E.g. using databases (perhaps <a href=\"http://sqlite.org/\" rel=\"nofollow noreferrer\">Sqlite</a>), using indexed files \u00e0 la <a href=\"http://www.gnu.org.ua/software/gdbm/manual/gdbm.html\" rel=\"nofollow noreferrer\">gdbm</a>, encoding your data in some textual format like <a href=\"http://json.org/\" rel=\"nofollow noreferrer\">JSON</a>, XML, or  <a href=\"http://yaml.org/\" rel=\"nofollow noreferrer\">YAML</a> (for which you'll find many libraries).</p>\n\n<p>Notice that most books about <a href=\"https://en.wikipedia.org/wiki/Compiler\" rel=\"nofollow noreferrer\">compilers</a> (notably the <a href=\"https://en.wikipedia.org/wiki/Compilers:_Principles,_Techniques,_and_Tools\" rel=\"nofollow noreferrer\">Dragon Book</a>) starts with an explanation of various parsing techniques. You should read that part.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1511998285, "creation_date": 1511998285, "answer_id": 47563585, "question_id": 47562647, "link": "https://stackoverflow.com/questions/47562647/reading-specific-lines-from-a-file-with-different-datatypes-in-c/47563585#47563585", "title": "Reading specific lines from a file with different datatypes in C", "body": "<p>There are <em>many</em> ways to solves this - each with strengths and weaknesses.</p>\n\n<p>How about a single line with \"tags\", markers in the file to indicate data ID?</p>\n\n<pre><code>void savetofile(int run, int gender, char *name, int points1, int points2) {\n  fprintf(savefile, \"r:%d g:%d n:\\\"%s\\\" p1:%d p2:%d\\n\", \n    run, gender, name, points1, points2);\n}\n\n// return 1: success, EOF:no more 0:problem data\nint readfile(int &amp;run, int &amp;gender, char *name, int *points1, int *points2) {\n  char buf[100];  // Size: 2x longest expected line\n  if (fgets(buf, sizeof buf, savefile) == NULL) return EOF;\n  if (sscanf(buf, \"r:%2d g:%1d n:\\\"%19[^\\\"]\\\" p1:%3d p2:%3d\", \n    &amp;run, &amp;gender, name, &amp;points1, &amp;points2) != 5) return 0;\n  return 1;\n}\n</code></pre>\n\n<p>All sorts of other improvements possible, especially additional error checking, but the above is to realize some ideas.</p>\n"}], "owner": {"reputation": 1, "user_id": 9028144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1945935605682739/picture?type=large", "display_name": "Sheerley", "link": "https://stackoverflow.com/users/9028144/sheerley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1512019116, "answer_count": 2, "score": 0, "last_activity_date": 1511999567, "creation_date": 1511993240, "last_edit_date": 1511995759, "question_id": 47562647, "link": "https://stackoverflow.com/questions/47562647/reading-specific-lines-from-a-file-with-different-datatypes-in-c", "closed_reason": "Needs details or clarity", "title": "Reading specific lines from a file with different datatypes in C", "body": "<p>I have a terrible problem with my code. I am saving some data by:</p>\n\n<pre><code>void savetofile()\n{\n  fprintf(savefile, \"%d\\n\", run); // here are 1 or 2 characters\n  fprintf(savefile, \"%d\\n\", gender); // 1 character\n  fprintf(savefile, \"%s\\n\", name); // here is string, max 20 characters\n  fprintf(savefile, \"%d\\n\", points1); // between 1 and 3 characters\n  fprintf(savefile, \"%d\\n\", points2); // between 1 and 3 characters\n}\n</code></pre>\n\n<p>How can I read them after saving? Can I somehow specific line with:</p>\n\n<pre><code>fscanf(savefile, \"%d\", &amp;gender);\n</code></pre>\n\n<p>to read specificaly line 2?</p>\n\n<p>Maybe when I save data to file as that:</p>\n\n<pre><code>void savetofile()\n{\n  fprintf(savefile, \"%d \", run); // here are 1 or 2 characters\n  fprintf(savefile, \"%d \", gender); // 1 character\n  fprintf(savefile, \"%s \", name); // here is string, max 20 characters\n  fprintf(savefile, \"%d \", points1); // between 1 and 3 characters\n  fprintf(savefile, \"%d \", points2); // between 1 and 3 characters\n}\n</code></pre>\n\n<p>It will be easier to read?</p>\n"}, {"tags": ["c", "redirect", "stdin", "execvp", "dup2"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511997304, "post_id": 47562547, "comment_id": 82084752, "body": "this question is off topic because when posting a question about a run time problem, as this question is doing, you must post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem so we can debug it."}], "owner": {"reputation": 21, "user_id": 9028107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aae3281c01d507568fda42a71ef8a1b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dulcie Jackson", "link": "https://stackoverflow.com/users/9028107/dulcie-jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1511992666, "creation_date": 1511992666, "question_id": 47562547, "link": "https://stackoverflow.com/questions/47562547/dup2-for-input-file-redirection-not-working", "title": "dup2 for Input File Redirection Not Working", "body": "<p>I am relatively new to C, and am working on an assignment in which we are required to write a shell. The shell must have most standard functionality, including file redirection and piping. File redirection must be done using dup2, and I have been encountering problems with this which I cannot find a relevant solution for on Stack Overflow or elsewhere.</p>\n\n<p>I have created a struct which stores a statement to be executed in the shell, as well as input or output redirection file pointers in the variables input_redir and output_redir. If a file pointer is set for either, the file is opened and remains open until used for execution. For each statement, I check whether the input_redir or output_redir file pointers are not NULL, and if so I use dup2 in the relevant way to redirect input or output. My code for this is as follows:</p>\n\n<pre><code>if(pid == 0) {\n            if(stat-&gt;input_redir != NULL) {\n                dup2(fileno(stat-&gt;input_redir), STDIN_FILENO);\n                fclose(stat-&gt;input_redir);\n            }\n\n            if(stat-&gt;output_redir != NULL) {\n                dup2(fileno(stat-&gt;output_redir), STDOUT_FILENO);\n                fclose(stat-&gt;output_redir);\n            } ...\n</code></pre>\n\n<p>Output to files is working perfectly, allowing me to execute commands such as 'echo hello world > testOutput.txt', but input from a file does not work at all, instead printing a blank line and then continuing to wait for the next user input. I have looked at dup2 man pages and can't seem to figure out what is going wrong here - presumably the input is causing an error? I am executing commands using execvp, which should respond to the redirection if I understand correctly.</p>\n\n<p>Many thanks for any help!</p>\n"}, {"tags": ["c", "arrays", "for-loop"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1511992651, "post_id": 47562516, "comment_id": 82082845, "body": "The last line assigns what was in line[i] (now in temp) back into its new location at line[j].  Those 3 lines swap line[i] and line[j]."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1511994719, "post_id": 47562516, "comment_id": 82083769, "body": "What do you think this one does: &#39;temp = line[i];&#39; ?"}], "answers": [{"tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": false, "score": 1, "last_activity_date": 1511992753, "creation_date": 1511992753, "answer_id": 47562569, "question_id": 47562516, "link": "https://stackoverflow.com/questions/47562516/reversing-chars-in-c/47562569#47562569", "title": "Reversing chars in C", "body": "<p>The last <code>for</code> run from <code>i</code> up and from <code>j</code> down until they meet in the middle, and switches those elements in the array.\nIn each iteration of the loop, the <code>i</code>th item is saved to <code>temp</code>, the <code>j</code>th item is placed in the <code>i</code>th place, and then the previously saved value, <code>temp</code>, is assigned to the <code>j</code>th place.</p>\n"}, {"tags": [], "owner": {"reputation": 60, "user_id": 9028126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5658f52953ee4b03be01ddd1a1e9aab9?s=128&d=identicon&r=PG&f=1", "display_name": "SAG", "link": "https://stackoverflow.com/users/9028126/sag"}, "is_accepted": true, "score": 3, "last_activity_date": 1511999442, "last_edit_date": 1511999442, "creation_date": 1511993529, "answer_id": 47562710, "question_id": 47562516, "link": "https://stackoverflow.com/questions/47562516/reversing-chars-in-c/47562710#47562710", "title": "Reversing chars in C", "body": "<p>you simply want to exchange two variables inside an array together . you won't be able to just do  <code>line[i] = line[j];</code> because the i'th item of the 'line' array will be overwritten by the j'th variable and it's initial value will be lost. so, in order to avoid i'th item from being lost, you first copy it in the 'temp' (<code>temp= line[i]</code>) , you overwrite <code>line[i]</code> by  <code>line[j]</code>, then copy temp (which is your initial value of <code>line[i]</code>)to <code>line[j]</code>.    </p>\n"}], "owner": {"reputation": 131, "user_id": 8630545, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/51098a8fe7cc3b8707a5fae8a258be30?s=128&d=identicon&r=PG&f=1", "display_name": "kron maz", "link": "https://stackoverflow.com/users/8630545/kron-maz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 47562710, "answer_count": 2, "score": 2, "last_activity_date": 1511999442, "creation_date": 1511992552, "last_edit_date": 1511993407, "question_id": 47562516, "link": "https://stackoverflow.com/questions/47562516/reversing-chars-in-c", "title": "Reversing chars in C", "body": "<p>I was looking at a function that reverses an array of <code>char</code>s and I get everything, but the one thing that confuses me is the last statement inside the last <code>for</code> loop which is <code>line[j] = temp;</code>. I don't know what this is accomplishing.</p>\n\n<pre><code>    void reverse(char line[]) {\n\n    char temp;\n    int i, j;\n\n    for (j = 0; line[j] != '\\0'; ++j)\n        ;\n    --j;\n\n    if (line[j] == '\\n') {\n        --j;\n    }\n\n    for (i = 0; i &lt; j; ++i, --j) {\n        temp = line[i];\n\n        line[i] = line[j];\n\n        //This statement is the one in which I dont understand it's function\n        line[j] = temp;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "string", "printf", "const-char"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 5, "creation_date": 1511992618, "post_id": 47562493, "comment_id": 82082825, "body": "<code>r</code> is locally-scoped.  Once you return from that function, it loses scope and the data is garbage.  Use <code>malloc</code> to allocate space on the heap."}], "answers": [{"tags": [], "owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "is_accepted": true, "score": 2, "last_activity_date": 1512002877, "last_edit_date": 1512002877, "creation_date": 1511994027, "answer_id": 47562807, "question_id": 47562493, "link": "https://stackoverflow.com/questions/47562493/why-cant-my-call-to-printf-display-the-right-characters-in-console/47562807#47562807", "title": "Why can&#39;t my call to printf() display the right characters in console?", "body": "<pre><code>const int msg_size = sizeof(message) / sizeof(message[0]);\n</code></pre>\n\n<p>is all wrong here.</p>\n\n<p>message is a <code>char*</code>, so <code>sizeof(message)</code> will be the size of a pointer to char.</p>\n\n<p>And since <code>message[0]</code> is a char, <code>sizeof(message[0])</code> is one by definition. So your <code>msg_size</code> will be the size of a pointer to char.</p>\n\n<p>You need to pass the length of the String into your <code>rstr()</code> function.</p>\n"}], "owner": {"reputation": 103, "user_id": 8239925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9533b3f0a56a8087f4658de50550ec00?s=128&d=identicon&r=PG&f=1", "display_name": "Quoc-Minh", "link": "https://stackoverflow.com/users/8239925/quoc-minh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 47562807, "answer_count": 1, "score": -1, "last_activity_date": 1512002877, "creation_date": 1511992450, "question_id": 47562493, "link": "https://stackoverflow.com/questions/47562493/why-cant-my-call-to-printf-display-the-right-characters-in-console", "title": "Why can&#39;t my call to printf() display the right characters in console?", "body": "<p>In visual studio, I can clearly see that the <code>rstr()</code> (to reverse string) function returns \"olla\\0\", but the console display shows unreadable character symbols. Also, for some reason, after the call to <code>printf()</code>, the variable <code>reverse</code> transforms into unreadable character values too while watching variables in debug mode. Does anyone know how to correctly display the string returned by <code>rstr()</code>?</p>\n\n<pre><code>#include \"stdio.h\"\n\nconst char* rstr(const char* message) {\n\n    const int msg_size = sizeof(message) / sizeof(message[0]);\n    char r[msg_size + 1];\n\n    for (int i = 0; i &lt; msg_size; ++i) {\n        r[i] = message[msg_size - i - 1];\n        if (i == (msg_size - 1))\n            r[msg_size] = '\\0';\n    }\n\n    return r;\n}\n\nint main() \n{\n    const char* reversed = rstr(\"allo\");\n    printf(\"Reversed string is: %s\\n\", reversed);\n\n    getchar();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "common-lisp", "ecl"], "answers": [{"comments": [{"owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "edited": false, "score": 0, "creation_date": 1512007898, "post_id": 47563898, "comment_id": 82087633, "body": "Thanks for the detailed answer!"}, {"owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "edited": false, "score": 0, "creation_date": 1512020709, "post_id": 47563898, "comment_id": 82090925, "body": "Also, are you aware of any documentation which enumerates all of the available types? I&#39;ve searched both before/after receiving your answer and haven&#39;t found anything relevant."}, {"owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "reply_to_user": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "edited": false, "score": 1, "creation_date": 1512063840, "post_id": 47563898, "comment_id": 82116090, "body": "They are listed here: <a href=\"https://common-lisp.net/project/ecl/static/ecldoc/Extensions.html#Primitive-Types\" rel=\"nofollow noreferrer\">common-lisp.net/project/ecl/static/ecldoc/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "is_accepted": true, "score": 5, "last_activity_date": 1512063888, "last_edit_date": 1512063888, "creation_date": 1512000429, "answer_id": 47563898, "question_id": 47562440, "link": "https://stackoverflow.com/questions/47562440/how-can-i-return-a-string-from-a-call-to-ffic-inline-in-ecl/47563898#47563898", "title": "How can I return a string from a call to ffi:c-inline in ecl?", "body": "<p>Use <code>:cstring</code> instead of <code>:string</code>:</p>\n\n<p>constants.h:</p>\n\n<pre><code>#define ORGANIZATION \"foobar\"\n</code></pre>\n\n<p>ecl.lsp:</p>\n\n<pre><code>(ffi:clines \"#include \\\"./constants.h\\\"\")\n(defun myfun ()\n  (ffi:c-inline () () :cstring \"ORGANIZATION\" :one-liner t))\n</code></pre>\n\n<p>From ecl prompt:</p>\n\n<pre><code>&gt; (compile-file \"ecl.lsp\" :load t)\n...\n&gt; (myfun)\n\n\"foobar\"\n&gt; \n</code></pre>\n\n<p>Reference: <a href=\"https://common-lisp.net/project/ecl/static/ecldoc/Extensions.html#Primitive-Types\" rel=\"nofollow noreferrer\">https://common-lisp.net/project/ecl/static/ecldoc/Extensions.html#Primitive-Types</a></p>\n"}], "owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 47563898, "answer_count": 1, "score": 2, "last_activity_date": 1512063888, "creation_date": 1511992246, "question_id": 47562440, "link": "https://stackoverflow.com/questions/47562440/how-can-i-return-a-string-from-a-call-to-ffic-inline-in-ecl", "title": "How can I return a string from a call to ffi:c-inline in ecl?", "body": "<p>How can I return a string constant from a call to <code>ffi:c-inline</code>?</p>\n\n<p>I've tried variations of the following without success (<code>ORGANIZATION</code> is a constant defined in constants.h):</p>\n\n<pre><code>(ffi:clines \"#include \\\"./constants.h\\\"\")\n(ffi:c-inline () () :string \"ORGANIZATION\" :one-liner t)\n</code></pre>\n\n<p>The example above results in the following compiler error:</p>\n\n<blockquote>\n  <p>Unknown representation type :STRING</p>\n</blockquote>\n"}, {"tags": ["c", "algorithm", "parameters", "equation"], "comments": [{"owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "edited": false, "score": 0, "creation_date": 1511994127, "post_id": 47562431, "comment_id": 82083508, "body": "<a href=\"https://math.stackexchange.com/questions/20717/how-to-find-solutions-of-linear-diophantine-ax-by-c\" title=\"how to find solutions of linear diophantine ax by c\">math.stackexchange.com/questions/20717/&hellip;</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511996083, "post_id": 47562431, "comment_id": 82084310, "body": "Start  by posting the program that you could easily write down.  Doing so adds clarity to your goal and serves as a base line for performance testing."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511997817, "post_id": 47562431, "comment_id": 82084932, "body": "Did you ever take geometry when in school?  The answer to your question is very simple when using the equations taught in geometry."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511997871, "post_id": 47562431, "comment_id": 82084956, "body": "what is a ??mininal??  what is meant by a ??neutral n??  what is meant by ??absoult??   Please use your spell checker, so we are not guessing as to your meaning."}], "owner": {"reputation": 323, "user_id": 9028098, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c6998a17853d32e83c5f8f7eec078b2e?s=128&d=identicon&r=PG&f=1", "display_name": "Ofek Pintok", "link": "https://stackoverflow.com/users/9028098/ofek-pintok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1511993001, "creation_date": 1511992222, "last_edit_date": 1511993001, "question_id": 47562431, "link": "https://stackoverflow.com/questions/47562431/finding-a-mininal-parameters-of-distance-in-equation-c", "title": "Finding a mininal parameters of distance in equation (C)", "body": "<p>I need to write a function that gets a neutral n that bigger then 7. the function calculting the equation 3x+5y = n and prints the value of x and y, but if there are more then one answer, it should check which one of them as the minimal absoult value (|x-y|), and print it. \n(for example, if the n is 34 then the two results are (3,5) and (8,2) but it would print (3,5).</p>\n\n<p>So, I could easly write down a program with 2 for loops and check x and y one by one until i get a result, then compare the results.. but it won't be effective. I feel that there is a better way but I couldn't find it. \nmy toughts were about using mod maybe, but I couldn't develope it. </p>\n"}, {"tags": ["c", "parameter-passing", "void-pointers"], "comments": [{"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 4, "creation_date": 1511992118, "post_id": 47562360, "comment_id": 82082556, "body": "is a <code>struct</code> the construct you are looking for?"}, {"owner": {"reputation": 13, "user_id": 8768023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a623b5de98c2ca19d59ef106003e1e?s=128&d=identicon&r=PG&f=1", "display_name": "n k", "link": "https://stackoverflow.com/users/8768023/n-k"}, "reply_to_user": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1511992729, "post_id": 47562360, "comment_id": 82082884, "body": "oh I didnt think of that!"}], "answers": [{"tags": [], "owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "is_accepted": true, "score": 0, "last_activity_date": 1511995134, "creation_date": 1511995134, "answer_id": 47563030, "question_id": 47562360, "link": "https://stackoverflow.com/questions/47562360/a-good-way-to-pass-several-arguments-into-one-void-pointer-argument-c/47563030#47563030", "title": "A good way to pass several arguments into one void pointer argument? (C)", "body": "<p>You do the same thing as in Python: you pass an argument that's a compound object made of multiple objects. Except that because C is a low-level language, you need to manage several things manually. You need to declare a type for the compound object, you need to ensure that you're using that type consistently, and you need to manage the memory for the compound object. So it's the same conceptual core as in Python, but significantly more difficult in practice.</p>\n\n<p>C has static typing and its type system doesn't have structural aggregate types, so you need to declare a type for the data you're going to pass. Say you want to pass an integer and a character.</p>\n\n<pre><code>typedef struct {\n    int y;\n    char *z;\n} thread_param_t;\n</code></pre>\n\n<p>When you call the thread creation function, you need to create an object of this type and pass a pointer to it.</p>\n\n<pre><code>thread_param_t param = {42, \"hello\"};\npthread_create(thread, attr, entry_point, &amp;param);\n\u2026\npthread_join(thread, NULL);\n</code></pre>\n\n<p>The function that runs the code of the thread takes an argument of type <code>void*</code>. What's <code>void*</code>? It's a way to do polymorphism in C. A pointer to <code>void</code> is a pointer that doesn't say what it points to. It can't be used directly other than to pass it around, but a pointer to any type can be converted to a pointer to void and vice versa. For example, the 4th argument to <code>pthread_create</code> has the type <code>void*</code>, and above I passed a parameter of type <code>thread_param_t*</code>.</p>\n\n<pre><code>void* entry_point(void *param_arg) {\n    thread_param_t *param = param_arg;\n    printf(\"entry_point called with y=%d and z=%s\\n\", param-&gt;y, param-&gt;z);\n    \u2026\n}\n</code></pre>\n\n<p>Note that C doesn't carry around type information at runtime. It's ok to convert a pointer to <code>void*</code> and back to the original type. It isn't ok to convert a pointer to <code>void*</code> and then to a pointer to a different type, but if you accidentally do this, you won't get a nice exception, you'll get a crash if you're lucky and memory corruption or other hard-to-debug behavior if you aren't.</p>\n\n<p>In addition, you need to manage the memory used by the parameter object. Above, I showed how to declare a parameter object as a local variable. If you put this in a function, then the object only exists until the function returns. (If <code>param</code> is declared in a block, it's only valid until the block's closing brace.) That's fine if the function waits for the thread to finish accessing the parameter object \u2014\u00a0above I showed it waiting for the thread to end. But often that's not good enough, so you'll need to allocate memory dynamically.</p>\n\n<pre><code>thread_param_t *param;\nparam = malloc(sizeof(*param));\nif (param == NULL) \u2026;\npthread_create(thread, attr, entry_point, &amp;param);\n</code></pre>\n\n<p>Since the object is allocated dynamically, you'll need to call <code>free</code> on it at some point, presumably in <code>entry_point</code> after it's finished using the object.</p>\n"}], "owner": {"reputation": 13, "user_id": 8768023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a623b5de98c2ca19d59ef106003e1e?s=128&d=identicon&r=PG&f=1", "display_name": "n k", "link": "https://stackoverflow.com/users/8768023/n-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "accepted_answer_id": 47563030, "answer_count": 1, "score": 1, "last_activity_date": 1511995134, "creation_date": 1511991884, "question_id": 47562360, "link": "https://stackoverflow.com/questions/47562360/a-good-way-to-pass-several-arguments-into-one-void-pointer-argument-c", "title": "A good way to pass several arguments into one void pointer argument? (C)", "body": "<p>For example, in Python, if you wanted to pass several things into one argument you can just pass a tuple like:</p>\n\n<pre><code>thread_create(v, w, x, (y, z))\n</code></pre>\n\n<p>I had an idea to pass an array of pointers to the things I want to access in the other function, but they are of different types. Is there a way to make an array of void pointers or something like that? </p>\n\n<p>the argument is of type void* , a concept which I am kind of really unfamiliar with. </p>\n"}, {"tags": ["c", "char", "int"], "comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1511991961, "post_id": 47562325, "comment_id": 82082478, "body": "Does those values Always have the same length (<code>3</code>)?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1511991971, "post_id": 47562325, "comment_id": 82082483, "body": "Perhaps <code>sscanf(input_E_human, &quot;$R%d&quot;, &amp;register_index);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "is_accepted": false, "score": 1, "last_activity_date": 1511992629, "creation_date": 1511992629, "answer_id": 47562538, "question_id": 47562325, "link": "https://stackoverflow.com/questions/47562325/how-to-take-a-char-containing-the-string-rx-where-x-is-a-number-and-sto/47562538#47562538", "title": "How to take a char * containing the string &quot;$Rx&quot;, where &#39;x&#39; is a number, and store the x to a an integer?", "body": "<p>If it is always the third character and always one character long you can simply subtract <code>\u20190\u2019</code> from it and you get it as a number. C standard requires digits to be sequential so this works. </p>\n\n<pre><code>register_index1 = input_E_human[2] - \u20180\u2019;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": false, "score": 0, "last_activity_date": 1511997802, "last_edit_date": 1511997802, "creation_date": 1511992991, "answer_id": 47562617, "question_id": 47562325, "link": "https://stackoverflow.com/questions/47562325/how-to-take-a-char-containing-the-string-rx-where-x-is-a-number-and-sto/47562617#47562617", "title": "How to take a char * containing the string &quot;$Rx&quot;, where &#39;x&#39; is a number, and store the x to a an integer?", "body": "<p>If you do not care about the length if is <code>3</code> or not, one way will be like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint ret ( const char *src );\n\nint main(void){\n    char ptr[] = \"$R3\";\n    int number = ret( ptr );\n\n    if ( number &lt; 0 ){\n        printf(\"There was no number Found!\\n\");\n        /* do something here */\n    }else{\n        printf(\"Number = %d\\n\", number);\n    }\n}\n\nint ret ( const char *src ){\n    int i = 0;\n    int tmp = 0;\n    int count = 0;\n\n    while(src[i] != '\\0' ){\n        if( isdigit (src[i]) ){ // if( ( src[i] &gt;= '0' ) &amp;&amp; ( src[i] &lt;= '9' )  ){}\n            tmp = src[i] - '0';\n            count++;\n        }\n        i++;\n    }\n\n    if ( count == 0 ){\n        return -1;\n    }else{\n        return tmp;\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Number = 3\n</code></pre>\n\n<p>Like you noticed all you need to do is to subtract <code>ptr[i]</code> with <code>'0'</code>.</p>\n\n<p>Of course if there are more than one number I am sure you can now adapt the code to your needs. But If you care only for the last number, then this code is fine. </p>\n\n<p>Even if you have a string like this <code>\"$5H4j9R3\"</code> it will still print <code>3</code> which is the last number.</p>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 1, "last_activity_date": 1511995698, "creation_date": 1511995698, "answer_id": 47563148, "question_id": 47562325, "link": "https://stackoverflow.com/questions/47562325/how-to-take-a-char-containing-the-string-rx-where-x-is-a-number-and-sto/47563148#47563148", "title": "How to take a char * containing the string &quot;$Rx&quot;, where &#39;x&#39; is a number, and store the x to a an integer?", "body": "<p><code>input_E_human[2]</code> is the third character in <code>input_E_human</code>. But <code>atoi</code> takes a <em>pointer</em> to a sequence of characters, or in other words the <em>address</em> of the first character in the string containing the integer. That would be <code>&amp;input_E_human[2]</code>, which could also be written <code>input_E_human + 2</code>. </p>\n\n<p>Which of those you choose depends on your preferred style (I usually go with the first one but there is no hard and fast rule), but understanding why they are the same is essential for understanding C.</p>\n"}], "owner": {"reputation": 41, "user_id": 8914245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11281bcdc4888d23c702ee2f16cb4dc?s=128&d=identicon&r=PG&f=1", "display_name": "sdepot", "link": "https://stackoverflow.com/users/8914245/sdepot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1511997802, "creation_date": 1511991716, "question_id": 47562325, "link": "https://stackoverflow.com/questions/47562325/how-to-take-a-char-containing-the-string-rx-where-x-is-a-number-and-sto", "title": "How to take a char * containing the string &quot;$Rx&quot;, where &#39;x&#39; is a number, and store the x to a an integer?", "body": "<p>So I have a text file and I read in a value and store it into a char *.  This variable will always have a number, representing the register I wish to use later in the code, as the third character (i.e. $R0 or $R1, etc.).  I want to store into a pre-initialized int called register_index1.  For reference the value read in from strtok below is $R1.</p>\n\n<p>I tried using:</p>\n\n<pre><code>    input_E_human = strtok(NULL, \" ,\");\n    register_index1 = atoi(input_E_human[2]);\n</code></pre>\n\n<p>but that made my program error out and not compile so I read online that you could just do this:</p>\n\n<pre><code>    input_E_human = strtok(NULL, \" ,\");\n    register_index1 = input_E_human[2];\n</code></pre>\n\n<p>but that's not working either.  It compiles but if I do:</p>\n\n<pre><code>    printf(\"%d\",register_index);\n</code></pre>\n\n<p>it prints out the number 49, not 1.  This is (obviously) causing unexpected behavior later on in my code.  Any help would be appreciated...</p>\n"}, {"tags": ["c", "image-processing", "optimization"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1511992033, "post_id": 47562303, "comment_id": 82082517, "body": "Take care that <code>pixels[i-3]</code> and <code>pixels[i+5]</code> don&#39;t break the array bounds. You don&#39;t show how <code>i</code> starts but you do show <code>i &lt; length</code>."}, {"owner": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1511992259, "post_id": 47562303, "comment_id": 82082634, "body": "They can&#39;t since I first check for border points. <code>i</code>, <code>row</code> and <code>column</code> start at 0 and goes through all bytes (3 bytes at a time, for RGB values). <code>width3</code> is <code>width*3</code>, which is 600 in the case of 200x200 images (should add all of this to the snippet I guess)."}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1511993098, "post_id": 47562303, "comment_id": 82083064, "body": "&quot;I could use the GPU but the transfer of memory from and to the GPU is quite costly.&quot;  Surely not as costly as doing the entire operation in the CPU!  IIRC copying to VRAM is only slightly slower than a regular <code>memcpy</code>."}, {"owner": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 0, "creation_date": 1511993310, "post_id": 47562303, "comment_id": 82083154, "body": "Are you sure? The problem with GPU is that I want to add border points to separate queues per color, but I&#39;m not sure how to do that with the GPU (very new to all of this)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "reply_to_user": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1512065008, "post_id": 47562303, "comment_id": 82116853, "body": "@0x5453 Is this well suited for the GPU to output a list of border points? The output has to be serial in nature, I assume, like a variable-sized list of x/y pairs, or else the CPU might have to do something expensive just to read back whatever the GPU outputs. I&#39;m a total novice to GPGPU but it seems awkward given the serial nature of the output."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 0, "creation_date": 1511994013, "post_id": 47562704, "comment_id": 82083454, "body": "I test for white because it&#39;s usually a rather large fraction of the image area, but it would have made sense otherwise.   I don&#39;t understand the first item ; I test for column and row indexes because each non-white pixel on the image border is a border point. Do you think I should separate the checks for the image border?   Would definitely like to know more about SSE/AVX btw, I skimmed through the wiki but wouldn&#39;t know how to use it in my case."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 1, "creation_date": 1511994331, "post_id": 47562704, "comment_id": 82083586, "body": "@HaraKikiri: loop on column=0 to column=width-2 inclusive, inside a loop on row. Consider my suggestion about integers, it handles the three components at a time. SSE is a too large topic to address here."}, {"owner": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 0, "creation_date": 1511994990, "post_id": 47562704, "comment_id": 82083878, "body": "The integer loading seems to help a great deal. Thanks a lot. If you have any links to share about SSE, I&#39;d be glad to do some reading."}, {"owner": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 0, "creation_date": 1511999143, "post_id": 47562704, "comment_id": 82085386, "body": "Why does it now consider the last pixel non-white, as well as any left-most border point? For some reason it seems to be shifted 16 times to the right."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 0, "creation_date": 1511999778, "post_id": 47562704, "comment_id": 82085572, "body": "@HaraKikiri: what is the speedup that you get ?"}, {"owner": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 0, "creation_date": 1511999897, "post_id": 47562704, "comment_id": 82085621, "body": "Used to get about 0.55ms, now about 0.35. Superb for me tbh, as there aren&#39;t that many border points left to process (maybe 400), so my whole thing takes under a ms compared with using java code which regularly takes more than a ms for just detecting border points. Plus I&#39;m probably gonna use a hash table and with your proposal I already have the rgb in an int, which can be used as the hash code."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 0, "creation_date": 1512000000, "post_id": 47562704, "comment_id": 82085655, "body": "@HaraKikiri: I exected a better improvement :("}, {"owner": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 0, "creation_date": 1512000079, "post_id": 47562704, "comment_id": 82085683, "body": "Well I&#39;m happy with it, only thing is that if there is a non-white pixel to the right of the current pixel, the rgb of the current pixel becomes weird. If the current pixel is white it&#39;s like it shifts to the right twice. Any idea why? Seems like a silly error."}, {"owner": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 0, "creation_date": 1512001391, "post_id": 47562704, "comment_id": 82085997, "body": "Well I managed to make it work (had to be (pixels -1) instead of (pixels), (pixels + 2) instead of (pixels + 3), ... always subtracting 1). <a href=\"https://imgur.com/a/VgRYf\" rel=\"nofollow noreferrer\">See here for comparison of speed JAVA versus JNI implementation</a>"}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 0, "creation_date": 1512026083, "post_id": 47562704, "comment_id": 82093072, "body": "@HaraKikiri: this is what I meant by &quot;computing the appropriate offset&quot; ;-)"}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 0, "creation_date": 1512026163, "post_id": 47562704, "comment_id": 82093116, "body": "@HaraKikiri: mh, the comparison of Java vs. JNI is not so instructive. I am more interested in the comparison of JNI &quot;old&quot; code vs. JNI &quot;new&quot; code."}, {"owner": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "edited": false, "score": 0, "creation_date": 1512065429, "post_id": 47562704, "comment_id": 82117116, "body": "The difference is not that large then, but it can&#39;t really be, since the loop without any comparison logic is at least 0,12ms."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1512065866, "post_id": 47562704, "comment_id": 82117372, "body": "&quot;I already have the rgb in an int [...]&quot; Did you actually make your image 32-bit (4 bytes per pixel)? That could slow things down a tad over 24-bit but it does make SIMD easier if so."}], "tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": true, "score": 3, "last_activity_date": 1511994110, "last_edit_date": 1511994110, "creation_date": 1511993494, "answer_id": 47562704, "question_id": 47562303, "link": "https://stackoverflow.com/questions/47562303/optimizing-code-that-loops-through-pixels/47562704#47562704", "title": "Optimizing code that loops through pixels", "body": "<p>A few micro-optimizations:</p>\n\n<ul>\n<li><p>reorganize the loop on the rows to only access pairs of pixels wholly inside the image, so that you needn't test the column and row indexes;</p></li>\n<li><p>do not test left and right: if two pixels differ, a single comparison suffices for both;</p></li>\n<li><p>test only for white in case you detect a border point (they are only a fraction of the image area);</p></li>\n</ul>\n\n<p>Your 12 comparisons test (to be reduced to 6) might be efficient, as it uses shortcut logics (so that all tests are performed only in uniform areas). You may try and trade it for a branchless expression, which will always be executed in full, but avoids costly conditional branches: use <code>r0 - r1 | g0 - g1 | b0 - b1</code>, which is only zero for identical colors.</p>\n\n<p>Or even better, load whole pixels at a time as an integer value, computing the appropriate offset, xor them and mask out the extra byte: <code>(*(unsigned int*)pixels ^ *(unsigned int*)(pixels + 3)) &gt;&gt; 8</code>.</p>\n\n<p>If this is not enough , you can consider to use the vector instruction set (SSE/AVX), but this is yet another story.</p>\n"}], "owner": {"reputation": 35, "user_id": 6655727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462adba054702e7e9474a673f8c525de?s=128&d=identicon&r=PG&f=1", "display_name": "Arno Breker", "link": "https://stackoverflow.com/users/6655727/arno-breker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 47562704, "answer_count": 1, "score": 1, "last_activity_date": 1511994110, "creation_date": 1511991614, "last_edit_date": 1511992398, "question_id": 47562303, "link": "https://stackoverflow.com/questions/47562303/optimizing-code-that-loops-through-pixels", "title": "Optimizing code that loops through pixels", "body": "<p>I got a 200x200 image, as a byte array of pixels (3 bytes for each pixel, representing RGB values). I'd like to select all border points, defined as a point that is not white, and lies either on the border of the image or has a neighbouring pixel of a different color. </p>\n\n<p>Wrote simple C code for this :</p>\n\n<pre><code>int i = 0, row = 0, column = 0, width3 = width*3;\nchar r,g,b;\nwhile (i &lt; length) {\n\n    r = pixels[i], g = pixels[i+1], b = pixels[i+2];\n\n    if (r != -1 || g != -1 || b != -1) { // Not white\n        // Check for border point\n        if (column == 0 || column == width-1 || row == 0 || row == height-1\n            || r != pixels[i-3] || r != pixels[i+3] || r != pixels[i-width3] || r != pixels[i+width3]\n            || g != pixels[i-2] || g != pixels[i+4] || g != pixels[i-width3+1] || g != pixels[i+width3+1]\n            || b != pixels[i-1] || b != pixels[i+5] || b != pixels[i-width3+2] || b != pixels[i+width3+2]) {\n            // Border point\n        }\n    }\n\n    i += 3;\n\n    if (++column == width) {\n        column = 0;\n        row++;\n        // printf(\"new row\");\n    }\n\n}\n</code></pre>\n\n<p>Now I'd like to know how I can speed this up as much as possible.\nEither I could use the GPU but the transfer of memory from and to the GPU is quite costly.</p>\n\n<p>Since I'm totally new to any kind of optimisation techniques such as those used in openCV, I'd like to know if there's any way to make my snippet faster.</p>\n\n<p>(for more context ; I want to interpret border points of each non-white object on the image as 'contours' of a visible object and then use Douglas-Peucker to approximate the contours as a polygon)</p>\n"}, {"tags": ["c", "unix", "fork"], "comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1515229531, "post_id": 47562137, "comment_id": 83228282, "body": "<a href=\"https://stackoverflow.com/help/someone-answers\">if an answer helps you</a> then consider <a href=\"https://meta.stackexchange.com/q/5234/230282\">accepting it</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2978, "user_id": 904148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf9d0b9f5d61826525247bd5b79cdc0?s=128&d=identicon&r=PG", "display_name": "Timothy Baldwin", "link": "https://stackoverflow.com/users/904148/timothy-baldwin"}, "is_accepted": false, "score": 2, "last_activity_date": 1511993655, "creation_date": 1511993655, "answer_id": 47562731, "question_id": 47562137, "link": "https://stackoverflow.com/questions/47562137/having-multiple-fork-and-the-extra-print/47562731#47562731", "title": "having multiple fork and the extra print", "body": "<p>After the first call to <code>fork</code> two processes are running the program both of which call <code>fork</code> creating another two processes. All four processes then call <code>printf</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1511994078, "creation_date": 1511994078, "answer_id": 47562815, "question_id": 47562137, "link": "https://stackoverflow.com/questions/47562137/having-multiple-fork-and-the-extra-print/47562815#47562815", "title": "having multiple fork and the extra print", "body": "<p>Fork splits the program in two (almost) identical pieces (in one (the child) it returns 0 and in the other a >0 pid).</p>\n\n<pre><code>      L0\n    /    \\\n   L1     L1\n  / \\     /  \\\n Bye Bye Bye Bye \n</code></pre>\n\n<p>And it's only this simple if your output is a terminal and your messages end with <code>\\n</code>, because that means each message gets flushed.</p>\n\n<p>With normal block buffering, you'd also get further output duplication due to duplication of the output buffer (which stays empty in your case, due to the <code>\\n</code>-induced flushes).</p>\n"}], "owner": {"reputation": 147, "user_id": 8513493, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e9f0858b5f0e148106aa638944f225b5?s=128&d=identicon&r=PG&f=1", "display_name": "Kasra GH", "link": "https://stackoverflow.com/users/8513493/kasra-gh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1516954563, "creation_date": 1511990927, "last_edit_date": 1516954563, "question_id": 47562137, "link": "https://stackoverflow.com/questions/47562137/having-multiple-fork-and-the-extra-print", "title": "having multiple fork and the extra print", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n\nvoid fork3() \n{\n    printf(\"\\n [%d] L0 \\n\" , getpid() );\n    fork();\n\n    printf(\"\\n [%d] L1 \\n\" , getpid() );\n    fork();\n\n    printf(\"\\n [%d] Bye \\n\", getpid() );\n} \n\nint main ()\n{\n    fork3();\n    return 0;\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code> [2880] L0 \n\n [2880] L1 \n\n [2881] L1 \n\n [2880] Bye \n\n [2882] Bye \n\n [2881] Bye \n\n [2883] Bye \n</code></pre>\n\n<p>The last print is extra! where dose it come from? There is one extra thing I don't understand.Would it be alright if someone explained?</p>\n"}, {"tags": ["c", "data-structures", "binary-search-tree"], "comments": [{"owner": {"reputation": 86506, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1511990311, "post_id": 47561965, "comment_id": 82081719, "body": "What do you mean by numbered nodes?"}, {"owner": {"reputation": 223, "user_id": 8815780, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8fc0b39c713bf19e6c73488ee3f0c0e7?s=128&d=identicon&r=PG&f=1", "display_name": "gotthecodes", "link": "https://stackoverflow.com/users/8815780/gotthecodes"}, "reply_to_user": {"reputation": 86506, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1511990366, "post_id": 47561965, "comment_id": 82081743, "body": "They should be printed: &quot;Hole 1 ....\\nHole 2....\\nHole 3....&quot; and so on. In ascending order of course."}, {"owner": {"reputation": 3965, "user_id": 755934, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/78206ae90608eeec3892338bc3f1d1b4?s=128&d=identicon&r=PG", "display_name": "Daniel Kats", "link": "https://stackoverflow.com/users/755934/daniel-kats"}, "edited": false, "score": 0, "creation_date": 1511990497, "post_id": 47561965, "comment_id": 82081800, "body": "@D.Lamkin When you want numbering do you mean in increasing order (for whatever the BST uses to order the nodes)? So number according to traversal order?"}, {"owner": {"reputation": 223, "user_id": 8815780, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8fc0b39c713bf19e6c73488ee3f0c0e7?s=128&d=identicon&r=PG&f=1", "display_name": "gotthecodes", "link": "https://stackoverflow.com/users/8815780/gotthecodes"}, "edited": false, "score": 0, "creation_date": 1511990680, "post_id": 47561965, "comment_id": 82081898, "body": "Yes, it&#39;s basically just a line number."}, {"owner": {"reputation": 3965, "user_id": 755934, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/78206ae90608eeec3892338bc3f1d1b4?s=128&d=identicon&r=PG", "display_name": "Daniel Kats", "link": "https://stackoverflow.com/users/755934/daniel-kats"}, "edited": false, "score": 0, "creation_date": 1511991161, "post_id": 47561965, "comment_id": 82082103, "body": "@D.Lamkin I&#39;m not seeing anything wrong with your initial code (just printHoles code). What is the output you&#39;re getting, and what is your expected output? Can you provide a testcase where it&#39;s failing?"}, {"owner": {"reputation": 3965, "user_id": 755934, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/78206ae90608eeec3892338bc3f1d1b4?s=128&d=identicon&r=PG", "display_name": "Daniel Kats", "link": "https://stackoverflow.com/users/755934/daniel-kats"}, "edited": false, "score": 1, "creation_date": 1511991230, "post_id": 47561965, "comment_id": 82082142, "body": "@D.Lamkin FYI you can use the following pattern so you don&#39;t have to type <code>struct Node_h</code> everywhere: <code>typedef struct Node_h { ... } Node;</code>"}, {"owner": {"reputation": 223, "user_id": 8815780, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8fc0b39c713bf19e6c73488ee3f0c0e7?s=128&d=identicon&r=PG&f=1", "display_name": "gotthecodes", "link": "https://stackoverflow.com/users/8815780/gotthecodes"}, "reply_to_user": {"reputation": 3965, "user_id": 755934, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/78206ae90608eeec3892338bc3f1d1b4?s=128&d=identicon&r=PG", "display_name": "Daniel Kats", "link": "https://stackoverflow.com/users/755934/daniel-kats"}, "edited": false, "score": 0, "creation_date": 1511991482, "post_id": 47561965, "comment_id": 82082239, "body": "@BlackSheep in the code I show I add 1000 nodes with random sizes/pid(the key). When I print I get the lines I just added to my post."}, {"owner": {"reputation": 223, "user_id": 8815780, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8fc0b39c713bf19e6c73488ee3f0c0e7?s=128&d=identicon&r=PG&f=1", "display_name": "gotthecodes", "link": "https://stackoverflow.com/users/8815780/gotthecodes"}, "reply_to_user": {"reputation": 3965, "user_id": 755934, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/78206ae90608eeec3892338bc3f1d1b4?s=128&d=identicon&r=PG", "display_name": "Daniel Kats", "link": "https://stackoverflow.com/users/755934/daniel-kats"}, "edited": false, "score": 0, "creation_date": 1511991728, "post_id": 47561965, "comment_id": 82082362, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/160144/discussion-between-d-lamkin-and-blacksheep\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 3965, "user_id": 755934, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/78206ae90608eeec3892338bc3f1d1b4?s=128&d=identicon&r=PG", "display_name": "Daniel Kats", "link": "https://stackoverflow.com/users/755934/daniel-kats"}, "edited": false, "score": 0, "creation_date": 1511992546, "post_id": 47562247, "comment_id": 82082796, "body": "I don&#39;t think this answer is correct because if I am at a node N {size=3, left=NULL, right=Node(5)}, and num=4, then I print <code>9. size=3. </code>. That doesn&#39;t seem right."}, {"owner": {"reputation": 3965, "user_id": 755934, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/78206ae90608eeec3892338bc3f1d1b4?s=128&d=identicon&r=PG", "display_name": "Daniel Kats", "link": "https://stackoverflow.com/users/755934/daniel-kats"}, "edited": false, "score": 0, "creation_date": 1511992632, "post_id": 47562247, "comment_id": 82082829, "body": "It&#39;s definitely not correct for any non-trivial BST."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 3965, "user_id": 755934, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/78206ae90608eeec3892338bc3f1d1b4?s=128&d=identicon&r=PG", "display_name": "Daniel Kats", "link": "https://stackoverflow.com/users/755934/daniel-kats"}, "edited": false, "score": 0, "creation_date": 1511993019, "post_id": 47562247, "comment_id": 82083017, "body": "@BlackSheep well, you just copied my answer and spotted my mistake with &quot;+=&quot; instead of &quot;=&quot;, gratulations ;)"}, {"owner": {"reputation": 3965, "user_id": 755934, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/78206ae90608eeec3892338bc3f1d1b4?s=128&d=identicon&r=PG", "display_name": "Daniel Kats", "link": "https://stackoverflow.com/users/755934/daniel-kats"}, "edited": false, "score": 0, "creation_date": 1511993499, "post_id": 47562247, "comment_id": 82083216, "body": "I actually was independently solving the question and came up with that solution after getting it to work on my test inputs. But it&#39;s neat that you think I copied you instead"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 3965, "user_id": 755934, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/78206ae90608eeec3892338bc3f1d1b4?s=128&d=identicon&r=PG", "display_name": "Daniel Kats", "link": "https://stackoverflow.com/users/755934/daniel-kats"}, "edited": false, "score": 0, "creation_date": 1511993588, "post_id": 47562247, "comment_id": 82083260, "body": "@BlackSheep Oh, ok, sorry, I surely misinterpreted the coincidency ;)"}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 0, "last_activity_date": 1511992870, "last_edit_date": 1511992870, "creation_date": 1511991445, "answer_id": 47562247, "question_id": 47561965, "link": "https://stackoverflow.com/questions/47561965/printing-binary-search-tree-with-numbered-nodes/47562247#47562247", "title": "Printing Binary Search Tree with numbered nodes", "body": "<p>If you rewrite your function like</p>\n\n<pre><code>int printHoles(struct Node_h* cur, int num) {\n    if(cur == NULL) {\n        return num;\n    }\n    num = printHoles(cur-&gt;left, num) + 1;\n    printf(\"Hole %d: start location = %d, size = %d\\n\", num, cur-&gt;start_addr, cur-&gt;size);\n    num = printHoles(cur-&gt;right, num);\n    return num;\n}\n</code></pre>\n\n<p>it should correctly track the number of values outputted. Before each <code>printf()</code>-call, the num is now incremented by one and each recursive call returns, how many values were output up to then. This should do what you expect.</p>\n"}, {"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1511992248, "post_id": 47562420, "comment_id": 82082625, "body": "This is another valid approach, but not valid c code"}, {"owner": {"reputation": 86506, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1511992322, "post_id": 47562420, "comment_id": 82082666, "body": "@Ctx Right. I forgot it was C."}], "tags": [], "owner": {"reputation": 86506, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "is_accepted": false, "score": 2, "last_activity_date": 1511992341, "last_edit_date": 1511992341, "creation_date": 1511992180, "answer_id": 47562420, "question_id": 47561965, "link": "https://stackoverflow.com/questions/47561965/printing-binary-search-tree-with-numbered-nodes/47562420#47562420", "title": "Printing Binary Search Tree with numbered nodes", "body": "<p>Make <code>num</code> a pointer and increment directly after the node is visited. With the following modification, <code>printHoles</code> no longer needs to return <code>int</code>:</p>\n\n<pre><code>void printHoles(struct Node_h* cur, int* num) {\n  if (cur == NULL) {\n    return;\n  }\n  printHoles(cur-&gt;left, num);\n  printf(\"Hole %d: start location = %d, size = %d\\n\", *num, cur-&gt;start_addr, cur-&gt;size);\n  (*num)++;\n  printHoles(cur-&gt;right, num);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3965, "user_id": 755934, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/78206ae90608eeec3892338bc3f1d1b4?s=128&d=identicon&r=PG", "display_name": "Daniel Kats", "link": "https://stackoverflow.com/users/755934/daniel-kats"}, "is_accepted": true, "score": 0, "last_activity_date": 1511992185, "creation_date": 1511992185, "answer_id": 47562422, "question_id": 47561965, "link": "https://stackoverflow.com/questions/47561965/printing-binary-search-tree-with-numbered-nodes/47562422#47562422", "title": "Printing Binary Search Tree with numbered nodes", "body": "<pre><code>// num is the number of nodes printed so far\n// return the number of nodes printed so far\nint printHoles(struct Node_h* cur, int num) {\n    if(NULL == cur) {\n        // last printed not changed\n        return num;\n    }\n    num = printHoles(cur-&gt;left, num);\n    printf(\"%d. size = %d\\n\", num + 1, cur-&gt;size);\n    num = printHoles(cur-&gt;right, num + 1);\n    return num;\n}\n</code></pre>\n\n<p>We can use <code>num</code> to track the number of nodes printed so far. Without using <code>t</code> this should be clearer and correct.</p>\n"}], "owner": {"reputation": 223, "user_id": 8815780, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8fc0b39c713bf19e6c73488ee3f0c0e7?s=128&d=identicon&r=PG&f=1", "display_name": "gotthecodes", "link": "https://stackoverflow.com/users/8815780/gotthecodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 47562422, "answer_count": 3, "score": 2, "last_activity_date": 1511992870, "creation_date": 1511990200, "last_edit_date": 1511991629, "question_id": 47561965, "link": "https://stackoverflow.com/questions/47561965/printing-binary-search-tree-with-numbered-nodes", "title": "Printing Binary Search Tree with numbered nodes", "body": "<p>I want to do an InOrder traversal of a BST and print the nodes. I can print the tree just fine but I can't get the numbering right. </p>\n\n<p>Here is all the code if anyone wants to compile and give it a shot. Thank you!</p>\n\n<pre><code>#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n\n\nstruct Node_h {\n    int start_addr;\n    int size;\n\n    struct Node_h* left;\n    struct Node_h* right;\n};\n\nstruct Node_h* newHoleNode(int st, int size) {\n    struct Node_h* tmp = (struct Node_h*)malloc(sizeof(struct Node_h));\n    tmp-&gt;start_addr = st;\n    tmp-&gt;size = size;\n    tmp-&gt;left = NULL;\n    tmp-&gt;right = NULL;\n    return tmp;\n}\n\nint compare(struct Node_h* lhs, struct Node_h* rhs) {\n    if(lhs-&gt;size != rhs-&gt;size) \n        return (lhs-&gt;size &lt; rhs-&gt;size) ? -1 : 1;\n    else if(lhs-&gt;start_addr == rhs-&gt;start_addr)\n        return 0;\n    else\n        return (lhs-&gt;start_addr &lt; rhs-&gt;start_addr) ? -1 : 1;\n}\n\nstruct Node_h* insertHole(struct Node_h* cur, struct Node_h* add) {\n    /* If the tree is empty, return a new node */\n    if (cur == NULL) \n        return add;\n\n    /* Otherwise, recur down the tree */\n    if (compare(add, cur) == -1) {\n        cur-&gt;left  = insertHole(cur-&gt;left, add);\n    }\n    else if(compare(add, cur) == 1) {\n        cur-&gt;right = insertHole(cur-&gt;right, add);\n    }\n\n    /* return the (unchanged) node pointer */\n    return cur;\n}\n\nint printHoles(struct Node_h* cur, int num) {\n    if(cur == NULL) {\n        return 0;\n    }\n    int t = 1 + num;\n    t += printHoles(cur-&gt;left, num);\n    printf(\"Hole %d: start location = %d, size = %d\\n\", t, cur-&gt;start_addr, cur-&gt;size);\n    t += printHoles(cur-&gt;right, t);\n    return t;\n}\n\nint main(int argc, char const *argv[]) {\n    srand(time(NULL));   // should only be called once\n    int pid = 0;\n    struct Node_h* root = NULL;\n    for (int i = 0; i &lt; 1000; ++i) {\n        int size = rand() % 10000;\n        root = insertHole(root, newHoleNode(pid++, size));\n    }\n    printHoles(root, 0);\n    return 0;\n}\n</code></pre>\n\n<p>The numbering is always either massive random +/- numbers or something like that. Help!</p>\n\n<p>Hole 1: start location = 168, size = 12</p>\n\n<p>Hole 2: start location = 665, size = 12</p>\n\n<p>Hole 4: start location = 506, size = 14</p>\n\n<p>Hole 5: start location = 908, size = 30</p>\n\n<p>Hole 11: start location = 498, size = 31</p>\n\n<p>Hole 13: start location = 340, size = 38</p>\n\n<p>Hole 14: start location = 378, size = 44</p>\n\n<p>Hole 29: start location = 303, size = 54</p>\n\n<p>Hole 30: start location = 948, size = 58</p>\n\n<p>Hole 60: start location = 503, size = 70</p>\n"}, {"tags": ["c", "file", "types", "ls"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8965725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f59ce6712cac4fc07868ec7a14226ef?s=128&d=identicon&r=PG&f=1", "display_name": "M4gie", "link": "https://stackoverflow.com/users/8965725/m4gie"}, "edited": false, "score": 0, "creation_date": 1511990144, "post_id": 47561836, "comment_id": 82081635, "body": "Yes but if i check with macros i will need to check each cases"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 3, "user_id": 8965725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f59ce6712cac4fc07868ec7a14226ef?s=128&d=identicon&r=PG&f=1", "display_name": "M4gie", "link": "https://stackoverflow.com/users/8965725/m4gie"}, "edited": false, "score": 0, "creation_date": 1511990634, "post_id": 47561836, "comment_id": 82081870, "body": "@M4gie <i>Yes but if i check with macros i will need to check each cases</i> You have to check all the cases you&#39;re interested in anyway, with or without macros."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1511989732, "creation_date": 1511989732, "answer_id": 47561836, "question_id": 47561721, "link": "https://stackoverflow.com/questions/47561721/c-sys-stat-h-find-file-type/47561836#47561836", "title": "C &lt;sys/stat.h&gt; Find file type", "body": "<p>Per the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/sys_stat.h.html#tag_13_62\" rel=\"nofollow noreferrer\">POSIX &lt;sys/stat.h> documentation</a>:</p>\n\n<blockquote>\n  <p>The following macros shall be provided to test whether a file is of\n  the specified type. The value m supplied to the macros is the value of\n  st_mode from a stat structure. The macro shall evaluate to a non-zero\n  value if the test is true; 0 if the test is false.</p>\n\n<pre><code>S_ISBLK(m)\n    Test for a block special file.\nS_ISCHR(m)\n    Test for a character special file.\nS_ISDIR(m)\n    Test for a directory.\nS_ISFIFO(m)\n    Test for a pipe or FIFO special file.\nS_ISREG(m)\n    Test for a regular file.\nS_ISLNK(m)\n    Test for a symbolic link.\nS_ISSOCK(m)\n    Test for a socket.\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 0, "last_activity_date": 1512062516, "creation_date": 1512062516, "answer_id": 47579162, "question_id": 47561721, "link": "https://stackoverflow.com/questions/47561721/c-sys-stat-h-find-file-type/47579162#47579162", "title": "C &lt;sys/stat.h&gt; Find file type", "body": "<p>yes you can use both method with predefined macros as below, open the man page of stat() system call, it says</p>\n\n<pre><code>S_IFMT     0170000   bit mask for the file type bit fields\n</code></pre>\n\n<p>So do <code>&amp;</code> of <code>st_mode</code> and <code>S_IFMT</code>, you will get file type                 </p>\n\n<pre><code>                struct stat v;\n                stat(file,&amp;v);  \n                switch (v.st_mode &amp; S_IFMT) // type of file\n                {\n\n                        case S_IFBLK:  printf(\"b\");                 break;\n                        case S_IFCHR:  printf(\"c\");                 break;\n                        case S_IFDIR:  printf(\"d\");                 break;\n                        case S_IFIFO:  printf(\"p\");                 break;\n                        case S_IFLNK:  printf(\"l\");                 break;\n                        case S_IFREG:  printf(\"-\");                 break;\n                        case S_IFSOCK: printf(\"s\");                 break;\n                        default:       printf(\"unknown?\");          break;\n                }\n</code></pre>\n\n<p>If you don't want to use macros then first find out <code>st_mode</code> value of each type of <code>files</code> &amp; then write the logic. for e.g <code>st_mode</code> value of <code>regular file</code> is <code>10664</code>, last 3 digits(664) for <code>permission</code>, write the binary of 10664 you will come to know that <code>15th</code> bit is set so do <code>st.mode &gt;&gt; 15</code> . Similarly find the st_mode value of different types of file &amp; analyse.</p>\n\n<pre><code>if( ( v.st_mode &gt;&gt; 15 &amp; 1) &amp;&amp; ( v.st_mode &gt;&gt; 14 &amp; 1) ) \n                printf(\"Socket File\\n\"); \n        else if( ( v.st_mode &gt;&gt; 15 &amp; 1) &amp;&amp; ( v.st_mode &gt;&gt; 13 &amp; 1) )\n                printf(\"Symbolic Link File\\n\");\n        else if( v.st_mode &gt;&gt; 15 &amp; 1) \n                printf(\"Regular File\\n\");\n        else if((v.st_mode &gt;&gt; 14 &amp; 1) &amp;&amp; (v.st_mode &gt;&gt; 13 &amp; 1) )\n                printf(\"Block Dev File\\n\");\n        else if(v.st_mode &gt;&gt; 14 &amp; 1) \n                printf(\"Directory File\\n\");\n        else if(v.st_mode &gt;&gt; 13 &amp; 1)\n                printf(\"Char Dev File\\n\");\n        else if(v.st_mode &gt;&gt; 12 &amp; 1)\n                printf(\"FIFO/PIPE File\\n\");\n</code></pre>\n\n<p>I hope it help's .</p>\n"}], "owner": {"reputation": 3, "user_id": 8965725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f59ce6712cac4fc07868ec7a14226ef?s=128&d=identicon&r=PG&f=1", "display_name": "M4gie", "link": "https://stackoverflow.com/users/8965725/m4gie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "accepted_answer_id": 47579162, "answer_count": 2, "score": 0, "last_activity_date": 1559823760, "creation_date": 1511989267, "last_edit_date": 1559823760, "question_id": 47561721, "link": "https://stackoverflow.com/questions/47561721/c-sys-stat-h-find-file-type", "title": "C &lt;sys/stat.h&gt; Find file type", "body": "<p>I create my own ls command for a project and I use the \"st_mode\" variable to find the files permissions but I don't use the macros.</p>\n\n<p>Ex:\nst_mode = 16877</p>\n\n<p>I convert it in octal base:</p>\n\n<p>st_mode = 40755</p>\n\n<p>I keep the three last characters and I get my permissions.</p>\n\n<p>But when I try to find the file's type, I try to use the two first characters but they don't really help me...\nSo I would like to know if I can use the two first characters to find the file's type (Link, folder,...). And if I can't, what I should use to find the file's type</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["c++", "c", "linux", "gcc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1511988981, "post_id": 47561634, "comment_id": 82081029, "body": "What&#39;s <code>-xCC</code> ? Just remove it."}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 1, "creation_date": 1511989521, "post_id": 47561634, "comment_id": 82081299, "body": "If you&#39;re migrating to 64-bit linux, you may also need to specify <code>-m32</code> which IIRC is what Oracle&#39;s compiler defaults to (if you were using the default)"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1511989688, "post_id": 47561634, "comment_id": 82081396, "body": "GCC4.1 is <b>obsolete</b> and unmaintained so don&#39;t use it. Current GCC is <a href=\"https://gcc.gnu.org/gcc-7/\" rel=\"nofollow noreferrer\">GCC 7</a>, in november 2017 (a lot of progress made since GCC4.1). GCC 8 will be released in a few weeks. Read about <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Invoking-GCC.html\" rel=\"nofollow noreferrer\">Invoking GCC</a>"}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 0, "creation_date": 1511996468, "post_id": 47561634, "comment_id": 82084463, "body": "...and if you see any errors tagged with <code>-fpermissive</code> you&#39;ll want to add that as well.  Shouldn&#39;t be an issue with C, but with C++ it might be."}], "answers": [{"tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 3, "last_activity_date": 1511989776, "creation_date": 1511989776, "answer_id": 47561856, "question_id": 47561634, "link": "https://stackoverflow.com/questions/47561634/cc-language-cc-not-recognized/47561856#47561856", "title": "cc: language CC not recognized", "body": "<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc/Overall-Options.html#index-x\" rel=\"nofollow noreferrer\">The <code>-x</code> option selects the input language</a>, so <code>-xCC</code> attempts to use <code>CC</code>, which is not known to <code>gcc</code>.  With Solaris <code>cc</code>, <code>-xCC</code> enables C++-style comments, so you may have to use <code>-std=gnu99</code> instead of <code>-xCC</code> (but it is also possible that your build of GCC 4.1 supports such comments by default).</p>\n"}], "owner": {"reputation": 13, "user_id": 3658145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac106d7787d8c0f0dca5928e1370b42e?s=128&d=identicon&r=PG&f=1", "display_name": "user3658145", "link": "https://stackoverflow.com/users/3658145/user3658145"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1272, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511989776, "creation_date": 1511988853, "last_edit_date": 1511989580, "question_id": 47561634, "link": "https://stackoverflow.com/questions/47561634/cc-language-cc-not-recognized", "title": "cc: language CC not recognized", "body": "<p>When I'm migrating my app from Solaris C compiler sunstudio/v12/SUNWspro to Linux C compiler GCC version 4.1.2 20080704, I'm seeing a CC not recognized error.</p>\n\n<p>C Command: The same command is working in solaris but not working in Linux with Gcc 4.1.2.</p>\n\n<pre><code>CFLAGS          = -c -g -xCC -I. -I${ORACLE_INCLUDE}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>cc: language CC not recognized\ncc: language CC not recognized\ncc: check*****maint.c: linker input file unused because linking not done\n</code></pre>\n\n<p>Do we need to change any parameters to be compatible with GCC 4.1.2 ?</p>\n"}, {"tags": ["c", "struct", "types", "declaration"], "answers": [{"tags": [], "owner": {"reputation": 341, "user_id": 8002326, "user_type": "registered", "profile_image": "https://graph.facebook.com/1345259895588235/picture?type=large", "display_name": "Prasanna Kumar", "link": "https://stackoverflow.com/users/8002326/prasanna-kumar"}, "is_accepted": false, "score": 1, "last_activity_date": 1511989565, "creation_date": 1511989565, "answer_id": 47561791, "question_id": 47561631, "link": "https://stackoverflow.com/questions/47561631/array-in-c-struct-declaration/47561791#47561791", "title": "Array in C struct declaration", "body": "<p>As far as structure is considered, <strong>struct</strong> is a user defined data type .\nIt allows a number of primitive data types to be grouped together under a single name .\nThe word that is <strong>immediate next to the keyword struct</strong> is the <strong>structure name</strong> .\nConsidering the example code that you provided, <strong>commands</strong> is the <strong>structure name</strong> .\nThe variables in the structure can never be initialized a value .\nSyntax for declaring structure variable is</p>\n\n<blockquote>\n  <p>struct struct_name variable_name;</p>\n</blockquote>\n\n<p>The variables within the structure can be accessed using the <strong>structure variable and dot(.) operator</strong></p>\n\n<blockquote>\n  <p>commands.tok = 'a' ;</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": true, "score": 2, "last_activity_date": 1511991305, "last_edit_date": 1511991305, "creation_date": 1511989935, "answer_id": 47561899, "question_id": 47561631, "link": "https://stackoverflow.com/questions/47561631/array-in-c-struct-declaration/47561899#47561899", "title": "Array in C struct declaration", "body": "<p>I would prefer to see <code>table</code> defined in a separate statement, like this:</p>\n\n<pre><code>struct commands\n{\n    char command[20];\n    char tok;\n};\n\nstruct commands table[] =\n{\n    \"if\", IF,\n    \"else\", ELSE,\n    \"for\", FOR,\n    \"do\", DO,\n    \"while\", WHILE,\n    \"char\", CHAR,\n    \"int\", INT,\n    \"return\", RETURN,\n    \"end\", END,\n    \"\", END\n};\n</code></pre>\n\n<p>The effect is the same. <code>table[]</code> is an array of <code>struct commands</code> elements, initialized with the values from the initializer list. The <code>enum</code> values have type <code>int</code>, with <code>ARG</code> getting a value of 0; each subsequent <code>enum</code> member has a value one greater than the one which precedes it. It must be expected that the <code>enum</code> will never grow so large that member values can't be stored in a <code>char</code>, so a <code>char</code> member in the <code>struct</code> is used to hold this value. This seems likely intended as a way to save memory by using a <code>char</code> member instead of an <code>int</code> member for <code>tok</code>, yet this would only have an impact in severely memory-constrained environments, or where many such <code>commands</code> <code>structs</code> are used.</p>\n\n<p>Note that initializing this way may trigger warnings on some compilers:</p>\n\n<blockquote>\n  <p>warning: missing braces around initializer [-Wmissing-braces]</p>\n</blockquote>\n\n<p>It would be better to place braces around the individual <code>struct</code> initializers:</p>\n\n<pre><code>struct commands\n{\n    char command[20];\n    char tok;\n}\ntable[] =\n    {\n        {\"if\", IF},\n        {\"else\", ELSE},\n        {\"for\", FOR},\n        {\"do\", DO},\n        {\"while\", WHILE},\n        {\"char\", CHAR},\n        {\"int\", INT},\n        {\"return\", RETURN},\n        {\"end\", END},\n        {\"\", END}\n    };\n</code></pre>\n\n<p>This will quiet the missing braces warning and add some clarity to the code. Another alternative would be to use the designated initializer syntax for even more clarity:</p>\n\n<pre><code>struct commands\n{\n    char command[20];\n    char tok;\n}\ntable[] =\n    {\n        {.command = \"if\",     .tok = IF},\n        {.command = \"else\",   .tok = ELSE},\n        {.command = \"for\",    .tok = FOR},\n        {.command = \"do\",     .tok = DO},\n        {.command = \"while\",  .tok = WHILE},\n        {.command = \"char\",   .tok = CHAR},\n        {.command = \"int\",    .tok = INT},\n        {.command = \"return\", .tok = RETURN},\n        {.command = \"end\",    .tok = END},\n        {.command = \"\",       .tok = END}\n    };\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 8269790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6292081ac63dfa6b568cb4b6b4516a7e?s=128&d=identicon&r=PG&f=1", "display_name": "Stepii", "link": "https://stackoverflow.com/users/8269790/stepii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 47561899, "answer_count": 2, "score": 1, "last_activity_date": 1511991305, "creation_date": 1511988837, "question_id": 47561631, "link": "https://stackoverflow.com/questions/47561631/array-in-c-struct-declaration", "title": "Array in C struct declaration", "body": "<p>Can you explain what this code does and how does <code>struct</code> declaration works?</p>\n\n<p></p>\n\n<pre><code>enum tokens\n{\n    ARG, CHAR, INT, IF, ELSE, FOR, DO, WHILE,\n    SWITCH, RETURN, EOL, FINISHED, END\n};\n</code></pre>\n\n<p></p>\n\n<p>[...]</p>\n\n<p></p>\n\n<pre><code>struct commands\n{\n    char command[20];\n    char tok;\n}\ntable[] =\n{\n    \"if\", IF,\n    \"else\", ELSE,\n    \"for\", FOR,\n    \"do\", DO,\n    \"while\", WHILE,\n    \"char\", CHAR,\n    \"int\", INT,\n    \"return\", RETURN,\n    \"end\", END,\n    \"\", END\n};\n</code></pre>\n\n<p></p>\n"}, {"tags": ["c", "arrays", "embedded", "string-literals"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1511986949, "post_id": 47561141, "comment_id": 82080013, "body": "Show the full code, please. Anyway, you can&#39;t assign <i>strings</i> to a <code>char</code> array elements."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1511986982, "post_id": 47561141, "comment_id": 82080026, "body": "Given <code>char _cylinder_types[5];</code>, just what do you think the <code>_cylinder_types[0]</code> array element is?"}], "answers": [{"comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 845, "user_id": 1150206, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af03c91f56eb9ed4c506b2471da8b7a8?s=128&d=identicon&r=PG", "display_name": "Chef Flambe", "link": "https://stackoverflow.com/users/1150206/chef-flambe"}, "edited": false, "score": 0, "creation_date": 1511987565, "post_id": 47561206, "comment_id": 82080281, "body": "@ChefFlambe Check whether the array is declared before the function definition. See also my updated post."}, {"owner": {"reputation": 845, "user_id": 1150206, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af03c91f56eb9ed4c506b2471da8b7a8?s=128&d=identicon&r=PG", "display_name": "Chef Flambe", "link": "https://stackoverflow.com/users/1150206/chef-flambe"}, "edited": false, "score": 0, "creation_date": 1511988400, "post_id": 47561206, "comment_id": 82080717, "body": "Thnx, that seemed to fix part of it.  Forgot about the assignment outside function thing.  Nice catch on the i++  Still getting the undeclared (first use in this function) error though.  I&#39;ve moved all my prototypes after the Global variable declarations so I&#39;m kind confused why its not being passed along.  Should I have it declared as an extern in the header?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 845, "user_id": 1150206, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af03c91f56eb9ed4c506b2471da8b7a8?s=128&d=identicon&r=PG", "display_name": "Chef Flambe", "link": "https://stackoverflow.com/users/1150206/chef-flambe"}, "edited": false, "score": 0, "creation_date": 1511988535, "post_id": 47561206, "comment_id": 82080784, "body": "@ChefFlambe Show the exact error message. If you have only one compilation unit then the array can be defined in the header."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 845, "user_id": 1150206, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af03c91f56eb9ed4c506b2471da8b7a8?s=128&d=identicon&r=PG", "display_name": "Chef Flambe", "link": "https://stackoverflow.com/users/1150206/chef-flambe"}, "edited": false, "score": 0, "creation_date": 1511988676, "post_id": 47561206, "comment_id": 82080864, "body": "@ChefFlambe If there are several compilation units then you should declare the array with the specifier extern in the header and define it in a module,"}, {"owner": {"reputation": 845, "user_id": 1150206, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af03c91f56eb9ed4c506b2471da8b7a8?s=128&d=identicon&r=PG", "display_name": "Chef Flambe", "link": "https://stackoverflow.com/users/1150206/chef-flambe"}, "edited": false, "score": 0, "creation_date": 1511988680, "post_id": 47561206, "comment_id": 82080866, "body": "Severity\tCode\tDescription\tProject\tFile\tLine Error\t\t&#39;_cylinder_types&#39; undeclared (first use in this function)\tV4_1\tC:\\Users\\sysadmin\\Documents\\Atmel Studio\\7.0\\projectBuilds\\V4_11_29_working\\V4_1\\lcd.c\t111"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 6, "last_activity_date": 1511988881, "last_edit_date": 1511988881, "creation_date": 1511987125, "answer_id": 47561206, "question_id": 47561141, "link": "https://stackoverflow.com/questions/47561141/char-array-not-recognized-in-function/47561206#47561206", "title": "char array not recognized in function", "body": "<p>Just declare the array like</p>\n\n<pre><code>char * _cylinder_types[5];\n^^^^^^ \n</code></pre>\n\n<p>For example in this expression statement</p>\n\n<pre><code>_cylinder_types[0] = \"Blk\";\n</code></pre>\n\n<p>the string literal <code>\"Blk\"</code> is implicitly converted to an rvalue of the type <code>char *</code>.</p>\n\n<p>And you may not place these statements</p>\n\n<pre><code>_cylinder_types[0] = \"Blk\";\n_cylinder_types[1] = \"Wht\";\n_cylinder_types[2] = \"Stl\";\n_cylinder_types[3] = \"Alu\";\n_cylinder_types[4] = \"Err\";\n</code></pre>\n\n<p>outside any function.</p>\n\n<p>You could for example initially initialize the array like</p>\n\n<pre><code> char * _cylinder_types[5] =\n {\n     \"Blk\", \"Wht\", \"Stl\", \"Alu\", \"Err\"\n };\n</code></pre>\n\n<p>If there are several compilation units in the project then the array should be declared in the header like</p>\n\n<pre><code>extern char * _cylinder_types[5];\n</code></pre>\n\n<p>and in some module defined like for example</p>\n\n<pre><code> char * _cylinder_types[5] =\n {\n     \"Blk\", \"Wht\", \"Stl\", \"Alu\", \"Err\"\n };\n</code></pre>\n\n<p>The header must be included in each module where there is a reference to the array.</p>\n\n<p>Take into account that this statement</p>\n\n<pre><code> i++;\n</code></pre>\n\n<p>shall be inside the while loop.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1511989003, "creation_date": 1511989003, "answer_id": 47561669, "question_id": 47561141, "link": "https://stackoverflow.com/questions/47561141/char-array-not-recognized-in-function/47561669#47561669", "title": "char array not recognized in function", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>does not yet compile because it is missing, amongst other things, the include statements for the header files.</li>\n<li>demonstrates how to initialize the array when it is declared, rather than via a series of assignment statements.</li>\n<li>properly declares the array as an array of pointers to strings</li>\n<li>uses an indent width of 4 spaces as that is very readable</li>\n<li>separates code blocks (for, if, else, while, do...while, switch, case, default) via a single blank line</li>\n<li>does not name the array, starting with <code>_</code> as such names are 'reserved' of the OS</li>\n<li>allows the compiler to determine the size of the array</li>\n<li>uses the 'preprocessor' operator 'sizeof' to calculate the second parameter of the <code>for()</code> statement.</li>\n<li>breaks the <code>for()</code> statement so it does not runoff the right edge of the page</li>\n<li>uses appropriate horizontal spacing, inside parens, after semicolons, after commas, etc for readability</li>\n<li>replaces the incorrect <code>lcd_write( 0 );</code> (which should be passed a character, not a integer) with <code>lcd_write( '0' );</code></li>\n</ol>\n\n<p>and now, the proposed code:</p>\n\n<pre><code>char *cylinder_types[] =\n{\n    \"Blk\",\n    \"Wht\",\n    \"Stl\",\n    \"Alu\",\n    \"Err\"\n};\n\n\nint main( void )\n{\n    for(int i=0;\n        i &lt; sizeof( cylinder_types ) / sizeof( char * );\n        i++ )\n    {\n        lcd_write( '0' );\n        lcd_position( lcd_TopLine, 1 );\n        lcd_string( \"SORTED:\" );\n        lcd_string( cylinder_types[i] );\n        lcd_write( ':' );\n        lcd_write_Num_8( drop_number[i] );\n\n        lcd_position( lcd_BotLine, 1 );\n        lcd_string( \"UNSORTED:\" );\n        lcd_string( cylinder_types[i] );\n        lcd_write( ':' );\n        lcd_write_Num_8( queued_number[i] );\n\n        mTimer( 5000 );\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 845, "user_id": 1150206, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af03c91f56eb9ed4c506b2471da8b7a8?s=128&d=identicon&r=PG", "display_name": "Chef Flambe", "link": "https://stackoverflow.com/users/1150206/chef-flambe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 47561206, "answer_count": 2, "score": 1, "last_activity_date": 1511989003, "creation_date": 1511986864, "last_edit_date": 1511987824, "question_id": 47561141, "link": "https://stackoverflow.com/questions/47561141/char-array-not-recognized-in-function", "title": "char array not recognized in function", "body": "<p>I'm working on a project for a class.  Embedded C-code.\nI'm attempting to create a char array of 5 strings that I declare globally so my LCD function can loop through the list easily.  They could be declared as const but right now I just want it to build without issue.</p>\n\n<p>Problem is I keep getting an 'undeclared' error in the function and 'conflicting types' error pointing at the declaration when I build.  The declaration looks correct but I guess it's not.  What am I missing?\nThe undeclared error will probably fix itself once the declaration is sorted out.</p>\n\n<pre><code>     // Declared before main()\n     char _cylinder_types[5];\n\n    _cylinder_types[0] = \"Blk\";\n    _cylinder_types[1] = \"Wht\";\n    _cylinder_types[2] = \"Stl\";\n    _cylinder_types[3] = \"Alu\";\n    _cylinder_types[4] = \"Err\";\n</code></pre>\n\n<p>inside my lcd.c file:</p>\n\n<pre><code>void lcd_display_update(void){\n\n  int i = 0;\n  while(i&lt;5)\n    {\n     lcd_write(0);\n     lcd_position(lcd_TopLine,1);\n     lcd_string(\"SORTED:\");\n     lcd_string(_cylinder_types[i]);\n     lcd_write(':');\n     lcd_write_Num_8(drop_number[i]);\n\n     lcd_position(lcd_BotLine,1);\n     lcd_string(\"UNSORTED:\");\n     lcd_string(_cylinder_types[i]);\n     lcd_write(':');\n     lcd_write_Num_8(queued_number[i]);\n\n     mTimer(5000);\n    }\n     i++;\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list", "shared-memory", "fifo"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1511986532, "post_id": 47560994, "comment_id": 82079829, "body": "You can&#39;t share memory allocated via <code>malloc()</code> across processes."}, {"owner": {"reputation": 533, "user_id": 4955934, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/11835c69a4a5444cde0da98f73e6345a?s=128&d=identicon&r=PG&f=1", "display_name": "Xalion", "link": "https://stackoverflow.com/users/4955934/xalion"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1511987835, "post_id": 47560994, "comment_id": 82080420, "body": "@EOF so only way is change list on table?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511989755, "post_id": 47560994, "comment_id": 82081433, "body": "for ease of readability and understanding: 1) please consistently indent the code.  Indent after every opening brace &#39;{&#39;.  Unindent before every closing brace &#39;}&#39;.   Suggest each indent level be 4 spaces.  2) separate code blocks (for, if, else, while, do...while, switch, case, default) via a single blank line."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511989848, "post_id": 47560994, "comment_id": 82081487, "body": "function <code>fork()</code> has three possible return values: 1) &lt;0, 2) =0, 3) &gt;0.  The posted code fails to handle the &lt;0 condition"}, {"owner": {"reputation": 533, "user_id": 4955934, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/11835c69a4a5444cde0da98f73e6345a?s=128&d=identicon&r=PG&f=1", "display_name": "Xalion", "link": "https://stackoverflow.com/users/4955934/xalion"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511993838, "post_id": 47560994, "comment_id": 82083358, "body": "@user3629249 there is no problem with fork... And it is not final version of code. Child is created and execute lines but didnt have impact on shared fifo."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511995860, "post_id": 47560994, "comment_id": 82084206, "body": "@Xalion, not checking for errors is a MAJOR problem. Suggest you learn to always check for errors.   My answer says why the code is not working as you seem to expect."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511995976, "post_id": 47560994, "comment_id": 82084264, "body": "when asking a question about a run time problem, as this question is doing, post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem.  Otherwise, the question is off-topic and will soon be closed."}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1511995713, "creation_date": 1511995713, "answer_id": 47563152, "question_id": 47560994, "link": "https://stackoverflow.com/questions/47560994/child-cant-write-into-shared-memory-fifo-linked-list-in-c/47563152#47563152", "title": "Child can&#39;t write into shared memory ( fifo - linked list in c)", "body": "<p>the first few lines of the posted code work with a queue on the stack, that was initialized via a call to <code>init()</code>.  </p>\n\n<p>After the call to <code>mmap()</code> a new queue is defined as being located in the memory allocated via the call to <code>mmap()</code>.  </p>\n\n<p>The posted code fails to initialize that new queue.  </p>\n\n<p>Then after the call to <code>fork()</code>, the child tries to add a entry to the queue on the (uninitialized) queue in the memory allocated by <code>mmap()</code>  so, naturally, that entry is NOT on the queue that is on the stack</p>\n\n<p>The call to <code>list_print()</code> is passed a parameter that points to the queue on the stack.  so will never see the entry in the memory allocated by <code>mmap()</code></p>\n"}], "owner": {"reputation": 533, "user_id": 4955934, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/11835c69a4a5444cde0da98f73e6345a?s=128&d=identicon&r=PG&f=1", "display_name": "Xalion", "link": "https://stackoverflow.com/users/4955934/xalion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1511995713, "creation_date": 1511986300, "question_id": 47560994, "link": "https://stackoverflow.com/questions/47560994/child-cant-write-into-shared-memory-fifo-linked-list-in-c", "title": "Child can&#39;t write into shared memory ( fifo - linked list in c)", "body": "<p>I have to resolve problem of producer and cunsumers. I can use only POSIX (without System V). I make small steps and try to implement simple sharing with child procces now. Unfortunately, child can't add anything to fifo.</p>\n\n<pre><code>        typedef struct elem{\n        int val;\n        bool a;\n        bool b;\n        bool c;\n        struct elem * next;\n    } elem_t;\n    typedef struct fifo\n    {\n        elem_t * head;\n        elem_t * tail;\n        int size;\n    }fifo_t;\n\nfifo_t* add_elem( fifo_t*, const int);\nfifo_t* remove_elem( fifo_t*);\nfifo_t* init(void);\n\nvoid list_print( const fifo_t* );\nvoid list_print_elem(const elem_t* );\n\n\nint main()\n{\n\n    int fd;\n    void *addr;\n    fifo_t * queue = NULL;\n    queue = init();\n    add_elem(queue,5);\n    add_elem(queue,8);\n    list_print(queue);\n    remove_elem(queue);\n    list_print(queue);\n\n    fd = shm_open(\"/test\",  O_CREAT | O_EXCL | O_RDWR, 0666);\n    size_t size_fifo = sizeof queue;\n    ftruncate(fd,size_fifo);\n    addr = mmap(NULL, size_fifo, PROT_READ | PROT_WRITE,MAP_SHARED ,fd, 0);\n    pid_t pidA = fork();\n    if(pidA==0){\n        fifo_t * q = (fifo_t*) addr;\n        add_elem(q,5);\n        exit(0);\n    }\n    else{\n        int status;\n        waitpid(pidA, &amp;status, 0);\n        list_print(queue);\n\n    }   \n    munmap(addr,size_fifo);\n    shm_unlink(\"/test\");\n    return 0;\n}\n</code></pre>\n\n<p>and method add:</p>\n\n<pre><code>    fifo_t * add_elem(fifo_t* s, int i)\n{\n  elem_t* p = malloc( 1 * sizeof(*p) );\n\n  if( NULL == p )\n    {\n      fprintf(stderr, \"IN %s, %s: malloc() failed\\n\", __FILE__, \"list_add\");\n      return s; \n    }\n\n  p-&gt;val = i;\n  p-&gt;next = NULL;\n\n\n\n  if( NULL == s )\n    {\n      printf(\"Queue not initialized\\n\");\n      free(p);\n      return s;\n    }\n  else if( NULL == s-&gt;head &amp;&amp; NULL == s-&gt;tail )\n    {\n      /* printf(\"Empty list, adding p-&gt;num: %d\\n\\n\", p-&gt;num);  */\n      s-&gt;head = s-&gt;tail = p;\n      s-&gt;size +=1;\n      return s;\n    }\n\n  else\n    {\n      /* printf(\"List not empty, adding element to tail\\n\"); */\n      s-&gt;tail-&gt;next = p;\n      s-&gt;tail = p;\n      s-&gt;size +=1;\n    }\n\n  return s;\n}\n</code></pre>\n\n<p>my output like that:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9H7dy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9H7dy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Main procces can add and remove elements.\nChild should add val =5 and increase size but it didnt make it.\nCan someone explain my mistakes?</p>\n"}, {"tags": ["c", "arrays", "pointers", "generics"], "comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 4, "creation_date": 1511985657, "post_id": 47560790, "comment_id": 82079359, "body": "Even though <code>void *</code> doesn&#39;t allow arithmetic, <code>void **</code> (which is a completely different type) does."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 8, "creation_date": 1511985699, "post_id": 47560790, "comment_id": 82079379, "body": "<code>void *</code> doesn&#39;t allow arithmetic because the compiler doesn&#39;t know what it&#39;s pointing to. <code>void **</code> does, because we know exactly what it points to: pointers."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1511986445, "post_id": 47560790, "comment_id": 82079780, "body": "While <code>void **</code> will allow you to do pointer arithmetic, I have to wonder if that&#39;s really what you want.  If you want a generic dynamic array, I think you want to use <code>void *</code> and then type-cast it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511987864, "post_id": 47560790, "comment_id": 82080446, "body": "Note: as <code>array-&gt;data[i]</code> is a <code>void *</code>, the cast in <code>if(strcmp((char*)array-&gt;data[i], some_string) == 0)</code> is not needed."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1512205106, "post_id": 47560790, "comment_id": 82170855, "body": "<code>strcmp((char*)array-&gt;data[i], ...</code> no need to cast here (in C)."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1511987701, "post_id": 47560825, "comment_id": 82080354, "body": "Minor: On code review, <code>a.data = malloc(a.capacity * sizeof(void*));</code> has the usual &quot;was the correct type used?&quot; concern.  This requires a look-up of the details of <code>struct dynamic_array</code> which may exist in another file (maybe dynamic_array.h). OTOH, if code was <code>a.data = malloc(a.capacity * sizeof *(a.data));</code>, the right size is certain without a  type check.  Further, this code idiom is easier to maintain."}], "tags": [], "owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "is_accepted": true, "score": 2, "last_activity_date": 1511986174, "last_edit_date": 1511986174, "creation_date": 1511985681, "answer_id": 47560825, "question_id": 47560790, "link": "https://stackoverflow.com/questions/47560790/is-void-portable-c/47560825#47560825", "title": "Is void** portable C?", "body": "<p>Yes, this works. A pointer to void (<code>void *</code>) is a perfectly valid data object, so you can have an array of pointers to void, and access elements in that array in the normal way.</p>\n\n<p>An example code snippet:</p>\n\n<pre><code>int i;\nchar c;\nfloat f;\n\nstruct dynamic_array a;\na.capacity = 1024;\na.data = malloc(a.capacity * sizeof(void*));\na.data[0] = &amp;i;\na.data[1] = &amp;c;\na.data[2] = &amp;f;\na.length = 3;\n</code></pre>\n\n<p>As Lee Daniel Crocker wrote, <code>void *</code> doesn't allow pointer arithmetic because the compiler doesn't know what it's pointing to. But <code>void **</code> does, because we know exactly what it points to: pointers.</p>\n"}], "owner": {"reputation": 129, "user_id": 8885528, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c173287e345ef2dc9bf513fbe80fbe8b?s=128&d=identicon&r=PG&f=1", "display_name": "Kona98", "link": "https://stackoverflow.com/users/8885528/kona98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 47560825, "answer_count": 1, "score": 1, "last_activity_date": 1511987438, "creation_date": 1511985553, "last_edit_date": 1511987438, "question_id": 47560790, "link": "https://stackoverflow.com/questions/47560790/is-void-portable-c", "title": "Is void** portable C?", "body": "<p>I want to implement a generic growing array and use this struct for it:</p>\n\n<pre><code>struct dynamic_array\n{\n    void** data;\n    size_t length;\n    size_t capacity;\n};\n</code></pre>\n\n<p>Because <code>void*</code> doesn't allow arithmetic, I wanted to know if a <code>void*</code> array allows it, since it is a <em>pointer</em> to a <code>void*</code>. If that doesn't work, I'd like to know how else I could implement a generic array.</p>\n\n<p>Edit: Since not everyone knows what I want to do with it, here's a code snippet how I could use the array:</p>\n\n<pre><code>for(size_t i = 0; i &lt; array-&gt;length; i++)\n{\n    if(strcmp((char*)array-&gt;data[i], some_string) == 0)\n    {\n        break;\n    }\n}\n</code></pre>\n\n<p>Of course it's not only going to be char* but struct* too, and I know I have to cast them, but void* should allow casting back and forth without data loss, right?</p>\n"}, {"tags": ["c", "fwrite"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1511985587, "post_id": 47560766, "comment_id": 82079326, "body": "I would rather be concerned about problems caused by a write operation interrupted by power down."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1511985671, "post_id": 47560766, "comment_id": 82079367, "body": "you should <code>fflush</code> your handles as soon as you&#39;re writing. But even that doesn&#39;t guarantee that the disk won&#39;t be corrupt if a write occurs while you&#39;re powering it off."}, {"owner": {"reputation": 2511, "user_id": 3015268, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/K2RwN.jpg?s=128&g=1", "display_name": "bakalolo", "link": "https://stackoverflow.com/users/3015268/bakalolo"}, "edited": false, "score": 0, "creation_date": 1511985732, "post_id": 47560766, "comment_id": 82079403, "body": "Anyway to communicate to my program that I want to shut off the machine from the outside then?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1511985813, "post_id": 47560766, "comment_id": 82079449, "body": "you could create a certain file on disk, or send a signal prior to powering off. And that would leave the chance to <code>fclose</code> the file :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1511985822, "post_id": 47560766, "comment_id": 82079456, "body": "There are nice mechanisms implemented in modern OSs that will gracefully terminate all of the processes before turning the power off."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1511985846, "post_id": 47560766, "comment_id": 82079470, "body": "That&#39;s a joke. Open and close the close the file for every write, if you want to throw a rock at it."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1511985931, "post_id": 47560766, "comment_id": 82079521, "body": "@EugeneSh. <i>&quot;by turning off the power to the machine&quot;</i>. There is a difference between pushing the &quot;off&quot; button and cutting power at the wall."}, {"owner": {"reputation": 2525, "user_id": 5402881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbd67023a48b626fa1595d8d5cf8404e?s=128&d=identicon&r=PG&f=1", "display_name": "yacc", "link": "https://stackoverflow.com/users/5402881/yacc"}, "edited": false, "score": 0, "creation_date": 1511986035, "post_id": 47560766, "comment_id": 82079584, "body": "hm, would be throwing out of the window considered as powering off?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1511986053, "post_id": 47560766, "comment_id": 82079595, "body": "@WeatherVane I know. My seond comment was to address the OPs comment."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "reply_to_user": {"reputation": 2525, "user_id": 5402881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbd67023a48b626fa1595d8d5cf8404e?s=128&d=identicon&r=PG&f=1", "display_name": "yacc", "link": "https://stackoverflow.com/users/5402881/yacc"}, "edited": false, "score": 1, "creation_date": 1511986086, "post_id": 47560766, "comment_id": 82079610, "body": "@yacc That depends whether the computer is running on battery, or has a very long and firmly attached power cord, and how far the computer travels before coming to rest."}, {"owner": {"reputation": 2511, "user_id": 3015268, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/K2RwN.jpg?s=128&g=1", "display_name": "bakalolo", "link": "https://stackoverflow.com/users/3015268/bakalolo"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1511986089, "post_id": 47560766, "comment_id": 82079614, "body": "@Jean-Fran&#231;oisFabre you mean I create a file with a char inside and change it when I want to shut down, and have my program read that char to know when to turn off?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1511986096, "post_id": 47560766, "comment_id": 82079619, "body": "@EugeneSh. My &quot;joke&quot; remark was to OP. It&#39;s a bit like those old cartoons that show someone sitting on a tree branch while sawing it off. &quot;Will I be safe&quot;?"}, {"owner": {"reputation": 2525, "user_id": 5402881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbd67023a48b626fa1595d8d5cf8404e?s=128&d=identicon&r=PG&f=1", "display_name": "yacc", "link": "https://stackoverflow.com/users/5402881/yacc"}, "edited": false, "score": 0, "creation_date": 1511986432, "post_id": 47560766, "comment_id": 82079776, "body": "@bakalolo That is normally handled by signals. So when an operating system is going to shut down it signals all running processes to terminate operation. Signal is called SIGTERM on Unix/Linux."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1511986536, "post_id": 47560766, "comment_id": 82079832, "body": "Embedded code can be a state machine, and when a brown-out is detected it prevents the code from making any changes that would mean the state is not recoverable on power up."}, {"owner": {"reputation": 2511, "user_id": 3015268, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/K2RwN.jpg?s=128&g=1", "display_name": "bakalolo", "link": "https://stackoverflow.com/users/3015268/bakalolo"}, "reply_to_user": {"reputation": 2525, "user_id": 5402881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbd67023a48b626fa1595d8d5cf8404e?s=128&d=identicon&r=PG&f=1", "display_name": "yacc", "link": "https://stackoverflow.com/users/5402881/yacc"}, "edited": false, "score": 0, "creation_date": 1511986547, "post_id": 47560766, "comment_id": 82079840, "body": "@yacc I am confused, so if I shut down the machine normally while the loop is running there is no problemo?"}, {"owner": {"reputation": 2525, "user_id": 5402881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbd67023a48b626fa1595d8d5cf8404e?s=128&d=identicon&r=PG&f=1", "display_name": "yacc", "link": "https://stackoverflow.com/users/5402881/yacc"}, "edited": false, "score": 0, "creation_date": 1511986634, "post_id": 47560766, "comment_id": 82079880, "body": "No problem when you do a graceful shutdown. Unix, Linux handle this with SIGTERM, Windows sends a WM_QUIT message to application."}, {"owner": {"reputation": 2511, "user_id": 3015268, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/K2RwN.jpg?s=128&g=1", "display_name": "bakalolo", "link": "https://stackoverflow.com/users/3015268/bakalolo"}, "edited": false, "score": 0, "creation_date": 1511986673, "post_id": 47560766, "comment_id": 82079889, "body": "and the file is not going to be corrupted?"}, {"owner": {"reputation": 2525, "user_id": 5402881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbd67023a48b626fa1595d8d5cf8404e?s=128&d=identicon&r=PG&f=1", "display_name": "yacc", "link": "https://stackoverflow.com/users/5402881/yacc"}, "edited": false, "score": 0, "creation_date": 1511986936, "post_id": 47560766, "comment_id": 82080006, "body": "Unless you throw your computer out of the window... no. But the process must receive SIGTERM to flush and close everthing. If it&#39;s SIGINT (Ctrl-c) or even no signal at all... you see. You should add the OS to the question btw."}, {"owner": {"reputation": 2525, "user_id": 5402881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbd67023a48b626fa1595d8d5cf8404e?s=128&d=identicon&r=PG&f=1", "display_name": "yacc", "link": "https://stackoverflow.com/users/5402881/yacc"}, "edited": false, "score": 0, "creation_date": 1511987673, "post_id": 47560766, "comment_id": 82080336, "body": "Hey I&#39;ve just learned that flushing is OS dependant. See here: <a href=\"https://stackoverflow.com/questions/7281255/why-is-data-not-being-flushed-to-file-on-process-exit\" title=\"why is data not being flushed to file on process exit\">stackoverflow.com/questions/7281255/&hellip;</a>. So I think closing will always happen, flushing maybe (mostly yes). Why don&#39;t you make a test to check it?"}], "answers": [{"tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1511985824, "creation_date": 1511985824, "answer_id": 47560863, "question_id": 47560766, "link": "https://stackoverflow.com/questions/47560766/is-fclose-call-needed-when-writing-to-file/47560863#47560863", "title": "is fclose() call needed when writing to file", "body": "<p>Short answer: no, not as written, if there is any kind of buffering.  And if no buffering, also maybe no.</p>\n\n<p>The buffering mode can be controlled with <code>setvbuf</code>.  You can also periodically call <code>fflush</code> to flush the buffers.</p>\n\n<p>However, regardless of how you manage the buffering, control is transferred to the OS kernel I/O scheduling, and then to the hardware (which may have its own buffering).</p>\n\n<p>The file I/O routines in <code>&lt;stdio.h&gt;</code>, to my knowledge, don't give you control at a low enough level to be absolutely certain your data is written upon return from a call such as <code>fflush</code>.</p>\n\n<p>Note that here I'm talking about sudden unexpected power loss.</p>\n"}], "owner": {"reputation": 2511, "user_id": 3015268, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/K2RwN.jpg?s=128&g=1", "display_name": "bakalolo", "link": "https://stackoverflow.com/users/3015268/bakalolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511985824, "creation_date": 1511985462, "question_id": 47560766, "link": "https://stackoverflow.com/questions/47560766/is-fclose-call-needed-when-writing-to-file", "title": "is fclose() call needed when writing to file", "body": "<p>Say I'm writing to a file but I want to end the write by turning off the power to the machine, would that be a problem that the fclose() function didn't get called?</p>\n\n<pre><code>FILE *f = fopen(\"file.txt\", \"w\");\nif (f == NULL)\n{\n    printf(\"Error opening file!\\n\");\n    exit(1);\n}\n\n/* print some text */\nwhile(1){\n//write something...\n}\n//Dont want to call this\nfclose(f);\n</code></pre>\n"}, {"tags": ["c", "unix", "fork"], "comments": [{"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 1, "creation_date": 1511985682, "post_id": 47560737, "comment_id": 82079372, "body": "The result of <code>fork()</code> is non-zero in the parent process (positive for success, -1 for failure) and zero in the child process. This is so because the parent needs to get the process id of the child; the child process can always get the process id of its current parent (natural or adoptive) by calling <code>getppid()</code>.  <i>Only</i> the parent process can enter the <code>if</code>."}], "answers": [{"tags": [], "owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "is_accepted": false, "score": 0, "last_activity_date": 1511986622, "creation_date": 1511986622, "answer_id": 47561079, "question_id": 47560737, "link": "https://stackoverflow.com/questions/47560737/using-fork-in-if-conditional/47561079#47561079", "title": "using fork in if conditional", "body": "<p>Notice the output.</p>\n\n<p>You can see only process with <strong>ID:4141</strong> is able to get into <code>if</code> statements. Because after successful creation of child process, the return value from <code>fork()</code> is child process ID.</p>\n\n<p>The process <strong>id:4141</strong> is your parent process. And this process is calling <code>fork()</code> statements, which creates the child process <strong>4142,4143,4144...</strong></p>\n\n<p>None of these processes (<strong>4142,4143</strong>) can go into your <code>if</code> statement. Because for these processes the return value is zero from the successful execution of <code>fork()</code> statement.</p>\n\n<p>For process <strong>4142</strong> and <strong>4143</strong>, the next statement of execution after they get created from <code>fork()</code> is the \"Bye\" statement.</p>\n"}], "owner": {"reputation": 147, "user_id": 8513493, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e9f0858b5f0e148106aa638944f225b5?s=128&d=identicon&r=PG&f=1", "display_name": "Kasra GH", "link": "https://stackoverflow.com/users/8513493/kasra-gh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 572, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516954361, "creation_date": 1511985359, "last_edit_date": 1516954361, "question_id": 47560737, "link": "https://stackoverflow.com/questions/47560737/using-fork-in-if-conditional", "title": "using fork in if conditional", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n\nvoid fork4 () \n{\n    printf(\"\\n [%d] L0 \\n\", getpid());\n    if ( fork() != 0 )\n    {\n        printf(\"\\n [%d] L1  \\n\" , getpid());\n        if ( fork() != 0)\n        {\n            printf(\"\\n [%d] L2 \\n\" , getpid());\n            fork();\n        }\n    }\n    printf(\"\\n [%d] Bye \\n\" , getpid());\n}\n\nint main()\n{\n    fork4();\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code> [4141] L0 \n\n [4141] L1  \n\n [4142] Bye \n\n [4141] L2 \n\n [4141] Bye \n\n [4143] Bye \n\n [4144] Bye\n</code></pre>\n\n<p>I'm trying to understand what exactly is happening but the output is very strange! I don't understand why the parent process can enter the first if scope! Would it be alright if someone explained what is happening here? </p>\n"}, {"tags": ["c", "unix", "command-line", "queue", "ipc"], "comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1511985406, "post_id": 47560692, "comment_id": 82079230, "body": "You need to allocate memory for mtext.  Change the structure definition to user <code>char mtext[16]</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511999368, "post_id": 47560692, "comment_id": 82085447, "body": "both the &#39;send.c&#39; and the &#39;receiver.c&#39; are missing the needed include statements for the required header files."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511999405, "post_id": 47560692, "comment_id": 82085459, "body": "never access beyond <code>argv[0]</code> without first checking <code>argc</code> to assure the command line parameters were actually entered"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511999499, "post_id": 47560692, "comment_id": 82085481, "body": "regarding: <code>int main(int argc, char *argv[]) { int msqid;</code> and similar lines.  For ease of readability and understanding follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511999629, "post_id": 47560692, "comment_id": 82085525, "body": "for ease of readability and understanding: 1) please consistently indent the code.  indent after every opening brace &#39;{&#39;  Unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511999708, "post_id": 47560692, "comment_id": 82085544, "body": "when calling system functions, for instance: <code>msgget()</code>, <code>msgrcv()</code>, always check the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511999801, "post_id": 47560692, "comment_id": 82085579, "body": "when defining a struct, always include a &#39;tag name&#39; because that is what most debuggers use to be able to display the individual fields in the struct"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511999977, "post_id": 47560692, "comment_id": 82085648, "body": "the posted code, is defining a struct AND an instance of the struct named <code>mymsg</code>.  This is not what you want to be doing.  especially later in the code with this statement: <code>struct mymsg message;</code>  which is expecting the &#39;tag name&#39; of the struct to be <code>mymsg</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512000201, "post_id": 47560692, "comment_id": 82085706, "body": "regarding: `    struct     {         long int mtype;         char * mtext;     } mymsg;`  the pointer: <code>mtext</code> should be declared as <code>char mtext[1024];</code>  because that is the actual memory to be sent/received.  This is probably the main reason that trash is being received, because a pointer in the sender means nothing in the receiver"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512000465, "post_id": 47560692, "comment_id": 82085776, "body": "the <code>send.c</code> code is missing the include statements for the needed header files.   and it is missing some code at the end of the posted function."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512001866, "post_id": 47560692, "comment_id": 82086124, "body": "regarding: <code>while(fgets(mymsg.mtext, sizeof mymsg.mtext, stdin) != NULL) {</code>  the expression: <code>sizeof mymsg.mtext</code> will evaluate to the size of a pointer (say 4 or 8 bytes, depending on the underlying hardware architecture) The function: <code>fgets()</code> always inserts a trailing NUL byte and since reading from <code>stdin</code>, probably also has a &#39;\\n&#39; inserted before the NUL byte.  This means the user (assuming 4 byte pointers) will only be able to insert 2 characters."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512002973, "post_id": 47560692, "comment_id": 82086403, "body": "The message type field of the struct field: <code>mtype</code> should be int32_t (from the header file <code>stdint.h</code>  not <code>long int</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512003051, "post_id": 47560692, "comment_id": 82086424, "body": "strongly suggest reading/understanding the MAN pages for each of the functions being called."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512003192, "post_id": 47560692, "comment_id": 82086461, "body": "regarding the question marks being printed, that means that the data that is trying to be printed is not a printable character"}], "owner": {"reputation": 77, "user_id": 7698195, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a964923f74a13ff923b20aa17ce3955e?s=128&d=identicon&r=PG&f=1", "display_name": "user101010", "link": "https://stackoverflow.com/users/7698195/user101010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511985160, "creation_date": 1511985160, "question_id": 47560692, "link": "https://stackoverflow.com/questions/47560692/ipc-message-queue-question-marks-in-the-received-message", "title": "IPC Message queue question marks in the received message", "body": "<p>Good Evening.</p>\n\n<p>I was trying to reproduce example of sending and retrieving messages using IPC Queue.\nThe problem is when I am printing the message f.ex.\"aaaa\" i see as output \"????\".</p>\n\n<p>receiver.c</p>\n\n<p>int main(int argc, char *argv[]) {\n    int msqid;</p>\n\n<pre><code>int rc;\nsize_t msgsz;\nstruct {\n    long int mtype;\n    char * mtext;\n} mymsg;\n\nlong int msgtype;\n\nmsqid = msgget(65536, IPC_CREAT | S_IRUSR | S_IWUSR);\nstruct mymsg message;\n\nmsgsz = sizeof(struct mymsg) - sizeof(long int);\nmsgtype = 1;\nfor (;;) {\n    if (msgrcv(msqid, &amp;message, msgsz, msgtype, IPC_NOWAIT) == -1) {\n        perror(\"msgrcv\");\n        exit(1);\n    }\n    puts(message.mtext);\n}\n\nprintf(\"Error code: \\\"%d\\\"\\n\", rc);\nprintf(\"The message received is: \\\"%s\\\"\\n\", message.mtext);\nreturn EXIT_SUCCESS;\n</code></pre>\n\n<p>}</p>\n\n<p>send.c</p>\n\n<pre><code>int rc;\n    size_t msgsz;\n    struct {\n      long int mtype;\n      char * mtext;\n    } mymsg;\n\n    long int msgtyp;\n\n    msqid = msgget(65536, IPC_CREAT | S_IRUSR | S_IWUSR);\n\n\n    mymsg.mtype = 1;\n    mymsg.mtext = argv[1];\n\n    struct mymsg message;\n\n    msgsz = sizeof(struct mymsg) - sizeof(long int);\n\n    //rc = msgsnd(msqid, &amp;mymsg, msgsz, IPC_NOWAIT);\n\n    while(fgets(mymsg.mtext, sizeof mymsg.mtext, stdin) != NULL) {\n            int len = strlen(mymsg.mtext);\n\n            /* ditch newline at end, if it exists */\n            if (mymsg.mtext[len-1] == '\\n') mymsg.mtext[len-1] = '\\0';\n\n            if (msgsnd(msqid, &amp;mymsg, len+1, 0) == -1) /* +1 for '\\0' */\n                perror(\"msgsnd\");\n        }\n\n        if (msgctl(msqid, IPC_RMID, NULL) == -1) {\n            perror(\"msgctl\");\n            exit(1);\n        }\n</code></pre>\n\n<p>This is my very beginning with C - language.\nI want to extend this to more complicated program.</p>\n\n<p>I was following beej documentation.\n<a href=\"http://beej.us/guide/bgipc/output/html/multipage/mq.html\" rel=\"nofollow noreferrer\">http://beej.us/guide/bgipc/output/html/multipage/mq.html</a></p>\n\n<p>I cannot find anything about those question marks or maybe its a lack of knowledge.</p>\n\n<p>Will appreciate all clues.</p>\n\n<p>Greetings.</p>\n"}, {"tags": ["c", "arrays", "sequence"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1511984965, "post_id": 47560607, "comment_id": 82079009, "body": "Aside: &quot;note that I am aware that <code>s_array[]</code> is set to 15 but only has 5 elements&quot;. It does have 15 elements, the other 10 elements are initialised to 0 by default."}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 1, "creation_date": 1511984994, "post_id": 47560607, "comment_id": 82079028, "body": "Don&#39;t you want to set <code>counter=1</code> before the <code>for (Bcount=1; ...)</code>? After all, you have just found <i>one</i> common element. Otherwise, <code>counter</code> counts something not interesting, keeping its value from the previous attempt."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1511985167, "post_id": 47560607, "comment_id": 82079102, "body": "O/T - recommend un-nesting your <code>s_array</code> fill loop from your <code>array</code> fill loop... unless that&#39;s providing some core functionality to the program I&#39;m not seeing.. ? More difficult to read IMO, plus there&#39;s no point in checking <code>if (i==15)</code> every iteration when you know you won&#39;t continue until that condition is met."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1511985334, "post_id": 47560607, "comment_id": 82079201, "body": "... and leave the subsequence testing until later too. Simplify to three operations: 1) enter data for <code>array[15]</code>, 2) enter data for <code>s_array[15]</code>, 3) look for a subsequence."}, {"owner": {"reputation": 63, "user_id": 7872614, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92952ce2b05e96fea1f80166b58df9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Khateeb", "link": "https://stackoverflow.com/users/7872614/ahmad-khateeb"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1511985452, "post_id": 47560607, "comment_id": 82079253, "body": "@WeatherVane so you are recommending to un-nest it as Yano suggested?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1511985527, "post_id": 47560607, "comment_id": 82079289, "body": "Yep, there are three clear stages. Then you can test the first two input stages were correct - without going into ever deeper nesting. Also, make sure you can end the substring at say 5 elements as in the first hard coded example. Don&#39;t tangle it, keep operation clear and simple."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1511985894, "post_id": 47560607, "comment_id": 82079498, "body": "really you could simply call 3 function from main,, <code>fill_set(...)</code>, <code>fill_subset(...)</code>, <code>test(...)</code>. Each of those operates independently from the others and that modularity will make it easier to test, debug, and maintain. If you don&#39;t want to use functions, the functionality of each should be 3 distinct sections of code in <code>main</code>."}, {"owner": {"reputation": 63, "user_id": 7872614, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92952ce2b05e96fea1f80166b58df9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Khateeb", "link": "https://stackoverflow.com/users/7872614/ahmad-khateeb"}, "edited": false, "score": 0, "creation_date": 1511986918, "post_id": 47560607, "comment_id": 82079996, "body": "makes so much sense to do it that way, worked well and is way easier to comprehend  what is going on"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1511991172, "post_id": 47560607, "comment_id": 82082109, "body": "in fact, just two functions since 2 of them are doing the same thing.. <code>void fill_set(int array[], int numElementsToFill){ ... }</code>, then you could use that to fill <code>array</code> and <code>s_array</code>."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 10047624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7uMal.jpg?s=128&g=1", "display_name": "Avi Tal", "link": "https://stackoverflow.com/users/10047624/avi-tal"}, "edited": false, "score": 0, "creation_date": 1609049588, "post_id": 47561939, "comment_id": 115736588, "body": "Unfortunately, this does not work on the following input:                                                                        int array[15] = { 1, 2, 3, 4, 6, 7, 6, 9, 1, 2, 2, 2, 4, 5, 6 };     int s_array[5] = { 2, 2, 4, 5, 6 };"}], "tags": [], "owner": {"reputation": 1820, "user_id": 7209631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ad26cdac82ab360fb4fd572febf351?s=128&d=identicon&r=PG&f=1", "display_name": "Baris Yakut", "link": "https://stackoverflow.com/users/7209631/baris-yakut"}, "is_accepted": false, "score": 0, "last_activity_date": 1511990103, "creation_date": 1511990103, "answer_id": 47561939, "question_id": 47560607, "link": "https://stackoverflow.com/questions/47560607/finding-if-an-array-is-a-sub-sequence-of-another-array/47561939#47561939", "title": "finding if an array is a sub-sequence of another array", "body": "<p>You can loop over <code>array</code> and set an index counter for <code>s_array</code>. Increment that counter if only <code>array[i] == s_array[j]</code>, reset otherwise.</p>\n\n<p>You can end the loop earlier if:</p>\n\n<ul>\n<li>You have found the sub array</li>\n<li>There are not enough elements left to compare in array</li>\n</ul>\n\n<p><strong>Code sample:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include&lt;stdbool.h&gt;\n\nint main(void)\n{\n  int array[15] = {1, 2, 3, 4, 6, 7, 6, 9, 0, 1, 2, 3, 4, 5, 6};\n  int s_array[5] = {2, 3, 4, 5, 6};\n\n  const int size_array = sizeof(array) / sizeof(array[0]);\n  const int size_s_array = sizeof(s_array) / sizeof(s_array[0]);\n\n  bool isFound = false;\n\n  if (size_s_array &gt; size_array)\n  {\n    printf(\"Sub array is larger than the array\\n\");\n  }\n  else\n  {\n    int j = 0;\n    for (int i = 0; (i &lt; size_array) &amp;&amp; (j != size_s_array) ; i++)\n    {\n      if (array[i] == s_array[j])\n      {\n        j++;\n      }\n      else\n      {\n        j = 0;\n        if (i &gt; size_array - size_s_array) // You can also put this in for loop's test condition, but I find this more readable.\n        {\n          break;\n        }\n      }\n    }\n    isFound = (j == size_s_array) ? true : false;\n  }\n\n  printf(\"%s\\n\", isFound ? \"Found\" : \"Not found\");\n\n  return 0;\n}\n</code></pre>\n\n<p><strong>Test cases for different s_array:</strong></p>\n\n<p><code>array[15] = {1, 2, 3, 4, 6, 7, 6, 9, 0, 1, 2, 3, 4, 5, 6};</code></p>\n\n<pre><code>int s_array[5] = {2, 3, 4, 5, 6};\nFound\n\nint s_array[1] = {8};\nNot found\n\nint s_array[2] = {1, 2};\nFound\n\nint s_array[15] = {1, 2, 3, 4, 6, 7, 6, 9, 0, 1, 2, 3, 4, 5, 6};\nFound\n\nint s_array[16] = {0, 1, 2, 3, 4, 6, 7, 6, 9, 0, 1, 2, 3, 4, 5, 6};\nSub array is larger than the array\nNot found\n\nint s_array[2] = {0, 2};\nNot found\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7872614, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92952ce2b05e96fea1f80166b58df9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Khateeb", "link": "https://stackoverflow.com/users/7872614/ahmad-khateeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1370, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511990103, "creation_date": 1511984761, "last_edit_date": 1511985295, "question_id": 47560607, "link": "https://stackoverflow.com/questions/47560607/finding-if-an-array-is-a-sub-sequence-of-another-array", "title": "finding if an array is a sub-sequence of another array", "body": "<p>Let us assume that I have those two <code>arrays</code>, <code>int array[15] = {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15}</code> and <code>int s_array[15] = {1,2,3,4,5}</code></p>\n\n<p>*note that I am aware that <code>s_array[]</code> is set to 15 but only has 5 elements</p>\n\n<p>in the following part of my code I'd like to check if <code>s_array[]</code> is a sub-sequence of <code>array[]</code>, that means that whatever values are stored in <code>s_array[]</code> are also stored in <code>array[]</code>, and in the same order. That means that <code>{3,5,4}</code> is not a sub-sequence whereas <code>{3,4,5}</code> is.</p>\n\n<p>this is the part of the code (in which I think the problem lies). <code>j</code> is the number of in <code>s_array[]</code>. the whole code will be shown down below</p>\n\n<pre><code>            for( i = 0; i &lt; 15; i++ ){\n            if( s_array[0] == array[i] ){ /*if the first element of the s_array is not \n                                           available then it is not a sub-sequence and \n                                            there is no need to check the rest */ \n                for( Bcount = 1; Bcount &lt; ( j - 1 ); Bcount++ ){\n                    if( s_array[Bcount] == array[Bcount + i])\n                        counter++;\n                    else{\n                        printf( \"B is not a sub-sequence of A.\" );\n                        break;\n                    }\n                }\n                if( j == counter ){\n                    printf( \"B is a sub-sequence of A.\" );\n                    break;\n                }\n            }\n            else\n                continue;\n        }\n</code></pre>\n\n<p>The whole code for whoever is interested or if it will help understand better</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    int array[15], s_array[15], i = 0, j = 0, Bcount = 1, counter = 1;\n    printf( \"Please enter a sequence A: \" );\n    while(i &lt; 15  &amp;&amp; scanf(\"%d\", &amp;array[i]) == 1) {\n          //input for array[], will always have 15 elements\n        i++;\n        if( i == 15){\n            printf( \"Please enter a sequence B: \" );\n            while(j &lt; 15  &amp;&amp; scanf(\"%d\", &amp;s_array[j]) == 1) {\n                //input for s_array, will have somewhere between 1 and 15 elements\n                j++;\n            }\n            for( i = 0; i &lt; 15; i++ ){\n                if( s_array[0] == array[i] ){\n                    for( Bcount = 1; Bcount &lt; ( j - 1 ); Bcount++ ){\n                        if( s_array[Bcount] == array[Bcount + i])\n                            counter++;\n                        else{\n                            printf( \"B is not a sub-sequence of A.\" );\n                            break;\n                        }\n                    }\n                    if( j == counter ){\n                        printf( \"B is a sub-sequence of A.\" );\n                        break;\n                    }\n                }\n                else\n                    continue;\n            }\n            return 5;\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "matrix", "input"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1511983773, "post_id": 47560291, "comment_id": 82078389, "body": "sure, you can use command line arguments or accept user input after the program starts. But if you want &quot;2d&quot; won&#39;t the user have to input a width and height? I think some systems will limit the number of command line arguments you can have though (somebody here will know), so you&#39;re probably better off reading in user input after the program starts and parsing that yourself."}, {"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1511983963, "post_id": 47560291, "comment_id": 82078505, "body": "read about <code>malloc</code>"}, {"owner": {"reputation": 3, "user_id": 8882429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2317aac21170f5fa51135bb5a759ec9?s=128&d=identicon&r=PG&f=1", "display_name": "Nadia", "link": "https://stackoverflow.com/users/8882429/nadia"}, "edited": false, "score": 0, "creation_date": 1511983974, "post_id": 47560291, "comment_id": 82078511, "body": "my bad. fixed the question. I meant getting 3 that will give me n*n matrix where the rest of the numbers are the input."}, {"owner": {"reputation": 3, "user_id": 8882429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2317aac21170f5fa51135bb5a759ec9?s=128&d=identicon&r=PG&f=1", "display_name": "Nadia", "link": "https://stackoverflow.com/users/8882429/nadia"}, "reply_to_user": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1511984121, "post_id": 47560291, "comment_id": 82078595, "body": "@AditiRawat yes, I know about malloc. I don&#39;t know how to extract the first number that supposed to be the size of my array."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 1, "creation_date": 1511984192, "post_id": 47560291, "comment_id": 82078635, "body": "Read in the first number using <code>scanf</code>; create a 2D-array of ints accoring to the dimensions; write two nested loops and use scanf to read in the values..."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1511984205, "post_id": 47560291, "comment_id": 82078641, "body": "Look at Variable Length Arrays, and read up on string parsing."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1511984677, "post_id": 47560291, "comment_id": 82078877, "body": "<i>&quot;Any ideas?&quot;</i> Show us what you have tried, and ask why it does not work. Voting to close."}, {"owner": {"reputation": 3, "user_id": 8882429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2317aac21170f5fa51135bb5a759ec9?s=128&d=identicon&r=PG&f=1", "display_name": "Nadia", "link": "https://stackoverflow.com/users/8882429/nadia"}, "edited": false, "score": 0, "creation_date": 1511985003, "post_id": 47560291, "comment_id": 82079034, "body": "oh ok, I didn&#39;t know it&#39;s wrong to consult if you are stuck. I tried few things but they are bad. If it&#39;s against the rules I will delete the thread."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1511986104, "post_id": 47560291, "comment_id": 82079625, "body": "@Nadia: don&#39;t mind if the things you tried are bad; show it. You will get comments on your thoughts, and it helps the community to estimate your maturity level when answering the question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511989084, "post_id": 47560291, "comment_id": 82081069, "body": "&quot;I&#39;ve been trying to create a dynamic 2d matrix&quot; --&gt; posting that code helps to bring clarity to the post."}], "answers": [{"tags": [], "owner": {"reputation": 5349, "user_id": 5132337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fcj6b.jpg?s=128&g=1", "display_name": "Siraj Alam", "link": "https://stackoverflow.com/users/5132337/siraj-alam"}, "is_accepted": false, "score": 0, "last_activity_date": 1511987638, "last_edit_date": 1511987638, "creation_date": 1511986302, "answer_id": 47560997, "question_id": 47560291, "link": "https://stackoverflow.com/questions/47560291/getting-size-of-array-in-one-line-with-the-input/47560997#47560997", "title": "Getting size of array in one line with the input", "body": "<p>This is what you are looking for.\nThe code is explained in the comments in the code. </p>\n\n<p>Read <a href=\"https://stackoverflow.com/a/19920531/5132337\">here</a>, how to make dynamic 2d array in <code>c</code>.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main()\n{\n    int n;\n\n    scanf(\"%d\", &amp;n);\n\n    /* It will allocate an array of pointers with n elements*/\n    int **arr = (int**)malloc(n*sizeof(int*));\n\n    /* each element in the above array would contain another array that makes the upper array as the 2D array */\n    for (int i = 0; i &lt; n; i++)\n        arr[i] = (int*)malloc(n * sizeof(int));\n\n    /*It is taking the input to put inside the array */\n    for (int i = 0; i &lt; n; i++)\n        for (int j = 0; j &lt; n; j++)\n            scanf(\"%d\", &amp;arr[i][j]);\n\n    /* This is printing the content inside the array */\n    for (int i = 0; i &lt; n; i++)\n        for (int j = 0; j &lt; n; j++)\n            printf(\"%d\\t\", arr[i][j]);\n\n    return 0;\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5349, "user_id": 5132337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fcj6b.jpg?s=128&g=1", "display_name": "Siraj Alam", "link": "https://stackoverflow.com/users/5132337/siraj-alam"}, "edited": false, "score": 0, "creation_date": 1511987142, "post_id": 47561018, "comment_id": 82080085, "body": "Your line <code>int array[n][n]; &#47;&#47;variable length array</code> is giving error in the Visual Studio 2017 community edition. <b>Expression did not evaluate to a constant</b>. That might because that array declaration expect constant and you are providing a variable."}, {"owner": {"reputation": 5349, "user_id": 5132337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fcj6b.jpg?s=128&g=1", "display_name": "Siraj Alam", "link": "https://stackoverflow.com/users/5132337/siraj-alam"}, "edited": false, "score": 0, "creation_date": 1511987249, "post_id": 47561018, "comment_id": 82080131, "body": "<a href=\"https://stackoverflow.com/a/19920531/5132337\">stackoverflow.com/a/19920531/5132337</a> This explains better of creating of dynamic 2d array"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 5349, "user_id": 5132337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fcj6b.jpg?s=128&g=1", "display_name": "Siraj Alam", "link": "https://stackoverflow.com/users/5132337/siraj-alam"}, "edited": false, "score": 0, "creation_date": 1511989369, "post_id": 47561018, "comment_id": 82081223, "body": "@Siraj The error message &quot;Expression did not evaluate to a constant&quot; is because the compiler used does not support C99 or the optional feature in C11.  (was compiler the C++ or C compiler used?)"}, {"owner": {"reputation": 5349, "user_id": 5132337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fcj6b.jpg?s=128&g=1", "display_name": "Siraj Alam", "link": "https://stackoverflow.com/users/5132337/siraj-alam"}, "edited": false, "score": 0, "creation_date": 1511989638, "post_id": 47561018, "comment_id": 82081363, "body": "The project is chosen to be <code>Compiled as C</code>"}, {"owner": {"reputation": 5349, "user_id": 5132337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fcj6b.jpg?s=128&g=1", "display_name": "Siraj Alam", "link": "https://stackoverflow.com/users/5132337/siraj-alam"}, "edited": false, "score": 0, "creation_date": 1511989889, "post_id": 47561018, "comment_id": 82081506, "body": "I think the problem must be in C compiler."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1511986822, "last_edit_date": 1511986822, "creation_date": 1511986382, "answer_id": 47561018, "question_id": 47560291, "link": "https://stackoverflow.com/questions/47560291/getting-size-of-array-in-one-line-with-the-input/47561018#47561018", "title": "Getting size of array in one line with the input", "body": "<p>If \"dynamic\" just means that the size of the 2d-matrix is defined at runtime, then you might use a variable length array. These are created in function scope and are \"real\" 2D-arrays in the sense that they are <code>n x n</code> continuously stored integers that can be accessed like <code>array[x][y]</code>. See the following code illustrating this approach:</p>\n\n<pre><code>int main() {\n\n    int n;\n    if (scanf(\"%d\", &amp;n) != 1 || n &lt;= 0) {\n        printf(\"invalid input.\");\n        return 1;\n    }\n\n    int array[n][n]; // variable length array\n    for (int i = 0; i &lt; n; i++) {\n        for (int j = 0; j &lt; n; j++) {\n            if (scanf(\"%d\", &amp;array[i][j]) != 1) {\n                printf(\"invalid input.\");\n                return 1;\n            }\n        }\n    }\n\n    // matrix is available in main...\n    return 0;\n}\n</code></pre>\n\n<p>If \"dynamic\" means, however, allocated dynamically using <code>malloc</code>, then you have two chances, both not leading to a \"real\" 2D-array: </p>\n\n<p>First, (dynamically) create an array of pointers, each entry pointing to a (dynamically) allocated array of ints. Advantage: you can access it like <code>arr[x][y]</code>; Drawback: rows are not continguously stored but (probably) spread in memory.</p>\n\n<p>Second, (dynamically) create an array of ints of size <code>n * n</code>; Advantage: values are stored in a continguous block of memory; drawback: you cannot access it like <code>arr[x][y]</code> but rather have to calculate the cell's position on your own, i.e. <code>arr[y * n + x]</code>;</p>\n"}], "owner": {"reputation": 3, "user_id": 8882429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2317aac21170f5fa51135bb5a759ec9?s=128&d=identicon&r=PG&f=1", "display_name": "Nadia", "link": "https://stackoverflow.com/users/8882429/nadia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "closed_date": 1511989100, "answer_count": 2, "score": -2, "last_activity_date": 1511987638, "creation_date": 1511983488, "last_edit_date": 1511983929, "question_id": 47560291, "link": "https://stackoverflow.com/questions/47560291/getting-size-of-array-in-one-line-with-the-input", "closed_reason": "Needs details or clarity", "title": "Getting size of array in one line with the input", "body": "<p>I've been trying to create a dynamic 2d matrix where the user gives me the size of the matrix along with the input.\nFor example: 3 1 2 3 4 5 6 7 8 9, where the first int 3 is the size of the matrix (3*3) and the rest of the numbers are the numbers I'd like to input in my matrix.\nAny ideas how to do it?</p>\n"}, {"tags": ["c++", "c", "gcc", "linker", "elf"], "comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1511984277, "post_id": 47560152, "comment_id": 82078687, "body": "Is it possible that whatever is placing the C object files into the library archive is stripping symbols?"}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1511985387, "post_id": 47560152, "comment_id": 82079225, "body": "@MichaelBurr no because to check the <code>.obj</code>s, I unzip the library archive but I think I know what is stripping the symbols; see my update shortly."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1511985740, "post_id": 47560152, "comment_id": 82079411, "body": "@MichaelBurr updated"}, {"owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "edited": false, "score": 0, "creation_date": 1511989812, "post_id": 47560152, "comment_id": 82081465, "body": "I realize it may be difficult for an issue like this, but posting a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would help us to help you."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "edited": false, "score": 0, "creation_date": 1511989902, "post_id": 47560152, "comment_id": 82081510, "body": "@Tim I think I&#39;m doing the gruntwork. I just need help with knowledge of <code>gcc</code> like my update: <code>what&#39;s the input section I need to add to .dflash_code that contains the mixed source-assembly?</code>"}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "edited": false, "score": 0, "creation_date": 1511989964, "post_id": 47560152, "comment_id": 82081545, "body": "@Tim it&#39;s obvious that the info is being stripped from the <code>.obj</code> when the <code>.elf</code> is created and the linking process is doing it which is controlled by linker file and <code>ld</code> command line options."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1512074295, "post_id": 47560152, "comment_id": 82121949, "body": "@MichaelBurr if you&#39;re interested, figured it out."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "edited": false, "score": 0, "creation_date": 1512074302, "post_id": 47560152, "comment_id": 82121952, "body": "@Tim if you&#39;re interested, figured it out."}], "answers": [{"comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 2, "creation_date": 1512157530, "post_id": 47582133, "comment_id": 82159394, "body": "Glad you found a solution - linker scripts are largely voodoo to me."}], "tags": [], "owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "is_accepted": true, "score": 2, "last_activity_date": 1512074037, "creation_date": 1512074037, "answer_id": 47582133, "question_id": 47560152, "link": "https://stackoverflow.com/questions/47560152/gcc-linker-obj-dump-has-mixed-source-assembly-but-not-when-linked-in-elf/47582133#47582133", "title": "gcc linker - .obj dump has mixed source-assembly but not when linked in .elf", "body": "<p>Finally figured out the reason but I still don't understand <strong>why</strong> this happens:</p>\n\n<p>In the linker file, if I place all sections with <code>.debug</code> in their name like <code>.debug_macro</code> in a different section:  </p>\n\n<pre><code>  .dflash_code :\n  {\n    *archive.dlb:*(.text.*)\n    *archive.dlb:*(.debug*)     \n  } &gt;dflash\n</code></pre>\n\n<p>Then in the ELF <code>.map</code> file I will get those sections placed in the <code>.elf</code> (no duh) including <code>.debug_line</code> which, in the <code>.obj</code>s, contains the entire source of the corresponding <code>.c</code>:</p>\n\n<p>app.elf.map:</p>\n\n<pre><code> .debug_line    0x1001841d      0x87e ..\\archive.dlb(main.doj)\n .debug_line    0x10026152      0x8fe ..\\archive.dlb(pyexec.doj)\n</code></pre>\n\n<p>However, if I run <code>objdump -Sxg app.elf</code>, I do NOT get the source intermixed with assembly:</p>\n\n<pre><code>Disassembly of section .dflash_code:\n10000000 &lt;micropython_main&gt;:\n10000000:   b580        push    {r7, lr}\n10000002:   b084        sub sp, #16\n10000004:   af00        add r7, sp, #0\n10000006:   6078        str r0, [r7, #4]\n10000008:   6039        str r1, [r7, #0]\n1000000a:   4b09        ldr r3, [pc, #36]   ; (10000030 &lt;micropython_main+0x30&gt;)\n1000000c:   f107 020c   add.w   r2, r7, #12\n10000010:   601a        str r2, [r3, #0]\n10000012:   f001 ff6d   bl  10001ef0 &lt;mp_init&gt;\n10000016:   4807        ldr r0, [pc, #28]   ; (10000034 &lt;micropython_main+0x34&gt;)\n10000018:   f006 f88e   bl  10006138 &lt;pyexec_frozen_module&gt;\n1000001c:   f001 ff94   bl  10001f48 &lt;mp_deinit&gt;\n10000020:   f04f 0300   mov.w   r3, #0\n10000024:   4618        mov r0, r3\n10000026:   f107 0710   add.w   r7, r7, #16\n1000002a:   46bd        mov sp, r7\n1000002c:   bd80        pop {r7, pc}\n1000002e:   bf00        nop\n10000030:   1fff34fc    .word   0x1fff34fc\n10000034:   100313bc    .word   0x100313bc\n</code></pre>\n\n<hr>\n\n<p>However, if I change the linker file such that the <code>.debug*</code> sections from <code>archive.dlb</code> are not placed in <code>.dflash_code</code> (and I reiterate this is the <strong>only</strong> change I make):</p>\n\n<pre><code>.dflash_code :\n  {\n    *archive.dlb:*(.text.*)\n\n  } &gt;dflash\n</code></pre>\n\n<p>Then in the ELF <code>.map</code> file, I still see those same <code>.debug_line</code> sections however they are placed in a different location because of some other statements later in the my linker file</p>\n\n<p>app.elf.map:</p>\n\n<pre><code> .debug_line    0x00082a32      0x87e ..\\archive.dlb(main.doj)\n .debug_line    0x000832b0      0x8fe ..\\archive.dlb(pyexec.doj)\n</code></pre>\n\n<p>and most importantly, running <code>objdump -Sxg app.elf</code> gives the intermixed source-assembly</p>\n\n<pre><code>int micropython_main(char * uP_heap, unsigned int heap_size)\n{\n10000000:   b580        push    {r7, lr}\n10000002:   b084        sub sp, #16\n10000004:   af00        add r7, sp, #0\n10000006:   6078        str r0, [r7, #4]\n10000008:   6039        str r1, [r7, #0]\n    int stack_dummy;\n    stack_top = (char*)&amp;stack_dummy;\n1000000a:   4b09        ldr r3, [pc, #36]   ; (10000030 &lt;micropython_main+0x30&gt;)\n1000000c:   f107 020c   add.w   r2, r7, #12\n10000010:   601a        str r2, [r3, #0]\n    #if MICROPY_ENABLE_GC\n        gc_init(uP_heap, uP_heap + heap_size);\n    #endif\n    mp_init();\n10000012:   f001 ff6d   bl  10001ef0 &lt;mp_init&gt;\n\n    pyexec_frozen_module(\"main.py\");\n10000016:   4807        ldr r0, [pc, #28]   ; (10000034 &lt;micropython_main+0x34&gt;)\n10000018:   f006 f88e   bl  10006138 &lt;pyexec_frozen_module&gt;\n\n    mp_deinit();\n1000001c:   f001 ff94   bl  10001f48 &lt;mp_deinit&gt;\n\n    return 0;\n10000020:   f04f 0300   mov.w   r3, #0\n}\n10000024:   4618        mov r0, r3\n10000026:   f107 0710   add.w   r7, r7, #16\n1000002a:   46bd        mov sp, r7\n1000002c:   bd80        pop {r7, pc}\n1000002e:   bf00        nop\n10000030:   1fff34fc    .word   0x1fff34fc\n10000034:   1001eaf4    .word   0x1001eaf4\n</code></pre>\n\n<p>So why does it matter where I put the sections <code>.debug*</code>? I don't think it technically does. The portion of my linker file that affects the placement of the DWARF symbols looks like this:</p>\n\n<pre><code>  .debug_info     0 : { *(.debug_info .gnu.linkonce.wi.*) }\n  .debug_abbrev   0 : { *(.debug_abbrev) }\n  .debug_line     0 : { *(.debug_line) }\n  .debug_frame    0 : { *(.debug_frame) }\n  .debug_str      0 : { *(.debug_str) }\n  .debug_loc      0 : { *(.debug_loc) }\n  .debug_macinfo  0 : { *(.debug_macinfo) }\n</code></pre>\n\n<p>I'm guessing the ordering somehow matters.</p>\n"}], "owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 47582133, "answer_count": 1, "score": 2, "last_activity_date": 1512074037, "creation_date": 1511982981, "last_edit_date": 1511990601, "question_id": 47560152, "link": "https://stackoverflow.com/questions/47560152/gcc-linker-obj-dump-has-mixed-source-assembly-but-not-when-linked-in-elf", "title": "gcc linker - .obj dump has mixed source-assembly but not when linked in .elf", "body": "<p><strong>BACKGROUND</strong></p>\n\n<p>I have a project using C-code and C++ code. The linking is not an issue: the C-functions are correctly called by the C++ code.</p>\n\n<p>All my <code>.cpp</code> files are compiled with <code>-g3</code> but only <code>main.c</code> and <code>pyexec.c</code> are <code>-g3</code>; rest have no debug info.</p>\n\n<p>The linking step consists of linking a few <code>.cpp</code> archives, <code>.cpp</code> objects and archive containing <code>.c</code> objects.</p>\n\n<p><strong>PROBLEM</strong></p>\n\n<p>When I do an <code>objdump</code> on my <code>.elf</code></p>\n\n<p><code>objdump APP.elf -dSsxsgetr  &gt; elf.dump</code></p>\n\n<p>I see the source of the <code>.cpp</code> files interspersed with the assembly but not for the two <code>.c</code> files compiled with <code>-g3</code>.</p>\n\n<p><strong>DOUBLE-CHECK</strong></p>\n\n<p>I am absolutely sure I compiled <code>main.c</code> and <code>pyexec.c</code> with <code>-g3</code>. When I did an <a href=\"https://sourceware.org/binutils/docs/binutils/objdump.html\" rel=\"nofollow noreferrer\"><code>objdump -dSsxsgetr</code></a><code>main.obj</code>, I see the source interspersed with the assembly in addition to debug symbols such as <code>.debug_line</code> that contains the entire source of my <code>.c</code> file.</p>\n\n<p>My link command is:</p>\n\n<p><code>arm-none-eabi-ld.exe HW_Interface.obj HW_Module.obj HeapMngr.obj C_archive.a Cpp_archive.a -nostartfiles --no-warn-mismatch --gc-sections --stats --cref -Map=APP.map -T \"APP.ld\" -o \"APP.elf\"</code></p>\n\n<p><strong>QUESTION</strong></p>\n\n<p>Why aren't the debug line numbers from the <code>.c</code> objects compiled with <code>-g3</code> getting into the <code>.elf</code>?</p>\n\n<p><strong>UPDATE 1</strong></p>\n\n<p>I think what's stripping the symbols is my linker-script statement combined with the <code>--gc-sections</code> option to the linker:</p>\n\n<pre><code>.dflash_code :\n  {\n    *ATI_micropython.dlb:*(.text.*) \n    *ATI_micropython.dlb:*(.debug*)\n\n  } &gt;dflash\n</code></pre>\n\n<p>This statement is \"correct\" but what is happening (I think) is that since I'm not explicitly specifying whatever input section contains the line-by-line info <strong>and</strong> because <code>--gc-sections</code> says <em>discard any \"unused\" sections</em>, that info is being stripped.</p>\n\n<p>So the real question is: what's the input section I need to add to <code>.dflash_code</code> that contains the mixed source-assembly? The <code>.debug_line</code> section is already included and that contains the entire source for a given file.</p>\n\n<p>In <code>.map</code>, there is a section called <code>Discarded input sections</code>. In this section, I see that only for my two <code>.c</code> debug files, there's a bunch of <code>.debug_macro</code> statements . . . which doesn't make sense because  <code>*ATI_micropython.dlb:*(.debug*)</code> should've caught all such sections (unless I'm misunderstanding their purpose).</p>\n\n<pre><code>.debug_macro   0x00000000       0x3a ..\\archive.dlb(main.doj)\n .debug_macro   0x00000000       0x35 ..\\archive.dlb(main.doj)\n .debug_macro   0x00000000       0x3a ..\\archive.dlb(main.doj)\n .debug_macro   0x00000000       0x52 ..\\archive.dlb(main.doj)\n .debug_macro   0x00000000       0x19 ..\\archive.dlb(main.doj)\n .debug_macro   0x00000000      0x189 ..\\archive.dlb(main.doj)\n .debug_macro   0x00000000       0x10 ..\\archive.dlb(main.doj)\n .debug_macro   0x00000000       0x22 ..\\archive.dlb(main.doj)\n .debug_macro   0x00000000       0x91 ..\\archive.dlb(main.doj)\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 3, "creation_date": 1511983203, "post_id": 47560121, "comment_id": 82078069, "body": "<code>char args[100];</code> is a local array and his liftetime ends when you exit from the function, hence you receive garbage in <code>main</code>, use <code>strcpy(text, args);</code> instead of <code>text = args;</code>"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1511983739, "post_id": 47560121, "comment_id": 82078370, "body": "@KeineLust: Technically, the problem here doesn&#39;t even reach<code>args</code> expiring, because the assignment to <code>text</code> itself doesn&#39;t (and can&#39;t) change any pointer passed from outside the function. So <code>args</code> expires (but it might have worked by coincidence thanks to undefined behavior if no further function calls stomped the part of the stack it was written to), except that the caller never even received a pointer to it. :-)"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1511983984, "post_id": 47560121, "comment_id": 82078517, "body": "@KeineLust: Also note: Your solution is flawed; <code>read</code> doesn&#39;t <code>NUL</code>-terminate, so using <code>strcpy</code> from the buffer is an out-of-bounds read waiting to happen. You&#39;d want <code>memcpy(text, args, read);</code>, and you&#39;d want to return <code>read</code> to the caller so they could do <code>int numread = method(c);</code>, then <code>printf(&quot;%*s&quot;, numread, c);</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1511984254, "post_id": 47560121, "comment_id": 82078670, "body": "<code>read(STDIN_FILENO, args, 100);</code> ==&gt; <code>read(STDIN_FILENO, c, 100);</code> moved to <code>main</code>. No need for a function unless you want added value, which it does not provide. Even in that function: <code>read(STDIN_FILENO, text, 100);</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1511986785, "post_id": 47560121, "comment_id": 82079942, "body": "Given <code>int read = read(STDIN_FILENO, args, 100); &#47;&#47; i write &quot;sth&quot; on keyboard</code>, after reading <code>sth\\n</code> from <code>STDIN_FILENO</code> and placing it into the <code>args</code> buffer, the rest of the buffer is filled with unknown values.  <code>read()</code> does not <code>NUL</code>-terminate the data read.  <code>read()</code> also returns <code>ssize_t</code>, not <code>int</code>."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1511986975, "post_id": 47560121, "comment_id": 82080022, "body": "Minor correction to <a href=\"https://stackoverflow.com/questions/47560121/scanning-char-array-using-read#comment82078517_47560121\">my previous comment</a>: Format string should be <code>&quot;%.*s&quot;</code>, not <code>&quot;%*s&quot;, </code>.*` makes it a maximum number of bytes to read (protecting against buffer read overflow), while <code>*</code> without <code>.</code> sets a minimum field width (which wouldn&#39;t give the intended buffer read overflow protection)."}], "answers": [{"tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": false, "score": 1, "last_activity_date": 1511986315, "last_edit_date": 1511986315, "creation_date": 1511984561, "answer_id": 47560560, "question_id": 47560121, "link": "https://stackoverflow.com/questions/47560121/scanning-char-array-using-read/47560560#47560560", "title": "Scanning char array using read()", "body": "<p>Simplest solution: Make <code>method</code> require (by documentation guarantees, since C can't force a specific array size to be passed) the caller to provide the size 100 buffer, rather than maintain a local and non-local buffer. You'll also want to return the result from <code>read</code>, so the caller knows how many valid bytes they received:</p>\n\n<pre><code>/* ...\n * text - must point to at least 100 bytes of valid memory\n * Returns number of read bytes\n */\nint method(char* text) {\n    return read(STDIN_FILENO, text, 100); // i write \"sth\" on keyboard\n}\n</code></pre>\n\n<p>and in <code>main</code>:</p>\n\n<pre><code>char c[100];\n// Store number of valid bytes available\nint numvalid = method(c);\n// Use .* to specify a dynamic maximum field width, so you don't have a read overflow\nprintf(\"%.*s\", numvalid, c); // should print \"sth\"\n</code></pre>\n\n<p>Other approaches include having the function perform the allocation for the caller (with the caller passing a double-pointer and <code>free</code>ing the buffer themselves):</p>\n\n<pre><code>int method(char** text) { // Receives double-pointer so it can change caller's char*\n    *text = malloc(100); // Dynamic allocation (add error checking)\n    return read(STDIN_FILENO, *text, 100); // i write \"sth\" on keyboard\n}\n\nchar *c = NULL; // Pointer to be filled, not array\nint numvalid = method(&amp;c); // Pass address of pointer so method can change c\n// Use .* to specify a dynamic maximum field width, so you don't have a read overflow\nprintf(\"%.*s\", numvalid, c); // should print \"sth\"\nfree(c); // Free memory allocated by method\n</code></pre>\n\n<p>Or keep using your current, separated buffers, and copy from one to the other before the <code>method</code> exits via <code>memcpy</code> (which copies the data), not via pointer assignment (which doesn't change anything visible to the caller):</p>\n\n<pre><code>int method(char* text) {\n    char args[100];\n    int read = read(STDIN_FILENO, args, 100); // i write \"sth\" on keyboard\n    // Copy data from args to text buffer\n    // Note: Using memcpy, *not* strcpy, because read provides no guarantees\n    // that the buffer will be NUL-terminated\n    memcpy(text, args, read);\n    return read; // Still need to return number of valid bytes\n}\n\nchar c[100];\nint numvalid = method(c);\nprintf(\"%.*s\", numvalid, c); // should print \"sth\"\n</code></pre>\n\n<p>This approach is kind of pointless though; <code>method</code> still requires a 100 byte buffer to be passed to operate safely, it just needlessly puts the data in a temporary space, then copies it to the final destination to waste cycles.</p>\n\n<p>Finally, a solution that remains safe, while <em>not</em> requiring you to add a return value to <code>method</code>:</p>\n\n<pre><code>/* ...\n * text - must point to at least 100 bytes of valid memory\n * On return, data is NUL-terminated, *unless* 100 non-NUL bytes were read\n */\nvoid method(char* text) {\n    int numread = read(STDIN_FILENO, text, 100);\n    if (0 &lt;= numread &amp;&amp; numread &lt; 100) text[numread] = '\\0';\n\n    // Or the one-liner for people who don't believe in error handling: :-)\n    // text[read(STDIN_FILENO, text, 100)] = '\\0';\n}\n</code></pre>\n\n<p>and then the caller can assume that their buffer is at most 100 bytes, so they can use a limiter on the <code>%s</code> format code to stop on <code>NUL</code> or after 100 bytes, whichever comes first:</p>\n\n<pre><code>char c[100];\nmethod(c);\n// Use .100 to prevent read overflow, knowing that method NUL terminated\n// anything shorter than 100 bytes (preventing undefined behavior reading\n// uninitialized bytes for smaller reads)\nprintf(\"%.100s\", c); // should print \"sth\"\n</code></pre>\n"}], "owner": {"reputation": 346, "user_id": 7924815, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/bb5085c7ce7aa05a670aa2ba9fb6870a?s=128&d=identicon&r=PG&f=1", "display_name": "jakub1998", "link": "https://stackoverflow.com/users/7924815/jakub1998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1512011023, "creation_date": 1511982891, "question_id": 47560121, "link": "https://stackoverflow.com/questions/47560121/scanning-char-array-using-read", "title": "Scanning char array using read()", "body": "<p>Can I set char array by using read method in a function? I tried the way below, but it didn't give any effect. For me I take a pointer in <code>method()</code> argument, I save the data to it by <code>read()</code> and then I just \"give\" address of args to text.\nDon't blame me, I used to code in java, so the pointers may be used wrong, pay attention to every mistake I made (and inform me, please).</p>\n\n<pre><code>void method(char* text) {\n char args[100];\n int read = read(STDIN_FILENO, args, 100); // i write \"sth\" on keyboard\n text = args;\n}\n</code></pre>\n\n<p>in main:</p>\n\n<pre><code>char c[100];\nmethod(c);\nprintf(\"%s\",c); // should print \"sth\"\n</code></pre>\n"}, {"tags": ["android", "c", "debugging", "android-ndk", "address-sanitizer"], "comments": [{"owner": {"reputation": 951, "user_id": 4324545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/067a9cf7538d753e3be66e77ef951614?s=128&d=identicon&r=PG", "display_name": "Lapshin Dmitry", "link": "https://stackoverflow.com/users/4324545/lapshin-dmitry"}, "edited": false, "score": 0, "creation_date": 1511982806, "post_id": 47560028, "comment_id": 82077841, "body": "You probably mean Davlik/ART where you say JVM."}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "edited": false, "score": 0, "creation_date": 1512026002, "post_id": 47560028, "comment_id": 82093029, "body": "&quot;Well, it would be nice if it actually worked. If you add that flag and try building your library, you get a bunch of &quot;undefined symbol&quot; errors.&quot; That shouldn&#39;t be happening. That&#39;s normal for a non-Android ASAN build, but Android uses a shared library version of the ASAN runtime which avoids this. Take a look at <a href=\"https://android.googlesource.com/platform/ndk/+/master/tests/device/asan-smoke/\" rel=\"nofollow noreferrer\">android.googlesource.com/platform/ndk/+/master/tests/device/&zwnj;&#8203;&hellip;</a> for an example of how to use ASAN with the NDK."}, {"owner": {"reputation": 285, "user_id": 234420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6d7ad4f831a6229d62b336b307a24b2?s=128&d=identicon&r=PG&f=1", "display_name": "Glider", "link": "https://stackoverflow.com/users/234420/glider"}, "edited": false, "score": 0, "creation_date": 1512030432, "post_id": 47560028, "comment_id": 82095251, "body": "The list of undefined symbols should&#39;ve also helped."}, {"owner": {"reputation": 2105, "user_id": 738639, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f71f8b7b782532f9346c3a25f35f3908?s=128&d=identicon&r=PG", "display_name": "Grishka", "link": "https://stackoverflow.com/users/738639/grishka"}, "reply_to_user": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "edited": false, "score": 0, "creation_date": 1512081880, "post_id": 47560028, "comment_id": 82125340, "body": "@DanAlbert like every other example I&#39;ve ever seen, the one you linked builds an executable instead of a shared library."}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "edited": false, "score": 0, "creation_date": 1512095496, "post_id": 47560028, "comment_id": 82129245, "body": "So change it to <code>BUILD_SHARED_LIBRARY</code>."}, {"owner": {"reputation": 2105, "user_id": 738639, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f71f8b7b782532f9346c3a25f35f3908?s=128&d=identicon&r=PG", "display_name": "Grishka", "link": "https://stackoverflow.com/users/738639/grishka"}, "reply_to_user": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "edited": false, "score": 0, "creation_date": 1512141217, "post_id": 47560028, "comment_id": 82150218, "body": "@DanAlbert which is what my makefile looks like already, and then it either complains about <code>-lasan</code> not found if I pass <code>-fsanitize=address</code> to the linker as well or about missing <code>__asan_...</code> symbols if I don&#39;t. I&#39;ve already fixed that crash so I no longer need ASAN right now, but it would still be nice to know how to run it on an Android app because there isn&#39;t a definitive guide anywhere."}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "edited": false, "score": 0, "creation_date": 1512250900, "post_id": 47560028, "comment_id": 82184024, "body": "There is no <code>-lasan</code>. Where is that flag coming from?"}, {"owner": {"reputation": 2105, "user_id": 738639, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f71f8b7b782532f9346c3a25f35f3908?s=128&d=identicon&r=PG", "display_name": "Grishka", "link": "https://stackoverflow.com/users/738639/grishka"}, "edited": false, "score": 0, "creation_date": 1512251020, "post_id": 47560028, "comment_id": 82184056, "body": "I suppose the linker adds it automatically when I specify <code>-fsanitize=address</code> because it doesn&#39;t show this error when I don&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 2105, "user_id": 738639, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f71f8b7b782532f9346c3a25f35f3908?s=128&d=identicon&r=PG", "display_name": "Grishka", "link": "https://stackoverflow.com/users/738639/grishka"}, "edited": false, "score": 0, "creation_date": 1512042729, "post_id": 47567908, "comment_id": 82102433, "body": "I&#39;ve tried ASAN on a Moto X running 5.1 if that matters, and malloc debug on an emulator because I don&#39;t have an Oreo device with an unlocked bootloader. As I was writing this I realized I also have a Nexus 9 that I unlocked bootloader on at some point so I&#39;ll now try rooting it and running ASAN on it as well."}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "reply_to_user": {"reputation": 2105, "user_id": 738639, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f71f8b7b782532f9346c3a25f35f3908?s=128&d=identicon&r=PG", "display_name": "Grishka", "link": "https://stackoverflow.com/users/738639/grishka"}, "edited": false, "score": 0, "creation_date": 1512069736, "post_id": 47567908, "comment_id": 82119513, "body": "KitKat/Lollipop is when the ASAN for Android stuff was just coming together. It might be a much better experience on something newer."}, {"owner": {"reputation": 2105, "user_id": 738639, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f71f8b7b782532f9346c3a25f35f3908?s=128&d=identicon&r=PG", "display_name": "Grishka", "link": "https://stackoverflow.com/users/738639/grishka"}, "edited": false, "score": 0, "creation_date": 1512086551, "post_id": 47567908, "comment_id": 82126848, "body": "I&#39;ve updated my question with the results of my further unsuccessful experiments"}], "tags": [], "owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "is_accepted": false, "score": 2, "last_activity_date": 1512026404, "creation_date": 1512026404, "answer_id": 47567908, "question_id": 47560028, "link": "https://stackoverflow.com/questions/47560028/using-the-clang-address-sanitizer-in-an-ndk-library-on-android/47567908#47567908", "title": "Using the Clang address sanitizer in an NDK library on Android", "body": "<p>You should probably file bugs (<a href=\"http://b.android.com\" rel=\"nofollow noreferrer\">http://b.android.com</a>) if you're seeing performance issues this serious. We run devices that are fully ASAN instrumented every day and those work better than you'd expect. ASAN is a roughly 2x slowdown, but running your app with ASAN should work fine.</p>\n\n<p>Same goes for debug malloc (I don't remember the performance implications of debug malloc, but I thought they were less severe than ASAN).</p>\n"}], "owner": {"reputation": 2105, "user_id": 738639, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f71f8b7b782532f9346c3a25f35f3908?s=128&d=identicon&r=PG", "display_name": "Grishka", "link": "https://stackoverflow.com/users/738639/grishka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1512086365, "creation_date": 1511982478, "last_edit_date": 1512086365, "question_id": 47560028, "link": "https://stackoverflow.com/questions/47560028/using-the-clang-address-sanitizer-in-an-ndk-library-on-android", "title": "Using the Clang address sanitizer in an NDK library on Android", "body": "<p>The NDK has the ability to enable the address sanitizer on anything you build with it by adding the <code>-fsanitize=address</code> flag to both <code>LOCAL_CFLAGS</code> and <code>LOCAL_LDFLAGS</code>, which is nice. Well, it would be nice if it actually worked. If you add that flag and try building your library, you get a bunch of \"undefined symbol\" errors. You can ignore these errors by passing <code>-Wl,--unresolved-symbols=ignore</code> to the linker and the build completes successfully, but of course the adventure doesn't end here.</p>\n\n<p>The <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizerOnAndroid\" rel=\"nofollow noreferrer\">Google's guide</a> then says that you need a rooted device on which you run a script that modifies the runtime executable on the system partition so it loads the ASan library, and then the aforementioned missing symbols link at runtime. I tried this, and the main problem with this approach is that it also profiles something in the JVM itself thus slowing it down so much that the app doesn't start at all or crashes somewhere inside the JVM.</p>\n\n<p>I've also tried the new <a href=\"https://android.googlesource.com/platform/bionic/+/master/libc/malloc_debug/README.md\" rel=\"nofollow noreferrer\">malloc debug</a> on an emulator but it also debugs the entire JVM thus making it unusable. All these tools seem to be absolutely not intended for the app developers but for those who work on Android itself.</p>\n\n<p>I desperately need a way to fix a memory corruption crash in my app without profiling the whole virtual machine in the process. Will ASan work if I just put its library into my apk and load it before my JNI library? Are there any other ways to debug this? How do people fix this kind of bugs on Android at all?</p>\n\n<p>Making a \"minimal wrapper executable\" and running it on some other operating system that has proper debugging tools isn't really an option here because the way the JNI library is used depends substantially on the Java part, and even if I make one, I can't be entirely sure that this bug will reproduce.</p>\n\n<p>Update: I tried the <code>asan_device_setup</code> script on an Oreo emulator because it didn't work at all this time on a Nexus 9 with Nougat. The log flooded with linker errors of 32-bit processes trying to load 64-bit libraries and then it froze and the only way to make it usable again was flashing the factory image. Just to be sure I didn't mess anything up, I tried it several times reflashing the factory image, then TWRP, than SuperSU, and then using the \"adbd insecure\" app to restart the adb daemon as root. So, I started the emulator with <code>-writable-system</code> and ran the script on it, it completed successfully. I then built my app with ASAN and installed it, but it crashes with <code>java.lang.UnsatisfiedLinkError: dlopen failed: cannot locate symbol \"__asan_init_v3\" referenced by \"/data/...full path to the shared library</code> on launch. I tried it both with and without <code>setprop wrap.com.app.package \"asanwrapper\"</code>, the result is the same.</p>\n"}, {"tags": ["c", "function", "numbers", "sieve"], "comments": [{"owner": {"reputation": 31113, "user_id": 112079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ccb721ddaf2f6e7dccc66262f406b1?s=128&d=identicon&r=PG&f=1", "display_name": "fvu", "link": "https://stackoverflow.com/users/112079/fvu"}, "edited": false, "score": 0, "creation_date": 1511982281, "post_id": 47559937, "comment_id": 82077573, "body": "Knowing the message with which it crashes might help. <code>char v[n];</code> for n=2M inside main may be an issue as that variable will be allocated from the stack, which in most cases is quite limited in size."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1511982311, "post_id": 47559937, "comment_id": 82077600, "body": "Using <code>i</code> as a counter for a loop <i>and</i> an nested loop? Sounds like a trouble."}, {"owner": {"reputation": 5, "user_id": 9027493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a45f34ddbdc63c3d0e63cda72c8522?s=128&d=identicon&r=PG&f=1", "display_name": "Nord", "link": "https://stackoverflow.com/users/9027493/nord"}, "reply_to_user": {"reputation": 31113, "user_id": 112079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ccb721ddaf2f6e7dccc66262f406b1?s=128&d=identicon&r=PG&f=1", "display_name": "fvu", "link": "https://stackoverflow.com/users/112079/fvu"}, "edited": false, "score": 0, "creation_date": 1511982427, "post_id": 47559937, "comment_id": 82077674, "body": "@fvu Process returned -1073741571 (0xC00000FD)   execution time : 2.032 s"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1511982500, "post_id": 47559937, "comment_id": 82077702, "body": "Use bit storage. That will give you 8x the range."}, {"owner": {"reputation": 5, "user_id": 9027493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a45f34ddbdc63c3d0e63cda72c8522?s=128&d=identicon&r=PG&f=1", "display_name": "Nord", "link": "https://stackoverflow.com/users/9027493/nord"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1511982801, "post_id": 47559937, "comment_id": 82077835, "body": "@EugeneSh. No. The programm works perfectly for numbers up to 2000000. I need to use the same i in both loops"}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1511982976, "post_id": 47559937, "comment_id": 82077919, "body": "@EugeneSh. The indenting is off, but assuming the brackets are correct, the second for loop using <code>i</code> is not nested within the first for loop. The first for loop is purely for initialization of the <code>primes</code> array"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1511983059, "post_id": 47559937, "comment_id": 82077983, "body": "@Taelsin Oh my. You are right. The indentation is not just terrible, it is highly misleading here."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1511986160, "post_id": 47559937, "comment_id": 82079652, "body": "<code>char v[n]</code> puts two megabytes on the stack--that might be too much for your runtime. Use <code>malloc</code>. Even better, use malloc and bit-manipulation so that you only need one bit per number."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9027493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a45f34ddbdc63c3d0e63cda72c8522?s=128&d=identicon&r=PG&f=1", "display_name": "Nord", "link": "https://stackoverflow.com/users/9027493/nord"}, "edited": false, "score": 0, "creation_date": 1511983811, "post_id": 47560164, "comment_id": 82078420, "body": "I never worked with pointers or the malloc function, but I tried to do this anyway. So now I have the following problem:  at the line with  &quot;sieve(n, v);&quot;  neither &quot;sieve(n, v);&quot; nor &quot;sieve(n, v*);&quot; works. What should I do there? With v: &quot;passing argument 2 of &#39;sieve&#39; from incompatible pointer type&quot; With *v: &quot;&#39;sieve&#39; makes pointer from integer without a cast&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511984015, "post_id": 47560164, "comment_id": 82078528, "body": "Pedram Azad, As OP is having trouble which may later include memory capacity issues, checking for <code>malloc()</code> success is prudent."}, {"owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "edited": false, "score": 0, "creation_date": 1511984027, "post_id": 47560164, "comment_id": 82078535, "body": "It should compile without any further changes. Maybe you forgot to adapt the declaration or the definition of your function &lt;code&gt;sieve&lt;/code&gt;? You need to adapt both."}, {"owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1511984198, "post_id": 47560164, "comment_id": 82078639, "body": "@chux We are talking about less than 2 MB of memory. For heap allocation, this can only become problematic for really exotic systems. And I do not assume that the OP is doing DSP programming. But ok, for use with a lot larger n, a check would be useful."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511985602, "post_id": 47560164, "comment_id": 82079332, "body": "OP could be on an interactive system emulating a real computer and for student purposes works in a small sandbox - the initial issue is a memory one.  IAC, learners do <i>interesting things</i> and checking <code>malloc()</code> can discover an error faster.  Yet if a goal is <a href=\"https://codegolf.stackexchange.com\">code golf</a>, then yes, do not bother with a <code>malloc()</code> check."}], "tags": [], "owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "is_accepted": true, "score": 1, "last_activity_date": 1511983900, "last_edit_date": 1511983900, "creation_date": 1511983030, "answer_id": 47560164, "question_id": 47559937, "link": "https://stackoverflow.com/questions/47559937/sieve-of-eratosthenes-for-higher-numbers-than-2-million-c/47560164#47560164", "title": "Sieve of Eratosthenes for higher numbers than 2 Million [C]", "body": "<p>Stick to the name of this website; you are experiencing a stack overflow. ;-)</p>\n\n<p>Try</p>\n\n<pre><code>char *v = malloc(n);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>void sieve(unsigned long long int n, char *primes)\n</code></pre>\n\n<p>respectively. Of course, you will also need</p>\n\n<pre><code>free(v);\n</code></pre>\n\n<p>Apart from that, I haven't checked your algorithm for correctness.</p>\n"}, {"tags": [], "owner": {"reputation": 2289, "user_id": 3142347, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Tbfqk.jpg?s=128&g=1", "display_name": "tupan", "link": "https://stackoverflow.com/users/3142347/tupan"}, "is_accepted": false, "score": 1, "last_activity_date": 1511985524, "last_edit_date": 1511985524, "creation_date": 1511984796, "answer_id": 47560617, "question_id": 47559937, "link": "https://stackoverflow.com/questions/47559937/sieve-of-eratosthenes-for-higher-numbers-than-2-million-c/47560617#47560617", "title": "Sieve of Eratosthenes for higher numbers than 2 Million [C]", "body": "<p>The problem is because your program did not have enough memory reserved and as mentioned by @Pedram Azad you had an stack overflow. You can by-pass that by allocating more memory to your var (malloc).</p>\n\n<p>Also, you need to start using brackets for your code blocks (loops and conditional statements). It helps to visualize problems. The indentation was very confusing.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid sieve(unsigned long long int, char *);\n\n\nint main()\n{\n  unsigned long long int i, n = 63000000; // find the primes up to 500000\n  char *v = (char*) malloc(n*sizeof(char));\n  sieve(n, v);\n  for (i=0; i&lt;n; i++) {\n    if (v[i] == 1) {\n      printf(\"%lld\\n\",i); // this just prints out each value if it's Prime\n    }\n  }\n  free(v);\n}\n\nvoid sieve(unsigned long long int n, char *primes)\n{\n  unsigned long long int i, j;\n  for (i=0; i&lt;n; i++) {\n    primes[i]=1; // we initialize the sieve list to all 1's (True)\n  }\n  // Set the first two numbers (0 and 1) to 0 (False)\n  primes[0]=0;\n  primes[1]=0;\n  // loop through all the numbers up to the sqrt(n)\n  for (i=2; i&lt;sqrt(n); i++) {\n    for (j=i*i; j&lt;n; j+=i) {\n      // mark off each factor of i by setting it to 0 (False)\n      primes[j] = 0;\n    }\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9027493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a45f34ddbdc63c3d0e63cda72c8522?s=128&d=identicon&r=PG&f=1", "display_name": "Nord", "link": "https://stackoverflow.com/users/9027493/nord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 47560164, "answer_count": 2, "score": 0, "last_activity_date": 1511985524, "creation_date": 1511982111, "last_edit_date": 1511984526, "question_id": 47559937, "link": "https://stackoverflow.com/questions/47559937/sieve-of-eratosthenes-for-higher-numbers-than-2-million-c", "title": "Sieve of Eratosthenes for higher numbers than 2 Million [C]", "body": "<p>I am trying to make a program which names all prime numbers up to n. When I enter numbers > 2 Million, the program crashes. Can someone help me?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nvoid sieve(unsigned long long int n, char primes[]);\n\nint main()\n{\n  unsigned long long int i, n = 2000000; // find the primes up to 500000\n  char v[n];\n  sieve(n, v);\n  for (i=0;i&lt;n;i++)\n    if (v[i] == 1)\n      printf(\"%I64u\\n\",i); // this just prints out each value if it's Prime\n}\n\nvoid sieve(unsigned long long int n, char primes[])\n{\n  unsigned long long int i, j;\n  for (i=0;i&lt;n;i++)\n    primes[i]=1; // we initialize the sieve list to all 1's (True)\n  primes[0]=0,primes[1]=0; // Set the first two numbers (0 and 1) to 0 (False)\n  for (i=2;i&lt;sqrt(n);i++) // loop through all the numbers up to the sqrt(n)\n    for (j=i*i;j&lt;n;j+=i) // mark off each factor of i by setting it to 0 (False)\n      primes[j] = 0;\n}\n</code></pre>\n\n<p>Error message:</p>\n\n<blockquote>\n  <p>Process returned -1073741571 (0xC00000FD) execution time : 2.032 s</p>\n</blockquote>\n"}, {"tags": ["c", "multithreading", "mpi", "openmp", "distributed-computing"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1511994559, "post_id": 47559929, "comment_id": 82083690, "body": "We can&#39;t possible help you based on that code snippet. If you really believe you narrowed down the performance issue, then craft a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and post it here - along with a detailed system description, performance observation as well as expectations. Otherwise you&#39;re on your own. Make sure to use a MPI aware performance analysis tool."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1512000926, "post_id": 47559929, "comment_id": 82085900, "body": "don&#39;t you need <code>#pragma omp barrier</code> before <code>#pragma omp single</code> ? if the threads not executing <code>MPI_Sendrecv_replace()</code> are spinning, that might impact MPI performance. there is likely a runtime setting to change that behavior. also, which MPI library (and version) are you using, and what are the requested and provided thread levels by <code>MPI_Init_thread()</code> ?"}, {"owner": {"reputation": 1, "user_id": 9027456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1a970645ca7d454fa672ad8980f83c2?s=128&d=identicon&r=PG&f=1", "display_name": "jdesmond", "link": "https://stackoverflow.com/users/9027456/jdesmond"}, "edited": false, "score": 0, "creation_date": 1512166810, "post_id": 47559929, "comment_id": 82163335, "body": "I edited my original post with the information you requested. Thanks."}, {"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 0, "creation_date": 1512192612, "post_id": 47559929, "comment_id": 82168459, "body": "I didn&#39;t try the code, but by reading it, it appears that the initialization of MPI should request  at least a <code>MPI_THREAD_SERIALIZED</code> level of thread support, and that <code>MPI_THREAD_SINGLE</code> is definitely not enough. Just try that and check the value returned by <code>MPI_Init_thread()</code> for actually provided support. As it is now, your code is invalid."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1512221349, "post_id": 47559929, "comment_id": 82175170, "body": "or if you replace <code>#pragma omp single</code> with <code>#pragma omp master</code> (i assume you do need a barrier before that), <code>MPI_THREAD_FUNNELED</code> could be enough"}, {"owner": {"reputation": 1, "user_id": 9027456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1a970645ca7d454fa672ad8980f83c2?s=128&d=identicon&r=PG&f=1", "display_name": "jdesmond", "link": "https://stackoverflow.com/users/9027456/jdesmond"}, "edited": false, "score": 0, "creation_date": 1512320908, "post_id": 47559929, "comment_id": 82199744, "body": "Gilles,  The only value supported by the MPI implementation I&#39;m using is <code>MPI_THREAD_SINGLE</code>. However, replacing  <code>#pragma omp single</code> with <code>#pragma omp master</code> reduced the overhead dramatically; do you know why this is? Also, there was a <code>#pragma omp barrier</code> already in at the end of the last method called just before <code>#pragma omp single</code> in my full-length code, so I should have added it explicitly in my example.   Thanks a lot for the help."}], "owner": {"reputation": 1, "user_id": 9027456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1a970645ca7d454fa672ad8980f83c2?s=128&d=identicon&r=PG&f=1", "display_name": "jdesmond", "link": "https://stackoverflow.com/users/9027456/jdesmond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 437, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512166771, "creation_date": 1511982074, "last_edit_date": 1512166771, "question_id": 47559929, "link": "https://stackoverflow.com/questions/47559929/n-body-solver-using-c-with-mpi-and-openmp-performance-issues-with-multiple-thre", "title": "N-Body Solver using C with MPI and OpenMP: performance issues with multiple threads due to communication between processes", "body": "<p>My N-body solver runs great when I use multiple processes and one thread or multiple threads and one process, but it suffers from serious performance issues due to proccess-communication when I use multiple processes AND multiple threads.</p>\n\n<p>I have narrowed down the performance issues and marked them in the code below. There are a couple of key findings I have made already: </p>\n\n<ol>\n<li><p>Even if MPI_Sendrecv_replace is called outside of a omp parallel block the issues still persist.</p></li>\n<li><p>Using MPI_Ssend and MPI_Recv instead of MPI_Sendrecv doesn't help</p></li>\n<li><p>Everything else in my code works perfectly, so don't worry about variables that have not been assigned a value within my code snippet.</p></li>\n</ol>\n\n<p>*Edit\nI am running my code on an HPC cluster at my school that doesn't have any MPI performance analysis tools. </p>\n\n<p>MPI version: 1.6.2</p>\n\n<p>System hardware info listed at: <a href=\"http://acs.kennesaw.edu/services/hpcnodes.php\" rel=\"nofollow noreferrer\">http://acs.kennesaw.edu/services/hpcnodes.php</a></p>\n\n<p>Minimal, Complete, and Verifiable example (perforamnce issue at line 87):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;mpi.h&gt;\n\nint main(int argc, char *argv[])\n{\ndouble local_start, local_finish, local_elapsed, elapsed, test_start, test_finish, test_elapsed, test_final, t_delta;\nint required, provided, my_rank, comm_sz, i, phase, thread_count, num_approximations, num_particles, \n    local_num_particles, dimensions, send_to, recv_from;\nchar *ptr;\n\nrequired = MPI_THREAD_SINGLE;\nMPI_Init_thread(&amp;argc, &amp;argv, required, &amp;provided); \nMPI_Comm_size(MPI_COMM_WORLD, &amp;comm_sz);\nMPI_Comm_rank(MPI_COMM_WORLD, &amp;my_rank);\nMPI_Barrier(MPI_COMM_WORLD);\n\nthread_count = strtol(argv[1], &amp;ptr, 10);\nnum_particles = strtol(argv[2], &amp;ptr, 10);\nt_delta = strtod(argv[3], &amp;ptr);\nnum_approximations = strtol(argv[4], &amp;ptr, 10);\n\nlocal_num_particles = num_particles/comm_sz;\nfloat *temp_forces_positions = malloc(2 * dimensions * local_num_particles * sizeof(float));\nfor(i = 0; i &lt; 2 * dimensions * local_num_particles; i++)\n    temp_forces_positions[i] = 0;\n\nif(my_rank == 0)\n    printf(\"START\\n\\n\");\n\nsend_to = (my_rank + 1) % comm_sz;\nrecv_from = (my_rank + comm_sz - 1) % comm_sz;\n\nMPI_Barrier(MPI_COMM_WORLD);\nlocal_start = MPI_Wtime();\n\n#pragma omp parallel num_threads(thread_count) private(i, phase)\n{   \n    for(i = 0; i &lt; num_approximations; i++)\n    {                                   \n        for(phase = 0; phase &lt; comm_sz; phase++)\n        {\n            #pragma omp single\n            {\n                test_start = MPI_Wtime();\n                /* PERFORMANCE ISSUES START HERE */\n                MPI_Sendrecv_replace(temp_forces_positions, local_num_particles * dimensions * 2, MPI_FLOAT, send_to, 0, recv_from, 0, MPI_COMM_WORLD, MPI_STATUS_IGNORE);  \n                /* PERFORMANCE ISSUES END HERE */\n                test_finish = MPI_Wtime();\n                test_elapsed += (test_finish - test_start);                                         \n            }\n        }       \n    }\n}\n\nMPI_Barrier(MPI_COMM_WORLD);\nlocal_finish = MPI_Wtime(); \nlocal_elapsed = local_finish - local_start;\nMPI_Reduce(&amp;local_elapsed, &amp;elapsed, 1, MPI_DOUBLE, MPI_MAX, 0, MPI_COMM_WORLD);\nMPI_Reduce(&amp;test_elapsed, &amp;test_final, 1, MPI_DOUBLE, MPI_MAX, 0, MPI_COMM_WORLD);\n\nif(my_rank == 0)\n{       \n    printf(\"FINISHED\\n\\n\");\n    printf(\"Time taken total: %lf seconds\\n\", elapsed);\n    printf(\"Time taken for communication: %lf seconds\\n\", test_final);\n}\nMPI_Finalize();\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>Compile:\nmmpicc -g -Wall -fopenmp -o n-body_issues n-body_issues.c</p>\n\n<p>Execute:\nmpiexec -n  ./n-body_issues    </p>\n\n<p>Run with at least 64 threads and 1000 approximations.</p>\n\n<p>Expected performance:</p>\n\n<p>With 4 processes, using 1, 2, or 3 threads words fine. Running on 4 threads results in a huge overhead.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "arrays", "loops", "conditional-statements"], "comments": [{"owner": {"reputation": 2439, "user_id": 7089665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b544b5944e4ad813695a8c5c4252b10e?s=128&d=identicon&r=PG&f=1", "display_name": "Dhiraj", "link": "https://stackoverflow.com/users/7089665/dhiraj"}, "edited": false, "score": 0, "creation_date": 1511982096, "post_id": 47559834, "comment_id": 82077481, "body": "What is the problem? Error?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511985957, "post_id": 47559834, "comment_id": 82079537, "body": "What is the minimum allowed value?  If 0, then there is no need to ask for the 16th input."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9027175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Kron.jpg?s=128&g=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/9027175/marcus"}, "edited": false, "score": 0, "creation_date": 1511985607, "post_id": 47559968, "comment_id": 82079333, "body": "Thank you for answering, i&#39;ve been trying to do what you&#39;ve said but can&#39;t yet figure out how to implemt it. Could you write it down in a little more detailed way... Thanks, im new to C :)"}, {"owner": {"reputation": 6850, "user_id": 650884, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7475fa31c3962a357047617df181c680?s=128&d=identicon&r=PG", "display_name": "Pavel", "link": "https://stackoverflow.com/users/650884/pavel"}, "reply_to_user": {"reputation": 1, "user_id": 9027175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Kron.jpg?s=128&g=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/9027175/marcus"}, "edited": false, "score": 0, "creation_date": 1511986272, "post_id": 47559968, "comment_id": 82079693, "body": "I&#39;ve added some pseudo code. Give it a try, implement it in C!"}], "tags": [], "owner": {"reputation": 6850, "user_id": 650884, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7475fa31c3962a357047617df181c680?s=128&d=identicon&r=PG", "display_name": "Pavel", "link": "https://stackoverflow.com/users/650884/pavel"}, "is_accepted": false, "score": 0, "last_activity_date": 1511986127, "last_edit_date": 1511986127, "creation_date": 1511982224, "answer_id": 47559968, "question_id": 47559834, "link": "https://stackoverflow.com/questions/47559834/prevent-user-from-entering-the-same-number-more-than-once/47559968#47559968", "title": "Prevent user from entering the same number more than once", "body": "<p>I'd define an array of \"seen\" digits where you store a 0/1 flag for the numbers the user has already entered, something like </p>\n\n<pre><code>int seen[16]; // initialize with 0\n</code></pre>\n\n<p>Then, everytime <code>scanf_s</code> gives you the most recent input (let's call it <code>in</code> for brevity), you check if <code>seen[in] == 0</code>. If it is, just store the number in <code>matrixArray</code>, set <code>seen[in] = 1</code> and continue. If it's not, the user has entered a number twice. Just discard the input, give her a nice error message and continue. That can be done in a <code>while</code> loop.</p>\n\n<p><strong>pseudo code</strong></p>\n\n<pre><code>ok = false\nfor i = 1..4 {\n  for j = 1..4 {\n    while (not ok) {\n      in = scanf()\n      if (not 1 &lt;= in &lt;= 16)\n        error(\"input must be between 1 and 16; try again\")\n        continue\n\n      if seen[in] == 1\n        error(\"you already entered that number; try again\")\n        continue\n      else\n        matrixArray[i][j] = in\n        seen[in] = 1\n        ok = true\n    }\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1511987057, "last_edit_date": 1511987057, "creation_date": 1511986623, "answer_id": 47561081, "question_id": 47559834, "link": "https://stackoverflow.com/questions/47559834/prevent-user-from-entering-the-same-number-more-than-once/47561081#47561081", "title": "Prevent user from entering the same number more than once", "body": "<p>Use the prior values read to look for duplicates</p>\n\n<pre><code>#define ROW 4\n#define COL 4\nint total = ROW*COL;\nprintf(\"Skriv in %d olika v\u00e4rden f\u00f6r din %d x %d kvadrat: \", total, ROW, COL); \nfor (int i = 0; i &lt; total; i++) {\n  bool duplicate;\n  do {\n    duplicate = false;\n    unsigned value; \n    if (scanf_s(\"%x\", &amp;value) != 1) {\n      printf(\"Numeric data not entered\\n\");\n      exit(-1);\n    }\n    for (int k = 0; k &lt; i; k++) {  // look through prior values\n      int r2 = k/COL;\n      int c2 = k%COL;\n      if (value == matrixArray[r2][c2]) {\n        duplicate = true;\n        printf(\"Duplicate\\n\");\n        break;\n      }\n    }\n  } while (duplicate);  // reject recent entry and try again.\n  int r = i/COL;\n  int c = i%COL;\n  matrixArray[r][c] = value;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9027175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Kron.jpg?s=128&g=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/9027175/marcus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1511987057, "creation_date": 1511981721, "last_edit_date": 1511982302, "question_id": 47559834, "link": "https://stackoverflow.com/questions/47559834/prevent-user-from-entering-the-same-number-more-than-once", "title": "Prevent user from entering the same number more than once", "body": "<p>Also need a condition where's the user cannot input a value higher than 15.\nif the user inserts the same hexa again it will restart the \"loop\"</p>\n\n<pre><code> int matrixArray[4][4], i, j, rowsum, columnsum, diagonalsum;\n\n\n printf(\"Skriv in 16 olika v\u00e4rden f\u00f6r din 4 x 4 kvadrat: \"); // asks user to insert 16 numbers to see if its a magicsquare\n\n for (i = 0; i &lt; 4; i++) {\n        for (j = 0; j &lt; 4; j++) {\n            scanf_s(\"%x\", &amp;matrixArray[i][j]);  // inserts values into the array\n\n            }\n        }\n</code></pre>\n"}, {"tags": ["c", "pointers", "access-violation"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1511982010, "post_id": 47559828, "comment_id": 82077419, "body": "<i>what am I missing?</i> - the calling code."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1511982037, "post_id": 47559828, "comment_id": 82077440, "body": "The problem might easily be in the calling code, which you failed to provide."}, {"owner": {"reputation": 71, "user_id": 7418314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27dbc2592a0ae1db21ac18851d1a1f8d?s=128&d=identicon&r=PG", "display_name": "Eden Dupont", "link": "https://stackoverflow.com/users/7418314/eden-dupont"}, "edited": false, "score": 0, "creation_date": 1511982540, "post_id": 47559828, "comment_id": 82077722, "body": "added the main, which calls this function."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1511982702, "post_id": 47559828, "comment_id": 82077797, "body": "This is unlikely to be the reson for the crash, but anyway: it is incorrect to print the result of <code>temp - string</code> as <code>%d</code>. The proper format is <code>%td</code>. Or at least explcitly cast the result ot <code>int</code>: <code>(int) (temp - string)</code>"}, {"owner": {"reputation": 71, "user_id": 7418314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27dbc2592a0ae1db21ac18851d1a1f8d?s=128&d=identicon&r=PG", "display_name": "Eden Dupont", "link": "https://stackoverflow.com/users/7418314/eden-dupont"}, "edited": false, "score": 0, "creation_date": 1511982965, "post_id": 47559828, "comment_id": 82077913, "body": "added casting as mentioned, but the problem remains.."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1511983027, "post_id": 47559828, "comment_id": 82077952, "body": "@Eden Dupont: What string did you enter? And what is the value of <code>findIndex</code> when you call the function?"}, {"owner": {"reputation": 71, "user_id": 7418314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27dbc2592a0ae1db21ac18851d1a1f8d?s=128&d=identicon&r=PG", "display_name": "Eden Dupont", "link": "https://stackoverflow.com/users/7418314/eden-dupont"}, "edited": false, "score": 0, "creation_date": 1511983234, "post_id": 47559828, "comment_id": 82078090, "body": "for the string &quot;hello&quot; and findIndex = &#39;l&#39; the console output is:  &quot;the char l is located at index 2&quot;  and then the program throws to debug window with message pointing at while -  &quot;Exception thrown at 0x00007FFD0A2D9E80 (ucrtbased.dll) in EdenDupont.exe: 0xC0000005: Access violation reading location 0x00000000526FF7AB.&quot;"}, {"owner": {"reputation": 71, "user_id": 7418314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27dbc2592a0ae1db21ac18851d1a1f8d?s=128&d=identicon&r=PG", "display_name": "Eden Dupont", "link": "https://stackoverflow.com/users/7418314/eden-dupont"}, "edited": false, "score": 0, "creation_date": 1511983894, "post_id": 47559828, "comment_id": 82078471, "body": "finally solved the problem, i did #include &lt;string.h&gt; in the main and not the source file where the function resides..I didn&#39;t know string.h was necessary to read partial strings..  thank you for your help"}, {"owner": {"reputation": 429, "user_id": 3814775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8614686c908b84f4fb9c43d954bdf3?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/3814775/bruce"}, "edited": false, "score": 1, "creation_date": 1511992252, "post_id": 47559828, "comment_id": 82082630, "body": "Glad you solved it. But allow me to say a few more words. Function printIndexesOfChar() still will go wrong, if the second argument is &#39;\\0&#39;. So I suggest to change <code>while (strlen(temp) &gt; 0)</code> into <code>for (; strlen(temp) &gt; 0; temp++)</code>, and remove statement  <code>temp++;</code> from the loop body.  ( <code>for(; *temp; temp++)</code> is better for performance. )"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512004577, "post_id": 47559828, "comment_id": 82086853, "body": "for ease of readability and understanding: 1) please consistently indent the code.  indent after every opening brace &#39;{&#39;.  unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512004658, "post_id": 47559828, "comment_id": 82086870, "body": "when calling any of the <code>scanf()</code> family of functions, 1) always check the returned value (not the parameter values) to assure the operation was successful.  2) when using the &#39;%s&#39; input format specifier, always include a MAX CHARACTERS modifier that is one less than the length of the input buffer.  This is to limit the length of the number characters input And because the &#39;%s&#39; and &#39;%[,,,]&#39; input format specifiers always append a NUL byte to the input"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512004904, "post_id": 47559828, "comment_id": 82086946, "body": "what is the function: <code>getche()</code>.  it is not part of the standard C librarys"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512005017, "post_id": 47559828, "comment_id": 82086969, "body": "regarding: <code>indexChar = getche();</code>  this will probably input the newline that was still in the input stream from the call to <code>scanf()</code>  probably not what your program is really interested in."}, {"owner": {"reputation": 71, "user_id": 7418314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27dbc2592a0ae1db21ac18851d1a1f8d?s=128&d=identicon&r=PG", "display_name": "Eden Dupont", "link": "https://stackoverflow.com/users/7418314/eden-dupont"}, "edited": false, "score": 0, "creation_date": 1512052002, "post_id": 47559828, "comment_id": 82108347, "body": "thank you for the tips, had trouble copying the code to this interface so it didn&#39;t indent so good"}], "owner": {"reputation": 71, "user_id": 7418314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27dbc2592a0ae1db21ac18851d1a1f8d?s=128&d=identicon&r=PG", "display_name": "Eden Dupont", "link": "https://stackoverflow.com/users/7418314/eden-dupont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593969733, "creation_date": 1511981707, "last_edit_date": 1593969733, "question_id": 47559828, "link": "https://stackoverflow.com/questions/47559828/read-access-violation-string-pointer", "title": "Read Access violation string pointer", "body": "<p>I'm trying to run this function, to print the indexes of char within a string.\nwhile it runs for the first index of a string and prints the index, after incrementing the string pointer by 1 (to continue reading the string from where it left) it throws me out with the message :</p>\n\n<p>\"Access violation reading location 0x00000000066FF2E9.\" when it returns to the while loop for the second time.</p>\n\n<p>I've done this type of thing before and it worked, what am I missing?\nI don't think I've exceeded the string length with the pointer so there shouldn't be a problem from what I know...\nvery thankful for any help! </p>\n\n<pre><code>void printIndexesOfChar(char* string, char findIndex)\n{\nchar* temp = string;\n  while(strlen(temp) &gt; 0)   \n  {\n      printf(\"%s \\n\", temp);                //prints what is left of the string to check\n      temp = strchr(temp, findIndex);       //get pointer to the char we are looking for to calculate index\n\n      if (temp != NULL)                     //if strchr didn't return NULL\n      {\n          printf(\"the char %c is located at index %d\\n\\n\", findIndex, (temp - string));   //prints index\n          temp++;                           //continue the string after the char index we found in the next iteration\n      }\n      else\n      {\n          break;                            //exits while if no more chars in the string\n      }\n  }\n}\n</code></pre>\n\n<p>the main :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#define MAX_CHARS_STR 40\nvoid main()\n{\n        char str[MAX_CHARS_STR];\n        char indexChar;\n\n        printf(\"\\nProgram 3 Selected.\\n\\nPlease enter a string of characters for the indexes to be shown.\\n\");\n        scanf(\"%s\", str);\n        printf(\"\\nType which character index to print:\");\n        indexChar = getche();\n        printf(\"\\n\");\n        printIndexesOfChar(str, indexChar);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1511980493, "post_id": 47559450, "comment_id": 82076696, "body": "Using a <i>cycle</i>? Do you mean a loop?"}, {"owner": {"reputation": 1, "user_id": 8932138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc389a5707b2b8ead1f4b4b2b67cadb1?s=128&d=identicon&r=PG&f=1", "display_name": "martinjan", "link": "https://stackoverflow.com/users/8932138/martinjan"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1511980827, "post_id": 47559450, "comment_id": 82076856, "body": "Yes i do sorry."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1511981100, "post_id": 47559450, "comment_id": 82076981, "body": "Did you try something with <code>while</code>?"}, {"owner": {"reputation": 6850, "user_id": 650884, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7475fa31c3962a357047617df181c680?s=128&d=identicon&r=PG", "display_name": "Pavel", "link": "https://stackoverflow.com/users/650884/pavel"}, "edited": false, "score": 0, "creation_date": 1511981515, "post_id": 47559450, "comment_id": 82077170, "body": "Here&#39;s a nice example: <a href=\"https://stackoverflow.com/questions/11280523/c-reading-from-file-into-structure\" title=\"c reading from file into structure\">stackoverflow.com/questions/11280523/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 8932138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc389a5707b2b8ead1f4b4b2b67cadb1?s=128&d=identicon&r=PG&f=1", "display_name": "martinjan", "link": "https://stackoverflow.com/users/8932138/martinjan"}, "edited": false, "score": 0, "creation_date": 1511982651, "post_id": 47559450, "comment_id": 82077768, "body": "Im having a little trouble understanding with a whole structure of pointers there so i thought maybe i could use just one or two pointers and make do with that but i havent quite figured that out."}], "answers": [{"comments": [{"owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "reply_to_user": {"reputation": 1, "user_id": 8932138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc389a5707b2b8ead1f4b4b2b67cadb1?s=128&d=identicon&r=PG&f=1", "display_name": "martinjan", "link": "https://stackoverflow.com/users/8932138/martinjan"}, "edited": false, "score": 0, "creation_date": 1511991671, "post_id": 47560316, "comment_id": 82082338, "body": "Just make sure you understand it.    This sounds like a homework assignment, and the last thing I want to do is to get you out of having to learn something :-)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511992124, "post_id": 47560316, "comment_id": 82082560, "body": "Concerning <code>while (!feof(fr)) {</code>, review <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511992210, "post_id": 47560316, "comment_id": 82082600, "body": "Certinaly <code>fgets(z[0],5,fr); if (strcmp(z,&quot;$&quot;)...</code> is broken code.  <code>z[0]</code> de-references the pointer."}, {"owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512057029, "post_id": 47560316, "comment_id": 82111707, "body": "Thanks @chux -- sorry, a bit hastily written.    OP quoted the check against <code>z[0]</code>, not sure if they mean <code>&amp;z[0]</code>, but I&#39;ll assume it&#39;s a pointer to an array of strings.   For the <code>feof</code> issue, I created another test after trying to read the <code>$</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512057343, "post_id": 47560316, "comment_id": 82111927, "body": "Checking <code>feof()</code> makes most sense <i>after</i> receiving an end-of-file/error indication from <code>fgets()</code>.  Rather than <code>fgets(....); ... if (feof(...)) done()</code>, use <code>if(fgets(...) == NULL) done();</code>"}], "tags": [], "owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "is_accepted": false, "score": 1, "last_activity_date": 1512056765, "last_edit_date": 1512056765, "creation_date": 1511983599, "answer_id": 47560316, "question_id": 47559450, "link": "https://stackoverflow.com/questions/47559450/reading-from-file-into-structure-using-a-cycle-and-pointers/47560316#47560316", "title": "Reading from file into structure using a cycle and pointers", "body": "<p>I'm not sure what language this is, but I'll assume that dalsi translates to next (if not, add a <code>struct auta *next</code> at the end of the structure).   I'm also assuming you're a beginner so I'll go over some of what I'm doing below:</p>\n\n<pre><code>AUTA *pStart = NULL;   // keep track of start of list:\nAUTA **pp = &amp;pStart;   // set a pointer to the pointer of the active entry\n\nwhile (!feof(fr)) {\n    fgets(z[0],5,fr);\n    if (feof(fr))\n           break;\n    if (strcmp(z[0],\"$\") != 0) \n           continue;   // non $ sign -- not start of record... ignore line\n    // allocate record:\n    *pp = malloc(AUTA*)malloc(sizeof(AUTA))\n    if (*pp == NULL) {   // double check that malloc succeeded\n        sprintf(stderr, \"Out of memory\\n\"); \n        exit -1;\n    }\n    // read in record -- note pp points to the pointer to the \n    // record, so you want to access (*pp)-&gt; ...\n    fgets((*pp)-&gt;kategoria,50,fr);\n    fgets((*pp)-&gt;znacka,50,fr);\n    fgets((*pp)-&gt;predajca,100,fr);\n    fscanf(fr,\"%d\",&amp;(*pp)-&gt;cena);\n    fscanf(fr,\"%d\\n\",&amp;(*pp)-&gt;rok_vyroby);\n    fgets((*pp)-&gt;stav_vozidla,200,fr);\n    (*pp)-&gt;dalsi = NULL;   // in case this is the last entry...\n    pp = &amp;(*pp)-&gt;dalsi;\n}\n</code></pre>\n\n<p>This solution used double indirection (a pointer to a pointer), which is a bit to take in if you're new.   I would suggest drawing a diagram if you're having trouble getting your head around it.   Basically, we start with a pointer to the first record (<code>pStart</code>).   <code>pStart</code> starts off as <code>NULL</code>.  You then have a pointer to the pointer to the first entry (that is, <code>pp</code> points to <code>pStart</code>.  You then start looping.   If you find a <code>$</code>, you start reading.  First, you allocate memory for a new record and set <code>*pp</code> to point to that (remember that <code>pp</code> pointed to <code>pStart</code>, ergo now <code>*pp</code> or <code>pStart</code> points to the new record.   You then scan in that record.   When you're done, you set <code>pp</code> to point to the next pointer (<code>dalsi</code>) of the current record, and loop.  The second iteration of the loop will populate <code>pStart-&gt;dalsi</code> to point to the next record, so you end up with:</p>\n\n<pre><code> pStart ------&gt; (record1)     +---&gt; (record2)    +---&gt; (record3)\n                  \\ dalsi  ---+       \\dalsi  ---+         \\dalsi --&gt; NULL\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8932138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc389a5707b2b8ead1f4b4b2b67cadb1?s=128&d=identicon&r=PG&f=1", "display_name": "martinjan", "link": "https://stackoverflow.com/users/8932138/martinjan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1512056765, "creation_date": 1511980221, "last_edit_date": 1511980864, "question_id": 47559450, "link": "https://stackoverflow.com/questions/47559450/reading-from-file-into-structure-using-a-cycle-and-pointers", "title": "Reading from file into structure using a cycle and pointers", "body": "<p>I have a text documet which has the following data</p>\n\n<pre><code>$\nosobny automobil\nFerrari\nAutobazar Pestovatelska 4 Bratislava\n68957\n2012\nudrziavane cervene dvojdverove\n$\nkamion\nRenault magnum\nAUTO Modranska 5 Senec\n28000\n2016\npo havarii opraveny v dobrom stave\n$\nkaravan\nKostitras\nJANA, Vitanova 147\n20250\n2010\nVoz na dovolenku\n</code></pre>\n\n<p>The structure looks like this:</p>\n\n<pre><code>typedef struct auta {  \n    char kategoria [50];  \n    char znacka [50];\n    char predajca [100];\n    int cena;\n    int rok_vyroby;\n    char stav_vozidla [200];\n    struct auta *dalsi;\n}AUTA;\n</code></pre>\n\n<p>And the thing my fucntion is supposed to do is read from this file a printf the number of entries. For example $ counts as one entry, so there would be three entries total. I have found it quite stupid to do this entry by entry with a different structure pointer as i am doing it now but the problem is i dont know how to make a sensible loop. What i have so far is how i read the first entry from the file.</p>\n\n<pre><code>AUTA *p=NULL;\np=(AUTA*)malloc(sizeof(AUTA));\n    fgets(z[0],5,fr);\n    fgets(p-&gt;kategoria,50,fr);\n    fgets(p-&gt;znacka,50,fr);\n    fgets(p-&gt;predajca,100,fr);\n    fscanf(fr,\"%d\",&amp;p-&gt;cena);\n    fscanf(fr,\"%d\\n\",&amp;p-&gt;rok_vyroby);\n    fgets(p-&gt;stav_vozidla,200,fr);\n</code></pre>\n\n<p>So the question would be how to load entries from the text file into the structure using a loop.</p>\n"}, {"tags": ["c", "clang", "c89"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1511980232, "post_id": 47559238, "comment_id": 82076572, "body": "That <i>should</i> have worked, I think you may have found a bug in clang."}], "answers": [{"comments": [{"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1511986316, "post_id": 47560543, "comment_id": 82079716, "body": "Clang also doesn&#39;t catch the invalid length modifier <code>l</code> in <code>&quot;%lf&quot;</code> for the <code>printf</code> family of functions. It&#39;s valid in C99."}], "tags": [], "owner": {"reputation": 10144, "user_id": 7256341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RXEvi.jpg?s=128&g=1", "display_name": "valiano", "link": "https://stackoverflow.com/users/7256341/valiano"}, "is_accepted": true, "score": 1, "last_activity_date": 1511985244, "last_edit_date": 1592644375, "creation_date": 1511984507, "answer_id": 47560543, "question_id": 47559238, "link": "https://stackoverflow.com/questions/47559238/enforcing-ansi-c89-with-clang/47560543#47560543", "title": "Enforcing ANSI C89 with clang", "body": "<p>It seems as if this specific warning is not emitted by clang, but apparently <code>-std=c89</code> does toggle ANSI C89 syntax checking.</p>\n<p>For example:</p>\n<pre><code>inline int foo(int* restrict p)\n{\n    return *p;\n}\n</code></pre>\n<p>Will refuse to compile with <code>-std=c89 -pedantic -Wall</code>:</p>\n<blockquote>\n<p>t.c:1:1: error: unknown type name 'inline'</p>\n<p>t.c:1:23: error: expected ')'<br />\nint foo(int* restrict p)</p>\n</blockquote>\n<p>But will compile without errors using <code>-std=c99</code>.</p>\n<p>The non-standard predefined identifiers warning was introduced with GCC 5 (<a href=\"https://gcc.gnu.org/gcc-5/porting_to.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/gcc-5/porting_to.html</a>), and apparently clang did not adapt with it.</p>\n"}], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 2, "accepted_answer_id": 47560543, "answer_count": 1, "score": 5, "last_activity_date": 1511985244, "creation_date": 1511979358, "question_id": 47559238, "link": "https://stackoverflow.com/questions/47559238/enforcing-ansi-c89-with-clang", "title": "Enforcing ANSI C89 with clang", "body": "<p>I'm trying to make the C compiler <code>clang</code> go into ANSI C89 mode but without success.</p>\n\n<p>Here is an example session:</p>\n\n<pre><code>$ cat t.c\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    puts(__FUNCTION__);\n    return 0;\n}\n$ gcc -pedantic -std=c89 -Wall t.c\nt.c: In function \u2018main\u2019:\nt.c:5:7: warning: ISO C does not support \u2018__FUNCTION__\u2019 predefined identifier [-Wpedantic]\n  puts(__FUNCTION__);\n       ^~~~~~~~~~~~\n$ clang -pedantic -std=c89 -Wall t.c\n$ clang --version\nclang version 3.8.1-24 (tags/RELEASE_381/final)\nTarget: x86_64-pc-linux-gnu\nThread model: posix\nInstalledDir: /usr/bin\n</code></pre>\n\n<p>As you can see, the <code>clang</code> command completes with no warning. Is there a command option that I'm missing here?</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8992868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1618dcb150b78865508b2a0e694705f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8992868/tom"}, "edited": false, "score": 0, "creation_date": 1511979557, "post_id": 47559248, "comment_id": 82076231, "body": "How would i do it? I need to print the whole struct"}, {"owner": {"reputation": 31, "user_id": 8992868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1618dcb150b78865508b2a0e694705f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8992868/tom"}, "edited": false, "score": 0, "creation_date": 1511980124, "post_id": 47559248, "comment_id": 82076518, "body": "I still dont get it, sorry, im just a begginer"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 31, "user_id": 8992868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1618dcb150b78865508b2a0e694705f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8992868/tom"}, "edited": false, "score": 0, "creation_date": 1511980166, "post_id": 47559248, "comment_id": 82076547, "body": "@Tom.: It;s not about prinitng the main idea is about accessing indeterminate pointer value. You don&#39;t need pointer to a pointer here. And even if you used it you are accessing it woithot initializing it."}, {"owner": {"reputation": 31, "user_id": 8992868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1618dcb150b78865508b2a0e694705f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8992868/tom"}, "edited": false, "score": 0, "creation_date": 1511980319, "post_id": 47559248, "comment_id": 82076612, "body": "Doesnt these count as initializations? subjects-&gt;num_subjs = 0; \tsubjects-&gt;subjs = NULL;"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 31, "user_id": 8992868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1618dcb150b78865508b2a0e694705f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8992868/tom"}, "edited": false, "score": 0, "creation_date": 1511980393, "post_id": 47559248, "comment_id": 82076643, "body": "@Tom.: It does but the you have to allocate some memory before you can access <code>subjects-&gt;subjs[i]</code> this is what is being done here."}, {"owner": {"reputation": 31, "user_id": 8992868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1618dcb150b78865508b2a0e694705f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8992868/tom"}, "edited": false, "score": 0, "creation_date": 1511980463, "post_id": 47559248, "comment_id": 82076676, "body": "So i should also initialize in functions? Not only in main?"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 31, "user_id": 8992868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1618dcb150b78865508b2a0e694705f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8992868/tom"}, "edited": false, "score": 0, "creation_date": 1511980519, "post_id": 47559248, "comment_id": 82076707, "body": "@Tom.: I will explain a bit. Wait a bit."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 31, "user_id": 8992868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1618dcb150b78865508b2a0e694705f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8992868/tom"}, "edited": false, "score": 0, "creation_date": 1511981225, "post_id": 47559248, "comment_id": 82077042, "body": "@Tom.: I explained this. Try to read and understand. Get a book - it will help you. ( I dont know if you wrote the code on your own). because if you did then you wouldn&#39;t ask about initializing the value."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 2, "last_activity_date": 1511981575, "last_edit_date": 1511981575, "creation_date": 1511979394, "answer_id": 47559248, "question_id": 47559200, "link": "https://stackoverflow.com/questions/47559200/program-doesnt-write-to-file-and-crashes-when-loading/47559248#47559248", "title": "Program doesnt write to file and crashes when loading", "body": "<p><code>&amp;subjects-&gt;subjs[i],</code> This is Undefined behavior. Accessing garbage value. You need to properly initialize it proper memory address. You ddin't do it anywhere.</p>\n\n<p><code>(*subjects).subjs</code> or <code>subjects-&gt;subjs</code> -> This is not pointing anywhere. It is <code>NULL</code>.</p>\n\n<p>Also here you don't need the double pointer. A single pointer would do the thing you want to do. </p>\n\n<pre><code>typedef struct{\n        Subject *subjs;\n        int num_subjs;\n}Subjects;\n</code></pre>\n\n<p>For single pointer this would be like </p>\n\n<pre><code>Subjects *subjects = malloc(sizeof(Subjects));\nsubjects-&gt;num_subjs = 10;\nsubjects-&gt;subjs = malloc(subjects-&gt;num_subjs * sizeof Subject);\nsubjects-&gt;subjs[0].subjName = malloc(40);\n</code></pre>\n\n<p>Each of the <code>malloc</code> should be checked with it's return Value. If it's NULL then it would be error to proceed further or access it.</p>\n\n<p>And <code>free()</code> it accordingly when you are done working with it.</p>\n\n<hr>\n\n<p>Some basic things:-</p>\n\n<pre><code>  typedef struct{\n          Subject *subjs;\n          int num_subjs;\n  }Subjects;\n</code></pre>\n\n<p>Now let's look a bit in the code. </p>\n\n<p>Op asked why OP should initialize and isn;t <code>subjects-&gt;num_subjs = 0;\n    subjects-&gt;subjs = NULL;</code> not enough?</p>\n\n<p>A pointer is a variable that is supposed to hold address. here <code>Subject*</code> will hold the address of the variables of type <code>Subject</code>.</p>\n\n<p>Now here initially you initialized it. </p>\n\n<p>You have allocated a memory and assigned it's address to the <code>Subject*</code> variable <code>subjects</code>.</p>\n\n<p>Now let's see what else you do.</p>\n\n<pre><code>subjects-&gt;num_subjs = 0;\nsubjects-&gt;subjs = NULL;\n</code></pre>\n\n<p>You initialized it. And then you try to access it(<code>subjects-&gt;subjs[i]</code>). Can you tell me where it points to? (<code>subject-&gt;subjs</code>)?</p>\n\n<p>Answer is nope. It is pointing to nowhere. It contains <code>NULL</code> value now. Don't you think you should tell it how many <code>subject</code> you want to hold and allocate accordingly? Yes you should and that's what I did precisely in the example shown.</p>\n\n<p>Whenever you have a pointer variable ask yourself what it contains - and if the value is something you know about, not some random garbage value. </p>\n"}], "owner": {"reputation": 31, "user_id": 8992868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1618dcb150b78865508b2a0e694705f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8992868/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511981575, "creation_date": 1511979220, "question_id": 47559200, "link": "https://stackoverflow.com/questions/47559200/program-doesnt-write-to-file-and-crashes-when-loading", "title": "Program doesnt write to file and crashes when loading", "body": "<p>So i need to write and read to and from a binary file, but cant seem to do it, and when using readFromFile, the program crashes. I need help write to binary file, and then reading from it and resuming my work later after turning off the program.I have no idea what i am doing wrong, and i have googled for a long time now, but with no results. Here is the code of my program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct{\n    char *subjName;\n    char *lectName;\n    char *lectSurname;\n    int credits;\n    int num_students;\n}Subject;\n\ntypedef struct{\n        Subject **subjs;\n        int num_subjs;\n}Subjects;\n\nint numOfSubjs=0;\n\nvoid listInput();\nvoid listEdit();\nvoid listDelete();\nvoid listPrint();\nint userChoice(int select);\nint enterNumber(char *name);\nvoid saveToFile(Subjects *subjects);\nvoid readFromFile(Subjects *subjects);\n\nint main() {\n\n    Subjects *subjects = malloc(sizeof(Subjects));\n    subjects-&gt;num_subjs = 0;\n    subjects-&gt;subjs = NULL;\n    readFromFile(subjects);\n    int r=1;\n    while(r!=0){\n        int select=userChoice(select);\n        switch(select){\n            case 1:\n            listPrint(subjects);\n            break;\n\n            case 2:\n            listInput(&amp;subjects);\n            break;\n\n            case 3:\n            listDelete(subjects);\n            break;\n\n            case 4:\n            listEdit(subjects);\n            break;\n\n            case 0:\n            r=0;\n            break;\n        }\n    }\n    saveToFile(subjects);\n    return 0;\n}\n\nint userChoice(int select){                                                 // menu options\n    int choice,input=0;\n    printf(\"(1). View all the data\\n\");\n    printf(\"(2). Enter new data\\n\");\n    printf(\"(3). Delete data\\n\");\n    printf(\"(4). Edit data\\n\");\n    printf(\"(0). Exit\\n\");\n    printf(\"-----------------------------\\n\");\n\n    while(input!=1){\n        choice = enterNumber(\"menu\");\n        if(choice&gt;4 || choice&lt;0){\n            printf(\"Invalid input \\n\");\n        }\n        else\n            input = 1;\n    }\n    return choice;\n}\n\nvoid listPrint(Subjects *subjects){                         // print data\n    int i;\n    for(i=0; i&lt; numOfSubjs; i++){\n        printf(\"%d, %s, %s, %s, %d, %d\\n\",i+1, subjects-&gt;subjs[i]-&gt;subjName, subjects-&gt;subjs[i]-&gt;lectName, subjects-&gt;subjs[i]-&gt;lectSurname, subjects-&gt;subjs[i]-&gt;credits, subjects-&gt;subjs[i]-&gt;num_students);\n    }\n    printf(\"Number of entries: %d \\n\", numOfSubjs);\n}\n\nchar *getln()                                               //dynamically allocate input string\n{\n    char *line = NULL, *tmp = NULL;\n    size_t size = 0, index = 0;\n    int ch = 1;\n\n    while (ch) {\n        ch = getc(stdin);\n        if (ch == '\\n')\n            ch = 0;\n\n        if (size &lt;= index) {\n            size += 1;\n            tmp = realloc(line, size);\n            if (!tmp) {\n                free(line);\n                line = NULL;\n                break;\n            }\n            line = tmp;\n        }\n\n        line[index++] = ch;\n    }\n\n    return line;\n}\n\n\n\nvoid saveToFile(Subjects *subjects){\n    FILE *data;\n    data = fopen(\"data.bin\",\"wb\");\n    printf(\"%s\", subjects-&gt;subjs[0]);\n    for(int i=0; i&lt;numOfSubjs; i++){\n        fwrite(&amp;subjects-&gt;subjs[i],sizeof(Subject*),1,data);\n    }\n    fclose(data);\n}\n\nvoid readFromFile(Subjects *subjects){\n    FILE *data;\n    int i=0;\n    data = fopen(\"data.bin\",\"rb\");\n    while(!feof(data))\n    {\n         fread(&amp;subjects-&gt;subjs[i],sizeof(Subject*),1,data);\n         i++;\n    }\n    fclose(data);\n}\n\nint isText(char *str,char *name){                                   // check if is text\n    for(int i = 0; i &lt; strlen(str);i++){\n        if((str[i]&lt;'A' || str[i]&gt;'z') &amp;&amp; str[i]!=' '){\n            printf(\"Error, %s must be a text \\n\",name);\n            return 0;\n        }\n    }\n    return 1;\n}\n\nint enterNumber(char *name){                                // enter number and check if is number\n    int input=0, crash=0, num=0;\n        while(input!=1)\n        {\n             crash=0;\n             printf(\"Enter the number of %s\\n\", name);\n             scanf(\"%d\", &amp;num);\n             while(getchar()!='\\n')\n             {\n                crash++;\n             }\n             if(crash&gt;0 || num&lt;0)\n                printf(\"Error, enter a not negative number of %s\\n\", name);\n             else if(crash==0)\n                input=1;\n        }\n    return num;\n}\n\nvoid listInput(Subjects **p_subjects){                              // input new data\n\n    Subject *new_subj = malloc(sizeof(Subject));\n    new_subj-&gt;subjName = NULL;\n    new_subj-&gt;lectName = NULL;\n    new_subj-&gt;lectSurname = NULL;\n    new_subj-&gt;credits = 0;\n    new_subj-&gt;num_students = 0;\n\n    do{\n        printf(\"Enter the name of the subject \\n\");\n        new_subj-&gt;subjName = getln();\n    }while(!isText(new_subj-&gt;subjName,\"Subject name\"));\n\n    do{\n        printf(\"Enter the name of the lecturer \\n\");\n        new_subj-&gt;lectName = getln();\n        new_subj-&gt;lectName[0] &amp;= '_';\n    }while(!isText(new_subj-&gt;lectName,\"Lecturer's name\"));\n\n    do{\n\n        printf(\"Enter the surname of the lecturer\\n\");\n        new_subj-&gt;lectSurname = getln();\n        new_subj-&gt;lectSurname[0] &amp;= '_';                                            //Convert to uppercase if lowercase\n    }while(!isText(new_subj-&gt;lectSurname,\"Lecturer's name\"));\n\n    new_subj-&gt;credits = enterNumber(\"credits\");\n\n    new_subj-&gt;num_students = enterNumber(\"students\");\n\n    (*p_subjects)-&gt;subjs = realloc((*p_subjects)-&gt;subjs,sizeof(Subject*)*(++(*p_subjects)-&gt;num_subjs));\n    (*p_subjects)-&gt;subjs[(*p_subjects)-&gt;num_subjs-1] = new_subj;\n    numOfSubjs++;\n    printf(\"Added a new entry.\\n\\n\");\n}\n\nvoid listDelete(Subjects *subjects){                                                // delete entries\n    int del;\n    if(numOfSubjs==0)\n        printf(\"Number of entries is 0, can't delete anything\\n\");\n    else{\n        printf(\"Enter 0 to exit. Number of subjects : %d \\n\", numOfSubjs);\n        while(1){\n            del = enterNumber(\"entry which you would like to delete\");\n            if(del&lt;=numOfSubjs &amp;&amp; del&gt;0){\n                    for(int i = del-1; i&lt;numOfSubjs-1; i++){\n                        subjects-&gt;subjs[i]=subjects-&gt;subjs[i+1];\n                        subjects-&gt;subjs = realloc(subjects-&gt;subjs,sizeof(Subject*)*(--subjects-&gt;num_subjs));\n                    }\n                numOfSubjs--;\n                break;  \n            }\n            if(del&gt;numOfSubjs)\n                printf(\"Error, input a number between 1 and %d (or enter 0 to exit)\\n\", numOfSubjs);\n            else\n                break;\n        }\n    }\n}\nvoid listEdit(Subjects *subjects){                                                                  // edit entries\n    int choice=0, editEntry=0, editSubj=0;\n    if(numOfSubjs == 0)\n        printf(\"Number of entries is 0, can't edit anthing\\n\");\n    else{\n        while(1){\n            printf(\"Number of entry must be between 1 and %d \\n\", numOfSubjs);\n            choice = enterNumber(\"entry you would like to edit.\");\n            if(choice&gt;0 &amp;&amp; choice&lt;=numOfSubjs){\n                while(1){\n                    editEntry = enterNumber(\"what would you like to edit\\n 1 - Subject name\\n 2 - Lecturer's name\\n 3 - Lecturer's surname\\n 4 - Number of credits\\n 5 - Number of students\");\n                        if(editEntry&gt;0 &amp;&amp; editEntry &lt;=5){\n                            switch(editEntry){\n                                case 1:\n                                    do{\n                                        printf(\"Enter the name of the subject \\n\");\n                                        subjects-&gt;subjs[choice-1]-&gt;subjName = getln();\n                                    }while(!isText(subjects-&gt;subjs[choice-1]-&gt;subjName,\"Subject name\"));\n                                    break;\n                                case 2:\n                                    do{\n                                        printf(\"Enter Lecturer's name \\n\");\n                                        subjects-&gt;subjs[choice-1]-&gt;lectName = getln();\n                                    }while(!isText(subjects-&gt;subjs[choice-1]-&gt;lectName,\"Lecturer's name\"));\n                                    break;\n                                case 3:\n                                    do{\n                                        printf(\"Enter Lecturer's surname \\n\");\n                                        subjects-&gt;subjs[choice-1]-&gt;lectSurname = getln();\n                                    }while(!isText(subjects-&gt;subjs[choice-1]-&gt;lectSurname,\"Lecturer's surname\"));\n                                    break;\n                                case 4:\n                                    subjects-&gt;subjs[choice-1]-&gt;credits = enterNumber(\"credits\");\n                                    break;\n                                case 5:\n                                    subjects-&gt;subjs[choice-1]-&gt;num_students = enterNumber(\"students\");\n                                    break;\n\n                            }\n                        }\n                    break;\n                }\n            }\n            break;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "memory-management", "data-structures", "malloc", "free"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1511978547, "post_id": 47558937, "comment_id": 82075726, "body": "Minor help - calling free passing in a NULL is a defined behavior so you could have a common &quot;failed alloc, free all&quot; area if you wanted."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1511978646, "post_id": 47558937, "comment_id": 82075791, "body": "Another thought - if you have written passed the end of any of your strings, this will likely corrupt the dynamic memory&#39;s internal data and cause a crash.  Double check bounds on your strings in memory before freeing."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1511978676, "post_id": 47558937, "comment_id": 82075800, "body": "Could the (not presented) functions create/destroyDynamicArray corrupt your heap? Does it work when you comment these calls out?"}, {"owner": {"reputation": 281, "user_id": 6102131, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RcFnf.png?s=128&g=1", "display_name": "Tuwuh S", "link": "https://stackoverflow.com/users/6102131/tuwuh-s"}, "edited": false, "score": 0, "creation_date": 1511978809, "post_id": 47558937, "comment_id": 82075879, "body": "Seems to work correctly <a href=\"https://onlinegdb.com/rkaQwO3lf\" rel=\"nofollow noreferrer\">onlinegdb.com/rkaQwO3lf</a>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1511978968, "post_id": 47558937, "comment_id": 82075955, "body": "Another victim of those popular bad habits: 1) typedef-ing &quot;innocent&quot; type names that hide pointers inside - <code>Course</code> in this case, 2) using <code>sizef(type)</code> under <code>malloc</code> - <code>malloc(sizeof(Course))</code> instead of the proper <code>malloc(sizeof *temp)</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1511979256, "post_id": 47558937, "comment_id": 82076097, "body": "It is valid to <code>typedef</code> a pointer, but is not always considered good practice, as this answer to <a href=\"https://stackoverflow.com/a/8853708/4142924\">C typedef of pointer to structure</a> says. Although a pointer <code>typedef</code> can make the code syntax easier to write, without having to know where parentheses should be used, it may not be so easy to follow."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9027155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d8d5fdbac9af8cebde18479baa65e4c?s=128&d=identicon&r=PG&f=1", "display_name": "John Katz", "link": "https://stackoverflow.com/users/9027155/john-katz"}, "edited": false, "score": 0, "creation_date": 1511991538, "post_id": 47559099, "comment_id": 82082273, "body": "Welp you just saved my project and hours of heartache. THANK YOU!"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 4, "last_activity_date": 1511979135, "last_edit_date": 1511979135, "creation_date": 1511978854, "answer_id": 47559099, "question_id": 47558937, "link": "https://stackoverflow.com/questions/47558937/c-free-causes-crash-but-the-data-itself-works-normally-and-is-the-correct-siz/47559099#47559099", "title": "c free() causes crash, but the data itself works normally and is the correct size", "body": "<pre><code>Course temp= malloc(sizeof(Course));\n</code></pre>\n\n<p><code>Course</code> is typedefed as a pointer, you need to reserve space for the whole <code>struct</code>, not for a pointer to it, change to:</p>\n\n<pre><code>Course temp = malloc(sizeof(struct course));\n</code></pre>\n\n<p>or better yet</p>\n\n<pre><code>Course temp = malloc(sizeof(*temp));\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9027155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d8d5fdbac9af8cebde18479baa65e4c?s=128&d=identicon&r=PG&f=1", "display_name": "John Katz", "link": "https://stackoverflow.com/users/9027155/john-katz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 47559099, "answer_count": 1, "score": 1, "last_activity_date": 1511979135, "creation_date": 1511978300, "question_id": 47558937, "link": "https://stackoverflow.com/questions/47558937/c-free-causes-crash-but-the-data-itself-works-normally-and-is-the-correct-siz", "title": "c free() causes crash, but the data itself works normally and is the correct size", "body": "<p>My program crashes every time when I try to free one of the strings in my struct, here are the functions I call and the struct:</p>\n\n<pre><code>typedef struct course\n{\n    char *id;\n    char *name;\n    double credits;\n    DynamicArray preCourses;\n} *Course;\n\n\nCourse c2;\ncreateCourse(\"345682\", \"Cyberpunk and the Future\", 3, &amp;c2);\ndestroyCourse(c2);\n</code></pre>\n\n<p>Here is the code for the creation function:</p>\n\n<pre><code>CourseResult createCourse(char *id, char *name, double credits, Course *course)\n{\n    assert(name != NULL || id != NULL);\n    Course temp= malloc(sizeof(Course));\n    if(temp == NULL)\n        return COURSE_ILLEGAL_PARAMETER;\n    temp-&gt;id = (char *)malloc((strlen(id)+1));\n    if (temp-&gt;id == NULL) {\n        free(temp);\n        return COURSE_MEMORY_ERROR;\n    }\n    temp-&gt;name = (char *)malloc((strlen(name)+1));\n    if (temp-&gt;name == NULL) {\n        free(temp-&gt;id);\n        free(temp);\n        return COURSE_MEMORY_ERROR;\n    }\n    temp-&gt;preCourses=createDynamicArray();\n    if(temp-&gt;preCourses == NULL){\n        free(temp-&gt;name);\n        free(temp-&gt;id);\n        free(temp);\n        return COURSE_MEMORY_ERROR;\n    }\n    strcpy(temp-&gt;id,id);\n    strcpy(temp-&gt;name,name);\n    temp-&gt;credits=credits;\n    *course = temp;\n    return COURSE_OK;\n}\n</code></pre>\n\n<p>The free function:</p>\n\n<pre><code>void destroyCourse(Course course1)\n{\n    destroyDynamicArray(course1-&gt;preCourses);\n    printf(\"%s\", course1-&gt;id); //prints 345682\n    printf(\"%d\", strlen(course1-&gt;id)); //prints 6\n    free(course1-&gt;id); //crashes here\n    free(course1-&gt;name);\n    free(course1);\n}\n</code></pre>\n\n<p>The string itself is located in the memory, and is the right length.\nThanks for any and all of the help!</p>\n"}, {"tags": ["c", "pipe"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 4538402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-t_a-dG9q94I/AAAAAAAAAAI/AAAAAAAAADI/mo6xFaPx3F0/photo.jpg?sz=128", "display_name": "Mistos", "link": "https://stackoverflow.com/users/4538402/mistos"}, "edited": false, "score": 1, "creation_date": 1511977962, "post_id": 47558789, "comment_id": 82075356, "body": "still, now both on reading and writing, Im recieving the same error message"}], "tags": [], "owner": {"reputation": 7357, "user_id": 416627, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ff79d2dc195bdd3d342235f21ccbead9?s=128&d=identicon&r=PG", "display_name": "Dave Rager", "link": "https://stackoverflow.com/users/416627/dave-rager"}, "is_accepted": false, "score": 2, "last_activity_date": 1511977783, "creation_date": 1511977783, "answer_id": 47558789, "question_id": 47558672, "link": "https://stackoverflow.com/questions/47558672/error-in-file-descriptors-of-a-pipe/47558789#47558789", "title": "Error in file descriptors of a pipe", "body": "<p>Close the respective read/write ends of the pipe after you fork not before.</p>\n"}], "owner": {"reputation": 137, "user_id": 4538402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-t_a-dG9q94I/AAAAAAAAAAI/AAAAAAAAADI/mo6xFaPx3F0/photo.jpg?sz=128", "display_name": "Mistos", "link": "https://stackoverflow.com/users/4538402/mistos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1511997991, "creation_date": 1511977365, "last_edit_date": 1511997905, "question_id": 47558672, "link": "https://stackoverflow.com/questions/47558672/error-in-file-descriptors-of-a-pipe", "title": "Error in file descriptors of a pipe", "body": "<p>Running this c program that evaluates the exponential taylor expansion, using a child process created in each loop that returns a digit of this sum to the parent, its leading me to a BAD FILE DESCRIPTOR ERROR, although I don't know why, I think the problem may be in the way I open and close the pipe in the loop and such.</p>\n\n<p>My code is :</p>\n\n<pre><code>#include&lt;unistd.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;sys/wait.h&gt;\n#include&lt;stdlib.h&gt;\nint main()  \n{int i; pid_t id;\nint count=1;\nint fact=1;\nint N;\ndouble S=1;double s1=0; double div;double x;\nint p[2];\n\nprintf(\"Input x and N : \\n\");\nscanf(\"%lf %d\",&amp;x,&amp;N);\nif(pipe(p) == -1)\n{perror(\"Error opening pipe\");\nreturn -1; }\n else{ \n for(i=1;i&lt;=N;i++)\n {  id=fork();\n  if(id==0)\n  { close(p[0]);\n      while(count&lt;i)\n      {   fact*=(fact+1);\n                      x*=x;\n          count++;\n      }\n\n    div=x/fact;\n    if(write(p[1],&amp;div,sizeof(double))!=sizeof(double))\n    perror(\"file writing error\");\n    exit(0);\n  }\n  else {\n      wait(NULL);\n      close(p[1]); \\\\ ***&lt;-- Problem here*** \n      if(read(p[0],&amp;s1,sizeof(double))!=sizeof(double))\n{\n perror(\"file become empty\");         \n return -1;}\n      S+=s1;\n  }}}\nprintf(\"Sum = %lf\",S);\nreturn 1;}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault", "fork"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1511976913, "post_id": 47558469, "comment_id": 82074714, "body": "Did you step through your code in a debugger?  That would provide important details about the problem.."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1511976977, "post_id": 47558469, "comment_id": 82074751, "body": "Have you proved that your logic works with two separate programs? Allows you to narrow down whether or not your problem is with <code>fork</code> or not."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 2, "creation_date": 1511976978, "post_id": 47558469, "comment_id": 82074752, "body": "Why do you think that two processes will read alternative lines when they are not communicating with each other?"}, {"owner": {"reputation": 13, "user_id": 7595103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1da6f75fcbf650b332aec245ba6ead9?s=128&d=identicon&r=PG&f=1", "display_name": "pkitsos", "link": "https://stackoverflow.com/users/7595103/pkitsos"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1511977080, "post_id": 47558469, "comment_id": 82074813, "body": "@DrewDormann GDB returned terminated with unknown signal and it said no symbol table loaded. I&#39;m new to GDB so not sure quite what that means"}, {"owner": {"reputation": 134, "user_id": 8599142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fa460d1b8eb70cd862ac0dfdaff807a?s=128&d=identicon&r=PG&f=1", "display_name": "organicoman", "link": "https://stackoverflow.com/users/8599142/organicoman"}, "edited": false, "score": 0, "creation_date": 1511977459, "post_id": 47558469, "comment_id": 82075029, "body": "just at a glance the first remark, is the two process are trying to open the same file &#39;fp*&#39;, =&gt; <code>segmentation fault</code> on the spot. try to capture the <code>errno</code> and print it, you will get a lot of enlightement, plus read the<code>fork()</code> function documentation, also restructure your code, if this code runs in a nuclear plant, it will explode it!."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1511977688, "post_id": 47558469, "comment_id": 82075177, "body": "Well one of the problems is that neither the parent nor the child ever try to read or print more than one line, so it isn&#39;t clear how the whole process can be called &quot;alternating&quot;. Another problem is that you don&#39;t check whether your calls to library functions succeed (if you don&#39;t check you don&#39;t care, right?)"}, {"owner": {"reputation": 1340, "user_id": 8372228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea211204c4d8ee5167b4e34ccb2328f3?s=128&d=identicon&r=PG", "display_name": "v1bri", "link": "https://stackoverflow.com/users/8372228/v1bri"}, "edited": false, "score": 1, "creation_date": 1511977769, "post_id": 47558469, "comment_id": 82075234, "body": "I just tested and your app appears to work for me (though you forgot <code>#include &lt;sys&#47;wait.h&gt;</code>). I was able to reproduce a segmentation fault by trying to open a file that doesn&#39;t exist. So I would verify that <code>&#47;Desktop&#47;read.txt</code> is actually there and perhaps add some code to handle when <code>fopen()</code> fails."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1511977876, "post_id": 47558469, "comment_id": 82075300, "body": "Anyway, should <code>else printf (&quot;read failed!\\n&quot;); exit(1);</code> be braced as <code>else { printf (&quot;read failed!\\n&quot;); exit(1); }</code> ?"}, {"owner": {"reputation": 13, "user_id": 7595103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1da6f75fcbf650b332aec245ba6ead9?s=128&d=identicon&r=PG&f=1", "display_name": "pkitsos", "link": "https://stackoverflow.com/users/7595103/pkitsos"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1511983949, "post_id": 47558469, "comment_id": 82078498, "body": "@EdHeal Sorry folks, I don&#39;t need it to alternate lines (plural). I just need it to print one via parent and the other via child. The code I posted does that and removing /Desktop/ fixes the segmentation fault and allows compilation. Thanks for the help!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512007634, "post_id": 47558469, "comment_id": 82087567, "body": "when the parameters to <code>main()</code> are not going to be used, then use the signature: <code>int main( void )</code> to avoid getting the two warnings from the compiler about the unused parameters"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512007916, "post_id": 47558469, "comment_id": 82087638, "body": "when displaying information about an error condition: 1) always output to <code>stderr</code>, not <code>stdout</code>  2) when the error was from a system function, like <code>fork()</code>, use <code>perror( &quot;error message&quot; );</code>  so both the error message AND the reason the system thinks the function failed are output to <code>stderr</code>.  Note: there should be no intervening functions calls, as they may change the value in <code>errno</code> which would cause <code>perror()</code> (or <code>strerror()</code>) to output the wrong information"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512008086, "post_id": 47558469, "comment_id": 82087671, "body": "regarding: <code>while ( (char)fgetc( fp ) != &#39;\\n&#39; );</code>  1) no need to cast to <code>char</code>.  2) also need to be checking for <code>EOF</code>.  Suggest:  <code>int ch; while( (ch = fgetc( fp ) ) != EOF  &amp;&amp; &#39;\\n&#39; != ch );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512008208, "post_id": 47558469, "comment_id": 82087696, "body": "regarding: <code>memset(buff1,0, sizeof(buff1));</code>  this statement is not needed as the following call to <code>fgets()</code> will overlay the contents of <code>buff1</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512008326, "post_id": 47558469, "comment_id": 82087727, "body": "regarding: <code>printf (&quot;read failed!\\n&quot;);</code>  it is not <code>read</code> that failed. and such error message should be output to <code>stderr</code>, not <code>stdout</code>  Suggest: <code>perror( &quot;fgets in parent failed&quot; );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512008567, "post_id": 47558469, "comment_id": 82087778, "body": "it is a poor programming practice to include header files those contents are not being used.  Suggest removing the statements: 1) <code>#include &lt;sys&#47;types.h&gt;</code> 2) <code>#include &lt;sys&#47;stat.h&gt;</code>  3) <code>#include &lt;fcntl.h&gt;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512008656, "post_id": 47558469, "comment_id": 82087797, "body": "when calling <code>fopen()</code>, always check (!=NULL) the returned value to assure the operation was successful."}], "owner": {"reputation": 13, "user_id": 7595103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1da6f75fcbf650b332aec245ba6ead9?s=128&d=identicon&r=PG&f=1", "display_name": "pkitsos", "link": "https://stackoverflow.com/users/7595103/pkitsos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 964, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511976910, "creation_date": 1511976711, "last_edit_date": 1511976910, "question_id": 47558469, "link": "https://stackoverflow.com/questions/47558469/using-fork-to-read-lines-from-txt-file-in-c", "title": "Using fork() to read lines from txt file in c", "body": "<p>I am trying to implement a simple program that uses fork() to spawn a child process. The program should allow the parent and child processes to alternate printing lines read from a .txt file and the parent should reap the child process. So far, this is what I have come up with but I am getting a segmentation fault: 11. Can someone help me identify and fix the problem? Thanks!</p>\n\n<p><em>Code</em></p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;sys/types.h&gt;\n#include&lt;sys/stat.h&gt;\n#include&lt;fcntl.h&gt;\n\nint main(int argc, char **argv) {\n\n    int status = 0;\n    pid_t pid = fork();\n    FILE *fp = fopen(\"/Desktop/read.txt\",\"r\");\n    char buff[256]=\"\";\n    char buff1[256]=\"\";\n\n    if (pid == 0)\n    {\n        // child process\n        if ((fgets(buff, sizeof(buff), fp)) != NULL)\n            printf (\"Read a line in child:\\t%s\\n\", buff);\n        else\n            printf (\"read failed!\\n\");\n        exit(1);\n    }\n    else if (pid &gt; 0)\n    {\n        // parent process\n        waitpid (pid, &amp;status, 0);\n        while ( (char)fgetc( fp ) != '\\n' );\n        memset(buff1,0, sizeof(buff1));\n        if ((fgets(buff1, sizeof(buff1), fp)) != NULL)\n            printf (\"Read a line in parent:\\t%s\\n\", buff1);\n        else\n            printf (\"read failed!\\n\");\n    }\n    else\n    {\n        // fork failed\n        printf(\"fork() failed!\\n\");\n        return 1;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "xml", "gtk"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1511976342, "post_id": 47557929, "comment_id": 82074402, "body": "It&#39;s a while ago when I switched from gtkmm 2.x to Qt (because gtkmm3 and Windows didn&#39;t work well together for us) but the <a href=\"https://developer.gnome.org/gtk3/stable/GtkUIManager.html\" rel=\"nofollow noreferrer\"><code>GTKUIManager</code></a> seems still to be there. It can be used to read UI files but you can also provide XML code in strings &quot;inline&quot;."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1511976545, "post_id": 47557929, "comment_id": 82074515, "body": "Found something else: <a href=\"https://developer.gnome.org/gtk3/stable/ch01s04.html#id-1.2.3.12.6\" rel=\"nofollow noreferrer\">Building applications - Populating the window</a>"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1511976800, "post_id": 47557929, "comment_id": 82074652, "body": "Btw. you don&#39;t need the UI files nor the <code>GTKUIManager</code> - it&#39;s actually for convenience. We usually created all widgets in pure C++ code, ehem, in C code in your case. Or, do you asking for <a href=\"https://glade.gnome.org/\" rel=\"nofollow noreferrer\">Glade</a>? (Sorry, no experience - not at all.)"}, {"owner": {"reputation": 65, "user_id": 9026941, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l0NoQ55d2NY/AAAAAAAAAAI/AAAAAAAABhg/0CcBzbGRE7o/photo.jpg?sz=128", "display_name": "Julia Moffitt", "link": "https://stackoverflow.com/users/9026941/julia-moffitt"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1511977072, "post_id": 47557929, "comment_id": 82074808, "body": "I&#39;m so relieved to hear that I don&#39;t need the UI files/GTKUIManager! I am not using glade but I was just following the tutorials (the populating the window one you posted actually) and was wondering as a beginner to UI where all these XML files tied in and how."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1511978383, "post_id": 47557929, "comment_id": 82075626, "body": "See e.g. <a href=\"https://developer.gnome.org/gtk3/stable/GtkLabel.html\" rel=\"nofollow noreferrer\">GtkLabel</a>. The page provides samples with and without UI definition."}, {"owner": {"reputation": 65, "user_id": 9026941, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l0NoQ55d2NY/AAAAAAAAAAI/AAAAAAAABhg/0CcBzbGRE7o/photo.jpg?sz=128", "display_name": "Julia Moffitt", "link": "https://stackoverflow.com/users/9026941/julia-moffitt"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1511998253, "post_id": 47557929, "comment_id": 82085078, "body": "Thank you you&#39;ve been super helpful!"}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1512047767, "post_id": 47557929, "comment_id": 82105539, "body": "Please don&#39;t use <code>GtkUIManager</code>, it has been deprecated since GTK+ 3.10. Use <code>GtkBuilder</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9026941, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l0NoQ55d2NY/AAAAAAAAAAI/AAAAAAAABhg/0CcBzbGRE7o/photo.jpg?sz=128", "display_name": "Julia Moffitt", "link": "https://stackoverflow.com/users/9026941/julia-moffitt"}, "edited": false, "score": 0, "creation_date": 1512151899, "post_id": 47574921, "comment_id": 82156580, "body": "Thank you! This really helped me understand, I appreciate it!"}], "tags": [], "owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "is_accepted": true, "score": 4, "last_activity_date": 1517306523, "last_edit_date": 1517306523, "creation_date": 1512049348, "answer_id": 47574921, "question_id": 47557929, "link": "https://stackoverflow.com/questions/47557929/how-does-xml-document-work-with-gtk-to-create-user-interface/47574921#47574921", "title": "How does XML document work with GTK to create user interface?", "body": "<p>There's two ways of constructing a user interface:</p>\n\n<ol>\n<li>You write the code for it.</li>\n<li>You write a file that describes the user interface, and have the user interface built for you at runtime.</li>\n</ol>\n\n<p>If you write the code yourself, everytime you want to move widgets around, you have to modify your code, that you'll need to compile. That is doable for a small UI, and is what is done in most tutorials.</p>\n\n<p>If you use ui files, then you use the <a href=\"https://wiki.gnome.org/action/show/Apps/Glade\" rel=\"nofollow noreferrer\">Glade</a> application to design your UI graphically, and it will write the UI files for you. This helps in splitting responsabilities too: you may have design people taking care of the UI, and let developpers focus on the behavior. Even without that, you'll be able to design a UI faster with an editor like Glade than by coding it by hand. Think you skip all the compile/debug cycles.</p>\n\n<p>In your ui file, if you name a wigdet \"bob\", you'll be able to get it in your code by passing its name to <a href=\"https://developer.gnome.org/gtk3/stable/GtkBuilder.html#gtk-builder-get-object\" rel=\"nofollow noreferrer\"><code>gtk_builder_get_object</code></a>. <code>GtkBuilder</code> takes care of the construction and the memory, so don't destroy the widgets it creates if you need to display them again, and hide them instead.</p>\n\n<p>You have examples of use of UI files in the GTK documentation:\n<a href=\"https://developer.gnome.org/gtk3/stable/ch01s04.html#id-1.2.3.12.5\" rel=\"nofollow noreferrer\">https://developer.gnome.org/gtk3/stable/ch01s04.html#id-1.2.3.12.5</a></p>\n"}], "owner": {"reputation": 65, "user_id": 9026941, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l0NoQ55d2NY/AAAAAAAAAAI/AAAAAAAABhg/0CcBzbGRE7o/photo.jpg?sz=128", "display_name": "Julia Moffitt", "link": "https://stackoverflow.com/users/9026941/julia-moffitt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1285, "favorite_count": 0, "accepted_answer_id": 47574921, "answer_count": 1, "score": 4, "last_activity_date": 1517306523, "creation_date": 1511974603, "question_id": 47557929, "link": "https://stackoverflow.com/questions/47557929/how-does-xml-document-work-with-gtk-to-create-user-interface", "title": "How does XML document work with GTK to create user interface?", "body": "<p>I am working on a C/GTK+3 project right now. I have a little experience with front end but mostly only with Android. Even then that was VERY LITTLE experience.</p>\n\n<p>I notice that in the C code I place objects and set properties (like if a textview is editable etc). I also have been able to connect a .ui XML file to my program with the builder functions.</p>\n\n<p>I am wondering how the XML file gets linked to the C code defining the interface. Does it match by structure, by the name or ID properties? Why are properties like \"visible\" and \"editable\" present in both the C code and the XML? Do you need the XML file? Do you need to specify the properties in both the XML file and the C code or just one? Will I ever completely understand front end development?</p>\n"}, {"tags": ["c", "bitwise-operators", "uint8t"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1511974631, "post_id": 47557901, "comment_id": 82073411, "body": "I don&#39;t think it matters: assignment will truncate the result anyway. And with your values it&#39;s not an issue. but your question has a lot of typos. Can you edit it?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1511974641, "post_id": 47557901, "comment_id": 82073421, "body": "The shift operation is subject to integer promotion."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1511974664, "post_id": 47557901, "comment_id": 82073434, "body": "since you&#39;re dividing, the result will be the same."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1511974742, "post_id": 47557901, "comment_id": 82073481, "body": "And I don&#39;t really see what exactly are you asking here. Are you asking if it is guaranteed to result in <code>2</code>? Yes it is."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1511974806, "post_id": 47557901, "comment_id": 82073509, "body": "not 5, rather 2."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1511974832, "post_id": 47557901, "comment_id": 82073525, "body": "@Jean-Fran&#231;oisFabre yeah, sorry"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1511974857, "post_id": 47557901, "comment_id": 82073549, "body": "I like those manual compilation exercises :)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 4, "creation_date": 1511975129, "post_id": 47557901, "comment_id": 82073698, "body": "Why are you asking this?"}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1511976673, "post_id": 47557901, "comment_id": 82074590, "body": "The last sentence still doesn&#39;t make sense grammatically."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1511977149, "post_id": 47557901, "comment_id": 82074851, "body": "<i>after the edit</i> - the conversion process is covered by the standard <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.3\" rel=\"nofollow noreferrer\">here</a> .It is safe to covert any integer to an unsigned integer type in terms it is always well defined."}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 2, "last_activity_date": 1511976478, "last_edit_date": 1511976478, "creation_date": 1511975919, "answer_id": 47558272, "question_id": 47557901, "link": "https://stackoverflow.com/questions/47557901/bitwise-operations-performed-on-an-8-bit-unsigned-int/47558272#47558272", "title": "Bitwise operations performed on an 8 bit unsigned int", "body": "<p>No.</p>\n\n<p>In arithmetic expressions, the lesser types are converted to <code>int</code> if possible, and otherwise to <code>unsigned int</code> (see <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.1p2\" rel=\"nofollow noreferrer\">6.3.1.1p2</a>).</p>\n\n<p>Practically,</p>\n\n<pre><code>uint8_t i = 10;\nputs(_Generic(i&gt;&gt;2, uint8_t: \"u8\", int: \"int\", unsigned int: \"uint\"));\n</code></pre>\n\n<p>should output \"int\", as should </p>\n\n<pre><code>uint8_t i = 10, j = 2;\nputs(_Generic(i&gt;&gt;j, uint8_t: \"u8\", int: \"int\", unsigned int: \"uint\"));\n</code></pre>\n\n<p>(In the former example, <code>i</code> would also get promoted to <code>int</code> because <code>2</code> is of type <code>int</code> and because <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.8\" rel=\"nofollow noreferrer\">usual arithmetic conversions</a> would apply.)</p>\n"}], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 1, "closed_date": 1511977364, "accepted_answer_id": 47558272, "answer_count": 1, "score": -2, "last_activity_date": 1511976478, "creation_date": 1511974509, "last_edit_date": 1511975796, "question_id": 47557901, "link": "https://stackoverflow.com/questions/47557901/bitwise-operations-performed-on-an-8-bit-unsigned-int", "closed_reason": "Needs details or clarity", "title": "Bitwise operations performed on an 8 bit unsigned int", "body": "<p>In the following code, bitwise operations are performed on an 8-bit unsigned integer.</p>\n\n<pre><code>uint8_t i = 10;\nuint8_t j = i&gt;&gt;2;\n</code></pre>\n\n<p>In this example, <code>i</code> is promoted to a <code>signed int</code> and value assigned to 8 bits unsigned int. Is it safe to int converted back to 8 bits unsigned int?</p>\n"}, {"tags": ["c", "linux", "unix"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1511972374, "post_id": 47557239, "comment_id": 82071960, "body": "Did you read the man page?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1511972387, "post_id": 47557239, "comment_id": 82071966, "body": "It is not a system call."}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1511972611, "post_id": 47557239, "comment_id": 82072122, "body": "<code>gettimeofday</code> is not the solution to get time taken by a process."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1511973777, "post_id": 47557239, "comment_id": 82072821, "body": "Do you want CPU time used or wall time elapsed?  They\u2019re different.  And there are reasons to prefer <code>clock_gettime()</code> to <code>gettimeofday()</code>.  (There are also some reasons, increasingly less compelling reasons, to use <code>gettimeofday()</code> instead.)"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5539389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1aae68778654a8c58b2af9f02f5e383?s=128&d=identicon&r=PG&f=1", "display_name": "Jeries Haddad", "link": "https://stackoverflow.com/users/5539389/jeries-haddad"}, "edited": false, "score": 1, "creation_date": 1512147836, "post_id": 47567612, "comment_id": 82154317, "body": "This is exactly what I was looking for, thank you so much!"}], "tags": [], "owner": {"reputation": 1374, "user_id": 6385870, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WcPaBJ4dA7E/AAAAAAAAAAI/AAAAAAAAACU/GqGqqqVbT9E/photo.jpg?sz=128", "display_name": "the kamilz", "link": "https://stackoverflow.com/users/6385870/the-kamilz"}, "is_accepted": true, "score": 0, "last_activity_date": 1512025155, "creation_date": 1512025155, "answer_id": 47567612, "question_id": 47557239, "link": "https://stackoverflow.com/questions/47557239/how-can-i-measure-time-taken-by-a-process-in-c-using-linux-system-call-gettimeof/47567612#47567612", "title": "How can I measure time taken by a process in C using Linux System Call gettimeofday()?", "body": "<p>Here is my tested code snipped:</p>\n\n<pre><code>struct timeval t1, t2;\ndouble elapsedTime;\n\n// start timer\ngettimeofday(&amp;t1, NULL);\n\n// do something\n// ...\n\n// stop timer\ngettimeofday(&amp;t2, NULL);\n\n// compute and print the elapsed time in millisec\nelapsedTime = (t2.tv_sec - t1.tv_sec) * 1000.0;      // sec to ms\nelapsedTime += (t2.tv_usec - t1.tv_usec) / 1000.0;   // us to ms\nfprintf(stderr, \"elapsedTime = %5.3fms \\n\", elapsedTime);\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 67, "user_id": 5539389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1aae68778654a8c58b2af9f02f5e383?s=128&d=identicon&r=PG&f=1", "display_name": "Jeries Haddad", "link": "https://stackoverflow.com/users/5539389/jeries-haddad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 47567612, "answer_count": 1, "score": 0, "last_activity_date": 1512025155, "creation_date": 1511972236, "question_id": 47557239, "link": "https://stackoverflow.com/questions/47557239/how-can-i-measure-time-taken-by-a-process-in-c-using-linux-system-call-gettimeof", "title": "How can I measure time taken by a process in C using Linux System Call gettimeofday()?", "body": "<p>I'm trying to find how much time the process / function took to find the solution. I am asked to do it using gettimeofday() Linux System Call.\nAny help?  Thanks in advance.</p>\n"}, {"tags": ["c", "gcc", "macros", "c-preprocessor", "hygiene"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1511972033, "post_id": 47557125, "comment_id": 82071745, "body": "Maybe you should not abuse macros this way, and consider generating some C code (from some script or program), perhaps in some included header...."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1511972198, "post_id": 47557125, "comment_id": 82071858, "body": "But even if you could do what you want (and I don&#39;t understand your exact wish) with macros, you could have very unreadable code. Sometimes, coding a simple <code>awk</code> script generating some simple header containing some <code>#define</code>-s is much simpler."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1511972304, "post_id": 47557125, "comment_id": 82071915, "body": "Did you consider some form of <a href=\"https://en.wikipedia.org/wiki/X_Macro\" rel=\"nofollow noreferrer\">X macros</a>? Also please edit your question by giving the desired preprocessor input <i>and output</i>; I don&#39;t exactly understand your wish (and your <i>motivations</i>)"}], "answers": [{"comments": [{"owner": {"reputation": 1554, "user_id": 3250971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2840796a62fdc1c1368d6b0977cef34?s=128&d=identicon&r=PG&f=1", "display_name": "WhatsUp", "link": "https://stackoverflow.com/users/3250971/whatsup"}, "edited": false, "score": 0, "creation_date": 1511973387, "post_id": 47557437, "comment_id": 82072596, "body": "Right. You need a &quot;pre-pre-processor&quot;."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1511974844, "post_id": 47557437, "comment_id": 82073536, "body": "Maybe a <i>simple</i> generator could fit your use case (which I don&#39;t understand). Perhaps something as simple as a one-line <code>sed</code> script. Or write your own generator or preprocessor (for the conventions of your project)."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1511974988, "post_id": 47557437, "comment_id": 82073612, "body": "A possible advice: make a quick and dirty experiment (half a day of work) writing your own generator or preprocessor (or using another one cleverly). Show it to your boss or team. They could be convinced by something simple. And that does not involve any &quot;retraining&quot; except perhaps a 20 minutes talk with a few slides. Perhaps you have more a communication problem than a technical one. A lot of free software programs have <i>some</i> of their C code generated, and that is not a big deal at all."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1511975207, "post_id": 47557437, "comment_id": 82073746, "body": "Most IDEs can be configured to use some specific command for building. Is your GUI app not one? Generating some header file is not a workflow break, if you can explain that in simple terms. My feeling is that you should try some quick &amp; dirty experiment, and propose it. Of course, if others are using a specific IDE, you need to be able to configure it for them."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "edited": false, "score": 0, "creation_date": 1511975316, "post_id": 47557437, "comment_id": 82073819, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/160119/discussion-between-basile-starynkevitch-and-devnull\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 2, "last_activity_date": 1511980887, "last_edit_date": 1511980887, "creation_date": 1511972903, "answer_id": 47557437, "question_id": 47557125, "link": "https://stackoverflow.com/questions/47557125/dynamically-prefix-macro-names-with-a-variadic-macro/47557437#47557437", "title": "Dynamically prefix macro names with a variadic macro", "body": "<blockquote>\n  <p>I would like this code:</p>\n\n<pre><code> #define NAME(SOME_MACRO_CONST)  (123)\n #define NAME(SOME_MACRO_CONST2) (124)\n</code></pre>\n  \n  <p>To expand to:</p>\n\n<pre><code> #define 3SOME_MACRO_CONST  (123)\n #define 3SOME_MACRO_CONST2 (124)\n</code></pre>\n</blockquote>\n\n<p><sup>(I corrected the second number to 124 to make it different from the first one, for readability purposes)</sup></p>\n\n<h2>This is impossible with the C preprocessor</h2>\n\n<p>for several reasons:</p>\n\n<ul>\n<li><p><code>3SOME_MACRO_CONST</code> is not a valid identifier (both for the preprocessor, and for the C compiler itself) since it does not start with a letter or an underscore. So let's assume you want your code to be expanded to:</p>\n\n<pre><code>  /// new desired expansion\n  #define THREE_SOME_MACRO_CONST  (123)\n  #define THREE_SOME_MACRO_CONST2 (124)\n</code></pre></li>\n<li><p>this is still <strong>impossible</strong>, because the preprocessor works before anything else and cannot generate any preprocessor directive (e.g. <code>#define</code>).</p></li>\n</ul>\n\n<p>A workaround, if you only want to <code>#define</code> some <em>numbers</em> (computable at <em>compile-time</em> !!!) might be to expand to some anonymous <code>enum</code>  like</p>\n\n<pre><code> enum {\n   THREE_SOME_MACRO_CONST= 123,\n   THREE_SOME_MACRO_CONST2= 124,\n };\n</code></pre>\n\n<p>and you know how to do that in the details. Read also about <a href=\"https://en.wikipedia.org/wiki/X_Macro\" rel=\"nofollow noreferrer\">X-macros</a>.</p>\n\n<hr>\n\n<p>However, even if you can change your requirement to something that is <em>possible</em>, it might be not recommendable, because your code becomes very unreadable (IMHO). You could sometimes consider writing some simple script (e.g. in <code>sed</code> or <code>awk</code> ...), or use some other preprocessor like <a href=\"https://logological.org/gpp\" rel=\"nofollow noreferrer\">GPP</a>,  to generate a C file from something else.</p>\n\n<p>Notice that most serious <a href=\"https://en.wikipedia.org/wiki/Build_automation\" rel=\"nofollow noreferrer\">build automation</a> tools (like <a href=\"https://www.gnu.org/software/make/\" rel=\"nofollow noreferrer\">GNU make</a> or <a href=\"http://ninja-build.org/\" rel=\"nofollow noreferrer\">ninja</a>) -or even <a href=\"https://en.wikipedia.org/wiki/Integrated_development_environment\" rel=\"nofollow noreferrer\">IDE</a>s (they can be configured to) permit quite easily (by adding extra targets, recipes, commands, etc...) to generate some C (or C++) code from some other file, and that <a href=\"https://en.wikipedia.org/wiki/Metaprogramming\" rel=\"nofollow noreferrer\">meta-programming</a> practice has been routinely used since decades (e.g. <a href=\"https://www.gnu.org/software/bison/\" rel=\"nofollow noreferrer\">bison</a>, <a href=\"https://github.com/westes/flex\" rel=\"nofollow noreferrer\">flex</a>, <a href=\"https://en.wikipedia.org/wiki/Autoconf\" rel=\"nofollow noreferrer\">autoconf</a>, <a href=\"https://en.wikipedia.org/wiki/RPCGEN\" rel=\"nofollow noreferrer\">rpcgen</a>, <a href=\"http://doc.qt.io/qt-5/why-moc.html\" rel=\"nofollow noreferrer\">Qt <code>moc</code></a>, <a href=\"http://swig.org/\" rel=\"nofollow noreferrer\">SWIG</a> ...) so I am surprised you cannot do so. Generating a header file containing many <code>#define</code>-s is so common a practice that I am surprised you are forbidden to do so. Perhaps you just need to discuss with your manager or colleagues. Maybe you need to look for some more interesting job.</p>\n\n<p>Personally, I am very fond of such meta-programming approaches (I did my PhD on these in 1990, and I would discuss them at <em>every</em> job interview; a job where metaprogramming is forbidden is not for me. Look for example at my past <a href=\"http://starynkevitch.net/Basile/gcc-melt/\" rel=\"nofollow noreferrer\">GCC MELT</a> project, and my future project also will have metaprogramming). Another way of promoting that approach is to defend <a href=\"https://en.wikipedia.org/wiki/Domain-specific_language\" rel=\"nofollow noreferrer\">domain specific languages</a> (and the ability to make your DSL inside some large software project; for example the <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a> compiler has about a dozen of such DSLs inside it....). Then, your DSL can (naturally) be <a href=\"https://softwareengineering.stackexchange.com/a/257873/40065\">compiled to C</a> which is a common practice. On modern operating systems that generated C code could be compiled at runtime and <a href=\"https://en.wikipedia.org/wiki/Dynamic_loading\" rel=\"nofollow noreferrer\">dynamically loaded</a> as a (generated) <a href=\"https://en.wikipedia.org/wiki/Plug-in_(computing)\" rel=\"nofollow noreferrer\">plugin</a> (using <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/dlopen.html\" rel=\"nofollow noreferrer\">dlopen</a> on POSIX...)</p>\n\n<hr>\n\n<p>Sometimes, you can trick the compiler. For a project compiled by GCC, you could consider writing your <a href=\"https://gcc.gnu.org/onlinedocs/gccint/Plugins.html\" rel=\"nofollow noreferrer\">GCC plugin</a>..... (that is a lot more work than adding a command generating C code; your plugin could provide extra magic pragmas or builtins or attributes used by some other macros).</p>\n\n<p>You could also configure the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Spec-Files.html\" rel=\"nofollow noreferrer\">spec file</a> of your <code>gcc</code> to handle specifically some C files. Beware, that could affect every future compilation!</p>\n"}], "owner": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1358, "favorite_count": 0, "accepted_answer_id": 47557437, "answer_count": 1, "score": 1, "last_activity_date": 1511980887, "creation_date": 1511971805, "last_edit_date": 1511972830, "question_id": 47557125, "link": "https://stackoverflow.com/questions/47557125/dynamically-prefix-macro-names-with-a-variadic-macro", "title": "Dynamically prefix macro names with a variadic macro", "body": "<h1>Background</h1>\n\n<p><a href=\"https://stackoverflow.com/questions/1489932/how-to-concatenate-twice-with-the-c-preprocessor-and-expand-a-macro-as-in-arg\">I've utilized a set of preprocessor macros from another question that allows me to prefix symbol names</a> (enums, function names, struct names, etc) in my source, i.e.:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define VARIABLE 3\n#define PASTER(x,y) x ## _ ## y\n#define EVALUATOR(x,y)  PASTER(x,y)\n#define NAME(fun) EVALUATOR(fun, VARIABLE)\n\nvoid NAME(func)(int i);\n\nint main(void)\n{\n    NAME(func)(123);\n\n    return 0;\n}\n\nvoid NAME(func)(int i)\n{\n    printf(\"i is %d in %s.\\n\", i, __func__);\n}\n</code></pre>\n\n<hr>\n\n<h1>Problem</h1>\n\n<p>This works as expected, with the following output: <code>i is 123 in func_3.</code> </p>\n\n<h1>Edit</h1>\n\n<p>I would like this code:</p>\n\n<pre><code>#define NAME(SOME_MACRO_CONST)  (123)\n#define NAME(SOME_MACRO_CONST2) (123)\n</code></pre>\n\n<p>To expand to:</p>\n\n<pre><code>#define 3SOME_MACRO_CONST  (123)\n#define 3SOME_MACRO_CONST2 (123)\n</code></pre>\n\n<p><strong>I realize the macro shouldn't start with a digit. In the final code I'll be using names like <code>LIB_A_</code> and <code>LIB_B_</code> as prefixes.</strong></p>\n\n<h1>/Edit</h1>\n\n<p>However, if I attempt to do the same with macros as the arguments to my <code>NAME</code> variadic macro, it fails like so:</p>\n\n<h2>Re-using <code>NAME</code> macro:</h2>\n\n<h3>Code</h3>\n\n<pre><code>#define NAME(MY_CONST)  (3)\n</code></pre>\n\n<h3>Output</h3>\n\n<pre><code>test.c:7:0: warning: \"NAME\" redefined\n #define NAME(MY_CONST) 3\n</code></pre>\n\n<h2>Manually pasting prefix:</h2>\n\n<h3>Code:</h3>\n\n<pre><code>#define VARIABLE ## MY_CONST    (3)\n</code></pre>\n\n<h3>Output:</h3>\n\n<pre><code>test.c:8:18: error: '##' cannot appear at either end of a macro expansion\n #define VARIABLE ## MY_CONST (3)\n</code></pre>\n\n<hr>\n\n<h1>Question</h1>\n\n<p>How can I create simple macro definitions (name + value) that has a common prefix for all the macros? The goal is to be able to make multiple copies of the source file and compile them with different flags so all versions can be linked together into the same final binary without symbol/macro name collisions (the macros will later be moved into header files). The final file will be too big to write in something like M4 or a template language. <strong>Ideally, the solution would involve being able to use a single macro-function/variadic-macro for all use cases, but I'm OK with one macro for symbol prefixing, and another for macro-name prefixing.</strong></p>\n"}, {"tags": ["python", "c", "module"], "comments": [{"owner": {"reputation": 7240, "user_id": 3190076, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hXPhP.jpg?s=128&g=1", "display_name": "alec_djinn", "link": "https://stackoverflow.com/users/3190076/alec-djinn"}, "edited": false, "score": 0, "creation_date": 1511969643, "post_id": 47556349, "comment_id": 82070021, "body": "You may want to have a look at <a href=\"http://cython.org/\" rel=\"nofollow noreferrer\">cython.org</a>"}, {"owner": {"reputation": 508, "user_id": 7683374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2014b72f925e6a1171ad42b59ae487a1?s=128&d=identicon&r=PG", "display_name": "RottenCandy", "link": "https://stackoverflow.com/users/7683374/rottencandy"}, "edited": false, "score": 0, "creation_date": 1511969708, "post_id": 47556349, "comment_id": 82070074, "body": "Have you taken a look at <a href=\"http://cython.org/\" rel=\"nofollow noreferrer\">Cython</a>? Are you asking for a module which helps you write C code?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9026218, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Plcllgwlu-M/AAAAAAAAAAI/AAAAAAAAAqI/WSgCjia40UU/photo.jpg?sz=128", "display_name": "Pallavi .V.R", "link": "https://stackoverflow.com/users/9026218/pallavi-v-r"}, "edited": false, "score": 0, "creation_date": 1511971052, "post_id": 47556761, "comment_id": 82071070, "body": "Thank you so much for your feedback and yes right now I don&#39;t want cython at this moment. The application i am trying to build is quite simple. I was fascinated to use the module(codegen) like in the link attached where i wanted to create a c file . I was was looking out for a equivalent functionality.  And yes normal file operations are always at disposal for hard coding."}, {"owner": {"reputation": 76206, "user_id": 108205, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ef459127edc89cc575d80a73cd8c567a?s=128&d=identicon&r=PG", "display_name": "jsbueno", "link": "https://stackoverflow.com/users/108205/jsbueno"}, "reply_to_user": {"reputation": 11, "user_id": 9026218, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Plcllgwlu-M/AAAAAAAAAAI/AAAAAAAAAqI/WSgCjia40UU/photo.jpg?sz=128", "display_name": "Pallavi .V.R", "link": "https://stackoverflow.com/users/9026218/pallavi-v-r"}, "edited": false, "score": 0, "creation_date": 1511971691, "post_id": 47556761, "comment_id": 82071503, "body": "Just take a look at jinja - I think it can do what you want. That CodeGen thing you linked too actually looks awful."}, {"owner": {"reputation": 11, "user_id": 9026218, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Plcllgwlu-M/AAAAAAAAAAI/AAAAAAAAAqI/WSgCjia40UU/photo.jpg?sz=128", "display_name": "Pallavi .V.R", "link": "https://stackoverflow.com/users/9026218/pallavi-v-r"}, "edited": false, "score": 0, "creation_date": 1511972294, "post_id": 47556761, "comment_id": 82071908, "body": "LOL !! Even i was surprised to see that module at first. Anyway thanks a lot . I will try Jinja :)"}], "tags": [], "owner": {"reputation": 76206, "user_id": 108205, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ef459127edc89cc575d80a73cd8c567a?s=128&d=identicon&r=PG", "display_name": "jsbueno", "link": "https://stackoverflow.com/users/108205/jsbueno"}, "is_accepted": false, "score": 1, "last_activity_date": 1511970714, "creation_date": 1511970714, "answer_id": 47556761, "question_id": 47556349, "link": "https://stackoverflow.com/questions/47556349/what-are-the-modules-supported-by-python-to-generate-a-c-code/47556761#47556761", "title": "What are the modules supported by python to generate a c code?", "body": "<p>By what you describe you just have to generate a source code file you will be using in your own project.</p>\n\n<p>You just don t need any special Python library to do that.\nThe linked article you give does nothing special with the C++ strings for each line hardcoded into Python code, which linearly generates all the parts of the code: there is nothing special on that article about \"creatign a C++\" file - just put what you want in your final file in strings, and you can put your data values using the string format method, or the new f-strings.</p>\n\n<p>However, if you want a nice and maintainable solution, you could use a template library for Python, like <a href=\"http://jinja.pocoo.org/docs/latest/\" rel=\"nofollow noreferrer\">\"jinja2\"</a>. Once you have a jinja2 template for your desired C file, all you need to do is to call Jinja's render methods passing the custom data you want into the final file, and sabve the result to a file. </p>\n\n<p>That is not specific about C, though, that is about creating a structered text file with data you have, and Jinja is a nice tool for that.</p>\n\n<p>People are mentioning \"Cython\" around: Cython is a solution to convert Python-like code into C - that is, if you want a program you wrote in Python to become a C program. (Although it is seldon used like that - normally the C generating and building steps are transparent, and one just cares about the final executable program or module when using Cython.)</p>\n\n<p>From my reading of your question, Cython is not what you want at this moment.</p>\n"}], "owner": {"reputation": 11, "user_id": 9026218, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Plcllgwlu-M/AAAAAAAAAAI/AAAAAAAAAqI/WSgCjia40UU/photo.jpg?sz=128", "display_name": "Pallavi .V.R", "link": "https://stackoverflow.com/users/9026218/pallavi-v-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511970896, "creation_date": 1511969467, "last_edit_date": 1511970896, "question_id": 47556349, "link": "https://stackoverflow.com/questions/47556349/what-are-the-modules-supported-by-python-to-generate-a-c-code", "title": "What are the modules supported by python to generate a c code?", "body": "<p>Are there any particular modules in python which provide the generation of c file and write into this c file ? Currently I am parsing an xml file with python and I want to use the parsed information to create a desired data structure from the python script into a c file.\n for example , i saw a reference from the link <a href=\"https://www.codeproject.com/Articles/571645/Really-simple-Cplusplus-code-generation-in-Python\" rel=\"nofollow noreferrer\">https://www.codeproject.com/Articles/571645/Really-simple-Cplusplus-code-generation-in-Python</a> . Is there similar module for c code generation ??</p>\n"}, {"tags": ["c", "c89"], "comments": [{"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 1, "creation_date": 1511969026, "post_id": 47556181, "comment_id": 82069552, "body": "Safe as long as the size fits into an UL..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1511969181, "post_id": 47556181, "comment_id": 82069650, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.19p4\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#7.19p4</a> <i>The types used for size_t and ptrdiff_t should not have an integer conversion rank greater than that of signed long int unless the implementation supports objects large enough to make this necessary.</i>. Yet it is just a recomendation."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 5, "creation_date": 1511969266, "post_id": 47556181, "comment_id": 82069714, "body": "<code>size_t</code> is an unsigned type, so does not have any &#39;trap&#39; values. So it is always safe to convert it to <code>long unsigned int</code> even when the original value cannot be represented in the new type."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1511969849, "post_id": 47556181, "comment_id": 82070195, "body": "@Bilkokuya Yes, I meant &#39;safe&#39; as in no UB."}, {"owner": {"user_type": "does_not_exist", "display_name": "user955340"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1511969975, "post_id": 47556181, "comment_id": 82070287, "body": "@IanAbbott Apologies for that, I&#39;ve removed my incorrect comment. Only just learned that <code>size_t</code> cannot ever be larger than <code>long unsigned int</code> in C89 due to the following: <a href=\"https://stackoverflow.com/a/39441237/955340\">stackoverflow.com/a/39441237/955340</a> It appears it is safe in both regards, again - apologies."}], "answers": [{"comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 2, "creation_date": 1511971109, "post_id": 47556740, "comment_id": 82071108, "body": "&quot;As such, size_t in C89 will never be larger than unsigned long, and therefore the cast is always safe&quot; isn&#39;t true. There&#39;s no such guarantee in the standard. Having <code>size_t</code> as a 64-bit type and <code>unsigned long</code> as a 32-bit type is a valid in C89. Having said that, there&#39;s not much better option if one is stuck with C89."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1511971316, "post_id": 47556740, "comment_id": 82071253, "body": "P.P. Do you have an example of such a system or compiler?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1511971489, "post_id": 47556740, "comment_id": 82071365, "body": "Linked page in the answer has MSVC as an example."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 2, "creation_date": 1511972388, "post_id": 47556740, "comment_id": 82071968, "body": "That&#39;s based on the assumption that <code>sizeof(long) &lt;= sizeof(size_t)</code> (i.e., if <code>size_t</code> must be one of an existing &quot;integral type&quot;. But I can&#39;t find anything to that effect) is required in C89 which I am not sure about. Perhaps MSVC isn&#39;t a valid C89 implementation in the respect ;-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user955340"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1511972530, "post_id": 47556740, "comment_id": 82072063, "body": "@P.P. I have re-read the relevant parts of the draft standard for C89, and while I may be wrong - my interpretation is definitely that the MSVC example shows non-conforming behaviour. I will amend my answer to include this though, to ensure it&#39;s clear that relying on the letter of the standard may not produce results in reality. The draft standard I am using is: <a href=\"http://port70.net/~nsz/c/c89/c89-draft.html\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c89/c89-draft.html</a> The specific line I&#39;m going by is (3.3.3.4) &quot;its type (an unsigned integral type) is size_t&quot;, combined with the list of type specifiers in (3.5.2)"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 2, "creation_date": 1511973394, "post_id": 47556740, "comment_id": 82072601, "body": "<code>size_t</code> an integral type and integral type is defined as &quot;The type char, the signed and unsigned integer types, and the enumerated types are collectively called integral types.&quot; So if an <code>size_t</code> is defined as <code>unsigned long long</code>, say an extension provided by the implementation in C89, then it&#39;s an &quot;unsigned integer type&quot; and can be considered as an integral type. So it&#39;s not clear if <code>size_t</code> must be an <i>existing</i> integral type."}, {"owner": {"user_type": "does_not_exist", "display_name": "user955340"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1511973972, "post_id": 47556740, "comment_id": 82072956, "body": "@P.P. My interpretation of the standard (1.7 Compliance) <i>&quot;A conforming implementation may have extensions (including additional library functions), provided they do not alter the behavior of any strictly conforming program&quot;</i> is that an extension which adds <code>unsigned long long</code> and allows <code>size_t</code> to be defined as it, would break previously <i>&quot;strictly conforming&quot;</i> code and therefore would not be compliant. However, I think the important part which I definitely agree on - is the reality will be that because such extensions do exist, relying on the &quot;word of the standard&quot; is not truly &quot;safe&quot;."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 2, "creation_date": 1511974510, "post_id": 47556740, "comment_id": 82073327, "body": "The reasoning in this answer is not correct. It&#39;s possible for <code>size_t</code> to be an extended integer type (in which case there might be no way to print it with <code>printf</code> in C89). It&#39;s also possible that you&#39;re writing C89 code simply for cross-platform compatibility, but using it with a C99 or C11 compiler where larger standard types may be available. In C99 or later you can safely use a cast to <code>(uintmax_t)</code> and <code>%ju</code> but C89 did not have that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user955340"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1511974817, "post_id": 47556740, "comment_id": 82073516, "body": "@R.. In both of these cases, does this not mean that either the extension is technically non-compliant - or that you are not truly compiling C89 code with a compliant C89 compiler? I&#39;ve added a proviso at the bottom to try to make clear that this is the reality of the situation and not to rely on the main answer for practical situations. But I disagree that the answer incorrect in regard to writing a C89 program that follows the letter of the standard. If I&#39;m mistaken, I&#39;m happy to adapt the answer further."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 2, "creation_date": 1511975530, "post_id": 47556740, "comment_id": 82073943, "body": "@Bilkokuya: As far as I know, C89 allows implementations where <code>size_t</code> is an extended integer type. A C89 that accepts <code>long long</code> as an extension and uses <code>unsigned long long</code> to define <code>size_t</code> should be an example of such. It&#39;s true that a C99 implementation is not, strictly speaking, a conforming C89 implementation (due to some namespace considerations and subtle behavioral differences) but from a practical standpoint it&#39;s reasonable to write C89 code that&#39;s also valid C99 code and compile on a C99 implementation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user955340"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1511975881, "post_id": 47556740, "comment_id": 82074144, "body": "@R.. I definitely agree on the practical standpoint, and that holding the standard as a golden-ruling is likely to produce unsafe or buggy code in this instance. I feel what&#39;s probably most useful to people is that this discussion is visible, along with the bold warning in the answer - so for now I&#39;m going to avoid editing the answer further. Hopefully it is now clear to anybody that comes here in future that the reality of the situation (regardless of what the standard dictates) is that you may cause issues if you convert <code>size_t</code> to <code>unsigned long</code> in C89 - but no UB."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user955340"}, "is_accepted": true, "score": 17, "last_activity_date": 1511974919, "last_edit_date": 1511974919, "creation_date": 1511970644, "answer_id": 47556740, "question_id": 47556181, "link": "https://stackoverflow.com/questions/47556181/is-it-safe-to-cast-size-t-to-unsigned-long-int/47556740#47556740", "title": "Is it safe to cast size_t to unsigned long int?", "body": "<p>In <strong>C89</strong>, <code>size_t</code> is defined as an unsigned integer type. Unlike future standards, C89 defines what the list of unsigned integer types are as the following:</p>\n\n<ul>\n<li>unsigned char</li>\n<li>unsigned short</li>\n<li>unsigned int</li>\n<li>unsigned long</li>\n</ul>\n\n<p>As such, <code>size_t</code> in C89 will never be larger than <code>unsigned long</code>, and therefore the cast is always safe - both in that it will not cause any undefined behaviour and in that it will always be large enough to hold the value in entirety.</p>\n\n<p>Worth noting; the C89 standard states:\n<em>\"A conforming implementation may have extensions (including additional library functions), provided they do not alter the behavior of any strictly conforming program\"</em> \nMeaning that no extension could change this behaviour - while still conforming to the C89 standard, as the unsigned integer types have been specifically listed and therefore cannot be altered.</p>\n\n<p>In future standards, this is not a guarantee and while you will not get undefined behaviour - you may lose data where <code>unsigned long</code> is smaller than <code>size_t</code>, meaning that you would display incorrect data to your user. In this situation I'd be hesitant to label it as \"safe\".</p>\n\n<hr>\n\n<p><strong>As an important additional note;</strong> this answer refers to compilers that are compliant with the C89 standard. It is possible for your C89 compiler to be \"less than compliant\" in the respects above, in which case - treat the behaviour to be similar to that of C99 or newer where you will not see undefined behaviour, but may suffer data loss if <code>size_t</code> is larger than <code>unsigned long</code>. To be clear though, this would not be complying with the C89 standard.</p>\n\n<p>Beyond this, while my interpretation of the standard (1.7 Compliance) is that while it states extensions must not alter the behaviour of a <em>\"strictly conforming program\"</em> and as such cannot alter the fact that <code>size_t</code> must be <code>unsigned long</code> at largest without complying; it does not change the fact that <strong>such extensions do exist</strong>. For example GNU GCC does provide an extension that adds <code>unsigned long long</code>. In my view this is non-compliant, but the reality is you must be prepared to deal with such things and as such - <strong>while the standard says what you are doing is completely safe, you must be prepared for potential data loss where non-compliant compilers or extensions are used</strong>.</p>\n\n<hr>\n\n<p>Please see here for previous discussion on this topic:\n<a href=\"https://stackoverflow.com/a/39441237/955340\">https://stackoverflow.com/a/39441237/955340</a></p>\n"}, {"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1511974562, "post_id": 47557819, "comment_id": 82073356, "body": "Unfortunately, <code>SIZE_MAX</code> was introduced in C99. It does not exist in C89."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1511975762, "post_id": 47557819, "comment_id": 82074074, "body": "@R.. Updated to cope with historic compilers."}, {"owner": {"reputation": 2361, "user_id": 5809597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43b1c037d08a423aeb6ee10fc922437?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Bellon", "link": "https://stackoverflow.com/users/5809597/jorge-bellon"}, "edited": false, "score": 0, "creation_date": 1511977051, "post_id": 47557819, "comment_id": 82074791, "body": "Up for the compile time check. What about directly checking <code>sizeof(size_t)</code> and <code>sizeof(long)</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 2361, "user_id": 5809597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43b1c037d08a423aeb6ee10fc922437?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Bellon", "link": "https://stackoverflow.com/users/5809597/jorge-bellon"}, "edited": false, "score": 0, "creation_date": 1511977224, "post_id": 47557819, "comment_id": 82074891, "body": "@JorgeBell&#243;n <code>#if sizeof(size_t) &lt;= sizeof(long)</code>  may not work at macro evaluation time.  Strictly speaking, either may have padding (on some unicorn platform) and so comparing sizes is not as strong as comparing <code>_MAX</code>.  <code>sizeof(size_t) &lt;= sizeof(long)</code> can be use in C11 <code>_Static_assert()</code>.  Of course code can check <code>sizeof(size_t) &lt;= sizeof(long)</code> at run-time and steer code."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1511980032, "post_id": 47557819, "comment_id": 82076464, "body": "I can also <code>assert(n &lt;= ULONG_MAX)</code> before the print statement."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1511980258, "post_id": 47557819, "comment_id": 82076581, "body": "@AugustKarlstrom True, <code>assert()</code> can be used for a <i>run time</i> check/failure.  Yet that may first happen when your customer sees the code.  I reccomend compile time checks."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1511980506, "post_id": 47557819, "comment_id": 82076700, "body": "@AugustKarlstrom Of course one could code <code>void print_size_t(size_t n) {   if (n &gt;= 10) print_size_t(n&#47;10);   putchar((int) (n%10) + &#39;0&#39;); }</code> and remove all portability issues."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1566417893, "last_edit_date": 1566417893, "creation_date": 1511974225, "answer_id": 47557819, "question_id": 47556181, "link": "https://stackoverflow.com/questions/47556181/is-it-safe-to-cast-size-t-to-unsigned-long-int/47557819#47557819", "title": "Is it safe to cast size_t to unsigned long int?", "body": "<pre><code>size_t n = foo();\nprintf(\"%lu\\n\", (long unsigned int) n);\n</code></pre>\n\n<blockquote>\n  <p>Provided that <code>size_t</code> is defined as either <code>unsigned int</code> or <code>long unsigned int</code> ...  Is the cast safe?</p>\n</blockquote>\n\n<p>Yes, the cast is safe with no undefined behavior nor loss of information on C89, C99, C11.</p>\n\n<hr>\n\n<p>But what happens <strong>if that proviso is not true</strong>?</p>\n\n<p>Assuming the range of <code>size_t</code> will be within the range of <code>unsigned long</code> is very reasonable.  Add a compile time test:  <a href=\"https://stackoverflow.com/a/2115886/2410359\">ref</a></p>\n\n<pre><code>#include &lt;limits.h&gt;\n#if defined(__STDC__)\n#if defined(__STDC_VERSION__)\n#if (__STDC_VERSION__ &gt;= 199901L)\n#include &lt;stdint.h&gt;\n#if SIZE_MAX &gt; ULONG_MAX\n#error Re-work printf size code\n#endif\n#endif\n#endif\n#endif\n</code></pre>\n\n<p>The point is that when code had a dependency - <strong>add a test</strong>.  Even if it acceptable on all known machines today and historically, the future has unknowns.  </p>\n\n<p>C, today, with its immense flexibility does allow <code>SIZE_MAX &gt; ULONG_MAX</code>, but it is certainly rare.  IMO, <code>SIZE_MAX &gt; ULONG_MAX</code> is <a href=\"https://en.wiktionary.org/wiki/beyond_the_pale\" rel=\"nofollow noreferrer\">beyond the pale</a>.</p>\n\n<hr>\n\n<p>Such tests are common as from time to time, though possible, it is simply not practicable or budgeted to write <strong>super</strong> portable code.</p>\n\n<pre><code>#include &lt;limits.h&gt;\n#if CHAR_BIT != 8 &amp;&amp; CHAR_BIT != 16 &amp;&amp; CHAR_BIT != 32 &amp;&amp; CHAR_BIT != 64\n  #error Code depends on char size as a common power of 2.\n#endif\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>I need a portable way to print the value of a variable n of type size_t.</p>\n</blockquote>\n\n<p>Yet to address OP's top level goal, a simple portable helper function can be written.</p>\n\n<pre><code>// This approach works with any unsigned type\nvoid print_size_t(size_t n) {\n  if (n &gt;= 10) print_size_t(n/10);\n  putchar((int) (n%10) + '0');\n}\n</code></pre>\n\n<p>To avoid recursion, a slightly longer function: </p>\n\n<pre><code>#include &lt;limits.h&gt;\nvoid print_size_t(size_t n) {\n  char buf[sizeof n * CHAR_BIT / 3 + 2];  // 1/3 is more than log2(10)\n  char *p = &amp;buf[sizeof buf - 1];          // Start at end of buf[]\n  *p = '\\0';\n  do {\n    p--;\n    *p = (char) (n%10 + '0');\n    n /= 10;\n  } while (n);    // Use a do {} while so print_size_t(0) prints something\n  fputs(p, stdout);\n}\n</code></pre>\n"}], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9327, "favorite_count": 2, "accepted_answer_id": 47556740, "answer_count": 2, "score": 12, "last_activity_date": 1566417893, "creation_date": 1511968934, "last_edit_date": 1511978601, "question_id": 47556181, "link": "https://stackoverflow.com/questions/47556181/is-it-safe-to-cast-size-t-to-unsigned-long-int", "title": "Is it safe to cast size_t to unsigned long int?", "body": "<p>I need a portable way to print the value of a variable <em>n</em> of type <code>size_t</code>. Since I use ANSI C89 I cannot use the <code>z</code> length modifier. My current approach is to cast the value to <code>long unsigned int</code>:</p>\n\n<pre><code>printf(\"%lu\\n\", (long unsigned int) n);\n</code></pre>\n\n<p>Provided that <code>size_t</code> is defined as either <code>unsigned int</code> or <code>long unsigned int</code> I can't see how this would fail. Is the cast safe?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1511968897, "post_id": 47556130, "comment_id": 82069453, "body": "<i>&quot;that does not work&quot;</i> is not a problem description. What happened?"}, {"owner": {"reputation": 3, "user_id": 9026442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07480f034fa39b5145a42cd57726d938?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/9026442/j-doe"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1511969264, "post_id": 47556130, "comment_id": 82069712, "body": "@underscore_d I&#39;m sorry. The animation keeps on looping and it won&#39;t stop."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1511969315, "post_id": 47556130, "comment_id": 82069751, "body": "There is no loop in your snippet."}, {"owner": {"reputation": 5543, "user_id": 6372809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11k5.jpg?s=128&g=1", "display_name": "ilkkachu", "link": "https://stackoverflow.com/users/6372809/ilkkachu"}, "edited": false, "score": 0, "creation_date": 1511970543, "post_id": 47556130, "comment_id": 82070711, "body": "I suppose this depends on how the modification system works in this game. Does your code run as a function that gets called from time to time from the main program to make some decisions, or does it run as a distinct thread simultaneously with the rest of the game? Most operating systems have a system call for sleeping a set amount of time, just because the OS has access to timer hardware and can do it more effectively than the application program by itself. Possibly there&#39;s something similar in games too, since they are likely have other work while your code runs."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1511971723, "post_id": 47556130, "comment_id": 82071521, "body": "Use OS specific functions for idle delays (e.g. on Linux <a href=\"http://man7.org/linux/man-pages/man2/nanosleep.2.html\" rel=\"nofollow noreferrer\">nanosleep(2)</a> or <a href=\"http://man7.org/linux/man-pages/man3/usleep.3.html\" rel=\"nofollow noreferrer\">usleep(3)</a> or maybe <a href=\"http://man7.org/linux/man-pages/man2/poll.2.html\" rel=\"nofollow noreferrer\">poll(2)</a>...) or something related to your event loop (or GUI toolkit)"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "is_accepted": true, "score": 2, "last_activity_date": 1511969270, "creation_date": 1511969270, "answer_id": 47556298, "question_id": 47556130, "link": "https://stackoverflow.com/questions/47556130/c-has-time-passed/47556298#47556298", "title": "C - Has Time Passed", "body": "<p>Here</p>\n\n<pre><code>if (toc&amp;&amp;((GET_GAME_TIMER()-tic) &gt; 8000)) {\n</code></pre>\n\n<p>you check immediately after setting <code>tic</code> to a clock value if 8 seconds have passed. Unless the computer is <em>very</em> slow, that will not happen.</p>\n\n<p>Doing a <em>while</em> on the opposite condition will work</p>\n\n<pre><code>while (toc &amp;&amp; (GET_GAME_TIMER()-tic) &lt;= 8000)) {\n    // nothing, just wait\n    // or you could use that time to do some quick tasks\n}\ntoc = 0;\n</code></pre>\n\n<p>waiting in a loop until 8 seconds passed.</p>\n"}], "owner": {"reputation": 3, "user_id": 9026442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07480f034fa39b5145a42cd57726d938?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/9026442/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 47556298, "answer_count": 1, "score": 0, "last_activity_date": 1511971494, "creation_date": 1511968782, "last_edit_date": 1511971494, "question_id": 47556130, "link": "https://stackoverflow.com/questions/47556130/c-has-time-passed", "title": "C - Has Time Passed", "body": "<p>I'm making a game modification for Grand Theft Auto V. In this modification, I play an animation, but I also want this animation to stop after 8 seconds.</p>\n\n<p>I will have to calculate the ingame time and see if 8 seconds have passed (<code>GET_GAME_TIMER()</code> outputs the game time in milliseconds):</p>\n\n<pre><code>int tic = GET_GAME_TIMER();\nint toc = 1;\n\nif (toc&amp;&amp;((GET_GAME_TIMER()-tic) &gt; 8000)) {\n     // stop animation\n     toc = 0;\n}\n</code></pre>\n\n<p>But that does not work: The animation keeps on looping and it won't stop.</p>\n\n<p>Does anybody else have an idea how to accomplish this?</p>\n"}, {"tags": ["c", "libuv"], "answers": [{"tags": [], "owner": {"reputation": 739, "user_id": 4794649, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh6.googleusercontent.com/-Q0FdvS0ieJs/AAAAAAAAAAI/AAAAAAAAFuc/9cM1CX7uptw/photo.jpg?sz=128", "display_name": "\u912d\u5143\u5091", "link": "https://stackoverflow.com/users/4794649/%e9%84%ad%e5%85%83%e5%82%91"}, "is_accepted": false, "score": 0, "last_activity_date": 1512373855, "creation_date": 1512373855, "answer_id": 47628740, "question_id": 47556003, "link": "https://stackoverflow.com/questions/47556003/libuv-fs-read-file-print-one-more-time/47628740#47628740", "title": "libuv fs read file print one more time", "body": "<p>Finally found out my stupid mistake.<br>\n<code>r = uv_fs_read(uv_default_loop(), read_req, open_req-&gt;result, &amp;context-&gt;iov, 1, 0, read_cb);</code><br>\nThe params offset should be -1 instead of 0 to read from prev offset.</p>\n"}], "owner": {"reputation": 739, "user_id": 4794649, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh6.googleusercontent.com/-Q0FdvS0ieJs/AAAAAAAAAAI/AAAAAAAAFuc/9cM1CX7uptw/photo.jpg?sz=128", "display_name": "\u912d\u5143\u5091", "link": "https://stackoverflow.com/users/4794649/%e9%84%ad%e5%85%83%e5%82%91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 267, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512373855, "creation_date": 1511968357, "question_id": 47556003, "link": "https://stackoverflow.com/questions/47556003/libuv-fs-read-file-print-one-more-time", "title": "libuv fs read file print one more time", "body": "<p>Recently I am writing some c code to simply read file and print out content using libuv.<br>\nBut I don't know why my code would print first buffer twice.  </p>\n\n<pre><code>void open_cb(uv_fs_t* open_req){\n    int r = 0;\n    if(open_req -&gt; result &lt; 0 ) printf(\"open_req\");\n\n    context_t* context = open_req -&gt; data;\n\n    size_t buf_len = sizeof(char) * BUF_SIZE;\n    char *buf = malloc(buf_len);\n    context-&gt;iov = uv_buf_init(buf, buf_len);\n    context-&gt;times = 0;\n\n    uv_fs_t *read_req = malloc(sizeof(uv_fs_t));\n    context-&gt;read_req = read_req;\n    read_req-&gt;data = context;\n    r = uv_fs_read(uv_default_loop(), read_req, open_req-&gt;result, &amp;context-&gt;iov, 1, 0, read_cb);    \n}\nvoid read_cb(uv_fs_t* read_req){\n    int r = 0;\n\n    //uv_fs_t* close_req = mollac(sizeof(uv_fs_t));\n    if(read_req-&gt;result &lt; 0){\n        printf(\"read_req\");\n        return;\n    }else if(read_req-&gt;result == 0){\n        printf(\"read finish\\n\");\n        return;\n    }\n\n    context_t* context = read_req-&gt;data;\n\n    printf(\"%zu %zu\", read_req-&gt;result, context-&gt;read_open_req-&gt;result);\n    printf(\"%i :\", context-&gt;times);\n    printf(\"%s\\n\", context-&gt;iov.base);\n\n    size_t buf_len = sizeof(char) * BUF_SIZE;\n    char *buf = malloc(buf_len);\n    context-&gt;iov = uv_buf_init(buf, buf_len);\n    context-&gt;times++;\n    read_req-&gt;data = context;\n\n    r = uv_fs_read(uv_default_loop(), read_req, context-&gt;read_open_req-&gt;result, &amp;context-&gt;iov, 1, -1, read_cb);\n    if(r&lt;0) printf(\"read_req\");\n}\n</code></pre>\n\n<p>I am reading this file with only one line text: \"hello1234567\\n\", \nthe buffer size is 5 so it would print 5 characters per time.<br>\nHowever the result is </p>\n\n<pre><code>read result:5, open result:10\ntime: 0 :hello\nread result:5, open result:10\ntime: 1 :hello\nread result:5, open result:10\ntime: 2 :12345\nread result:3, open result:10\ntime: 3 :67\n\nread finish\n</code></pre>\n\n<p>first number is read_req->result, second number is context->read_open_req->result.</p>\n\n<p>Other codes are similar to the <a href=\"http://docs.libuv.org/en/v1.x/guide/filesystem.html\" rel=\"nofollow noreferrer\">official tutorial</a></p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "struct", "typedef"], "comments": [{"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 6, "creation_date": 1511967713, "post_id": 47555734, "comment_id": 82068548, "body": "In C, structs and unions each have their own namespace distinct from the global namespace. You have to say <code>struct</code> so it knows to look in the struct namespace."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1511977790, "post_id": 47555734, "comment_id": 82075248, "body": "@RaymondChen: The tag namespace is shared between structs, unions, and enums - you can&#39;t have both <code>struct foo</code> and <code>union foo</code> in the same scope, for example.  Labels get their own namespace, as do <code>struct</code> and <code>union</code> members.  All other identifiers (variable names, function names, enumeration constants, etc.) are lumped into the &quot;ordinary identifier&quot; namespace."}], "answers": [{"comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1511968085, "post_id": 47555836, "comment_id": 82068855, "body": "Judging if this is an advantage serious enough to counterbalance the annoyance of writing <code>struct</code> all the time (or using the <code>typedef</code> trick, which historically confused debugging information) is left to the reader."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1511968459, "post_id": 47555836, "comment_id": 82069132, "body": "@MatteoItalia The problem is that there can be conflicts with names in other modules or libraries. Using the keywords allows to avoid these conflicts."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1511969742, "post_id": 47555836, "comment_id": 82070105, "body": "not really... it just keeps types into a separate namespace, which is still shared between all included libraries, so it helps just in the unlikely case of a conflict between a type and another kind of symbol. If you have conflicting function names (which is what generally happen) you are just as in trouble."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1511970136, "post_id": 47555836, "comment_id": 82070414, "body": "@MatteoItalia You are contradicting yourself. If you are speaking about separate namespaces then you are confirming my statement. You just do not understand what you are saying yourself."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 2, "creation_date": 1511970375, "post_id": 47555836, "comment_id": 82070577, "body": "There&#39;s a namespace for structs, a namespace for unions and a namespace for all the rest; each one of them is shared between all the libraries you include. What I&#39;m saying is simply that it&#39;s a separation of the wrong kind - you want to have a namespace for each library, not a namespace for each kind of entities (which can still have conflicting names between different libraries)."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1511970674, "post_id": 47555836, "comment_id": 82070809, "body": "@MatteoItalia For starters there is one namespace for tags of structures, unions and enumerations. But one more you do not understand what you are saying. Using separate namespaces allows to decrease name conflicts. That is all."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1511970837, "post_id": 47555836, "comment_id": 82070927, "body": "@MatteoItalia Moreover in my answer I showed a demonstrative program where the same one name is used in three different name spaces."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1511974301, "post_id": 47555836, "comment_id": 82073179, "body": "I don&#39;t know why you get all this worked up; the fact that there are those separate namespaces is clear, and is clear as well that names in different namespaces don&#39;t conflict. All I&#39;m saying is that it&#39;s a weak solution for the &quot;name conflicts between unrelated libraries&quot;, because it only separates for type of entity, not for &quot;library of origin&quot;, so it helps you only if the name conflicts you have are between different kind of entity, which, in my experience, happens quite rarely (99% of name conflicts I ever had were about function names)."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1511975135, "post_id": 47555836, "comment_id": 82073705, "body": "@MatteoItalia Nobody says that this resolves all problems with the name collision. But this allows to decrease name collisions."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1511967852, "creation_date": 1511967852, "answer_id": 47555836, "question_id": 47555734, "link": "https://stackoverflow.com/questions/47555734/why-must-the-struct-keyword-precede-struct-instances-in-c/47555836#47555836", "title": "Why must the &#39;struct&#39; keyword precede struct instances in C?", "body": "<p>Due to using the keywords struct, union and enum names for these types can form their own namespace that will not conflict with names of other entities.</p>\n\n<p>For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    struct Book \n    {\n        const char *Book;\n    } Book = { \"The first favorite book\" };\n\n    struct Book otherBook = { .Book = \"The second favorite book\" };\n\n    puts( Book.Book );\n    puts( otherBook.Book );\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1511969056, "creation_date": 1511969056, "answer_id": 47556226, "question_id": 47555734, "link": "https://stackoverflow.com/questions/47555734/why-must-the-struct-keyword-precede-struct-instances-in-c/47556226#47556226", "title": "Why must the &#39;struct&#39; keyword precede struct instances in C?", "body": "<p>With the current arrangement, you could have both <code>struct Book</code> and a global/local symbol named <code>Book</code>, which doesn't need to be related to <code>struct Book</code>. <code>struct stat</code> existing alongside a function named <code>stat</code> is a nice example this feature being used in POSIX.</p>\n\n<p>Clearly, you could automate the typedefing as C++ has done (and thereby lose the possibility of having a perhaps unrelated <code>Book</code> and <code>struct Book</code> in the same scope), but I guess that not automating it makes the grammar perhaps neater, because then if you don't use <code>typedef</code>s at all, you've got a basically context-free grammar, whereas with <code>typedef</code>s (explicit or implicit) a context of currently valid <code>typedef</code>ed types has to be maintained by the parser.</p>\n\n<hr>\n\n<p>Personally, I prefer automated <code>typedef</code>ing to the possibility of having a global scope coexist with a struct tag of the same name, and so I do:</p>\n\n<pre><code>#define Struct(Nm,...) typedef struct Nm Nm; struct Nm __VA_ARGS__\n#define Union(Nm,...) typedef union Nm Nm; union Nm __VA_ARGS__\n#define Enum(Nm,...) enum Nm __VA_ARGS__; typedef enum Nm Nm\n\nStruct(Book,{\n   char title[50];\n   char author[50];\n   char subject[100];\n   int book_id;\n});\n</code></pre>\n\n<p>(You may want to use it alongside a naming convention that lets you know you're dealing with a struct/union/enum (e.g., <code>_s</code> as in <code>book_s</code>)).</p>\n"}], "owner": {"reputation": 3336, "user_id": 2649384, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/07fcf64005a81f4b34618c50a15f2b20?s=128&d=identicon&r=PG", "display_name": "Izzo", "link": "https://stackoverflow.com/users/2649384/izzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1511969056, "creation_date": 1511967512, "question_id": 47555734, "link": "https://stackoverflow.com/questions/47555734/why-must-the-struct-keyword-precede-struct-instances-in-c", "title": "Why must the &#39;struct&#39; keyword precede struct instances in C?", "body": "<p>Let's say I define a struct in C. If I declare an instance of that struct, it's necessary that I include the 'struct' keyword in front of it.</p>\n\n<pre><code>// Define struct\nstruct Book {\n   char title[50];\n   char author[50];\n   char subject[100];\n   int book_id;\n};\n\n// Instantiate struct\nint main()\n{\n    struct Book myBook;\n}\n</code></pre>\n\n<p>My question: why is it necessary for the struct keyword to precede any instantiation of the struct? It seems like the compiler would have plenty of information to deduct that 'Book' is a struct.</p>\n\n<p>I realize you can get around this by using a typedef, but that really just seems like boiler plate code for something the compiler should already know.</p>\n"}, {"tags": ["c++", "c", "windows", "dll", "memory-leaks"], "comments": [{"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 3, "creation_date": 1511967440, "post_id": 47555600, "comment_id": 82068315, "body": "It will be hard to tell without looking into the code. Try simple things. Does leak if you don&#39;t call any method, just load the library? If so, yikes. If not, then find a method that causes tis. On WIdnows you might find it tnds to allocate things at the same place  and can set a break point programmatically when that memory address is allocated - you could then debug where the problem is. More simply, you may find the &quot;contract&quot; for the API is they allocate stuff but you are supoosed to free it. Are therre any docs/comments/developers to ask?"}, {"owner": {"reputation": 508, "user_id": 6885710, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/D8MzG.jpg?s=128&g=1", "display_name": "rranjik", "link": "https://stackoverflow.com/users/6885710/rranjik"}, "reply_to_user": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1512020195, "post_id": 47555600, "comment_id": 82090752, "body": "@doctorlove thanks for your comment. Just loading and unloading does not crash my app. As you mentioned, I can find the specific function call after calling which this issue happens. But, why ? Why does a resource leak cause a crash here ? that too, at some completely innocent part of my app ? <code>int main { int* newInteger = new int; return 0;}</code> does not crash, in the same lines why does the leak here, cause failure ? Can you please explain what exactly is causing the crash here ? I will read through the API contracts, but, help me understand the issue. CRT linkage is same everywhere."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1512035685, "post_id": 47555600, "comment_id": 82098178, "body": "I&#39;d need more details on the crash. Try to make a core dump and see what that tells you?"}], "owner": {"reputation": 508, "user_id": 6885710, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/D8MzG.jpg?s=128&g=1", "display_name": "rranjik", "link": "https://stackoverflow.com/users/6885710/rranjik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511967502, "creation_date": 1511967126, "question_id": 47555600, "link": "https://stackoverflow.com/questions/47555600/resource-leak-across-dll-boundaries", "title": "Resource leak across dll boundaries", "body": "<p>I have a third party (open-source) dll written in C, let's call it <code>library_c_style_0.2.dll</code>. In my C++ application I have to call methods from this dll. I will make calls to these methods from inside a dll, say <code>library0.1.dll</code>, loaded by my <code>application.exe</code>. After using the dll <code>library_c_style_0.2.dll</code>(which I load at run-time using LoadLibrary) I'm calling FreeLibrary. I can see App Verifier complaining that <code>A heap allocation was leaked.</code> I ignore this and continue and I see failures in some unrelated parts of my app starting to fail at, <code>HeapAlloc</code>. </p>\n\n<p>Thus to verify this I used crtdbg, and wrote a mini simulation of the scenario like the following. The export from <code>library_c_style_0.2.dll</code> is like so,</p>\n\n<pre><code>int hello_from_c_style_library(const char* string_to_print)\n{\n    _CrtMemState s1, s2, s3;\n    _CrtMemCheckpoint(&amp;s1); //create on checkpoint\n\n    int length = strlen(string_to_print);\n    char * c = malloc(length+1); //allocate memory for the sting\n    StringCchCopyA(c, length + 1, string_to_print);\n    printf(\"%s\", c);\n\n    //comment the folling lines if you pretend that you will foget to free\n    //free(c);\n\n    _CrtMemCheckpoint(&amp;s3); //one more after resource allocation\n    if (_CrtMemDifference(&amp;s2, &amp;s3, &amp;s1))//find the difference now\n    {\n        //returns 1 if memory is leaked; 0 otherwise\n        OutputDebugString(L\"Memory Leaked!!!\");\n        _CrtDumpMemoryLeaks();\n    }\n    return 0;\n}\n</code></pre>\n\n<p>and my <code>library0.1.dll</code> that will load this at run-time would be like so,</p>\n\n<pre><code>HINSTANCE hinstLib = LoadLibrary(TEXT(\"library_c_style_0.2.dll\"));\nif (hinstLib != NULL)\n{\n    //GetProcAddress of hello_from_c_style_library\n    //call the funtion\n    //we are now done with the third party dll, free it\n\n    FreeLibrary(hinstLib);\n}\n</code></pre>\n\n<p>But, if I uncomment the <code>free(c)</code> all is well. (and there was no problem when I wrote the sample <code>library_c_style_0.2.dll</code> in C++ with operator <code>new</code>, though it leaked)</p>\n\n<p>As we can see <code>library_c_style_0.2.dll</code> leaks the memory that it allocated for <code>c</code> and I see the call to <code>FreeLibrary(hinstLib)</code> failing with the error <code>A heap allocation was leaked.</code> on AppVerifier.</p>\n\n<p>The output window dump from CRT is as follows,</p>\n\n<pre><code>Memory Leaked!!!Detected memory leaks!\nDumping objects -&gt;\nlibrary_c_style_0.2.c(23) : {69} normal block at 0x08B31FF0, 6 bytes long.\n Data: &lt;hello &gt; 68 65 6C 6C 6F 00 \nObject dump complete.\n</code></pre>\n\n<p>as we can see <code>hello</code>'s 6 bytes are leaked. </p>\n\n<p>This is just a simulation, the actual third party dll (for which library_c_style_0.2.dll is the placeholder here) is leaking some resource and is causing my app to crash.</p>\n\n<p>What can I do ? Is there a way I can deal with this without having to look into the third party C dll that leaks the resource ? If I ignore this, it crashes some unrelated part of my C++ app on <code>HeapAlloc</code>. </p>\n\n<p>Why does this happen ? Any pointers will be helpful. I'm new to the Windows environment. Does every dll have its own heap ?! Is the error thrown because, I try to free the library while it is holding a resource ?</p>\n\n<p>Is there a workaround to avoid looking into <code>library_c_style_0.2.dll</code>'s code ? Is there a problem with the way I link to the run-time ? I'm statically linking to it now. In production I use <code>Multi-threaded (/MT)</code>and I can see the leaky dll (which is a pretty huge code base) also uses the same.</p>\n\n<p>I would want to understand the basics. Why does resource leak cause a failure here ? Please explain the internals about, what exactly is going on here.</p>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 0, "creation_date": 1511967620, "post_id": 47555379, "comment_id": 82068452, "body": "running the code or trying to compile the code?"}, {"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 1, "creation_date": 1511967653, "post_id": 47555379, "comment_id": 82068488, "body": "I suspect you shouldn&#39;t be setting HAVE_STRUCT_TIMESPEC, that should be set by the header that actually provides it"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1511967929, "post_id": 47555379, "comment_id": 82068734, "body": "Check the file that the compiler claims to be corrupt. Is it corrupt?"}, {"owner": {"reputation": 93, "user_id": 8770655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-v4ynAoO7sDI/AAAAAAAAAAI/AAAAAAAAAFw/YAhtbaHF8uA/photo.jpg?sz=128", "display_name": "Addict", "link": "https://stackoverflow.com/users/8770655/addict"}, "edited": false, "score": 1, "creation_date": 1511968780, "post_id": 47555379, "comment_id": 82069360, "body": "Is it C or C++ ? Title say C++ but tags say C."}, {"owner": {"reputation": 9, "user_id": 8043469, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qfgEAUOfzQw/AAAAAAAAAAI/AAAAAAAAAH8/SOXSLTe0zPY/photo.jpg?sz=128", "display_name": "Hito Roke", "link": "https://stackoverflow.com/users/8043469/hito-roke"}, "edited": false, "score": 0, "creation_date": 1511968896, "post_id": 47555379, "comment_id": 82069451, "body": "i add tag c++.  By the way, Has been changed."}], "owner": {"reputation": 9, "user_id": 8043469, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qfgEAUOfzQw/AAAAAAAAAAI/AAAAAAAAAH8/SOXSLTe0zPY/photo.jpg?sz=128", "display_name": "Hito Roke", "link": "https://stackoverflow.com/users/8043469/hito-roke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511966751, "creation_date": 1511966496, "last_edit_date": 1511966751, "question_id": 47555379, "link": "https://stackoverflow.com/questions/47555379/error-in-implementing-algorithm-for-c-redefinition-error-the-file-is-inval", "title": "Error in implementing algorithm for C ++: redefinition error &amp; The file is invalid or corrupt", "body": "<p>I have received the Derek algorithm in C++</p>\n\n<p>it's code : </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#define HAVE_STRUCT_TIMESPEC\n#include&lt;pthread.h&gt;\n#define NR_THREAD 2\n\nstruct dekker\n{\n    char flag[2];\n    int turn;\n};\n\nvoid dekker_lock(struct dekker *, int);\nvoid dekker_unlock(struct dekker *, int);\n\nstatic struct dekker dlock;\nstatic unsigned long result_sum;\nvoid dekker_lock(struct dekker *d, int thid)\n{\n    d-&gt;flag[thid] = 1;\n    while (d-&gt;flag[!thid])\n    {\n        d-&gt;flag[thid] = 0;\n        while (d-&gt;turn != thid) { (void)0; }\n        d-&gt;flag[thid] = 1;\n    }\n}\nvoid dekker_unlock(struct dekker *d, int thid)\n{\n    d-&gt;flag[thid] = 0;\n    d-&gt;turn = !thid;\n}\nstatic void *thread_routine(void *arg)\n{\n    int i;\n    int thid = *(int *)arg;\n    for (i = 0; i &lt; 1000000; i++)\n    {\n        dekker_lock(&amp;dlock, thid);\n        result_sum++;\n        dekker_unlock(&amp;dlock, thid);\n    }\n    return NULL;\n}\nint main()\n{\n    int i;\n    pthread_t pth[NR_THREAD];\n    for (i = 0; i &lt; NR_THREAD; i++) { pthread_create(&amp;pth[i], NULL,             \nthread_routine, &amp;i); }\n    for (i = 0; i &lt; NR_THREAD; i++) { pthread_join(pth[i], NULL); }\n    printf(\"result = %lu\\n\", result_sum);\n    return 0;\n}\n</code></pre>\n\n<p>and i running this code. I get an error : Timespec redefinition error.</p>\n\n<p>So I searched and got answers : Add between library declarations <code>#define HAVE_STRUCT_TIMESPEC</code></p>\n\n<p>When I add the above sentence and execute it, I also get error. : The file is invalid or corrupt. Can not read from 0x288.</p>\n\n<p>I want to know how to solution this problem. And this solution would be short and simple sentences.</p>\n"}, {"tags": ["c", "binary", "long-integer", "biginteger", "scientific-notation"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1511966673, "post_id": 47555327, "comment_id": 82067677, "body": "Which language, C or C++?  They are different languages.  C++ has <code>std::bitset</code>, <code>std::string</code> and <code>std::vector</code>, the C language doesn&#39;t."}, {"owner": {"reputation": 656, "user_id": 6219626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-cOC8zrPN-TI/AAAAAAAAAAI/AAAAAAAAFH8/3SnAtcH49Q4/photo.jpg?sz=128", "display_name": "HaseeB Mir", "link": "https://stackoverflow.com/users/6219626/haseeb-mir"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1511966821, "post_id": 47555327, "comment_id": 82067796, "body": "@ThomasMatthews yes i know c++ has std::bitset . but my problem is related to both languages long double which is both in c/c++ so i want to know where is representation wrong."}, {"owner": {"reputation": 656, "user_id": 6219626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-cOC8zrPN-TI/AAAAAAAAAAI/AAAAAAAAFH8/3SnAtcH49Q4/photo.jpg?sz=128", "display_name": "HaseeB Mir", "link": "https://stackoverflow.com/users/6219626/haseeb-mir"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1511968157, "post_id": 47555327, "comment_id": 82068901, "body": "@Ron but the problem is not with language its with data type that is present in both languages that is &quot;long double data type&quot; so thats why i added that in there."}, {"owner": {"reputation": 656, "user_id": 6219626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-cOC8zrPN-TI/AAAAAAAAAAI/AAAAAAAAFH8/3SnAtcH49Q4/photo.jpg?sz=128", "display_name": "HaseeB Mir", "link": "https://stackoverflow.com/users/6219626/haseeb-mir"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1511968671, "post_id": 47555327, "comment_id": 82069282, "body": "@Ron ok i will remove c++ tag but still i don&#39;t think it necessary to do so because my question was tested in both languages."}], "answers": [{"comments": [{"owner": {"reputation": 656, "user_id": 6219626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-cOC8zrPN-TI/AAAAAAAAAAI/AAAAAAAAFH8/3SnAtcH49Q4/photo.jpg?sz=128", "display_name": "HaseeB Mir", "link": "https://stackoverflow.com/users/6219626/haseeb-mir"}, "edited": false, "score": 0, "creation_date": 1511969016, "post_id": 47555948, "comment_id": 82069545, "body": "Then how will i get exact binary representation of big numbers if will not convert it into long double. because i want numbers &gt; 64bits and that can only be represented in long double."}, {"owner": {"reputation": 144, "user_id": 3047226, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000497727031/picture?type=large", "display_name": "NjamNjam", "link": "https://stackoverflow.com/users/3047226/njamnjam"}, "reply_to_user": {"reputation": 656, "user_id": 6219626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-cOC8zrPN-TI/AAAAAAAAAAI/AAAAAAAAFH8/3SnAtcH49Q4/photo.jpg?sz=128", "display_name": "HaseeB Mir", "link": "https://stackoverflow.com/users/6219626/haseeb-mir"}, "edited": false, "score": 0, "creation_date": 1511969849, "post_id": 47555948, "comment_id": 82070196, "body": "Are you able/allowed to use libraries? Additionally what type of numbers do you get rational or real numbers?"}, {"owner": {"reputation": 656, "user_id": 6219626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-cOC8zrPN-TI/AAAAAAAAAAI/AAAAAAAAFH8/3SnAtcH49Q4/photo.jpg?sz=128", "display_name": "HaseeB Mir", "link": "https://stackoverflow.com/users/6219626/haseeb-mir"}, "edited": false, "score": 0, "creation_date": 1511970345, "post_id": 47555948, "comment_id": 82070559, "body": "Yes we can use inbuilt libraries also i already have used them in my code and i get real numbers and followed by zeros filled in so thats why i am getting wrong binary representation . But for numbers in &lt; 64bits they hold correct but dont know for numbers &gt; 64bits they dont represent exact number while long double has 96bits."}, {"owner": {"reputation": 144, "user_id": 3047226, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000497727031/picture?type=large", "display_name": "NjamNjam", "link": "https://stackoverflow.com/users/3047226/njamnjam"}, "reply_to_user": {"reputation": 656, "user_id": 6219626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-cOC8zrPN-TI/AAAAAAAAAAI/AAAAAAAAFH8/3SnAtcH49Q4/photo.jpg?sz=128", "display_name": "HaseeB Mir", "link": "https://stackoverflow.com/users/6219626/haseeb-mir"}, "edited": false, "score": 0, "creation_date": 1511970670, "post_id": 47555948, "comment_id": 82070802, "body": "You sure you are using real numbers? Your examples and telling hints you are only using integers/natural numbers."}, {"owner": {"reputation": 656, "user_id": 6219626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-cOC8zrPN-TI/AAAAAAAAAAI/AAAAAAAAFH8/3SnAtcH49Q4/photo.jpg?sz=128", "display_name": "HaseeB Mir", "link": "https://stackoverflow.com/users/6219626/haseeb-mir"}, "edited": false, "score": 0, "creation_date": 1511971090, "post_id": 47555948, "comment_id": 82071095, "body": "Actually it uses both first it uses decimal integers and print its binary representation then it again converts decimal to scientific notation for long doubles there it could be real number based on conversion . then again its prints binary which has the problem there representing binary because of conversion is rounding off truncating bits i guess ."}], "tags": [], "owner": {"reputation": 144, "user_id": 3047226, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000497727031/picture?type=large", "display_name": "NjamNjam", "link": "https://stackoverflow.com/users/3047226/njamnjam"}, "is_accepted": true, "score": 2, "last_activity_date": 1511968187, "creation_date": 1511968187, "answer_id": 47555948, "question_id": 47555327, "link": "https://stackoverflow.com/questions/47555327/how-to-get-exact-binary-representation-of-big-numbers-in-c-c/47555948#47555948", "title": "How to get exact binary representation of big numbers in c/c++?", "body": "<p>If you first convert to double to represent your decimal in exponent representation then of course it is wrong. Have a look at <a href=\"https://en.wikipedia.org/wiki/Floating-point_arithmetic\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Floating-point_arithmetic</a>. <em>TLDR;</em> If you have more different numbers than states (2^128) you will have gaps. Thats what double is designed for from the beginning. If you require an exact representations of your actual number do not convert it into a floating point representation.</p>\n"}], "owner": {"reputation": 656, "user_id": 6219626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-cOC8zrPN-TI/AAAAAAAAAAI/AAAAAAAAFH8/3SnAtcH49Q4/photo.jpg?sz=128", "display_name": "HaseeB Mir", "link": "https://stackoverflow.com/users/6219626/haseeb-mir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 0, "accepted_answer_id": 47555948, "answer_count": 1, "score": 0, "last_activity_date": 1511968701, "creation_date": 1511966330, "last_edit_date": 1511968701, "question_id": 47555327, "link": "https://stackoverflow.com/questions/47555327/how-to-get-exact-binary-representation-of-big-numbers-in-c-c", "title": "How to get exact binary representation of big numbers in c/c++?", "body": "<p>I am trying to convert big numbers to binary in C/C++ and Java but if i take input in plain decimal like <code>998446744073709551615</code> output is correct but if i will use scientific notation ex : <code>1.7334e+32</code> then binary representation comes wrong.</p>\n\n<p>I have tested from double and BigDecimals from binary in C/C++ and Java.</p>\n\n<p><strong><em>String to Long Double in C/C++ Test :</em></strong>\n<a href=\"https://ideone.com/EeOyNP\" rel=\"nofollow noreferrer\">https://ideone.com/EeOyNP</a></p>\n\n<p><strong><em>String to Big Decimal in Java Test :</em></strong>\n<a href=\"https://ideone.com/OAvx7q\" rel=\"nofollow noreferrer\">https://ideone.com/OAvx7q</a></p>\n\n<p>The problem is with numbers which are represented in more than <code>64 bits</code> aren't represented in scientific notation somehow .</p>\n\n<p>Check out the output below.</p>\n\n<p><strong>Output from C/C++ Code :</strong></p>\n\n<blockquote>\n  <p>Input = 998446744073709551615 Expected Binary =\n  1101100010000000111011011001111011110011001010110011111111111111111111</p>\n  \n  <p>Output :  Successfully parsed strtold (C-Style): 9.98447e+20 Binary :\n  1101100010000000111011011001111011110011001010110100000000000000000000</p>\n  \n  <p>stringstream parsed stringstream (C++ Style): 9.98447e+20 Binary :\n  1101100010000000111011011001111011110011001010110100000000000000000000</p>\n  \n  <p>showBitDiff statistics :  Total Bits 70 Bits 49 Bits matched 21 Bits\n  not matched</p>\n</blockquote>\n\n<p><strong>Output from Java Code :</strong> </p>\n\n<blockquote>\n  <p>Decimal String Part  : </p>\n  \n  <p>decimalString  : 998446744073709551615 \n  Scientific notation : 9.984467440737096E20</p>\n  \n  <p>Decimal-String Radix Info :<br>\n  Binary :\n  1101100010000000111011011001111011110011001010110011111111111111111111\n  Decimal : 998446744073709551615 \n  Hexa : 0x36203B67BCCACFFFFF \n  Bit length : 70</p>\n  \n  <p>Exponent String Part :<br>\n  exponentString  : 9.984467440737096E20</p>\n  \n  <p>Exponent String Radix Info :<br>\n  Binary :\n  1101100010000000111011011001111011110011001010110100001011110100000000\n  Decimal : 998446744073709600000 \n  Hexa : 0x36203B67BCCAD0BD00 \n  Bit length : 70</p>\n  \n  <p>Both BigInts are not equal</p>\n</blockquote>\n\n<p>How do i solve this problem and represent big numbers correctly in C/C++? \ni don't want solution in java i just used java for testing purpose because it has bigDecimal Class for very large arbitrary numbers thanks.</p>\n"}, {"tags": ["c", "arrays", "multithreading"], "comments": [{"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1511966428, "post_id": 47555306, "comment_id": 82067493, "body": "Sounds like you must use some sort of synchronization resource (a mutex for example). Can&#39;t see that in your code though..."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1511966503, "post_id": 47555306, "comment_id": 82067552, "body": "Why are you calling <code>pthread_exit</code> ? It seems you ignored the helpful comment and answer to <a href=\"https://stackoverflow.com/q/47454287/253056\">your previous question</a> ? Read up on <code>pthread_join</code>."}, {"owner": {"reputation": 451, "user_id": 6650397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fcc00075552f0fd192c2c13b4f6256b?s=128&d=identicon&r=PG&f=1", "display_name": "A.nechi", "link": "https://stackoverflow.com/users/6650397/a-nechi"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1511966835, "post_id": 47555306, "comment_id": 82067807, "body": "@PaulR : actually no I used <code>pthread_join</code> and it is already working as it should be .... but now the problem is only on reading from <code>array_1[]</code>"}, {"owner": {"reputation": 451, "user_id": 6650397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fcc00075552f0fd192c2c13b4f6256b?s=128&d=identicon&r=PG&f=1", "display_name": "A.nechi", "link": "https://stackoverflow.com/users/6650397/a-nechi"}, "reply_to_user": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1511966893, "post_id": 47555306, "comment_id": 82067853, "body": "@goodvibration : why should I use synchros ... I&#39;m only reading from <code>array_1[]</code>"}, {"owner": {"reputation": 451, "user_id": 6650397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fcc00075552f0fd192c2c13b4f6256b?s=128&d=identicon&r=PG&f=1", "display_name": "A.nechi", "link": "https://stackoverflow.com/users/6650397/a-nechi"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1511967054, "post_id": 47555306, "comment_id": 82067992, "body": "@PaulR : yes sorry for that i have just made the edit"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1511967073, "post_id": 47555306, "comment_id": 82068006, "body": "You need to provide a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, not an approximation of your code which you then keep editing."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1511967208, "post_id": 47555306, "comment_id": 82068114, "body": "Marked code example, copy &amp; paste to file, ran compiler, didn&#39;t compile (let alone reproduce the problem), lost interest, voted to close."}], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 3, "last_activity_date": 1511967174, "creation_date": 1511967174, "answer_id": 47555612, "question_id": 47555306, "link": "https://stackoverflow.com/questions/47555306/erroneous-array-reading-inside-a-thread/47555612#47555612", "title": "Erroneous array reading inside a thread", "body": "<p>Given </p>\n\n<pre><code>__m256 *array_1;\n__m256 *array_2;\n__m256 *array_3;\n#define ALIGNMENT 32\n#define SIMD_STEP 8\n\nvoid Init_arrays()\n{\n   int i;\n   posix_memalign((void**) &amp;array_1, ALIGNMENT, 32*sizeof(__m256));\n   posix_memalign((void**) &amp;array_2, ALIGNMENT, 4 *sizeof(__m256));\n   posix_memalign((void**) &amp;array_3, ALIGNMENT, 2 *sizeof(__m256));\n       .\n       .\n       .\n</code></pre>\n\n<p>This loop references array elements that are <strong><em>way</em></strong> out of range:</p>\n\n<pre><code>for (n = t_start; n &lt; t_stop; n += 8)\n{\n    .\n    .\n    .\n   T_fac1 = array_1[n];\n   T_fac2 = array_2[n];\n   T_fac3 = array_3[n];\n</code></pre>\n\n<p><code>array_3</code>  has all of <em>two</em> members: <code>2 *sizeof(__m256)</code> yet the index is incremented by <em>eight</em>?</p>\n"}], "owner": {"reputation": 451, "user_id": 6650397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fcc00075552f0fd192c2c13b4f6256b?s=128&d=identicon&r=PG&f=1", "display_name": "A.nechi", "link": "https://stackoverflow.com/users/6650397/a-nechi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 47555612, "answer_count": 1, "score": -1, "last_activity_date": 1511967174, "creation_date": 1511966232, "last_edit_date": 1511967117, "question_id": 47555306, "link": "https://stackoverflow.com/questions/47555306/erroneous-array-reading-inside-a-thread", "title": "Erroneous array reading inside a thread", "body": "<p>I Have a multi-threaded C program where I have 4 threads doing some arithmetic computations using some global arrays. here is example of the code.</p>\n\n<pre><code>__m256 *array_1;\n__m256 *array_2;\n__m256 *array_3;\n#define ALIGNMENT 32\n#define SIMD_STEP 8\n\nvoid Init_arrays()\n{\n   int i;\n   posix_memalign((void**) &amp;array_1, ALIGNMENT, 32*sizeof(__m256));\n   posix_memalign((void**) &amp;array_2, ALIGNMENT, 4 *sizeof(__m256));\n   posix_memalign((void**) &amp;array_3, ALIGNMENT, 2 *sizeof(__m256));\n\n   for(i=0;i &lt; 256; i+= SIMD_STEP)\n   {\n       // Filling array for the 1st stage\n   }\n   for(i=0;i &lt; 64; i+= SIMD_STEP)\n   {\n       // Filling array for the 2nd stage\n   }\n   for(i=0;i &lt; 16; i+= SIMD_STEP)\n   {\n       // Filling array for the 3rd stage\n   }\n}\n\nvoid *routine(void *thread_info)\n{\n  int n;\n  unsigned t_start,t_stop;\n  unsigned ind1, ind2, ind3;\n  float *arr_in , *arr_out;\n  struct thread_data *mydata;\n\n  mydata = (struct thread_data*) thread_info;\n  t_start = mydata-&gt;start;\n  t_stop  = mydata-&gt;stop;\n  arr_in  = mydata-&gt;input;\n  arr_out = mydata-&gt;output;\n\n  for (n = t_start; n &lt; t_stop; n += 8)\n  {  \n    ind1 = 256 + n;\n    ind2 = 512 + n;\n\n    vec_a = _mm256_load_ps((float *) (&amp;arr_in[n   ]) );\n    vec_b = _mm256_load_ps((float *) (&amp;arr_in[ind1]) );\n    vec_c = _mm256_load_ps((float *) (&amp;arr_in[ind2]) );\n\n    T_fac1 = array_1[n];\n    T_fac2 = array_2[n];\n    T_fac3 = array_3[n];\n    // print data 'printf()'\n\n    // further computations\n\n    _mm256_store_ps((float *) (&amp;arr_out[n   ]), (vec_a) );\n    _mm256_store_ps((float *) (&amp;arr_out[ind1]), (vec_b) );\n    _mm256_store_ps((float *) (&amp;arr_out[ind2]), (vec_c) );\n  }   \n  pthread_exit(NULL);\n}\n\nvoid foo(float* in,float* out)\n{\n  unsigned t,i=0;\n  for(t=0;t&lt;256;t+=64)\n  {\n     thread_data_array[i].start    = t;\n     thread_data_array[i].stop = t+QUARTER;\n     thread_data_array[i].input    = in;\n     thread_data_array[i].output   = out;\n     pthread_create(&amp;threads[i],NULL,routine,(void*)&amp;thread_data_array[i]);\n     i++;\n  }\n    for(i=0; i&lt;NUM_THREADS; i++)\n    {\n       int rc = pthread_join(threads[i], NULL);\n       if (rc)\n       {\n           fprintf(stderr, \"failed to join thread #%u - %s\\n\",i, strerror(rc));\n       }\n    }\n}\n\nint main()\n{\n  float *data1;\n  float *data2;\n\n  posix_memalign((void**)&amp;data1, 32, 1024 * sizeof(float));\n  posix_memalign((void**)&amp;data2, 32, 1024 * sizeof(float));\n\n  Load_inputs(reals,imags);//load data into the two arrays\n  Init_arrays();\n  // print data 'printf()'\n  foo(data1,data2);\n  return EXIT_SUCCESS;\n }\n</code></pre>\n\n<p>For some reason reading from the <code>array_1</code> for example doesnt work as it should be inside the thread, and I did not know the reason behind it. Here is display of the <code>array_1</code> as it should be  </p>\n\n<pre><code>     Display from the main                Display from the thread\nRE = 1.000000    IM = -0.000000     RE = 1.000000    IM = -0.000000 \nRE = 0.999981    IM = -0.006136     RE = 0.399624    IM = 0.671559 \nRE = 0.999925    IM = -0.012272     RE = 0.416430    IM = 0.634393 \nRE = 0.999831    IM = -0.018407     RE = 0.433094    IM = 0.595699 \nRE = 0.999699    IM = -0.024541     RE = 0.449612    IM = 0.555570 \nRE = 0.999529    IM = -0.030675     RE = 0.465977    IM = 0.514103 \nRE = 0.999322    IM = -0.036807     RE = 0.482184    IM = 0.471397 \nRE = 0.999078    IM = -0.042938     RE = 0.498228    IM = 0.427555 \nRE = 0.998795    IM = -0.049068     // the same \nRE = 0.998476    IM = -0.055195     // the same \nRE = 0.998118    IM = -0.061321     // the same \nRE = 0.997723    IM = -0.067444     // the same \nRE = 0.997290    IM = -0.073565     // the same \nRE = 0.996820    IM = -0.079682     // the same \nRE = 0.996313    IM = -0.085797     // the same \nRE = 0.995767    IM = -0.091909     // the same \n</code></pre>\n\n<p>Could somebody know what is the reason behind this erroneous results?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1511966027, "post_id": 47555212, "comment_id": 82067213, "body": "Possible? Definitely."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 4, "creation_date": 1511966173, "post_id": 47555212, "comment_id": 82067291, "body": "Yes, it&#39;s possible.  Does that answer your question?"}, {"owner": {"reputation": 759, "user_id": 6766146, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/W8JRX.png?s=128&g=1", "display_name": "Lalit Verma", "link": "https://stackoverflow.com/users/6766146/lalit-verma"}, "edited": false, "score": 0, "creation_date": 1511966245, "post_id": 47555212, "comment_id": 82067348, "body": "Add SUM in your question statement, its unclear and YES it is possible."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1511966518, "post_id": 47555212, "comment_id": 82067566, "body": "If the rows and columns fill the &quot;magic&quot; critera, wouldn&#39;t the diagonal always do this too?"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1511966751, "post_id": 47555212, "comment_id": 82067730, "body": "@Lundin: No: [1 2 3] [2 4 0] [3 0 3] - the rows and columns each sum to 6, but the diagonals are 8 and 10."}], "answers": [{"comments": [{"owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "edited": false, "score": 0, "creation_date": 1511971659, "post_id": 47555888, "comment_id": 82071477, "body": "There is no need for three separate loops, as the rows and columns can be handled within the same two nested loops (see my suggested code). The diagonals could be handled within those as well, but would require undesired if clauses. Furthermore, I doubt storing the sums will be faster than in place checking, not only because it does not allow for early returning."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1511971331, "last_edit_date": 1511971331, "creation_date": 1511968036, "answer_id": 47555888, "question_id": 47555212, "link": "https://stackoverflow.com/questions/47555212/check-if-my-matrix-is-magic-square/47555888#47555888", "title": "Check if my matrix is magic square", "body": "<p>Apparently you have to iterate through the matrix 3 times, with 3 separate loops. I see no way around this. </p>\n\n<p>The \"naive\" implementation:</p>\n\n<ul>\n<li>Sum the first row and store this result in a variable to henceforth use for comparisons.</li>\n<li>Sum the rest of the rows in a loop and compare against the variable. If any sums are unequal, return false from the function.</li>\n<li>Second loop, check the columns, compare against the same variable, if any unequal, return false.</li>\n<li>Third loops, check the diagonal, compare against the same variable, if any unequal, return false.</li>\n</ul>\n\n<p>This algorithm is however potentially ineffective because it is very branch-intensive. What you can do to manually optimize it is to reduce the number of branches.</p>\n\n<p>One possibly faster implementation:</p>\n\n<ul>\n<li>Sum all rows, store results in a result array. This is cache-friendly and will mean that the array ends up in data cache.</li>\n<li>Do the same with columns and diagonals. </li>\n<li><p>Make sure that your 3 sum arrays are allocated adjacently in memory by placing them in a struct. This is cache-friendly. Preferably something like this:</p>\n\n<pre><code>typedef union\n{\n  struct\n  {\n    unsigned int row_sum[3];\n    unsigned int col_sum[3];\n    unsigned int dia_sum[2];\n  };\n  unsigned int sum [3+3+2];\n} sum_t;  \n\n_Static_assert(sizeof(sum_t) == sizeof(unsigned int[3+3+2]), \n               \"Sorry, weird systems are not supported.\");\n</code></pre></li>\n<li><p>After done summing, go through the above <code>sum</code> array and compare every item against the first.</p></li>\n</ul>\n\n<p>This may or may not improve performance. You have to benchmark it on the specific system.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1511971541, "post_id": 47556090, "comment_id": 82071402, "body": "&quot;I want to do that as efficiently as possible&quot;. This code is very branch-intense. Showing everything into a single loop for the sake of it is a meta requirement, it fills no purpose by itself."}], "tags": [], "owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "is_accepted": true, "score": 0, "last_activity_date": 1511968611, "creation_date": 1511968611, "answer_id": 47556090, "question_id": 47555212, "link": "https://stackoverflow.com/questions/47555212/check-if-my-matrix-is-magic-square/47556090#47556090", "title": "Check if my matrix is magic square", "body": "<p>Doing everything within the nested <code>for</code> loops is an interesting problem.</p>\n\n<p>The only small challenge was to calculate the <em>columns</em> sums as well, since, the way the loops are written, it seems at first an <em>array[dimension]</em> would be necessary.</p>\n\n<p>However a small trick is of help. This line to get a row value </p>\n\n<pre><code>int rownum = *(mat + i * dimension + j);\n</code></pre>\n\n<p>Might also be used to get the col value, by inverting <code>i</code> and <code>j</code></p>\n\n<pre><code>int colnum = *(mat + j * dimension + i);\n</code></pre>\n\n<p>Allowing to sum the columns as well at the same place (a matrix being a square!)</p>\n\n<pre><code>void printmatrix(int *mat, int dimension) {\n\n    int i, j;\n    int magic=1;              // default to \"is magic\"\n    int d1=0,d2=0,refcount=0; // diag1, diag2\n\n    for (i = 0 ; i &lt; dimension; i++) {\n        int rowcount = 0;\n        int colcount = 0;\n        for (j = 0; j &lt; dimension; j++) {\n            int num = *(mat + i * dimension + j);\n            rowcount += num;                   // row sum \n            if (i == j) d1 += num;             // diag1 sum\n            if (i == dimension-j-1) d2 += num; // diag2 sum\n            // row to col ...\n            colcount += *(mat + j * dimension + i); // col sum\n        }\n        if (!i) refcount = rowcount;   // first rowcount is reference\n        else if (refcount != rowcount) magic = 0;\n        if (refcount != colcount) magic = 0;\n    }\n    if (d1 != refcount || d2 != refcount) magic = 0;\n    printf(\"Is Magic: %s\\n\", magic ? \"Yes\":\"No\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "is_accepted": false, "score": 0, "last_activity_date": 1511980650, "last_edit_date": 1511980650, "creation_date": 1511969983, "answer_id": 47556525, "question_id": 47555212, "link": "https://stackoverflow.com/questions/47555212/check-if-my-matrix-is-magic-square/47556525#47556525", "title": "Check if my matrix is magic square", "body": "<ol>\n<li><p>Your code is buggy, as you start with <code>ismagicsquaere = 0</code>. But even if you start with <code>ismagicsquaere = 1</code>, it is still buggy, because in the iteration <code>i = 0</code>, the variable <code>rowscount</code> remains zero, so that the following comparison will always lead to setting <code>ismagicsquaere = 0</code>, which is not what you want.</p></li>\n<li><p>If you are aiming at speed, you should whenever possible avoid any if clause within a loop, in particular within the inner loop.</p></li>\n<li><p>Since you have a printf in your inner loop, I wouldn't care about speed at all, as this I/O operation will by far dominate the runtime.</p></li>\n<li><p>If your aim really was a fast magic square check, you would have not only to remove the printf calls but return the function as soon as the first check fails.</p></li>\n</ol>\n\n<p>Here is my suggested code, including checks for the two diagonals. Since I assume that you need the printing to be included, I left the printf calls and did not add early returning:</p>\n\n<pre><code>void printmatrix(const int *mat, int dimension) {\n    int i, j;\n    int ismagicsquare = 1;\n    int diagonal1 = 0, diagonal2 = 0;\n\n    for (i = 0; i &lt; dimension; i++) {\n        diagonal1 += mat[i * dimension + i];\n        diagonal2 += mat[i * dimension + dimension - 1 - i];\n    }\n\n    if (diagonal1 != diagonal2) {\n        ismagicsquare = 0;\n    }\n\n    for (i = 0; i &lt; dimension; i++) {\n        int rowscount = 0;\n        int colscount = 0;\n\n        for (j = 0; j &lt; dimension; j++) {\n            rowscount += mat[i * dimension + j];\n            colscount += mat[j * dimension + i];\n\n            printf(\"%d\\t\", mat[i * dimension + j]);\n        }\n\n        if (rowscount != diagonal1 || colscount != diagonal1) {\n            ismagicsquare = 0;\n        }\n\n        printf(\"\\n\\n\");\n    }\n\n    printf(\"ismagicsquare = %i\\n\", ismagicsquare);\n}\n</code></pre>\n\n<p>Note that with regard to memory accesses and cache optimization, it should be fastest to do in place checking of the row sums as shown, but within the same two nested loops increment per-column sums and evaluate them at the end. This way the very cache-unfriendly memory access mat[j * dimension + i] would be completely removed. However, this kind of optimization only makes sense when designing a pure check function without printf calls.</p>\n"}, {"tags": [], "owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "is_accepted": false, "score": 0, "last_activity_date": 1512148150, "last_edit_date": 1512148150, "creation_date": 1511973194, "answer_id": 47557532, "question_id": 47555212, "link": "https://stackoverflow.com/questions/47555212/check-if-my-matrix-is-magic-square/47557532#47557532", "title": "Check if my matrix is magic square", "body": "<p>I've written the following code with the purpose to write (a day) a code that elaborates magic squares.</p>\n\n<p>It stores all rows, columns and diagonals sums into a matrix. The purpose of this matrix ( <code>sum[][]</code> ) shall be to understand where the magic square is not correct.</p>\n\n<p>The main calls the function <code>checkAndComputeSums()</code>that calculates all sums and returns 1 if the data into  the magic square are correct and 0 if are not correct.</p>\n\n<p>Here the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define DIMS 3\n#define COLS DIMS\n#define ROWS DIMS\n\nint checkAndComputeSums(int *s , int *ms, int dim);\n\nenum STYPE {\n    SUMROW,\n    SUMCOL,\n    SUMDIAG,\n\n    //-------------------\n\n    SUMCNT\n};\n\nint msqr[COLS][ROWS] = {\n    { 8,       1,       6},\n\n    { 3,       5,       7},\n\n    { 4,       9,       2}\n};\n\nint sum[DIMS][SUMCNT];\n\nconst char * label[SUMCNT] = {\n    \"ROWS\",\"COLS\",\"DIAG\"\n};\n\nint checkAndComputeSums(int *s , int *ms, int dim)\n{\n    int i,j,ok=1;\n\n    /* The sum are cleared */\n    for(i=0;i&lt;dim;i++) {\n        for(j=0;j&lt;SUMCNT;j++) {\n            s[i*SUMCNT+j] =0;\n        }\n    }\n\n    for(i=0;i&lt;dim;i++) {\n        for(j=0;j&lt;dim;j++) {\n            s[i*SUMCNT+SUMROW]+=ms[i*dim+j];\n            s[i*SUMCNT+SUMCOL]+=ms[j*dim+i];\n\n            if (i==j)\n                s[SUMDIAG]+=ms[i*dim+j];\n\n            if (i==dim - j - 1)\n                s[SUMDIAG+SUMCNT]+=ms[i*dim+j];\n\n        }\n\n        if (s[i*SUMCNT+SUMROW]!=s[SUMROW] || s[i*SUMCNT+SUMCOL]!=s[SUMROW])\n            ok=0;\n    }\n\n    if (s[SUMDIAG]!=s[SUMROW] || s[SUMDIAG+SUMCNT]!=s[SUMROW])\n        ok=0;\n\n    return ok;\n}\n\nint main(void)\n{\n    int i,j;\n\n    i=checkAndComputeSums(sum[0],msqr[0],DIMS);\n    printf(\"The check was %s\\n\",(!i)?\"KO\":\"OK\");\n\n    for (j=SUMROW;j&lt;SUMCNT;j++) {\n        printf(\"%s: \",label[j]);\n        for(i=0;i&lt;DIMS-((j==SUMDIAG)?1:0);i++) {\n            printf(\"%d \",sum[i][j]);\n        }\n        puts(\"\");\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 2976232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb92f5127953e1d8b4c65d50e8b64333?s=128&d=identicon&r=PG&f=1", "display_name": "user2976232", "link": "https://stackoverflow.com/users/2976232/user2976232"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1277, "favorite_count": 0, "accepted_answer_id": 47556090, "answer_count": 4, "score": 1, "last_activity_date": 1512148150, "creation_date": 1511965937, "last_edit_date": 1511966756, "question_id": 47555212, "link": "https://stackoverflow.com/questions/47555212/check-if-my-matrix-is-magic-square", "title": "Check if my matrix is magic square", "body": "<p>So I have this matrix:</p>\n\n<pre><code>8       1       6\n\n3       5       7\n\n4       9       2\n</code></pre>\n\n<p>And now I want to check if this is a \"magic square\". This means that the sums of all the rows, columns and oblique lines respectively, are equal (here with value of 15).</p>\n\n<p>So because I want to do that as efficiently as possible and I need to print my matrix first, I want to do all the values checks in the same function:</p>\n\n<pre><code>void printmatrix(int *mat, int dimension) {\n\n    int i, j, rowscount, colcount;\n    int firstvalue = 0; \n    int ismagicsquaere = 0;\n    for (i = 0; i &lt; dimension; i++)\n    {\n        rowscount = 0;\n        for (j = 0; j &lt; dimension; j++)\n        {\n            int num = *(mat + i * dimension + j);\n\n            if (i == 0)\n                firstvalue += num;\n            else\n                rowscount += num;\n\n            printf(\"%d\\t\", num);\n        }\n\n        if (rowscount != firstvalue)\n            ismagicsquaere = 0;\n\n        printf(\"\\n\\n\");\n    }\n</code></pre>\n\n<p>Currently my function checks only the rows value. I wonder if it is also possible to check the columns and the oblique lines?</p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "edited": false, "score": 1, "creation_date": 1511965776, "post_id": 47555072, "comment_id": 82067053, "body": "But what is the issue? Please elaborate more."}, {"owner": {"reputation": 2748, "user_id": 6165833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1b6bbdd7a7472d52c14da82af5eb6d20?s=128&d=identicon&r=PG&f=1", "display_name": "ymoreau", "link": "https://stackoverflow.com/users/6165833/ymoreau"}, "edited": false, "score": 0, "creation_date": 1511966198, "post_id": 47555072, "comment_id": 82067314, "body": "Btw, I hope you are not using actual data and names in your example, you should have anonymized samples to work on."}, {"owner": {"reputation": 93, "user_id": 8770655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-v4ynAoO7sDI/AAAAAAAAAAI/AAAAAAAAAFw/YAhtbaHF8uA/photo.jpg?sz=128", "display_name": "Addict", "link": "https://stackoverflow.com/users/8770655/addict"}, "edited": false, "score": 0, "creation_date": 1511968927, "post_id": 47555072, "comment_id": 82069465, "body": "Can you put some example of the problem your dealing with ? It&#39;s a bit hard to understand what you&#39;re meaning by &quot;it messes my entire array up&quot;"}], "owner": {"reputation": 11, "user_id": 9026146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed2dcbd5eed9b5a0df6f69f0908b5d7?s=128&d=identicon&r=PG&f=1", "display_name": "Sheiala", "link": "https://stackoverflow.com/users/9026146/sheiala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1511966110, "creation_date": 1511965544, "last_edit_date": 1511966110, "question_id": 47555072, "link": "https://stackoverflow.com/questions/47555072/sorting-of-names-in-an-array-of-structs", "title": "Sorting of names in an array of structs", "body": "<p>So I have a long list of bikers that I need to sort into an array of struct so it goes</p>\n\n<p>Race, First Name, Last Name, Age, Team, Nationality, placement and running time.</p>\n\n<p>So far I have managed to do that, but when I come to a guy that has two first names (In this problem Mads Wurst) it messes my entire array up, and no matter what I try it doesn't seem to fix it.</p>\n\n<p>The list of names look like this:</p>\n\n<p>ParisRoubaix               \"Mickael DELAGE\"                               32  FDJ   FRA      43      5:50:48 </p>\n\n<p>ParisRoubaix               \"Iljo KEISSE\"                                  35  QST   BEL      44      5:50:48 </p>\n\n<p>ParisRoubaix               \"Matthieu LADAGNOUS\"                           33  FDJ   FRA      45      5:50:48 </p>\n\n<p>ParisRoubaix               \"Mads Wurtz SCHMIDT\"                           23  KAT   DEN      46      5:50:48 </p>\n\n<p>ParisRoubaix               \"Dylan GROENEWEGEN\"                            24  TLJ   NED      47      5:50:48 </p>\n\n<p>ParisRoubaix               \"Reto HOLLENSTEIN\"                             32  KAT   SUI      48      5:50:48</p>\n\n<p>And my code looks like this:</p>\n\n<pre><code>int printAllRiders(void){\n  char full_data_array[RACE_DATA_SIZE];\n\n  race_results *each_race = malloc(sizeof(race_results)*RACE_DATA_SIZE);\n\n  FILE *inputp;\n  inputp = fopen(\"cykelloeb-2017.txt\", \"r\");\n\n  int i = 0;\n\n  if(inputp != NULL)\n  {\n   while(i&lt;50/*(temp_var = fgetc(inputp)) !=EOF*/)\n   {\n  fscanf(inputp, \" %s \\\"%[-A-z] %[ ABCDEFGHIJKLMNOPQRSTUVWXYZ'  ]\\\" %[0-9] %[A-Z] %[A-Z] %s %s\", \n    each_race[i].race, \n    each_race[i].name_first, \n    each_race[i].name_last, \n    each_race[i].age, \n    each_race[i].team, \n    each_race[i].nationality, \n    each_race[i].placement, \n    each_race[i].finishing_time);\n\n  printf(\"Race: %s\\n, first name: %s\\n, last name: %s\\n, age: %s\\n, team: %s\\n, nationality: %s\\n, placement: %s\\n, time: %s\\n\", \n    each_race[i].race, \n    each_race[i].name_first, \n    each_race[i].name_last, \n    each_race[i].age, \n    each_race[i].team, \n    each_race[i].nationality, \n    each_race[i].placement, \n    each_race[i].finishing_time);\n  i++;\n}\n } else {\nprintf(\"ERROR: Input file could not be opened\");\nexit(EXIT_FAILURE);\n }\n\nfclose(inputp);\nfull_data_array[i] = '\\0';\n  }\n</code></pre>\n"}, {"tags": ["c", "compilation", "fork", "pid"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1511965197, "post_id": 47554927, "comment_id": 82066648, "body": "What is the purpose of <code>pid_t = pid = fork();</code>? It&#39;s simply not valid C syntax."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1511965259, "post_id": 47554927, "comment_id": 82066692, "body": "What&#39;s worse, you <i>fixed</i> the error in the code you show here! You should always <i>copy-paste</i> the code, so you don&#39;t introduce other errors, or like in this case <i>fix</i> the error. Now this question is worthless since there is no problem."}, {"owner": {"reputation": 1, "user_id": 9026043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274b7a1d19483ae52ff959e1f7832c55?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/9026043/jonas"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1511965572, "post_id": 47554927, "comment_id": 82066916, "body": "im sorry i meant : pid_t pid = fork();"}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1511965718, "post_id": 47554927, "comment_id": 82067021, "body": "Check out <a href=\"http://man7.org/linux/man-pages/man3/strtol.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/strtol.3.html</a> and move your call to <code>strtol(...)</code> below the declaration of your local variables."}, {"owner": {"reputation": 1, "user_id": 9026043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274b7a1d19483ae52ff959e1f7832c55?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/9026043/jonas"}, "edited": false, "score": 0, "creation_date": 1511965733, "post_id": 47554927, "comment_id": 82067026, "body": "there is a problem. i used pid_t pid = fork(); in the code i compiled. i just mistyped it when i tried to explain the error."}, {"owner": {"reputation": 1, "user_id": 9026043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274b7a1d19483ae52ff959e1f7832c55?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/9026043/jonas"}, "edited": false, "score": 0, "creation_date": 1511965922, "post_id": 47554927, "comment_id": 82067138, "body": "which local variables? the variables in the child process or the parent process?"}, {"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1511966042, "post_id": 47554927, "comment_id": 82067222, "body": "You might have some weird character around that line. Delete lines 12~14, and rewrite the code, clean."}, {"owner": {"reputation": 1, "user_id": 9026043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274b7a1d19483ae52ff959e1f7832c55?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/9026043/jonas"}, "edited": false, "score": 0, "creation_date": 1511966245, "post_id": 47554927, "comment_id": 82067347, "body": "ah yeah it worked. thanks dude. ill remember that if something like this happens again."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1511966336, "post_id": 47554927, "comment_id": 82067416, "body": "The you seem to have an older compiler, that doesn&#39;t handle C99 (or later) where you could define variables anywhere. Pre-C99 you had to declare and define variables before any other statements in the current block."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1511966404, "post_id": 47554927, "comment_id": 82067474, "body": "Also, that should teach you to copy-paste the error as well. In full, complete, without modifications and as text."}], "answers": [{"tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1511966129, "creation_date": 1511966129, "answer_id": 47555277, "question_id": 47554927, "link": "https://stackoverflow.com/questions/47554927/my-pid-identifier-not-expected/47555277#47555277", "title": "My pid identifier not expected", "body": "<p>The compiler is telling you it didn't expect to encounter an identifier <code>pid_t</code> at that line since the previous line wasn't an identifier.  You need to declare your variables at the top of the scope, and put other code below that.  You could either do this </p>\n\n<pre><code>int main(int argc, char *argv, char *env)\n{       \n    long int val=strtoul(argv, NULL, 0);\n    pid_t pid = fork(); \n    ...\n</code></pre>\n\n<p>or</p>\n\n<pre><code>int main(int argc, char *argv, char *env)\n{       \n    pid_t pid = fork(); \n    strtoul(argv, NULL, 0);\n    ...\n</code></pre>\n\n<p>But you're missing the value returned from strtol</p>\n"}, {"comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 1, "creation_date": 1511967815, "post_id": 47555408, "comment_id": 82068637, "body": "Minor comment: in general, I&#39;d suggest using <code>-std=gnu99</code> Instead of <code>-std=c99</code> to get C99 features unless you specifically want to avoid GNU extensions. Up to GCC 4.x the default for C compilation is <code>-std=gnu90</code>. Starting with GCC 5.x the default is <code>-std=gnu11</code> (skipping over <code>gnu99</code> and going right to the C 2011 standard with GNU extensions)."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 2, "last_activity_date": 1511967884, "last_edit_date": 1511967884, "creation_date": 1511966579, "answer_id": 47555408, "question_id": 47554927, "link": "https://stackoverflow.com/questions/47554927/my-pid-identifier-not-expected/47555408#47555408", "title": "My pid identifier not expected", "body": "<p>Some old versions of compilers accept <a href=\"https://en.wikipedia.org/wiki/ANSI_C#C89\" rel=\"nofollow noreferrer\">C89</a> (not <a href=\"https://en.wikipedia.org/wiki/C99\" rel=\"nofollow noreferrer\">C99</a> or <a href=\"https://en.wikipedia.org/wiki/C11_(C_standard_revision)\" rel=\"nofollow noreferrer\">C11</a>) as the default C dialect. You want C99 (since you have <em>a declaration</em> after a statement) at least.</p>\n\n<p>If you use some old version of <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a> on some old Linux distribution, try compiling <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Invoking-GCC.html\" rel=\"nofollow noreferrer\">with</a> <code>gcc -std=gnu99 -Wall -Wextra -g</code> where <code>-std=gnu99</code> sets the C dialect (you could also use <code>-std=c99</code> or better), <code>-Wall -Wextra</code> asks for warnings, <code>-g</code> wants debug information (in <a href=\"https://en.wikipedia.org/wiki/DWARF\" rel=\"nofollow noreferrer\">DWARF</a>, for the <a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/\" rel=\"nofollow noreferrer\"><code>gdb</code> debugger</a>). Better yet, upgrade your GCC to a recent version (like <a href=\"https://gcc.gnu.org/gcc-7/\" rel=\"nofollow noreferrer\">GCC 7</a> in November 2017) whose default is C11 with <a href=\"https://gcc.gnu.org/onlinedocs/gcc/C-Extensions.html\" rel=\"nofollow noreferrer\">GNU extensions</a>.</p>\n\n<p>Or put the declaration</p>\n\n<pre><code>pid_t pid= 0;\n</code></pre>\n\n<p><sup>(I prefer to systematically initialize variables in C)</sup></p>\n\n<p><em>before</em> the statements </p>\n\n<pre><code> strtoul(argv, NULL, 0); //useless call, you need to store the result\n pid= fork(); \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1511967176, "post_id": 47555486, "comment_id": 82068093, "body": "Code only (or code mostly) questions are off-topic. IMHO, a code only answer is frowned upon. You should add several sentences of explanation (in English)"}], "tags": [], "owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "is_accepted": false, "score": 0, "last_activity_date": 1511968611, "last_edit_date": 1511968611, "creation_date": 1511966786, "answer_id": 47555486, "question_id": 47554927, "link": "https://stackoverflow.com/questions/47554927/my-pid-identifier-not-expected/47555486#47555486", "title": "My pid identifier not expected", "body": "<p>You can use make shorter prime finder loop by changing, <code>i &lt; num</code> to <code>i &lt; num/2</code>.</p>\n\n<p>This is one of standards for <code>main()</code> arguments: </p>\n\n<blockquote>\n  <p>(int argc, char **argv)  </p>\n</blockquote>\n\n<p>Turn on gcc flag: <code>-Wall</code> to see all warnings in code. </p>\n\n<p>As <a href=\"https://stackoverflow.com/users/1813336/cleblanc\">@cleblanc</a> said in one of answer, store return value of <code>strtoul()</code> to a varibale <code>long int val = strtoul(argv[1], NULL, 0);</code>.</p>\n\n<p>we pass number for check, from command line arguments, \n<code>argv[1]</code> refers to number when we run program with </p>\n\n<blockquote>\n  <p>./prime 15</p>\n</blockquote>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid checkprime(unsigned long num);\n\nint main(int argc, char **argv)\n{ \n\n    long int val = strtoul(argv[1], NULL, 0);\n\n    pid_t pid = fork(); \n\n    if(pid == 0){   \n        checkprime(val);\n    }\n    else if(pid &lt; 0){\n        perror(\"Fork Failed!\");\n    }\n    else{\n        int status = -1, result;\n        waitpid(pid, &amp;status, 0);\n        result = WEXITSTATUS(status);\n        if(result == 1){       \n            printf(\"Prime\\n\");\n        }\n        else if(status &lt; 0){\n            perror(\"Something Failed\");\n        }\n        else{ \n            printf(\"Not prime\\n\");\n        }\n    }\n    return 0;\n}\n\nvoid checkprime(unsigned long num)\n{\n    int i;\n    for(i = 2; i &lt; num/2; i++){\n        if(num % i == 0){\n            exit(0);\n        }\n    }\n    exit(1);\n}\n</code></pre>\n\n<blockquote>\n  <p>Compile, Run</p>\n</blockquote>\n\n<p><code>gcc -Wall prime.c -o prime</code></p>\n\n<p><code>./prime 15</code></p>\n"}], "owner": {"reputation": 1, "user_id": 9026043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274b7a1d19483ae52ff959e1f7832c55?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/9026043/jonas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1511968611, "creation_date": 1511965113, "last_edit_date": 1511967710, "question_id": 47554927, "link": "https://stackoverflow.com/questions/47554927/my-pid-identifier-not-expected", "title": "My pid identifier not expected", "body": "<p>So for school I got this exercise where I need to make a program that calculates if a number is a prime number or not. This program should make use of parent and child processes, and strtoul should be used to convert the argv to a unsigned long.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;sys/types.h&gt;\n#include&lt;sys/wait.h&gt;\n#include&lt;unistd.h&gt;\n\nvoid checkprime(unsigned long num);\n\nint main(int argc, char *argv, char *env)\n{       \nstrtoul(argv, NULL, 0);\n\npid_t pid = fork(); \n\nif(pid == 0)\n{\n    unsigned long number;\n\n    printf(\"\\nGive number to check: \\n\");\n    scanf(\"%lu\",&amp;number);\n\n    checkprime(number);\n}\nelse if(pid &lt; 0)\n{\n    perror(\"Fork Failed!\");\n}\nelse\n{\n    int status = -1, result;\n    waitpid(pid, &amp;status, 0);\n    result = WEXITSTATUS(status);\n\n    if(result == 1)\n    {       \n        printf(\"this is a prime number\\n\");\n    }\n    else if(status &lt; 0)\n    {\n        perror(\"Something Failed\");\n    }\n    else\n    { \n        printf(\"this is not a prime number\\n\");\n    }\n}\nreturn 0;\n}\n\nvoid checkprime(unsigned long num)\n{\nint i;\nfor(i = 2; i &lt; num; i++)\n{\n    if(num % i == 0)\n    {\n        exit(0);\n    }\n}\nexit(1);\n}\n</code></pre>\n\n<p>So when I try to compile this it says: line 13: identifier not expected. Error code 1.</p>\n\n<p>The code on line 13 says: pid_t pid = fork();</p>\n\n<p>Now my question is: Why do i get that error?</p>\n\n<p>Its fixed, thanks everyone for the help. I appreciate it.</p>\n"}, {"tags": ["c", "windows", "pointers", "64-bit"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 3, "creation_date": 1511963975, "post_id": 47554514, "comment_id": 82065821, "body": "Nothing in your code above deals with pointer sizes."}, {"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 1, "creation_date": 1511964040, "post_id": 47554514, "comment_id": 82065861, "body": "Incidentally 256 + 44 = 300"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1511964319, "post_id": 47554514, "comment_id": 82066048, "body": "The size of a pointer is not the same as the size of what it points <b>to</b>. Here <code>char *ptr</code> says that <code>*ptr</code> is a <code>char</code>. The result is complicated by the fact that it really is not pointing to a <code>char</code>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1511965385, "post_id": 47554514, "comment_id": 82066782, "body": "In your example, your pointers not only have the same size, but they have the same value.  But when dereferenced, one of them loads a single byte while the other loads an integer.  Why is that confusing?  <code>sizeof(ptr)</code> is the pointer size.  <code>sizeof(*ptr)</code> is the size of the data type it points to."}, {"owner": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "edited": false, "score": 0, "creation_date": 1511965512, "post_id": 47554514, "comment_id": 82066875, "body": "<code>Why is that confusing? </code> I missed the fact that during dereferencing data type comes into picture"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 1, "creation_date": 1511971033, "post_id": 47554514, "comment_id": 82071059, "body": "<code>warning: initialization from incompatible pointer type [-Wincompatible-pointer-types]      char *ptr = &amp;a; </code>"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "is_accepted": false, "score": 1, "last_activity_date": 1511964300, "creation_date": 1511964300, "answer_id": 47554667, "question_id": 47554514, "link": "https://stackoverflow.com/questions/47554514/confusion-regarding-pointer-size/47554667#47554667", "title": "Confusion regarding pointer size", "body": "<p>Indeed, on a little endian architecture, the LSB would appear first in memory, thus to store 300, memory looks like</p>\n\n<pre><code>44 , 1 , 0 , 0  (for a size 4 int)\n</code></pre>\n\n<p>The</p>\n\n<pre><code>printf(\"%d\\n %d\\n\", *ptr, *intptr);\n</code></pre>\n\n<p>doesn't print the pointer sizes (which are likely the same), it prints the <em>dereferenced</em> pointers, values of one byte, a char, then the int value.</p>\n\n<p>To print the pointer sizes</p>\n\n<pre><code>printf (\"%zu\\n%zu\\n\", sizeof(ptr), sizeof(intptr));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511968679, "post_id": 47554675, "comment_id": 82069286, "body": "All that  is left is to print the size of <code>char, int</code>."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1511965078, "last_edit_date": 1511965078, "creation_date": 1511964325, "answer_id": 47554675, "question_id": 47554514, "link": "https://stackoverflow.com/questions/47554514/confusion-regarding-pointer-size/47554675#47554675", "title": "Confusion regarding pointer size", "body": "<p>In this statement</p>\n\n<pre><code>printf(\"%d\\n %d\\n\", *ptr, *intptr);\n</code></pre>\n\n<p>there are outputted not the pointers themselves but the data they point to.</p>\n\n<p>For example <code>300</code> can be represented like <code>256 + 44</code>. So <code>44</code> can be stored in one byte while 256 can be stored in another byte.  And this expression <code>*ptr</code> gives the value 44 stored in the byte pointed to by the pointer <code>ptr</code>.</p>\n\n<p>On the other hand the pointer <code>intptr</code> points to the whole object of the type <code>int</code> and the expression <code>*intptr</code>  gives the value 300.</p>\n\n<p>If you want to output the addresses stored in the pointers you should write</p>\n\n<pre><code>printf(\"%p\\n %p\\n\", ( void * )ptr, ( void * )intptr);\n</code></pre>\n\n<p>To output sizes of the pointers you could write</p>\n\n<pre><code>printf(\"%zu\\n %zu\\n\", sizeof( ptr ), sizeof( intptr ));\n</code></pre>\n\n<p>Take into account that according to the C Standard the function main without parameters shall be declared like</p>\n\n<pre><code>int main( void )\n</code></pre>\n\n<p>Also in this declaration you should use an explicit casting</p>\n\n<pre><code>char *ptr = ( char * )&amp;a;\n</code></pre>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    int a = 300;\n    char *ptr = ( char * )&amp;a;\n    int *intptr = &amp;a;\n\n    printf( \"*ptr = %d, *intptr = %d\\n\", *ptr, *intptr );\n    printf( \"ptr = %p, intptr = %p\\n\", ( void * )ptr, ( void * )intptr );\n    printf( \"sizeof( ptr ) = %zu, sizeof( intptr ) = %zu\\n\", \n        sizeof( ptr ), sizeof( intptr ) );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output might look like</p>\n\n<pre><code>*ptr = 44, *intptr = 300\nptr = 0x7ffe5972613c, intptr = 0x7ffe5972613c\nsizeof( ptr ) = 8, sizeof( intptr ) = 8\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1511964667, "post_id": 47554691, "comment_id": 82066289, "body": "Accessing an object through a character pointer is defined in C."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1511964771, "post_id": 47554691, "comment_id": 82066366, "body": "The OP doesn&#39;t <i>cast</i> anywhere, cast != conversion. Which is why their code <code>char* ptr = &amp;a</code> is not valid C. That being said, using character pointers to other types do <i>not</i> invoke UB, there&#39;s an explicit exception from the strict aliasing rule. Basically half of this answer is completely incorrect."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1511965465, "post_id": 47554691, "comment_id": 82066838, "body": "The first sentence of this answer is false. Any pointer to an object may be converted to a character type and access the bytes of the object through the character type. As Lundin points out, the assignment <code>char *ptr = &amp;a</code> is not strictly conforming C, but <code>char *ptr = (char *) &amp;a</code> fixes that."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1511965682, "post_id": 47554691, "comment_id": 82066991, "body": "&quot;You introduce undefined behaviour if you cast a pointer to an object to a different type than that of the object AND access it then through this pointer.&quot; is just plain wrong for character types. You can access anything from a character pointer, but you cannot do the opposite, ie access a chunk of characters through another pointer type. See the FAQ <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">What is the strict aliasing rule?</a>."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 2, "last_activity_date": 1511964696, "last_edit_date": 1511964696, "creation_date": 1511964375, "answer_id": 47554691, "question_id": 47554514, "link": "https://stackoverflow.com/questions/47554514/confusion-regarding-pointer-size/47554691#47554691", "title": "Confusion regarding pointer size", "body": "<p>You introduce undefined behaviour if you cast a pointer to an object to a different type than that of the object AND access it then through this pointer.</p>\n\n<p>Statement <code>int a = 300</code> introduces an object of type <code>int</code>, <code>char* ptr = &amp;a</code> introduces a pointer to an object of type <code>char</code> but let it point to an object of type <code>int</code>. This per se is not a problem, but dereferencing this pointer then through <code>*ptr</code> is undefined behaviour. And this does not have something to do with the <code>printf</code> - a statement like <code>char x = *ptr</code> would be UB, too. However, a statement like <code>int x = *((int *)ptr)</code> would be OK, as the ptr is casted back to the original type of the object it points to.</p>\n\n<p>Concerning the sizes of pointers: The size of a pointer (i.e. the value necessary for storing a memory address to which the pointer points to) is fixed size; it's usually 4 bytes on a 32 bit system and 8 bytes on a 64 bit system. The size necessary for representing a memory address has nothing to do with the size of the object that resides at the respecite memory address to which the pointer points to.</p>\n\n<p>The following example demonstrates this behaviour:</p>\n\n<pre><code>int main() {\n\n    int a = 300;\n    void *ptr = &amp;a;\n    int *intptr = &amp;a;\n\n    printf(\"%d %d\\n\", *((int*)ptr), *intptr);   \n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>300 300\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 2, "creation_date": 1511964742, "post_id": 47554721, "comment_id": 82066337, "body": "@babon: And cast them to <code>void *</code> or <code>const void *</code>."}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1511964793, "post_id": 47554721, "comment_id": 82066385, "body": "@EricPostpischil Absolutely :)"}, {"owner": {"reputation": 282, "user_id": 9015013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f3d083e8707051e81ed4e7a3830a418?s=128&d=identicon&r=PG&f=1", "display_name": "Karol T.", "link": "https://stackoverflow.com/users/9015013/karol-t"}, "edited": false, "score": 0, "creation_date": 1511964877, "post_id": 47554721, "comment_id": 82066447, "body": "Yes, I agree. The code above in fact wasn&#39;t intended to print real flat address, but only show that it is the same value, regardless pointer type ;)"}], "tags": [], "owner": {"reputation": 282, "user_id": 9015013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f3d083e8707051e81ed4e7a3830a418?s=128&d=identicon&r=PG&f=1", "display_name": "Karol T.", "link": "https://stackoverflow.com/users/9015013/karol-t"}, "is_accepted": false, "score": -1, "last_activity_date": 1511964794, "last_edit_date": 1511964794, "creation_date": 1511964490, "answer_id": 47554721, "question_id": 47554514, "link": "https://stackoverflow.com/questions/47554514/confusion-regarding-pointer-size/47554721#47554721", "title": "Confusion regarding pointer size", "body": "<p>no, no, no</p>\n\n<blockquote>\n  <p>As per my understanding,why dereferencing *ptr prints 44 is due to the fact that char pointer is one byte and so it reads only 8 bits from the address of int...</p>\n</blockquote>\n\n<p>char is one byte, not char pointer. If you want to print pointer you should</p>\n\n<pre><code>printf(\"%p\\n %p\\n\", ptr, intptr);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1511964820, "post_id": 47554780, "comment_id": 82066409, "body": "In C, a pointer to any object may be converted to a pointer to a character type and back."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1511965127, "post_id": 47554780, "comment_id": 82066600, "body": "@EricPostpischil Not implicitly, it would violate the constraints of simple assignment, since the pointers are not compatible. C11 6.5.16.1: <code>the left operand has atomic, qualified, or unqualified pointer type, and (considering the type the left operand would have after lvalue conversion) both operands are pointers to qualified or unqualified versions of compatible types, and the type pointed to by the left has all the qualifiers of the type pointed to by the right;</code>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1511965639, "post_id": 47554780, "comment_id": 82066961, "body": "Printing a <code>char</code> value with <code>%d</code> is fine due to integer promotion. (Unless you are using a bizarre C implementation where <code>int</code> and <code>char</code> have been distorted to be the same size, as has been discussed elsewhere on Stack Overflow.) I do not think it is best to hammer the OP with C violations first rather than helping them understand what they have observed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1511965933, "post_id": 47554780, "comment_id": 82067147, "body": "@EricPostpischil For a normal VA function, yes then the default argument promotion apply. But the (dysfunctional) printf family of functions explicitly labels it UB, C11 7.21.6.1/9 <code>If a conversion specification is invalid, the behavior is undefined. If any argument is not the correct type for the corresponding conversion specification, the behavior is undefined.</code>. As for hammering the OP, they are obviously compiling their code with some random crap they found in a packet of corn flakes. We need to point out that they need to use a compliant compiler instead of a broken one."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1511967072, "post_id": 47554780, "comment_id": 82068004, "body": "I think that is an excessive interpretation. For example, 6.5.2.2 4 says \u201ceach parameter is assigned the value of the corresponding argument.\u201d So \u201cvalue of the corresponding argument\u201d here must mean the value of the argument after the promotions and conversions specified in this clause, as assigning the value before those would not be sensible (or always possible). Yet they did not write \u201cvalue of the corresponding argument after the promotions and conversions specified in this clause.\u201d So the standard may use \u201carguments\u201d to mean the arguments after promotion and conversion."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1511969011, "post_id": 47554780, "comment_id": 82069539, "body": "And they do not have to be first. The way things are said to a person affects how they interpret them. Explaining first, and giving them a model by which they can understand the behavior, is a better introduction to what you have to say than saying they are doing things wrong. They have indicated what information they want by asking a question, so give them that information first, when possible."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 5, "last_activity_date": 1511965196, "last_edit_date": 1511965196, "creation_date": 1511964666, "answer_id": 47554780, "question_id": 47554514, "link": "https://stackoverflow.com/questions/47554514/confusion-regarding-pointer-size/47554780#47554780", "title": "Confusion regarding pointer size", "body": "<p>First of all, your code is not valid C and it also invokes undefined behavior, so anything can happen. If your compiler didn't show you any diagnostic messages, you need to uninstall it and get a working one instead. You have the following bugs:</p>\n\n<ul>\n<li><code>void main()</code> will only work on freestanding implementations that specifically allow this form of main. </li>\n<li><code>char *ptr = &amp;a;</code> is not a valid form of assignment in C. The pointers are not compatible<sup>(1)</sup>.</li>\n<li>Printing a character with the <code>%d</code> format specifier invokes undefined behavior.</li>\n</ul>\n\n<p>After fixing these bugs, we get:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n  int a = 300;\n  char *ptr = (char*)&amp;a;\n  int *intptr = &amp;a;\n\n  printf(\"%d\\n %d\\n\", (int)*ptr, *intptr);\n}\n</code></pre>\n\n<p>None of this prints the size of a pointer. You print the contents of the first byte in the <code>int a</code>, which you translate to a <code>char</code>, which may or may not be signed and possibly give an incorrect result (this part is endianess-dependent). And then you print the contents of the whole <code>int a</code>.</p>\n\n<p>What you seem to want is to print the size of the pointers themselves:</p>\n\n<pre><code>printf(\"%zu %zu\\n\", sizeof ptr, sizeof intptr);\n</code></pre>\n\n<hr>\n\n<p><sup>(1)</sup> C11 6.5.16.1 emphasis mine:</p>\n\n<blockquote>\n  <p><strong>Constraints</strong><br>\n  One of the following shall hold:<br>\n  /--/<br>\n  - the <strong>left operand has</strong> atomic, qualified, or unqualified <strong>pointer type, and</strong> (considering\n  the type the left operand would have after lvalue conversion) <strong>both operands are\n  pointers to</strong> qualified or unqualified versions of <strong>compatible types</strong>, and the type pointed\n  to by the left has all the qualifiers of the type pointed to by the right;</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "edited": false, "score": 0, "creation_date": 1511964850, "post_id": 47554781, "comment_id": 82066428, "body": "Thanks,so pointer irrespective of its data type might be of same size ,but when dereferencing,it depends on data type..Am i correct"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "edited": false, "score": 2, "creation_date": 1511965125, "post_id": 47554781, "comment_id": 82066598, "body": "@TheGameiswar Not necessarily 8 bytes (not 8 bits).  It could be 4 bytes if you&#39;re on a 32-bit system.  The standard doesn&#39;t guarantee that all pointers are the same size, but in practice they tend to be.  But yes, the main difference is when the pointer is dereferenced.  The number of bytes read/written depend on the type."}, {"owner": {"reputation": 1345, "user_id": 4554967, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3e7affacfbfa560a3f2ca86204fb5b84?s=128&d=identicon&r=PG&f=1", "display_name": "zappy", "link": "https://stackoverflow.com/users/4554967/zappy"}, "edited": false, "score": 0, "creation_date": 1512023194, "post_id": 47554781, "comment_id": 82091835, "body": "@dbush Great Answer, But your picture representation of memory of variable &#39;a&#39; is little confusing to noobs like me."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 5, "last_activity_date": 1511964851, "last_edit_date": 1511964851, "creation_date": 1511964667, "answer_id": 47554781, "question_id": 47554514, "link": "https://stackoverflow.com/questions/47554514/confusion-regarding-pointer-size/47554781#47554781", "title": "Confusion regarding pointer size", "body": "<p>Object pointers (e.g. pointers to anything besides a function) are typically the same size on most systems you're likely to come across, however there's no guarantee of that.  That being said, even though the <em>pointers</em> may be the same size, the <em>types</em> that they point to are not.</p>\n\n<p>For example, on a 64-bit Windows system, pointers are typically 8 bytes in size.  In your example you have <code>char *</code> and an <code>int *</code> which are most likely both 8 bytes.  The difference here is that dereferencing a <code>char *</code> will read/write 1 byte while dereferenceing an <code>int *</code> will read/write 4 bytes (assuming an <code>int</code> is 32 bit).</p>\n\n<p>Assuming little endian byte ordering, <code>a</code> looks like this in memory:</p>\n\n<pre><code>  ------------------\na | 44 | 1 | 0 | 0 |\n  ------------------\n</code></pre>\n\n<p>Both <code>ptr</code> and <code>intptr</code> contain the address of <code>a</code>.  When dereferencing <code>ptr</code>, which is of type <code>char *</code>, it only looks at the first byte.  In contrast, when dereferencing <code>intptr</code>, which is of type <code>int *</code>, it looks at all 4 bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "is_accepted": false, "score": 0, "last_activity_date": 1511979260, "last_edit_date": 1511979260, "creation_date": 1511978924, "answer_id": 47559119, "question_id": 47554514, "link": "https://stackoverflow.com/questions/47554514/confusion-regarding-pointer-size/47559119#47559119", "title": "Confusion regarding pointer size", "body": "<p><strong><em>Code</em></strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nunsigned int\ntrans(unsigned char c){\n  if ('0' &lt;=c &amp;&amp; c &lt;= '9') return c - '0';\n  if ('A' &lt;=c &amp;&amp; c &lt;= 'F') return c - 'A' + 0x0A;\n  if ('a' &lt;=c &amp;&amp; c &lt;= 'f') return c - 'a' + 0x0A;\n  return 0;\n}\n\nuint16_t\nhex_to_uint16(const char* s) {\n  char *p = (char*) s;\n  uint16_t v = 0;\n  while (*p) {\n    if (p &gt; s) v = v &lt;&lt; 4;\n    v += trans(*p);\n    p++;\n  }\n  return v;\n}\n\nint main (void)\n{\n\n  int n = 1;\n    // little endian if true\n    if(*(char *)&amp;n == 1) {printf(\"little\\n\");}\n\n  int a = 300;\n  char *ptr =  (char*)&amp;a;\n  int *intptr = &amp;a;\n\n    printf(\"charSize:%zu intSize:%zu\\n\", sizeof (char), sizeof (int));\n    printf(\"PcharSize:%zu PintSize:%zu\\n\", sizeof (ptr), sizeof (intptr));\n\n\n  //printf(\"Hex: %x, Decimal: %d\\n\", 0x2c, (int)0x2c ); \n\n  //printf(\"int: %d\\n\", hex_to_uint16(\"2c\"));\n    //printf(\"300H: %x\\n\", (a));\n\n\n    printf(\"PcharAddr: %p\\nPintAddr: %p\\n\", ptr, intptr);\n\n\n  printf(\"int: %d\\n\", *intptr);\n\n\n  printf(\"LSB  |     |     |  MSB|\\n\");\n  printf(\"  0  |  1  |  2  |  3  |\\n\");\n  printf(\"------------------------\\n\");\n  printf(\"Dec\\n\");\n  printf(\" %d     %d     %d     %d\\n\", *(ptr), *(ptr+1), *(ptr+2), *(ptr+3));\n  printf(\"Hex\\n\");\n  printf(\" %x     %x     %x     %x\\n\", *(ptr), *(ptr+1), *(ptr+2), *(ptr+3));\n\n\n\n    printf(\"To Big Endian:\\n%.2x%x%x%x\\n\", (uint8_t)*(ptr+3), (uint8_t)*(ptr+2), (uint8_t)*(ptr+1), (uint8_t)*(ptr));\n\n  ///https://stackoverflow.com/questions/19275955/convert-little-endian-to-big-endian\n    /*\n     * chux aswer\n    uint32_t num = 300;\n    uint8_t b[4];\n\n    b[0] = (uint8_t) (num &gt;&gt;  0u);\n    b[1] = (uint8_t) (num &gt;&gt;  8u);\n    b[2] = (uint8_t) (num &gt;&gt; 16u);\n    b[3] = (uint8_t) (num &gt;&gt; 24u);\n\n  printf(\"%x%x%x%x\\n\", b[3], b[2], b[1], b[0]);\n\n  */\n\n    return 0;\n}\n</code></pre>\n\n<p><strong><em>Compile, Run</em></strong></p>\n\n<pre><code>gcc -Wall -Wextra te.c -o te &amp;&amp; ./te\n</code></pre>\n"}], "owner": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 1, "accepted_answer_id": 47554781, "answer_count": 7, "score": -1, "last_activity_date": 1511979260, "creation_date": 1511963825, "last_edit_date": 1511964317, "question_id": 47554514, "link": "https://stackoverflow.com/questions/47554514/confusion-regarding-pointer-size", "title": "Confusion regarding pointer size", "body": "<p>This may be a noob question ..but this is really confusing me..</p>\n\n<p>Below is some sample code </p>\n\n<pre><code>void main() {\n\n    int a = 300;\n    char *ptr = &amp;a;\n    int *intptr = &amp;a;\n\n    printf(\"%d\\n %d\\n\", *ptr, *intptr);\n\n}\n</code></pre>\n\n<p><strong>output:</strong><br>\n44<br>\n300</p>\n\n<p>As per my understanding,why dereferencing <code>*ptr</code> prints 44 is due to the fact that char pointer is one byte and so it reads only 8 bits from the address  of int...</p>\n\n<p>But this <a href=\"https://stackoverflow.com/questions/6751749/what-is-the-size-of-a-pointer\">question:What is the size of a pointer?</a> states <code>Regardless of what data type they are pointing to, they have fixed size</code></p>\n\n<p>Am i missing some thing.Why dereferencing char pointer prints 44,if pointer size is same ?</p>\n"}, {"tags": ["python", "c", "python-3.x", "python-3.6"], "comments": [{"owner": {"reputation": 1467, "user_id": 5090081, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0c684449acc79d93475dc04526e28b6b?s=128&d=identicon&r=PG&f=1", "display_name": "bendl", "link": "https://stackoverflow.com/users/5090081/bendl"}, "edited": false, "score": 1, "creation_date": 1511963779, "post_id": 47554439, "comment_id": 82065678, "body": "You&#39;re using two different compilers, correct? So I&#39;m guessing that one is better at creating efficient executables in this one instance"}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1511963801, "post_id": 47554439, "comment_id": 82065693, "body": "<i>executing a C function inside of Python to be 2x faster than just executing the C code from a C main</i> &lt;--- are you sure, how do you benchmarking the speed here, I&#39;m curious to know what made you to come in conclusion that executing  C function in Python is faster?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 6, "creation_date": 1511963888, "post_id": 47554439, "comment_id": 82065758, "body": "In most of these cases, the answer is incorrect benchmarking."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1511964278, "post_id": 47554439, "comment_id": 82066024, "body": "<code>int* a = (int*)malloc(sizeof(int)*1024);</code> -- This number of entries (to me) is a tiny amount to be used for meaningful benchmark tests."}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 7, "last_activity_date": 1511969392, "last_edit_date": 1511969392, "creation_date": 1511963933, "answer_id": 47554543, "question_id": 47554439, "link": "https://stackoverflow.com/questions/47554439/running-c-extension-in-python-faster-than-plain-c/47554543#47554543", "title": "Running C extension in Python faster than plain C", "body": "<p>85 microseconds is too small a delay to be measured reliably and repeatedly. For example, <a href=\"https://en.wikipedia.org/wiki/CPU_cache\" rel=\"nofollow noreferrer\">CPU cache</a> effects (or <a href=\"https://en.wikipedia.org/wiki/Context_switch\" rel=\"nofollow noreferrer\">context switches</a>, or <a href=\"https://en.wikipedia.org/wiki/Paging\" rel=\"nofollow noreferrer\">paging</a>) may dominate the computation time (and alter it to make that timing meaningless).</p>\n\n<p><sup>(I guess you are on Linux/x86-64)</sup></p>\n\n<p>As a rule of thumb, try to have a run lasting about half a second at least, and repeat the benchmarking a few times. You could also use <a href=\"http://man7.org/linux/man-pages/man1/time.1.html\" rel=\"nofollow noreferrer\">time(1)</a> for measurements.</p>\n\n<p>See also <a href=\"http://man7.org/linux/man-pages/man7/time.7.html\" rel=\"nofollow noreferrer\">time(7)</a>. There are <em>several</em> notions of time (elapsed \"real\" time, monotonic time, process cpu time, thread cpu time, etc...). You could consider using <a href=\"http://man7.org/linux/man-pages/man3/clock.3.html\" rel=\"nofollow noreferrer\">clock(3)</a> or <a href=\"http://man7.org/linux/man-pages/man2/clock_gettime.2.html\" rel=\"nofollow noreferrer\">clock_gettime(2)</a> to measure time.</p>\n\n<p>BTW, you might compile with a more recent version of <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a> (in November 2017, <a href=\"https://gcc.gnu.org/gcc-7/\" rel=\"nofollow noreferrer\">GCC7</a> and in a few weeks GCC8) and you want to compile with <code>gcc -march=native -O3</code> for benchmarking purposes. Try also other <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html\" rel=\"nofollow noreferrer\">optimization options</a> and tuning. You could also try another compiler, e.g. <a href=\"http://clang.llvm.org/\" rel=\"nofollow noreferrer\">Clang/LLVM</a>.</p>\n\n<p>Look also at <a href=\"https://stackoverflow.com/a/47528068/841108\">this</a> answer (regarding parallelization) to a relevant question. Probably the <a href=\"http://www.numpy.org/\" rel=\"nofollow noreferrer\">numpy</a> package is using (internally) similar techniques (outside of the <a href=\"https://wiki.python.org/moin/GlobalInterpreterLock\" rel=\"nofollow noreferrer\">Python GIL</a>), so could be faster than your naive sequential matrix multiplication code in C.</p>\n"}], "owner": {"reputation": 31, "user_id": 9025888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac105a332d7f1ca9f0d2557581f097f8?s=128&d=identicon&r=PG&f=1", "display_name": "samis13", "link": "https://stackoverflow.com/users/9025888/samis13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1511969392, "creation_date": 1511963558, "last_edit_date": 1511968632, "question_id": 47554439, "link": "https://stackoverflow.com/questions/47554439/running-c-extension-in-python-faster-than-plain-c", "title": "Running C extension in Python faster than plain C", "body": "<p>I have implemented a Python extension in C and found that executing a C function inside of Python to be 2x faster than just executing the C code from a C main.</p>\n\n<p>But why is this faster? I would expect the plain C to be exactly the same performance when called from Python as it is when called from C.</p>\n\n<p>Here is my experiment:</p>\n\n<ul>\n<li>Plain C compute code (simple 3for matrix-matrix multiplication)</li>\n<li>Plain C main function that calls the <strong>mmult()</strong> function</li>\n<li>Python extension wrapper to call the <strong>mmult()</strong> function</li>\n<li>All timing is happening entirely within the C code</li>\n</ul>\n\n<p><strong><em>Here are my results:</em></strong></p>\n\n<p>Pure C - 85us</p>\n\n<p>Python Extension - 36us</p>\n\n<hr>\n\n<p>Heres my code:</p>\n\n<hr>\n\n<p>--mmult.cpp----------</p>\n\n<pre><code>#include \"mmult.h\"\n\nvoid mmult(int32_t a[1024],int32_t b[1024],int32_t c[1024]) {\n\n  struct timeval t1, t2;\n  gettimeofday(&amp;t1, NULL);\n\n  for(int i=0; i&lt;32; i=i+1) {\n    for(int j=0; j&lt;32; j=j+1) {\n        int32_t result=0;\n         for(int k=0; k&lt;32; k=k+1) {\n           result+=a[i*32+k]*b[k*32+j];\n         }\n         c[i*32+j] = result;\n      }\n  }\n\n  gettimeofday(&amp;t2, NULL);\n\n  double elapsedTime = (t2.tv_usec - t1.tv_usec) + (t2.tv_sec - t1.tv_sec)*1000000;\n  printf(\"elapsed time: %fus\\n\",elapsedTime);\n\n}\n</code></pre>\n\n<p>--mmult.h-------</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nvoid mmult(int32_t a[1024],int32_t b[1024],int32_t c[1024]);\n</code></pre>\n\n<p>--main.cpp------</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/time.h&gt;\n#include \"mmult.h\"\n\nint main() {\n  int* a = (int*)malloc(sizeof(int)*1024);\n  int* b = (int*)malloc(sizeof(int)*1024);\n  int* c = (int*)malloc(sizeof(int)*1024);\n\n  for(int i=0; i&lt;1024; i++) {\n    a[i]=i+1;\n    b[i]=i+1;\n    c[i]=0;\n  }\n\n  struct timeval t1, t2;\n  gettimeofday(&amp;t1, NULL);\n  mmult(a,b,c);\n  gettimeofday(&amp;t2, NULL);\n\n  double elapsedTime = (t2.tv_usec - t1.tv_usec) + (t2.tv_sec - t1.tv_sec)*1000000;\n  printf(\"elapsed time: %fus\\n\",elapsedTime);\n  free(a);\n  free(b);\n  free(c);\n\n  return 0;\n}\n</code></pre>\n\n<p>Heres how I compile main:</p>\n\n<pre><code>gcc -o main main.cpp mmult.cpp -O3\n</code></pre>\n\n<hr>\n\n<p>--wrapper.cpp-----</p>\n\n<pre><code>#include &lt;Python.h&gt;\n#include &lt;numpy/arrayobject.h&gt;\n#include \"mmult.h\"\n\nstatic PyObject* mmult_wrapper(PyObject* self, PyObject* args) {\n   int32_t* a;\n   PyArrayObject* a_obj = NULL;\n   int32_t* b;\n   PyArrayObject* b_obj = NULL;\n   int32_t* c;\n   PyArrayObject* c_obj = NULL;\n\n   int res = PyArg_ParseTuple(args, \"OOO\", &amp;a_obj, &amp;b_obj, &amp;c_obj);\n\n   if (!res)\n      return NULL;\n\n   a = (int32_t*) PyArray_DATA(a_obj);\n   b = (int32_t*) PyArray_DATA(b_obj);\n   c = (int32_t*) PyArray_DATA(c_obj);\n\n   /* call function */\n   mmult(a,b,c);\n\n   Py_RETURN_NONE;\n}\n\n/*  define functions in module */\nstatic PyMethodDef TheMethods[] = {\n   {\"mmult_wrapper\", mmult_wrapper, METH_VARARGS, \"your c function\"},\n   {NULL, NULL, 0, NULL}\n};\n\nstatic struct PyModuleDef cModPyDem = {\n   PyModuleDef_HEAD_INIT,\n   \"mmult\", \"Some documentation\",\n   -1,\n   TheMethods\n};\n\nPyMODINIT_FUNC\nPyInit_c_module(void) {\n   PyObject* retval = PyModule_Create(&amp;cModPyDem);\n   import_array();\n   return retval;\n}\n</code></pre>\n\n<p>--setup.py-----</p>\n\n<pre><code>import os\nimport numpy\nfrom distutils.core import setup, Extension\ncur = os.path.dirname(os.path.realpath(__file__))\nc_module = Extension(\"c_module\", sources=[\"wrapper.cpp\",\"mmult.cpp\"],include_dirs=[cur,numpy.get_include()])\nsetup(ext_modules=[c_module])\n</code></pre>\n\n<p>--code.py-----</p>\n\n<pre><code>import c_module\nimport time\nimport numpy as np\nif __name__ == \"__main__\":\n    a = np.ndarray((32,32),dtype='int32',buffer=np.linspace(1,1024,1024,dtype='int32').reshape(32,32))\n    b = np.ndarray((32,32),dtype='int32',buffer=np.linspace(1,1024,1024,dtype='int32').reshape(32,32))\n    c = np.ndarray((32,32),dtype='int32',buffer=np.zeros((32,32),dtype='int32'))\n\n    c_module.mmult_wrapper(a,b,c)\n</code></pre>\n\n<p>Heres how I compile the Python extension:</p>\n\n<pre><code>python3.6 setup_sw.py build_ext --inplace\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Ive updated the mmult.cpp code to run the 3for for 1,000,000 iterations internally. This resulted in very similar times:</p>\n\n<p>Pure C - 27us</p>\n\n<p>Python Extension - 27us</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1511975833, "post_id": 47554388, "comment_id": 82074113, "body": "<code>(LPCWSTR)thewebsite</code> This cast is suspicious. What is the declaration for <code>thewebsite</code> and <code>thesubdirectory</code>? Is it <code>char</code> or <code>std::string</code> etc. ?"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1511980146, "post_id": 47554388, "comment_id": 82076530, "body": "That error means the website doesn&#39;t support secure connection. Did the target website lose its secure connection? Try accessing the site with <code>INTERNET_DEFAULT_HTTP_PORT</code> and replace <code>WINHTTP_FLAG_SECURE</code> with zero. By the way, WinINet is much easier if you just want to read a website."}, {"owner": {"reputation": 7909, "user_id": 169774, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef760e2a9a24b58476207635c21730f9?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/169774/mick"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1511980857, "post_id": 47554388, "comment_id": 82076872, "body": "@Barmack: if I do that then later when I call WinHttpReceiveResponse(hrequest, NULL) it returns a non-zero value and getlasterror is 12175 again."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1511981800, "post_id": 47554388, "comment_id": 82077317, "body": "I think you are using the wrong flags. How do you access the site through a web browser? <code>&quot;http:&#47;&#47;www.thewebsite.com&quot;</code> or <code>&quot;https:&#47;&#47;www.thewebsite.com&quot;</code>"}, {"owner": {"reputation": 7909, "user_id": 169774, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef760e2a9a24b58476207635c21730f9?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/169774/mick"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1511982046, "post_id": 47554388, "comment_id": 82077448, "body": "the latter - the &quot;https&quot;"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1511984086, "post_id": 47554388, "comment_id": 82078577, "body": "I tried your code on Win7, it works with <code>char thewebsite = &quot;stackoverflow.com&quot;</code> and <code>char_thesubdirectory = &quot;questions&quot;;</code> using secure connect the way you have listed in the question."}, {"owner": {"reputation": 7909, "user_id": 169774, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef760e2a9a24b58476207635c21730f9?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/169774/mick"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1511984999, "post_id": 47554388, "comment_id": 82079032, "body": "@Barmak: I would expect the code to work... maybe this is pointing towards a coincidence of some subtle change in the website?... or a strange interaction with my ISP?"}], "answers": [{"comments": [{"owner": {"reputation": 7909, "user_id": 169774, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef760e2a9a24b58476207635c21730f9?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/169774/mick"}, "edited": false, "score": 0, "creation_date": 1512039388, "post_id": 47560841, "comment_id": 82100456, "body": "I had to make a few small tweaks to get it to compile - perhaps because my character set is set to &quot;use multi-byte character set&quot; ... but anyway, it is now working without errors. BTW I think you can use both WinINet and WinHTTP in the same program so long as you don&#39;t include Winhttp.h and WinINet.h in the same source file. Thank you very much for your help."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 7909, "user_id": 169774, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef760e2a9a24b58476207635c21730f9?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/169774/mick"}, "edited": false, "score": 0, "creation_date": 1512046614, "post_id": 47560841, "comment_id": 82104772, "body": "I forgot WinHTTP is Unicode only, that explains the conversions you were making. WinInet functions have ANSI version which can accept <code>char*</code> input."}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 2, "last_activity_date": 1512046991, "last_edit_date": 1512046991, "creation_date": 1511985723, "answer_id": 47560841, "question_id": 47554388, "link": "https://stackoverflow.com/questions/47554388/winhttpsendrequest-fails-with-error-winhttp-secure-failure/47560841#47560841", "title": "WinHttpSendRequest fails with ERROR_WINHTTP_SECURE_FAILURE", "body": "<p>This is a long comment not an answer!</p>\n\n<p>WinINet is much easier, you can use WinINet library if you don't need WinHTTP server capabilities. However you cannot use both WinINet and WinHTTP.</p>\n\n<p>When declaring strings, it's best to start with UTF-16 strings <code>wchar_t *str = L\"str\"</code>. Sometimes your source string is in UTF-8, in that case you can use <code>MultiByteToWideChar(CP_UTF8...)</code> to convert to UTF-16.</p>\n\n<p>WinINet example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;Windows.h&gt;\n#include &lt;WinINet.h&gt;\n\n#pragma comment(lib, \"WinINet.lib\")\n\nint main()\n{\n    const wchar_t* url = L\"https://stackoverflow.com/questions\";\n    std::ofstream fout(L\"c:\\\\test\\\\test.htm\");\n    HINTERNET hopen = InternetOpen(L\"MyAppName\",\n        INTERNET_OPEN_TYPE_PRECONFIG, NULL, NULL, 0);\n    if(hopen)\n    {\n        DWORD flags = INTERNET_FLAG_DONT_CACHE;\n        if(wcsstr(url, L\"https://\") == url)\n            flags |= INTERNET_FLAG_SECURE;\n        HINTERNET hinternet = InternetOpenUrl(hopen, url, NULL, 0, flags, 0);\n        if(hinternet)\n        {\n            char buf[1024];\n            DWORD received = 0;\n            while(InternetReadFile(hinternet, buf, sizeof(buf), &amp;received))\n            {\n                if(!received) break;\n                fout.write(buf, received);\n            }\n            std::cout &lt;&lt; \"success!\\n\";\n            InternetCloseHandle(hinternet);\n        }\n        InternetCloseHandle(hopen);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 7909, "user_id": 169774, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef760e2a9a24b58476207635c21730f9?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/169774/mick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2276, "favorite_count": 0, "accepted_answer_id": 47560841, "answer_count": 1, "score": 2, "last_activity_date": 1512046991, "creation_date": 1511963393, "last_edit_date": 1511979418, "question_id": 47554388, "link": "https://stackoverflow.com/questions/47554388/winhttpsendrequest-fails-with-error-winhttp-secure-failure", "title": "WinHttpSendRequest fails with ERROR_WINHTTP_SECURE_FAILURE", "body": "<p>Programmatically communicating with the web is not my area of expertise but I managed to make a read_web_page() function by cutting and pasting code from examples found online and the code has been working without error on a daily basis for many months.</p>\n\n<p>It just so happened that my main windows-10 PC at work broke down and while waiting for it to be repaired and I am now forced to run the (the same) code from a windows-7 PC at home.</p>\n\n<p>But now I have a error appear that I never saw before. I call the following code (simplified):</p>\n\n<pre><code>    // code to handle bad return values from the following three functions ommitted...\n\n    HINTERNET hsession = WinHttpOpen(0,WINHTTP_ACCESS_TYPE_DEFAULT_PROXY, WINHTTP_NO_PROXY_NAME,WINHTTP_NO_PROXY_BYPASS, 0);\n\n    HINTERNET hconnect = WinHttpConnect(hsession, (LPCWSTR)thewebsite, INTERNET_DEFAULT_HTTPS_PORT , 0);\n\n    HINTERNET hrequest = WinHttpOpenRequest(hconnect, L\"GET\", (LPCWSTR)thesubdirectory, NULL, WINHTTP_NO_REFERER, WINHTTP_DEFAULT_ACCEPT_TYPES, WINHTTP_FLAG_SECURE);\n\n    if (!WinHttpSendRequest(hrequest, WINHTTP_NO_ADDITIONAL_HEADERS, 0, WINHTTP_NO_REQUEST_DATA, 0, 0, 0))\n    {\n        int err = GetLastError();\n</code></pre>\n\n<p>Normally WinHttpSendRequest returns zero but now returns a non-zero value and GetLastError() returns a value of 12175 (equal to ERROR_WINHTTP_SECURE_FAILURE).</p>\n\n<p>The (https) URL I am connecting to has been the same all along and when I type it into my browser, the site still appears as normal.</p>\n\n<p>Maybe the whole change of PC and location is a coincidence and the problem is caused by an under-the-hood change in the website I am reading (it is not under my control)... but I have no idea how to begin diagnosing (or fixing) the fault. Could it be something to do with my ISP?</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384110%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">documentation for WinHttpSendRequest</a> says that more detailed information can be found for this error by setting up a callback function but the documentation describing how this is done is incomprehensible to me and I can not find any example code anywhere.</p>\n\n<p><strong>EDIT:</strong> To address Barmak's concerns about thewebsite and thesubdirectory, the code that creates them is here below:</p>\n\n<pre><code>char *char_thewebsite = \"www.thewebsite.com\";\nchar *char_thesubdirectory = \"sub\";\n\nint n_website = MultiByteToWideChar(CP_ACP, 0, char_thewebsite, -1, NULL, 0);\nint n_subdir = MultiByteToWideChar(CP_ACP, 0, char_thesubdirectory, -1, NULL, 0);\n\nthewebsite = new WCHAR[n_website];\nthesubdirectory = new WCHAR[n_subdir];\n\nMultiByteToWideChar(CP_ACP, 0, char_thewebsite, -1, (LPWSTR)thewebsite, n_website);\nMultiByteToWideChar(CP_ACP, 0, char_thesubdirectory, -1, (LPWSTR)thesubdirectory, n_subdir);\n</code></pre>\n"}, {"tags": ["c", "arrays", "multidimensional-array"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 2, "creation_date": 1511963163, "post_id": 47554261, "comment_id": 82065272, "body": "If it works, you got lucky. To get what you really want: add col=col-&#39;a&#39; and row=row-&#39;1&#39; inside the loop so the indices are normalized."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1511963174, "post_id": 47554261, "comment_id": 82065282, "body": "<i>So this has actually worked for a while.</i>  Only for extremely loose definitions of &quot;worked&quot;."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1511963215, "post_id": 47554261, "comment_id": 82065314, "body": "@nicomp <i>To get what you really want: add col=col-&#39;a&#39;</i> Until it&#39;s run with a non-ASCII character set..."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1511963223, "post_id": 47554261, "comment_id": 82065319, "body": "Because it&#39;s undefined behavior. It&#39;s the silent killer of C programs."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1511963518, "post_id": 47554261, "comment_id": 82065524, "body": "Beware: <b>1.</b> <code>&#39;1&#39;</code> is not the same as <code>1</code>. <b>2.</b> array indexes start at 0, not at 1"}, {"owner": {"reputation": 360, "user_id": 4350660, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/823224762/picture?type=large", "display_name": "Benjamin Larsen", "link": "https://stackoverflow.com/users/4350660/benjamin-larsen"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1511963535, "post_id": 47554261, "comment_id": 82065531, "body": "I wont be using non-ASCII chars, so I think @nicomp proposal is pretty good."}], "answers": [{"comments": [{"owner": {"reputation": 360, "user_id": 4350660, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/823224762/picture?type=large", "display_name": "Benjamin Larsen", "link": "https://stackoverflow.com/users/4350660/benjamin-larsen"}, "edited": false, "score": 0, "creation_date": 1511963481, "post_id": 47554336, "comment_id": 82065494, "body": "Thank you. That&#39;s actually the first time I&#39;ve had undefined behaviour actually working for this long - the code has been running for half a year. Good explanation!"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 360, "user_id": 4350660, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/823224762/picture?type=large", "display_name": "Benjamin Larsen", "link": "https://stackoverflow.com/users/4350660/benjamin-larsen"}, "edited": false, "score": 4, "creation_date": 1511963619, "post_id": 47554336, "comment_id": 82065577, "body": "@BenjaminLarsen be aware that &quot;undefined behaviour&quot; includes &quot;apparently working fine&quot;."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 4, "last_activity_date": 1511963220, "creation_date": 1511963220, "answer_id": 47554336, "question_id": 47554261, "link": "https://stackoverflow.com/questions/47554261/access-array-with-chars-in-c/47554336#47554336", "title": "Access array with chars in C", "body": "<p>Yes, you have major undefined behavior. You can't index like that, it makes no sense since you only have room for 8x8 elements and the integer value of characters is often larger than 0..7 which is your index space in each dimension.</p>\n\n<p>It worked because the behavior of undefined behavior code is undefined, and \"working as expected (for some value of expected)\" is certainly part of the space of all that is undefined. As is anything else you can come up, basically. :)</p>\n\n<p>In practice, it probably worked because memory allocation was sufficiently granular to make the major out-of-bounds accesses not fall anywhere you couldn't write. Perhaps you mangled <code>malloc()</code>'s book-keeping, but didn't notice because you never called <code>free()</code>, or <code>malloc()</code> again, or whatever.</p>\n"}], "owner": {"reputation": 360, "user_id": 4350660, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/823224762/picture?type=large", "display_name": "Benjamin Larsen", "link": "https://stackoverflow.com/users/4350660/benjamin-larsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 47554336, "answer_count": 1, "score": 1, "last_activity_date": 1511963220, "creation_date": 1511962953, "question_id": 47554261, "link": "https://stackoverflow.com/questions/47554261/access-array-with-chars-in-c", "title": "Access array with chars in C", "body": "<p>For a while I've had this struct:</p>\n\n<pre><code>struct coordinates{\n    struct coord coord_board[8][8];\n};\n</code></pre>\n\n<p>And I've initialized it with</p>\n\n<pre><code>coordBoard = malloc(sizeof(struct coordinates));\nfor (col = 'a'; col &lt;= 'h'; col++) {\n        for (row = '1'; row &lt;= '8'; row++) {\n            initializeCoord(col, row);\n        }\n}\n\nvoid  initializeCoord(char col, char row) {\n    coordBoard-&gt;coord_board[col][row].Iter = 0;\n    coordBoard-&gt;coord_board[col][row].occupant = NULL;\n}\n</code></pre>\n\n<p>So this has actually worked for a while. I could even access them using chars too:</p>\n\n<pre><code>void printCoordBoard() {\n    char col, row;\n    printf(\"\\n\");\n    for (col = 'a'; col &lt;= 'h'; col++) {\n        for (row = '1'; row &lt;= '8'; row++) {\n            struct coord l = board-&gt;coordBoard-&gt;coord_board[col][row];\n            printf(\"%c \", l.occupant == NULL ? ' ' : l.occupant-&gt;type);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>And this has also worked. But now it doesn't - And I have no idea what I've done to make it fail. Though when I think about it, it makes sense. It's been a while since I've used C, but I remember that all arrays are accessed using an integer - right? I initialize them as <code>array[8][8]</code>. So when I access it using e.g. 'a', I'd actually access location 97 (decimal value of char a), right? And then of course I'd have memory corruption. </p>\n\n<p>My question is then: Why did it work? And even more weird - if I change the array to a [7][7], it works again... I'm getting confused. Another question is - would there be a way in C to use chars to access the data, with having to initialize an array of the highest char (in this case 'h', which would crate a 104x104 array)?</p>\n\n<p>I hope someone can enlighen me!</p>\n\n<p>Have a great day.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 385, "user_id": 5497626, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s56Me3yuiM0/AAAAAAAAAAI/AAAAAAAAABs/JJwaDcFp2iQ/photo.jpg?sz=128", "display_name": "vbRocks", "link": "https://stackoverflow.com/users/5497626/vbrocks"}, "edited": false, "score": 0, "creation_date": 1511963471, "post_id": 47554158, "comment_id": 82065486, "body": "possible duplicate - <a href=\"https://stackoverflow.com/questions/16620779/printing-tokenized-data-from-file-in-c\" title=\"printing tokenized data from file in c\">stackoverflow.com/questions/16620779/&hellip;</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1511963688, "post_id": 47554158, "comment_id": 82065616, "body": "Possibly, but I suggest using more delimiter characters than just a space. Perhaps add <code>&#39;\\t&#39;</code> in case the data is tabbed, and <code>&#39;\\n&#39;</code> to clean off the trailing newline from <code>fgets</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1511967794, "post_id": 47554649, "comment_id": 82068618, "body": "Beautify code indents, use meaningful variable: <code>FILE *fp;</code>(file pointer), initialize all variables"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1511970444, "post_id": 47554649, "comment_id": 82070634, "body": "Compiling with <code>gcc -Wall -Wextra te.c -o te te.c: In function \u2018main\u2019: te.c:18:42: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]     while((read=getline(&amp;line, &amp;len, fp)) != -1){ </code>"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1511970537, "post_id": 47554649, "comment_id": 82070703, "body": "Change <code>size_t read = 0;</code> to <code>ssize_t read = 0;</code>, see <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">example</a>, comparison between unsigned/singed integer not good"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1511970661, "post_id": 47554649, "comment_id": 82070793, "body": "C standard <a href=\"https://stackoverflow.com/questions/204476/what-should-main-return-in-c-and-c\">main()</a> return type, arguments"}], "tags": [], "owner": {"reputation": 628, "user_id": 8939165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0gchW.jpg?s=128&g=1", "display_name": "Fabio_MO", "link": "https://stackoverflow.com/users/8939165/fabio-mo"}, "is_accepted": false, "score": 1, "last_activity_date": 1511970019, "last_edit_date": 1511970019, "creation_date": 1511964256, "answer_id": 47554649, "question_id": 47554158, "link": "https://stackoverflow.com/questions/47554158/reading-from-file-in-c-including-char-and-integer/47554649#47554649", "title": "Reading from file in C including char and integer", "body": "<p>Here is a simple code that do the job.</p>\n\n<p>First put your text inside a <code>test.txt</code> file, save it in C source code path.</p>\n\n<blockquote>\n  <p>test.txt</p>\n</blockquote>\n\n<pre><code>A17ke4004       44         66      84\nA17ke4005       33         62      88\nA17ke4008       44         66      86\n</code></pre>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n\n        FILE *fp = NULL;\n        char *line = NULL;\n        size_t len = 0;\n        size_t read = 0;\n        char string[10][32];\n        int a[10], b[10], c[10];\n        int count = 0;\n\n        fp = fopen(\"test.txt\", \"r\");\n\n        if(fp != NULL){\n            while((read = getline(&amp;line, &amp;len, fp)) != -1){\n                sscanf(line, \"%s%d%d%d\", string[count], &amp;a[count], &amp;b[count], &amp;c[count]);\n                printf(\"&lt;%s&gt; - &lt;%d&gt; - &lt;%d&gt; - &lt;%d&gt;\\n\", string[count], a[count], b[count], c[count]);\n                count++;\n            }\n        }else{\n                printf(\"File can't open\\n\");\n        }\n\n        return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>Compile, Run</p>\n</blockquote>\n\n<p><code>gcc -Wall  -Wextra te.c -o te</code></p>\n\n<p><code>./te</code></p>\n\n<p>If you have more than 10 lines you should increase the arrays dimension.\nHope this help you.</p>\n"}], "owner": {"reputation": 1, "user_id": 9025929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9f5501fb58d50fb5c78aedfc1a388e?s=128&d=identicon&r=PG", "display_name": "user9025929", "link": "https://stackoverflow.com/users/9025929/user9025929"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1511970019, "creation_date": 1511962589, "last_edit_date": 1511963798, "question_id": 47554158, "link": "https://stackoverflow.com/questions/47554158/reading-from-file-in-c-including-char-and-integer", "title": "Reading from file in C including char and integer", "body": "<p>How to read and store each column in the following text from a file into an array </p>\n\n<pre><code>A17ke4004       44         66      84\nA17ke4005       33         62      88\nA17ke4008       44         66      86\n</code></pre>\n\n<p>The first column should be string and the rest should be integer </p>\n"}, {"tags": ["c", "arm", "signature", "u-boot", "squashfs"], "answers": [{"tags": [], "owner": {"reputation": 1688, "user_id": 6046607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57f8c429dafb009c1c3e8795117bf942?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Rini", "link": "https://stackoverflow.com/users/6046607/tom-rini"}, "is_accepted": true, "score": 1, "last_activity_date": 1511983070, "creation_date": 1511983070, "answer_id": 47560182, "question_id": 47553986, "link": "https://stackoverflow.com/questions/47553986/signature-for-squashfs-to-check-in-u-boot/47560182#47560182", "title": "Signature for squashfs to check in u-boot", "body": "<p>A solution to this would be to leverage the <a href=\"http://git.denx.de/?p=u-boot.git;a=blob;f=doc/uImage.FIT/verified-boot.txt;h=41c9fa9e09f97d047f980a31fcdbad5cd74d0db2;hb=HEAD\" rel=\"nofollow noreferrer\">verified boot</a> functionality of FIT images, and have your squashfs be contained with the FIT image, along with the kernel and device tree files.  Then you can ensure they have the signatures that you want before booting, and also disable support for booting unsigned images.</p>\n"}], "owner": {"reputation": 13, "user_id": 8648649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8534623703068c35e5a6a31be69c163f?s=128&d=identicon&r=PG&f=1", "display_name": "GalaxyHero", "link": "https://stackoverflow.com/users/8648649/galaxyhero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 47560182, "answer_count": 1, "score": 1, "last_activity_date": 1511983070, "creation_date": 1511962068, "question_id": 47553986, "link": "https://stackoverflow.com/questions/47553986/signature-for-squashfs-to-check-in-u-boot", "title": "Signature for squashfs to check in u-boot", "body": "<p>I have board with arm-proccessor, that uses u-boot to load firmwares. I load firmware as Squashfs, but I want to make sure, that no one would be able to load their own firmwares, so I want to some how sign my squashfs file and check its signature in u-boot. \nAre there any standart ways to do it? Does squashfs supports signatures \"out-of-box\"? Or can I add my signature to the end of squshfs-file? </p>\n"}, {"tags": ["c", "eeprom"], "comments": [{"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 2, "creation_date": 1511960904, "post_id": 47553589, "comment_id": 82063745, "body": "Can you please format your code better, and suppress the many unnecessary CRs"}, {"owner": {"reputation": 3249, "user_id": 7147233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94f37773a80589840319d063ee51ab16?s=128&d=identicon&r=PG&f=1", "display_name": "WhatsThePoint", "link": "https://stackoverflow.com/users/7147233/whatsthepoint"}, "edited": false, "score": 0, "creation_date": 1511961025, "post_id": 47553589, "comment_id": 82063826, "body": "yes like Ring says please format your code properly"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1511962121, "post_id": 47553589, "comment_id": 82064535, "body": "Formatting does not only concern the code but the question as a whole. Please learn how to format a question. It&#39;s easy, but it requires a minimal effort."}, {"owner": {"reputation": 4924, "user_id": 2862719, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yzhk5.png?s=128&g=1", "display_name": "m00am", "link": "https://stackoverflow.com/users/2862719/m00am"}, "edited": false, "score": 0, "creation_date": 1511963751, "post_id": 47553589, "comment_id": 82065656, "body": "Welcome to SO. I took the liberty to format your code a little more so that it can be read more easily. I also rephrased your question so that is is easier to read."}, {"owner": {"reputation": 1, "user_id": 9025741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f4b6b2db404d385abb9e47b4798906?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/9025741/ahmed"}, "edited": false, "score": 0, "creation_date": 1511984432, "post_id": 47553589, "comment_id": 82078761, "body": "Thank You m00am, i am sorry for the messy and unformatted code since I am not much of a coder. So I would like to know what could be done to solve the problem"}], "owner": {"reputation": 1, "user_id": 9025741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f4b6b2db404d385abb9e47b4798906?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/9025741/ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511963751, "creation_date": 1511960747, "last_edit_date": 1511963751, "question_id": 47553589, "link": "https://stackoverflow.com/questions/47553589/writing-and-reading-data-to-eeprom-24lc32a", "title": "Writing and reading data to EEPROM 24LC32A", "body": "<p>I have been trying to write a byte to the EEPROM 23LC32A through I2C protocol. I am using uvision 5 Keil to code my program.</p>\n\n<p>When I run my code in the Termite.exe terminal window, the output seems to indicate that read function is executing. It returns 255, which is the default value of a cleared EEPROM. So the thing is that the writing of the data is not taking place.</p>\n\n<p>I have configured and coded the control registers correctly as per the datasheet. What could have possibly gone wrong? And also please do help with me page writing of EEPROM too. Here is my code below:</p>\n\n<pre><code>void write8eeprom(uint8_t addr, uint8_t reghigh, uint8_t reglow, uint8_t value) \n{\n    uint8_t  bytes [3];\n    bytes[0] = reghigh;\n    bytes[1] = reglow;\n    bytes[2] = value;\n    bool success = twi_master_transfer(addr, (uint8_t*) &amp;bytes, sizeof(bytes), TWI_ISSUE_STOP);\n}\n\nuint8_t read8(uint8_t addr, uint8_t reg)\n{\n    uint8_t value;\n    uint8_t  bytes [1];\n    bytes[0] =  reg;\n    uint8_t regValue[1] ;\n\n    twi_master_transfer(addr, (uint8_t*) &amp;bytes, sizeof(bytes), TWI_DONT_ISSUE_STOP);\n    twi_master_transfer(addr|TWI_READ_BIT, (uint8_t*) &amp;regValue, sizeof(regValue), TWI_ISSUE_STOP);\n\n    value = regValue[0] ;\n    return value;\n}\n\n\nvoid  eeprom_write()\n{\n    uint8_t value;\n    value = 1;\n    write8eeprom(160, 0x1000, 0x0001, value);\n    printf(\"Data %d is written\\n\", value);\n}\n\n\nvoid eeprom_read()\n{\n    uint8_t value;\n    value = read8(160, 0x00000001);\n    printf(\"The data %d is read\\n\", value);\n}\n\n\nint main(void)\n{\n    nrf_drv_clock_lfclk_request();\n    timers_init();\n    application_timers_start();\n    nrf_delay_ms(2000);\n    uart_config();\n    gpio_config();\n    bool tt= twi_master_init    (   )   ;\n    nrf_delay_ms(2000);\n    printf(\"\\n\\r I2C  \\n\\r\");\n    eeprom_write();\n    nrf_delay_ms(1000);\n    eeprom_read();\n\n    for(;;)\n    {\n        __WFE();\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "macos"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1511959444, "post_id": 47553151, "comment_id": 82062873, "body": "You have the <code>if</code> condition backward: <code>sigaction</code> returns a nonzero value on <i>failure</i>.  That should be <code>if (sigaction(SIGBUS, &amp;act, &amp;oldact)) { &#47;* report error *&#47; }</code>."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 3, "creation_date": 1511959517, "post_id": 47553151, "comment_id": 82062923, "body": "Also, we don&#39;t know which errno numbers correspond to which actual error conditions on your system.  Never print raw errno numbers.  Your <code>printf</code> should read <code>printf(&quot;[-] failed to install handler for SIGBUS: %s\\n&quot;, strerror(errno));</code> to get a meaningful error message.  (<code>strerror</code> is declared in <code>string.h</code>.)"}, {"owner": {"reputation": 456, "user_id": 3719263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/eYlZV.jpg?s=128&g=1", "display_name": "stylo", "link": "https://stackoverflow.com/users/3719263/stylo"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1511960526, "post_id": 47553151, "comment_id": 82063542, "body": "Oh crap, I didn&#39;t even notice that. Thanks A lot!! :)"}], "owner": {"reputation": 456, "user_id": 3719263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/eYlZV.jpg?s=128&g=1", "display_name": "stylo", "link": "https://stackoverflow.com/users/3719263/stylo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511959286, "creation_date": 1511959286, "question_id": 47553151, "link": "https://stackoverflow.com/questions/47553151/signal-handling-sigaction-return-errno-2", "title": "Signal handling, sigaction return errno 2", "body": "<p>any idea why sigaction will set errno 2?</p>\n\n<p>this is my code</p>\n\n<pre><code>struct sigaction act;\nstruct sigaction oldact;\n\nact.sa_sigaction = my_handler;\nact.sa_flags = SA_RESTART | SA_SIGINFO | SA_64REGSET;\n\nsigfillset(&amp;sa.sa_mask);\n\nif (sigaction(SIGBUS, &amp;act, &amp;oldact) != -1) {\n    printf(\"[-] failed to install signal handler, %d\", errno);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1511958395, "post_id": 47552778, "comment_id": 82062145, "body": "&quot;So, the 2 int have not passed correctly into the struct.&quot; NO! They haven&#39;t. You are ignoring padding of your struct and by accident get what you expect. Also you pass wrong type to <code>printf</code>."}, {"owner": {"reputation": 342, "user_id": 5782525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87dd54738224a530aff348939d243be8?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Pierru", "link": "https://stackoverflow.com/users/5782525/alexis-pierru"}, "edited": false, "score": 7, "creation_date": 1511958457, "post_id": 47552778, "comment_id": 82062189, "body": "You&#39;re experiencing alignment issues. to get the offset of a strucure member, you should use <code>offsetof</code> (<code>&lt;stddef.h&gt;</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 5, "last_activity_date": 1511958989, "last_edit_date": 1511958989, "creation_date": 1511958570, "answer_id": 47552923, "question_id": 47552778, "link": "https://stackoverflow.com/questions/47552778/passing-data-in-struct-with-memcpy/47552923#47552923", "title": "Passing data in struct with memcpy", "body": "<p><code>memset</code> is not designed for setting values of objects other than arrays of characters or bytes. <code>memset</code> fills every byte of the destination with the same value. When you use <code>memset(destination, 24, sizeof(int))</code>, you are filling each byte with the value 24. Those combined bytes make a very larger integer value.</p>\n\n<p>Although you fill the <code>age</code> field with a large integer, you do not see it in your <code>printf</code> because you pass the value to <code>printf</code> using <code>*(Person_data)</code>. Since <code>Person_data</code> is a pointer to <code>char</code>, this expression only fetches one character from the object, so it only gets one of the bytes containing <code>24</code>. In contrast, when you use <code>Person1-&gt;age</code>, <code>age</code> is an <code>int</code>, so the entire <code>int</code> is fetched.</p>\n\n<p>Additionally, you should not assume you can simply add the sizes of objects in a structure to get the addresses of the members. Most hardware architectures have alignment requirements for data, meaning that objects of more than one byte must start at memory addresses that are multiples of their size or of values such as two, four, or eight bytes. When you declare a structure with diverse object types in it, the compiler includes some unused space between them to make the alignments correct. There is an <code>offsetof</code> macro in the <code>&lt;stddef.h&gt;</code> header that will give you the offsets of members within a structure. (I am assuming this code is just for exploring how C works and not for use in a real product. If it were for use in a real product, this is very bad code for that.)</p>\n\n<p>The assignment operator <code>=</code> knows how many bytes to move because the compiler knows the type of the left operand (because you have declared the type previously in your source code).</p>\n\n<p>If you do want to set an <code>int</code> to 24 by writing to its individual bytes, then you have to put 24 in its low-valued byte and 0 in its other bytes. However, which byte is the low-valued byte varies from system to system. Some hardware architectures put the low-valued byte in the low address, and some put it in the high address. (And, if you want to set an <code>int</code> to a value greater than fits into a byte, you have to break it into multiple bytes and write those.)</p>\n"}, {"comments": [{"owner": {"reputation": 306, "user_id": 7554024, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21c8a1063f1f606194fc1a1b36494fd8?s=128&d=identicon&r=PG&f=1", "display_name": "Fanarosss", "link": "https://stackoverflow.com/users/7554024/fanarosss"}, "edited": false, "score": 0, "creation_date": 1511959215, "post_id": 47552975, "comment_id": 82062720, "body": "So to get this right, <code>memset</code> shouldn&#39;t be used for that or the mistake is only at calculating the offset, and not using <code>offsetof</code>?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 306, "user_id": 7554024, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21c8a1063f1f606194fc1a1b36494fd8?s=128&d=identicon&r=PG&f=1", "display_name": "Fanarosss", "link": "https://stackoverflow.com/users/7554024/fanarosss"}, "edited": false, "score": 1, "creation_date": 1511959289, "post_id": 47552975, "comment_id": 82062773, "body": "Wrong offset is not the only problem. Read the manual for <code>memset</code>. it writes 4 identical bytes into your <code>int</code> storage."}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": true, "score": 9, "last_activity_date": 1511959497, "last_edit_date": 1511959497, "creation_date": 1511958744, "answer_id": 47552975, "question_id": 47552778, "link": "https://stackoverflow.com/questions/47552778/passing-data-in-struct-with-memcpy/47552975#47552975", "title": "Passing data in struct with memcpy", "body": "<p>Whatever you want to do, don't do it that way.</p>\n\n<pre><code>char Person_Data[50];\nsize_t offset = 0;\nmemset(Person_Data + offset, 24, sizeof(int));\noffset += sizeof(int);\nmemset(Person_Data + offset, 'M', sizeof(char));\noffset += sizeof(char);\nmemset(Person_Data + offset, 55, sizeof(int));\n</code></pre>\n\n<p>This will create the following memory layout (ints assumed to be 32 bit):</p>\n\n<pre><code>+--+--+--+--+--+--+--+--+--+--+--+--+\n|18|18|18|18| M|37|37|37|37|xx|xx|xx| \n+--+--+--+--+--+--+--+--+--+--+--+--+\n \\   int   /char\\  pad / \\   int   / \n</code></pre>\n\n<p>You copy into wrong locations.</p>\n\n<p>Why does printing seem to work?\nBecause you don't print int values but only char.</p>\n\n<pre><code>printf(\"Age = %d, Gender = %c, weight = %d\\n\", *(Person_Data), *(Person_Data + sizeof(int)), *(Person_Data + sizeof(int) + sizeof(char)));\n</code></pre>\n\n<p>The single character values are read from memory and promoted to <code>int</code> before passing to <code>printf</code>.</p>\n\n<p>As a general rule:</p>\n\n<ul>\n<li>Don't calculate offsets, but use <code>offsetof</code> as already suggested in comments.</li>\n<li>Don't use <code>memset</code> to fill integers.</li>\n<li>Don't mess around with <code>char</code> arrays if you want to use structures.</li>\n</ul>\n"}], "owner": {"reputation": 306, "user_id": 7554024, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21c8a1063f1f606194fc1a1b36494fd8?s=128&d=identicon&r=PG&f=1", "display_name": "Fanarosss", "link": "https://stackoverflow.com/users/7554024/fanarosss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 702, "favorite_count": 1, "accepted_answer_id": 47552975, "answer_count": 2, "score": 1, "last_activity_date": 1511959497, "creation_date": 1511958096, "question_id": 47552778, "link": "https://stackoverflow.com/questions/47552778/passing-data-in-struct-with-memcpy", "title": "Passing data in struct with memcpy", "body": "<p>I have the following struct:</p>\n\n<pre><code> typedef struct P{\n     int age;\n     char gender;\n     int weight;\n }Person;\n</code></pre>\n\n<p>I'm working with blocks of data. So all of my data are inside <code>char Person_Data[50];</code></p>\n\n<p>The expected outcome is to move the data from <code>Person_Data</code> to my struct. In order to achieve this I'm using memcpy, having in mind that inside <code>Person_Data</code> I can store either int or char(or anything else I might add).</p>\n\n<p>I wrote a code for a testable example:</p>\n\n<pre><code>char Person_Data[50];\nsize_t offset = 0;\nmemset(Person_Data + offset, 24, sizeof(int));\noffset += sizeof(int);\nmemset(Person_Data + offset, 'M', sizeof(char));\noffset += sizeof(char);\nmemset(Person_Data + offset, 55, sizeof(int));\n\nprintf(\"Age = %d, Gender = %c, weight = %d\\n\", *(Person_Data), *(Person_Data +  sizeof(int)), *(Person_Data + sizeof(int) + sizeof(char)));\n</code></pre>\n\n<p>Until this point we can see that the data inside my string are passed correctly, maintaining their type. (I guess from what I have read in various books).</p>\n\n<p>Now I pass the data from <code>Person_Data</code> to my struct:</p>\n\n<pre><code>Person *Person1 = malloc(sizeof(Person));\noffset = 0;\nmemcpy(&amp;Person1-&gt;age, Person_Data + offset, sizeof(int));\noffset += sizeof(int);\nmemcpy(&amp;Person1-&gt;gender, Person_Data + offset, sizeof(char));\noffset += sizeof(char);\nmemcpy(&amp;Person1-&gt;weight, Person_Data + offset, sizeof(int));\n\nprintf(\"Age = %d, Gender = %c, weight = %d\\n\", Person1-&gt;age, Person1-&gt;gender, Person1-&gt;weight);\n</code></pre>\n\n<p>As we can see the output of the above code is </p>\n\n<pre><code>Age = 24, Gender = M, weight = 55\nAge = 404232216, Gender = M, weight = 926365495\n</code></pre>\n\n<p>So, the 2 <code>int</code> have not passed correctly into the struct.</p>\n\n<p>That got me wondering and I tried this with <code>memset</code> like this:</p>\n\n<pre><code>memset(&amp;Person1-&gt;age, *(Person_Data + offset), sizeof(int));\n</code></pre>\n\n<p>But it didn't work also. So the last attempt was to pass the int like this:</p>\n\n<pre><code>Person1-&gt;age = *(Person_Data);\n</code></pre>\n\n<p>After doing this I saw that the age was passed correctly. \nMy thought is whether this is correct. </p>\n\n<p>How the \"=\" operator knows how many bytes to pass? </p>\n\n<p>Shouldn't memcpy/memset do the work since the third argument is how many bytes to copy?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "arm", "gdb", "cortex-m3", "openocd"], "comments": [{"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1511961408, "post_id": 47552591, "comment_id": 82064060, "body": "Could you show the code before <code>mww</code>?"}, {"owner": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "reply_to_user": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1511962240, "post_id": 47552591, "comment_id": 82064600, "body": "@Ring&#216; Updated now, just a <code>reset halt</code>"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1511979882, "post_id": 47552591, "comment_id": 82076379, "body": "this is a microcontroller and very specific to the chip (cortex-m3 is not the chip, not really related at all other than a blob that the debugger communicates through to get at the chip specific peripheral).   so first off there is no reason to expect flashing from openocd to work, once we went from parallel to serial flashes that all ended (chip specific, where it wasnt necessarily before).  so what chip are you using, and what openocd version and what command line and/or openocd script are you using to gain access?"}, {"owner": {"reputation": 7207, "user_id": 410847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a354e99dd64adf823aa72c4ee22a1fc?s=128&d=identicon&r=PG", "display_name": "Turbo J", "link": "https://stackoverflow.com/users/410847/turbo-j"}, "edited": false, "score": 0, "creation_date": 1513464118, "post_id": 47552591, "comment_id": 82665650, "body": "Few &#181;C will allow direct writes to flash with <code>mww</code>. That is why openOCD has special flash write commands."}], "answers": [{"tags": [], "owner": {"reputation": 1469, "user_id": 2105592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e0660c06174e5479ed2c6dcda818d0f?s=128&d=identicon&r=PG", "display_name": "Sean Houlihane", "link": "https://stackoverflow.com/users/2105592/sean-houlihane"}, "is_accepted": false, "score": 0, "last_activity_date": 1511981555, "creation_date": 1511981555, "answer_id": 47559780, "question_id": 47552591, "link": "https://stackoverflow.com/questions/47552591/openocd-write-a-value-to-flash-address/47559780#47559780", "title": "Openocd: Write a value to flash address", "body": "<p>That error message (assuming it's accurate) indicates that the debug port on the chip (the slave for the SWD connection) has detected an error. This might be a parity error on the SWD, a read polling mismatch or an AHB error response. See <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0314h/Chdhbffe.html\" rel=\"nofollow noreferrer\">table 2.10 here</a>. Without digging into which of these openOCD can handle, its hard to tell. This is only a symptom of your problem though - it is quite likely that writes directly to the flash are not supported in your chip (or at least not without some preamble to prepare the flash controller)</p>\n"}, {"tags": [], "owner": {"reputation": 7440, "user_id": 157344, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b403786b380b1b5a1ed25f144df103e6?s=128&d=identicon&r=PG", "display_name": "Freddie Chopin", "link": "https://stackoverflow.com/users/157344/freddie-chopin"}, "is_accepted": false, "score": 0, "last_activity_date": 1515673480, "last_edit_date": 1515673480, "creation_date": 1515671529, "answer_id": 48206408, "question_id": 47552591, "link": "https://stackoverflow.com/questions/47552591/openocd-write-a-value-to-flash-address/48206408#48206408", "title": "Openocd: Write a value to flash address", "body": "<p>You cannot \"just\" write any value to flash memory. In (almost?) all cases you have to follow a very specific procedure to actually write something there (like set this bit, wait for some other bit, write the address to this register, write the value to that register, set another bit, wait for \"done\" bit, repeat...). That's why the thing you are trying to do just won't work unless you implement this particular procedure with more <code>mww</code> (and <code>mmw</code> and <code>mdw</code>, or variants which use 16-bits of 8-bits, as sometimes you may write only 2 bytes at once, not all 4) commands before the actual write.</p>\n"}], "owner": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 923, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1515673480, "creation_date": 1511957542, "last_edit_date": 1511962209, "question_id": 47552591, "link": "https://stackoverflow.com/questions/47552591/openocd-write-a-value-to-flash-address", "title": "Openocd: Write a value to flash address", "body": "<p>I want to write a specific value to an address in flash using openocd.\nThe address is <code>0x0003FFF0</code>. ANd the value I want to write to it is <code>0xFFFFC000</code>.</p>\n\n<p>To erase that address I used:\n<code>flash erase_address 0x0003FFF0 2048</code> </p>\n\n<p>but got an error message <code>address range 0x0003fff0 .. 0x0003ffff is not sector-aligned</code></p>\n\n<p>To fix this I ran <code>flash info 0</code> to find the address to start from and then ran <code>flash erase_address 0x38000 2048</code> and this worked.</p>\n\n<p>Finally to write the value to flash I tried:</p>\n\n<p><code>reset halt</code></p>\n\n<p><code>mww 0x0003FFF0 0xFFFFC000</code></p>\n\n<p>but got this error:</p>\n\n<p><code>SWD ack not OK: 4 FAULT</code>\n<code>SWD IDCODE 0x2ba01477</code></p>\n"}, {"tags": ["c", "buffer"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1511957173, "post_id": 47552387, "comment_id": 82061319, "body": "There&#39;s no &quot;standard&quot; way, but what you have started on not uncommon. Then add a set of functions to append different kinds of data to the buffer."}, {"owner": {"reputation": 864, "user_id": 4624725, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-KB3KYmNbWw4/AAAAAAAAAAI/AAAAAAAAEpU/BgqrUE_Kev8/photo.jpg?sz=128", "display_name": "PoVa", "link": "https://stackoverflow.com/users/4624725/pova"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1511957313, "post_id": 47552387, "comment_id": 82061409, "body": "Is there a library for this kind of problem? I feel like I&#39;m reinventing a wheel."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1511957774, "post_id": 47552387, "comment_id": 82061704, "body": "@PoVa Of course, but recommending libraries is off-topic for this site. Re-inventing wheels is on-topic (modulo dupes), however. :)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1511958387, "post_id": 47552387, "comment_id": 82062140, "body": "Your approach is fine.  A library is overkill - you have to track how much data you have anyway - if you can&#39;t do that..."}], "answers": [{"comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1511957828, "post_id": 47552667, "comment_id": 82061746, "body": "Your code is not valid, you treat the structure&#39;s fields like local variables which is very confusing. Consider that the OP might not be very experienced in writing C. Post real code when possible."}, {"owner": {"reputation": 316, "user_id": 2370049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z9GzY.jpg?s=128&g=1", "display_name": "harsmar", "link": "https://stackoverflow.com/users/2370049/harsmar"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1511957898, "post_id": 47552667, "comment_id": 82061796, "body": "Ok I will change it"}], "tags": [], "owner": {"reputation": 316, "user_id": 2370049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z9GzY.jpg?s=128&g=1", "display_name": "harsmar", "link": "https://stackoverflow.com/users/2370049/harsmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1546419096, "last_edit_date": 1546419096, "creation_date": 1511957756, "answer_id": 47552667, "question_id": 47552387, "link": "https://stackoverflow.com/questions/47552387/storing-binary-data-in-static-array/47552667#47552667", "title": "Storing binary data in static array", "body": "<p>one way of doing it could be to store a pointer to where in your array next byte should be placed. </p>\n\n<pre><code>typedef struct {\n    unsigned char buff[2048];\n    char*    pData;\n} binary_data_t;\n\n// at init\nbinary_data_t rspMsg;\nrspMsg.pData = &amp;rspMsg.buff[0];\n\n// at entering data\n*(rspMsg.pData) = data;\nrspMsg.pData++;\n\n// at sending data you know the length via\nlength = rspMsg.pData - &amp;rspMsg.buff[0];\n</code></pre>\n\n<p>This is one way of solving this. \nCan be done in many ways. </p>\n"}, {"comments": [{"owner": {"reputation": 864, "user_id": 4624725, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-KB3KYmNbWw4/AAAAAAAAAAI/AAAAAAAAEpU/BgqrUE_Kev8/photo.jpg?sz=128", "display_name": "PoVa", "link": "https://stackoverflow.com/users/4624725/pova"}, "edited": false, "score": 0, "creation_date": 1512371627, "post_id": 47553193, "comment_id": 82213975, "body": "Thanks, I ended up using something similar. One question, what&#39;s the point of using flexible array members? Isn&#39;t it the same (under the hood) as declaring a pointer and allocating space for it?"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 1, "last_activity_date": 1511959402, "creation_date": 1511959402, "answer_id": 47553193, "question_id": 47552387, "link": "https://stackoverflow.com/questions/47552387/storing-binary-data-in-static-array/47553193#47553193", "title": "Storing binary data in static array", "body": "<p>Since you know the number of bytes you need to hold a packet, just use a <a href=\"https://en.wikipedia.org/wiki/Flexible_array_member\" rel=\"nofollow noreferrer\">flexible array member</a>:</p>\n\n<pre><code>typedef struct\n{\n    size_t bytes;\n    unsigned char data[];\n} binary_data_t;\n</code></pre>\n\n<p>(Note that <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/xrat/V4_xsh_chap02.html#tag_22_02_12\" rel=\"nofollow noreferrer\">identifiers ending in <code>_t</code> are reserved by POSIX</a>, and you really shouldn't be using them.)</p>\n\n<p>Allocation and reading data (assumes you <code>read()</code> from a file descriptor):</p>\n\n<pre><code>binary_data_t *p = malloc( sizeof( *p ) + numDataBytes );\np-&gt;bytes = numDataBytes;\nssize_t bytes_read = read( uartFD, p-&gt;data, numDataBytes );\n</code></pre>\n"}], "owner": {"reputation": 864, "user_id": 4624725, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-KB3KYmNbWw4/AAAAAAAAAAI/AAAAAAAAEpU/BgqrUE_Kev8/photo.jpg?sz=128", "display_name": "PoVa", "link": "https://stackoverflow.com/users/4624725/pova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 47553193, "answer_count": 2, "score": 0, "last_activity_date": 1546419096, "creation_date": 1511956928, "question_id": 47552387, "link": "https://stackoverflow.com/questions/47552387/storing-binary-data-in-static-array", "title": "Storing binary data in static array", "body": "<p>I'm writing an application which reads data from a UART interface. The data is sent in packets. Each packet has a channel associated with it. My application multiplexes received packets into virtual channels (threads) so that every channel can work independently of one another. When I receive a packet I have to do something depending on it's contents and produce a response. The response is sent back using the same UART interface.</p>\n\n<p>The data sent is mostly binary. When I'm reading from the UART interface, I know the size of the packet beforehand, so I can preallocate memory with no problem.</p>\n\n<p>The problem for me is producing a response. I know the maximum size of a packet, so I can create a static buffer when I'm constructing a response. If I we're to work with ASCII characters, instead of binary data, I could rely on NULL terminator to determine how long the data stored in the buffer is. However, I'm working with binary data, so using a NULL byte does not work. Instead, I have to keep a variable storing how many bytes of the buffer is used up already. I was thinking of using a custom data type for storing binary data:</p>\n\n<pre><code>typedef struct {\n    unsigned char buff[2048];\n    size_t buff_used;\n} binary_data_t;\n</code></pre>\n\n<p>What would be a standart way of handling this? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1511956496, "post_id": 47552208, "comment_id": 82060903, "body": "When you ask question about build errors, then please copy (as text) the complete output and paste it (without modifications) into the question body. Please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>, and learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>. Then <i>edit your question</i> to improve it."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1511956602, "post_id": 47552208, "comment_id": 82060985, "body": "As a hint though, with <code>(loebsdata2017 *)p1</code> you cast <code>p1</code> as a <i>pointer</i> to a <code>loebsdata2017</code> object, and then you assign this <i>pointer</i> to the variable <code>resultat1</code> which is <i>not</i> a pointer. Does that seem correct?"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1511959286, "post_id": 47552208, "comment_id": 82062769, "body": "In your example, it should be sufficient to sort the data once, before the loop instead of once for every loop iteration."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9025448, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212908757106773/picture?type=large", "display_name": "Rachel Hutchings", "link": "https://stackoverflow.com/users/9025448/rachel-hutchings"}, "edited": false, "score": 0, "creation_date": 1511956939, "post_id": 47552324, "comment_id": 82061195, "body": "Do I need to put semicolon &quot;;&quot; after   loebsdata2017 *resultat1 = (loebsdata2017 *)p1,  instead of &quot;,&quot;?"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 11, "user_id": 9025448, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212908757106773/picture?type=large", "display_name": "Rachel Hutchings", "link": "https://stackoverflow.com/users/9025448/rachel-hutchings"}, "edited": false, "score": 0, "creation_date": 1511957011, "post_id": 47552324, "comment_id": 82061235, "body": "Yes, or <code>loebsdata2017 *resultat1 = (loebsdata2017 *)p1,      *resultat2 = (loebsdata2017 *)p2;</code>  (I&#39;ve updated my answer)"}, {"owner": {"reputation": 11, "user_id": 9025448, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212908757106773/picture?type=large", "display_name": "Rachel Hutchings", "link": "https://stackoverflow.com/users/9025448/rachel-hutchings"}, "edited": false, "score": 0, "creation_date": 1511957352, "post_id": 47552324, "comment_id": 82061437, "body": "Thanks for your help. I am also trying to sort my data alphabetically, but I can&#39;t seem to figure out how. Is there a prototype for how it is done?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 11, "user_id": 9025448, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212908757106773/picture?type=large", "display_name": "Rachel Hutchings", "link": "https://stackoverflow.com/users/9025448/rachel-hutchings"}, "edited": false, "score": 0, "creation_date": 1511957917, "post_id": 47552324, "comment_id": 82061815, "body": "@RachelHutchings Isn&#39;t that what you&#39;re doing? Comparing strings in <code>qsort()</code> generally leads to an alphabetic sort. This is hard since your structure is not shown, and the field names are not in English."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 11, "user_id": 9025448, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212908757106773/picture?type=large", "display_name": "Rachel Hutchings", "link": "https://stackoverflow.com/users/9025448/rachel-hutchings"}, "edited": false, "score": 0, "creation_date": 1511959159, "post_id": 47552324, "comment_id": 82062683, "body": "@RachelHutchings Your current sorting function sorts on <code>rytterhold</code>. To sort on more than one field, you need to expand your sorting function a bit. You can find an example here (the example sorts on int and string, but it shouldn&#39;t be too hard to adapt it for two string fields): <a href=\"https://stackoverflow.com/questions/23732011/compare-function-for-qsort-using-two-fields-of-a-structure\" title=\"compare function for qsort using two fields of a structure\">stackoverflow.com/questions/23732011/&hellip;</a>"}], "tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 2, "last_activity_date": 1511956981, "last_edit_date": 1511956981, "creation_date": 1511956720, "answer_id": 47552324, "question_id": 47552208, "link": "https://stackoverflow.com/questions/47552208/qsort-and-strcmp/47552324#47552324", "title": "Qsort and strcmp", "body": "<p>You seem to have forgotten the  <code>*</code> in  the pointer declaration:</p>\n\n<pre><code>int sammenlign_hold (const void *p1, const void *p2) {\n    loebsdata2017 *resultat1 = (loebsdata2017 *)p1;\n    loebsdata2017 *resultat2 = (loebsdata2017 *)p2;\n\n    return strcmp(resultat1 -&gt; rytterhold, resultat2 -&gt; rytterhold)\n} \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9025448, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212908757106773/picture?type=large", "display_name": "Rachel Hutchings", "link": "https://stackoverflow.com/users/9025448/rachel-hutchings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511963434, "creation_date": 1511956355, "last_edit_date": 1511963434, "question_id": 47552208, "link": "https://stackoverflow.com/questions/47552208/qsort-and-strcmp", "title": "Qsort and strcmp", "body": "<p>I am having trouble with this code, beacuse it won't compile properly. I am getting this mistake:</p>\n\n<blockquote>\n  <p>initializing 'loebsdata2017' (aka 'struct loebsdata2017')\n        with an expression of incompatible type 'loebsdata2017 *' (aka 'struct\n        loebsdata2017 *'); dereference with *</p>\n</blockquote>\n\n<p>And I don't know what to change in my code. </p>\n\n<pre><code>int sammenlign_hold (const void *p1, const void *p2);\nvoid opgave_2 (loebsdata2017 *alle_loebsdata2017) {\n    int i = 0;\n    for (i = 0; i &lt; MAX_PERSONER; i++) {\n        qsort (alle_loebsdata2017, 792, sizeof (loebsdata2017), sammenlign_hold);\n        if(strcmp(alle_loebsdata2017[i].nationalitet, \"DEN\") == 0) \n        {\n\n            printf(\"%s    \\n\", alle_loebsdata2017[i].rytternavn);\n        }\n    }\n}\n\nint sammenlign_hold (const void *p1, const void *p2) {\n    loebsdata2017 resultat1 = (loebsdata2017 *)p1,\n    loebsdata2017 resultat2 = (loebsdata2017 *)p2;\n\n    return strcmp(resultat1 -&gt; rytterhold, resultat2 -&gt; rytterhold)\n} \n</code></pre>\n"}, {"tags": ["c", "linux", "makefile", "gnu-make"], "comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1511956501, "post_id": 47552127, "comment_id": 82060906, "body": "<code>$(GCC) -c $&lt; $(CFLAGS) -o $@</code> --&gt;&gt; <code>$(GCC) $(CFLAGS) $&lt;  -o $@</code>"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1511956582, "post_id": 47552127, "comment_id": 82060967, "body": "I think you need to remove the spaces before your colons. Not sure though."}, {"owner": {"reputation": 129, "user_id": 1678047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0421367752812f401faa0f37ddb22c59?s=128&d=identicon&r=PG", "display_name": "tongko", "link": "https://stackoverflow.com/users/1678047/tongko"}, "reply_to_user": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1511957571, "post_id": 47552127, "comment_id": 82061567, "body": "@Gaurav, I tried your suggestion but with no luck..."}, {"owner": {"reputation": 129, "user_id": 1678047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0421367752812f401faa0f37ddb22c59?s=128&d=identicon&r=PG", "display_name": "tongko", "link": "https://stackoverflow.com/users/1678047/tongko"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1511957593, "post_id": 47552127, "comment_id": 82061584, "body": "@fuz, that doesn&#39;t work either."}, {"owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "edited": false, "score": 2, "creation_date": 1511958037, "post_id": 47552127, "comment_id": 82061898, "body": "I think the issue lies in the line <code>kernel.elf : %.o</code>, the rule to make <code>kernel.elf</code>. Make looks for a target <code>%.o</code> but since it is genereic it does not know what files to use. If you use <code>kernel.elf : kernel.o</code> or whatever <code>.o</code>-files you actually need to make the kernel, it should work. (answered at the same time below)"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1511958826, "post_id": 47552127, "comment_id": 82062453, "body": "Also see <a href=\"https://stackoverflow.com/q/5178125/608639\">How to place object files in separate subdirectory</a> and <a href=\"https://stackoverflow.com/q/15873011/608639\">How to make specific binary from specific object file?</a>, where the answers seems to tell you to use a wildcard for object files. Maybe GNU Make is not understanding the <code>*.elf</code> extension in <code>kernel.elf</code>."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 1678047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0421367752812f401faa0f37ddb22c59?s=128&d=identicon&r=PG", "display_name": "tongko", "link": "https://stackoverflow.com/users/1678047/tongko"}, "edited": false, "score": 1, "creation_date": 1511959210, "post_id": 47552762, "comment_id": 82062714, "body": "It works! Thank you so much! I&#39;ve been scratching my head whole night!"}, {"owner": {"reputation": 894, "user_id": 310560, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c084731bc5d9b0cf96604b7275174f83?s=128&d=identicon&r=PG", "display_name": "Assimilater", "link": "https://stackoverflow.com/users/310560/assimilater"}, "edited": false, "score": 0, "creation_date": 1527812270, "post_id": 47552762, "comment_id": 88279055, "body": "Shouldn&#39;t it be a prerequisite though? Otherwise when %.c is updated how will it know to compile the appropriate .o target?"}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 894, "user_id": 310560, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c084731bc5d9b0cf96604b7275174f83?s=128&d=identicon&r=PG", "display_name": "Assimilater", "link": "https://stackoverflow.com/users/310560/assimilater"}, "edited": false, "score": 0, "creation_date": 1527924093, "post_id": 47552762, "comment_id": 88319176, "body": "@Assimilater What I meant is that the original prerequisite is literally <code>%.o</code> (i.e., a file called <code>%.o</code>, <b>not</b> a <i>pattern</i> for <code>.o</code> files). With my approach, the list of files resulting from the expansion of <code>$(obj)</code> becomes the prerequisite of <code>kernel.elf</code>. This list consists of <code>.o</code> files and, when their corresponding <code>.c</code> is updated, the OP&#39;s rule <code>%.o: %.c</code> is used."}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": true, "score": 10, "last_activity_date": 1511958361, "last_edit_date": 1511958361, "creation_date": 1511958042, "answer_id": 47552762, "question_id": 47552127, "link": "https://stackoverflow.com/questions/47552127/no-rule-to-make-target-o/47552762#47552762", "title": "No rule to make target &#39;%.o&#39;", "body": "<p>The problem is in the following rule:</p>\n\n<pre><code>kernel.elf : %.o\n</code></pre>\n\n<p>GNU Make is actually treating <code>%.o</code> as a <em>prerequisite</em>, and not a <em>pattern</em>.</p>\n\n<p>I would suggest you to define an <code>obj</code> variable which includes the names of the object files and rewrite the rule as:</p>\n\n<pre><code>kernel.elf: $(obj)\n</code></pre>\n\n<p>A definition of such an <code>obj</code> variable could be:</p>\n\n<pre><code>obj := $(patsubst %.c,%.o,$(wildcard *.c))\nobj += $(patsubst %.asm,%.so,$(wildcard *.asm))\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 1678047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0421367752812f401faa0f37ddb22c59?s=128&d=identicon&r=PG", "display_name": "tongko", "link": "https://stackoverflow.com/users/1678047/tongko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4256, "favorite_count": 1, "accepted_answer_id": 47552762, "answer_count": 1, "score": 4, "last_activity_date": 1511958578, "creation_date": 1511956176, "last_edit_date": 1511958578, "question_id": 47552127, "link": "https://stackoverflow.com/questions/47552127/no-rule-to-make-target-o", "title": "No rule to make target &#39;%.o&#39;", "body": "<p>For unknown reason, GNU Make doesn't do the job for me. I have this MAKE file, I did ensure for every recipe, I use tab, not space. however I look at it, I just couldn't spot anywhere that would cause the error message.</p>\n\n<p>OS: Ubuntu 17.10 / GNU Make: 4.1 / GCC: Cross compile to i686-elf-gcc.</p>\n\n<p>Running it with: make (in the same directory) give me</p>\n\n<pre><code>make: *** No rule to make target '%.o', needed by 'kernel.elf'.  Stop.\n</code></pre>\n\n<p>I have a bash script that does exactly the same thing and it works like charm. Can any one tell what am I doing wrong?</p>\n\n<p>Makefile:</p>\n\n<pre><code>NASM=nasm\nQEMU=qemu-system-i386\nGCC=~/opt/cross/bin/i686-elf-gcc\nCFLAGS=-std=c11 -ffreestanding -Wall -Wextra -Werror -masm=intel -g -O0\nASFLAGS=-felf32 -g\n\n.PHONY: all clean\nall:boot.iso\n\n%.o : %.c\n    $(GCC) -c $&lt; $(CFLAGS) -o $@\n\n%.so : %.asm\n    $(NASM) $(ASFLAGS) -o $@ $&lt;\n\nkernel.elf : %.o\n    $(GCC) -T link.ld -o $@ -ffreestanding -O0 -nostdlib -lgcc --verbose $^\n    grub-file --is-x86-multiboot2 kernel.elf\n\nboot.iso : kernel.elf grub.cfg\n    mkdir -p ./iso/boot/grub\n    cp kernel.elf ./iso/boot\n    cp grub.cfg ./iso/boot/grub\n    grub-mkrescue -o $@ ./iso\n\nrun: boot.iso\n    $(QEMU) -cdrom $&lt; -D log/qemu.log -d guest_errors -m 2048M -daemonize -serial file:log/boot.log\n\ndebug: boot.iso\n    $(QEMU) -cdrom $&lt; -D log/qemu.log -d guest_errors -m 2048M -daemonize -serial file:log/boot.log -s -S\n    gdb ./kernel.elf -ex \"target remote :1234\" --tui\n\nclean:\n    rm -f ./*.o\n    rm -f ./kernel.elf\n    rm -rf ./iso\n</code></pre>\n\n<p>Running make with -d option output this:</p>\n\n<pre><code>GNU Make 4.1\nBuilt for x86_64-pc-linux-gnu\nCopyright (C) 1988-2014 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nReading makefiles...\nReading makefile 'Makefile'...\nUpdating makefiles....\n Considering target file 'Makefile'.\n  Looking for an implicit rule for 'Makefile'.\n\n  ... a bunch of ...\n  Trying pattern rule with stem 'Makefile'.\n  Trying implicit prerequisite 'Makefile.o'. &lt;-- last line\n  ... end a bunch of ...\n\n  Looking for a rule with intermediate file 'Makefile.o'.\n   Avoiding implicit rule recursion.\n\n   ... a bunch of ...\n   Trying pattern rule with stem 'Makefile'.\n   Trying implicit prerequisite 'Makefile.c'. &lt;--- last line\n   ... end a bunch of ...\n\n   Looking for a rule with intermediate file 'Makefile.c'.\n    Avoiding implicit rule recursion.\n    Avoiding implicit rule recursion.\n\n    ... a bunch of ...\n    Trying pattern rule with stem 'Makefile'.\n    Trying implicit prerequisite 'Makefile.y'.\n    ... end a bunch of ...\n\n    Looking for a rule with intermediate file 'Makefile.y'.\n     Avoiding implicit rule recursion.\n     Avoiding implicit rule recursion.\n     Avoiding implicit rule recursion.\n\n     ... a bunch of ...\n     Trying pattern rule with stem 'Makefile.y'.\n     Trying implicit prerequisite 'SCCS/s.Makefile.y'. &lt;-- last line\n     ... end a bunch of ...\n     ... I'm too tired to clean it up ....\n     ... is all the same thing for Makefile\n\nUpdating goal targets....\nConsidering target file 'all'.\n File 'all' does not exist.\n  Considering target file 'boot.iso'.\n   File 'boot.iso' does not exist.\n    Considering target file 'kernel.elf'.\n     File 'kernel.elf' does not exist.\n      Considering target file '%.o'.\n       File '%.o' does not exist.\n       Looking for an implicit rule for '%.o'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.c'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.cc'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.C'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.cpp'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.p'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.f'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.F'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.m'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.r'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.s'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.S'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.mod'.\n       Trying pattern rule with stem '%.o'.\n       Trying implicit prerequisite '%.o,v'.\n       Trying pattern rule with stem '%.o'.\n       Trying implicit prerequisite 'RCS/%.o,v'.\n       Trying pattern rule with stem '%.o'.\n       Trying implicit prerequisite 'RCS/%.o'.\n       Trying pattern rule with stem '%.o'.\n       Trying implicit prerequisite 's.%.o'.\n       Trying pattern rule with stem '%.o'.\n       Trying implicit prerequisite 'SCCS/s.%.o'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.c'.\n       Looking for a rule with intermediate file '%.c'.\n        Avoiding implicit rule recursion.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.y'.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.l'.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.w'.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.w'.\n        Trying pattern rule with stem '%.c'.\n        Trying implicit prerequisite '%.c,v'.\n        Trying pattern rule with stem '%.c'.\n        Trying implicit prerequisite 'RCS/%.c,v'.\n        Trying pattern rule with stem '%.c'.\n        Trying implicit prerequisite 'RCS/%.c'.\n        Trying pattern rule with stem '%.c'.\n        Trying implicit prerequisite 's.%.c'.\n        Trying pattern rule with stem '%.c'.\n        Trying implicit prerequisite 'SCCS/s.%.c'.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.y'.\n        Looking for a rule with intermediate file '%.y'.\n         Avoiding implicit rule recursion.\n         Avoiding implicit rule recursion.\n         Trying pattern rule with stem '%.y'.\n         Trying implicit prerequisite '%.y,v'.\n         Trying pattern rule with stem '%.y'.\n         Trying implicit prerequisite 'RCS/%.y,v'.\n         Trying pattern rule with stem '%.y'.\n         Trying implicit prerequisite 'RCS/%.y'.\n         Trying pattern rule with stem '%.y'.\n         Trying implicit prerequisite 's.%.y'.\n         Trying pattern rule with stem '%.y'.\n         Trying implicit prerequisite 'SCCS/s.%.y'.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.l'.\n        Looking for a rule with intermediate file '%.l'.\n         Avoiding implicit rule recursion.\n         Avoiding implicit rule recursion.\n         Trying pattern rule with stem '%.l'.\n         Trying implicit prerequisite '%.l,v'.\n         Trying pattern rule with stem '%.l'.\n         Trying implicit prerequisite 'RCS/%.l,v'.\n         Trying pattern rule with stem '%.l'.\n         Trying implicit prerequisite 'RCS/%.l'.\n         Trying pattern rule with stem '%.l'.\n         Trying implicit prerequisite 's.%.l'.\n         Trying pattern rule with stem '%.l'.\n         Trying implicit prerequisite 'SCCS/s.%.l'.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.w'.\n        Looking for a rule with intermediate file '%.w'.\n         Avoiding implicit rule recursion.\n         Avoiding implicit rule recursion.\n         Trying pattern rule with stem '%.w'.\n         Trying implicit prerequisite '%.w,v'.\n         Trying pattern rule with stem '%.w'.\n         Trying implicit prerequisite 'RCS/%.w,v'.\n         Trying pattern rule with stem '%.w'.\n         Trying implicit prerequisite 'RCS/%.w'.\n         Trying pattern rule with stem '%.w'.\n         Trying implicit prerequisite 's.%.w'.\n         Trying pattern rule with stem '%.w'.\n         Trying implicit prerequisite 'SCCS/s.%.w'.\n        Trying pattern rule with stem '%'.\n        Rejecting impossible rule prerequisite '%.w'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.cc'.\n       Looking for a rule with intermediate file '%.cc'.\n        Avoiding implicit rule recursion.\n        Trying pattern rule with stem '%.cc'.\n        Trying implicit prerequisite '%.cc,v'.\n        Trying pattern rule with stem '%.cc'.\n        Trying implicit prerequisite 'RCS/%.cc,v'.\n        Trying pattern rule with stem '%.cc'.\n        Trying implicit prerequisite 'RCS/%.cc'.\n        Trying pattern rule with stem '%.cc'.\n        Trying implicit prerequisite 's.%.cc'.\n        Trying pattern rule with stem '%.cc'.\n        Trying implicit prerequisite 'SCCS/s.%.cc'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.C'.\n       Looking for a rule with intermediate file '%.C'.\n        Avoiding implicit rule recursion.\n        Trying pattern rule with stem '%.C'.\n        Trying implicit prerequisite '%.C,v'.\n        Trying pattern rule with stem '%.C'.\n        Trying implicit prerequisite 'RCS/%.C,v'.\n        Trying pattern rule with stem '%.C'.\n        Trying implicit prerequisite 'RCS/%.C'.\n        Trying pattern rule with stem '%.C'.\n        Trying implicit prerequisite 's.%.C'.\n        Trying pattern rule with stem '%.C'.\n        Trying implicit prerequisite 'SCCS/s.%.C'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.cpp'.\n       Looking for a rule with intermediate file '%.cpp'.\n        Avoiding implicit rule recursion.\n        Trying pattern rule with stem '%.cpp'.\n        Trying implicit prerequisite '%.cpp,v'.\n        Trying pattern rule with stem '%.cpp'.\n        Trying implicit prerequisite 'RCS/%.cpp,v'.\n        Trying pattern rule with stem '%.cpp'.\n        Trying implicit prerequisite 'RCS/%.cpp'.\n        Trying pattern rule with stem '%.cpp'.\n        Trying implicit prerequisite 's.%.cpp'.\n        Trying pattern rule with stem '%.cpp'.\n        Trying implicit prerequisite 'SCCS/s.%.cpp'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.p'.\n       Looking for a rule with intermediate file '%.p'.\n        Avoiding implicit rule recursion.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.web'.\n        Trying pattern rule with stem '%.p'.\n        Trying implicit prerequisite '%.p,v'.\n        Trying pattern rule with stem '%.p'.\n        Trying implicit prerequisite 'RCS/%.p,v'.\n        Trying pattern rule with stem '%.p'.\n        Trying implicit prerequisite 'RCS/%.p'.\n        Trying pattern rule with stem '%.p'.\n        Trying implicit prerequisite 's.%.p'.\n        Trying pattern rule with stem '%.p'.\n        Trying implicit prerequisite 'SCCS/s.%.p'.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.web'.\n        Looking for a rule with intermediate file '%.web'.\n         Avoiding implicit rule recursion.\n         Avoiding implicit rule recursion.\n         Trying pattern rule with stem '%.web'.\n         Trying implicit prerequisite '%.web,v'.\n         Trying pattern rule with stem '%.web'.\n         Trying implicit prerequisite 'RCS/%.web,v'.\n         Trying pattern rule with stem '%.web'.\n         Trying implicit prerequisite 'RCS/%.web'.\n         Trying pattern rule with stem '%.web'.\n         Trying implicit prerequisite 's.%.web'.\n         Trying pattern rule with stem '%.web'.\n         Trying implicit prerequisite 'SCCS/s.%.web'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.f'.\n       Looking for a rule with intermediate file '%.f'.\n        Avoiding implicit rule recursion.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.F'.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.r'.\n        Trying pattern rule with stem '%.f'.\n        Trying implicit prerequisite '%.f,v'.\n        Trying pattern rule with stem '%.f'.\n        Trying implicit prerequisite 'RCS/%.f,v'.\n        Trying pattern rule with stem '%.f'.\n        Trying implicit prerequisite 'RCS/%.f'.\n        Trying pattern rule with stem '%.f'.\n        Trying implicit prerequisite 's.%.f'.\n        Trying pattern rule with stem '%.f'.\n        Trying implicit prerequisite 'SCCS/s.%.f'.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.F'.\n        Looking for a rule with intermediate file '%.F'.\n         Avoiding implicit rule recursion.\n         Avoiding implicit rule recursion.\n         Trying pattern rule with stem '%.F'.\n         Trying implicit prerequisite '%.F,v'.\n         Trying pattern rule with stem '%.F'.\n         Trying implicit prerequisite 'RCS/%.F,v'.\n         Trying pattern rule with stem '%.F'.\n         Trying implicit prerequisite 'RCS/%.F'.\n         Trying pattern rule with stem '%.F'.\n         Trying implicit prerequisite 's.%.F'.\n         Trying pattern rule with stem '%.F'.\n         Trying implicit prerequisite 'SCCS/s.%.F'.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.r'.\n        Looking for a rule with intermediate file '%.r'.\n         Avoiding implicit rule recursion.\n         Avoiding implicit rule recursion.\n         Trying pattern rule with stem '%'.\n         Rejecting impossible rule prerequisite '%.l'.\n         Trying pattern rule with stem '%.r'.\n         Trying implicit prerequisite '%.r,v'.\n         Trying pattern rule with stem '%.r'.\n         Trying implicit prerequisite 'RCS/%.r,v'.\n         Trying pattern rule with stem '%.r'.\n         Trying implicit prerequisite 'RCS/%.r'.\n         Trying pattern rule with stem '%.r'.\n         Trying implicit prerequisite 's.%.r'.\n         Trying pattern rule with stem '%.r'.\n         Trying implicit prerequisite 'SCCS/s.%.r'.\n       Trying pattern rule with stem '%'.\n       Rejecting impossible rule prerequisite '%.F'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.m'.\n       Looking for a rule with intermediate file '%.m'.\n        Avoiding implicit rule recursion.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.ym'.\n        Trying pattern rule with stem '%.m'.\n        Trying implicit prerequisite '%.m,v'.\n        Trying pattern rule with stem '%.m'.\n        Trying implicit prerequisite 'RCS/%.m,v'.\n        Trying pattern rule with stem '%.m'.\n        Trying implicit prerequisite 'RCS/%.m'.\n        Trying pattern rule with stem '%.m'.\n        Trying implicit prerequisite 's.%.m'.\n        Trying pattern rule with stem '%.m'.\n        Trying implicit prerequisite 'SCCS/s.%.m'.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.ym'.\n        Looking for a rule with intermediate file '%.ym'.\n         Avoiding implicit rule recursion.\n         Avoiding implicit rule recursion.\n         Trying pattern rule with stem '%.ym'.\n         Trying implicit prerequisite '%.ym,v'.\n         Trying pattern rule with stem '%.ym'.\n         Trying implicit prerequisite 'RCS/%.ym,v'.\n         Trying pattern rule with stem '%.ym'.\n         Trying implicit prerequisite 'RCS/%.ym'.\n         Trying pattern rule with stem '%.ym'.\n         Trying implicit prerequisite 's.%.ym'.\n         Trying pattern rule with stem '%.ym'.\n         Trying implicit prerequisite 'SCCS/s.%.ym'.\n       Trying pattern rule with stem '%'.\n       Rejecting impossible rule prerequisite '%.r'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.s'.\n       Looking for a rule with intermediate file '%.s'.\n        Avoiding implicit rule recursion.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.S'.\n        Trying pattern rule with stem '%.s'.\n        Trying implicit prerequisite '%.s,v'.\n        Trying pattern rule with stem '%.s'.\n        Trying implicit prerequisite 'RCS/%.s,v'.\n        Trying pattern rule with stem '%.s'.\n        Trying implicit prerequisite 'RCS/%.s'.\n        Trying pattern rule with stem '%.s'.\n        Trying implicit prerequisite 's.%.s'.\n        Trying pattern rule with stem '%.s'.\n        Trying implicit prerequisite 'SCCS/s.%.s'.\n        Trying pattern rule with stem '%'.\n        Trying rule prerequisite '%.S'.\n        Looking for a rule with intermediate file '%.S'.\n         Avoiding implicit rule recursion.\n         Avoiding implicit rule recursion.\n         Trying pattern rule with stem '%.S'.\n         Trying implicit prerequisite '%.S,v'.\n         Trying pattern rule with stem '%.S'.\n         Trying implicit prerequisite 'RCS/%.S,v'.\n         Trying pattern rule with stem '%.S'.\n         Trying implicit prerequisite 'RCS/%.S'.\n         Trying pattern rule with stem '%.S'.\n         Trying implicit prerequisite 's.%.S'.\n         Trying pattern rule with stem '%.S'.\n         Trying implicit prerequisite 'SCCS/s.%.S'.\n       Trying pattern rule with stem '%'.\n       Rejecting impossible rule prerequisite '%.S'.\n       Trying pattern rule with stem '%'.\n       Trying rule prerequisite '%.mod'.\n       Looking for a rule with intermediate file '%.mod'.\n        Avoiding implicit rule recursion.\n        Trying pattern rule with stem '%.mod'.\n        Trying implicit prerequisite '%.mod,v'.\n        Trying pattern rule with stem '%.mod'.\n        Trying implicit prerequisite 'RCS/%.mod,v'.\n        Trying pattern rule with stem '%.mod'.\n        Trying implicit prerequisite 'RCS/%.mod'.\n        Trying pattern rule with stem '%.mod'.\n        Trying implicit prerequisite 's.%.mod'.\n        Trying pattern rule with stem '%.mod'.\n        Trying implicit prerequisite 'SCCS/s.%.mod'.\n       No implicit rule found for '%.o'.\n       Finished prerequisites of target file '%.o'.\n      Must remake target '%.o'.\nmake: *** No rule to make target '%.o', needed by 'kernel.elf'.  Stop.\n</code></pre>\n"}, {"tags": ["c", "if-statement", "switch-statement", "flags", "ls"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1511956026, "post_id": 47552042, "comment_id": 82060635, "body": "You can remove all the new line characters. ;)"}, {"owner": {"reputation": 141, "user_id": 5737076, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/309841178a8b3f5759300d6fb83b262c?s=128&d=identicon&r=PG&f=1", "display_name": "Asez", "link": "https://stackoverflow.com/users/5737076/asez"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1511956098, "post_id": 47552042, "comment_id": 82060672, "body": "What do you mean by this? P.S: This is just the beginning of my function. I have to make all the flags. I&#39;ve heard about some pointer on function for this but I don&#39;t understand how it works."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1511956236, "post_id": 47552042, "comment_id": 82060750, "body": "He means that C does not care about line structure in most cases. You could simply put your whole function in one line."}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 3, "creation_date": 1511956242, "post_id": 47552042, "comment_id": 82060755, "body": "You can use <code>getopt()</code>."}, {"owner": {"reputation": 141, "user_id": 5737076, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/309841178a8b3f5759300d6fb83b262c?s=128&d=identicon&r=PG&f=1", "display_name": "Asez", "link": "https://stackoverflow.com/users/5737076/asez"}, "edited": false, "score": 0, "creation_date": 1511956335, "post_id": 47552042, "comment_id": 82060800, "body": "Well, I&#39;m not allowed to use getopt() and I can&#39;t put my whole function on the same line since I can&#39;t pass 80 chars on a line. Also, If I use more than 3 if, it&#39;s not ok."}, {"owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "edited": false, "score": 0, "creation_date": 1511956501, "post_id": 47552042, "comment_id": 82060905, "body": "Concatenate all the arguments then <code>system(argv)</code> (not a serious suggestion sorry)"}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1511956647, "post_id": 47552042, "comment_id": 82061019, "body": "@Asez Can you please update the question that you don&#39;t want to use <code>getopt()</code>?"}, {"owner": {"reputation": 141, "user_id": 5737076, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/309841178a8b3f5759300d6fb83b262c?s=128&d=identicon&r=PG&f=1", "display_name": "Asez", "link": "https://stackoverflow.com/users/5737076/asez"}, "edited": false, "score": 0, "creation_date": 1511956971, "post_id": 47552042, "comment_id": 82061217, "body": "I&#39;m not allowed to use getopt() by my teachers."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 2, "creation_date": 1511957275, "post_id": 47552042, "comment_id": 82061391, "body": "instead of comparing again and again all the strings, just use <code>else</code> to avoid redundant comparisons"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1511957410, "post_id": 47552042, "comment_id": 82061472, "body": "You entire approach may be wrong if the goal is to replicate the command-line options of <code>ls</code>.  How do you plan on handling something like <code>ls -lat ...</code>, where multiple options are combined into one <code>argv</code> string passed to your code?"}, {"owner": {"reputation": 141, "user_id": 5737076, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/309841178a8b3f5759300d6fb83b262c?s=128&d=identicon&r=PG&f=1", "display_name": "Asez", "link": "https://stackoverflow.com/users/5737076/asez"}, "edited": false, "score": 0, "creation_date": 1511957591, "post_id": 47552042, "comment_id": 82061581, "body": "@AndrewHenie Yep, that&#39;s the main problem. I&#39;m struggling in putting multiple arguments."}], "answers": [{"comments": [{"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1511957525, "post_id": 47552449, "comment_id": 82061536, "body": "BTW, you probably wanna make sure that <code>argc &gt; 1</code> to begin with."}, {"owner": {"reputation": 141, "user_id": 5737076, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/309841178a8b3f5759300d6fb83b262c?s=128&d=identicon&r=PG&f=1", "display_name": "Asez", "link": "https://stackoverflow.com/users/5737076/asez"}, "edited": false, "score": 0, "creation_date": 1511958230, "post_id": 47552449, "comment_id": 82062047, "body": "Thanks! Have you an idea about how to manage multiple flags. not only argv[1]. Like ./my_ls -a -d -F ...etc"}, {"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "reply_to_user": {"reputation": 141, "user_id": 5737076, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/309841178a8b3f5759300d6fb83b262c?s=128&d=identicon&r=PG&f=1", "display_name": "Asez", "link": "https://stackoverflow.com/users/5737076/asez"}, "edited": false, "score": 0, "creation_date": 1511961565, "post_id": 47552449, "comment_id": 82064155, "body": "@Asez: Implement a function which will take the string as input, parse it according to those <code>-</code> characters and return an array of flags as output. Use an enumeration for these flags, so that you don&#39;t have to parse them as individual strings again outside the function."}], "tags": [], "owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "is_accepted": false, "score": 0, "last_activity_date": 1511957122, "creation_date": 1511957122, "answer_id": 47552449, "question_id": 47552042, "link": "https://stackoverflow.com/questions/47552042/c-many-if-to-less-lines/47552449#47552449", "title": "C: Many if to less lines", "body": "<p>Try this:</p>\n\n<pre><code>if (argv[1][0] == '-' &amp;&amp; argv[1][1] != 0 &amp;&amp; argv[1][2] == 0)\n{\n    switch (argv[1][1])\n    {\n        case 'a':\n            ...\n            break;\n        case 'd':\n            ...\n            break;\n        case 'F':\n            ...\n            break;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 5737076, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/309841178a8b3f5759300d6fb83b262c?s=128&d=identicon&r=PG&f=1", "display_name": "Asez", "link": "https://stackoverflow.com/users/5737076/asez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511957122, "creation_date": 1511955932, "question_id": 47552042, "link": "https://stackoverflow.com/questions/47552042/c-many-if-to-less-lines", "title": "C: Many if to less lines", "body": "<p>For an exercise, I must recode the \"ls\" function. Currently I'm using if(strcmp to gestionate the flags but I'm wondering if there is another way to do it with less lines. Thanks in advance and there you have my code.</p>\n\n<pre><code>void my_ls(int argc, char *argv[])\n{\n    if(strcmp(argv[1], \"-a\") == 0)\n        minus_a(argc, argv);\n    if(strcmp(argv[1], \"-d\") == 0)\n        minus_d(argc, argv);\n    if(strcmp(argv[1], \"-F\") == 0)\n        minus_cap_f(argc, argv);\n    multi_ls(argc, argv);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "integer", "division"], "comments": [{"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 0, "creation_date": 1511954361, "post_id": 47551488, "comment_id": 82059690, "body": "Is your purpose to have only set the MSB of the variable?"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 3, "creation_date": 1511954610, "post_id": 47551488, "comment_id": 82059825, "body": "So debug it. What do you expect <code>~currentAddr</code> to be? What actually is it? What about <code>~currentAddr&#47;2</code>? What about that <code>+1</code>?"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1511954821, "post_id": 47551488, "comment_id": 82059963, "body": "I think the problem here is that literal integers (like <code>2</code> and <code>1</code> in <code>(~currentAddr)&#47;2+1</code> are treated as <code>int</code> values. As a result, <code>currentAddr</code> is being promoted to an <code>int</code> before the calculation is done. For some reason, <a href=\"https://stackoverflow.com/questions/1906917/short-int-literals-in-c\">C doesn&#39;t support literal <code>unsigned short</code> values</a>."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 2, "creation_date": 1511955167, "post_id": 47551488, "comment_id": 82060175, "body": "The key is that <code>~currentAddr</code> evaluates to <code>~(int)currentaAddr</code> on machines where <code>int</code> is larger than <code>short</code>. Note that the result would be <code>0x8000</code> on a platform where <code>sizeof (int) == sizeof (short)</code> because then the expression would be evaluated as <code>unsigned</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1511965863, "post_id": 47551488, "comment_id": 82067101, "body": "Simply insure unsigned division.  Use <code>addr[1] = (~currentAddr)&#47;2u+1;</code>  (add u)"}], "answers": [{"comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1511954880, "post_id": 47551688, "comment_id": 82060001, "body": "This would be a better answer if you included a workaround to the OP&#39;s problem."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1511955355, "post_id": 47551688, "comment_id": 82060282, "body": "You might add an explanation why this is a problem. It should work fine unless already <code>(~currentAddr)</code> has more bits than <code>unsigned short</code>, i.e. <code>currentAddr</code> is promoted before applying <code>~</code> operator."}, {"owner": {"reputation": 21, "user_id": 9017856, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JthbKLMbJ3I/AAAAAAAAAAI/AAAAAAAAABs/z8V9VVUnI88/photo.jpg?sz=128", "display_name": "ABC CHN", "link": "https://stackoverflow.com/users/9017856/abc-chn"}, "edited": false, "score": 0, "creation_date": 1511956659, "post_id": 47551688, "comment_id": 82061027, "body": "Well,I tried in my VS, and found the result is actually decided by the type of value  X/2 (because 2 is int and int can hold unsinged short,so result is int ),so you can write like this addr[1] = (unsigned short)(~currentAddr)/2+1;"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1511957093, "post_id": 47551688, "comment_id": 82061279, "body": "The problem is that already <code>~</code> causes promotion. If the division by 2 was the reason for promotion, it would be <code>((unsigned short)0xFFFF)&#47;2</code>which promotes to <code>(int)0x0000FFFF&#47;2</code> resulting to <code>0x00007FFF</code> as expected"}, {"owner": {"reputation": 21, "user_id": 9017856, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JthbKLMbJ3I/AAAAAAAAAAI/AAAAAAAAABs/z8V9VVUnI88/photo.jpg?sz=128", "display_name": "ABC CHN", "link": "https://stackoverflow.com/users/9017856/abc-chn"}, "edited": false, "score": 0, "creation_date": 1511957580, "post_id": 47551688, "comment_id": 82061570, "body": "Some things happened....As you see,(type)(~)/int,lets see the operator priority about this equation,&#39;(~)&#39;&gt;&#39;(type)&#39;&gt;&#39;/&#39;.this commnent refutes my answer and last comment......"}, {"owner": {"reputation": 158, "user_id": 4734920, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/rc7H6.jpg?s=128&g=1", "display_name": "Stefatronik", "link": "https://stackoverflow.com/users/4734920/stefatronik"}, "edited": false, "score": 0, "creation_date": 1511965611, "post_id": 47551688, "comment_id": 82066945, "body": "<code>addr[1] = ((unsigned short)~currentAddr)&#47;2+1; </code> seems to work. I wonder why I hadn&#39;t tried any cast before? So Gerhardh looks like you are right with you answer"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 158, "user_id": 4734920, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/rc7H6.jpg?s=128&g=1", "display_name": "Stefatronik", "link": "https://stackoverflow.com/users/4734920/stefatronik"}, "edited": false, "score": 1, "creation_date": 1511968006, "post_id": 47551688, "comment_id": 82068800, "body": "@Stefatronik Avoid casting as in <code>((unsigned short)~currentAddr)&#47;2+1;</code>.  This may &quot;work&quot; for this C code, yet casting in a computation is usually a sign of other problems and better fixes exist."}, {"owner": {"reputation": 158, "user_id": 4734920, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/rc7H6.jpg?s=128&g=1", "display_name": "Stefatronik", "link": "https://stackoverflow.com/users/4734920/stefatronik"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512030153, "post_id": 47551688, "comment_id": 82095094, "body": "@chux Yes you&#39;re right- I implemented the WedaPashi&#39;s suggestion <code>addr[1] = USHRT_MAX&#47;2+1;</code>... Good discussion here thanks to all proposals, I learned a lot!"}], "tags": [], "owner": {"reputation": 21, "user_id": 9017856, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JthbKLMbJ3I/AAAAAAAAAAI/AAAAAAAAABs/z8V9VVUnI88/photo.jpg?sz=128", "display_name": "ABC CHN", "link": "https://stackoverflow.com/users/9017856/abc-chn"}, "is_accepted": false, "score": 0, "last_activity_date": 1511955545, "last_edit_date": 1511955545, "creation_date": 1511954712, "answer_id": 47551688, "question_id": 47551488, "link": "https://stackoverflow.com/questions/47551488/integer-division-in-c-with-unsigned-short/47551688#47551688", "title": "Integer division in C with unsigned short", "body": "<p>Because the number 2 is int and int can hold unsigned short,so,the the actual operation is <code>addr[1] = (unsigned short)(((int)(~currentAddr)/2)+1)</code></p>\n"}, {"comments": [{"owner": {"reputation": 158, "user_id": 4734920, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/rc7H6.jpg?s=128&g=1", "display_name": "Stefatronik", "link": "https://stackoverflow.com/users/4734920/stefatronik"}, "edited": false, "score": 0, "creation_date": 1511963342, "post_id": 47551866, "comment_id": 82065400, "body": "Hello David, I tried following: <code>unsigned short c;</code> <code>c = ~currentAddr;</code> <code>unsigned short c_z = sizeof (c);`` </code>unsigned short ci;` <code>ci = (c &gt;&gt; 1)+1;</code> <code>unsigned short ci_z = sizeof (ci);</code> <code>addr[1] =ci; </code> (btw. how do I make a \\n in the comment?) Now everything is fine. But if what you said is true, shouldn&#39;t I have an int in my second line?"}, {"owner": {"reputation": 158, "user_id": 4734920, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/rc7H6.jpg?s=128&g=1", "display_name": "Stefatronik", "link": "https://stackoverflow.com/users/4734920/stefatronik"}, "edited": false, "score": 0, "creation_date": 1511963726, "post_id": 47551866, "comment_id": 82065634, "body": "I meant shouldn&#39;t c bekome an int in line 2... Sorry I am having trouble with the comment feature and the formatting options..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511965065, "post_id": 47551866, "comment_id": 82066550, "body": "Note: &quot;<code>~currentAddr</code> evaluates to -1&quot; is also implementation-defined - yet very commonly the result is -1 on 32-bit <code>int</code>.  On 16-bit <code>int&#47;unsigned</code> (common in embedded world),  <code>~currentAddr</code> would be 65,535."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511967490, "post_id": 47551866, "comment_id": 82068344, "body": "@DavidBowling On 16-bit <code>int&#47;unsigned</code>, <code>unsigned short</code> promoted to <code>unsigned</code> where -1u is 65,535.  Detailed <a href=\"https://stackoverflow.com/a/47555535/2410359\">here</a>."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 158, "user_id": 4734920, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/rc7H6.jpg?s=128&g=1", "display_name": "Stefatronik", "link": "https://stackoverflow.com/users/4734920/stefatronik"}, "edited": false, "score": 0, "creation_date": 1511967769, "post_id": 47551866, "comment_id": 82068598, "body": "@Stefatronik -- not quite sure I follow you; with <code>unsigned short c;  c = ~currentAddr;</code>, <code>currentAddr</code> is promoted to <code>int</code> (or <code>unsigned int</code> in some cases). Then <code>~currentAddr</code> evaluates to <code>-1</code> for the <code>int</code> case. When the assignment is made to <code>unsigned short c</code> the value <code>-1</code> undergoes conversion to <code>unsigned short</code>, yielding <code>USHRT_MAX</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1511971316, "post_id": 47551866, "comment_id": 82071252, "body": "Recommend we delete our paired comments."}], "tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 6, "last_activity_date": 1512037488, "last_edit_date": 1512037488, "creation_date": 1511955323, "answer_id": 47551866, "question_id": 47551488, "link": "https://stackoverflow.com/questions/47551488/integer-division-in-c-with-unsigned-short/47551866#47551866", "title": "Integer division in C with unsigned short", "body": "<h2>What went wrong</h2>\n\n<p>The integer promotions are performed on the operand of the unary <code>~</code>.</p>\n\n<p>On many systems <code>int</code> is larger than <code>short</code>. On such systems, for <code>unsigned short currentAddr = 0</code>, the value of <code>currentAddr</code> is first promoted to <code>int</code> in the expression <code>~currentAddr</code>. Then <code>~currentAddr</code> evaluates to <code>-1</code> (assuming twos-complement representation).</p>\n\n<p>On some systems <code>int</code> and <code>short</code> may be the same size (though <code>int</code> must be at least as large as <code>short</code>); here <code>currentAddr</code> would instead be promoted to <code>unsigned int</code> since an <code>int</code> cannot hold all values of an <code>unsigned</code> integer type of the same size. In such a case, <code>~currentAddr</code> would evaluate to <code>UINT_MAX</code>. For 16-bit <code>int</code> (<code>short</code> must be at least 16-bit, so here <code>int</code> and <code>short</code> would be the same size) the result of <code>~currentAddr</code> would be 65,535.</p>\n\n<p>The OP's system must have <code>int</code> larger than <code>short</code>. In the case of <code>addr[1] = (~currentAddr)/2+1;</code> this becomes <code>addr[1] = (-1)/2+1;</code> which evaluates to <code>1</code>.</p>\n\n<p>In the second case, <code>addr[1] = ~currentAddr&gt;&gt;1;</code> evaluates to <code>addr[1] = (-1)&gt;&gt;1;</code>. Here, the result of right-shifting a negative value is implementation-defined. In the present case, the result appears to be <code>INT_MAX</code>, which is converted to <code>unsigned short</code> in the assignment to <code>addr[1]</code>, which takes the value <code>USHRT_MAX</code> in the conversion. This value is 65,535 on OP's system.</p>\n\n<h2>What to do about it</h2>\n\n<p>To obtain maximum and minimum values for standard integer types clearly and reliably, use the macros found in <code>limits.h</code> instead of attempting bit manipulations. This method will not disappoint:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nint main(void)\n{\n    unsigned short val;\n\n    val = (USHRT_MAX / 2) + 1;\n    printf(\"(USHRT_MAX / 2) + 1: %#hx\\n\", val);\n\n    val = USHRT_MAX &gt;&gt; 1;\n    printf(\"     USHRT_MAX &gt;&gt; 1: %#hx\\n\", val);\n\n    return 0;\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(USHRT_MAX / 2) + 1: 0x8000\n     USHRT_MAX &gt;&gt; 1: 0x7fff\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 158, "user_id": 4734920, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/rc7H6.jpg?s=128&g=1", "display_name": "Stefatronik", "link": "https://stackoverflow.com/users/4734920/stefatronik"}, "edited": false, "score": 0, "creation_date": 1511963921, "post_id": 47551904, "comment_id": 82065778, "body": "Hey. Pls see my reply to David Bowling. I have a separate line doing <code>unsigned short c = ~currentAddr;</code> that works - I mean c remains short. Where is the difference?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1511965603, "post_id": 47551904, "comment_id": 82066940, "body": "&quot;Now, why this isn&#39;t promoted to integer as opposed to previous case  <code>c = ~currentAddr;</code>&quot; mis-leads.    <code>currentAddr</code> is still promoted to <code>int</code> on 32-bit machines before applying the <code>~</code>.  That operation results in an <code>int</code>.  The <code>int</code> value is then saved in <code>c</code>, yet then goes through a conversion to <code>unsigned short</code>."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1511965896, "post_id": 47551904, "comment_id": 82067124, "body": "@chux: Oh, honestly I didn&#39;t see that coming. Thanks for explaining. I have updated the answer accordingly."}, {"owner": {"reputation": 158, "user_id": 4734920, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/rc7H6.jpg?s=128&g=1", "display_name": "Stefatronik", "link": "https://stackoverflow.com/users/4734920/stefatronik"}, "edited": false, "score": 0, "creation_date": 1511967229, "post_id": 47551904, "comment_id": 82068129, "body": "@WedaPashi Thanks for the update - this was the jumping point. So I better expect C to do most operations in standard int. The assignment helps me to make it <i>the other</i> datatype. Doing operations with the unexpected type may / will fail like I have proven in my initial post ^^ Thanks"}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 158, "user_id": 4734920, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/rc7H6.jpg?s=128&g=1", "display_name": "Stefatronik", "link": "https://stackoverflow.com/users/4734920/stefatronik"}, "edited": false, "score": 0, "creation_date": 1511974231, "post_id": 47551904, "comment_id": 82073137, "body": "@Stefatronik: Welcome! If we (David, chux and I) have answered your question then may be You should accept one of the answers."}], "tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": true, "score": 1, "last_activity_date": 1511966178, "last_edit_date": 1511966178, "creation_date": 1511955419, "answer_id": 47551904, "question_id": 47551488, "link": "https://stackoverflow.com/questions/47551488/integer-division-in-c-with-unsigned-short/47551904#47551904", "title": "Integer division in C with unsigned short", "body": "<p>The problem lies here:</p>\n\n<pre><code>addr[1] = (~currentAddr)/2+1;\n</code></pre>\n\n<p>You expect <code>currentAddr</code> to <code>0xFFFF</code>, which is partially right. But, what you might have missed out is integer promotion rule, which makes it <code>0xFFFFFFFF</code> which is hexadecimal representation of <code>-1</code>.</p>\n\n<p>Now, there is simple math:\n<code>(~currentAddr)/2+1</code> is nothing but <code>0x01</code> or <code>1</code>, When you <code>~currentAddr&gt;&gt;1;</code> do this shift, it is again becoming <code>-1</code>.</p>\n\n<p>From</p>\n\n<blockquote>\n  <p>My aim is to have half the maximum of the variable, here <code>0x8000</code></p>\n</blockquote>\n\n<p>If I understand you correctly, what you are trying to do is get the value which is equal to (Maximum value of Unsigned short)/2. If it is so, the proper way of doing it will be using <code>USHRT_MAX</code>. Of course, you'll need to include <code>limits.h</code> file in your source code.</p>\n\n<hr>\n\n<p><strong>Update:</strong></p>\n\n<p>Referring to your comments to David's answer, following changes works as expected. (You have tested, I haven't)</p>\n\n<pre><code>unsigned short c; \nc = ~currentAddr; \nunsigned short c_z = sizeof (c);\nunsigned short ci; \nci = (c &gt;&gt; 1) + 1; \nunsigned short ci_z = sizeof (ci); \naddr[1] = ci;\n</code></pre>\n\n<p>Now, why this isn't promoted to integer as opposed to previous case</p>\n\n<pre><code>c = ~currentAddr; \n</code></pre>\n\n<p>It is promoted, but it yields an expected result because, as chux explainned (which I couldn't have done) it is (temporarily) promoted to <code>int</code> during its operation, but resolved as (converted to) a <code>unsigned short</code> again when it is stored in memory allocated to <code>c</code>.</p>\n\n<p>The C standard answers the question:</p>\n\n<p><strong>From the C99 standard: 6.5.16.1 Simple assignment</strong></p>\n\n<blockquote>\n  <p>In simple assignment (=), the value of the right operand is converted to the type of the assignment expression and replaces the value stored in the object designated by the left operand.\n  In your case since both the LHS and RHS are of the same type, there is no need for any conversion.</p>\n</blockquote>\n\n<p>Also, it says:</p>\n\n<blockquote>\n  <p>The type of an assignment expression is the type the left operand would have after lvalue conversion.</p>\n</blockquote>\n\n<p>The same is specified by <strong>C11 6.5.16.1/2:</strong></p>\n\n<blockquote>\n  <p>In simple assignment (=), the value of the right operand is converted to the type of the assignment expression and replaces the value stored in the object designated by the left operand.</p>\n</blockquote>\n\n<p>Try this yourself:</p>\n\n<pre><code>int main(void)\n{\n    unsigned short c; \n    unsigned short currentAddr= 0x0000;\n    c = ~currentAddr;\n\n    printf(\"\\n0x%x\", c);\n    printf(\"\\n0x%x\", (~currentAddr));\n\n    return 0;\n}\n</code></pre>\n\n<p>This should print:</p>\n\n<pre><code>0xffff\n0xffffffff\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1511980088, "post_id": 47555535, "comment_id": 82076499, "body": "@Stefatronik pre-C11, for user code to discern the maximum of a variable of <i>arbitrary  type</i> is not possible with risking UB  unless 1) the type is known to be some unsigned type and max value is known to be &gt;= <code>UINT_MAX</code>  or 2) the <code>sizeof(var) == 1</code>.  With C11, <code>_Generic</code> can be used to find the max of select types."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1511979117, "last_edit_date": 1511979117, "creation_date": 1511966919, "answer_id": 47555535, "question_id": 47551488, "link": "https://stackoverflow.com/questions/47551488/integer-division-in-c-with-unsigned-short/47555535#47555535", "title": "Integer division in C with unsigned short", "body": "<pre><code>addr[1] = (~currentAddr)/2+1;\n</code></pre>\n\n<p>Let us break it down: <code>currentAddr</code> is an <code>unsigned short</code> involved in a computation so the value/type is first promoted to <code>int</code> or <code>unsigned</code>.  In C this is <em>integer promotion</em>.</p>\n\n<blockquote>\n  <p>If an <code>int</code> can represent all values of the original type ..., the value is converted to an int; otherwise, it is converted to an <code>unsigned int</code>. These are called the <em>integer promotions</em>. All other types are unchanged by the integer promotions.  C11dr \u00a76.3.1.1 2</p>\n</blockquote>\n\n<hr>\n\n<p>When <code>USHRT_MAX &lt;= INT_MAX</code>,  (e.g. 16 bit short int/unsigned, 32-bit int/unsigned), code is like below.  With <code>currentAddr == 0</code> and typical 2's complement behavior, ~0 --> -1 and <code>addr[1]</code> --> 1.</p>\n\n<pre><code>int tmp = currentAddr;\naddr[1] = (~tmp)/2+1;  \n</code></pre>\n\n<p>When <code>USHRT_MAX &gt; INT_MAX</code>,  (e.g. 16 bit short int/unsigned, 16-bit int/unsigned), code is like below.  With <code>currentAddr == 0</code> and unsigned behavior, ~0 --> 0xFFFF and <code>addr[1]</code> --> 0x8000.</p>\n\n<pre><code>unsigned tmp = currentAddr;\naddr[1] = (~tmp)/2+1;  \n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>My aim is to have half the maximum of the variable</p>\n</blockquote>\n\n<p>The <em>best</em> way to get the maximum of an <code>unsigned short</code> is to use <code>SHRT_MAX</code> and skip the <code>~</code> code.  It will work as expected regardless of <code>unsigned short, int, unsigned</code> range.  It also better documents code intent.</p>\n\n<pre><code>#include &lt;limits.h&gt;\naddr[1] = USHRT_MAX/2+1;\n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 4734920, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/rc7H6.jpg?s=128&g=1", "display_name": "Stefatronik", "link": "https://stackoverflow.com/users/4734920/stefatronik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "accepted_answer_id": 47551904, "answer_count": 4, "score": 1, "last_activity_date": 1512037488, "creation_date": 1511954111, "question_id": 47551488, "link": "https://stackoverflow.com/questions/47551488/integer-division-in-c-with-unsigned-short", "title": "Integer division in C with unsigned short", "body": "<p>I feel like the bloodiest beginner - Why does the following not work:</p>\n\n<pre><code>// declarations\nunsigned short currentAddr= 0x0000;\nunsigned short addr[20] = {1, 0};\n\n// main \naddr[1] = (~currentAddr)/2+1;\nprintf(\"addr[1] wert: %hu\\n\", addr[1]); // equals 1, expecte 0x8000\naddr[1] = ~currentAddr&gt;&gt;1;\nprintf(\"addr[1] wert: %hu\\n\", addr[1]); // equals 65535, expected 0x7FFF\n</code></pre>\n\n<p>In printf and also in my debugger's watchlist the value for addr[1] is not as expected. My aim is to have half the maximum of the variable, here 0x8000. \nInfo: I am doing ~currentAddr to get the max. 0xFFFF in case short is in a different length on my embedded platform than here on my PC. </p>\n\n<p>cheers, Stefan</p>\n"}, {"tags": ["c", "binary-search-tree"], "comments": [{"owner": {"reputation": 1341, "user_id": 4524618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e1ca7e81266dc3e8f724a4864b3d90e?s=128&d=identicon&r=PG", "display_name": "Sniper", "link": "https://stackoverflow.com/users/4524618/sniper"}, "edited": false, "score": 0, "creation_date": 1511953750, "post_id": 47551272, "comment_id": 82059264, "body": "Can you show sample input?"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1511953882, "post_id": 47551272, "comment_id": 82059361, "body": "What is the meaning of <code>temp = root;</code> in all your functions? Having shared temporary fields aptly named <code>temp</code> and <code>temp1</code> is a road to failure. Have you heard of <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">rubber duck debugging</a>?"}, {"owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "edited": false, "score": 0, "creation_date": 1511953948, "post_id": 47551272, "comment_id": 82059401, "body": "Do you know there is something called MVCE <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "edited": false, "score": 0, "creation_date": 1511954161, "post_id": 47551272, "comment_id": 82059555, "body": "@potato the OP&#39;s code compiles."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1511954195, "post_id": 47551272, "comment_id": 82059580, "body": "You are leaking memory when you simply do <code>temp-&gt;left = NULL</code>. Do not use global variables in recursive functions, it just defeats the purpose."}, {"owner": {"reputation": 49, "user_id": 6573695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a97c07e411d469a878cc07c58bfa9f4e?s=128&d=identicon&r=PG&f=1", "display_name": "oldDoctor", "link": "https://stackoverflow.com/users/6573695/olddoctor"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1511955960, "post_id": 47551272, "comment_id": 82060602, "body": "@Groo temp = root, so that I can store the value of the parent in temp for later use. Lose of memory will definitely happen but then i was just experimenting with global variables."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1512053822, "post_id": 47551272, "comment_id": 82109578, "body": "@oldDoctor: Using global variables should be avoided in programming. They should never be used for temporary variables. And when writing recursive functions, state is passed through function parameters, not by writing it to some global location."}], "owner": {"reputation": 49, "user_id": 6573695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a97c07e411d469a878cc07c58bfa9f4e?s=128&d=identicon&r=PG&f=1", "display_name": "oldDoctor", "link": "https://stackoverflow.com/users/6573695/olddoctor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511957328, "creation_date": 1511953421, "last_edit_date": 1511957328, "question_id": 47551272, "link": "https://stackoverflow.com/questions/47551272/deleting-a-node-with-2-children-from-a-binary-search-tree", "title": "Deleting a node with 2 children from a binary search tree", "body": "<p>I am trying to delete a node having 2 chidren in a binary search tree. However i am facing little problem here. While deleting node(node with data=30) with children (left->data=20,right->data=40), I am replacing the node with its inorder successor (which is node with data=40) and then deleting the inorder successor. After deletion the node's data is successfully replaced (new value being 40) but the inorder successor is not being deleted/freed properly. </p>\n\n<p>Expected Output [inorder traversal]: 20->40->50->60->70->80-></p>\n\n<p>Output[inorder traversal]: 20->40->0->50->60->70->80-></p>\n\n<p>After 40, why is the value 0 appearing?   </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct Node\n{ \n    int data;\n    struct Node *left;\n    struct Node *right;\n};\n\nstruct Node* temp = NULL,*temp1 = NULL;\nstruct Node *newNode(int data)\n{\n    struct Node *node = (struct Node*)malloc(sizeof(struct Node));\n    node-&gt;data = data;\n    node-&gt;left = node-&gt;right = NULL;\n\n    return node;\n}\n\nstruct Node* insert(struct Node* root,int data)\n{\n    if(root == NULL)\n    {\n        return newNode(data);\n    }\n\n    if(data &lt; root-&gt;data)\n        root-&gt;left = insert(root-&gt;left,data);\n    else\n        root-&gt;right = insert(root-&gt;right,data);\n}\n\nvoid inorder(struct Node* root)\n{\n    if(root!=NULL)\n    {\n        inorder(root-&gt;left);    \n        printf(\"%d-&gt;\",root-&gt;data); \n        inorder(root-&gt;right);    \n    }\n    else\n    {\n        return;\n    }\n}\n /*to find the inorder successor*/\nstruct Node *minVal(struct Node *root)\n{\n    while(root-&gt;left !=NULL)\n    {\n        temp = root;\n        root = root-&gt;left;\n    }\n\n    return root;\n}\n\nvoid deleteNode(struct Node *root,int data)\n{\n    if(data &lt; root-&gt;data)\n    {\n        temp = root; \n        deleteNode(root-&gt;left,data);  \n    }\n    else if(data &gt; root-&gt;data)\n    {\n        temp = root;\n        deleteNode(root-&gt;right,data);\n    }\n    else if(data == root-&gt;data)\n    { /*deleting leaf nodes*/\n        if(root-&gt;left == NULL &amp;&amp; root-&gt;right == NULL)\n        {\n            if(temp-&gt;left == root)\n                temp-&gt;left = NULL;\n            else\n                if(temp-&gt;right == root)\n            temp-&gt;right = NULL;\n            free(root);\n            root = NULL;\n            return;\n        }\n         /*deleting nodes having single child*/\n        else if(root-&gt;left !=NULL &amp;&amp; root-&gt;right == NULL)\n        {\n            temp1 = root-&gt;left;\n            temp-&gt;left = temp1;\n            free(root);\n            root = NULL;\n        }\n        else if(root-&gt;left ==NULL &amp;&amp; root-&gt;right != NULL)\n        {\n            temp1 = root-&gt;right;\n            temp-&gt;right = temp1;\n            free(root);\n            root = NULL;\n        }\n         /*deleting nodes having 2 children*/\n        else if(root-&gt;left !=NULL &amp;&amp; root-&gt;right !=NULL)\n        {\n            struct Node *temp2 = minVal(root-&gt;right);\n            root-&gt;data = temp2-&gt;data;\n            deleteNode(root-&gt;right,temp2-&gt;data);\n        }  \n    }\n}\n\nint main()\n{\n    struct Node *root = NULL;\n    printf(\"\\n\\n\");\n\n    root = insert(root, 50);\n    insert(root, 30);\n    insert(root, 20);\n    insert(root, 40);\n    insert(root, 70);\n    insert(root, 60);\n    insert(root, 80);\n\n    inorder(root);\n    //deleteNode(root,40);\n    deleteNode(root,30);\n    printf(\"\\n\\n\");\n    inorder(root);\n\n    printf(\"\\n\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "do-while"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1511951914, "post_id": 47550732, "comment_id": 82058003, "body": "Check what <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>scanf</code></a> <i>returns</i>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1511951966, "post_id": 47550732, "comment_id": 82058028, "body": "<code>between 0 and 24</code> and <code>while ( n &lt; 0 || n &gt; 23)</code>...something is <i>off</i>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1511951976, "post_id": 47550732, "comment_id": 82058038, "body": "Don&#39;t use <code>scanf</code>at all but use <code>fgets</code> and parse the input."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8968181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ASc7r.jpg?s=128&g=1", "display_name": "potarin", "link": "https://stackoverflow.com/users/8968181/potarin"}, "edited": false, "score": 0, "creation_date": 1511954923, "post_id": 47551124, "comment_id": 82060030, "body": "my problem is that I don\u2019t know how to ask for input again when I got  &quot; &quot;, &quot;abc&quot; or enter key. it loops"}], "tags": [], "owner": {"reputation": 174, "user_id": 6607862, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-X-RCpFaKB88/AAAAAAAAAAI/AAAAAAAADcU/nFWOBp7uKUE/photo.jpg?sz=128", "display_name": "Noam Ohana", "link": "https://stackoverflow.com/users/6607862/noam-ohana"}, "is_accepted": true, "score": 0, "last_activity_date": 1511960103, "last_edit_date": 1511960103, "creation_date": 1511953011, "answer_id": 47551124, "question_id": 47550732, "link": "https://stackoverflow.com/questions/47550732/how-to-avoid-spaces-enter-key-or-non-numeric-input-in-c-scanf-reads-integer-v/47551124#47551124", "title": "How to avoid spaces, enter key or non-numeric input in C ? scanf reads integer value", "body": "<p>The only thing that I see is that the input '24' itself won't stop the loop, so you need to change the condition to:</p>\n\n<pre><code>while ( n &lt; 0 || n &gt; 24);\n</code></pre>\n\n<p>NULL is not an issue, as you can't get NULL from stdin. NULL means an address that points byte number 0. It won't happen, as you call scanf with a memory that is on the stack of the current running thread.</p>\n\n<p>about EOF from stdin, you can get more info here \n<a href=\"https://stackoverflow.com/questions/3197025/end-of-fileeof-of-standard-input-stream-stdin\">End of File(EOF) of Standard input stream (stdin)</a>.</p>\n\n<p>About using scanf, I would recommend to read:\n<a href=\"https://stackoverflow.com/questions/2430303/disadvantages-of-scanf\">Disadvantages of scanf</a>.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> This is what's best to do. Get rid of scanf and use fgets and strtol, like the following example (taken from <a href=\"https://stackoverflow.com/questions/26583717/how-to-scanf-only-integer\">This SO answer</a>)</p>\n\n<pre><code>char *end;\nchar buf[LINE_MAX];\nint n = 0;\n\ndo {\n    if (!fgets(buf, sizeof buf, stdin))\n        break;\n\n    // remove \\n\n    buf[strlen(buf) - 1] = '\\0';\n\n    //Get integer from line\n    n = strtol(buf, &amp;end, 10);\n // making sure that a valid input was given (i.e. a number) and its value\n // You might also want to check that strlen(end) is zero, to avoid input like \"213 abcde\", depends on you\n} while ((end != buf) &amp;&amp; ( (n &gt; 24 || n &lt; 0)));\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8968181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ASc7r.jpg?s=128&g=1", "display_name": "potarin", "link": "https://stackoverflow.com/users/8968181/potarin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 47551124, "answer_count": 1, "score": -1, "last_activity_date": 1511960103, "creation_date": 1511951855, "last_edit_date": 1511955706, "question_id": 47550732, "link": "https://stackoverflow.com/questions/47550732/how-to-avoid-spaces-enter-key-or-non-numeric-input-in-c-scanf-reads-integer-v", "title": "How to avoid spaces, enter key or non-numeric input in C ? scanf reads integer value", "body": "<p>Get input untill it's an integer beetween 0 and 23.</p>\n\n<pre><code>int n;    \ndo\n{\n    printf(\"Enter height: \");\n    scanf(\"%d\", &amp;n);\n} while ( n &lt; 0 || n &gt; 23);\n</code></pre>\n\n<p>adding <code>EOF</code> and <code>NULL</code> to while somehow?</p>\n"}, {"tags": ["c", "openssl", "x509", "hsm"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1511951156, "post_id": 47550347, "comment_id": 82057471, "body": "May be of some use <a href=\"https://linuxctl.com/2017/02/x509-certificate-manual-signature-verification/\" rel=\"nofollow noreferrer\">x509 Certificate Manual Signature Verification</a>"}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1511951260, "post_id": 47550347, "comment_id": 82057546, "body": "do you have the signature with private key thats hidden in hsm"}, {"owner": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "edited": false, "score": 2, "creation_date": 1511951926, "post_id": 47550347, "comment_id": 82058006, "body": "See the example code on this page: <a href=\"https://wiki.openssl.org/index.php/Manual:EVP_PKEY_verify(3)\" rel=\"nofollow noreferrer\">wiki.openssl.org/index.php/Manual:EVP_PKEY_verify(3)</a>"}, {"owner": {"reputation": 1846, "user_id": 3134181, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b4b3f1301af98ad83aa4bb36092d80a6?s=128&d=identicon&r=PG&f=1", "display_name": "LordTitiKaka", "link": "https://stackoverflow.com/users/3134181/lordtitikaka"}, "reply_to_user": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1511955601, "post_id": 47550347, "comment_id": 82060401, "body": "@Pras my HSM PCI holds the private key(s) , the server (holding the PCI) is able to sign buffer using the private key , I use the public key to be sure signing made with correct private key"}, {"owner": {"reputation": 1846, "user_id": 3134181, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b4b3f1301af98ad83aa4bb36092d80a6?s=128&d=identicon&r=PG&f=1", "display_name": "LordTitiKaka", "link": "https://stackoverflow.com/users/3134181/lordtitikaka"}, "reply_to_user": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "edited": false, "score": 0, "creation_date": 1511955653, "post_id": 47550347, "comment_id": 82060430, "body": "@lockcmpxchg8b I&#39;ll look into it !! and publish my finding (or answer)"}, {"owner": {"reputation": 1846, "user_id": 3134181, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b4b3f1301af98ad83aa4bb36092d80a6?s=128&d=identicon&r=PG&f=1", "display_name": "LordTitiKaka", "link": "https://stackoverflow.com/users/3134181/lordtitikaka"}, "reply_to_user": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "edited": false, "score": 0, "creation_date": 1512541328, "post_id": 47550347, "comment_id": 82294769, "body": "@lockcmpxchg8b your example put me on the right track, please see published answer"}], "answers": [{"tags": [], "owner": {"reputation": 1846, "user_id": 3134181, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b4b3f1301af98ad83aa4bb36092d80a6?s=128&d=identicon&r=PG&f=1", "display_name": "LordTitiKaka", "link": "https://stackoverflow.com/users/3134181/lordtitikaka"}, "is_accepted": true, "score": 0, "last_activity_date": 1512541251, "creation_date": 1512541251, "answer_id": 47668010, "question_id": 47550347, "link": "https://stackoverflow.com/questions/47550347/verify-public-key-matches-signature-of-private-key/47668010#47668010", "title": "Verify public key matches signature of private key", "body": "<p>Issue I've encountered was figuring out what is the signature length before hand to allocate place for the signature that must have prior knowledge on RSA key size and type of hash</p>\n\n<pre><code>sha256 + RSA1024 ~ 128byte\nsha256 + RSA2048 ~ 256byte\n</code></pre>\n\n<p>using openssl API <a href=\"https://wiki.openssl.org/index.php/EVP_Signing_and_Verifying\" rel=\"nofollow noreferrer\">based of this guide</a> I've managed to verify signature using following code :</p>\n\n<pre><code>Verifyx509VsPrivKeySig(X509* x509Cert,char* signature,size_t sigLen,char* message,size_t messageLen)\n{\n        int rc;\n        EVP_PKEY* pPubkey = NULL;\n        EVP_MD_CTX* ctx = NULL;\n\n        rc = getX509Publickey(x509Cert, &amp;pPubkey);\n        if (rc != SSL_OK)\n        {\n                goto err_verify;\n        }\n\n        ctx = EVP_MD_CTX_create();\n        if(ctx == NULL) {\n                PRINT_LOG_ERR(\"EVP_MD_CTX_create failed, error 0x%lx\\n\", ERR_get_error());\n                /* failed */\n                goto err_verify;\n        }\n\n        rc = EVP_DigestVerifyInit(ctx, NULL, EVP_sha256(), NULL, pPubkey);\n        if(rc != 1) {\n                PRINT_LOG_ERR(\"EVP_DigestVerifyInit failed, error 0x%lx\\n\", ERR_get_error());\n                goto err_EVP_XTX_destroy; /* failed */\n        }\n\n        rc = EVP_DigestVerifyUpdate(ctx, message, messageLen);\n        if(rc != 1) {\n                PRINT_LOG_ERR(\"EVP_DigestVerifyUpdate failed, error 0x%lx\\n\", ERR_get_error());\n                goto err_EVP_XTX_destroy; /* failed */\n        }\n\n        /* Clear any errors for the call below */\n        ERR_clear_error();\n\n        rc = EVP_DigestVerifyFinal(ctx,(const unsigned char*) signature, sigLen);\n        if(rc != 1) {\n                PRINT_LOG_ERR(\"EVP_DigestVerifyFinal failed, error 0x%lx\\n\", ERR_get_error());\n                goto err_EVP_XTX_destroy; /* failed */\n        }\n\n\n        /*if we got to here , verify sig finished with good result!!*/\n    if(ctx) {\n        EVP_MD_CTX_destroy(ctx);\n        ctx = NULL;\n    }\n\n    return true;\n    //////////////////// ERROR HANDLING ///////////////////////////\nerr_EVP_XTX_destroy:\n        EVP_MD_CTX_destroy(ctx);\nerr_verify:\n        return false;\n}\n</code></pre>\n"}], "owner": {"reputation": 1846, "user_id": 3134181, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b4b3f1301af98ad83aa4bb36092d80a6?s=128&d=identicon&r=PG&f=1", "display_name": "LordTitiKaka", "link": "https://stackoverflow.com/users/3134181/lordtitikaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1522, "favorite_count": 1, "accepted_answer_id": 47668010, "answer_count": 1, "score": 1, "last_activity_date": 1512541251, "creation_date": 1511950806, "last_edit_date": 1512008915, "question_id": 47550347, "link": "https://stackoverflow.com/questions/47550347/verify-public-key-matches-signature-of-private-key", "title": "Verify public key matches signature of private key", "body": "<p>I'm new to openssl API.</p>\n\n<p>my goal is to verify that my public key is \"related\" to my hidden private key.</p>\n\n<p>solution using openssl cli:</p>\n\n<p>I have a certificate , the private key is hidden (in HSM)\nI have a buffer:</p>\n\n<pre><code>echo \"hello world!!!!\" &gt; sign.txt\n</code></pre>\n\n<p>using following commands I create sha256 signature of my buffer similar to what my HSM will do : </p>\n\n<pre><code>openssl dgst -sha256 -sign myrootca.key.insecure -out sign.sha256 sign.txt\n</code></pre>\n\n<p>extract public key:</p>\n\n<pre><code>openssl x509 -pubkey -noout -in myrootca.crt  &gt; myrootca.publicKey.pem\n</code></pre>\n\n<p>verify public key :</p>\n\n<pre><code>openssl dgst -sha256 -verify myrootca.publicKey.pem -signature sign.sha256 sign.txt\n</code></pre>\n\n<hr>\n\n<p>I think I know how to represent my public key and signature file correctly</p>\n\n<pre><code>sigkey = load_pubkey(bio_err, keyfile, keyform, 0, NULL,\n                                 e, \"key file\");\nsigbio = BIO_new_file(sigfile, \"rb\");\n</code></pre>\n\n<p>but can't find a proper API to continue from here </p>\n"}, {"tags": ["c", "random"], "comments": [{"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 1, "creation_date": 1511949961, "post_id": 47549990, "comment_id": 82056577, "body": "the <i>format specifier</i> for <code>printf()</code> is not right."}, {"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 0, "creation_date": 1511950045, "post_id": 47549990, "comment_id": 82056643, "body": "and besides: what is the result of rand() / RAND_MAX?"}, {"owner": {"reputation": 2134, "user_id": 2340703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gCs7t.png?s=128&g=1", "display_name": "Gregor Sturm", "link": "https://stackoverflow.com/users/2340703/gregor-sturm"}, "edited": false, "score": 1, "creation_date": 1511950119, "post_id": 47549990, "comment_id": 82056702, "body": "@dbran0 shouldn&#39;t that normalize the random number between 0 and 1? Correct me, if I&#39;m wrong"}, {"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 0, "creation_date": 1511951077, "post_id": 47549990, "comment_id": 82057408, "body": "gregor: my bad. The cast has precendence over division, so it&#39;s ok."}], "answers": [{"comments": [{"owner": {"reputation": 2134, "user_id": 2340703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gCs7t.png?s=128&g=1", "display_name": "Gregor Sturm", "link": "https://stackoverflow.com/users/2340703/gregor-sturm"}, "edited": false, "score": 2, "creation_date": 1511950444, "post_id": 47550045, "comment_id": 82056924, "body": "rather <code>RAND_MAX + 1</code>? otherwise it could even be &gt;1"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 2134, "user_id": 2340703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gCs7t.png?s=128&g=1", "display_name": "Gregor Sturm", "link": "https://stackoverflow.com/users/2340703/gregor-sturm"}, "edited": false, "score": 0, "creation_date": 1511950489, "post_id": 47550045, "comment_id": 82056946, "body": "@GregorSturm: Indeed, we&#39;ll publish jointly!"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 6, "last_activity_date": 1511950471, "last_edit_date": 1511950471, "creation_date": 1511949974, "answer_id": 47550045, "question_id": 47549990, "link": "https://stackoverflow.com/questions/47549990/random-double-in-loop-stays-constant/47550045#47550045", "title": "Random double in loop stays constant", "body": "<p>The behaviour of your code is undefined.</p>\n\n<p><code>(double) rand() / RAND_MAX</code> is an expression of type <code>double</code>. That requires a <code>%f</code> format specifier in your <code>printf</code> call.</p>\n\n<p>(Also note that <code>(double) rand() / RAND_MAX</code> can draw <code>1.0</code> which is idiosyncratic. Normally you write <code>RAND_MAX + 1</code> on the denominator.)</p>\n"}], "owner": {"reputation": 2134, "user_id": 2340703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gCs7t.png?s=128&g=1", "display_name": "Gregor Sturm", "link": "https://stackoverflow.com/users/2340703/gregor-sturm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 47550045, "answer_count": 1, "score": 3, "last_activity_date": 1511950628, "creation_date": 1511949830, "last_edit_date": 1511950566, "question_id": 47549990, "link": "https://stackoverflow.com/questions/47549990/random-double-in-loop-stays-constant", "title": "Random double in loop stays constant", "body": "<p>I have the following c-program to generate random numbers in a loop. \nWhile this works well for integers, when I try to generate a random double between 0 and 1, the value stays constant throughout the loop.</p>\n\n<ul>\n<li>Why does that happen?</li>\n<li>How can I generate a random double in [0, 1] within a loop?</li>\n</ul>\n\n<p>Source:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nint main(int argc, char** argv) {\n    srand(time(NULL));\n    for(int i=0; i&lt;5; i++) {\n        printf(\"%d\\n\", rand()); \n    }\n    for(int i=0; i&lt;5; i++) {\n        printf(\"%d\\n\", (double) rand() / RAND_MAX); \n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&gt;gcc -O3 -o test test.c -lm \n&gt;./test\n787380606\n1210256636\n1002592740\n1410731589\n737199770\n-684428956\n-684428956\n-684428956\n-684428956\n-684428956\n</code></pre>\n"}, {"tags": ["c#", "c", "c++-cli"], "answers": [{"comments": [{"owner": {"reputation": 6200, "user_id": 218640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b46c5c5c70b433012c437578243bf289?s=128&d=identicon&r=PG", "display_name": "char m", "link": "https://stackoverflow.com/users/218640/char-m"}, "edited": false, "score": 0, "creation_date": 1512048471, "post_id": 47554870, "comment_id": 82105958, "body": "thanks! i looked into it already. this would eliminate both C++/CLI &quot;bridge&quot; and managed dll."}], "tags": [], "owner": {"reputation": 61, "user_id": 9019651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1107ff29509c1e2c723a4864f96a43b9?s=128&d=identicon&r=PG&f=1", "display_name": "nick_b", "link": "https://stackoverflow.com/users/9019651/nick-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1511964925, "creation_date": 1511964925, "answer_id": 47554870, "question_id": 47549400, "link": "https://stackoverflow.com/questions/47549400/how-to-consume-wcf-web-service-from-native-c-code-without-manually-writing-a-c/47554870#47554870", "title": "How to consume WCF Web Service from native C code without manually writing a C++ CLI &quot;bridge&quot;?", "body": "<p>One time-saver here, both during development and at runtime, would be to remove the intermediate managed WCF client.</p>\n\n<p>A native toolset/SDK such as <a href=\"https://www.genivia.com/dev.html\" rel=\"nofollow noreferrer\">gSOAP</a> might fit the bill, dependent upon your licensing requirements. (Open-source and commercial versions are available.)</p>\n"}], "owner": {"reputation": 6200, "user_id": 218640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b46c5c5c70b433012c437578243bf289?s=128&d=identicon&r=PG", "display_name": "char m", "link": "https://stackoverflow.com/users/218640/char-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1511964925, "creation_date": 1511948066, "question_id": 47549400, "link": "https://stackoverflow.com/questions/47549400/how-to-consume-wcf-web-service-from-native-c-code-without-manually-writing-a-c", "title": "How to consume WCF Web Service from native C code without manually writing a C++ CLI &quot;bridge&quot;?", "body": "<p>I've been doing this before by </p>\n\n<ul>\n<li>Generating C# WCF WS Client with WSCF Blue from wsld-file to WSClient.dll</li>\n<li>Writing (manually) C++ CLI WSClientBridge.dll that has:\n\n<ul>\n<li>structs used in native C code (w/ arrays etc) for types in WSClient.dll </li>\n<li>conversion from managed types to native</li>\n<li>conversion from native types to managed</li>\n<li>exported functions that:\n\n<ul>\n<li>convert native structs to managed classes</li>\n<li>calls C# method in WSClient.dll</li>\n<li>convert managed classes to native structs</li>\n<li>return the native struct(s)</li>\n</ul></li>\n</ul></li>\n<li>Writing C code that calls exported functions WSClientBridge.dll and uses native types defined in WSClientBridge.dll </li>\n</ul>\n\n<p>This is both error-prone, difficult with complex hierarchical data and takes lots and lots of time. </p>\n\n<p>The question is: How to do this better in terms of time spent and error proneness?</p>\n"}, {"tags": ["c++", "c", "macros"], "comments": [{"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 2, "creation_date": 1511948284, "post_id": 47549362, "comment_id": 82055431, "body": "<a href=\"http://www.open-std.org/JTC1/SC22/WG14/www/docs/summary.htm#dr_483\" rel=\"nofollow noreferrer\">C DR 483</a>"}, {"owner": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "edited": false, "score": 0, "creation_date": 1511952252, "post_id": 47549362, "comment_id": 82058258, "body": "TL;DR: A macro doesn&#39;t expand when it&#39;s defined.  It expands each time when (and where) it is used."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "edited": false, "score": 0, "creation_date": 1511953395, "post_id": 47549362, "comment_id": 82059039, "body": "@lockcmpxchg8b - That&#39;s a bad TL;DR. I think the OP&#39;s confusion is that, at least on the face of it, <code>#define L __LINE__</code> <i>uses</i> <code>__LINE__</code>."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 9, "last_activity_date": 1511959615, "last_edit_date": 1511959615, "creation_date": 1511948340, "answer_id": 47549495, "question_id": 47549362, "link": "https://stackoverflow.com/questions/47549362/replacing-line-macro/47549495#47549495", "title": "Replacing __LINE__ macro", "body": "<p>If you want to print <code>10</code> then change <code>L</code> into something that is not a macro:</p>\n\n<pre><code>constexpr int L = __LINE__;\n</code></pre>\n\n<p>Otherwise the <em>macro</em> <code>L</code> would be substituted on the line <code>int i = L;</code> and become:</p>\n\n<pre><code>int i = __LINE__;\n</code></pre>\n\n<p>Where it will have to be substituted again for the line number, and read the last <code>#line</code> directive.</p>\n\n<p>Recall that macros perform token substitution. When you <code>#define L __LINE__</code> it only specifies what <strong>tokens</strong> should <code>L</code> be substituted for when it appears in the source. It does not substitute anything at the point of <code>L</code>'s own definition.</p>\n\n<p><a href=\"https://timsong-cpp.github.io/cppwp/n4659/cpp.replace#9\" rel=\"nofollow noreferrer\">C++ - [cpp.replace]/9</a> or <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.10.3p9\" rel=\"nofollow noreferrer\">C - [6.10.3 Macro replacement]/9</a></p>\n\n<blockquote>\n  <p>A preprocessing directive of the form</p>\n\n<pre><code># define identifier replacement-list new-line\n</code></pre>\n  \n  <p>defines an object-like macro that causes each subsequent instance of\n  the macro name to be replaced by the replacement list of preprocessing\n  tokens that constitute the remainder of the directive. The replacement\n  list is then rescanned for more macro names as specified below.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1511948508, "post_id": 47549510, "comment_id": 82055591, "body": "I think the misunderstanding was thinking that <code>__LINE__</code> would be expanded at the <code>#define L __LINE__</code>, rather than where <code>L</code> is used."}], "tags": [], "owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "is_accepted": false, "score": 3, "last_activity_date": 1511949108, "last_edit_date": 1511949108, "creation_date": 1511948384, "answer_id": 47549510, "question_id": 47549362, "link": "https://stackoverflow.com/questions/47549362/replacing-line-macro/47549510#47549510", "title": "Replacing __LINE__ macro", "body": "<p>Your <a href=\"http://en.cppreference.com/w/cpp/preprocessor/line\" rel=\"nofollow noreferrer\">#line</a> preprocessor directive changes the value to <code>20</code>:</p>\n\n<pre><code>#line 20\n</code></pre>\n\n<p>The macro is expanded where used (not where defined) which is in your <code>main()</code> function,  after the preprocessor directive which changes the value to <code>20</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 5, "last_activity_date": 1511948955, "creation_date": 1511948955, "answer_id": 47549687, "question_id": 47549362, "link": "https://stackoverflow.com/questions/47549362/replacing-line-macro/47549687#47549687", "title": "Replacing __LINE__ macro", "body": "<pre><code>  #define y 42\n  #define x y\n</code></pre>\n\n<p>This makes <code>x</code> defined as a sequence of preprocessing tokens that contains one token <code>y</code>. Not the token <code>42</code>.</p>\n\n<pre><code>  cout &lt;&lt; x;\n</code></pre>\n\n<p>This will expad <code>x</code> to <code>y</code> and <em>then</em> <code>y</code> to <code>42</code>.</p>\n\n<pre><code>#undef y\n#define y \"oops\"\n</code></pre>\n\n<p><code>x</code> is still defined as <code>y</code>.</p>\n\n<pre><code>cout &lt;&lt; x;\n</code></pre>\n\n<p>You guess what happens. <code>__LINE__</code> isn't special in this regard.</p>\n"}], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 1, "accepted_answer_id": 47549495, "answer_count": 3, "score": 0, "last_activity_date": 1511959615, "creation_date": 1511947979, "last_edit_date": 1511950026, "question_id": 47549362, "link": "https://stackoverflow.com/questions/47549362/replacing-line-macro", "title": "Replacing __LINE__ macro", "body": "<p>I read about macros using <a href=\"http://en.cppreference.com/w/cpp/preprocessor/replace\" rel=\"nofollow noreferrer\">Cppreference</a>. </p>\n\n<blockquote>\n  <p><strong>__LINE__</strong> : expands to the source file line number, an integer constant, can be changed by the <code>#line</code> directive</p>\n</blockquote>\n\n<p>I made c++ program to test <code>__LINE__</code> macro.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n#line 10\n#define L __LINE__\n\nint main() \n{\n    #line 20\n    int i = L;\n    cout&lt;&lt;i&lt;&lt;endl;\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output :</strong> </p>\n\n<pre><code>20\n</code></pre>\n\n<p>Why output of the above code is <code>20</code>? Why does not 10?</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1511948248, "post_id": 47549279, "comment_id": 82055406, "body": "Please always apply proper indentation to your code. Then it will be more visible that your <code>while</code> loop in <code>nodePrint</code> will loop forever."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1511948262, "post_id": 47549279, "comment_id": 82055414, "body": "Not directly related: <code>void nodeWrite(node *n,char *string,int x){ ..</code> is weird, you don&#39;t use the <code>n</code> parameter but you use directly the global variable <code>root</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1511948363, "post_id": 47549279, "comment_id": 82055487, "body": "All your function have parameter <code>n</code> but don&#39;t use it as they directly manipulate <code>root</code>. Is this intentional?"}, {"owner": {"reputation": 67, "user_id": 5601039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TWNm3.jpg?s=128&g=1", "display_name": "Tarkan Batar", "link": "https://stackoverflow.com/users/5601039/tarkan-batar"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1511948728, "post_id": 47549279, "comment_id": 82055749, "body": "Thanks for your advice guys, as I told before I&#39;m not really good at coding and I&#39;m trying to learning someting and gaining experience about it. Thanks again. @Gerhardh"}, {"owner": {"reputation": 67, "user_id": 5601039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TWNm3.jpg?s=128&g=1", "display_name": "Tarkan Batar", "link": "https://stackoverflow.com/users/5601039/tarkan-batar"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1511948872, "post_id": 47549279, "comment_id": 82055855, "body": "@MichaelWalz It is working but not useful understood. Thank you so much."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1511949002, "post_id": 47549279, "comment_id": 82055947, "body": "@TarkanBatar there is a huge difference between &quot;it is working&quot; and &quot;the program is properly written and it is working&quot;"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1511950019, "post_id": 47549279, "comment_id": 82056620, "body": "@TarkanBatar Especially when your are new and unexperienced with C, indentation is important. It provides hints about the structure. But be aware that indentation does not affect the code."}, {"owner": {"reputation": 67, "user_id": 5601039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TWNm3.jpg?s=128&g=1", "display_name": "Tarkan Batar", "link": "https://stackoverflow.com/users/5601039/tarkan-batar"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1511950206, "post_id": 47549279, "comment_id": 82056762, "body": "It seems agressive attitude on my comment but it is just about my bad English skills so sorry. I used &quot;understood&quot; means &quot;I understand it.&quot;. Forgive me :) @MichaelWalz"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1511950744, "post_id": 47549279, "comment_id": 82057131, "body": "@TarkanBatar no problem.I just wanted to point out that a poorly written program can still work correctly and do what you expect."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5601039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TWNm3.jpg?s=128&g=1", "display_name": "Tarkan Batar", "link": "https://stackoverflow.com/users/5601039/tarkan-batar"}, "edited": false, "score": 0, "creation_date": 1511948231, "post_id": 47549330, "comment_id": 82055392, "body": "I did it and it is working now, thank you so much @coderredoc"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 2, "last_activity_date": 1511948571, "last_edit_date": 1511948571, "creation_date": 1511947906, "answer_id": 47549330, "question_id": 47549279, "link": "https://stackoverflow.com/questions/47549279/c-programming-exc-bad-access-code1-address-0x0-error/47549330#47549330", "title": "C Programming EXC_BAD_ACCESS (code:1 ,address=0x0) Error", "body": "<p><code>data</code> is an unintialized pointer variable. Initialize with the address of a valid memory that you allocate. That will solve the problem. Now you have udnefined behavior.</p>\n\n<p>What you can possibly do is </p>\n\n<ol>\n<li><p>Use <code>char array</code> instead of using pointer.</p></li>\n<li><p>Allocate dynamically the memory.</p></li>\n</ol>\n\n<p>In case of 1.</p>\n\n<pre><code>struct node{\n\n     char data[MAXSTRINGLEN];\n     struct node *next;\n};\n</code></pre>\n\n<p>In case of 2:</p>\n\n<p>Initially make the pointers point to <code>NULL</code>. So now you can allocate to it like this</p>\n\n<pre><code>temp-&gt;data = malloc(sizeof *temp-&gt;data*MAXSTRINGLEN);\nif( temp-&gt;data == NULL)\n{\n    fprintf(stderr,\"Error in malloc\");\n    exit(1);\n}\n</code></pre>\n\n<p>Just one point, free the allocated memory when you are done working with it.</p>\n\n<p>Use of the global variable here is not really required here. You can always pass return pointers from memory and assign it to the <code>struct node*</code>. Or yes you can use double pointers. Use of global variable is not needed here. </p>\n\n<p>Clean up code, that are redundant and not required. That makes things readable and less confusing.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1511948881, "creation_date": 1511948881, "answer_id": 47549656, "question_id": 47549279, "link": "https://stackoverflow.com/questions/47549279/c-programming-exc-bad-access-code1-address-0x0-error/47549656#47549656", "title": "C Programming EXC_BAD_ACCESS (code:1 ,address=0x0) Error", "body": "<p>The program initially is designed incorrectly and has undefined behavior..</p>\n\n<p>For example the data member <code>data</code> of the node <code>root</code> was not initialized. So its output in the function <code>nodePrint</code> results in undefined behavior. Moreover the function itself is incorrect.</p>\n\n<p>Neither function uses its parameter <code>node *n</code>.</p>\n\n<p>In this statement</p>\n\n<pre><code>strcpy(temp-&gt;data,string);  \n</code></pre>\n\n<p>there is an attempt to change the string literal pointed to by the data member temp->data provided that the data member was initialized (as it was pointed above the data member is not initialized for the node <code>root</code>). You may not change a string literal. Any attempt to modify a string literal leads to undefined behavior.</p>\n\n<p>There is no need to declare the node <code>root</code> as a global variable.</p>\n\n<p>Parameters of the function <code>main</code> are not used in the program. So the function should be declared like</p>\n\n<pre><code>int main( void )\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 5601039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TWNm3.jpg?s=128&g=1", "display_name": "Tarkan Batar", "link": "https://stackoverflow.com/users/5601039/tarkan-batar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "accepted_answer_id": 47549330, "answer_count": 2, "score": 0, "last_activity_date": 1511952978, "creation_date": 1511947772, "last_edit_date": 1511952978, "question_id": 47549279, "link": "https://stackoverflow.com/questions/47549279/c-programming-exc-bad-access-code1-address-0x0-error", "title": "C Programming EXC_BAD_ACCESS (code:1 ,address=0x0) Error", "body": "<p>Hi guys I'm learning C programming. I wanted to write some codes for learning linked list topic but there is a problem. This code about creating linked list with 5 nodes, writing something into 3rd node, printing them to console.  </p>\n\n<p>Here is all of my codes: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;memory.h&gt;\n\nstruct node{    \n     char *data;\n     struct node *next;\n};\n\ntypedef struct node node;\nnode *root;\n\n\nvoid nodeAdd(node *n, int x)\n{    \n  node *iter;\n  iter=root;\n\n  for(int i=0;i&lt;x;i++)\n  {\n    iter-&gt;next = (node*)malloc(sizeof(node));\n    iter-&gt;next-&gt;data=\"0\";\n    iter-&gt;next-&gt;next=NULL;\n\n    iter=iter-&gt;next;\n    printf(\"Node created.\\n\");\n  }\n}\n\nvoid nodeWrite(node *n,char *string,int x)\n{\n  node *temp;\n  temp=root;\n\n  for(int k=0;k&lt;x;k++)\n  {\n    temp=temp-&gt;next;\n  }\n  strcpy(temp-&gt;data,string);  //HERE IS ERROR\n  printf(\"\\n\");\n  printf(\"%s \\n\",temp-&gt;data);\n  printf(\"Node writed.\");\n} \n\nvoid nodePrint(node *n)\n{\n  while(root-&gt;next!=NULL)\n    printf(\"%s\\n\",root-&gt;data);\n  root=root-&gt;next;\n}\n\nint main(int argc, const char * argv[])\n{\n  root = (node*)malloc(sizeof(node));\n\n  nodeAdd(root,5);\n  nodeWrite(root,\"WTF\", 3);\n  nodePrint(root);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "networking"], "answers": [{"comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1511949124, "post_id": 47549620, "comment_id": 82056023, "body": "With a link to the header doc and maybe a short example, this could be a good answer ;)"}, {"owner": {"reputation": 1, "user_id": 8871891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wtrfg.jpg?s=128&g=1", "display_name": "z.x", "link": "https://stackoverflow.com/users/8871891/z-x"}, "edited": false, "score": 0, "creation_date": 1511956558, "post_id": 47549620, "comment_id": 82060949, "body": "I do not found the  field which return &quot;Link encap&quot;(net type).            ioctl(sock, SIOCGIFADDR, &amp;ifr)--------&gt;get ip"}], "tags": [], "owner": {"reputation": 1, "user_id": 4007029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca1af6233c8be8e2d25188d8cb4c5ce?s=128&d=identicon&r=PG&f=1", "display_name": "qazwsx897", "link": "https://stackoverflow.com/users/4007029/qazwsx897"}, "is_accepted": false, "score": 0, "last_activity_date": 1511948767, "creation_date": 1511948767, "answer_id": 47549620, "question_id": 47549228, "link": "https://stackoverflow.com/questions/47549228/how-to-get-net-encap-in-c-c-on-linux/47549620#47549620", "title": "How to get net encap in c\\c++ on linux?", "body": "<p>Please look at the struct <code>ifreq</code> in the <code>&lt;net/if.h&gt;</code></p>\n\n<pre><code>/* Interface request structure used for socket ioctl's. All interface ioctl's must have\nparameter definitions which begin with ifr_name. The remainder may be interface specific. */\n\nstruct ifreq\n  {\n# define IFHWADDRLEN 6\n# define IFNAMSIZ IF_NAMESIZE\n    union\n      {\n        char ifrn_name[IFNAMSIZ]; /* Interface name, e.g. \"en0\". */\n      } ifr_ifrn;\n\n    union\n      {\n        struct sockaddr ifru_addr;\n        struct sockaddr ifru_dstaddr;\n        struct sockaddr ifru_broadaddr;\n        struct sockaddr ifru_netmask;\n        struct sockaddr ifru_hwaddr;\n        short int ifru_flags;\n        int ifru_ivalue;\n        int ifru_mtu;\n        struct ifmap ifru_map;\n        char ifru_slave[IFNAMSIZ]; /* Just fits the size */\n        char ifru_newname[IFNAMSIZ];\n         __caddr_t ifru_data;\n      } ifr_ifru;\n  };\n# define ifr_name ifr_ifrn.ifrn_name /* interface name */\n# define ifr_hwaddr ifr_ifru.ifru_hwaddr /* MAC address */\n# define ifr_addr ifr_ifru.ifru_addr /* address */\n# define ifr_dstaddr ifr_ifru.ifru_dstaddr /* other end of p-p lnk */\n# define ifr_broadaddr ifr_ifru.ifru_broadaddr /* broadcast address */\n# define ifr_netmask ifr_ifru.ifru_netmask /* interface net mask */\n# define ifr_flags ifr_ifru.ifru_flags /* flags */\n# define ifr_metric ifr_ifru.ifru_ivalue /* metric */\n# define ifr_mtu ifr_ifru.ifru_mtu /* mtu */\n# define ifr_map ifr_ifru.ifru_map /* device map */\n# define ifr_slave ifr_ifru.ifru_slave /* slave device */\n# define ifr_data ifr_ifru.ifru_data /* for use by interface */\n# define ifr_ifindex ifr_ifru.ifru_ivalue /* interface index */\n# define ifr_bandwidth ifr_ifru.ifru_ivalue /* link bandwidth */\n# define ifr_qlen ifr_ifru.ifru_ivalue /* queue length */\n# define ifr_newname ifr_ifru.ifru_newname /* New name */\n# define _IOT_ifreq _IOT(_IOTS(char),IFNAMSIZ,_IOTS(char),16,0,0)\n# define _IOT_ifreq_short _IOT(_IOTS(char),IFNAMSIZ,_IOTS(short),1,0,0)\n# define _IOT_ifreq_int _IOT(_IOTS(char),IFNAMSIZ,_IOTS(int),1,0,0)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8871891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wtrfg.jpg?s=128&g=1", "display_name": "z.x", "link": "https://stackoverflow.com/users/8871891/z-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511948767, "creation_date": 1511947609, "last_edit_date": 1511948399, "question_id": 47549228, "link": "https://stackoverflow.com/questions/47549228/how-to-get-net-encap-in-c-c-on-linux", "title": "How to get net encap in c\\c++ on linux?", "body": "<ul>\n<li><p>Is there a way in Linux, using C\\C++ code, to get the information about all network adapters \"Link encap:*****\"? I had already got things like IP address and MAC address.</p></li>\n<li><p>Here's sample output from ifconfig:</p>\n\n<pre><code>ethx  Link encap:Ethernet  HWaddr 00:0F:20:CF:8B:42\n      inet addr:217.149.127.10  Bcast:217.149.127.63  Mask:255.255.255.192\n      UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n      RX packets:2472694671 errors:1 dropped:0 overruns:0 frame:0\n      TX packets:44641779 errors:0 dropped:0 overruns:0 carrier:0\n      collisions:0 txqueuelen:1000\n      RX bytes:1761467179 (1679.8 Mb)  TX bytes:2870928587 (2737.9 Mb)\n      Interrupt:28 \n</code></pre></li>\n</ul>\n"}, {"tags": ["c", "malloc", "calloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1511947408, "post_id": 47549140, "comment_id": 82054806, "body": "1) I see no <code>main()</code> 2) missing return type is a sign of  <i>bad</i> source of learning."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1511947444, "post_id": 47549140, "comment_id": 82054834, "body": "<code>array=(char **) malloc(1m*sizeof(char *));</code> should be <code>array = malloc(m * sizeof *array);</code>. That <code>1m</code> is a syntax error."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1511947497, "post_id": 47549140, "comment_id": 82054873, "body": "Please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>, and learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1511947712, "post_id": 47549140, "comment_id": 82055035, "body": "Given typos like <code>1m</code>, it appears that this code was re-typed by hand rather than copy/pasted.  As such, it only approximates the code that was actually run.  That means that your results will not be reliably replicated."}, {"owner": {"reputation": 77, "user_id": 6224890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6068acc845dfa52558f31bb210b68a0a?s=128&d=identicon&r=PG&f=1", "display_name": "D Sam", "link": "https://stackoverflow.com/users/6224890/d-sam"}, "edited": false, "score": 0, "creation_date": 1511947842, "post_id": 47549140, "comment_id": 82055120, "body": "I added the main and changed the typo, thanks"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1511947882, "post_id": 47549140, "comment_id": 82055146, "body": "Please post real code <code>constructorArray(m,n) {..</code>  is not C."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1511948322, "post_id": 47549140, "comment_id": 82055460, "body": "Please learn how to indent your code."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1511948631, "post_id": 47549140, "comment_id": 82055676, "body": "@MichaelWalz <code>constructorArray(m,n)</code> it is valid K&amp;R C. So if his compiler is really old..."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1511948753, "post_id": 47549140, "comment_id": 82055764, "body": "@JeremyP OK, your&#39;re probably right, but normally nobody should have written K&amp;R for the last 10 (or even 20?) years."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1511949043, "post_id": 47549140, "comment_id": 82055979, "body": "@MichaelWalz 19 years ago I was arguing at the company I worked for that we should stop using the weird parameter macros that we had to allow our code to compile in both K&amp;R and ANSI C. So yes, people shouldn&#39;t have been using it for 20 years IMO."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 2, "last_activity_date": 1511948005, "creation_date": 1511948005, "answer_id": 47549377, "question_id": 47549140, "link": "https://stackoverflow.com/questions/47549140/create-a-dynamic-array-and-initialize-it/47549377#47549377", "title": "Create a dynamic array and initialize it", "body": "<p>It seems you have some believes that are incorrect.</p>\n\n<p>First, you do no correctly declare your C functions:</p>\n\n<pre><code>constructorArray(m,n)\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>void constructorArray(int m, int n)\n</code></pre>\n\n<p>Then it seems that you think a constructor will be called automatically in C, which is not so, so simply writing <code>array[m][n]</code> in <code>CreateMaze</code> won't work. You should write:</p>\n\n<pre><code>char **array;    // it will be allocated dynamically\n</code></pre>\n\n<p>and then have your function:</p>\n\n<pre><code>char **constructorArray(int m, int n)\n{ \n    char **array= malloc(m*sizeof(char *));\n\n    for(int i=0; i&lt;m; i++)\n        array[i]= malloc(n*sizeof(char));\n\n    return array;\n}\n</code></pre>\n\n<p>which you now can call as:</p>\n\n<pre><code>char **array= constructorArray(m, n);\n</code></pre>\n\n<p>Note: your use of the array suggests an array of ints could be more sutiable.</p>\n"}], "owner": {"reputation": 77, "user_id": 6224890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6068acc845dfa52558f31bb210b68a0a?s=128&d=identicon&r=PG&f=1", "display_name": "D Sam", "link": "https://stackoverflow.com/users/6224890/d-sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 47549377, "answer_count": 1, "score": -3, "last_activity_date": 1526481459, "creation_date": 1511947324, "last_edit_date": 1526481459, "question_id": 47549140, "link": "https://stackoverflow.com/questions/47549140/create-a-dynamic-array-and-initialize-it", "title": "Create a dynamic array and initialize it", "body": "<p>for a school project, we have to create a maze in c, I'm a beginner in that language, so I'm stuck at the very beginning: creating an array dynamically...</p>\n\n<p>I read about malloc and calloc, and tried to use it but with no success...</p>\n\n<p>here is my code:</p>\n\n<pre><code>/* define maze structure */\n\ntypedef struct _maze_t {\n    int m, n;\n    char **array;\n} Maze;\n\nvoid constructorArray(int m,int n)\n{ \n    array = malloc(m * sizeof *array);\n\n    for(i=0;i&lt;m;i++){\n        array[i]=(char *) malloc(n*sizeof(char)); \n    }\n    array = calloc(m, sizeof *array);\n\n    for (i=0; i&lt;m; i++){\n      array[i] = calloc(n, sizeof *(array[i]));\n    }   \n}\nvoid createMaze(int ncolumn, int mlign)\n{    \n    int m=mlign;\n    int n=ncolumn;\n    int counter=0; \n\n    constructorArray(m,n) ;     \n\n    char **array;            \n\n    for(i=0;i&lt;m;i++)\n    {\n        for(y=0;y&lt;n;y++)\n        {\n            array[i][y]=counter;\n            counter++;\n        }\n    }\n}\n\nint main()\n{\n    createMaze(100,100);    \n    return 0;\n}\n</code></pre>\n\n<p>Could someone explain to me how to do it right?</p>\n"}, {"tags": ["c", "pointers", "type-conversion", "boolean"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1511946698, "post_id": 47548883, "comment_id": 82054339, "body": "<code>val</code> is a constant pointer, so you must initialize it (make it point somewhere) when you define the variable. Once you have done that, all pointers are implicitly convertible to a boolean value, with only a null pointer being false. So what you have (with the exception of you missing the pointer initialization) will work as you expect (I think)."}, {"owner": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "edited": false, "score": 1, "creation_date": 1511952563, "post_id": 47548883, "comment_id": 82058472, "body": "The common interpretation of a pointer in a Boolean context is to ask &quot;does the pointer point at something? (true) or is it a null pointer (false)?&quot;. Is this what you mean?"}], "answers": [{"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1511948572, "post_id": 47549442, "comment_id": 82055631, "body": "What&#39;s up with the typedefs? These types are included in <code>stdint.h</code> and <code>stdbool.h</code>."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1511948643, "post_id": 47549442, "comment_id": 82055684, "body": "I wanted OP to understand that the same is applicable to all data types including user defined ones."}], "tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": false, "score": 2, "last_activity_date": 1512995499, "last_edit_date": 1512995499, "creation_date": 1511948185, "answer_id": 47549442, "question_id": 47548883, "link": "https://stackoverflow.com/questions/47548883/how-to-convert-const-uint8-t-const-to-bool/47549442#47549442", "title": "How to convert const uint8_t * const to bool", "body": "<p>Here is the problem:</p>\n\n<pre><code>const uint8_t * const val;\n</code></pre>\n\n<p>its a <code>const</code> pointer to a <code>const uint8_t</code>, so either you have to make it point to some valid memory, typically a <code>const</code> variable/value, or get rid of <code>const</code>ness.</p>\n\n<p>With warnings enabled, the compiler would have generated a warning on this statement:</p>\n\n<pre><code>const bool res = (val &amp;&amp; (num&gt;0));\n</code></pre>\n\n<p>because, <code>val</code> wasn't initialized. In your case, the Compiler complains here because it is Undefined Behavior. But, I get that the question is not about why or how is it a case of Undefined Behavior, so lets not get into that.</p>\n\n<p>See the code below:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\ntypedef unsigned char uint8_t; // There are better ways of doing it, but I am lazy right now\ntypedef enum { TRUE = 1, FALSE = 0 } Bool_t; // There are better ways of doing it, but I am lazy right now\n\nint main() {\n\n    const uint8_t ch = 'A'; //0x41\n\n    // Below initialization/assignment is what you missed.\n    const uint8_t * const val = &amp;ch;\n    int num = 5;\n    const Bool_t res = *val + num;\n    //The above assignment is not suited in terms of accuracy because, \n    //`res` is type `Bool_t`, so it *should* ideally be assigned \n    //with values either TRUE or FALSE, but anyways, here we go.\n\n    printf(\"0x%x\", res);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0x46\n</code></pre>\n\n<p>Which is as expected: <code>'A'</code> + <code>0x05</code> is <code>0x46</code>.</p>\n\n<p>Note: You could always make a habit of compiling the code with all the warnings enabled. Take out some spare time and read <a href=\"https://gcc.gnu.org/onlinedocs/gcc-5.4.0/gcc/Warning-Options.html\" rel=\"nofollow noreferrer\">this rich documentation</a>. Till then, <code>-wall</code> or better yet <code>-werror</code> is what you need.</p>\n"}, {"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 1, "last_activity_date": 1511948614, "last_edit_date": 1511948614, "creation_date": 1511948262, "answer_id": 47549471, "question_id": 47548883, "link": "https://stackoverflow.com/questions/47548883/how-to-convert-const-uint8-t-const-to-bool/47549471#47549471", "title": "How to convert const uint8_t * const to bool", "body": "<p>If you compile your code with warnings enabled, you will get:</p>\n\n<pre><code>warning: 'val' is used uninitialized in this function [-Wuninitialized]\n    const bool res = (val &amp;&amp; (num&gt;0));\n                     ~~~~~^~~~~~~~~~~\n</code></pre>\n\n<p>which comes from the fact that you declare you pointer, but you don't initiailze it, here:</p>\n\n<pre><code>const uint8_t * const val;\n</code></pre>\n\n<p>Initialize it to a value, like this for example:</p>\n\n<pre><code>uint8_t v = 5; // example value\nconst uint8_t * const val = &amp;v;\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>How to convert <code>const uint8_t * const</code> to <code>bool</code>?</p>\n</blockquote>\n\n<p>Regardless of the <code>const</code> keywords you have there, you need to focus in the fact that you have a pointer.</p>\n\n<p>All pointers are <strong>implicitly convertible</strong> to a boolean value (thus <code>bool</code> too), meaning that you don't have to do something more, your code shall do the trick (now that you initialized <code>val</code>).</p>\n"}], "owner": {"reputation": 19, "user_id": 9024642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/663608dd317aab12bc5a79ac5327802d?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/9024642/prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1512995499, "creation_date": 1511946540, "last_edit_date": 1511954021, "question_id": 47548883, "link": "https://stackoverflow.com/questions/47548883/how-to-convert-const-uint8-t-const-to-bool", "title": "How to convert const uint8_t * const to bool", "body": "<pre><code>const uint8_t * const val;\nint num = 5;\nconst bool res = (val &amp;&amp; (num&gt;0));\n</code></pre>\n\n<p>Here, I need to convert a pointer of the type const <code>uint8_t* const</code> to <code>bool</code>. \nHow can/should I do that?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1511944557, "post_id": 47548244, "comment_id": 82053037, "body": "<code>FILE* inputFile</code>: you&#39;re losing the file handle, assigned locally only.*"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1511944693, "post_id": 47548244, "comment_id": 82053130, "body": "So the <code>FILE*</code> is a result of your function. Why (and how) would you pass it as an argument? Why don&#39;t you just <code>return</code> it from the function?"}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1511944639, "creation_date": 1511944639, "answer_id": 47548335, "question_id": 47548244, "link": "https://stackoverflow.com/questions/47548244/how-to-create-function-that-opens-files-and-lets-other-functions-use-them/47548335#47548335", "title": "How to create function that opens files and let&#39;s other functions use them?", "body": "<p>Your prototype makes no sense, <code>openFile()</code> can't change the caller's <code>FILE *</code> when it's passed by value, you need to pass the address of the pointer in that case:</p>\n\n<pre><code>int openFile(FILE **inputFile)\n{\n  *inputFile = fopen(\"input.txt\", \"rt\");\n  return *inputFile == NULL ? -1 : 0;\n}\n</code></pre>\n\n<p>But of course this serves very little purpose, just use <code>fopen()</code> directly where you want to open a file, instead. Returning the pointer to the open file is easier to work with, instead of having to manage a separate <code>int</code> that carries no added value or information (an <code>int</code> being 0 or -1 is not \"better\" than a pointer being <code>NULL</code> or not <code>NULL</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 0, "last_activity_date": 1511945421, "last_edit_date": 1511945421, "creation_date": 1511944667, "answer_id": 47548344, "question_id": 47548244, "link": "https://stackoverflow.com/questions/47548244/how-to-create-function-that-opens-files-and-lets-other-functions-use-them/47548344#47548344", "title": "How to create function that opens files and let&#39;s other functions use them?", "body": "<p>You should return <code>inputFile</code> itself. That wauy you can reused it from other function.\nAlso why pass that <code>FILE*</code> to <code>openFile</code> function? It's redundant.</p>\n\n<p>Design-wise you can pass the filename and the parameters like <code>r</code>,<code>w</code> etc.</p>\n\n<pre><code>FILE* openFile(const char*name, const char*params)\n{\n    inputFile = fopen(name, params);\n\n    if (inputFile != NULL)\n        return inputFile;\n    else\n        return NULL;\n}\n</code></pre>\n\n<p>But in doing that you are just abstracting out the <code>fopen()</code> call. You still have to check the return value of <code>openFile()</code>. You can use double pointer and achieve the same thing but yes I have provided with an alternative. </p>\n\n<pre><code>FILE *inputFile = openFile(\"input.txt\",\"r\");\nif( !inputFile ){\n    //...\n}\n</code></pre>\n\n<p>The thing is as far as the method shown this is really doing anything other than wrapping the <code>fopen()</code> call. What you can get to know from this answer that you can pass the pointer around in Functions and how to use it.</p>\n\n<p>Other answer provides how you use the double pointer but do you get what happened in previous case?</p>\n\n<p>You are changing the local variable that is passed to <code>openFile()</code>. You change it. And when the function completes then that local variable is not there anymore. It's value wont affect the <code>FILE*</code> variable in <code>main()</code>.</p>\n\n<p>To be clear you don't need this method to open a file. It's better if you use the 2 lines alone. Because there is no improvement whatsoever. You still have to check the return value just like you would have in case of direct <code>fopen</code> call.</p>\n"}], "owner": {"reputation": 63, "user_id": 6187574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d37b22f4042e8acb3e5d2f64c2f0b2a3?s=128&d=identicon&r=PG&f=1", "display_name": "Smorts", "link": "https://stackoverflow.com/users/6187574/smorts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1511945118, "answer_count": 2, "score": -1, "last_activity_date": 1511945421, "creation_date": 1511944332, "question_id": 47548244, "link": "https://stackoverflow.com/questions/47548244/how-to-create-function-that-opens-files-and-lets-other-functions-use-them", "closed_reason": "Duplicate", "title": "How to create function that opens files and let&#39;s other functions use them?", "body": "<p>I want to create the function that opens a file and then other functions use this opened file. This is my code,</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint openFile(FILE* inputFile)\n{\n    inputFile = fopen(\"input.txt\", \"r\");\n\n    if (inputFile != NULL)\n        return 0;\n    else\n        return -1;\n}\nvoid readWholeFile(FILE* inputFile)\n{\n    char str[20];\n    while (feof(inputFile)) {\n        fscanf(inputFile, str);\n        printf(\"%s\\n\", str);\n    }\n}\nint main() {\n\n    FILE* inputFile;\n\n    if (openFile(inputFile) == 0) {\n        readWholeFile(inputFile);\n    }\n    else\n        printf(\"File didn't open\");\n        fclose(inputFile);    \n\n    return 0;\n}\n</code></pre>\n\n<p>\"File didn't open\" is not printed so the file should be opened but actually readWholeFile prints nothing as a file would be empty. What's the problem?</p>\n"}, {"tags": ["c", "multithreading", "binary", "openmp", "bit-shift"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1511945781, "post_id": 47548227, "comment_id": 82053776, "body": "You didn&#39;t really ask a question. A file is, by definition, a stream of bytes."}, {"owner": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "edited": false, "score": 0, "creation_date": 1511953020, "post_id": 47548227, "comment_id": 82058765, "body": "The data is small enough, you can probably pass it all to one collector who writes the file.  Else you can have a token that starts at thread 1, and once he writes, he passes the token to thread 2... Here, token can just be a message used to synchronize the writes...or a shared variable that is only written by a thread when it&#39;s current value matches the thread number."}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 5713799, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/956124104436835/picture?type=large", "display_name": "Beniamin Ionut Dobre", "link": "https://stackoverflow.com/users/5713799/beniamin-ionut-dobre"}, "edited": false, "score": 0, "creation_date": 1512062414, "post_id": 47548535, "comment_id": 82115236, "body": "lets say i know exactly the number of bits generated by each thread. I am not sure if i can shift easily the sequence of bits (not just 8 bits, but hundreds of bytes) or i should keep the first bits from thread 2 that fill the gap from thread 1 and the other bits from thread 2 in bytes"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1511945337, "creation_date": 1511945337, "answer_id": 47548535, "question_id": 47548227, "link": "https://stackoverflow.com/questions/47548227/write-bits-sequences-from-threads-in-order/47548535#47548535", "title": "Write bits sequences from threads in order", "body": "<p>You can't do file I/O directly from the threads, as that would not do any synchronization and things would not end up in the proper order.</p>\n\n<p>If you know in advance how many bits each thread can generate, I would just pre-allocate the storage in the parent process, and hand each thread its working area. Then when the threads have joined, the parent process can write out the data in the proper order.</p>\n"}], "owner": {"reputation": 169, "user_id": 5713799, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/956124104436835/picture?type=large", "display_name": "Beniamin Ionut Dobre", "link": "https://stackoverflow.com/users/5713799/beniamin-ionut-dobre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1512062537, "creation_date": 1511944278, "last_edit_date": 1512062537, "question_id": 47548227, "link": "https://stackoverflow.com/questions/47548227/write-bits-sequences-from-threads-in-order", "title": "Write bits sequences from threads in order", "body": "<p>I have parallel program. On each thread a have a sequence of bits stored in a char*. <br>\nMy brains gets seg fault when I am thinking how to write this bits in a file. The bits from 1st thread then the bits from the second and so on without the 0s need to have full bytes.</p>\n\n<p>I an example will be very usefull. The data <strong>is not</strong> this small it can be 100MB <br>\nthread 1: 13 bits 1011 1111 0110 0(000)  because i can't store 13 bits i can store 2 bytes<br>\nthread 2: 9 bits 1001 1011 0(000 0000)<br>\nthread 3: 7 bits 1011 111(0) <br>\nthread 4: 5 bits 0001 1(000) <br></p>\n\n<p><strong>Question:</strong>\nHow can I can I get the end result in a file or char* as this? <br>\n1011 1111 0110 0100 1101 1010 1111 1000 11(00 0000)<br></p>\n\n<p>If it helps i can put \\' when the bits come from a different thread<br>\n1011 1111 0110 0'100 1101 10'10 1111 1'000 11(00 0000)<br></p>\n"}, {"tags": ["c", "gcc", "glibc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1511943893, "post_id": 47548091, "comment_id": 82052674, "body": "what is <code>gblic</code>? Did you mean <code>glibc</code>?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1511943947, "post_id": 47548091, "comment_id": 82052701, "body": "<a href=\"https://stackoverflow.com/q/16376341/2173917\">Related?</a>"}, {"owner": {"reputation": 111, "user_id": 5820730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41103f66511a6a3e726150c6c924d77c?s=128&d=identicon&r=PG&f=1", "display_name": "hrl", "link": "https://stackoverflow.com/users/5820730/hrl"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1511944163, "post_id": 47548091, "comment_id": 82052811, "body": "@SouravGhosh I mean  the superset of all  other standards under GNU C libraries."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1511944237, "post_id": 47548091, "comment_id": 82052857, "body": "Why this C++1 tag? What does this have to do with C++ ?"}, {"owner": {"reputation": 111, "user_id": 5820730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41103f66511a6a3e726150c6c924d77c?s=128&d=identicon&r=PG&f=1", "display_name": "hrl", "link": "https://stackoverflow.com/users/5820730/hrl"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1511944381, "post_id": 47548091, "comment_id": 82052938, "body": "@JensGustedt em,isn&#39;t gcc similar to c++?"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1511944501, "post_id": 47548091, "comment_id": 82052997, "body": "@hrl, gcc is a compiler C++ is a programming language. How can one be another? gcc is a compiler for many languages, C and C++ among them."}, {"owner": {"reputation": 111, "user_id": 5820730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41103f66511a6a3e726150c6c924d77c?s=128&d=identicon&r=PG&f=1", "display_name": "hrl", "link": "https://stackoverflow.com/users/5820730/hrl"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1511944658, "post_id": 47548091, "comment_id": 82053107, "body": "@SouravGhosh Thanks for your  recommendation.It may related to my question ,but I don&#39;t understand its  conclusion and can&#39;t get a solution from it."}, {"owner": {"reputation": 111, "user_id": 5820730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41103f66511a6a3e726150c6c924d77c?s=128&d=identicon&r=PG&f=1", "display_name": "hrl", "link": "https://stackoverflow.com/users/5820730/hrl"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1511944836, "post_id": 47548091, "comment_id": 82053212, "body": "@JensGustedt I am sorry for that. I will add gcc tag and remove the c++ tag,thanks.But as you know ,gcc is a compiler for many languages , I just think someone who is good at c++ may also know more about gcc complier and help me to find the answer .So that I add the c++ tag."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1511954183, "post_id": 47548091, "comment_id": 82059569, "body": "&quot;So that I add the c++ tag.&quot; This is called &quot;tag spamming&quot; and it&#39;s considered as bad behavior."}, {"owner": {"reputation": 111, "user_id": 5820730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41103f66511a6a3e726150c6c924d77c?s=128&d=identicon&r=PG&f=1", "display_name": "hrl", "link": "https://stackoverflow.com/users/5820730/hrl"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1512005448, "post_id": 47548091, "comment_id": 82087059, "body": "@Scheff I&#39;m sorry about that. I&#39;ll pay attention next time"}], "answers": [{"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1560485840, "post_id": 47552158, "comment_id": 99759805, "body": "This is so wrong. First of all, it&#39;s <code>-D_GNU_SOURCE</code>, not <code>-DGNU_SOURCE</code> or <code>-GNU_SOURCE</code>. Second of all, header files are located in <code>&#47;usr&#47;include</code>, not <code>&#47;usr&#47;lib</code>."}], "tags": [], "owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "is_accepted": false, "score": 0, "last_activity_date": 1600195564, "last_edit_date": 1600195564, "creation_date": 1511956237, "answer_id": 47552158, "question_id": 47548091, "link": "https://stackoverflow.com/questions/47548091/why-gcc-need-d-gnu-source/47552158#47552158", "title": "Why gcc need -D_GNU_SOURCE", "body": "<p>You need <code>-D_GNU_SOURCE</code> in-order to use GNU extension features/functions. You can use low level functions such as <code>socket</code>, <code>ifconfig</code>, etc.</p>\n<blockquote>\n<p>Macro: _GNU_SOURCE If you define this macro, everything is included:\nISO C89, ISO C99, POSIX.1, POSIX.2, BSD, SVID, X/Open, LFS, and GNU\nextensions. In the cases where POSIX.1 conflicts with BSD, the POSIX\ndefinitions take precedence.</p>\n</blockquote>\n<p>Compiling without <code>-D_GNU_SOURCE</code> may run on one Linux machine without any problem but then fail on other Linux variants if they use a different C standard library.</p>\n<hr />\n<p><strong>Very straight forward answer:</strong></p>\n<ul>\n<li><p><code>#define _GNU_SOURCE 1</code> enables GNU extensions supported by the GNU C library. Define it when you're using non-standard functions and macros.  In your case, you're trying to use a non-standard function that is part of POSIX, that's why you need to <code>#define _GNU_SOURCE 1</code>.</p>\n</li>\n<li><p>You want to get the full effect of <code>_GNU_SOURCE</code> but make the BSD\ndefinitions take precedence over the POSIX definitions, the use the <code>_GNU_SOURCE</code>.</p>\n</li>\n</ul>\n<p>Check this answer for more info about defining <a href=\"https://stackoverflow.com/a/5583764/7640269\">_GNU_SOURCE.</a></p>\n"}], "owner": {"reputation": 111, "user_id": 5820730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41103f66511a6a3e726150c6c924d77c?s=128&d=identicon&r=PG&f=1", "display_name": "hrl", "link": "https://stackoverflow.com/users/5820730/hrl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1170, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1600195564, "creation_date": 1511943791, "last_edit_date": 1511944748, "question_id": 47548091, "link": "https://stackoverflow.com/questions/47548091/why-gcc-need-d-gnu-source", "title": "Why gcc need -D_GNU_SOURCE", "body": "<p>When I make a gcc compile command with the option \"-L\",I should add the gblic library path or add -D_GNU_SOURCE or the gcc will run error.</p>\n\n<pre><code>$gcc sscanf_test.c -I/si/usr/aa/include/arch -o sscanf_test_2  -m64  -L$ORACLE_HOME/precomp/lib/ -L$ORACLE_HOME/lib/ -L$ORACLE_HOME/lib/stubs/ -lc\n$/tmp/ccq1Z6T1.o\uff1afunction \u2018main\u2019\uff1a\n  sscanf_test.c:(.text+0x32)\uff1aundefined reference to \u2018__isoc99_sscanf\u2019\n  sscanf_test.c:(.text+0xf8)\uff1aundefined reference to \u2018__isoc99_sscanf\u2019\n  sscanf_test.c:(.text+0x1e4)\uff1aundefined reference to \u2018__isoc99_sscanf\u2019\n  collect2: ld return 1\n$gcc sscanf_test.c -I/si/usr/aa/include/arch -o sscanf_test_2  -m64  -L$ORACLE_HOME/precomp/lib/ -L$ORACLE_HOME/lib/ -L$ORACLE_HOME/lib/stubs/ -D_GNU_SOURCE\n$gcc sscanf_test.c -I/si/usr/aa/include/arch -o sscanf_test_2  -m64  -L$ORACLE_HOME/precomp/lib/ -L$ORACLE_HOME/lib/ -L$ORACLE_HOME/lib/stubs/ /lib64/libc.so.6\n</code></pre>\n\n<p>Now, I have puzzle that why gcc need  -D_GNU_SOURCE.Another machine have a similar environment can run normally without -D_GNU_SOURCE.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1511943726, "post_id": 47548042, "comment_id": 82052584, "body": "I don&#39;t know where you got that header. but if you wrote it yourself, prefer <code>stddef.h</code> over defining your own <code>offsetoff</code>. The former is not dancing with UB."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1511943749, "post_id": 47548042, "comment_id": 82052596, "body": "You must have got the error message in a form &quot;...previously defined in....&quot;, rings a bell?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1511943772, "post_id": 47548042, "comment_id": 82052610, "body": "What is the purpose of using the full absolute path in e.g. <code>#include &quot;&#47;usr&#47;include&#47;sys&#47;queue.h&quot;</code>? Why not simply <code>#include &lt;sys&#47;queue.h&gt;</code>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1511943854, "post_id": 47548042, "comment_id": 82052655, "body": "Also please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. Then edit your question to improve it, for example to copy (as text!) the <i>full</i> and <i>complete</i> output from the compiler, and paste it into the body of the question (without modifications)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1511943901, "post_id": 47548042, "comment_id": 82052679, "body": "Lastly, <code>offsetof</code> is a <a href=\"http://en.cppreference.com/w/c/types/offsetof\" rel=\"nofollow noreferrer\">standard C macro</a>. Don&#39;t define it yourself."}, {"owner": {"reputation": 11, "user_id": 9024280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0a006a2b4b12e56449b5029b54845f?s=128&d=identicon&r=PG&f=1", "display_name": "xiaokang", "link": "https://stackoverflow.com/users/9024280/xiaokang"}, "edited": false, "score": 0, "creation_date": 1511944372, "post_id": 47548042, "comment_id": 82052933, "body": "hmmm  yeah  i know include&lt;stddef.h&gt; definde offsetoff , but it&#39;s not problem,some structure come from Library functions in freebsd"}, {"owner": {"reputation": 11, "user_id": 9024280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0a006a2b4b12e56449b5029b54845f?s=128&d=identicon&r=PG&f=1", "display_name": "xiaokang", "link": "https://stackoverflow.com/users/9024280/xiaokang"}, "edited": false, "score": 0, "creation_date": 1511944477, "post_id": 47548042, "comment_id": 82052981, "body": "sorry,this is my first time ask question"}, {"owner": {"reputation": 11, "user_id": 9024280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0a006a2b4b12e56449b5029b54845f?s=128&d=identicon&r=PG&f=1", "display_name": "xiaokang", "link": "https://stackoverflow.com/users/9024280/xiaokang"}, "edited": false, "score": 0, "creation_date": 1511944561, "post_id": 47548042, "comment_id": 82053042, "body": "some like #include&lt;sys/XXX.h&gt;, it maybe can&#39;t find on freebsd, i need to designate it"}, {"owner": {"reputation": 11, "user_id": 9024280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0a006a2b4b12e56449b5029b54845f?s=128&d=identicon&r=PG&f=1", "display_name": "xiaokang", "link": "https://stackoverflow.com/users/9024280/xiaokang"}, "edited": false, "score": 0, "creation_date": 1511945202, "post_id": 47548042, "comment_id": 82053442, "body": "like this                                                                                       project.c:1063: warning: declaration does not declare anything project.c:1064: error: redefinition of &#39;struct auditinfo&#39; project.c:1069: warning: declaration does not declare anything project.c:1070: error: redefinition of &#39;struct auditinfo_addr&#39; project.c:1076: warning: declaration does not declare anything project.c:1077: error: redefinition of &#39;struct auditpinfo&#39; project.c:1083: warning: declaration does not declare anything project.c:1084: error: redefinition of &#39;struct auditpinfo_addr&#39;"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1511948842, "post_id": 47548042, "comment_id": 82055830, "body": "<code>sys&#47;types.h</code> should be one of the first includes to include. The order of includes is important."}], "owner": {"reputation": 11, "user_id": 9024280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0a006a2b4b12e56449b5029b54845f?s=128&d=identicon&r=PG&f=1", "display_name": "xiaokang", "link": "https://stackoverflow.com/users/9024280/xiaokang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 539, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1511945055, "creation_date": 1511943636, "last_edit_date": 1511945055, "question_id": 47548042, "link": "https://stackoverflow.com/questions/47548042/error-redefinition-of-struct-auditinfo-addr", "title": "error: redefinition of &#39;struct auditinfo_addr&#39;", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include \"/usr/include/sys/queue.h\"\n#include \"/usr/include/altq/altq_classq.h\"\n#include \"/usr/include/altq/altq_rmclass.h\"\n#include \"/usr/include/bsm/audit.h\"\n#include \"/usr/include/sys/types.h\"\n#include \"/usr/include/bsdxml_external.h\"\n#include \"/usr/include/sys/bitstring.h\"\n#include \"/usr/include/bsdxml.h\"\n#define offsetof(TYPE,MEMBER) ((int)(&amp;((TYPE *)0)-&gt;MEMBER))\n</code></pre>\n\n<blockquote>\n  <p>audit.h this file include structure,for example au_tid.\n  those structure come from freebsd head file, compile and execute on freebsd system  </p>\n</blockquote>\n\n<pre><code>struct au_tid {\n    dev_t       port;\n    u_int32_t   machine;\n};\nstruct au_tid_addr {\n    dev_t       at_port;\n    u_int32_t   at_type;\n    u_int32_t   at_addr[4];\n};\nstruct au_mask {\n    unsigned int    am_success;     \n    unsigned int    am_failure;     \n};\nstruct auditinfo {\n    au_id_t     ai_auid;    \n    au_mask_t   ai_mask;    \n    au_tid_t    ai_termid;  \n    au_asid_t   ai_asid;    \n};\nstruct auditinfo_addr {\n    au_id_t     ai_auid;    \n    au_mask_t   ai_mask;    \n    au_tid_addr_t   ai_termid;  \n    au_asid_t   ai_asid;    \n    au_asflgs_t ai_flags;   \n};\nstruct auditpinfo {\n    pid_t       ap_pid;     \n    au_id_t     ap_auid;    \n    au_mask_t   ap_mask;    \n    au_tid_t    ap_termid;  \n    au_asid_t   ap_asid;    \n};\nstruct auditpinfo_addr {\n    pid_t       ap_pid;     \n    au_id_t     ap_auid;    \n    au_mask_t   ap_mask;    \n    au_tid_addr_t   ap_termid;  \n    au_asid_t   ap_asid;    \n    au_asflgs_t ap_flags;   \n};\nstruct au_session {\n    auditinfo_addr_t    *as_aia_p;  \n    au_mask_t        as_mask;   \n};\n.......\n\nint main()\n{\n    int temp =-1;\n    temp = offsetof(struct  internal_state  ,  dummy);\n    printf(\"%d\\n\", temp);\n    return 0;\n}\n</code></pre>\n\n<p>When I compile the above code, there will be an error</p>\n\n<blockquote>\n  <p>error:redefinition of ' >struct au_tid_addr '</p>\n</blockquote>\n\n<p>prompts, but i can not solve the problem \ncan anyone help me? Links to discussions on this problem are also highly appreciated. Thanks.</p>\n"}, {"tags": ["c", "structure", "member-access"], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 2, "creation_date": 1511941886, "post_id": 47547536, "comment_id": 82051672, "body": "@Ring&#216;: Let&#39;s put that down to this: <a href=\"https://en.wikipedia.org/wiki/Relativity_of_simultaneity\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Relativity_of_simultaneity</a>"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 7, "last_activity_date": 1511941657, "creation_date": 1511941657, "answer_id": 47547536, "question_id": 47547501, "link": "https://stackoverflow.com/questions/47547501/unable-to-compile-c-code-when-using-the-macro-define-for-struct-member-in-head/47547536#47547536", "title": "Unable to compile c code, when using the macro #define for struct member in header file", "body": "<p>Typo:</p>\n\n<pre><code>twoStrokeEngine.internal.i1=20;\n</code></pre>\n\n<p>ought to be</p>\n\n<pre><code>twoStrokeEngine.i.i1=20;\n</code></pre>\n\n<p>and so on. <code>i</code> is the member, <strong>not</strong> <code>internal</code>. The latter is the <code>typedef</code> for the <code>struct</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1511942089, "post_id": 47547542, "comment_id": 82051771, "body": "@Bathsheba but, moreover, the privileged to join the 100K club with mentors like you is more honorable, there&#39;s no two things about it. :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 11, "last_activity_date": 1511941853, "last_edit_date": 1511941853, "creation_date": 1511941672, "answer_id": 47547542, "question_id": 47547501, "link": "https://stackoverflow.com/questions/47547501/unable-to-compile-c-code-when-using-the-macro-define-for-struct-member-in-head/47547542#47547542", "title": "Unable to compile c code, when using the macro #define for struct member in header file", "body": "<p>The problem is with </p>\n\n<pre><code>  twoStroke.internal.i1+twoStroke.internal.i2;\n            ^^^                   ^^^^\n</code></pre>\n\n<p><code>internal</code> is a type, not a member that you can access. You need to access the member variables. The member variable, which is of type <code>internal</code> is <code>i</code>, so your statements should look something like</p>\n\n<pre><code> twoStroke.i.i1+twoStroke.i.i2;\n</code></pre>\n"}], "owner": {"reputation": 320, "user_id": 3211801, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/dshng.jpg?s=128&g=1", "display_name": "Nandha", "link": "https://stackoverflow.com/users/3211801/nandha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 47547542, "answer_count": 2, "score": 1, "last_activity_date": 1511943664, "creation_date": 1511941514, "last_edit_date": 1511943664, "question_id": 47547501, "link": "https://stackoverflow.com/questions/47547501/unable-to-compile-c-code-when-using-the-macro-define-for-struct-member-in-head", "title": "Unable to compile c code, when using the macro #define for struct member in header file", "body": "<p>I have two files(average.h, average.c). In the definition of a structure i have used <code>#ifdef INTERNAL</code> . </p>\n\n<pre><code>#ifndef AVERAGE_H_\n#define AVERAGE_H_\n\n\ntypedef struct str_internal {\n    int i1;\n    int i2;\n} internal;\n\ntypedef struct str_speed {\n    int lowest;\n    int highest;\n#ifdef INTERNAL\n    internal i;\n#endif\n} speed;\n\n\nextern double average(speed twoStroke);\n\n#endif /* AVERAGE_H_ */\n</code></pre>\n\n<p>The contents of average.c are,</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"average.h\"\n\ndouble average(speed twoStroke) {\n    double average = (twoStroke.highest + twoStroke.lowest) / 2.0;\n\n#ifdef INTERNAL\n    average += twoStroke.internal.i1+twoStroke.internal.i2;\n#endif\n\n    return average;\n}\n\n\nint main() {\n    speed twoStrokeEngine;\n    twoStrokeEngine.highest = 70;\n    twoStrokeEngine.lowest = 50;\n#ifdef INTERNAL\n    twoStrokeEngine.internal.i1=20;\n    twoStrokeEngine.internal.i2=10;\n#endif\n    double avg = average(twoStrokeEngine);\n    printf(\"Average speed of two stroke engine is: %f\", avg);\n    return 0;\n}\n</code></pre>\n\n<p>When i try to compile this code,\n<strong>gcc -DINTERNAL -o average.exe average.c</strong> \ni am getting the following error messages.</p>\n\n<pre><code>average.c:8:22: error: \u2018speed {aka struct str_speed}\u2019 has no member named \u2018internal\u2019\n  average += twoStroke.internal.i1+twoStroke.internal.i2;\n                      ^\naverage.c:8:44: error: \u2018speed {aka struct str_speed}\u2019 has no member named \u2018internal\u2019\n  average += twoStroke.internal.i1+twoStroke.internal.i2;\n                                            ^\naverage.c: In function \u2018main\u2019:\naverage.c:20:17: error: \u2018speed {aka struct str_speed}\u2019 has no member named \u2018internal\u2019\n  twoStrokeEngine.internal.i1=20;\n                 ^\naverage.c:21:17: error: \u2018speed {aka struct str_speed}\u2019 has no member named \u2018internal\u2019\n  twoStrokeEngine.internal.i2=10;\n</code></pre>\n"}, {"tags": ["c", "static-linking", "dynamic-linking"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1511940201, "post_id": 47547141, "comment_id": 82050820, "body": "If i&#39;m not wrong, you don&#39;t link functions, you link libraries. However, I&#39;m interested in seeing other responses, too."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1511940325, "post_id": 47547141, "comment_id": 82050870, "body": "You forgot to mention your specific problem."}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 1, "creation_date": 1511940418, "post_id": 47547141, "comment_id": 82050917, "body": "What&#39;s wrong with <code>-lpthread</code>? Why do you want to link specific functions?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1511940436, "post_id": 47547141, "comment_id": 82050924, "body": "You should show how you statically link the file that must be statically linked.  Normally, <code>pthread_create()</code> et al are only provided in a shared library, so you don&#39;t get an option to statically link.  However, this is platform-specific.  You should identify the platform and the compiler/linker toolchain you&#39;re using too."}, {"owner": {"reputation": 686, "user_id": 1875791, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ce05bb4d7eb8b4f7c2732f51a0496f2e?s=128&d=identicon&r=PG", "display_name": "Arshan", "link": "https://stackoverflow.com/users/1875791/arshan"}, "edited": false, "score": 0, "creation_date": 1511941387, "post_id": 47547141, "comment_id": 82051441, "body": "Do you want to link only specific parts of dynamic library just to reduce size of executable (thats what I am assuming you are trying to achieve)?"}, {"owner": {"reputation": 129, "user_id": 4754001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79d6f43d39458e7c278adfabadec09e?s=128&d=identicon&r=PG&f=1", "display_name": "Abubaker Siddique", "link": "https://stackoverflow.com/users/4754001/abubaker-siddique"}, "edited": false, "score": 0, "creation_date": 1511942169, "post_id": 47547141, "comment_id": 82051806, "body": "Are you looking for dynamically linking functions ? if so, function pointers may help."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511944116, "post_id": 47547141, "comment_id": 82052790, "body": "Stackoverflow.com is not a coding service.  Please post what you have tried and the results.  Be sure to post your compile and link statements."}], "owner": {"reputation": 3, "user_id": 6212050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00a79d0c84f73be34a3a190e8be968?s=128&d=identicon&r=PG&f=1", "display_name": "Zulu", "link": "https://stackoverflow.com/users/6212050/zulu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511940090, "creation_date": 1511940090, "question_id": 47547141, "link": "https://stackoverflow.com/questions/47547141/c-static-linking-and-dynamic-linking", "title": "C Static linking and dynamic linking", "body": "<p>Am working on a project that requires us to statically link a file and also dynamically link pthread_create and pthread_join in a C program.</p>\n\n<p>I have found resources on the static linking but i cant seem to find anything on dynamic linking that that consists of just linking the certain parts of pthread.</p>\n\n<p>would really appreciate any insight or resourcse</p>\n"}, {"tags": ["c", "while-loop", "switch-statement"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1511939844, "post_id": 47547075, "comment_id": 82050653, "body": "No; when you enter <code>1</code>, the <code>scanf(&quot;%d &quot;,&amp;p);</code> is not returning because of the trailing blank.  You should be checking the return value.  You should add a print after it saying &quot;Hi, I&#39;m here&quot;; you wonb&#39;t see that.  You have to enter something other than white space (not a newline, blank, tab) to get that <code>scanf()</code> to return.  I hope you guessed right about what the next input needs to be."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1511939952, "post_id": 47547075, "comment_id": 82050704, "body": "Obligatory: always check return vale of scanf"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1511940881, "post_id": 47547075, "comment_id": 82051139, "body": "Please never include trailing whitespace in <code>scanf()</code> format strings; this is almost always a mistake."}], "owner": {"reputation": 76, "user_id": 5826916, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-tTvW94kfr78/AAAAAAAAAAI/AAAAAAAAEr4/xR_zkDAZnnQ/photo.jpg?sz=128", "display_name": "Aditya kumar", "link": "https://stackoverflow.com/users/5826916/aditya-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "closed_date": 1511939883, "answer_count": 0, "score": 0, "last_activity_date": 1511939804, "creation_date": 1511939804, "question_id": 47547075, "link": "https://stackoverflow.com/questions/47547075/switch-inside-while-loop-in-c", "closed_reason": "Duplicate", "title": "switch() inside while loop in C", "body": "<p>I am getting an infinite loop in trying to input data using switch statement inside while loop....Here is the code part :</p>\n\n<pre><code>do{\n   printf(\"Enter option:\\n 1.push\\n 2.pop\\n 3.Size of Stack\\n \n           4.TopElement\\n\");\n\n  scanf(\"%d \",&amp;p);\n\n  switch(p){\n    case 1:\n            while(ch!='n'){\n              printf(\"Enter data\\n\");\n              scanf(\"%d\",&amp;x);\n              push(x);\n              printf(\"\\nWant to enter more data? y or n ?\\n\");\n              scanf(\" %c\",&amp;ch);//ch=getchar();\n             }\n    break;\n\n    case 2: while(ch!='n'){\n      pop();\n      printf(\"Wanna pop more ? Enter y or n\\n\");\n      scanf(\" %c\",&amp;ch);//ch=getchar();\n    }\n    break;\n\n    case 3:\n    Stacksize();\n    break;\n\n    case 4: TopElement();\n    break;\n\n    default: exit(0);\n}\nprintf(\"Wanna continue ? Enter choice y or n\\n\");\nscanf(\" %c\",&amp;choice);\n\n}while(choice!='n');\n</code></pre>\n\n<p>When I enter '1' then it is going in infinite loop. I suppose control should go to switch and print \"Enter data\" but this is not happening.. </p>\n\n<p><code>ch</code> and <code>choice</code> are of type char </p>\n"}, {"tags": ["c", "matrix", "dynamic", "sudoku"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1511940184, "post_id": 47547035, "comment_id": 82050814, "body": "Welcome to Stack Overflow. Please read the <a href=\"https://stackoverflow.com/tour\">About</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> pages soon, but even more importantly, please read about how to create an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>). You need to show your code. Note that <code>int **ptrptrint</code> and <code>int matrix[9][9]</code> are very different types with completely different storage requirements, even if you use <code>ptrptrint[8][8]</code> and <code>matrix[8][8]</code> to access the bottom-right corner of the data. The access path is also quite different; one involves two memory reads, the other just one; one involves multiplication, the other doesn&#39;t. And <code>int **matrix[9][9]</code> is different again \u2014 and wrong."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1511941945, "post_id": 47547035, "comment_id": 82051706, "body": "&quot;Yet somehow I get errors&quot; What did you expect to get? <code>int **[9][9]</code> is different from <code>int **</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1511942242, "post_id": 47547035, "comment_id": 82051839, "body": "Out of interest, could you not code this in C++?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1511950531, "post_id": 47547035, "comment_id": 82056975, "body": "Since <code>typematrix</code> returns an <code>int **</code> value, that is what you should pass to <code>showMatrixValues</code>: <code>void showMatrixValues(int **matrix);</code>."}], "owner": {"reputation": 1, "user_id": 9024171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd8b3c4b03501cbc8924ace263544bf?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Bouaouina", "link": "https://stackoverflow.com/users/9024171/omar-bouaouina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511941577, "creation_date": 1511939671, "last_edit_date": 1511941577, "question_id": 47547035, "link": "https://stackoverflow.com/questions/47547035/access-to-values-of-a-double-pointer-of-integers-in-a-function-in-c", "title": "Access to values of a double pointer of integers in a function in C", "body": "<p>In a SUDOKU project, I created a function to type in a dynamic matrix and fill it, however I can't figure out how to use the values of this dynamic matrix in other functions, to be precise I don't know how to pass the matrix as a function parameter in order to change or make some tests on its values.</p>\n\n<p>For example, the function typematrix has this header:</p>\n\n<pre><code>int **typematrix();\n</code></pre>\n\n<p>If for example I wanted to show the values of this matrix using a created function, named for example showMatrixValues, I wrote like so:</p>\n\n<pre><code>void showMatrixValues(int **matrix[9][9]);\n</code></pre>\n\n<p>Yet somehow I get errors on conflicting types or the fact that I'm passing an argument makes pointer without cast when using both functions in main, using a local variable:</p>\n\n<pre><code>   int  **matrix[9][9];\n</code></pre>\n"}, {"tags": ["c++", "c", "cudd"], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 3984390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b77fec27a8cd0b0fd106475eb4088f?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Inoue", "link": "https://stackoverflow.com/users/3984390/jun-inoue"}, "is_accepted": false, "score": 1, "last_activity_date": 1511961541, "creation_date": 1511961541, "answer_id": 47553819, "question_id": 47546965, "link": "https://stackoverflow.com/questions/47546965/cudd-extracting-variable-ordering/47553819#47553819", "title": "Cudd: extracting variable ordering", "body": "<p>Ah, I should have read the source code of <code>dd</code>.  The answer is quite simple: use <code>Cudd_ReadPerm</code>.</p>\n"}], "owner": {"reputation": 313, "user_id": 3984390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b77fec27a8cd0b0fd106475eb4088f?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Inoue", "link": "https://stackoverflow.com/users/3984390/jun-inoue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511961541, "creation_date": 1511939414, "question_id": 47546965, "link": "https://stackoverflow.com/questions/47546965/cudd-extracting-variable-ordering", "title": "Cudd: extracting variable ordering", "body": "<p>I'm trying to leverage CUDD's variable ordering heuristics for another program.  I have created a BDD, tried a few variable orderings to see which one minimizes the size, and now I want to extract the variable ordering.  How can I do this?</p>\n\n<p>According to <a href=\"https://stackoverflow.com/questions/21994614/cudd-package-way-to-pass-a-specific-variable-order\">this answer</a>, the <code>dd</code> python package gives you a way to inspect the level of each variable, but I don't see a corresponding function in the C/C++ interface.  How does that python binding pull it off?  Does it require accessing CUDD internals through <code>cuddInt.h</code>?</p>\n"}, {"tags": ["c", "hashtable", "bit-shift", "cs50", "hash-function"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 0, "creation_date": 1511939227, "post_id": 47546904, "comment_id": 82050353, "body": "How do you compile your program? Fully optimized?"}, {"owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "edited": false, "score": 0, "creation_date": 1511939294, "post_id": 47546904, "comment_id": 82050388, "body": "<a href=\"https://stackoverflow.com/a/6357747/6935629\">stackoverflow.com/a/6357747/6935629</a>"}, {"owner": {"reputation": 821764, "user_id": 893, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/747ffa5da3538e66840ebc0548b8fd58?s=128&d=identicon&r=PG", "display_name": "Greg Hewgill", "link": "https://stackoverflow.com/users/893/greg-hewgill"}, "edited": false, "score": 1, "creation_date": 1511939337, "post_id": 47546904, "comment_id": 82050406, "body": "Which compiler are you using? Also, use the online <a href=\"https://godbolt.org\" rel=\"nofollow noreferrer\">Compiler Explorer</a> to see what assembly code is generated from your source."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 2, "creation_date": 1511939464, "post_id": 47546904, "comment_id": 82050475, "body": "Considering that this is a hash function, it could easily be because of the resulting hash distribution. Neither of these are very good hashes, but the weaknesses of the first seem more likely to come up in a spell checker - for example, reordering the letters doesn&#39;t affect the hash in the first one."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 2, "creation_date": 1511939538, "post_id": 47546904, "comment_id": 82050509, "body": "Of course, trying to extrapolate from these tiny code snippets to the behavior of an entire unknown program compiled with unknown settings on an unknown compiler and architecture and run on unknown input is futile. This question isn&#39;t answerable."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1511939801, "post_id": 47546904, "comment_id": 82050633, "body": "There are many, many different hash functions you can use tailored to what you are hashing. Many (if not most) will use some type of shift or negation to create the hash. (just search for different hash functions). If you are using a recent compiler with optimizations enabled in your compile string, then your compiler should be handling the optimizations to the point there should be little difference between whether you multiply by a power of two of left shift (the compiler will make those type of optimizations). Concentrate on reducing collisions, let the compiler optimize the math."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1511943207, "post_id": 47546904, "comment_id": 82052316, "body": "You need at least to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1511946336, "post_id": 47546904, "comment_id": 82054108, "body": "They don&#39;t. Both your functions are horrific if you are concerned with efficiency. Replace the <code>strlen</code> function with a simple <code>a[i]</code> to know if it is a zero byte. So your assumption from the start, that one is more efficient than the other, is just not valid. As @DavidC.Rankin said, first learn about hash functions and there different advantages and drawbacks. Then, if (and only if) there is a performance problem that is measurable <i>and</i> relevant, try to improve the performance."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1511947787, "post_id": 47546904, "comment_id": 82055086, "body": "I&#39;m with @user2357112. Most likely, the hash function is not significantly faster (if it is faster at all) but <b>the resulting hash value is different</b>, so the hash table might be used better (however, you didn&#39;t include any information of what you do with the computed hash)"}], "answers": [{"tags": [], "owner": {"reputation": 44632, "user_id": 382763, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/swPG1.png?s=128&g=1", "display_name": "Thomas Mueller", "link": "https://stackoverflow.com/users/382763/thomas-mueller"}, "is_accepted": false, "score": 1, "last_activity_date": 1512116458, "creation_date": 1512116458, "answer_id": 47589241, "question_id": 47546904, "link": "https://stackoverflow.com/questions/47546904/why-do-bit-shift-operators-make-my-hash-function-so-fast/47589241#47589241", "title": "Why do bit-shift operators make my hash function so fast?", "body": "<p>I don't think shift + xor is faster than addition.</p>\n\n<p>However, the resulting hash <em>table</em> is probably much faster, because the hash values are much better distributed.</p>\n"}], "owner": {"reputation": 5, "user_id": 8702564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tdE9nSoLPzI/AAAAAAAAAAI/AAAAAAAAAr4/VqlGMZR02jw/photo.jpg?sz=128", "display_name": "Brent Walsh", "link": "https://stackoverflow.com/users/8702564/brent-walsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1414, "favorite_count": 1, "closed_date": 1512125054, "answer_count": 1, "score": -3, "last_activity_date": 1512287694, "creation_date": 1511939131, "last_edit_date": 1512287694, "question_id": 47546904, "link": "https://stackoverflow.com/questions/47546904/why-do-bit-shift-operators-make-my-hash-function-so-fast", "closed_reason": "Needs more focus", "title": "Why do bit-shift operators make my hash function so fast?", "body": "<p>I'm learning C right now and I had originally built this hash function for a spell checker program I'm building in a CS50 edx course. </p>\n\n<pre><code>int hashing(char *word)      \n{\n\n    unsigned int hash = 0;\n    for (int i = 0, n = strlen(word); i &lt; n; i++)\n        hash += word[i];\n    return hash % HTABLE_SIZE;\n}\n</code></pre>\n\n<p>Then I stumbled upon this <a href=\"https://www.reddit.com/r/cs50/comments/1x6vc8/pset6_trie_vs_hashtable/cf9nlkn/\" rel=\"nofollow noreferrer\">hash function</a> on reddit that uses bit-shift operators.</p>\n\n<pre><code>int hashing(char *word)\n{\n    unsigned int hash = 0;\n    for (int i = 0, n = strlen(word); i &lt; n; i++)\n        hash = (hash &lt;&lt; 2) ^ word[i];\n    return hash % HTABLE_SIZE;\n} \n</code></pre>\n\n<p>With this hash function the speed of my program went from 0.13 seconds to 0.06 seconds. Can someone please explain to me why this hash function is so much faster?</p>\n"}, {"tags": ["c", "uart", "atmega", "9-bit-serial"], "comments": [{"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 1, "creation_date": 1511980054, "post_id": 47546898, "comment_id": 82076478, "body": "You only posted a portion of your code and there&#39;s lots of indirection so it&#39;s hard to know what&#39;s happening.  I&#39;d suggest simplifying it as much as possible and posting a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 39, "user_id": 8856511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb51aeebecafc1289660a4e8595831d7?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8856511/daniel"}, "reply_to_user": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1512001150, "post_id": 47546898, "comment_id": 82085946, "body": "Thanks for the comment.  I will keep your advice in mind on my next post.  I figured out the problem.  serial_0_tx_send_if_ready_nine() was returning false, because the comms weren&#39;t ready.  But I didn&#39;t reverse the toggle as the loop was run again with the same byte."}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 8856511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb51aeebecafc1289660a4e8595831d7?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8856511/daniel"}, "is_accepted": true, "score": 1, "last_activity_date": 1512001343, "creation_date": 1512001343, "answer_id": 47564011, "question_id": 47546898, "link": "https://stackoverflow.com/questions/47546898/atmega-toggle-variable-too-slow-for-9bit-uart/47564011#47564011", "title": "Atmega Toggle Variable Too Slow For 9Bit UART", "body": "<p>Figured it out.</p>\n\n<p>serial_0_tx_send_if_ready_nine(...) was returning false when running at full speed, because the comm port wasn't ready to send the data.</p>\n\n<p>Therefore it was holding onto that byte and re-running the send function, however, the toggle had already been changed, and I didnt reverse the toggle.</p>\n\n<p>I changed a part of the code to be the following:</p>\n\n<pre><code>  if(serial_0_tx_send_if_ready_nine(data, nine_toggle) == SE_FALSE)\n  {\n    // but couldn't send it so put it back\n    RingBuffer8_PutBackByte(&amp;handle-&gt;out_rb, data);\n    nine_toggle ^= 1; //&lt;== Added this line\n  }\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 8856511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb51aeebecafc1289660a4e8595831d7?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8856511/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 47564011, "answer_count": 1, "score": 1, "last_activity_date": 1512001343, "creation_date": 1511939115, "question_id": 47546898, "link": "https://stackoverflow.com/questions/47546898/atmega-toggle-variable-too-slow-for-9bit-uart", "title": "Atmega Toggle Variable Too Slow For 9Bit UART", "body": "<p>I've written some code to output to the usart a 9bit message.</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>bool_t SERIAL__TX_SEND_NINE(U8_t ch, bool_t nine)         // send a character\n{\n\n  bool_t result = SE_TRUE;              // assume OK\n\n  // transceiver is on so send as soon as the buffer is ready\n  while(SERIAL__TX_READY() == SE_FALSE)\n  {                                     // make sure the Tx buffer is ready for another character\n  }\n  if (nine == TRUE)\n  {   \n    //SERIAL_USART_B |= 0x01;   \n    UCSR0B &amp;= ~(1&lt;&lt;TXB80);\n    UCSR0B |= (1&lt;&lt;TXB80);\n  }\n  else\n  {     \n    //SERIAL_USART_B &amp;= 0xFE;   \n    UCSR0B &amp;= ~(1&lt;&lt;TXB80);\n  }\n\n  SERIAL_UDR = ch;                      // then send the next character\n  SERIAL_USART_A |= SERIAL_TX_DONE;     // clear the done flag\n  return result;                        // OK\n}\n\n//! \\brief  send a byte on the serial communications bus if ready - return TRUE if successful\n//!\n//! \\param  ch the byte to transmit\n//! \\return SE_TRUE if the byte was sent, SE_FALSE can't happen for this device\nbool_t serial_0_tx_send_if_ready_nine(U8_t ch, bool_t nine)         // send a character if able to\n{\n    // if buffer ready?\n    if(SERIAL__TX_READY() == FALSE)\n    {\n        return FALSE;\n    }\n\nreturn SERIAL__TX_SEND_NINE(ch, nine);           // send the next character\n}\n</code></pre>\n\n<p>SERIAL_UDR = UDR0</p>\n\n<p>SERIAL_USART_A = UCSR0A</p>\n\n<p>When I put in breakpoints for whenever the code is run, whether it is the start of the function or the end of the function, it works as expected.  The ninth bit toggles on and off for each data packet. (5 data packets in total)</p>\n\n<p>When I have no breakpoints, when the ninth bit toggles appear to be completely at random.\nWhen I only have one breakpoint within the if statement, it only hits once.\nSo, I'm guessing the 'nine' value isn't setting quick enough to run the toggle at full speed.</p>\n\n<p>The toggle bit is being set a function before hand.</p>\n\n<pre><code>// outgoing state machine\n// only process it if the function pointer isn't NULL\nif(handle-&gt;send != NULL)\n{\n  // try and get a byte to send\n  if(RingBuffer_GetByte(&amp;handle-&gt;out_rb, &amp;data) == RINGBUFFER_OK)\n  {\n    // we got something to send\n        if (nine_toggle == TRUE)\n        {\n            nine_toggle = FALSE;\n        }\n        else\n        {\n            nine_toggle = TRUE;\n        }\n\n  if(serial_0_tx_send_if_ready_nine(data, nine_toggle) == SE_FALSE)\n  {\n    // but couldn't send it so put it back\n    RingBuffer_PutBackByte(&amp;handle-&gt;out_rb, data);\n  }\n  // otherwise we sent another one. ringbuffer does all the data handling so nothing else to do\n}\n}\n</code></pre>\n\n<p>But I don't understand why that would happen.</p>\n\n<p>Does the atemga324p have a timing delay when storing unsigned chars (bool_t)</p>\n\n<p>Any ideas would be appreciate.</p>\n\n<p>Additional details.  MCU: Atmega324p. OS: Windows 10.  Compiler: Atmel Studio 7.0.  Optimization: None.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 759, "user_id": 6766146, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/W8JRX.png?s=128&g=1", "display_name": "Lalit Verma", "link": "https://stackoverflow.com/users/6766146/lalit-verma"}, "edited": false, "score": 1, "creation_date": 1511938972, "post_id": 47546847, "comment_id": 82050219, "body": "what did you try, is the code provided gives any error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 0, "creation_date": 1511939176, "post_id": 47546847, "comment_id": 82050324, "body": "You should check the return value of <code>fscanf</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1511939185, "post_id": 47546847, "comment_id": 82050334, "body": "Note that <code>feof</code> is a function pointer, and will never be null, so the loop never be entered (unless negation has blown my mind).  You probably intended to use <code>while (!feof(fre))</code> but  <a href=\"https://stackoverflow.com/questions/5431941/\"><code>while (!feof(file))</code> is always wrong</a>.  You should probably include some separator between the numbers on output; using <code>&quot;%d\\n&quot;</code> makes sense, but there are many other options also available"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 2, "creation_date": 1511939215, "post_id": 47546847, "comment_id": 82050347, "body": "1. Check the return value from <code>fopen</code> 2. This is wrong <code>while (!feof)</code> on many levels - For a start read the manual page for <code>feof</code> and also <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>. 3. Why the test <code>if (fre==NULL){</code> inside the loop, 4...."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1511939291, "post_id": 47546847, "comment_id": 82050384, "body": "You may want to see <a href=\"https://stackoverflow.com/questions/19914298/how-do-i-scan-in-numbers-to-an-array-from-a-file?rq=1\">How do I scan numbers to an array from a file?</a>"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1511945761, "post_id": 47546847, "comment_id": 82053767, "body": "You really should start with a C tutorial. The <code>fre == NULL</code> test should occur immediately after the open, <code>if(feof)</code> is plain wrong as explained by JonathanLeffer, you should instead test <code>fscanf</code>return value. And <code>fopen(...,&quot;a&quot;)</code> open the file in write only mode, you should use <code>&quot;r&quot;</code> for read mode."}], "answers": [{"tags": [], "owner": {"reputation": 519, "user_id": 7304514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e4ab7a095c59c76e18a1c8ed1e272c?s=128&d=identicon&r=PG&f=1", "display_name": "Ordoshsen", "link": "https://stackoverflow.com/users/7304514/ordoshsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1511951615, "creation_date": 1511951615, "answer_id": 47550652, "question_id": 47546847, "link": "https://stackoverflow.com/questions/47546847/how-do-i-scan-and-print-the-int-values-from-a-text-file/47550652#47550652", "title": "How do I scan and print the int values from a text file?", "body": "<p>To make as few changes to your code, you can do something like this</p>\n\n<pre><code>FILE *fre;\nint re_rng;\n\nfre = fopen(\"vals\", \"r\");\nif (fre==NULL){\n    printf(\"Error\");\n}\n\nwhile (fscanf(fre, \"%d\", &amp;re_rng) == 1)\n{\n    printf(\"%d\\n\", re_rng);\n}\n</code></pre>\n\n<p>Things to note: You put wrong specifier at in the fopen, <code>a</code> means append, it is opening the file for writing at the end of the file. You want to use <code>r</code> for reading. </p>\n\n<p>You need to check if the file is ok right after you opened it. If you first try to read and then check, if it failed the program will end with segfault probably.</p>\n\n<p>You can also move the fscanf into the condition for while, where it returns number of conversion made, meaning for you that it returns 1 when it reads a number, 0 when it fails to read a number and -1 when it's at the end of file.</p>\n\n<p>I would suggest you try to read about all of these functions (+feof) at some documentation sites like <a href=\"http://cppreference.com\" rel=\"nofollow noreferrer\">cppreference.com</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1511951887, "creation_date": 1511951887, "answer_id": 47550748, "question_id": 47546847, "link": "https://stackoverflow.com/questions/47546847/how-do-i-scan-and-print-the-int-values-from-a-text-file/47550748#47550748", "title": "How do I scan and print the int values from a text file?", "body": "<p>There are a number of ways to approach this problem. If you have a file with nothing but numbers in it, and you are not taking any other mixed input with <code>scanf</code>, then it can be use to read each integer value in the file until <code>EOF</code> is encountered. Nothing special is needed.</p>\n\n<p>The following code reads from the filename provided as the first argument (or from <code>stdin</code> by default if no arguments is provided)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (int argc, char **argv) {\n\n    int i;  /* read from 1st arg (or stdin by default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        fprintf (stderr, \"error: file open failed '%s'.\\n\", argv[1]);\n        return 1;\n    }\n    while (fscanf (fp, \"%d\", &amp;i) == 1)  /* validate 1 conversion */\n        printf (\" %2d\", i);         /* output your integer */\n    putchar ('\\n');                 /* tidy up with newline */\n\n    if (fp != stdin) fclose (fp);   /* close file if not stdin */\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Input File</strong></p>\n\n<pre><code>$cat dat/verticallist.txt\n12\n2\n7\n5\n4\n10\n15\n4\n18\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/rdintsfromfile &lt;dat/verticallist.txt\n 12  2  7  5  4 10 15  4 18\n</code></pre>\n\n<p>Look things over and let me know if you have any further questions.</p>\n"}], "owner": {"reputation": 9, "user_id": 9024120, "user_type": "registered", "profile_image": "https://graph.facebook.com/1741498329216956/picture?type=large", "display_name": "Fl&#252;gel Schatten", "link": "https://stackoverflow.com/users/9024120/fl%c3%bcgel-schatten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1511951887, "creation_date": 1511938851, "last_edit_date": 1511939028, "question_id": 47546847, "link": "https://stackoverflow.com/questions/47546847/how-do-i-scan-and-print-the-int-values-from-a-text-file", "title": "How do I scan and print the int values from a text file?", "body": "<pre><code>FILE *fre;\nint re_rng;\n\nfre = fopen(file_name, \"a\");\nwhile (!feof)\n{\n    fscanf(fre,\"%d\", &amp;re_rng);\n\n    if (fre==NULL){\n        printf(\"Error\");\n    }\n    printf(\"%d\", re_rng);\n}\n</code></pre>\n\n<p>The text file looks like this (vertical list)</p>\n\n<pre><code>12\n2\n7\n5\n4\n10\n15\n4\n18\n</code></pre>\n"}, {"tags": ["c", "file", "debugging", "io", "syntax-error"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1511939454, "post_id": 47546791, "comment_id": 82050471, "body": "It&#39;s curious that you spend your efforts to use <code>float</code> instead of <code>double</code>, but then use <code>sqrt()</code> instead of <code>sqrtf()</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1511939563, "post_id": 47546791, "comment_id": 82050531, "body": "You should avoid parameterless functions when possible.  Your code would be more general (reusable) if you passed the array as length plus pointer to start (e.g. <code>float std_dev(size_t num_data, float data[])</code>."}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 2, "creation_date": 1511940948, "post_id": 47546791, "comment_id": 82051167, "body": "After getting the program to compile (there are compilation errors e.g. the declaration and definition of <code>output()</code> differ), The <code>avg</code> variable prints just fine."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511944612, "post_id": 47546791, "comment_id": 82053080, "body": "The posted code contains LOTS of <code>double</code> literals.  In all cases, they should be <code>float</code> literals.  To make them <code>float</code> literals, append a <code>f</code> to the end of each of the literals."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511944812, "post_id": 47546791, "comment_id": 82053197, "body": "regarding: <code>static void output(float var)</code>   The idea behind using the <code>static</code> modifier is that the function will not be visible outside of the current file.  Suggest changing the statement to: <code>void output( float var )</code>  Then in the second file insert the statement: <code>extern void output( float );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511944976, "post_id": 47546791, "comment_id": 82053300, "body": "this statement, in the first file: <code>float average(void);</code> is useless.  However, it is needed in the second file written as: <code>float average( void );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511945139, "post_id": 47546791, "comment_id": 82053397, "body": "regarding: <code>s = std_dev(avg);</code>  the variable <code>avg</code> is visible in the second file, and the use of a parameter does not match the prototype,  Suggest replacing the statement with: <code>s = std_dev();</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1511945332, "post_id": 47546791, "comment_id": 82053526, "body": "overall, there should be a header file for each of the two source files,  And each of the source files should be including each of those header files."}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1511948184, "last_edit_date": 1511948184, "creation_date": 1511947795, "answer_id": 47549286, "question_id": 47546791, "link": "https://stackoverflow.com/questions/47546791/not-printing-average/47549286#47549286", "title": "Not Printing Average", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>performs the desired functionality</li>\n<li>demonstrates how to execute functions in external files</li>\n<li>properly prototypes the functions</li>\n<li>removes extraneous code</li>\n<li>properly formats the code for ease of readability and understanding</li>\n<li>eliminates the 'magic' numbers</li>\n<li>lets the compiler determine how many items are in the array</li>\n<li>uses <code>float</code> literals rather than <code>double</code> literals</li>\n<li>documented why each of the system header files is included</li>\n<li>used meaningful parameter and variable names</li>\n<li>derived the value of <code>count</code> at compile time</li>\n<li>cast the <code>int count</code> parameter, when needed, to a <code>float</code></li>\n</ol>\n\n<p>and now the proposed code:</p>\n\n<p>header file: main.h</p>\n\n<pre><code>#ifndef MAIN_H\n#define MAIN_H\nvoid output(float var);\nextern float avg;\n#endif // MAIN_H\n</code></pre>\n\n<p>header file: util.h</p>\n\n<pre><code>#ifndef UTIL_H\n#define UTIL_H\nfloat calc_std_dev( float *, int  );\nvoid  calc_mean( float *, int );\n#endif // UTIL_H\n</code></pre>\n\n<p>main.c file</p>\n\n<pre><code>#include &lt;stdio.h&gt;  // printf()\n#include \"main.h\"\n#include \"util.h\"\n\n\nfloat  array[]  =\n{\n    4.8f,  12.98f,  82.1f,  5.98f,  19.75f,\n    24.9f, 75.7f,   3.45f,  10.0f,  28.11f\n};\n\n\n\nint main( void )\n{\n    printf(\"The average value of the array is %.2f \\n\", avg);\n\n    float s = calc_std_dev( array, sizeof(array)/sizeof(float) );\n    printf(\"The standard deviation of the array is %.2f \\n\", s);\n\n    calc_mean( array, sizeof(array)/sizeof(float) );\n    return 0;\n}\n\n\nvoid output(float var)\n{\n    printf(\"The mean value of the array is: %.2f \\n\", var);\n}\n</code></pre>\n\n<p>util.c file</p>\n\n<pre><code>#include &lt;math.h&gt;  //sqrtf()\n#include \"main.h\"\n#include \"util.h\"\n\n\nfloat avg = 26.78f;\n\n\nvoid calc_mean( float array[], int count )\n{\n    int n;\n    float sum  = 0.0f;\n    float mean = 0.0f;\n\n    for(n=0; n&lt;count; n++)\n        sum = sum + array[n];\n\n    mean= sum/ (float)count;\n    output(mean);\n}\n\n\nfloat calc_std_dev( float array[], int count  )\n{\n    int n;\n    float cumm_diff = 0.0f;\n\n    for(n=0; n&lt;count; n++)\n         cumm_diff += (avg -array[n]) * (avg -array[n]);\n\n    return sqrtf(cumm_diff / (float)count);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "is_accepted": false, "score": 0, "last_activity_date": 1511964304, "creation_date": 1511964304, "answer_id": 47554670, "question_id": 47546791, "link": "https://stackoverflow.com/questions/47546791/not-printing-average/47554670#47554670", "title": "Not Printing Average", "body": "<p>You never call your function <code>average()</code>, which is why the average is not computed, but the initialized value <code>avg = 26.78</code> (not 0 - you probably changed that at some point) is printed and used by <code>std_dev()</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8949808, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10203718215913945/picture?type=large", "display_name": "Blake Rogers", "link": "https://stackoverflow.com/users/8949808/blake-rogers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1511964304, "creation_date": 1511938607, "question_id": 47546791, "link": "https://stackoverflow.com/questions/47546791/not-printing-average", "title": "Not Printing Average", "body": "<p>I have a project going in two files, but I cannot get the main program to print out the average variable, I just get 0.0 no matter what I change. It also does not print out a whole other function Any Tips?</p>\n\n<pre><code>Main File:\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\nfloat average(void);\nfloat std_dev(float);\nfloat output(float);\n\nfloat  array[10]  =  {4.8,  12.98,  82.1,  5.98,  19.75,  24.9,  75.7,  3.45,  10.0,  28.11};\nextern float avg;\nint main()\n{\n float s = 0.0;\n printf(\"The average value of the array is %.2f \\n\", avg);\n s = std_dev(avg);\n printf(\"The standard deviation of the array is %.2f \\n\", s);\n return 0;\n} \n\nstatic void output(float var)\n{\n    printf(\"The value of the variable is %.2f \\n\", var);\n}\n</code></pre>\n\n<p>Second File: </p>\n\n<pre><code>#include &lt;math.h&gt;\nextern float array[];\nfloat avg = 26.78;\n\nstatic float average()\n{\n    int n;\n    float sum = 0.0, mean=0.0;\n    for(n=0; n&lt;10; n++)\n        sum = sum + array[n];\n    mean= sum/10;\n    output(mean);\n    return mean;\n}\nfloat std_dev()\n{\nint n;\nfloat cumm_diff = 0.0;\nfor(n=0; n&lt;10; n++)\n     cumm_diff += (avg -array[n]) * (avg -array[n]);\nreturn sqrt(cumm_diff/10);\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "initialization", "codeblocks", "kernighan-and-ritchie"], "comments": [{"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1511937469, "post_id": 47546497, "comment_id": 82049597, "body": "What&#39;s <code>inside </code>? <code>state</code> has not been initialized."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1511937542, "post_id": 47546497, "comment_id": 82049623, "body": "Undefined behaviour."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1511937556, "post_id": 47546497, "comment_id": 82049626, "body": "You want the pure C explanation or the explanation that pertains to how C is compiled on your machine?"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1511937665, "post_id": 47546497, "comment_id": 82049670, "body": "It&#39;s undefined behavior.  It is generally of little interest, and certainly not something to post here about."}, {"owner": {"reputation": 1, "user_id": 8646139, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212860089430757/picture?type=large", "display_name": "Derek ZhongXuan Kwok", "link": "https://stackoverflow.com/users/8646139/derek-zhongxuan-kwok"}, "edited": false, "score": 0, "creation_date": 1511938613, "post_id": 47546497, "comment_id": 82050046, "body": "I meant to change that &quot;inside&quot; to be &quot;state&quot; - must have missed that one. I updated the code accordingly. Tom...I ask because I don&#39;t understand why I am getting this behavior - that&#39;s what forums and questions are for."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1511939017, "post_id": 47546497, "comment_id": 82050242, "body": "@DerekZhongXuanKwok You&#39;re getting it because you can get anything.  It&#39;s undefined.  Anything beyond that is implementation-specific and can change without notice.  A new machine, a new compiler, new libraries, almost anything can cause it to change."}, {"owner": {"reputation": 1, "user_id": 8646139, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212860089430757/picture?type=large", "display_name": "Derek ZhongXuan Kwok", "link": "https://stackoverflow.com/users/8646139/derek-zhongxuan-kwok"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1511940088, "post_id": 47546497, "comment_id": 82050757, "body": "@TomKarzes So you mean that the fact that I am getting 9 here is because of my current setup. So if I were to try this on a different computer, I might have a different starting value for the variable? Am I understanding this correctly? Thanks!"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1511941369, "post_id": 47546497, "comment_id": 82051430, "body": "@DerekZhongXuanKwok Right.  The specific behavior you&#39;re seeing is not specified by the C standard.  If you <i>really</i> want to understand it, then look at the assembly code.  In either case, fix your code so that it doesn&#39;t happen."}], "answers": [{"tags": [], "owner": {"reputation": 572, "user_id": 6111545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69db98ac907db60393a79e2ac6da32e7?s=128&d=identicon&r=PG&f=1", "display_name": "Insax", "link": "https://stackoverflow.com/users/6111545/insax"}, "is_accepted": false, "score": 0, "last_activity_date": 1511937623, "creation_date": 1511937623, "answer_id": 47546546, "question_id": 47546497, "link": "https://stackoverflow.com/questions/47546497/interesting-value-when-not-initialized-to-0/47546546#47546546", "title": "Interesting Value When Not Initialized to 0", "body": "<p>If you initialize a variable, it gets a \"random\" (unused) allocation in your RAM, if something has been already written there, the variable uses this value for itself.</p>\n\n<p>That's why you always declare variables.</p>\n\n<p>The backend is a bit more complicated, but thats the \"simple\" explanation.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8646139, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212860089430757/picture?type=large", "display_name": "Derek ZhongXuan Kwok", "link": "https://stackoverflow.com/users/8646139/derek-zhongxuan-kwok"}, "edited": false, "score": 0, "creation_date": 1511938550, "post_id": 47546550, "comment_id": 82050016, "body": "My bad - I changed the variable name from &quot;inside&quot; to &quot;state&quot; and must have missed the initial assignment. The same thing still happens even when state is initialized with my OUT macro."}, {"owner": {"reputation": 1, "user_id": 8646139, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212860089430757/picture?type=large", "display_name": "Derek ZhongXuan Kwok", "link": "https://stackoverflow.com/users/8646139/derek-zhongxuan-kwok"}, "edited": false, "score": 0, "creation_date": 1511939082, "post_id": 47546550, "comment_id": 82050276, "body": "By that last sentence, would always initializing an automatic variable explicitly fall under the &#39;good-to-know&#39; coding habits? I am a noobie, so just trying to get my head around all this."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 1, "user_id": 8646139, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212860089430757/picture?type=large", "display_name": "Derek ZhongXuan Kwok", "link": "https://stackoverflow.com/users/8646139/derek-zhongxuan-kwok"}, "edited": false, "score": 0, "creation_date": 1511939440, "post_id": 47546550, "comment_id": 82050458, "body": "@DerekZhongXuanKwok: It would depend. Sometimes, some compilers don&#39;t catch some of these issues with uninitialized variables. Obviously, compiling a code with warnings suppressed is another issue. So, I usually keep my variables initialized, and compile my code with warnings enabled."}, {"owner": {"reputation": 1, "user_id": 8646139, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212860089430757/picture?type=large", "display_name": "Derek ZhongXuan Kwok", "link": "https://stackoverflow.com/users/8646139/derek-zhongxuan-kwok"}, "edited": false, "score": 0, "creation_date": 1511939626, "post_id": 47546550, "comment_id": 82050553, "body": "Gotcha. Yea, I am using Codeblocks which has a GCC compiler that comes with it. I did not get any warning when I built my code (warnings are enabled), but it still starts off at 9. No idea how you got it to work without changing my code edits. I guess this is just a matter of my setup/how my system deals with the undefined variable?"}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 1, "user_id": 8646139, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212860089430757/picture?type=large", "display_name": "Derek ZhongXuan Kwok", "link": "https://stackoverflow.com/users/8646139/derek-zhongxuan-kwok"}, "edited": false, "score": 0, "creation_date": 1511939657, "post_id": 47546550, "comment_id": 82050562, "body": "Additionally, the reason I blatantly said that &quot;It depends&quot;, because thats would I&#39;d do for older compilers. For, C99 it allows us to declare variable when you have an actual sensible value for it, so that you don&#39;t have to initialize it, you just have to assign the sensible value to it. As I said, it depends."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 1, "user_id": 8646139, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212860089430757/picture?type=large", "display_name": "Derek ZhongXuan Kwok", "link": "https://stackoverflow.com/users/8646139/derek-zhongxuan-kwok"}, "edited": false, "score": 0, "creation_date": 1511939752, "post_id": 47546550, "comment_id": 82050609, "body": "@DerekZhongXuanKwok: I used the code which has <code>state = OUT;</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1511940145, "post_id": 47546550, "comment_id": 82050787, "body": "Very good effort on the answer, any reason you are not citing the C11 draft? <a href=\"https://port70.net/~nsz/c/c11/n1570.html\" rel=\"nofollow noreferrer\">C11 Draft (n1570)</a>?"}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1511943881, "post_id": 47546550, "comment_id": 82052667, "body": "@DavidC.Rankin: Oh, sorry, in fact I did. &quot;Refer standard section 6.3.2.1p2:&quot; (which I linked now to the link you provided, thanks!) That refers to the same section. (Please note: Previous comment deleted)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1511945141, "post_id": 47546550, "comment_id": 82053398, "body": "Not a big deal at all. It&#39;s just the most recent standard is generally what is cited. Especially when you consider the C89 standard in nearing 29 years old.... (I&#39;d wager a majority of the new programmers we see here were not even alive then <code>:)</code>"}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1511945198, "post_id": 47546550, "comment_id": 82053437, "body": "@DavidC.Rankin: Indeed. :-)"}], "tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": false, "score": 2, "last_activity_date": 1511943733, "last_edit_date": 1511943733, "creation_date": 1511937656, "answer_id": 47546550, "question_id": 47546497, "link": "https://stackoverflow.com/questions/47546497/interesting-value-when-not-initialized-to-0/47546550#47546550", "title": "Interesting Value When Not Initialized to 0", "body": "<p><strong>Before the OP edited the question:</strong></p>\n\n<p>This is Undefined Behavior.</p>\n\n<pre><code>if (state == IN)\n//Some code\nelse if (state == OUT)\n//Some code\n</code></pre>\n\n<p>It looks like <code>State</code> is not initialized (or set to a value) before comparing it.\nLeaving a value uninitialized is not Undefined Behavior, but accessing this way is definitely way to get in horrors of UB!</p>\n\n<p>In <strong>C89</strong>, see <strong>section 6.5.7 Initialization</strong>.</p>\n\n<blockquote>\n  <p>If an object that has automatic storage duration is not initialized explicitly, its value is indeterminate. If an object that has static storage duration is not initialized explicitly, it is initialized implicitly as if every member that has arithmetic type were assigned 0 and every member that has pointer type were assigned a null pointer constant</p>\n</blockquote>\n\n<p>In <strong>C99</strong>, see <strong>section 6.7.8 Initialization</strong></p>\n\n<blockquote>\n  <p>If an object that has automatic storage duration is not initialized explicitly, its value is indeterminate. If an object that has static storage duration is not initialized explicitly, then: \n  \u2014 if it has pointer type, it is initialized to a null pointer; \n  \u2014 if it has arithmetic type, it is initialized to (positive or unsigned) zero; \n  \u2014 if it is an aggregate, every member is initialized (recursively) according to these rules; \n  \u2014 if it is a union, the first named member is initialized (recursively) according to these rules.</p>\n</blockquote>\n\n<p>Refer <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.3.2.1\" rel=\"nofollow noreferrer\">standard section <strong>6.3.2.1p2</strong></a>:</p>\n\n<blockquote>\n  <p>If the lvalue designates an object of automatic storage duration that could have been declared with the register storage class (never had its address taken), and that object is uninitialized (not declared with an initializer and no assignment to it has been performed prior to use), the behavior is undefined.</p>\n</blockquote>\n\n<p>According to <strong>C99</strong> Standard, its \"indeterminate value\", it is either an unspecified value or a trap representation.</p>\n\n<p>But, before you get into the minors details these standards provide, you should acquire some of the most common and good-to-know coding habits. This can be a good start.</p>\n\n<hr>\n\n<p>After the edit from OP:</p>\n\n<p>I ran the exact same code from OP which has <code>state = OUT;</code> i.e. <code>State</code> initialized, it behaves the way it should.</p>\n\n<p>stdin:</p>\n\n<pre><code>Lazy Frog\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Lazy\nCurrent word count: 1\nFrog\nCurrent word count: 2\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8646139, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212860089430757/picture?type=large", "display_name": "Derek ZhongXuan Kwok", "link": "https://stackoverflow.com/users/8646139/derek-zhongxuan-kwok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1511943733, "creation_date": 1511937317, "last_edit_date": 1511938274, "question_id": 47546497, "link": "https://stackoverflow.com/questions/47546497/interesting-value-when-not-initialized-to-0", "title": "Interesting Value When Not Initialized to 0", "body": "<p>I have the following code which is supposed to display each input word on a separate line. For kicks, I placed a <code>printf</code> to display the word count after every word to make sure I understood the logic. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n/*Write a program that prints its input one word per line*/\n\n#define IN 1\n#define OUT 0\n\nint main()\n{\n    int c, state, wordcount;\n\n    state = OUT;\n    while ((c = getchar()) != EOF) \n    {\n        if (c == ' ' || c == '\\t' || c == '\\n') \n        {\n            if (state == IN)\n            {\n                printf(\"\\n\");\n                printf(\"Current word count: %i\\n\", wordcount); \n                /*troubleshooting*/\n                state = OUT;\n            }\n        }\n        else if (state == OUT) \n        {\n            state = IN;\n            putchar(c);\n            ++wordcount;\n        }\n        else\n        {\n            putchar(c);\n        }\n    }\n}\n</code></pre>\n\n<p>The output for this is shown in this picture. For some reason, without initializing the wordcount variable initially to 0, it starts at 9. </p>\n\n<p><a href=\"https://i.stack.imgur.com/AG9Td.png\" rel=\"nofollow noreferrer\">Wordcount variable gets set to 9 when it is not initialized to 0</a></p>\n\n<p>When initializing the wordcount variable to 0 (just setting wordcount = 0 in the int declaration statement), everything works as expected:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9x5M1.png\" rel=\"nofollow noreferrer\">Wordcount variable is correct when initialized to 0</a></p>\n\n<p>Can someone explain to me what is going on here? Does this have something to do with how these variables are stored in memory? Trying to understand what is going on. Thanks!</p>\n"}, {"tags": ["c", "sockets", "udp"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1511936379, "post_id": 47546055, "comment_id": 82049181, "body": "What is &#39;BUFSIZE&#39;?"}, {"owner": {"reputation": 686, "user_id": 1875791, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ce05bb4d7eb8b4f7c2732f51a0496f2e?s=128&d=identicon&r=PG", "display_name": "Arshan", "link": "https://stackoverflow.com/users/1875791/arshan"}, "edited": false, "score": 0, "creation_date": 1511936425, "post_id": 47546055, "comment_id": 82049203, "body": "Is your received buf null terminated?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1511936529, "post_id": 47546055, "comment_id": 82049234, "body": "&#39;bzero(buf, BUFSIZE)&#39;, then &#39;n = recvfrom(sockfd, buf, strlen(buf)....&#39;, &#39;recvfrom nothing at all&#39;.  All strlen() calls in network code are hugely suspicious and likely to be wrong.  99% of all C network code posted to SO that has any strlen in it is wrong."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 2, "creation_date": 1511936550, "post_id": 47546055, "comment_id": 82049240, "body": "recvfrom() has length specified as &quot;strlen(buf)&quot;... right after you cleared it out with a bzero()...."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1511936733, "post_id": 47546055, "comment_id": 82049309, "body": "Another large percentage  of all C network code posted to SO that has any &#39;printf(&quot;%s...&#39; in it is also suspicious:("}], "answers": [{"tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 2, "last_activity_date": 1511937650, "creation_date": 1511937650, "answer_id": 47546548, "question_id": 47546055, "link": "https://stackoverflow.com/questions/47546055/udp-socket-programming-in-c-printf-not-working-after-calling-recvfrom/47546548#47546548", "title": "UDP Socket Programming in C, printf not working after calling recvfrom()?", "body": "<p>Usual problem. You're ignoring the count returned by <code>recvfrom()</code>:</p>\n\n<pre><code>printf(\"%.*s\\n\", strlen(buf), buf);\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>printf(\"%.*s\\n\", n, buf);\n</code></pre>\n\n<p>NB your <code>recvfrom()</code> call is also incorrect. It should be:</p>\n\n<pre><code>n = recvfrom(sockfd, buf, sizeof buf, 0, (struct sockaddr *)&amp;serveraddr, \n  &amp;serverlen);\n</code></pre>\n\n<p>and if <code>n &lt; 0</code> you should not enter the following if-else chain.</p>\n"}], "owner": {"reputation": 1, "user_id": 8078466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f49d935b367f3572b3458bfff60e28c?s=128&d=identicon&r=PG&f=1", "display_name": "Grumpy96", "link": "https://stackoverflow.com/users/8078466/grumpy96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511937650, "creation_date": 1511935281, "question_id": 47546055, "link": "https://stackoverflow.com/questions/47546055/udp-socket-programming-in-c-printf-not-working-after-calling-recvfrom", "title": "UDP Socket Programming in C, printf not working after calling recvfrom()?", "body": "<p>I am working on a project regarding socket programming in c and java, using UDP and TCP (separately of course). My UDP server is Java and my UDP client is in C. I have encountered an issue where, after I call recvfrom(), methods such as printf and fprintf are not actually printing everything. I also tried fflush. Here is that section of code:</p>\n\n<pre><code>int main(int argc, char **argv) {\n   int sockfd, portno, n;\n   int serverlen;\n   struct sockaddr_in serveraddr;\n   struct hostent *server;\n   char *hostname;\n   char buf[BUFSIZE];\n   int GID = 9;\n\n/* check command line arguments and extract port numbers */\n   if (argc != 4) {\n     fprintf(stderr,\"usage: %s &lt;hostname&gt; &lt;port&gt; &lt;myport&gt;\\n\", argv[0]);\n     exit(0);\n   }\n   hostname = argv[1];\n   int serverPort = atoi(argv[2]);                                                 \n   int myPort = atoi(argv[3]);\n   int portRange = (5 * GID) + 10010;\n   if (myPort &lt; portRange || myPort &gt; portRange + 4) {\n     fprintf(stderr, \"Invalid Port range\\n\");\n     exit(1);\n   }\n\n/* socket: create the socket */\n   sockfd = socket(AF_INET, SOCK_DGRAM, 0);\n   if (sockfd &lt; 0) \n     error(\"ERROR opening socket\\n\");\n\n /* gethostbyname: get the server's DNS entry */\n   server = gethostbyname(hostname);\n   if (server == NULL) {\n     fprintf(stderr,\"ERROR, no such host as %s\\n\", hostname);\n     exit(0);\n   }\n\n/* build the server's Internet address */\n   bzero((char *) &amp;serveraddr, sizeof(serveraddr));\n   serveraddr.sin_family = AF_INET;\n   bcopy((char *)server-&gt;h_addr, \n     (char *)&amp;serveraddr.sin_addr.s_addr, server-&gt;h_length);\n   serveraddr.sin_port = htons(serverPort);\n\n/* create a message */\n   bzero(buf, BUFSIZE);\n   buf[0] = 74;\n   buf[1] = 111;\n   buf[2] = 121;\n   buf[3] = 33;\n   buf[4] = (myPort &gt;&gt; 8);\n   buf[5] = (myPort &amp; 0xFF);\n   buf[6] = GID;\n\n/* send the message to the server */\n   serverlen = sizeof(serveraddr);\n   n = sendto(sockfd, buf, strlen(buf), 0, (struct sockaddr *)&amp;serveraddr, \n     serverlen);\n   if (n &lt; 0) \n     error(\"ERROR in sendto\\n\");\n\n   bzero(buf, BUFSIZE);\n\n/* print the server's reply if buf[6] != 0*/\n   n = recvfrom(sockfd, buf, strlen(buf), 0, (struct sockaddr *)&amp;serveraddr, \n      &amp;serverlen);\n  //ERROR OCCURS AFTER RECEIVING\n\n   if (n &lt; 0) \n     error(\"ERROR in recvfrom\\n\");\n   if (buf[6] == 0 &amp;&amp; buf[7] == 1) {\n     printf(\"ERROR: no magic number\\n\");\n     return 0;\n   }\n   else if (buf[6] == 0 &amp;&amp; buf[7] == 2) {\n     printf(\"ERROR: incorrect length\\n\");\n     return 0;\n   }\n   else if (buf[6] == 0 &amp;&amp; buf[7] == 4) {\n     printf(\"ERROR: port number out of range\\n\");\n   }\n   printf(\"%.*s\\n\", strlen(buf), buf);\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "multithreading", "dynamic", "segmentation-fault"], "comments": [{"owner": {"reputation": 1992, "user_id": 3924496, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YPKhm.jpg?s=128&g=1", "display_name": "roelofs", "link": "https://stackoverflow.com/users/3924496/roelofs"}, "edited": false, "score": 0, "creation_date": 1511936771, "post_id": 47545995, "comment_id": 82049320, "body": "Why are you asking the exact same question twice?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1511937042, "post_id": 47545995, "comment_id": 82049422, "body": "..having not fixed any of the issues raised last time:("}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1511937115, "post_id": 47545995, "comment_id": 82049451, "body": "At least you got rid of the accidentally-left-in rude comment."}], "owner": {"reputation": 1, "user_id": 9023465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mCYE7awFCVw/AAAAAAAAAAI/AAAAAAAAAJw/SNLHuFn_hGo/photo.jpg?sz=128", "display_name": "mitch lew", "link": "https://stackoverflow.com/users/9023465/mitch-lew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1511965187, "answer_count": 0, "score": 0, "last_activity_date": 1545301483, "creation_date": 1511934951, "last_edit_date": 1545301483, "question_id": 47545995, "link": "https://stackoverflow.com/questions/47545995/segmentation-fault-in-p-thread", "closed_reason": "Duplicate", "title": "Segmentation Fault in p_thread", "body": "<p><strong>Issue:</strong> </p>\n\n<p>I created a linked list of Child thread TIDS and want to wait on all the child tids to finish execution before i continue my main thread. Basically I have directory traversal (a directory is specified by the members of a given struct). Every time I see a directory or file I create a new thread and put its threadID into the linked list. However when I traverse the linked list and call <code>pthread_join</code> I get a segmentation fault (core dumped) - I cannot understand why. I Can never wait on a child thread in my While loop at the bottom. Do I have to explicitly exit the child treads when I am done with them? </p>\n\n<p><a href=\"https://i.stack.imgur.com/38k7D.png\" rel=\"nofollow noreferrer\">Here is the output of my Compilation </a></p>\n\n<p>Program:</p>\n\n<pre><code>void *handy(void *arguments)\n{   \n    handarg *thestruct=(handarg*)arguments; \n\n    DIR *dp=opendir(thestruct-&gt;directory);  \n    DIR *outExist=opendir(thestruct-&gt;outputdirectory);\n\n    if(outExist==NULL)\n    {\n        if((thestruct-&gt;outputdirectory = \"\"))\n        {\n            ;   \n        }\n        else\n        {\n            printf(\"The outputdirectory doesnt exist, program terminated\\n\");\n            exit(1);\n        }\n    }\n\n    struct dirent *entry;  // has two important members (d-type)-tells me if its a directory (d-name) tells me current file name\n    if(dp==NULL)\n    {\n        printf(\"directory doesnt exist: %s\\n\", thestruct-&gt;directory);\n        exit(1);\n    }\n    NODE *head=(NODE*)malloc(sizeof(NODE)); //linked list\n    NODE *ptr=(NODE*)malloc(sizeof(NODE));//node POINTER\n    head=NULL;\n    int count;\n\n    while((entry=readdir(dp))!=NULL)\n    {\n        if(strcmp(entry-&gt;d_name,\"..\")==0||strcmp(entry-&gt;d_name,\".\")==0)\n        {\n           continue;\n        }\n        if((entry-&gt;d_type==DT_DIR))\n        {\n            unsigned int const sz1 = strlen(thestruct-&gt;directory);\n            unsigned int const sz2 = strlen(entry-&gt;d_name);\n\n            char *dnewname=(char *)malloc((sz1+sz2+2)*sizeof(char));\n\n            memcpy(dnewname,thestruct-&gt;directory,sz1);\n            memcpy(dnewname+sz1,\"/\",sizeof(char));\n            memcpy(dnewname+sz1+1,entry-&gt;d_name,sz2);\n            dnewname[strlen(dnewname)]='\\0';\n            pthread_t tid;\n            handarg *current=(handarg*)malloc(sizeof(handarg));//malloc\n            current-&gt;directory=dnewname;\n            current-&gt;outputdirectory=thestruct-&gt;outputdirectory;\n            current-&gt;column=thestruct-&gt;column;\n            pthread_create(&amp;tid,NULL,&amp;handy,current);\n            printf(\"The Filepath is: %s, The Parent TID = %ld, THE peer TID = %ld\\n\",dnewname, pthread_self(), tid);\n            NODE *newNode=(NODE*)malloc(sizeof(NODE));\n            if(head==NULL)\n            {\n                head=newNode;\n                ptr=newNode;\n                newNode-&gt;peerTid=tid;\n                newNode-&gt;next=NULL;\n                //printf(\"THE TID I PUT INTO THIS NODE IS %ld\\n\",ptr-&gt;peerTid);\n            }\n            else\n            {\n                ptr=head;\n                while(ptr-&gt;next!=NULL)\n                {\n                ptr=ptr-&gt;next;  \n                }\n                ptr-&gt;next=newNode;\n                newNode-&gt;peerTid=tid;\n                newNode-&gt;next=NULL;\n\n                //printf(\"THE TID I PUT INTO THIS NODE IS %ld\\n\",ptr-&gt;peerTid);\n\n            }\n            //pthread_join(tid,NULL);\n            // dont want to do this this does not make sense you \n            // create all your child threads make sure they are running KEEP Track of them (know their tid ) //create an array of tids or linked list  then for loop \n            //for loop tids  and wait on all of them \n            // then join all the threads (wait)\n            //say y ou have ann array of 5 tids for loop the array and call wait on each of tids  for loop only exit if last tid is waiting on \n        }\n\n        if((entry-&gt;d_type==DT_REG))\n        {\n            char *filename = entry-&gt;d_name;\n            int len = strlen(filename);\n            const char *last_four = &amp;filename[len-4]; //need to account for if filename is less than 4 characters   \n            if(strcmp(last_four,\".csv\")==0)\n            {   \n                //here is where i call handle file and merge sort\n                char *dnewname = (char*)malloc(sizeof(char)*(strlen(thestruct-&gt;directory)+strlen(entry-&gt;d_name)+2));\n                char *slash = (char*)malloc(sizeof(char));\n                strcpy(dnewname, thestruct-&gt;directory);\n                strcpy(slash, \"/\");\n                strcat(dnewname, slash);\n                strcat(dnewname, entry-&gt;d_name);\n                dnewname[strlen(dnewname)]='\\0';\n\n                pthread_t tid;\n                handarg *current=(handarg*)malloc(sizeof(handarg));\n                current-&gt;directory=dnewname;\n                current-&gt;outputdirectory=thestruct-&gt;outputdirectory;\n                current-&gt;column=thestruct-&gt;column;\n                pthread_create(&amp;tid,NULL,&amp;handleFile,current);\n\n                printf(\"The Filepath is: %s, The Parent TID = %ld, THE peer TID = %ld\\n\",dnewname, pthread_self(), tid);\n                NODE *newNode=(NODE*)malloc(sizeof(NODE));\n                if(head==NULL)\n                {\n                    head=newNode;\n                    ptr=newNode;\n                    newNode-&gt;peerTid=tid;\n                    newNode-&gt;next=NULL;\n                    //printf(\"THE TID I PUT INTO THIS NODE IS %ld\\n\",ptr-&gt;peerTid);\n                }\n                else\n                {\n                    ptr=head;\n                    while(ptr-&gt;next!=NULL)\n                    {\n                        ptr=ptr-&gt;next;  \n                    }\n                    ptr-&gt;next=newNode;\n                    newNode-&gt;peerTid=tid;\n                    newNode-&gt;next=NULL;\n\n                    //printf(\"THE TID I PUT INTO THIS NODE IS %ld\\n\",ptr-&gt;peerTid);\n                }\n            }               \n        }\n    }\n\n    ptr=head;\n    printf(\"\\nthese are the items from the linkedlist\\n\\n\");\n    while (ptr!=NULL)\n    {\n        printf(\"%ld\\n\",ptr-&gt;peerTid);\n        ptr=ptr-&gt;next;\n    }\n        printf(\"\\n\");\n    ptr=head;\n    while (ptr!=NULL)\n    {\n        printf(\"THE PEER THREAD I AM WAITING ON IS %ld --------I AM THE THREAD %ld\\n\",ptr-&gt;peerTid,pthread_self());\n        pthread_join(ptr-&gt;peerTid,NULL);\n        ptr=ptr-&gt;next;\n    }\n    printf(\"\\n\");\n    //return NULL;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 24690, "user_id": 350272, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/625bc443534e86742d2f865a4f1a5ad7?s=128&d=identicon&r=PG", "display_name": "JustSid", "link": "https://stackoverflow.com/users/350272/justsid"}, "edited": false, "score": 1, "creation_date": 1511934857, "post_id": 47545948, "comment_id": 82048689, "body": "0x100000000000 is 17592186044416, not 4096."}, {"owner": {"reputation": 3523, "user_id": 7820956, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0dc587fdd6cdf1980d081c028387f48d?s=128&d=identicon&r=PG&f=1", "display_name": "hellofanengineer", "link": "https://stackoverflow.com/users/7820956/hellofanengineer"}, "reply_to_user": {"reputation": 24690, "user_id": 350272, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/625bc443534e86742d2f865a4f1a5ad7?s=128&d=identicon&r=PG", "display_name": "JustSid", "link": "https://stackoverflow.com/users/350272/justsid"}, "edited": false, "score": 0, "creation_date": 1511934979, "post_id": 47545948, "comment_id": 82048728, "body": "@JustSid Where is the number coming from???? And.. what is 4096 in hexadecimal? Could you explain it on answer if you don&#39;t mind? :)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1511935043, "post_id": 47545948, "comment_id": 82048747, "body": "4096 in decimal is 0x1000 in hex, so PGSIZE-1 is 0xFFF.  I can&#39;t think how your example starting with 6 hex digits could be expected to end up with 12 hex digits.  Your macro rounds up to a multiple of 4096, and that&#39;s the result you see.  \u2014\u2014 Oh, you say 4096 is 2^12 (which is correct) and show 1000 0000 0000 which is almost the binary representation (1 zero short), but not the hex representation.  So your interpretation of what&#39;s expected is all wrong."}, {"owner": {"reputation": 24690, "user_id": 350272, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/625bc443534e86742d2f865a4f1a5ad7?s=128&d=identicon&r=PG", "display_name": "JustSid", "link": "https://stackoverflow.com/users/350272/justsid"}, "edited": false, "score": 0, "creation_date": 1511935300, "post_id": 47545948, "comment_id": 82048819, "body": "Ahhh, that&#39;s where that number is coming from. Michael Petch and coderredoc also just pointed that out in my (now) deleted answer."}, {"owner": {"reputation": 3523, "user_id": 7820956, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0dc587fdd6cdf1980d081c028387f48d?s=128&d=identicon&r=PG&f=1", "display_name": "hellofanengineer", "link": "https://stackoverflow.com/users/7820956/hellofanengineer"}, "edited": false, "score": 0, "creation_date": 1511935302, "post_id": 47545948, "comment_id": 82048820, "body": "???? the answer has been deleted while I was reading."}, {"owner": {"reputation": 24690, "user_id": 350272, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/625bc443534e86742d2f865a4f1a5ad7?s=128&d=identicon&r=PG", "display_name": "JustSid", "link": "https://stackoverflow.com/users/350272/justsid"}, "edited": false, "score": 0, "creation_date": 1511935339, "post_id": 47545948, "comment_id": 82048845, "body": "@JohnBaek It&quot;s because the answer is exactly what Jonathan Leffler pointed out: You confused hex and binary"}, {"owner": {"reputation": 3523, "user_id": 7820956, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0dc587fdd6cdf1980d081c028387f48d?s=128&d=identicon&r=PG&f=1", "display_name": "hellofanengineer", "link": "https://stackoverflow.com/users/7820956/hellofanengineer"}, "edited": false, "score": 0, "creation_date": 1511935430, "post_id": 47545948, "comment_id": 82048880, "body": "Thanks, you are right but how 0x124455 &amp; 1000 becomes 0x124000? Does if automatically fill 1s to the front? And yes if you can reinstate your answer with more explanation it will be highly appreaciated"}], "answers": [{"comments": [{"owner": {"reputation": 3523, "user_id": 7820956, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0dc587fdd6cdf1980d081c028387f48d?s=128&d=identicon&r=PG&f=1", "display_name": "hellofanengineer", "link": "https://stackoverflow.com/users/7820956/hellofanengineer"}, "edited": false, "score": 0, "creation_date": 1511935867, "post_id": 47546112, "comment_id": 82049018, "body": "how 0x124455 &amp; 1000 becomes 0x124000? Does if automatically fill 1s to the front? Could you explain little more about it on the question?"}], "tags": [], "owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "is_accepted": false, "score": 2, "last_activity_date": 1511935599, "last_edit_date": 1511935599, "creation_date": 1511935486, "answer_id": 47546112, "question_id": 47545948, "link": "https://stackoverflow.com/questions/47545948/the-macro-prints-incorrect-output/47546112#47546112", "title": "The macro prints incorrect output", "body": "<p>You showed in the question:</p>\n\n<pre><code>((sz)+PGSIZE-1) =&gt; (0x123456)+4096-1 \n                =(0x123456)+(0x1000 0000 0000) - 1 //4096 is 2^12\n                =0x1000 0012 3456 - 1\n</code></pre>\n\n<p>You converted 4096 to a binary notation, but then treat it as a hexadecimal number. That won't work. If you want to keep the hexadecimal notation, that's: </p>\n\n<pre><code>((sz)+PGSIZE-1) =&gt; (0x123456)+4096-1 \n                =(0x123456)+(0x1000) - 1\n                =0x124456 - 1\n</code></pre>\n\n<p>Or converting both to binary, that's:</p>\n\n<pre><code>((sz)+PGSIZE-1) =&gt; (0x123456)+4096-1 \n                =(0b1_0010_0011_0100_0101_0110)+(0b1_0000_0000_0000) - 1\n                = 0b1_0010_0100_0100_0101_0110 - 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3523, "user_id": 7820956, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0dc587fdd6cdf1980d081c028387f48d?s=128&d=identicon&r=PG&f=1", "display_name": "hellofanengineer", "link": "https://stackoverflow.com/users/7820956/hellofanengineer"}, "edited": false, "score": 0, "creation_date": 1512981000, "post_id": 47548837, "comment_id": 82457892, "body": "~(0) = f. I got it but what about other numbers?"}, {"owner": {"reputation": 3523, "user_id": 7820956, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0dc587fdd6cdf1980d081c028387f48d?s=128&d=identicon&r=PG&f=1", "display_name": "hellofanengineer", "link": "https://stackoverflow.com/users/7820956/hellofanengineer"}, "edited": false, "score": 0, "creation_date": 1512981084, "post_id": 47548837, "comment_id": 82457934, "body": "one more question... 0x1 &amp; 0xF = 1. How is that be???? Can it be like 0x1 &amp; 0xF = F???"}, {"owner": {"reputation": 106, "user_id": 4514909, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c0e66024726e19e6eb5263db1b97ffe?s=128&d=identicon&r=PG&f=1", "display_name": "Meenohara", "link": "https://stackoverflow.com/users/4514909/meenohara"}, "reply_to_user": {"reputation": 3523, "user_id": 7820956, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0dc587fdd6cdf1980d081c028387f48d?s=128&d=identicon&r=PG&f=1", "display_name": "hellofanengineer", "link": "https://stackoverflow.com/users/7820956/hellofanengineer"}, "edited": false, "score": 0, "creation_date": 1513065501, "post_id": 47548837, "comment_id": 82496461, "body": "You will find your answer here: <a href=\"http://www.geeksforgeeks.org/interesting-facts-bitwise-operators-c/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/interesting-facts-bitwise-operators-c</a> Every bitwise operator is discussed here with examples and what output is got. Pay attention to the one on &quot;~&quot; which is what your doubt is about"}], "tags": [], "owner": {"reputation": 106, "user_id": 4514909, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c0e66024726e19e6eb5263db1b97ffe?s=128&d=identicon&r=PG&f=1", "display_name": "Meenohara", "link": "https://stackoverflow.com/users/4514909/meenohara"}, "is_accepted": true, "score": 1, "last_activity_date": 1511948511, "last_edit_date": 1511948511, "creation_date": 1511946388, "answer_id": 47548837, "question_id": 47545948, "link": "https://stackoverflow.com/questions/47545948/the-macro-prints-incorrect-output/47548837#47548837", "title": "The macro prints incorrect output", "body": "<p>The error is in your calculation.\n2^12 is not 1000 0000 0000, but 0001 0000 0000 0000.</p>\n\n<p>The weights of binary begin as 2^0 which is one so 2^12 comes at 13th position so 4096 is 0x1000\n If you use this for your manual calculation you will get 0x124000 as your answer.</p>\n\n<p>The below calculation also answers your doubt \"how 0x124455 &amp; 1000 becomes 0x124000? Does if automatically fill 1s to the front? Could you explain little more about it on the question?\" in the comment of the previous answer.</p>\n\n<pre><code>4096 = 0x1000 \n4096-1 =&gt; 0xfff =&gt; 0x0000 0fff\n    ~(4096-1) is thus 0xfffff000\n\n    Coming to the addition part in macro \n     (0x123456)+4096-1 \n         =&gt;0x123456+0x1000-1\n         =&gt;0x124456-1\n         =&gt;0x124455\n\n    You result will be 0x124455 &amp; 0xfffff000 which is 0x124000 which is the correct output\n</code></pre>\n"}], "owner": {"reputation": 3523, "user_id": 7820956, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0dc587fdd6cdf1980d081c028387f48d?s=128&d=identicon&r=PG&f=1", "display_name": "hellofanengineer", "link": "https://stackoverflow.com/users/7820956/hellofanengineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 47548837, "answer_count": 2, "score": 0, "last_activity_date": 1511948511, "creation_date": 1511934693, "last_edit_date": 1511935696, "question_id": 47545948, "link": "https://stackoverflow.com/questions/47545948/the-macro-prints-incorrect-output", "title": "The macro prints incorrect output", "body": "<p>I'm learning C programming and this is my problem. I feel like I've learned the macro topic in C but I guess I'm not quite ready yet.</p>\n\n<pre><code>#define PGSIZE    4096 \n#define CONVERT(sz)    (((sz)+PGSIZE-1) &amp; ~(PGSIZE-1))\n\nprintf(\"0x%x\", CONVERT(0x123456));\n</code></pre>\n\n<p>Here is the problem. My expected output is <code>0x100000000000</code> but it prints <code>0x124000</code>.</p>\n\n<pre><code>((sz)+PGSIZE-1) = (0x123456)+4096-1 \n                = (0x123456)+(0x1000 0000 0000) - 1 //4096 is 2^12\n                =  0x1000 0012 3456 - 1\n                =  0x1000 0012 3455\n\n~(PGSIZE-1) =&gt; ~(0x0111 1111 1111) = 0x1000 0000 0000\n\n((sz)+PGSIZE-1) &amp; ~(PGSIZE-1) = (0x1000 0012 3455) &amp; (0x1000 0000 0000)\n                              = 0x100000000000\n</code></pre>\n\n<p>But when I ran the program, it prints 0x124000. </p>\n\n<p>What am I doing wrong?</p>\n"}]