[{"tags": ["c", "gcc", "assembly"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1566428696, "post_id": 57600074, "comment_id": 101657467, "body": "Looks like missed optimization. clang does it with 24."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1566428865, "post_id": 57600074, "comment_id": 101657501, "body": "Well, part of it would be that the System V AMD64 ABI requires that the stack must be aligned to a 16 byte boundary on entering a function. So if <code>main</code>&#39;s stack demands are solely for a 20 byte struct, then it would have to pad the stack expansion out to 32 bytes to ensure <code>f</code> is called with an appropriately aligned stack pointer. Not sure what the other 40 bytes would be for though."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1566428969, "post_id": 57600074, "comment_id": 101657529, "body": "@Jester: Is clang also inlining <code>f</code> in your test? Pretty sure if <code>f</code> isn&#39;t inlined, clang is required to use 32 bytes."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 3, "creation_date": 1566429035, "post_id": 57600074, "comment_id": 101657546, "body": "It&#39;s not inlining, hence the 24 bytes. The remaining 8 is for the return address."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1566433274, "post_id": 57600074, "comment_id": 101658331, "body": "@Jester: Ah, good point."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1566455964, "post_id": 57600074, "comment_id": 101663030, "body": "If you pass a struct as value it gets copied. So some space is needed for the argument. The local variable <code>x</code> will not accessible in <code>f()</code>."}, {"owner": {"reputation": 371, "user_id": 8596999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/595f98020f985780afcce080519abfd6?s=128&d=identicon&r=PG&f=1", "display_name": "ChauhanTs", "link": "https://stackoverflow.com/users/8596999/chauhants"}, "edited": false, "score": 0, "creation_date": 1566458630, "post_id": 57600074, "comment_id": 101664290, "body": "I think 72 is for whole function g , not only for struct foo"}], "owner": {"reputation": 44, "user_id": 2313244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6919522d1b24f9a7fcfe9983bbf4523d?s=128&d=identicon&r=PG", "display_name": "marcelo827", "link": "https://stackoverflow.com/users/2313244/marcelo827"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1566429277, "creation_date": 1566427949, "last_edit_date": 1566429277, "question_id": 57600074, "link": "https://stackoverflow.com/questions/57600074/how-to-explain-stack-space-reservation-in-this-simple-c-function", "title": "How to explain stack space reservation in this simple C function?", "body": "<p>I used gcc (Debian 8.3.0-6), with the optimization flag -O3 set to compile the following code:</p>\n\n<pre><code>struct foo {\n  int a;\n  int b;\n  int c;\n  int d;\n  int e;\n};\n\nint f(struct foo f);\n\nint g() {\n  struct foo x = {0, 1, 2, 3, 4};\n  return f(x);\n}\n</code></pre>\n\n<p>This is the assembly output I got:</p>\n\n<pre><code>    .file   \"struct.c\"\n    .text\n    .p2align 4,,15\n    .globl  g\n    .type   g, @function\ng:\n.LFB0:\n    .cfi_startproc\n    subq    $72, %rsp\n    .cfi_def_cfa_offset 80\n    movdqa  .LC0(%rip), %xmm0\n    movl    $4, 16(%rsp)\n    movups  %xmm0, (%rsp)\n    call    f@PLT\n    addq    $72, %rsp\n    .cfi_def_cfa_offset 8\n    ret\n    .cfi_endproc\n.LFE0:\n    .size   g, .-g\n    .section    .rodata.cst16,\"aM\",@progbits,16\n    .align 16\n.LC0:\n    .long   0\n    .long   1\n    .long   2\n    .long   3\n    .ident  \"GCC: (Debian 8.3.0-6) 8.3.0\"\n    .section    .note.GNU-stack,\"\",@progbits\n\n</code></pre>\n\n<p>What I don't know how to explain is, why did gcc reserve 72 bytes on the stack? It looks like the struct value {0, 1, 2, 3, 4} was moved to the area starting at %rsp and ending at %rsp+19, but what's with the extra 52 bytes?</p>\n"}, {"tags": ["c", "filesystems"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1566429350, "post_id": 57599982, "comment_id": 101657620, "body": "<code>dirent_t</code> and <code>dirread</code> are already identifiers in POSIX. You misdirect many readers using something already taken by POSIX. Also you introduce name clashes. Don&#39;t do it, please rename your symbols. <code>assert(!dirappend(&amp;n, &amp;t))</code> - don&#39;t use expressions with side effects inside <code>assert</code>, it is removed on release builds - ie. those that don&#39;t define <code>NDEBUG</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566431021, "post_id": 57599982, "comment_id": 101657980, "body": "Sensible variable names would also help. <code>int r</code> should be something like <code>bool first_entry</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566431374, "post_id": 57599982, "comment_id": 101658042, "body": "I&#39;m not sure that <code>if (!(!strcmp(t.nm, file-&gt;nm) &amp;&amp; !(r = 0)))</code> does what you want. <code>!(r = 0)</code> is always true, so it doesn&#39;t affect the result of <code>&amp;&amp;</code>. Can you explain what logic you&#39;re trying to implement there?"}, {"owner": {"reputation": 38, "user_id": 11820145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b0caf2ad4c724478dcc3f1a0175ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "b0kiii", "link": "https://stackoverflow.com/users/11820145/b0kiii"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566444447, "post_id": 57599982, "comment_id": 101660086, "body": "@Barmar I use the ability that if the first expression is false, the. second won&#39;t be evaluated. So <i>! (r = 0)</i> will be executes when the names are the same"}, {"owner": {"reputation": 38, "user_id": 11820145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b0caf2ad4c724478dcc3f1a0175ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "b0kiii", "link": "https://stackoverflow.com/users/11820145/b0kiii"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566452727, "post_id": 57599982, "comment_id": 101661824, "body": "@Barmar <a href=\"https://en.wikipedia.org/wiki/Short-circuit_evaluation\" rel=\"nofollow noreferrer\">Show-circuit evaluation</a>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1566457547, "post_id": 57599982, "comment_id": 101663717, "body": "Why not use a normal <code>if</code> statement? <code>if (strcmp(t.nm, file-&gt;nm) != 0) { r = 0; }</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1566457704, "post_id": 57599982, "comment_id": 101663779, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566486479, "post_id": 57599982, "comment_id": 101679913, "body": "@b0kiii It&#39;s <b>short</b> circuit. All the <code>!</code> make that expression overly complicated, I had to work out the meaning on paper. Use de Morgan&#39;s Law to simplify the double negatives."}, {"owner": {"reputation": 38, "user_id": 11820145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b0caf2ad4c724478dcc3f1a0175ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "b0kiii", "link": "https://stackoverflow.com/users/11820145/b0kiii"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566594565, "post_id": 57599982, "comment_id": 101719373, "body": "@Barmar Thanks for the proposal. I&#39;ll change it immediately."}], "owner": {"reputation": 38, "user_id": 11820145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b0caf2ad4c724478dcc3f1a0175ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "b0kiii", "link": "https://stackoverflow.com/users/11820145/b0kiii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566457685, "creation_date": 1566427062, "last_edit_date": 1566457685, "question_id": 57599982, "link": "https://stackoverflow.com/questions/57599982/remove-file-from-directory-ext-like-file-system-implementation", "title": "Remove file from directory - ext-like file system implementation", "body": "<p>I have an issue. I'm currently trying to implement an ext-ish file system. I've done the inode operations such as read and write. I've created a structure that represents both a regular file and a directory. I have a problem when trying to remove a certain file from the directory.   </p>\n\n<pre><code>char\ndirremove(struct dirent *dir, struct dirent *file)\n{\n    dirent_t n = {.mode = NODDIR, .inumber = remdirnod, \n                      .r = 0, .w = 0};\n    strcpy(n.nm, dir-&gt;nm);\n    dirent_t t;\n    dir-&gt;r = 0;\n    char r = 1;\n\n    while (!dirread(dir, &amp;t))\n    {\n        int tt = dir-&gt;r;\n        dir-&gt;r = 0;\n        dirent_t ff[3];\n        filread(ff, dir, 3 * entrysiz);\n        dir-&gt;r = tt;\n\n        if (!strcmp(t.nm, \"\"))\n            return 1;\n        if (!(!strcmp(t.nm, file-&gt;nm) &amp;&amp; !(r = 0)))\n            assert(!dirappend(&amp;n, &amp;t));\n    }\n    assert(n.w == dir-&gt;w - entrysiz);\n    dir-&gt;w = n.w;\n    dir-&gt;r = n.r;\n    copyinode(dir-&gt;inumber, remdirnod);\n    return r;\n}\n</code></pre>\n\n<p>This is the function called from the <em>rm</em> command. It takes the directory object (where the file is stored) and the file object to be deleted. I know this solution is not the best in terms of speed and memory usage but I'm still a beginner in this area, so don't hate me a lot, please :). </p>\n\n<p>The function is designed to do the following. It has to read all files and check if the current is the one to be deleted. If not, the file is added to a new directory (empty in the beginning) which will replace the old one at the end of the function. The \"new\" directory is an entry saved entirely for this purpose, so there isn't a chance that all inodes are already used.</p>\n\n<p>The test that I've done is to create a file (works fine), then remove it, then create it again and remove it. Everything works perfectly except for the second execution of the <em>dirremove</em> function. The directory has its <em>dot</em> and <em>dot-dot</em> directories by default so it goes through them first. The result is that the first deletion is successful. Everything works perfectly. But the second time things go wrong somewhere. </p>\n\n<pre><code>\nint tt = dir-&gt;r;\ndir-&gt;r = 0;\ndirent_t ff[3];\nfilread(ff, dir, 3 * entrysize;\ndir-&gt;r = tt;\n\n</code></pre>\n\n<p>I added the <em>ff</em> array that should read the whole content of the directory and this would help me figure out if the correct files are there. On the first and second iteration, all files (\".\", \"..\" and \"some-other-file\") are there but at the iteration which should hold the object of the file that's to be removed the third file suddenly goes all zeroes.  </p>\n\n<p>I've debugged this for several hours but it continues to fail the same way.</p>\n\n<p>Probably I didn't explain the failure the best way, but there are a lot of things that I forgot to say, so if I missed something please don't ignore the question and just ask about it.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 3, "creation_date": 1566426024, "post_id": 57599811, "comment_id": 101656872, "body": "A char doesn&#39;t contain symbols. Rather, there is a standard for &quot;this number encodes this symbol&quot;. See ASCII. You see symbols and not numbers because the display-er knows how to convert the numbers into the patterns of pixels we see"}, {"owner": {"reputation": 986, "user_id": 2443300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1abd2a8240bed4e8dc963b1004a8ada?s=128&d=identicon&r=PG", "display_name": "N Alex", "link": "https://stackoverflow.com/users/2443300/n-alex"}, "edited": false, "score": 2, "creation_date": 1566426031, "post_id": 57599811, "comment_id": 101656874, "body": "Symbols are actually numbers: see <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">this ASCII table</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1566426050, "post_id": 57599811, "comment_id": 101656878, "body": "Do you mean <a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">How does UTF-8 work</a>?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566464638, "post_id": 57599811, "comment_id": 101667233, "body": "Software only contains numbers, nothing else. You cannot store letters or pictures in memory, you can only store binary numbers"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1566637679, "post_id": 57599811, "comment_id": 101725742, "body": "@tadman, sorry, but utf-8 is not related to this question.  That&#39;s only an encoding, but many different can be used to encode characters into display symbols (see EBCDIC, Windows code pages, ASCII, etc)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1566675904, "post_id": 57599811, "comment_id": 101733764, "body": "@LuisColorado Sure, but UTF-8 is the most common when talking about <code>char*</code> and it&#39;s the only one that can do the full suite of symbols. Other character sets, especially 8-bit code pages, have a very limited subset. It&#39;s also designed to play well with languages like C where zero-bytes have special meaning."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1566757042, "post_id": 57599811, "comment_id": 101747764, "body": "I don&#39;t understand when you say <i>have a very limited subset</i>. Really... utf is expanding, and utf-8 is actually a good idea.... anyway, the character encoding is not related to this question at all.  The OP is requesting an explanation for an encoding at all... you assume that he know exactly what is.... Are you trying to debate? the specifics of utf-8 only overcomplicate things..."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11959436, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJZVJvBMYFbB21tQkWUuCQx1flYFpL1ViAEpUN=k-s128", "display_name": "Ilya Mashinin", "link": "https://stackoverflow.com/users/11959436/ilya-mashinin"}, "edited": false, "score": 0, "creation_date": 1566426335, "post_id": 57599845, "comment_id": 101656951, "body": "Why usually? Are there any exceptions when char is not a single byte integer?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 9, "user_id": 11959436, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJZVJvBMYFbB21tQkWUuCQx1flYFpL1ViAEpUN=k-s128", "display_name": "Ilya Mashinin", "link": "https://stackoverflow.com/users/11959436/ilya-mashinin"}, "edited": false, "score": 0, "creation_date": 1566426436, "post_id": 57599845, "comment_id": 101656976, "body": "@IlyaMashinin When it&#39;s passed to a function with variable arguments, such as <code>printf</code>. Or when it&#39;s converted into an <code>int</code> and passed to a <code>ctype</code> function."}, {"owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "reply_to_user": {"reputation": 9, "user_id": 11959436, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJZVJvBMYFbB21tQkWUuCQx1flYFpL1ViAEpUN=k-s128", "display_name": "Ilya Mashinin", "link": "https://stackoverflow.com/users/11959436/ilya-mashinin"}, "edited": false, "score": 0, "creation_date": 1566426620, "post_id": 57599845, "comment_id": 101657019, "body": "@IlyaMashinin In C, a char is defined as a byte, so is always a single byte integer. In some exotic systems, one byte is 16 bits. But almost always, a byte is 8 bits, so a char is 8 bits."}, {"owner": {"reputation": 10045, "user_id": 77542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2bb52913c4cebae8835bb50c03996d5?s=128&d=identicon&r=PG", "display_name": "Tordek", "link": "https://stackoverflow.com/users/77542/tordek"}, "edited": false, "score": 1, "creation_date": 1566426639, "post_id": 57599845, "comment_id": 101657025, "body": "That doesn&#39;t cause <code>char</code> to not be a single byte; <code>sizeof(char)</code> will always return 1. What happens in that case is that the value of the <code>char</code> is temporarily stored in a larger space."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1566427010, "post_id": 57599845, "comment_id": 101657120, "body": "Note that the standard guarantees that a byte is at least 8 bits, but it could be longer. POSIX guarantees that a byte is exactly 8 bits."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1566430118, "post_id": 57599845, "comment_id": 101657800, "body": "There could be any number of possibilities from 255 upwards.  256 is just a common setup"}, {"owner": {"reputation": 639, "user_id": 11529348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04841364af7bdde45d0f48dadf800a29?s=128&d=identicon&r=PG&f=1", "display_name": "memtha", "link": "https://stackoverflow.com/users/11529348/memtha"}, "edited": false, "score": 0, "creation_date": 1566515423, "post_id": 57599845, "comment_id": 101690773, "body": "I said &quot;usually&quot; because there&#39;s nothing to stop a specific compiler implementation from deciding that it should be a different size, or even allowing it to be redefined (e.g. typedef), as well as to avoid confusing with other types of similar names, such as wchar_t on windows. As a rule, if someone <i>might</i> have been chosen to do something slightly differently, there is probably a system out there in which it was. I admit though that I had not considered the possibility that a &quot;byte&quot; might be a different size."}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1567629959, "post_id": 57599845, "comment_id": 102023963, "body": "@JL2210 Huh? What do <code>printf</code> and variable arguments lists have to do with it?  In ANSI C (and all the way back to K&amp;R) <code>char</code> is always a single byte integer. If you&#39;re talking about promotions that&#39;s not an example of a <code>char</code> not being a single byte. It&#39;s an example of a <code>char</code> being promoted to a <i>different</i> type."}, {"owner": {"reputation": 639, "user_id": 11529348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04841364af7bdde45d0f48dadf800a29?s=128&d=identicon&r=PG&f=1", "display_name": "memtha", "link": "https://stackoverflow.com/users/11529348/memtha"}, "reply_to_user": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1567630222, "post_id": 57599845, "comment_id": 102024058, "body": "@CareyGregory Calling a function requires some specific handling of arguments at the machine code level, which is way beyond the scope of this question. The point is, when working on a 64-bit target, every argument is generally padded up to 64-bits, unless there are so many arguments that they can&#39;t all fit in the registers. See function section of this asm reference: <a href=\"https://cs.brown.edu/courses/cs033/docs/guides/x64_cheatsheet.pdf\" rel=\"nofollow noreferrer\">cs.brown.edu/courses/cs033/docs/guides/x64_cheatsheet.pdf</a> (section 4.4.1)"}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1567630736, "post_id": 57599845, "comment_id": 102024239, "body": "@memtha Yeah, I get all that, but you&#39;re right that it&#39;s way beyond the scope of this question. My point was that telling the OP chars aren&#39;t always chars is really misleading. What happens beneath the covers at the assembly level is irrelevant here."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1567631408, "post_id": 57599845, "comment_id": 102024474, "body": "@CareyGregory Yes, but all other times <code>char</code> looks like <code>char</code> (i.e. to <code>sizeof</code> and initializers). I was just dumbing it down for the OP."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1567631717, "post_id": 57599845, "comment_id": 102024575, "body": "... No multi-byte characters will ever be able to fit in a <code>char</code>. A <code>char</code> is only one byte."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1567631762, "post_id": 57599845, "comment_id": 102024592, "body": "Also, I&#39;d generally use <code>CHAR_BIT</code> bits in a <code>char</code> instead of only 8."}], "tags": [], "owner": {"reputation": 639, "user_id": 11529348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04841364af7bdde45d0f48dadf800a29?s=128&d=identicon&r=PG&f=1", "display_name": "memtha", "link": "https://stackoverflow.com/users/11529348/memtha"}, "is_accepted": true, "score": 1, "last_activity_date": 1567631653, "last_edit_date": 1567631653, "creation_date": 1566426102, "answer_id": 57599845, "question_id": 57599811, "link": "https://stackoverflow.com/questions/57599811/if-a-char-is-a-small-integer-then-why-can-it-contain-symbols/57599845#57599845", "title": "If a char is a small integer then why can it contain symbols?", "body": "<p><code>char</code> is a single byte integer, which means at least 256 possibilities (assuming the compiler follows the c standard). The lower 128 (number 0-127 inclusive) include almost all \"symbols\" you see printed. Here's a list: <a href=\"https://www.asciitable.com/\" rel=\"nofollow noreferrer\">https://www.asciitable.com/</a></p>\n\n<p>This often does not include more complicated characters, commonly called \"multi-byte characters\" which consist of more then 8 bits, such as emojis and eastern Asian word-characters. Different systems have different ways of handling these, but very few use the <code>char</code> type in C for more then one byte characters.</p>\n\n<p>As a general rule, treat a <code>char</code>/byte like it is exactly 8 bits. Though some systems may allow <code>char</code> to be bigger, that's not always the case. Use the platform-specific type for multi-byte characters if you want to use them.</p>\n"}], "owner": {"reputation": 9, "user_id": 11959436, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJZVJvBMYFbB21tQkWUuCQx1flYFpL1ViAEpUN=k-s128", "display_name": "Ilya Mashinin", "link": "https://stackoverflow.com/users/11959436/ilya-mashinin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 57599845, "answer_count": 1, "score": -1, "last_activity_date": 1567631653, "creation_date": 1566425838, "last_edit_date": 1566426618, "question_id": 57599811, "link": "https://stackoverflow.com/questions/57599811/if-a-char-is-a-small-integer-then-why-can-it-contain-symbols", "title": "If a char is a small integer then why can it contain symbols?", "body": "<p>If a <code>char</code> is a small integer, why can it contain symbols?</p>\n"}, {"tags": ["c", "struct", "typedef"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1566420558, "post_id": 57599005, "comment_id": 101655227, "body": "<code>esame esami[MAXESAMI];</code> -&gt; <code>struct esame esami[MAXESAMI];</code>"}, {"owner": {"reputation": 9, "user_id": 11943074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6663a8244bf66e133556233f73c0cccd?s=128&d=identicon&r=PG&f=1", "display_name": "user11943074", "link": "https://stackoverflow.com/users/11943074/user11943074"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1566420850, "post_id": 57599005, "comment_id": 101655339, "body": "@EugeneSh. array type has incomplete element type \u2018struct esame\u2019   struct esame esami[MAXESAMI];"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1566420890, "post_id": 57599005, "comment_id": 101655351, "body": "The <code>struct</code> declarations should be in header files too, and, it&#39;s better to avoid the <code>typedef</code> of pointers."}, {"owner": {"reputation": 9, "user_id": 11943074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6663a8244bf66e133556233f73c0cccd?s=128&d=identicon&r=PG&f=1", "display_name": "user11943074", "link": "https://stackoverflow.com/users/11943074/user11943074"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566421980, "post_id": 57599005, "comment_id": 101655701, "body": "@WeatherVane I added the two structs in header files too and it gives me more errors"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1566422465, "post_id": 57599005, "comment_id": 101655848, "body": "Please make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1463, "user_id": 1375025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XsUS.png?s=128&g=1", "display_name": "Giova", "link": "https://stackoverflow.com/users/1375025/giova"}, "is_accepted": true, "score": 1, "last_activity_date": 1566422724, "creation_date": 1566422724, "answer_id": 57599340, "question_id": 57599005, "link": "https://stackoverflow.com/questions/57599005/dereferencing-pointer-to-incomplete-type-struct/57599340#57599340", "title": "Dereferencing pointer to incomplete type \u2018struct&#39;", "body": "<p>I use to declare types in the header file and then define them in the implementation one as you did, but in a sligtly different manner. This how I do:</p>\n\n<ul>\n<li>In the header file</li>\n</ul>\n\n<pre><code>typedef struct{\n    char corso[20];\n    int voto;\n    char data[11];\n}esame, *ptr_esame;\n</code></pre>\n\n<ul>\n<li>In the implementation file you can then use the types as follows:</li>\n</ul>\n\n<pre><code>esame esami[MAXESAMI];\nptr_esame testa = esami;\n</code></pre>\n\n<p>I do not really know why this <code>typedef struct esame *esame;</code> is sintactically correct, cause even by reading it doesn't make sense. Anyway, none of my business.</p>\n\n<p>Keep in mind that when header files are included by multiple sources, redefinition may happen very easily, so use precompiler guards to avoid those issues. </p>\n\n<pre><code>#ifndef __ESAME_H__\n#define __ESAME_H__\n\ntypedef struct{\n    char corso[20];\n    int voto;\n    char data[11];\n}esame, *ptr_esame;\n\n...\n\n#endif\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11943074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6663a8244bf66e133556233f73c0cccd?s=128&d=identicon&r=PG&f=1", "display_name": "user11943074", "link": "https://stackoverflow.com/users/11943074/user11943074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1566426765, "accepted_answer_id": 57599340, "answer_count": 1, "score": 0, "last_activity_date": 1566422724, "creation_date": 1566420510, "last_edit_date": 1566420958, "question_id": 57599005, "link": "https://stackoverflow.com/questions/57599005/dereferencing-pointer-to-incomplete-type-struct", "closed_reason": "Not suitable for this site", "title": "Dereferencing pointer to incomplete type \u2018struct&#39;", "body": "<p>In \"esame.h\" I have declared <code>typedef struct esame *esame;</code> and in \"esame.c\" I have declared:</p>\n\n<pre><code>struct esame{\n    char corso[20];\n    int voto;\n    char data[11];\n};\n</code></pre>\n\n<p>In \"libretto.h\" I have declared <code>typedef struct libretto *libretto;</code> and in \"libretto.c\" I have declared:</p>\n\n<pre><code>struct libretto{\n    esame esami[MAXESAMI];\n};\n</code></pre>\n\n<p>But if for example I try to <code>printf</code> this </p>\n\n<pre><code>printf(\"Corso: %s\\nVoto: %d\\nData: %s\\n\", l-&gt;esami[i]-&gt;corso, l-&gt;esami[i]-&gt;voto, l-&gt;esami[i]-&gt;data);\n</code></pre>\n\n<p>it gives me this error, why?</p>\n\n<pre><code>error: dereferencing pointer to incomplete type \u2018struct esame\u2019\n    printf(\"Corso: %s\\nVoto: %d\\nData: %s\\n\", l-&gt;esami[i]-&gt;corso, l-&gt;esami[i]-&gt;voto, l-&gt;esami[i]-&gt;data);\n</code></pre>\n"}, {"tags": ["c", "time", "windows-10", "console-application", "average"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 5, "creation_date": 1566418972, "post_id": 57598653, "comment_id": 101654623, "body": "<code>clock()</code> returns type <code>clock_t</code>, not <code>time_t</code>.  Also research <code>CLOCKS_PER_SEC</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1566419305, "post_id": 57598653, "comment_id": 101654748, "body": "By always dividing by 2 in the loop, you&#39;re doing some sort of weighted average, with the most recent value counting for more than the prior values.  You can probably simply add the <code>tNumGen</code> values and divide by the number of entries in the list \u2014 ditto <code>tSort</code> values."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566419782, "post_id": 57598653, "comment_id": 101654919, "body": "Probably not your problem, but see <a href=\"https://stackoverflow.com/questions/57439219/comparing-execution-time-of-two-functions/57440637#57440637\">this answer</a> for some practical advice on timing functions."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566419907, "post_id": 57598653, "comment_id": 101654967, "body": "That divide by 2 thing is a crude type of filter sometimes used to process incoming readings from a device and is out of place here."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566420041, "post_id": 57598653, "comment_id": 101655018, "body": "Use <code>time()</code> and <code>time_t</code> instead of <code>clock</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1566420237, "post_id": 57598653, "comment_id": 101655092, "body": "@JL2210 <code>time()</code> only gives seconds resolution, and doesn&#39;t measure processor time. But Visual C is non-conforming anyway, with <code>clock()</code> measuring wall time too, not processor time."}, {"owner": {"reputation": 159, "user_id": 11223349, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CpOqrGGhVMI/AAAAAAAAAAI/AAAAAAAAQLY/7yS2Dh5JNIk/photo.jpg?sz=128", "display_name": "rphii", "link": "https://stackoverflow.com/users/11223349/rphii"}, "edited": false, "score": 0, "creation_date": 1566421681, "post_id": 57598653, "comment_id": 101655607, "body": "okay, thats some nice comments, thanks! and now me as well sees that I did the calculation weird... oops"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1566450948, "post_id": 57598653, "comment_id": 101661341, "body": "I recommend you delete the question."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1566455443, "post_id": 57598653, "comment_id": 101662799, "body": "And a little hint for your next questions: Please invest some seconds to learn how to copy contents out of shell windows and spreadsheets as text. It will make helping so much easier if we don&#39;t have to type what is in a screenshot."}], "owner": {"reputation": 159, "user_id": 11223349, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CpOqrGGhVMI/AAAAAAAAAAI/AAAAAAAAQLY/7yS2Dh5JNIk/photo.jpg?sz=128", "display_name": "rphii", "link": "https://stackoverflow.com/users/11223349/rphii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566418542, "creation_date": 1566418542, "question_id": 57598653, "link": "https://stackoverflow.com/questions/57598653/calculating-average-times-with-clock", "title": "Calculating average times with clock()", "body": "<p>I made a program that generates a user predefined number of random numbers and then sorts them and it repeats that as many times as the user wants it to repeat. While doing so, the program tracks how long the key functions take.</p>\n\n<p>For that I defined a struct (I guess I could delete the pPrev but let that aside ..) that I'm allocating dynamically and that works like a charm, at least I think so.</p>\n\n<pre><code>struct sTimes {\n    struct sTimes *pNext;\n    struct sTimes *pPrev;\n    time_t tNumGen;\n    time_t tSort;\n};\n</code></pre>\n\n<p>and declared / initialized three things corresponding to the average time calculation:</p>\n\n<pre><code>struct sTimes * pTimes = NULL;  // pointer to times\nstruct sTimes * pTimeStart;     // pointer to start of times\nstruct sTimes tAverage;         // average times\n</code></pre>\n\n<p>Before each generation and sorting I'm doing:</p>\n\n<pre><code>pTimes-&gt;tNumGen = clock();\npTimes-&gt;tSort = clock();\n</code></pre>\n\n<p>and after each generation and sort:</p>\n\n<pre><code>pTimes-&gt;tNumGen = clock() - pTimes-&gt;tNumGen;\npTimes-&gt;tSort = clock() - pTimes-&gt;tSort;\n</code></pre>\n\n<p>okay, so that's the basic structure. The cycles and sorting etc works. My problem is that the average times don't get calculated super exactly, and I can't figure out why or how to fix that (I'm getting <a href=\"https://i.stack.imgur.com/VaqMf.png\" rel=\"nofollow noreferrer\">this</a> instead of <a href=\"https://i.stack.imgur.com/1moOV.png\" rel=\"nofollow noreferrer\">this</a>).</p>\n\n<p>I calculated the average times like that:</p>\n\n<pre><code>tAverage.tNumGen = pTimeStart-&gt;tNumGen;\ntAverage.tSort = pTimeStart-&gt;tSort;\npTimes = pTimeStart;\nif(pTimes-&gt;pNext != NULL)\n{\n    pTimes = pTimes-&gt;pNext;\n}\nwhile(pTimes != NULL)\n{\n    tAverage.tNumGen += pTimes-&gt;tNumGen;\n    tAverage.tNumGen /= 2;\n    tAverage.tSort += pTimes-&gt;tSort;\n    tAverage.tSort /= 2;\n    pTimes = pTimes-&gt;pNext;\n}\n</code></pre>\n\n<p>I would be so glad if someone has a fancy answer or at least can give me a solution approach to my problem. And I would probably be even happier if someone can explain why this is happening. Have a gread day :)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 517, "user_id": 11937169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EDVLX.jpg?s=128&g=1", "display_name": "Matthew E. Miller", "link": "https://stackoverflow.com/users/11937169/matthew-e-miller"}, "edited": false, "score": 0, "creation_date": 1566418062, "post_id": 57598523, "comment_id": 101654280, "body": "When you say &#39;first&#39; do you mean the head or the tail?"}, {"owner": {"reputation": 632, "user_id": 11467079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ab3W.jpg?s=128&g=1", "display_name": "FlowMafia", "link": "https://stackoverflow.com/users/11467079/flowmafia"}, "reply_to_user": {"reputation": 517, "user_id": 11937169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EDVLX.jpg?s=128&g=1", "display_name": "Matthew E. Miller", "link": "https://stackoverflow.com/users/11937169/matthew-e-miller"}, "edited": false, "score": 0, "creation_date": 1566418118, "post_id": 57598523, "comment_id": 101654299, "body": "@MatthewE.Miller head"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1566422160, "post_id": 57598670, "comment_id": 101655760, "body": "For a working example, see <a href=\"https://pastebin.com/B4WFfHfF\" rel=\"nofollow noreferrer\">Singly Linked List of Integers (add, del, print)</a>"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1566420269, "last_edit_date": 1566420269, "creation_date": 1566418634, "answer_id": 57598670, "question_id": 57598523, "link": "https://stackoverflow.com/questions/57598523/delete-first-node-in-a-linked-list/57598670#57598670", "title": "Delete first node in a linked list", "body": "<p>You can eliminate testing for multiple cases (is node the 1st, if not the 1st, etc..) by simply using a pointer-to-pointer to node to hold the current node and a pointer to the next node, e.g.</p>\n\n<pre><code>/** delete node with value n from list (for loop) */\nvoid deleteClient (client **p, int n)\n{\n    client **ppn = p;           /* pointer to pointer to node*/\n    client *pn = *p;            /* pointer to node */\n\n    for (; pn; ppn = &amp;pn-&gt;next, pn = pn-&gt;next) {\n        if (pn-&gt;id == n) {\n            *ppn = pn-&gt;next;    /* set address to next */\n            free (pn);\n            break;\n        }\n    }\n}\n</code></pre>\n\n<p>This approach is detailed in <a href=\"https://grisha.org/blog/2013/04/02/linus-on-understanding-pointers/\" rel=\"nofollow noreferrer\">Linus on Understanding Pointers</a></p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1567003925, "last_edit_date": 1592644375, "creation_date": 1566997781, "answer_id": 57693228, "question_id": 57598523, "link": "https://stackoverflow.com/questions/57598523/delete-first-node-in-a-linked-list/57693228#57693228", "title": "Delete first node in a linked list", "body": "<p>The first question that comes to me, when dealing with your problem is: If you have defined an interface to your function that receives a pointer to a <code>client</code> <em>by reference</em>, why don't you get profit from that fact and use it to modify the received pointer?  (I was astonished about this, because the first thing you do, in the function is to dereference it, and use a normal pointer, and you don't touch the original pointer received anymore)  If you pass a pointer to the first node, you'll never have access to the pointer variable, and you'll not be able to change its value, and so, you'll never be able to unlink the first element, and it is because of that, that you need to access the pointer pointing to the first node (in order to be able to change it).  Very good at passing the pointer by reference, but bad as you didn't know why.</p>\n<pre><code>(pointer to 1st el.)\n    +-----+          +----------------+       +----------------+\n---&gt;| *p &gt;----------&gt;| client | next &gt;-------&gt;| client | next &gt;------.\n    +-----+          +----------------+       +----------------+     |\n     ^                                                               V          \n     |                                                              NULL\n  +--|--+\n  |  p  | (reference to the pointer that points to the first element)\n  +-----+\n</code></pre>\n<p>As you move the pointer reference, you get up to this scenario:</p>\n<pre><code>    +-----+          +----------------+       +----------------+\n---&gt;| *p &gt;----------&gt;| client | nxt &gt;--------&gt;| client | nxt &gt;-------.\n    +-----+          +----------------+       +----------------+     |\n                               ^                                     V\n       ,-----------------------'                                    NULL\n    +--|--+\n    |  p  | (see how the reference points to the pointer, not to client node)\n    +-----+\n</code></pre>\n<p>From this scenario, with a reference pointed by <code>&amp;p</code>, we need to make the value pointed by the pointer referenced to the next <code>client</code> node's <code>nxt</code> pointer, and not to the node itself. As here:</p>\n<pre><code>              ,---------------------------.\n              |                           |\n    +-----+   |      +----------------+   |   +----------------+\n---&gt;| *p &gt;----'      | client | nxt &gt;-----+--&gt;| client | nxt &gt;-------.\n    +-----+          +----------------+       +----------------+     |\n     ^                ^                                            =====\n     |                |                                             ===\n  +--|--+           +-|--+                                           =\n  |  p  |           | q  | (q points to the client node, instead)\n  +-----+           +----+\n</code></pre>\n<p>In this graph, <code>q</code> is a node pointer we use to link to the <code>client</code> node we are going in order to <code>free()</code> after it has been unlinked.  So, your first approach can be turned into this:</p>\n<pre><code>void deleteClient (client **p, int n)\n{\n    /* first advance the reference to the n-esim pointer,\n     * (zero meaning the first node) We decrement n after\n     * checking, and test goes on while *p is also non null\n     */\n    while (*p &amp;&amp; (*p)-&gt;id != n)\n        p = &amp;(*p)-&gt;next; /* move the reference to a reference\n                          * to the pointer in the next node. */\n\n    client *q = *p;      /* temporary link to the node to be \n                          * freed */\n\n    if (q) {             /* if found */\n        *p = q-&gt;next;    /* make *p point to the next node. */\n        free(q);         /* free the client node */\n    }\n}\n</code></pre>\n<p>The way to call this routine should be:</p>\n<pre><code>client *list;\n\n/* ... */\ndeleteClient(&amp;list, 3); /* delete node with id == 3 */\n</code></pre>\n<p>The statement <code>p = &amp;(*p)-&gt;next;</code> needs some explanation:</p>\n<ol>\n<li><code>*p</code> is the address of the <code>client</code> node that the pointer referenced by <code>p</code> points to.</li>\n<li><code>(*p)-&gt;next</code> is the <code>next</code> pointer of the node the pointer referenced by <code>p</code> points to.</li>\n<li><code>&amp;(*p)-&gt;next</code> is the address of that pointer.</li>\n</ol>\n<p>So we make <code>p</code> to point to the address of the <code>next</code> pointer of the <code>client</code> node pointed to by the referenced pointer <code>*p</code>.</p>\n<h1>NOTE</h1>\n<p>The reason your code messes up the whole list when you delete the first node is that you make the pointer (the initial pointer to the first node) to point to the second, but that pointer is local to your function and, as you never modify the pointer passed by reference (you modify the copy you make as soon as you get into the function, it is never modified above it), it continues to point to the (now <code>free()</code>d) node, so this makes the mess  (not only you have a pointer pointing to an invalid address, you have leaked the rest of the nodes ---as the <code>next</code> field of the pointed node can have been changed by <code>free()</code> as a result of managing the returned memory chunk---) :)</p>\n<p>Finally, you have a complete example <a href=\"https://github.com/mojadita/so/tree/master/57693228\" rel=\"nofollow noreferrer\">here</a>, that you can checkout from github.</p>\n"}], "owner": {"reputation": 632, "user_id": 11467079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ab3W.jpg?s=128&g=1", "display_name": "FlowMafia", "link": "https://stackoverflow.com/users/11467079/flowmafia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 57598670, "answer_count": 2, "score": 0, "last_activity_date": 1567003925, "creation_date": 1566417821, "question_id": 57598523, "link": "https://stackoverflow.com/questions/57598523/delete-first-node-in-a-linked-list", "title": "Delete first node in a linked list", "body": "<p>I'm trying to delete nodes from a simply linked list on C, when I delete any other node except the first it works fine, but when I try to delete the first node the whole list messes up, I've tried different solutions and I have the same outcome, I don't know what to do anymore</p>\n\n<p>One of my tries was this:</p>\n\n<pre><code>void deleteClient (client **p, int n){\n    client *t = *p;\n\n    if (t){\n        while (t &amp;&amp; t-&gt;id != n)\n                t = t-&gt;next;\n            if (t){\n                client * ax = t;\n                t = t-&gt;next;\n                free(ax);\n            }\n    }\n}\n</code></pre>\n\n<p>The other one was this</p>\n\n<pre><code>void deleteClient (client **p, int n){\n    client *t = *p;\n\n    if (t)\n        if (t-&gt;id == n){\n            client * ax = *p;\n            *p = (*p)-&gt;next;\n            free(ax);\n            return;\n        }\n        else{\n            while (t-&gt;next &amp;&amp; t-&gt;next-&gt;id != n)\n                t = t-&gt;next;\n            if (t-&gt;next){\n                client * ax = t-&gt;next;\n                t-&gt;next = t-&gt;next-&gt;next;\n                free(ax);\n            }\n        }\n}\n</code></pre>\n\n<p>But in both versions of the code it only deletes fine from the second node onwards, while messing up the whole list if I try to delete the first node.</p>\n"}, {"tags": ["c", "buffer-overflow"], "comments": [{"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 3, "creation_date": 1566416636, "post_id": 57598233, "comment_id": 101653751, "body": "Now is a good time to learn how to debug a program with a proper debugger.  Not sure what your development platform is.  Load the program in a debugger, step through each line of code, and examine the variable values."}, {"owner": {"reputation": 179, "user_id": 11656314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13c1fc455d1139c87c35bede13d0290?s=128&d=identicon&r=PG&f=1", "display_name": "Valyrie H. Autumn", "link": "https://stackoverflow.com/users/11656314/valyrie-h-autumn"}, "edited": false, "score": 0, "creation_date": 1566416742, "post_id": 57598233, "comment_id": 101653796, "body": "May I request that the indentation on the code formatting be made a bit more regular?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 6, "creation_date": 1566416746, "post_id": 57598233, "comment_id": 101653799, "body": "You fill up your arrays <code>temp_hours</code> and <code>temp_events</code> without adding a terminating <code>\\0</code>. When you pass them to <code>strcat</code> which expects to get pointers to C strings, i.e. NUL-terminated character sequences you invoke undefined behaviour"}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 1, "creation_date": 1566416892, "post_id": 57598233, "comment_id": 101653859, "body": "As Gerhardh said... you probably want to <code>char temp_hours[EVENT_NAME_SIZE + 1]</code> (add a space the the null termination) otherwise strcat will keep cat&#39;ting until it finds a null. There may be a few other places where a +1 is needed"}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1566416942, "post_id": 57598233, "comment_id": 101653880, "body": "@Gerhardh might be a good answer instead of just a comment."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1566420778, "post_id": 57598233, "comment_id": 101655317, "body": "If you use Clang or GCC, you can very very easily identify the cause of these errors by adding <code>-fsanitize=address</code> to your compiler invocation. The program will stop cleanly at the point of overflow."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1566423985, "post_id": 57598233, "comment_id": 101656294, "body": "Absent a compiler bug, a variable is never overwritten for no apparent reason..."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1566419639, "creation_date": 1566419639, "answer_id": 57598850, "question_id": 57598233, "link": "https://stackoverflow.com/questions/57598233/a-variable-is-being-overwritten-for-no-apparent-reason/57598850#57598850", "title": "A variable is being overwritten for no apparent reason", "body": "<p>All your array declarations exclude space for string terminating zero byte.</p>\n\n<p>It should be:</p>\n\n<pre><code>char events[8+EVENT_NAME_SIZE*7+1] = {0};\nchar  hours[8+EVENT_NAME_SIZE*7+1] = {0};\n</code></pre>\n\n<p>where you want to hold <code>EVENT_NAME_SIZE</code> spaces or <code>b</code> characters and 8 <code>|</code> characters.</p>\n\n<p>and:</p>\n\n<pre><code>    char temp_events[EVENT_NAME_SIZE+1]= {0};\n    char temp_hours[EVENT_NAME_SIZE+1] = {0};\n</code></pre>\n\n<p>If you want to store <code>EVENT_NAME_SIZE</code> characters in a string, you need <code>EVENT_NAME_SIZE</code> bytes of space plus one byte for terminating zero character.</p>\n\n<p>Functions like <code>strcat</code> need zero terminated arrays. Also programmer need to make sure the destination have enough space available. The behavior of the first <code>strcat(events, temp_events);</code> is undefined - <code>temp_events</code> is not null terminated, so <code>strcat</code> was accessing some random data of memory.</p>\n"}], "owner": {"reputation": 3, "user_id": 11958030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ecc5250851add33f0d2a598407a7598?s=128&d=identicon&r=PG&f=1", "display_name": "user11958030", "link": "https://stackoverflow.com/users/11958030/user11958030"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 57598850, "answer_count": 1, "score": 0, "last_activity_date": 1566419639, "creation_date": 1566416390, "last_edit_date": 1566416881, "question_id": 57598233, "link": "https://stackoverflow.com/questions/57598233/a-variable-is-being-overwritten-for-no-apparent-reason", "title": "A variable is being overwritten for no apparent reason", "body": "<p>I am writing a scheduler in C, and in order to print it I have prepared a function that prints a table with names and times of \"events\". \nIn order to print the tables I have a separation after each line, which is basically \"|=======|========|=======|.....\", so I saved it in a variable and tried using it to print. And for some reason I overflow it with values.</p>\n\n<p>I tried finding out where the error is, and I've tried decreasing the amount of characters added to a string that is defined after it(to prevent the overflow), but those didn't work</p>\n\n<pre><code>char line_break[] = \"|====================|====================|====================|====================|====================|====================|====================|\";\nprintf(\"\\n|       Sunday       |       Monday       |       Teusday      |      Wedensday     |      Thursday      |       Friday       |      Saturday      |\\n%s\\n\",line_break);\n\nfor (int i=0; i &lt; max(schedule_index);i++) {\n    char events[8+EVENT_NAME_SIZE*7] = {0};\n    char  hours[8+EVENT_NAME_SIZE*7] = {0};\n    strcat(events, \"|\");\n    strcat(hours,  \"|\");\n    for (int day=0; day &lt; DAYS_PER_WEEK; day++) {\n        char temp_events[EVENT_NAME_SIZE]= {0};\n        char temp_hours[EVENT_NAME_SIZE] = {0};\n        for (int i=0; i&lt;EVENT_NAME_SIZE;i++) {\n            temp_events[i] = ' ';\n            temp_hours[i] = 'b';\n        }\n\n        strcat(events, temp_events);\n        strcat(events, \"|\");\n\n        strcat(hours, temp_hours);\n        strcat(hours, \"|\");\n    }\n\n    printf(\"%s\\n\", events);\n    printf(\"%s\\n\", hours);\n    printf(\"%s\\n\", line_break);\n}\n</code></pre>\n\n<p>Whenever I execute the code I get the following: </p>\n\n<pre><code>|       Sunday       |       Monday       |       Teusday      |      Wedensday     |      Thursday      |       Friday       |      Saturday      |\n|====================|====================|====================|====================|====================|====================|====================|\n|                    |                    |                    |                    |                    |                    |                    |\n|                    |                    |                    |                    |                    |                    |                    |\n|bbbbbbbbbbbbbbbbbbbb|bbbbbbbbbbbbbbbbbbbb|bbbbbbbbbbbbbbbbbbbb|bbbbbbbbbbbbbbbbbbbb|bbbbbbbbbbbbbbbbbbbb|bbbbbbbbbbbbbbbbbbbb|bbbbbbbbbbbbbbbbbbbb|\nbbbbbbbbbbbbbbbbb|\n</code></pre>\n\n<p>So that's how I figured out the problem is the <code>line_break</code> variable is being overridden by the <code>hours</code> variable but I still have no clue as to why it's happening. <code>EVENT_NAME_SIZE</code> is declared to be 20,<code>DAYS_PER_WEEK</code> is also 7, <code>max(schedule_index)</code> is just for me to find out what is the max amount of hours I have to draw,</p>\n"}, {"tags": ["c", "cuda", "nvidia"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11958785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce46c1231d3cada27221655346d9554?s=128&d=identicon&r=PG&f=1", "display_name": "user8675309", "link": "https://stackoverflow.com/users/11958785/user8675309"}, "edited": false, "score": 0, "creation_date": 1566416034, "post_id": 57598005, "comment_id": 101653487, "body": "I want to make sure I understand the last part. Can I think of register memory as kind of a &quot;stack&quot; for each thread? And how are register and local memory related?"}, {"owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "reply_to_user": {"reputation": 1, "user_id": 11958785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce46c1231d3cada27221655346d9554?s=128&d=identicon&r=PG&f=1", "display_name": "user8675309", "link": "https://stackoverflow.com/users/11958785/user8675309"}, "edited": false, "score": 0, "creation_date": 1566416161, "post_id": 57598005, "comment_id": 101653545, "body": "@user8675309 I meant just the syntax. They are like automatic variables. They die when they go out of scope...."}, {"owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1566431691, "post_id": 57598005, "comment_id": 101658092, "body": "Isnt new working on local? Every thread gets a different pointer."}, {"owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "reply_to_user": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 1, "creation_date": 1566451655, "post_id": 57598005, "comment_id": 101661531, "body": "@huseyintugrulbuyukisik &quot;new and delete operate on device heap memory. The device allows for a portion of the global (i.e. on-board) memory to be allocated in this fashion.&quot;<a href=\"https://stackoverflow.com/questions/14417318/cuda-new-delete\">stackoverflow.com/questions/14417318/cuda-new-delet&zwnj;&#8203;e</a>. yes every thread gets different pointer."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1566509845, "post_id": 57598005, "comment_id": 101689544, "body": "Another method for global memory allocation is the static method, using the <code>__device__</code> decorator.  (<code>cudaMalloc()</code> from host code would be considered dynamic allocation)  In addition to <code>new</code> and <code>delete</code> for in-kernel usage, equivalent in-kernel behavior is possible with <code>malloc()</code> and <code>free()</code>, and also <code>cudaMalloc()</code> and <code>cudaFree()</code>."}], "tags": [], "owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "is_accepted": false, "score": 2, "last_activity_date": 1566416441, "last_edit_date": 1566416441, "creation_date": 1566415242, "answer_id": 57598005, "question_id": 57597831, "link": "https://stackoverflow.com/questions/57597831/which-memory-space-does-cudamalloc-allocate-memory-in/57598005#57598005", "title": "Which memory space does cudaMalloc allocate memory in?", "body": "<p><strong>global</strong></p>\n\n<p><code>cudaMalloc</code> allocates in global memory.\nThe other method for global memory allocation is using <code>new</code> and <code>delete</code> inside kernel.</p>\n\n<pre><code>__global__ void myKernel(int N)\n{\n     int* a = new int[N]; // not recommended\n     delete [] a;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>shared</strong> </p>\n\n<p>For dynamic shared memory you use sth like</p>\n\n<pre><code>extern __shared__ int s[];\n</code></pre>\n\n<p>And launch kernel like</p>\n\n<pre><code>myKernel&lt;&lt;&lt;1,n,n*sizeof(int)&gt;&gt;();\n</code></pre>\n\n<p>Or just <code>__shared__ int s[4];</code> (inside kernel) for static shared memory</p>\n\n<hr>\n\n<p><strong>register</strong></p>\n\n<p>And for register you can think of automatic allocation in C++(just from syntax point of view):</p>\n\n<pre><code>int example = 0;\nint moreExample[4]\n</code></pre>\n\n<p>the main difference is if you run out of register memory you will have register spilling and the variable may end up in global memory instead of register.</p>\n"}], "owner": {"reputation": 1, "user_id": 11958785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce46c1231d3cada27221655346d9554?s=128&d=identicon&r=PG&f=1", "display_name": "user8675309", "link": "https://stackoverflow.com/users/11958785/user8675309"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566486310, "creation_date": 1566414359, "last_edit_date": 1566486310, "question_id": 57597831, "link": "https://stackoverflow.com/questions/57597831/which-memory-space-does-cudamalloc-allocate-memory-in", "title": "Which memory space does cudaMalloc allocate memory in?", "body": "<p>If I understand correctly, CUDA devices have a few different <a href=\"https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#device-memory-spaces\" rel=\"nofollow noreferrer\">memory spaces</a>. (e.g. register, local, shared, global, etc). When calling <code>cudaMalloc()</code>, which memory space does allocated memory reside? </p>\n\n<p>For example:</p>\n\n<pre><code>__global__ mykernel (void *p) {\n    /* What memory space does p point to? */\n    printf(\"p: %p\\n\", p);\n}\n\nint main() {\n    void *p;\n    assert(cudaMalloc (&amp;p, 1024) == CUDA_SUCCESS);\n    mykernel&lt;&lt;&lt;1,1024&gt;&gt;&gt; (p);\n}\n</code></pre>\n\n<p>The <a href=\"https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__MEMORY.html#group__CUDART__MEMORY_1g37d37965bfb4803b6d4e59ff26856356\" rel=\"nofollow noreferrer\">documentation</a> does not mention at what level the memory is allocated. It only says</p>\n\n<blockquote>\n  <p>Allocates <code>size</code> bytes of linear memory on the device and returns a pointer to the allocated memory. The allocated memory is suitably aligned for any kind of variable. The memory is not cleared.</p>\n</blockquote>\n\n<p>It seems the memory would have to reside in one of global/constant/texture spaces, but which one?</p>\n\n<p>Is it also safe to assume the memory will never be in local/register/shared memory space?</p>\n"}, {"tags": ["c", "gcc", "makefile", "htk", "makefile-errors"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1566413347, "post_id": 57597548, "comment_id": 101652305, "body": "The problem is probably close to, but not actually <i>on</i>, line 77.  Could you please expand your quotation of the Makefile to include lines 65 through 90, with line 77 marked?"}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 2, "creation_date": 1566421497, "post_id": 57597548, "comment_id": 101655547, "body": "Please remember you need to be looking at <code>&#47;home&#47;zeesy&#47;htk-3.4.1&#47;HLMTools&#47;Makefile</code> not some other makefile"}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1566433393, "post_id": 57597548, "comment_id": 101658344, "body": "Are you using soft tabs by any chance?"}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1566452932, "post_id": 57597548, "comment_id": 101661881, "body": "Just by looking at your spacing I can see that the recipie for <code>mkinstalldir</code> is indentend further the the other receipies. So I think you need to look at what characters are there. I would delete each indentation and re-indent them ensuring the tab character is used (your editor may be forcing spaces as user58697 is eluding to). But for sure, one of those is wrong - otherwise they would all be indented the same. You can check they are tabs but using the arrow keys to navigate over that white space (tab should be one character wide). Also make sure there are no EOL white spaces."}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1566453059, "post_id": 57597548, "comment_id": 101661936, "body": "... or even just comment out the line starting with <code>if [ ! -d ...</code> by putting a <code>#</code> at the very start of the line and see if the error goes away  - that would be the quickest check"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 1, "creation_date": 1566454824, "post_id": 57597548, "comment_id": 101662564, "body": "Many editors and some IDEs can show whitespace characters by an option. Use this to be <b>sure</b> that you have tabs. Make needs a tab as first character on a line to recognize it as command line. It is OK if spaces follow but the tab is mandatory."}, {"owner": {"reputation": 509, "user_id": 6069097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SuOdC.jpg?s=128&g=1", "display_name": "Zeesy", "link": "https://stackoverflow.com/users/6069097/zeesy"}, "reply_to_user": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1566498380, "post_id": 57597548, "comment_id": 101685307, "body": "Thanks for suggestions @code_fodder I have corrected the (autogenerated) quadruple tabs, and the Makefile isn&#39;t throwing errors. However, HTK still isn&#39;t compiling. If you&#39;re interested, see modified question above."}], "answers": [{"comments": [{"owner": {"reputation": 23634, "user_id": 432021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c16a68dfa5030f9b6df4d4ae4a337a?s=128&d=identicon&r=PG", "display_name": "Nikolay Shmyrev", "link": "https://stackoverflow.com/users/432021/nikolay-shmyrev"}, "edited": false, "score": 1, "creation_date": 1566662092, "post_id": 57600102, "comment_id": 101730820, "body": "If you see &quot;Nothing to be done for &#39;all&#39;&quot; there is no need to run make clean and make again, you already have everything compiled. You just proceed with other steps"}, {"owner": {"reputation": 509, "user_id": 6069097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SuOdC.jpg?s=128&g=1", "display_name": "Zeesy", "link": "https://stackoverflow.com/users/6069097/zeesy"}, "reply_to_user": {"reputation": 23634, "user_id": 432021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c16a68dfa5030f9b6df4d4ae4a337a?s=128&d=identicon&r=PG", "display_name": "Nikolay Shmyrev", "link": "https://stackoverflow.com/users/432021/nikolay-shmyrev"}, "edited": false, "score": 0, "creation_date": 1566840919, "post_id": 57600102, "comment_id": 101773847, "body": "Thank you. After working with Julius some more I have realized that although everything has compiled, it has not compiled correctly due to some other error. I&#39;ve made a post on the <a href=\"http://www.voxforge.org/home/forums/message-boards/general-discussion/ls-cannot-access-/tmp/bin.linux-no-such-file-or-directory-on-ubuntu-18.04#ndV99s04IGgRjqquU6pGJg\" rel=\"nofollow noreferrer\">HTK forums</a> but no response yet."}, {"owner": {"reputation": 23634, "user_id": 432021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c16a68dfa5030f9b6df4d4ae4a337a?s=128&d=identicon&r=PG", "display_name": "Nikolay Shmyrev", "link": "https://stackoverflow.com/users/432021/nikolay-shmyrev"}, "edited": false, "score": 1, "creation_date": 1566854021, "post_id": 57600102, "comment_id": 101778682, "body": "You have to run <code>make install</code> to install it in /tmp/bin.linux folder as you configured. Forum is for Voxforge, not HTK. I&#39;m too lazy to reply you there though."}, {"owner": {"reputation": 509, "user_id": 6069097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SuOdC.jpg?s=128&g=1", "display_name": "Zeesy", "link": "https://stackoverflow.com/users/6069097/zeesy"}, "reply_to_user": {"reputation": 23634, "user_id": 432021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c16a68dfa5030f9b6df4d4ae4a337a?s=128&d=identicon&r=PG", "display_name": "Nikolay Shmyrev", "link": "https://stackoverflow.com/users/432021/nikolay-shmyrev"}, "edited": false, "score": 0, "creation_date": 1566924727, "post_id": 57600102, "comment_id": 101805102, "body": "I&#39;ve run <code>.&#47;configure --prefix=&#47;tmp</code>, <code>make all</code> and <code>make install</code> again from the voxforge/bin/htk directory, but am still getting <code>ls: cannot access &#39;&#47;tmp&#47;bin.linux&#39;: No such file or directory</code> when I run <code>ls &#47;tmp&#47;bin.linux</code>. /tmp doesn&#39;t appear in <code>ls</code>, but its contents (including <code>bin.linux</code>) do appear for <code>ls &#47;tmp</code>."}, {"owner": {"reputation": 23634, "user_id": 432021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c16a68dfa5030f9b6df4d4ae4a337a?s=128&d=identicon&r=PG", "display_name": "Nikolay Shmyrev", "link": "https://stackoverflow.com/users/432021/nikolay-shmyrev"}, "edited": false, "score": 0, "creation_date": 1566925099, "post_id": 57600102, "comment_id": 101805238, "body": "You have to read (and if you want help to share) full and exact output of the commands. All errors are there, you just need to read them."}], "tags": [], "owner": {"reputation": 509, "user_id": 6069097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SuOdC.jpg?s=128&g=1", "display_name": "Zeesy", "link": "https://stackoverflow.com/users/6069097/zeesy"}, "is_accepted": false, "score": 0, "last_activity_date": 1566841057, "last_edit_date": 1566841057, "creation_date": 1566428227, "answer_id": 57600102, "question_id": 57597548, "link": "https://stackoverflow.com/questions/57597548/htk-compile-error-make1-nothing-to-be-done-for-all/57600102#57600102", "title": "HTK compile error: make[1]: Nothing to be done for &#39;all&#39;", "body": "<p>As suggested by MadScientist, I was at first looking at the wrong Makefile. I had been looking at <code>/htk-3.1.4/Makefile</code>, when the file that needed to be edited was <code>/htk-3.1.4/HLMTools/Makefile</code>. A case of not reading the error messages thoroughly.</p>\n\n<p>After getting the  same error message for line 77 </p>\n\n<pre><code>missing separator (did you mean TAB instead of 8 spaces?).\n</code></pre>\n\n<p>I ran Spaces to Tabs in Atom, and corrected the quadruple tab in the default Makefile. </p>\n\n<p>The <code>make all</code> command initially ran successfully, but as I was unable to access <code>ls /tmp/bin.linux</code> I attempted <code>make all</code> again and received the second error message</p>\n\n<pre><code>make[1]: Nothing to be done for 'all'\n</code></pre>\n\n<p>The fix for this was to run <code>make clean</code> (see <a href=\"https://stackoverflow.com/questions/32903139/why-is-make-printing-make-nothing-to-be-done-for-all\">this post</a>). However, Nikolay Shmyrev has pointed out that this error means that everything has compiled, there for there is 'nothing to be done'.</p>\n\n<p>I'm now having problems accessing <code>/tmp/bin.linux</code> but will deal with that elsewhere.</p>\n\n<p><strong>SUMMARY:</strong> The <code>make[1]: Nothing to be done for 'all'</code> error means that everything has already compiled.</p>\n"}], "owner": {"reputation": 509, "user_id": 6069097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SuOdC.jpg?s=128&g=1", "display_name": "Zeesy", "link": "https://stackoverflow.com/users/6069097/zeesy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566841057, "creation_date": 1566412912, "last_edit_date": 1566501566, "question_id": 57597548, "link": "https://stackoverflow.com/questions/57597548/htk-compile-error-make1-nothing-to-be-done-for-all", "title": "HTK compile error: make[1]: Nothing to be done for &#39;all&#39;", "body": "<p>Following the <a href=\"http://htk.eng.cam.ac.uk/docs/inst-nix.shtml\" rel=\"nofollow noreferrer\">official HTK Unix/Linux installation guide</a>, I had similar issues to the ones described in <a href=\"https://stackoverflow.com/questions/54082459/fatal-error-bits-libc-header-start-h-no-such-file-or-directory-while-compili\">this thread</a> when trying to run <code>make all</code> on HTK. I had initially been looking at the wrong Makefile (<code>/htk-3.4.1/Makefile</code>), as suggested by MadScientist. After fixing the extra indentation on line 77 in the correct Makefile (<code>/htk-3.4.1/HLMTools/Makefile</code>) generated by running <code>./configure --prefix=/tmp</code>, the HTK compile error: </p>\n\n<p><code>Makefile:77: *** missing separator (did you mean TAB instead of 8 spaces?).  Stop.</code> </p>\n\n<p>has disappeared, but I am still unable to compile on <code>make all</code>:</p>\n\n<pre><code>$ make all\n(cd HTKTools &amp;&amp; make all) \\\n  || case \"\" in *k*) fail=yes;; *) exit 1;; esac;\nmake[1]: Entering directory '/home/zeesy/htk-3.4.1/HTKTools'\nmake[1]: Nothing to be done for 'all'.\nmake[1]: Leaving directory '/home/zeesy/htk-3.4.1/HTKTools'\n(cd HLMTools &amp;&amp; make all) \\\n  || case \"\" in *k*) fail=yes;; *) exit 1;; esac;\nmake[1]: Entering directory '/home/zeesy/htk-3.4.1/HLMTools'\nmake[1]: Nothing to be done for 'all'.\nmake[1]: Leaving directory '/home/zeesy/htk-3.4.1/HLMTools'\n</code></pre>\n\n<p>Prior to <code>make all</code>, running <code>./configure --prefix=/tmp</code> results in the error:</p>\n\n<pre><code>config.status: WARNING:  HLMTools/Makefile.in seems to ignore the --datarootdir setting\n</code></pre>\n\n<p>for <code>HTKLib</code>, <code>HLMLib</code>, <code>HTKTools</code> and <code>HLMTools</code>. It also resets line 77 of the Makefile to quadruple indented tabs.</p>\n\n<p>I have <code>gcc-multilib</code> installed. Based on <a href=\"https://unix.stackexchange.com/questions/13391/getting-not-found-message-when-running-a-32-bit-binary-on-a-64-bit-system/13409#13409\">this post</a>, I installed <code>libc6:i386</code> <code>zlib1g:i386</code> <code>lib32ncurses5</code> and <code>lib32z1</code> in order to run this 32bit program on a 64bit computer.</p>\n\n<p>Has anyone run into this problem? Step 4 of the <a href=\"http://www.voxforge.org/home/dev/acousticmodels/linux/create/htkjulius/tutorial/download\" rel=\"nofollow noreferrer\">VoxForge HTK install guide</a> suggests that gcc 3.4 compiler compatibility modules are required. </p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566418353, "post_id": 57597499, "comment_id": 101654390, "body": "Maybe cast it to a <code>void *</code> and then to a <code>void **</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 11586179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AvHWY.jpg?s=128&g=1", "display_name": "Treasone", "link": "https://stackoverflow.com/users/11586179/treasone"}, "edited": false, "score": 0, "creation_date": 1566421493, "post_id": 57597638, "comment_id": 101655546, "body": "@lan Abbott I don&#39;t know what the purpose of (void) is, please specify, and can I write this? <code>#define SAFE_FREE(p) free(p);(p) = NULL</code>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 123, "user_id": 11586179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AvHWY.jpg?s=128&g=1", "display_name": "Treasone", "link": "https://stackoverflow.com/users/11586179/treasone"}, "edited": false, "score": 1, "creation_date": 1566428167, "post_id": 57597638, "comment_id": 101657380, "body": "The cast to <code>void</code> is merely to thwart any attempts to assign the value of <code>SAFE_FREE(p)</code> to a variable. The problem with <code>#define SAFE_FREE(p) free(p); (p) = NULL</code> is that it is two statements (when terminated by a semi-colon), so <code>if (foo) SAFE_FREE(bar);</code> wouldn&#39;t work (the <code>(bar) = NULL;</code> part would always be done). A common workaround is <code>#define SAFE_FREE(p) do { free(p); (p) = NULL; } while (0)</code>, which is a single, compound statement when terminated by a semi-colon."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 123, "user_id": 11586179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AvHWY.jpg?s=128&g=1", "display_name": "Treasone", "link": "https://stackoverflow.com/users/11586179/treasone"}, "edited": false, "score": 0, "creation_date": 1566428950, "post_id": 57597638, "comment_id": 101657524, "body": "A significant difference between the &quot;expression&quot; form of the macro such as <code>#define SAFE_FREE(p) (free(p), (p) = NULL)</code> (I left out the <code>(void)</code> cast for you) and the &quot;statement&quot; form of the macro such as <code>#define SAFE_FREE(p) do { free(p); (p) = NULL; } while (0)</code> is that the &quot;expression&quot; form can be used within another expression (especially a comma expression), whereas the &quot;statement&quot; form cannot. (An expression can form a statement, but a statement cannot form an expression - at least not in standard C.)"}, {"owner": {"reputation": 123, "user_id": 11586179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AvHWY.jpg?s=128&g=1", "display_name": "Treasone", "link": "https://stackoverflow.com/users/11586179/treasone"}, "edited": false, "score": 0, "creation_date": 1566453471, "post_id": 57597638, "comment_id": 101662087, "body": "@lan Abbott Thank you, I understand.~"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 123, "user_id": 11586179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AvHWY.jpg?s=128&g=1", "display_name": "Treasone", "link": "https://stackoverflow.com/users/11586179/treasone"}, "edited": false, "score": 0, "creation_date": 1566460051, "post_id": 57597638, "comment_id": 101665068, "body": "@Treasone Also, be aware that calls such as <code>SAFE_FREE(*foo++)</code> will not work with any of these macros because <code>*foo++</code> is evaluated twice by the macro."}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 4, "last_activity_date": 1566413812, "last_edit_date": 1566413812, "creation_date": 1566413321, "answer_id": 57597638, "question_id": 57597499, "link": "https://stackoverflow.com/questions/57597499/is-it-safe-to-use-void-in-special-cases-still-undefined-behavior/57597638#57597638", "title": "Is it safe to use void** in special cases? Still undefined behavior?", "body": "<p>The pointer types <code>int **</code> and <code>void **</code> are incompatible. The type cast just masks the incompatibility.</p>\n\n<p>You could define:</p>\n\n<pre><code>#define SAFE_FREE(p) ((void)(free(p), (p) = NULL))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 5, "last_activity_date": 1566413330, "creation_date": 1566413330, "answer_id": 57597641, "question_id": 57597499, "link": "https://stackoverflow.com/questions/57597499/is-it-safe-to-use-void-in-special-cases-still-undefined-behavior/57597641#57597641", "title": "Is it safe to use void** in special cases? Still undefined behavior?", "body": "<p>The behavior of such code is not defined by the C standard.</p>\n\n<p>In <code>main</code>, <code>mac_arr</code> is an <code>int *</code>. The parameter <code>safeFree</code> receives is a pointer to <code>void *</code>. But <code>int *</code> and <code>void *</code> are not compatible types as defined by the C standard. They may have different sizes, alignment requirements, and representations. So converting the address of <code>mac_arr</code> from <code>int **</code> to <code>void **</code> and using <code>*ptr</code> for an lvalue of type <code>void *</code> is not portable.</p>\n\n<p>It might \u201cwork\u201d in many C implementations.</p>\n\n<p>The <code>SAFE_FREE</code> macro you are contemplating is not a great remedy for pointer problems. While it sets the current pointer to an object to null, it has no way of affecting other pointers to the same object, such as links in linked lists or links in other data structures.</p>\n\n<p>(It also does not need to test <code>*ptr != NULL</code>. <code>free</code> is specified to do nothing when it is passed a null pointer, so you would just be doubling up on a test that is already performed.)</p>\n"}], "owner": {"reputation": 123, "user_id": 11586179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AvHWY.jpg?s=128&g=1", "display_name": "Treasone", "link": "https://stackoverflow.com/users/11586179/treasone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 57597638, "answer_count": 2, "score": 0, "last_activity_date": 1566413812, "creation_date": 1566412675, "question_id": 57597499, "link": "https://stackoverflow.com/questions/57597499/is-it-safe-to-use-void-in-special-cases-still-undefined-behavior", "title": "Is it safe to use void** in special cases? Still undefined behavior?", "body": "<p>I want to create a function that frees the memory pointed to by the pointer and assigns this pointer to NULL. So I have to declare the argument as <code>void**</code> (an indirect pointer), I know that <code>void*</code> is safe for converting pointers, and using <code>void**</code> is undefined behavior. But I think that should be no problem in this situation.Will this function safely free any memory allocated by <code>malloc()</code> without undefined behavior?  Ask the hackers to help or suggest a better way.</p>\n\n<p>C code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// If I use safeFree(&amp;mac_arr); ,\n// it will warn \"Incompatible pointer types passing ' int **' to parameter of type ' void **'\"\n// So I used #define, don't care about this.\n\n#define SAFE_FREE(p) safeFree((void **)&amp;(p))\n\nvoid safeFree(void ** ptr);\n\nint main(void) {\n    int *mac_arr = malloc(sizeof *mac_arr);\n    SAFE_FREE(mac_arr);\n    return 0;\n}\n\nvoid safeFree(void ** ptr){\n    if (ptr != NULL &amp;&amp; *ptr != NULL) {\n        free(*ptr);\n        *ptr = NULL;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "database", "sqlite"], "comments": [{"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1566412937, "post_id": 57597465, "comment_id": 101652149, "body": "There are three files in all: pcg32-demo.c (the one with the code example here), pcg_basic.c and pcg_basic.h"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1566415307, "post_id": 57597465, "comment_id": 101653159, "body": "All that code does is print out random numbers (and it&#39;s lifted from the pcg test suite). Where does sqlite come into play?"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1566425675, "post_id": 57597465, "comment_id": 101656770, "body": "No, there will be no database nor tables (i.e. database schema) created automatically &quot;on the fly&quot;.  You could do some of that beforehand using another tool, but you could also do it in code, but that is not answerable by anyone else since it is up to you to decide how you want to create and prepare the database.  Regardless of how you create and set up the database, you&#39;ll still need to include an sqlite library in the code, then add code to open the connection, then code to execute inserts into the database.  All that is too broad for a stack overflow question."}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1566437073, "post_id": 57597465, "comment_id": 101658935, "body": "@Shawn. Because I will be analysing millions of records, I will first store the rounds in a SQLite database."}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1566437190, "post_id": 57597465, "comment_id": 101658964, "body": "@C Perkins. Okay point taken. I will use a tool (DB Browser for SQLite) to create the database and tables ahead of time."}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1566437532, "post_id": 57597465, "comment_id": 101659012, "body": "Include an SQLlite library in the code. This would be done by including this header file: #include &lt;sqlite3.h&gt; --- Is that correct?"}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1566521974, "post_id": 57597465, "comment_id": 101691852, "body": "@Stephan Schlecht --- What code would work for this requirement?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567354208, "post_id": 57746327, "comment_id": 101932593, "body": "Thanks for the input. Have been at a roadblock with this. Even tried the C++ version."}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567354830, "post_id": 57746327, "comment_id": 101932750, "body": "Is it better to use code to create the SQLite db and table instead of doing it from the command line? The problem is: When I build the program in Xcode, it cannot find the db/table (path problem?). Output: failure preparing insert: no such table: experiment"}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567366306, "post_id": 57746327, "comment_id": 101935211, "body": "most likely it&#39;s a path problem, on the terminal command line take a look where you create the random.sqlite db (e.g. /Users/mjm or something similar) - then in the line <code>char *pathToDB = &quot;&lt;a path to random.sqlite&gt;&quot;;</code> replace <code>&lt;a path to random.sqlite&gt;</code> with an absolute path (e.g. <code>&#47;Users&#47;mjm&#47;random.sqlite</code>) so that it looks like <code>char *pathToDB = &quot;&#47;Users&#47;mjm&#47;random.sqlite&quot;;</code>"}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567410675, "post_id": 57746327, "comment_id": 101943102, "body": "Some progress but \u201dBuild Failed&quot;    This is the absolute path, and what I used in the code:      * char *pathToDB = &quot;/Users/Mike/Library/Developer/Xcode/DerivedData/CoinToss1/B&zwnj;&#8203;uild/Products/Debug/&zwnj;&#8203;random.sqlite&quot;;   error message: Expected identifier or \u2018(&#39;"}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567410844, "post_id": 57746327, "comment_id": 101943172, "body": "Further down in the code another problem comes up (related to the first one?):      if (sqlite3_open(pathToDB, &amp;db) != SQLITE_OK) {   error message: Use of undeclared identifier &#39;pathToDB&#39;"}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567413561, "post_id": 57746327, "comment_id": 101944261, "body": "you should not use the path ~/Library/Developer/Xcode/DerivedData/... - it is managed by Xcode for intermediate build results and could also be cleaned in between. Use something like <code>&#47;Users&#47;Mike&#47;random.sqlite</code> or <code>&#47;Users&#47;Mike&#47;db&#47;random.sqilte</code>.  The answer above compiles correctly, just copy it over once again and add the correct path to the db there - also follow the instructions in the answer to create the table and it will work ;-)"}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567417863, "post_id": 57746327, "comment_id": 101946113, "body": "Build still fails for me...   * char *pathToDB = &quot;Users/Mike/Development/db/random.sqlite&quot;;  error message: Expected identifier or &#39;(&#39;"}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567417935, "post_id": 57746327, "comment_id": 101946148, "body": "Using DB Browser for SQLite, I have checked, the db has been created correctly and so has the table. It looks good at that level. What is wrong with the path?"}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567418476, "post_id": 57746327, "comment_id": 101946405, "body": "(1) there should be no <code>*</code> at the beginning of the line, so it is <i>not</i> <code>* char *pathToDB = &quot;U...</code> -&gt; instead the line should start with <code>char *...</code> - take a look at my answer (2) an absolute path starts with <code>&#47;</code> so it should be <code>char *pathToDB = &quot;&#47;Users&#47;Mi...</code> and <i>not</i> <code>char *pathToDB = &quot;Users&#47;Mi</code> - perhaps take a look at the code sample and instructions again"}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567419148, "post_id": 57746327, "comment_id": 101946681, "body": "Okay, that is working correctly now, it builds as it should, be there is the following error message:   can&#39;t open db: : unable to open database file Program ended with exit code: 1"}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567423653, "post_id": 57746327, "comment_id": 101948638, "body": "double check your path (you get this message typically if the path is not correct (e.g. if a subdirectory of the path is not created or wrongly spelled))"}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567427536, "post_id": 57746327, "comment_id": 101950400, "body": "I can&#39;t see any fault with the path, spelling etc. I have renamed directories and created a new path, just to be sure, but the same result. Is there another possibility for this error? Thanks"}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567495179, "post_id": 57746327, "comment_id": 101968863, "body": "How does the line starting with <code>char *pathToDB =</code> look like now in your code?"}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567503173, "post_id": 57746327, "comment_id": 101972883, "body": "char *pathToDB = &quot;Users/Mike/Development/Database/random.sqlite&quot;;"}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567503393, "post_id": 57746327, "comment_id": 101973010, "body": "I think I (now) see the problem. It should be: char *pathToDB = &quot;/Users/Mike/Development/Database/random.sqlite&quot;;  Is that correct? Was missing a forward slash."}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567504128, "post_id": 57746327, "comment_id": 101973406, "body": "Great news, the db is now populated. Thank you."}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567504549, "post_id": 57746327, "comment_id": 101973655, "body": "Is there a reason why there is a round &quot;0&quot;? Instead of the first round being &quot;1&quot;, it is tabled as &quot;0&quot;. (BTW, would it be a good idea to close this question as it has been answered for the question asked? Perhaps db questions could be part of a separate thread?)"}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567505779, "post_id": 57746327, "comment_id": 101974287, "body": "Yes it is correct you should use a forward slash as first parameter, see Point (2) in my comment above :-)  In C normally one works with indices starting from 0, so the first element usually has the index 0, but if you don&#39;t like this in the DB you can start from 1. And you are right, since this question seems to be answered, consider to accept it, for new questions, think about asking  new ones (the help center can be helpful, take a look here: <a href=\"https://stackoverflow.com/help/asking\">stackoverflow.com/help/asking</a> )."}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567768572, "post_id": 57746327, "comment_id": 102072021, "body": "Despite the fact that the original (Melissa O\u2019Neil)l program provided true random distribution, I have noticed an anomaly with the revamped one."}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567768583, "post_id": 57746327, "comment_id": 102072024, "body": "Instead of there being some expected distribution of randomness (e.g. for 10 tosses, an outcome of 4 heads or 6 heads), each and every time it is exactly 0.50000 (exactly 50% heads). Even if I generate 1000 tosses, it will be exactly 500 heads every time. In fact, even the sequence looks suspicious: Tail - Head - Tail - Head all the way to the end without deviation. I have run all the tests again so as not to bother you with a false finding. But I think something is amiss. Unless I have screwed up somewhere... Do you mind taking a look when have a moment? Thanks, Stephan Schlecht"}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567769873, "post_id": 57746327, "comment_id": 102072606, "body": "Of course this is the case.   This answers your question, what code could be used in a C program to insert data into SQLite. In the answer I have the sentence: <i>Note: Instead of using random values, the code simply outputs &#39;T&#39; and &#39;H&#39; alternately to have a simple test case.</i>  You just need to use <i>your</i> own real data and insert it to Sqlite as shown."}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567770872, "post_id": 57746327, "comment_id": 102073052, "body": "I see. I misunderstood that was a literal implementation, because all along my mission was to get the random data generated from the actual Melissa O&#39;Neil program into the database. Suggestions?"}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567937043, "post_id": 57746327, "comment_id": 102109647, "body": "You have the Melissa O&#39;Neil program that generates random data in two nested loops, and you have a working, complete, self-contained sample program that is capable of writing data from two nested loops into the database. Just combine both."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567937055, "post_id": 57746327, "comment_id": 102109650, "body": "By the way: From your last comment one could conclude that you neither read the text of the answer nor took a look at the source code. If you have a programming problem, here on Stackoverflow are lot&#39;s of fine competent folks who volunteer to help if they can see that you have at least made a little effort to find a solution."}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567952852, "post_id": 57746327, "comment_id": 102113000, "body": "Actually I have spent many frustrating days trying to piece this altogether. As an absolute beginner, this has been beyond me, but I have stuck with it anyway. That&#39;s despite wanting to give up on it. I finally connected it up to SQLite and got all of that working only to discover that I had assumed wrongly about the code you provided. Not all is lost, I am just three-quarters of the way there instead of at the end point. And yes, there are a lot of good folks here, including yourself, that have generously helped. I can imagine it must be very frustrating for the helpers too."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1567971281, "post_id": 57746327, "comment_id": 102117499, "body": "No worries. In the beginning the learning curve is quite steep. Trying to achieve too complex goals right at the beginning leads to frustration. It often makes sense to start with simple exercises and then increase the difficulty level step by step."}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 0, "creation_date": 1568080550, "post_id": 57746327, "comment_id": 102151973, "body": "Working on it ;)"}, {"owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "edited": false, "score": 1, "creation_date": 1568352304, "post_id": 57746327, "comment_id": 102253568, "body": "The program now correctly inserts the random data into the database. I have run several tests and it appears to be correct as far as I can tell. That&#39;s good news. I don&#39;t know if I did it the best way (maybe there are better ways to do it?), but I am not too fussed about that. If you are curious, I will create a link to inspect the code. Thanks for your help on this."}], "tags": [], "owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "is_accepted": true, "score": 0, "last_activity_date": 1567344034, "creation_date": 1567344034, "answer_id": 57746327, "question_id": 57597465, "link": "https://stackoverflow.com/questions/57597465/inserting-many-records/57746327#57746327", "title": "Inserting many records", "body": "<p>I guess I would start with a simple approach and if you need to access results based on rounds and tosses, your table in the database could consist of three fields, e.g. <code>round</code>, <code>toss</code> and <code>result</code>.</p>\n\n<p>To create the database and the table, you could use the command line program sqlite3 as follows:</p>\n\n<pre><code>sqlite3 random.sqlite\n</code></pre>\n\n<p>Then enter the following command at the command prompt:</p>\n\n<pre><code>CREATE TABLE experiment (round INT, toss INT, result CHAR(1));\n</code></pre>\n\n<p>Now you have created a database <code>random.sqlite</code> and a table <code>experiment</code>.</p>\n\n<p>How to fill this table from C?</p>\n\n<p>One way would be:</p>\n\n<ul>\n<li>open db</li>\n<li>create a prepared insert statement</li>\n<li>start a transaction  </li>\n<li>in a loop: \n\n<ul>\n<li>bind values to parameters</li>\n<li>run the SQL</li>\n<li>reset prepared statement</li>\n</ul></li>\n<li>end transaction</li>\n<li>finalize the statement and close the db to avoid resource leaks</li>\n</ul>\n\n<p>A simple example of the flow described could look like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"sqlite3.h\"\n\nvoid exit_with_error(sqlite3 *db, const char * msg) {\n    fprintf(stderr, \"%s: %s\\n\", msg, sqlite3_errmsg(db));\n    sqlite3_close(db);\n    exit(1);\n}\n\nchar *pathToDB = \"&lt;a path to random.sqlite&gt;\";\n\nsqlite3 *open_db(void);\nsqlite3_stmt *prepeare_stmt(sqlite3 *db);\nvoid close_db(sqlite3 *db, sqlite3_stmt *stmt);\n\n\nint main() {\n    sqlite3 *db = open_db();\n    sqlite3_stmt *stmt = prepeare_stmt(db);\n\n    if(sqlite3_exec(db, \"BEGIN TRANSACTION\", NULL, NULL, NULL) != SQLITE_OK) {\n        exit_with_error(db, \"begin transaction failed\");\n    }\n\n    char *result = \"H\";\n    for(int round = 0; round &lt; 100; round++) {\n        for(int toss = 0; toss &lt; 100; toss++) {\n\n            //for a short test simply output alternately \"H\" and \"T\"\n            result = strcmp(result, \"H\") == 0 ? \"T\" : \"H\";\n\n            //bind values to parameters\n            sqlite3_bind_int(stmt, 1, round);\n            sqlite3_bind_int(stmt, 2, toss);\n            sqlite3_bind_text(stmt, 3, result, -1, SQLITE_STATIC);\n\n            //run the SQL\n            if (sqlite3_step(stmt) != SQLITE_DONE) {\n                exit_with_error(db, \"insert failed\");\n            }\n\n            //reset prepared statement to be able to bind new values in next loop pass\n            if (sqlite3_reset(stmt) != SQLITE_OK) {\n                exit_with_error(db, \"reset failed\");\n            }\n\n        }\n    }\n\n    if(sqlite3_exec(db, \"END TRANSACTION\", NULL, NULL, NULL) != SQLITE_OK) {\n        exit_with_error(db, \"end transaction failed\");\n    }\n\n    //finalize the stmt and close db to avoid resource leaks\n    sqlite3_finalize(stmt);\n    sqlite3_close(db);\n\n    return 0;\n}\n\nsqlite3 *open_db(void) {\n    sqlite3 *db;\n\n    if (sqlite3_open(pathToDB, &amp;db) != SQLITE_OK) {\n        exit_with_error(db, \"can't open db: \");\n    }\n    return db;\n}\n\nsqlite3_stmt *prepeare_stmt(sqlite3 *db) {\n    sqlite3_stmt *stmt;\n\n    //create a prepared statement\n    int rc = sqlite3_prepare_v2(db, \"INSERT INTO experiment VALUES (?1,?2,?3)\", -1, &amp;stmt, 0);\n    if (rc != SQLITE_OK) {\n        exit_with_error(db, \"failure preparing insert\");\n    }\n\n    return stmt;\n}\n</code></pre>\n\n<p>Note: Instead of using random values, the code simply outputs 'T' and 'H' alternately to have a simple test case. </p>\n\n<p>After executing the program, you can take a look at the stored values with the command line as follows:</p>\n\n<pre><code>sqlite3 random.sqlite\n</code></pre>\n\n<p>At the sqlite command prompt you can enter: </p>\n\n<pre><code>SELECT * FROM experiment;\n</code></pre>\n\n<p>The following should then be output in the console:</p>\n\n<pre><code>0|0|T\n0|1|H\n0|2|T\n...\n99|97|H\n99|98|T\n99|99|H\n</code></pre>\n\n<p>To get the value for the third toss in the first round you would issue the following sql statement from the command prompt:</p>\n\n<pre><code>SELECT * from experiment WHERE round=0 and toss=2;\n</code></pre>\n\n<p>that would output something like this on the console:</p>\n\n<pre><code>0|2|T\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11941254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34bca796fc42e1fe11d5382fd6344e0?s=128&d=identicon&r=PG&f=1", "display_name": "MJM", "link": "https://stackoverflow.com/users/11941254/mjm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 57746327, "answer_count": 1, "score": -2, "last_activity_date": 1567344034, "creation_date": 1566412510, "last_edit_date": 1566491439, "question_id": 57597465, "link": "https://stackoverflow.com/questions/57597465/inserting-many-records", "title": "Inserting many records", "body": "<p>The output of the program generates random results for a 100 rounds of 100 coin tosses. I need to get all of those H &amp; T results (10,000) into SQLite for analysis.</p>\n\n<p>Round 1:\nTTTTTHHTHTTHHTTTHHTTTTTTTHHTTHHHHHHTTTHTHTTHHTTTHHHHHHTHTTTTHTHHTHTTTHTHTHTHTTHHTTTTTTHTHTTHHTTTTHTH</p>\n\n<p>-</p>\n\n<p>Round 99:\nTTHHHTHTHHTTTHHTTHTHTHTTHHHHHTHTTTTHHHHTHTHTHTHHHHTTTTTHTTHHHTTTTHTTHHHHTTTTTTHHTHTTHTTTTHTHHTTHHTHT</p>\n\n<p>Round 100:\nTHTHTHHHHHTTHTTTTTTTTTTTHTTHHTHHHTHHTHHHHTTHTHHTTHTHTHHTTHHHTHTHHTHTTTTTHTHTTHHTHTHHHTHTHHTHTHHTTTHH</p>\n\n<p>I have little knowledge how to do this, so I looked into what others have done. Apparently Multi-row INSERT is not supported. Some sources say the only way to insert several rows in a batch is use a Select statement. How would I achieve this?</p>\n\n<p>Assuming the database and table is already created, what code could I use in a C program to insert all this data into SQLite?</p>\n\n<pre><code>/* This file was mechanically generated from tests/check-pcg32.c */\n\n#include &lt;stdio.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n\n#include \"pcg_basic.h\"\n\nint main(int argc, char** argv)\n{\n    // Read command-line options\n\n    int rounds = 1000;\n    bool nondeterministic_seed = false;\n    int round, i;\n\n    ++argv;\n    --argc;\n    if (argc &gt; 0 &amp;&amp; strcmp(argv[0], \"-r\") == 0) {\n        nondeterministic_seed = true;\n        ++argv;\n        --argc;\n    }\n    if (argc &gt; 0) {\n        rounds = atoi(argv[0]);\n    }\n\n    // In this version of the code, we'll use a local rng, rather than the\n    // global one.\n\n    pcg32_random_t rng;\n\n    // You should *always* seed the RNG.  The usual time to do it is the\n    // point in time when you create RNG (typically at the beginning of the\n    // program).\n    //\n    // pcg32_srandom_r takes two 64-bit constants (the initial state, and the\n    // rng sequence selector; rngs with different sequence selectors will\n    // *never* have random sequences that coincide, at all) - the code below\n    // shows three possible ways to do so.\n\n    if (nondeterministic_seed) {\n        // Seed with external entropy -- the time and some program addresses\n        // (which will actually be somewhat random on most modern systems).\n        // A better solution, entropy_getbytes, using /dev/random, is provided\n        // in the full library.\n\n        pcg32_srandom_r(&amp;rng, time(NULL) ^ (intptr_t)&amp;printf, \n                  (intptr_t)&amp;rounds);\n    } else {\n        // Seed with a fixed constant\n\n        pcg32_srandom_r(&amp;rng, 42u, 54u);\n    }\n\n    printf(\"pcg32_random_r:\\n\"\n           \"      -  result:      32-bit unsigned int (uint32_t)\\n\"\n           \"      -  period:      2^64   (* 2^63 streams)\\n\"\n           \"      -  state type:  pcg32_random_t (%zu bytes)\\n\"\n           \"      -  output func: XSH-RR\\n\"\n           \"\\n\",\n           sizeof(pcg32_random_t));\n\n    for (round = 1; round &lt;= rounds; ++round) {\n        printf(\"Round %d:\\n\", round);\n        /* Make some 32-bit numbers */\n        printf(\"  32bit:\");\n        for (i = 0; i &lt; 6; ++i)\n            printf(\" 0x%08x\", pcg32_random_r(&amp;rng));\n        printf(\"\\n\");\n\n        /* Toss some coins */\n        printf(\"  Coins: \");\n        for (i = 0; i &lt; 100; ++i)\n            printf(\"%c\", pcg32_boundedrand_r(&amp;rng, 2) ? 'H' : 'T');\n        printf(\"\\n\");\n\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 910, "user_id": 6422591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/wIpwn.jpg?s=128&g=1", "display_name": "manish ma", "link": "https://stackoverflow.com/users/6422591/manish-ma"}, "edited": false, "score": 2, "creation_date": 1566412654, "post_id": 57597458, "comment_id": 101652022, "body": "The first one is the adress the pointer holds. The second is the adress of the pointer itself."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1566413390, "last_edit_date": 1566413390, "creation_date": 1566412678, "answer_id": 57597500, "question_id": 57597458, "link": "https://stackoverflow.com/questions/57597458/what-differences-are-there-between-addresses-using-operator-and-without-oper/57597500#57597500", "title": "What differences are there between addresses using &amp; operator and without &amp; operator?", "body": "<p>The variable <code>name</code> contains the address of the string literal <code>\"John\"</code>. </p>\n\n<p>So this call</p>\n\n<pre><code>printf(\"is stored at %p\\n\",name );\n</code></pre>\n\n<p>outputs the address of the first character of the string literal.</p>\n\n<p>The expression <code>&amp;name</code> contains the address of the variable <code>name</code> and has the type <code>char **</code> instead of the type <code>char *</code> So the second call of <code>printf</code> outputs the address of the variable <code>name</code> itself instead of the address of the string literal.</p>\n\n<p>You should cast outputted pointers to the type <code>void *</code>. For example</p>\n\n<pre><code>printf(\"is stored at %p\\n\", ( void * )name );\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11858788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f26610f6691098ffccf27a47d9801be?s=128&d=identicon&r=PG&f=1", "display_name": "Atakan", "link": "https://stackoverflow.com/users/11858788/atakan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1566413478, "accepted_answer_id": 57597500, "answer_count": 1, "score": -1, "last_activity_date": 1566413390, "creation_date": 1566412498, "last_edit_date": 1566412733, "question_id": 57597458, "link": "https://stackoverflow.com/questions/57597458/what-differences-are-there-between-addresses-using-operator-and-without-oper", "closed_reason": "Duplicate", "title": "What differences are there between addresses using &amp; operator and without &amp; operator?", "body": "<p>I have faced two different addresses for a pointer variable.I don't know what they mean.Why was there two different addresses for two outputs?</p>\n\n<pre><code>char *name = \"John\";\nprintf(\"is stored at %p\\n\",name ); //output that is showed \"is stored at 0x558b8c21e9c4\"\nprintf(\"print on the screen %p\\n\",&amp;name);//output that is showed \"print on the screen 0x7ffd8b9be710\"\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "kernel-module"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1566412466, "post_id": 57597355, "comment_id": 101651950, "body": "How are you making your syscall from userspace?"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566412519, "post_id": 57597355, "comment_id": 101651973, "body": "You should add the relevant code where you actually make the syscall."}, {"owner": {"reputation": 189, "user_id": 6545142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d6d4a23008a1b338ee7e9902a5b2a25?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Vannacci", "link": "https://stackoverflow.com/users/6545142/emanuele-vannacci"}, "edited": false, "score": 0, "creation_date": 1566413135, "post_id": 57597355, "comment_id": 101652236, "body": "yes, done. Sorry!"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566415344, "post_id": 57597355, "comment_id": 101653175, "body": "@EmanueleVannacci on which syscall numbers are you installing your custom syscalls?"}, {"owner": {"reputation": 189, "user_id": 6545142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d6d4a23008a1b338ee7e9902a5b2a25?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Vannacci", "link": "https://stackoverflow.com/users/6545142/emanuele-vannacci"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566415866, "post_id": 57597355, "comment_id": 101653398, "body": "@MarcoBonelli Actually, I iterate over the syscall table looking for an entry pointing to sys_ni_syscall and I put my syscalls there. When I mount the module, I usually put the syscalls at 134 and 174"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 1, "creation_date": 1566416100, "post_id": 57597355, "comment_id": 101653517, "body": "@EmanueleVannacci well, syscall 174 is <code>create_module</code>, which is not implemented and therefore takes no arguments. I don&#39;t know much about how syscall resolution works in the kernel but that seems like it could be a problem: the kernel thinks syscall 174 needs no arguments and doesn&#39;t bother passing the correct value. Could that be the case?"}, {"owner": {"reputation": 189, "user_id": 6545142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d6d4a23008a1b338ee7e9902a5b2a25?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Vannacci", "link": "https://stackoverflow.com/users/6545142/emanuele-vannacci"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566416888, "post_id": 57597355, "comment_id": 101653858, "body": "@MarcoBonelli I tried putting the syscall at 180. it is supposed to be sys_nfsservctl, actually not implemented and accepting 3 args. The result does not change... Btw I don&#39;t think that  putting a function accepting more args than the functions supposed to be at that location should matter..."}, {"owner": {"reputation": 189, "user_id": 6545142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d6d4a23008a1b338ee7e9902a5b2a25?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Vannacci", "link": "https://stackoverflow.com/users/6545142/emanuele-vannacci"}, "edited": false, "score": 0, "creation_date": 1566417494, "post_id": 57597355, "comment_id": 101654066, "body": "Moreover, I&#39;m pretty sure that on previous kernel versions the code is gonna work because I remember trying this in the past successfully. However, I cannot check it..."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566417580, "post_id": 57597355, "comment_id": 101654094, "body": "@EmanueleVannacci could it be that your syscall is not going to have any parameter passed by the kernel because it&#39;s supposed to be unimplemented? Maybe you should try replacing an existing syscall (even though I would not suggest playing around with that outside of a VM). You can write a simple wrapper for something like <code>exit</code> for example, that executes your code and then calls the real <code>exit</code>."}, {"owner": {"reputation": 2106, "user_id": 7191047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWSwl.png?s=128&g=1", "display_name": "Danila Kiver", "link": "https://stackoverflow.com/users/7191047/danila-kiver"}, "edited": false, "score": 2, "creation_date": 1566428976, "post_id": 57597355, "comment_id": 101657531, "body": "Check my answer <a href=\"https://stackoverflow.com/questions/55027649/memory-isolation-in-new-linux-kernels-or-what/55174798#55174798\">here</a> - most probably the random values you see in the arguments are the pointers to <code>struct pt_regs</code> instances. In short - in most recent kernels functions which reside directly in the syscalls table receive not the arguments themselves, but a pointer to the structure with these arguments, so you see not the argument, but a pointer. Allocation algorithm places the structure <i>somewhere</i>, and, thus, the pointer is pretty &quot;random&quot;, of course."}, {"owner": {"reputation": 189, "user_id": 6545142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d6d4a23008a1b338ee7e9902a5b2a25?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Vannacci", "link": "https://stackoverflow.com/users/6545142/emanuele-vannacci"}, "reply_to_user": {"reputation": 2106, "user_id": 7191047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWSwl.png?s=128&g=1", "display_name": "Danila Kiver", "link": "https://stackoverflow.com/users/7191047/danila-kiver"}, "edited": false, "score": 1, "creation_date": 1566463187, "post_id": 57597355, "comment_id": 101666556, "body": "@DanilaKiver @MarcoBonelli yes, that was the issue! I modified the syscall in order to accept only the arg <code>const struct pt_regs *regs</code> and passing a value I can find it in the  <code>di</code> field of the struct!"}, {"owner": {"reputation": 2106, "user_id": 7191047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWSwl.png?s=128&g=1", "display_name": "Danila Kiver", "link": "https://stackoverflow.com/users/7191047/danila-kiver"}, "edited": false, "score": 0, "creation_date": 1566463514, "post_id": 57597355, "comment_id": 101666700, "body": "@EmanueleVannacci OK, then I will flag current question as a duplicate too. Glad that this stuff helped."}], "answers": [{"comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 2, "creation_date": 1566416291, "post_id": 57598202, "comment_id": 101653608, "body": "This question is about syscall hijacking though, of course it is not the right way to add a system call. The objective is to replace an existing syscall with an arbitrary function, therefore <i>hijacking</i> it."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566416561, "post_id": 57598202, "comment_id": 101653728, "body": "@MarcoBonelli Right. My concern is that system call hijacking is explicitly an unsupported technique, and that the OP may have been misled into thinking that this is an appropriate thing for a kernel module to do."}, {"owner": {"reputation": 189, "user_id": 6545142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d6d4a23008a1b338ee7e9902a5b2a25?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Vannacci", "link": "https://stackoverflow.com/users/6545142/emanuele-vannacci"}, "edited": false, "score": 0, "creation_date": 1566417284, "post_id": 57598202, "comment_id": 101654003, "body": "@duskwuff Thank you for your answer! However I know that this is an unsupported technique, but I cannot rebuild the kernel. I just need an easy way to run kernel code and pass it parameters."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566417298, "post_id": 57598202, "comment_id": 101654009, "body": "If that was the case, OP wouldn&#39;t have talked about &quot;hijacking&quot; and wouldn&#39;t have used names like <code>HACKED_ENTRIES</code>."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 189, "user_id": 6545142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d6d4a23008a1b338ee7e9902a5b2a25?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Vannacci", "link": "https://stackoverflow.com/users/6545142/emanuele-vannacci"}, "edited": false, "score": 0, "creation_date": 1566419716, "post_id": 57598202, "comment_id": 101654901, "body": "@EmanueleVannacci You don&#39;t need to create a new system call to run code in the kernel. Read the section of the documentation titled &quot;System Call Alternatives&quot;."}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 0, "last_activity_date": 1566416424, "last_edit_date": 1566416424, "creation_date": 1566416225, "answer_id": 57598202, "question_id": 57597355, "link": "https://stackoverflow.com/questions/57597355/syscall-hijacking-how-to-pass-arguments/57598202#57598202", "title": "Syscall hijacking: How to pass arguments?", "body": "<blockquote>\n  <p>I'm trying to register a new syscall hacking the syscall table.</p>\n</blockquote>\n\n<p>This is not a supported method of adding system calls. It will not work reliably or correctly.</p>\n\n<p>If you want to add a system call, add it in the kernel itself, and rebuild the kernel. See the kernel documentation on \"<a href=\"https://www.kernel.org/doc/html/v5.2/process/adding-syscalls.html\" rel=\"nofollow noreferrer\">Adding a New System Call</a>\" for details, but focus in particular on the section describing \"System Call Alternatives\" -- there are many ways to add functionality to the kernel without adding a new system call.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11639899, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b8FNp60-Vps/AAAAAAAAAAI/AAAAAAAAABE/PFKPKSxQxQ4/photo.jpg?sz=128", "display_name": "SkyStar", "link": "https://stackoverflow.com/users/11639899/skystar"}, "is_accepted": false, "score": 0, "last_activity_date": 1566444831, "creation_date": 1566444831, "answer_id": 57601712, "question_id": 57597355, "link": "https://stackoverflow.com/questions/57597355/syscall-hijacking-how-to-pass-arguments/57601712#57601712", "title": "Syscall hijacking: How to pass arguments?", "body": "<p>sys_ni_syscall is an invalid system call.\nIt is defined as no params passed in, so you can't pass params into this syscall <a href=\"https://i.stack.imgur.com/DuKsL.png\" rel=\"nofollow noreferrer\">sys_ni_syscall</a></p>\n\n<p>It is called when an invalid system call number is passed in.</p>\n"}], "owner": {"reputation": 189, "user_id": 6545142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d6d4a23008a1b338ee7e9902a5b2a25?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Vannacci", "link": "https://stackoverflow.com/users/6545142/emanuele-vannacci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "closed_date": 1566489859, "answer_count": 2, "score": 1, "last_activity_date": 1566444831, "creation_date": 1566412079, "last_edit_date": 1566415151, "question_id": 57597355, "link": "https://stackoverflow.com/questions/57597355/syscall-hijacking-how-to-pass-arguments", "closed_reason": "Duplicate", "title": "Syscall hijacking: How to pass arguments?", "body": "<p>I'm trying to register a new syscall hacking the syscall table. I'm able to register a function as syscall and I can properly call it. However, I'm not able to pass arguments.</p>\n\n<p>I'm working on Linux ubuntu, kernel version 5.0.0-25.</p>\n\n<p>copy_from_user and copy_to_user do not return any error but simply the data are not copied. Also passing just a  value doesn't work since I read random value from the kernel side.</p>\n\n<p>Currently, my implementation looks like:</p>\n\n<pre><code>unsigned long sys_call_table = 0xffffffffbb6001e0;\nunsigned long sys_ni_syscall = 0xffffffffba6bd800;\n\nasmlinkage int sys_my_first_sys_call(void){\n    printk(\"%s: zero-params sys-call has been called\\n\",MODNAME);\n    return 0;\n}\n\nasmlinkage int sys_my_second_sys_call(int a){\n    printk(\"%s: 1-param sys-call has been called (with param %d)\\n\",MODNAME,a);\n    return 0;\n}\n\nunsigned long new_sys_call_array[HACKED_ENTRIES] = {sys_my_first_sys_call,sys_my_second_sys_call};\n\nint init_module(void) {\n\n    unsigned long * p = (unsigned long *) sys_call_table;\n    int i,j;\n    int ret;\n\n    unsigned long cr0;\n\n    printk(\"%s: initializing\\n\",MODNAME);\n    j = -1;\n    for (i=0; i&lt;256; i++){\n        if (p[i] == sys_ni_syscall){\n            printk(\"%s: table entry %d keeps address %p\\n\",MODNAME,i,(void*)p[i]);\n            j++;\n            restore[j] = i;\n            if (j == (HACKED_ENTRIES-1)) break;\n        }\n    }\n\n    cr0 = read_cr0();\n        write_cr0(cr0 &amp; ~X86_CR0_WP);\n    for(i=0;i&lt;HACKED_ENTRIES;i++){\n        p[restore[i]] = (unsigned long)new_sys_call_array[i];\n    }\n    write_cr0(cr0);\n\n    printk(\"%s: all new system-calls correctly installed on sys-call table \\n\",MODNAME);\n\n    ret = 0;\n\n    return ret;\n}\n</code></pre>\n\n<p>Userspace, I call the sycall in the following way:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char** argv){\n\n    int sys_call_num, arg;\n\n    if(argc &lt; 2){ \n                printf(\"usage: prog syscall-num [syscall-param]\\n\");\n                return;\n        }\n\n\n        sys_call_num = strtol(argv[1],NULL,10);\n        if (argv[2]){\n            arg = strtol(argv[2],NULL,10);\n            syscall(sys_call_num,arg);\n            return 0;\n        }\n\n    syscall(sys_call_num);\n\n    return 0;\n}\n</code></pre>\n\n<p>Calling the syscall and passing it a params results in printing random values like</p>\n\n<p><code>1-param sys-call has been called (with param -1017053352)</code></p>\n\n<p>anyone has any idea why this happens? I don't think it is a bug...</p>\n"}, {"tags": ["c", "complex-numbers"], "answers": [{"tags": [], "owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "is_accepted": false, "score": -1, "last_activity_date": 1566410494, "creation_date": 1566410494, "answer_id": 57597006, "question_id": 57596927, "link": "https://stackoverflow.com/questions/57596927/how-to-cast-complex-double-in-c/57597006#57597006", "title": "How to cast complex double in C", "body": "<p>From <a href=\"https://en.cppreference.com/w/c/language/arithmetic_types#Complex_floating_types\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/c/language/arithmetic_types#Complex_floating_types</a>:</p>\n\n<blockquote>\n  <p>Each complex type has the same object representation and alignment requirements as an array of two elements of the corresponding real type (<code>float</code> for <code>float complex</code>, <code>double</code> for <code>double complex</code>, <code>long double</code> for <code>long double complex</code>). The first element of the array holds the real part, and the second element of the array holds the imaginary component.</p>\n</blockquote>\n\n<p>So, it would be perfectly valid to write it like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>complex double a;\n{\n    complex_num a_ = dostuff(...);\n    memcpy(&amp;a, &amp;a_, sizeof(a));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566411269, "post_id": 57597062, "comment_id": 101651471, "body": "I would add that <code>CMPLX</code> is C11."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1566410760, "creation_date": 1566410760, "answer_id": 57597062, "question_id": 57596927, "link": "https://stackoverflow.com/questions/57596927/how-to-cast-complex-double-in-c/57597062#57597062", "title": "How to cast complex double in C", "body": "<p>Write yourself a conversion function:</p>\n\n<pre><code>complex double MyCast(complex_num x) { return CMPLX(x.dat[0], x.dat[1]); }\n</code></pre>\n\n<p><code>CMPLX</code> is a standard macro, defined in <code>&lt;complex.h&gt;</code>. Apple LLVM 10.0.1 with clang-1001.0.46.4 and GCC 9.1 optimize this use of <code>CMPLX</code> to no operation, at least in one scenario I tested.</p>\n"}], "owner": {"reputation": 23, "user_id": 3516849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d9d48101c86dc6dc3342fbddf0d894a?s=128&d=identicon&r=PG&f=1", "display_name": "user3516849", "link": "https://stackoverflow.com/users/3516849/user3516849"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 57597062, "answer_count": 2, "score": 0, "last_activity_date": 1566410760, "creation_date": 1566410160, "question_id": 57596927, "link": "https://stackoverflow.com/questions/57596927/how-to-cast-complex-double-in-c", "title": "How to cast complex double in C", "body": "<p>I am calling C functions in a 3rd party library, which return complex numbers using a custom type:</p>\n\n<pre><code>typedef struct\n{\n  double dat[2];\n} complex_num;\n</code></pre>\n\n<p>Here, dat[0] is the real part and dat[1] is the imaginary part. I want to safely and portably cast these to the C <code>complex double</code> type to use optimized math operations like add/multiply etc. Suppose I have a function returning <code>complex_num</code>:</p>\n\n<pre><code>complex_num dostuff(...);\n</code></pre>\n\n<p><strong>My question is, can I safely do the following:</strong></p>\n\n<pre><code>complex double a = (complex double) dostuff(...);\n</code></pre>\n\n<p>Are there any issues with array padding/alignments which would screw up the above cast?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 4, "creation_date": 1566409870, "post_id": 57596800, "comment_id": 101650893, "body": "Please explain why you think that you are doing anything wrong. What happens/does not happen in contrast to what you want?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1566411347, "post_id": 57596800, "comment_id": 101651510, "body": "It might be hard to understand, but even if somebody successfully guesses what your problem with the code is and you get an answer based on that guessing, even then an unclear question does not match the idea of StackOverflow. Please <a href=\"https://stackoverflow.com/posts/57596800/edit\">edit</a> your question to explain what the problem actually is. &quot;What is the problem with this code?&quot; is not a good question. Here is more information for you: <a href=\"https://stackoverflow.com/tour\">tour</a>, <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">codeblog.jonskeet.uk/2012/11/24/&hellip;</a> <a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question</a>"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566472972, "post_id": 57596800, "comment_id": 101671834, "body": "I actually VTC&#39;ed this for &quot;simple typographical error&quot;, but oh well."}], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 1, "last_activity_date": 1566410397, "last_edit_date": 1566410397, "creation_date": 1566409800, "answer_id": 57596840, "question_id": 57596800, "link": "https://stackoverflow.com/questions/57596800/am-i-implementing-pointers-in-a-function-correctly/57596840#57596840", "title": "Am i implementing pointers in a function correctly?", "body": "<p>Right here's your issue:</p>\n\n<pre><code>    *c = *a + *c;\n</code></pre>\n\n<p>You're adding <code>*a</code> and <code>*c</code>, not <code>*a</code> and <code>*b</code>.</p>\n\n<p>Here's fixed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid sum(int *, int *, int *);\n\nint main()\n{\n    int num1, num2, total;\n\n    printf(\"Enter Two Numbers\");\n    scanf(\"\\n%d%d\", &amp;num1, &amp;num2);\n    sum(&amp;num1, &amp;num2, &amp;total);\n    printf(\"\\nThe Sum is %d\", total);\n}\n\nvoid sum(int *a, int *b, int *c)\n{\n    *c = *a + *b;\n}\n</code></pre>\n\n<p>Other than that, good job!</p>\n"}], "owner": {"reputation": 21, "user_id": 11958531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba6d4f62cfdfef933c7febf736100ea?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Umair", "link": "https://stackoverflow.com/users/11958531/syed-umair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1566422233, "answer_count": 1, "score": -1, "last_activity_date": 1566411251, "creation_date": 1566409619, "last_edit_date": 1566409888, "question_id": 57596800, "link": "https://stackoverflow.com/questions/57596800/am-i-implementing-pointers-in-a-function-correctly", "closed_reason": "Needs details or clarity", "title": "Am i implementing pointers in a function correctly?", "body": "<p>I am not understanding how to implement pointers in functions, it would be great if someone could help me out and tell me what I am doing wrong and how to modify it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid sum(int *, int *, int *);\n\nint main()\n{\n    int num1, num2, total;\n\n    printf(\"Enter Two Numbers\");\n    scanf(\"\\n%d%d\", &amp;num1, &amp;num2);\n    sum(&amp;num1, &amp;num2, &amp;total);\n    printf(\"\\nThe Sum is %d\", total);\n}\n\nvoid sum(int *a, int *b, int *c)\n{\n    *c = *a + *c;\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 0, "last_activity_date": 1566410431, "creation_date": 1566410431, "answer_id": 57596989, "question_id": 57596781, "link": "https://stackoverflow.com/questions/57596781/having-trouble-with-linked-lists-program-will-not-print-the-elements/57596989#57596989", "title": "Having trouble with linked lists, program will not print the elements", "body": "<p><code>add_on_beginning</code> is not returning the correct value. It should return the node that was added, since it's the new head of the list. Nothing else will work correctly because of that, because <code>head</code> will always be <code>NULL</code>.</p>\n\n<pre><code>Element *add_on_beginning(Element *head, Element *newN)\n{\n   newN-&gt;next = head;\n\n   return newN;\n}\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 11958375, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TYKRUaUWWG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1llVlpbZu5UQj3bMPCnJkemwA2g/photo.jpg?sz=128", "display_name": "igor", "link": "https://stackoverflow.com/users/11958375/igor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 57596989, "answer_count": 1, "score": 0, "last_activity_date": 1566411749, "creation_date": 1566409521, "last_edit_date": 1566411749, "question_id": 57596781, "link": "https://stackoverflow.com/questions/57596781/having-trouble-with-linked-lists-program-will-not-print-the-elements", "title": "Having trouble with linked lists, program will not print the elements", "body": "<p>I am supposed to do an assignment in C programming language. It includes linked lists and reading user input from the console.</p>\n\n<p>The user inputs numbers into the console, for example ( 1 3 5 7 0 ), which are added, one by one, to the beginning of the linked list. 0 marks the end of the transition. This is what the linked list should look like after the first part: 7 5 3 1</p>\n\n<p>I need to code two different functions that will delete different elements of the linked list.</p>\n\n<p>First function deletes all elements from the list that have the value that you input, and second function deletes the element on the position that the user inputs, if it exists.</p>\n\n<p>At the end, you should print the list.</p>\n\n<p>I've written the the first function correctly, and I am sure about it, with the second function (the one that deletes elements on a certain position) I had some trouble. I made a simple function that counts how many nodes are there in total, so if someone puts a number larger than the amount of nodes, a message would pop up. I also used that function to make a for loop and used it as a limit when searching for the element on a certain position, if that makes any sense. The program also won't print anything, I have no idea why.</p>\n\n<pre><code>    typedef struct Element Element;\n\n    struct Element\n    {\n        int number;\n        Element *next;\n    };\n\n    Element *addnewN(int number)\n    {\n       Element *newN = (Element*)malloc(sizeof(Element));\n\n       newN-&gt;number = number;\n       newN-&gt;next = NULL;\n\n       return newN;\n    }\n\n    Element *add_on_beginning(Element *head, Element *newN)\n    {\n       newN-&gt;next = head;\n\n       return head;\n    }\n\n    Element* delete_value(Element* head, int value)\n    {\n       Element *before = NULL;\n       Element *temp = head;\n       Element *newNhead = head;\n\n       while(temp != NULL)\n       {\n          if(temp-&gt;number == value)\n          {\n            if(before == NULL)\n            {\n               newNhead = temp-&gt;next;\n               free(temp);\n               temp = newNhead;\n            }\n            else\n            {\n                before-&gt;next = temp-&gt;next;\n                free(temp);\n                temp = before-&gt;next;\n            }\n        }\n        else\n        {\n            before = temp;\n            temp = temp-&gt;next;\n        }\n\n     }\n       return newNhead;\n    }\n\n    int counter(Element *head)\n    {\n       int count = 0;\n       Element *temp = head;\n\n       while(temp != NULL)\n       {\n         count++;\n         temp = temp-&gt;next;\n       }\n       return count;\n     }\n\n    Element* delete_on_position(Element* head, int position)\n    {\n       int limit = counter(head);\n\n       Element *temp = head;\n       Element *newNhead = head;\n       Element *before = NULL;\n\n       if(position &gt; limit)\n       {\n         printf(\"Error.\\n\");\n       }\n\n       for(int i = 0; i &lt; limit; i++)\n       {\n          if(position == 0)\n       {\n          newNhead = temp-&gt;next;\n          free(temp);\n          temp = newNhead;\n    }\n    else if(position == i)\n    {\n        before-&gt;next = temp-&gt;next;\n        free(temp);\n        temp = before-&gt;next;\n    }\n    else\n    {\n        before = temp;\n        temp = temp-&gt;next;\n    }\n}\nreturn head;\n}\n\nvoid printElement(Element *element)\n{\n   printf(\"%d \", element-&gt;number);\n}\n\nvoid printList(Element *head)\n{\n   Element *temp = head;\n\n   while(temp != NULL)\n   {\n      printElement(temp);\n      temp = temp-&gt;next;\n   }\n}\n\nvoid menu()\n{\n   printf(\"\\t MENU \\n\");\n   printf(\"1. Delete all elements from the list that have the value that \n   you input.\\n\");\n   printf(\"2. Delete the element on the position, if it exists.\\n\");\n   printf(\"3. Print the list. \\n\");\n   printf(\"4. Exit \\n\");\n}\n\nint main()\n{\n    Element *head = NULL;\n\n    int i = 0;\n    int arr[1000];\n    char temp;\n    int x;\n    int y;\n\n    printf(\"Input the numbers you want: \\n\");\n\n    while(temp != '\\n')\n    {\n       scanf(\"%d%c\", &amp;arr[i], &amp;temp);\n\n       if(arr[i] == 0)\n       {\n          break;\n       }\n\n       head = add_on_beginning(head, addnewN(arr[i]));\n\n       i++;\n     }\n\n     menu();\n\n     while(1)\n     {\n        scanf(\"%d\", &amp;x);\n\n        switch(x)\n       {\n          case 1:\n          {\n             scanf(\"%d\", &amp;y);\n             head = delete_value(head, y);\n             break;\n          }\n          case 2:\n          {\n             scanf(\"%d\", &amp;y);\n             head = delete_on_position(head, y);\n             break;\n          }\n          case 3:\n          {\n              printList(head);\n              break;\n          }\n          case 4:\n          {\n              return 0;\n          }\n     }\n\n  }\n\n   return 0;\n\n }\n</code></pre>\n\n<p>What you are supposed to get would be for example:</p>\n\n<p>Input: 2 4 5 8 5 0 (in one line), and in one line each:</p>\n\n<pre><code>2\n2\n1\n5\n3\n</code></pre>\n\n<p>Output: <code>2 8</code></p>\n\n<p>When debugged, the code does not show any errors.</p>\n"}, {"tags": ["c", "pointers", "malloc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1566407958, "post_id": 57596352, "comment_id": 101650103, "body": "Then <i>what</i> will <code>malloc</code> return? Can you write a proposed prototype?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1566408762, "post_id": 57596352, "comment_id": 101650435, "body": "<a href=\"https://stackoverflow.com/editing-help\">stackoverflow.com/editing-help</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1566408827, "post_id": 57596352, "comment_id": 101650464, "body": "@EugeneSh. Your estimation of OPs abstract language competence seems noticably higher than mine."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1566408934, "post_id": 57596352, "comment_id": 101650502, "body": "Static memory is also addressed using pointers as the compiler uses its address to read/write the value."}], "answers": [{"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566408907, "post_id": 57596484, "comment_id": 101650492, "body": "<code>free(arr); arr = malloc(...);</code> can be shortened to <code>arr = realloc(arr, ...);</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1566408959, "post_id": 57596484, "comment_id": 101650518, "body": "I am staying with things OPs has demonstrated to be aware of, where possible. No need for additional complication... Not contradicting you however, @JL2210 ."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 1, "last_activity_date": 1566408504, "last_edit_date": 1566408504, "creation_date": 1566408125, "answer_id": 57596484, "question_id": 57596352, "link": "https://stackoverflow.com/questions/57596352/why-does-malloc-returns-a-pointer/57596484#57596484", "title": "Why does malloc returns a pointer?", "body": "<p>The way you propose to handle pointers would prevent half of the use cases of pointers.<br>\nThey not only allow to access the content of the memory referenced by the pointer,<br>\nthey also allow to change the memory addressed by the pointer, i.e. which part of memory it refers to.</p>\n\n<p>Accessing the content of the referenced memory is done like</p>\n\n<pre><code>int* arr= malloc(sizeof(int)); /* Do not cast malloc. */\n*arr = 1;\n</code></pre>\n\n<p>Changing the memory which is referenced is done by</p>\n\n<pre><code>free(arr); /* assuming it was initialised as above */\narr= malloc(sizeof(int)*2); /* different now */\n</code></pre>\n\n<p>(<em>Strictly this does not guarantee the pointer to get a different value at the second malloc, but I did not want to make an example which leaks the first allocation by not freeing beforehand.</em>)</p>\n\n<p>And also changing the accessed memory without changing the pointer:</p>\n\n<pre><code>*arr=1;         /* first */\n*(arr+1) =2;    /* second */\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1566408488, "creation_date": 1566408488, "answer_id": 57596566, "question_id": 57596352, "link": "https://stackoverflow.com/questions/57596352/why-does-malloc-returns-a-pointer/57596566#57596566", "title": "Why does malloc returns a pointer?", "body": "<p>First, when a program executes <code>malloc(n)</code>, there is no name. It is not possible to refer to the object by name because there is no name that refers to the space that <code>malloc</code> allocated.</p>\n\n<p>Consider <code>int *p = malloc(n);</code>. This assigns the pointer that <code>malloc</code> returns to <code>p</code>. Note that <code>p</code> is the name of the <em>pointer</em>. It is not the name of the space. <code>*p</code> refers to the space.</p>\n\n<p>We could add a feature to C that lets us bind names to allocated space, so that <code>int &amp;x = *p;</code> caused <code>x</code> to refer to the space. But that is not often what we want to use allocated space for. Sometimes we want to allocate many things and organize them into a linked list or a tree or other structures where one element of a structure points to other structures. We would not want to have an individual name for every structure in the program\u2014we want to work with them dynamically, using computed pointers. For example, consider how we might add up all numbers in an array:</p>\n\n<pre><code>int sum = 0;\nfor (int i = 0; i &lt; N; ++i)\n    sum += array[i];\n</code></pre>\n\n<p>We would not want to write this loop as <code>sum = array[0] + array[1] + array[2] + \u2026;</code>. Aside from being tedious, we do not know how many terms to write at compile time. We want this loop to be dynamic, for the elements to be computed while the program is running. Similarly, with a linked list, we want to write:</p>\n\n<pre><code>int sum = 0;\nfor (int *p = Head; p; p = p-&gt;next)\n    sum += p-&gt;value;\n</code></pre>\n\n<p>So we do not want a bunch of named variables for the allocated objects. We want to be able to manipulate them with pointers.</p>\n"}, {"tags": [], "owner": {"reputation": 62, "user_id": 11957671, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZgSqbWfKr9k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rclGdVbPIk7pw3rz9y8e1BFx82VwQ/photo.jpg?sz=128", "display_name": "biplav karna", "link": "https://stackoverflow.com/users/11957671/biplav-karna"}, "is_accepted": false, "score": -1, "last_activity_date": 1566410520, "creation_date": 1566410520, "answer_id": 57597014, "question_id": 57596352, "link": "https://stackoverflow.com/questions/57596352/why-does-malloc-returns-a-pointer/57597014#57597014", "title": "Why does malloc returns a pointer?", "body": "<p>The way to understand \"why does malloc returns a pointer?\" is by understanding arrays in C. Array in c are sequential collection of elements. For statically allocating array we define as:-</p>\n\n<pre><code>int toys[20];\n</code></pre>\n\n<p>toys is an array of 20 elements of type integer. Here \"toys\" can be considered pointer and can be accessed like it.</p>\n\n<pre><code>*(toys) = 1; // setting first element i.e toys[0] = 1;\n*(toys + 1) = 25; // setting second element i.e toys[1] = 25;\n*(toys + 4) =  60; //setting 5th element i.e toys[4] = 60;\n\n</code></pre>\n\n<p>Now, looking into manual of malloc.</p>\n\n<blockquote>\n  <p>void * malloc(size_t size);</p>\n  \n  <p>The malloc() function allocates size bytes of memory and returns a\n  pointer to the allocated memory.</p>\n</blockquote>\n\n<p>Malloc always allocates memory in chunk (i.e, collection or array). so </p>\n\n<pre><code>p = malloc (8 )\n</code></pre>\n\n<p>allocates 8 bytes and return void type pointer of the 8 bytes, i.e. equivalent to static code below.</p>\n\n<pre><code>void test[8];\n</code></pre>\n\n<p>To get the pointer of desired type, the returned pointer is type casted as below:-</p>\n\n<pre><code>int * myToys = (int *) malloc ( sizeof(int) * 20 ); // same as, int mytoys[20];\n</code></pre>\n\n<p>PS:- Pointers and arrays are correlated. Malloc always returns array of bytes, so it returns pointer.  </p>\n"}], "owner": {"reputation": 7, "user_id": 11695021, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LpVBBip_-3g/AAAAAAAAAAI/AAAAAAAABtw/-BTIjL8QDwo/photo.jpg?sz=128", "display_name": "Manav Gupta", "link": "https://stackoverflow.com/users/11695021/manav-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "closed_date": 1566451868, "accepted_answer_id": 57596566, "answer_count": 3, "score": -3, "last_activity_date": 1566410520, "creation_date": 1566407545, "last_edit_date": 1566408732, "question_id": 57596352, "link": "https://stackoverflow.com/questions/57596352/why-does-malloc-returns-a-pointer", "closed_reason": "Needs details or clarity", "title": "Why does malloc returns a pointer?", "body": "<p>While allocating static memory in c, it can be done quite simply. But while dealing with dynamic memory why do i have to deal with pointer. one explanation is that malloc allocates the memory and returns pointer so that it can be accessed but then why same does not happen in case of static memory?<br>\nShouldn't it be simply accessed by its name?<br>\nfor eg  </p>\n\n<pre><code>int *arr = (int*)malloc(sizeof(int));\n</code></pre>\n"}, {"tags": ["c", "virtual-machine", "processor", "cpu-cores"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1566405869, "post_id": 57596033, "comment_id": 101649340, "body": "Is a virtual core different from a logical processor?"}, {"owner": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1566406631, "post_id": 57596033, "comment_id": 101649635, "body": "I don&#39;t this so. This <a href=\"https://www.itprotoday.com/server-virtualization/understanding-virtual-and-logical-processors\" rel=\"nofollow noreferrer\">article</a> was one of the ones I read. He talks about Virtual Processors per Logical Processor."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1566406917, "post_id": 57596033, "comment_id": 101649754, "body": "That relates the inside cores to the outside cores. When you&#39;re inside the VM, your  VM virtual cores &quot;are&quot; the logical cores, as far as any software is concerned."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1566407063, "post_id": 57596033, "comment_id": 101649795, "body": "Also, that article you linked to isn&#39;t clear on the distinction  between logical cores and physical cores. A single physical core of a processor can have multiple logical cores. Outside of the context of VMs, virtual cores are synonymous with logical cores. The article is relating the number of cores visible inside the VM to the number of logical (virtual) cores of the host."}], "owner": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566405813, "creation_date": 1566405813, "question_id": 57596033, "link": "https://stackoverflow.com/questions/57596033/how-to-count-virtual-cores-on-a-vm-in-c-or-cpp", "title": "How to count Virtual Cores on a VM in C or CPP", "body": "<p>I have a Windows Server 2012R2 VM running on VMWare Workstation 14 and Windows 10 Pro x64. Using C/CPP, I need to be able to count the number of Virtual Cores.  I used the example at the bottom of this <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-getlogicalprocessorinformation\" rel=\"nofollow noreferrer\"> Microsoft Document</a>.</p>\n\n<p>I ran it on the 2012R2 VM. It prints the number of processors, physical core, logical processors,etc, but not the Virtual Cores. Is there any way to get/compute that count?</p>\n"}, {"tags": ["c", "gcc", "optimization", "x86-64", "calling-convention"], "comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1566555611, "post_id": 57595888, "comment_id": 101702233, "body": "At least they think about it, gcc&#39;s optimized dump shows &quot;&lt;retval&gt; = create (); [return slot optimization] [tail call]&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1566406978, "post_id": 57596207, "comment_id": 101649777, "body": "That&#39;s why the return value has class &quot;MEMORY&quot; like the question is asking about.  (And BTW, integer structs up to 16 bytes are returned in RDX:RAX, not RDI.  And RAI isn&#39;t a register name).  Anyway, x86-64 SysV passes an extra pointer arg to the return value space which the function must return as well as write into.  This pointer is always passed in RDI and returned in RAX."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1566407392, "post_id": 57596207, "comment_id": 101649900, "body": "Ok, but that doesn&#39;t fix the fundamental problem with this answer.  The OP isn&#39;t asking <i>why</i> it has type MEMORY, but rather about the missed tailcall optimization for that case."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566408309, "post_id": 57596207, "comment_id": 101650242, "body": "(And BTW, <code>Vec2</code> is returned in the low qword each of XMM1 and XMM0.  <a href=\"https://godbolt.org/z/lfLQv2\" rel=\"nofollow noreferrer\">godbolt.org/z/lfLQv2</a>.  FP-only structs aren&#39;t passed/returned in integer registers)"}], "tags": [], "owner": {"reputation": 310, "user_id": 6719353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bgXrn.png?s=128&g=1", "display_name": "cmwt", "link": "https://stackoverflow.com/users/6719353/cmwt"}, "is_accepted": false, "score": -1, "last_activity_date": 1566410231, "last_edit_date": 1566410231, "creation_date": 1566406752, "answer_id": 57596207, "question_id": 57595888, "link": "https://stackoverflow.com/questions/57595888/why-is-tailcall-optimization-not-performed-for-types-of-class-memory/57596207#57596207", "title": "Why is tailcall optimization not performed for types of class MEMORY?", "body": "<p><a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI\" rel=\"nofollow noreferrer\">System V AMD64 - ABI</a> will return data from a function in registers <code>RDX</code> and <code>RAX</code> or <code>XMM0</code> and <code>XMM1</code>. Looking at <a href=\"https://godbolt.org/z/7oKqPq\" rel=\"nofollow noreferrer\">Godbolt</a> the optimization seems to be based on size. The compiler will only return up to 2 <code>double</code> or 4 <code>float</code> in registers.</p>\n\n<hr>\n\n<p>Compilers miss optimizations all the time. The C language does not have tail-call optimization, unlike Scheme. GCC and Clang have said that they have no plans to try and guarantee tail-call optimization. It sounds like OP could try asking the compiler developers or open a bug with said compilers.</p>\n"}, {"comments": [{"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1566938191, "post_id": 57597039, "comment_id": 101810382, "body": "I have followed your advice (<a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=91515\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=91515</a>), yet got not that much insight. However, I think you are correct and this is missed optimization."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 7, "last_activity_date": 1566419773, "last_edit_date": 1566419773, "creation_date": 1566410615, "answer_id": 57597039, "question_id": 57595888, "link": "https://stackoverflow.com/questions/57595888/why-is-tailcall-optimization-not-performed-for-types-of-class-memory/57597039#57597039", "title": "Why is tailcall optimization not performed for types of class MEMORY?", "body": "<p>Looks like a missed optimization bug that you should report, if there isn't already a duplicate open for gcc and clang.</p>\n\n<p>(It's not rare for both gcc and clang to have the same missed optimization in cases like this; <strong>do <em>not</em> assume that something is illegal just because compilers don't do it.</strong>  The only useful data is when compilers <em>do</em> perform an optimization: it's either a compiler bug or at least some compiler devs decided it was safe according to their interpretation of whatever  standards.)</p>\n\n<hr>\n\n<p>We can see GCC is returning its own incoming arg instead of returning the copy of it that <code>create()</code> will return in RAX.  <strong><em>This</em> is the missed optimization that's blocking tailcall optimization.</strong></p>\n\n<p>The ABI requires a function with a MEMORY-type return value to return the \"hidden\" pointer in RAX<sup>1</sup>.</p>\n\n<p>GCC/clang do already realize they can elide actual copying by passing along their own return-value space, instead of allocating fresh space.  But to do tailcall optimization, they'd have to realize that they can leave their callee's RAX value in RAX, instead of saving their incoming RDI in a call-preserved register.</p>\n\n<p>If the ABI didn't require returning the hidden pointer in RAX, I expect gcc/clang would have had no problem with passing along the incoming RDI as part of an optimized tailcall.</p>\n\n<p>Generally compilers like to shorten dependency chains; that's probably what's going on here.  The compiler doesn't know that the latency from <code>rdi</code> arg to <code>rax</code> result of <code>create()</code> is probably just one <code>mov</code> instruction.  Ironically, this could be a pessimization if the callee saves/restores some call-preserved registers (like <code>r12</code>), introducing a store/reload of the return-address pointer.  (But that mostly only matters if anything even uses it.  I did get some clang code to do so, see below.)</p>\n\n<hr>\n\n<p>Footnote 1:   Returning the pointer sounds like a good idea, but almost invariably the caller already knows where it put the arg in its own stack frame and will just use an addressing mode like <code>8(%rsp)</code> instead of actually using RAX.  At least in compiler-generated code, the RAX return value will typically go unused.  (And if necessary, the caller can always save it somewhere themselves.)</p>\n\n<p>As discussed in <a href=\"https://stackoverflow.com/questions/57377314/what-prevents-the-usage-of-a-function-argument-as-hidden-pointer\">What prevents the usage of a function argument as hidden pointer?</a> there are serious obstacles to using anything other than space in the caller's stack frame to receive a retval.</p>\n\n<p>Having the pointer in a register just saves an LEA in the caller if the caller wants to store the address somewhere, if it is a static or stack address.</p>\n\n<p><strong>However, this case is close to one where it <em>would</em> be useful.</strong>  If we're passing along our own retval space to a child function, we might want to <em>modify</em> that space after the call.  Then it is useful for easy access to that space, e.g. to modify a return value before we return.</p>\n\n<pre><code>#define T struct Vec3\n\nT use2(){\n    T tmp = create();\n    tmp.y = 0.0;\n    return tmp;\n}\n</code></pre>\n\n<p>Efficient handwritten asm:</p>\n\n<pre><code>use2:\n        callq   create\n        movq    $0, 8(%rax)\n        retq\n</code></pre>\n\n<p>Actual clang asm at least still uses return-value optimization, vs. GCC9.1 copying.  (<a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:___c,source:&#39;struct+Vec2%7B%0A++++double+x,+y%3B%0A%7D%3B%0Astruct+Vec3%7B%0A++++double+x,+y,+z%3B%0A%7D%3B%0A%0A%0A%23define+T+struct+Vec3%0A%0AT+create(void)%3B+//%7B+return+(T)%7B0,0%7D%3B%7D%3B%0A%0AT+use()%7B%0A++++return+create()%3B%0A%7D%0A%0AT+use2()%7B%0A++++T+tmp+%3D+create()%3B%0A++++tmp.y+%3D+0.0%3B%0A++++return+tmp%3B%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C+source+%231&#39;,t:&#39;0&#39;)),k:27.770179658472408,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:cclang800,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),lang:___c,libs:!(),options:&#39;-O3&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+clang+8.0.0+(Editor+%231,+Compiler+%231)+C&#39;,t:&#39;0&#39;)),header:(),k:33.65143685137262,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:cg91,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;1&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),lang:___c,libs:!(),options:&#39;-O3&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+9.1+(Editor+%231,+Compiler+%232)+C&#39;,t:&#39;0&#39;)),k:38.578383490154984,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"noreferrer\"><strong>Godbolt</strong></a>)</p>\n\n<pre><code># clang -O3\nuse2:                                   # @use2\n        pushq   %rbx\n        movq    %rdi, %rbx\n        callq   create\n        movq    $0, 8(%rbx)\n        movq    %rbx, %rax\n        popq    %rbx\n        retq\n</code></pre>\n\n<p>This ABI rule perhaps exists specifically for this case, or maybe the ABI designers were picturing that the retval space might be newly-allocated dynamic storage (which the caller <em>would</em> have to save a pointer to if the ABI didn't provide it in RAX).  I didn't try that case.</p>\n"}], "owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 2, "accepted_answer_id": 57597039, "answer_count": 2, "score": 12, "last_activity_date": 1566419773, "creation_date": 1566405075, "last_edit_date": 1566405947, "question_id": 57595888, "link": "https://stackoverflow.com/questions/57595888/why-is-tailcall-optimization-not-performed-for-types-of-class-memory", "title": "Why is tailcall optimization not performed for types of class MEMORY?", "body": "<p>I'm trying to understand the implication of <a href=\"https://stackoverflow.com/q/18133812/5769463\">System V AMD64 - ABI</a> for returning by value from a function.</p>\n\n<p>For the following data type</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct Vec3{\n    double x, y, z;\n};\n</code></pre>\n\n<p>the type <code>Vec3</code> is of class MEMORY and thus the following is specified by the ABI concerning \"Returning of Values\":</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li><p>If the type has class MEMORY, then the caller provides space for the return value and passes the address of this storage in %rdi as if\n  it were the first argument to the function. In effect, this address\n  becomes a \u201chidden\u201d first argument. This storage must not overlap any\n  data visible to the callee through other names than this argument.</p>\n  \n  <p>On\n  return %rax will contain the address that has been passed in by the\n  caller in %rdi. </p></li>\n  </ol>\n</blockquote>\n\n<p>With this in mind, the following (silly) function:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct Vec3 create(void);\n\nstruct Vec3 use(){\n    return create();\n}\n</code></pre>\n\n<p>could be compiled as:</p>\n\n<pre><code>use_v2:\n        jmp     create\n</code></pre>\n\n<p>In my opinion, tailcall-optimization can be performed, as we are assured by the ABI, that <code>create</code> will place in <code>%rdi</code> passed value into <code>%rax</code> register.</p>\n\n<p>However, none of the compilers (gcc, clang, icc) seem to be performing this optimization (here <a href=\"https://godbolt.org/z/-fopZD\" rel=\"noreferrer\">on godbolt</a>). The resulting assembly code saves <code>%rdi</code> on stack only to be able move its value to <code>%rax</code>, for example gcc:</p>\n\n<pre><code>use:\n        pushq   %r12\n        movq    %rdi, %r12\n        call    create\n        movq    %r12, %rax\n        popq    %r12\n        ret\n</code></pre>\n\n<p>Neither for this minimal, silly function nor for more complicated ones from real life, tailcall-optimization is performed. Which leads me to believe, that I must be missing something, which prohibits it.</p>\n\n<hr>\n\n<p>Needless to say, for types of class SSE (e.g. only 2 and not 3 doubles), tailcall-optimization is performed (at least by gcc and clang, live <a href=\"https://godbolt.org/z/OgQ89m\" rel=\"noreferrer\">on godbolt</a>):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct Vec2{\n    double x, y;\n};\n\nstruct Vec2 create(void);\n\nstruct Vec2 use(){\n    return create();\n}\n</code></pre>\n\n<p>results in</p>\n\n<pre><code>use:\n        jmp     create\n</code></pre>\n"}, {"tags": ["c", "linker", "duplicate-symbol"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1566404760, "post_id": 57595736, "comment_id": 101648832, "body": "@VladfromMoscow It seems like OP isn&#39;t getting link-time errors, and is asking why that would happen."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 6, "last_activity_date": 1566405413, "last_edit_date": 1566405413, "creation_date": 1566404872, "answer_id": 57595846, "question_id": 57595736, "link": "https://stackoverflow.com/questions/57595736/why-is-my-code-not-throwing-a-duplicate-symbol-conflict/57595846#57595846", "title": "Why is my code not throwing a duplicate symbol conflict", "body": "<blockquote>\n  <p>Why is my following code not throwing duplicate symbol conflict?</p>\n</blockquote>\n\n<p>The linker looks for undefined symbols in the libraries in the order in which they are specified in the linker line. When it finds a symbol in a library, it uses that definition and stops. It does not check whether that symbol is defined in any of the other libraries specified in the linker line.</p>\n\n<p>In your case, if the linker finds a symbol in A.lib, it stops there. It does not look for the symbol in B.lib.</p>\n\n<p>With your commands, the linker will find function <code>printGood()</code> in object <code>perfect.o</code> in library <code>A</code>. It will not use the function of the same name in <code>good.o</code> from library <code>B</code>. So you effectively link <code>orchestrator.o</code>, <code>A.o</code>, <code>B.o</code> and <code>perfect.o</code>. That's why the executable program prints <code>I am perfect</code> twice and not <code>I am good</code>.</p>\n\n<p>Multiple definition errors are reported only when the object files used in the linker line contain multiple definitions.</p>\n\n<p>You will see the error if you use:</p>\n\n<pre><code>gcc -o orchestrator orchestrator.o a.o b.o perfect.o good.o\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 3879832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41bc32390b57329ef04619fbf6d4a5a0?s=128&d=identicon&r=PG&f=1", "display_name": "electronic_coder", "link": "https://stackoverflow.com/users/3879832/electronic-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 57595846, "answer_count": 1, "score": 2, "last_activity_date": 1566405413, "creation_date": 1566404439, "last_edit_date": 1566404685, "question_id": 57595736, "link": "https://stackoverflow.com/questions/57595736/why-is-my-code-not-throwing-a-duplicate-symbol-conflict", "title": "Why is my code not throwing a duplicate symbol conflict", "body": "<p>Why is my following code not throwing duplicate symbol conflict?</p>\n\n<p>I referred to name mangling, but that seems only when there is difference in parameters. But, here there is not difference in parameters. But, still it does not throw conflict. Why?</p>\n\n<p>good.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid printGood() {\n    printf(\"I am good\");\n}\n</code></pre>\n\n<p>perfect.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid printGood() {\n    printf(\"I am perfect\");\n}\n</code></pre>\n\n<p>A.c</p>\n\n<pre><code>extern void printGood();\n\nvoid bringGood() {\n    printGood();\n}\n</code></pre>\n\n<p>B.c</p>\n\n<pre><code>extern void printGood();\n\nvoid bringPerfect() {\n    printGood();\n}\n</code></pre>\n\n<p>orchestrator.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid bringGood();\nvoid bringPerfect();\n\nint main() {\n    printf(\"bringing good\");\n    bringGood();\n    printf(\"bringing perfect\");\n    bringPerfect();\n    return 1;\n}\n</code></pre>\n\n<p>compile line:</p>\n\n<pre><code>gcc -g -c good.c\ngcc -g -c perfect.c\n\ngcc -g -c A.c\ngcc -g -c B.c\n\ngcc -g -c orchestrator.c\n\nar rcs libA.a perfect.o A.o\nar rcs libB.a  good.o B.o\n\ngcc -o orchestrator orchestrator.o -L.  -lA -lB\n\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12087, "user_id": 1121249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LkDcL.png?s=128&g=1", "display_name": "rkosegi", "link": "https://stackoverflow.com/users/1121249/rkosegi"}, "edited": false, "score": 0, "creation_date": 1566404147, "post_id": 57595648, "comment_id": 101648537, "body": "And what architecture is this system running on?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1566404148, "post_id": 57595648, "comment_id": 101648538, "body": "That is not knowable from the memory availability alone. And SO is not a homework-doing service (no matter how poorly written said homework is)."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1566404236, "post_id": 57595648, "comment_id": 101648576, "body": "@underscore_d maybe the question should be &quot;What is the minimum size of a pointer...?&quot;"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1566404240, "post_id": 57595648, "comment_id": 101648579, "body": "The pointer will be 4 or 8 bytes. Which one do you think will be needed to address 2^38 locations?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1566404288, "post_id": 57595648, "comment_id": 101648605, "body": "Are we to infer that the title is the OP&#39;s guess as to the answer to the copy-pasted question, and they&#39;re asking for validation? Either way, it can&#39;t be answered."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566405355, "post_id": 57595648, "comment_id": 101649124, "body": "The program could use 32-bit pointers if the system has a paging mechanism."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 3, "creation_date": 1566405870, "post_id": 57595648, "comment_id": 101649341, "body": "The question was wrongly closed; it is not too broad and can be answered no regarding 4.75-byte pointers and answer with information about the rules of bytes, objects, and pointers in C."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1566407246, "post_id": 57595648, "comment_id": 101649857, "body": "I presume you obtained <code>4.75</code> from a calculation like <code>38 &#47; 8</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1566407261, "post_id": 57595648, "comment_id": 101649863, "body": "The question can be answered generally (possibly with a clarification question comment in preparation), with a code fragment which will answer it specifically and with a little detour to discuss the most probable misconceptions OP seems to have (little challenge in tact and diplomacy there...)."}, {"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "edited": false, "score": 0, "creation_date": 1566415680, "post_id": 57595648, "comment_id": 101653318, "body": "<a href=\"https://youtu.be/_7iXw9zZrLo?t=163\" rel=\"nofollow noreferrer\">African or European?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 3, "creation_date": 1566408480, "post_id": 57596320, "comment_id": 101650306, "body": "Real-world example - the Motorola 68000 was a 32-bit architecture, but only exposed 24 address lines from the chip to the memory bus.  So while pointer types were 4 bytes wide, the upper 8 bits were not used for storing address values.  You could (and some people did) pack other data into those unused bits.  When the &#39;020 came along, all 32 address lines were exposed to the memory bus."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 5, "last_activity_date": 1566407342, "creation_date": 1566407342, "answer_id": 57596320, "question_id": 57595648, "link": "https://stackoverflow.com/questions/57595648/can-a-pointer-size-be-4-75-bytes/57596320#57596320", "title": "Can a pointer size be 4.75 Bytes", "body": "<p>In C, a <em>byte</em> is a fundamental unit. The number of bits in a byte is defined by each individual C implementation. (Eight bits is very common these days but is not mandatory. It is the minimum.)</p>\n\n<p>Per C 2018 6.2.6.1 2, except for bit-fields, each object is composed of a one or more bytes. So a pointer must be a whole number of bytes in its C implementation, although it may be that some bits in the pointer are not used.</p>\n\n<p>The number of bytes a pointer uses is ultimately determined by the C implementation, not by the computer or system its programs run on. By and large, C is intended to be configured to fit a system \u201cnaturally,\u201d so pointers and other types tend to match what a machine is designed for. However, C implementations sometimes serve special purposes, such as supporting old source code or making only a subset of memory available in order to conserve resources. For example, on a machine with a 64-bit address space, we could choose to use a 32-bit C implementation because the amount of space consumed by 64-bit pointers is a significant cost for execution of certain programs.</p>\n\n<p>Thus, on a system with 2<sup>38</sup> bytes of memory, 38 bits would be necessary to to address each byte. This leads to several possibilities, including: </p>\n\n<ul>\n<li>The system has eight-bit bytes, and the C implementation uses five-byte (40-bit) pointers, in which 38 bits represent an address and the other two could be wasted or could be used for some error detection or other features.</li>\n<li>The system has eight-bit bytes, and there is some benefit to alignment, so the C implementation uses eight-byte pointers.</li>\n<li>The system has, hypothetically, 19-bit bytes, and the C implementation uses two of them for a pointer.</li>\n<li>The system has eight-bit bytes, and the C implementation uses four-byte pointers. Only 2<sup>32</sup> bytes are available in the address space of each C program, although different C programs may use different portions of the 2<sup>38</sup> bytes in memory.</li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 11958189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l8j6SlHd_vM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rftddHLmZqssBM9l8BeuXhU_BuMgA/photo.jpg?sz=128", "display_name": "sweety", "link": "https://stackoverflow.com/users/11958189/sweety"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "closed_date": 1566460755, "answer_count": 1, "score": -5, "last_activity_date": 1566407342, "creation_date": 1566404031, "question_id": 57595648, "link": "https://stackoverflow.com/questions/57595648/can-a-pointer-size-be-4-75-bytes", "closed_reason": "Needs more focus", "title": "Can a pointer size be 4.75 Bytes", "body": "<p>Consider a system with total memory available is 2^(38) bytes. A user write a C program on this system that uses the entire addressing space. What is the size of a pointer (in bytes) defined in this C program.</p>\n"}, {"tags": ["c", "visual-studio"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1566403116, "post_id": 57595385, "comment_id": 101648092, "body": "You need <code>scanf_s(&quot; %c&quot;, &amp;d, 1);</code> note the added space before <code>%c</code>. Please see <a href=\"https://stackoverflow.com/questions/5240789/scanf-leaves-the-new-line-char-in-the-buffer\">scanf() leaves the newline char in the buffer</a>. Aside: please get into the habit of placing the <code>\\n</code> newline at the <i>end</i> not the start."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566403155, "post_id": 57595385, "comment_id": 101648106, "body": "Try <code>scanf_s(&quot; %c&quot;, &amp;d,1);</code> instead. Note the extra leading space in the format. And if you print the decimal value of <code>d</code> together with the decimal value of <code>&#39;\\n&#39;</code> (or used a debugger to see the value of <code>d</code> directly) then you would hopefully understand what happens."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566403503, "post_id": 57595385, "comment_id": 101648281, "body": "Also, for <code>long double</code> the format should be <code>%Lf</code>. Your format <code>%lf</code> is for <code>double</code> . However, I believe Microsoft implements <code>long double</code> as <code>double</code> so in the example it &quot;works&quot;."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1566470238, "post_id": 57595385, "comment_id": 101670289, "body": "You would have got a clue had you put delimiters round your printf, which is always a good idea when debugging: printf(&quot;\\nThe char value is &lt;%c&gt;&quot;, d);"}], "owner": {"reputation": 15, "user_id": 10465448, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DXp5ZpNGPQc/AAAAAAAAAAI/AAAAAAAAABc/lM8aojEl9B0/photo.jpg?sz=128", "display_name": "Sourabh Chavan", "link": "https://stackoverflow.com/users/10465448/sourabh-chavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566402982, "creation_date": 1566402982, "question_id": 57595385, "link": "https://stackoverflow.com/questions/57595385/i-cannot-enter-and-display-char-datatype-in-visual-studio", "title": "I cannot enter and display char datatype in Visual Studio", "body": "<p>I am writing a program to enter and display datatypes in C language.\nI can enter and display int,float,long double,but cannot enter and display char.</p>\n\n<pre><code>int a;\nfloat b;\nlong double c;\nchar d;\n\nprintf(\"\\nEnter the integer value\");\nscanf_s(\"%d\", &amp;a);\nprintf(\"\\nThe integer value is %d\", a);\n\nprintf(\"\\nEnter the float value\");\nscanf_s(\"%f\", &amp;b);\nprintf(\"\\nThe float value is %f\", b);\n\nprintf(\"\\nEnter the long double value\");\nscanf_s(\"%lf\", &amp;c);\nprintf(\"\\nThe double value is %lf\", c);\n\nprintf(\"\\nEnter the char value\");\nscanf_s(\"%c\", &amp;d,1);\nprintf(\"\\nThe char value is %c\", d);\n</code></pre>\n"}, {"tags": ["c", "pointers", "casting", "char", "int"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1566401963, "post_id": 57595110, "comment_id": 101647522, "body": "Type casting can&#39;t cause segfault. Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1566402030, "post_id": 57595110, "comment_id": 101647554, "body": "When size of address is not the same as sizeof int, then there will be an error in run-time. And if you turn warnings of your compiler on, it will tell you."}, {"owner": {"reputation": 21, "user_id": 10591434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bq5u3FEbVi8/AAAAAAAAAAI/AAAAAAAAACk/UyIXi8NQr0I/photo.jpg?sz=128", "display_name": "Virchual Shado", "link": "https://stackoverflow.com/users/10591434/virchual-shado"}, "edited": false, "score": 0, "creation_date": 1566402222, "post_id": 57595110, "comment_id": 101647656, "body": "I have added source.. Please check again.. I&#39;m using sizeof.."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1566402418, "post_id": 57595110, "comment_id": 101647762, "body": "One obvious issue that can cause undefined behavior is that you are using <code>%p</code> to print an integer. The other is that your pointer size might be larger than can fit into <code>unsigned int</code>."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1566402588, "post_id": 57595110, "comment_id": 101647852, "body": "Probably a pointer is too big for an <code>unsigned int</code>. You can try <code>unsigned long</code> instead of <code>unsigned int</code>. Add output like this <code>printf(&quot;size of char* %d unsigned int %d unsigned long %d\\n&quot;, sizeof(char*), sizeof(unsigned int), sizeof(unsigned long));</code> to see if the size is the problem."}, {"owner": {"reputation": 21, "user_id": 10591434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bq5u3FEbVi8/AAAAAAAAAAI/AAAAAAAAACk/UyIXi8NQr0I/photo.jpg?sz=128", "display_name": "Virchual Shado", "link": "https://stackoverflow.com/users/10591434/virchual-shado"}, "edited": false, "score": 0, "creation_date": 1566402664, "post_id": 57595110, "comment_id": 101647885, "body": "But the code works when i remove typecasting part from printf() statement.. It prints the addresses using %p but when i try to print the char value using %c it causes segmentation fault. Thanks for quick reply."}, {"owner": {"reputation": 21, "user_id": 10591434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bq5u3FEbVi8/AAAAAAAAAAI/AAAAAAAAACk/UyIXi8NQr0I/photo.jpg?sz=128", "display_name": "Virchual Shado", "link": "https://stackoverflow.com/users/10591434/virchual-shado"}, "edited": false, "score": 0, "creation_date": 1566402874, "post_id": 57595110, "comment_id": 101647975, "body": "Here is the output of          printf(&quot;size of char* %d unsigned int %d unsigned long %d\\n&quot;, sizeof(char*), sizeof(unsigned int), sizeof(unsigned long));            size of char* 8 unsigned int 4 unsigned long 8"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566403089, "post_id": 57595110, "comment_id": 101648076, "body": "Why are you trying to store pointer values in unsigned integer variables?  Why not store pointer values in <i>pointer</i> variables?  You&#39;re bound to have less trouble..."}, {"owner": {"reputation": 21, "user_id": 10591434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bq5u3FEbVi8/AAAAAAAAAAI/AAAAAAAAACk/UyIXi8NQr0I/photo.jpg?sz=128", "display_name": "Virchual Shado", "link": "https://stackoverflow.com/users/10591434/virchual-shado"}, "edited": false, "score": 0, "creation_date": 1566403142, "post_id": 57595110, "comment_id": 101648101, "body": "Sorry guys I got it.. The problem was size of unsigned int. Thanks for your precious feedback.. thank you all guys.."}, {"owner": {"reputation": 21, "user_id": 10591434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bq5u3FEbVi8/AAAAAAAAAAI/AAAAAAAAACk/UyIXi8NQr0I/photo.jpg?sz=128", "display_name": "Virchual Shado", "link": "https://stackoverflow.com/users/10591434/virchual-shado"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566403224, "post_id": 57595110, "comment_id": 101648141, "body": "@SteveSummit It;s a kinda assignment for me But i solved it thanks.."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10591434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bq5u3FEbVi8/AAAAAAAAAAI/AAAAAAAAACk/UyIXi8NQr0I/photo.jpg?sz=128", "display_name": "Virchual Shado", "link": "https://stackoverflow.com/users/10591434/virchual-shado"}, "edited": false, "score": 0, "creation_date": 1566403358, "post_id": 57595289, "comment_id": 101648208, "body": "Thanks for your great suggestion.. I got it already it worked with unsigned long int."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1566402730, "last_edit_date": 1566402730, "creation_date": 1566402585, "answer_id": 57595289, "question_id": 57595110, "link": "https://stackoverflow.com/questions/57595110/segmentation-fault-in-typecasting-from-unsigned-int-to-char-pointer/57595289#57595289", "title": "Segmentation Fault in typecasting from unsigned int to char pointer", "body": "<p>What you are trying to do is the following</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint main()\n{\n    char char_arr[4] = {'a', 'b', 'c', 'd'};\n    int i;\n\n    uintptr_t hackyPointer;\n    hackyPointer = (uintptr_t) char_arr;\n\n        for (i = 0; i &lt; 4; i++)\n        {\n            printf(\"[hacky Pointer] now points to %p which contains value %c\\n\",( void * )hackyPointer, *((char *) hackyPointer));\n            hackyPointer += sizeof(char);\n        }\n}        \n</code></pre>\n\n<p>The program output is</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[hacky Pointer] now points to 0x7ffff86d4224 which contains value a\n[hacky Pointer] now points to 0x7ffff86d4225 which contains value b\n[hacky Pointer] now points to 0x7ffff86d4226 which contains value c\n[hacky Pointer] now points to 0x7ffff86d4227 which contains value d\n</code></pre>\n\n<p>You have to use an integer type that is able to contain values of pointers. </p>\n"}, {"tags": [], "owner": {"reputation": 110, "user_id": 10696143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rAhKx.jpg?s=128&g=1", "display_name": "winidis", "link": "https://stackoverflow.com/users/10696143/winidis"}, "is_accepted": false, "score": 2, "last_activity_date": 1566404189, "creation_date": 1566404189, "answer_id": 57595695, "question_id": 57595110, "link": "https://stackoverflow.com/questions/57595110/segmentation-fault-in-typecasting-from-unsigned-int-to-char-pointer/57595695#57595695", "title": "Segmentation Fault in typecasting from unsigned int to char pointer", "body": "<p>The problem is that you are trying to fit a bigger number than <code>int</code> can store, that is if you are running <code>x64</code>.</p>\n\n<p>In 64 bit systems, pointers have a size of 8 bytes and <code>int</code> is usually 4 bytes. Pointer addresses work like numbers so when you cast the pointer to <code>int</code>, the address will be truncated.</p>\n\n<p>Casting the <code>int</code> back to a pointer it will now contain some other address that does not belong to your program which can result in a access violation, or in other words, a segmentation fault.</p>\n\n<p>Use a bigger <code>int</code> to hold the address, cast it to an <code>int</code> pointer or use <code>uintptr_t</code> type which is guaranteed to be big enough to hold the address.</p>\n"}], "owner": {"reputation": 21, "user_id": 10591434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bq5u3FEbVi8/AAAAAAAAAAI/AAAAAAAAACk/UyIXi8NQr0I/photo.jpg?sz=128", "display_name": "Virchual Shado", "link": "https://stackoverflow.com/users/10591434/virchual-shado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 57595289, "answer_count": 2, "score": 0, "last_activity_date": 1566404189, "creation_date": 1566401910, "last_edit_date": 1566403520, "question_id": 57595110, "link": "https://stackoverflow.com/questions/57595110/segmentation-fault-in-typecasting-from-unsigned-int-to-char-pointer", "title": "Segmentation Fault in typecasting from unsigned int to char pointer", "body": "<p>I'm new to c. Just learning.\nWhat i am trying to do is initialize a variable type of unsigned int and then store address of an char type array in it and after that I am trying to use int as a pointer and print the array using the unsigned int but I'am getting segmentation fault, I don't know why? \nIt's printing value of memory address of char type array. But not the actual values at memory addresses.\nCan someone please help?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    char char_arr[4] = {'a', 'b', 'c', 'd'};\n    int i;\n\n    unsigned int hackyPointer;\n    hackyPointer = (unsigned int) char_arr;\n\n        for (i = 0; i &lt; 4; i++)\n        {\n            printf(\"[hacky Pointer] now points to %p which contains value %c\\n\",hackyPointer, *((char *) hackyPointer));\n            hackyPointer += sizeof(char);\n        }\n\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "casting", "compiler-warnings"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1566401759, "post_id": 57595041, "comment_id": 101647422, "body": "<code>Thing* thing_ptr = (Thing*) buffer[0];</code> -&gt; <code>Thing* thing_ptr = (Thing*) &amp;buffer[0];</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566401851, "post_id": 57595041, "comment_id": 101647461, "body": "... because <code>buffer[0]</code> is of type <code>uint8_t</code> so that won&#39;t make a valid pointer."}], "answers": [{"tags": [], "owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "is_accepted": true, "score": 2, "last_activity_date": 1566402689, "last_edit_date": 1566402689, "creation_date": 1566401920, "answer_id": 57595114, "question_id": 57595041, "link": "https://stackoverflow.com/questions/57595041/reading-a-struct-from-a-memory-buffer-raises-a-compiler-error-and-segfault/57595114#57595114", "title": "Reading a struct from a memory buffer raises a compiler error and segfault", "body": "<p>The line</p>\n\n<pre><code>Thing* thing_ptr = (Thing*) buffer[0];\n</code></pre>\n\n<p>is incorrect.</p>\n\n<p>The variable <code>buffer</code> is a <code>uint8_t *</code>, so <code>buffer[0]</code> is a <code>uint8_t</code>. In this case, <code>buffer[0]</code> is equivalent to <code>*buffer</code>.</p>\n\n<p>There are two options:</p>\n\n<p>You can take the address of <code>buffer[0]</code>:</p>\n\n<pre><code>Thing* thing_ptr = (Thing*) &amp;buffer[0];\n</code></pre>\n\n<p>In this case, this doesn't make much sense, though it can clarify intent in some other situations.</p>\n\n<p>In my opinion, the better option is to drop the <code>[0]</code>:</p>\n\n<pre><code>Thing* thing_ptr = (Thing*) buffer;\n</code></pre>\n\n<p>This clearly shows that you're casting the value in <code>buffer</code> from the type <code>uint8_t *</code> to a <code>Thing *</code>.</p>\n\n<hr>\n\n<p>The <code>[-Wint-to-pointer-cast]</code> warning indicates that you're casting to a pointer from an integer type that is a different size. This type of cast usually doesn't make sense to do.</p>\n\n<p>One of the reasons such a warning would exist is to prevent issues like the one you're experiencing.</p>\n\n<hr>\n\n<p>Your version causes a segfault because you interpret the <code>uint8_t</code> value <code>buffer[0]</code> (likely either <code>0</code> or <code>80</code>, depending on endianness) as a pointer. This is likely to be an invalid pointer on personal computers, and dereferencing it causes a segfault on your platform.</p>\n"}], "owner": {"reputation": 11251, "user_id": 3284878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d324c610856d2626e9b719eb4135b3cb?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv Cohn", "link": "https://stackoverflow.com/users/3284878/aviv-cohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 57595114, "answer_count": 1, "score": 0, "last_activity_date": 1566402689, "creation_date": 1566401675, "question_id": 57595041, "link": "https://stackoverflow.com/questions/57595041/reading-a-struct-from-a-memory-buffer-raises-a-compiler-error-and-segfault", "title": "Reading a struct from a memory buffer raises a compiler error and segfault", "body": "<p>In the following piece of code, I attempt to store a <code>struct</code> inside a raw memory buffer.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct {\n  int a;\n} Thing;\n\nint main(void) {\n  uint8_t* buffer = malloc(sizeof(Thing) * 200);\n\n  Thing thing;\n  thing.a = 80;\n\n  memcpy(buffer, &amp;thing, sizeof(Thing));\n\n  Thing* thing_ptr = (Thing*) buffer[0];\n\n  return 0;\n}\n</code></pre>\n\n<p>However, I get the following compiler warning:</p>\n\n<pre><code>warning: cast to 'Thing *' from smaller integer type\n      'uint8_t' (aka 'unsigned char') [-Wint-to-pointer-cast]\n      Thing* thing_ptr = (Thing*) buffer[0]\n</code></pre>\n\n<p>Also, when I try to dereference <code>thing_ptr</code> at the end:</p>\n\n<pre><code>printf(\"%d\\n\", thing_ptr-&gt;a);\n</code></pre>\n\n<p>I get a <code>segmentation fault</code>.</p>\n\n<p>Two questions:</p>\n\n<p>A. What's wrong with <code>Thing* thing_ptr = (Thing*) buffer[0];</code>? Why is it raising an error?</p>\n\n<p>B. What is the reason for the segfault?</p>\n"}, {"tags": ["c", "pointers", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 1, "creation_date": 1566400524, "post_id": 57594627, "comment_id": 101646758, "body": "See the picture on top of <a href=\"https://en.wikipedia.org/wiki/Linked_list\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Linked_list</a>. At that point <code>head</code> would point to the first cell. Notice that the pointers are not to the data, but to the whole two-blocks cells. And of course every element in a list is its own instance of <code>Node</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1566400686, "post_id": 57594627, "comment_id": 101646846, "body": "Please don&#39;t describe your code, but show a small example instead. You can <a href=\"https://stackoverflow.com/posts/57594627/edit\">edit</a> your question."}, {"owner": {"reputation": 154, "user_id": 11347273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecdde797e6c55c0bca2faf59d6b4eae6?s=128&d=identicon&r=PG&f=1", "display_name": "bobthebuilder", "link": "https://stackoverflow.com/users/11347273/bobthebuilder"}, "edited": false, "score": 0, "creation_date": 1566400739, "post_id": 57594627, "comment_id": 101646876, "body": "I was trying to explain how much i understood, so that we could start from somewhere"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1566400808, "post_id": 57594627, "comment_id": 101646914, "body": "Google &quot;linked list tutorial&quot;, you should find something useful"}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1566400911, "creation_date": 1566400911, "answer_id": 57594831, "question_id": 57594627, "link": "https://stackoverflow.com/questions/57594627/pointers-in-structure-pointing-to-another-strucutre/57594831#57594831", "title": "Pointers in Structure pointing to another strucutre", "body": "<blockquote>\n  <p>\u2026 a pointer of a type struct\u2026</p>\n</blockquote>\n\n<p>A pointer cannot be <strong>of</strong> a type struct. A pointer can point <strong>to</strong> a structure.</p>\n\n<p>C has objects. Objects include <code>char</code>, <code>int</code>, <code>double</code>, structures, and other things. A structure is a collection of objects grouped together.</p>\n\n<p>In main, if you define <code>p</code> with <code>Node *p;</code>, you then have a pointer <code>p</code>. It has no value because you have not given it a value. When you execute <code>p = malloc(sizeof *p);</code>, you request enough memory for the size of the thing <code>p</code> points to (<code>*p</code>). If <code>malloc</code> returns a non-null pointer, then <code>p</code> points to a <code>Node</code> structure.</p>\n\n<p>Then <code>p-&gt;data</code> refers to the <code>data</code> member of that structure. <code>p-&gt;data</code> is shorthand for <code>(*p).data</code>, in which <code>*p</code> means \u201cthe object <code>p</code> points to\u201d and <code>.data</code> means \u201cthe <code>data</code> member in that object.\u201d</p>\n\n<p>After <code>p = malloc(sizeof *p);</code> and <code>p-&gt;data = 5;</code>, <code>p-&gt;link</code> does not point to anything because you have not assigned it a value. In a linked list, you would use <code>malloc</code> to get memory for another <code>Node</code>, and then you would set the <code>p-&gt;link</code> in one <code>Node</code> to point to the new <code>Node</code>. In each <code>Node</code>, its <code>link</code> member points to the next <code>Node</code> in the list. Except, in the last <code>Node</code>, <code>p-&gt;link</code> is set to a null pointer to indicate it is the last <code>Node</code>.</p>\n\n<p>In <code>List</code>, you would set <code>head</code> to point to the first <code>Node</code> in a list of <code>Node</code> objects.</p>\n"}, {"comments": [{"owner": {"reputation": 154, "user_id": 11347273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecdde797e6c55c0bca2faf59d6b4eae6?s=128&d=identicon&r=PG&f=1", "display_name": "bobthebuilder", "link": "https://stackoverflow.com/users/11347273/bobthebuilder"}, "edited": false, "score": 0, "creation_date": 1566401729, "post_id": 57594969, "comment_id": 101647404, "body": "what happens if you have a pointer to the structure List, memory allocated and all? Where does it point to then (according to the diagrams, which did help by the way)"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 154, "user_id": 11347273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecdde797e6c55c0bca2faf59d6b4eae6?s=128&d=identicon&r=PG&f=1", "display_name": "bobthebuilder", "link": "https://stackoverflow.com/users/11347273/bobthebuilder"}, "edited": false, "score": 0, "creation_date": 1566401981, "post_id": 57594969, "comment_id": 101647532, "body": "@bobthebuilder <code>List</code> is a type. You cannot have a pointer to a type (but you can have a &quot;pointer to type&quot; type), but you can have a pointer to an object of a type."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566402055, "post_id": 57594969, "comment_id": 101647564, "body": "Of course the <code>link</code>s and <code>head</code> won&#39;t point anywhere valid until you assign or initialize them."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 3, "last_activity_date": 1566512546, "last_edit_date": 1566512546, "creation_date": 1566401418, "answer_id": 57594969, "question_id": 57594627, "link": "https://stackoverflow.com/questions/57594627/pointers-in-structure-pointing-to-another-strucutre/57594969#57594969", "title": "Pointers in Structure pointing to another strucutre", "body": "<blockquote>\n  <p>Where exactly does link point to?</p>\n</blockquote>\n\n<p><code>link</code> points to another object of the same type:</p>\n\n<pre><code>+------+------+     +------+------+     +------+------+\n| data | link |----&gt;| data | link |----&gt;| data | link | ----&gt; ...\n+------+------+     +------+------+     +------+------+\n</code></pre>\n\n<blockquote>\n  <p>Now in the structure List, what is head doing? What is it pointing to? </p>\n</blockquote>\n\n<p><code>head</code> points to the <em>first</em> node in a list:</p>\n\n<pre><code>+-----------------+     +------+------+     +------+------+ \n| head            |----&gt;| data | link |----&gt;| data | link |----&gt; ...\n+-----------------+     +------+------+     +------+------+\n| number_of_nodes |\n+-----------------+\n</code></pre>\n\n<blockquote>\n  <p>I am really trying my level best to understand how linked lists work,</p>\n</blockquote>\n\n<p>Don't feel bad - linked lists threw me for a loop in my Data Structures class (my first \"hard\" CS class).  It took me a solid week longer than my classmates to grok the concept.  Hopefully the pictures help.</p>\n\n<p><strong>Edit</strong></p>\n\n<blockquote>\n  <p>what happens if you have a pointer to the structure List, memory allocated and all? Where does it point to then (according to the diagrams, which did help by the way)</p>\n</blockquote>\n\n<p>So, let's assume you have the following code:</p>\n\n<pre><code>/**\n * Create a new list object.  head is initially NULL,\n * number_of_nodes initially 0.\n */\nList *newList( void )\n{\n  List *l = malloc( sizeof *l );\n  if ( l )\n  {\n    l-&gt;head = NULL;\n    l-&gt;number_of_nodes = 0;\n  }\n  return l;\n}\n\nint main( void )\n{\n  List *l = newList();\n  ...\n}\n</code></pre>\n\n<p>Then your picture looks like this:</p>\n\n<pre><code>+---------+       +--------------------+\n| l: addr | ----&gt; | head: NULL         |\n+---------+       +--------------------+\n                  | number_of_nodes: 0 |\n                  +--------------------+\n</code></pre>\n\n<p>(<code>addr</code> represents some arbitrary memory address)</p>\n\n<p>Now let's say you add a node to your list:</p>\n\n<pre><code>/**\n * Create a new node object, using the input data\n * link is initially NULL\n */\nNode *newNode( int data )\n{\n  Node *n = malloc( sizeof *n );\n  if ( n )\n  {\n    n-&gt;data = data;\n    n-&gt;link = NULL;\n  }\n  return n;\n}\n\nvoid insertNode( List *l, int data )\n{\n  Node *n = newNode( data );\n  if ( n )\n  {\n    /**\n     * If list is initially empty, make this new node the head\n     * of the list.  Otherwise, add the new node to the end of the\n     * list.\n     */\n    if ( !l-&gt;head ) // or n-&gt;head == NULL\n    {\n      l-&gt;head = n;\n    }\n    else\n    {\n      /**\n       * cur initially points to the first element in the list.  \n       * While the current element has a non-NULL link, follow\n       * that link.\n       */\n      for ( Node *cur = l-&gt;head; cur-&gt;link != NULL; cur = cur-&gt;link )\n        ; // empty loop body\n      cur-&gt;link = n;\n    }\n    l-&gt;number_of_nodes++;\n  }\n}\n\nint main( void )\n{\n  List *l = newList();\n  insertNode( l, 5 );\n  ...\n}\n</code></pre>\n\n<p>Now your picture looks like this:</p>\n\n<pre><code>+---------+       +--------------------+      +------------+\n| l: addr | ----&gt; | head: addr         | ---&gt; | data: 5    |\n+---------+       +--------------------+      +------------+\n                  | number_of_nodes: 1 |      | link: NULL |\n                  +--------------------+      +------------+\n</code></pre>\n\n<p>You could add another node:</p>\n\n<pre><code>int main( void )\n{\n  List *l = newList();\n  insertNode( l, 5 );\n  insertNode( l, 3 );\n  ...\n}\n</code></pre>\n\n<p>then your picture becomes</p>\n\n<pre><code>+---------+       +--------------------+      +------------+        +------------+\n| l: addr | ----&gt; | head: addr         | ---&gt; | data: 5    |   +--&gt; | data: 3    |\n+---------+       +--------------------+      +------------+   |    +------------+\n                  | number_of_nodes: 2 |      | link: addr | --+    | link: NULL |\n                  +--------------------+      +------------+        +------------+\n</code></pre>\n\n<p>Naturally, you'd want to add some error checking and messages in case a node couldn't be allocated (it happens).  And you'd probably want an ordered list, where elements are inserted in order (ascending, descending, whatever).  But this should give you a flavor of how to build lists.  </p>\n\n<p>You'd also need functions to remove items and free that memory.  Here's how I'd free an entire list:</p>\n\n<pre><code>void freeList( List *l )\n{\n  Node *prev, *cur = l-&gt;head;\n  while( cur &amp;&amp; cur-&gt;link )\n  {\n    prev = cur;\n    cur = cur-&gt;link;\n    free( prev );\n  }\n  free( cur );\n}\n\nint main( void )\n{\n  List *l = newList();\n  ...\n  freeList( l );\n  free( l );\n  ...\n}\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 11347273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecdde797e6c55c0bca2faf59d6b4eae6?s=128&d=identicon&r=PG&f=1", "display_name": "bobthebuilder", "link": "https://stackoverflow.com/users/11347273/bobthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 57594969, "answer_count": 2, "score": -3, "last_activity_date": 1566512546, "creation_date": 1566400309, "last_edit_date": 1566400445, "question_id": 57594627, "link": "https://stackoverflow.com/questions/57594627/pointers-in-structure-pointing-to-another-strucutre", "title": "Pointers in Structure pointing to another strucutre", "body": "<p>I am trying to understand how pointers in linked lists work. So far i am having lots of trouble trying to figure out where the pointer is pointing to and how a pointer of a type struct works( I know we need to allocate memory from the heap but can't quite understand it, but maybe that's a different question altogether). </p>\n\n<p>Lets take this structure:</p>\n\n<pre><code>typedef struct Node {\n    int data;\n    struct Node *link;\n} Node;\n</code></pre>\n\n<p>What I think will happen now is:</p>\n\n<ol>\n<li><p>Say you have a pointer of type Node in the main function, <code>Node* p</code> and this is allocated memory (using malloc).</p></li>\n<li><p>Now if we have some data <code>p-&gt;data=5;</code> , p points to the beginning of this data (at least this is what i think is happening).</p></li>\n</ol>\n\n<p>Where exactly does <code>link</code> point to?</p>\n\n<p>So now, i come across this particular piece of code:</p>\n\n<pre><code>typedef struct Node {\n    int data;\n    struct Node *link;\n} Node;\n\ntypedef struct List {\n    Node* head;\n    int number_of_nodes;\n} List;\n</code></pre>\n\n<p>So this is complete chaos in my brain! . </p>\n\n<p>Now in the structure <code>List</code>, what is <code>head</code> doing? What is it pointing to? And how would you create a linked list at all with these two lists??</p>\n\n<p>I am really trying my level best to understand how linked lists work, but all the pointers make it too hard to keep track of. You might suggest i start with something simple and i did, and i have already mentioned how much i understand. But the <code>head</code> pointer in the second structure has completely thrown me off track! </p>\n\n<p>It would make my life so much more easier if someone could help me explain it while keeping track of the pointers.</p>\n"}, {"tags": ["c", "bit-manipulation", "64-bit", "implicit-conversion", "bitmask"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1566398454, "post_id": 57593932, "comment_id": 101645569, "body": "<i>My concern is that the compiler may treat 0xFFFFFFFF as integer value of -1</i> , why would the compiler do that?"}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1566398570, "post_id": 57593932, "comment_id": 101645635, "body": "@DavidRanieri Because constant numbers by default have type of <code>int</code> and in 2th complementary, 0xFFFFFFFF is -1 (for <code>int</code>s)"}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1566398586, "post_id": 57593932, "comment_id": 101645649, "body": "@DavidRanieri because technically all integer constants are signed (with caveats) unless suffixed with a <code>u</code>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1566398789, "post_id": 57593932, "comment_id": 101645766, "body": "@Mgetz Not true.  All <i>decimal</i> integer constants are signed unless otherwise specified with a suffix, but <i>octal</i> or <i>hexadecimal</i> constants can be unsigned.  In this particular case, it would be unsigned, as per the C standard included in Vlad&#39;s answer."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566399211, "post_id": 57593932, "comment_id": 101645997, "body": "Technically, there is no such thing as a negative integer constant."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1566399466, "post_id": 57593932, "comment_id": 101646143, "body": "@ChristianGibbons those are the caveats, but that&#39;s implementation dependent and not guaranteed in all cases. However the core of it is that in almost all cases it&#39;s not worth worrying about because of how all integer constants, even decimals, are positive by default and negation is applied afterwards."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566399802, "post_id": 57593932, "comment_id": 101646320, "body": "Just cast it to <code>unsigned</code> if you&#39;re worried about it."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1566400607, "post_id": 57593932, "comment_id": 101646802, "body": "@Mgetz The issue I have is that this question is specifically about hexadecimal representation, so sweeping that under the rug as a &quot;caveat&quot; isn&#39;t very helpful and potentially misleading as it pertains to this question.  I will agree, though, that the specific type isn&#39;t as important to the OP&#39;s issue so much as the fact that integer constants are always positive."}], "answers": [{"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1566399046, "post_id": 57594141, "comment_id": 101645888, "body": "It could have type <code>int</code> if <code>int</code> is more than 32 bits wide."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566399510, "post_id": 57594141, "comment_id": 101646169, "body": "@IanAbbott The size of int can not be greater than the size of unsigned int.:)"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566399774, "post_id": 57594141, "comment_id": 101646306, "body": "True, but who says size 4 means 32 bits?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566399977, "post_id": 57594141, "comment_id": 101646429, "body": "@IanAbbott We do not deep into details about that some implementations can have padding bits.:)"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566400186, "post_id": 57594141, "comment_id": 101646568, "body": "I wasn&#39;t referring to the padding bits. :) E.g. you could have a 9-bit <code>char</code> and a 36-bit <code>int</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566400941, "post_id": 57594141, "comment_id": 101646983, "body": "Hmm, I want to agree with @IanAbbott, who is technically correct (best kind of correct) that if CHAR_BIT is not 8, then it could still be an <code>int</code>, even if <code>unsigned int</code> has sizeof 4.  But on the other hand, if <code>CHAR_BIT</code> is 9, then you wouldn&#39;t have <code>uint64_t</code> available, which is the type of <code>g_global_var</code>, therefore it can be surmised that <code>CHAR_BIT</code> is not, in fact, 9."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1566401133, "post_id": 57594141, "comment_id": 101647084, "body": "@ChristianGibbons That&#39;s a good point, but my point would still apply if <code>CHAR_BIT</code> is 16 and <code>unsigned int</code> is 64 bits wide."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566401831, "post_id": 57594141, "comment_id": 101647453, "body": "@IanAbbott Agreed.  That is why I restricted my comment to the example of <code>CHAR_BIT</code> being 9 rather than specifying that <code>CHAR_BIT</code> must therefore be 8 making it a non-factor."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1566402242, "post_id": 57594141, "comment_id": 101647672, "body": "@ChristianGibbons Understood. :)"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 8, "last_activity_date": 1566404843, "last_edit_date": 1566404843, "creation_date": 1566398594, "answer_id": 57594141, "question_id": 57593932, "link": "https://stackoverflow.com/questions/57593932/safe-low-32-bits-masking-of-uint64-t/57594141#57594141", "title": "Safe low 32 bits masking of uint64_t", "body": "<p>There is no problem. The integer constant <code>0xFFFFFFFF</code> has the type that is able to store the value as is.</p>\n\n<p>According to the C Standard (6.4.4.1 Integer constants)</p>\n\n<blockquote>\n  <p>5 The type of an integer constant is the first of the corresponding\n  list in which its value can be represented</p>\n</blockquote>\n\n<p>So this value is stored as a positive value.</p>\n\n<p>If the type <code>unsigned int</code> is a 32-bit integer type then the constant will have the type <code>unsigned int</code>.</p>\n\n<p>Otherwise it will have one of the types that can store the value.</p>\n\n<pre><code>long int\nunsigned long int\nlong long int\nunsigned long long int \n</code></pre>\n\n<p>Due to the usual arithmetic conversions in the expression</p>\n\n<pre><code>g_global_var &amp; 0xFFFFFFFF;\n</code></pre>\n\n<p>it is promoted like</p>\n\n<pre><code>0x00000000FFFFFFFF\n</code></pre>\n\n<p>Pay attention to that in C there is no negative integer constants. For example an expression like</p>\n\n<pre><code>-10\n</code></pre>\n\n<p>consists of two sub-expressions: the primary expression <code>10</code> and the sub-expression with the unary operator <code>-</code> <code>-19</code> that coincides with the full expression.</p>\n"}, {"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 3, "last_activity_date": 1566398604, "creation_date": 1566398604, "answer_id": 57594144, "question_id": 57593932, "link": "https://stackoverflow.com/questions/57593932/safe-low-32-bits-masking-of-uint64-t/57594144#57594144", "title": "Safe low 32 bits masking of uint64_t", "body": "<p>0xffffffff is not -1, ever. It may convert to -1 if you cast or coerce (e.g. by assignment) it to a signed 32-bit type, but integer literals in C always have their mathematical value unless they overflow.</p>\n\n<p>For decimal literals, the type is the narrowest signed type that can represent the value. For hex literals, unsigned types are used before going up to the next wider signed type. So, in the common case where <code>int</code> is 32-bit, 0xffffffff would have type <code>unsigned int</code>. If you wrote it as decimal, it would have type <code>long</code> (if <code>long</code> is 64-bit) or <code>long long</code> (if <code>long</code> is only 32-bit).</p>\n"}, {"tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": false, "score": 1, "last_activity_date": 1566404438, "last_edit_date": 1566404438, "creation_date": 1566398756, "answer_id": 57594181, "question_id": 57593932, "link": "https://stackoverflow.com/questions/57593932/safe-low-32-bits-masking-of-uint64-t/57594181#57594181", "title": "Safe low 32 bits masking of uint64_t", "body": "<p>The type of an unsuffixed hexadecimal or octal constant is the first of the following list in which its value can be represented:</p>\n\n<pre><code>int\nunsigned int\nlong int\nunsigned long int\nlong long int\nunsigned long long int\n</code></pre>\n\n<p>(For unsuffixed decimal constants, remove the <code>unsigned</code> types from the above list.)</p>\n\n<p>The hexadecimal constant <code>0xFFFFFFFF</code> can definitely be represented by <code>unsigned long int</code>, so its type will be the first of <code>int</code>, <code>unsigned int</code>, <code>long int</code> or <code>unsigned long int</code> that can represent its value.</p>\n\n<p>Note that although <code>0xFFFFFFFF &gt; 0</code> always evaluates to 1 (true), it is possible for <code>0xFFFFFFFF &gt; -1</code> to evaluate to either 0 (false) or 1 (true) on different implementations. So you need to be careful when comparing integer constants with each other or with other objects of integer type.</p>\n"}, {"tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 0, "last_activity_date": 1566399770, "creation_date": 1566399770, "answer_id": 57594464, "question_id": 57593932, "link": "https://stackoverflow.com/questions/57593932/safe-low-32-bits-masking-of-uint64-t/57594464#57594464", "title": "Safe low 32 bits masking of uint64_t", "body": "<p>Others have answered the question, just a recomendation, next time (if you are under C11) you can check the type of the expression by yourself using <code>_Generic</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n#define print_type(x) _Generic((x), \\\n    int64_t:  puts(\"int64_t\"),      \\\n    uint64_t: puts(\"uint64_t\"),     \\\n    default:  puts(\"unknown\")       \\\n)\n\nuint64_t g_global_var;\n\nint main(void)\n{\n    print_type(g_global_var &amp; 0xFFFFFFFF);\n    return 0;\n}\n</code></pre>\n\n<p>The ouput is</p>\n\n<pre><code>uint64_t\n</code></pre>\n"}], "owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 57594141, "answer_count": 4, "score": 3, "last_activity_date": 1566404843, "creation_date": 1566397870, "last_edit_date": 1566399176, "question_id": 57593932, "link": "https://stackoverflow.com/questions/57593932/safe-low-32-bits-masking-of-uint64-t", "title": "Safe low 32 bits masking of uint64_t", "body": "<p>Assume the following code:</p>\n\n<pre><code>uint64_t g_global_var;\n\n....\n....\n\nvoid foo(void)\n{\n    uint64_t local_32bit_low = g_global_var &amp; 0xFFFFFFFF;\n    ....\n}\n</code></pre>\n\n<p>With the current toolchain, this code works as expected, <code>local_32bit_low</code> indeed contains the low 32 bits of <code>g_global_var</code>.</p>\n\n<p>I wonder if it is guaranteed by the standard C that this code will always work as expected?\nMy concern is that the compiler may treat 0xFFFFFFFF as integer value of -1 and when promoting to <code>uint64_t</code> it would become 0xFFFFFFFFFFFFFFFF.</p>\n\n<p><strong>P.S.</strong></p>\n\n<p>I know that to be on the safe side it is better to use 0xFFFFFFFFULL in this case. The point is that I saw it in a legacy code and I wonder if it worth to be fixed or not.</p>\n"}, {"tags": ["c", "xc8"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1566396890, "post_id": 57593623, "comment_id": 101644849, "body": "What is <code>typedef uint8_t ButtonFunc(MenuStr *);</code> supposed to be?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1566397054, "post_id": 57593623, "comment_id": 101644959, "body": "What&#39;s the exact compiler error message? Can&#39;t reproduce, your code compiles cleanly on all mainstream compilers."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1566397089, "post_id": 57593623, "comment_id": 101644979, "body": "@AndrewHenle It&#39;s a typedef of a function pointer, which doesn&#39;t hide the <code>*</code> behind a typedef."}, {"owner": {"reputation": 141, "user_id": 7062928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/VJrvf.jpg?s=128&g=1", "display_name": "Decapod", "link": "https://stackoverflow.com/users/7062928/decapod"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566399620, "post_id": 57593623, "comment_id": 101646228, "body": "@Lundin Pls see the addition on the question."}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1566405749, "post_id": 57593623, "comment_id": 101649280, "body": "&quot;a declaration conflict (1098) is reported&quot; ... on which specific source line?"}, {"owner": {"reputation": 141, "user_id": 7062928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/VJrvf.jpg?s=128&g=1", "display_name": "Decapod", "link": "https://stackoverflow.com/users/7062928/decapod"}, "edited": false, "score": 0, "creation_date": 1566410424, "post_id": 57593623, "comment_id": 101651100, "body": "The declaration conflict is reported on  the function uint8_t MenuButtons(MENU *Menu). in the header file and the code file. As far as i can see there is no correlation between the error other than the fact that the MENU structure is used,"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566456362, "post_id": 57593623, "comment_id": 101663213, "body": "Yes well, I tried the code posted here in numerous mainstream compilers, only adding <code>#include &lt;stdint.h&gt;</code> and a typedef for INDEX. It compiles cleanly even with high warning levels set, on gcc, clang, icc. Even on MSVC. So either the problem is related to the file structure of your project, or the infamous Microchip compiler or this isn&#39;t the actual code."}, {"owner": {"reputation": 141, "user_id": 7062928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/VJrvf.jpg?s=128&g=1", "display_name": "Decapod", "link": "https://stackoverflow.com/users/7062928/decapod"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566471440, "post_id": 57593623, "comment_id": 101670964, "body": "@Lundin I have created a functional workaround compiling and linking without a problem. See addition 2"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566472380, "post_id": 57593623, "comment_id": 101671515, "body": "It&#39;s a weird problem, maybe related to the various stack tricks specific to PIC, or maybe related to how their compiler changes pointer sizes dynamically depending on use etc. I peeked at the MPLAB manual but nothing in its documentation about deviations from the standard mentions struct forward declarations. I&#39;d open a support ticket with Microchip and give them a project that reproduces the error."}, {"owner": {"reputation": 141, "user_id": 7062928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/VJrvf.jpg?s=128&g=1", "display_name": "Decapod", "link": "https://stackoverflow.com/users/7062928/decapod"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566473522, "post_id": 57593623, "comment_id": 101672142, "body": "@Lundin I am going to follow your advise"}, {"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1576532033, "post_id": 57593623, "comment_id": 104922921, "body": "Which version of XC8 are you using.  The original code compiles on  version 1.42.  At a guess it is your use of <b>typedef struct MenuStr MenuStr</b>.  Try changing it to <b>typedef struct MenuStr MENU</b>."}, {"owner": {"reputation": 141, "user_id": 7062928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/VJrvf.jpg?s=128&g=1", "display_name": "Decapod", "link": "https://stackoverflow.com/users/7062928/decapod"}, "reply_to_user": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1576652497, "post_id": 57593623, "comment_id": 104964654, "body": "@cup I tried on 1.45; 2.00 and 2.05. I keep your comment in mind."}, {"owner": {"reputation": 139, "user_id": 851042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec6d93c74fd80dcaeb6a78aa1e55aaa?s=128&d=identicon&r=PG", "display_name": "efox29", "link": "https://stackoverflow.com/users/851042/efox29"}, "edited": false, "score": 0, "creation_date": 1596198473, "post_id": 57593623, "comment_id": 111742801, "body": "@Decapod did you get this resolved - having the same issue right now."}], "owner": {"reputation": 141, "user_id": 7062928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/VJrvf.jpg?s=128&g=1", "display_name": "Decapod", "link": "https://stackoverflow.com/users/7062928/decapod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566471365, "creation_date": 1566396607, "last_edit_date": 1566471365, "question_id": 57593623, "link": "https://stackoverflow.com/questions/57593623/unclear-compiler-error-after-implementing-a-change-in-a-structure-using-forward", "title": "Unclear compiler error after implementing a change in a structure using forward declarations", "body": "<p>I believed that the strange behaviour of the XC8 compiler was due to problems with forward declarations. With help of you all I have corrected that but the strange error remains.  So now I elaborate a little more on my problem.\nIn the MENU structure CursorStr has been implemented and gives trouble.\nIf I take out CursorStr and use the ButtonFunc* directly then all goes well.\nBelow the structs I have included the #define statements used througout the program.  </p>\n\n<pre><code>typedef struct ArrowStr {\n    // Cursor select data\n    uint8_t UP[4];\n    uint8_t DOWN[4];\n    uint8_t RIGHT[4];\n    uint8_t LEFT[4];\n}ARROW_STR;\n\ntypedef struct MenuStr MenuStr;\ntypedef uint8_t ButtonFunc(MenuStr *);\n\ntypedef struct CursorStr\n{         \n    ButtonFunc* ButtonUpPtr;\n    ButtonFunc* ButtonDownPtr;\n    ButtonFunc* ButtonLeftPtr;\n    ButtonFunc* ButtonRightPtr;\n    ButtonFunc* PreMenuCursorPtr;\n    ButtonFunc* MenuCursorPtr;\n    ButtonFunc* PostMenuCursorPtr;\n}CURSOR_STR;\n\ntypedef struct MenuStr\n{\n    ARROW_STR Arrows; \n    // not known anymore\n    int    *ValueArray;\n    // Cusor position data\n    uint8_t ROW_POS[4];\n    uint8_t COL_POS[4];\n    // A5-A3 format strings\n    uint8_t Format[3][3];\n    INDEX ROW_INDEX;\n    INDEX COL_INDEX;\n    INDEX DIM_INDEX;\n    INDEX EDIT_INDEX;\n\n    INDEX FORMAT_INDEX;\n    uint8_t CURRENT_MENU;\n    CURSOR_STR CursorStr;\n\n  //  ButtonFunc* ButtonUpPtr;\n  //  ButtonFunc* ButtonDownPtr;\n  //  ButtonFunc* ButtonLeftPtr;\n   // ButtonFunc* ButtonRightPtr;\n   // ButtonFunc* PreMenuCursorPtr;\n  //  ButtonFunc* MenuCursorPtr;\n  //  ButtonFunc* PostMenuCursorPtr;\n    uint8_t CursorX;\n    uint8_t CursorY;\n}MENU;\n\n// used in case of CursorStr\n    #define pButtonDownPtr       Menu-&gt;CursorStr.ButtonDownPtr\n    #define pButtonUpPtr         Menu-&gt;CursorStr.ButtonUpPtr\n    #define pButtonLeftPtr       Menu-&gt;CursorStr.ButtonLeftPtr\n    #define pButtonRightPtr      Menu-&gt;CursorStr.ButtonRightPtr\n    #define pPreMenuCursorPtr    Menu-&gt;CursorStr.PreMenuCursorPtr\n    #define pMenuCursorPtr       Menu-&gt;CursorStr.MenuCursorPtr\n    #define pPostMenuCursorPtr   Menu-&gt;CursorStr.PostMenuCursorPtr\n    #define pCursorPtrs          Menu-&gt;CursorStr\n\n // used directly   \n    #define pButtonDownPtr       Menu-&gt;ButtonDownPtr\n    #define pButtonUpPtr         Menu-&gt;ButtonUpPtr\n    #define pButtonLeftPtr       Menu-&gt;ButtonLeftPtr\n    #define pButtonRightPtr      Menu-&gt;ButtonRightPtr\n    #define pPreMenuCursorPtr    Menu-&gt;PreMenuCursorPtr\n    #define pMenuCursorPtr       Menu-&gt;MenuCursorPtr\n    #define pPostMenuCursorPtr   Menu-&gt;PostMenuCursorPtr\n</code></pre>\n\n<p>In XC8 all compiles and runs fine with the direct approach but with the CursorStr approach a declaration conflict (1098) is reported. Of course I can reach my goal in using some calls to save, store and replace the pointers but I would like to see the CursorStr approach working because that would keep the code more simple. Again help is appreciated.</p>\n\n<p><strong>Addition:</strong></p>\n\n<p>If </p>\n\n<pre><code>typedef uint8_t ButtonFunc(MenuStr *)\n</code></pre>\n\n<p>is changed into </p>\n\n<pre><code>typedef uint8_t ButtonFunc(uint8_t *)\n</code></pre>\n\n<p>then I get understandably all kinds of warnings but the code compiles and the program works. So there must be still something with the forward declaration.</p>\n\n<p><strong>Addition2</strong></p>\n\n<p>Since I could not get what I wanted I created a workaround and changed the MENU_STR into the code below. This works without any error or warning. So for the moment I think that the problem comes from the XC8 compiler.</p>\n\n<pre><code>typedef uint8_t ButtonFunc(struct MenuStr *);\ntypedef uint8_t CursorFunc(void *);\n\n typedef struct Buttons{\n       CursorFunc* ButtonUpPtr;\n       CursorFunc* ButtonDownPtr;\n       CursorFunc* ButtonLeftPtr;\n       CursorFunc* ButtonRightPtr;\n       CursorFunc* PreMenuCursorPtr;\n       CursorFunc* MenuCursorPtr;\n       CursorFunc* PostMenuCursorPtr;   \n   }BUTTONS;\n\n\ntypedef struct MenuStr\n{\n    ARROW_STR Arrows; \n    // not known anymore\n    int    *ValueArray;\n    // Cusor position data\n    uint8_t ROW_POS[4];\n    uint8_t COL_POS[4];\n    // A5-A3 format strings\n    uint8_t Format[3][3];\n    INDEX ROW_INDEX;\n    INDEX COL_INDEX;\n    INDEX DIM_INDEX;\n    INDEX EDIT_INDEX;\n\n    INDEX FORMAT_INDEX;\n    uint8_t CURRENT_MENU;\n\n    union\n    {\n         BUTTONS ButtonsPtrs;    \n         struct \n         {\n                 ButtonFunc* ButtonUpPtr;\n                 ButtonFunc* ButtonDownPtr;\n                 ButtonFunc* ButtonLeftPtr;\n                 ButtonFunc* ButtonRightPtr;\n                 ButtonFunc* PreMenuCursorPtr;\n                 ButtonFunc* MenuCursorPtr;\n                 ButtonFunc* PostMenuCursorPtr;   \n        };\n    };\n    uint8_t CursorX;\n    uint8_t CursorY;\n}MENU;\n</code></pre>\n"}, {"tags": ["c", "sleep", "stm32"], "comments": [{"owner": {"reputation": 318, "user_id": 11942119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec26748e8c53969f0d2e7d6c819af0cf?s=128&d=identicon&r=PG", "display_name": "fugiefire", "link": "https://stackoverflow.com/users/11942119/fugiefire"}, "edited": false, "score": 0, "creation_date": 1566391666, "post_id": 57591880, "comment_id": 101641286, "body": "What flags are used for ld?"}, {"owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "edited": false, "score": 3, "creation_date": 1566391821, "post_id": 57591880, "comment_id": 101641405, "body": "there is already <code>HAL_Delay()</code> function, you can use it instead of <code>sleep()</code> this is not fix for your problem just an alternative way ... Also, you should init <code>CLK</code> for <code>GPIO</code> and <code>GPIO</code> itself."}, {"owner": {"reputation": 19, "user_id": 9419795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5df03b2ed3e3fc2758ea0ecec4f56f0c?s=128&d=identicon&r=PG&f=1", "display_name": "roedler", "link": "https://stackoverflow.com/users/9419795/roedler"}, "edited": false, "score": 0, "creation_date": 1566392962, "post_id": 57591880, "comment_id": 101642134, "body": "GPIO and CLK are initialized, but i left it out, bc not relevant"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566394040, "post_id": 57591880, "comment_id": 101642879, "body": "<code>sleep</code> is not standard but Linux-specific. Your STM32 is not a Linux PC."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566394299, "post_id": 57591880, "comment_id": 101643064, "body": "Also, unrelated to your question, you need to set data direction registers and possibly port mapping somewhere."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 7, "last_activity_date": 1566465954, "last_edit_date": 1566465954, "creation_date": 1566392674, "answer_id": 57592338, "question_id": 57591880, "link": "https://stackoverflow.com/questions/57591880/cant-use-sleep-in-embedded-c-for-stm32/57592338#57592338", "title": "cant use sleep() in embedded c for stm32", "body": "<p>You can't use POSIX functions on bare-metal target with arm-none-eabi-gcc compiler. There is no operating system. There is no <code>sleep()</code>, <code>gettimeofday()</code>, <code>clock_gettime()</code>, <code>getpid()</code>, <code>fork()</code>, <code>stat()</code>, <code>open()</code>, <code>pthread_create()</code> and many, many, many others C and posix and *unix specific functions. The declarations of these functions can be found in the standard headers, but linker will just give up with <code>undefined reference</code> error. You have to implement them yourself.</p>\n\n<p>Your compiler arm-none-eabi-gcc by default uses <a href=\"https://en.wikipedia.org/wiki/Newlib\" rel=\"nofollow noreferrer\">newlib</a> implementation of C standard library. It comes with an implementation of most basic and not operating system aware functions, like <code>snprintf</code> and <code>mktime</code>. For functions like <code>printf</code> or <code>putc</code> the callback <code>_write()</code> or <code>_write_r()</code> should be implemented for them to work. For <code>malloc()</code> to work you have to provide <code>sbrk()</code>. For most other functions, you have to implement them yourself.</p>\n\n<p>The commonly used <code>-specs=nosys.specs</code> compiler option just specifies to use a \"default\" no-system implementation of some functions like <code>fseek()</code> or <code>write()</code> or <code>sbrk()</code>. Most of these functions just return <code>-1</code> and set errno to <code>ENOSYS</code>, but are there, so that you can compile your program. The implementation can be found <a href=\"https://github.com/littlekernel/newlib/tree/master/libgloss/libnosys\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>If you happen to use stm32 hal library, you can initialize your systick interrupt for 1 ms and use the standard in stm32 world <code>HAL_Delay()</code> function and provide your own implementation of <code>sleep()</code>:</p>\n\n<pre><code>unsigned int sleep(unsigned int seconds) {\n   HAL_Delay(seconds * 1000);\n   return 0;\n}\n</code></pre>\n\n<p>The other way round is to use an operating system on your device that provides an implementation of these functions. For example there is <a href=\"https://riot-os.org/\" rel=\"nofollow noreferrer\">RIOT OS</a> that aims at providing POSIX compatibility and already provides many calls.</p>\n"}, {"comments": [{"owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "edited": false, "score": 0, "creation_date": 1566576536, "post_id": 57593029, "comment_id": 101713083, "body": "This will not work with optimizations <a href=\"https://gcc.godbolt.org/z/mjhjHq\" rel=\"nofollow noreferrer\">enabled</a>"}, {"owner": {"reputation": 10367, "user_id": 380331, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef911e1dffe26625ae43f8d1cd1ac70e?s=128&d=identicon&r=PG", "display_name": "Agnius Vasiliauskas", "link": "https://stackoverflow.com/users/380331/agnius-vasiliauskas"}, "reply_to_user": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "edited": false, "score": 0, "creation_date": 1566646025, "post_id": 57593029, "comment_id": 101727328, "body": "See my edit - I&#39;ve added <code>asm(&quot;nop&quot;);</code> for loop(s) not being factored out by compiler optimizations. If NOP is factored out in STM32 microcontroller too - then something else may be added instead of nop, dependent on the platform / cpu."}], "tags": [], "owner": {"reputation": 10367, "user_id": 380331, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef911e1dffe26625ae43f8d1cd1ac70e?s=128&d=identicon&r=PG", "display_name": "Agnius Vasiliauskas", "link": "https://stackoverflow.com/users/380331/agnius-vasiliauskas"}, "is_accepted": false, "score": 0, "last_activity_date": 1566645776, "last_edit_date": 1566645776, "creation_date": 1566394808, "answer_id": 57593029, "question_id": 57591880, "link": "https://stackoverflow.com/questions/57591880/cant-use-sleep-in-embedded-c-for-stm32/57593029#57593029", "title": "cant use sleep() in embedded c for stm32", "body": "<p>Micro-controller may not have standard library included, so in this case you must roll your own missing functions. For example sleep could be implemented like this:</p>\n\n<pre><code>void my_sleep(int secs) {\n  #define STEPS_PER_SEC 650000000\n  unsigned int i,s;\n  for (s=0; s &lt; secs; s++) {\n    for (i=0; i &lt; STEPS_PER_SEC; i++) {\n       // skip CPU cycle or any other statement(s) for making loop \n       // untouched by C compiler code optimizations\n       asm(\"nop\");\n    }\n  }\n}\n\nint main() {\n   my_sleep(1);\n}\n</code></pre>\n\n<p>Btw constant <code>STEPS_PER_SEC</code> should be adjusted empirically according to your controller CPU specs and your compilation mode (optimizations On / Off, etc.).</p>\n"}], "owner": {"reputation": 19, "user_id": 9419795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5df03b2ed3e3fc2758ea0ecec4f56f0c?s=128&d=identicon&r=PG&f=1", "display_name": "roedler", "link": "https://stackoverflow.com/users/9419795/roedler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1616, "favorite_count": 0, "accepted_answer_id": 57592338, "answer_count": 2, "score": 0, "last_activity_date": 1566645776, "creation_date": 1566391289, "last_edit_date": 1566391792, "question_id": 57591880, "link": "https://stackoverflow.com/questions/57591880/cant-use-sleep-in-embedded-c-for-stm32", "title": "cant use sleep() in embedded c for stm32", "body": "<p>I try to learn embedded c for a stm32-microcontorller. I try to wirte a easy blink program, where i use the sleep()-function.</p>\n\n<p>code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/* Includes ------------------------------------------------------------------*/\n#include &lt;unistd.h&gt;\n#include \"main.h\"\n\nint main(void)\n{\n  HAL_Init();\n\n  while (1)\n  { \n    HAL_GPIO_TogglePin(LD2_GPIO_Port,LD2_Pin);\n    sleep(1);  // this line throws a error, when compiling\n  }\n}\n</code></pre>\n\n<p>the compiler gives me following error:</p>\n\n<pre><code>/usr/lib/gcc/arm-none-eabi/7.4.0/../../../../arm-none-eabi/bin/ld: CMakeFiles/untitled2.elf.dir/Src/main.c.obj: in function `main':\n/home/heinrich/CLionProjects/untitled2/Src/main.c:106: undefined reference to `sleep'\ncollect2: error: ld returned 1 exit status\nmake[3]: *** [CMakeFiles/untitled2.elf.dir/build.make:391: untitled2.elf] Fehler 1\nmake[2]: *** [CMakeFiles/Makefile2:73: CMakeFiles/untitled2.elf.dir/all] Fehler 2\nmake[1]: *** [CMakeFiles/Makefile2:85: CMakeFiles/untitled2.elf.dir/rule] Fehler 2\nmake: *** [Makefile:118: untitled2.elf] Fehler 2\n</code></pre>\n\n<p>I think, the problem is a not-installed libary, but i installed everything in the fedora-repos for arm-gcc</p>\n\n<p>OS: Fedora 30\nIDE: CLion\nToolchain: Arm-gcc-none-eabi</p>\n"}, {"tags": ["c", "file", "fopen", "fgets"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1566391183, "post_id": 57591797, "comment_id": 101640983, "body": "<a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fgets.htm\" rel=\"nofollow noreferrer\"><code>fgets</code></a> is the opposite of <code>fprintf</code>"}, {"owner": {"reputation": 2233, "user_id": 2669128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/430a24425fb593f00def23e45c454c39?s=128&d=identicon&r=PG", "display_name": "thurizas", "link": "https://stackoverflow.com/users/2669128/thurizas"}, "edited": false, "score": 0, "creation_date": 1566392378, "post_id": 57591797, "comment_id": 101641776, "body": "The text &#39;went&#39; into the file &quot;inventor.txt&quot; that is in the working directory.  You should be able to open this with any text editor (e.g notepad++).  Hmmm, I take that back, I&#39;ve never used JDoodle and I&#39;m not sure where it puts files.  You might be better served by getting a compiler and install it on you system.  Then you can certainly create, save and open files."}], "answers": [{"comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1566392088, "post_id": 57592049, "comment_id": 101641562, "body": "In this case there is no need to strip the trailing newline and <code>s[strcspn( s, &quot;\\n&quot; )] = &#39;\\0&#39;; puts( s );</code> can be replaced with a simple <code>printf(&quot;%s&quot; s);</code>"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1566392161, "post_id": 57592049, "comment_id": 101641620, "body": "@DavidRanieri It is important to show that fgets appends the new line character.:)"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1566392527, "post_id": 57592049, "comment_id": 101641884, "body": "My comment was for the OP :P ... of course you are right and is good to know that <code>fgets</code> appends a <code>&quot;\\n&quot;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11748237"}, "edited": false, "score": 0, "creation_date": 1566406432, "post_id": 57592049, "comment_id": 101649545, "body": "Thank you all so much for your help, I will try!"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1566406511, "post_id": 57592049, "comment_id": 101649587, "body": "@AekateriniZorbas I advice to close the question selecting the best answer.:)"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1566391775, "creation_date": 1566391775, "answer_id": 57592049, "question_id": 57591797, "link": "https://stackoverflow.com/questions/57591797/hello-i-am-using-jdoodle-to-practice-c-programming-i-created-a-fpointer-to-te/57592049#57592049", "title": "Hello, I am using JDoodle to practice C programming, I created a fpointer to .text file, how can I open this .text file and see data?", "body": "<p>If I have understood correctly you need something like that</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\nint main(void) \n{\n    FILE * fpointer = fopen ( \"inventory.txt\", \"w\" );\n\n    if ( fpointer != NULL )\n    {\n        fprintf ( fpointer, \"A432LIPG, Lipgloss\\n A442LIPG, Lipgloss \\n C465LIPG, Lipgloss\" );\n\n        fclose( fpointer );\n    }\n    else\n    {\n        puts( strerror( errno ) );\n    }\n\n    fpointer = fopen ( \"inventory.txt\", \"r\" );\n\n    if ( fpointer != NULL )\n    {\n        enum { N = 100 };\n        char s[N];\n\n        while ( fgets( s, sizeof( s ), fpointer ) != NULL )\n        {\n            s[strcspn( s, \"\\n\" )] = '\\0';\n\n            puts( s );\n        }\n\n        fclose( fpointer );\n    }\n    else\n    {\n        puts( strerror( errno ) );\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11748237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566391846, "creation_date": 1566391012, "last_edit_date": 1566391846, "question_id": 57591797, "link": "https://stackoverflow.com/questions/57591797/hello-i-am-using-jdoodle-to-practice-c-programming-i-created-a-fpointer-to-te", "title": "Hello, I am using JDoodle to practice C programming, I created a fpointer to .text file, how can I open this .text file and see data?", "body": "<p>I wrote this code in jdoodle, the screen is blank. How can I open the .text? Where did it go?</p>\n\n<pre><code>int main () {\n\nFILE * fpointer = fopen (\"inventory.txt\", \"w\");\n\nfprintf (fpointer, \"A432LIPG, Lipgloss\\n A442LIPG, Lipgloss \\n C465LIPG, Lipgloss\");\n\nfclose (fpointer);\n\nreturn 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "network-programming"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1566388700, "post_id": 57590849, "comment_id": 101639464, "body": "The partial backtrace indicates that your program is multithreaded, and it furthermore seems to be indicating that you have two threads both running <code>close()</code> at the same time (not necessarily corresponding to the same source line).  Multithreading provides all kinds of opportunities for intermittent failures, so a reasonable diagnostic step would be to try to reproduce the issue in a single-threaded program."}, {"owner": {"reputation": 11, "user_id": 6606610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fec3d7fb30ef1fd4b490cd17fc40f838?s=128&d=identicon&r=PG&f=1", "display_name": "Bharat", "link": "https://stackoverflow.com/users/6606610/bharat"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1566398462, "post_id": 57590849, "comment_id": 101645575, "body": "we are firing a timer (using libevent), inside timer expiry call back function we are calling this ARP request send method. So it might happen that libevent is creating threads internally for each timer event and calling the callback function from that thread. Which eventually calls create_and_send_arp method."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1566424246, "post_id": 57590849, "comment_id": 101656350, "body": "The posted question is about a run time problem.  SO, please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1566424381, "post_id": 57590849, "comment_id": 101656383, "body": "It seems the OP could have made that minor edit in their program to <code>htons (ETH_P_ARP).</code> and tested it out (and IMO: should have done so) before posting the question on stackoverflow"}], "owner": {"reputation": 11, "user_id": 6606610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fec3d7fb30ef1fd4b490cd17fc40f838?s=128&d=identicon&r=PG&f=1", "display_name": "Bharat", "link": "https://stackoverflow.com/users/6606610/bharat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1566399117, "creation_date": 1566387756, "last_edit_date": 1566399117, "question_id": 57590849, "link": "https://stackoverflow.com/questions/57590849/socket-closesd-call-after-sending-arp-request-is-getting-stuck-hanged", "title": "socket close(sd) call (after sending arp request) is getting stuck (hanged)", "body": "<p>The below <code>create_and_send_arp</code> function sometimes hangs in the <code>close(sd)</code> call, after sending an ARP request.  Is that due to creating the socket with <code>htons (ETH_P_ALL)</code> ? I think for sending Gratuitous ARP requests it should be <code>htons (ETH_P_ARP)</code>.</p>\n\n<p>Would there be any side effect if we changed the socket protocol type to <code>ETH_P_ARP</code> instead of <code>ETH_P_ALL</code>?</p>\n\n<pre><code>create_and_send_arp(string port, IpAddress&amp; addr)\n{\n    const char *interface;\n    int frame_length, sd, bytes;\n    arp_hdr arphdr;\n    UINT32 address = addr.addr.ipv4.s_addr;\n\n    uint8_t src_ip[4], src_mac[6], dst_mac[6], ether_frame[IP_MAXPACKET];\n    struct sockaddr_ll device;\n    struct ifreq ifr;\n\n\n    // Interface to send packet through.\n    interface = port.c_str();\n    memcpy (src_ip, &amp;address, 4 * sizeof (uint8_t));\n\n     // Submit request for a socket descriptor to look up interface.\n    if ((sd = socket (AF_INET, SOCK_RAW, IPPROTO_RAW)) &lt; 0) {\n      perror (\"socket() failed to get socket descriptor for using ioctl()\");\n      return;\n    }\n\n    // Use ioctl() to look up interface name and get its MAC address.\n    memset (&amp;ifr, 0, sizeof (ifr));\n    snprintf (ifr.ifr_name, sizeof (ifr.ifr_name), \"%s\", interface);\n    if (ioctl (sd, SIOCGIFHWADDR, &amp;ifr) &lt; 0) {\n      perror (\"ioctl() failed to get source MAC address\");\n      close (sd);\n      return;\n    }\n\n    close (sd);\n\n    // Copy source MAC address.\n    memcpy (src_mac, ifr.ifr_hwaddr.sa_data, 6 * sizeof (uint8_t));\n\n    // Find interface index from interface name and store index in\n    // struct sockaddr_ll device, which will be used as an argument of sendto().\n    if ((device.sll_ifindex = if_nametoindex (interface)) == 0) {\n      perror (\"if_nametoindex() failed to obtain interface index\");\n      return;\n    }\n\n    // Set destination MAC address: broadcast address\n    memset (dst_mac, 0xff, 6 * sizeof (uint8_t));\n\n    memcpy (&amp;arphdr.sender_ip, src_ip, 4 * sizeof (uint8_t));\n    memcpy (&amp;arphdr.target_ip, src_ip, 4 * sizeof (uint8_t));\n\n    // Fill out sockaddr_ll.\n    device.sll_family = AF_PACKET;\n    memcpy (device.sll_addr, src_mac, 6 * sizeof (uint8_t));\n    device.sll_halen = htons (6);\n\n    // ARP header\n\n    // Hardware type (16 bits): 1 for ethernet\n    arphdr.htype = htons (1);\n\n    // Protocol type (16 bits): 2048 for IP\n    arphdr.ptype = htons (ETH_P_IP);\n\n    // Hardware address length (8 bits): 6 bytes for MAC address\n    arphdr.hlen = 6;\n\n    // Protocol address length (8 bits): 4 bytes for IPv4 address\n    arphdr.plen = 4;\n\n    // OpCode: 1 for ARP request\n    arphdr.opcode = htons (ARPOP_REQUEST);\n\n    // Sender hardware address (48 bits): MAC address\n    memcpy (&amp;arphdr.sender_mac, src_mac, 6 * sizeof (uint8_t));\n\n    // Target hardware address (48 bits): zero\n    memset (&amp;arphdr.target_mac, 0, 6 * sizeof (uint8_t));\n\n    // Fill out ethernet frame header.\n\n    // Ethernet frame length = ethernet header (MAC + MAC + ethernet type) + ethernet data (ARP header)\n    frame_length = 6 + 6 + 2 + ARP_HDRLEN;\n\n    // Destination and Source MAC addresses\n    memcpy (ether_frame, dst_mac, 6 * sizeof (uint8_t));\n    memcpy (ether_frame + 6, src_mac, 6 * sizeof (uint8_t));\n\n    // Next is ethernet type code (ETH_P_ARP for ARP).\n    ether_frame[12] = ETH_P_ARP / 256;\n    ether_frame[13] = ETH_P_ARP % 256;\n\n\n    // ARP header\n    memcpy (ether_frame + ETH_HDRLEN, &amp;arphdr, ARP_HDRLEN * sizeof (uint8_t));\n\n    if ((sd = socket (PF_PACKET, SOCK_RAW, htons (ETH_P_ARP))) &lt; 0) {\n        perror (\"socket() failed\");\n        return;\n    }\n\n    // Send ethernet frame to socket.\n    if ((bytes = sendto (sd, ether_frame, frame_length, 0, (struct sockaddr *) &amp;device, sizeof (device))) &lt;= 0) {\n      perror (\"sendto() failed\");\n      close (sd);\n      return;\n    }\n\n    // Close socket descriptor.\n    close (sd); // this gets stuck and hangs\n    return;\n    }\n</code></pre>\n\n<p>The backtrace when the program hangs is</p>\n\n<pre><code>[New LWP 29815]\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n\n#0 0x00007f33984cf750 in __close_nocancel () from /lib64/libpthread.so.0\n#0 0x00007f33984cf750 in __close_nocancel () from /lib64/libpthread.so.0\n</code></pre>\n"}, {"tags": ["c", "hash", "cryptography", "probability", "murmurhash"], "comments": [{"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1566394749, "post_id": 57590782, "comment_id": 101643378, "body": "What do you mean by &quot;quality&quot;? What are you using the hash for?"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 1, "creation_date": 1566408764, "post_id": 57590782, "comment_id": 101650436, "body": "Grabbing the first (or last, or middle) 32 bits of Mumur128 will not give you a better hash code (distribution, etc.) than Murmur32. It will <i>probably</i> give you approximately the same quality."}], "owner": {"reputation": 33097, "user_id": 508343, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c7fe4b419ef78796ae89e40665c4394b?s=128&d=identicon&r=PG", "display_name": "xmllmx", "link": "https://stackoverflow.com/users/508343/xmllmx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566387532, "creation_date": 1566387532, "question_id": 57590782, "link": "https://stackoverflow.com/questions/57590782/is-there-any-quality-difference-between-murmurhash32-and-static-castmurmurhash3", "title": "Is there any quality difference between MurmurHash32 and static_cast&lt;MurmurHash32&gt;(MurmurHash128)?", "body": "<p>Given a message, <a href=\"https://github.com/aappleby/smhasher/wiki/MurmurHash3\" rel=\"nofollow noreferrer\">MurmurHash3</a> can produce a 32-bit hash result or a 128-bit one.</p>\n\n<pre><code>Message msg;\nchar output_v32_a[4];\nchar output_v32_b[4];\nchar output_v128[16];\n\nMurmurHash32(msg, output_v32_a); \nMurmurHash128(msg, output_v128); \nmemcpy(output_v32_b, output_v128, 4);\n</code></pre>\n\n<p><strong>In the pseudocode above, is there any quality difference between <code>output_v32_a</code> and <code>output_v32_b</code>?</strong></p>\n"}, {"tags": ["c", "pic"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1566386417, "post_id": 57590415, "comment_id": 101638265, "body": "Do some research about <i>forward declarations</i>."}, {"owner": {"reputation": 141, "user_id": 7062928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/VJrvf.jpg?s=128&g=1", "display_name": "Decapod", "link": "https://stackoverflow.com/users/7062928/decapod"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566410749, "post_id": 57590415, "comment_id": 101651242, "body": "@Someprogrammerdude  Even after adjusting the forward declarations to the level indicated by Lundin i still have the same . With a different argument on the functions used (no forward declarations) I have a lot of warnings ofcourse but the program compiles and runs. There must be more"}], "answers": [{"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566387355, "post_id": 57590483, "comment_id": 101638741, "body": "I&#39;d say that hiding structures under <code>typedef</code>s is confusing, but that&#39;s just my opinion."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1566387441, "post_id": 57590483, "comment_id": 101638779, "body": "Whether to type out struct tags <code>struct Menustr</code> or use typedef is a matter of style. Typedef is by far the most common style save for in Linux, and it is also the most compatible with C++ structs and classes. Either style is ok."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566387595, "post_id": 57590483, "comment_id": 101638864, "body": "(Although when declaring opaque type ADTs, the caller need not worry their pretty head about what type your ADT is using internally - which makes <code>typedef struct MenuStr MenuStr;</code> superior for programs using opaque type. We don&#39;t type <code>struct FILE*</code> when using <code>FILE</code>, do we?)"}, {"owner": {"reputation": 141, "user_id": 7062928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/VJrvf.jpg?s=128&g=1", "display_name": "Decapod", "link": "https://stackoverflow.com/users/7062928/decapod"}, "edited": false, "score": 0, "creation_date": 1566394485, "post_id": 57590483, "comment_id": 101643207, "body": "@Lundin  Since I believed that the above was the reason for a strange compilation error I made this post. I have implemented your suggestions but my problems remain. I open a new post."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 141, "user_id": 7062928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/VJrvf.jpg?s=128&g=1", "display_name": "Decapod", "link": "https://stackoverflow.com/users/7062928/decapod"}, "edited": false, "score": 0, "creation_date": 1566394556, "post_id": 57590483, "comment_id": 101643253, "body": "@Decapod It wasn&#39;t really clear what you meant with &quot;Now I stumble into a problem with the arguments of the pointers&quot;. I assumed it was the unknown MENU type."}, {"owner": {"reputation": 141, "user_id": 7062928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/VJrvf.jpg?s=128&g=1", "display_name": "Decapod", "link": "https://stackoverflow.com/users/7062928/decapod"}, "edited": false, "score": 0, "creation_date": 1566395265, "post_id": 57590483, "comment_id": 101643736, "body": "@Lundin I had the impression that that was my problem. But there must be something else. Anyway your answer helped ."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566408782, "post_id": 57590483, "comment_id": 101650447, "body": "@Lundin I know that it&#39;s just an example, but <code>struct FILE*</code> is invalid. <code>FILE</code> is usually <code>typedef</code>&#39;d to <code>struct _IO_FILE</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1566457193, "post_id": 57590483, "comment_id": 101663579, "body": "@JL2210 That was the whole point - they did that on purpose so that you wouldn&#39;t have to type out <code>struct</code>. It is an opaque type and the compiler is free to handle it as it pleases internally."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 4, "last_activity_date": 1566387278, "last_edit_date": 1566387278, "creation_date": 1566386451, "answer_id": 57590483, "question_id": 57590415, "link": "https://stackoverflow.com/questions/57590415/how-to-solve-a-problem-with-circular-dependancy-in-c-and-function-pointers/57590483#57590483", "title": "How to solve a problem with circular dependancy in C and function pointers", "body": "<p>You'll have to forward-declare the <code>MENU</code> struct. Add this before the declaration of <code>CURSOR_STR</code>:</p>\n\n<pre><code>typedef struct MenuStr MenuStr;\n</code></pre>\n\n<p>All this does is to tell the compiler that there will be a struct called <code>MenuStr</code> in the program, but that it will be defined later on.</p>\n\n<hr>\n\n<p>Also consider using a typedef for the function pointers. Full example:</p>\n\n<pre><code>typedef struct MenuStr MenuStr;\n\ntypedef uint8_t ButtonFunc (MenuStr*);\n\ntypedef struct Cursorstr\n{\n  ButtonFunc* ButtonUpPtr;\n  ButtonFunc* ButtonDownPtr;\n  ButtonFunc* ButtonLeftPtr;\n  ButtonFunc* ButtonRightPtr;\n  ButtonFunc* PreMenuCursorPtr;\n  ButtonFunc* MenuCursorPtr;\n  ButtonFunc* PostMenuCursorPtr;\n}CURSOR_STR;\n\ntypedef struct MenuStr\n{\n  // more elements\n  CURSOR_STR  Elements;\n  // more elements\n}MENU;\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 7062928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/VJrvf.jpg?s=128&g=1", "display_name": "Decapod", "link": "https://stackoverflow.com/users/7062928/decapod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 57590483, "answer_count": 1, "score": 0, "last_activity_date": 1566389200, "creation_date": 1566386205, "last_edit_date": 1566389200, "question_id": 57590415, "link": "https://stackoverflow.com/questions/57590415/how-to-solve-a-problem-with-circular-dependancy-in-c-and-function-pointers", "title": "How to solve a problem with circular dependancy in C and function pointers", "body": "<p>|In a program I use this struct with function pointers but I want to change it so I can save, restore and replace the function pointers with one single statement.</p>\n\n<pre><code>typedef struct MenuStr\n{\n       // more elements\n       uint8_t (*ButtonUpPtr)(struct MenuStr *Menu);\n       uint8_t (*ButtonDownPtr)(struct MenuStr *Menu);\n       uint8_t (*ButtonLeftPtr)(struct MenuStr *Menu);\n       uint8_t (*ButtonRightPtr)(struct MenuStr *Menu);\n       uint8_t (*PreMenuCursorPtr)(struct MenuStr *Menu);\n       uint8_t (*MenuCursorPtr)(struct MenuStr *Menu);\n       uint8_t (*PostMenuCursorPtr)(struct MenuStr *Menu);\n       // more elements\n}MENU;\n</code></pre>\n\n<p>Therefore I want to change the above into allowing a copy of all the pointers with one statement.</p>\n\n<pre><code>typedef struct Cursorstr\n{\n       uint8_t (*ButtonUpPtr)(struct MenuStr *Menu);\n       uint8_t (*ButtonDownPtr)(struct MenuStr *Menu);\n       uint8_t (*ButtonLeftPtr)(struct MenuStr *Menu);\n       uint8_t (*ButtonRightPtr)(struct MenuStr *Menu);\n       uint8_t (*PreMenuCursorPtr)(struct MenuStr *Menu);\n       uint8_t (*MenuCursorPtr)(struct MenuStr *Menu);\n       uint8_t (*PostMenuCursorPtr)(struct MenuStr *Menu);\n}CURSOR_STR;\n\ntypedef struct MenuStr\n{\n           // more elements\n           CURSOR_STR  Elements;\n           // more elements\n}MENU;\n</code></pre>\n\n<p>Now I stumble into a problem with the arguments of the pointers and I can not find the solution. \nAssistance is appreciated</p>\n"}, {"tags": ["c", "assembly", "x86", "cpu-registers"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1566385702, "post_id": 57590230, "comment_id": 101637843, "body": "Single step through the disassembly with a debugger and see for yourself?"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 1, "creation_date": 1566385778, "post_id": 57590230, "comment_id": 101637884, "body": "The value of <code>eax</code> after the execution of this instruction should equal <code>eax+eax*4</code>"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 4, "creation_date": 1566386033, "post_id": 57590230, "comment_id": 101638036, "body": "If you think it through backwards, you can deduce it... the line before has <code>c</code> in <code>eax</code>, that is, the value of <code>a*b</code>. <code>d = a*b + c*4</code> is the same as <code>d = c + c*4</code> (the compiler is smart enough to figure this out). <code>lea eax, DWORD PTR [eax + eax*4]</code> loads <code>eax</code> with the value <code>eax + eax*4</code>, which is <code>c + c*4</code>, thus the desired return value of the function. I&#39;d recommend, though, doing an interwebs search on <code>x86 lea instruction</code> as you&#39;ll find lots of information on what it does and why."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 3, "creation_date": 1566386069, "post_id": 57590230, "comment_id": 101638054, "body": "Is your question what the <code>lea</code> instruction does ? If so, refer to <a href=\"https://stackoverflow.com/questions/1658294/whats-the-purpose-of-the-lea-instruction\">What&#39;s the purpose of the LEA instruction?</a>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566389913, "post_id": 57590230, "comment_id": 101640142, "body": "<i>when we multiply it stores in eax</i>.  No, that&#39;s only if you use one-operand <code>mul</code> or <code>imul</code>, and the result goes in EDX:EAX.  When you use normal 2-operand <code>imul</code> it&#39;s just like <code>add</code>.  You can do stuff like <code>imul esi, edi</code>.  (It&#39;s faster because it doesn&#39;t have to write the high half anywhere, that&#39;s why this compiler, MSVC it looks like, chose to use <code>imul eax, [esp-4 + _b$]</code> instead of one-operand <code>imul dword ptr [esp-4 + _b$]</code>, even though it does already have the other operand in EAX and it would be safe to clobber EDX)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566390181, "post_id": 57590230, "comment_id": 101640323, "body": "What are you confused about?  Why would the answer <i>not</i> be exactly what you&#39;d expect from the C source (<a href=\"https://godbolt.org/z/llPL8g\" rel=\"nofollow noreferrer\">godbolt.org/z/llPL8g</a> shows an inlined caller), or from the asm?  Obviously the compiler implements the C source correctly, and those inputs don&#39;t cause any C undefined behaviour (e.g. signed overflow), so what&#39;s the question?  As you can see from the comments, people are having to guess about what kind of any might be useful.  The way it&#39;s written, a one-word &quot;yes&quot; would be a complete answer to what you asked.  That&#39;s usually a sign that it&#39;s not a useful or well-expressed question."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566407807, "post_id": 57590230, "comment_id": 101650043, "body": "@PeterCordes : I hope you never end up in a witness box :)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1566412215, "post_id": 57590230, "comment_id": 101651839, "body": "@mevets: because the lawyers and judge would complain if I tried to clarify the question?  Are we just supposed to assume that the question is about LEA when the only error in the question is the claim that multiply always puts the result in EAX?  There are multiple canonical duplicates for LEA, so this question only has any reason for existing if it&#39;s about something else.  But what?"}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566414291, "post_id": 57590230, "comment_id": 101652688, "body": "@PeterCordes: yes.   It was a well intended joke, I hope I didn&#39;t offend you."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1566416278, "post_id": 57590230, "comment_id": 101653601, "body": "@mevets: yeah, I got that you were joking, I just wasn&#39;t sure about which which part.  Like answering a long but ultimately yes or no question with just a &quot;yes&quot;?  Or the asking for clarification?  I didn&#39;t take offense, but I thought you might be using that joke to suggest that some of my comments went too far or were being too hard on this question.  If it was purely joking, then nevermind :P"}], "answers": [{"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1566407515, "creation_date": 1566407515, "answer_id": 57596349, "question_id": 57590230, "link": "https://stackoverflow.com/questions/57590230/value-of-eax-register-in-the-assembly-program/57596349#57596349", "title": "Value of eax register in the assembly program", "body": "<p><code>lea</code> is \"load effective address\". </p>\n\n<p>Instruction sets can have some quite complex multi-register address calculation modes that are generally used just for reading and writing data to memory, but lea allows the programmer to get the address that would be accessed by the instruction.</p>\n\n<p>Effectively, it performs the calculation inside the bracket, returns that value - it  doesn't access the memory (which is what bracket usually implies).</p>\n\n<p>In this case it is being used as a quick way to multiply by 5, because the rest of the function has been optimised away!</p>\n"}], "owner": {"reputation": 5377, "user_id": 417552, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/b614f4459d79cd6bbe55eb316acf1042?s=128&d=identicon&r=PG&f=1", "display_name": "narayanpatra", "link": "https://stackoverflow.com/users/417552/narayanpatra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 662, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566407515, "creation_date": 1566385569, "last_edit_date": 1566389927, "question_id": 57590230, "link": "https://stackoverflow.com/questions/57590230/value-of-eax-register-in-the-assembly-program", "title": "Value of eax register in the assembly program", "body": "<p>I am completing an assignment related to c programming and assembly language. Here is the simple c program : </p>\n\n<pre><code>int multiply(int a, int b) {\n    int k = 4; \n    int c,d, e;\n    c = a*b ;\n    d = a*b + k*c;\n    return d;\n}\n</code></pre>\n\n<p>And it's optimised assembly is </p>\n\n<pre><code>_a$ = 8                                       ; size = 4\n_b$ = 12                                                ; size = 4\n_multiply PROC\n        mov     eax, DWORD PTR _a$[esp-4]\n        imul    eax, DWORD PTR _b$[esp-4]\n        lea     eax, DWORD PTR [eax+eax*4]\n        ret     0\n_multiply ENDP\n</code></pre>\n\n<p>I want to know the value of eax register after this line of code in assembly </p>\n\n<pre><code>lea     eax, DWORD PTR [eax+eax*4]\n</code></pre>\n\n<p>I know when add integers in assembly, it stores result in the destination. and when we multiply it stores in eax. so if I call the function multiply( 3 , 8 ), the value of eax register after that line should be 120. Am I correct? </p>\n"}, {"tags": ["c", "bash", "printf"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1566384641, "post_id": 57589781, "comment_id": 101637285, "body": "Why are you passing values cast to <code>double</code> to a <code>printf()</code> with formatting strings <code>%x</code>  and <code>%X</code>? Those expect <code>unsigned int</code>, so this is instant undefined behavior."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 2, "last_activity_date": 1566387071, "creation_date": 1566387071, "answer_id": 57590657, "question_id": 57589781, "link": "https://stackoverflow.com/questions/57589781/how-to-format-c-printf-string-to-be-equal-to-bash-printf-string/57590657#57590657", "title": "How to Format C-printf string to be equal to bash-printf string", "body": "<p>Just convert it then to hexadecimal value with nanoseconds resolution...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nint main() {\n    struct timespec tp;\n    clock_gettime(CLOCK_REALTIME, &amp;tp);\n    unsigned long long tmp = tp.tv_sec * 1000ull * 1000 * 1000 + tp.tv_nsec;\n    printf(\"%llX\", tmp);\n}\n</code></pre>\n\n<p>Don't use gettimeofday, it's deprecated since POSIX 2008.</p>\n"}], "owner": {"reputation": 1, "user_id": 10943954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/562f615f3b4d869bfb66f6318a8255b0?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Cel", "link": "https://stackoverflow.com/users/10943954/mike-cel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566387071, "creation_date": 1566383934, "question_id": 57589781, "link": "https://stackoverflow.com/questions/57589781/how-to-format-c-printf-string-to-be-equal-to-bash-printf-string", "title": "How to Format C-printf string to be equal to bash-printf string", "body": "<p>I want to send timestamps via the CAN interface for analysis. \nTherefore I used the cansend from the Linux-can/can-utils. On the Linux shell I can send the current time via \n<code>cansend can0 123#$(printf \"%x\" $(date +%s%N))</code>.</p>\n\n<p><code>date +%s%N</code> gives me the output <code>1566378614461677537</code>  (which is 19 digits) simply converted to hex with <code>printf \"%X\" $(date +%s%N)</code> gives me the desired output <code>B15CE567BA9D338E</code> (which is 8 Bytes CAN-frame)\nwhich then is sent with the \"cansend\". On the other side, inside my C-Code</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    struct timeval start; \n    gettimeofday(&amp;start, NULL);\n    printf(\"%.0f%.0f\\n\", (double)( start.tv_sec) , (double)(start.tv_usec)); //for debug\n    printf(\"%x%.0X.%0X%X\\n\", (double)(start.tv_sec), (double)(start.tv_usec)); //desired output \n</code></pre>\n\n<p>gives me the output <code>1566382713648209</code>\n(that's 16 digits without nano, but accurate enought for me) but if i use \n<code>printf(\"%x%.0X%0X%X\\n\", (double)(start.tv_sec), (double)(start.tv_usec))</code> then the output is <code>09E40000041D757460</code>. \nHow can I get the desired output <code>B15CE567BA9D338E</code>?</p>\n"}, {"tags": ["c", "build", "alpine"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566389721, "post_id": 57589231, "comment_id": 101640022, "body": "There is much more to compilation then copying one file... The <code>ENABLE_FEATURE_VERBOSE</code> is getting defined by the build system, after you run <code>make menuconfig</code> from busybox. You better clone the whole repo..."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1566389890, "post_id": 57589231, "comment_id": 101640129, "body": "Busybox combines all its utilities in one binary. This means it&#39;s not meant for anyone to compile any single file or utility and produce a separate executable for them, and as a side effect there&#39;s a lot of dependencies between the various modules and commands. You likely need to build/replace busybox on your system alltogether. (e.g. ENABLE_FEATURE_VERBOSE is created as part the build process of busybox)"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1566483780, "post_id": 57589231, "comment_id": 101678277, "body": "If you change the way time work, you will break anything else that depends on it"}], "answers": [{"comments": [{"owner": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "edited": false, "score": 0, "creation_date": 1566546329, "post_id": 57593587, "comment_id": 101697715, "body": "Seems like unfortunately it has the same problem as Alpine -- it prints two digits of time after a dot. Ubuntu and Mac OS print more digits -- 3. What I wanted to improve is printing with <code>%03</code> instead of <code>%02</code>."}, {"owner": {"reputation": 10144, "user_id": 7256341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RXEvi.jpg?s=128&g=1", "display_name": "valiano", "link": "https://stackoverflow.com/users/7256341/valiano"}, "reply_to_user": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "edited": false, "score": 0, "creation_date": 1566549937, "post_id": 57593587, "comment_id": 101699337, "body": "@Nakilon I see. Then you can try your original plan to patch and build time, but this time using GNU time: git://git.sv.gnu.org/time"}, {"owner": {"reputation": 10144, "user_id": 7256341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RXEvi.jpg?s=128&g=1", "display_name": "valiano", "link": "https://stackoverflow.com/users/7256341/valiano"}, "reply_to_user": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "edited": false, "score": 0, "creation_date": 1566550303, "post_id": 57593587, "comment_id": 101699513, "body": "Or try grabbing the source code of the exact Ubuntu package version that is working for you (with <code>deb-src</code> or from the package download page), and trying building that on Alpine"}], "tags": [], "owner": {"reputation": 10144, "user_id": 7256341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RXEvi.jpg?s=128&g=1", "display_name": "valiano", "link": "https://stackoverflow.com/users/7256341/valiano"}, "is_accepted": false, "score": 0, "last_activity_date": 1566412907, "last_edit_date": 1566412907, "creation_date": 1566396505, "answer_id": 57593587, "question_id": 57589231, "link": "https://stackoverflow.com/questions/57589231/how-do-i-compile-the-time-c-on-alpine/57593587#57593587", "title": "How do I compile the time.c on Alpine?", "body": "<p>Assuming that GNU time functionality is what your after, and BusyBox <code>time</code> being insufficient for your needs, just install the <a href=\"https://pkgs.alpinelinux.org/package/edge/testing/x86_64/time\" rel=\"nofollow noreferrer\">GNU time</a> package which was recently made available on Alpine:</p>\n\n<pre><code>apk add time --repository=http://dl-cdn.alpinelinux.org/alpine/edge/testing\n</code></pre>\n\n<p>When installed, it will replace the <code>/usr/bin/time</code> BusyBox symlink with the GNU time executable.</p>\n"}], "owner": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 423, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1566412907, "creation_date": 1566382080, "last_edit_date": 1566389568, "question_id": 57589231, "link": "https://stackoverflow.com/questions/57589231/how-do-i-compile-the-time-c-on-alpine", "title": "How do I compile the time.c on Alpine?", "body": "<p>I don't like the built-in <code>time</code> utility in Alpine Linux and would like to improve it for my needs -- I want to edit the <code>time.c</code> and compile it to a binary. I have done the <code>apk add build-base</code> to install the gcc and have copypasted the <code>time.c</code> from Github, but when I do the <code>gcc /tmp/time.c -o /tmp/time</code> I get the:</p>\n\n<pre><code>/tmp/time.c:34:10: fatal error: libbb.h: No such file or directory\n #include \"libbb.h\"\n          ^~~~~~~~~\n</code></pre>\n\n<p>So I copypasted it too but it relies on dozens more header files. I saw somewhere that I might need the <code>apk add alpine-sdk</code> and maybe it would also garantee version compatibility so I did it but gcc still does not see header files. Should I provide some <code>-I</code> flag?<br>\nWhat do I really have to do to finally compile my custom <code>time.c</code>?</p>\n\n<p>P.S.: there is probably a SO tag for <code>time</code> but I can't find it.</p>\n\n<p>UPD: I've copied the whole <code>include</code> folder but it says:</p>\n\n<pre><code>In file included from /tmp/time.c:34:\ninclude/libbb.h:406:42: error: 'ENABLE_FEATURE_VERBOSE' undeclared here (not in a function)\n  FILEUTILS_VERBOSE         = (1 &lt;&lt; 12) * ENABLE_FEATURE_VERBOSE, /* -v */\n                                          ^~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>but I can't find where it's defined even in the whole <a href=\"https://github.com/mirror/busybox\" rel=\"nofollow noreferrer\">https://github.com/mirror/busybox</a></p>\n\n<p>UPD: oh no, it's more complex.</p>\n\n<pre><code>/ # ls -l `which time`\nlrwxrwxrwx    1 root     root            12 Jan 30  2019 /usr/bin/time -&gt; /bin/busybox\n</code></pre>\n\n<p>Seems like there is no such thing as <code>time</code> binary.</p>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1566382251, "post_id": 57589160, "comment_id": 101636029, "body": "<code>_DEF1(cpu_id)</code> results in a string, eg. <code>&quot;SUBCORE1&quot;</code>. How do you expect <code>_JOIN(&quot;SUBCORE1&quot;,BASE_ADDR_DEF)</code> to work ?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566382344, "post_id": 57589160, "comment_id": 101636085, "body": "You want to have <code>&quot;SUBCORE1&quot;_PERIPHERAL_I2C_BASE__ADDR</code> ?"}, {"owner": {"reputation": 2663, "user_id": 35733, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/617a3a44e355ca7a357596d21d16a3a5?s=128&d=identicon&r=PG", "display_name": "lordhog", "link": "https://stackoverflow.com/users/35733/lordhog"}, "edited": false, "score": 1, "creation_date": 1566383531, "post_id": 57589160, "comment_id": 101636713, "body": "Yes, I know I didn&#39;t want &quot;SUBCORE1&quot;, but it was a baby step to see if I could get something towards the end goal.  ;-)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566384452, "post_id": 57589160, "comment_id": 101637179, "body": "So drop the string literals."}], "answers": [{"comments": [{"owner": {"reputation": 2663, "user_id": 35733, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/617a3a44e355ca7a357596d21d16a3a5?s=128&d=identicon&r=PG", "display_name": "lordhog", "link": "https://stackoverflow.com/users/35733/lordhog"}, "edited": false, "score": 0, "creation_date": 1566383939, "post_id": 57589474, "comment_id": 101636912, "body": "Thanks, @Kamil-Cuk, I figured I was missing some level of expansion.  I just needed that extra <code>#define _XJOIN(x,y)      _JOIN(x,y)</code> to make it work.  Thanks again"}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1566382920, "creation_date": 1566382920, "answer_id": 57589474, "question_id": 57589160, "link": "https://stackoverflow.com/questions/57589160/nested-preprocessors-to-equate-to-a-define/57589474#57589474", "title": "Nested preprocessors to equate to a #define", "body": "<ol>\n<li>Declare macros not as string literals. Just as strings. Change ex. <code>\"SUBCORE3\"</code> to <code>SUBCORE3</code>. Preprocessor can't remove <code>\"</code>.</li>\n<li>You need to trigger expansion with a nested macro. Ex. <code>#define _JOIN2(x, y) x ## y</code> and then <code>#define _JOIN(x, y) _JOIN2(x, y)</code></li>\n<li>All identifiers starting with a underscore followed by big letter are reserved by standard. Declaring them is undefined behavior.</li>\n</ol>\n\n<p></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n/* Created by makefile to specify the core/CPU */\n#define  CPU_ID       5\n\n/* Autogenerated hardware register descriptors */\n#define CPU0_PERIPHERAL_I2C_BASE__ADDR         (0x40000)\n#define CPU1_PERIPHERAL_I2C_BASE__ADDR         (0x56000)\n#define CPU2_PERIPHERAL_I2C_BASE__ADDR         (0x57000)\n#define CPU3_PERIPHERAL_I2C_BASE__ADDR         (0x61000)\n#define SUBCORE0_PERIPHERAL_I2C_BASE__ADDR     (0x67000)\n#define SUBCORE1_PERIPHERAL_I2C_BASE__ADDR     (0x90000)\n#define SUBCORE2_PERIPHERAL_I2C_BASE__ADDR     (0xA3000)\n#define SUBCORE3_PERIPHERAL_I2C_BASE__ADDR     (0xE3000)\n\n#define BASE_ADDR_DEF     _PERIPHERAL_I2C_BASE__ADDR\n\n/* defines for translating CPU_ID into autogenerated hardware regs */\n#define CPU_ID_0       CPU0\n#define CPU_ID_1       CPU1\n#define CPU_ID_2       CPU2\n#define CPU_ID_3       CPU3\n#define CPU_ID_4       SUBCORE0\n#define CPU_ID_5       SUBCORE1\n#define CPU_ID_6       SUBCORE2\n#define CPU_ID_7       SUBCORE3\n\n// usually those are called CONCAT or CONCATX or CONCAT2 or XCONCAT etc.\n// so I name them the same here\n// XCONCAT is a mnemonic from \"eXpand then CONCATenate\"\n#define CONCAT(x,y)     x ## y\n#define XCONCAT(x,y)    CONCAT(x, y)\n#define STRING(x)        #x\n#define XSTRING(x)       STRING(x)\n// note that glibc defines __CONCAT __XCONCAT __STRING __XSTRING\n\n// trigger the expansions\n#define DEF1(cpu_id)    XCONCAT(CPU_ID_, cpu_id)\n#define DEF2(cpu_id)    XCONCAT(DEF1(cpu_id),BASE_ADDR_DEF)\n\nint main(void)\n{\n    printf(\"%s\\n\", XSTRING(DEF1(CPU_ID)));  // &lt;- this prints out \"SUBCORE0\", which is at all not part the way here\n    printf(\"%X\\n\", DEF2(CPU_ID));  // &lt;- This will expand to 0x90000\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 2663, "user_id": 35733, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/617a3a44e355ca7a357596d21d16a3a5?s=128&d=identicon&r=PG", "display_name": "lordhog", "link": "https://stackoverflow.com/users/35733/lordhog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57589474, "answer_count": 1, "score": 1, "last_activity_date": 1566385298, "creation_date": 1566381842, "last_edit_date": 1566385298, "question_id": 57589160, "link": "https://stackoverflow.com/questions/57589160/nested-preprocessors-to-equate-to-a-define", "title": "Nested preprocessors to equate to a #define", "body": "<p>I am trying to create a macro that coverts a #define create in the makefile to an autogenerated list of #defines which are starting address to peripheral components. Here is the test code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n/* Created by makefile to specify the core/CPU */\n#define  CPU_ID       5\n\n/* Autogenerated hardware register descriptors */\n#define CPU0_PERIPHERAL_I2C_BASE__ADDR         (0x40000)\n#define CPU1_PERIPHERAL_I2C_BASE__ADDR         (0x56000)\n#define CPU2_PERIPHERAL_I2C_BASE__ADDR         (0x57000)\n#define CPU3_PERIPHERAL_I2C_BASE__ADDR         (0x61000)\n#define SUBCORE0_PERIPHERAL_I2C_BASE__ADDR     (0x67000)\n#define SUBCORE1_PERIPHERAL_I2C_BASE__ADDR     (0x90000)\n#define SUBCORE2_PERIPHERAL_I2C_BASE__ADDR     (0xA3000)\n#define SUBCORE3_PERIPHERAL_I2C_BASE__ADDR     (0xE3000)\n\n#define BASE_ADDR_DEF     _PERIPHERAL_I2C_BASE__ADDR\n\n/* defines for translating CPU_ID into autogenerated hardware regs */\n#define CPU_ID_0       \"CPU0\"\n#define CPU_ID_1       \"CPU1\"\n#define CPU_ID_2       \"CPU2\"\n#define CPU_ID_3       \"CPU3\"\n#define CPU_ID_4       \"SUBCORE0\"\n#define CPU_ID_5       \"SUBCORE1\"\n#define CPU_ID_6       \"SUBCORE2\"\n#define CPU_ID_7       \"SUBCORE3\"\n\n#define _JOIN(x,y)       x ## y\n#define _DEF1(cpu_id)    _JOIN(CPU_ID_,cpu_id)\n#define _DEF2(cpu_id)    _JOIN(_DEF1(cpu_id),BASE_ADDR_DEF)\n\nint main(void)\n{\n    printf(\"%s\\n\", _DEF1(CPU_ID));  // &lt;- this prints out \"SUBCORE0\" which is part of the way there\n    printf(\"%X\\n\", _DEF2(CPU_ID));  // &lt;- This will not compile\n    return 0;\n}\n</code></pre>\n\n<p>The _DEF1 macro sort of works at the output, in this case, will be \"SUBCORE1\" as I expect.  I can't seem to get the macro to translate up one additional level to combine the \"SUBCORE1\" with \"_PERIPHERAL_I2C_BASE__ADDR\" to create \"SUBCORE1_PERIPHERAL_I2C_BASE__ADDR\" then print out the hex value which should be 0x90000.  Am I missing another level of macros during the expansion that I am not seeing or can't get correct?</p>\n\n<p>Edit: I know people are commenting about the literal strings and I know this wasn't the end goal, but this was just one of many iterative steps while experimenting. I just needed some sort of example to show what I was trying to do.  Thanks.</p>\n"}, {"tags": ["c", "floating-point"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1566381703, "post_id": 57589047, "comment_id": 101635702, "body": "Please also add how you run this code (specifically : what do you place on <code>stdin</code> ? do you simply type or do you redirect from a file in which a <code>double</code> was previously written with <code>write</code> ?)."}, {"owner": {"reputation": 8116, "user_id": 815653, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a2beceb77bdda94b8097c2c21f615442?s=128&d=identicon&r=PG", "display_name": "zell", "link": "https://stackoverflow.com/users/815653/zell"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1566381888, "post_id": 57589047, "comment_id": 101635824, "body": "@SanderDeDycker I typed the inputs from  the console. See my edits."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566389504, "post_id": 57589166, "comment_id": 101639898, "body": "The sentence \u201cYou attempt to read the input as a raw binary representation of the value\u201d is confusing and may be hard for a learner to interpret. First, it presumes to assert something about the OP\u2019s intent regarding what they are attempting. It is really trying to be a sentence about how the <code>read</code> routine behaves, and it ought to be phrased that way, not as an assertion about what the OP is doing. That phrasing may leave them confused and not even understand the sentence is about the <code>read</code> call."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566389614, "post_id": 57589166, "comment_id": 101639965, "body": "Second, there is no such thing as a \u201craw binary representation\u201d of a floating-point value. Floating-point necessarily has some form of encoding other than binary. It must\u2014it has a sign, a significand, and an exponent, so its representation must be partitioned into fields, at least; it cannot be represented as a binary numeral. More than that, those fields are not pure binary even individually. <code>read</code> will read bytes without interpreting them into an object. It reads the bytes that represent an object."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1566503041, "post_id": 57589166, "comment_id": 101687181, "body": "Normally, binary representation of floating point data is universally following the IEEE-752 format for floating point  numbers.  This is normally the format used to <code>write(2)</code> the data stored in a floating point variable (with the bytes in <i>big endian</i> or <i>little endian</i> order --if can be so called for a floating point number-- depending on the architecture) this is the raw binary representation I thing that Some programmer dude means."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 1, "creation_date": 1566504312, "post_id": 57589166, "comment_id": 101687685, "body": "@SomeProgrammerDude, using <code>0</code> for stdin is a legacy from ancient unix, and still there&#39;s a lot of code that uses it.  Unfortunately, <code>STDIN_FILENO</code> is a recommendation of POSIX, that is only followed by POSIX. Neither OS/F, SYSVID, nor any original UNIX(tm) follows it, I&#39;m afraid, and you&#39;ll get even code that uses the macro at some places, and the integer value in others.  I&#39;m afraid that this is a dead cause.... sincerely.  Please, don&#39;t flame me for this comment, that is only a comment.  Same happens to <code>EXIT_SUCCESS</code>, <code>EXIT_FAILURE</code> and many of the constants defined by posix."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566509325, "post_id": 57589166, "comment_id": 101689397, "body": "@EricPostpischil comments are not meant for answers. If you&#39;ve got a better answer then please do write one."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1566526857, "post_id": 57589166, "comment_id": 101692736, "body": "@AnttiHaapala: My comments do not contain an answer. They contain comments on how to improve this answer."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1566382246, "last_edit_date": 1566382246, "creation_date": 1566381869, "answer_id": 57589166, "question_id": 57589047, "link": "https://stackoverflow.com/questions/57589047/read-a-double-number-from-stdin-with-c-read/57589166#57589166", "title": "Read a double number from stdin, with C read()", "body": "<p>Input on standard input (please use <code>STDIN_FILENO</code> instead of the \"magic number\" <code>0</code>) is usually <strong><em>text</em></strong>.</p>\n\n<p>You attempt to read the input as a raw binary representation of the value.</p>\n\n<p>Unless you <em>know</em> that the input will be in raw binary form (for example from redirection of a binary file or from a pipe where the other end is writing raw binary data) I suggest you read into a character buffer, make sure the buffer is null-terminated (you have to do it yourself, the position is what <code>read</code> return if successful), and use e.g. <code>sscanf</code> or <a href=\"https://en.cppreference.com/w/cpp/string/byte/strtof\" rel=\"nofollow noreferrer\"><code>strtod</code></a> to convert the string.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1566504013, "creation_date": 1566504013, "answer_id": 57616320, "question_id": 57589047, "link": "https://stackoverflow.com/questions/57589047/read-a-double-number-from-stdin-with-c-read/57616320#57616320", "title": "Read a double number from stdin, with C read()", "body": "<p>As the manual says, <em>attempts to read up to count bytes from file descriptor fd</em> and that means for a <code>double</code> for example to read <code>sizeof (double)</code> bytes with the internal format representation of a <code>double</code> value.  As it says it reads bytes, those bytes can be generated by a corresponding <code>write(2)</code> of a <code>double</code> value, but are only understandable by the machine, so entering <code>24.2</code> is not valid, as that is a string representation of a number in ascii decimal form.</p>\n\n<p>There's a standard binary representation for internal use on extended use, described in the IEEE-752 standard.  It describes internal binary format representations for <code>float</code>, <code>double</code> and <em>extended long doubles</em> (128bit representation of a floating point number, normally not used in current architectures, but only a small set)  If you know it, probably you can produce the exact representation needed to be able to input correctly a specific number.  You should read that document in order to understand why the sequence of chars <code>2</code>, <code>4</code>, <code>.</code>, <code>2</code>, that form the string <code>24.2</code> is not the same as the internal binary representation of that number, which is what is written by <code>write(2)</code>.</p>\n\n<p>Try to <code>write(2)</code> that first, with:</p>\n\n<pre><code>double number = 3.1415926535897932;\nwrite(1, &amp;number, sizeof number);\n</code></pre>\n\n<p>and see what happens in your output.  Next try to filter up with a hex reader, as in</p>\n\n<pre><code>$ new_program | hd\n</code></pre>\n\n<p>and you'll see the exact values of the bytes that pi produces.  Then, try to feed that to your original program, as in</p>\n\n<pre><code>$ new_program | your_original_program\n</code></pre>\n\n<p>and print them again with</p>\n\n<pre><code>read(0, &amp;my_double, sizeof my_double);\nprintf(\"%g\", my_double);\n</code></pre>\n\n<p>you'll see that what was read is what you wrote, but the binary representation of a <code>double</code> value is, in general, misunderstandable for humans (well, there's people so used to binary that understand hex dumps up to this level, but I'm not one of them)</p>\n"}], "owner": {"reputation": 8116, "user_id": 815653, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a2beceb77bdda94b8097c2c21f615442?s=128&d=identicon&r=PG", "display_name": "zell", "link": "https://stackoverflow.com/users/815653/zell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1566504013, "creation_date": 1566381480, "last_edit_date": 1566381860, "question_id": 57589047, "link": "https://stackoverflow.com/questions/57589047/read-a-double-number-from-stdin-with-c-read", "title": "Read a double number from stdin, with C read()", "body": "<p>According to the Linux <a href=\"https://linux.die.net/man/2/read\" rel=\"nofollow noreferrer\">manual</a>, </p>\n\n<pre><code>#include &lt;unistd.h&gt;\nssize_t read(int fd, void *buf, size_t count);\n</code></pre>\n\n<p>attempts to read up to count bytes from file descriptor fd into the buffer starting at buf.</p>\n\n<p>I am writing a C program that uses \"read\" (instead of scanf) to read a double from stdin. Below is what I get. I typed inputs such as 42.0, 47.9, etc from the console. It turns out that the program produces random outputs. Can anyone help?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(){\n    double x;\n    read(0, &amp;x, sizeof(x));\n    printf (\"Results = %g\\n\", x);\n}\n</code></pre>\n"}, {"tags": ["c", "compilation"], "comments": [{"owner": {"reputation": 3880, "user_id": 5328289, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e0e88b500a567f9572d0f8fe4e99405?s=128&d=identicon&r=PG&f=1", "display_name": "M.E.", "link": "https://stackoverflow.com/users/5328289/m-e"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1566380868, "post_id": 57588712, "comment_id": 101635212, "body": "I am editing the question to include a whole example that fails together with the compiling error. According to my calculation the array takes more than 200Mb."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1566381066, "post_id": 57588712, "comment_id": 101635329, "body": "Yes, it takes up 171,417,600 bytes of memory (assuming 32-bit <code>int</code>s) which will be allocated in the process&#39;s global data space. That shouldn&#39;t be too excessive, even on a 32-bit system."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1566381272, "post_id": 57588712, "comment_id": 101635457, "body": "Looks like a bug in the linker. Is there any reason you use the Digital Mars compiler rather than e.g gcc?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566381279, "post_id": 57588712, "comment_id": 101635460, "body": "With the edited question, it now takes up 214,272,000 bytes."}, {"owner": {"reputation": 3880, "user_id": 5328289, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e0e88b500a567f9572d0f8fe4e99405?s=128&d=identicon&r=PG&f=1", "display_name": "M.E.", "link": "https://stackoverflow.com/users/5328289/m-e"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1566381344, "post_id": 57588712, "comment_id": 101635491, "body": "@jabberwocky I am trying to use a lightweight compiler instead of gcc, do not have too much space on the netbook I use for this task."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1566381419, "post_id": 57588712, "comment_id": 101635532, "body": "<code>struct struct_tpo_line  array1[10000];</code> is a huge for a local variable. Try <code>static struct struct_tpo_line  array1[10000];</code>, or declare it as global variable. Same thing for <code>struct struct_bar  bar;</code>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566381646, "post_id": 57588712, "comment_id": 101635663, "body": "You may have better luck allocating space for those huge objects with <code>malloc</code> or <code>calloc</code>."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1566389852, "post_id": 57588712, "comment_id": 101640100, "body": "Is it an option for you to simply  <i><a href=\"https://digitalmars.com/ctg/ctgCompilingCode.html\" rel=\"nofollow noreferrer\">change your stack size?</a></i>.  ( Look about half way down on the linked page. )  I did this on my system and your sample program worked just as you have shown it without edits.  (I am not recommending disregarding the other suggestions, just offering a new one.)"}, {"owner": {"reputation": 3880, "user_id": 5328289, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e0e88b500a567f9572d0f8fe4e99405?s=128&d=identicon&r=PG&f=1", "display_name": "M.E.", "link": "https://stackoverflow.com/users/5328289/m-e"}, "edited": false, "score": 0, "creation_date": 1566427730, "post_id": 57588712, "comment_id": 101657286, "body": "Just in case it helps someone, issue was not related to large local variable and a stack overflow (as marked by the duplicated). Moving the variable to the global area did not solve the issue. It seems a linker error as pointed in the comments.Using another compiler (Pelles C) fixed the issue."}], "answers": [{"comments": [{"owner": {"reputation": 3880, "user_id": 5328289, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e0e88b500a567f9572d0f8fe4e99405?s=128&d=identicon&r=PG&f=1", "display_name": "M.E.", "link": "https://stackoverflow.com/users/5328289/m-e"}, "edited": false, "score": 0, "creation_date": 1566381836, "post_id": 57589131, "comment_id": 101635790, "body": "Thanks for the advice, it does not fix the compiling issue though. (I am trying Pelles C compiler now)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 3880, "user_id": 5328289, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e0e88b500a567f9572d0f8fe4e99405?s=128&d=identicon&r=PG&f=1", "display_name": "M.E.", "link": "https://stackoverflow.com/users/5328289/m-e"}, "edited": false, "score": 0, "creation_date": 1566381956, "post_id": 57589131, "comment_id": 101635861, "body": "@M.E. looks like a compiler/linker bug to me then. Your original code should compile correctly, but it is expected to fail at run time."}, {"owner": {"reputation": 3880, "user_id": 5328289, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e0e88b500a567f9572d0f8fe4e99405?s=128&d=identicon&r=PG&f=1", "display_name": "M.E.", "link": "https://stackoverflow.com/users/5328289/m-e"}, "edited": false, "score": 0, "creation_date": 1566382344, "post_id": 57589131, "comment_id": 101636084, "body": "I downloaded Pelles C (more lightweight than the whole GCC) and it compiles fine. I used static for the large local array. Thanks for checking the code, it helped."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 1, "last_activity_date": 1566381887, "last_edit_date": 1566381887, "creation_date": 1566381730, "answer_id": 57589131, "question_id": 57588712, "link": "https://stackoverflow.com/questions/57588712/compilation-error-while-using-array-of-structs-in-c-using-digital-mars-compiler/57589131#57589131", "title": "Compilation error while using array of structs in C using Digital Mars compiler", "body": "<p>Your local variables are too big. Usually local variables are alloocated on the stack and the default stack space of a process is 1Mb on Windows and 8Mb on Linux.</p>\n\n<p>Declare them as global variables or as static variables:</p>\n\n<pre><code>...\nint main() {    \n    char filename[255];\n    static struct struct_bar           bar;\n    static struct struct_tpo_line      array1[10000];\n    ...\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>...\nstruct struct_bar           bar;\nstruct struct_tpo_line      array1[10000];\n\nint main() {    \n    char filename[255];\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 3880, "user_id": 5328289, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e0e88b500a567f9572d0f8fe4e99405?s=128&d=identicon&r=PG&f=1", "display_name": "M.E.", "link": "https://stackoverflow.com/users/5328289/m-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "closed_date": 1566387730, "accepted_answer_id": 57589131, "answer_count": 1, "score": 1, "last_activity_date": 1566399912, "creation_date": 1566380321, "last_edit_date": 1566399912, "question_id": 57588712, "link": "https://stackoverflow.com/questions/57588712/compilation-error-while-using-array-of-structs-in-c-using-digital-mars-compiler", "closed_reason": "Duplicate", "title": "Compilation error while using array of structs in C using Digital Mars compiler", "body": "<p>I have the following code in C which fails on compilation. I think I am missing something about the way array of structs work or about memory models or something else I am not aware of it.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\n#define BASE_YEAR 2013\n\nstruct struct_tpo_line {\n    int price;\n    char tpo_list[255];\n    int tpo_count;\n};\n\nstruct struct_bar {\n    unsigned int open;\n    unsigned int high;\n    unsigned int low;\n    unsigned int close;\n    unsigned int flags_volume;  \n};\n\nstruct struct_bar data[20][12][31][24][60];\n\nmain() {\n\n    char                        filename[255];\n    struct struct_bar           bar;\n    struct struct_tpo_line      array1[10000];\n\n    printf(\"20030101 193200;1.048400;1.048500;1.048300;1.048500;0\\n\");\n    bar = data[2013 - BASE_YEAR][1 - 1][1 - 1][19][32];\n    printf(\"%d %d %d %d\\n\", bar.open, bar.high, bar.low, bar.close);\n\n    printf(\"Hello World.\\n\");\n}\n</code></pre>\n\n<p>I try to compile it under Windows 10 32 bits Home using Digital Mars C compiler and I get:</p>\n\n<pre><code>C:\\Users\\...\\DATA&gt;dmc test2.c -o test2.exe\nlink test2,test2,,user32+kernel32/noi;\n</code></pre>\n\n<p>And the following popup:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mwQYS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mwQYS.png\" alt=\"Errormsg\"></a></p>\n\n<p>I was previously using PCC compiler but I changed to Digital Mars as I thought it might be compiler-related issue.</p>\n"}, {"tags": ["c", "sockets", "udp"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1566382244, "post_id": 57588099, "comment_id": 101636020, "body": "Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal, complete, and verifiable example</a>.  From what you&#39;ve posted, you&#39;ll only get guesses.  You haven&#39;t even established that you really are receiving just 24 bytes of data and not the entire 116 bytes.  For that matter, you haven&#39;t even established from the posted code that you&#39;re sending 116-byte packets."}], "answers": [{"comments": [{"owner": {"reputation": 310, "user_id": 6612018, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3473d948039560d8d4ca42c9de7b382?s=128&d=identicon&r=PG&f=1", "display_name": "Athul Sukumaran", "link": "https://stackoverflow.com/users/6612018/athul-sukumaran"}, "edited": false, "score": 0, "creation_date": 1566381279, "post_id": 57588374, "comment_id": 101635459, "body": "Thanks David. I made both the changes. But still issue is observed"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 310, "user_id": 6612018, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3473d948039560d8d4ca42c9de7b382?s=128&d=identicon&r=PG&f=1", "display_name": "Athul Sukumaran", "link": "https://stackoverflow.com/users/6612018/athul-sukumaran"}, "edited": false, "score": 0, "creation_date": 1566431307, "post_id": 57588374, "comment_id": 101658029, "body": "@AthulSukumaran then you are doing something else wrong that we can&#39;t see.  Please edit your question to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, including the actual definitions of <code>DISC_REQ_SIZE</code> and <code>BUFSIZE</code>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1566431380, "post_id": 57588374, "comment_id": 101658043, "body": "@David there is no need to use <code>memset()</code>/<code>bzero()</code> at all, if you simply don&#39;t exceed the length that <code>recvfrom()</code> returns when using the <code>buffer</code> after reading it."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 1, "last_activity_date": 1566380362, "last_edit_date": 1566380362, "creation_date": 1566379214, "answer_id": 57588374, "question_id": 57588099, "link": "https://stackoverflow.com/questions/57588099/recvfrom-doesnt-receive-complete-buffer/57588374#57588374", "title": "recvfrom() doesn&#39;t receive complete buffer", "body": "<p>The third parameter of <code>recvfrom</code> (length) wants the length of the buffer in bytes but you are passing the number of elements.</p>\n\n<p>Try changing</p>\n\n<pre><code>n = recvfrom(sockfd, buffer, BUFSIZE, ...\n</code></pre>\n\n<p>to</p>\n\n<pre><code>n = recvfrom(sockfd, buffer, sizeof buffer, ...\n</code></pre>\n\n<p>Also, on modern systems do not use <code>bzero</code> (is deprecated), instead:</p>\n\n<pre><code>memset(buffer, 0, sizeof buffer);\n</code></pre>\n"}], "owner": {"reputation": 310, "user_id": 6612018, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3473d948039560d8d4ca42c9de7b382?s=128&d=identicon&r=PG&f=1", "display_name": "Athul Sukumaran", "link": "https://stackoverflow.com/users/6612018/athul-sukumaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1566380362, "creation_date": 1566378281, "question_id": 57588099, "link": "https://stackoverflow.com/questions/57588099/recvfrom-doesnt-receive-complete-buffer", "title": "recvfrom() doesn&#39;t receive complete buffer", "body": "<p>In a client-server architecture based setup, my client sends data over UDP socket which is of size 116 bytes. But on the server side, the program receives only 24 bytes. Any help is appreciated.</p>\n\n<p>I tried capturing the packet using wireshark. But the packet looks to be intact. But on the server(receiving) side buffer data is lost. I suspect somrthing is wrong with my recvfrom()</p>\n\n<pre><code>//Client sends data\nuint32_t final_cmd[DISC_REQ_SIZE] = {0};\n..\n..\nn = sendto(sockfd, (const char *) final_cmd, sizeof(final_cmd), 0,\n            (struct sockaddr *) &amp;serveraddr, ser_len);\n\n\n//Server receives data\nuint32_t buffer[BUFSIZE];\n..\n..\nwhile(1)\n{\n    bzero(buffer, BUFSIZE);\n    n = recvfrom(sockfd, buffer, BUFSIZE, \n            0, ( struct sockaddr *) &amp;cliaddr, \n            &amp;len); \n..\n..\n</code></pre>\n\n<p>Expected result : Sever receives complete 116 B of data\nActual result : Server receives only 24 B of data</p>\n"}, {"tags": ["c", "sockets", "zeromq"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1566837778, "post_id": 57588005, "comment_id": 101772620, "body": "ZMQ is essentially a message queue implementation. If that&#39;s not what you want/need then why not stick with plain sockets?"}, {"owner": {"reputation": 25, "user_id": 11955930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8747ae1ed58c78b559e52bf9bbdefb63?s=128&d=identicon&r=PG&f=1", "display_name": "McPhie", "link": "https://stackoverflow.com/users/11955930/mcphie"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1567171651, "post_id": 57588005, "comment_id": 101895430, "body": "The current implementation does use plain sockets. The reason I am looking at adapting to use 0MQ is to allow it to cope with large queues of compute nodes waiting to attest with an SGX enclave. The enclave is not thread safe so currently it can only deal with one client at a time leading to a queue forming. When I get to around 200 compute node processes with the current system things start to time out and some nodes fail to attest leading to the whole job failing.  When I Googled dealing with large queues 0MQ came up hence my desire to see if I could easily swap it in for a standard socket"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11955930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8747ae1ed58c78b559e52bf9bbdefb63?s=128&d=identicon&r=PG&f=1", "display_name": "McPhie", "link": "https://stackoverflow.com/users/11955930/mcphie"}, "edited": false, "score": 0, "creation_date": 1567172905, "post_id": 57661888, "comment_id": 101896144, "body": "Thanks for your reply. I agree trying to get ZeroMQ to act just like a standard socket is far from optimal and now realise I should probably have rephrased my initial question. My end goal is to get the server to accept an initial message from a client and then exclusively talk to that client until it has attested. This involves many messages being sent back and forth. With a standard socket this is easily achieved as a new socket is created when the server accepts a client connection. Is there an approach I could implement in ZeroMQ that would give the same result?"}, {"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "reply_to_user": {"reputation": 25, "user_id": 11955930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8747ae1ed58c78b559e52bf9bbdefb63?s=128&d=identicon&r=PG&f=1", "display_name": "McPhie", "link": "https://stackoverflow.com/users/11955930/mcphie"}, "edited": false, "score": 0, "creation_date": 1567175849, "post_id": 57661888, "comment_id": 101897776, "body": "@McPhie - Welcome to the StackOverflow Community. Feel free to accept the best Answer provided and may enjoy to open another Question(s) as per further needs to investigate the problem or open a new paradigm. &quot;Creeping&quot; the topic is not a sign of fair handling the Community of Members, that have answered your original Question. StackOverflow encourages to say [Thanks] by clicking the Vote Up ( The gray triangle [This answer is useful] ) and by accepting the best one from the provided, Community sponsored, help. Putting thanks in written is polite,but not compliant with StackOverflow Netiquette"}], "tags": [], "owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "is_accepted": true, "score": 0, "last_activity_date": 1566839470, "last_edit_date": 1566839470, "creation_date": 1566837943, "answer_id": 57661888, "question_id": 57588005, "link": "https://stackoverflow.com/questions/57588005/zeromq-emulating-standard-socket-for-multiple-clients-to-one-server/57661888#57661888", "title": "ZeroMQ - Emulating standard socket for multiple clients to one server", "body": "<blockquote>\n  <p><strong>Q</strong> : <em>Is there <strong>a way</strong> I can utilise ZeroMQ <strong>to give the same behaviour</strong> in this application <strong>as a standard socket?</em></strong></p>\n</blockquote>\n\n<p>ZeroMQ is a <a href=\"https://stackoverflow.com/questions/46615141/how-to-control-the-source-ip-address-of-a-zeromq-packet-on-a-machine-with-multip/46620571#46620571\">very <strong>smart</strong> and rather <strong>behaviour-oriented</strong></a> signaling / messaging-platform for <strong><a href=\"/questions/tagged/distributed-systems\" class=\"post-tag\" title=\"show questions tagged &#39;distributed-systems&#39;\" rel=\"tag\">distributed-systems</a></strong>, not a socket.</p>\n\n<p>Given your intentions are to be worth for HPC-ecosystem, a solution postulated / directed to use some tool and a must to bend it as much as possible, so as it will become close to resemble a behaviour that is native, but for other tool, does not seem to be a typical HPC-grade approach.</p>\n\n<p>HPC-code is typically very well-crafted so as to become computing-costs-efficient ( and bless the Boss, CFO &amp; gov/mil-funding for all those, who are today permitted not to design the HPC-code for the ultimate performance and hardware-resources' use efficiency :o) ) - here, if one pays expenses on ZeroMQ instantiations, there seems no benefit to come from these non-zero costs of instantiations and getting \"just\"-a-socket-alike behaviour, at cost, has negative performance yield, without any adjustments in some future benefits from smart, cluster-wide ZeroMQ services ( be it an N+1 or N+M redundancy, low-latency smart inter-node cluster signaling, cryptography, cheap security-motivated white-listing, or anything that may represent any additional HPC-grade Project's benefit, that may justify the costs of the initial ZeroMQ instantiation ).</p>\n\n<hr>\n\n<h2>Defined archetype of <strong><code>ZMQ_STREAM</code></strong> may provide some tools, yet, ref. above</h2>\n\n<blockquote>\n  <p>A socket of type <strong><code>ZMQ_STREAM</code></strong> is used to send and receive TCP data from a non-\u00d8MQ peer, when using the <code>tcp://</code> transport. A <code>ZMQ_STREAM</code> socket can act as client and/or server, sending and/or receiving TCP data asynchronously.<br><br>\n  When receiving TCP data, a <code>ZMQ_STREAM</code> socket shall prepend a message part containing the identity of the originating peer to the message before passing it to the application. Messages received are fair-queued from among all connected peers.\n  <br><br>\n  When sending TCP data, a ZMQ_STREAM socket shall remove the first part of the message and use it to determine the identity of the peer the message shall be routed to, and unroutable messages shall cause an <code>EHOSTUNREACH</code> or <code>EAGAIN</code> error.\n  <br><br>\n  To open a connection to a server, use the <strong><code>zmq_connect</code></strong> call, and then fetch the socket identity using the <strong><code>ZMQ_IDENTITY</code></strong> <code>zmq_getsockopt</code> call.\n  <br><br>\n  To close a specific connection, send the identity frame followed by a zero-length message (see EXAMPLE section).\n  <br><br>\n  When a connection is made, a zero-length message will be received by the application. Similarly, when the peer disconnects (or the connection is lost), a zero-length message will be received by the application.\n  <br><br>\n  You must send one identity frame followed by one data frame. The <code>ZMQ_SNDMORE</code> flag is required for identity frames but is ignored on data frames.</p>\n</blockquote>\n\n<p><code>ZMQ_STREAM</code> Example:</p>\n\n<pre><code>void *ctx = zmq_ctx_new ();                          assert (ctx     &amp;&amp; \"Context Instantiation Failed...\" );\nvoid *socket = zmq_socket (ctx, ZMQ_STREAM);         assert (socket  &amp;&amp; \"socket Instantiation Failed...\" );\nint rc = zmq_bind (socket, \"tcp://*:8080\");          assert (rc == 0 &amp;&amp; \"socket.bind() Failed...\" );\nuint8_t id [256];                                 /* Data structure to hold the ZMQ_STREAM ID */\nsize_t id_size = 256;\nuint8_t raw [256];                                /* Data structure to hold the ZMQ_STREAM received data */\nsize_t raw_size = 256;\nwhile (1) {\n   id_size = zmq_recv (socket, id, 256, 0);          assert (id_size &gt; 0 &amp;&amp; \"Get HTTP request; ID frame and then request; Failed...\" )\n   do {\n        raw_size = zmq_recv (socket, raw, 256, 0);   assert (raw_size &gt;= 0 &amp;&amp; \"socket.recv() Failed...\" );\n   } while (raw_size == 256);\n\n   char http_response [] =                        /* Prepares the response */\n            \"HTTP/1.0 200 OK\\r\\n\"\n            \"Content-Type: text/plain\\r\\n\"\n            \"\\r\\n\"\n            \"Hello, World!\";\n   zmq_send (socket, id, id_size, ZMQ_SNDMORE);   /* Sends the ID frame followed by the response */\n   zmq_send (socket, http_response, strlen (http_response), 0);\n   zmq_send (socket, id, id_size, ZMQ_SNDMORE);   /* Closes the connection by sending the ID frame followed by a zero response */\n   zmq_send (socket, 0, 0, 0);\n}\nzmq_close (socket);\nzmq_ctx_destroy (ctx);\n</code></pre>\n\n<hr>\n\n<h2>ZeroMQ <code>zmq_getsockopt()</code> can deliver a POSIX/SOCKET descriptor, for low-level tricks</h2>\n\n<blockquote>\n  <p>The <strong><code>ZMQ_FD</code></strong> option shall retrieve the file descriptor associated with the specified socket. The returned file descriptor can be used to integrate the socket into an existing event loop; the \u00d8MQ library shall signal any pending events on the socket in an edge-triggered fashion by making the file descriptor become ready for reading.\n  <br><br>\n  The ability to read from the returned file descriptor does not necessarily indicate that messages are available to be read from, or can be written to, the underlying socket; applications must retrieve the actual event state with a subsequent retrieval of the <code>ZMQ_EVENTS</code> option.\n  <br><br>\n  The returned file descriptor is also used internally by the <strong><code>zmq_send</code></strong> and <strong><code>zmq_recv</code></strong> functions. As the <strong>descriptor is edge triggered, applications must update the state of <code>ZMQ_EVENTS</code> after each invocation of <code>zmq_send</code> or <code>zmq_recv</code>.</strong>\n  <br><br>\n  <strong>To be more explicit:</strong> after calling zmq_send the socket may become readable (and vice versa) without triggering a read event on the file descriptor.\n  <br><br>\n  The returned file descriptor is intended for use with a <strong><code>poll</code></strong> or similar system call <strong>only</strong>. Applications must never attempt to read or write data to it directly, neither should they try to close it.\n  <br><br>\n  Option value type:  <code>int</code> on POSIX systems, SOCKET on Windows</p>\n</blockquote>\n\n<hr>\n\n<p>For more <a href=\"https://stackoverflow.com/search?tab=votes&amp;q=user%3A3666197%20%5Bzeromq%5D\">details on ZeroMQ tricks</a> one may enjoy to read solutions, performance benchmarks, latency-shaving details and other problem-solving tricks that have already been discussed here.</p>\n"}], "owner": {"reputation": 25, "user_id": 11955930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8747ae1ed58c78b559e52bf9bbdefb63?s=128&d=identicon&r=PG&f=1", "display_name": "McPhie", "link": "https://stackoverflow.com/users/11955930/mcphie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 1, "accepted_answer_id": 57661888, "answer_count": 1, "score": 0, "last_activity_date": 1566839470, "creation_date": 1566377967, "last_edit_date": 1566837129, "question_id": 57588005, "link": "https://stackoverflow.com/questions/57588005/zeromq-emulating-standard-socket-for-multiple-clients-to-one-server", "title": "ZeroMQ - Emulating standard socket for multiple clients to one server", "body": "<p>I am hoping to utilise ZeroMQ in order to handle queuing of a large number of requests coming in at the same time to an attestation server.</p>\n\n<p>I am in an HPC environment and so have a large number of compute nodes all running the same launcher program that attests with a server. This server code runs on a front-end node and after successfully attesting the client, will then release a key in order for the client to decrypt job data. </p>\n\n<p>Currently standard sockets are used. When a client initially sends something to the server a new socket is spawned using <code>accept()</code> from <code>sys/socket.h</code>. This allows the client and server to send multiple messages between each other in the attestation process (checksums etc) before finally returning the key if successful.</p>\n\n<p>The issue with ZeroMQ is that the attach command is not necessary and so a secondary socket for that specific attestation is not created. All the messages are dealt with from all the clients in whatever order they come in, leading to the multi-part attestation process not working. I have spent ages going through the guide and googling to try and find a similar solution but have not had any luck so far.</p>\n\n<p>Is there a way I can utilise ZeroMQ to give the same behaviour in this application as a standard socket?</p>\n"}, {"tags": ["c", "bit-manipulation", "byte", "bit"], "comments": [{"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 0, "creation_date": 1566377988, "post_id": 57587943, "comment_id": 101633419, "body": "You can bitwise operators like shits (<code>&lt;&lt;</code> and  <code>&gt;&gt;</code>) and <code>$</code>. Or  you can use <i>bitfields</i>."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 0, "creation_date": 1566378137, "post_id": 57587943, "comment_id": 101633504, "body": "&quot;I can get the byte and use it without any modification right?&quot; this question is unclear to me. What you mean by &quot;get it and use it without any modification&quot;?"}, {"owner": {"reputation": 46070, "user_id": 1410664, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/vGygm.gif?s=128&g=1", "display_name": "Caius Jard", "link": "https://stackoverflow.com/users/1410664/caius-jard"}, "edited": false, "score": 2, "creation_date": 1566378332, "post_id": 57587943, "comment_id": 101633617, "body": "Huh, if you have a byte array and you want byte 2 out of it it&#39;s either <code>array[1]</code> or <code>array[2]</code> depending on what you mean by 2 (second or index 2). LSB, MSB is irrelevant because you have a byte array and you want a byte. Please read your question again and check you&#39;ve used the correct word (bit/ byte) in all places. I think you&#39;ve mixed them up"}, {"owner": {"reputation": 159, "user_id": 11841300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7831761bbc1003a0d139ac543459f6e0?s=128&d=identicon&r=PG&f=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/11841300/danny"}, "reply_to_user": {"reputation": 46070, "user_id": 1410664, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/vGygm.gif?s=128&g=1", "display_name": "Caius Jard", "link": "https://stackoverflow.com/users/1410664/caius-jard"}, "edited": false, "score": 0, "creation_date": 1566378455, "post_id": 57587943, "comment_id": 101633696, "body": "@CaiusJard Your explanation cleared a part of my confusion, thank you. I think I have written my question correctly. Which part you mean?"}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 0, "creation_date": 1566378459, "post_id": 57587943, "comment_id": 101633699, "body": "@Dennis.M the first question is still very unclear and confusing..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566378630, "post_id": 57587943, "comment_id": 101633804, "body": "Note that LSB means least significant <i>bit</i>, not byte. Byte order (endianess) only matters in case you try to serialize integers or floats. Otherwise index 0 of a byte array is always the least significant. To mask out bits from a byte, simply use the bitwise operators as advised by your C book."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1566378663, "post_id": 57587943, "comment_id": 101633815, "body": "More info: <a href=\"https://stackoverflow.com/questions/47981/how-do-you-set-clear-and-toggle-a-single-bit\">How do you set, clear, and toggle a single bit?</a>"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566378826, "post_id": 57587943, "comment_id": 101633913, "body": "@Lundin Actually, LSB is ambiguous, can stand for <a href=\"https://en.wikipedia.org/wiki/Bit_numbering#Least_significant_byte\" rel=\"nofollow noreferrer\">both</a>..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1566378959, "post_id": 57587943, "comment_id": 101633980, "body": "@Aconcagua No, the de facto industry standard meaning is bit. The wikipedia source used in that link is some hobbyist&#39;s trash site."}, {"owner": {"reputation": 159, "user_id": 11841300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7831761bbc1003a0d139ac543459f6e0?s=128&d=identicon&r=PG&f=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/11841300/danny"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566379307, "post_id": 57587943, "comment_id": 101634198, "body": "@Lundin Get 2 bits from a byte is <code>first_2bits = (num &gt;&gt; 6) &amp; 0xFF;</code>. Am I right?"}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 0, "creation_date": 1566379492, "post_id": 57587943, "comment_id": 101634311, "body": "@Dennis.M considering <code>num</code> is a 8 bit value and you mean by first 2 bits the most significant bits, yes."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566379583, "post_id": 57587943, "comment_id": 101634368, "body": "@Dennis.M That code gives you the 2 most significant bits, bit number 6 and 7."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566379612, "post_id": 57587943, "comment_id": 101634392, "body": "@Lundin Any reference for? Have seen counter examples, although not having one by hand at the moment..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1566379859, "post_id": 57587943, "comment_id": 101634550, "body": "@Dennis.M <code>(num &gt;&gt; 6) &amp; 0xff</code> might give you unexpected results, if <code>char</code> is signed on your system and most significant bit is set; <code>num</code> will be promoted to <code>int</code>, but sign extension occurs, and if right shift is arithmitic shift (usually for signed values), you&#39;ll end up in having ones at bit locations 2, 3, ... , 7. If you don&#39;t want these, you&#39;d have <code>(num &gt;&gt; 6) &amp; 0x03</code>."}, {"owner": {"reputation": 159, "user_id": 11841300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7831761bbc1003a0d139ac543459f6e0?s=128&d=identicon&r=PG&f=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/11841300/danny"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566379940, "post_id": 57587943, "comment_id": 101634606, "body": "@Lundin That will give the most significant bits, if the bit order is most significant bit. If the bit order is least significant bit, it will give the 2 least significant bits. Is my understanding correct?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1566380075, "post_id": 57587943, "comment_id": 101634705, "body": "@Dennis.M There only exists one bit order on all computers. Bit 7 is always the MSB."}, {"owner": {"reputation": 159, "user_id": 11841300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7831761bbc1003a0d139ac543459f6e0?s=128&d=identicon&r=PG&f=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/11841300/danny"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566380185, "post_id": 57587943, "comment_id": 101634785, "body": "@Lundin Then why there is <code>Most Significant Bits</code> and <code>Least Significant Bits</code>. I didn&#39;t get."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566380356, "post_id": 57587943, "comment_id": 101634898, "body": "Because on a 16 bit word the MSB is number 15, on a 32 bit word MSB is number 31 and so on."}, {"owner": {"reputation": 159, "user_id": 11841300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7831761bbc1003a0d139ac543459f6e0?s=128&d=identicon&r=PG&f=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/11841300/danny"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566380402, "post_id": 57587943, "comment_id": 101634934, "body": "@Lundin Cleared!"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1566382071, "post_id": 57587943, "comment_id": 101635926, "body": "@Dennis.M LSB/MSB can play an important role, though, if you have protocols based on serial transmission (i. e. only one bit at a time), such as SPI, I&#178;C, 1-wire, ... If you only transmit one bit at a time, <i>then</i> you need to know if first bit transmitted is LSB or MSB!"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566379930, "post_id": 57588439, "comment_id": 101634599, "body": "There&#39;s no guarantee that &quot;bit1&quot; in your bit-field example is the LSB. Furthermore, bits are always enumerated from 0 to 7, not from 1 to 8."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566380164, "post_id": 57588439, "comment_id": 101634772, "body": "Also, <code>unsigned char</code> need not be a valid type to be used for bit-fields, it isn&#39;t guaranteed to work by the standard. Your example relies on compiler-specific extensions."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566380333, "post_id": 57588439, "comment_id": 101634882, "body": "@Lundin I don&#39;t think if I got it. C standard doesn&#39;t rules bit-fields? Please elaborate a bit more."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566383611, "post_id": 57588439, "comment_id": 101636753, "body": "@Lundin so if I understood well I could use <code>st_foo</code> to be treated as a 8 bit value but could not count on the bit ordering? That means any code that relies on bit-field structures are implementation-specific?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1566383762, "post_id": 57588439, "comment_id": 101636828, "body": "No, you can treat it as a chunk of binary, containing 3 other chunks of binary, in unspecified order. Yes, code that uses bit-fields is very implementation-specific and completely non-portable, while at the same time not offering any advantages."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566383957, "post_id": 57588439, "comment_id": 101636921, "body": "@Lundin got it, thanks for the clarification, but don&#39;t you think a code that uses bit-fields are more readable than one relying on shifts and other bitwise operators (considering the bit ordering is not important)?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1566384111, "post_id": 57588439, "comment_id": 101636997, "body": "Bitwise operations are so incredibly common that they <i>should</i> be readable to any C programmer. Long as the number of operations on a single line are kept low."}], "tags": [], "owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "is_accepted": true, "score": 2, "last_activity_date": 1566380167, "last_edit_date": 1566380167, "creation_date": 1566379398, "answer_id": 57588439, "question_id": 57587943, "link": "https://stackoverflow.com/questions/57587943/how-to-add-and-extract-bits-to-a-byte/57588439#57588439", "title": "How to add and extract bits to a byte?", "body": "<blockquote>\n  <p>First, lets say we have a byte array with the byte order as LSB. I want to get the byte 2 from this array. I can get the byte like byte[1]. Am I right?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>Second, we have a byte array with the byte order as LSB. And I want to get first 2 bits of the byte 1!. How can I get the first 2 bits from that byte? Also, how can I add a number into the first 2 bits of a byte?</p>\n</blockquote>\n\n<p>You can use the bitwise AND operator <code>&amp;</code> with the constant <code>3</code> to retrieve only the first two bits. By doing <code>num &amp; 3</code> it will realize a condition operation between each bit of <code>num</code> and <code>3</code> returning 1 as resultant bit only if both bits are 1. As <code>3</code> have only its 2 first bits set, every bit in <code>num</code> other than the first 2 will be ignored.</p>\n\n<pre><code>unsigned char foo = 47;\nunsigned char twobits = foo &amp; 3; // this will return only the value of the two bits of foo.\nunsigned char number_to_add = 78;\ntwobits &amp;= (number_to_add &amp; 3); // this will get the values of the 2 bits of number_to_add_ and then assign it to the 2 bits of variable twobits.\n</code></pre>\n\n<p>Or if you don't care of the <em>endianess</em> you can use bitfields:</p>\n\n<pre><code>struct st_foo\n{\n     unsigned char bit1 : 1;\n     unsigned char bit2 : 1;\n     unsigned char the_rest : 6;\n};\n\nstruct st_foo my_byte;\nmy_byte.bit1 = 1;\nmy_byte.bit2 = 0;\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 11841300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7831761bbc1003a0d139ac543459f6e0?s=128&d=identicon&r=PG&f=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/11841300/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 57588439, "answer_count": 1, "score": -2, "last_activity_date": 1566380167, "creation_date": 1566377768, "last_edit_date": 1566378729, "question_id": 57587943, "link": "https://stackoverflow.com/questions/57587943/how-to-add-and-extract-bits-to-a-byte", "title": "How to add and extract bits to a byte?", "body": "<p>I am trying to understand <code>bit</code> and <code>byte manipulation</code> and I have seen many examples in <code>SO</code>. Still, I have some questions regarding my understanding.</p>\n\n<p>First, lets say we have a <code>byte array</code> with the byte order as <code>Least Significant Byte</code>. I want to get the byte 2 from this array. I can get the byte like <code>byte[1]</code>. Am I right?</p>\n\n<p>Second, we have a <code>byte array</code> with the byte order as <code>Least Significant Byte</code>. And I want to get first 2 bits of the byte 1!. How can I get the first 2 bits from that byte? \nAlso, how can I add a number into the first 2 bits of a byte?</p>\n\n<p>Any help or link to understand those logics are much appreciated.</p>\n"}, {"tags": ["c", "lpc", "nxp-microcontroller"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566377413, "post_id": 57587249, "comment_id": 101633089, "body": "It looks like are attempting DMA from RAM to RAM?"}, {"owner": {"reputation": 1, "user_id": 11955534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e001861497b23d8727d8c3d3b857911b?s=128&d=identicon&r=PG&f=1", "display_name": "timkrebs", "link": "https://stackoverflow.com/users/11955534/timkrebs"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566377809, "post_id": 57587249, "comment_id": 101633317, "body": "Exactly from flash to RAM"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566377995, "post_id": 57587249, "comment_id": 101633427, "body": "CSrcAddr sounds like source address, which you set to RAM. Then you set CDestAddr to address 0x20004000. If the destination is flash, well no wonder... Unless there&#39;s something very fancy going on with this MCU, you can&#39;t program flash memory through DMA."}, {"owner": {"reputation": 1, "user_id": 11955534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e001861497b23d8727d8c3d3b857911b?s=128&d=identicon&r=PG&f=1", "display_name": "timkrebs", "link": "https://stackoverflow.com/users/11955534/timkrebs"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566380096, "post_id": 57587249, "comment_id": 101634722, "body": "But the UM mentioned a memory to memory transfer which I thought can transfer Data from flash to RAM, please stop me if I got it wrong."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566380234, "post_id": 57587249, "comment_id": 101634820, "body": "I don&#39;t know this hardware, but it does look like you are attempting to DMA data from RAM to flash, not the other way around."}, {"owner": {"reputation": 1, "user_id": 11955534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e001861497b23d8727d8c3d3b857911b?s=128&d=identicon&r=PG&f=1", "display_name": "timkrebs", "link": "https://stackoverflow.com/users/11955534/timkrebs"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566380466, "post_id": 57587249, "comment_id": 101634970, "body": "Alright thanks, I will overthink my code."}], "owner": {"reputation": 1, "user_id": 11955534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e001861497b23d8727d8c3d3b857911b?s=128&d=identicon&r=PG&f=1", "display_name": "timkrebs", "link": "https://stackoverflow.com/users/11955534/timkrebs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566375441, "creation_date": 1566375338, "last_edit_date": 1566375441, "question_id": 57587249, "link": "https://stackoverflow.com/questions/57587249/timer-triggered-gpdma-transfer-to-sram", "title": "Timer triggered GPDMA transfer to SRAM", "body": "<p>I want to transfer data from an external AD-Converter. I get parallel 11 bits which I store in an array. I wanna set up a timer triggered GPDMA transfer, that every 50ns fires a DMA stream and transfer data. After the transfer is complete, the RAM address should be incremented. </p>\n\n<p>The MCU, I work with is the LPC4088 Quickstart Board.\nThe CPU and Peripheral Clock, runs with 120Mhz</p>\n\n<p>I studied the UM of LPC4088 and already wrote some simple basic code. </p>\n\n<pre><code>\n#include \"LPC407x_8x_177x_8x.h\"\n\n#define PERIPHSRAM1           0x20004000\n\nchar adcData[11] = {1,1,1,1,1,1,1,1,1,1,1};\n\nvolatile uint32_t DMATCCOUNT = 0;\nvolatile uint32_t DMAERRCOUNT = 0;\n\n\nint main(){\n\n    uint8_t size = sizeof(adcData);\n\n    LPC_SC-&gt;PCONP |= (1 &lt;&lt; 22);                     //Power &amp; Clock  Timer2\n\n    LPC_TIM2-&gt;CTCR = (0 &lt;&lt; 0);                      //Timer Mode\n    LPC_TIM2-&gt;PR = 0;\n    LPC_TIM2-&gt;TCR = (1 &lt;&lt; 1);                       //Reset timer\n\n    LPC_TIM2-&gt;TC = 0;               \n    LPC_TIM2-&gt;MR0 = 5;                        //Match register to get 10MHz\n    LPC_TIM2-&gt;MCR = (1 &lt;&lt; 1)                        //Reset Timer\n                    |(1 &lt;&lt; 0);                   //Interrupt if MR0 matches\n    LPC_TIM2-&gt;EMR = 0x31;                 //toggle pin to check wave output\n    LPC_TIM2-&gt;TCR = (1 &lt;&lt; 1);                       //reset timer again\n\n    LPC_SC-&gt;PCONP |= (1 &lt;&lt; 29);                     //Power &amp; Clock DMA\n    LPC_GPDMACH0-&gt;CConfig = 0;                      //disable CH0\n    LPC_GPDMA-&gt;Config |= (1 &lt;&lt; 0);                  //enable DMA Controller\n    LPC_SC-&gt;DMAREQSEL = 0x010;                 //Set T2 MAT0 as DMA request\n\n    LPC_GPDMA-&gt;IntErrClr |= 0x0FF;\n    LPC_GPDMA-&gt;IntTCClear |= 0x0FF;\n\n    LPC_GPDMACH0-&gt;CDestAddr = PERIPHSRAM1;\n    LPC_GPDMACH0-&gt;CSrcAddr = (uint32_t) &amp;adcData;\n    LPC_GPDMACH0-&gt;CControl = size\n                            |(0x00 &lt;&lt; 12) //Source Burst size: 1\n                            |(0x00 &lt;&lt; 15) //Destination Burst size: 1 \n                            |(0x02 &lt;&lt; 18) //Source width:     32 bit\n                            |(0x02 &lt;&lt; 21) //Destination width:32 bit\n                            |(0x01 &lt;&lt; 26) //Source increment: enabled\n                            |(0x01 &lt;&lt; 27) //Destination increment: enabled\n                            |(0x01 &lt;&lt; 31); //TermCount interrupt enabled\n\n    LPC_GPDMACH0-&gt;CControl |= (4 &lt;&lt; 1)      //Source peripheral: Timer2 MR0\n                           |(0 &lt;&lt; 11);      //Memory to memory trasnfer\n\n    NVIC_SetVector(DMA_IRQn, (uint32_t) DMA_IRQHandler);\n    NVIC_EnableIRQ(DMA_IRQn);\n\n    LPC_GPDMACH0-&gt;CConfig |= 1;         //Enable channel\n    LPC_TIM2-&gt;IR |= 0x0FF;              //CLear all timer interrupts\n    LPC_TIM2-&gt;TCR = 0x01;               //start Timer\n\n    while(!DMATCCOUNT);                 //Wait till transfer Complete\n\n    while(1){\n\n    }\n}\n\nvoid DMA_IRQHandler(void){\n    uint32_t temp;\n    DMATCCOUNT++;\n    temp = LPC_GPDMA-&gt;IntTCStat;\n    if(temp){\n        DMATCCOUNT++;\n        LPC_GPDMA-&gt;IntTCClear |= temp;\n    }\n    temp = LPC_GPDMA-&gt;IntErrStat;\n    if(temp){\n        DMAERRCOUNT++;\n        LPC_GPDMA-&gt;IntErrClr |= temp;\n    }\n    return;\n}\n\n\nI expected data on address 0x20004000, but there is nothing. \n\nHope any of you guys could help me.\n</code></pre>\n"}, {"tags": ["c", "linux", "glib", "networkmanager"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1566373565, "post_id": 57586732, "comment_id": 101631292, "body": "When you say that you want to &quot;connect to a specific network&quot;, what you do mean by that? Do you want to use e.g. a TCP connection through a specific interface? Then you should <a href=\"http://man7.org/linux/man-pages/man2/bind.2.html\" rel=\"nofollow noreferrer\"><code>bind</code></a> to the interface, but if you do then note that any connections to addresses not routable through that interface will fail. And if you mean something else by &quot;connect to a specific network&quot; then you need to elaborate, like telling us what problem you&#39;re really trying to solve."}, {"owner": {"reputation": 579, "user_id": 5490535, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/496260983880990/picture?type=large", "display_name": "Sebastian Karlsson", "link": "https://stackoverflow.com/users/5490535/sebastian-karlsson"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566373716, "post_id": 57586732, "comment_id": 101631358, "body": "@Someprogrammerdude Well, I want the machine to connect to a wifi and use that wifi to be able to access the internet"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1566373802, "post_id": 57586732, "comment_id": 101631392, "body": "<code>system(&quot;nmcli connection up wifi&quot;)</code>? <a href=\"https://developer.gnome.org/libnm/stable/NMClient.html\" rel=\"nofollow noreferrer\">reference</a> if you want."}], "answers": [{"tags": [], "owner": {"reputation": 371, "user_id": 8596999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/595f98020f985780afcce080519abfd6?s=128&d=identicon&r=PG&f=1", "display_name": "ChauhanTs", "link": "https://stackoverflow.com/users/8596999/chauhants"}, "is_accepted": true, "score": 1, "last_activity_date": 1566374021, "creation_date": 1566374021, "answer_id": 57586904, "question_id": 57586732, "link": "https://stackoverflow.com/questions/57586732/connect-to-wifi-from-c-program/57586904#57586904", "title": "Connect to WIFI from C program", "body": "<p>You can use the following API</p>\n\n<pre><code>void\nnm_client_activate_connection (NMClient *client,\n                               NMConnection *connection,\n                               NMDevice *device,\n                               const char *specific_object,\n                               NMClientActivateFn callback,\n                               gpointer user_data);\n</code></pre>\n\n<p>details of each input parameters are described here</p>\n\n<p><a href=\"https://developer.gnome.org/libnm-glib/stable/NMClient.html#nm-client-activate-connection\" rel=\"nofollow noreferrer\">https://developer.gnome.org/libnm-glib/stable/NMClient.html#nm-client-activate-connection</a></p>\n"}], "owner": {"reputation": 579, "user_id": 5490535, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/496260983880990/picture?type=large", "display_name": "Sebastian Karlsson", "link": "https://stackoverflow.com/users/5490535/sebastian-karlsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1924, "favorite_count": 0, "closed_date": 1566378878, "accepted_answer_id": 57586904, "answer_count": 1, "score": 0, "last_activity_date": 1566374021, "creation_date": 1566373279, "question_id": 57586732, "link": "https://stackoverflow.com/questions/57586732/connect-to-wifi-from-c-program", "closed_reason": "Needs details or clarity", "title": "Connect to WIFI from C program", "body": "<p>I am using these libraries at the moment to list available networks:</p>\n\n<pre><code>#include &lt;glib.h&gt;\n#include &lt;NetworkManager.h&gt;\n</code></pre>\n\n<p>(which works fine by the way)</p>\n\n<p>Now my question is, how do I connect to a specific network from my C program?\nI can't seem to find any good documentation or examples for it.</p>\n\n<p>What I did find was this: <a href=\"https://cgit.freedesktop.org/NetworkManager/NetworkManager/tree/examples/C/glib/add-connection-libnm.c\" rel=\"nofollow noreferrer\">https://cgit.freedesktop.org/NetworkManager/NetworkManager/tree/examples/C/glib/add-connection-libnm.c</a></p>\n\n<p>But it does not suggest a way to actually connect to the added network.\nAnd also, if it matters; this code will be running on a Linux machine without a display so I'm not looking for anything that requires a graphical application.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "enums", "gcc-warning", "fail-fast-fail-early"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1566370621, "post_id": 57586004, "comment_id": 101629918, "body": "The reliable and portable solution is to add a default.  It can do <code>assert(0); abort();</code> so that it fails even if assertions are inhibited \u2014 or you can do something more sensible if you prefer."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566370630, "post_id": 57586004, "comment_id": 101629922, "body": "There are pragmas you can use to enable or disable warnings from within source files. As the flags it should be noted that these pragmas are compiler-dependent and non-portable. See <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html\" rel=\"nofollow noreferrer\">the diagnostic pragmas section</a> of the documentation for details."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566373200, "post_id": 57586004, "comment_id": 101631090, "body": "Are the enums always adjacent values like in your example? If so, there&#39;s much better solutions to the problem than gcc extensions."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1566371723, "last_edit_date": 1566371723, "creation_date": 1566371218, "answer_id": 57586223, "question_id": 57586004, "link": "https://stackoverflow.com/questions/57586004/c-how-can-i-fail-to-compile-when-wswitch-is-off/57586223#57586223", "title": "C: how can I fail to compile when -Wswitch is off?", "body": "<p>The reliable and portable solution is to add a <code>default</code> label to your <code>switch</code> statement. It can do:</p>\n\n<pre><code>default:\n    assert(0);\n    abort();\n</code></pre>\n\n<p>so that it fails even if assertions are inhibited \u2014 or you can do something more sensible if you prefer.</p>\n\n<p>If you're using GCC, you can use <a href=\"https://gcc.gnu.org/onlinedocs/gcc-9.2.0/gcc/Diagnostic-Pragmas.html#Diagnostic-Pragmas\" rel=\"nofollow noreferrer\">diagnostic pragmas</a> to get the required result of turning on <code>-Wswitch</code> for a short scope.</p>\n\n<pre><code>#ifdef __GNUC__\n#pragma GCC diagnostic push\n#pragma GCC diagnostic error \"-Wswitch\"\n#endif /* __GNUC__ */\n\nswitch (e)\n{\n\u2026\n}\n\n#ifdef __GNUC__\n#pragma GCC diagnostic pop\n#endif /* __GNUC__ */\n</code></pre>\n\n<p>This pushes the diagnostic state, changes it to add errors as if <code>-Wswitch</code> is specified on the command line, compiles the <code>switch</code> statement, and then pops (restores) the saved diagnostic state.</p>\n\n<p>If you never use a compiler other than GCC (or perhaps Clang), you can omit the <code>__GNUC__</code> tests.  However, compilers on other platforms (e.g. IBM XLC 13.1.3 on AIX 7.2) complain about the GCC-specific pragmas, even though the <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.10.6\" rel=\"nofollow noreferrer\">C standard</a> says it shouldn't.  You pays your money and takes your pick.</p>\n\n<p>You can use <code>ignore</code> or <code>warning</code> instead of <code>error</code> to achieve other effects if you prefer.</p>\n\n<p>You might also note that the <code>-Wswitch</code> option is one of the warnings enabled by <a href=\"https://gcc.gnu.org/onlinedocs/gcc-9.2.0/gcc/Warning-Options.html#Warning-Options\" rel=\"nofollow noreferrer\"><code>-Wall</code></a> \u2014 and if you're compiling with GCC, you should always be using <code>-Wall</code> (and <code>-Wextra</code> and <code>-Werror</code>), so you should never run into problems.</p>\n\n<p>Also, the correctness of your program depends on how you wrote it (or modified it), not on the compiler options.  What does depend on the compiler options is whether or not the mitsakes you've made are spotted by the compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1566374089, "creation_date": 1566374089, "answer_id": 57586918, "question_id": 57586004, "link": "https://stackoverflow.com/questions/57586004/c-how-can-i-fail-to-compile-when-wswitch-is-off/57586918#57586918", "title": "C: how can I fail to compile when -Wswitch is off?", "body": "<p>Assuming that the enum only contains adjacent numbers like in your example, then you can \"unroll\" the switch statement by replacing it with a table of function pointers, which is fairly common practice. A function pointer table would be pure standard C. Example:</p>\n\n<pre><code>typedef enum \n{ \n  e1, \n  e2, \n  e3,\n  eN  // enum counter\n} e_t;\n\ntypedef void e_func_t (void);\n\ne_func_t* const do_stuff [] =   // array of functions of type void f(void);\n{\n  e1_stuff, \n  e2_stuff,\n  e3_stuff,\n};\n\n// force compilation error if missing a \"case statement\":\n_Static_assert(sizeof(do_stuff)/sizeof(*do_stuff) == eN, \n               \"Function pointer table incomplete.\");\n</code></pre>\n\n<p>Then you can replace the whole switch with this:</p>\n\n<pre><code>if(e &lt; e1 || e &gt;= eN)\n{  \n  /* handle errors or \"default\" here */ \n}\nelse\n{\n  do_stuff[e]();\n}\n</code></pre>\n"}], "owner": {"reputation": 38108, "user_id": 6610, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/635c3ea0c7b8c37ef45744b6e66dd263?s=128&d=identicon&r=PG", "display_name": "xtofl", "link": "https://stackoverflow.com/users/6610/xtofl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 1, "accepted_answer_id": 57586223, "answer_count": 2, "score": 2, "last_activity_date": 1566374089, "creation_date": 1566370450, "question_id": 57586004, "link": "https://stackoverflow.com/questions/57586004/c-how-can-i-fail-to-compile-when-wswitch-is-off", "title": "C: how can I fail to compile when -Wswitch is off?", "body": "<p>If I want my <code>switch(an_enum)</code> statement to be reported when it misses an enum case, I can turn on the <code>-Wswitch</code> compiler flag (<a href=\"https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html\" rel=\"nofollow noreferrer\">on gcc</a>).</p>\n\n<pre><code>enum E { e1, e2, e3 };\n\n...\nswitch(e) {\n  case e1: ...\n  case e2: ...\n  // NO default: checked by -Wswitch and -Werror\n}\n</code></pre>\n\n<p>It works nicely: \"error: enumeration value \u2018e3\u2019 not handled in switch [-Werror=switch]\"</p>\n\n<p>But now the correctness of my code depends on the compiler flags in use, which is kind of brittle.</p>\n\n<p>Something like this:</p>\n\n<pre><code>switch(e) __attribute__((exhaustive))\n{\n  ...\n}\n</code></pre>\n\n<p>Is there a way I can have that piece of code fail if the <code>-Wswitch</code> flag is off?  Or temporarily switch it on within the code?</p>\n"}, {"tags": ["c", "parallel-processing", "opencl", "gpgpu"], "comments": [{"owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1566378264, "post_id": 57584992, "comment_id": 101633572, "body": "You&#39;ll need to be a bit clearer in your question. (1) The OpenCL <b>compiler</b> will normally always run on the CPU. It&#39;s the <b>kernel</b> that will run on the GPU. (2) Your process won&#39;t suddenly have 0% CPU utilisation just because you are running some OpenCL kernels on the GPU. Please clarify what you are measuring, and what you are expecting."}, {"owner": {"reputation": 3, "user_id": 8486735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aae0d489585a06585c49f95ccd1eefc8?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Pavan", "link": "https://stackoverflow.com/users/8486735/sai-pavan"}, "reply_to_user": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1566382548, "post_id": 57584992, "comment_id": 101636197, "body": "kernel function is there but my kernel is using cpu and not my gpu. My GPU is at 0% utilisation, i want it to run the kernel function."}, {"owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1566386249, "post_id": 57584992, "comment_id": 101638153, "body": "What kind of kernel is this? If it\u2019s trivial, you might just be spending lots of time moving data back and forth, and your implementation might not be counting that towards \u201cGPU utilisation\u201d. Also, does the kernel run for long enough to make a dent in the stats?"}], "owner": {"reputation": 3, "user_id": 8486735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aae0d489585a06585c49f95ccd1eefc8?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Pavan", "link": "https://stackoverflow.com/users/8486735/sai-pavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566365448, "creation_date": 1566365448, "question_id": 57584992, "link": "https://stackoverflow.com/questions/57584992/not-able-to-figure-out-how-to-compile-kernel-code-on-gpu-instead-of-cpu-using-op", "title": "Not able to figure out how to compile kernel code on GPU instead of CPU using OpenCL", "body": "<p>I'm a beginner in coding in OpenCL. I was trying to compile some sample code I got off the internet on my GPU using OpenCL. Although I'm using <code>CL_DEVICE_TYPE_GPU</code> tag, the kernel code is still getting compiled in the CPU, as shown by the task manager. (<a href=\"https://imgur.com/9vDZr79\" rel=\"nofollow noreferrer\">https://imgur.com/9vDZr79</a>).\nPlease guide me in this regard</p>\n\n<pre><code>    // Get platform and device information\n    cl_platform_id platform_id = NULL;\n    cl_device_id device_id = NULL;\n    cl_uint ret_num_devices;\n    cl_uint ret_num_platforms;\n    cl_int ret = clGetPlatformIDs(1, &amp;platform_id, &amp;ret_num_platforms);\n    ret = clGetDeviceIDs(platform_id, CL_DEVICE_TYPE_GPU, 1, &amp;device_id, &amp;ret_num_devices);\n    //printf(\"no of devices %d\", ret_num_devices);\n\n    // Create an OpenCL context\n    cl_context context = clCreateContext(NULL, 1, &amp;device_id, NULL, NULL, &amp;ret);\n\n    // Create a command queue\n    cl_command_queue command_queue = clCreateCommandQueue(context, device_id, 0, &amp;ret);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 33, "user_id": 11785222, "user_type": "registered", "profile_image": "https://graph.facebook.com/1387375861415651/picture?type=large", "display_name": "J \ua9fe", "link": "https://stackoverflow.com/users/11785222/j-%ea%a7%be"}, "edited": false, "score": 2, "creation_date": 1566365591, "post_id": 57584925, "comment_id": 101628029, "body": "@KenY-N , It is what I did too, sir. But the teacher didn&#39;&#39;t accept that code. For me, it seems impossible."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 2, "creation_date": 1566365647, "post_id": 57584925, "comment_id": 101628051, "body": "run your loop twice. First pick odd numbers then even numbers."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1566366963, "post_id": 57584925, "comment_id": 101628470, "body": "I assume writing to strings would be cheating as they&#39;re character arrays."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1566367000, "post_id": 57584925, "comment_id": 101628484, "body": "@Mike You have to store those numbers somewhere. <code>stdin</code> can&#39;t be reliably rewound."}, {"owner": {"reputation": 33, "user_id": 11785222, "user_type": "registered", "profile_image": "https://graph.facebook.com/1387375861415651/picture?type=large", "display_name": "J \ua9fe", "link": "https://stackoverflow.com/users/11785222/j-%ea%a7%be"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1566369170, "post_id": 57584925, "comment_id": 101629278, "body": "@Schwern hi ,sir. I&#39;d like to hear your idea. I can somehow substitute character arrays with putchar or printf"}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1566369494, "post_id": 57584925, "comment_id": 101629415, "body": "it seems from your description that it is ok with having three integer variables instead one? scanf(&quot;%d %d %d&quot;, &amp;n1,&amp;n2,&amp;n3) ..."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1566369498, "post_id": 57584925, "comment_id": 101629422, "body": "Hmm, interesting. Are you aware that you are not asking a question? In either case, start with two integers."}, {"owner": {"reputation": 33, "user_id": 11785222, "user_type": "registered", "profile_image": "https://graph.facebook.com/1387375861415651/picture?type=large", "display_name": "J \ua9fe", "link": "https://stackoverflow.com/users/11785222/j-%ea%a7%be"}, "reply_to_user": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1566369748, "post_id": 57584925, "comment_id": 101629538, "body": "@Anders,I have tried it already, sir, but the teacher won&#39;t accept it. I must run the scanf(&quot;%d&quot;, &amp;num) three times in a loop."}, {"owner": {"reputation": 33, "user_id": 11785222, "user_type": "registered", "profile_image": "https://graph.facebook.com/1387375861415651/picture?type=large", "display_name": "J \ua9fe", "link": "https://stackoverflow.com/users/11785222/j-%ea%a7%be"}, "reply_to_user": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1566369778, "post_id": 57584925, "comment_id": 101629551, "body": "@UlrichEckhardt, hello, sir. What do you mean?"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1566370018, "post_id": 57584925, "comment_id": 101629645, "body": "I mean (approximately) what I wrote. You&#39;ll have to be a bit more specific with your question if you want me to clarify something."}, {"owner": {"reputation": 33, "user_id": 11785222, "user_type": "registered", "profile_image": "https://graph.facebook.com/1387375861415651/picture?type=large", "display_name": "J \ua9fe", "link": "https://stackoverflow.com/users/11785222/j-%ea%a7%be"}, "reply_to_user": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1566370880, "post_id": 57584925, "comment_id": 101630023, "body": "@UlrichEckhardt I have updated the description already,sir. thanks"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 4, "creation_date": 1566384810, "post_id": 57584925, "comment_id": 101637375, "body": "Tell your teacher that it would be more meaningful to teach you program <b>with</b> arrays than <b>without</b> them."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1566384863, "post_id": 57584925, "comment_id": 101637398, "body": "And your program uses <b>4</b> arrays (of char)."}], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1566425831, "post_id": 57585028, "comment_id": 101656822, "body": "Per the OPs question, cannot use multiple variables.  see: <i>I must not have multiple variables like odd1, odd2, odd3, even1, even2, even3.</i>"}], "tags": [], "owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1566365947, "last_edit_date": 1566365947, "creation_date": 1566365609, "answer_id": 57585028, "question_id": 57584925, "link": "https://stackoverflow.com/questions/57584925/is-it-possible-to-create-a-program-that-accepts-3-integers-and-outputs-the-odd-e/57585028#57585028", "title": "Is it possible to create a program that accepts 3 integers and outputs the odd/even integers without using array?", "body": "<p>One way would be say:</p>\n\n<pre><code>int odd1, odd2, odd3, numOdd = 0; \n\n/* Code as above */\n\nscanf(\"%d\", &amp;num);\n\nif (num%2)\n{\n    if (numOdd == 0)\n    {\n        odd1 = num;\n        numOdd++;\n    }\n    else if (numOdd == 1)\n    {\n        odd2 = num;\n        numOdd++;\n    }\n    /* And continue */\n}\nelse\n{\n    /* Repeat with even1, even2, even3 and numEven */\n}\n\n/* Print out numOdd oddn's */\n/* Print out numEven evenn's */\n</code></pre>\n\n<p>It seems a silly exercise, but at least you'll get a lot of practise writing <code>if</code> statements...</p>\n\n<hr>\n\n<p>I also thought:</p>\n\n<pre><code>scanf(\"%d\", &amp;num1);\nscanf(\"%d\", &amp;num2);\nscanf(\"%d\", &amp;num3);\n</code></pre>\n\n<p>Might be shorter, but then you don't need a for loop, unless you do something like:</p>\n\n<pre><code>printf(\"Odd: \");\nfor (i = 0; i &lt; 3; i++)\n{\n    int thisNum;\n    if (i == 0) thisNum = num1;\n    else if (i == 1) thisNum = num2;\n    /* etc */\n    if (thisNum % 2) printf(\"%d \", thisNum);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1566368244, "post_id": 57585369, "comment_id": 101628942, "body": "Well that is still using arrays, just dynamically allocated ones. and <code>3</code> is not the right argument for <code>malloc</code>"}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1566373995, "post_id": 57585369, "comment_id": 101631477, "body": "There&#39;s no need to cast <code>malloc()</code> in C. Also, you pass bad pointers to <code>free()</code>."}, {"owner": {"reputation": 33, "user_id": 11785222, "user_type": "registered", "profile_image": "https://graph.facebook.com/1387375861415651/picture?type=large", "display_name": "J \ua9fe", "link": "https://stackoverflow.com/users/11785222/j-%ea%a7%be"}, "edited": false, "score": 0, "creation_date": 1566383456, "post_id": 57585369, "comment_id": 101636672, "body": "Sorry, sir. but we are not allowed to use pointers or malloc functions"}], "tags": [], "owner": {"reputation": 47, "user_id": 7927255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IRNw0.png?s=128&g=1", "display_name": "Sector", "link": "https://stackoverflow.com/users/7927255/sector"}, "is_accepted": false, "score": -3, "last_activity_date": 1566368410, "last_edit_date": 1566368410, "creation_date": 1566367607, "answer_id": 57585369, "question_id": 57584925, "link": "https://stackoverflow.com/questions/57584925/is-it-possible-to-create-a-program-that-accepts-3-integers-and-outputs-the-odd-e/57585369#57585369", "title": "Is it possible to create a program that accepts 3 integers and outputs the odd/even integers without using array?", "body": "<p>Given the fact that you are learning C, perhaps your teacher wants to teach you some pointer arithmetics instead of using arrays like in this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n  int i = 0;\n  int *odd = (int*)malloc(3 * sizeof(int));\n  int odd_count = 0;\n  int *even = (int*)malloc(3 * sizeof(int));\n  int even_count = 0;\n\n  printf(\"Enter three integers: \");\n\n  for(i=0; i&lt;3; i++)\n  {\n    int num = 0;\n    scanf(\"%d\", &amp;num);\n    if(!(num%2))\n    {\n        *even++ = num;\n        even_count++;\n    }\n    if(num%2)\n    {\n        *odd++ = num;\n        odd_count++;\n    }\n  }\n\n  even -= even_count;\n  odd -= odd_count;\n\n  printf(\"\\nEven: \");\n  for(i=0; i&lt;even_count; i++)\n  {\n     printf(\"%d \", *even++);\n  }\n\n  printf(\"\\nOdd: \");\n  for(i=0; i&lt;odd_count; i++)\n  {\n     printf(\"%d \", *odd++);\n  }\n\n  free(odd);\n  free(even);\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 455, "user_id": 4899025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGgvb.jpg?s=128&g=1", "display_name": "Ajith C Narayanan", "link": "https://stackoverflow.com/users/4899025/ajith-c-narayanan"}, "edited": false, "score": 0, "creation_date": 1566391107, "post_id": 57589876, "comment_id": 101640929, "body": "i hope it will print &quot;odd: &quot; before scanning all the 3 numbers"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 455, "user_id": 4899025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGgvb.jpg?s=128&g=1", "display_name": "Ajith C Narayanan", "link": "https://stackoverflow.com/users/4899025/ajith-c-narayanan"}, "edited": false, "score": 0, "creation_date": 1566391294, "post_id": 57589876, "comment_id": 101641048, "body": "That&#39;s an easy change, @AjithCNarayanan. The core of my answer is in printing the numbers <b>before</b> or <b>after</b> the recursive call. Have fun! <i>I just wanted to cram it all in one single function, moving functionality out of the recursive function makes it simpler :)</i>"}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 1, "creation_date": 1566431837, "post_id": 57589876, "comment_id": 101658119, "body": "I think this is the only answer that satisfies the requirements, although I wonder if it is too advanced for OP. I&#39;d love to see what answer the teacher had in mind."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1566451451, "post_id": 57589876, "comment_id": 101661466, "body": "It still uses arrays."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1566462679, "post_id": 57589876, "comment_id": 101666298, "body": "@AnttiHaapala: no array version, recursive function simplified at <a href=\"https://ideone.com/6ik1XB\" rel=\"nofollow noreferrer\">ideone.com/6ik1XB</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1566462894, "post_id": 57589876, "comment_id": 101666408, "body": "A bounty worthy answer :)))"}], "tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 4, "last_activity_date": 1566384230, "creation_date": 1566384230, "answer_id": 57589876, "question_id": 57584925, "link": "https://stackoverflow.com/questions/57584925/is-it-possible-to-create-a-program-that-accepts-3-integers-and-outputs-the-odd-e/57589876#57589876", "title": "Is it possible to create a program that accepts 3 integers and outputs the odd/even integers without using array?", "body": "<p>Recursion (loop in disguise) for the win (if you don't mind having the even numbers reversed).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid separate(int m, int n) {\n    if (m == n) printf(\"Odd:\");\n    if (n == 0) { printf(\"\\nEven:\"); return; }\n    int i;\n    if (scanf(\"%d\", &amp;i) != 1) exit(EXIT_FAILURE);\n\n    // print odd numbers before recursing; even numbers after recursing\n    if (i % 2 == 1) printf(\" %d\", i);\n    separate(m, n - 1);\n    if (i % 2 == 0) printf(\" %d\", i);\n\n    if (m == n) printf(\"\\n\\n\");\n}\n</code></pre>\n\n<p>See <a href=\"https://ideone.com/GpE7rC\" rel=\"nofollow noreferrer\">https://ideone.com/GpE7rC</a> which includes the calling and input</p>\n\n<pre><code>separate(3, 3); // for 3 numbers\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1566425679, "post_id": 57590305, "comment_id": 101656773, "body": "Per the OPs question, cannot use multiple variables.  see: <i>I must not have multiple variables like odd1, odd2, odd3, even1, even2, even3.</i>"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1566463531, "post_id": 57590305, "comment_id": 101666709, "body": "You should cast the argument of <code>is*()</code> functions: <code>isdigit((unsigned char)c)</code> :)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1566463607, "post_id": 57590305, "comment_id": 101666746, "body": "Haha but I needn&#39;t :)) it&#39;s a trap"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 0, "last_activity_date": 1566392632, "last_edit_date": 1566392632, "creation_date": 1566385801, "answer_id": 57590305, "question_id": 57584925, "link": "https://stackoverflow.com/questions/57584925/is-it-possible-to-create-a-program-that-accepts-3-integers-and-outputs-the-odd-e/57590305#57590305", "title": "Is it possible to create a program that accepts 3 integers and outputs the odd/even integers without using array?", "body": "<p>The problems is that you cannot use arrays. Hence you must not use strings, which are arrays. Allowing the use of <code>scanf</code> and <code>printf</code> is a deliberate trap set by your teacher - there is no way of using them in an useful way without resorting to use of arrays, explicit or implied.</p>\n\n<p>Therefore you must do this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\n\nvoid print_number(int n)\n{\n    if (n &lt; 0) {\n        putchar('-');\n        n = -n;\n    }\n\n    if (n == 0)\n        putchar('0');\n\n    if (n / 10)\n        print_number(n / 10);\n\n    putchar(n % 10 + '0');\n}\n\nint main(void) {\n    putchar('E');\n    putchar('n');\n    putchar('t');\n    putchar('e');\n    putchar('r');\n    putchar(' ');\n    putchar('t');\n    putchar('h');\n    putchar('r');\n    putchar('e');\n    putchar('e');\n    putchar(' ');\n    putchar('i');\n    putchar('n');\n    putchar('t');\n    putchar('e');\n    putchar('g');\n    putchar('e');\n    putchar('r');\n    putchar('s');\n    putchar(':');\n    putchar(' ');\n    fflush(stdout);\n\n    int odd1, odd2, odd3, odd_count = 0;\n    int even1, even2, even3, even_count = 0;\n    for(int i = 0; i &lt; 3; i++)\n    {\n        int number = 0;\n        int c;\n        while (1) {\n            c = getchar();\n            if (isspace(c)) {\n                if (c == '\\n')\n                    break;\n\n                while ((c = getchar()) == ' ');\n                ungetc(c, stdin);\n                break;\n            }\n            else if (isdigit(c)) {\n                number = number * 10 + c - '0';\n            }\n        }\n        if (number % 2) {\n            switch (odd_count) {\n                case 0: odd1 = number; break;\n                case 1: odd2 = number; break;\n                case 2: odd3 = number; break;\n            }\n            odd_count ++;\n        }\n        else {\n            switch (even_count) {\n                case 0: even1 = number; break;\n                case 1: even2 = number; break;\n                case 2: even3 = number; break;\n            }\n            even_count ++;\n        }\n    }\n\n    putchar('O');\n    putchar('d');\n    putchar('d');\n    putchar(':');\n    putchar(' ');\n\n    if (odd_count &gt;= 1) {\n        print_number(odd1);\n    }\n\n    if (odd_count &gt;= 2) {\n        putchar(' ');\n        print_number(odd2);\n    }\n\n    if (odd_count &gt;= 3) {\n        putchar(' ');\n        print_number(odd3);\n    }\n\n    putchar('\\n');\n    putchar('E');\n    putchar('v');\n    putchar('e');\n    putchar('n');\n    putchar(':');\n    putchar(' ');\n\n    if (even_count &gt;= 1) {\n        print_number(even1);\n    }\n\n    if (even_count &gt;= 2) {\n        putchar(' ');\n        print_number(even2);\n    }\n\n    if (even_count &gt;= 3) {\n        putchar(' ');\n        print_number(even3);\n    }\n\n    putchar('\\n');\n}\n</code></pre>\n\n<p>This code does not use any arrays. </p>\n\n<p>If you cannot define any functions (other than <code>main</code> obviously), you must inline the <code>print_number</code> in the 6 places changing the recursion into iteration. Good luck!</p>\n\n<p>If the teacher however accepts the use of strings in a task that does not allow the use of arrays, you can take it as a license to disregard all silly restrictions set by them.</p>\n"}], "owner": {"reputation": 33, "user_id": 11785222, "user_type": "registered", "profile_image": "https://graph.facebook.com/1387375861415651/picture?type=large", "display_name": "J \ua9fe", "link": "https://stackoverflow.com/users/11785222/j-%ea%a7%be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 1, "answer_count": 4, "score": 0, "last_activity_date": 1566392632, "creation_date": 1566365031, "last_edit_date": 1566369882, "question_id": 57584925, "link": "https://stackoverflow.com/questions/57584925/is-it-possible-to-create-a-program-that-accepts-3-integers-and-outputs-the-odd-e", "title": "Is it possible to create a program that accepts 3 integers and outputs the odd/even integers without using array?", "body": "<p>Our teacher gave us an exercise in C. We have to create a program that accepts three integers and outputs them if they are odd or even without using arrays, only loops and conditional statements can be used.\nWhat I am only allowed to use are scanf(), printf(), loops and conditional statements. I must not have multiple variables like odd1, odd2, odd3, even1, even2, even3.And I must not do scanf(\"%d %d %d\",), so I must run scanf(\"%d\") three times in a loop.I couldn't think of any idea that would precisely print the same format of the expected output. I hope someone could help me on this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n    int i, num;\n\n    printf(\"Enter three integers: \");\n\n    for(i=1;i&lt;=3;i++)\n    {\n        scanf(\"%d\", &amp;num);\n\n          if(!(num%2))\n          {\n            printf(\"\\nEven: %d\", num);    \n          }\n          if(num%2)\n          {\n            printf(\"\\nOdd: %d\\n\", num);    \n          }\n    }\n}\n</code></pre>\n\n<p>I expect the following like this...</p>\n\n<p>Input: </p>\n\n<pre><code>   1 2 3\n</code></pre>\n\n<p>Output: </p>\n\n<pre><code>   Odd: 1 3\n   Even: 2\n</code></pre>\n\n<p>Input: </p>\n\n<pre><code>   2 4 6\n</code></pre>\n\n<p>Output: </p>\n\n<pre><code>   Odd:  \n   Even: 2 4 6\n</code></pre>\n\n<p>...but the only thing i can do is this</p>\n\n<p>Input: </p>\n\n<pre><code>   1 2 3\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>    Odd: 1\n   Even: 2\n    Odd: 3\n</code></pre>\n\n<p>Input: </p>\n\n<pre><code>    1 3 5\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>    Odd: 1\n    Odd: 3\n    Odd: 5\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": false, "score": 1, "last_activity_date": 1566362435, "creation_date": 1566362435, "answer_id": 57584527, "question_id": 57584446, "link": "https://stackoverflow.com/questions/57584446/is-there-a-way-to-read-a-string-from-a-file-that-are-separated-by-enter-key/57584527#57584527", "title": "Is there a way to read a string from a file that are separated by enter key?", "body": "<p><code>fgets</code> is for reading lines in a file.  According to the man page:</p>\n\n<blockquote>\n  <p>fgets()  reads in at most one less than size characters from stream and stores them into the buffer pointed to by s.  Reading stops after an EOF or a newline.  If a newline is read, it is stored into the buffer.  A terminating null byte ('\\0') is stored after the last character in the buffer.</p>\n</blockquote>\n\n<p>If you want to get raw data, use <code>fread</code>.  The man page for that function describes it as:</p>\n\n<blockquote>\n  <p>The  function  fread() reads nmemb items of data, each size bytes long, from the stream pointed to by stream, storing them at the location given by ptr.</p>\n</blockquote>\n\n<p>Another option is just calling <code>fgets</code> three times for each line, then the input will already be split up.</p>\n\n<p>Which way to go depends on what you want to do with the data.</p>\n"}], "owner": {"reputation": 1, "user_id": 9980506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6gZN9uAeLmo/AAAAAAAAAAI/AAAAAAAAAgI/1krjfbLcq_8/photo.jpg?sz=128", "display_name": "Bruno Henrique", "link": "https://stackoverflow.com/users/9980506/bruno-henrique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1566362435, "creation_date": 1566361736, "last_edit_date": 1566362244, "question_id": 57584446, "link": "https://stackoverflow.com/questions/57584446/is-there-a-way-to-read-a-string-from-a-file-that-are-separated-by-enter-key", "title": "Is there a way to read a string from a file that are separated by enter key?", "body": "<p>I'm a new programmer, and I learning some C.</p>\n\n<p>The problem is, I got a file that it's words are separated by the enter key, such like:</p>\n\n<pre><code>Apple\nBanana\nCinnamon\n</code></pre>\n\n<p>I'd like to store all this data in a single variable (a string (array of characters)) but I think that my fgets() function stops when finds an enter key.</p>\n\n<p>So I'd like to know if there's another way to do it</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char* readFile(void){ // \n\n    FILE *text;\n    text = fopen(\"text1.txt\", \"r\");  \n\n    char *words;\n\n    words = malloc (sizeof(char)*10); \n\n    fgets(words, 2000, text); \n\n    fclose(text); \n\n    printf(\"%s\\n\", words); // Just to see the output\n\n    return words;\n\n}\n</code></pre>\n\n<p>When I read the file containing:</p>\n\n<pre><code>Apple\nBanana\nCinnamon\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>Apple\n</code></pre>\n"}, {"tags": ["c", "winapi", "console-application", "raku"], "comments": [{"owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 1, "creation_date": 1566366697, "post_id": 57584155, "comment_id": 101628379, "body": "65 is &quot;A&quot; instead of &quot;a&quot;. <code>ord</code> is used to convert a character to a number. So <code>ord(&quot;A&quot;)</code> will return 65. Can you have a try?"}, {"owner": {"reputation": 1964, "user_id": 8666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e412c92534ae5c8ae3b0e9cb7b7360?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel S\u0119k", "link": "https://stackoverflow.com/users/8666197/daniel-s%c4%99k"}, "edited": false, "score": 2, "creation_date": 1566376408, "post_id": 57584155, "comment_id": 101632590, "body": "I would put <code>int32</code> instead of <code>bool</code> just in case the Perl maps it to something with size not equal 4. For test replace union with just <code>uint16</code> and see if anything changes. Check also <code>INPUT_RECORD</code> definition which embeds <code>KEY_EVENT_RECORD</code>."}, {"owner": {"reputation": 4524, "user_id": 8893864, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfBb3bzlcfw/AAAAAAAAAAI/AAAAAAAAADM/vILdjUEHHM8/photo.jpg?sz=128", "display_name": "Holli", "link": "https://stackoverflow.com/users/8893864/holli"}, "edited": false, "score": 2, "creation_date": 1566378714, "post_id": 57584155, "comment_id": 101633852, "body": "Yes, I just realized when I look at the struct in the c debugger it thinks that boolean is an int, and sure enough BOOL is defined as int in the header file. I changed my class accordingly and now everything works. Thanks"}, {"owner": {"reputation": 3151, "user_id": 9574771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d205b5efbf77202893f777a90fde50d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiepi", "link": "https://stackoverflow.com/users/9574771/kaiepi"}, "edited": false, "score": 0, "creation_date": 1567518825, "post_id": 57584155, "comment_id": 101981444, "body": "In case people end up here looking for a way to use <code>wchar_t</code> with NativeCall, I have a <a href=\"https://github.com/rakudo/rakudo/pull/3044\" rel=\"nofollow noreferrer\">pullreq</a> open to add support for <code>wchar_t</code>, <code>wint_t</code>, <code>char16_t</code>, and <code>char32_t</code> to Rakudo, nqp, and MoarVM so the backends can figure out what those types really are rather than having to guess in your own code (if it gets merged, at least)."}, {"owner": {"reputation": 4524, "user_id": 8893864, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfBb3bzlcfw/AAAAAAAAAAI/AAAAAAAAADM/vILdjUEHHM8/photo.jpg?sz=128", "display_name": "Holli", "link": "https://stackoverflow.com/users/8893864/holli"}, "edited": false, "score": 0, "creation_date": 1567524128, "post_id": 57584155, "comment_id": 101984459, "body": "Not really neccessary since those types are &quot;frozen&quot; for compatibility reasons.Under Windows a wchar_t is 2 bytes wide, regardless if it is on 32 bit or 64 bit or future 128 bit. ( I think )"}, {"owner": {"reputation": 3151, "user_id": 9574771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d205b5efbf77202893f777a90fde50d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiepi", "link": "https://stackoverflow.com/users/9574771/kaiepi"}, "edited": false, "score": 0, "creation_date": 1568124865, "post_id": 57584155, "comment_id": 102170256, "body": "This is the case on Windows, but on other platforms (like Solaris), the size of <code>wchar_t</code> does depend on what architecture you&#39;re using. Certain compiler flags can also make it harder to tell what its size is from Perl 6."}], "owner": {"reputation": 4524, "user_id": 8893864, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfBb3bzlcfw/AAAAAAAAAAI/AAAAAAAAADM/vILdjUEHHM8/photo.jpg?sz=128", "display_name": "Holli", "link": "https://stackoverflow.com/users/8893864/holli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1575229819, "creation_date": 1566358888, "last_edit_date": 1575229819, "question_id": 57584155, "link": "https://stackoverflow.com/questions/57584155/how-to-properly-use-char-and-wchar-t-in-nativecall-perl6", "title": "how to properly use char and wchar_t in NativeCall (Perl6)", "body": "<p>I am calling <code>ReadConsoleInputW</code> from Kernel32.dll using <code>NativeCall</code>\nA part of the struct I have to pass into that function looks like this</p>\n\n<pre><code>typedef struct _KEY_EVENT_RECORD {\n    BOOL bKeyDown;\n    WORD wRepeatCount;\n    WORD wVirtualKeyCode;\n    WORD wVirtualScanCode;\n    union {\n        WCHAR UnicodeChar;\n        CHAR  AsciiChar;\n    } uChar;\n    DWORD dwControlKeyState;\n}\n</code></pre>\n\n<p>which I have implemented as</p>\n\n<pre><code>class KEY_EVENT_RECORD_CHAR is repr('CUnion') {\n    has uint16 $.UnicodeChar;\n    has uint8  $.AsciiChar;\n}   \nclass KEY_EVENT_RECORD is repr('CStruct') {\n    has bool $.bKeyDown;\n    has uint16 $.wRepeatCount;\n    has uint16 $.wVirtualKeyCode;\n    has uint16 $.wVirtualScanCode;\n    HAS KEY_EVENT_RECORD_CHAR $.uChar;\n    has uint32 $.dwControlKeyState;\n}\n</code></pre>\n\n<p>My code works, in the sense that it doesn't crash. However, the values of the UnicodeChar and AsciiChar fields differ from the output of the C version of the program. For instance, if I type \"a\", the Perl version says the char is 30 (not 65 as I expect), whereas in C it's 65/\"a\". </p>\n\n<p>I'm not a C-Guru but I don't see what's wrong there, I mean a char is one byte wide and a wchar_t is 2 bytes.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c", "multithreading", "concurrency", "synchronization", "pthreads"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 4714666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vbGjAsYQaDA/AAAAAAAAAAI/AAAAAAAAAHo/KBb-cDAUqoY/photo.jpg?sz=128", "display_name": "gdea73", "link": "https://stackoverflow.com/users/4714666/gdea73"}, "is_accepted": false, "score": 1, "last_activity_date": 1566357955, "last_edit_date": 1566357955, "creation_date": 1566357349, "answer_id": 57583999, "question_id": 57583876, "link": "https://stackoverflow.com/questions/57583876/how-to-prevent-this-pthread-synchronization-memory-stomping/57583999#57583999", "title": "How to prevent this pthread synchronization memory stomping?", "body": "<p>When running your code, I see the names printed in an unpredictable sequence, but I see no mangling like your output suggests. I'm using glibc 2.29-3 on Arch Linux.</p>\n\n<p>Edit: I noticed that you are not calling <code>pthread_mutex_init</code>. Incidentally, the uninitialized (zero) <code>mt</code> appears to be lockable on my platform, but it may be causing the issue you are seeing on yours. I am not sure whether your platform is returning an error code when you call <code>pthread_mutex_lock</code> on account of it being uninitialized, but it would also be best to check the return value of those calls.</p>\n"}, {"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 1, "last_activity_date": 1566363015, "last_edit_date": 1566363015, "creation_date": 1566360998, "answer_id": 57584353, "question_id": 57583876, "link": "https://stackoverflow.com/questions/57583876/how-to-prevent-this-pthread-synchronization-memory-stomping/57584353#57584353", "title": "How to prevent this pthread synchronization memory stomping?", "body": "<p>The mutex <code>mt</code> is use <strong>un</strong>initialised. So the calls to <code>pthread_mutex_lock()</code> and <code>pthread_mutex_unlock()</code> may not work as expected. This would become obvious if the code checked the latter function's return values, like so:</p>\n\n<pre><code>  if (0 != pthread_mutex_lock(&amp;mt))\n  {\n    /* Handle and log error here. */\n  }\n</code></pre>\n\n<p>Handling and logging the error might be done as follows:</p>\n\n<pre><code>  if (0 != (errno = pthread_mutex_lock(&amp;mt)))  /* Needs errno.h. */\n  {\n    perror(\"pthread_mutex_lock() failed\");  /* Requires errno to be set. */\n    exit(EXIT_FAILURE);  /* Needs stdlib.h. */\n  }\n</code></pre>\n\n<p>To initialise a mutex in the simplest case do:</p>\n\n<pre><code>pthread_mutex_t mt = PTHREAD_MUTEX_INITIALIZER;\n</code></pre>\n\n<p>Alternatively do:</p>\n\n<pre><code>  if (0 != pthread_mutex_init(&amp;mt, NULL))\n  {\n    /* Handle and log error here. */\n  }\n</code></pre>\n\n<p>The <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_mutex_destroy.html\" rel=\"nofollow noreferrer\">related documentation is here</a>.</p>\n"}], "owner": {"reputation": 1691, "user_id": 6396569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh3.googleusercontent.com/-f0efiZGjd9s/AAAAAAAAAAI/AAAAAAAAAFQ/A1O5wGFybXA/photo.jpg?sz=128", "display_name": "the_endian", "link": "https://stackoverflow.com/users/6396569/the-endian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 57584353, "answer_count": 2, "score": 1, "last_activity_date": 1566363015, "creation_date": 1566356185, "last_edit_date": 1566361011, "question_id": 57583876, "link": "https://stackoverflow.com/questions/57583876/how-to-prevent-this-pthread-synchronization-memory-stomping", "title": "How to prevent this pthread synchronization memory stomping?", "body": "<p>The following program, in which I use critical sections to protect a writer/readers pattern:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#define NAME_SIZE 6\n#define NUM_THREADS 4\nstatic char name[NAME_SIZE];\npthread_mutex_t mt;\npthread_cond_t read_phase;\n\nvoid* name_joey(void *arg);\nvoid* name_jimmy(void *arg);\nvoid* name_leah(void *arg);\nvoid* print_name(void *arg);\n\n\nint main(void)\n{\n    pthread_t joey;\n    pthread_t jimmy;\n    pthread_t leah;\n    pthread_t printer;\n\n    pthread_create(&amp;joey, NULL, name_joey, NULL);\n    pthread_create(&amp;jimmy, NULL, name_jimmy, NULL);\n    pthread_create(&amp;leah, NULL, name_leah, NULL);\n    pthread_create(&amp;printer, NULL, print_name, NULL);\n\n    pthread_join(joey, NULL);\n    pthread_join(jimmy, NULL);\n    pthread_join(leah, NULL);\n    pthread_join(printer, NULL);\n    return EXIT_SUCCESS;\n}\n\nvoid* name_joey(void *arg)\n{\n    while(1)\n    {\n        pthread_mutex_lock(&amp;mt);\n        memset(name, 0, NAME_SIZE);\n        strcpy(name, \"Joey\\0\");\n        pthread_mutex_unlock(&amp;mt);\n    }\n    return 0;\n}\nvoid* name_jimmy(void *arg)\n{\n    while(1)\n    {\n        pthread_mutex_lock(&amp;mt);\n        memset(name, 0, NAME_SIZE);\n        strcpy(name, \"Jimmy\\0\");\n        pthread_mutex_unlock(&amp;mt);\n    }\n    return 0;\n}\nvoid* name_leah(void *arg)\n{\n    while(1)\n    {\n        pthread_mutex_lock(&amp;mt);\n        memset(name, 0, NAME_SIZE);\n        strcpy(name, \"Leah\\0\");\n        pthread_mutex_unlock(&amp;mt);\n    }\n    return 0;\n}\n\nvoid* print_name(void *arg)\n{\n    while(1)\n    {\n        pthread_mutex_lock(&amp;mt);\n        printf(\"%s\\n\", name);\n        pthread_mutex_unlock(&amp;mt);\n        sleep(1);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Produces variations on this output:</p>\n\n<pre><code>Loey\nLeah\nLeah\nJimmy\nJimm\nJoey\neah\nJimm\nJimmy\nLoey\nLeah\nLoey\nJimmy\nimm\nLoey\nLoeh\nJeey\nLimm\nJimm\nJimmy\nLeah\nLeah\nJimmy\nJimmy\nJimm\nJeah\nLoey\nJimmy\nJimmy\nJeah\n</code></pre>\n\n<p>This is not the desired effect. I've provided critical sections to each write/read area of the code, in addition to zeroing out the memory entirely before each write. What could be causing the memory to be partially malformed like this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 5, "creation_date": 1566353964, "post_id": 57583538, "comment_id": 101625998, "body": "Since you only read two characters from <code>stdin</code>, it&#39;s likely that the newline character is still in the buffer and gets eaten by the <code>pause</code> command.  Use <code>fgets</code> to read a line of input."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1566367994, "post_id": 57583538, "comment_id": 101628832, "body": "Call your program from an already open commandline prompt. Then it will stay open afterwards."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1566368099, "post_id": 57583538, "comment_id": 101628877, "body": "@paddy Sounds good enough to be an answer, even one which contradicts the &quot;dupe&quot; feeling I had."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1566377558, "post_id": 57583538, "comment_id": 101633156, "body": "Unrelated to your question, you should always use <code>strtol</code> and never <code>atoi</code>. The <code>atoi</code> is a dangerous function with no error handling."}, {"owner": {"reputation": 21, "user_id": 11954395, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBIIebK4yQEoHsEVc-x1zDopB26XTPZhWJwZRiGdQ=k-s128", "display_name": "Reese Evans", "link": "https://stackoverflow.com/users/11954395/reese-evans"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566401190, "post_id": 57583538, "comment_id": 101647121, "body": "Read through the suggestions, I&#39;ll try them when I get home from work.  For @Lundin I searched more into strtol vs atoi and it does seem to be an outdated function which the book is referencing from 2012 when it was published so I&#39;ll change that as well - thanks for the correction."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1566423274, "post_id": 57583538, "comment_id": 101656094, "body": "before calling <code>system( &quot;pause&quot; );</code>  always clear out <code>stdin</code>, typically via: <code>int ch;  while( (ch = getchar() ) != EOF &amp;&amp; ch != &#39;\\n&#39; ){;}</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566456560, "post_id": 57583538, "comment_id": 101663290, "body": "@ReeseEvans Some guide lines about which standard functions to avoid or be extra careful with: <a href=\"https://stackoverflow.com/a/46563868/584518\">Which functions from the standard library must (should) be avoided?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1566434762, "post_id": 57600661, "comment_id": 101658557, "body": "You will also find using the <i>VS Developers Command Prompt</i> and compiling from the command line by invoking the compiler directly (<code>cl.exe</code>) allows you to tailor your build simply by specifying options on the command line (in addition to avoiding the need to set up a project in VS) See, e.g. <a href=\"https://docs.microsoft.com/en-us/cpp/build/walkthrough-compile-a-c-program-on-the-command-line?view=vs-2019\" rel=\"nofollow noreferrer\">Use the Microsoft C toolset from the command line</a>"}], "tags": [], "owner": {"reputation": 21, "user_id": 11954395, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBIIebK4yQEoHsEVc-x1zDopB26XTPZhWJwZRiGdQ=k-s128", "display_name": "Reese Evans", "link": "https://stackoverflow.com/users/11954395/reese-evans"}, "is_accepted": false, "score": 1, "last_activity_date": 1566433949, "creation_date": 1566433949, "answer_id": 57600661, "question_id": 57583538, "link": "https://stackoverflow.com/questions/57583538/c-program-command-prompt-closing-within-an-if-statement-rather-than-pausing-at-t/57600661#57600661", "title": "C program command prompt closing within an if statement rather than pausing at the end of main()", "body": "<p>I was able to get it working using the advice provided by paddy to use fgets instead of just printing as my character was being eaten by the buffer while passing.  I also launched directly through the command line as my setup for VSCode wasnt done properly and was running into issues itself trying to run the compiled exe.  </p>\n"}], "owner": {"reputation": 21, "user_id": 11954395, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBIIebK4yQEoHsEVc-x1zDopB26XTPZhWJwZRiGdQ=k-s128", "display_name": "Reese Evans", "link": "https://stackoverflow.com/users/11954395/reese-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566433949, "creation_date": 1566353120, "last_edit_date": 1566366339, "question_id": 57583538, "link": "https://stackoverflow.com/questions/57583538/c-program-command-prompt-closing-within-an-if-statement-rather-than-pausing-at-t", "title": "C program command prompt closing within an if statement rather than pausing at the end of main()", "body": "<p>I'm following along the <em>Head First C</em> (2012) and am running into an issue with their initial \"cards.c\" project in the first chapter.  </p>\n\n<p>Basically, the code asks for an input for a type of card then outputs a value based on whatever the user entered.  However, I find that the command prompt exits automatically after executing the corresponding if statement even if I tell the program to pause or check for a key input at the end of the main() function.</p>\n\n<p>I've made a half-fix by including the output of the card's value within the if statement such as</p>\n\n<pre><code>if (card_name[0] == 'K') {\n    val = 10;\n    printf(\"The card value is: %i\\n\", val);\n    system(\"pause\");\n}\n</code></pre>\n\n<p>Yet I find the output will occur twice if I leave the printf statement and system pause both within the for bracket and at the end of main.  As such, I'm confused why the command prompt is automatically closing when I only output at the end of main rather than inside of each if/else if/else statement.</p>\n\n<p>For reference, I am running through Visual Studio Code on Windows 10 and am using MinGW to compile (Which VSCode allows me to build with, but I run through a command prompt).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    char card_name[3];\n    puts(\"Enter the card name: \");\n    scanf(\"%2s\", card_name);\n    int val = 0;\n    if (card_name[0] == 'K') {\n        val = 10;\n    } else if(card_name[0] == 'Q') {\n        val = 10;\n    } else if(card_name[0] == 'J') {\n        val = 10;\n    } else if(card_name[0] == 'A') {\n        val = 11;\n    } else {\n        val = atoi(card_name);\n    }\n    printf(\"The card value is: %i\\n\", val);\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>For anyone reading, this is exactly how the code appears in the book outside of the system pause at the end of main().  I apologize if this is too basic of a question, but I have yet to find an answer after an hour of searching on this site.</p>\n"}, {"tags": ["python", "c++", "c", "bit-manipulation", "bitwise-operators"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1566353101, "post_id": 57583506, "comment_id": 101625864, "body": "What&#39;s the actual purpose of your subroutine and why all the restrictions? The description reads uncannily like a homework problem."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1566353222, "post_id": 57583506, "comment_id": 101625887, "body": "What&#39;s the allowed set of operations exactly? Anything &quot;advanced&quot; like popcnt, lzcnt, pext, etc? (E: it is possible without them, but it gets a bit more hairy)"}, {"owner": {"reputation": 21, "user_id": 11875946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hba-asz04DA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd3Yt5YFBfMIMwfysMeIwzCa35V6g/photo.jpg?sz=128", "display_name": "NightDriveDrones", "link": "https://stackoverflow.com/users/11875946/nightdrivedrones"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1566353714, "post_id": 57583506, "comment_id": 101625964, "body": "@lurker I&#39;m designing an algorithm to generate all possible permutations of size <code>n</code> binary trees with <code>k</code> number of distinct values. This is one tiny piece of it. It sounds academic I guess, but it does have real-world applications. I&#39;m not a student."}, {"owner": {"reputation": 1341, "user_id": 4524618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e1ca7e81266dc3e8f724a4864b3d90e?s=128&d=identicon&r=PG", "display_name": "Sniper", "link": "https://stackoverflow.com/users/4524618/sniper"}, "edited": false, "score": 0, "creation_date": 1566353757, "post_id": 57583506, "comment_id": 101625974, "body": "Should <code>n</code> have at least 1 clear bit?"}, {"owner": {"reputation": 21, "user_id": 11875946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hba-asz04DA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd3Yt5YFBfMIMwfysMeIwzCa35V6g/photo.jpg?sz=128", "display_name": "NightDriveDrones", "link": "https://stackoverflow.com/users/11875946/nightdrivedrones"}, "reply_to_user": {"reputation": 1341, "user_id": 4524618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e1ca7e81266dc3e8f724a4864b3d90e?s=128&d=identicon&r=PG", "display_name": "Sniper", "link": "https://stackoverflow.com/users/4524618/sniper"}, "edited": false, "score": 0, "creation_date": 1566354646, "post_id": 57583506, "comment_id": 101626122, "body": "@sniper Good question, I added constraints to input <code>n</code>. There are some guarantees on the bit counts."}, {"owner": {"reputation": 21, "user_id": 11875946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hba-asz04DA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd3Yt5YFBfMIMwfysMeIwzCa35V6g/photo.jpg?sz=128", "display_name": "NightDriveDrones", "link": "https://stackoverflow.com/users/11875946/nightdrivedrones"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1566354949, "post_id": 57583506, "comment_id": 101626166, "body": "@harold Prefer <code>&amp; | &lt;&lt; &gt;&gt; ~ ^ + - &#47; * %</code> since they&#39;re less dependent on instruction set architecture, but solutions using popcnt/lzcnt/pext/etc are welcome too (and probably fine)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1566357181, "post_id": 57583506, "comment_id": 101626525, "body": "&quot;I&#39;m trying to maximally optimize a low-level subroutine&quot; is not demonstrated.  Post what you have tried else this is simply a request for some else to do the work."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11875946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hba-asz04DA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd3Yt5YFBfMIMwfysMeIwzCa35V6g/photo.jpg?sz=128", "display_name": "NightDriveDrones", "link": "https://stackoverflow.com/users/11875946/nightdrivedrones"}, "edited": false, "score": 0, "creation_date": 1566355411, "post_id": 57583646, "comment_id": 101626250, "body": "This is great! So clear and simple. If it helps enable other solutions, I added constraints on input <code>n</code> to the original question. There are some guarantees on starting set/clear counts."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 21, "user_id": 11875946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hba-asz04DA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd3Yt5YFBfMIMwfysMeIwzCa35V6g/photo.jpg?sz=128", "display_name": "NightDriveDrones", "link": "https://stackoverflow.com/users/11875946/nightdrivedrones"}, "edited": false, "score": 0, "creation_date": 1566355721, "post_id": 57583646, "comment_id": 101626286, "body": "@user107870 I couldn&#39;t think of a way to use the guarantee on the number of trailing zeroes, if it was a stronger guarantee such as <code>tzcnt(x) == popcnt(x)</code> then it would make the problem much easier"}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1566370663, "post_id": 57583646, "comment_id": 101629936, "body": "@harold I wonder if, in the particular case described here, <code>x &#47; (x &amp; -x)</code> cannot be replaced by  <code>x &#47; (-x)</code> ?"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1566399084, "post_id": 57583646, "comment_id": 101645916, "body": "@GuillaumePetitjean I believed that for a moment (using the intuition &quot;negation flips the bits above the rightmost set bit&quot;), but for example -6 isn&#39;t 2, a lot of higher bits get set as well"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1566411753, "post_id": 57583646, "comment_id": 101651661, "body": "If you want to avoid hardcoding the integer length, /3*2 does the trick. Division is slow, but good compilers can replace that division with a multiplication since 3 is a constant. (Just check godbolt to see how)"}], "tags": [], "owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "is_accepted": true, "score": 6, "last_activity_date": 1566398869, "last_edit_date": 1566398869, "creation_date": 1566354120, "answer_id": 57583646, "question_id": 57583506, "link": "https://stackoverflow.com/questions/57583506/bit-manipulation-to-convert-leftmost-set-bits-to-right-side-alternating-bits/57583646#57583646", "title": "Bit manipulation to convert leftmost set bits to right-side alternating bits?", "body": "<p>One approach could be to use these steps:</p>\n\n<ol>\n<li>Right-justify (discard trailing zeroes)</li>\n<li>Get rid of 2 set bits</li>\n<li>Double the number of set bits</li>\n<li>Mask out the even bits</li>\n</ol>\n\n<p>For example, using only \"basic\" operations:</p>\n\n<pre><code>// right-justify\nx = x / (x &amp; -x)\n// get rid of 2 set bits\nx &gt;&gt;= 2\n// double the number of set bits\nx *= x + 2\n// mask out even bits\nx &amp;= 0xAAAAAAAAAAAAAAAA\n</code></pre>\n\n<p>That step \"double the number of set bits\" relies on <code>x</code> being a power of two minus one at that point. If <code>x</code> can be written as 2<sup>k</sup>-1 then <code>x * (x + 2)</code> will be (2<sup>k</sup>-1) * (2<sup>k</sup>+1) = 2<sup>2k</sup>-1 so it doubles the number of set bits.</p>\n\n<p>Division is not so nice, if you had a fast <code>tzcnt</code> then you can right-justify with:</p>\n\n<pre><code>x &gt;&gt;= tzcnt(x)\n</code></pre>\n\n<p>With fast <a href=\"https://www.felixcloutier.com/x86/pdep\" rel=\"nofollow noreferrer\"><code>pdep</code></a> (Intel Haswell and newer, works on AMD Ryzen but slowly), doubling the number of set bits can be avoided,</p>\n\n<pre><code>// spread out the bits to even positions\nx = pdep(x, 0xAAAAAAAAAAAAAAAA)\n</code></pre>\n\n<p>And fast <a href=\"https://www.felixcloutier.com/x86/pext\" rel=\"nofollow noreferrer\"><code>pext</code></a> could be used as an alternative right-justify,</p>\n\n<pre><code>// right-justify\nx = pext(x, x)\n</code></pre>\n\n<p>With the common <code>popcnt</code> a more direct approach could be used, counting the number of set bits, subtracting two, then generating a pattern of that size for example by shifting <code>0xAAAAAAAAAAAAAAAA</code> right until it is short enough, or by using <a href=\"https://www.felixcloutier.com/x86/bzhi\" rel=\"nofollow noreferrer\"><code>bzhi</code></a> to truncate it at the top.</p>\n"}, {"comments": [{"owner": {"reputation": 21554, "user_id": 1329296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1026699dbf4140d3fc7262842428e808?s=128&d=identicon&r=PG", "display_name": "lenik", "link": "https://stackoverflow.com/users/1329296/lenik"}, "edited": false, "score": 0, "creation_date": 1566356807, "post_id": 57583899, "comment_id": 101626474, "body": "OP asked for &quot;no loops, please&quot;"}], "tags": [], "owner": {"reputation": 5908, "user_id": 2442613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c872ea7055801788bec55c7703b96d88?s=128&d=identicon&r=PG", "display_name": "Paul Cornelius", "link": "https://stackoverflow.com/users/2442613/paul-cornelius"}, "is_accepted": false, "score": 0, "last_activity_date": 1566356385, "creation_date": 1566356385, "answer_id": 57583899, "question_id": 57583506, "link": "https://stackoverflow.com/questions/57583506/bit-manipulation-to-convert-leftmost-set-bits-to-right-side-alternating-bits/57583899#57583899", "title": "Bit manipulation to convert leftmost set bits to right-side alternating bits?", "body": "<p>Here is a Python algorithm that doesn't care how many zero bits are to the right of the first one.  It builds the answer without worrying about subtracting off 2 of the 1 bits, and at the end it shifts the result to the right by 4 bits to take this into account.</p>\n\n<pre><code>k = 0\nn = 0b111110000\n\nwhile n != 0:\n    if n &amp; 1 != 0:\n        k = (k &lt;&lt; 2) + 2\n    n &gt;&gt;= 1\n\nprint(bin(k&gt;&gt;4))\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11875946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hba-asz04DA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd3Yt5YFBfMIMwfysMeIwzCa35V6g/photo.jpg?sz=128", "display_name": "NightDriveDrones", "link": "https://stackoverflow.com/users/11875946/nightdrivedrones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 1, "accepted_answer_id": 57583646, "answer_count": 2, "score": 1, "last_activity_date": 1566398869, "creation_date": 1566352832, "last_edit_date": 1566354534, "question_id": 57583506, "link": "https://stackoverflow.com/questions/57583506/bit-manipulation-to-convert-leftmost-set-bits-to-right-side-alternating-bits", "title": "Bit manipulation to convert leftmost set bits to right-side alternating bits?", "body": "<p>I'm trying to maximally optimize a low-level subroutine, but I can't figure out the fastest way to flip the bits in this specific case:</p>\n\n<p>Given a binary integer <code>n</code> wherein all set bits are to the left of all clear bits (e.g. <code>11110000</code>, <code>110000</code>, <code>1110000</code>), is it possible to produce a resulting binary integer of digit length <code>((number of set bits in n) - 2) * 2</code>, with all even bits set and all odd bits clear?</p>\n\n<p>Example:</p>\n\n<pre><code>n = 111000, answer: 10\nn = 1111000, answer: 1010\nn = 110, answer: 0\nn = 111110000000, answer: 101010\nn = 1111111111000000000, answer: 1010101010101010\n</code></pre>\n\n<p><code>n</code> is guaranteed to have at least 2 <code>set bits</code>, and at least  (<code>set bits</code> - 1) <code>clear bits</code></p>\n\n<p>The answer must utilize only a constant number of bit manipulation and/or arithmetic operations (i.e. loopless), and can't use any type conversions (integers only, no strings).</p>\n"}, {"tags": ["c", "for-loop"], "answers": [{"tags": [], "owner": {"reputation": 648, "user_id": 10990718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f79b3692b9dc156ff26b1c58fa07e4?s=128&d=identicon&r=PG&f=1", "display_name": "dms", "link": "https://stackoverflow.com/users/10990718/dms"}, "is_accepted": false, "score": 4, "last_activity_date": 1566350112, "creation_date": 1566350112, "answer_id": 57583261, "question_id": 57583246, "link": "https://stackoverflow.com/questions/57583246/two-similar-for-loops-give-different-results/57583261#57583261", "title": "Two similar for-loops give different results", "body": "<p>In the first loop <code>sum</code> is incremented at the end of the iteration, so after the call to <code>printf</code>, while in the second loop <code>sum2</code> is incremented before the call to <code>printf</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 688, "user_id": 5610348, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVSjg.jpg?s=128&g=1", "display_name": "pcgben", "link": "https://stackoverflow.com/users/5610348/pcgben"}, "is_accepted": false, "score": 1, "last_activity_date": 1566350450, "creation_date": 1566350450, "answer_id": 57583297, "question_id": 57583246, "link": "https://stackoverflow.com/questions/57583246/two-similar-for-loops-give-different-results/57583297#57583297", "title": "Two similar for-loops give different results", "body": "<p>If you follow the execution pointer carefully, in the first loop <code>sum += i</code> occurs <em>before</em> <code>i</code> is incremented.</p>\n\n<p>In the second loop, <code>sum2 += j</code> occurs <em>after</em> <code>j</code> has been incremented.</p>\n"}], "owner": {"reputation": 35, "user_id": 7210995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a3dbb4105d063e913f8d1183998da1?s=128&d=identicon&r=PG&f=1", "display_name": "narutowindy", "link": "https://stackoverflow.com/users/7210995/narutowindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "closed_date": 1566540529, "answer_count": 2, "score": -2, "last_activity_date": 1566451452, "creation_date": 1566349954, "last_edit_date": 1566351225, "question_id": 57583246, "link": "https://stackoverflow.com/questions/57583246/two-similar-for-loops-give-different-results", "closed_reason": "Not suitable for this site", "title": "Two similar for-loops give different results", "body": "<p>just playing around with for loops, and wanted to see what the results are.</p>\n\n<p>I'm assuming both produce the same results, but I'm wrong.</p>\n\n<pre><code>        int sum ,sum2 , i , j;\n\n        for(  sum = 0,  i = 1 ; i &lt;= 5 ; sum+=i , i++ )\n            printf(\"%d\\t\",sum);\n\n        printf(\"\\n\");\n\n        for(  sum2 = 0, j = 1 ; j &lt;= 5 ; j++ ) {\n            sum2 +=j;\n            printf(\"%d\\t\",sum2); }\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code> 0  1   3   6   10\n 1  3   6   10  15\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 1, "creation_date": 1566350141, "post_id": 57583216, "comment_id": 101625371, "body": "There must be hundreds of duplicate posts on SO related to line buffering, but I can&#39;t seem to find a good one.  It&#39;s possible that so many of the questions have inappropriate titles, as this one does.  The problem here is your program is not showing any output, yet the title is &quot;how to make minutes and seconds timer&quot;.  This is not useful in any search."}, {"owner": {"reputation": 6091, "user_id": 933198, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/25a22103fd3210fdfa142843c7777ff1?s=128&d=identicon&r=PG", "display_name": "Lee Taylor", "link": "https://stackoverflow.com/users/933198/lee-taylor"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1566350311, "post_id": 57583216, "comment_id": 101625395, "body": "@paddy. That&#39;s because the OP didn&#39;t have any inkling of line buffering..."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1566350568, "post_id": 57583216, "comment_id": 101625441, "body": "I only mean to point out that the issue here is that a program produces no output.  That is the actual symptom, which would make a much better title."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1566351903, "post_id": 57583216, "comment_id": 101625661, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1716296/why-does-printf-not-flush-after-the-call-unless-a-newline-is-in-the-format-strin\">Why does printf not flush after the call unless a newline is in the format string?</a>"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1566478890, "post_id": 57583216, "comment_id": 101675190, "body": "@phuclv, The question is not about trying to get the <code>printf()</code> output unbuffered, but how to get some kind of clock (or chronometer) working.  As the OP asks at the end, the objective is to know things that are wrong in this code, so it cannot be a duplicate of the question posted."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11531878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a39a45798015a431d83764c09fd0d60?s=128&d=identicon&r=PG&f=1", "display_name": "Billbert", "link": "https://stackoverflow.com/users/11531878/billbert"}, "edited": false, "score": 0, "creation_date": 1566350019, "post_id": 57583247, "comment_id": 101625348, "body": "what does it mean that its buffered"}, {"owner": {"reputation": 35430, "user_id": 7536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/69aa4b5b81a1d2120c98ceed09446489?s=128&d=identicon&r=PG", "display_name": "eduffy", "link": "https://stackoverflow.com/users/7536/eduffy"}, "reply_to_user": {"reputation": 19, "user_id": 11531878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a39a45798015a431d83764c09fd0d60?s=128&d=identicon&r=PG&f=1", "display_name": "Billbert", "link": "https://stackoverflow.com/users/11531878/billbert"}, "edited": false, "score": 3, "creation_date": 1566350193, "post_id": 57583247, "comment_id": 101625376, "body": "It keeps the contents of what you want to display in memory until it&#39;s ready to be displayed.  Writing to the display is expensive, so the I/O routine try to be smart and wait until the optimal time to write the output.  Usually, when you begin a newline is a good time"}], "tags": [], "owner": {"reputation": 35430, "user_id": 7536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/69aa4b5b81a1d2120c98ceed09446489?s=128&d=identicon&r=PG", "display_name": "eduffy", "link": "https://stackoverflow.com/users/7536/eduffy"}, "is_accepted": false, "score": 2, "last_activity_date": 1566349955, "creation_date": 1566349955, "answer_id": 57583247, "question_id": 57583216, "link": "https://stackoverflow.com/questions/57583216/how-to-make-minutes-and-seconds-timer-in-c/57583247#57583247", "title": "How to make minutes and seconds timer in C", "body": "<p>For performance reason, <code>printf</code> is buffered.  That is, it won't display until the buffer is full.  First thing to try is to add a new-line character to the end:</p>\n\n<pre><code>    printf(\"%2d:%2d\\n\", min, sec);\n</code></pre>\n\n<p>If that doesn't work, you can force the output buffer to flush by calling <code>fflush(stdout);</code></p>\n"}, {"comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566354964, "post_id": 57583731, "comment_id": 101626169, "body": "Hmmmm I&#39;m pretty sure that <code>Sleep(1000)</code> sleeps for 1000ms = 1s, <i>not</i> 1000s."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566355043, "post_id": 57583731, "comment_id": 101626182, "body": "@MarcoBonelli: It&#39;s easy to find out (there&#39;s plenty of descriptions of the function online, like this one: <a href=\"http://man7.org/linux/man-pages/man3/sleep.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/sleep.3.html</a> )"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566355129, "post_id": 57583731, "comment_id": 101626200, "body": "Dude, it&#39;s Windows API <code>Sleep()</code> (also notice the uppercase <code>S</code>). See <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686298(v=vs.85).aspx\" rel=\"nofollow noreferrer\">here</a>. 90% of your answer is assuming Linux and therefore wrong. Your suggested code snippet is also wrong."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566355478, "post_id": 57583731, "comment_id": 101626260, "body": "@MarcoBonelli: Ah - you&#39;re right - I missed the fifth problem (using a non-standard, non-portable/vendor specific function that has nothing to do with C). Note that the 1st, 3rd, 4th and &quot;part but not all&quot; of the last problem are still relevant even with &quot;Microsoft&#39;s vendor lock-in malware&quot; function. It&#39;s not &quot;90% wrong because I assumed Linux&quot;, it&#39;s &quot;20% wrong because I assumed C&quot;."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566355935, "post_id": 57583731, "comment_id": 101626321, "body": "W-what? 1. Windows has no <code>nanosleep()</code>; 2. The code snippet is wrong, you should not do <code>expiry += delay</code>, but <code>expiry = now() + delay</code> each time; 3. <code>if(sec == 59</code> is not wrong, it&#39;s the fact that <code>sec++</code> should be in the <code>else</code> branch of that <code>if</code>... doing <code>if( sec==60</code> is still wrong since it would display <code>XX:60</code>. 4. What is even <code>now()</code>..? It&#39;s not that simple, <code>GetSystemTime()</code> should be used. This answer does not make any sense."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566356719, "post_id": 57583731, "comment_id": 101626447, "body": "@MarcoBonelli: 1. When I said &quot;depending on which compiler for which OS, there&#39;s probably something better&quot; what I meant is that depending on which compiler for which OS there&#39;s probably something better. 2. The code snippet is correct, and it&#39;s deliberately trying to avoid jitter and drift caused by reasons given. 3. In the code provided <code>if(sec == 59)</code> is wrong, there are 2 ways to fix it (my way and your way) but that doesn&#39;t mean it wasn&#39;t wrong and didn&#39;t need fixing. 4. <code>now()</code> is abstract pseudo-code with obvious but context dependent meaning (possibly <code>clock()</code> or <code>time()</code> or..)"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566357244, "post_id": 57583731, "comment_id": 101626542, "body": "<b>1</b>. Ok.. granted, I would still have corrected that with the appropriate function though. <b>2</b>. It&#39;s not correct. Doing <code>expiry += delay;</code> completely defies the purpose of using <code>now()</code> to be more &quot;accurate&quot;, since you are trusting that <code>sleep()</code> just slept for the appropriate amount of time, and you just add the expected <code>delay</code> to <code>expiry</code> when you should really re-calculate it doing <code>expiry = now() + delay</code> again. <b>3</b>. Your fix is wrong, as I said, it prints <code>0:60</code> and then <code>1:1</code>; <b>4</b>. Granted that too, but we&#39;re talking to a beginner here, same reasoning as point 1 applies IMHO."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 1, "creation_date": 1566358018, "post_id": 57583731, "comment_id": 101626629, "body": "@MarcoBonelli: 2. Um, dude. Stop and think about what happens if the OS decides to do a task switch (and run some other program for who knows how long) in the middle of the <code>printf()</code>, and/or what happens if the <code>sleep()</code> (or <code>Sleep()</code> or <code>nanosleep()</code> or <code>usleep()</code>) sleeps for longer than requested. These things will cause drift and will make the program wrong (e.g. the program saying that 10 minutes passed after 12 minutes have passed). My example is necessary to fix/avoid that drift."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566358203, "post_id": 57583731, "comment_id": 101626655, "body": "Okay, I see the point, you&#39;re right, sorry about that. Would probably need an overflow check then since <code>sleep</code> takes an unsigned value so that <code>expiry - now()</code> does not end up doing something like <code>sleep(999999)</code>, right?"}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566359279, "post_id": 57583731, "comment_id": 101626817, "body": "@MarcoBonelli: Yes, if the delay is unsigned (which is sadly common across all the variations) there&#39;s a risk of overflow. I mostly bury it all (including compiler/OS specific <code>#ifdef</code> to select the least awful functions for portability) under my own wrappers so I can end up with a portable custom time format (partly because C ends up being a horrible mixture of different time formats when you start trying to mix <code>time()</code> with <code>select</code> with <code>pthread_cond_timedwait()</code> and... where some has nasty leap second problems and some has &quot;year 2038&quot; bugs and most is non-portable)."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566478566, "post_id": 57583731, "comment_id": 101674981, "body": "@MarcoBonelli, <code>Sleep()</code> is a windows function, misnamed after one ancient unix function, <code>sleep()</code> that sleeps a number of seconds.  While it is true that <code>Sleep()</code> (the windows version) sleeps a number of milliseconds, It fails to do that, depending on the windows (or ms-dos, as it is also defined in microsoft compilers for ms-dos) versions you call, mainly because of the kernel time tick spacing those systems have.  <code>Sleep()</code> (the windows version) is not in any standard, but in the Microsoft documentation.  Nowhere else."}], "tags": [], "owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "is_accepted": false, "score": -1, "last_activity_date": 1566354841, "creation_date": 1566354841, "answer_id": 57583731, "question_id": 57583216, "link": "https://stackoverflow.com/questions/57583216/how-to-make-minutes-and-seconds-timer-in-c/57583731#57583731", "title": "How to make minutes and seconds timer in C", "body": "<blockquote>\n  <p>Does anything look wrong in my code?</p>\n</blockquote>\n\n<p>Several things look wrong. The first is <code>stdout</code> line buffering - see eduffy's answer for that.</p>\n\n<p>The second problem is that you're doing <code>sec++; sleep(1000);</code>, which means that <code>sec</code> will be incremented once every 1000 seconds or more.</p>\n\n<p>The third problem is that <code>if(sec == 59;</code> is wrong and needs to be <code>if(sec == 60)</code>. Otherwise you'll have 59 seconds per minute.</p>\n\n<p>The fourth problem is that <code>sleep(1)</code> will sleep for at least 1 second, but may sleep for 2 seconds, or 10 seconds, or 1234 seconds. To guard against this you want something more like this:</p>\n\n<pre><code>expiry = now() + delay;\nwhile(true) {\n    sleep(expiry - now() ):\n    expiry += delay;\n }\n</code></pre>\n\n<p>The basic idea being that if one sleep takes too long then the next sleep will sleep less; and it'll end up being \"correct on average\".</p>\n\n<p>The last problem is that <code>sleep()</code> doesn't really have enough precision. For 1 second delays you want to be able to sleep for fractions of a second (e.g. like maybe 9/10ths of a second). Depending on which compiler for which OS, there's probably something better you can use (e.g. maybe <code>nanosleep()</code>). Sadly there may be nothing that's actually good (e.g. some sort of \"<code>nanosleep_until(expiry_time)</code>\" that prevents jitter caused by IRQs and/or task switches that occur after you determine <code>now</code> but before you call something like \"<code>nanosleep()</code>\").</p>\n"}, {"tags": [], "owner": {"reputation": 1322, "user_id": 1087492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RU0jR.jpg?s=128&g=1", "display_name": "Lloyd Macrohon", "link": "https://stackoverflow.com/users/1087492/lloyd-macrohon"}, "is_accepted": false, "score": 0, "last_activity_date": 1566360856, "creation_date": 1566360856, "answer_id": 57584336, "question_id": 57583216, "link": "https://stackoverflow.com/questions/57583216/how-to-make-minutes-and-seconds-timer-in-c/57584336#57584336", "title": "How to make minutes and seconds timer in C", "body": "<p>I would just check the system time rather than keeping track of seconds/minutes. This is because, your Sleep may not be exactly 1000ms, so over time your counter will not be accurate.</p>\n\n<p>Since you're using Windows, here's a slightly modified version of your code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;windows.h&gt;\n\nint main()\n{\n    for (;;)\n    {\n        time_t now = time(NULL);\n        struct tm* ptm = localtime(&amp;now);\n        printf(\"%02d:%02d\\n\", ptm-&gt;tm_min, ptm-&gt;tm_sec);\n        Sleep(1000);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I hope that helps.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1566482203, "last_edit_date": 1592644375, "creation_date": 1566480489, "answer_id": 57610490, "question_id": 57583216, "link": "https://stackoverflow.com/questions/57583216/how-to-make-minutes-and-seconds-timer-in-c/57610490#57610490", "title": "How to make minutes and seconds timer in C", "body": "<p>As you ask, there are several things wrong in your code, I'll tell you as I read it.  See below.</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;windows.h&gt;\n\n#define TRUE 1\n\nint main( void )\n{\n\n    int min = 0;\n    int sec = 0;\n\n    while (TRUE)\n    {\n        sec++;\n        Sleep(1000);\n</code></pre>\n<ol>\n<li>There's a problem with <code>Sleep()</code>.  The thing is that you ask the kernel to pause your program for <code>1000</code> milliseconds, but that means that the kernel will awake your program 1 second <strong>after</strong> your call it to pause.  This doesn't take into account the fact that the kernel will put in the schedule queue your process and it will, in general never take the cpu immediately, but after some delay.  Then, even if you get the cpu immediately, your code will need some time to execute, making the total loop longer than 1000 ms.  And your clock will be slow.  It is better to get the system time and show it on the screen, or to take a timestamp when you start... and then show the difference in time from the start time to the timestamp you get at each display.  The system time is maintained by an interrupt, that happens at regular intervals (by means of a precise clock oscillator) so you'll get a good clock time that way, instead of your slow clock (how slow it is will depend on things like how many other processes you are running on the system)</li>\n</ol>\n<pre><code>            printf(&quot;%2d:%2d&quot;, min, sec);\n</code></pre>\n<ol start=\"2\">\n<li><p>This has already been stated in other answers, but let me explain how it works so you can understand how buffering works.  A buffer is a large block of memory (normally it is 512 bytes) that is filled by <code>printf()</code> so it only calls <code>write()</code> when it has filled a complete buffer of data.  This allows stdio to save system calls to do the actual writing and so, be more efficient when transferring large amounts of data.</p>\n<p>On interactive applications, this is not applicable, as no output would be done if you don't force the buffers to <code>fflush()</code> before any input is done, so when the output is a tty device (something that stdio can know from the file descriptor associated to standard output) then it switches to line mode buffering, and that means that <code>printf()</code> will flush out the buffer when: 1) it is filled up, or 2) when a newline <code>\\n</code> character is found in the output.  So, one way to solve your problem is to put a <code>\\n</code> at the end of the string, or to call <code>fflush(stdout);</code> after calling <code>printf()</code>.</p>\n</li>\n</ol>\n<pre><code>            if (sec == 59)\n</code></pre>\n<ol start=\"3\">\n<li>as you increment your seconds before comparing, you have to check against <code>60</code> and not <code>59</code>, as you compare with <code>60</code> to convert it to <code>0</code> <em>after you have already incremented the seconds</em>.</li>\n</ol>\n<pre><code>            {\n                min++;\n</code></pre>\n<ol start=\"4\">\n<li>You should have to do the same with the minutes, when minutes get to <code>60</code>.  As you have not included this code, I assume you are not considering an hours chrono.</li>\n</ol>\n<pre><code>                sec = 0;\n            }\n        }\n        return 0;\n    }\n</code></pre>\n<hr />\n<p>A complete solution for what I mean can be:</p>\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;windows.h&gt;\n\nint main()\n{\n    long start_timestamp;\n    long display_timestamp;\n\n    start_timestamp = time(NULL);\n\n    for(;;) { /* this is the same as while(TRUE) */\n            display_timestamp = time(NULL);\n            int elapsed = display_timestamp - start_timestamp;\n            int min = elapsed / 60;\n            int sec = elapsed % 60;\n            /* the \\r in next printf will make to print a single carry\n             * return in the same line, so the time updates on top of\n             * itself */\n            printf(&quot;\\r%02d:%02d&quot;, min, sec); fflush(stdout);\n            Sleep(100); /* as you print the time elapsed, you don't\n                         * mind if you shorten the time between \n                         * displays. */\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11531878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a39a45798015a431d83764c09fd0d60?s=128&d=identicon&r=PG&f=1", "display_name": "Billbert", "link": "https://stackoverflow.com/users/11531878/billbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1566482203, "creation_date": 1566349663, "last_edit_date": 1566349843, "question_id": 57583216, "link": "https://stackoverflow.com/questions/57583216/how-to-make-minutes-and-seconds-timer-in-c", "title": "How to make minutes and seconds timer in C", "body": "<p>I'm struggling to make a timer in c that counts minutes and seconds. I'm trying to test it by printing the time to the console but it doesn't seem to show anything. Does anything look wrong in my code?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;windows.h&gt;\n\n#define TRUE 1\n\nint main( void )\n{\n\n    int min = 0;\n    int sec = 0;\n\n    while (TRUE)\n    {\n        sec++;\n        Sleep(1000);\n        printf(\"%2d:%2d\", min, sec);\n        if (sec == 59)\n        {\n            min++;\n            sec = 0;\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11383897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4d1f1ed9dec6f65be7b53de74cfd16?s=128&d=identicon&r=PG&f=1", "display_name": "nextgenben99", "link": "https://stackoverflow.com/users/11383897/nextgenben99"}, "edited": false, "score": 0, "creation_date": 1566349406, "post_id": 57583101, "comment_id": 101625265, "body": "What does that mean"}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1566348280, "creation_date": 1566348280, "answer_id": 57583101, "question_id": 57583054, "link": "https://stackoverflow.com/questions/57583054/how-to-make-minutes-and-seconds-stopwatch-in-c/57583101#57583101", "title": "How to make minutes and seconds stopwatch in c", "body": "<p>You have to either output entire lines of text or call <code>fflush</code>. Otherwise, <code>printf</code> just puts text into the output buffer.</p>\n"}], "owner": {"reputation": 33, "user_id": 11383897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4d1f1ed9dec6f65be7b53de74cfd16?s=128&d=identicon&r=PG&f=1", "display_name": "nextgenben99", "link": "https://stackoverflow.com/users/11383897/nextgenben99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "closed_date": 1566355255, "answer_count": 1, "score": 0, "last_activity_date": 1566348280, "creation_date": 1566347699, "question_id": 57583054, "link": "https://stackoverflow.com/questions/57583054/how-to-make-minutes-and-seconds-stopwatch-in-c", "closed_reason": "Duplicate", "title": "How to make minutes and seconds stopwatch in c", "body": "<p>Im trying to make a minutes and seconds timer but am having some trouble. The timer does not have to stop, as it will rarely go up to 5 mins.</p>\n\n<p>Im trying to format it as mm:ss.</p>\n\n<pre><code>#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;windows.h&gt; \n\n#define TRUE 1\n\nint main( void ) {\n\n    int min = 0;\n    int sec = 0;\n\n\n    while(TRUE){\n    printf(\"%02d : %02d\", min, sec);\n    sec++;\n    Sleep(1000); \n    if (sec == 59){\n        min++;\n        sec = 0;\n    }\n\n\n    } \n    return 0;\n}\n</code></pre>\n\n<p>I've been trying this code but it does not seem to show the timer in the terminal when I run it. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1566344896, "post_id": 57582732, "comment_id": 101624661, "body": "It prints the text due to the <code>putchar(c)</code>, skip this line if you dont want the echo"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566345507, "post_id": 57582732, "comment_id": 101624732, "body": "Yes, <code>getchar</code> uses previously entered text if there is any. When you enter a line, the characters in it, including a new-line character, are stored in a buffer. <code>getchar</code> is part of a system, actually multiple pieces of software (C, operating system, terminal emulator, other stuff) working together, and it will get characters in the buffer before it waits for you to enter more in the terminal window."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1566429297, "post_id": 57582732, "comment_id": 101657606, "body": "<code>stdin</code> is a input stream.   The C program does not &#39;see&#39; anything until the &#39;terminal&#39; handler passes the <code>stdin</code> input buffer to the program.  Unless the terminal handler options are modified, the terminal handler will not pass anything to the C program until it sees a newline (typically &#39;\\r&#39; or &#39;n&#39; or EOF)  That is known as <code>line buffering</code>.  The terminal handler can be commanded to not echo, run in &#39;raw&#39; mode (not buffered), etc. Varying the terminal mode via: <code>#include &lt;termios.h&gt;   struct termios myTermios;   tcgetattr(STDIN_FILENO, &amp;myTermios); tcsetattr( STDIN_FILENO, myTermios );</code>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1566359217, "post_id": 57582988, "comment_id": 101626799, "body": "&quot;By default&quot; is unclear.  Certainly line buffering is common for <code>stdin</code>, yet not by <i>default</i>."}, {"owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1566370034, "post_id": 57582988, "comment_id": 101629659, "body": "@chux: Here <i>&quot;By default&quot;</i> means <i>&quot;unless the program has requested a specific buffering mode with <code>setvbuf()</code>&quot;</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1566404631, "post_id": 57582988, "comment_id": 101648759, "body": "caf, I do not find anything in the C spec that supports the idea &quot;default: line-buffered&quot;.  Best I see the <i>default</i> is implementation defined - which does meet the idea of &quot;usual&quot; in the answer as &quot;line-buffered&quot;."}, {"owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1566477707, "post_id": 57582988, "comment_id": 101674442, "body": "@chux: Exactly so.  The buffering mode if you haven&#39;t specifically set one is up to the implementation, but the usual case (across commonly encountered implementations) is to be line-buffered."}], "tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": true, "score": 1, "last_activity_date": 1566347183, "last_edit_date": 1566347183, "creation_date": 1566346948, "answer_id": 57582988, "question_id": 57582732, "link": "https://stackoverflow.com/questions/57582732/using-getchar-in-c/57582988#57582988", "title": "Using getchar in C", "body": "<p><code>getchar()</code> reads from the \"standard input\" stream.  By default, it is usual for this stream to be line-buffered, which means that no input is delivered until a complete line is available.</p>\n\n<p>So, when you run your program, it stops at the first <code>getchar()</code> until you enter a complete line.  It then runs around the loop, with <code>getchar()</code> immediately returning each subsequent character in that line up to and including the terminating newline.  The next <code>getchar()</code> after that will then block again, waiting for another line.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 9906416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28790a38b6a223a25e5a1acfcbec2bfb?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/9906416/steven"}, "is_accepted": false, "score": 0, "last_activity_date": 1566347915, "creation_date": 1566347915, "answer_id": 57583071, "question_id": 57582732, "link": "https://stackoverflow.com/questions/57582732/using-getchar-in-c/57583071#57583071", "title": "Using getchar in C", "body": "<p>since <code>getchar()</code> reads a single character from a buffer, even if you enter new input it will keep reading the old buffered input until it runs out of characters. </p>\n\n<p>If you want to be able to input multiple characters but only read the first character of different inputs, then you have to clear the input buffer before the next <code>getchar()</code> read.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 57582988, "answer_count": 2, "score": 2, "last_activity_date": 1566347915, "creation_date": 1566344272, "question_id": 57582732, "link": "https://stackoverflow.com/questions/57582732/using-getchar-in-c", "title": "Using getchar in C", "body": "<p>In the following function:</p>\n\n<pre><code>int main() {\n\n    int c;\n\n    c=getchar();\n    while (c != EOF) {\n        putchar(c);\n        c = getchar();\n    }\n\n}\n</code></pre>\n\n<p>The first time it runs <code>getchar()</code> it \"waits\" for me to enter in text. But the next time (after I've entered in text), it prints the text previously entered. Does <code>getchar()</code> work differently depending on whether there's been a previous input, or how exactly does that item work?</p>\n\n<p>If someone could explain what's going on in the above while look that would be great.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 2, "creation_date": 1566343317, "post_id": 57582621, "comment_id": 101624373, "body": "Nops, <code>const</code> is not preserved, and you should get a warning from the compiler at least in pedantic mode."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1566343381, "post_id": 57582621, "comment_id": 101624387, "body": "In this example p will contain a garbage value pointing to nowhere in particular."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1566343890, "post_id": 57582621, "comment_id": 101624478, "body": "@DavidRanieri: Neither GCC nor Clang warn with <code>-Wall</code> (although Clang does with <code>-Weverything</code>), and there is no reason <code>-pedantic</code> should change that, as it is a conversion defined by the standard. More than that, casting away <code>const</code> is required to use <code>printf(&quot;%p&quot;)</code> properly, as its argument should be <code>void *</code>. It is also sometimes needed when a module cast a <code>T *</code> to <code>const T *</code> when giving it to another module and later receives back the <code>const T *</code> that it needs to revert to <code>T *</code>. That is a shortcoming in the C language due to historical development, but it is the way it is."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1566349804, "post_id": 57582621, "comment_id": 101625319, "body": "With <code>const void* a; char* p = (char*)a;</code>, The assignment causes <code>p</code>to have an indeterminate value or causes a trap."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1566344613, "last_edit_date": 1566344613, "creation_date": 1566344224, "answer_id": 57582723, "question_id": 57582621, "link": "https://stackoverflow.com/questions/57582621/is-the-const-qualifier-in-c-preserved-when-casting-a-const-pointer/57582723#57582723", "title": "Is the const qualifier in c preserved when casting a const pointer?", "body": "<p>Let us consider this code first:</p>\n\n<pre><code>const char c = 'x';\nchar *p = (char *) &amp;c;\n</code></pre>\n\n<p><code>p</code> points to <code>x</code> and has type <code>char *</code>, not <code>const char *</code>. However, <code>x</code> remains defined with <code>const</code>, and the C standard does not define the behavior of attempting to modify <code>*p</code>, as by executing <code>*p = 'y';</code>.</p>\n\n<p>Next, consider this code:</p>\n\n<pre><code>char c = 'x';\nconst char *p = &amp;c;\nchar *q = (char *) p;\n</code></pre>\n\n<p>In the third statement, the <code>const char *p</code> is converted to a <code>char *</code>. This is allowed. Furthermore, <code>*q = 'y';</code> is defined by the C standard. What is important is whether the object was originally <strong>defined</strong> with <code>const</code>.</p>\n\n<p>You are allowed to explicitly convert pointers to add and remove <code>const</code>. However, it is your obligation to know whether the original object was defined with <code>const</code>. If it was, the behavior of modifying it is not defined, regardless of any conversions. If it was not, you may modify the object, using a pointer without <code>const</code>, regardless of any intervening conversions.</p>\n\n<p>Note that in <code>const char *p = &amp;c;</code> no cast is needed. The language allows <code>const</code> to be implicitly added. However, it cannot be implicitly removed; you must use an explicit cast when removing <code>const</code>.</p>\n\n<p>In the case of your original code:</p>\n\n<pre><code>const void* a;\nchar* p = (char*)a;\n</code></pre>\n\n<p>We do not know what <code>a</code> was pointing at. We do know that <code>p</code> carries no record of whether it was <code>const</code> or not. However, the C implementation may have that information in one form or another, and, if you attempt to use <code>p</code> to modify an object that was originally defined with <code>const</code>, then the behavior is not defined by the C standard.</p>\n"}], "owner": {"reputation": 319, "user_id": 11923251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dca75f80755c3c08edba8a539cd399d?s=128&d=identicon&r=PG&f=1", "display_name": "duper21", "link": "https://stackoverflow.com/users/11923251/duper21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 57582723, "answer_count": 1, "score": 0, "last_activity_date": 1566344613, "creation_date": 1566343091, "question_id": 57582621, "link": "https://stackoverflow.com/questions/57582621/is-the-const-qualifier-in-c-preserved-when-casting-a-const-pointer", "title": "Is the const qualifier in c preserved when casting a const pointer?", "body": "<p>For example would p be pointing to a constant char?</p>\n\n<pre><code>const void* a;\nchar* p = (char*)a;\n</code></pre>\n"}, {"tags": ["c", "linux", "cross-platform"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566335386, "post_id": 57581409, "comment_id": 101622540, "body": "Please explicitly include a problem statement (i.e. a question with a question mark) in your question."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 0, "creation_date": 1566335927, "post_id": 57581409, "comment_id": 101622737, "body": "@shellter That isn&#39;t necessary for this question. It&#39;s asking about something other than code that&#39;s not working."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566336141, "post_id": 57581409, "comment_id": 101622819, "body": "Can you give us a few examples of what you&#39;re trying to do?"}, {"owner": {"reputation": 4082, "user_id": 314005, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c544a6691017a7b88319f3a1bd5bbeb?s=128&d=identicon&r=PG", "display_name": "Nick Banks", "link": "https://stackoverflow.com/users/314005/nick-banks"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1566336438, "post_id": 57581409, "comment_id": 101622907, "body": "@JL2210 It&#39;s a cross platform network library, that both has it&#39;s own error codes (success and failure) and returns system error codes."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566336702, "post_id": 57581409, "comment_id": 101622978, "body": "@NickBanks Any <i>specific</i> examples?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 2, "creation_date": 1566349626, "post_id": 57581409, "comment_id": 101625298, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/3952342/608639\">Convert errno.h error values to Win32 GetLastError() equivalents</a>, <a href=\"https://stackoverflow.com/q/12352922/608639\">In Windows, is there any way to convert an errno into an HRESULT?</a>, etc."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1566350744, "post_id": 57581409, "comment_id": 101625477, "body": "I also think you should  handle errors independently at the library level based on the OS results. That is, your application maps <code>Win32:ERROR_ACCESS_DENIED</code> and <code>Linux:EACCES</code> to a library error like <code>MyLib:ACCESS_DENIED</code>. You can also map other types of errors, like <code>SQLite:SQLITE_PERM</code> into  <code>MyLib:ACCESS_DENIED</code>. I found that is cleanest based on a cross-platform library that supported Android, BSDs, iOS, Linux, OS X and Windows."}], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 0, "last_activity_date": 1566338462, "last_edit_date": 1566338462, "creation_date": 1566335326, "answer_id": 57581556, "question_id": 57581409, "link": "https://stackoverflow.com/questions/57581409/how-do-i-represent-success-status-codes-in-linux/57581556#57581556", "title": "How do I Represent Success Status Codes in Linux", "body": "<p>To get the error return code from a function in Linux, use the function's return value (usually nonzero on error) and the value of the <code>errno</code> variable, from <code>errno.h</code>.</p>\n\n<p>Search for \"linux errno codes\" or run <code>man errno</code> on Linux to get more information.</p>\n\n<p><code>errno</code> (and return statuses) are usually represented as an <code>int</code>, so that's what I'd go with if you're looking for a type to use.</p>\n\n<p>For example, checking to see if the return code of non-blocking <code>connect</code> is negative one and <code>errno</code> is <code>EINPROGRESS</code> is the same as checking for <code>STATUS_PENDING</code> in Windows.</p>\n\n<p>Here's some pseudocode to respond to your pseudocode example:</p>\n\n<pre><code>#ifdef _WIN32\ntypedef /* Windows stuff */ MY_STATUS;\n# define MY_FAILED(x) /* Windows stuff */\n#else /* POSIX, other reasonable operating systems, etc. */\ntypedef int MY_STATUS;\n# define MY_FAILED(x) ((x) == -1)\n#endif\n</code></pre>\n\n<p>Of course, this assumes that your functions will return <code>int</code> or something similar, which may not be the case. But you get the idea.</p>\n"}, {"comments": [{"owner": {"reputation": 4082, "user_id": 314005, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c544a6691017a7b88319f3a1bd5bbeb?s=128&d=identicon&r=PG", "display_name": "Nick Banks", "link": "https://stackoverflow.com/users/314005/nick-banks"}, "edited": false, "score": 0, "creation_date": 1566483989, "post_id": 57581643, "comment_id": 101678420, "body": "So, bottom line, there isn&#39;t any clear definition of error codes in Linux? I&#39;ll just have to figure something out for my library?"}, {"owner": {"reputation": 14754, "user_id": 1827600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KHa84.png?s=128&g=1", "display_name": "suspectus", "link": "https://stackoverflow.com/users/1827600/suspectus"}, "reply_to_user": {"reputation": 4082, "user_id": 314005, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c544a6691017a7b88319f3a1bd5bbeb?s=128&d=identicon&r=PG", "display_name": "Nick Banks", "link": "https://stackoverflow.com/users/314005/nick-banks"}, "edited": false, "score": 0, "creation_date": 1566484234, "post_id": 57581643, "comment_id": 101678583, "body": "<i>Error codes</i> , yes. Status codes, no. The full set of linux error codes are listed here: <a href=\"http://man7.org/linux/man-pages/man3/errno.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/errno.3.html</a>"}], "tags": [], "owner": {"reputation": 14754, "user_id": 1827600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KHa84.png?s=128&g=1", "display_name": "suspectus", "link": "https://stackoverflow.com/users/1827600/suspectus"}, "is_accepted": true, "score": 6, "last_activity_date": 1566485003, "last_edit_date": 1566485003, "creation_date": 1566335869, "answer_id": 57581643, "question_id": 57581409, "link": "https://stackoverflow.com/questions/57581409/how-do-i-represent-success-status-codes-in-linux/57581643#57581643", "title": "How do I Represent Success Status Codes in Linux", "body": "<p>For <strong>error codes</strong> in linux there are the constants defined in errno.h header file. The error constants are available from man page <code>man 3 errno</code>. Also there is: <a href=\"https://stackoverflow.com/questions/503878/how-to-know-what-the-errno-means\">What errno means</a></p>\n\n<p>As for <strong>exit status codes</strong>, there is no standard set of codes. The value 0 has always denoting success, and non-zero value has denoted an error state. Bash, for example has this <a href=\"https://www.gnu.org/software/bash/manual/html_node/Exit-Status.html\" rel=\"nofollow noreferrer\">Bash exit status information</a>. </p>\n\n<blockquote>\n  <p>All of the Bash builtins return an exit status of zero if they succeed\n  and a non-zero status on failure, so they may be used by the\n  conditional and list constructs. All builtins return an exit status of\n  2 to indicate incorrect usage, generally invalid options or missing\n  arguments.</p>\n</blockquote>\n\n<p>There is <a href=\"https://www.freebsd.org/cgi/man.cgi?query=sysexits\" rel=\"nofollow noreferrer\">sysexits</a> which was an attempt to define a set of status codes, but it has been largely ignored in the field of linux software.</p>\n\n<p>For more info: <a href=\"https://stackoverflow.com/questions/1101957/are-there-any-standard-exit-status-codes-in-linux\">Exit Status codes in Linux</a></p>\n"}], "owner": {"reputation": 4082, "user_id": 314005, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c544a6691017a7b88319f3a1bd5bbeb?s=128&d=identicon&r=PG", "display_name": "Nick Banks", "link": "https://stackoverflow.com/users/314005/nick-banks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 57581643, "answer_count": 2, "score": 5, "last_activity_date": 1566485003, "creation_date": 1566334516, "last_edit_date": 1566395249, "question_id": 57581409, "link": "https://stackoverflow.com/questions/57581409/how-do-i-represent-success-status-codes-in-linux", "title": "How do I Represent Success Status Codes in Linux", "body": "<p>Windows has different types of status codes, <code>HRESULT</code> and <code>NTSTATUS</code> for instance, that allow for representing both success and failure values. This allows for macros like <code>FAILED</code> and <code>NT_SUCCESS</code>. One example of a success status code is <code>STATUS_PENDING</code> that indicates an IO is not yet complete.</p>\n\n<p>I'm trying to map similar style status codes in Linux. I have a (WIP) cross platform library that uses the above type of status codes on Windows (user mode and kernel mode). I have my own \"FAILED\" macro that wraps the above macros. I need an equivalent for Linux for it all.</p>\n\n<p>I've looked around and haven't found anything interesting/helpful. For any system/platform function (sockets, thread, locks) that might return and error, I need to make sure it is converted to the appropriate status code type. Windows has lots of helpers for things like this, but I'm not sure about Linux.</p>\n\n<p>Psuedocode example:</p>\n\n<pre><code>MY_STATUS SendAsync(...) {\n   ASYNC_OPERATION* Operation = MY_ALLOC(...)\n   if (Operation == NULL) {\n       return MY_OUT_OF_MEMORY_ERROR; // Error status\n   }\n   // Build the operation\n   MY_STATUS Status = QueueOperation(Operation);\n   if (MY_FAILED(Status)) {\n       return Status;\n   }\n   return MY_STATUS_PENDING; // Success status\n}\n</code></pre>\n\n<p>The caller should then be able to have the following code:</p>\n\n<pre><code>MY_STATUS Status = SendAsync(...)\nif (MY_FAILED(Status)) {\n   // Bail\n}\n// Handle success\n</code></pre>\n\n<p>I think the crux of the problem is that I don't know how to stuff status codes from system/platform function calls into a generic type that supports success/fail. Generally, it looks like all the status codes are positive, so I could just say my success error codes are <code>&lt;= 0</code>. But I'm not sure that's a great solution.</p>\n\n<p>To be clear, since it was proposed that <a href=\"https://stackoverflow.com/questions/12352922/in-windows-is-there-any-way-to-convert-an-errno-into-an-hresult\">this question</a> might the answer, I'm not trying to force the Linux status/error codes into <code>HRESULT</code> format explicitly. I'm just trying to find <em>some way</em> to represent error codes as either success or failure. If I have to convert system error codes (negate them?) along the way, that's acceptable. If there is no real solution to this problem, then that would be an acceptable answer (though not desired), and I'll have to find some work around.</p>\n"}, {"tags": ["c", "linux", "process", "exec"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1566334668, "post_id": 57581393, "comment_id": 101622294, "body": "Have you read the man page for <code>execve</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 9638690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea991cf7b6fa5d6e9f0a402fb751b8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Hussein Hijazi", "link": "https://stackoverflow.com/users/9638690/hussein-hijazi"}, "edited": false, "score": 0, "creation_date": 1566336123, "post_id": 57581588, "comment_id": 101622813, "body": "Thanks for pointing out about the documentation of execve (I only read that of the exec family ). Can I generalize and say that all the PCB data is preserved upon the execve?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 187, "user_id": 9638690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea991cf7b6fa5d6e9f0a402fb751b8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Hussein Hijazi", "link": "https://stackoverflow.com/users/9638690/hussein-hijazi"}, "edited": false, "score": 0, "creation_date": 1566336212, "post_id": 57581588, "comment_id": 101622837, "body": "@HusseinHijazi Read this again: <i>&quot;All process attributes are preserved during an execve(), except the following&quot;</i>"}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": true, "score": 1, "last_activity_date": 1566335521, "creation_date": 1566335521, "answer_id": 57581588, "question_id": 57581393, "link": "https://stackoverflow.com/questions/57581393/on-what-basis-are-aspects-of-the-environment-kept-upon-a-call-to-execve/57581588#57581588", "title": "On what basis are aspects of the environment kept upon a call to execve()?", "body": "<p>From <code>execve(3)</code>:</p>\n\n<blockquote>\n  <p>All process attributes are preserved during an execve(), except the\n  following:</p>\n  \n  <ul>\n  <li><p>The dispositions of any signals that are being caught are reset\n  to the default (signal(7)).</p></li>\n  <li><p>Any alternate signal stack is not preserved (sigaltstack(2)).</p></li>\n  <li><p>Memory mappings are not preserved (mmap(2)).</p></li>\n  <li><p>Attached System V shared memory segments are detached\n  (shmat(2)).</p></li>\n  <li><p>POSIX shared memory regions are unmapped (shm_open(3)).</p></li>\n  <li><p>Open POSIX message queue descriptors are closed\n  (mq_overview(7)).</p></li>\n  <li><p>Any open POSIX named semaphores are closed (sem_overview(7)).</p></li>\n  <li><p>POSIX timers are not preserved (timer_create(2)).</p></li>\n  <li><p>Any open directory streams are closed (opendir(3)).</p></li>\n  <li><p>Memory locks are not preserved (mlock(2), mlockall(2)).</p></li>\n  <li><p>Exit handlers are not preserved (atexit(3), on_exit(3)).</p></li>\n  <li><p>The floating-point environment is reset to the default (see\n  fenv(3)).</p></li>\n  </ul>\n</blockquote>\n\n<p>POSIX also mandates this (although negated):</p>\n\n<blockquote>\n  <p>The new process shall inherit at least the following attributes from\n  the calling process image:</p>\n  \n  <ul>\n  <li><p>Nice value (see nice())</p></li>\n  <li><p>semadj values (see semop())</p></li>\n  <li><p>Process ID</p></li>\n  <li><p>Parent process ID</p></li>\n  <li><p>Process group ID</p></li>\n  <li><p>Session membership</p></li>\n  <li><p>Real user ID</p></li>\n  <li><p>Real group ID</p></li>\n  <li><p>Supplementary group IDs</p></li>\n  <li><p>Time left until an alarm clock signal (see alarm())</p></li>\n  <li><p>Current working directory</p></li>\n  <li><p>Root directory</p></li>\n  <li><p>File mode creation mask (see umask())</p></li>\n  <li><p>File size limit (see getrlimit() and setrlimit())</p></li>\n  <li><p>Process signal mask (see pthread_sigmask())</p></li>\n  <li><p>Pending signal (see sigpending())</p></li>\n  <li><p>tms_utime, tms_stime, tms_cutime, and tms_cstime (see times())</p></li>\n  <li><p>Resource limits</p></li>\n  <li><p>Controlling terminal</p></li>\n  <li><p>Interval timers</p></li>\n  </ul>\n  \n  <p>The initial thread of the new process shall inherit at least the\n  following attributes from the calling thread:</p>\n  \n  <ul>\n  <li><p>Signal mask (see sigprocmask() and pthread_sigmask())</p></li>\n  <li><p>Pending signals (see sigpending())</p></li>\n  </ul>\n  \n  <p>All other process attributes defined in this volume of POSIX.1-2017\n  shall be inherited in the new process image from the old process\n  image. All other thread attributes defined in this volume of\n  POSIX.1-2017 shall be inherited in the initial thread in the new\n  process image from the calling thread in the old process image. The\n  inheritance of process or thread attributes not defined by this volume\n  of POSIX.1-2017 is implementation-defined.</p>\n</blockquote>\n"}], "owner": {"reputation": 187, "user_id": 9638690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea991cf7b6fa5d6e9f0a402fb751b8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Hussein Hijazi", "link": "https://stackoverflow.com/users/9638690/hussein-hijazi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "closed_date": 1566340570, "accepted_answer_id": 57581588, "answer_count": 1, "score": -1, "last_activity_date": 1566341685, "creation_date": 1566334430, "last_edit_date": 1566341685, "question_id": 57581393, "link": "https://stackoverflow.com/questions/57581393/on-what-basis-are-aspects-of-the-environment-kept-upon-a-call-to-execve", "closed_reason": "Not suitable for this site", "title": "On what basis are aspects of the environment kept upon a call to execve()?", "body": "<p>I know that <code>exec</code> should replace the entire process image, but I also know that some things like file descriptors are preserved upon a call to one of the <code>exec</code>-family functions.</p>\n\n<p>On what basis are aspects of the environment kept upon a call to <code>execve()</code>?</p>\n"}, {"tags": ["c", "linux", "sockets", "server", "command-line-arguments"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1566342151, "post_id": 57581082, "comment_id": 101624161, "body": "You aren&#39;t checking the return from recv.   There is no guarantee that a complete buffer is sent in a single packet."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1566342268, "post_id": 57581082, "comment_id": 101624180, "body": "Also, you&#39;re doing strlen on a buffer that is not guaranteed to be null-terminated."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1566355772, "post_id": 57581082, "comment_id": 101626296, "body": "<i>I am using <code>RE_USEADDR</code>, but still facing the problem&quot;</i> - I believe it is <code>SO_REUSEADDR</code>. Also see <a href=\"https://stackoverflow.com/q/14388706/608639\">How do SO_REUSEADDR and SO_REUSEPORT differ?</a> and friends. You may be restarting too soon. In this case, reduce <code>SO_LINGER</code>. Lingering helps with client shutdowns in transit to the old [dead] server."}], "answers": [{"tags": [], "owner": {"reputation": 20, "user_id": 4642828, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xwoZ9QJAESY/AAAAAAAAAAI/AAAAAAAAOoc/uEjpT71cQyA/photo.jpg?sz=128", "display_name": "Sarath Padakandla", "link": "https://stackoverflow.com/users/4642828/sarath-padakandla"}, "is_accepted": false, "score": -1, "last_activity_date": 1566334437, "creation_date": 1566334437, "answer_id": 57581394, "question_id": 57581082, "link": "https://stackoverflow.com/questions/57581082/binding-failed-cannot-assign-requested-address/57581394#57581394", "title": "Binding failed : Cannot assign requested address", "body": "<p>When you come out of the program, the socket is not closed gracefully. I would recommend use the signal interrupt handler and close the welcomeSocket.</p>\n\n<pre><code>void sigintHandler(int sig_num) {\nclose(welcomeSocket);\n}\n\nint main(){\nsignal(SIGINT, sigintHandler);\n...\n...\nyour code\nwhile (1) {\n  //code\n}\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1566353232, "creation_date": 1566353232, "answer_id": 57583549, "question_id": 57581082, "link": "https://stackoverflow.com/questions/57581082/binding-failed-cannot-assign-requested-address/57583549#57583549", "title": "Binding failed : Cannot assign requested address", "body": "<p>The <code>htonl</code> function expects a 32 bit integer value.  You are instead passing the address of a string, so you are actually attempting to use this address, converted to a 32 bit value in network byte order, as an IP address.</p>\n\n<p>You instead want to pass the string to <code>inet_addr</code> which converts the string representation of an IPv4 address to a 32 bit value in network byte order.</p>\n\n<pre><code>serverAddr.sin_addr.s_addr = inet_addr(argv[1]);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9497233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G9atl.png?s=128&g=1", "display_name": "are-you-an", "link": "https://stackoverflow.com/users/9497233/are-you-an"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566353232, "creation_date": 1566332748, "last_edit_date": 1566341382, "question_id": 57581082, "link": "https://stackoverflow.com/questions/57581082/binding-failed-cannot-assign-requested-address", "title": "Binding failed : Cannot assign requested address", "body": "<p>While running this server code for 2nd time, I get this error </p>\n\n<blockquote>\n  <p>\"Binding failed: Cannot assign requested address\".</p>\n</blockquote>\n\n<p>I am using <code>RE_USEADDR</code>, but still facing the problem. I understand the server is not getting closed after use.</p>\n\n<p><strong>command line input:</strong></p>\n\n<p><em>arg[1]=<strong>127.0.0.1</strong>, arg[2]=<strong>5019</em></strong></p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid reverse(char*, int, int);\n\nint main(int argc, char* argv[]){\nint welcomeSocket, newSocket;\nchar buffer[1024];\nstruct sockaddr_in serverAddr;\nstruct sockaddr_storage serverStorage;\nsocklen_t addr_size;\nint val=1;\n\nbzero((char*)&amp;serverAddr,sizeof(serverAddr));\nserverAddr.sin_family = AF_INET;\nserverAddr.sin_port = htons(atoi(argv[2]));\nserverAddr.sin_addr.s_addr = htonl(argv[1]);\nif((welcomeSocket = socket(AF_INET, SOCK_STREAM, 0))==-1){\n        perror(\"socket err\");\n        exit(1);}\n\n\nmemset(serverAddr.sin_zero, '\\0', sizeof serverAddr.sin_zero);\n\nsetsockopt(welcomeSocket, SOL_SOCKET, SO_REUSEADDR, &amp;val, sizeof(int));\n\nif(bind(welcomeSocket, (struct sockaddr *) &amp;serverAddr, sizeof(serverAddr))&lt;0){\n    perror(\"Binding failed\\n\");\n    exit(1);}\n\nif(listen(welcomeSocket,5)==0)\n    printf(\"Listening\\n\");\nelse\n    printf(\"Error\\n\");\n\nwhile(1){\n    printf(\"1\");\n    addr_size = sizeof(serverStorage);\n    newSocket = accept(welcomeSocket, (struct sockaddr *) &amp;serverStorage, &amp;addr_size);\n\n    recv(newSocket, buffer, 1024, 0);\n    printf(\"Data received: %s\",buffer);\n\n    reverse(buffer, 0, strlen(buffer)-1);\n    send(newSocket,buffer,13,0);\n\n    close(newSocket);\n}\nclose(welcomeSocket);\nreturn 0;\n}\n</code></pre>\n\n<p>I expect it to work every time irrespective to its ip and port.</p>\n"}, {"tags": ["c", "windows-10", "usb", "libusb-1.0"], "owner": {"reputation": 97, "user_id": 7466871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c15c7a9231c9af99aef8d23b07b86b5e?s=128&d=identicon&r=PG&f=1", "display_name": "kapkong", "link": "https://stackoverflow.com/users/7466871/kapkong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1566332604, "creation_date": 1566332604, "question_id": 57581061, "link": "https://stackoverflow.com/questions/57581061/issues-porting-libusb-usb-firmware-over-to-windows-10", "title": "Issues porting libusb USB firmware over to Windows 10", "body": "<p>I'm working with a custom USB firmware written in C utilizing the libusb API.  The goal is to have this firmware compatible with Linux, Mac, and Windows.  Thus far, testing w/a Beaglebone Black with debug probe on Ubuntu &amp; Mac has yielded proper USB enumeration and operations with the respective OS's host application.  However, trying to connect the board to Windows 10 results in 'This device cannot start. (Code 10) An invalid parameter was passed to a service or function.'</p>\n\n<p>I have primarily been relying on the <a href=\"https://github.com/pbatard/libwdi/wiki/WCID-Devices#Microsoft_OS_String_Descriptor\" rel=\"nofollow noreferrer\">WCID wiki</a> and <a href=\"https://github.com/libusb/libusb/wiki\" rel=\"nofollow noreferrer\">libusb wiki</a> regarding porting libusb over to Windows.  I've added the MS OS String Descriptor and MS OS CID Feature Descriptor for WINUSB; <a href=\"https://zadig.akeo.ie/\" rel=\"nofollow noreferrer\">Zadig</a> shows that the device is now WCID-compliant and is recognized as a WinUSB device.</p>\n\n<p>Using USB Device Tree Viewer 3.6, problem code CM_PROB_FAILED_START appears to be the primary issue.</p>\n\n<pre><code>    ----------------- Device Qualifier Descriptor -----------------\nError                    : ERROR_GEN_FAILURE\n\n      -------------------- String Descriptors -------------------\nString descriptors are not available  (because the device has problem code CM_PROB_FAILED_START)\n</code></pre>\n\n<p>Notably, the device qualifier exists in the firmware and is properly displayed when utilizing libusb0, but I've heard that it has been deprecated and am thus trying to get compatibility with WinUSB.</p>\n\n<p>Are there any particular descriptor issues or other firmware requirements that are more strict in Windows 10 vs. Linux?  Since the device is failing to even start, I'm guessing that the firmware is not properly set up for Windows specifically.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 2, "creation_date": 1566331237, "post_id": 57580753, "comment_id": 101621083, "body": "We love that you&#39;re here and this isn&#39;t the way to ask a question. Please see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a>"}, {"owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 0, "creation_date": 1566331473, "post_id": 57580753, "comment_id": 101621184, "body": "Please include the problem description and any code in your question.  Don&#39;t link to it."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 0, "last_activity_date": 1566333061, "creation_date": 1566333061, "answer_id": 57581141, "question_id": 57580753, "link": "https://stackoverflow.com/questions/57580753/wrong-answer-in-online-judge-codechef/57581141#57581141", "title": "Wrong Answer in Online Judge (CODECHEF)", "body": "<p><code>while(arr[i]!=l)</code> and <code>while(arr[i]!=r)</code> are wrong. The indicators of the left and right sides, <code>Li</code> and <code>Ri</code>, are indices or counts, not the values in the array. You should use a simple <code>for</code> loop:</p>\n\n<pre><code>for (i = l; i &lt;= r; ++i)\n    pro = pro * arr[i-1] % m;\n</code></pre>\n\n<p>Note that the index is <code>i-1</code> because <code>Li</code> and <code>Ri</code> are given using one-based indexing, but C uses zero-based indexing for its arrays.</p>\n"}, {"tags": [], "owner": {"reputation": 3266, "user_id": 6854407, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205840043960722/picture?type=large", "display_name": "Jim Rogers", "link": "https://stackoverflow.com/users/6854407/jim-rogers"}, "is_accepted": false, "score": 0, "last_activity_date": 1566333467, "creation_date": 1566333467, "answer_id": 57581215, "question_id": 57580753, "link": "https://stackoverflow.com/questions/57580753/wrong-answer-in-online-judge-codechef/57581215#57581215", "title": "Wrong Answer in Online Judge (CODECHEF)", "body": "<p>Since you are using C to solve the program you must realize that the problem description assumes an array index starting at 1 instead of 0. You must therefore adjust the values of the left and right segment boundaries given as inputs. Simply subtract 1 from the left value and start the segment there. Continue processing the segment while your index is less than the right value.\nYour understanding of the problem is somewhat flawed. You need to multiply <strong>all</strong> the values in the segment and then take the mod of the product.</p>\n\n<p>See the following solution using Ada:</p>\n\n<pre><code>-----------------------------------------------------------------------\n-- Code Chef CHMOD\n-----------------------------------------------------------------------\nwith Ada.Text_IO; use Ada.Text_io;\nwith Ada.Integer_Text_IO; use Ada.Integer_Text_IO;\n\nprocedure Chmod is\n   subtype Num_Items is Positive range 1..100_000;\n   subtype Values is Integer range 1..100;\n   type Data_Array is array(Num_Items range &lt;&gt;) of Values;\n   Num_Elements : Num_Items;\nbegin\n   Get(Num_Elements);\n   declare\n      Toy    : Data_Array(1..Num_Elements);\n      Left   : Num_Items;\n      Right  : Num_Items;\n      Mi     : Positive;\n      Games  : Num_Items;\n      Result : Positive;\n   begin\n      for Num of Toy loop\n         Get(Num);\n      end loop;\n      Get(Games);\n      for I in 1..Games loop\n         Result := 1;\n         Get(Left);\n         Get(Right);\n         Get(Mi);\n         for V in Left..Right loop\n            Result := Result * Toy(V);\n         end loop;\n         Put(Item =&gt; Result mod Mi, Width =&gt; 1);\n         New_Line;\n      end loop;\n   end;\nend Chmod;\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11589107, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i1aEtCFpqFs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reP-qSpx1sdRKAhRjwi4SkQmqTWNg/mo/photo.jpg?sz=128", "display_name": "Unicorn", "link": "https://stackoverflow.com/users/11589107/unicorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 1, "answer_count": 2, "score": -6, "last_activity_date": 1566333467, "creation_date": 1566331041, "last_edit_date": 1566331421, "question_id": 57580753, "link": "https://stackoverflow.com/questions/57580753/wrong-answer-in-online-judge-codechef", "title": "Wrong Answer in Online Judge (CODECHEF)", "body": "<p>I have been trying to solve the following problem on codechef\n<a href=\"https://www.codechef.com/problems/CHMOD\" rel=\"nofollow noreferrer\">https://www.codechef.com/problems/CHMOD</a></p>\n\n<p>I was expecting a Time Limit error but it gave me a Wrong answer. Though i found a way to solve it with time constraints but cant figure out the reason for this wrong answer. </p>\n\n<p>Here is my solution</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n    int num,i;\n    scanf(\"%d\",&amp;num);\n    int arr[num];\n    for(i=0;i&lt;num;i++){\n        scanf(\"%d\",&amp;arr[i]);\n    }\n    int testCases,l,r;\n    long int m,pro=1;\n    scanf(\"%d\",&amp;testCases);\n    while(testCases--){\n        pro=1;\n        scanf(\"%d%d%ld\",&amp;l,&amp;r,&amp;m);\n        i=0;\n        while(arr[i]!=l){\n            i++;\n        }\n        while(arr[i]!=r){\n            pro=(pro*arr[i])%m;\n            i++;\n        }\n        pro=(pro*arr[i])%m;\n        printf(\"%d\\n\",pro);\n    }\n    return 0;\n}\n\n</code></pre>\n"}, {"tags": ["c", "if-statement", "integer", "integer-promotion"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1566328816, "post_id": 57580245, "comment_id": 101620174, "body": "be aware that the signedness of <code>char</code> is implementation-defined."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566329431, "post_id": 57580245, "comment_id": 101620431, "body": "@Barmar the dup is about comparing for equality."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1566329575, "post_id": 57580245, "comment_id": 101620486, "body": "Dupe looks like it is C++ even though there is also a C tag."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566329646, "post_id": 57580245, "comment_id": 101620514, "body": "@WeatherVane I think the promotion rules are the same for equality and inequality tests."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1566329696, "post_id": 57580245, "comment_id": 101620536, "body": "@ChristianGibbons C and C++ are similar in this area."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1566329813, "post_id": 57580245, "comment_id": 101620580, "body": "Basically everything is first expanded to int if both ranges are representable in an int, else unsigned int. In the first case both are converted to unsigned int, in the second to int"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566329852, "post_id": 57580245, "comment_id": 101620596, "body": "In the second case, both values can be promoted to <code>int</code> without loss so the comparison works correctly. In the first case, they cannot so are converted to <code>unsigned int</code>, and the negative value is converted by the implementation to a large positive value. C11 <b>&#167;6.3.1.1.2</b> says <i>If an <code>int</code> can represent all values of the original type (as restricted by the width, for a bit-field), the value is converted to an <code>int</code>; otherwise, it is converted to an <code>unsigned int</code>. These are called the <b>integer promotions</b>. All other types are unchanged by the integer promotions.</i>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566329854, "post_id": 57580245, "comment_id": 101620597, "body": "@Barmar I thought there was a preference to separate C and C++ questions to fight the narrative that &quot;C/C++&quot; is a language and that we want them to be treated separately to avoid the issues that come along with assuming what is true with one is true of another."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1566329895, "post_id": 57580245, "comment_id": 101620620, "body": "@Barmar but it does not answer this question: why the comparison breaks."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566330031, "post_id": 57580245, "comment_id": 101620671, "body": "@WeatherVane this one does"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1566330076, "post_id": 57580245, "comment_id": 101620690, "body": "@AnttiHaapala yes is more relevant."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566330237, "post_id": 57580245, "comment_id": 101620745, "body": "@WeatherVane if you do have sth to add then please do edit Lundin&#39;s answer or add another one ;)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1566330699, "post_id": 57580245, "comment_id": 101620897, "body": "@AnttiHaapala why would I do that to an exemplary answer? I posted my comment before you added the dupe (and before I saw your earlier comment - I was typing)."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566330834, "post_id": 57580245, "comment_id": 101620947, "body": "@WeatherVane well it might be sth that the exemplary answer is missing :d"}], "owner": {"reputation": 123, "user_id": 11953066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef8bb6ee9ad7b88a5c8ad6ca37470d0?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Anwar", "link": "https://stackoverflow.com/users/11953066/ahmad-anwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "closed_date": 1566329260, "answer_count": 0, "score": 0, "last_activity_date": 1566341207, "creation_date": 1566328678, "last_edit_date": 1566341207, "question_id": 57580245, "link": "https://stackoverflow.com/questions/57580245/integer-value-promotion-to-unsigned-int-vs-signed-int-in-c", "closed_reason": "Duplicate", "title": "Integer value promotion to unsigned int vs signed int in c", "body": "<p>I have two c codes, the difference between them is that one uses char and one uses int, as follows,</p>\n\n<p><strong><em>First:</em></strong> </p>\n\n<p>if case is true</p>\n\n<pre><code>int x = -1;\nunsigned int y = 2;\nif(x&gt;y)\n</code></pre>\n\n<p><strong><em>Second:</em></strong> </p>\n\n<p>the if case is false</p>\n\n<pre><code>char x = -1;\nunsigned char y = 2;\nif(x&gt;y)\n</code></pre>\n\n<p>Why does this happen?</p>\n"}, {"tags": ["c", "arduino", "avr-gcc"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566328989, "post_id": 57580230, "comment_id": 101620245, "body": "Does it make sense to shift the integer value left 4 times <i>after</i> truncating any fractional part? Or is that to align with a bit-field?"}, {"owner": {"reputation": 362, "user_id": 11936229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11da23565b039811f58b2beecf7493b3?s=128&d=identicon&r=PG&f=1", "display_name": "BTables", "link": "https://stackoverflow.com/users/11936229/btables"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566329131, "post_id": 57580230, "comment_id": 101620307, "body": "@WeatherVane I did not actually write that code. This is vendor supplied, so I&#39;m assuming it&#39;s correct(this bit is also useless to me so I don&#39;t really care). I was more curious what the standard guarantees."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1566350164, "post_id": 57580230, "comment_id": 101625374, "body": "Aside: code should round after scaling as with <code>min_current_threshold_code = lroundf(min_current_threshold &#47; LTC2946_DELTA_SENSE_lsb * resistor * 16);</code> rather than truncate and then scale."}, {"owner": {"reputation": 362, "user_id": 11936229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11da23565b039811f58b2beecf7493b3?s=128&d=identicon&r=PG&f=1", "display_name": "BTables", "link": "https://stackoverflow.com/users/11936229/btables"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1566358530, "post_id": 57580230, "comment_id": 101626704, "body": "@chux I agree with this. The vendor codebase this is a part of has a few other things I think are wonky, but, I&#39;ll be rewriting most of this so I guess we&#39;ll see..."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1566504598, "post_id": 57580230, "comment_id": 101687784, "body": "I see no <code>float</code> in your sample code... Please, can you edit your question and specify in what part of your code a <code>float</code> number if being handled? If so, what format is used to store it? can you describe? Thanks (all the multiplications, divisions and shifts are made over 32 bit integer values, no floating point arithmetic involved in that code)"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1566504765, "post_id": 57580230, "comment_id": 101687842, "body": "Can you post a verifiable piece of code where we can see how each variable is defined?  THANKS!"}], "answers": [{"tags": [], "owner": {"reputation": 60, "user_id": 3693304, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bo7xH.png?s=128&g=1", "display_name": "x5qubits", "link": "https://stackoverflow.com/users/3693304/x5qubits"}, "is_accepted": false, "score": 2, "last_activity_date": 1566332400, "last_edit_date": 1566332400, "creation_date": 1566328806, "answer_id": 57580266, "question_id": 57580230, "link": "https://stackoverflow.com/questions/57580230/guarantees-of-data-preservation-between-int32-t-and-float/57580266#57580266", "title": "Guarantees of data preservation between int32_t and float?", "body": "<p>6.3.1.4 states:</p>\n\n<blockquote>\n  <p>When a finite value of real floating type is converted to an integer\n  type other than _Bool, the fractional part is discarded (i.e., the\n  value is truncated toward zero). If the value of the integral part\n  cannot be represented by the integer type, the behavior is undefined.\n  61)</p>\n</blockquote>\n\n<p>And then there is a non-normative foot note explaining the above text:</p>\n\n<blockquote>\n  <p>61) The remaindering operation performed when a value of integer type\n  is converted to unsigned type need not be performed when a value of\n  real floating type is converted to unsigned type. Thus, the range of\n  portable real floating values is (\u22121, Utype_MAX+1).</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": true, "score": 7, "last_activity_date": 1566329080, "creation_date": 1566329080, "answer_id": 57580331, "question_id": 57580230, "link": "https://stackoverflow.com/questions/57580230/guarantees-of-data-preservation-between-int32-t-and-float/57580331#57580331", "title": "Guarantees of data preservation between int32_t and float?", "body": "<p>Yes, the standards mandates the truncation, for example in C99 chapter 6.3.1.4 paragraph 1:</p>\n\n<blockquote>\n  <p>When a finite value of real floating type is converted to an integer type other than <strong>_Bool</strong>, the fractional part is discarded (i.e., the value is truncated toward zero).</p>\n</blockquote>\n"}], "owner": {"reputation": 362, "user_id": 11936229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11da23565b039811f58b2beecf7493b3?s=128&d=identicon&r=PG&f=1", "display_name": "BTables", "link": "https://stackoverflow.com/users/11936229/btables"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 57580331, "answer_count": 2, "score": 4, "last_activity_date": 1566505582, "creation_date": 1566328582, "last_edit_date": 1592644375, "question_id": 57580230, "link": "https://stackoverflow.com/questions/57580230/guarantees-of-data-preservation-between-int32-t-and-float", "title": "Guarantees of data preservation between int32_t and float?", "body": "<p>I'm reading through the supplied code for a demo board(specifically the DC21561A) and found this snippet of code:</p>\n<pre><code>int32_t min_current_threshold_code;                                                                                                                                                                                                          \nmin_current_threshold_code = (min_current_threshold / LTC2946_DELTA_SENSE_lsb) * resistor;                                                                                                                                                   \nack |= LTC2946_write_16_bits(LTC2946_I2C_ADDRESS, LTC2946_MIN_DELTA_SENSE_THRESHOLD_MSB_REG, (min_current_threshold_code &lt;&lt; 4));\n</code></pre>\n<p>Here, everything on the RHS of first assignment is a float. From what I can tell, and have tested, an assignment with LHS int32_t and RHS float the decimal bits of the float will be discarded and only the integer is left; i.e. '1.5 * 3.5 = 5'.</p>\n<p>The data above is written to a register over I2C. I assume the floats are used to give a more accurate estimate of threshold values. However, I was wondering if this truncation when assigning a float to an int32_t is required by the C(or C++) standard or something compiler specific?</p>\n<p>Edit** Some people have asked for more code. While my question is answered, here's the rest for thoroughness.</p>\n<p>At the top of the file there is</p>\n<blockquote>\n<p>float min_current_threshold = read_float();</p>\n<p>const float LTC2946_DELTA_SENSE_lsb = 2.5006105E-05;</p>\n<p>const float resistor = .02;</p>\n</blockquote>\n"}, {"tags": ["c", "header"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1566330001, "post_id": 57580280, "comment_id": 101620657, "body": "For the most part, yes, it&#39;s to make the compiler&#39;s job easier. C was created decades ago, when computer time was much more valuable compared to human time."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1566331441, "post_id": 57580280, "comment_id": 101621175, "body": "Which c file will you include to get a definition of <code>fopen</code>?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1566332158, "post_id": 57580280, "comment_id": 101621454, "body": "Header files is the mechanism used by the language to allow sharing of information between two different C files. Compilation generally takes a long time compared to linking, so we often split the source code into separate C files to allow them to be compiled separately. That way, if we need to change one part of the software, only the affected C files need to be recompiled, not all of the code. Sometimes, distinct C files need some shared declarations in order to interface with each other. Header files allow this sharing without resorting to compiling a large source file."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1566332250, "post_id": 57580280, "comment_id": 101621482, "body": "Including C files amounts to creating a large source file. Also, if you don&#39;t manage it properly, you will probably create duplicate definitions. You want to share declarations, not definitions."}], "answers": [{"tags": [], "owner": {"reputation": 1979, "user_id": 6867430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3776fe17c0992abb221db63b5fea183?s=128&d=identicon&r=PG&f=1", "display_name": "ivanivan", "link": "https://stackoverflow.com/users/6867430/ivanivan"}, "is_accepted": false, "score": 1, "last_activity_date": 1566328619, "creation_date": 1566328619, "answer_id": 57580281, "question_id": 57580280, "link": "https://stackoverflow.com/questions/57580280/why-header-files-are-needed-in-c/57580281#57580281", "title": "Why header files are needed in c", "body": "<p>TLDR answer is organization and code reuse.</p>\n\n<p>Header files contain common standard code usable across multiple code bases - think of them as libraries to bring in.</p>\n\n<p>This code is kept separate for maintenance issues.  You only want one copy, so when a fix needs making it happens in one place.  All of the various code bases you have that reference that one included header file suddenly have the updates.</p>\n\n<p>You can also do project specific headers.  For example, my SQL statements are all static strings, since they are long and complex I keep them in a different file and just include it.  This way, I don't have a large long blob of complex SQL as a string in the middle of my code.</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1250553600, "open_beta_date": 1247529600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon@2.png", "twitter_account": "super_user", "favicon_url": "https://cdn.sstatic.net/Sites/superuser/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon.png", "audience": "computer enthusiasts and power users", "site_url": "https://superuser.com", "api_site_parameter": "superuser", "logo_url": "https://cdn.sstatic.net/Sites/superuser/Img/logo.png", "name": "Super User", "site_type": "main_site"}, "on_date": 1566328878, "question_id": 1473374}, "owner": {"user_type": "does_not_exist", "display_name": "heade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "closed_date": 1566331671, "answer_count": 1, "score": 0, "last_activity_date": 1566331306, "creation_date": 1566327726, "last_edit_date": 1566331306, "question_id": 57580280, "link": "https://stackoverflow.com/questions/57580280/why-header-files-are-needed-in-c", "closed_reason": "Duplicate", "title": "Why header files are needed in c", "body": "<p>When I program in c there are <code>.h</code> files .\nHeader files contain the signatures of functions that are implement in c files.</p>\n\n<p>Why are header files are needed as I can include the c file to use the function there instead of using headers.</p>\n\n<p>Is this to make the compiler's job easier?</p>\n"}, {"tags": ["c", "macros", "assert"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1566326654, "post_id": 57579796, "comment_id": 101619310, "body": "Did you intend to declare <code>method1Instrumentation</code> 3 times? Or should they be 2 and 3?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566326730, "post_id": 57579796, "comment_id": 101619344, "body": "What is <code>null</code>, should that be <code>NULL</code>?"}, {"owner": {"reputation": 394, "user_id": 7261925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnEFB.png?s=128&g=1", "display_name": "Robur_131", "link": "https://stackoverflow.com/users/7261925/robur-131"}, "edited": false, "score": 0, "creation_date": 1566326792, "post_id": 57579796, "comment_id": 101619375, "body": "&quot;How should I add an <code>assets</code>?&quot; should be <code>assert</code>."}, {"owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "edited": false, "score": 0, "creation_date": 1566326793, "post_id": 57579796, "comment_id": 101619377, "body": "What should happen in the case of <code>if</code> statement if <code>arg == null</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1566326860, "post_id": 57579796, "comment_id": 101619402, "body": "Shouldn&#39;t you be asserting that the arg is <b>not</b> null?"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1566327507, "post_id": 57579796, "comment_id": 101619630, "body": "There are so many false claims in this question! Probably all from typos, though. But still, this wastes our time and/or it forces us to make guesses, which means we could be giving you incorrect and/or incomplete responses. Please proofread what you post!"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1566327589, "post_id": 57579796, "comment_id": 101619663, "body": "If you just want polymorphism, you should look at using C11&#39;s <code>_Generic</code>."}, {"owner": {"reputation": 371, "user_id": 8596999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/595f98020f985780afcce080519abfd6?s=128&d=identicon&r=PG&f=1", "display_name": "ChauhanTs", "link": "https://stackoverflow.com/users/8596999/chauhants"}, "edited": false, "score": 0, "creation_date": 1566336864, "post_id": 57579796, "comment_id": 101623031, "body": "Put the semicolon between assert call and method.. function call. And replace null with NULL"}], "answers": [{"comments": [{"owner": {"reputation": 4566, "user_id": 453492, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7b45c33a5eda398febe496831ccaacb4?s=128&d=identicon&r=PG", "display_name": "Mario The Spoon", "link": "https://stackoverflow.com/users/453492/mario-the-spoon"}, "edited": false, "score": 0, "creation_date": 1566327063, "post_id": 57579878, "comment_id": 101619476, "body": "wouldn&#39;t it be &amp;&amp; since the methodXInstrumentation is returning bool and no second argument is expected?"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 4566, "user_id": 453492, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7b45c33a5eda398febe496831ccaacb4?s=128&d=identicon&r=PG", "display_name": "Mario The Spoon", "link": "https://stackoverflow.com/users/453492/mario-the-spoon"}, "edited": false, "score": 1, "creation_date": 1566327244, "post_id": 57579878, "comment_id": 101619553, "body": "@Mario The Spoon, You mean instead of the comma? No, because <code>assert</code> returns <code>void</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 4566, "user_id": 453492, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7b45c33a5eda398febe496831ccaacb4?s=128&d=identicon&r=PG", "display_name": "Mario The Spoon", "link": "https://stackoverflow.com/users/453492/mario-the-spoon"}, "edited": false, "score": 1, "creation_date": 1566327249, "post_id": 57579878, "comment_id": 101619554, "body": "@MarioTheSpoon The return value of <code>assert()</code> isn&#39;t specified."}, {"owner": {"reputation": 4566, "user_id": 453492, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7b45c33a5eda398febe496831ccaacb4?s=128&d=identicon&r=PG", "display_name": "Mario The Spoon", "link": "https://stackoverflow.com/users/453492/mario-the-spoon"}, "edited": false, "score": 0, "creation_date": 1566327865, "post_id": 57579878, "comment_id": 101619760, "body": "ok did not notice, but would then not the compilation of the if( method2(xxx) also fail?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566327925, "post_id": 57579878, "comment_id": 101619781, "body": "No, why would it? The return value of the left operand of the comma operator isn&#39;t used."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1566326890, "creation_date": 1566326890, "answer_id": 57579878, "question_id": 57579796, "link": "https://stackoverflow.com/questions/57579796/how-to-implement-c-macro-with-assert/57579878#57579878", "title": "How to implement C macro with assert", "body": "<p>Use the <a href=\"https://en.wikipedia.org/wiki/Comma_operator\" rel=\"nofollow noreferrer\">comma operator</a> to combine the <code>assert</code> and function call into a single expression. Also, wrap it in parentheses to prevent problems with operator precedence when combining it with other operators.</p>\n\n<pre><code>#define method1(arg) (assert(arg != NULL), method1Instrumentation(arg))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1566328019, "post_id": 57580058, "comment_id": 101619824, "body": "You&#39;re not triggering whatever error the standard <code>assert()</code> macro normally produces. You&#39;re also not dependent on the <code>NDEBUG</code> macro like <code>assert()</code> is."}], "tags": [], "owner": {"reputation": 4566, "user_id": 453492, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7b45c33a5eda398febe496831ccaacb4?s=128&d=identicon&r=PG", "display_name": "Mario The Spoon", "link": "https://stackoverflow.com/users/453492/mario-the-spoon"}, "is_accepted": false, "score": 0, "last_activity_date": 1566328233, "last_edit_date": 1566328233, "creation_date": 1566327758, "answer_id": 57580058, "question_id": 57579796, "link": "https://stackoverflow.com/questions/57579796/how-to-implement-c-macro-with-assert/57580058#57580058", "title": "How to implement C macro with assert", "body": "<p>TO work a little against the macro ugliness I would suggest something along these lines:</p>\n\n<p><strong>Edited to use assert() as pointed out in comment;</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\nbool method1( void* data );\nbool method2( void* data );\n\ntypedef bool (*methodPointer)(void*);\n\nbool assertAndCall( void* data, methodPointer );\n\n#define call1( arg )  assertAndCall( arg, method1 )\n#define call2( arg )  assertAndCall( arg, method2 )\n\n\nbool method1( void* data )\n{\n    printf(\"method1\\n\");\n}\n\nbool method2(void* data )\n{\n    printf(\"method2\\n\");\n}\n\nbool assertAndCall( void* data, methodPointer mp )\n{\n    assert( arg == null );\n\n    mp( data );\n}\n\n\nint main()\n{\n    call1( \"test \");\n    call2( \"test\" );\n    call1( NULL );\n\n    return 0;\n}\n</code></pre>\n\n<p>I know, still a lot of macros and there are better solutions, but I wanted to play around,,,</p>\n"}], "owner": {"reputation": 8739, "user_id": 466056, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/101889513654ccabf2cff98d3352e74c?s=128&d=identicon&r=PG", "display_name": "Yakov", "link": "https://stackoverflow.com/users/466056/yakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 57579878, "answer_count": 2, "score": -3, "last_activity_date": 1566333184, "creation_date": 1566326524, "last_edit_date": 1566333184, "question_id": 57579796, "link": "https://stackoverflow.com/questions/57579796/how-to-implement-c-macro-with-assert", "title": "How to implement C macro with assert", "body": "<p>I work on a C project, it implements a kind of polymorphism by using macros</p>\n\n<pre><code>void method1Instrumentation(void*);\nbool method2Instrumentation(void*);\nbool method3Instrumentation(void*);\n\n#define method1(arg) method1Instrumentation(arg)\n#define method2(arg) method2Instrumentation(arg)\n#define method3(arg) method32Instrumentation(arg)\n</code></pre>\n\n<p>For each of <code>method1Instrumentation, method2Instrumentation, method3Instrumentation</code> there are several implementations. Based on internal configuration, compiler \"chooses\" the appropriate function.\nI (probably) can`t change the given design.\nBut I need to add <code>asserts</code> to <code>method*</code>.</p>\n\n<p>is works fine</p>\n\n<pre><code>#define method1(arg) assert(arg == NULL) method1Instrumentation(arg)\n</code></pre>\n\n<p>doesn`t work (compilation problems)</p>\n\n<pre><code>#define method2(arg) assert(arg == null) method2Instrumentation(arg)\n</code></pre>\n\n<p>The problem occurs since the original code has following calls</p>\n\n<pre><code>if(method2(arg))\n{\n}\n</code></pre>\n\n<p>How should I add an <code>assets</code> following the limitations I have?</p>\n"}, {"tags": ["c", "julia"], "comments": [{"owner": {"reputation": 3346, "user_id": 5141328, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/518f7cb4b021eb39eb3cb9987016db2d?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar Smith", "link": "https://stackoverflow.com/users/5141328/oscar-smith"}, "edited": false, "score": 2, "creation_date": 1566324112, "post_id": 57579231, "comment_id": 101618314, "body": "given the types of things declaring a struct immutable lets a compiler do, this would almost certainly be a very bad idea"}, {"owner": {"reputation": 916, "user_id": 3853175, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BG7vO.png?s=128&g=1", "display_name": "JKRT", "link": "https://stackoverflow.com/users/3853175/jkrt"}, "reply_to_user": {"reputation": 3346, "user_id": 5141328, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/518f7cb4b021eb39eb3cb9987016db2d?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar Smith", "link": "https://stackoverflow.com/users/5141328/oscar-smith"}, "edited": false, "score": 0, "creation_date": 1566325007, "post_id": 57579231, "comment_id": 101618676, "body": "Of course, I am aware that this is not a good idea. I have some experience with compiler runtimes albeit limited and for performance reasons, it might under certain circumstances be worth it to circumvent immutability. Still that requires knowledge on how the runtime and garbage collector et. cetera operates, knowledge that I lack : )"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1566326268, "post_id": 57579231, "comment_id": 101619158, "body": "<i>&quot;Is it ever safe to do?&quot;</i> Nope, mutable vs. immutable is a fundamental design choice. You can&#39;t just go and arbitrarily change it in one place. You&#39;d have to redesign the language from scratch."}, {"owner": {"reputation": 916, "user_id": 3853175, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BG7vO.png?s=128&g=1", "display_name": "JKRT", "link": "https://stackoverflow.com/users/3853175/jkrt"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1566329018, "post_id": 57579231, "comment_id": 101620262, "body": "@user3386109 I have clarified in my post that I do not indent to modify the source language"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1566332832, "post_id": 57579231, "comment_id": 101621674, "body": "If I understand correctly, you&#39;re proposing to pass the <code>st</code> pointer to a C function, and allow that function to modify the object that <code>st</code> points to. If the Julia language specification doesn&#39;t specifically prohibit C functions from modifying Julia objects, then the language specification sorely needs an update. The ability to call C functions is almost certainly intended to allow the use of existing libraries, e.g. math libraries with functions like <code>sin</code>, <code>cos</code>, and <code>pow</code>. And it&#39;s almost certainly <b>not</b> intended to allow C functions to muck around with the internals of Julia objects."}, {"owner": {"reputation": 916, "user_id": 3853175, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BG7vO.png?s=128&g=1", "display_name": "JKRT", "link": "https://stackoverflow.com/users/3853175/jkrt"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1566333164, "post_id": 57579231, "comment_id": 101621781, "body": "@user3386109 It is possible to do it yes. However, it is of course not recommended to do so, which I understand fully (And also stated in my question)."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1566333410, "post_id": 57579231, "comment_id": 101621870, "body": "So then what is your question? To quote your comments: <i>&quot;Of course, I am aware that this is not a good idea.&quot;</i> and <i>&quot;it is of course not recommended to do so&quot;</i>. What more are you looking for?"}, {"owner": {"reputation": 916, "user_id": 3853175, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BG7vO.png?s=128&g=1", "display_name": "JKRT", "link": "https://stackoverflow.com/users/3853175/jkrt"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1566333584, "post_id": 57579231, "comment_id": 101621928, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/198203/discussion-between-jkrt-and-user3386109\">continue this discussion in chat</a>."}, {"owner": {"reputation": 16267, "user_id": 1346276, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Tu8Re.jpg?s=128&g=1", "display_name": "phipsgabler", "link": "https://stackoverflow.com/users/1346276/phipsgabler"}, "edited": false, "score": 1, "creation_date": 1566370096, "post_id": 57579231, "comment_id": 101629692, "body": "Well, the question formulated as &quot;if I do this, what kinds of bad things would actually happen and why?&quot; isn&#39;t a bad one."}, {"owner": {"reputation": 916, "user_id": 3853175, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BG7vO.png?s=128&g=1", "display_name": "JKRT", "link": "https://stackoverflow.com/users/3853175/jkrt"}, "reply_to_user": {"reputation": 16267, "user_id": 1346276, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Tu8Re.jpg?s=128&g=1", "display_name": "phipsgabler", "link": "https://stackoverflow.com/users/1346276/phipsgabler"}, "edited": false, "score": 0, "creation_date": 1566408229, "post_id": 57579231, "comment_id": 101650205, "body": "@phg Feel free to edit my post, to clarify it further it would be very much appreciated!"}], "answers": [{"comments": [{"owner": {"reputation": 916, "user_id": 3853175, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BG7vO.png?s=128&g=1", "display_name": "JKRT", "link": "https://stackoverflow.com/users/3853175/jkrt"}, "edited": false, "score": 0, "creation_date": 1566328699, "post_id": 57579716, "comment_id": 101620128, "body": "To clarify the Julia language does allow calling user-defined C-sources through it&#39;s FFI and the assignment syntax above is syntactic sugar for setfield! So by implementing my own setfield! outside of the compiler, I would not change the language, since I can do what I described above without changing the language implementation."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 916, "user_id": 3853175, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BG7vO.png?s=128&g=1", "display_name": "JKRT", "link": "https://stackoverflow.com/users/3853175/jkrt"}, "edited": false, "score": 1, "creation_date": 1566330906, "post_id": 57579716, "comment_id": 101620970, "body": "Surely either the language is underspecified or doing that is explicitly undefined behavior."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 3, "last_activity_date": 1566326142, "creation_date": 1566326142, "answer_id": 57579716, "question_id": 57579231, "link": "https://stackoverflow.com/questions/57579231/are-immutable-julia-structs-ever-safe-to-mutate-and-under-what-conditions-can-it/57579716#57579716", "title": "Are immutable julia structs ever safe to mutate and under what conditions can it be done in safe way?", "body": "<p>If you modify the language implementation in way to allow breaking the rules of the language as specified, you can do whatever you want. However:</p>\n\n<ol>\n<li>The language you're working with is no longer Julia, and</li>\n<li>Whatever changes you make may introduce bugs. If you add backdoors to allow violation of constraints of the original language, you may very well find that other parts of the language implementation that you haven't yet examined are making use of invariants depending on those language constraints, and that, without making significant changes elsewhere, your changes end up being bugs.</li>\n</ol>\n\n<p>What you're trying to do sounds highly inadvisible.</p>\n"}], "owner": {"reputation": 916, "user_id": 3853175, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BG7vO.png?s=128&g=1", "display_name": "JKRT", "link": "https://stackoverflow.com/users/3853175/jkrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566328856, "creation_date": 1566323965, "last_edit_date": 1566328856, "question_id": 57579231, "link": "https://stackoverflow.com/questions/57579231/are-immutable-julia-structs-ever-safe-to-mutate-and-under-what-conditions-can-it", "title": "Are immutable julia structs ever safe to mutate and under what conditions can it be done in safe way?", "body": "<p>Inspired by the post <a href=\"https://discourse.julialang.org/t/are-immutable-struct-really-immutable/26138\" rel=\"nofollow noreferrer\">at Julia discourse</a> I would like to ask the same question but with a catch. </p>\n\n<p>Consider: </p>\n\n<pre><code>struct HappyImmutable\n  a::Int\nend \n</code></pre>\n\n<p>I cannot change the field a. it is of course immutable:</p>\n\n<pre><code>julia&gt; struct HappyImmutable\n   a::Int\n   end\n\njulia&gt; b = HappyImmutable(1)\njulia&gt; b.a\n1\n\njulia&gt; b.a = 2\nERROR: setfield! immutable struct of type HappyImmutable cannot be changed\nStacktrace:\n [1] setproperty!(::HappyImmutable, ::Symbol, ::Int64) at ./sysimg.jl:19\n [2] top-level scope at none:0\n</code></pre>\n\n<p>This makes perfect sense to me. However, reading through the Julia sources I see that there is one ifstatement preventing me from mutating the struct. </p>\n\n<pre><code> JL_CALLABLE(jl_f_setfield)\n    {\n        JL_NARGS(setfield!, 3, 3);\n        jl_value_t *v = args[0];\n        jl_value_t *vt = (jl_value_t*)jl_typeof(v);\n        if (vt == (jl_value_t*)jl_module_type)\n            jl_error(\"cannot assign variables in other modules\");\n        if (!jl_is_datatype(vt))\n            jl_type_error(\"setfield!\", (jl_value_t*)jl_datatype_type, v);\n        jl_datatype_t *st = (jl_datatype_t*)vt;\n        if (!st-&gt;mutabl)\n            jl_errorf(\"setfield! immutable struct of type %s cannot be changed\", jl_symbol_name(st-&gt;name-&gt;name));\n        size_t idx;\n        if (jl_is_long(args[1])) {\n            idx = jl_unbox_long(args[1]) - 1;\n            if (idx &gt;= jl_datatype_nfields(st))\n                jl_bounds_error(args[0], args[1]);\n        }\n        else {\n            JL_TYPECHK(setfield!, symbol, args[1]);\n            idx = jl_field_index(st, (jl_sym_t*)args[1], 1);\n        }\n        jl_value_t *ft = jl_field_type(st,idx);\n        if (!jl_isa(args[2], ft)) {\n            jl_type_error(\"setfield!\", ft, args[2]);\n        }\n        jl_set_nth_field(v, idx, args[2]);\n        return args[2];\n    }\n</code></pre>\n\n<p>By removing that if-statement and implementing my own setfield! I guess I can indeed mutate the struct. The question is, what consequences and can of worms will I open by doing this? Is it ever safe to do?  </p>\n\n<p><strong>Edit</strong> \nIt seems that some misunderstood me I do not indent to modify the language itself, rather declaring an external C function that does the same thing as the runtime defined function.</p>\n"}, {"tags": ["c", "arrays", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "reply_to_user": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1566324196, "post_id": 57579141, "comment_id": 101618354, "body": "@I\u0142yaBursov It says: &quot;error operand of type &#39;void&#39; where arithmetic or pointer type is required&quot;."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1566324226, "post_id": 57579141, "comment_id": 101618367, "body": "<a href=\"//stackoverflow.com/q/8812690\">Using void pointer to an array</a>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1566324250, "post_id": 57579141, "comment_id": 101618377, "body": "The first version of the question appears to be correct. Why did you change it?"}, {"owner": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1566324315, "post_id": 57579141, "comment_id": 101618408, "body": "@user3386109 someone suggested to change it (though it was right, but then he removed his comment). Johnny, this is a list not an array though."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1566324687, "post_id": 57579141, "comment_id": 101618543, "body": "Yup, he was wrong. The problem is in the declaration of <code>arr2list</code>. <code>void *array</code> should be <code>int *array</code>."}, {"owner": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1566324732, "post_id": 57579141, "comment_id": 101618565, "body": "@user3386109 I would like to create a generic function so I have to use <code>void*</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1566324903, "post_id": 57579141, "comment_id": 101618637, "body": "Yes, I know. The <code>insert</code> function is generic. The <code>arr2list</code> function does the conversion between a specific type of array, and the generic <code>insert</code> function. So <code>arr2list</code> cannot be generic. (Unless you get messy as shown in the latest edit to Pascal Cuoq&#39;s answer.)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1566350606, "post_id": 57579141, "comment_id": 101625448, "body": "vesii, Note: inconsistent to use <code>size_t length</code> and <code>int i</code>.  Choose one type.  Recommend <code>size_t</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "edited": false, "score": 0, "creation_date": 1566324401, "post_id": 57579313, "comment_id": 101618440, "body": "I use <code>C99</code>. So, how do I replace <code>&amp;</code>?"}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "edited": false, "score": 2, "creation_date": 1566324570, "post_id": 57579313, "comment_id": 101618495, "body": "@vesii <code>void*</code> arithmetic is not defined in any C standard. Not in C89, not in C99 and not in C11. If you are using GCC, try <code>-std=c99 -pedantic</code> to get something that resembles a C99 compiler. The problem is not that you are using <code>&amp;</code>, it&#39;s fundamentally that your function <code>arr2list</code> is trying to offset a pointer without knowing the size of the elements it points to."}, {"owner": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "edited": false, "score": 0, "creation_date": 1566324769, "post_id": 57579313, "comment_id": 101618576, "body": "what do you mean by arithmetic? In the following link you have an example of <code>void*</code>: <a href=\"https://www.geeksforgeeks.org/generic-linked-list-in-c-2/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/generic-linked-list-in-c-2</a>"}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "edited": false, "score": 0, "creation_date": 1566325108, "post_id": 57579313, "comment_id": 101618713, "body": "What I called \u201c<code>void*</code> arithmetic\u201d is, in longer terms, \u201cpointer arithmetic using a <code>void*</code> pointer\u201d. It&#39;s not C. GCC makes it work like \u201c<code>char*</code> arithmetic\u201d, or \u201cpointer arithmetic using a <code>char*</code> pointer\u201d, which is not what you want. You would have been better served by a compilation error, which a standard C compiler would have provided."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "edited": false, "score": 0, "creation_date": 1566325178, "post_id": 57579313, "comment_id": 101618743, "body": "@vesii in other words, your mistake is similar to the mistake in the question <a href=\"https://stackoverflow.com/questions/8812690/using-void-pointer-to-an-array\" title=\"using void pointer to an array\">stackoverflow.com/questions/8812690/&hellip;</a> which Johnny Mopp has pointed out in the comments."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "edited": false, "score": 0, "creation_date": 1566325313, "post_id": 57579313, "comment_id": 101618793, "body": "@vesii note that the link you provided contains the same solution as my answer, in the form of <code>size_t data_size</code> as argument to the function <code>push</code>."}], "tags": [], "owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "is_accepted": false, "score": 1, "last_activity_date": 1566324954, "last_edit_date": 1566324954, "creation_date": 1566324325, "answer_id": 57579313, "question_id": 57579141, "link": "https://stackoverflow.com/questions/57579141/generic-list-contains-garbage-values-in-c/57579313#57579313", "title": "Generic list contains garbage values in C", "body": "<p>Your program contains <code>&amp;array[i]</code> where <code>array</code> has type <code>void*</code> at line 28.</p>\n\n<p>This is not standard C. GCC accepts it and treats the pointer arithmetic as char* arithmetic (arguably a bad idea, in particular because it feeds the confusion in an example such as this one).</p>\n\n<p>Since your function <code>arr2list</code> consumes the array through some misaligned pointers, the results are apparently arbitrary values (that contain some of the bytes of the first array element and some of the bytes of the second array element, for instance).</p>\n\n<p>I would be happy to say that the function <code>arr2list</code> must simply take as argument the length of one element, but this small change alone is not going to be enough in itself to make things work. Your linked list type stores pointers as data, so the function will also need to allocate a block for each of the elements, and store a pointer to this element inside the <code>Node</code>.</p>\n\n<p>If you are content with making the list point to the elements of the array, then forget the above paragraph, you almost have a working solution, just make <code>arr2list</code> take an extra argument <code>size_t elt_size</code> and use <code>(char*)array + elt_size*i</code> instead of <code>&amp;array[i]</code>.</p>\n"}], "owner": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1566332773, "creation_date": 1566323587, "last_edit_date": 1566332773, "question_id": 57579141, "link": "https://stackoverflow.com/questions/57579141/generic-list-contains-garbage-values-in-c", "title": "Generic list contains garbage values in C", "body": "<p>So I wanted to write a function in C which converts a generic array into a single linked list.</p>\n\n<p><strong><em>The code I wrote:</em></strong></p>\n\n<pre><code>typedef struct Node {\n    struct Node* next;\n    void *value;\n} Node;\n\nvoid insert(Node** root, void* value) {\n    Node* new_node = (Node *) malloc(sizeof(Node));\n    Node* ptr;\n    new_node-&gt;value = value;\n    new_node-&gt;next = NULL;\n\n    if (*root == NULL)\n        *root = new_node;\n    else {\n        ptr = *root;\n        while (ptr-&gt;next != NULL)\n            ptr = ptr-&gt;next;\n        ptr-&gt;next = new_node;\n    }\n}\n\n\nNode* arr2list(void* array, size_t length) {\n    Node *root = NULL;\n    for(int i = 0; i &lt; length; i++) {\n        insert(&amp;root,&amp;array[i]);\n    }\n    return root;\n}\n</code></pre>\n\n<p>I wrote a small test for it:</p>\n\n<pre><code>int main() {\n    int arr[] = { 1, 2, 3, 4, 5 };\n    int n = sizeof(arr) / sizeof(arr[0]);\n    Node* root = arr2list(arr, n);\n    while (root != NULL)\n    {\n        printf(\"%d,\",*(int*) root-&gt;value);\n        root = root-&gt;next;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>But I get garbage values: <code>-13308,-2145276560,-2145276560,-2145276560,-2145276560,</code>.</p>\n\n<p>I can't seem to find the mistake that leads to those results.</p>\n\n<p>What could be the issue?</p>\n"}, {"tags": ["c", "ubuntu", "ncurses"], "comments": [{"owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 2, "creation_date": 1566323139, "post_id": 57578362, "comment_id": 101617916, "body": "nRows and nCols are being used before they are assigned a value"}, {"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "reply_to_user": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 1, "creation_date": 1566331412, "post_id": 57578362, "comment_id": 101621168, "body": "@jmq technically they are declared globally, so they are zero-initialized automatically so they are actually assigned before use. But yes, that is probably also problematic"}, {"owner": {"reputation": 59, "user_id": 10672612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754348447a56473e31a856c9be104965?s=128&d=identicon&r=PG&f=1", "display_name": "keith bradley", "link": "https://stackoverflow.com/users/10672612/keith-bradley"}, "edited": false, "score": 0, "creation_date": 1566331910, "post_id": 57578362, "comment_id": 101621357, "body": "Sorry ... typo on my part. I changed getyx() to getmaxyx() ... still no output."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 10672612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754348447a56473e31a856c9be104965?s=128&d=identicon&r=PG&f=1", "display_name": "keith bradley", "link": "https://stackoverflow.com/users/10672612/keith-bradley"}, "edited": false, "score": 0, "creation_date": 1566331971, "post_id": 57580567, "comment_id": 101621384, "body": "Sorry ... typo on my part. I changed getyx() to getmaxyx() ... still no output."}, {"owner": {"reputation": 59, "user_id": 10672612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754348447a56473e31a856c9be104965?s=128&d=identicon&r=PG&f=1", "display_name": "keith bradley", "link": "https://stackoverflow.com/users/10672612/keith-bradley"}, "edited": false, "score": 0, "creation_date": 1566498432, "post_id": 57580567, "comment_id": 101685327, "body": "Thanks for the feedback Thomas ... but I was under the impression that I did not need to referesh() since STDSCR is no used?"}, {"owner": {"reputation": 59, "user_id": 10672612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754348447a56473e31a856c9be104965?s=128&d=identicon&r=PG&f=1", "display_name": "keith bradley", "link": "https://stackoverflow.com/users/10672612/keith-bradley"}, "edited": false, "score": 0, "creation_date": 1566498468, "post_id": 57580567, "comment_id": 101685335, "body": "Don&#39;t ask me why ... but today ... the code I originally posted (with the getmaxyx() correction) works. I fixed the typo yesterday and it did not. Problem now is that if I change x and y here ... getmaxyx(win, 0, 0, y, x, nRows, nCols) ... I get no output again."}, {"owner": {"reputation": 59, "user_id": 10672612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754348447a56473e31a856c9be104965?s=128&d=identicon&r=PG&f=1", "display_name": "keith bradley", "link": "https://stackoverflow.com/users/10672612/keith-bradley"}, "edited": false, "score": 0, "creation_date": 1566499792, "post_id": 57580567, "comment_id": 101685864, "body": "each time I make a change ... and recompile ... I seem to be getting intermittent no output with correct output ... not sure why ... but the original question was answered by all three posters ... so thanks all !"}], "tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": true, "score": 1, "last_activity_date": 1566430400, "last_edit_date": 1592644375, "creation_date": 1566330232, "answer_id": 57580567, "question_id": 57578362, "link": "https://stackoverflow.com/questions/57578362/no-characters-on-screen-sent-to-an-ncurses-pad/57580567#57580567", "title": "No characters on screen sent to an Ncurses pad", "body": "<p>After calling <code>initscr</code>, the current position in <code>stdscr</code> is <strong><code>0,0</code></strong>.  Your program then asks for the position and uses it as the size of a pad:</p>\n<blockquote>\n<p><a href=\"https://invisible-island.net/ncurses/man/curs_getyx.3x.html\" rel=\"nofollow noreferrer\">getyx(stdscr, nRows, nCols);</a></p>\n<p><a href=\"https://invisible-island.net/ncurses/man/curs_pad.3x.html#h3-newpad\" rel=\"nofollow noreferrer\">myPad = newpad(nRows, nCols);</a></p>\n</blockquote>\n<p>A <em>pad</em> with <strong>zero</strong> lines and <strong>zero</strong> columns will not show much on the screen.</p>\n<p>In the altered question, there are still two problems:</p>\n<ul>\n<li>the input is buffered (use <code>cbreak</code> to change that)</li>\n<li>there is a missing <code>refresh</code> before the loop (to ensure that <code>stdscr</code> is displayed).</li>\n</ul>\n<p>Here is a diff showing what might be done to fix those problems:</p>\n<pre><code>&gt; diff -u foo.c.orig foo.c\n--- foo.c.orig  2019-08-21 19:24:24.000000000 -0400\n+++ foo.c       2019-08-21 19:30:46.202769968 -0400\n@@ -13,12 +13,14 @@\n {\n \n   initscr();\n+  cbreak();\n+  noecho();\n \n   getmaxyx(stdscr, nRows, nCols);\n \n   myPad = newpad(nRows, nCols);\n \n-\n+  refresh();\n   while (1)\n   {\n     waddch(myPad, wgetch(myPad));\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 10672612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754348447a56473e31a856c9be104965?s=128&d=identicon&r=PG&f=1", "display_name": "keith bradley", "link": "https://stackoverflow.com/users/10672612/keith-bradley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 57580567, "answer_count": 1, "score": 2, "last_activity_date": 1566430400, "creation_date": 1566320145, "last_edit_date": 1566331943, "question_id": 57578362, "link": "https://stackoverflow.com/questions/57578362/no-characters-on-screen-sent-to-an-ncurses-pad", "title": "No characters on screen sent to an Ncurses pad", "body": "<p>This should work\nCan anyone tell me why I see no typed output on the screen?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;curses.h&gt;\n\n\nint nRows;\nint nCols;\n\nWINDOW  *myPad;\n\n\nint main(void)\n{\n\n  initscr();\n\n  getmaxyx(stdscr, nRows, nCols);\n\n  myPad = newpad(nRows, nCols);\n\n\n  while (1)\n  {\n    waddch(myPad, wgetch(myPad));\n    prefresh(myPad, 0, 0, 0, 0, nRows, nCols);\n  }\n\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I have no idea ... other similar examples work.\nCould this be an Ubuntu issue?</p>\n\n<p>18.04.3 latest patches of today.</p>\n"}, {"tags": ["c", "list", "struct", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1566320372, "post_id": 57578291, "comment_id": 101616766, "body": "same problem, but hard to see the similarity: <a href=\"https://stackoverflow.com/questions/10907650/add-to-array-call-results-in-null-list\" title=\"add to array call results in null list\">stackoverflow.com/questions/10907650/&hellip;</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1566320573, "post_id": 57578291, "comment_id": 101616854, "body": "Better, if you can handle an answer without coding solution: <a href=\"https://stackoverflow.com/questions/20108412/c-linked-list-why-is-my-list-head-variable-remaining-null-new-to-c\" title=\"c linked list why is my list head variable remaining null new to c\">stackoverflow.com/questions/20108412/&hellip;</a>"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 2, "creation_date": 1566320638, "post_id": 57578291, "comment_id": 101616880, "body": "@Alessandro The function  Lcreate returns nothing though its return type is not void."}, {"owner": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "edited": false, "score": 0, "creation_date": 1566320826, "post_id": 57578291, "comment_id": 101616970, "body": "And it can sometimes be very useful to return something!"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1566321022, "post_id": 57578291, "comment_id": 101617068, "body": "These two give code solutions for the two most obvious solutions. <a href=\"https://stackoverflow.com/questions/28498069/linked-list-for-stack-head-next-keeps-becoming-null\" title=\"linked list for stack head next keeps becoming null\">stackoverflow.com/questions/28498069/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/36338968/inserting-element-at-start-of-linked-list-works-in-function-but-on-return-from\" title=\"inserting element at start of linked list works in function but on return from\">stackoverflow.com/questions/36338968/&hellip;</a> The second one better matches your prototype."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1566321047, "post_id": 57578291, "comment_id": 101617075, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/36338968/inserting-element-at-start-of-linked-list-works-in-function-but-on-return-from\">Inserting element at start of linked list works in function, but on return from function the start point is NULL</a>"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1566322679, "last_edit_date": 1566322679, "creation_date": 1566321108, "answer_id": 57578588, "question_id": 57578291, "link": "https://stackoverflow.com/questions/57578291/problems-during-the-creation-of-a-list/57578588#57578588", "title": "Problems during the creation of a list", "body": "<p>For starters the function <code>Lcreate</code> returns nothing though its return  type is <code>elem *</code>.</p>\n\n<pre><code>elem* Lcreate(elem *list);\n</code></pre>\n\n<p>Within the function the original pointer to the head of the list is not changed.</p>\n\n<p>It is better when the function returns the number of added elements to the list.</p>\n\n<p>The function can be defined the following way</p>\n\n<pre><code>size_t Lcreate( elem **list ) \n{\n    size_t listsize;\n\n    scanf( \"%zu\", &amp;listsize );\n\n    for ( size_t i = 0; i &lt; listsize; i++ )\n    {\n        *list = ( elem * )malloc( sizeof( elem ) );\n\n        scanf( \"%d\", &amp;( *list )-&gt;key );\n        ( *list )-&gt;next = NULL;\n\n        list = &amp;( *list )-&gt;next;\n    }\n\n    return listsize;\n}\n</code></pre>\n\n<p>and called like</p>\n\n<pre><code>elem *list = NULL;\nLcreate( &amp;list );\n</code></pre>\n\n<p>or</p>\n\n<pre><code>elem *list = NULL;\nsize_t n = Lcreate( &amp;list );\n</code></pre>\n\n<p>Or you can add a check into the function that a next node was successfully allocated. For example</p>\n\n<pre><code>size_t Lcreate( elem **list ) \n{\n    size_t listsize;\n\n    scanf( \"%zu\", &amp;listsize );\n\n    size_t i = 0;\n\n    for ( ; i &lt; listsize &amp;&amp; ( *list = malloc( sizeof( elem ) ) ) != NULL; i++ )\n    {\n        scanf( \"%d\", &amp;( *list )-&gt;key );\n        ( *list )-&gt;next = NULL;\n\n        list = &amp;( *list )-&gt;next;\n    }\n\n    return i;\n}\n</code></pre>\n\n<p>Pay attention to that the header <code>&lt;malloc.h&gt;</code> is not a standard header. It should be removed. The allocation functions are declared in the header <code>&lt;stdlib.h&gt;</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 11952810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f0482b86df5efb5a0a054eef951fdd?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro", "link": "https://stackoverflow.com/users/11952810/alessandro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1566322679, "creation_date": 1566319869, "last_edit_date": 1566321131, "question_id": 57578291, "link": "https://stackoverflow.com/questions/57578291/problems-during-the-creation-of-a-list", "title": "Problems during the creation of a list", "body": "<p>When I execute the code it doesn't print the list, so adding the IF inside of the Lread function I discovered that *list is still NULL when I read it!\nCan you tell me why the Lcreate function fail to create the list?\nThank you very much!!</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;stdlib.h&gt;\n#include &lt;malloc.h&gt;\n\ntypedef struct _elem {\n    int key;\n    struct _elem *next;\n} elem;\n\nelem* Lcreate(elem *list) {\n    int listsize;\n    scanf(\"%d\",&amp;listsize);\n    elem *p = NULL;\n    p = list;\n    elem *nuovo = NULL;\n    int counter=0;\n    while(counter&lt;listsize){\n        nuovo = (elem *) malloc(sizeof(elem));\n        scanf(\"%d\",&amp;(nuovo-&gt;key));\n        nuovo-&gt;next=NULL;\n        if(p==NULL){\n            p=nuovo;}\n        else{\n            while(p-&gt;next!=NULL){\n                p=p-&gt;next;}\n            p-&gt;next=nuovo;}\n        counter++;}\n}\n\nelem* Lread(elem *list){\n    if (list==NULL){\n        printf(\"error\\n\");\n    }\n    elem *p = list;\n    while(p!=NULL){        \n        printf(\"%d\\n\",p-&gt;key);\n        p=p-&gt;next;\n    }\n}\n\n\nmain(){\n    struct _elem *list=NULL;\n    Lcreate(list);\n    Lread(list);\n}\n</code></pre>\n"}, {"tags": ["c", "character-encoding"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1566318923, "post_id": 57577986, "comment_id": 101616175, "body": "<a href=\"http://codepad.org/ZRTMhG7t\" rel=\"nofollow noreferrer\">Use <code>%u</code> instead of <code>%d</code>.</a>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 4, "creation_date": 1566319062, "post_id": 57577986, "comment_id": 101616243, "body": "@PaulR <code>%u</code> is likely to print a large value in this case!"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1566319145, "post_id": 57577986, "comment_id": 101616285, "body": "@IanAbbott: yes, possibly <a href=\"http://codepad.org/ZRTMhG7t\" rel=\"nofollow noreferrer\">49827</a>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1566319497, "post_id": 57577986, "comment_id": 101616435, "body": "@PaulR Since it is outputting <code>-93</code> for <code>%d</code>, it will likely output either 65443 (for 16-bit <code>unsigned int</code>) or 4294967203 (for 32-bit <code>unsigned int</code>)."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1566319522, "post_id": 57577986, "comment_id": 101616446, "body": "Using &quot;%d&quot; in printf requests a signed value. Use &quot;%u&quot;."}, {"owner": {"reputation": 393, "user_id": 6470928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ca50db72512cbab0ea4d95c14222d07?s=128&d=identicon&r=PG&f=1", "display_name": "bonehead", "link": "https://stackoverflow.com/users/6470928/bonehead"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566320089, "post_id": 57577986, "comment_id": 101616639, "body": "@IanAbbott using <code>%u</code> istead of <code>%d</code> prints the value appropriate for 32-bit <code>unsigned int</code>. The reason why I didn&#39;t use <code>%u</code> is because I doubt that the character set is so big that it would enter the negative part of <code>int</code>. Is it? What&#39;s going on?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566320686, "post_id": 57577986, "comment_id": 101616899, "body": "@ahra You were probably expecting 163 to be printed (if the source file is encoded and compiled as ISO-8859-1 or ISO-8859-15 character set). However, <code>char</code> appears to be a <i>signed</i>, 8-bit, 2&#39;s complement integer type on your system, so the range of <code>char</code> will be -128 to 127 inclusive."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1566320983, "post_id": 57577986, "comment_id": 101617051, "body": "To avoid this counter intuitive yet common and conformant behavior, compile with <code>-funsigned-char</code>, telling the compiler (gcc and clang) to make <code>char</code> unsigned by default."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1566340264, "post_id": 57577986, "comment_id": 101623827, "body": "That might be a requirement in order to satisfy some concern about transport or storage systems of the day. It&#39;s not really relevant today because you don&#39;t do mathematical operations on characters, do you? If you used a character code in a lexicographic sort or as an array index in a map, you would cast to an unsigned integer if necessary."}], "answers": [{"comments": [{"owner": {"reputation": 393, "user_id": 6470928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ca50db72512cbab0ea4d95c14222d07?s=128&d=identicon&r=PG&f=1", "display_name": "bonehead", "link": "https://stackoverflow.com/users/6470928/bonehead"}, "edited": false, "score": 0, "creation_date": 1566320841, "post_id": 57578489, "comment_id": 101616978, "body": "So technically I should read &quot;standard printing set&quot; in this context as basic ASCII?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 393, "user_id": 6470928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ca50db72512cbab0ea4d95c14222d07?s=128&d=identicon&r=PG&f=1", "display_name": "bonehead", "link": "https://stackoverflow.com/users/6470928/bonehead"}, "edited": false, "score": 0, "creation_date": 1566320944, "post_id": 57578489, "comment_id": 101617027, "body": "@ahra: K&amp;R is old and not useful as a formal specification for modern C."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1566321054, "post_id": 57578489, "comment_id": 101617078, "body": "@IanAbbott: There were a variety of machines in use way back when with varied character sets."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 3, "last_activity_date": 1566320648, "creation_date": 1566320648, "answer_id": 57578489, "question_id": 57577986, "link": "https://stackoverflow.com/questions/57577986/how-is-it-so-that-these-character-constants-have-negative-values/57578489#57578489", "title": "How is it so that these character constants have negative values?", "body": "<p>K&amp;R is somewhat informal, but apparently \u201c\u00a3\u201d is not in your implementation\u2019s \u201cstandard printing set.\u201d The C standard is more formal. It specifies that members of the basic execution character set are nonnegative when stored in <code>char</code> and defines the set to contain A-Z, a-z, 0-9, !, \", #, %, &amp;, ', (, ), *, +, comma, -, period, /, :, ;, &lt;, =, >, ?, [, \\, ], ^, _, {, |, }, ~, space, horizontal tab, vertical tab, form feed, alert, backspace, carraige return, new line, and a null character. \u201c\u00a3\u201d is not among these, so the C standard does not require that its value be nonnegative.</p>\n"}, {"tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": false, "score": 1, "last_activity_date": 1566324048, "creation_date": 1566324048, "answer_id": 57579256, "question_id": 57577986, "link": "https://stackoverflow.com/questions/57577986/how-is-it-so-that-these-character-constants-have-negative-values/57579256#57579256", "title": "How is it so that these character constants have negative values?", "body": "<p>The following affect the value of an <code>int</code> expressed as a character constant containing a single character:</p>\n\n<ol>\n<li>the actual character set and character encoding of the source file;</li>\n<li>the assumed (by the compiler) character set and character encoding of the source file;</li>\n<li>whether the character in the character constant is encoded as a multibyte character or a single-byte character;</li>\n<li>if encoded as a single-byte character, whether the character code falls within the range of the <code>char</code> type or not.</li>\n</ol>\n\n<p>Ideally, you want the assumed character set and encoding of the source to match the actual character set and encoding.</p>\n\n<p>The value of a character constant containing a multibyte sequence (more than one byte) is implementation defined.</p>\n\n<p>If the <code>char</code> type is signed, there may be single-byte characters in the source that cannot be represented as positive <code>char</code> values. Such characters will be represented as negative <code>char</code> values.</p>\n\n<p>In OP's example,</p>\n\n<pre><code>printf(\"%d\", '\u00a3');\n</code></pre>\n\n<p>printed the value -93. Since the '\u00a3' character has decimal code 163 in the ISO-8859-1 and ISO-8859-15 character sets, the following seems the most likely deduction:</p>\n\n<ol>\n<li>The source character set is actually ISO-8859-1 or ISO-8859-15 or possibly some variant such as Windows CP-1252.</li>\n<li>The source character set assumed by the compiler is ISO-8859-1 or ISO-8859-15 or possibly some variant such as Windows CP-1252.</li>\n<li>Due to 1 and 2 above, all characters in the source are encoded as single bytes.</li>\n<li>The <code>char</code> type on OP's system is an 8-bit, 2's-complement, signed integer type. (N.B. 163 - 256 = -93.)</li>\n</ol>\n\n<p>According to C11 section 6.4.4.4 paragraph 10:</p>\n\n<blockquote>\n  <p>If an integer character constant contains a single character or escape sequence, its value is the one that results when an object with type <code>char</code> whose value is that of the single character or escape sequence is converted to type <code>int</code>.</p>\n</blockquote>\n\n<p>Since <code>int</code> can represent all the values of <code>char</code> if <code>char</code> is signed, and the <code>int</code> constant produced by <code>'\u00a3'</code> was -93 on OP's system, then as long as <code>'\u00a3'</code> really is a single-byte character constant on OP's system it can be deduced that the <code>char</code> value also -93. If <code>'\u00a3'</code> is actually a multibyte (more than one byte) character constant on OP's system, then its value is implementation defined and no such deduction can be made.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1566384750, "last_edit_date": 1566384750, "creation_date": 1566328986, "answer_id": 57580307, "question_id": 57577986, "link": "https://stackoverflow.com/questions/57577986/how-is-it-so-that-these-character-constants-have-negative-values/57580307#57580307", "title": "How is it so that these character constants have negative values?", "body": "<p>the characters you are concerned about are multi character formats. I.E. 16bits rather than 8 bits I.E. wide characters.  so the statement: <code>printf(\"%d\", '\u00a3');</code> will cause the compiler to output a warning message.  A much better way to write that statement is: <code>printf(\"%d\", L'\u00a3');</code>  Notice the 'L' before the character.</p>\n\n<p>When <code>printf()</code> prints the value using: <code>%d</code> the char is 'promoted` to an integer.</p>\n\n<p>When the upper most bit is 'set', the promotion sees the char as negative so the resulting value will be negative (via sign extension)</p>\n\n<p>However, the upper most bit in this wide character is NOT set, so when the correct data format is used, the <code>printf()</code> outputs: <code>163</code></p>\n"}], "owner": {"reputation": 393, "user_id": 6470928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ca50db72512cbab0ea4d95c14222d07?s=128&d=identicon&r=PG&f=1", "display_name": "bonehead", "link": "https://stackoverflow.com/users/6470928/bonehead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 2, "accepted_answer_id": 57578489, "answer_count": 3, "score": 0, "last_activity_date": 1566384750, "creation_date": 1566318642, "question_id": 57577986, "link": "https://stackoverflow.com/questions/57577986/how-is-it-so-that-these-character-constants-have-negative-values", "title": "How is it so that these character constants have negative values?", "body": "<p>Reading K&amp;R 1st paragraph page 44 Chapter 2 - <em>The definition of C guarantees that any character in the machine's standard printing set will never be negative, so these characters will always be positive quantities in expressions.</em></p>\n\n<p>Well enough, but when I run the following code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    printf(\"%d\", '\u00a3');\n\n    return 0;\n}\n</code></pre>\n\n<p>I get <code>-93</code> as the output. I will just cite some of the negative values I get along with the corresponding characters: <code>\u00ff = -1</code>, <code>\u00fe = -2</code>, <code>\u00f7 = -9</code>. I don't understand: if it is true that C guarantees that these values are positive in expressions, how is it that the values are negative?</p>\n"}, {"tags": ["c", "pointers", "pointer-arithmetic"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 11, "creation_date": 1566317369, "post_id": 57577632, "comment_id": 101615424, "body": "Because you have an array of <i>pointers</i>. Your pointers have a size of 4, <code>6 * 4 = 24</code> which is <code>0x18</code>. Pointer arthimetic works in units of elements, like array indexing does."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 4, "creation_date": 1566317430, "post_id": 57577632, "comment_id": 101615460, "body": "<code>Buffer</code> is an array of pointers. So the assignment <code>Buffer2 = Buffer + 6</code> should be generating a compiler warning about mismatched pointers. Be sure to enable the compiler warnings. With gcc and clang, you should be using the <code>-Wall -Wextra -Werror</code> command line options (as a minimum)."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 2, "creation_date": 1566317437, "post_id": 57577632, "comment_id": 101615464, "body": "Didn&#39;t the compiler warn about -- <code>char *Buffer2 = Buffer + 6;</code> ?"}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1566317472, "post_id": 57577632, "comment_id": 101615479, "body": "You have an array of <code>pointers</code>, not <code>char</code>. How did this even compile? Seems like you should at least have warnings."}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1566317607, "post_id": 57577632, "comment_id": 101615539, "body": "Don&#39;t ever ignore compiler warnings; they are usually a sign you&#39;ve done something funky."}, {"owner": {"reputation": 2605, "user_id": 4846598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56c681dc497676a33de782f84bc7a87f?s=128&d=identicon&r=PG&f=1", "display_name": "Hearner", "link": "https://stackoverflow.com/users/4846598/hearner"}, "edited": false, "score": 0, "creation_date": 1566317695, "post_id": 57577632, "comment_id": 101615581, "body": "Change <code>char *Buffer[10];</code> to <code>char Buffer[10];</code>. I got the desired output"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1566318352, "last_edit_date": 1566318352, "creation_date": 1566318044, "answer_id": 57577828, "question_id": 57577632, "link": "https://stackoverflow.com/questions/57577632/i-dont-understand-c-pointers/57577828#57577828", "title": "I don&#39;t understand C pointers", "body": "<p>The difference between these two values</p>\n\n<pre><code>Buffer = 0x56559040\nBuffer2 = 0x56559058\n</code></pre>\n\n<p>is <code>0x18</code> or in decimal <code>24</code>.</p>\n\n<p>In this declaration</p>\n\n<pre><code>char *Buffer2 = Buffer + 6;\n</code></pre>\n\n<p>the array designator <code>Buffer</code> is converted to pointer to its first element. As the element type of the array <code>Buffer</code> is <code>char *</code> then the expression has the type <code>char **</code>.</p>\n\n<p>There is no implicit conversion between types <code>char *</code> (the type of the variable <code>Buffer2</code>) and <code>char **</code> (the type of the initializer)</p>\n\n<p>So the compiler should issue at least a warning.</p>\n\n<p>Nevertheless using the pointer arithmetic this expression</p>\n\n<pre><code>Buffer + 6\n</code></pre>\n\n<p>is evaluated like </p>\n\n<pre><code>the value of the address pointed to by Buffer + 6 * sizeof( char * )\n</code></pre>\n\n<p>as the size of a pointer of the type <code>char *</code> (the size of element of the array) in your system is equal to <code>4</code> then you get the value 0x56559058 that is </p>\n\n<pre><code>0x56559040 + 6 * sizeof( char * )\n                 ^^^^^^^^^^^^^^^^\n                       4\n</code></pre>\n\n<p>That is the expression</p>\n\n<pre><code>Buffer + 6\n</code></pre>\n\n<p>points to the sixth element of the array Buffer.</p>\n"}], "owner": {"reputation": 119, "user_id": 9429262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2b96bc87261cf77b69c0e2233d2af6?s=128&d=identicon&r=PG&f=1", "display_name": "Alvin", "link": "https://stackoverflow.com/users/9429262/alvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 57577828, "answer_count": 1, "score": 1, "last_activity_date": 1566318363, "creation_date": 1566317234, "last_edit_date": 1566318363, "question_id": 57577632, "link": "https://stackoverflow.com/questions/57577632/i-dont-understand-c-pointers", "title": "I don&#39;t understand C pointers", "body": "<p>I don't really understand the reason why I obtain a different address from what I'm expecting.</p>\n\n<p>I've tried to build this small C code with <code>-m32</code> flag option.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar *Buffer[10];\n\nint main (void){\n printf(\"%p\\n\", Buffer);\n char *Buffer2 = Buffer + 6;\n printf(\"%p\\n\", Buffer2);\n}\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>Buffer = 0x56559040\nBuffer2 = 0x56559046\n</code></pre>\n\n<p>Obtained output:</p>\n\n<pre><code>Buffer = 0x56559040\nBuffer2 = 0x56559058\n</code></pre>\n\n<p>Why the obtained output is different from the expected one (0x56559040 + 6 = 0x56559046)?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4644, "user_id": 1431720, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f5a1388d4d3b2bf03b11bb5658c68c29?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1431720/robert"}, "edited": false, "score": 4, "creation_date": 1566317708, "post_id": 57577631, "comment_id": 101615585, "body": "Headers make function prototypes available / known to the compiler. Try using <code>strlen</code> without including <code>string.h</code>. Please find a C tutorial or textbook."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1566317845, "post_id": 57577631, "comment_id": 101615656, "body": "Without the header included, wth MSVC I get a compiler warning that it does not know what <code>printf</code> means, and then a linker error. So it doesn&#39;t work at all."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1566319228, "post_id": 57577631, "comment_id": 101616320, "body": "If you can get that code to run without the include line, then read the warnings you get while doing that."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1566320110, "post_id": 57577631, "comment_id": 101616650, "body": "Without the header the program is invalid. If your compiler didn&#39;t tell you that, you need a newer compiler."}, {"owner": {"reputation": 750, "user_id": 607567, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2cdaf11bb9df57dba9722b7ca291ab17?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/607567/marco"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1566320916, "post_id": 57577631, "comment_id": 101617017, "body": "@n.m. that is not true, the header definition is a compatibility thing, it will fail if your environment doesn&#39;t have the libraries in the expected places though. Of course, if you want custom libs you gotta use them, and it is a good practice to always put them, this because there are macros and types that are not available if the declaration is not done."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 750, "user_id": 607567, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2cdaf11bb9df57dba9722b7ca291ab17?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/607567/marco"}, "edited": false, "score": 0, "creation_date": 1566321328, "post_id": 57577631, "comment_id": 101617172, "body": "@Marco You are unfortunately  wrong. Every function or variable needs to be declared before use. Please read the C standard or a good <i>modern</i> C book. In historic versions of C one could omit declarations of some functions, but priintf is not one if them."}, {"owner": {"reputation": 750, "user_id": 607567, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2cdaf11bb9df57dba9722b7ca291ab17?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/607567/marco"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1566326089, "post_id": 57577631, "comment_id": 101619089, "body": "@n.m. I am totally ok with putting headers, that is the best way to do it, but, the compiler should search on the standard paths in order to find what it needs. The event will be a warning, and the compilation should finish without issues."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 750, "user_id": 607567, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2cdaf11bb9df57dba9722b7ca291ab17?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/607567/marco"}, "edited": false, "score": 0, "creation_date": 1566326708, "post_id": 57577631, "comment_id": 101619333, "body": "@Marco &quot;warning, and the compilation should finish without issues&quot;. A warning <b>is</b> an issue. In C++11 the program is <b>invalid</b>, as in not allowed by the standard. In earlier versions, it has <b>undefined behaviour</b>."}, {"owner": {"reputation": 750, "user_id": 607567, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2cdaf11bb9df57dba9722b7ca291ab17?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/607567/marco"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1566333569, "post_id": 57577631, "comment_id": 101621924, "body": "@n.m. You are talking about C11. I haven&#39;t checked that yet, I am on C90 and those warnings can be avoided without issues. Now, note that even in C11, the lack of the prototypes is no a big issue, they added as a constraint for probably... best practices and performance?! I don&#39;t know"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 750, "user_id": 607567, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2cdaf11bb9df57dba9722b7ca291ab17?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/607567/marco"}, "edited": false, "score": 0, "creation_date": 1566367261, "post_id": 57577631, "comment_id": 101628574, "body": "@Marco C90 is a historic standard that was supplanted 20 years ago. Even in C90 calling printf without a prototype in scope is <b>undefined behaviour</b>. Headers are not &quot;best practice&quot;, they are the only valid practice. &quot;the lack of the prototypes is no a big issue&quot; Have you <i>read</i> C11? I have. It is illegal to call a function without an explicit declaration in scope."}, {"owner": {"reputation": 750, "user_id": 607567, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2cdaf11bb9df57dba9722b7ca291ab17?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/607567/marco"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1566397308, "post_id": 57577631, "comment_id": 101645125, "body": "@n.m. Mine is C99..., I can run all the ones prior to C11. No, I haven&#39;t read that one, the linux servers that we have are all with gcc that don&#39;t support C11, so.. I am not touching them. Now, for the sake of this particular question!!, why it happened? why it was working?! It was explained."}], "answers": [{"tags": [], "owner": {"reputation": 750, "user_id": 607567, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2cdaf11bb9df57dba9722b7ca291ab17?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/607567/marco"}, "is_accepted": true, "score": 1, "last_activity_date": 1566333644, "last_edit_date": 1566333644, "creation_date": 1566319671, "answer_id": 57578247, "question_id": 57577631, "link": "https://stackoverflow.com/questions/57577631/what-is-functionwork-of-header-in-c-programming/57578247#57578247", "title": "What is function(work) of header in c programming?", "body": "<p>The headers are just defining the prototypes, not importing anything, in C you are not actually importing the functions, etc.</p>\n\n<p>When you use printf, you are just calling the standard lib libc.so (if working on linux), which will anyways print the string.</p>\n\n<p>IF, you don't have an standard function, you need to declare it in the header, that definition will then be taken from your file.</p>\n\n<p>Now, as a matter of compatibility, you should put it, since there are libary declarations that are only going to get added when the header is in place, like specific types and macros.</p>\n\n<p>I am leaving here the libc manual, so you can take a look:\n<a href=\"https://www.gnu.org/software/libc/manual/pdf/libc.pdf\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/libc/manual/pdf/libc.pdf</a></p>\n\n<p>Another thing to take into account is performance, the lack of macros will make your program suffer (not in your case), but in a real big program, and those are not going to be in your program if the include is not in place, so .. it is always good practice to put them.</p>\n\n<p>Update: Note that this is not C11 compliant, the code will work on any implementation preC11 standard. (thanks @n.m here for the note)</p>\n"}, {"comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1602658751, "post_id": 64348071, "comment_id": 113786717, "body": "Welcome to SO. This answer is not really correct. It is not recommended to put definitions into headers. In vast majority of cases only declarations should go in headers."}], "tags": [], "owner": {"reputation": 9, "user_id": 14269933, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f5gTpGcN1pg/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucnrXvP8nbwEOkZmpxw2yFfWnX1-Ug/photo.jpg?sz=128", "display_name": "Khalid Ahmad Nori", "link": "https://stackoverflow.com/users/14269933/khalid-ahmad-nori"}, "is_accepted": false, "score": -1, "last_activity_date": 1602658565, "creation_date": 1602658565, "answer_id": 64348071, "question_id": 57577631, "link": "https://stackoverflow.com/questions/57577631/what-is-functionwork-of-header-in-c-programming/64348071#64348071", "title": "What is function(work) of header in c programming?", "body": "<p>Ok header file is like you know like library every thing is defined in header file befor you code.  every thing are stored in header.</p>\n"}], "owner": {"reputation": 9, "user_id": 11952622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dhmg9VqK_9A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfl8PsoGL_WYsCig-F5rOIp_YZXDw/photo.jpg?sz=128", "display_name": "Tarkeshwar Kumar", "link": "https://stackoverflow.com/users/11952622/tarkeshwar-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 57578247, "answer_count": 2, "score": -3, "last_activity_date": 1602658565, "creation_date": 1566317228, "last_edit_date": 1566317724, "question_id": 57577631, "link": "https://stackoverflow.com/questions/57577631/what-is-functionwork-of-header-in-c-programming", "title": "What is function(work) of header in c programming?", "body": "<p>what header line actually do in c programming?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main ()\n{\n    printf(\"Hello World!\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>this code gives same output with or without header line, why it is so?</p>\n"}, {"tags": ["c", "operators", "operator-precedence"], "comments": [{"owner": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "edited": false, "score": 0, "creation_date": 1566314894, "post_id": 57576934, "comment_id": 101614106, "body": "What do you get if you use 9.0/5 ? (Also: <i>Fahrenheit</i>.)"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 5, "creation_date": 1566314965, "post_id": 57576934, "comment_id": 101614162, "body": "That won&#39;t compile..."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1566315077, "post_id": 57576934, "comment_id": 101614229, "body": "<a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/operator_precedence</a> should give an idea. (hint: when two operators have the same precedence, in what order are they evaluated?)"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1566315514, "post_id": 57576934, "comment_id": 101614495, "body": "@Geo Mukkath What is &quot;celt is&quot;?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1566315787, "post_id": 57576934, "comment_id": 101614643, "body": "@VladfromMoscow <code>is</code> is a macro that&#39;s defined to <code>==</code>, but still..."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1566315872, "post_id": 57576934, "comment_id": 101614678, "body": "<a href=\"https://stackoverflow.com/q/4890480/995714\">C program to convert Fahrenheit to Celsius always prints zero</a>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1566331162, "post_id": 57576934, "comment_id": 101621054, "body": "Copy/paste code that you actually tried."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1566371517, "post_id": 57576934, "comment_id": 101630318, "body": "Use floating point literals (as <code>9.0&#47;5.0</code>,  instead of <code>9&#47;5</code>)  Integer division <code>9&#47;5</code> gives you <code>1</code>, while <code>9.0&#47;5.0</code> gives you <code>1.8</code>.  <code>(C*9)&#47;5</code> when <code>C</code> is a floating point variable, will convert first <code>9</code> to double, then the result (<code>double</code>) will be divided by <code>5.0</code>."}], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 4, "last_activity_date": 1566316069, "last_edit_date": 1566316069, "creation_date": 1566315041, "answer_id": 57577012, "question_id": 57576934, "link": "https://stackoverflow.com/questions/57576934/what-is-difference-between-f-9-5-c-32-and-f-c-9-5-32-precedence/57577012#57577012", "title": "What is difference between F = (9/5 * C) + 32 and F = (C *9/5) + 32 ? Precedence?", "body": "<p>Yes, precedence (and integer arithmetic).</p>\n\n<p>They're evaluated like this:</p>\n\n<pre><code>F = ((C * 9)/5 ) + 32;\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>F = ((9/5) * C) + 32;\n</code></pre>\n\n<p>The way C does integer arithmetic (it truncates integers towards zero) makes the second incorrect (<code>9/5</code> is one).</p>\n\n<p>Instead, use <code>9.f</code>, <code>5.f</code>, and <code>32.f</code>. That way, precedence won't change much (and you'll get correct results).</p>\n"}, {"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 3, "creation_date": 1566315309, "post_id": 57577088, "comment_id": 101614365, "body": "Don&#39;t forget the <code>f</code> suffix. The OP is dealing with <code>float</code>s."}, {"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 5, "creation_date": 1566315478, "post_id": 57577088, "comment_id": 101614474, "body": "@JL2210:  the explicit type suffix <code>f</code> is not needed except for the pickiest of compilers.  The expression will be evaluated as a <code>double</code> and truncated to a <code>float</code> on assignment to <code>fahr</code>."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1566317061, "post_id": 57577088, "comment_id": 101615283, "body": "Yes, but in general, try to avoid implicit type changes (they surprise you when you&#39;re not paying attention)."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 2, "creation_date": 1566318597, "post_id": 57577088, "comment_id": 101616022, "body": "@JL2210 Implicit type conversions are a <i>feature of the language</i>.  Avoiding them is silly; doing so denies the utility of using a higher-order language in the first place.  Naturally you have to learn to avoid a few pitfalls (this question demonstrates a dandy one), but I have to disagree with your blanket advice to &quot;avoid implicit type changes&quot;.  In general they&#39;re fine."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1566332150, "post_id": 57577088, "comment_id": 101621449, "body": "implicit type conversions can (and often will) result in values other than what the programmer is expecting.   That is why the compiler (when warnings are enabled) outputs a warning message about the problem"}], "tags": [], "owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "is_accepted": false, "score": 3, "last_activity_date": 1567737856, "last_edit_date": 1567737856, "creation_date": 1566315274, "answer_id": 57577088, "question_id": 57576934, "link": "https://stackoverflow.com/questions/57576934/what-is-difference-between-f-9-5-c-32-and-f-c-9-5-32-precedence/57577088#57577088", "title": "What is difference between F = (9/5 * C) + 32 and F = (C *9/5) + 32 ? Precedence?", "body": "<p>Besides the precedence problem, the result of <code>9/5</code> is <code>1</code>.  It would work more like expected if it were written</p>\n\n<pre><code>9.0/5       or\n9/5.0        or\n9.0/5.0       or (even)\n1.8\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1566317084, "post_id": 57577191, "comment_id": 101615296, "body": "So <code>F = ((C * 9)&#47;5) + 32</code> will be more precise than <code>F = ((9&#47;5) * C) + 32</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1566332012, "post_id": 57577191, "comment_id": 101621401, "body": "no, the expression: <code>9&#47;5</code> results in 1 due to integer truncation of the fraction"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 2, "creation_date": 1566371825, "post_id": 57577191, "comment_id": 101630466, "body": "IMHO the best is to use all floating point, as the problem is talking about temperatures: <code>F = 9.0&#47;5.0 * C + 32.0;</code>  When converting temperatures it is better to think as a scientist, not as an assembler programmer :)  OMG! this program is the second example of K&amp;R book!!!  Doesn&#39;t anybody read it?"}], "tags": [], "owner": {"reputation": 76876, "user_id": 287586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tB5AG.png?s=128&g=1", "display_name": "dan04", "link": "https://stackoverflow.com/users/287586/dan04"}, "is_accepted": false, "score": 7, "last_activity_date": 1566315638, "creation_date": 1566315638, "answer_id": 57577191, "question_id": 57576934, "link": "https://stackoverflow.com/questions/57576934/what-is-difference-between-f-9-5-c-32-and-f-c-9-5-32-precedence/57577191#57577191", "title": "What is difference between F = (9/5 * C) + 32 and F = (C *9/5) + 32 ? Precedence?", "body": "<p>Multiplication and division have equal precedence in C, and left-to-right associativity.  So,</p>\n\n<ul>\n<li><code>F = (C * 9/5 ) + 32</code> is equivalent to <code>F = ((C * 9)/5) + 32</code></li>\n<li><code>F = (9/5 * C) + 32</code> is equivalent to <code>F = ((9/5) * C) + 32</code></li>\n</ul>\n\n<p>The two expressions would be algebraically equivalent, except for the fact that C defines <code>int / int = int</code>, discarding the remainder.  So, <code>9/5</code> is not 1.8 as you might have expected, but 1.</p>\n\n<p>To get a floating-point result from dividing two <code>int</code>s, you need to convert at least one of the operands to <code>float</code> or <code>double</code>.  So instead of <code>9/5</code>, write:</p>\n\n<ul>\n<li><code>9.0/5.0</code>, <code>9.0/5</code>, <code>9/5.0</code>, or <code>1.8</code>, which gives you a <code>double</code>, or</li>\n<li><code>9.0f/5.0f</code>, <code>9.0f/5</code>, <code>9/5.0f</code>, or <code>1.8f</code>, which gives you a <code>float</code></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1566372037, "post_id": 57577307, "comment_id": 101630555, "body": "why everybody insists in using integers, when all the arithmetic mus be done in floats? With this approach, the newcomers to C will believe that using floating point literals is an expensive task.  Nothing further from reality."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1566317430, "last_edit_date": 1566317430, "creation_date": 1566316010, "answer_id": 57577307, "question_id": 57576934, "link": "https://stackoverflow.com/questions/57576934/what-is-difference-between-f-9-5-c-32-and-f-c-9-5-32-precedence/57577307#57577307", "title": "What is difference between F = (9/5 * C) + 32 and F = (C *9/5) + 32 ? Precedence?", "body": "<p>This expression</p>\n\n<pre><code>C * 9/5\n</code></pre>\n\n<p>is evaluated form left to right because the used operators have the same precedence.</p>\n\n<p>So, it is evaluated like</p>\n\n<pre><code>( C * 9 ) / 5\n</code></pre>\n\n<p>Each time when a sub-expression is evaluated the compiler determines the common type of the used operands.</p>\n\n<p>The common type of the sub-expression</p>\n\n<pre><code>C * 9\n</code></pre>\n\n<p>is float according to the usual arithmetic conversions. So the result of this sub-expression has the type float and the result of the whole expression </p>\n\n<pre><code>( C * 9 ) / 5\n</code></pre>\n\n<p>is correspondingly has the type float.</p>\n\n<p>This expression</p>\n\n<pre><code>9/5 * C\n</code></pre>\n\n<p>is evaluated like</p>\n\n<pre><code>(9/5) * C\n</code></pre>\n\n<p>As the both operands of the sub-expression</p>\n\n<pre><code>9/5\n</code></pre>\n\n<p>are integers then there is used the integer arithmetic and the result of the sub-expression is also integer.</p>\n\n<p>To avoid the dependence of the order of operands you could for example write </p>\n\n<pre><code>(9.f/5) * C\n</code></pre>\n\n<p>or</p>\n\n<pre><code>(9/5.0f) * C\n</code></pre>\n\n<p>In this case the sub-expressions</p>\n\n<pre><code>8.0f/5\n</code></pre>\n\n<p>and</p>\n\n<pre><code>8/5.0f\n</code></pre>\n\n<p>are evaluated as an expression with float numbers.</p>\n"}], "owner": {"reputation": 97, "user_id": 7622682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58e4aca74743af9d43b360b8413b084?s=128&d=identicon&r=PG&f=1", "display_name": "Geo Mukkath", "link": "https://stackoverflow.com/users/7622682/geo-mukkath"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "closed_date": 1566342440, "answer_count": 4, "score": 2, "last_activity_date": 1567737856, "creation_date": 1566314768, "last_edit_date": 1566385797, "question_id": 57576934, "link": "https://stackoverflow.com/questions/57576934/what-is-difference-between-f-9-5-c-32-and-f-c-9-5-32-precedence", "closed_reason": "Duplicate", "title": "What is difference between F = (9/5 * C) + 32 and F = (C *9/5) + 32 ? Precedence?", "body": "<p>F = (C * 9/5 ) + 32 and F = (9/5 * C) + 32 yield two different results although the input for C is the same. I realize that there is some kind of precedence in operators but i am not sure about it. Does multiplication come before division ? </p>\n\n<p>An input of 20 gives the Fahrenheit value as 68(correct one) in the first case and 52 in the second. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    float cel , fahr ; \n    printf(\"Enter the temperature(C): \");\n    scanf(\"%f\",&amp;cel);\n    fahr = (9/5 * celt is  ) + 32;\n    printf(\"\\nThe temperature in fahranheit is %f \",fahr);\n\n}\n</code></pre>\n\n<p>Expected result is 68 but its 52 for the above code. If I switch the position of '9/5' and 'cel' it gives the correct result. Why is that ?</p>\n"}, {"tags": ["c++", "c", "native", "messaging", "microsoft-edge-extension"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1566314209, "post_id": 57576523, "comment_id": 101613688, "body": "Please post the non working code in your question. All those links don&#39;t help much to solve your problem."}, {"owner": {"reputation": 1548, "user_id": 8319683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LBugp.jpg?s=128&g=1", "display_name": "Shim-Sao", "link": "https://stackoverflow.com/users/8319683/shim-sao"}, "edited": false, "score": 1, "creation_date": 1566315857, "post_id": 57576523, "comment_id": 101614669, "body": "Welcome in Stackoverflow. We\u2019d love to help you.  To get a good Answer for your Question: Can you edit the question and provide  some code and/or more explanations, if there is, of what  you are doing, and what&#39;s wrong. To avoid downvote and bad comments,  please take some time to read <a href=\"https://stackoverflow.com/help\">Help</a>  and <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question</a>"}, {"owner": {"reputation": 1, "user_id": 11945632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90716f4b8fb489494a2d8ff638c8a827?s=128&d=identicon&r=PG&f=1", "display_name": "AliShahi", "link": "https://stackoverflow.com/users/11945632/alishahi"}, "edited": false, "score": 0, "creation_date": 1566323189, "post_id": 57576523, "comment_id": 101617944, "body": "Thanks <a href=\"https://stackoverflow.com/users/8319683/shim-sao\">Shim-Sao</a>. But I have already reworded my original question because it was put on-hold. The amount of code associated with this is far too big to include in the question. The crunch point is that the use of runtime.sendNativeMessage API in an Edge extension is insufficient to make it into a non-persistent connection, i.e. one that starts/exchanges messages and then closes the native app. So, the question is what else to do besides using runtime.sendNativeMessage() to make an Edge extension work with non-persistent connections?"}, {"owner": {"reputation": 6456, "user_id": 11490347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFlKK.jpg?s=128&g=1", "display_name": "Yu Zhou", "link": "https://stackoverflow.com/users/11490347/yu-zhou"}, "edited": false, "score": 0, "creation_date": 1566369678, "post_id": 57576523, "comment_id": 101629508, "body": "From the doc, it says <i>Microsoft Edge will terminate the connection after every messages&#39; response has been received.</i> You could follow <a href=\"https://docs.microsoft.com/en-us/microsoft-edge/extensions/guides/native-messaging#non-persistent\" rel=\"nofollow noreferrer\">the example</a> which shows the non-persistent connection. Besides, for callbacks, <i>Edge uses the AppServiceRequest object&#39;s SendResponseAsync method to let the app send a ValueSet object back to the extension</i> instead of runtime.sendNativeMessage."}, {"owner": {"reputation": 1, "user_id": 11945632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90716f4b8fb489494a2d8ff638c8a827?s=128&d=identicon&r=PG&f=1", "display_name": "AliShahi", "link": "https://stackoverflow.com/users/11945632/alishahi"}, "edited": false, "score": 0, "creation_date": 1566387089, "post_id": 57576523, "comment_id": 101638601, "body": "Thank you <a href=\"https://stackoverflow.com/users/11490347/yu-zhou\">Yu Zhou</a>. But you will notice that the example you recommend is the same as I refer to in my question and it is not very useful to me. It refers to the Random Number Generator sample which I have checked out. It is not the same thing as an Edge extension although they both use comms between two UWP apps.  Finally, in Edge extensions, SendResponseAsync method is used regardless of whether you use runtime.sendNativeMessage API (i.e. non-persistent connection) or runtime.connectNative API (i.e. persistent connection)."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11945632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90716f4b8fb489494a2d8ff638c8a827?s=128&d=identicon&r=PG&f=1", "display_name": "AliShahi", "link": "https://stackoverflow.com/users/11945632/alishahi"}, "edited": false, "score": 0, "creation_date": 1566473637, "post_id": 57604469, "comment_id": 101672198, "body": "Thank you <a href=\"https://stackoverflow.com/users/5271974/fangfang-wu-msft\">Fangfang Wu</a>.But I am afraid I disagree.The sample you refer to is anything but clear. I have checked it out. It refers to two UWP applications where one is the AppServicesProvider and the other is a client. This is not the case in Edge exten. with nativeMessaging.wrt not having separate APIs, again I think you are mistaken.Persistent connections are started from background.js by a call that uses a port,i.e. port = browser.runtime.connectNative.Only after this can you send messages to the native app.e.g. DigitalSigning sample"}, {"owner": {"reputation": 1, "user_id": 11945632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90716f4b8fb489494a2d8ff638c8a827?s=128&d=identicon&r=PG&f=1", "display_name": "AliShahi", "link": "https://stackoverflow.com/users/11945632/alishahi"}, "edited": false, "score": 0, "creation_date": 1566473843, "post_id": 57604469, "comment_id": 101672304, "body": "I continue... <a href=\"https://stackoverflow.com/users/5271974/fangfang-wu-msft\">Fangfang Wu</a> :-). In fact I have used the runtime.sendNativeMessage API (for non-persistent connections) in my Edge extension. And it works but only for the first message. So there are definitely two different APIs possible in Edge just as is the case for Chrome and FF extensions. You can see this in Mozilla&#39;s Documentation that is also referred to from Microsoft documentation."}], "tags": [], "owner": {"reputation": 1024, "user_id": 5271974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43e19f8640df3e654424a7fe52f2d8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Fangfang Wu - MSFT", "link": "https://stackoverflow.com/users/5271974/fangfang-wu-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1566460172, "creation_date": 1566460172, "answer_id": 57604469, "question_id": 57576523, "link": "https://stackoverflow.com/questions/57576523/microsoft-edge-extension-with-native-messaging-and-non-persistent-connection-doe/57604469#57604469", "title": "Microsoft Edge Extension with native messaging and non-persistent connection does not work", "body": "<p>There are no separate API's in Edge for persistence and Non-persistence connection. The only difference is: for persistence connection we will keep the connection open after it is successfully established. We can close it till the task is done. Please refer to this <a href=\"https://github.com/microsoft/Windows-universal-samples/blob/fe8567faf2efdea3672c2ba642ba7b925ff6467e/Samples/AppServices/cs/AppServicesClient/KeepConnectionOpenScenario.xaml.cs#L41\" rel=\"nofollow noreferrer\">sample</a>. </p>\n\n<p>However, for non-persistence connections, we would release the connect as soon as the response is received and stored as an AppServiceResponse. <a href=\"https://docs.microsoft.com/en-us/microsoft-edge/extensions/guides/native-messaging#non-persistent\" rel=\"nofollow noreferrer\">This sample</a> is very clear where we can see the AppServiceConnection object lasts only for one connection.</p>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11945632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90716f4b8fb489494a2d8ff638c8a827?s=128&d=identicon&r=PG&f=1", "display_name": "AliShahi", "link": "https://stackoverflow.com/users/11945632/alishahi"}, "is_accepted": false, "score": 0, "last_activity_date": 1571419495, "creation_date": 1571419495, "answer_id": 58455566, "question_id": 57576523, "link": "https://stackoverflow.com/questions/57576523/microsoft-edge-extension-with-native-messaging-and-non-persistent-connection-doe/58455566#58455566", "title": "Microsoft Edge Extension with native messaging and non-persistent connection does not work", "body": "<p>I have now solved this issue and converted my Edge extension from a persistent to a non-persistent connection extension.\n<br><br> Assuming you start with an extension similar to the one <a href=\"https://github.com/MicrosoftEdge/MicrosoftEdge-Extensions-Demos\" rel=\"nofollow noreferrer\">here</a>, the central ideas in converting the extension to a non-persistent one are as follows:</p>\n\n<ol>\n<li>Remove all JavaScript code associated with connect/disconnect from the content.js and background.js</li>\n<li>Move the call that launches the win32 application from OnBackgroundActivated() into OnAppServiceRequestReceived()</li>\n<li>The last step ensures that we only call </li>\n</ol>\n\n<pre><code>Windows.ApplicationModel.FullTrustProcessLauncher.LaunchFullTrustProcessForCurrentAppAsync()\n</code></pre>\n\n<p>, when we actually receive a message from Edge.</p>\n\n<ol start=\"4\">\n<li>The win32 application is then called with the payload of the message from Edge. The win32 application communicates the result back to Edge via the AppServiceConnection in the following calls:</li>\n</ol>\n\n<pre><code>        // Send message to the win32 application component and wait for response\n        AppServiceResponse centennialResponse = await this.centennialConnection.SendMessageAsync(args.Request.Message);\n        await args.Request.SendResponseAsync(centennialResponse.Message);\n</code></pre>\n\n<ol start=\"5\">\n<li>The above steps result in a call that starts with browser.runtime.sendNativeMessage() in background.js which is picked up by OnAppServiceRequestReceived(). The latter launches the win32 application and passes the message to it via the AppServiceConnection made in centennialConnection. It awaits the result and sends the response back to background.js.</li>\n<li>The calls in the last step all happen without a session or a persistent connection ever being established between the background script and the background task.</li>\n</ol>\n\n<p>The reliability of our extension has improved a great deal as a result of the above changes. </p>\n"}], "owner": {"reputation": 1, "user_id": 11945632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90716f4b8fb489494a2d8ff638c8a827?s=128&d=identicon&r=PG&f=1", "display_name": "AliShahi", "link": "https://stackoverflow.com/users/11945632/alishahi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571419495, "creation_date": 1566313381, "last_edit_date": 1566378965, "question_id": 57576523, "link": "https://stackoverflow.com/questions/57576523/microsoft-edge-extension-with-native-messaging-and-non-persistent-connection-doe", "title": "Microsoft Edge Extension with native messaging and non-persistent connection does not work", "body": "<p>I have created a Microsoft Edge Extension with native messaging but I cannot make it work with non-persistent connections.</p>\n\n<p>The example given <a href=\"https://docs.microsoft.com/en-us/microsoft-edge/extensions/guides/native-messaging\" rel=\"nofollow noreferrer\">here</a> is not useful in my particular case: </p>\n\n<p>The example (Random Number Generator) shows how two UWP applications can communicate where the client communicates with the server when the server is already running. In Edge Extensions with Native Messaging (and mine is based on the Digital Signing and Secure Input examples), I have a W32 applications where the server is NOT running when the message arrives from the page via the extension.</p>\n\n<p>I have checked out all the samples I could find <a href=\"https://github.com/MicrosoftEdge/MicrosoftEdge-Extensions-Demos\" rel=\"nofollow noreferrer\">here</a> and none are using \"non-persistent\" connections which I need:</p>\n\n<p>I have also tried using <code>runtime.sendNativeMessage</code> in my Edge extension but this only works for the first message.</p>\n\n<p>I do not have an interactive html page whereby the user can start a connection with the <code>runtime.connectNative</code>. That's why it has to be a \"non-persistent\" connection using <code>runtime.sendNativeMessage</code> to <code>start/query/get-response</code> from the native application in a similar way to the one used by Chrome and Firefox.</p>\n"}, {"tags": ["c", "algorithm", "data-structures", "struct", "binary-search-tree"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 4, "creation_date": 1566312658, "post_id": 57576242, "comment_id": 101612787, "body": "None are used before they are set, so initialization is not needed."}, {"owner": {"reputation": 21, "user_id": 11169057, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-O9F92GCLx7U/AAAAAAAAAAI/AAAAAAAAAAc/A39iSNZlFKo/photo.jpg?sz=128", "display_name": "\u9f50\u5b50\u4f73", "link": "https://stackoverflow.com/users/11169057/%e9%bd%90%e5%ad%90%e4%bd%b3"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1566313054, "post_id": 57576242, "comment_id": 101613031, "body": "@stark I see. But how can HL and HR be calculated? I can&#39;t understand this recursive algorithm..."}, {"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 1, "creation_date": 1566313245, "post_id": 57576242, "comment_id": 101613137, "body": "@\u9f50\u5b50\u4f73 do you understand induction and recursive calculations in general? E.g. that there is a base case and a recursive case, and that it is the base case that sets <code>HL</code> + <code>HR</code> here. If not, try reading up on wikipedia, maybe here: <a href=\"https://en.wikipedia.org/wiki/Recursion_(computer_science)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Recursion_(computer_science)</a>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1566313780, "post_id": 57576242, "comment_id": 101613438, "body": "<code>HL</code>, <code>HR</code> and <code>MaxH</code> do not need initialization because they are assigned values before there values are used in later expressions. You know that each recursion has its own <code>HL</code>, <code>HR</code> and <code>MaxH</code> variables, right?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1566313938, "post_id": 57576242, "comment_id": 101613523, "body": "It finds the height by determining the height of the left and right sub-trees, determining which one of those is the largest, and adding 1 for its own node. An empty (sub-)tree has height 0."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1566313719, "post_id": 57576473, "comment_id": 101613409, "body": "This does not explain anything."}], "tags": [], "owner": {"reputation": 430, "user_id": 10237558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f39111c4e218b419ecdaf84b44481de4?s=128&d=identicon&r=PG&f=1", "display_name": "Navidk", "link": "https://stackoverflow.com/users/10237558/navidk"}, "is_accepted": false, "score": 0, "last_activity_date": 1566313216, "creation_date": 1566313216, "answer_id": 57576473, "question_id": 57576242, "link": "https://stackoverflow.com/questions/57576242/what-is-the-principle-of-calculating-the-height-of-binary-tree-by-recursive-meth/57576473#57576473", "title": "What is the principle of calculating the height of binary tree by recursive method?", "body": "<pre><code>#include&lt;stdio.h&gt; \n#include&lt;stdlib.h&gt; \n\n\nstruct node  \n{ \n    int data; \n    struct node* left; \n    struct node* right; \n}; \n\nint maxDepth(struct node* node)  \n{ \n   if (node==NULL)  \n       return 0; \n   else \n   { \n\n       int lDepth = maxDepth(node-&gt;left); \n       int rDepth = maxDepth(node-&gt;right); \n\n\n       if (lDepth &gt; rDepth)  \n           return(lDepth+1); \n       else return(rDepth+1); \n   } \n}  \n\n\nstruct node* newNode(int data)  \n{ \n    struct node* node = (struct node*) \n                                malloc(sizeof(struct node)); \n    node-&gt;data = data; \n    node-&gt;left = NULL; \n    node-&gt;right = NULL; \n\n    return(node); \n} \n\nint main() \n{ \n    struct node *root = newNode(1); \n\n    root-&gt;left = newNode(2); \n    root-&gt;right = newNode(3); \n    root-&gt;left-&gt;left = newNode(4); \n    root-&gt;left-&gt;right = newNode(5);  \n\n    printf(\"Height of tree is %d\", maxDepth(root)); \n\n    getchar(); \n\n} \n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1566313319, "creation_date": 1566313319, "answer_id": 57576499, "question_id": 57576242, "link": "https://stackoverflow.com/questions/57576242/what-is-the-principle-of-calculating-the-height-of-binary-tree-by-recursive-meth/57576499#57576499", "title": "What is the principle of calculating the height of binary tree by recursive method?", "body": "<p>If BinTree BT is not equal to <code>NULL</code> then <code>HL</code> and <code>HR</code> get their values due to these statements</p>\n\n<pre><code>   HL = PostOrderGetHeight(BT-&gt;Left); \n   HR = PostOrderGetHeight(BT-&gt;Right);  \n</code></pre>\n\n<p>Otherwise if for example <code>BT</code>, or <code>BT-&gt;Left</code>, or <code>BT-&gt;Right</code> are equal to <code>NULL</code> then a function call as for example</p>\n\n<pre><code>PostOrderGetHeight(BT-&gt;Left);\n</code></pre>\n\n<p>returns 0 because the function is defined like</p>\n\n<pre><code>int PostOrderGetHeight(BinTree BT) { \n   int HL,HR,MaxH; \n   if(BT){ \n      //...\n   }\n   else return 0;\n        ^^^^^^^^ \n}\n</code></pre>\n\n<p>In each iteration of recursive calls of the function there is selected the maximum length between the left sub-tree and the right sub-tree.</p>\n"}, {"tags": [], "owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "is_accepted": true, "score": 3, "last_activity_date": 1566313479, "creation_date": 1566313479, "answer_id": 57576554, "question_id": 57576242, "link": "https://stackoverflow.com/questions/57576242/what-is-the-principle-of-calculating-the-height-of-binary-tree-by-recursive-meth/57576554#57576554", "title": "What is the principle of calculating the height of binary tree by recursive method?", "body": "<p>What you're doing here is calculating the height of both sides of each tree. Every binary tree will have a right and left tree, which will have it's own height, until it reaches a terminal node with no height on either side.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Gx2ns.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Gx2ns.png\" alt=\"enter image description here\"></a></p>\n\n<p>Lets go through this example. </p>\n\n<ul>\n<li>We pass in A. </li>\n<li>It tries to calculate the height of B (a's left tree). \n\n<ul>\n<li>B tries to calculate the height of D (it's left tree). \n\n<ul>\n<li>D tries to calculate the height of it's left tree, and it returns zero. </li>\n<li>D tries to calculate the height of its right tree (e)</li>\n<li>e has no right or left trees (both return zero), so it return the max of (0) + 1\nas it's height </li>\n</ul></li>\n<li>The max of D's right and left trees is 1, so the height of D is 1+1 = 2.</li>\n<li>B has no right node so that returns zero.</li>\n<li>The max of B's right and left nodes is 2, so B returns 2 +1 =3.</li>\n<li>A calculates the height of C (it's right node, which will return 1)</li>\n<li>Max of a's right and left is 3+1 =4. </li>\n</ul></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1566314043, "last_edit_date": 1566314043, "creation_date": 1566313703, "answer_id": 57576624, "question_id": 57576242, "link": "https://stackoverflow.com/questions/57576242/what-is-the-principle-of-calculating-the-height-of-binary-tree-by-recursive-meth/57576624#57576624", "title": "What is the principle of calculating the height of binary tree by recursive method?", "body": "<p>We can provide <code>PostOrderGetHeight</code> works for any tree by:</p>\n\n<ul>\n<li>proving it works for a tree of height 0, and</li>\n<li>proving that if it works for a tree of height <em>h</em>\u22121 or less, with <em>h</em> > 0, then it works for a tree of height <em>h</em>.</li>\n</ul>\n\n<p>Thus, we will have proven it works for a tree of height 0, and therefore it works for a tree of height 1, and therefore for a tree of height 2, and 3, and so on.</p>\n\n<p>To prove the first part, suppose <code>PostOrderGetHeight</code> is called with a tree of height 0. This means its root node, <code>BT</code> is null. In this case, when the routine is called the <code>else return 0;</code> statement executes, and the routine returns zero, which is correct.</p>\n\n<p>To prove the second part, suppose <code>PostOrderGetHeight</code> is called with a tree of height <em>h</em>, with <em>h</em> > 0.</p>\n\n<p>Then these two statements are executed:</p>\n\n<pre><code>HL = PostOrderGetHeight(BT-&gt;Left); \nHR = PostOrderGetHeight(BT-&gt;Right);\n</code></pre>\n\n<p>Observe that each of these calls <code>PostOrderGetHeight</code> with subtree of <code>BT</code>. Each subtree, <code>BT-&gt;Left</code> and <code>BT-&gt;Right</code>, must be a tree of height less than <em>h</em>. Since we have assumed <code>PostOrderGetHeight</code> works for trees of height up to <em>h</em>@-1, it returns the correct heights for these trees.</p>\n\n<p>Then <code>MaxH = (HL&gt;HR)?HL:HR;</code> sets <code>MaxH</code> to whichever is greater, the height of the left subtree or the height of the right subtree. At this point, we know that <code>BT</code> has height one greater than that maximum, because it includes that larger subtree plus one more node (the root node <code>BT</code>).</p>\n\n<p>Then the statement <code>return (MAXH+1);</code> returns that height.</p>\n"}, {"tags": [], "owner": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "is_accepted": false, "score": 0, "last_activity_date": 1566313782, "creation_date": 1566313782, "answer_id": 57576641, "question_id": 57576242, "link": "https://stackoverflow.com/questions/57576242/what-is-the-principle-of-calculating-the-height-of-binary-tree-by-recursive-meth/57576641#57576641", "title": "What is the principle of calculating the height of binary tree by recursive method?", "body": "<p>Perhaps it is clearer to declare and initialise the variables in one step. See <a href=\"https://stackoverflow.com/questions/288441/variable-declaration-placement-in-c\">here</a> for more information.</p>\n\n<pre><code>int PostOrderGetHeight(BinTree BT) { \n   if(BT){ \n       const int HL = PostOrderGetHeight(BT-&gt;Left); \n       const int HR = PostOrderGetHeight(BT-&gt;Right); \n       const int MaxH = (HL&gt;HR)?HL:HR;\n       return (MaxH+1); \n   } else {\n       return 0;\n   }\n}\n</code></pre>\n\n<p>If one node has no further <code>left</code> or <code>right</code> nodes, this is the end of this branch and <code>0</code> is returned. </p>\n"}, {"tags": [], "owner": {"reputation": 8973, "user_id": 831564, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b7b5cb565edb37aac67f053f64f0324f?s=128&d=identicon&r=PG", "display_name": "Marlin Pierce", "link": "https://stackoverflow.com/users/831564/marlin-pierce"}, "is_accepted": false, "score": 0, "last_activity_date": 1566314162, "creation_date": 1566314162, "answer_id": 57576743, "question_id": 57576242, "link": "https://stackoverflow.com/questions/57576242/what-is-the-principle-of-calculating-the-height-of-binary-tree-by-recursive-meth/57576743#57576743", "title": "What is the principle of calculating the height of binary tree by recursive method?", "body": "<p>Let's step through a tree (A) where the root has a left (B) and right (C) node, and its left node has a left node (D).  All other branches are NULL.</p>\n\n<p>We pass A to <code>PostOrderGetHeight</code>, which calls <code>PostOrderGetHeight</code> on its two nodes (B) and (C).</p>\n\n<p>When <code>PostOrderGetHeight</code> is called on B, it calls <code>PostOrderGetHeight</code> on its left node D, and on NULL (which is its right node).</p>\n\n<p>That calls <code>PostOrderGetHeight</code> on D, which calls <code>PostOrderGetHeight</code> on its two NULL nodes.  Notice that calling <code>PostOrderGetHeight</code> on NULL return 0.</p>\n\n<p>In this call <code>PostOrderGetHeight(D)</code>, HL and HR are set to zero.  So this effectively initializes them.  Then <code>MaxH</code> is set to zero, effectively initializing it.  Then the call to <code>PostOrderGetHeight(D)</code> returns <code>MaxH+1</code> which is 1.</p>\n\n<p>Remember that <code>PostOrderGetHeight(D)</code> was called from <code>PostOrderGetHeight(B)</code> so it gets this answer 1 to set <code>HL</code> to 1.  The right branch of B is NULL, so <code>HR</code> gets set to 0, and <code>MaxH</code> gets set to 1, so <code>PostOrderGetHeight(B)</code> returns 2.</p>\n\n<p><code>PostOrderGetHeight(A)</code> called <code>PostOrderGetHeight(B)</code> and <code>PostOrderGetHeight(C)</code>.  Since C has two NULL branches, the call to <code>PostOrderGetHeight(C)</code> returns 1.  This sets <code>HL</code> to 2 returned from <code>PostOrderGetHeight(B)</code> and <code>HR</code> to 1 returned from <code>PostOrderGetHeight(C)</code>, making <code>MaxH</code> set to 2.  Thus <code>PostOrderGetHeight(A)</code> will return 3, which is the height of tree A.</p>\n"}, {"tags": [], "owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "is_accepted": false, "score": 0, "last_activity_date": 1566315565, "last_edit_date": 1566315565, "creation_date": 1566315104, "answer_id": 57577036, "question_id": 57576242, "link": "https://stackoverflow.com/questions/57576242/what-is-the-principle-of-calculating-the-height-of-binary-tree-by-recursive-meth/57577036#57577036", "title": "What is the principle of calculating the height of binary tree by recursive method?", "body": "<p>The general recursive algorithm relies on the fact that the height of a binary tree is the greater of height of its left and right sub-trees plus 1. \nThe height of the empty tree is 0. </p>\n\n<p>That's a very basic kind of recursion. The trivial case is 0 and more complex cases rely on working out the same thing for sub-parts of the problem and combining them except in the trivial case!</p>\n\n<p>It's a bit like saying the height of a brick wall is the height of the wall with one brick taken off plus one, with the height of no wall being 0.\nOK, that's a mad way to measure walls but it's not uncommon in computing!</p>\n\n<p><code>BinTree</code> will be a pointer. So the line <code>if(BT)</code> will be false if <code>BT</code> is <code>NULL</code> (the empty tree) and the function returns a height of zero (jumping straight to <code>else return 0</code>).</p>\n\n<p>NB: <code>return 0;</code> would do here. There's no need for an <code>else</code> because both sides of the if-statement return.</p>\n\n<p>So now you look at the detail of the if-true branch.</p>\n\n<pre><code>HL = PostOrderGetHeight(BT-&gt;Left); \nHR = PostOrderGetHeight(BT-&gt;Right); \nMaxH = (HL&gt;HR)?HL:HR;\nreturn (MaxH+1); \n</code></pre>\n\n<p><code>HL</code> (meaning height left) is the height of the left side of the tree from the node, <code>HR</code> is the height of the right side.</p>\n\n<p><code>MaxH = (HL&gt;HR)?HL:HR</code> uses the ternary operator (inline if expression) that says if <code>HL&gt;HR</code> the value of this expression is <code>HL</code> otherwise <code>HR</code>.\nThat gives us our maximum height of the left and right sub-trees.</p>\n\n<p>The return statement (<code>return (MaxH+1);</code>) adds the 1.</p>\n\n<p>As stated in a comment it would be preferable to omit:</p>\n\n<pre><code>int HL,HR, MaxH;\n</code></pre>\n\n<p>And write</p>\n\n<pre><code>int HL = PostOrderGetHeight(BT-&gt;Left); \nint HR = PostOrderGetHeight(BT-&gt;Right); \nint MaxH = (HL&gt;HR)?HL:HR;\n</code></pre>\n\n<p>Before C99 (the 1999 standard) you were required to declare all variables at the start of the function. That gave the compiler an easy ride determine how much stack was required.</p>\n\n<p>But it should not be preferred style unless shackled to a compiler that imposes the rule (not even all 20th century compilers did).</p>\n\n<p>It's less readable and reduce safety by risking the use of uninitialized data such as in blocks it's not used in.</p>\n\n<p>Slightly more obscurely it could also stop the compiler seeing opportunities to optimize the stack layout. </p>\n\n<p>But in short I wonder if this code was written for a old-school compiler or by an old-timer. I don't apologise to calling anyone an old-timer. I wrote C code on those compilers. It's not an insult.</p>\n\n<p>The definition of <code>BinTree</code> isn't provided but it must be similar to:</p>\n\n<pre><code>typedef struct BinTree_tag;\n\ntypedef struct {\n    struct BinTree_tag *Left;\n    struct BinTree_tag *Right;\n} *BinTree ;\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11169057, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-O9F92GCLx7U/AAAAAAAAAAI/AAAAAAAAAAc/A39iSNZlFKo/photo.jpg?sz=128", "display_name": "\u9f50\u5b50\u4f73", "link": "https://stackoverflow.com/users/11169057/%e9%bd%90%e5%ad%90%e4%bd%b3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "accepted_answer_id": 57576554, "answer_count": 7, "score": 0, "last_activity_date": 1566315565, "creation_date": 1566312413, "last_edit_date": 1566313778, "question_id": 57576242, "link": "https://stackoverflow.com/questions/57576242/what-is-the-principle-of-calculating-the-height-of-binary-tree-by-recursive-meth", "title": "What is the principle of calculating the height of binary tree by recursive method?", "body": "<p>This is the code that can find the height of the binary tree.</p>\n\n<pre><code>int PostOrderGetHeight(BinTree BT) { \n   int HL,HR,MaxH; \n   if(BT){ \n   HL = PostOrderGetHeight(BT-&gt;Left); \n   HR = PostOrderGetHeight(BT-&gt;Right); \n   MaxH = (HL&gt;HR)?HL:HR;\n   return (MaxH+1); \n   }\n   else return 0;\n}\n</code></pre>\n\n<p>My confusion is why HL, HR, MaxH don't need initialization and how does this recursive algorithm work to calculate the HL and HR.</p>\n"}, {"tags": ["c", "string", "symbols", "isalpha"], "comments": [{"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1566310486, "post_id": 57575599, "comment_id": 101611507, "body": "<a href=\"https://en.cppreference.com/w/c/string/byte/ispunct\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/string/byte/ispunct</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1566310498, "post_id": 57575599, "comment_id": 101611512, "body": "Your question is unclear, if you want to check for <code>:</code>, well check for <code>:</code>."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566310504, "post_id": 57575599, "comment_id": 101611517, "body": "<code>:</code> <b>is</b> ASCII. I don&#39;t really understand your question."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 5, "creation_date": 1566310535, "post_id": 57575599, "comment_id": 101611532, "body": "It&#39;s not clear to me what you&#39;re asking, or what your problem is. You can check that a <code>:</code> is a <code>:</code> by comparing it to <code>&#39;:&#39;</code>. Also, ASCII is a text encoding. You&#39;re already likely using it."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 6, "creation_date": 1566310573, "post_id": 57575599, "comment_id": 101611548, "body": "<code>ispunct</code> checks for lots of other things you aren&#39;t interested in. You should use <code>isxdigit(ch) || ch==&#39;:&#39;</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1566310719, "post_id": 57575599, "comment_id": 101611625, "body": "The <code>Y4</code> component is weird for a string of hex."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 3, "creation_date": 1566311122, "post_id": 57575599, "comment_id": 101611842, "body": "<code>if (sscanf(s, &quot;%x:%x:%x:%x:%x:%x&quot;, &amp;mac[0], &amp;mac[1], &amp;mac[2], &amp;mac[3], &amp;mac[4], &amp;mac[5]) != 6) { &#47;* error*&#47; }</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1566311607, "post_id": 57575599, "comment_id": 101612131, "body": "What character set are you running against?  <code>(c &gt;= &#39;a&#39; &amp;&amp; c &lt;= &#39;z&#39;)</code> is not guaranteed to work."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1566311827, "post_id": 57575599, "comment_id": 101612255, "body": "@Matt <code>char c = &#39;\\0&#39;; if (sscanf(s, &quot;%x:%x:%x:%x:%x:%x%c&quot;, &amp;mac[0], &amp;mac[1], &amp;mac[2], &amp;mac[3], &amp;mac[4], &amp;mac[5], &amp;c) != 6 || c != &#39;\\0&#39;) { &#47;* error*&#47; }</code> if you want scanf to test if the string is strictly a MAC address (or you can use &quot;strlen&quot;)."}, {"owner": {"reputation": 33, "user_id": 11863548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36c74fdfee6301da3b0843314658df2d?s=128&d=identicon&r=PG&f=1", "display_name": "jadamian", "link": "https://stackoverflow.com/users/11863548/jadamian"}, "edited": false, "score": 0, "creation_date": 1566311959, "post_id": 57575599, "comment_id": 101612349, "body": "Of course there should be only letters from A to F and digits. I&#39;ve wanted to focuse only on that  &#39; : &#39;  first."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 1, "creation_date": 1566312049, "post_id": 57575599, "comment_id": 101612410, "body": "@Tom&#39;s will that last <code>%c</code> be read if it&#39;s the terminator character <code>&#39;\\0&#39;</code>?"}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1566312368, "post_id": 57575599, "comment_id": 101612594, "body": "Okay, then it&#39;s better <code>int c; if (sscanf(s, &quot;%x:%x:%x:%x:%x:%x%c&quot;, &amp;mac[0], &amp;mac[1], &amp;mac[2], &amp;mac[3], &amp;mac[4], &amp;mac[5], &amp;c) != 6) { &#47;* error*&#47; }</code> No need to set/check <code>c</code> value."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1566312494, "post_id": 57575599, "comment_id": 101612676, "body": "Also, <code>mac[0]..mac[5]</code> should be checked if they are in <code>0..255</code> range."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566313104, "post_id": 57575599, "comment_id": 101613058, "body": "<code>unsigned char mac[6]; int i; for (i = 0; i &lt; 17; i++) { if (i % 3 == 2 ? s[i] != &#39;:&#39; : !isxdigit(s[i])) break; } if (i == 17 &amp;&amp; s[i] == &#39;\\0&#39;) { &#47;* GOOD *&#47; sscanf(&quot;%hhx:%hhx:%hhx:%hhx:%hhx:%hhx&quot;, &amp;mac[0], &amp;mac[1], &amp;mac[2], &amp;mac[3], &amp;mac[4], &amp;mac[5]); } else { &#47;* BAD *&#47; }</code>"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566313412, "post_id": 57575599, "comment_id": 101613229, "body": "@MarcoBonelli No, it will no be read. Try to read an empty string and you will read nothing, not even &#39;\\0&#39;."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1566313490, "post_id": 57575599, "comment_id": 101613274, "body": "@Tom&#39;s ok, makes sense."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1566314368, "post_id": 57575599, "comment_id": 101613777, "body": "@Matt It&#39;s out of habit that I set/check c, because there is case where it&#39;s important. Anyway, your scanf is flawed (&quot;AAA:A:AAA:A:AAA:A&quot; is accepted). It&#39;s simpler to manually parse the string like Ian Abbott show it."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 2, "creation_date": 1566314613, "post_id": 57575599, "comment_id": 101613925, "body": "@Matt <a href=\"https://stackoverflow.com/questions/24302160/scanf-on-an-istream-object/24318630#24318630\">The <code>scanf</code> functions are broken-as-specified and should never be used for anything</a>; please do not suggest their use, especially not to new C programmers."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "reply_to_user": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1566314687, "post_id": 57575599, "comment_id": 101613969, "body": "@Tom&#39;s As I said there must be an additional check for a range."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1566314799, "post_id": 57575599, "comment_id": 101614040, "body": "@zwol <code>%x</code> is safe. And so the other arguments by the link do not apply in this particular case."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1566314984, "post_id": 57575599, "comment_id": 101614181, "body": "@zwol the answer you linked is about C++ and does not make any sense in this context."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 1, "creation_date": 1566315099, "post_id": 57575599, "comment_id": 101614238, "body": "@Matt <code>char mac[6][3] = {{0}}; sscanf(s, &quot;%2[0-9A-F]:%2[0-9A-F]:%2[0-9A-F]:%2[0-9A-F]:%2[0-9A-F]:%2[0&zwnj;&#8203;-9A-F]%c&quot;, mac[0], mac[1], mac[2], mac[3], mac[4], mac[5], &amp;c);</code> then you strlen all &quot;mac&quot; to see if their length is strictly 2. It&#39;s a little better, although I franckly prefere the plain for loop given how you have to tweak scanf and still be obligated to do ulterior check."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1566315145, "post_id": 57575599, "comment_id": 101614263, "body": "@Matt <code>%x</code> is <i>not</i> safe.  It has undefined behavior on input overflow.  If I remember correctly, the only <code>scanf</code> input formats that <i>don&#39;t</i> have undefined behavior on invalid input are <code>%c</code> and <code>%NNNs</code> (where NNN is an explicit field width)."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566315191, "post_id": 57575599, "comment_id": 101614293, "body": "@MarcoBonelli That <i>question</i> was about C++, but everything I said about <code>scanf</code> in that answer applies equally to C and C++."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1566315669, "post_id": 57575599, "comment_id": 101614578, "body": "@zwol By language standard <code>%x</code> is defined to be an equivalent of <code>strtoul</code>, therefore it cannot overflow in a conforming libc implementation."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566316290, "post_id": 57575599, "comment_id": 101614908, "body": "<code>if( !(isalnum(x) || x == &#39;:&#39;) ) { ... }</code>"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 3, "creation_date": 1566316773, "post_id": 57575599, "comment_id": 101615154, "body": "@Matt The <i>syntax</i> accepted by <code>%x</code> is defined to be the syntax accepted by <code>strtoul</code> with base 16, but the C standard never actually says that the conversion is performed as-if by <code>strtoul</code>, and <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.2p10\" rel=\"nofollow noreferrer\">7.21.6.2p10</a> says &quot;if the result of the conversion cannot be represented in the [destination] object the behavior is undefined.&quot;  The only viable interpretation of that sentence that I can see is, for any input where <code>strto*</code> would report overflow, the corresponding <code>scanf</code> specifiers have undefined behavior."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 1, "creation_date": 1566351040, "post_id": 57575599, "comment_id": 101625533, "body": "@Matt <code>&quot;%x&quot;</code> can overflow and is thus potential UB.  <code>&quot;%2x&quot;</code> will not overflow, yet will accept inputs like questionable <code>&quot; 12&quot;</code>, <code>&quot;-2&quot;</code>, <code>&quot;0&quot;</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1566351528, "post_id": 57575599, "comment_id": 101625606, "body": "Code could pedantically scan with <code>sscanf(s, &quot;%1x%1x:%1x%1x:%1x%1x:%1x%1x:%1x%1x:%1x%1x%n&quot;, ...</code> and not risk UB.   Then check the length for the correct offset via the <code>&quot;%n&quot;</code>."}, {"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1566365728, "post_id": 57575599, "comment_id": 101628083, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/198214/discussion-on-question-by-jadamian-is-there-an-exception-for-ispunct-in-c\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11863548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36c74fdfee6301da3b0843314658df2d?s=128&d=identicon&r=PG&f=1", "display_name": "jadamian", "link": "https://stackoverflow.com/users/11863548/jadamian"}, "edited": false, "score": 0, "creation_date": 1566377418, "post_id": 57582483, "comment_id": 101633095, "body": "error in <code>char mac_addr[max_len +1] { 0 };</code> ----- variable-sized object may not be initialized, that i dont understand"}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "reply_to_user": {"reputation": 33, "user_id": 11863548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36c74fdfee6301da3b0843314658df2d?s=128&d=identicon&r=PG&f=1", "display_name": "jadamian", "link": "https://stackoverflow.com/users/11863548/jadamian"}, "edited": false, "score": 1, "creation_date": 1566403900, "post_id": 57582483, "comment_id": 101648443, "body": "@jadamian i was really just trying to highlight the <code>is_valid</code> function; i assumed you already had your own user input code. but in any case i&#39;ve updated the answer with a more complete example."}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "reply_to_user": {"reputation": 33, "user_id": 11863548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36c74fdfee6301da3b0843314658df2d?s=128&d=identicon&r=PG&f=1", "display_name": "jadamian", "link": "https://stackoverflow.com/users/11863548/jadamian"}, "edited": false, "score": 1, "creation_date": 1566404348, "post_id": 57582483, "comment_id": 101648637, "body": "@jadamian i want to stress, though, that the top portion is really the best way to parse a MAC address. it&#39;s bizarre to actively reject MAC addresses that use lowercase letters, or a hyphen instead of a colon, etc."}], "tags": [], "owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "is_accepted": true, "score": 2, "last_activity_date": 1566405919, "last_edit_date": 1566405919, "creation_date": 1566341886, "answer_id": 57582483, "question_id": 57575599, "link": "https://stackoverflow.com/questions/57575599/is-there-an-exception-for-ispunct-in-c/57582483#57582483", "title": "Is there an exception for ispunct() in C?", "body": "<p><strong>The best way to parse a MAC address or check its validity is to use <a href=\"http://man7.org/linux/man-pages/man3/ether_aton.3.html\" rel=\"nofollow noreferrer\"><code>ether_aton</code></a>.</strong> MAC addresses can come in many formats, and <code>ether_aton</code> can be relied on to parse them.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;netinet/ether.h&gt;\n\nint main(int argc, const char *argv[])\n{\n    char mac_addr[64];\n\n    while (true)\n    {\n        fgets(mac_addr, sizeof(mac_addr), stdin);\n        if (mac_addr[sizeof(mac_addr) - 1] != '\\0')\n        {\n            // input was too long for the buffer\n            printf(\"invalid!\\n\");\n        }\n        else if (ether_aton(mac_addr) == NULL)\n        {\n            // input isn't recognizable as a MAC address\n            printf(\"invalid!\\n\");\n        }\n        else\n        {\n            break;\n        }\n    }\n\n    printf(\"valid!\\n\");\n    printf(\"%s\\n\", mac_addr);\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>It sounds like you're checking one character at a time, that you want to reject an invalid character immediately without waiting for the full string of input, and that you specifically want to reject MAC addresses that have lowercase letters or that use separators other than a colon. Is that accurate? I will assume you have your own reasons for doing so.</p>\n\n<p>The <code>ispunct</code> function is a red herring here. There is no reason to check whether a given character is a punctuation character; what you really want to know is whether it's a colon. specifically. you can compare them directly.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;termios.h&gt;\n\nbool is_valid(char ch, int i)\n{\n    if ((i + 1) % 3 == 0)\n    {\n        return ch == ':';\n    }\n    else if (ch &gt;= '0' &amp;&amp; ch &lt;= '9')\n    {\n        return true;\n    }\n    else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F')\n    {\n        return true;\n    }\n\n    return false;\n}\n\nint main(int argc, const char *argv[])\n{\n    struct termios old_tio, new_tio;\n    const int max_len = strlen(\"00:00:00:00:00:00\");\n    char mac_addr[max_len + 1];\n    char ch = '\\0';\n    int i = 0;\n    int ret = 0;\n\n    /* need to modify the terminal's underlying settings, because\n     * by default STDIN is buffered to support backspace, etc.\n     * by switching to non-buffered input, you lose a lot of basic\n     * functionality like backspace.\n     * that's why it's usually recommended to just read in the entire\n     * line of text and then check if it's valid at the end.\n     */\n    tcgetattr(STDIN_FILENO, &amp;old_tio);\n    new_tio = old_tio;\n    new_tio.c_lflag &amp;=(~ICANON);\n    tcsetattr(STDIN_FILENO, TCSANOW, &amp;new_tio);\n\n    for (i = 0; i &lt; max_len; i++)\n    {\n        ch = getchar();\n        if (!is_valid(ch, i))\n        {\n            printf(\"\\ninvalid!\\n\");\n            ret = 1;\n            goto exit;\n        }\n        mac_addr[i] = ch;\n    }\n    mac_addr[max_len] = '\\0';\n\n    printf(\"\\nvalid!\\n\");\n    printf(\"%s\\n\", mac_addr);\n\nexit:\n    /* this is important; need to reset the terminal\n     * settings to their previous value before terminating.\n     */\n    tcsetattr(STDIN_FILENO,TCSANOW,&amp;old_tio);\n    return ret;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11863548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36c74fdfee6301da3b0843314658df2d?s=128&d=identicon&r=PG&f=1", "display_name": "jadamian", "link": "https://stackoverflow.com/users/11863548/jadamian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 57582483, "answer_count": 1, "score": -1, "last_activity_date": 1566473051, "creation_date": 1566310310, "last_edit_date": 1566473051, "question_id": 57575599, "link": "https://stackoverflow.com/questions/57575599/is-there-an-exception-for-ispunct-in-c", "title": "Is there an exception for ispunct() in C?", "body": "<p>I want to write a code that will check the correctness of MAC address.\nInput should look for example like this <code>D7:6E:F4:30:17:2B</code>.\nIm thinking about using functions <code>isdigit()</code> and <code>isupper()</code>. Dont know how to make user avalaible to write \" : \" symbol and stop him from writting other symbols. </p>\n\n<pre><code>if(user input is 13:4F:60:AC:7O:DE)\n    ... all good\nif(user input is 14:a]:!o:0L)\n    ... wrong input, retry\n</code></pre>\n\n<p><strong>EDIT</strong>\nAccording to @<a href=\"https://stackoverflow.com/users/3961271/woodrow-barlow\">Woodrow Barlow</a> answer i've wrote that code:</p>\n\n<pre><code>int mac_address() \n    {   \n        int is_valid = 1;\n        printf(\"MAC ADDRESS:\");\n        fgets(mac_addr, sizeof(mac_addr), stdin); \n            if (mac_addr[sizeof(mac_addr) - 1] != '\\0')\n            {\n                is_valid = 0;\n            }\n            else if (ether_aton(mac_addr) == NULL)\n            {\n                is_valid = 0;\n                // input isn't recognizable as a MAC address\n            }\n            if (is_valid == 1)\n            {\n                system(\"clear\");\n                printf(\"valid!\\n\");\n                printf(\"%s\\n\", mac_addr);\n                return license_menu();\n            }\n            else {\n                printf(\"invalid!\\n\");\n                fflush(stdin);\n                return 1;\n            }\n    }\n</code></pre>\n"}, {"tags": ["c", "macros", "misra"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 3, "creation_date": 1566310609, "post_id": 57575579, "comment_id": 101611563, "body": "This isn&#39;t a complete example. You don&#39;t show the definition of <code>CCP_BYTE</code>."}, {"owner": {"reputation": 1567, "user_id": 555911, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/531a798e41fe010eac238329693a916d?s=128&d=identicon&r=PG", "display_name": "kapilddit", "link": "https://stackoverflow.com/users/555911/kapilddit"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1566366581, "post_id": 57575579, "comment_id": 101628349, "body": "Yes, It&#39;s C_BYTE, not CCP_BYTE. Changed"}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 2, "creation_date": 1566379697, "post_id": 57575579, "comment_id": 101634443, "body": "It still is not a complete example. Provide a full function. Also, with what tool did you check your code?"}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1566386199, "post_id": 57575579, "comment_id": 101638119, "body": "There is no question."}, {"owner": {"reputation": 1567, "user_id": 555911, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/531a798e41fe010eac238329693a916d?s=128&d=identicon&r=PG", "display_name": "kapilddit", "link": "https://stackoverflow.com/users/555911/kapilddit"}, "edited": false, "score": 0, "creation_date": 1566386566, "post_id": 57575579, "comment_id": 101638346, "body": "How to avoid this warning?"}, {"owner": {"reputation": 545, "user_id": 9266860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5206d6fd79c294c934bf07fd5e2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Gunther Schulz", "link": "https://stackoverflow.com/users/9266860/gunther-schulz"}, "edited": false, "score": 1, "creation_date": 1566387033, "post_id": 57575579, "comment_id": 101638565, "body": "see <a href=\"https://stackoverflow.com/questions/50736432/misra-2012-violation-type-mismatch-rules-10-1-10-4\" title=\"misra 2012 violation type mismatch rules 10 1 10 4\">stackoverflow.com/questions/50736432/&hellip;</a> for a complete answer to your situation"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1566394361, "post_id": 57575579, "comment_id": 101643115, "body": "<code>#define REQUEST  0x01U</code> etc. Do <b>not</b> cast any literals to <code>uint8_t</code> and the like."}], "answers": [{"tags": [], "owner": {"reputation": 1567, "user_id": 555911, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/531a798e41fe010eac238329693a916d?s=128&d=identicon&r=PG", "display_name": "kapilddit", "link": "https://stackoverflow.com/users/555911/kapilddit"}, "is_accepted": true, "score": 0, "last_activity_date": 1566396224, "creation_date": 1566396224, "answer_id": 57593500, "question_id": 57575579, "link": "https://stackoverflow.com/questions/57575579/unpermitted-operand-to-operator-misra-2012-rule-10-1-required/57593500#57593500", "title": "Unpermitted operand to operator &#39;|&#39; [MISRA 2012 Rule 10.1, required]", "body": "<p>Modify as below to avoid this warning. </p>\n\n<pre><code>#define REQUEST    0x01u\n#define PENDING    0x10u\n#define D_PENDING  0x20u\n</code></pre>\n"}], "owner": {"reputation": 1567, "user_id": 555911, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/531a798e41fe010eac238329693a916d?s=128&d=identicon&r=PG", "display_name": "kapilddit", "link": "https://stackoverflow.com/users/555911/kapilddit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 57593500, "answer_count": 1, "score": -1, "last_activity_date": 1566809458, "creation_date": 1566310242, "last_edit_date": 1566809458, "question_id": 57575579, "link": "https://stackoverflow.com/questions/57575579/unpermitted-operand-to-operator-misra-2012-rule-10-1-required", "title": "Unpermitted operand to operator &#39;|&#39; [MISRA 2012 Rule 10.1, required]", "body": "<p>Observed below Misra warning for 10.1 rule. It says \"Unpermitted operand to operator \u200d\u200d\u200d<code>|</code>.</p>\n\n<p>How to avoid this warning ?</p>\n\n<p>This is misleading as <code>|</code> is not being used in the statement. </p>\n\n<pre><code>#define C_BYTE unsigned char\nC_BYTE SendStatus;\n#define SEND_PENDING   0x10\n\nSendStatus &amp;= (C_BYTE) ~ ((C_BYTE) SEND_PENDING);\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I am using Misra 2012 to check QA-C warnings. compiling the code using a batch file. </p>\n\n<pre><code>#define BYTE unsigned char\n#define REQUEST  0x01\n#define PENDING  0x10\n#define D_PENDING  0x20\n#define SEND_PENDING (PENDING|D_PENDING|REQUEST)\n\nstruct cp {    \n  BYTE SessionStatus;\n  BYTE SendStatus;\n};\n</code></pre>\n\n<p>Case 1:</p>\n\n<pre><code>BYTE fun2( void )\n{\n    cp.SendStatus &amp;= (BYTE) ~ ((BYTE) SEND_PENDING); //Warning observed for this line\n\n    if((cp.SendStatus &amp; (BYTE) REQUEST) != 0u)\n    {\n        cp.SendStatus &amp;= (BYTE) ~ (BYTE) REQUEST;\n        return 1;\n    }\n}\n</code></pre>\n\n<p>Case 2: </p>\n\n<pre><code>void fun1(void)\n{\n    BYTE ChkStatus = (cp.SendStatus &amp; (BYTE) SEND_PENDING); //Warning observed for this line\n\n    if ((bool)ChkStatus)\n    {\n        cp.SendStatus |= ((BYTE) REQUEST);\n    }\n    else\n    {\n        cp.SendStatus |= ((BYTE) PENDING);\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "string", "function", "pointers", "null"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 2, "creation_date": 1566309909, "post_id": 57575351, "comment_id": 101611156, "body": "The both programs have undefined behavior because the functions return pointers to a local array."}, {"owner": {"reputation": 211, "user_id": 10648668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f6648674c0447629a1e56592c199fbc?s=128&d=identicon&r=PG&f=1", "display_name": "S.D.", "link": "https://stackoverflow.com/users/10648668/s-d"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1566310043, "post_id": 57575351, "comment_id": 101611239, "body": "@VladfromMoscow Interesting, I didn&#39;t know that limitation! So, would defining a <i>global</i> character array be the way to go, or is there a better alternative which you would suggest?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1566310384, "post_id": 57575351, "comment_id": 101611455, "body": "@Blue You should pass the arrays as parameters to the function and allocate them on the caller side. This is very basic stuff best answered by a good beginner-level book."}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 10648668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f6648674c0447629a1e56592c199fbc?s=128&d=identicon&r=PG&f=1", "display_name": "S.D.", "link": "https://stackoverflow.com/users/10648668/s-d"}, "edited": false, "score": 0, "creation_date": 1566310256, "post_id": 57575561, "comment_id": 101611368, "body": "Thanks, gotcha! So what would be the correct way to go about this program? Declaring a <i>global</i> <code>char s[100]</code>?"}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 211, "user_id": 10648668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f6648674c0447629a1e56592c199fbc?s=128&d=identicon&r=PG&f=1", "display_name": "S.D.", "link": "https://stackoverflow.com/users/10648668/s-d"}, "edited": false, "score": 0, "creation_date": 1566310367, "post_id": 57575561, "comment_id": 101611444, "body": "@Blue It&#39;s somewhat complicated to state here in a short answer what would be the &quot;correct way to go about this&quot; as it can consider tons of factors related to code quality, execution, etc."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 211, "user_id": 10648668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f6648674c0447629a1e56592c199fbc?s=128&d=identicon&r=PG&f=1", "display_name": "S.D.", "link": "https://stackoverflow.com/users/10648668/s-d"}, "edited": false, "score": 0, "creation_date": 1566310416, "post_id": 57575561, "comment_id": 101611470, "body": "Although yes, declaring <code>s</code> as a global variable would fix this specific problem  you are facing."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566312950, "post_id": 57575561, "comment_id": 101612974, "body": "You should avoid teaching people the rules of automatic storage using a stack frame. While automatic objects are ubiquitously implemented with a stack, the C standard does not construct its rules with such a concept, and teaching the wrong model can lead to incorrect deductions. (For example, if automatic storage <b>is</b> a stack, then objects on the stack <b>persist</b> after a function returns as long as space down to those objects is not yet reused for other purposes. But that deduction is false because the implementation is not purely a stack\u2014it is a stack plus optimization during compilation\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566312968, "post_id": 57575561, "comment_id": 101612989, "body": "\u2026 and that optimization may mean objects are not really on the stack in the portrayed way)."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566313068, "post_id": 57575561, "comment_id": 101613040, "body": "The code style is not a good way to mark phrases like \u201cstack frame\u201d as special terminology. Code style is to mark source code or other computer input/output/command text. To mark phrases as special, it suffices to use italics."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566313474, "post_id": 57575561, "comment_id": 101613267, "body": "@EricPostpischil agreed about my usage of code style markers. As for your argument about avoiding teaching people the rules of automatic storage I didn&#39;t understand what is the point you were trying to do."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 0, "creation_date": 1566313530, "post_id": 57575561, "comment_id": 101613293, "body": "I just explained how stack works in intel-based architectures as a background to answer <b>why</b> OP was facing his issues with his code."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 0, "creation_date": 1566313639, "post_id": 57575561, "comment_id": 101613367, "body": "Even if you consider cases where optimizations will store locals in registers or any other place, I can&#39;t see where my argument fails. It would be nice if you could elaborate a bit more about this."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566313796, "post_id": 57575561, "comment_id": 101613445, "body": "@dedecos: The OP did not say they were working on Intel-based architectures. They asked about a C program, and you answered using things that are not part of the C standard. The proper way to teach is to use the C standard\u2019s rules about automatic storage duration, not to use stacks."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566314312, "post_id": 57575561, "comment_id": 101613749, "body": "@EricPostpischil as I made it crystal clear what I said was related to intel-based architectures I can&#39;t see the downside of explaining how that works in a intel-based architecture which is the architecture used in the vast majority of the systems. I will try to be more architecture-agnostic in my future answers though - I accept what you say as a valid point."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566314481, "post_id": 57575561, "comment_id": 101613850, "body": "If we were assured functions used a stack for their automatic objects, then we could rely on the code <code>char *bar(void) { char x[] = &quot;abc&quot;; return x; } void foo(void) { char string[4]; char *p = bar(); for (int i = 0; i &lt; 4; ++i) string[i] = p[i]; puts(string); }</code> to print \u201cabc\u201d, because \u201cabc\u201d is put on the stack by <code>bar</code> and is not overwritten prior to its copying by <code>foo</code>. But, by the rules of the C standard, the behavior of this code is not defined by the C standard. Therefore, saying automatic objects are implemented by a stack is not a correct representation of the rules of C."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566314855, "post_id": 57575561, "comment_id": 101614082, "body": "In fact, when I compile and execute the above code (with an include of <code>&lt;stdio.h&gt;</code> and a <code>main</code> that calls <code>foo</code>) using Apple LLVM 10.0.1 with clang-10001.0.46.4 on macOS 10.14.6, it does not print \u201cabc\u201d. Looking at the generated code shows that the data for <code>x</code> is in fact not put on the stack. And this is an Intel architecture. So the assertion that objects \u201clocal\u201d to functions are written to the stack is not generally true."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566314877, "post_id": 57575561, "comment_id": 101614094, "body": "@EricPostpischil okay, so your problem with my answer is that I have stated that the variable <code>s</code> will (thus implying it always will) be allocated on the stack? In the first comments I thought you were arguing about I teaching inner details of the stack."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566316342, "post_id": 57575561, "comment_id": 101614943, "body": "@EricPostpischil I just updated the answer, please review it if you can. Thanks in advance."}], "tags": [], "owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "is_accepted": true, "score": 4, "last_activity_date": 1566316678, "last_edit_date": 1566316678, "creation_date": 1566310178, "answer_id": 57575561, "question_id": 57575351, "link": "https://stackoverflow.com/questions/57575351/null-is-printed-after-converting-an-integer-12345-to-a-string-54321-and-then/57575561#57575561", "title": "(null) is printed after converting an integer 12345 to a string &quot;54321&quot; and then returning it to main function for printing", "body": "<p>Inside function <code>itos</code> you declared the variable <code>s</code> which is an array of 100 <code>char</code>s. This array is allocated somewhere after the start of the function and deallocated just before the function returns to its caller.</p>\n\n<p>So when you put a <code>printf</code> inside <code>itos</code>, the variable <code>s</code> will still be a valid storage and this is why it worked as you intended. However as soon as <code>itos</code> returns, the memory reserved to the variable <code>s</code> should be considered deallocated thus can not be expected to still contain the data it had when <code>itos</code> was executing, creating undefined behavior if you rely on that.</p>\n\n<p>Probably once deallocated, the memory pointed by <code>s</code> had its values modified, causing your function to not being able to proper convert the string back to a number.</p>\n"}, {"comments": [{"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 0, "creation_date": 1566310672, "post_id": 57575577, "comment_id": 101611593, "body": "-1 for &quot;But to make up for it, the function runs faster because it doesn&#39;t have to dynamically allocate/delete the memory every time the function runs.&quot;. There will be no difference in allocation time of the stack using <code>s</code> as local or not."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 0, "creation_date": 1566311042, "post_id": 57575577, "comment_id": 101611795, "body": "@dedecos Using a global array once isn&#39;t faster than using <code>malloc</code>/<code>free</code> every time the function runs?"}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 0, "creation_date": 1566311170, "post_id": 57575577, "comment_id": 101611862, "body": "yeahs, it would be. However <code>s</code> is allocated in the <code>stack frame</code> as a local of <code>itos</code>. This is simply a matter of modifying the value that will already subtract the stack register to include the size of <code>s</code>."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 0, "creation_date": 1566311354, "post_id": 57575577, "comment_id": 101611983, "body": "@dedecos I&#39;m pointing out this speed difference as a comparison to using dynamic allocation as detailed in my answer, not compared to the wrong code that has undefined behavior. Sorry for being unclear, I&#39;ll change the wording a bit to make it less confusing."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 1, "creation_date": 1566311408, "post_id": 57575577, "comment_id": 101612011, "body": "I didn&#39;t noticed you were comparing dynamic allocating <code>s</code> to use it as a global variable - thought you were saying that allocating <code>s</code> locally would have any impact on the startup of the function. Sorry for the misunderstanding!"}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 1, "last_activity_date": 1566311373, "last_edit_date": 1566311373, "creation_date": 1566310239, "answer_id": 57575577, "question_id": 57575351, "link": "https://stackoverflow.com/questions/57575351/null-is-printed-after-converting-an-integer-12345-to-a-string-54321-and-then/57575577#57575577", "title": "(null) is printed after converting an integer 12345 to a string &quot;54321&quot; and then returning it to main function for printing", "body": "<p><code>char s[100]</code> is only valid within <code>itos</code>. When the function returns, the memory becomes invalid, and accessing it through the pointer you returned is undefined behavior. You could instead allocate the memory dynamically, like this:</p>\n\n<pre><code>char* s = malloc(100);\n</code></pre>\n\n<p>When you do it this way, you need to free it when you're done with it (such as after the <code>printf</code> in <code>main</code>), like this:</p>\n\n<pre><code>free(s);\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>So, would defining a global character array be the way to go?</p>\n</blockquote>\n\n<p>This would also work. Generally, it has its advantages and disadvantages over dynamically allocating the memory. For instance, it would occupy the memory at all times even if your function isn't using it. But to make up for it, the function runs faster because it doesn't have to dynamically allocate/delete the memory every time the function runs. But on the other hand it increases the startup time because it will zero-initialize the array. And of course you couldn't run it multiple times in parallel with one global array. But for this small program, none of those matter much.</p>\n"}], "owner": {"reputation": 211, "user_id": 10648668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f6648674c0447629a1e56592c199fbc?s=128&d=identicon&r=PG&f=1", "display_name": "S.D.", "link": "https://stackoverflow.com/users/10648668/s-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "closed_date": 1566310246, "accepted_answer_id": 57575561, "answer_count": 2, "score": 1, "last_activity_date": 1566316678, "creation_date": 1566309513, "last_edit_date": 1566309875, "question_id": 57575351, "link": "https://stackoverflow.com/questions/57575351/null-is-printed-after-converting-an-integer-12345-to-a-string-54321-and-then", "closed_reason": "Duplicate", "title": "(null) is printed after converting an integer 12345 to a string &quot;54321&quot; and then returning it to main function for printing", "body": "<p>I initially wrote a perfectly working C code for converting a positive integer (say 12345) to a string (i.e. \"12345\") and print it. The logic is simple: extracting the digits of the integer one-by-one by taking modulo 10 and reducing the integer by a factor of 10 each time (this occurs in the <code>itos()</code> function). The final string needs to hold the extracted digits in reverse order so as to match the original integer (cf. <code>reverse()</code> function). </p>\n\n\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar *reverse (char *s);\nchar *itos (int n);\n\nint\nmain ()\n{\n  int n = 12345;\n  char *s = itos (n);\n  printf (\"%s\", s);\n  return 1;\n}\n\nchar *\nitos (int n)\n{\n  int d = 0;\n  char s[100];\n  int i = 0;\n  do\n    {\n      d = n % 10;\n      s[i] = (d + '0');\n      n = n / 10;\n      i++;\n    } while (n != 0);\n  s[i] = '\\0';\n  return reverse(s);\n}\n\nchar *\nreverse (char *s)\n{\n  int i = 0;\n  int j = strlen (s) - 1;\n  char temp;\n  while (i &lt; j)\n    {\n      temp = s[i];\n      s[i] = s[j];\n      s[j] = temp;\n      i++;\n      j--;\n    }\n  return s;\n}\n</code></pre>\n\n\n\n<p>You may compile it <a href=\"https://onlinegdb.com/Sy6Zh_FEr\" rel=\"nofollow noreferrer\">here</a>. This works perfectly fine, but something strange happens if I return <code>s</code> instead of <code>reverse(s)</code> from the <code>char* itos()</code> function. That is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar *itos (int n);\n\nint\nmain ()\n{\n  int n = 12345;\n  char *s = itos (n);\n  printf (\"%s\", s);\n  return 1;\n}\n\nchar *\nitos (int n)\n{\n  int d = 0;\n  char s[100];\n  int i = 0;\n  do\n    {\n      d = n % 10;\n      s[i] = (d + '0');\n      n = n / 10;\n      i++;\n    } while (n != 0);\n  s[i] = '\\0';\n  return s;\n}\n</code></pre>\n\n<p>I'd have expected it to simply print the string \"54321\" instead of \"12345\". However, in the output screen, I simply get a <code>(null)</code>. There might be a logical error in the <code>char* itos()</code> function, as in I might have done some illegal pointer operation, but I can't really locate the source of error. </p>\n\n<p>I did try debugging by inserting print statements in several parts of the code. What I noticed is if I print the string <code>s</code> within the <code>itos()</code> function just before the <code>return</code> statement then it works fine and prints the string \"54321\". However, the print statement in the <code>main()</code> function still outputs a <code>(null)</code>, which probably implies that there is some mismanagement of memory when the <code>itos()</code> function returns a character pointer to the <code>main()</code> function.  Could someone please clarify?</p>\n"}, {"tags": ["c", "linux", "timer"], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 0, "last_activity_date": 1566306718, "creation_date": 1566306718, "answer_id": 57574507, "question_id": 57574373, "link": "https://stackoverflow.com/questions/57574373/why-using-timer-settime-affects-on-sleep-function/57574507#57574507", "title": "Why using timer_settime() affects on sleep() function", "body": "<p>That's normal (=working as standardized). <code>sleep</code> is an interruptible blocking function. </p>\n\n<p><a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sleep.html\" rel=\"nofollow noreferrer\">Here's what POSIX says about it:</a></p>\n\n<blockquote>\n  <p>If sleep() returns because the requested time has elapsed, the value\n  returned shall be 0. If sleep() returns due to delivery of a signal,\n  the return value shall be the \"unslept\" amount (the requested time\n  minus the time actually slept) in seconds.</p>\n</blockquote>\n\n<p>If you want sleep uninterrupted, you need to block signals (or you need to sleep again with the remaining time after the first call is interrupted, but then you'll likely want a higher-resolution sleeping function such as <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/nanosleep.html\" rel=\"nofollow noreferrer\">nanosleep</a> or <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/clock_nanosleep.html\" rel=\"nofollow noreferrer\">clock_nanosleep</a>).</p>\n"}], "owner": {"reputation": 13, "user_id": 8891956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f5c4810f89c15f1eaa6fc09fc80f0e?s=128&d=identicon&r=PG", "display_name": "user8891956", "link": "https://stackoverflow.com/users/8891956/user8891956"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 57574507, "answer_count": 1, "score": 1, "last_activity_date": 1566319373, "creation_date": 1566306299, "last_edit_date": 1566319373, "question_id": 57574373, "link": "https://stackoverflow.com/questions/57574373/why-using-timer-settime-affects-on-sleep-function", "title": "Why using timer_settime() affects on sleep() function", "body": "<p>I'm trying to create periodic timer with callback function, it works well. But in main() I've sleep() function and it doesn't work as usually. Instead of sleeping for 10 seconds, it just sleeps for 500 ms, which time is set for timer_settime() function. Is it a bug, or normal behaviour?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>volatile sig_atomic_t timer_flag = false;\nvolatile int total_cnt = 0;\ntimer_t gTimerid;\n\nvoid start_timer(void)\n{\n    struct itimerspec value;\n    value.it_value.tv_sec = 0;\n    value.it_value.tv_nsec = 500000000;\n    value.it_interval.tv_sec = 0;\n    value.it_interval.tv_nsec = 500000000;\n    timer_create(CLOCK_REALTIME, NULL, &amp;gTimerid);\n    timer_settime(gTimerid, 0, &amp;value, NULL);\n}\n\nvoid stop_timer(void)\n{\n    struct itimerspec value;\n    value.it_value.tv_sec = 0;\n    value.it_value.tv_nsec = 0;\n    value.it_interval.tv_sec = 0;\n    value.it_interval.tv_nsec = 0;\n    timer_settime(gTimerid, 0, &amp;value, NULL);\n}\n\nvoid timer_callback(int sig) \n{\n    timer_flag = true;  \n}\n\nstatic void *count(void *ptr)\n{   \n    for(;;) {\n        if(timer_flag == true) {                    \n            timer_flag = false;\n            printf(\"%d\\n\", total_cnt++);\n        }\n        usleep(1000);\n    }\n\n    return NULL;\n}\n\nint main(void)\n{   \n    (void) signal(SIGALRM, timer_callback);\n    start_timer();\n\n    pthread_t thread_cnt;\n    int thread_num = 1;\n\n    pthread_create(&amp;thread_cnt, NULL, count, (void*)&amp;thread_num);\n\n    clock_t begin, end;\n    double time_spent;\n    struct timeval  tv1, tv2;\n\n    for(;;) {\n        printf(\"Main loop\\n\");\n        gettimeofday(&amp;tv1, NULL);           \n        sleep(10);\n        gettimeofday(&amp;tv2, NULL);\n        printf (\"Total time = %f seconds\\n\",\n         (double) (tv2.tv_usec - tv1.tv_usec) / 1000000 +\n         (double) (tv2.tv_sec - tv1.tv_sec));\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "protocol-buffers", "nanopb"], "comments": [{"owner": {"reputation": 7877, "user_id": 914716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ed96380268ce904eb69d0895915cfa?s=128&d=identicon&r=PG", "display_name": "jpa", "link": "https://stackoverflow.com/users/914716/jpa"}, "edited": false, "score": 1, "creation_date": 1566306104, "post_id": 57574103, "comment_id": 101608828, "body": "It looks like you are using <code>arg</code> in <code>encode_repeatedMsg</code>, but are not setting it in <code>main</code>. Also, did you know that you can set maximum count for the array, and you get a regular array where you can store the data?"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1566312890, "post_id": 57574103, "comment_id": 101612936, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/45979984/creating-callbacks-and-structs-for-repeated-field-in-a-protobuf-message-in-nanop\">creating callbacks and structs for repeated field in a protobuf message in nanopb in c</a>"}], "answers": [{"tags": [], "owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "is_accepted": false, "score": 0, "last_activity_date": 1581265142, "creation_date": 1581265142, "answer_id": 60138687, "question_id": 57574103, "link": "https://stackoverflow.com/questions/57574103/how-to-add-submsg-to-msg-repeated-using-nanopb/60138687#60138687", "title": "How to add subMsg to msg repeated using Nanopb?", "body": "<p>I myself have never used the callbacks in nanopb. I do have been using the .options file to statically allocate the desired array size. Your case this might be a bit much as your require 60 messages but this is how you do it:</p>\n\n<p>You create a file with the same name as your .proto file but give it the extension .options. You place it in the same folder as your .proto file. In that file you mention there repeated variable name and assign it a size:</p>\n\n<pre><code># XXXX.options\nFeatureFile.features max_count:16\n</code></pre>\n\n<p>More information on the nanopb options can be found <a href=\"https://jpa.kapsi.fi/nanopb/docs/reference.html#proto-file-options\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 119, "user_id": 9764257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570f861aaa0062bd99c5e42a33115600?s=128&d=identicon&r=PG&f=1", "display_name": "John Dign", "link": "https://stackoverflow.com/users/9764257/john-dign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1581265142, "creation_date": 1566305396, "question_id": 57574103, "link": "https://stackoverflow.com/questions/57574103/how-to-add-submsg-to-msg-repeated-using-nanopb", "title": "How to add subMsg to msg repeated using Nanopb?", "body": "<p>I'm simply trying to add one message to another message (up to 60 times times)</p>\n\n<p>My .proto file looks as follows;</p>\n\n<pre><code>syntax = \"proto3\";\n\nmessage FeatureFile {    \n    string fileName= 2;\n    string Id= 3;\n    repeated Feature features = 1;\n}\n\nmessage Feature {\n    int32 version = 1;\n    int32 epochTime = 2;\n    int32 noOfObs= 3;\n    int32 frequency = 4;\n}\n</code></pre>\n\n<p>I have tried to make a callback function to add repeated data, but cannot make it work. </p>\n\n<pre><code>bool encode_string(pb_ostream_t* stream, const pb_field_t* field, void* const* arg)\n{\n    const char* str = (const char*)(*arg);\n\n    if (!pb_encode_tag_for_field(stream, field))\n        return false;\n\n    return pb_encode_string(stream, (uint8_t*)str, strlen(str));\n}\n\nbool encode_repeatedMsg(pb_ostream_t* stream, const pb_field_t* field, void* const* arg)\n{\n    const char* obj = (const char*)(*arg);\n    int i;\n\n    for (i = 0; i &lt; 60; i++)\n    {\n        if (!pb_encode_tag_for_field(stream, field))\n            return false;\n\n        if (!pb_encode_submessage(stream, Feature_fields, *arg))\n            return false;\n    }\n    return true;\n}\n\nint main()\n{\n    FeatureFile featurefile = FeatureFile_init_zero;\n\n    Feature feature = Feature_init_zero;\n\n    featurefile.fileName.arg = \"092536.csv\";\n    featurefile.fileName.funcs.encode = &amp;encode_string;\n    featurefile.Id.arg = \"\";\n    featurefile.Id.funcs.encode = &amp;encode_string;\n    feature.version = 1;\n    feature.epochTime = 12566232;\n    feature.noOfObs = 260;\n    feature.frequency = 200;\n\n    featurefile.features.funcs.encode = &amp;encode_repeatedMsg;\n</code></pre>\n\n<p>I thought I could call the repeated encoding like the last line of code shows, but I doesn't allow me.</p>\n\n<p>The callback itself is supposed to add 60 of the same messages (feature) to the the featurefile.</p>\n\n<p>Can anyone help me here?</p>\n"}, {"tags": ["c", "unit-testing", "gcc", "compiler-errors", "unity-test-framework"], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 7539696, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9VDwpu3VBGI/AAAAAAAAAAI/AAAAAAAADr0/kg-KwCIVyf4/photo.jpg?sz=128", "display_name": "Sam Hall", "link": "https://stackoverflow.com/users/7539696/sam-hall"}, "is_accepted": false, "score": 3, "last_activity_date": 1566305585, "creation_date": 1566305585, "answer_id": 57574160, "question_id": 57573905, "link": "https://stackoverflow.com/questions/57573905/unity-framework-unit-testing-undefined-reference-to-setup-and-teardown/57574160#57574160", "title": "Unity Framework Unit Testing undefined reference to &quot;setUp&quot; and &quot;tearDown&quot;", "body": "<p>Need to define setUp and tearDown in the file, i thought it was in unity.c</p>\n\n<pre><code>void setUp (void) {} /* Is run before every test, put unit init calls here. */\nvoid tearDown (void) {} /* Is run after every test, put unit clean-up calls here. */\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "is_accepted": false, "score": 1, "last_activity_date": 1566305677, "creation_date": 1566305677, "answer_id": 57574189, "question_id": 57573905, "link": "https://stackoverflow.com/questions/57573905/unity-framework-unit-testing-undefined-reference-to-setup-and-teardown/57574189#57574189", "title": "Unity Framework Unit Testing undefined reference to &quot;setUp&quot; and &quot;tearDown&quot;", "body": "<p>The Unit Test Framework uses these functions like a constructor/destructor.  Since you are doing a simple test you can just define two empty functions with these names.</p>\n"}], "owner": {"reputation": 125, "user_id": 7539696, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9VDwpu3VBGI/AAAAAAAAAAI/AAAAAAAADr0/kg-KwCIVyf4/photo.jpg?sz=128", "display_name": "Sam Hall", "link": "https://stackoverflow.com/users/7539696/sam-hall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1411, "favorite_count": 3, "answer_count": 2, "score": 3, "last_activity_date": 1593458873, "creation_date": 1566304780, "last_edit_date": 1593458873, "question_id": 57573905, "link": "https://stackoverflow.com/questions/57573905/unity-framework-unit-testing-undefined-reference-to-setup-and-teardown", "title": "Unity Framework Unit Testing undefined reference to &quot;setUp&quot; and &quot;tearDown&quot;", "body": "<p>I copied the simplest code from the <a href=\"http://www.throwtheswitch.org/unity\" rel=\"nofollow noreferrer\">Unity for C Unit Testing library</a> and set up a very basic test, which I copied and pasted from the site:</p>\n<pre><code>#include &quot;unity/src/unity.h&quot;\n\nint main(void)\n{\n    UNITY_BEGIN();\n    int a = 1;\n    TEST_ASSERT( a == 1 ); //this one will pass\n    TEST_ASSERT( a == 2 ); //this one will fail\n    return UNITY_END();\n}\n</code></pre>\n<p>What I typed into terminal:</p>\n<pre><code>gcc TestDumbExample.c ./unity/src/unity.c -o Test\n</code></pre>\n<p>I am getting this error message in Terminal:</p>\n<pre><code>/tmp/ccqgFGn8.o: In function `UnityDefaultTestRun':\nunity.c:(.text+0x26af): undefined reference to `setUp'\nunity.c:(.text+0x26ca): undefined reference to `tearDown' collect2:\nerror: ld returned 1 exit status\n\nUnsure why this error is occurring and it has undefined references.\n</code></pre>\n"}, {"tags": ["c", "arrays", "struct", "bit-fields"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1566303463, "post_id": 57573460, "comment_id": 101607160, "body": "How are you building the code? What are the compiler flags?"}, {"owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1566303501, "post_id": 57573460, "comment_id": 101607185, "body": "This is an embedded project. I&#39;m using <code>COSMIC</code> compiler"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1566303984, "post_id": 57573460, "comment_id": 101607486, "body": "Please <a href=\"https://stackoverflow.com/posts/57573460/edit\">edit</a> your question to add information instead of answering in comments. Does the compiler support structure initialization with <code>.member = value</code>?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1566304145, "post_id": 57573460, "comment_id": 101607589, "body": "Compiles for me. Please produce a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 2, "creation_date": 1566305097, "post_id": 57573460, "comment_id": 101608154, "body": "The <i>Initializer List</i> has been introduced since C99. Do you have a switch to compile with C99? Is the Cosmic compiler compliant with C99?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566305259, "post_id": 57573460, "comment_id": 101608262, "body": "<code>got many errors like</code> please post the exact error message from the compiler, at best including filename and line number and column number and at best including compiler invocation line. Please don&#39;t post &quot;like&quot; errors."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566307108, "post_id": 57573460, "comment_id": 101609388, "body": "A better version would be <code>const static uint32_t ch[] = { C, B, A|C };</code>. This is extremely portable and deterministic."}], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": true, "score": 3, "last_activity_date": 1566305578, "creation_date": 1566305578, "answer_id": 57574157, "question_id": 57573460, "link": "https://stackoverflow.com/questions/57573460/initialize-a-constant-array-of-struct-with-bitfield/57574157#57574157", "title": "Initialize a constant array of struct with bitfield", "body": "<p>The syntax you have given is correct. The <strong>designated initializer list</strong> was introduced in C99. </p>\n\n<p>If your compiler does not support this, you need to go for the next best option. i.e. initialize all the members in the bitfield.</p>\n\n<pre><code>typedef struct {\n    unsigned int a : 1;\n    unsigned int b : 1;\n    unsigned int c : 1;\n} Character;\n\nconst static Character Char[] =\n{\n    {0, 0, 1},\n    {0, 1, 0},\n    {1, 0, 1}\n}; \n</code></pre>\n"}], "owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 57574157, "answer_count": 1, "score": 1, "last_activity_date": 1566305578, "creation_date": 1566303332, "last_edit_date": 1566304655, "question_id": 57573460, "link": "https://stackoverflow.com/questions/57573460/initialize-a-constant-array-of-struct-with-bitfield", "title": "Initialize a constant array of struct with bitfield", "body": "<p>I'd like to initialize a <code>const</code> array of structs. These structs have bitfield members.</p>\n\n<p>Following is a snippet of my code:</p>\n\n<pre><code>typedef struct {\n    unsigned int a : 1;\n    unsigned int b : 1;\n    unsigned int c : 1;\n} Character;\n\nconst static Character Char[] =\n{\n    {.a = 0, .b = 0, .c = 1},\n    {.a = 0, .b = 1, .c = 0},\n    {.a = 1, .b = 0, .c = 1}\n};\n</code></pre>\n\n<p>When trying this way, I got many errors like <code>unexpected initialization syntax</code> and <code>missing ;</code>.</p>\n\n<p>What is the right way to do this?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I'm using <code>COSMIC</code> compiler (<code>CXSTM8</code>). I checked its user guide but couldn't find any information in this regard.</p>\n"}, {"tags": ["c", "windows", "visual-studio", "console-application"], "comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1566303232, "post_id": 57573370, "comment_id": 101607054, "body": "Maybe disable quick edit mode in the settings of the <code>CMD</code> window?"}, {"owner": {"reputation": 1514, "user_id": 1291628, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7eca596c7dc7b82b63243bb8af928128?s=128&d=identicon&r=PG", "display_name": "ikkentim", "link": "https://stackoverflow.com/users/1291628/ikkentim"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1566303610, "post_id": 57573370, "comment_id": 101607254, "body": "Like @Bodo said, right mouse button on the window header &gt; properties &gt; Options &gt; Edit Options &gt; Uncheck &quot;Quick Edit Mode&quot;"}, {"owner": {"reputation": 2943, "user_id": 9014308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6e0464313ca63c239f5d973213daf9?s=128&d=identicon&r=PG&f=1", "display_name": "kunif", "link": "https://stackoverflow.com/users/9014308/kunif"}, "edited": false, "score": 2, "creation_date": 1566303634, "post_id": 57573370, "comment_id": 101607270, "body": "This article may be helpful. <a href=\"https://stackoverflow.com/q/13656846/9014308\">How to programmatic disable C# Console Application&#39;s Quick Edit mode?</a>"}], "owner": {"reputation": 7909, "user_id": 169774, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef760e2a9a24b58476207635c21730f9?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/169774/mick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566303059, "creation_date": 1566303059, "question_id": 57573370, "link": "https://stackoverflow.com/questions/57573370/disable-clipboard-operations-in-console-app", "title": "Disable clipboard operations in console app", "body": "<p>I have a console app which monitors assorted things 24/7 and will issue warnings if it detects any faults. The other day I noticed that it failed to warn me about something and I later worked out that I accidentally clicked on the app thereby highlighting a single text cell in the console and the app was then locked up waiting for me to perhaps \"copy\" the highlighted text. This is rather hard to spot and I am concerned that it could happen again. Is there a way to prevent such locking - perhaps disabling any clipboard operations altogether?</p>\n"}, {"tags": ["c", "matlab", "embedded", "real-time", "simulink"], "answers": [{"tags": [], "owner": {"reputation": 10236, "user_id": 1998377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJV1Z.jpg?s=128&g=1", "display_name": "Phil Goddard", "link": "https://stackoverflow.com/users/1998377/phil-goddard"}, "is_accepted": false, "score": 2, "last_activity_date": 1566325246, "creation_date": 1566325246, "answer_id": 57579505, "question_id": 57573310, "link": "https://stackoverflow.com/questions/57573310/what-is-purpose-of-the-rtmgetu-define-in-the-simulink-embeded-coder-generated/57579505#57579505", "title": "What is purpose of the &quot;rtmGetU&quot; define in the Simulink Embeded Coder generated C code", "body": "<p><code>rtmGetU</code> is a macro for conveniently getting the data that is being fed into any <code>Inport</code>s in the model that the code is generated from.</p>\n\n<p>It will only be in the generated code if your model has any Inports (at the highest level of the model.)</p>\n"}], "owner": {"reputation": 39, "user_id": 3399221, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/3761107cc69306682ae9240fc7dd93a1?s=128&d=identicon&r=PG&f=1", "display_name": "Burak DEN\u0130Z", "link": "https://stackoverflow.com/users/3399221/burak-den%c4%b0z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566325246, "creation_date": 1566302878, "question_id": 57573310, "link": "https://stackoverflow.com/questions/57573310/what-is-purpose-of-the-rtmgetu-define-in-the-simulink-embeded-coder-generated", "title": "What is purpose of the &quot;rtmGetU&quot; define in the Simulink Embeded Coder generated C code", "body": "<p>I have Simulink Embedded Coder output model code. One of header file includes;</p>\n\n<pre><code>#ifndef rtmGetU\n#define rtmGetU(rtm) ((rtm)-&gt;ModelData.inputs)\n#endif\n</code></pre>\n\n<p>After saw the code block in the header, I tried to generate my own Simulink model embedded code but the output not include the <code>rtmGetU</code> define.</p>\n\n<p>I wonder what is the purpose of the <code>rtmGetU</code> define and how can I generate the <code>rtmGetU</code> code for my own model.</p>\n"}, {"tags": ["c", "arm", "stm32", "cortex-m"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1566300763, "post_id": 57572653, "comment_id": 101605656, "body": "<code>to be proportional to the number of assignments</code> - your compiler is way smarter, it optimizes it. All the <code>i = </code> assigments were optimized out and this all is a no-op. How is <code>i</code> declared? What compiler and compiler options are you using? Did you inspect the generated assembly from your compiler to confirm that compiler really generated assembly instructions to do the assignments operations?"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1566300981, "post_id": 57572653, "comment_id": 101605781, "body": "Once you account for some overhead, that is roughly proportional. Looks like <code>14 + (2 * assignments)</code>."}, {"owner": {"reputation": 33, "user_id": 11951077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd6cf7675f5bf97af4d3bdfe69caf1ab?s=128&d=identicon&r=PG&f=1", "display_name": "larein", "link": "https://stackoverflow.com/users/11951077/larein"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566301699, "post_id": 57572653, "comment_id": 101606191, "body": "@Kamil [i] is local variable, compiler is arm-none-eabi-gcc, and optimize option is not using. and assembly is not checking. I don&#39;t know check assembly. Is there a good document to reference how to view an assembly?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566301755, "post_id": 57572653, "comment_id": 101606220, "body": "Not really, it&#39;s all compiler dependent. But a short search about gcc leads to <a href=\"https://stackoverflow.com/questions/1354899/how-can-i-see-the-assembly-code-that-is-generated-by-a-gcc-any-flavor-compiler\">this stackoverflow question</a>. <code>i</code> is a local variable makes is worse - it&#39;s easier to optimize, but I asked how is it &quot;declared&quot; - is it <code>volatile</code>? If not, try with <code>i</code> being <code>volatile</code>..."}, {"owner": {"reputation": 33, "user_id": 11951077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd6cf7675f5bf97af4d3bdfe69caf1ab?s=128&d=identicon&r=PG&f=1", "display_name": "larein", "link": "https://stackoverflow.com/users/11951077/larein"}, "edited": false, "score": 0, "creation_date": 1566302336, "post_id": 57572653, "comment_id": 101606577, "body": "@ Kamil I declare local variable &quot;int i=0&quot; to &quot;volatile int i=0;&quot;. but it same result. and change global variable. Result is more irregular. 8, 17, 22, 27, 35"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1566304941, "post_id": 57572653, "comment_id": 101608054, "body": "<code>8, 17, 22, 27, 35</code> - looks like a valid result. Looks like overhead for reading DWT is 8 cycles  and each assignment takes ~4 cycles and compiler optimizes it a lot. You don&#39;t know on which cycle the DWT will read, so it can return any value between 0-4. Ideal results probably look like <code>8, 16, 24, 28, 32</code> looks almost like it."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566304984, "post_id": 57572653, "comment_id": 101608079, "body": "@KamilCuk That&#39;s almost exactly what you&#39;d expect from this."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1566306709, "post_id": 57572653, "comment_id": 101609164, "body": "Use <code>arm-none-eabi-objdump -dS myprogram.elf &gt;myprogram.asm</code> to disassemble the ELF binary, and include the C source inline with the assembly. Very very much recommended when working at this level."}], "answers": [{"tags": [], "owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "is_accepted": true, "score": 5, "last_activity_date": 1566304177, "creation_date": 1566304177, "answer_id": 57573705, "question_id": 57572653, "link": "https://stackoverflow.com/questions/57572653/stm32-dwt-cycle-count-is-differrent-from-my-prediction/57573705#57573705", "title": "STM32 - DWT cycle count is differrent from my prediction", "body": "<p>It is difficult to predict the number of cycles needed to execute one line of C code on a ARM Cortex. it depends on the compiler, on the level of optimisation you set up, of the way you declared the variables, whether the cache is enabled, where the code is executing from (RAM or Flash), etc... </p>\n\n<p>You can see <a href=\"https://godbolt.org/z/BRnhr6\" rel=\"noreferrer\">here</a> the assembly it <strong><em>may</em></strong> give.</p>\n\n<p>Every assignement consists of one <code>mov</code> and one <code>str</code> so two assembly instructions. But even knowing the assembly instructions that are executed does not always allow to deduce a precise number of cycles because of pipelining, caching policy, etc...</p>\n\n<p>In the end, the only way to get significant figures, is to measure a portion of code, as you did. </p>\n\n<p>However the code you are measuring here may not make a lot of sense (assigning several values, without doing anything in between -except perhaps if <code>i</code> is a register).</p>\n"}], "owner": {"reputation": 33, "user_id": 11951077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd6cf7675f5bf97af4d3bdfe69caf1ab?s=128&d=identicon&r=PG&f=1", "display_name": "larein", "link": "https://stackoverflow.com/users/11951077/larein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 57573705, "answer_count": 1, "score": 3, "last_activity_date": 1566304177, "creation_date": 1566300644, "question_id": 57572653, "link": "https://stackoverflow.com/questions/57572653/stm32-dwt-cycle-count-is-differrent-from-my-prediction", "title": "STM32 - DWT cycle count is differrent from my prediction", "body": "<p>I checked core cycle count using DWT->CYCCNT. but different from my prediction. Could you tell me the cause?</p>\n\n<p>My device is STM32 NUCLEO-L476RG. \nI just check DWT->CYCCNT. and only changed the number of times an integer assign.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>  m_nStart = DWT-&gt;CYCCNT;  \n  m_nStop = DWT-&gt;CYCCNT;\n  printf(\"Cycle diff - assign 0 : %lu\\n\", m_nStop - m_nStart);\n\n  m_nStart = DWT-&gt;CYCCNT;  \n  i = 10;\n  m_nStop = DWT-&gt;CYCCNT;\n  printf(\"Cycle diff - assign 1 : %lu\\n\", m_nStop - m_nStart); \n\n  m_nStart = DWT-&gt;CYCCNT;  \n  i = 10;\n  i = 20;\n  m_nStop = DWT-&gt;CYCCNT;\n  printf(\"Cycle diff - assign 2 : %lu\\n\", m_nStop - m_nStart); \n\n  m_nStart = DWT-&gt;CYCCNT;  \n  i = 10;\n  i = 20;\n  i = 30;\n  m_nStop = DWT-&gt;CYCCNT;\n  printf(\"Cycle diff - assign 3 : %lu\\n\", m_nStop - m_nStart); \n\n  m_nStart = DWT-&gt;CYCCNT;  \n  i = 10;\n  i = 20;\n  i = 30;\n  i = 40;\n  m_nStop = DWT-&gt;CYCCNT;\n  printf(\"Cycle diff - assign 4 : %lu\\n\", m_nStop - m_nStart);\n</code></pre>\n\n<p>I expected to be proportional to the number of assignments.\nbut result is this.</p>\n\n<p>Cycle diff - assign 0 : 14</p>\n\n<p>Cycle diff - assign 1 : 16</p>\n\n<p>Cycle diff - assign 2 : 18</p>\n\n<p>Cycle diff - assign 3 : 20</p>\n\n<p>Cycle diff - assign 4 : 22</p>\n\n<p>Why result like that?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 783, "user_id": 10403061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/35yNU.jpg?s=128&g=1", "display_name": "liakoyras", "link": "https://stackoverflow.com/users/10403061/liakoyras"}, "edited": false, "score": 0, "creation_date": 1566300627, "post_id": 57572623, "comment_id": 101605581, "body": "Is this a warning or an error? Does the program compile?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1566300882, "post_id": 57572623, "comment_id": 101605729, "body": "Because <code>const</code> defines a &quot;read-only&quot; object, not a constant &quot;typed&quot; value. Try <code>enum &#47;*untagged*&#47; { a = 1, b };</code> and let the compiler make its type guesses and conversions."}, {"owner": {"reputation": 47, "user_id": 6103274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f638ad3440a154f210797c9f9117a60?s=128&d=identicon&r=PG&f=1", "display_name": "elguerrero", "link": "https://stackoverflow.com/users/6103274/elguerrero"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1566303736, "post_id": 57572623, "comment_id": 101607336, "body": "@pmg: yes with a enum this issue is not pops up again but then i get another compiler warning e.g.  static const unsigned int a = 0x80000000;  compiler says: a is out of range of type int. The compiler uses int for enum variables"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1566305944, "post_id": 57572623, "comment_id": 101608733, "body": "Your other option is using <code>#define A 0x80000000U</code>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1566308432, "post_id": 57572623, "comment_id": 101610238, "body": "A <code>const</code> variable (more or less) is one that won&#39;t be changed by the program after initialisation.   It doesn&#39;t turn a variable into a compile-time constant.   If you want a compile-time constant, use a literal value (like <code>1</code> or <code>2</code>).   If you want to give it a name, of sorts, use a macro that expands to a literal or an expression involving literals  e.g. <code>#define a 1</code> or <code>#define b (a + 1)</code>.    There are gotchas with preprocessor macros though, so do some homework to understand the pitfalls BEFORE using them.   You can also use enums, such as <code>enum {a = 1, b = 2};</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1566350676, "post_id": 57572623, "comment_id": 101625460, "body": "OT:  when defining structs, always include a &#39;tag&#39; name.  This is because most debuggers use the &#39;tag&#39; name to be able to display the individual fields within the struct."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1566301189, "last_edit_date": 1592644375, "creation_date": 1566301189, "answer_id": 57572823, "question_id": 57572623, "link": "https://stackoverflow.com/questions/57572623/error-expression-must-have-a-constant-value/57572823#57572823", "title": "error &quot;expression must have a constant value&quot;", "body": "<p>According to the C Standard (6.7.9 Initialization)</p>\n<blockquote>\n<p>4 All the expressions in an initializer for an object that has static\nor thread storage duration shall be constant expressions or string\nliterals.</p>\n</blockquote>\n<p>and (6.6 Constant expressions)</p>\n<blockquote>\n<p>2 A constant expression can be evaluated during translation rather\nthan runtime, and accordingly may be used in any place that a constant\nmay be.</p>\n</blockquote>\n<p>and</p>\n<blockquote>\n<p>7 More latitude is permitted for constant expressions in initializers.\nSuch a constant expression shall be, or evaluate to, one of the\nfollowing:</p>\n<p>\u2014 an arithmetic constant expression,</p>\n<p>\u2014 a null pointer constant,</p>\n<p>\u2014 an address constant, or</p>\n<p>\u2014 an address constant for a complete object type plus or minus an\ninteger constant expression</p>\n</blockquote>\n<p>and</p>\n<blockquote>\n<p>8 An arithmetic constant expression shall have arithmetic type and\nshall only have operands that are integer constants, floating\nconstants, enumeration constants, character constants, and sizeof\nexpressions. Cast operators in an arithmetic constant expression shall\nonly convert arithmetic types to arithmetic types, except as part of\nan operand to a sizeof operator whose result is an integer constant.</p>\n</blockquote>\n<p>You could use enumerators instead of these declarations</p>\n<pre><code>static const unsigned int a = 1;\nstatic const unsigned int b = 2;\n</code></pre>\n<p>For example</p>\n<pre><code>enum { A = 1, B = 2 };\n\nstatic const BoardType cfg = {\n    /* pbgc cfg */\n    .BoardTypestruct_elem1 =\n    {\n        .InitTypestruct_elem1 = A,\n        .InitTypestruct_elem2 = B\n    } };\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 2, "last_activity_date": 1566301320, "creation_date": 1566301320, "answer_id": 57572864, "question_id": 57572623, "link": "https://stackoverflow.com/questions/57572623/error-expression-must-have-a-constant-value/57572864#57572864", "title": "error &quot;expression must have a constant value&quot;", "body": "<p>You can't initialize a variable of <em>static storage duration</em> with anything but a <em>constant expression</em>, an integer constant expression in this case.</p>\n\n<p>Unfortunately, C makes a difference between integer constant expressions and \"<code>const</code> qualified\" variables. (C and C++ are different here.) This means that the initializer of your <code>cfg</code> variable must be an integer constant (for example <code>1</code>), an enum or a <code>#define</code> value, or an expression formed by such operands.</p>\n\n<p>That is, if you do any arithmetic inside the initializer, all operands must be integer constants.<br>\nSo <code>1 + 1</code> would be fine, but not <code>a + 1</code>, if <code>a</code> is a variable.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 6103274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f638ad3440a154f210797c9f9117a60?s=128&d=identicon&r=PG&f=1", "display_name": "elguerrero", "link": "https://stackoverflow.com/users/6103274/elguerrero"}, "edited": false, "score": 0, "creation_date": 1566306477, "post_id": 57573613, "comment_id": 101609031, "body": "when i am placing the variable declaration of a and b into the fct const InitType *cfg(void) then it is working! But then i have the issue that I am returning a stack address! this is not allowed. Is it possible to move the cfg variable into read only area by using compiler directives?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 47, "user_id": 6103274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f638ad3440a154f210797c9f9117a60?s=128&d=identicon&r=PG&f=1", "display_name": "elguerrero", "link": "https://stackoverflow.com/users/6103274/elguerrero"}, "edited": false, "score": 0, "creation_date": 1566309502, "post_id": 57573613, "comment_id": 101610928, "body": "The <code>cfg</code> function performs the initialization (assignment) in <i>run-time</i>. That is not a problem. You can have a global variable and peform the initialization (assignment) in the function, and that is no problem either because then it is done in run-time too. The point is that <i>compile-time</i> initialization must be a constant expression."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 2, "last_activity_date": 1566309522, "last_edit_date": 1566309522, "creation_date": 1566303859, "answer_id": 57573613, "question_id": 57572623, "link": "https://stackoverflow.com/questions/57572623/error-expression-must-have-a-constant-value/57573613#57573613", "title": "error &quot;expression must have a constant value&quot;", "body": "<p>Simplifying the other answers:</p>\n\n<pre><code>static const unsigned int a = 1;\n</code></pre>\n\n<p><code>a</code> is a variable, no matter that it is const. You cannot initialize a global variable with another (global) variable at compile-time. The compiler does not see it as constant.</p>\n"}], "owner": {"reputation": 47, "user_id": 6103274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f638ad3440a154f210797c9f9117a60?s=128&d=identicon&r=PG&f=1", "display_name": "elguerrero", "link": "https://stackoverflow.com/users/6103274/elguerrero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2655, "favorite_count": 1, "accepted_answer_id": 57572864, "answer_count": 3, "score": 0, "last_activity_date": 1566309522, "creation_date": 1566300525, "question_id": 57572623, "link": "https://stackoverflow.com/questions/57572623/error-expression-must-have-a-constant-value", "title": "error &quot;expression must have a constant value&quot;", "body": "<p>When I am using const variables \"a\" &amp; \"b\" to init a structed variable \"cfg\" I am facing the following compiler issue \"expression must have a constant value\"</p>\n\n<pre><code>static const unsigned int a = 1;\nstatic const unsigned int b = 2;\n\n\ntypedef struct\n{\n    const uint32 InitTypestruct_elem1;   \n    const uint32 InitTypestruct_elem2;   \n}InitType;\n\ntypedef struct\n{\n    InitType BoardTypestruct_elem1;\n}BoardType;\n\n\nstatic const BoardType cfg =\n{\n    /* pbgc cfg */\n    .BoardTypestruct_elem1 =\n    {\n        ***.InitTypestruct_elem1 = a,\n        ***.InitTypestruct_elem2 = b\n    }\n};\n\n\nconst InitType *cfg(void)\n{\n    return &amp;cfg.BoardTypestruct_elem1;\n}\n\n\nint main()\n{\n    //cfg\n\n    return 0;\n}\n</code></pre>\n\n<p>The compiler warning causes in the line with ***</p>\n\n<p>why this issue is happening? a and b are const values?</p>\n"}, {"tags": ["c", "compiler-errors", "macros"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1566299722, "post_id": 57572334, "comment_id": 101605087, "body": "The problem is likely at the point you <i>use</i> the macro. Please include an example for that."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1566299843, "post_id": 57572334, "comment_id": 101605151, "body": "The error is probably in the context. The macro definition itself is correct. Please show a minimal source code that actually reproduces the problem."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566299901, "post_id": 57572334, "comment_id": 101605184, "body": "Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us. And include the <i>full</i> and <i>complete</i> error output."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566300062, "post_id": 57572334, "comment_id": 101605259, "body": "Unrelated to the compiler error, you need a semicolon after each function call."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1566300560, "post_id": 57572334, "comment_id": 101605538, "body": "And there you have it... You can&#39;t have e.g. <code>if ({some statements})</code>, that&#39;s just not valid C. Some compilers have <i>non-portable extensions</i> that allows statements as expressions. For example <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html#Statement-Exprs\" rel=\"nofollow noreferrer\">GCC have it</a>. I really don&#39;t recommend you use such extensions though. Remember, macros are <b><i>not</i></b> functions. Perhaps what you really want is an actual (possibly <code>inline</code>) function?"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1566300798, "post_id": 57572334, "comment_id": 101605676, "body": "I removed the answer now that the code is clear. Not valid C code."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1566300959, "post_id": 57572334, "comment_id": 101605770, "body": "@Frankie_C Yep, better to wait with answering until the OP has clarified everything. After the edit, the problem became obvious."}, {"owner": {"reputation": 371, "user_id": 8596999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/595f98020f985780afcce080519abfd6?s=128&d=identicon&r=PG&f=1", "display_name": "ChauhanTs", "link": "https://stackoverflow.com/users/8596999/chauhants"}, "edited": false, "score": 0, "creation_date": 1566337376, "post_id": 57572334, "comment_id": 101623173, "body": "I think you have call macro as function call , putting semicolon at last. As you have define macro as block do not put semicolon after calling macro . Or use do while loop"}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 2, "last_activity_date": 1566300743, "creation_date": 1566300743, "answer_id": 57572691, "question_id": 57572334, "link": "https://stackoverflow.com/questions/57572334/c-style-macro-compilation/57572691#57572691", "title": "C-style macro compilation", "body": "<p>Macros are kind of a glorified text replacement. Your call</p>\n\n<pre><code>if(!oslock_TryAcquire(&amp;pLock))\n</code></pre>\n\n<p>expands to</p>\n\n<pre><code>if(!{INITIALIZED_ASSERT(&amp;pLock) acquire(&amp;pLock)})\n</code></pre>\n\n<p>which is nonsense syntax in several different ways. Use a function instead of a macro.</p>\n"}], "owner": {"reputation": 8739, "user_id": 466056, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/101889513654ccabf2cff98d3352e74c?s=128&d=identicon&r=PG", "display_name": "Yakov", "link": "https://stackoverflow.com/users/466056/yakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 57572691, "answer_count": 1, "score": -1, "last_activity_date": 1566300891, "creation_date": 1566299485, "last_edit_date": 1566300891, "question_id": 57572334, "link": "https://stackoverflow.com/questions/57572334/c-style-macro-compilation", "title": "C-style macro compilation", "body": "<p>I have the following macro:</p>\n\n<pre><code>#define oslock_TryAcquire(pLock) { \\\n        INITIALIZED_ASSERT(pLock) \\\n        acquire(pLock)}\n</code></pre>\n\n<p>While compiling I get :</p>\n\n<pre><code>error: expected expression before \u2018{\u2019 token\n #define oslock_TryAcquire(pLock ) { \\\n</code></pre>\n\n<p><strong>Upd:</strong>                                        ^\nI get the \"follow-up\" error :</p>\n\n<pre><code>note: in expansion of macro \u2018oslock_TryAcquire\u2019\n         if(!oslock_TryAcquire(&amp;pLock)){\n             ^~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>I can`t understand what is a problem? Will be glsd to get advices</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566299525, "post_id": 57572169, "comment_id": 101604992, "body": "Why is the answer for [1, 2, 2, 3, 3] 2 when there are four subsets that contain all of the distinct elements: [1, 2, 3], [1, 2, 2, 3], [1, 2, 3, 3], and [1, 2, 2, 3, 3]?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566299868, "post_id": 57572169, "comment_id": 101605164, "body": "In <code>check</code>, after <code>i = 0;</code>, program control flows to the end of the <code>for</code> statement, which increments <code>i</code>, so the next loop begins with <code>i</code> set to 1, meaning no more checks are performed with <code>*(new_array + 0)</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566299891, "post_id": 57572169, "comment_id": 101605177, "body": "Write references to elements as <code>sub_array[j]</code>, not <code>*(sub_array + j)</code>, for readability."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566299976, "post_id": 57572169, "comment_id": 101605218, "body": "What thing? The example? You found an example for your homework assignment on the net? Where?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566300133, "post_id": 57572169, "comment_id": 101605292, "body": "Okay, the items in the problem are not <b>subsets</b> of the array (a subset is any collection of elements from a set) but <b>subarrays</b> of the array (portions of the array, so all elements from some start position to some end position). You should edit the question to use the correct word."}, {"owner": {"reputation": 113, "user_id": 10912105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ariwmaXAKfY/AAAAAAAAAAI/AAAAAAAAGAU/Tnmw-ZGCKD0/photo.jpg?sz=128", "display_name": "Swarnim Khosla", "link": "https://stackoverflow.com/users/10912105/swarnim-khosla"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566300448, "post_id": 57572169, "comment_id": 101605469, "body": "@EricPostpischil Thank you for telling me. I have edited the same."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566300863, "post_id": 57572169, "comment_id": 101605714, "body": "The question does not state for what input the program outputs only \u201c0\u201d. What input reproduces the problem?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566300968, "post_id": 57572169, "comment_id": 101605776, "body": "The loop to copy elements using <code>for(j = i; j &lt; k; j++)</code> iterates from <code>i</code> to <code>k</code> including <code>i</code> but excluding <code>k</code>, but <code>k</code> is intended to be inside the subarray, as evidenced by the later count of elements <code>k-i+1</code> and by the bounds used to loop on k, <code>k = i;</code> and <code>while(k &lt; number)</code>."}, {"owner": {"reputation": 113, "user_id": 10912105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ariwmaXAKfY/AAAAAAAAAAI/AAAAAAAAGAU/Tnmw-ZGCKD0/photo.jpg?sz=128", "display_name": "Swarnim Khosla", "link": "https://stackoverflow.com/users/10912105/swarnim-khosla"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566300987, "post_id": 57572169, "comment_id": 101605784, "body": "@EricPostpischil for the second example mentioned above. For the first example it outputs <code>1</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566301140, "post_id": 57572169, "comment_id": 101605877, "body": "Fixing the two bugs above produces the correct output for the two test cases."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566301173, "post_id": 57572169, "comment_id": 101605890, "body": "The <code>new_array = (int*) calloc ((k-i+1),sizeof(int));</code> could be removed, <code>check</code> doesn&#39;t modify the array, just <code>check(array + j, ..., (k-i+1),</code>. The <code>k = i;         while(k &lt; number) { ... k++;}</code> would look way cleaner as <code>for (k = i; k &lt; number; k++)</code>."}, {"owner": {"reputation": 113, "user_id": 10912105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ariwmaXAKfY/AAAAAAAAAAI/AAAAAAAAGAU/Tnmw-ZGCKD0/photo.jpg?sz=128", "display_name": "Swarnim Khosla", "link": "https://stackoverflow.com/users/10912105/swarnim-khosla"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566302603, "post_id": 57572169, "comment_id": 101606714, "body": "@EricPostpischil Thank you so much! I finally got both the bugs."}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 10912105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ariwmaXAKfY/AAAAAAAAAAI/AAAAAAAAGAU/Tnmw-ZGCKD0/photo.jpg?sz=128", "display_name": "Swarnim Khosla", "link": "https://stackoverflow.com/users/10912105/swarnim-khosla"}, "is_accepted": true, "score": 1, "last_activity_date": 1566303855, "creation_date": 1566303855, "answer_id": 57573612, "question_id": 57572169, "link": "https://stackoverflow.com/questions/57572169/taking-out-number-of-subarrays-from-an-array-which-contains-all-the-distinct-ele/57573612#57573612", "title": "Taking out number of subarrays from an array which contains all the distinct elements of that array", "body": "<p>The 2 bugs in the code as pointed out in the comments below are :-</p>\n\n<blockquote>\n  <p>The loop to copy elements using <code>for(j = i; j &lt; k; j++)</code> iterates from <code>i</code> to <code>k</code> including <code>i</code> but excluding <code>k</code>, but <code>k</code> is intended to be inside the subarray, as evidenced by the later count of elements <code>k-i+1</code> and by the bounds used to loop on <code>k, k = i; and while(k &lt; number)</code>.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>In check, after <code>i = 0</code>;, program control flows to the end of the <code>for</code> statement, which increments <code>i</code>, so the next loop begins with <code>i</code> set to <code>1</code>, meaning no more checks are performed with <code>*(new_array + 0)</code></p>\n</blockquote>\n"}], "owner": {"reputation": 113, "user_id": 10912105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ariwmaXAKfY/AAAAAAAAAAI/AAAAAAAAGAU/Tnmw-ZGCKD0/photo.jpg?sz=128", "display_name": "Swarnim Khosla", "link": "https://stackoverflow.com/users/10912105/swarnim-khosla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 57573612, "answer_count": 1, "score": -2, "last_activity_date": 1566303855, "creation_date": 1566298890, "last_edit_date": 1566300367, "question_id": 57572169, "link": "https://stackoverflow.com/questions/57572169/taking-out-number-of-subarrays-from-an-array-which-contains-all-the-distinct-ele", "title": "Taking out number of subarrays from an array which contains all the distinct elements of that array", "body": "<p>My teacher gave me a homework problem in which a user would provide an array with its size.</p>\n\n<p>What we have to do is:-</p>\n\n<blockquote>\n  <p>1) Take out all the distinct elements from that array.</p>\n  \n  <p>2) Compare all the subarrays which are possible in the main array with\n  the \"distinct array\".</p>\n  \n  <p>3) Tell the number of times we were able to successfully \"discover\"\n  all those subarrays which contained ALL the distinct elements.</p>\n</blockquote>\n\n<p>Example:- We are given an array :- [1,2,2,3,3]\nThe distinct elements array would be :- [1,2,3]\nAll the subarray of the original array will be :- </p>\n\n<pre><code>1) [1,2]\n2) [1,2,2]\n3) [1,2,2,3]\n4) [1,2,2,3,3]   \n5) [2,2]\n6) [2,2,3]\n7) [2,2,3,3]\n8) [2,3]\n9) [2,3,3]\n10) [3,3]\n</code></pre>\n\n<p>The answer of this specific test case shall be 2. Since only (3) and (4) subarrays contain all the distinct elements i.e. 1,2 and 3.</p>\n\n<p>Second Example:-</p>\n\n<p>Given array :- [86,5,34,64,56,60,81,77,36,41]</p>\n\n<p>The answer of the second example is 1; since all the elements of the original array are distinct and hence only one solution shall contain all the possible distinct elements which is the original array itself.</p>\n\n<p>Here is my code which I have wrote for the above problem:-</p>\n\n<pre><code># include &lt;stdio.h&gt;\n# include &lt;stdlib.h&gt;\n# include &lt;stdbool.h&gt;\n\nbool check(int *, int *, int, int);\n\n\nint main()\n{\n    int number; // Variable name \"number\" which will specify the size of dynamically allocated array.\n\n    printf(\"Enter the size of your array\\n\");\n    scanf(\"%d\",&amp;number);\n\n    int *array;\n    array = (int*)calloc(number, sizeof(int)); // Dynamically allocated memory.\n\n\n    int *temp_array;\n    temp_array = (int*)calloc(number, sizeof(int)); // Temporary variable of original array.\n\n    int i,j=0; // Counter variables for loop.\n\n    printf(\"Enter the elements of arrays\\n\");\n\n    for(i = 0; i &lt; number; i++)\n    {\n        scanf(\"%d\",(array + i)); //Main original array being filled.\n    }\n\n    for(i = 0; i &lt; number; i++)\n    {\n        *(temp_array + i) = *(array + i); //Copying into temp.\n    }\n\n\n\n    for(i = 0; i &lt; number; i++)\n    {\n        for( j = i + 1 ; j &lt; number; j++)\n        {\n            if( *(temp_array + i ) == *(temp_array + j))\n            {\n                *(temp_array + j) = 0; // My way of removing those numbers which are the repeated. (Assigning them value of zero).\n            }\n        }\n    }\n\n    i=0;j=0;\n\n    int sub_number = 0;\n\n    while(i &lt; number)\n    {\n        if(*(temp_array + i) != 0)\n        {\n            sub_number++; // Variable name \"sub_number\" which will specify the size of dynamically allocated array \"sub_array\".\n        }\n        i++;\n    }\n\n    int *sub_array ;\n    sub_array = (int*)calloc(sub_number,sizeof(int));\n\n    j=0;\n    for(i = 0;i &lt; number ;i++)\n    {\n        if( *(temp_array + i ) != 0)\n        {\n            *(sub_array + j) = * (temp_array + i ); //Transferring all the distinct values from temp_array to sub_array.\n            j++;\n        }\n    }\n\n    free(temp_array); //Freed \"temp_array\". No longer needed.\n    temp_array = NULL;\n\n    for(i = 0;i &lt; sub_number; i++)\n    {\n        printf(\"%d \",*(sub_array + i)); // Desired array which only contains distinct and unique variables.\n    }\n\n    printf(\"\\n\");\n\n    //CODE IS CORRECT TILL THE ABOVE LINE AND HAS BEEN VERIFIED.\n\n    //Problem code starts from below.\n\n    int ans = 0;    //Variable which shall calculate the answer.\n    int k=0;        //New variable counter\n    j=0;\n\n\n    for(i=0; i &lt; number; i++) //This loop will traverse variable \"i\" on array \"array\".\n    {\n        k = i;\n        while(k &lt; number)   //This loop will traverse variable \"k\" on array \"array\"\n        {\n            int *new_array;\n            new_array = (int*) calloc ((k-i+1),sizeof(int));\n\n                for(j = i; j &lt; k; j++)  //This loop will assign the subset values of array \"array\" to array \"new_array\".\n                {\n                    *(new_array + (j - i)) = *(array + j);\n                }\n                if(check(new_array, sub_array, (k-i+1), sub_number) == true) //This will check if ALL the values in \"sub_array\" are present in \"new_array\" or not.\n                {\n                    ans++;\n                }\n\n            free(new_array);\n            new_array = NULL;\n            k++;\n        }\n    }\n\n    printf(\"%d\",ans);\n\n    return 0;\n}\n\nbool check(int * new_array, int *sub_array, int new_number, int sub_number) //Function to check if ALL the values in \"sub_array\" are present in \"new_array\" or not.\n{\n    int i = 0;\n    int j = 0;\n    for(i = 0; i &lt; new_number; i++)     //new_number is nothing but (k - i + 1)\n    {\n        if(*(new_array + i)  == *(sub_array + j))\n        {\n            j++;\n            if(j == sub_number)\n            {\n                return true;\n            }\n            i = 0;\n        }\n    }\n    return false;\n}\n</code></pre>\n\n<p>Now the problem portion of my code (which i believe) starts from:-</p>\n\n<pre><code>    //CODE IS CORRECT TILL THE ABOVE LINE AND HAS BEEN VERIFIED.\n\n    //Problem code starts from below.\n\n    int ans = 0;    //Variable which shall calculate the answer.\n    int k=0;        //New variable counter\n    j=0;\n\n\n    for(i=0; i &lt; number; i++) //This loop will traverse variable \"i\" on array \"array\".\n    {\n        k = i;\n        while(k &lt; number)   //This loop will traverse variable \"k\" on array \"array\"\n        {\n            int *new_array;\n            new_array = (int*) calloc ((k-i+1),sizeof(int));\n\n                for(j = i; j &lt; k; j++)  //This loop will assign the subset values of array \"array\" to array \"new_array\".\n                {\n                    *(new_array + (j - i)) = *(array + j);\n                }\n                if(check(new_array, sub_array, (k-i+1), sub_number) == true) //This will check if ALL the values in \"sub_array\" are present in \"new_array\" or not.\n                {\n                    ans++;\n                }\n\n            free(new_array);\n            new_array = NULL;\n            k++;\n        }\n    }\n\n    printf(\"%d\",ans);\n\n    return 0;\n}\n\nbool check(int * new_array, int *sub_array, int new_number, int sub_number) //Function to check if ALL the values in \"sub_array\" are present in \"new_array\" or not.\n{\n    int i = 0;\n    int j = 0;\n    for(i = 0; i &lt; new_number; i++)     //new_number is nothing but (k - i + 1)\n    {\n        if(*(new_array + i)  == *(sub_array + j))\n        {\n            j++;\n            if(j == sub_number)\n            {\n                return true;\n            }\n            i = 0;\n        }\n    }\n    return false;\n}\n</code></pre>\n\n<p>The thing is that my code only outputs <code>0</code> and nothing else. Hence is there any problem with my <code>boolean</code> function? or the <code>if statement</code> which i have used above?</p>\n"}, {"tags": ["c", "linux", "wifi"], "comments": [{"owner": {"reputation": 8374, "user_id": 3691891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dcCUM.jpg?s=128&g=1", "display_name": "Arkadiusz Drabczyk", "link": "https://stackoverflow.com/users/3691891/arkadiusz-drabczyk"}, "edited": false, "score": 2, "creation_date": 1566297238, "post_id": 57571545, "comment_id": 101603884, "body": "Take a look at <code>iwlist</code> source code and specifically on its <code>scan</code> option implementation."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1566301098, "post_id": 57571545, "comment_id": 101605847, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/400240/608639\">How can I get a list of available wireless networks on Linux?</a> Also see <a href=\"https://stackoverflow.com/q/8434918/608639\">Find available network interfaces in C/C++?</a>, <a href=\"https://stackoverflow.com/q/18146236/608639\">How to get a list of active network interfaces in C?</a> and <a href=\"https://stackoverflow.com/q/12566911/608639\">Determine if a network interface is wireless or wired</a>."}], "owner": {"reputation": 579, "user_id": 5490535, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/496260983880990/picture?type=large", "display_name": "Sebastian Karlsson", "link": "https://stackoverflow.com/users/5490535/sebastian-karlsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1566301748, "answer_count": 0, "score": 1, "last_activity_date": 1566298645, "creation_date": 1566296637, "last_edit_date": 1566298645, "question_id": 57571545, "link": "https://stackoverflow.com/questions/57571545/how-do-i-get-a-list-of-available-wifi-connections", "closed_reason": "Duplicate", "title": "How do I get a list of available wifi-connections?", "body": "<p>Is there any way to get a list of available wifi-connections?</p>\n\n<p>I want to write a simple program that lists the available wifi-connections and lets the user select a network to connect to.</p>\n"}, {"tags": ["c", "linux", "memory-leaks"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1566296823, "post_id": 57571539, "comment_id": 101603651, "body": "Once the process ends, the memory is freed. Practically, it\u2019s not a memory leak in that program. Processes can\u2019t access each other\u2019s memory without explicit cooperation anyway."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1566296967, "post_id": 57571539, "comment_id": 101603721, "body": "On modern protected operating systems (like Linux which you seem to be using, you should really specify that), the memory map of one process is unique to that process only."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566297453, "post_id": 57571539, "comment_id": 101603990, "body": "@Someprogrammerdude Yes I am on Ubuntu 19.04, linux."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566298529, "post_id": 57571539, "comment_id": 101604514, "body": "See also <a href=\"https://stackoverflow.com/q/2213627/2173773\">When you exit a C application, is the malloc-ed memory automatically freed?</a>"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1566301637, "post_id": 57571539, "comment_id": 101606150, "body": "Also see <a href=\"https://en.wikipedia.org/wiki/Process_isolation\" rel=\"nofollow noreferrer\">Process isolation</a>, <a href=\"https://stackoverflow.com/q/56175076/608639\">Process isolation on Linux?</a> and <a href=\"https://stackoverflow.com/q/39753607/608639\">Does Linux support memory isolation for processes?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566297117, "post_id": 57571616, "comment_id": 101603805, "body": "So the memory is lost forever? It is not possible to free it even if you know the address?"}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566297204, "post_id": 57571616, "comment_id": 101603857, "body": "Yes, when the process ends its memory space is freed by the operating system, effectively whatever data was stored in that process&#39; memory is &quot;lost forever&quot;."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566297397, "post_id": 57571616, "comment_id": 101603961, "body": "@dedcos Ok, but it is possible to reallocate it by malloc?"}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566297519, "post_id": 57571616, "comment_id": 101604016, "body": "@H&#229;konH&#230;gland you can&#39;t give to <code>malloc</code> a specific address for it to alloc, and even if you could you were trying to access a <code>RVA</code> of process A in process B."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566297558, "post_id": 57571616, "comment_id": 101604034, "body": "@H&#229;konH&#230;gland there is a fundamental difference between the piece of memory in the RAM actually allocated by the operating system and the pointer you get as return from <code>malloc</code>."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566297695, "post_id": 57571616, "comment_id": 101604098, "body": "@H&#229;konH&#230;gland what you get from <code>malloc</code> is a Relative Virtual Address - it is just an offset of the process memory space used by the operating system to layout the memory. The actual address of that chunk allocated by <code>malloc</code> is managed only by the operating system."}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566297910, "post_id": 57571616, "comment_id": 101604187, "body": "When I said <code>RVA</code> I actually meant to refer to <code>VA</code> (virtual address)!"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566298266, "post_id": 57571616, "comment_id": 101604375, "body": "Is the memory freed by the OS even if the program crashes?"}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566298550, "post_id": 57571616, "comment_id": 101604527, "body": "@H&#229;konH&#230;gland yes. A program doesn&#39;t just crash. Every crash is caused by an unhandled exception and it&#39;s all well managed by the operating system. When you get a &quot;segment fault&quot; as you said in the question it is actually the operating system signaling to the process that that <code>VA</code> is not valid for the given operation. If the program doesn&#39;t consume and handle this exception, then the  operating system ends this process execution abruptly."}], "tags": [], "owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "is_accepted": true, "score": 2, "last_activity_date": 1566305944, "last_edit_date": 1566305944, "creation_date": 1566296895, "answer_id": 57571616, "question_id": 57571539, "link": "https://stackoverflow.com/questions/57571539/is-it-possible-to-free-leaked-memory-from-another-process/57571616#57571616", "title": "Is it possible to free leaked memory from another process?", "body": "<p>Assuming we are talking about Unix-like operating systems (this also applies to Windows and the majority of other modern operating systems)...</p>\n\n<blockquote>\n  <p>What is happening here? Why is it not possible to free the leaked memory?</p>\n</blockquote>\n\n<p>First of all: every running process have it's own virtual address space (or <code>VAS</code>). This <code>VAS</code> is a way the operating system have to lay out and organize the physical memory between different processes. It ranges from 0x0 to 0xFFFFFFFF on 32 bits processors and contains all the memory of the process - its code, static data, stack, heap, etc, it is all in the process <code>VAS</code>. A virtual address (or <code>VA</code>) is a specific address inside the virtual address space.</p>\n\n<p>When you allocate memory with <code>malloc</code> the system will search for a valid unallocated memory on the process heap and if it finds, return a pointer of it (i.e. <code>malloc</code> essentially returns a virtual address).</p>\n\n<p>After the process ends its <code>VAS</code> will be automatically \"freed\" by the operating system, so that memory is no longer valid, or allocated in that matter. Asides that, each process have its own virtual address space. You can not directly access a process <code>VAS</code> (virtual address space) using a <code>VA</code> (virtual address) of another process - by doing that what you actually end up doing is trying to access that <code>VA</code> in the running process which in your example is very likely to result in an unhandled <code>ACCESS_VIOLATION</code> exception and crashes the process.</p>\n"}, {"comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566297093, "post_id": 57571641, "comment_id": 101603794, "body": "So the memory is lost forever? It is not possible to free it even if you know the address?"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 2, "creation_date": 1566297152, "post_id": 57571641, "comment_id": 101603827, "body": "@H&#229;konH&#230;gland: The memory is freed when the process exits. It\u2019s not lost."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1566297304, "post_id": 57571641, "comment_id": 101603919, "body": "@Ry- Oh, I didn&#39;t realize. I had always thought memory was lost forever. Are you sure? Then memory leaks only persists until a process exits. I had never heard about that"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1566297443, "post_id": 57571641, "comment_id": 101603986, "body": "@H&#229;konH&#230;gland: I\u2019m sure, for any modern OS."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566298380, "post_id": 57571641, "comment_id": 101604432, "body": "What happens if the program crashes? Is the heap memory of the process then lost for ever?"}, {"owner": {"reputation": 5813, "user_id": 1075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70efe94a6c2237ec96f429402a03a27d?s=128&d=identicon&r=PG", "display_name": "Renat", "link": "https://stackoverflow.com/users/1075282/renat"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1566298584, "post_id": 57571641, "comment_id": 101604548, "body": "@H&#229;konH&#230;gland, memory is freed if process is crashed. No leakage here. OS takes care of it."}], "tags": [], "owner": {"reputation": 5813, "user_id": 1075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70efe94a6c2237ec96f429402a03a27d?s=128&d=identicon&r=PG", "display_name": "Renat", "link": "https://stackoverflow.com/users/1075282/renat"}, "is_accepted": false, "score": 1, "last_activity_date": 1566296981, "last_edit_date": 1566296981, "creation_date": 1566296962, "answer_id": 57571641, "question_id": 57571539, "link": "https://stackoverflow.com/questions/57571539/is-it-possible-to-free-leaked-memory-from-another-process/57571641#57571641", "title": "Is it possible to free leaked memory from another process?", "body": "<p>Each process has its own <a href=\"https://en.wikipedia.org/wiki/Virtual_address_space\" rel=\"nofollow noreferrer\">virtual memory space</a> due to <a href=\"https://en.wikipedia.org/wiki/Process_isolation\" rel=\"nofollow noreferrer\">process isolation</a>. Memory addresses in one process are not the same memory addresses in another process. You cannot just access dynamic memory by the address in another process.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 1, "last_activity_date": 1566370442, "last_edit_date": 1566370442, "creation_date": 1566369928, "answer_id": 57585870, "question_id": 57571539, "link": "https://stackoverflow.com/questions/57571539/is-it-possible-to-free-leaked-memory-from-another-process/57585870#57585870", "title": "Is it possible to free leaked memory from another process?", "body": "<p>Just to complete the answer of dedecos, the virtual address space of a process is always different for a different process in the same machine.  This means that what for process A is at <code>0x55eb2269a260</code>, in process B has no counterpart.  No address at Process B matches the same memory as it does for process A.  So then, it's impossible to address from B any of the addresses of process A.  </p>\n\n<p>The thing is that there is a memory manager at the operating system kernel that handles processes memory to be always disjoint, so even if two processes have the same variable at the same address, those variables are different (e.g. two versions of <code>ls</code> command executing at the same time will have the data segment at the same address, as the linker put it there) their address spaces (the same data addresses, for example) map to different memory pages for each process.  This way, you can run the same program several times in parallel without clashing their data segments.</p>\n\n<p>Operating systems offer ways for two processes to share a memory segment, so they can share common data, but even in that case, the addresses of both <em>visuals</em> of the same segment haven't to be placed at the same address (as one of those processes can have occupied the address given to the other for something else), so the conclusion is that what an address means for a process is not valid outside it.</p>\n"}], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 57571616, "answer_count": 3, "score": 3, "last_activity_date": 1566370442, "creation_date": 1566296612, "last_edit_date": 1566297571, "question_id": 57571539, "link": "https://stackoverflow.com/questions/57571539/is-it-possible-to-free-leaked-memory-from-another-process", "title": "Is it possible to free leaked memory from another process?", "body": "<p>I have this simple test C program which leaks 4 bytes of memory:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    int* x = malloc(sizeof(int));\n    printf( \"Address: %p\\n\", x);\n    return 0;\n}\n</code></pre>\n\n<p>I compile it with <code>gcc -o leak leak.c</code>, and then run it:</p>\n\n<pre><code>$ leak\nAddress: 0x55eb2269a260\n</code></pre>\n\n<p>Then I create another test C program that will try to free the leaked memory:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    void *addr = (void*)0x55eb2269a260;\n    printf( \"Trying to free address: %p\\n\", addr);\n    free(addr);\n    return 0;\n}\n</code></pre>\n\n<p>I compile it with <code>gcc -o myfree free.c</code> and then run it:</p>\n\n<pre><code>$ myfree\nTrying to free address: 0x55eb2269a260\nSegmentation fault (core dumped)\n</code></pre>\n\n<p>What is happening here? Why is it not possible to free the leaked memory?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 3, "creation_date": 1566295752, "post_id": 57571123, "comment_id": 101603069, "body": "Are you looking for a data type with 128 bit?"}, {"owner": {"reputation": 59, "user_id": 9629433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502439c7f9a0d90f82a181d36a5b43e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sushil Kumar", "link": "https://stackoverflow.com/users/9629433/sushil-kumar"}, "reply_to_user": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1566295915, "post_id": 57571123, "comment_id": 101603158, "body": "yes i&#39;m looking beyond 63bit"}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1566296218, "post_id": 57571123, "comment_id": 101603313, "body": "Have a look: <a href=\"https://stackoverflow.com/questions/16088282/is-there-a-128-bit-integer-in-gcc\" title=\"is there a 128 bit integer in gcc\">stackoverflow.com/questions/16088282/&hellip;</a>"}, {"owner": {"reputation": 59, "user_id": 9629433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502439c7f9a0d90f82a181d36a5b43e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sushil Kumar", "link": "https://stackoverflow.com/users/9629433/sushil-kumar"}, "reply_to_user": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1566314407, "post_id": 57571123, "comment_id": 101613789, "body": "@Mike now even if we have a data type of 128bits by applying the method as described in the link how do i set a bit now... &quot;1ULL &lt;&lt; 64&quot; instead of this what shift logic needs to be applied"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566342596, "post_id": 57571123, "comment_id": 101624246, "body": "@SushilKumar You can&#39;t."}, {"owner": {"reputation": 59, "user_id": 9629433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502439c7f9a0d90f82a181d36a5b43e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sushil Kumar", "link": "https://stackoverflow.com/users/9629433/sushil-kumar"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566364813, "post_id": 57571123, "comment_id": 101627813, "body": "@JL2210 hard luck to me... :( :("}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1566296730, "post_id": 57571208, "comment_id": 101603608, "body": "This does not answer the question."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1566297249, "post_id": 57571208, "comment_id": 101603895, "body": "@EricPostpischil It does answer the question &quot;how do I do left-shift greater than 64 bits&quot; by saying &quot;you don&#39;t do that by simply using a bitshift on an unsigned integer type&quot;. There might be other answers that you&#39;re very welcome to post."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566299177, "post_id": 57571208, "comment_id": 101604822, "body": "(a) GCC and Clang both offer <code>unsigned __int128</code>. (b) Computations with shifts exceeding 64 bits can be effected by emulating wider integers. In other words, we can write programs that compute desired results by building them out of various fundamental operations. (c) The possibility of entering other answers does not render this answer useful or correct, so it is not relevant to evaluating this answer. (d) Behavior not defined by the C standard is not random behavior."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1566300217, "post_id": 57571208, "comment_id": 101605339, "body": "Behaviour not defined by C standard can for all intents and purposes be totally random, to the extent that even the author of the compiler implementation might not be able to predict what the behaviour would be in any instance without compiling the program."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566300555, "post_id": 57571208, "comment_id": 101605535, "body": "There exist some situations in which behavior not defined by the C standard can be effectively random, as when effects are subject to address space layout randomization. But behavior not defined by the C standard is not generally random. Random means a lack of pattern or predictability, but much behavior not defined by the C standard is a consequence of things other than the standard, such as the designs and behaviors of compilers, operating systems, machines, and such. These things give the behavior some amount of pattern and predictability, so it is not, for all intents and purposes, random."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566300602, "post_id": 57571208, "comment_id": 101605561, "body": "In particular, observations of program behavior often give clues as to what went wrong, thus demonstrating that both theoretically and practically the behavior contains information, not random noise."}, {"owner": {"reputation": 59, "user_id": 9629433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502439c7f9a0d90f82a181d36a5b43e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sushil Kumar", "link": "https://stackoverflow.com/users/9629433/sushil-kumar"}, "edited": false, "score": 0, "creation_date": 1566302282, "post_id": 57571208, "comment_id": 101606537, "body": "I&#39;m working on existing project, where 63 macros are already taken the next comes 64(which are my changes) for which i have to do left shift operation."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 59, "user_id": 9629433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502439c7f9a0d90f82a181d36a5b43e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sushil Kumar", "link": "https://stackoverflow.com/users/9629433/sushil-kumar"}, "edited": false, "score": 1, "creation_date": 1566302319, "post_id": 57571208, "comment_id": 101606567, "body": "@SushilKumar this information needs to go into your <b>question</b>. All of the answers are wrong then."}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "reply_to_user": {"reputation": 59, "user_id": 9629433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502439c7f9a0d90f82a181d36a5b43e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sushil Kumar", "link": "https://stackoverflow.com/users/9629433/sushil-kumar"}, "edited": false, "score": 0, "creation_date": 1566306403, "post_id": 57571208, "comment_id": 101608987, "body": "@SushilKumar &quot;I&#39;m working on existing project, where 63 macros are already taken the next comes 64&quot;. I still don&#39;t get it. You want to left shift 64 times a 64 bits variable ?"}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566306559, "post_id": 57571208, "comment_id": 101609073, "body": "@EricPostpischil &quot;This does not answer the question&quot;. I don&#39;t agree. I does answer the question (result is undefined behaviour) and then it makes sense to clarify why Sushil needs to do that. There might be some misunderstanding somewhere."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1566307528, "post_id": 57571208, "comment_id": 101609654, "body": "@GuillaumePetitjean: That the result is undefined behavior does not answer the question. The question is not \u201cWhat happens when you shift by more than the left operand width?\u201d but \u201cHow do I shift by more than 64 bits?\u201d Correct answers to that are to use a left operand wider than 64 bits or to construct the operation out of a compound type, as with a structure or array containing multiple elements. Saying the behavior of left shifting an operand not wider than 64 bits by 64 bits does not tell you how to shift by 64 bits, so it is not an answer."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1566308112, "post_id": 57571208, "comment_id": 101610032, "body": "@GuillaumePetitjean: Framing this in a way that may make it clearer, the question solicits information about how to shift by more than 64 bits. That is a possible act, and there are ways to do it, but the answer that a left-shift of a 64-bit operand by more than 64 bits has undefined behavior does not provide that information. Since it does not provide the information that was solicited, it does not answer the question. It is really quite simple: If a person says \u201cPlease give me X,\u201d and you say \u201cYou cannot have X in some particular way, here is Y,\u201d then you have not done what was asked."}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 1, "creation_date": 1566308428, "post_id": 57571208, "comment_id": 101610235, "body": "Would have been much faster for you (and me by the way) to answer the question that nitpicking about the nature an answer should have... I understand we should follow rules on SO but this doesn&#39;t prevent to be flexible and remain constructive..."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 0, "last_activity_date": 1566300248, "last_edit_date": 1566300248, "creation_date": 1566295415, "answer_id": 57571208, "question_id": 57571123, "link": "https://stackoverflow.com/questions/57571123/how-do-i-do-left-shift-greater-then-64bits-warning-shift-count-width-of-typ/57571208#57571208", "title": "How do i do left shift greater then 64bits? warning: shift count &gt;= width of type [-Wshift-count-overflow]", "body": "<p>You can shift a 64-bit unsigned type left by zero to 63 bits. Anything else will lead to undefined behaviour. The largest unsigned integer type is <code>uintmax_t</code> but it is usually <code>unsigned long long</code> on most common implementations, which is 64 bits, and the shift is equally undefined then. In practice it will result in either zero, the original value, or completely random behaviour.</p>\n\n<p><strong>Why do you think you need to do this?</strong></p>\n"}, {"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 2, "last_activity_date": 1566342583, "last_edit_date": 1566342583, "creation_date": 1566300079, "answer_id": 57572504, "question_id": 57571123, "link": "https://stackoverflow.com/questions/57571123/how-do-i-do-left-shift-greater-then-64bits-warning-shift-count-width-of-typ/57572504#57572504", "title": "How do i do left shift greater then 64bits? warning: shift count &gt;= width of type [-Wshift-count-overflow]", "body": "<blockquote>\n  <p>I just want to understand how do i set a particular bit greater then 64bits.</p>\n</blockquote>\n\n<p>You can't.</p>\n\n<p><strong>Old answer:</strong></p>\n\n<p>You can do a left shift greater than or equal to 64-bits by doing exactly what you're doing.</p>\n\n<p>This, of course, won't result in anything usable (either the original value, zero, or something else), and is undefined behavior, so <strong>don't do it</strong>.</p>\n\n<p>If you want a data type that can do this, you're mostly out of luck. There are no guarantees that an 128-bit data type exists in C, and any compiler extensions that you may see are not portable. This may be possible with SIMD instructions but they're not portable across processors.</p>\n\n<p>That said, there is <code>unsigned __int128</code> in GCC and Clang that allows shifting (through emulation of wider integers). However, this <a href=\"https://stackoverflow.com/questions/6759592/how-to-enable-int128-on-visual-studio\">isn't available in MSVC</a>. Also note that you won't be able to print this number, so it's pretty pointless anyway.</p>\n"}], "owner": {"reputation": 59, "user_id": 9629433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502439c7f9a0d90f82a181d36a5b43e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sushil Kumar", "link": "https://stackoverflow.com/users/9629433/sushil-kumar"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "closed_date": 1566305180, "answer_count": 2, "score": -3, "last_activity_date": 1566342583, "creation_date": 1566295077, "last_edit_date": 1566314138, "question_id": 57571123, "link": "https://stackoverflow.com/questions/57571123/how-do-i-do-left-shift-greater-then-64bits-warning-shift-count-width-of-typ", "closed_reason": "Needs details or clarity", "title": "How do i do left shift greater then 64bits? warning: shift count &gt;= width of type [-Wshift-count-overflow]", "body": "<p>I am trying to do left shift greater then or equal to 64, but I am not sure which DATA TYPE exists to help me out here.</p>\n\n<p>I'm working on existing project, where 63 macros are already taken the next comes 64(which are my changes) for which i have to do left shift operation.</p>\n\n<p>Note: I just want to understand how do i set a particular bit greater then 64bits. \"I am not sure which DATA TYPE exists to help me out here\". \nBelow code is just a sample code. We know there no data type exists greater then 64bits, but can there be any solution for this.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define PEAK 64\n\nint main()\n{\n  unsigned long int a;\n  a= (1ULL &lt;&lt; PEAK);\n  printf(\"%lu\",a);\n  return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>main.c:8:10: warning: left shift count >= width of type [-Wshift-count-overflow]<br>\n   a= (1ULL &lt;&lt; PEAK);<br>\n             ^~</p>\n</blockquote>\n"}, {"tags": ["java", "c", "casting", "java-native-interface", "unsigned"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1566296039, "post_id": 57570784, "comment_id": 101603219, "body": "<a href=\"https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/types.html\" rel=\"nofollow noreferrer\"><code>jlong</code> is a signed 64-bit integer value</a>.  <code>unsigned long</code> is 32-bits on many platforms, even 64-bit Windows.  You probably should use <code>int64_t</code>, as in <code>int bar( int64_t id, int64_t *val );  Or just use </code>jlong`."}, {"owner": {"reputation": 169, "user_id": 10931326, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IRGyrBJ-Zks/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYWKrNEPQ9oVipqaDsZ8AWYiVn3RQ/mo/photo.jpg?sz=128", "display_name": "user10931326", "link": "https://stackoverflow.com/users/10931326/user10931326"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1566350746, "post_id": 57570784, "comment_id": 101625478, "body": "@AndrewHenle I know about <code>jlong</code> being what it is, but unfortunately I cannot change <code>bar(...)</code>. Everything else is available for change."}], "answers": [{"tags": [], "owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "is_accepted": false, "score": 0, "last_activity_date": 1567021249, "creation_date": 1567021249, "answer_id": 57699079, "question_id": 57570784, "link": "https://stackoverflow.com/questions/57570784/casting-jlong-to-and-from-unsigned-long-int/57699079#57699079", "title": "Casting jlong to and from unsigned long int", "body": "<p>I know that this solution is a hack, but maybe you can go via <code>String</code>.</p>\n\n<p><code>java.util.Long</code> provides method to create unsigned String value from <code>long</code>:</p>\n\n<p><a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html#toUnsignedString-long-\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html#toUnsignedString-long-</a></p>\n\n<p>It means, you can always convert your long value (assuming that you make sure it's not negative and in the range of <code>unsigned long</code>) to <code>String</code>, pass it to <code>JNI</code> based code, and convert it back.</p>\n\n<p><strong>Java</strong></p>\n\n<pre><code>public static void main(String[] args) {\n\n    long value_min = 0;\n    // I assume that we are dealing with 32bit unsigned long on a C side\n    // if you try to test boundary case with 4294967296L it fill fail for\n    // 64bit macOS/Linux as you will be able to fit the value into variable.\n    long value_max = 4294967295L;\n\n    System.out.println(\"I am passing: \" + value_min);\n    PassLongAsString.passULong(java.lang.Long.toUnsignedString(value_min));\n\n    System.out.println(\"I am passing: \" + value_max);\n    PassLongAsString.passULong(java.lang.Long.toUnsignedString(value_max));\n  }\n</code></pre>\n\n<p><strong>C</strong></p>\n\n<pre><code>JNIEXPORT void JNICALL Java_recipeNo058_PassLongAsString_passULong\n  (JNIEnv * env, jclass obj, jstring str) {\n\n  //we have to get string bytes into C string\n  const char *c_str;\n\n  c_str = (*env)-&gt;GetStringUTFChars (env, str, NULL);\n\n  if (c_str == NULL) {\n    return;\n  }\n  printf (\"Passed string: %s\\n\", c_str);\n  unsigned long ul = strtoul (c_str, NULL, 0);\n  printf (\"Parsed value:  %lu\\n\", ul);\n\n  //after using it, remember to release the memory\n  (*env)-&gt;ReleaseStringUTFChars (env, str, c_str);\n}\n</code></pre>\n\n<p>Of course, it will fail if you will pass value </p>\n"}], "owner": {"reputation": 169, "user_id": 10931326, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IRGyrBJ-Zks/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYWKrNEPQ9oVipqaDsZ8AWYiVn3RQ/mo/photo.jpg?sz=128", "display_name": "user10931326", "link": "https://stackoverflow.com/users/10931326/user10931326"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567021249, "creation_date": 1566294017, "question_id": 57570784, "link": "https://stackoverflow.com/questions/57570784/casting-jlong-to-and-from-unsigned-long-int", "title": "Casting jlong to and from unsigned long int", "body": "<p>I have the following JNI function:</p>\n\n<pre><code>JNIEXPORT jint JNICALL foo(JNIEnv *env, jobject obj, jlong id, jlongArray array)\n{\n    jboolean isCopy;\n    jsize len = (*env)-&gt;GetArrayLength(env, array);\n    jlong* lp = (*env)-&gt;GetLongArrayElements(env, array, &amp;isCopy);\n    if (!lp) {\n        return INSUFFICIENT_RESOURCES;\n    }\n\n    jlong retval = 0;\n    // insert code to cast id from jlong to ULONG before passing to bar(...)?\n    jint ret = bar(id, &amp;retval);\n    if(len&gt;=1) {\n        // insert code to cast retval from ULONG back to jlong\n        lp[0] = retval;\n    }\n\n    int mode = 0;\n    // if error code is returned then do not save changes\n    if(ret != 0) {\n        mode = JNI_ABORT;\n    }\n    (*env)-&gt;ReleaseLongArrayElements(env, array, lp, mode);\n\n    return ret;\n}\n</code></pre>\n\n<p>Method <code>bar</code> has the signature</p>\n\n<pre><code>int bar(ULONG id, ULONG *val);\n</code></pre>\n\n<p>where <code>ULONG</code> is</p>\n\n<pre><code>typedef ULONG unsigned long int;\n</code></pre>\n\n<p>So in my JNI function I would like to cast parameter <code>id</code> from <code>jlong</code> to <code>ULONG</code>, and then <code>retval</code> from <code>ULONG</code> back to <code>jlong</code>. Can I directly cast, or is there a series of bitwise operations that I can do in these two cases?</p>\n"}, {"tags": ["c", "linux-kernel", "filesystems", "atomic"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1566296223, "post_id": 57570746, "comment_id": 101603317, "body": "This sounds like you&#39;re trying to reinvent <a href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/chap-system_auditing\" rel=\"nofollow noreferrer\">system auditing</a>."}, {"owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "edited": false, "score": 2, "creation_date": 1566296632, "post_id": 57570746, "comment_id": 101603553, "body": "read about <code>inotify</code>. But +1 for Andrew answer."}, {"owner": {"reputation": 9, "user_id": 11128733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9aca81c1d28cab868a663208d7fedb?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay kumar singh", "link": "https://stackoverflow.com/users/11128733/vinay-kumar-singh"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1567143174, "post_id": 57570746, "comment_id": 101882874, "body": "Thanks @AndrewHenle , but my main motive is to provide atomicity to few files,like if in case of power failure, while i am writing a file ,then my file should not get corrupted... how to do it?"}], "answers": [{"tags": [], "owner": {"reputation": 4599, "user_id": 8330162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cDyyg.jpg?s=128&g=1", "display_name": "B--rian", "link": "https://stackoverflow.com/users/8330162/b-rian"}, "is_accepted": false, "score": 1, "last_activity_date": 1566310069, "creation_date": 1566310069, "answer_id": 57575522, "question_id": 57570746, "link": "https://stackoverflow.com/questions/57570746/how-would-i-know-that-file-is-opened-and-it-is-saved-after-some-writing-operatio/57575522#57575522", "title": "How would I know that file is opened and it is saved after some writing operation using C code?", "body": "<p>For the 1st part of your question, please refer e.g. to <a href=\"https://stackoverflow.com/questions/1048592/how-to-check-if-a-file-has-been-opened-by-another-application-in-c\">How to check if a file has been opened by another application in C++?</a> \nOne way described there is to use a system tool like <a href=\"http://en.wikipedia.org/wiki/Lsof\" rel=\"nofollow noreferrer\">lsof</a> and call this via a  <code>system()</code> call. </p>\n\n<p>For the 2nd part, about knowing whether a file has been modified, you will have to create a backup file to check against. Most editors already do that, but their naming scheme is different, so you might want to take care of that yourself. <em>How to do that?</em> Just automatically create a (hidden) file <code>.mylogfile.txt</code> if it does not exist by simply copying <code>mylogfile.txt</code>. If <code>.mylogfile.txt</code> exists, is having an older timestamp than <code>mylogfile.txt</code>, and differs in size and/or hash-value (using e.g. <code>md5sum</code>) your file was modified. </p>\n\n<p>But before re-implementing this, take a look at <a href=\"https://stackoverflow.com/questions/931093/how-do-i-make-my-program-watch-for-file-modification-in-c/\">How do I make my program watch for file modification in C++?</a></p>\n"}], "owner": {"reputation": 9, "user_id": 11128733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9aca81c1d28cab868a663208d7fedb?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay kumar singh", "link": "https://stackoverflow.com/users/11128733/vinay-kumar-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566565538, "creation_date": 1566293909, "last_edit_date": 1566565538, "question_id": 57570746, "link": "https://stackoverflow.com/questions/57570746/how-would-i-know-that-file-is-opened-and-it-is-saved-after-some-writing-operatio", "title": "How would I know that file is opened and it is saved after some writing operation using C code?", "body": "<p>I have a set of configuration files (10 or more), and if user opens any of these file using any editor (e.g vim,vi,geany,qt,leafpad..). How would I come to know that <strong>which file is opened</strong> and if some writing process is done, then it is <strong>saved or not</strong> (using <strong>C</strong> code).</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "edited": false, "score": 0, "creation_date": 1566293810, "post_id": 57570684, "comment_id": 101601950, "body": "pass it as parameter"}, {"owner": {"reputation": 33, "user_id": 11383897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4d1f1ed9dec6f65be7b53de74cfd16?s=128&d=identicon&r=PG&f=1", "display_name": "nextgenben99", "link": "https://stackoverflow.com/users/11383897/nextgenben99"}, "reply_to_user": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "edited": false, "score": 0, "creation_date": 1566293866, "post_id": 57570684, "comment_id": 101601982, "body": "what does that look like? Will it be able to if its not global"}], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 2, "last_activity_date": 1566293948, "creation_date": 1566293948, "answer_id": 57570757, "question_id": 57570684, "link": "https://stackoverflow.com/questions/57570684/how-to-pass-array-of-structs-from-main-to-another-function/57570757#57570757", "title": "How to pass array of structs from main to another function", "body": "<p>You can pass a pointer to the struct along with an optional size parameter in the <code>setup</code> function.</p>\n\n<pre><code>void setup(struct examples *arr, int size)\n{\n  ..\n}\n\n// in main\nsetup(array1, count-2);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2706603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/082b809b3d496faa869370158eaf1fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Mash", "link": "https://stackoverflow.com/users/2706603/mash"}, "is_accepted": false, "score": 0, "last_activity_date": 1566293991, "creation_date": 1566293991, "answer_id": 57570775, "question_id": 57570684, "link": "https://stackoverflow.com/questions/57570684/how-to-pass-array-of-structs-from-main-to-another-function/57570775#57570775", "title": "How to pass array of structs from main to another function", "body": "<p>Simply send the array as a param to setup() method.</p>\n\n<pre><code>setup(array1); //in main function\n\nvoid setup(struct array1[])\n{\n   //process array1 here\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64, "user_id": 11409858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X3vc0.jpg?s=128&g=1", "display_name": "Ruan", "link": "https://stackoverflow.com/users/11409858/ruan"}, "is_accepted": false, "score": 2, "last_activity_date": 1566294265, "creation_date": 1566294265, "answer_id": 57570869, "question_id": 57570684, "link": "https://stackoverflow.com/questions/57570684/how-to-pass-array-of-structs-from-main-to-another-function/57570869#57570869", "title": "How to pass array of structs from main to another function", "body": "<p>You need to pass the pointer of that array to function, pointer is the position of data in memory, for arrays you need to pass only the name of array</p>\n\n<pre><code>void setup(struct examples* array, int count)\n{\n    int i=0;\n    for(;i&lt;count;i++) {\n        //Do something\n        array[i] \n\n    }\n   //Wanting to access array in here\n}\nint main(int argc, char *argv[])\n{\n\n\n    struct examples array1[count-2];\n\n    // Calculation occurs here and fills array1\n\n    setup(array1,count-2);\n    return 0;\n}\n</code></pre>\n\n<p>I also passed the size of the array to help manipulate it in the function </p>\n"}], "owner": {"reputation": 33, "user_id": 11383897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4d1f1ed9dec6f65be7b53de74cfd16?s=128&d=identicon&r=PG&f=1", "display_name": "nextgenben99", "link": "https://stackoverflow.com/users/11383897/nextgenben99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1566297105, "creation_date": 1566293650, "last_edit_date": 1566297105, "question_id": 57570684, "link": "https://stackoverflow.com/questions/57570684/how-to-pass-array-of-structs-from-main-to-another-function", "title": "How to pass array of structs from main to another function", "body": "<p>Im I have this array of structs that I am trying to pass to another function (setup) in my C program. The array is created and populated in the main function. I would make it global but I don't know the size of the array until the program starts, as it takes input from command line args. The setup function will run in main. Since the array gets populated before <code>setup()</code> runs in main, how do I access the contents of <code>array1</code> in <code>setup()</code>. </p>\n\n<p>Essentially:</p>\n\n<pre><code>void setup()\n{\n   //Wanting to access array in here\n}\nint main(int argc, char *argv[])\n{\n\n\n    struct examples array1[count-2];\n\n    // Calculation occurs here and fills array1\n\n    setup();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 1, "creation_date": 1566293818, "post_id": 57570653, "comment_id": 101601956, "body": "What should the output be?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566304398, "post_id": 57570653, "comment_id": 101607720, "body": "If you&#39;re going for an optimal overall program, you might want to revisit your timestamp structure. Using tuples of (year, month, day, hour, minute) is classically difficult, classically bug-ridden, and inefficient to boot. If you&#39;re going to be manipulating timestamps intensively, consider using representations that allow you to carry an entire timestamp around in a single (long) integer, such as <code>time_t</code>, or a composite number yyyymmddHHMMSS. or a pair of numbers for the Julian day and the time within the day."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566304491, "post_id": 57570653, "comment_id": 101607780, "body": "Do you care about time zones and daylight saving time?"}, {"owner": {"reputation": 3880, "user_id": 5328289, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e0e88b500a567f9572d0f8fe4e99405?s=128&d=identicon&r=PG&f=1", "display_name": "M.E.", "link": "https://stackoverflow.com/users/5328289/m-e"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566307699, "post_id": 57570653, "comment_id": 101609781, "body": "@steve-summit Thanks for your suggestion. I am exploring the way you suggest. The reason for using tuples is that they are used to retrieve memory indexed data (multiple dimension array). Regarding your second question no I do not care about time zones and daylight saving time. They are financial timestamps and therefore they are ET, begin on Sunday evening and end on Friday evening."}], "answers": [{"comments": [{"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1566294621, "post_id": 57570912, "comment_id": 101602446, "body": "The smart bit of this means you can use the idiom that <code>compare_timestamp(a,b) op 0</code> for any relational operator <code>op</code> has the natural meaning. For example <code>compare_timestamp(a,b) &lt; 0</code> is true iff a &lt; b, <code>compare_timestamp(a,b) != 0</code> is true iff a!=b and so on for all of <code>&lt;</code>.<code>&lt;=</code>,<code>=</code>,<code>!=</code>,<code>&gt;=</code> and <code>&gt;</code>. But why not use <code>&lt;time.h&gt;</code>?"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1566299409, "post_id": 57570912, "comment_id": 101604947, "body": "@Persixty Of course you could create a <code>struct tm</code> from the <code>struct Timestamp</code> as defined in the question, but converting <code>struct tm</code> to <code>time_t</code> for comparison is probably more expensive as the question doesn&#39;t require to calculate the exact difference. Is there any better way to compare two <code>struct tm</code> than comparing (subtracting) the results of <code>mktime</code>?"}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1566303090, "post_id": 57570912, "comment_id": 101606972, "body": "Using the <code>struct tm</code> from <code>&lt;time.h&gt;</code> has its downsides. It has redundant members (<code>tm_sec</code>,<code>tm_wday</code>,<code>tm_yday</code> and <code>tm_isdst</code>) to the purpose here. There is (as you point out) a non-trivial cost to <code>mktime()</code> when the member by member comparison you propose will suffice and only compares as many values as required. I&#39;ve thrown it into the mix because as a matter of good practice you should prefer to use standard structures unless you can really justify the deviation...."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1566303313, "post_id": 57570912, "comment_id": 101607088, "body": "I&#39;m not aware of any better way (even in assembler) or comparing/ordering integers than by subtraction and considering the sign of the result (your way). But we should always be sceptical of premature optimization. I&#39;d consider using &lt;time.h&gt; and lazy use of <code>mktime()</code> until the OP is sure that&#39;s a genuine bottleneck."}, {"owner": {"reputation": 3880, "user_id": 5328289, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e0e88b500a567f9572d0f8fe4e99405?s=128&d=identicon&r=PG&f=1", "display_name": "M.E.", "link": "https://stackoverflow.com/users/5328289/m-e"}, "edited": false, "score": 0, "creation_date": 1566307843, "post_id": 57570912, "comment_id": 101609860, "body": "Thanks for the suggestion on time.h. I will do some tests with time.h, I was not aware this was a possibility. I am coming from a Python code that I need to optimize, it might be the case than even not being the most optimized option it might be fast enough."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1566324744, "post_id": 57570912, "comment_id": 101618571, "body": "Straightforward, easy to understand, and easy to prove correct. Excellent answer."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1566343719, "post_id": 57570912, "comment_id": 101624446, "body": "One thing to note is that the code assumes the values won&#39;t be negative, which is a reasonable assumption. However, if they can be negative then you have to be careful about using subtraction as a substitute for comparison because integer rollover can bite you."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": false, "score": 4, "last_activity_date": 1566374504, "last_edit_date": 1566374504, "creation_date": 1566294386, "answer_id": 57570912, "question_id": 57570653, "link": "https://stackoverflow.com/questions/57570653/algorithm-to-compare-two-date-time-stamps/57570912#57570912", "title": "Algorithm to compare two date time stamps", "body": "<p>Instead of using return values <code>0</code>, <code>1</code> and <code>2</code>, I suggest to use <code>&lt;0</code>, <code>0</code> and <code>&gt;0</code>. This is more common, matches the semantics of <code>strcmp</code> etc., <code>qsort</code> or <code>bsearch</code> and can be implemented using simple subtraction and comparison with 0.</p>\n\n<pre><code>/*\n * @retval &lt;0 if a &lt; b\n * @retval 0 if a == b\n * @retval &gt;0 if a &gt; b\n */\nint compare_timestamps(struct Timestamp a, struct Timestamp b)\n{\n    int result;\n\n    result = a.year - b.year;\n    if(result != 0) return result;\n\n    result = a.month - b.month;\n    if(result != 0) return result;\n\n    result = a.day - b.day;\n    if(result != 0) return result;\n\n    result = a.hour - b.hour;\n    if(result != 0) return result;\n\n    result = a.minute - b.minute;\n\n    return result;\n}\n</code></pre>\n\n<p>As mentioned in Jim Mischel's comment, the algorithm assumes that the subtraction doesn't result in integer rollover. This is valid for normal values of <code>month</code>, <code>day</code>, <code>hour</code> and <code>minute</code> fields. It is a reasonable assumption for \"usual\" year values. It will not be valid for the <code>year</code> field if <code>abs(a.year) + abs(b.year) &gt; INT_MAX</code>. To handle <code>year</code> values in the full range of <code>INT_MIN</code>..<code>INT_MAX</code> the algorithm would have to be changed.</p>\n"}, {"comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566303376, "post_id": 57571067, "comment_id": 101607115, "body": "Your first optimization is questionable.  It&#39;s hard to imagine <code>month * 64</code> being enough faster than <code>month * 1000</code> to make a difference, and if the OP is worried about that kind of efficiency, moving away from YMD timestamps is the way to go.  And then your second optimization is classically useless: any compiler can replace multiplications by shifts, so you get zero gain in efficiency and a significant loss in readability.  (Not to mention the possibility for error: your shifts are in the wrong direction)."}, {"owner": {"reputation": 9168, "user_id": 1921273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LREX2.png?s=128&g=1", "display_name": "MrSmith42", "link": "https://stackoverflow.com/users/1921273/mrsmith42"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566543067, "post_id": 57571067, "comment_id": 101696322, "body": "@Steve Summit: Tanks for pointing out the shift-direction-error. I corrected it. And as I said in my answer: 1 and 2 are at most <b>minor</b> improvements and must be validated by <b>profiling</b> like any optimization attempt."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566564790, "post_id": 57571067, "comment_id": 101706946, "body": "It occurred to me later that if you&#39;re thinking about packing bit-width fields into a single integer, shifts are actually <i>more</i> readable than multiplications, not less.  (In other words, my complaint about a loss in readability might, arguably, have been backwards.)"}], "tags": [], "owner": {"reputation": 9168, "user_id": 1921273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LREX2.png?s=128&g=1", "display_name": "MrSmith42", "link": "https://stackoverflow.com/users/1921273/mrsmith42"}, "is_accepted": false, "score": -1, "last_activity_date": 1566543142, "last_edit_date": 1566543142, "creation_date": 1566294888, "answer_id": 57571067, "question_id": 57570653, "link": "https://stackoverflow.com/questions/57570653/algorithm-to-compare-two-date-time-stamps/57571067#57571067", "title": "Algorithm to compare two date time stamps", "body": "<p>here a minor improvement:</p>\n\n<p>Your PC is working in binary so base 2 is what he can best</p>\n\n<p>You could replace: </p>\n\n<pre><code>comparison = c_year * 10000 + c_month * 1000 + c_day * 100 + c_hour * 10 + c_minute;\n</code></pre>\n\n<p>by (your values are all lower than 4) so you can:</p>\n\n<pre><code>comparison = c_year * 256 + c_month * 64 + c_day * 16 + c_hour *4 + c_minute;\n</code></pre>\n\n<p>Or this (less readable but 'without' arithmetic):</p>\n\n<pre><code>comparison = c_year &lt;&lt; 8 | c_month &lt;&lt;6 | c_day &lt;&lt;4 | c_hour &lt;&lt;2 | c_minute;\n</code></pre>\n\n<p>But if you really have a speed improvement by this, can only be validated with profiling.</p>\n\n<p>depending on your data it could be faster only to compare what you need:</p>\n\n<pre><code>int val;\nif(1!=(val=timestamp_comparison(a.year, b.year)))\n  return val;\nif(1!=(val=timestamp_comparison(a.month, b.month)))\n  return val;\nif(1!=(val=timestamp_comparison(a.c_day, b.c_day)))\n  return val;\nif(1!=(val=timestamp_comparison(a.c_hour, b.c_hour)))\n  return val;\nreturn timestamp_comparison(a.c_minute, b.c_minute);\n</code></pre>\n\n<p>But as I mentioned above, profiling is you friend when it is about optimization.</p>\n\n<hr>\n\n<p>P.s. </p>\n\n<pre><code>if(a&gt;b) return 2;\nif(a=b) return 1;\nif(a&lt;b) return 0;\n</code></pre>\n\n<p>is a bit unusual definition. More common is :</p>\n\n<pre><code>if(a&gt;b) return value &gt;=1\nif(a=b) return 0;\nif(a&lt;b) return value &lt;=-1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1566307841, "last_edit_date": 1566307841, "creation_date": 1566307492, "answer_id": 57574749, "question_id": 57570653, "link": "https://stackoverflow.com/questions/57570653/algorithm-to-compare-two-date-time-stamps/57574749#57574749", "title": "Algorithm to compare two date time stamps", "body": "<p>When comparing the timestamps, 2 concerns come into play</p>\n\n<p><strong>Range of year</strong></p>\n\n<p>If the used range of <code>.year</code> is <code>[INT_MIN...INT_MAX]</code>, avoid <code>a.year - b.year</code> as it may overflow.</p>\n\n<p><strong>Primary values</strong></p>\n\n<p>Are the members <em>always</em> in their primary range?  Example: Is <code>minute</code> in the range 0-59?</p>\n\n<p>Is so, a simple compare and returning -1,0,1 uses the common C idiom <code>(a&gt;b) - (a&lt;b)</code>, something many compilers recognize and emit efficient code.</p>\n\n<pre><code>int timestamp_compare(const struct Timestamp *ts2, const struct Timestamp *ts1) {\n  if (ts1-&gt;year  != ts2-&gt;year)  return (ts2-&gt;year  &gt; ts1-&gt;year)  - (ts2-&gt;year  &lt; ts1-&gt;year);\n  if (ts1-&gt;month != ts2-&gt;month) return (ts2-&gt;month &gt; ts1-&gt;month) - (ts2-&gt;month &lt; ts1-&gt;month);\n  if (ts1-&gt;day   != ts2-&gt;day)   return (ts2-&gt;day   &gt; ts1-&gt;day)   - (ts2-&gt;day   &lt; ts1-&gt;day);\n  if (ts1-&gt;hour  != ts2-&gt;hour)  return (ts2-&gt;hour  &gt; ts1-&gt;hour)  - (ts2-&gt;hour  &lt; ts1-&gt;hour);\n  return (ts2-&gt;day &gt; ts1-&gt;day) - (ts2-&gt;day &lt; ts1-&gt;day);\n}\n</code></pre>\n\n<p>If not, form a linear count of minutes and then compare.</p>\n\n<pre><code>long long minutes(const struct Timestamp *ts) {\n  return ((tbd_day_number(ts-&gt;year, ts-&gt;month, ts-&gt;day)*24LL + ts-&gt;hour)*60 + ts-&gt;minute;\n}\n\nint timestamp_compare(const struct Timestamp *ts2, const struct Timestamp *ts1) {\n  long long m1 = minutes(ts1);\n  long long m2 = minutes(ts2);\n  return (m2 &gt; m1) - (m2 &lt; m1);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1566324667, "post_id": 57574764, "comment_id": 101618532, "body": "Why compare as bytes, when it&#39;s just as easy and far more intuitive to compare as ints?"}, {"owner": {"reputation": 127, "user_id": 8382650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8aedbe41edf6079006d608dc479dc6?s=128&d=identicon&r=PG&f=1", "display_name": "SkyZip", "link": "https://stackoverflow.com/users/8382650/skyzip"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1566340805, "post_id": 57574764, "comment_id": 101623919, "body": "No particular reason. In this case, yes comparing as ints might be more appropriate. Just thought, that this would be more reusable, as the variables could be smaller in size, than an integer."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 1, "creation_date": 1566341605, "post_id": 57574764, "comment_id": 101624066, "body": "Come to think of it, I think this won&#39;t work. It depends on the order of bytes in memory. Intel CPUs (little endian) store an integer with the low bytes first. So the value 0xDEAD is stored in memory with 0xAD at the lower address and 0xDE at the higher address. Your function will compare the low bytes first. Some other CPUs store values the other way (big endian). On those, this would compare the high bytes first."}, {"owner": {"reputation": 127, "user_id": 8382650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8aedbe41edf6079006d608dc479dc6?s=128&d=identicon&r=PG&f=1", "display_name": "SkyZip", "link": "https://stackoverflow.com/users/8382650/skyzip"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1566343055, "post_id": 57574764, "comment_id": 101624328, "body": "Yes, you&#39;re right. Never heard of endiannes before. Not to mention the unsignedness may have messed up things as well. Edited. Is this what you suggested?"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1566343421, "post_id": 57574764, "comment_id": 101624397, "body": "Yes, that was the idea. This assumes, as you point out, that the members are stored contiguously. And also with no padding."}], "tags": [], "owner": {"reputation": 127, "user_id": 8382650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8aedbe41edf6079006d608dc479dc6?s=128&d=identicon&r=PG&f=1", "display_name": "SkyZip", "link": "https://stackoverflow.com/users/8382650/skyzip"}, "is_accepted": false, "score": 0, "last_activity_date": 1566342880, "last_edit_date": 1566342880, "creation_date": 1566307527, "answer_id": 57574764, "question_id": 57570653, "link": "https://stackoverflow.com/questions/57570653/algorithm-to-compare-two-date-time-stamps/57574764#57574764", "title": "Algorithm to compare two date time stamps", "body": "<p>If your struct contains its members in a sorted manner, like in your case, (year is more significant than month, and so on...) and since in a struct, members are 'most likely' to be stored in a contiguous manner:<br><br>\nsee: <a href=\"https://stackoverflow.com/questions/39461364/using-contiguous-memory-of-c-struct-members\">Using Contiguous Memory of C Struct Members</a>\n<br><br>\nyou can try using byte by byte comparison like so:<br></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdlib.h&gt;\n\n// members of struct are stored contigously\nstruct Timestamp\n{\n    int year;\n    int month;\n    int day;\n    int hour;\n    int minute;\n};\n\n\nint timestamp_comparison(const struct Timestamp a, const struct Timestamp b)\n{\n    unsigned i;\n    unsigned struct_size = sizeof(struct Timestamp) / sizeof(int);\n    const int* t1 = (const int*)&amp;a;\n    const int* t2 = (const int*)&amp;b;\n\n    // compare byte by byte\n    for (i = 0; i &lt; struct_size; i++)\n    {\n        if (*t1 != *t2)\n            return *t1 - *t2;\n\n        ++t1;\n        ++t2;\n    }\n\n    return 0;\n}\n\nint main()\n{\n    // example\n    struct Timestamp a = {1, 1, 2, 1, 1};\n    struct Timestamp b = {1, 1, 1, 7, 1};\n    int comp = timestamp_comparison(a, b);\n\n    return 0;\n}\n</code></pre>\n\n<p><br><br>\nI'm not saying this is better, than the already posted answer, just different. And for any other structs like yours, it'll work the same way.</p>\n"}], "owner": {"reputation": 3880, "user_id": 5328289, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e0e88b500a567f9572d0f8fe4e99405?s=128&d=identicon&r=PG&f=1", "display_name": "M.E.", "link": "https://stackoverflow.com/users/5328289/m-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 1, "answer_count": 4, "score": 0, "last_activity_date": 1566543142, "creation_date": 1566293552, "question_id": 57570653, "link": "https://stackoverflow.com/questions/57570653/algorithm-to-compare-two-date-time-stamps", "title": "Algorithm to compare two date time stamps", "body": "<p>I need to implement a timestamp comparison in C (not using any libraries).</p>\n\n<p>I am trying to figure out an optimal algorithm as the routine is going to be used intensively.</p>\n\n<p>My input data is two time stamps, a and b, each of one comprises the following:</p>\n\n<pre><code>year\nmonth\nday\nhour\nminute\n</code></pre>\n\n<p>In C pseudocode:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct Timestamp {\n    int year;\n    int month;\n    int day;\n    int hour;\n    int minute;\n};\n\nstruct Timestamp a;\nstruct Timestamp b;\n</code></pre>\n\n<p>I am trying several approaches including nested if's and a switch combining each value:</p>\n\n<pre><code>int timestamp_comparison(int a, int b) {\nif(a&gt;b) return 2;\nif(a=b) return 1;\nif(a&lt;b) return 0;\n}\n...\nc_year = timestamp_comparison(a.year, b.year);\nc_month = timestamp_comparison(a.month, b.month);\nc_day = timestamp_comparison(a.day, b.day);\nc_hour = timestamp_comparison(a.hour, b.hour);\nc_minute = timestamp_comparison(a.minute, b.minute);\n\ncomparison = c_year * 10000 + c_month * 1000 + c_day * 100 + c_hour * 10 + c_minute;\n...\n</code></pre>\n\n<p>But I would like to know if there is an already algorithm I could leverage on.\nI do not like to use external libraries.</p>\n"}, {"tags": ["c", "tcp", "embedded", "driver", "esp32"], "answers": [{"comments": [{"owner": {"reputation": 1273, "user_id": 493272, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8203e72f2d49e1f63ad33df47fe270b3?s=128&d=identicon&r=PG", "display_name": "SpiRail", "link": "https://stackoverflow.com/users/493272/spirail"}, "edited": false, "score": 0, "creation_date": 1611665844, "post_id": 57575288, "comment_id": 116519045, "body": "You also need to register the handler. The matching base and id is checked at this point. And therefore, I don&#39;t think you really need to check the event and id in the handler itself.  <code>esp_event_handler_instance_register(WIFI_EVENT,WIFI_EVENT_ST&zwnj;&#8203;A_START, wifi_event_handler, NULL, NULL);</code>"}], "tags": [], "owner": {"reputation": 2610, "user_id": 1883304, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xYoZ7.png?s=128&g=1", "display_name": "Micrified", "link": "https://stackoverflow.com/users/1883304/micrified"}, "is_accepted": true, "score": 5, "last_activity_date": 1566309298, "creation_date": 1566309298, "answer_id": 57575288, "question_id": 57570586, "link": "https://stackoverflow.com/questions/57570586/how-to-correctly-set-the-hostname-for-the-tcp-ip-adapter-on-the-esp32/57575288#57575288", "title": "How to correctly set the hostname for the TCP/IP adapter on the ESP32", "body": "<p>Turns out I was doing it correctly. It was my router that had failed to refresh the hostname adequately. For consistency I will restate what I did to solve this problem:</p>\n\n<hr>\n\n<p>The <a href=\"https://docs.espressif.com/projects/esp-idf/en/release-v3.0/api-guides/wifi.html#system-event-sta-start\" rel=\"noreferrer\">Espressif WiFi Guide</a> indicates that the event <code>SYSTEM_EVENT_STA_START</code> is generated once <code>esp_wifi_start()</code> returns successfully. </p>\n\n<p>The generation of this event also means that the event task will initialize the LwIP network interface (netif). Since we know that the TCP/IP adapter will surely have been initialized at this point, we can invoke the hostname change function. Here is an example of a handler that does that, taken right from their example: </p>\n\n<pre><code>void wifi_event_handler (void *handler_arg, esp_event_base_t base, int32_t id,\n    void *event_data) {\n    esp_err_t err;\n\n    // If esp_wifi_start() returned ESP_OK and WiFi mode is in station mode\n    if (base == WIFI_EVENT &amp;&amp; id == WIFI_EVENT_STA_START) {\n        const char *name;\n\n        // Set the hostname for the default TCP/IP station interface\n        if ((err = tcpip_adapter_set_hostname(TCPIP_ADAPTER_IF_STA, g_hostname))\n                != ESP_OK) {\n            fprintf(stderr, \"Err: %s\", esp_err_to_name(err));\n        } else {\n            if ((err = tcpip_adapter_get_hostname(TCPIP_ADAPTER_IF_STA, &amp;name)) != ESP_OK) {\n                fprintf(stderr, \"Err Get Hostname: %s\\n\", esp_err_to_name(err));\n            } else {\n                printf(\"Hostname: %s\\n\", (name == NULL ? \"&lt;None&gt;\" : name));\n            }\n        }\n        ...\n    }\n    ...\n}\n</code></pre>\n\n<p>In this example I get the hostname after setting it, and print it to <code>stdout</code>. You can validate it if you are running the monitor for the ESP32. The hostname set will be the one visible from the router page. </p>\n"}], "owner": {"reputation": 2610, "user_id": 1883304, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xYoZ7.png?s=128&g=1", "display_name": "Micrified", "link": "https://stackoverflow.com/users/1883304/micrified"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5029, "favorite_count": 0, "accepted_answer_id": 57575288, "answer_count": 1, "score": 3, "last_activity_date": 1602944117, "creation_date": 1566293301, "last_edit_date": 1566295525, "question_id": 57570586, "link": "https://stackoverflow.com/questions/57570586/how-to-correctly-set-the-hostname-for-the-tcp-ip-adapter-on-the-esp32", "title": "How to correctly set the hostname for the TCP/IP adapter on the ESP32", "body": "<h3>Problem</h3>\n\n<p>Espressif's ESP-32 (specifically the ESP-WROOM-32 in this case) appears on a network with the default hostname \"Espressif\". I don't want to use this hostname, so I've opted to change it as follows: </p>\n\n<pre><code>    // Initialize the TCP/IP adapter (launches handler task)\n    tcpip_adapter_init();\n\n    // Set the hostname for the default TCP/IP station interface\n    if ((err = tcpip_adapter_set_hostname(TCPIP_ADAPTER_IF_STA, g_hostname))\n            != ESP_OK) {\n        return err;\n    }\n\n</code></pre>\n\n<p>Of course, this isn't working. I get back the following error: <code>ESP_ERR_TCPIP_ADAPTER_IF_NOT_READY</code>. </p>\n\n<hr>\n\n<h3>Attempted Solutions</h3>\n\n<p>To solve this, I look to see if the TCP/IP adapter will post some kind of event when it is finished initializing. That way I can register a handler to set the hostname. The <a href=\"https://docs.espressif.com/projects/esp-idf/en/latest/api-guides/wifi.html\" rel=\"nofollow noreferrer\">Espressif WiFi Driver Guide</a> here indicates a task is launched - so there is probably an event right:</p>\n\n<blockquote>\n  <p>\"The main task calls tcpip_adapter_init() to create an <strong>LwIP core task</strong> and initialize LwIP-related work.\"</p>\n</blockquote>\n\n<p>Well I cannot find any such events. Neither the <a href=\"https://docs.espressif.com/projects/esp-idf/en/latest/api-reference/network/tcpip_adapter.html\" rel=\"nofollow noreferrer\">API documentation</a> nor the actual file itself (<code>tcpip_adapter.h</code>) have it. I checked the header file for events, and <strong>none seem to exist solely for the purpose of indicating that the TCP/IP adapter has finished starting</strong>:</p>\n\n<pre><code>/** IP event declarations */\ntypedef enum {\n    IP_EVENT_STA_GOT_IP,               /*!&lt; ESP32 station got IP from connected AP */\n    IP_EVENT_STA_LOST_IP,              /*!&lt; ESP32 station lost IP and the IP is reset to 0 */\n    IP_EVENT_AP_STAIPASSIGNED,         /*!&lt; ESP32 soft-AP assign an IP to a connected station */\n    IP_EVENT_GOT_IP6,                  /*!&lt; ESP32 station or ap or ethernet interface v6IP addr is preferred */\n    IP_EVENT_ETH_GOT_IP,               /*!&lt; ESP32 ethernet got IP from connected AP */\n} ip_event_t;\n</code></pre>\n\n<h3>Possible Lead</h3>\n\n<p>I have noticed that in <a href=\"https://docs.espressif.com/projects/esp-idf/en/release-v3.0/api-guides/wifi.html#system-event-sta-start\" rel=\"nofollow noreferrer\">Espressif's WiFi guide</a> they indicate that the event <code>SYSTEM_EVENT_STA_START</code> (which indicates that a station has started), will:</p>\n\n<blockquote>\n  <p>Upon receiving this event, the event task will initialize the LwIP network interface (netif). </p>\n</blockquote>\n\n<p>If I place the call after a handler receives this event, I no longer get the error: </p>\n\n<pre><code>\n    // After the event WIFI_EVENT_STA_START\n    if (base == WIFI_EVENT &amp;&amp; id == WIFI_EVENT_STA_START) {\n\n        // Set the hostname for the default TCP/IP station interface\n        if ((err = tcpip_adapter_set_hostname(TCPIP_ADAPTER_IF_STA, g_hostname))\n                != ESP_OK) {\n            fprintf(stderr, \"Err: %s\", esp_err_to_name(err));\n        }\n        ...\n    }\n\n</code></pre>\n\n<p>However, the hostname still hasn't changed. Therefore I find myself a bit stuck. How can I actually change the hostname? I've found little to no results from searching this problem. However, the esp32 is a popular module and I'm sure many other people will find themselves facing the same problem. </p>\n"}, {"tags": ["python", "c", "linux", "python-3.x", "ctypes"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1566296620, "post_id": 57570585, "comment_id": 101603541, "body": "From what I can see in other examples on the &#39;net, the argument type should be plain <code>ctypes.c_char_p</code>. To me it looks like <code>ctypes.POINTER(ctypes.c_char_p)</code> would be a pointer to a pointer, which isn&#39;t correct."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1566298246, "post_id": 57570585, "comment_id": 101604366, "body": "Yes, pick either <code>ctypes.c_char_p</code> or <code>ctypes.POINTER(ctypes.c_char)</code> for the 1st argument."}], "owner": {"reputation": 79, "user_id": 5308747, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155973195525551/picture?type=large", "display_name": "Eoin O Connell", "link": "https://stackoverflow.com/users/5308747/eoin-o-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566293295, "creation_date": 1566293295, "question_id": 57570585, "link": "https://stackoverflow.com/questions/57570585/calling-c-function-from-python-passes-over-incorrect-string", "title": "Calling C function from Python passes over incorrect string", "body": "<p>I have a simple function written in C that acts as a logger to limit the size of the log by deleting stuff from the top of the file everytime new stuff needs to be added, the file is a binary file and bytes can have any value from 0-0xFF. After following some example, I'm able to call my C function from Python3, but for some reason the string that is passed over is incorrect.</p>\n\n<pre><code>c\nint writetolog(char* pData,int bytes)\n</code></pre>\n\n<pre><code>python:\nimport ctypes\nlib = ctypes.CDLL(\"./filelogger.so\")\nfilelogger=lib.writetolog\nfilelogger.argtypes=[ctypes.POINTER(ctypes.c_char_p),ctypes.c_int]\nlib.connect()\nfilelogger(ctypes.c_char_p(b\"1234;;\\r\\n\"),8)\n</code></pre>\n\n<p>The string gets passed over as junk when I view what is stored into my log file. The characters that came across were junk.</p>\n"}, {"tags": ["c", "arm", "embedded", "interrupt-handling", "keil"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 3, "creation_date": 1566294917, "post_id": 57570040, "comment_id": 101602632, "body": "I don&#39;t think there should be <a href=\"https://godbolt.org/z/P4EyVa\" rel=\"nofollow noreferrer\">any meaningful overhead here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11374854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8b430758cda206f482ce5ba642cc172?s=128&d=identicon&r=PG&f=1", "display_name": "IvePaidMyDues", "link": "https://stackoverflow.com/users/11374854/ivepaidmydues"}, "is_accepted": false, "score": 1, "last_activity_date": 1566294320, "last_edit_date": 1566294320, "creation_date": 1566294017, "answer_id": 57570783, "question_id": 57570040, "link": "https://stackoverflow.com/questions/57570040/keil-arm-compiler-is-there-a-way-to-hook-in-the-same-function-for-two-interrupt/57570783#57570783", "title": "Keil Arm Compiler: Is there a way to hook in the same function for two interrupts without modifying the Interrupt Vector Table?", "body": "<p>You can hint the compiler to inline <code>realIRQHandler</code>.</p>\n\n<p>Otherwise you don't have anything on the stack in <code>EXTI9_5_IRQHandler</code> or <code>EXTI15_10_IRQHandler</code>, and <code>realIRQHandler</code> doesn't take any parameter nor returns anything. The only thing you'll push on the stack is the frame pointer.</p>\n\n<p>Or, you can use <code>goto</code>.</p>\n\n<p>Edit : depending on the optimisation level you chose, the compiler might just do a simple Branch Exchange, which is more or less a <code>goto</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 300, "user_id": 2682209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810bee725c3bb8df9f84147a9c29432e?s=128&d=identicon&r=PG&f=1", "display_name": "opt12", "link": "https://stackoverflow.com/users/2682209/opt12"}, "edited": false, "score": 0, "creation_date": 1566302315, "post_id": 57570834, "comment_id": 101606562, "body": "It&#39;s the Keil v5 toolchain and this one has the vector table defined in its start up. Believe me, I didn&#39;t opt for chosing that toolchain. It&#39;s my customer who told me whats good for me. And it&#39;s my customer who doesn&#39;t want me to change the table directly."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1566294167, "creation_date": 1566294167, "answer_id": 57570834, "question_id": 57570040, "link": "https://stackoverflow.com/questions/57570040/keil-arm-compiler-is-there-a-way-to-hook-in-the-same-function-for-two-interrupt/57570834#57570834", "title": "Keil Arm Compiler: Is there a way to hook in the same function for two interrupts without modifying the Interrupt Vector Table?", "body": "<blockquote>\n  <p>I don't want to change the interrupt vector table entries in the startup assembly directly </p>\n</blockquote>\n\n<p>This is the problem. The <em>only</em> correct solution to the table is to modify the vector table. Therefore, the vector table shouldn't be defined in some startup file but in a file of its own. Either a linker script or a .c file (array of function pointers). </p>\n\n<p>If you can't modify the vector table you can't do microcontroller programming on your tool chain. So if your compiler/linker can't provide an easy way to do this, you will have to customize the start-up code.</p>\n"}, {"comments": [{"owner": {"reputation": 300, "user_id": 2682209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810bee725c3bb8df9f84147a9c29432e?s=128&d=identicon&r=PG&f=1", "display_name": "opt12", "link": "https://stackoverflow.com/users/2682209/opt12"}, "edited": false, "score": 0, "creation_date": 1566302411, "post_id": 57571217, "comment_id": 101606615, "body": "The application of my idea is: There are two interrupts (data ready lines) which are supposed to get low at the <i>same</i> time. However, one of them will definitely be the first one, but I don&#39;t know which on this will be. And so I thought of using the IRQ handler to react on either one and start a busy wait for the other one. If this times out, they are not synchronous and the system goes into error. The total execution time is not that crucial in fact.  The idea to put it into one function is more due to code maintenance and &quot;poshness&quot; and that I want to know how this would work."}, {"owner": {"reputation": 300, "user_id": 2682209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810bee725c3bb8df9f84147a9c29432e?s=128&d=identicon&r=PG&f=1", "display_name": "opt12", "link": "https://stackoverflow.com/users/2682209/opt12"}, "edited": false, "score": 0, "creation_date": 1566302671, "post_id": 57571217, "comment_id": 101606745, "body": "passing the IRQ number as parameter is a very good idea. I&#39;ll consider this."}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "reply_to_user": {"reputation": 300, "user_id": 2682209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810bee725c3bb8df9f84147a9c29432e?s=128&d=identicon&r=PG&f=1", "display_name": "opt12", "link": "https://stackoverflow.com/users/2682209/opt12"}, "edited": false, "score": 1, "creation_date": 1566304362, "post_id": 57571217, "comment_id": 101607703, "body": "@opt12 be careful because it looks like realIRQHandler  will be reentrant (if a handler is interrupted by the other interrupt, which may happen depending on the interrupt priorities or trigger order). Also busy waiting in a IRQ handler is not always the best solution since it might lead to deadlock."}], "tags": [], "owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "is_accepted": false, "score": 0, "last_activity_date": 1566295446, "creation_date": 1566295446, "answer_id": 57571217, "question_id": 57570040, "link": "https://stackoverflow.com/questions/57570040/keil-arm-compiler-is-there-a-way-to-hook-in-the-same-function-for-two-interrupt/57571217#57571217", "title": "Keil Arm Compiler: Is there a way to hook in the same function for two interrupts without modifying the Interrupt Vector Table?", "body": "<p>Something is not consistent: it seems like your interrupt handling duration is very critical (since you want to avoid function calls overhead), but at the same time you want to use the same function for two interrupts. Which means this function will need to do the \"extra work\" of checking whether the interrupt EXTI9_5 or ETXI15_10 was asserted. Wouldn't it be more efficient to have two different functions, one for each interrupt line ? Or at least pass the interrupt number as a  parameter to <code>realIRQHandler</code> ?</p>\n"}, {"tags": [], "owner": {"reputation": 1447, "user_id": 6746897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1eb640fcdc6847c55c189ceddb6afca5?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/6746897/julien"}, "is_accepted": false, "score": 0, "last_activity_date": 1566475477, "creation_date": 1566475477, "answer_id": 57608976, "question_id": 57570040, "link": "https://stackoverflow.com/questions/57570040/keil-arm-compiler-is-there-a-way-to-hook-in-the-same-function-for-two-interrupt/57608976#57608976", "title": "Keil Arm Compiler: Is there a way to hook in the same function for two interrupts without modifying the Interrupt Vector Table?", "body": "<p>Have a try by disassembling the compiled code, but the comment of @Groo is completely correct.</p>\n\n<blockquote>\n  <p>I don't think there should be <a href=\"https://godbolt.org/z/P4EyVa\" rel=\"nofollow noreferrer\">any meaningful overhead here</a></p>\n</blockquote>\n\n<p>If your function has same prototype as the interrupt handler (aka <code>void realIRQHandler(void)</code>) the compiler will not do any overhead.</p>\n"}], "owner": {"reputation": 300, "user_id": 2682209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810bee725c3bb8df9f84147a9c29432e?s=128&d=identicon&r=PG&f=1", "display_name": "opt12", "link": "https://stackoverflow.com/users/2682209/opt12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1566475477, "creation_date": 1566291353, "question_id": 57570040, "link": "https://stackoverflow.com/questions/57570040/keil-arm-compiler-is-there-a-way-to-hook-in-the-same-function-for-two-interrupt", "title": "Keil Arm Compiler: Is there a way to hook in the same function for two interrupts without modifying the Interrupt Vector Table?", "body": "<p>In an embedded project, I need to handle two different external interrupts with the same IRQ handler. \nI don't want to change the interrupt vector table entries in the startup assembly directly, so that I have to stick with the predefined function names for the IRQ-handler routines (EXTI9_5_IRQHandler and EXTI15_10_IRQHandler).</p>\n\n<p>For both interrupts, I need the exact same code to handle the interrupt.</p>\n\n<p>Of course, I can program this like this:</p>\n\n<pre><code>void realIRQHandler (void)\n{\n    //do some magic interrupt handling here\n    return;\n}\n\nvoid EXTI9_5_IRQHandler(void)\n{\n    realIRQHandler();   //calls the real IRQ handler function\n}\n\nvoid EXTI15_10_IRQHandler(void)\n{\n    realIRQHandler();   //calls the real IRQ handler function\n}\n</code></pre>\n\n<p>This will eventually do what I want, but it will have an ordinary function call with the overhead of pushing and restoring the registers to the stack in each interrupt invocation.</p>\n\n<p>Is there a way to replace those function calls in <code>EXTI9_5_IRQHandler</code> and <code>EXTI15_10_IRQHandler</code>somehow and replace it with some unconditional branch or jump?</p>\n\n<p>What would be needed at the end of <code>realIRQHandler</code> when returning/exiting?</p>\n\n<p>Thanks!\nRegards,\nFelix</p>\n"}, {"tags": ["c", "valgrind"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1566291561, "post_id": 57569956, "comment_id": 101600714, "body": "But that is the &quot;real&quot; address (Always a fuzzy thing when talking about virtual memory) when running under valgrind and the allocator it uses."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1566291648, "post_id": 57569956, "comment_id": 101600761, "body": "<a href=\"https://en.wikipedia.org/wiki/Address_space_layout_randomization\" rel=\"nofollow noreferrer\">Address space layout randomization</a> ensures that the address where the program runs is normally not consistent. Valgrind is a debugging tool so that would be unhelpful. The addresses are virtual, an application progam has no access to real addresses."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566292204, "post_id": 57569956, "comment_id": 101601051, "body": "@WeatherVane Does that mean that it not possible to free the memory later? For example, my test program printed address:  <code>0x55a72e303260</code>, then I could not later create a program that did <code>void *addr = (void*)0x55a72e303260; free(addr)</code> ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566292428, "post_id": 57569956, "comment_id": 101601174, "body": "You can only <code>free</code> the memory at an address that was allocated by <code>malloc</code> function family. Or in other words, you can only pass an address to <code>free</code> that was returned by <code>malloc</code> etc."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566292654, "post_id": 57569956, "comment_id": 101601314, "body": "@WeatherVane Yes I did allocate it by <code>malloc</code>, right? So can it then be <code>free</code>d later is the question"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566292766, "post_id": 57569956, "comment_id": 101601371, "body": "In that case why should it not be possible to <code>free</code> the memory later? Unless you corrupted memory, or altered the value of the pointer you were returned.  I don&#39;t see the point of hard-coding a pointer value: because it won&#39;t be the same from one run to the next."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566292898, "post_id": 57569956, "comment_id": 101601448, "body": "So it is not possible to free leaked memory later even if you know the address of the leaked memory?"}, {"owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "edited": false, "score": 0, "creation_date": 1566292973, "post_id": 57569956, "comment_id": 101601491, "body": "You should keep track of the addresses that are returned by <code>malloc()</code> and friends so that you can pass them to <code>free()</code> later. Not doing so is asking for trouble."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566293022, "post_id": 57569956, "comment_id": 101601514, "body": "Ok, I think you misunderstood the question. Thanks for the help anyway!"}, {"owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1566293396, "post_id": 57569956, "comment_id": 101601730, "body": "Right, your main question was probably answered by the first comment by @WeatherVane. I have updated my answer as well."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "edited": false, "score": 0, "creation_date": 1566293548, "post_id": 57569956, "comment_id": 101601809, "body": "@marcolz So then the answer is: it is not possible to free the memory later, even if you know the address because of the randomization feature."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566293812, "post_id": 57569956, "comment_id": 101601952, "body": "A &quot;leak&quot; means you haven&#39;t <code>free</code>d memory. There&#39;s no reason why you can&#39;t <code>free</code> memory, but copying the address given by Valgrind isn&#39;t the way to do it (and won&#39;t be repeatable in the proper version): you should find out <i>why</i> there is a leak, instead of trying to use sticking plaster."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566294030, "post_id": 57569956, "comment_id": 101602070, "body": "@WeatherVane Ok, thanks I agree on finding the cause of the leak, but my question was about freeing leaked memory from another process. I guess this leaves me still confused, and I will rather ask a new question than continuing this discussion in the comments.."}, {"owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "edited": false, "score": 0, "creation_date": 1566294405, "post_id": 57569956, "comment_id": 101602309, "body": "Well, you are correct in that you <i>can</i> <code>free()</code> any address that was previously allocated by <code>malloc()</code> and friends."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "edited": false, "score": 0, "creation_date": 1566296669, "post_id": 57569956, "comment_id": 101603574, "body": "@marcolz Added <a href=\"https://stackoverflow.com/q/57571539/2173773\">follow-up question</a>"}], "answers": [{"comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566291839, "post_id": 57570155, "comment_id": 101600854, "body": "If I run the program under <code>valgrind</code> repeatedly it always prints: <code>Address: 0x4a66040</code> why is it always the same?"}, {"owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1566292203, "post_id": 57570155, "comment_id": 101601049, "body": "Because the valgrind implementation of <code>malloc()</code> is not affected by - or possibly explicitly avoids - address space randomization."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1566292528, "post_id": 57570155, "comment_id": 101601235, "body": "So the reported address <code>0x4a66040</code> is not the real address of the allocated memory, but some address in valgrinds buffers. That&#39;s why valgrind can free <code>0x4a66040</code> for each run, and be able to reallocate the same buffer at the exactly the same place at the next run?"}, {"owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1566292671, "post_id": 57570155, "comment_id": 101601325, "body": "Yes, I just edited my answer with <code>strace</code> output, showing that valgrind explicitly selects where its buffer is allocated in the virtual address space of your process."}], "tags": [], "owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "is_accepted": true, "score": 4, "last_activity_date": 1566294661, "last_edit_date": 1566294661, "creation_date": 1566291692, "answer_id": 57570155, "question_id": 57569956, "link": "https://stackoverflow.com/questions/57569956/address-of-allocated-memory-not-the-same-when-running-under-valgrind/57570155#57570155", "title": "Address of allocated memory not the same when running under valgrind", "body": "<p>It <em>is</em> the \"real\" address of the allocated memory.</p>\n\n<p>Valgrind replaces your <code>malloc()</code> implementation with its own version, so that it can do what it does, see the line:</p>\n\n<pre><code>==8186==    at 0x483874F: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n</code></pre>\n\n<p>So it is the underlying call to obtain memory that differs between your \"normal\" libc implementation of <code>malloc()</code> and that of valgrind's implementation. Likely libc uses <code>brk()</code> and valgrind uses <code>mmap()</code>.</p>\n\n<p><code>brk()</code> follows the rules of <a href=\"https://en.wikipedia.org/wiki/Address_space_layout_randomization\" rel=\"nofollow noreferrer\">Address Space Layout Randomization</a> while <code>mmap()</code> allows for explicitly selecting the virtual memory address where to map the newly allocated memory.</p>\n\n<p>Edit: <code>strace</code> of both versions, shows:</p>\n\n<p>libc:</p>\n\n<pre><code>brk(NULL)                               = 0x5611e25ec000\nbrk(0x5611e260d000)                     = 0x5611e260d000\nfstat(1, {st_dev=makedev(0, 22), st_ino=67, st_mode=S_IFCHR|0620, st_nlink=1, st_uid=1000, st_gid=5, st_blksize=1024, st_blocks=0, st_rdev=makedev(136, 64), st_atime=1566292432 /* 2019-08-20T11:13:52.993864629+0200 */, st_atime_nsec=993864629, st_mtime=1566292432 /* 2019-08-20T11:13:52.993864629+0200 */, st_mtime_nsec=993864629, st_ctime=1564479628 /* 2019-07-30T11:40:28.009864433+0200 */, st_ctime_nsec=9864433}) = 0\nwrite(1, \"Address: 0x5611e25ec260\\n\", 24) = 24\n</code></pre>\n\n<p>valgrind:</p>\n\n<pre><code>mmap(0x4c2c000, 2158912, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0) = 0x4c2c000\n...\nwrite(1027, \"==18842==    at 0x4C2FB0F: mallo\"..., 91) = 91\n</code></pre>\n\n<p>So in fact Valgrind explicitly chooses where to map its memory pool.</p>\n"}], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 57570155, "answer_count": 1, "score": 0, "last_activity_date": 1566294661, "creation_date": 1566291073, "question_id": 57569956, "link": "https://stackoverflow.com/questions/57569956/address-of-allocated-memory-not-the-same-when-running-under-valgrind", "title": "Address of allocated memory not the same when running under valgrind", "body": "<p>I am testing <code>valgrind</code> and have this small C program that leaks 4 bytes:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    int* x = malloc(sizeof(int));\n    printf( \"Address: %p\\n\", x);\n    return 0;\n}\n</code></pre>\n\n<p>I compile it with: <code>gcc -g -o leak leak.c</code>, and run it:</p>\n\n<pre><code>$ leak\nAddress: 0x55a72e303260\n$ leak\nAddress: 0x55f370273260\n</code></pre>\n\n<p>So it shows two different addresses for two separate runs. However if I run it under valgrind it always shows the same address: <code>0x4a66040</code>:</p>\n\n<pre><code>$ valgrind --leak-check=full --show-leak-kinds=all  leak\n==8186== Memcheck, a memory error detector\n==8186== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==8186== Using Valgrind-3.14.0 and LibVEX; rerun with -h for copyright info\n==8186== Command: leak\n==8186== \nAddress: 0x4a66040\n==8186== \n==8186== HEAP SUMMARY:\n==8186==     in use at exit: 4 bytes in 1 blocks\n==8186==   total heap usage: 2 allocs, 1 frees, 1,028 bytes allocated\n==8186== \n==8186== 4 bytes in 1 blocks are definitely lost in loss record 1 of 1\n==8186==    at 0x483874F: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==8186==    by 0x109156: main (leak.c:6)\n==8186== \n==8186== LEAK SUMMARY:\n==8186==    definitely lost: 4 bytes in 1 blocks\n==8186==    indirectly lost: 0 bytes in 0 blocks\n==8186==      possibly lost: 0 bytes in 0 blocks\n==8186==    still reachable: 0 bytes in 0 blocks\n==8186==         suppressed: 0 bytes in 0 blocks\n==8186== \n==8186== For counts of detected and suppressed errors, rerun with: -v\n==8186== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Why is this so? And is it possible for <code>valgrind</code> to show the real address of the memory?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 2, "creation_date": 1566291185, "post_id": 57569922, "comment_id": 101600511, "body": "When you enter any char you press also &lt;ENTER&gt; key. Your loop receives 2 inputs: the wrong char and the enter code. That&#39;s why it runs twice."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1566291188, "post_id": 57569922, "comment_id": 101600513, "body": "<a href=\"https://stackoverflow.com/a/56594003/6699433\">stackoverflow.com/a/56594003/6699433</a>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 11913822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9cc018e4221fa89c6e2c4f1c67c4bf0?s=128&d=identicon&r=PG&f=1", "display_name": "iamaksingh11", "link": "https://stackoverflow.com/users/11913822/iamaksingh11"}, "edited": false, "score": 0, "creation_date": 1566292991, "post_id": 57570036, "comment_id": 101601499, "body": "&quot;would you like to share more about &quot;space&quot; in scanf&quot;"}], "tags": [], "owner": {"reputation": 85, "user_id": 11829389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8141548b8e13a29d15f6632a81449a?s=128&d=identicon&r=PG&f=1", "display_name": "LucasFab", "link": "https://stackoverflow.com/users/11829389/lucasfab"}, "is_accepted": true, "score": 3, "last_activity_date": 1566291334, "creation_date": 1566291334, "answer_id": 57570036, "question_id": 57569922, "link": "https://stackoverflow.com/questions/57569922/why-else-condition-executing-two-times-in-while-loop-in-c/57570036#57570036", "title": "Why else condition executing two times in while loop in C", "body": "<p>When you use scanf to get a character you should use</p>\n\n<pre><code>scanf(\" %c, &amp;c);\n</code></pre>\n\n<p>Instead of</p>\n\n<pre><code>scanf(\"%c, &amp;c);\n</code></pre>\n\n<p>Leaving a blank space tells to scanf to skip optional white space. </p>\n"}], "owner": {"reputation": 41, "user_id": 11913822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9cc018e4221fa89c6e2c4f1c67c4bf0?s=128&d=identicon&r=PG&f=1", "display_name": "iamaksingh11", "link": "https://stackoverflow.com/users/11913822/iamaksingh11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "closed_date": 1566291351, "accepted_answer_id": 57570036, "answer_count": 1, "score": -1, "last_activity_date": 1566292875, "creation_date": 1566290924, "last_edit_date": 1566292875, "question_id": 57569922, "link": "https://stackoverflow.com/questions/57569922/why-else-condition-executing-two-times-in-while-loop-in-c", "closed_reason": "Duplicate", "title": "Why else condition executing two times in while loop in C", "body": "<p>\"Else condition is executing two times and printing two times in while loop,if-else is not working properly,\"</p>\n\n<p>\"I also tried the goto statement, I get the same problem\"</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\nint main ()\n{\n  int count=0;\n  char select;\n  while(count==0)\n  {\n    printf(\"please select options\\n\");\n    scanf(\"%c\", &amp;select);\n    if (select=='b' || select=='B')\n    {\n        printf(\"you have selected b\");\n        count=1;\n    }\n    else\n    {\n      printf(\"why this line printing two time\\n\");\n    }\n  }\n return 0;\n}\n</code></pre>\n\n<p>result</p>\n\n<pre><code>please select options\ng\nwhy this line printing two time\nplease select options\nwhy this line printing two time\nplease select options\n</code></pre>\n\n<p>\"When I take input other than 'b'/'B', I expect out to print the else condition and again run while loop, but the actual output is printing else condition two times\"<a href=\"https://i.stack.imgur.com/PQon7.png\" rel=\"nofollow noreferrer\">a result of my code</a></p>\n"}]